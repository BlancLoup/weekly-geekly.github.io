<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Under the press. Break and protect Wordpress with your own hands</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="WordPress is a convenient blogging platform for posting and managing articles, on which a huge number of different sites are based. Because of its pre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Under the press. Break and protect Wordpress with your own hands</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/81e/202/972/81e2029727c941c29dacf5ee6d1cba02.jpg"><br><br>  WordPress is a convenient blogging platform for posting and managing articles, on which a huge number of different sites are based.  Because of its prevalence, this CMS has long been a tidbit for intruders.  Unfortunately, the basic settings do not provide a sufficient level of protection, leaving many default holes unclosed.  In this article, we will go through a typical ‚Äútypical‚Äù hacking of the site on Wordpress, and also show how to fix the identified vulnerabilities. <br><a name="habracut"></a><br><h4>  Introduction </h4><br>  Today WordPress is the most popular among content management systems.  Its share is 60.4% of the total number of sites using CMS-engines.  According to statistics, 67.3% of sites are based on the latest version of this software.  Meanwhile, during the twelve years of the web engine existence, 242 vulnerabilities of various kinds were discovered in it (without taking into account the vulnerabilities found in third-party plugins and themes).  And the statistics of third-party add-ons looks even sadder.  So, Revisium analyzed 2350 Russified templates for WordPress, taken from various sources.  As a result, they found out that more than half (54%) were infected with web shells, backdoors, blackhat seo (‚Äúspam‚Äù) links, and also contained scripts with critical vulnerabilities.  So get comfortable, now we will figure out how to audit the site on WordPress and fix the found flaws.  We will use version 4.1 (Russified). <br><br><h4>  Indexing site </h4><br>  The first stage of any test is usually collecting information about the goal.  And here it often helps to incorrectly configure the site indexing, which allows unauthorized users to view the contents of individual sections of the site and, for example, get information about installed plugins and themes, as well as access to confidential data or backup copies of databases.  To check which directories are visible from the outside, it's easiest to use Google.  Simply run a Google Dorks query of type site: example.com intitle: ‚Äúindex of‚Äù inurl: / wp-content /.  In the inurl: statement, you can specify the following directories: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="bash hljs">/wp-content/ /wp-content/languages/plugins /wp-content/languages/themes /wp-content/plugins/ /wp-content/themes/ /wp-content/uploads/</code> </pre> <br>  If you can view / wp-content / plugins /, the next step in collecting information about installed plugins and their versions is much simpler.  Naturally, you can disable indexing using the robots.txt file.  Since by default it is not included in the WordPress installation package, you need to create it yourself and drop it into the root directory of the site.  There are quite a few manuals for creating and working with a robots.txt file, so I‚Äôll leave this topic for self-study.  I will give only one of the possible options: <br><br><pre> <code class="bash hljs">User-Agent: * Disallow: /cgi-bin Disallow: /wp-login.php Disallow: /wp-admin/ Disallow: /wp-includes/ Disallow: /wp-content/ Disallow: /wp-content/plugins/ Disallow: /wp-content/themes/ Disallow: /?author=* Allow: /</code> </pre><br>  If the files stored in the uploads folder contain confidential information, add the following line to this list: Disallow: / wp-content / uploads /.  On the other hand, in the robots.txt file, it is not recommended to place links to directories that were created specifically to store sensitive information.  Otherwise, by doing this you will make it easier for an intruder to take on the task, since this is the first place where everyone usually looks in search of ‚Äúinteresting things. <br><br><h4>  Determining the WordPress Version </h4><br>  Another important step is the identification of the CMS version.  Otherwise, how to choose the right flop?  There are three quick ways to determine the version of WordPress used on the site: <br><br>  1. Find in the source code of the page.  It is listed in the generator: / meta tag or in tags: &lt;link rel = 'stylesheet' id = 'twentyfifteen-style-css' href =' http: //.../wordpress/wp-content/themes/twentyfifteen/ style.css? ver = 4.1.1 '... /&gt;. <br>  2. Find in the readme.html file (Fig. 1), which is part of the installation package and is located at the root of the site.  The file may have other names like readme-ja.html. <br>  3. Find in the file ru_RU.po (Fig. 2), which is included in the installation package and located at / wp-content / languages ‚Äã‚Äã/: "Project-Id-Version: WordPress 4.1.1 \ n". <br><br><img src="https://habrastorage.org/files/b0f/ca9/2b4/b0fca92b4ca9499e85aaa98efb216216.png"><br>  Fig.  1. WordPress version in readme.html <br><br><img src="https://habrastorage.org/files/829/652/566/82965256689d42e892a2189f06daec14.png"><br>  Fig.  2. Peep WordPress version in ru_RU.po <br><br>  One of the security options in this case is to restrict access to the readme.html and ru_RU.po files using .htaccess. <br><br><blockquote><h4>  Automate the testing process </h4><br>  WordPress didn‚Äôt study security yesterday, so there are enough tools to automate routine tasks. <br><br>  Nmap: <br><br>  - determining the version and theme using <a href="http://seclists.org/nmap-dev/2014/q4/102">the http-wordpress-info script</a> <br><br><pre> <code class="bash hljs">nmap -sV --script http-wordpress-info &lt;ip&gt;</code> </pre><br>  - password selection by dictionaries <br><br><pre> <code class="bash hljs">nmap -p80 --script http-wordpress-brute --script-args <span class="hljs-string"><span class="hljs-string">'userdb=users.txt,passdb=passwords.txt'</span></span> example.com</code> </pre><br>  Metasploit: <br><br>  - module for determining the version: auxiliary / scanner / http / wordpress_scanner; <br>  - a module for determining the user name auxiliary / scanner / http / wordpress_login_enum. <br><br>  WPScan: <br><br>  - list of installed plugins: wpscan --url <a href="http://www.exmple.com/">www.exmple.com</a> --enumerate p; <br>  - listing established topics: wpscan --url <a href="http://www.exmple.com/">www.exmple.com</a> --enumerate t; <br>  - listing of installed timthumbs: wpscan --url <a href="http://www.example.com/">www.example.com</a> --enumerate tt; <br>  - username definition: wpscan --url <a href="http://www.example.com/">www.example.com</a> --enumerate u; <br>  - dictionary password selection for admin user: wpscan --url <a href="http://www.example.com/">www.example.com</a> --wordlist wordlist.txt --username admin; <br>  - password selection using a username / password bundle with the number of threads equal to 50: wpscan --url <a href="http://www.example.com/">www.example.com</a> --wordlist wordlist.txt --threads 50. </blockquote><br><h4>  Identify installed components </h4><br>  Now let's gather information about installed plugins and themes, regardless of whether they are activated or not.  First of all, such information can be extracted from the source code of the HTML page, for example, via JavaScript links, from comments and CSS-like resources that are loaded onto the page.  This is the easiest way to get information about installed components.  For example, the lines below indicate the twentyeleven theme used: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">media</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"all"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://example.com/wp-content/themes/twentyeleven/style.css"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://example.com/wp-content/themes/twentyeleven/js/html5.js"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Further, HTTP headers, such as X-Powered-By, may indicate the presence of a plugin (for example, the W3 Total Cache plugin). <br>  Since information about plugins is not always displayed in the source code of the HTML page, you can detect installed components using the WPScan utility (see the sidebar).  Just do not forget that the search of plugin paths will be fixed in the logs of the web server. <br>  Having obtained the data about the installed components, you can already start searching for vulnerabilities on your own or find publicly available exploits on resources like <a href="http://www.rapid7.com/db/">rapid7</a> or <a href="http://www.exploit-db.com/">exploit-db</a> . <br><br><h4>  User Name Definition </h4><br>  By default, in WordPress, each user is assigned a unique identifier, represented as a number: example.com/?author=1.  Going through the numbers, you will determine the names of users of the site.  The admin account, which is created during the WordPress installation process, is number 1, so it is recommended to remove it as a protective measure. <br><br><h4>  Brutfors wp-login </h4><br><img src="https://habrastorage.org/files/dbf/9a3/a9e/dbf9a3a9e6e0445d80688cf471b88902.png"><br>  Fig.  3. Errors in user authentication <br><br>  Knowing the username, you can try to find the password to the administration panel.  The WordPress authorization form on the wp-login.php page is very informative (Fig. 3), especially for the attacker: when you enter incorrect data, prompts appear about the wrong username or password for a specific user.  The developers are aware of this feature, but they decided to leave it, since such messages are convenient for users who may have forgotten their login and / or password.  The problem of selecting a password can be solved using a strong password consisting of twelve or more characters and including upper and lower case letters, numbers and special characters.  Or, for example, using the Login LockDown plugin. <br><br><blockquote><h4>  Security plugins for WordPress </h4><br>  - <a href="http://www.bad-neighborhood.com/login-lockdown.html">Login LockDown</a> - limits the number of failed login attempts; <br>  - <a href="http://revisium.com/rwp/">Revisium WordPress Theme Checker</a> - searches for typical malicious snippets in WordPress themes; <br>  - <a href="https://wordpress.org/plugins/sucuri-scanner/">Sucuri Security</a> - monitors and detects malicious code; <br>  - <a href="https://wordpress.org/plugins/better-wp-security/">iThemes Security (formerly Better WP Security)</a> - multifunctional plugin to protect WordPress; <br>  - <a href="https://wordpress.org/plugins/backupwordpress/">BackUpWordPress</a> - makes backup files and databases; <br>  - <a href="https://wordpress.org/plugins/google-captcha/">Google Captcha (reCAPTCHA)</a> - installs captcha during registration, authorization, password recovery and in the form of comments. </blockquote><br><h4>  Fill the shell </h4><br>  After we have twisted the password, nothing prevents to pour the shell on the compromised web resource.  For these purposes, the <a href="https://github.com/epinna/weevely3">Weevely framework</a> , which allows you to generate a shell in an obfuscated form, makes it quite difficult to detect.  To avoid suspicion, the resulting code can be inserted into any theme file (for example, in index.php) via the theme editor of the WordPress console.  After that, using the same Weevely, you can connect to the victim's machine and call various commands: <br><pre> <code class="bash hljs">python weevely.py http://<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>/index.php Pa$<span class="hljs-variable"><span class="hljs-variable">$w0rd</span></span> [+] weevely 3.1.0 [+] Target:<span class="hljs-built_in"><span class="hljs-built_in">test</span></span> [+] Session: _weevely/sessions/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>/index_0.session [+] Browse the filesystem or execute commands starts the connection [+] to the target. Type :<span class="hljs-built_in"><span class="hljs-built_in">help</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> more information. weevely&gt; :<span class="hljs-built_in"><span class="hljs-built_in">help</span></span></code> </pre><br><h4>  We connect .htaccess </h4><br>  To deny access to sensitive information, it is better to use the .htaccess file - this is the configuration file used in the Apache Web Server.  Consider the capabilities of this file in terms of security.  With it, you can: deny access to directories and files, block various SQL injections and malicious scripts.  To do this, the <a href="http://codex.wordpress.org/htaccess">standard</a> .htaccess file for CMS WordPress 4.1 needs to be slightly extended.  To close the list of files and folders, add: <br><br><pre> <code class="bash hljs">Options +FollowSymLinks -Indexes RewriteCond %{QUERY_STRING} base64_encode[^(]*\([^)]*\) [OR]  ,   Base64.   ,   &lt;script&gt;: RewriteCond %{QUERY_STRING} (&lt;|%3C)([^s]*s)+cript.*(&gt;|%3E) [NC,OR]</code> </pre><br>  Counteract scripts trying to set global variables or change _REQUEST variable via URL: <br><br><pre> <code class="bash hljs">RewriteCond %{QUERY_STRING} GLOBALS (=|\[|\%[0-9A-Z]{0,2}) [OR] RewriteCond %{QUERY_STRING} _REQUEST (=|\[|\%[0-9A-Z]{0,2})</code> </pre><br>  To counteract SQL injections, we block URL requests that contain certain keywords: <br><br><pre> <code class="bash hljs">RewriteCond %{query_string} concat.*\( [NC,OR] RewriteCond %{query_string} union.*select.*\( [NC,OR] RewriteCond %{query_string} union.*all.*select [NC] RewriteRule ^(.*)$ index.php [F,L]</code> </pre><br>  To spoil the life of common hacking tools, we filter out certain user-agents: <br><br><pre> <code class="bash hljs">SetEnvIf user-agent ¬´Indy Library¬ª stayout=1 SetEnvIf user-agent ¬´libwww-perl¬ª stayout=1 SetEnvIf user-agent ¬´Wget¬ª stayout=1 deny from env=stayout</code> </pre><br><h4>  Protecting files </h4><br>  It would also be nice to restrict access to particularly important files that store the configuration or can simply give the attacker some information.  The following candidates can be distinguished: <br><br>  - wp-config.php, contains the database name, user name, password and table prefix; <br>  - .htaccess; <br>  - readme.html and ru_RU.po, which contain the WordPress version; <br>  - install.php. <br><br>  This is done as follows: <br><br><pre> <code class="bash hljs">&lt;Files _&gt; Order Allow,Deny Deny from all &lt;/Files&gt;</code> </pre><br>  Moreover, the .htaccess file containing these lines must be located in the same directory as the protected file.  Then we prohibit the transfer of users (remember, we just talked about how easy it is to get a list of users?): <br><br><pre> <code class="bash hljs">RewriteCond %{QUERY_STRING} author=\d RewriteRule ^ /? [L,R=301]</code> </pre><br>  So what else?  You can only allow login from specified IP addresses.  To do this, create a .htaccess file in the wp-admin folder with the following rules: <br><br><pre> <code class="bash hljs">AuthUserFile /dev/null AuthGroupFile /dev/null AuthName <span class="hljs-string"><span class="hljs-string">"Access Control"</span></span> AuthType Basic order deny,allow deny from all allow from 178.178.178.178 <span class="hljs-comment"><span class="hljs-comment"># IP   allow from 248.248.248.248 # IP  </span></span></code> </pre><br>  The method is not very flexible and is applicable only if you work with a limited number of fixed IP addresses.  Otherwise, it is recommended to set a password to the wp-admin folder through the hosting panel (if such functionality is available). <br><br><blockquote><h4>  Www </h4><br>  The <a href="https://perishablepress.com/5g-blacklist-2013/">5G Blacklist</a> and <a href="https://perishablepress.com/6g-beta/">6G Blacklist beta</a> ruleset from Perishable Press, which allows you to fight common malicious URL requests for WordPress. </blockquote><br><h4>  Additional measures </h4><br>  To what has been said above, you can add the following recommendations.  First, use only current versions of WordPress and its components - this will eliminate known vulnerabilities.  Secondly, delete unused plugins and themes that can also be exploited.  Thirdly, download WordPress themes and plugins from reliable sources, for example, from the developer sites and the official WordPress site.  Like a home PC, you need to periodically check your web resource with a web antivirus, for example <a href="http://revisium.com/ai/">AI-Bolit</a> .  If you have access to a web server, configure permissions for files and directories.  As a rule, WordPress installs all the necessary rights at the installation stage, but if necessary, chmod can be set manually.  For directories - chmod 755, for files - chmod 644. Make sure that the rights 777 are assigned only to those objects that need it (sometimes this is necessary for the normal operation of some plugins).  If WordPress stopped functioning normally, experiment with access rights: first try 755, then 766, and finally 777. For all htaccess files, set chmod 444 (read only).  If the site stops working, try experimenting with the values ‚Äã‚Äã400, 440, 444, 600, 640, 644. <br><br>  Move the file wp-config.php.  This file contains information about MySQL settings, table prefix, secret keys, and so on.  Therefore, it is necessary to transfer it so that the file is not accessible from the Internet.  If the site is not located in the public_html folder, then move the wp-config.php file to a folder a higher level, and WordPress will automatically find it in this root directory (applicable if there is only one site on this CMS on the hosting). <br><br>  To complicate the shell fill, disable the ability to edit the theme through the WordPress console.  To do this, paste the following line into the wp-config.php file: define ('DISALLOW_FILE_EDIT', true) ;. <br><br>  Another weak point is the install.php file (which is in the wp-admin folder).  Therefore, it is better to remove, block or change.  Complete one of the options: <br><br><ol><li>  Just delete this file - after installation it is no longer necessary. </li><li>  Prevent file access with .htaccess. </li><li>  Rename the original install.php file (for example, install.php.old) and create a new install.php file with the following contents: </li></ol><br><pre> <code class="html hljs xml"><span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> header(</span><span class="hljs-string"><span class="php"><span class="hljs-string">"HTTP/1.1 503 Service Temporarily Unavailable"</span></span></span><span class="php">); </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span> <span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> header(</span><span class="hljs-string"><span class="php"><span class="hljs-string">"Status 503 Service Temporarily Unavailable"</span></span></span><span class="php">); </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span> <span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> header(</span><span class="hljs-string"><span class="php"><span class="hljs-string">"Retry-After 3600"</span></span></span><span class="php">); </span><span class="hljs-comment"><span class="php"><span class="hljs-comment">// 60 minutes </span></span><span class="hljs-meta"><span class="php"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></span></span> <span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?php</span></span></span><span class="php"> mail(</span><span class="hljs-string"><span class="php"><span class="hljs-string">"your@email.com"</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">"Database Error"</span></span></span><span class="php">, </span><span class="hljs-string"><span class="php"><span class="hljs-string">"There is a problem with teh database!"</span></span></span><span class="php">); </span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xml:lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/xhtml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Content-Type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html; charset=utf-8"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Error Establishing Database Connection<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Error Establishing Database Connection<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>We are currently experiencing database issues. Please check back shortly. Thank you.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  In addition to notifying visitors to the site, this script performs the following actions: <br><br>  - sends the status code 503 to the client and search engines (‚ÄúThe service is temporarily unavailable‚Äù); <br>  - indicates the period of time after which customers and search engines can return to the site (custom parameter); <br>  - notifies by e-mail about the problem with the database for appropriate action. <br><br>  The fact is that in earlier versions of WordPress (&lt;= 2.7.1) when MySQL crashes (for example, during a DDoS attack), CMS makes it possible to reinstall.  In addition, it can happen when one of the WordPress tables fails or becomes corrupted.  In particular, an attack is possible when the wp_options table (in WordPress 2.6.2) or wp_users (in WordPress 2.0.3 and 2.0.11) is damaged.  That is, in different versions of WP different tables are the main ones when checking in the installer - this can be either the wp_options table or wp_users table. <br>  And finally, turn off the registration of new users, if this is not necessary (Fig. 4).  If, however, the site provides for registration, make sure that new users receive minimal privileges after registration. <br><br><img src="https://habrastorage.org/files/9f4/817/680/9f4817680db143fd8ba0c71e262be0d0.png"><br>  Fig.  4. Disable registration of new users <br><br><blockquote><h4>  useful links </h4><br>  Hardening WordPress <a href="http://codex.wordpress.org/Hardening_WordPress">codex.wordpress.org/Hardening_WordPress</a> <br>  Ten steps to protect your WordPress blog <a href="http://habrahabr.ru/post/62814/">habrahabr.ru/post/62814</a> <br>  Every second Russified template for WordPress is infected or vulnerable <a href="http://www.securitylab.ru/analytics/456835.php">www.securitylab.ru/analytics/456835.php</a> <br>  Presentation on hacking sites WordPress <a href="https://xakep.ru/2015/04/01/wordpress-hack/">xakep.ru/2015/04/01/wordpress-hack</a> </blockquote><br><h4>  Conclusion </h4><br><br>  WordPress is a rather large and complex product, with its pluses and minuses.  Unfortunately, in the default configuration, its security is a big question, since even the usual scripts with direct hands and the Internet will be able to penetrate the defense.  Therefore, I strongly recommend checking your resource in the same way as we did in the article.  And if you find flaws - fix them to reduce the chances of an attacker to compromise the resource to a minimum. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f7b/153/c18/f7b153c18e47620075b1db37ae011fce.jpg" alt="image"><br><br>  <i>First published in Hacker Magazine # 196.</i> <i><br></i>  <i>Posted by: Sergey Storchak, PentestIT</i> <br><br>  Subscribe to "Hacker" <br><ul><li>  <a href="https://xakep.ru/wp-admin/profile.php%3Fpage%3Dpaywall_subscribes">Site materials</a> </li><li>  <a href="http://bit.ly/habr_subscribe_paper">Paper version</a> </li><li>  <a href="http://bit.ly/xakep_on_ipad">Hacker on iOS / iPad</a> </li><li>  <a href="http://bit.ly/habr_android">"Hacker" on Android</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/259843/">https://habr.com/ru/post/259843/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../259831/index.html">How I found the best programming language in the world. Part 1</a></li>
<li><a href="../259833/index.html">Spatial navigation and not only in the assembly Vivaldi 1.0.196.2</a></li>
<li><a href="../259835/index.html">Work with texture compression in Unity3D + NGUI</a></li>
<li><a href="../259839/index.html">OS Development on Go + asm Part 0x01</a></li>
<li><a href="../259841/index.html">How I found the best programming language in the world. Part 2</a></li>
<li><a href="../259845/index.html">Connect and conquer. Unusual view of keep-alive</a></li>
<li><a href="../259847/index.html">Model rover MSL Curiosity</a></li>
<li><a href="../259849/index.html">The crash of the satellite Express-MD1 (July 4, 2013)</a></li>
<li><a href="../259853/index.html">Swift 2.0 will be open source at the end of the year.</a></li>
<li><a href="../259855/index.html">Multidimensional Mtree Tree</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>