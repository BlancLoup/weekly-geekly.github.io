<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Matreshka.js 2: From simple to simple</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Documentation in Russian 
 Github repository 


 Hello! In this article I will tell you how to use Matreshka.js on three simple examples. We will look...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Matreshka.js 2: From simple to simple</h1><div class="post__text post__text-html js-mediator-article"><p> <a href="http://matreshka.io/"><img src="https://habrastorage.org/getpro/habr/post_images/2c1/7dd/c95/2c17ddc954b9bb6c001888f64f42d865.png" alt="image"></a> </p><br><p>  <a href="http://ru.matreshka.io/">Documentation in Russian</a> <br>  <a href="https://github.com/finom/matreshka">Github repository</a> </p><br><p>  Hello!  In this article I will tell you how to use Matreshka.js on three simple examples.  We will look at the basic capabilities of the framework, learn how to work with data and analyze the collections. </p><br><p>  A post is a brief compilation of translations from <a href="https://github.com/matreshkajs/examples-and-tutorials">this repository</a> . </p><br><a name="habracut"></a><br><h3>  1. Hello World! </h3><br><p>  To get started is to familiarize yourself with the application Hello World, which is <a href="https://ru.matreshka.io/">rendered from the post on the site</a> . </p><br><pre><code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ... <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   x    <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bindNode(<span class="hljs-string"><span class="hljs-string">'x'</span></span>, <span class="hljs-string"><span class="hljs-string">'.my-input'</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   x     my-output <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bindNode(<span class="hljs-string"><span class="hljs-string">'x'</span></span>, <span class="hljs-string"><span class="hljs-string">'.my-output'</span></span>, htmlBinder()); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    x <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.<span class="hljs-literal"><span class="hljs-literal">on</span></span>(<span class="hljs-string"><span class="hljs-string">'change:x'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(`<span class="javascript"><span class="javascript">x   </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"${this.x}"</span></span></span></span>`)); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ...</code> </pre> <br><p>  When updating the <code>x</code> property, three things happen: </p><br><ul><li>  The input field value will be updated. </li><li>  HTML block content will be updated. </li><li>  The console will display information about what <code>x</code> changed </li></ul><br><p>  When entering text in a text field: </p><br><ul><li>  Property <code>x</code> updated </li><li>  HTML block content will be updated. </li><li>  The console will display information about what <code>x</code> changed </li></ul><br><p>  As you can see, you do not need to manually catch the input event in the text field;  when changing the value of the property, you do not need to manually set HTML values ‚Äã‚Äãfor the nodes;  no need to declare the handle yourself. </p><br><p>  <a href="http://matreshkajs.github.io/examples-and-tutorials/hello-world/">Demo</a> </p><br><h3>  2. Authorization form.  Meet <a href="http://ru.matreshka.io/">Matreshka.Object</a> </h3><br><p>  The next example is the implementation of the authorization form on the site.  We have two text fields: login and password.  There are two checkboxes: ‚Äúshow password‚Äù and ‚Äúremember me‚Äù.  There is one button: ‚Äúenter‚Äù, which is active only when the form is valid.  Let's say that the form validation is passed if the login length is at least 4 characters, and the password length is at least 5 characters. </p><br><img src="https://habrastorage.org/getpro/habr/post_images/8b8/d10/641/8b8d1064142d153a992b2bd1fd96dd34.png" alt="image"><br><p>  A bit of theory: <code>Matreshka.Object</code> plays the role of a class that creates objects of key-value type.  In each instance of a class, you can separate the <strong>properties responsible for the data</strong> (what is not transferred to the server, for example) from other properties (what the server does not need, but determines the behavior of the application).  In this case, the login, password, and ‚Äúremember me‚Äù are the data that we send to the server, and the property that says whether the form is valid is not. </p><br><p>  Detailed and current information about this class is <a href="http://ru.matreshka.io/">in the documentation</a> . </p><br><p>  So, let's create a class that inherits from <code>Matreshka.Object</code> . </p><br><pre> <code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LoginForm</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Matreshka</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Object</span></span></span><span class="hljs-class"> </span></span>{ constructor () { <span class="hljs-comment"><span class="hljs-comment">// ... } }</span></span></code> </pre> <br><p>  Since the ‚Äúapplication‚Äù is very small, all the logic can be placed in the class constructor. </p><br><p>  First of all, we will declare the data by default. </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">super</span></span>(); <span class="hljs-selector-tag"><span class="hljs-selector-tag">this</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.setData</span></span>({ <span class="hljs-attribute"><span class="hljs-attribute">userName</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, password: <span class="hljs-string"><span class="hljs-string">''</span></span>, rememberMe: true })</code> </pre> <br><p>  The <a href="http://ru.matreshka.io/">setData</a> method not only sets values, but also declares the properties responsible for the data.  That is, <code>userName</code> , <code>password</code> and <code>rememberMe</code> should be transferred to the server (in this example, we simply display JSON on the screen). </p><br><p>  Since when developing applications, it is recommended to use all the power of ECMAScript 2015, and since the constructor <code>Matreshka.Object</code> calls <code>setData</code> with the argument passed to it, we initialize the defol data with a single call to <code>super</code> (which would make the same family as <code>Matreshka.Object.call(this, { ... })</code> ) so that the code becomes prettier.  The code below does the same as the previous one: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">super</span></span>({ <span class="hljs-attribute"><span class="hljs-attribute">userName</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, password: <span class="hljs-string"><span class="hljs-string">''</span></span>, rememberMe: true })</code> </pre> <br><p>  We declare a property, <code>isValid</code> , which depends on the <code>userName</code> and password properties.  If you change any of these properties (from code, console, or by using a bound element), the <code>isValid</code> property also changes. </p><br><pre> <code class="hljs coffeescript">.calc(<span class="hljs-string"><span class="hljs-string">'isValid'</span></span>, [<span class="hljs-string"><span class="hljs-string">'userName'</span></span>, <span class="hljs-string"><span class="hljs-string">'password'</span></span>], <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(userName, password)</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> userName.length &gt;= <span class="hljs-number"><span class="hljs-number">4</span></span> &amp;&amp; password.length &gt;= <span class="hljs-number"><span class="hljs-number">5</span></span>; })</code> </pre> <br><p>  <code>isValid</code> will be <code>true</code> if the length of the username is at least four, and the length of the password is at least five.  The <a href="http://ru.matreshka.io/">calc</a> method is another cool feature of the framework.  Some properties may depend on others, others on third, in others, on the properties of another object.  At the same time, you are protected from cyclical links.  The method stops working if it encounters dangerous dependencies. </p><br><p>  Now, link the object properties and elements on the page.  First of all we declare the sandbox.  The sandbox is needed in order to limit the impact of the instance to one element on the page and to avoid conflicts (for example, if there are two elements on the page with the same class).  Then bind the rest of the items. </p><br><pre> <code class="hljs pgsql">//       -    , //      .bindNode({ sandbox: <span class="hljs-string"><span class="hljs-string">'.login-form'</span></span>, userName: <span class="hljs-string"><span class="hljs-string">':sandbox .user-name'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">password</span></span>: <span class="hljs-string"><span class="hljs-string">':sandbox .password'</span></span>, showPassword: <span class="hljs-string"><span class="hljs-string">':sandbox .show-password'</span></span>, rememberMe: <span class="hljs-string"><span class="hljs-string">':sandbox .remember-me'</span></span> })</code> </pre> <br><p>  As you can see, for the remaining elements, a non-standard selector is used <code>:sandbox</code> , which refers to the sandbox (to an element with the class <code>.login-form</code> ).  In this case it is not necessary, as the page contains only our form.  Otherwise, if there are several forms or other widgets on the page, it is strongly recommended to restrict the elements to be selected by the sandbox. </p><br><p>  Then, we connect the button responsible for submitting the form and the <code>isValid</code> property.  When <code>isValid</code> is <code>true</code> , we add the class "disabled" to the element, when <code>false</code> , we remove.  This is an example of one-way binding, or rather, the value of an object property affects the state of the HTML element, but not vice versa. </p><br><pre> <code class="hljs kotlin">.bindNode(<span class="hljs-string"><span class="hljs-string">"isValid"</span></span>, <span class="hljs-string"><span class="hljs-string">":sandbox .submit"</span></span>, { setValue(v) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.classList.toggle(<span class="hljs-string"><span class="hljs-string">"disabled"</span></span>, !v); } })</code> </pre> <br><p>  Instead of such a record, you can use a shorter one: </p><br><pre> <code class="hljs cs">.bindNode(<span class="hljs-string"><span class="hljs-string">'isValid'</span></span>, <span class="hljs-string"><span class="hljs-string">':sandbox .submit'</span></span>, Matreshka.binders.className(<span class="hljs-string"><span class="hljs-string">'disabled'</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>))</code> </pre> <br><p>  See the <a href="http://ru.matreshka.io/">documentation for the binders object</a> . </p><br><p>  We associate the field with the password and the <code>showPassword</code> property (‚Äúshow password‚Äù) and change the input type depending on the value of the property ( <code>:bound(KEY)</code> is the last non-standard selector). </p><br><pre> <code class="hljs css"><span class="hljs-selector-class"><span class="hljs-selector-class">.bindNode</span></span>("<span class="hljs-selector-tag"><span class="hljs-selector-tag">showPassword</span></span>", "<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:bound(password)"</span></span>, { <span class="hljs-attribute"><span class="hljs-attribute">getValue</span></span>: null, <span class="hljs-built_in"><span class="hljs-built_in">setValue</span></span>(v) { this.type = v ? <span class="hljs-string"><span class="hljs-string">"text"</span></span> : <span class="hljs-string"><span class="hljs-string">"password"</span></span>; } })</code> </pre> <br><p>  <code>getValue: null</code> means that we redefine the standard behavior of the framework when binding form elements. </p><br><p>  Add a form submission event. </p><br><pre> <code class="hljs cs">.<span class="hljs-keyword"><span class="hljs-keyword">on</span></span>(<span class="hljs-string"><span class="hljs-string">"submit::sandbox"</span></span>, evt =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.login(); evt.preventDefault(); })</code> </pre> <br><p>  <code>submit</code> is a regular, arbitrary DOM or jQuery event, <code>sandbox</code> is our form ( <code>.login-form</code> ).  Such an event and key must be separated by a colon.  This is the syntax sugar of the DOM event, i.e. the event can be hung in any other way, including using <code>addEventListener</code> : </p><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.nodes.sandbox.addEventListener(<span class="hljs-string"><span class="hljs-string">"submit"</span></span>, evt =&gt; { ... });</code> </pre> <br><p>  In the handler, we call the <code>login</code> method, which we declare below, and prevent the page from reloading, canceling the standard browser behavior using <code>preventDefault</code> . </p><br><p>  The final touch is the <code>login</code> method.  For example, the method displays the resulting object if the form is valid.  In a real application, the content of the function should obviously be an ajax request to the server. </p><br><pre> <code class="hljs kotlin">login() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isValid) { alert(JSON.stringify(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; }</code> </pre> <br><p>  At the very end, create an instance of the class. </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> loginForm = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LoginForm();</code> </pre> <br><p>  You can open the console again and change the properties manually: </p><br><pre> <code class="hljs pgsql">loginForm.userName = "Chuck Norris"; loginForm.<span class="hljs-keyword"><span class="hljs-keyword">password</span></span> = "roundhouse_kick"; loginForm.showPassword = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>;</code> </pre> <br><p>  <a href="https://matreshkajs.github.io/examples-and-tutorials/matreshka-object/">Demo</a> </p><br><h3>  3. List of users.  We understand the collections ( <a href="http://ru.matreshka.io/">Matreshka.Array</a> ) </h3><br><p>  With the data type key-value sorted out.  Consider the collection.  Let's say the task sounds like this: display a list of some people in a table. </p><br><img src="https://habrastorage.org/getpro/habr/post_images/ad5/7b3/d18/ad57b3d18a76aba8f473a467047532e3.png"><br><p>  In order not to complicate the example, we place the previously prepared data into the <code>data</code> variable. </p><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">const</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> = [{ </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">: '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ida</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">T</span></span></span><span class="hljs-class">. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Heath</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">email</span></span></span><span class="hljs-class">: '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ida</span></span></span><span class="hljs-class">@</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dayrep</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">com'</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">phone</span></span></span><span class="hljs-class">: '507-879-9766' }, { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">: '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Robert</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">C</span></span></span><span class="hljs-class">. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Burkhardt</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">email</span></span></span><span class="hljs-class">: '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">rburkhardt</span></span></span><span class="hljs-class">@</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">teleworm</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">us'</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">phone</span></span></span><span class="hljs-class">: '321-252-5698' }, { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">: '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Gerald</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">S</span></span></span><span class="hljs-class">. </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Reaves</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">email</span></span></span><span class="hljs-class">: '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">gsr</span></span></span><span class="hljs-class">@</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">rhyta</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">com'</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">phone</span></span></span><span class="hljs-class">: '765-431-5347' }];</span></span></code> </pre> <br><p>  (names and phone numbers obtained using random data generator) </p><br><p>  For starters, as usual, create HTML markup. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"users"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>Name<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>Email<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>Phone<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-comment"><span class="hljs-comment">&lt;!--     --&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Let's declare the <code>Users</code> collection, which is inherited from <code>Matreshka.Array</code> . </p><br><pre> <code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Users</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Matreshka</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Array</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre> <br><p>  We <code>itemRenderer</code> property, which is responsible for how the elements of the array are rendered on the page. </p><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">get</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">itemRenderer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'#user_template'</span></span>; }</code> </pre> <br><p>  In this case, a selector is specified as the value that refers to the template in the HTML code. </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"user_template"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> &lt;tr&gt; </span><span class="xml"><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag"> </span></span></span><span class="hljs-attr"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">=</span></span></span><span class="hljs-string"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"name"</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span><span class="javascript"> &lt;td </span><span class="hljs-class"><span class="hljs-keyword"><span class="javascript"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span></span><span class="javascript">=</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"email"</span></span></span><span class="javascript">&gt;</span><span class="xml"><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span><span class="javascript"> &lt;td </span><span class="hljs-class"><span class="hljs-keyword"><span class="javascript"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span></span><span class="javascript">=</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"phone"</span></span></span><span class="javascript">&gt;</span><span class="xml"><span class="hljs-tag"><span class="javascript"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="javascript"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span></span><span class="javascript"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span><span class="javascript"> &lt;</span><span class="hljs-regexp"><span class="javascript"><span class="hljs-regexp">/tr&gt; </span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  <em>The itemRenderer property can take other values, including a function or an HTML string.</em> </p><br><p>  And we indicate the value of the <a href="http://ru.matreshka.io/">Model</a> property, defining the class of elements contained in the collection. </p><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">get</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Model</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> User; }</code> </pre> <br><p>  We will create the <code>User</code> class a little later, to begin with, we define the constructor of the newly created collection class. </p><br><pre> <code class="hljs delphi"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constructor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data)</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">{ super(); this .bindNode("sandbox", ".users") .bindNode("container", ":sandbox tbody") .recreate(data); }</span></span></span></span></code> </pre> <br><p>  When creating an instance of a class </p><br><ul><li>  The <code>sandbox</code> property and the <code>'.users'</code> element are <code>'.users'</code> creating a sandbox (the boundaries of the class influence on HTML). </li><li>  The <code>container</code> property and the <code>':sandbox tbody'</code> element <code>':sandbox tbody'</code> , defining an HTML node where the drawn elements of the array will be inserted. </li><li>  Add the transferred data to the array method to <a href="http://ru.matreshka.io/">recreate</a> . </li></ul><br><p>  Fine.  But we are going to use as many ECMAScript 2015 features as possible to improve the code.  Therefore, we will use the <code>super</code> call to populate the array. </p><br><pre> <code class="hljs delphi"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constructor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data)</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">{ super(...data) .bindNode('sandbox', '.users') .bindNode('container', ':sandbox tbody') .rerender(); }</span></span></span></span></code> </pre> <br><ul><li>  Items are added to the collection by calling <code>super</code> (which does the same thing as calling <code>Matreshka.Array.apply(this, data)</code> ). </li><li>  The <code>sandbox</code> property and the <code>'.users'</code> element are <code>'.users'</code> </li><li>  The <code>container</code> property is <code>':sandbox tbody'</code> element <code>':sandbox tbody'</code> </li><li>  The <a href="https://matreshka.io/">rerender</a> method is <a href="https://matreshka.io/">called</a> which <a href="https://matreshka.io/">renders the</a> collection (we have to call it, because we tied a <code>container</code> after we added data). </li></ul><br><p>  Now we declare ‚ÄúModel‚Äù: the <code>User</code> class, which is inherited from the already familiar to us <code>Matreshka.Object</code> . </p><br><pre> <code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Matreshka</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Object</span></span></span><span class="hljs-class"> </span></span>{ constructor(data) { ... } }</code> </pre> <br><p>  Set the data passed to the constructor by the <a href="http://ru.matreshka.io/">setData</a> method, or, as usual, call <code>super</code> . </p><br><pre> <code class="hljs lisp">super(<span class="hljs-name"><span class="hljs-name">data</span></span>)<span class="hljs-comment"><span class="hljs-comment">;</span></span></code> </pre> <br><p>  Then, we wait for the <code>render</code> event, which is triggered when the corresponding HTML element has been created but not yet inserted on the page.  In the handler, we bind the corresponding properties to the corresponding HTML elements.  When the value of the property changes, the <code>innerHTML</code> specified element also changes. </p><br><pre> <code class="hljs actionscript"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.on( <span class="hljs-string"><span class="hljs-string">'render'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> .bindNode({ name: <span class="hljs-string"><span class="hljs-string">':sandbox .name'</span></span>, email: <span class="hljs-string"><span class="hljs-string">':sandbox .email'</span></span>, phone: <span class="hljs-string"><span class="hljs-string">':sandbox .phone'</span></span> }, Matreshka.binders.html()) ; })</code> </pre> <br><p>  It is possible to replace listening to the <code>"render"</code> event by creating a special <code>onRender</code> method (see the <a href="https://ru.matreshka.io/">dock</a> ), but in order not to complicate this example, let‚Äôs leave as follows. </p><br><p>  At the end, create an instance of the <code>Users</code> class, passing the data as an argument. </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> users = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Users(data);</code> </pre> <br><p>  Everything.  When you refresh the page, you will see a table with a list of users. </p><br><p>  <a href="https://matreshkajs.github.io/examples-and-tutorials/matreshka-array/">Demo</a> </p><br><p>  Now open the console and write: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">users</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.push</span></span>({ <span class="hljs-attribute"><span class="hljs-attribute">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Gene L. Bailey'</span></span>, email: <span class="hljs-string"><span class="hljs-string">'bailey@rhyta.com'</span></span>, phone: <span class="hljs-string"><span class="hljs-string">'562-657-0985'</span></span> });</code> </pre> <br><p>  As you can see, a new item has been added to the table.  Now call </p><br><pre> <code class="hljs swift">users.<span class="hljs-built_in"><span class="hljs-built_in">reverse</span></span>();</code> </pre> <br><p>  Or any other array method ( <code>sort</code> , <code>splice</code> , <code>pop</code> ...).  <code>Matreshka.Array</code> , besides its own methods, contains <a href="http://ru.matreshka.io/">all the methods of the standard JavaScript array, without exception</a> .  Then, </p><br><pre> <code class="hljs pgsql">users[<span class="hljs-number"><span class="hljs-number">0</span></span>].name = <span class="hljs-string"><span class="hljs-string">'Vasily Pupkin'</span></span>; users[<span class="hljs-number"><span class="hljs-number">1</span></span>].email = <span class="hljs-string"><span class="hljs-string">'mail@example.com'</span></span></code> </pre> <br><p>  As you can see from the examples, you do not need to manually follow the changes in the collection, the framework itself catches changes to the data and changes the DOM. </p><br><p>  Do not forget that <code>Matreshka.Array</code> supports its own set of events.  You can catch any change in the collection: adding, deleting, re-sorting the elements using the <a href="http://ru.matreshka.io/">on</a> method. </p><br><pre> <code class="hljs pgsql">users.<span class="hljs-keyword"><span class="hljs-keyword">on</span></span>("addone", evt =&gt; { console.log(evt.addedItem.name); }); users.push({ <span class="hljs-type"><span class="hljs-type">name</span></span>: "Clint A. Barnes" });</code> </pre> <br><p>  (will display the name of the added user to the console) </p><br><hr><br><p>  As stated <a href="https://ru.matreshka.io/">in the documentation for itemRenderer,</a> you can define a renderer at the <code>Model</code> class level.  This is the answer to the frequently asked question: why should I define a renderer at the collection level?  Instead of defining an <code>itemRenderer</code> for the <code>Users</code> class, you can define the <code>renderer</code> property for the <code>User</code> class. </p><br><pre> <code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Matreshka</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Object</span></span></span><span class="hljs-class"> </span></span>{ get renderer() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> '#user_template'; } constructor(data) { ... } }</code> </pre> <br><p>  In fact, there are several ways to implement such an application.  It is not necessary to define a <code>Model</code> if the objects in the array have no serious logic.  The application described above can be implemented using one single class. </p><br><pre> <code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Users</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Matreshka</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Array</span></span></span><span class="hljs-class"> </span></span>{ get itemRenderer() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> '#user_template'; } constructor(data) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(...data) .bindNode(<span class="hljs-symbol"><span class="hljs-symbol">'sandbo</span></span>x', '.users') .bindNode(<span class="hljs-symbol"><span class="hljs-symbol">'containe</span></span>r', ':sandbox tbody') .rerender(); } onItemRender(item) { <span class="hljs-comment"><span class="hljs-comment">// item -   ,    Matreshka,    //    bindNode Matreshka.bindNode(item, { name: ':sandbox .name', email: ':sandbox .email', phone: ':sandbox .phone' }, Matreshka.binders.html()); } }</span></span></code> </pre> <br><p>  You can also use the <a href="https://ru.matreshka.io/">parser of banding</a> , which by default is used by the <code>Matreshka.Array</code> class, defining the renderer directly in the class and not adding anything to the HTML. </p><br><pre> <code class="hljs scala"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Users</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Matreshka</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Array</span></span></span><span class="hljs-class"> </span></span>{ get itemRenderer() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ` &lt;tr&gt; &lt;td <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"name"</span></span>&gt;{{name}}&lt;/td&gt; &lt;td <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"email"</span></span>&gt;{{email}}&lt;/td&gt; &lt;td <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"phone"</span></span>&gt;{{phone}}&lt;/td&gt; &lt;/tr&gt;`; } constructor(data) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(...data) .bindNode(<span class="hljs-symbol"><span class="hljs-symbol">'sandbo</span></span>x', '.users') .bindNode(<span class="hljs-symbol"><span class="hljs-symbol">'containe</span></span>r', ':sandbox tbody') .rerender(); } }</code> </pre> <br><p>  Thanks to all those who reported typos on the site.  All good! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/254889/">https://habr.com/ru/post/254889/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254879/index.html">IBM PC do it yourself is easy</a></li>
<li><a href="../254881/index.html">The best icon is text.</a></li>
<li><a href="../254883/index.html">We optimize web form usability</a></li>
<li><a href="../254885/index.html">Description of digital machines on VHDL</a></li>
<li><a href="../254887/index.html">WPF: Using Attached Property and Behavior</a></li>
<li><a href="../254891/index.html">We facilitate the support of iOS applications. Part 2 - location and network</a></li>
<li><a href="../254895/index.html">The taste and color 2 - not RGB one</a></li>
<li><a href="../254897/index.html">Lectures of the Technosphere. 1 semester Algorithms for intelligent processing of large amounts of data</a></li>
<li><a href="../254899/index.html">Encryption in NQ Vault turned out to be an ordinary XOR, and this is not the worst</a></li>
<li><a href="../254901/index.html">Universal Nixie-module on IN-12</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>