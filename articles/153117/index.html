<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Watch DLink IP Camera on iPhone and Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Somehow, the director of a certain organization T wanted to see from the holiday how his salesmen work in his absence. So on the ceiling in the office...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Watch DLink IP Camera on iPhone and Android</h1><div class="post__text post__text-html js-mediator-article"> Somehow, the director of a certain organization T wanted to see from the holiday how his salesmen work in his absence.  So on the ceiling in the office of the sales department appeared IP-camera with a microphone.  Then I, as a techie, had to give the sound + video from the camera to the apple phone and to the tablet from the company, which returns debts with whole trucks of five-cent coins. <br><br>  I have to say, all residents of the office know about the camera with a microphone. <br><a name="habracut"></a><br>  The first solution to this problem was very straightforward: a webcam and Skype, which itself picked up the phone when it called from the director.  The decision did not last long.  Then the camera will ‚Äúfall‚Äù with the eye down, the computer will be ‚Äúforgotten‚Äù to turn on.  And in those rare happy occasions, when you could call all the same, for some reason everyone worked. <br>  The director asked for another solution to the problem that the staff could not influence.  I offered a wi-fi camera, which can be turned off only by turning off the power at the camera or access point or the entire cabinet.  The socket of the camera on the ceiling, you will not turn it off quickly.  Disabling the access point or office is fraught with the failure of all computers.  The decision was supported and paid.  Getting started. <br><br>  The choice of camera somehow immediately limited to the presence on the shelves of the store.  This is the D-Link DCP-2130.  Installation and setup of the camera are simple: installation - electrician, camera - ip-address and password.  The camera is able to give the image via http in mjpeg, but without sound.  Able to give sound + video by <a href="http://ru.wikipedia.org/wiki/RTSP">rtsp</a> ( <code>rtsp://ipcamera/video1.sdp</code> ) <br>  For some reason, not all players are friends with rtsp.  VLC turned out well done and won other colleagues. <br>  The shortcut ‚Äú <code>vlc rtsp://ipcamera/video1.sdp</code> ‚Äù to the director‚Äôs desktop and browsing in the office on the desktop is ready. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But then I had to get a tambourine, because I want to watch a movie with funny people from anywhere. <br>  Path one: forward rtsp on the gateway from an external ip to the camera.  Fail.  And that's why: <br>  1. rtsp does not have any protection in the form of authentication of the beholder and it is forbidden to release this movie outside on the ball.  I wanted to rename <code>video1.sdp</code> to <code>mohqu3iep8Ohh.sdp</code> , but I don‚Äôt remember that, and see p.2 <br>  2. I didn‚Äôt dig much, but I managed to understand that rtsp is hard or even impossible to view on iOS, and not every Android player will master it. <br>  And so, port forwarding outside the camera was dropped. <br><br>  The second way: html5 or flash.  Success, but not all. <br>  I could not find a single flash player that would support rtsp.  HTML5 video does not support streaming at all.  But!  VLC perfectly reads the existing stream, VLC can decode video on the fly, VLC can transmit via HTTP, and even with authentication.  And we have a gateway computer.  We combine the gateway and VLC skills together by a team on the gateway <br><br><pre> <code class="dos hljs">vlc.exe -I dummy rtsp://<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">333</span></span>:<span class="hljs-number"><span class="hljs-number">554</span></span>/live1.sdp --http-reconnect --repeat --rtsp-caching=<span class="hljs-number"><span class="hljs-number">4600</span></span> --loop --sout=#transcode{width=<span class="hljs-number"><span class="hljs-number">320</span></span>,vcodec=h264,vb=<span class="hljs-number"><span class="hljs-number">384</span></span>,fps=<span class="hljs-number"><span class="hljs-number">15</span></span>,venc=x264{aud,profile=baseline,level=<span class="hljs-number"><span class="hljs-number">30</span></span>,keyint=<span class="hljs-number"><span class="hljs-number">30</span></span>,ref=<span class="hljs-number"><span class="hljs-number">1</span></span>},acodec=mp4a,ab=<span class="hljs-number"><span class="hljs-number">64</span></span>,channels=<span class="hljs-number"><span class="hljs-number">1</span></span>,samplerate=<span class="hljs-number"><span class="hljs-number">22050</span></span>,audio-sync}:http{user=camuser,pwd=campass,dst=:<span class="hljs-number"><span class="hljs-number">8080</span></span>/st.flv} --no-sout-rtp-sap --no-sout-standard-sap --ttl=<span class="hljs-number"><span class="hljs-number">1</span></span> --sout-keep</code> </pre><br>  where <code>192.168.0.333</code> are IP cameras, and <code>rtsp://192.168.0.333/live1.sdp</code> is, respectively, a live stream from the camera. <br>  As a result, we obtain that <code><a href="http://camuser/"></a> camuser:campass@gate:8080/st.flv</code>  <code><a href="http://camuser/"></a> camuser:campass@gate:8080/st.flv</code> a converted video stream that is already valid for a flash player.  By the way, it opens with many players on Android, which is good news. <br>  We open port 8080 on the gateway and the access to the outside appears, and, as you may have noticed, having at least some authentication.  Now the flash player as a source can slip our stream in the form <br> <code><a href="http://camuser/"></a> camuser:campass@camera.my-org.ru:8080/st.flv</code> <br>  On the advice of friends, the choice fell on the JW Player.  Its simplicity and performance fully satisfied. <br>  I added a html page with authentication and a flash player, I checked it, it works from computers and from the tablet specified in the beginning of the article.  Now the director from a computer or tablet comes to <br> <code><a href="http://camera.my-org.ru/"></a> camera.my-org.ru</code>  <code><a href="http://camera.my-org.ru/"></a> camera.my-org.ru</code> , enters the name password and looks at how his eagles work, and who just flew on tea. <br><br>  If the same stream is slipped into the html5 player, then nothing will come out, html5 does not want to understand streaming video.  A long game with video / audio formats did not give any results.  But I also want to watch a movie on the phone from one fruit company, and as you know, this very fruit company is your flash on html spit, so I was waiting <br><br>  The third way: Bite off the apple and not die of happiness.  Success. <br>  Googling in Yandex for a long time did not give any results.  Generally no.  I began to doubt my skills in asking the search engines.  I knew for sure that once Apple presentations can be watched live on Apple devices without additional dances, this is possible.  At about the third time to find a solution, I noticed a frequently repeated combination of words, namely <a href="http://en.wikipedia.org/wiki/HTTP_Live_Streaming">HTTP Live Streaming</a> .  I was delighted with Apple‚Äôs decision.  As you know, html5 can only play an existing file.  So that's it, they thought at Apple, and said: ‚Äúlet's imagine that the live stream is pieces of 10 seconds, you just have to finish playing the current piece, immediately start playing the next one‚Äù Super!  It is as ingenious as it is simple.  Everyone is busy with his business.  HTML5 video shows files, he knows how.  Http-server gives files and deals with any load, authorization, etc. It is for this purpose made.  It remains only to slip these 10-second pieces in time.  And there is a solution, and again VLC won.  VLC, like the other members of this bundle, is busy solely with its business - encodes the video.  Run <br><br><pre> <code class="dos hljs">vlc.exe -I dummy --mms-caching <span class="hljs-number"><span class="hljs-number">0</span></span> rtsp://<span class="hljs-number"><span class="hljs-number">192</span></span>.<span class="hljs-number"><span class="hljs-number">168</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">333</span></span>:<span class="hljs-number"><span class="hljs-number">554</span></span>/live1.sdp vlc://quit --sout="#transcode{width=<span class="hljs-number"><span class="hljs-number">320</span></span>,height=<span class="hljs-number"><span class="hljs-number">180</span></span>,fps=<span class="hljs-number"><span class="hljs-number">15</span></span>,vcodec=h264,vb=<span class="hljs-number"><span class="hljs-number">384</span></span>,venc=x264{aud,profile=baseline,level=<span class="hljs-number"><span class="hljs-number">30</span></span>,keyint=<span class="hljs-number"><span class="hljs-number">30</span></span>,ref=<span class="hljs-number"><span class="hljs-number">1</span></span>},acodec=mp3,ab=<span class="hljs-number"><span class="hljs-number">64</span></span>,channels=<span class="hljs-number"><span class="hljs-number">1</span></span>}:std{access=livehttp{seglen=<span class="hljs-number"><span class="hljs-number">10</span></span>,delsegs=true,numsegs=<span class="hljs-number"><span class="hljs-number">5</span></span>,index=c:\www\cam01\istream.m3u8,index-url=http://camera.my-org.ru/cam01/cam01-########.ts},mux=ts{use-key-frames},dst=c:\www\cam01\cam01-########.ts}"</code> </pre><br>  This is what we get: VLC adds the folder <code>c:\www\cam01\  cam01-########.ts</code> and the constantly updated playlist <code>istream.m3u8</code> , which contains links to these files.  Stores 5 fresh video pieces, old deletes. <br>  Actually this playlist and give HTML5 video player on iDevice as a source.  Watch and enjoy streaming video.  This is how simple the HTML file looks: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">center</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">video</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">320</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">180</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">controls</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"controls"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">/cam01/istream.m3u8</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">center</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  We only remember that Apache in .htaccess or configs needs to add new file types <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">AddType</span></span> application/x-mpegURL m3u8 AddType video/MP2T ts</code> </pre><br>  Unfortunately, only iDevice can be used as a source for HTML5 video.  It is a pity that such a great solution disappears. <br><br>  After scratching the ChSV from the work done, I updated the html page a bit.  Now the director comes to the site, logs in, and looks at least from the desktop, at least from Android, at least from iOS. <br><br>  hack: under android there is Puffin Web Browser which can show flash, even if flash is not installed. <br><br>  We add VLC launch to autorun and, perhaps, it‚Äôs done. <br><br>  Observations for the month of flight: <br>  1. The VLC, which encodes the pieces for iOS, works stably for weeks. <br>  2. VLC, which drives the stream for flash, loves to fall after 1-2 days of continuous operation.  Solution - restart every two hours. <br>  3. VLC, which drives the stream for a flash, sometimes loses the video, leaving only the sound on the photo of the black rectangle of not Malevich.  No solution was found, therefore, a restart every two hours, not once a day. <br>  4. The gateway that runs VLC is some kind of early P4 with 1G of RAM, Win2K3.  VLC consumes a little RAM and 50-60% of the processor. </div><p>Source: <a href="https://habr.com/ru/post/153117/">https://habr.com/ru/post/153117/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../153103/index.html">Create responsive website navigation</a></li>
<li><a href="../153105/index.html">Opera 12.10 beta - API for every taste</a></li>
<li><a href="../153109/index.html">Local Binary Patterns operator in the texture classification task</a></li>
<li><a href="../153113/index.html">I am a SysAdmin - or personal experience and the introduction of open source software in the corporate environment</a></li>
<li><a href="../153115/index.html">Problem on the topic of numbers</a></li>
<li><a href="../153119/index.html">JavaScript is BASIC today! (In a good way.)</a></li>
<li><a href="../153121/index.html">A quick note about feature detection</a></li>
<li><a href="../153123/index.html">Habr-lance</a></li>
<li><a href="../153125/index.html">DIY digital tachometer on AVR ATtiny2313, KR514ID2 and optocoupler</a></li>
<li><a href="../153127/index.html">TypeScript: static analysis, autocompletion and a little ES6 for JavaScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>