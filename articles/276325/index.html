<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Attackers use Gcat backdoor for cyber attacks on Ukrainian energy companies</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Earlier we described the details of malicious campaigns that were directed against such enterprises in the west of Ukraine [ 1 , 2 ]. In these cyber a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Attackers use Gcat backdoor for cyber attacks on Ukrainian energy companies</h1><div class="post__text post__text-html js-mediator-article">  Earlier we described the details of malicious campaigns that were directed against such enterprises in the west of Ukraine [ <a href="https://habrahabr.ru/company/eset/blog/274469/">1</a> , <a href="https://habrahabr.ru/company/eset/blog/274503/">2</a> ].  In these cyber attacks, the attackers used the BlackEnergy Trojan and a special KillDisk component to disable compromised systems.  They also resorted to using the <b>Win32 / SSHBearDoor.A backdoor</b> to manage such systems via SSH. <br><br><img src="https://habrastorage.org/files/5c5/d0e/730/5c5d0e73025846379a75bf16725210b1.jpg"><br><br>  On January 19, we managed to fix new cyber attacks on the energy companies of Ukraine.  Several such companies specializing in the supply of electricity, were attacked again, after a series of previous cyber attacks and power outages in December. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  The cyber attack scenario is very similar to past BlackEnergy incidents and has not undergone significant changes.  Attackers use a phishing e-mail message that is sent to the victim‚Äôs address and contains a malicious .xls file as an attachment. <br><br><img src="https://habrastorage.org/files/ea2/b4f/71f/ea2b4f71f3aa4f18b61ae782b959c581.png"><br>  Fig.  Phishing email that was used for a malicious campaign. <br><br>  A phishing message or letter contains data in HTML format with a link to the .PNG file located on the remote server, so the attackers implement a notification mechanism for the delivery of the content to the intended victim.  A similar mechanism was used in past cyber attacks using BlackEnergy. <br><br><img src="https://habrastorage.org/files/d0b/bf7/74a/d0bbf774ac044335b33f88e435632d34.png"><br>  Fig.  An HTML data section with the address of a PNG file on a remote server. <br><br>  The name of this PNG file is the base64-coded string " <i>mail_victim's_email</i> ". <br><br><img src="https://habrastorage.org/files/bcd/4db/427/bcd4db42774a45e19ce1e1ce12398e53.png"><br>  Fig.  The appearance of the so-called decoy-document (bait). <br><br>  The bait document above contains a malicious macro that is similar to the BlackEnergy used in past cyber attacks.  Using social engineering techniques, the macro attempts to deceive the victim by sabotaging her in ignoring the Microsoft Office Security Warning security message.  The text of the message in Ukrainian translation sounds like: " <i>Attention! This document was created in a newer version of Microsoft Office. The macros it contains are needed to display the contents of the document.</i> " <br><br>  Successful execution of the macro leads to the launch of malware, which is a downloader or downloader.  He is trying to download the payload from the remote server and execute it. <br><br><img src="https://habrastorage.org/files/f8f/b9e/010/f8fb9e0107c54d9db9c25c8ec9ee1621.png"><br>  Fig.  Part loader code. <br><br>  The downloadable payload is located on a server from Ukraine.  The server was dismantled after our appeal to the CERT-UA and CyS-CERT organization. <br><br>  We expected to see the BlackEnergy Trojan as the payload of the loader, however, this time for cyber attacks, the attackers chose another malicious program.  They used a modified version of the open source backdoor called <a href="https://github.com/byt3bl33d3r/gcat">gcat</a> , which is written in the well-known scripting language Python.  The source code of the backdoor was compiled into an executable file using the <a href="http://www.pyinstaller.org/">PyInstaller</a> tool. <br><br><img src="https://habrastorage.org/files/38e/a34/1fc/38ea341fc8f14a8aaa0938952f94188e.png"><br>  Fig.  Obfuscated GCat backdoor source code. <br><br>  The backdoor specializes in loading other executable files into the compromised system and executing commands of the command line interpreter (shell).  Other functions of the backdoor, such as creating screenshots, capturing keystrokes of the keyboard (keylogger), sending files to a remote server, have been removed from it.  The backdoor was managed by attackers using a Gmail account, which complicates the detection of its malicious traffic on the network. <br><br>  ESET anti-virus products detect threat files as: <br><br>  <b>VBA / TrojanDropper.Agent.EY</b> <b><br></b>  <b>Win32 / TrojanDownloader.Agent.CBC</b> <b><br></b>  <b>Python / Agent.N</b> <br><br>  <b>Conclusion</b> <br><br>  Our research on the above cyber attacks and published material has received widespread media attention.  This was due to two reasons. <br><br><ul><li>  Most likely, this is the first successful case of using cyber attacks for the purpose of massive power outages. </li><li>  Based on the opinions of some security companies, many well-known media have pointed to Russia as the source of such state-sponsored cyber attacks (cyber group BlackEnergy aka Sandworm, aka Quedagh). </li></ul><br>  The first point served as a starting point for various <a href="https://ics.sans.org/blog/2016/01/09/confirmation-of-a-coordinated-attack-on-the-ukrainian-power-grid">debates</a> about whether the power outage was a direct effect of a malicious program or if it simply provided remote access to the attackers who performed the necessary operations with their own hands.  Although there are obvious technical differences in both methods of sabotage, the result of their activity boils down to one. <br><br>  The second point is even more controversial.  As we have indicated earlier, imposing responsibility for conducting a cyber attack on a particular state or cyber group can only be done if there is indisputable evidence from which to draw such a conclusion.  Currently, we have no evidence that would indicate who is behind them.  Obviously, an attempt to link these cyber attacks to the current political situation may lead us to the wrong conclusions. <br><br>  <b>Indicators of compromise</b> <br><br>  IP addresses: <br>  193.239.152.131 <br>  62.210.83.213 <br><br>  SHA-1 malicious XLS file identifier: <br>  1DD4241835BD741F8D40BE63CA14E38BBDB0A816 <br><br>  Malicious executables SHA-1 identifiers: <br>  920EB07BC8321EC6DE67D02236CF1C56A90FEA7D <br>  BC63A99F494DE6731B7F08DD729B355341F6BF3D </div><p>Source: <a href="https://habr.com/ru/post/276325/">https://habr.com/ru/post/276325/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../276315/index.html">XAML Developer Chips: Conditional Converter</a></li>
<li><a href="../276317/index.html">I'm not smart, I just sat on it longer than you</a></li>
<li><a href="../276319/index.html">Quick installation of SSL certificate from StartSSL in iRedMail mail server</a></li>
<li><a href="../276321/index.html">Multiprocess Firefox 44.b, Electrolysis Optimization</a></li>
<li><a href="../276323/index.html">Migrate NAS from vfiler NetApp to EMC VNX</a></li>
<li><a href="../276327/index.html">Linux kernel support 2.6.32 LTS ends in February</a></li>
<li><a href="../276329/index.html">Quantum morris</a></li>
<li><a href="../276331/index.html">Add range operator in PHP</a></li>
<li><a href="../276333/index.html">Using or Using?</a></li>
<li><a href="../276335/index.html">HPE Aruba - Corporate-grade Wi-Fi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>