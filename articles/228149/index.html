<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Office 365 Cloud Business Apps</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous section, we looked at creating apps for SharePoint Online using the built-in NAPA tool. In this article we will give a brief overview ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Office 365 Cloud Business Apps</h1><div class="post__text post__text-html js-mediator-article"> In the <a href="http://habrahabr.ru/company/microsoft/blog/218347/">previous section,</a> we looked at creating apps for SharePoint Online using the built-in NAPA tool.  In this article we will give a brief overview of another simple method - the O365 Cloud Business App project (also known as LightSwitch for SharePoint). <br><a name="habracut"></a><br>  The LightSwitch development project, which appeared 3 years ago as part of Visual Studio, is aimed at quickly creating relatively simple applications using a predetermined scheme, which is a fairly common approach when programming most common business tasks.  First, data sources are defined (SQL Server Express is used as the default source, although data can be taken from many places, including, for example, SQL Azure or the same SharePoint).  The business logic for handling data is written using WCF and the Entity Framework.  Graphic designers of entities, relationships between them, up to the visual design of requests, are widely used.  In the next step, screen forms are designed to display the data.  Initially, the client side was focused on Silverlight, regardless of whether the thick or browser (read IE) client version was developed.  Starting from VS2012, LightSwitch <a href="http://www.eweek.com/developer/slideshows/microsoft-lightswitch-turns-on-the-power-of-rapid-app-development/">supports</a> HTML5 / JavaScript client-side development, including the client for the Windows 8 Modern UI.  Also, C # and VB.NET are supported as a customization language for business logic, although, as they say in beautiful glossy flyers, LightSwitch is focused on solving tasks without writing any code manually, including non-professional users. by programmers.  In the leaflets, of course, they write the truth.  You just need to understand that in real life, life is not so glossy, and there are enough roughnesses in it, and on the contrary, miracles happen very little.  In an amicable way, you still have to write the code.  The value of LightSwitch is that, first, the code, as a rule, is required, really, a little, because it assumes the basic infrastructure binding and docking of components;  secondly, for simple projects, it allows you to save effort by concentrating on the overall picture and business issues, which usually tends to slip away when you get stuck in coding. <br><br>  O365 Cloud Business App - the same LightSwitch, but applied to SharePoint.  By its nature, this is a typical App for SharePoint (a new type of application, which appeared in SPS 2013, for more details, see the <a href="http://habrahabr.ru/company/microsoft/blog/218347/">previous article</a> ), where the client part is the LightSwitch HTML5 Client, and the business logic will be concentrated in the SharePoint components.  Let's create a new project in Visual Studio: open templates for Visual C # (or Visual Basic), open the Office / SharePoint group, see three project templates in it: App for Office 2013, App for SharePoint 2013 and Cloud Business App, and click on it .  You will immediately be prompted to specify a SharePoint site.  In the course of the previous exercises, we created the Office365 Developer site, and I will point it out: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c9b/580/842/c9b580842438847e5531a8d3e4894998.png" width="500"><br>  Pic1 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      An empty project opens in which you can immediately see three characteristic blanks corresponding to the three levels of the LightSwitch application.  In general, a typical business application, I would say.  These are the data level (2), the business logic level (3) and the display level (1).  Tsiferki - this is how they go to Solution Explorer.  There is also a 0th project, which is a common manifesto for any App for SharePoint. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/089/d6c/089/089d6c089d70b7fb65c4a8f72e0bfe61.png" width="650"><br>  Pic2 <br><br>  Please note that, unlike App for SharePoint, we were not asked where we want to be hosted.  The Cloud Business App is always created as povider-hosted.  Open the manifest to verify this. <br><br>  Consider how to integrate an existing solution into O365, and also add some SharePoint functionality to it. I have some conditional application that symbolizes the work of the support center, where each employee has a list of incidents that he leads, each with its own status.  At the moment, this is a regular LightSwitch application without any SharePoint functionality.  What was the matter?  Add SharePoint integration to it: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6a7/ad2/cf9/6a7ad2cf9284f5321c15185db1cfb5b1.png" width="300"><br>  Pic.3 <br><br>  We start the decision.  It is successfully installed on SharePoint: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/632/244/5d0/6322445d018fc1aa3e0c4ec1d294c18e.png" width="600"><br>  Pic.4 <br><br>  And indeed, now you can see it on our portal: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d9f/42b/0e5/d9f42b0e56cedc4e2833cc9163c19452.png" width="600"><br>  Pic.5 <br><br>  The application uses its own database, inherited from the original LightSwitch project.  To mark the achieved integration with SharePoint, let's add a data source list.  Now there will be little text and even less code, but many pictures, because the Cloud Business App, as we remember, allows an inexperienced user in programming to achieve a meaningful business application by minimal coding.  Add a new SharePoint data source to the server component of the application: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/503/287/c0d/503287c0d18e61f2665420d88b6bb7a8.png" width="300"><img src="https://habrastorage.org/getpro/habr/post_images/195/c09/f84/195c09f84fdbd673495da836675ea816.png" width="400"><br>  Pic.6 <br><br>  We say that SharePoint will be the same and specify the desired list among the artifacts.  We started this list in the previous section, when we created the NAPA application. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dc6/689/2b1/dc66892b1371c3516f2421b16c784734.png" width="330"><img src="https://habrastorage.org/getpro/habr/post_images/d80/b35/327/d80b35327e96a43c62190d1e90fff343.png" width="370"><br>  Fig.7 <br><br>  I forgot to say that our application uses SharePoint authentication to control access, as can be seen in the properties of a web project.  It turned on automatically when we deactivated it for SharePoint (Figure 3). <br><br>  So, employees are stored in a DB on a SQL Server, incidents - in the SharePoint list.  Create a link between two data sources to bind incidents to an employee.  The key field for the connection is the employee's email address, which, of course, is wrong from the point of view of relational theory, but will come down as an illustration of the idea. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/71c/606/60d/71c60660dd8ae10d89d6666e3996621c.png" width="500"><br>  Fig.8 <br><br>  Now you need to change the UI to show incidents.  We go to the client project of the solution and slightly modify the ViewEmployeeDetails screen form by adding to it a display of data from the Issues source related to the current employee based on the link constructed above. <br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/df2/76f/64d/df276f64db1deaf0c6e373d0e06784e2.png" width="700"><br>  Fig.9 <br><br>  Add a new group's Layout to Tabs: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/098/267/b41/098267b4163653a78d74482e3f9dca19.png" width="450"><br>  Pic.10 <br><br>  Add Issues to a new group: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/213/3b0/89f/2133b089fd3cd9b7ecfaf730a5c39557.png" width="400"><img src="https://habrastorage.org/getpro/habr/post_images/3fa/c21/f1b/3fac21f1b8b9c93ad0023630e7e1e65d.png" width="300"><br>  Figure 11 <br><br>  Then select the Columns Layout and delete the extra fields: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4d2/424/dec/4d2424dec132ca41cfb919995dca0a38.png" width="350"><br>  Fig.12 <br><br>  Add a new screen to edit incidents.  You can see that in the properties of the List node (F4), as an action, when pressed it now stands None. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b6b/0e5/ae4/b6b0e5ae432e0ffab33fd1acc085909e.png" width="450"><br>  Fig.13 <br><br>  Click on None and select Choose an Executing Method = Issues -&gt; editSelected, Navigate To = (New Screen ...) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7aa/678/a4d/7aa678a4dce7586598c32abced9fce11.png" width="350"><img src="https://habrastorage.org/getpro/habr/post_images/75f/f50/389/75ff503891392048d5e9f552c88daf34.png" width="350"><br>  Fig.14 <br><br>  Edit the screen, removing the extra fields: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d96/fe9/6a0/d96fe96a07d0a427e7564d895f6c0634.png" width="350"><img src="https://habrastorage.org/getpro/habr/post_images/eef/a2d/c5d/eefa2dc5d82d7005b9cccfcffaf92f71.png" width="350"><br>  Fig.15 <br><br>  Run the application.  We see that the new Tab-group is now displayed on the form.  We fall into it and get a list of incidents, followed by the selected employee, as we filled it in Figure 8 of the <a href="http://habrahabr.ru/company/microsoft/blog/218347/">previous article</a> .  A somewhat peculiar list of incidents, but in general, I hope, is understandable. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0b8/af9/464/0b8af9464f0e732ec7fb3a24790e90a9.png" width="400"><img src="https://habrastorage.org/getpro/habr/post_images/148/017/a1e/148017a1ef57b947cba9889822bb31b7.png" width="300"><br>  Figure 16 <br><br>  I tried to fulfill the advertising slogan and do without a single line of code.  In fact, coming up formally, the custom code was present even in this simple solution, for example, to display the current user name in the top line: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/739/aa8/965/739aa8965d69c0fd9cc8538a590ba4a3.png" width="200"><img src="https://habrastorage.org/getpro/habr/post_images/24e/63b/28f/24e63b28fa0cf05f2f3b1e4b50d761f8.png" width="500"><br>  Pic.17 <br><br>  However, the minimum coding, as you understand, does not negate the convenience of the O365 Cloud Business App as a tool for the rapid development of typical simple business applications using portal technologies. </div><p>Source: <a href="https://habr.com/ru/post/228149/">https://habr.com/ru/post/228149/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../228137/index.html">Charles Herzfield: Director of DARPA and the Godfather of ARPANET</a></li>
<li><a href="../228139/index.html">How we stopped being afraid of Ogre and started making a game on it</a></li>
<li><a href="../228141/index.html">Mojolicious Documentation: Lost Chapters</a></li>
<li><a href="../228145/index.html">Bare Fridays # 1</a></li>
<li><a href="../228147/index.html">How to make money on an indie game</a></li>
<li><a href="../228151/index.html">My implementation of "smart home"</a></li>
<li><a href="../228157/index.html">Functional and economic comparison of Russian cloud service providers. Version 2.0</a></li>
<li><a href="../228159/index.html">Power sources</a></li>
<li><a href="../228163/index.html">How to ease the pain of payment. 7 studies on the psychology of finance</a></li>
<li><a href="../228169/index.html">ReadyScript - our look at CMS for online stores</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>