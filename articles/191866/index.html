<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Electronic signature formats</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article is devoted to the review of CMS (Cryptographic Message Syntax) standards for signed messages. 

 What is CMS for? 
 The CMS standard descr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Electronic signature formats</h1><div class="post__text post__text-html js-mediator-article">  The article is devoted to the review of CMS (Cryptographic Message Syntax) standards for signed messages. <br><br><h2>  What is CMS for? </h2><br>  The CMS standard describes the structure of cryptographic messages, which include protected data along with the information necessary for their correct discovery or use.  For example, the message contains protected data, information about the hashing algorithm and signature, signature time, public key certificate, certification chain, etc.  Some of these attributes are optional, but the application itself can determine the need for them.  Each algorithm has a set of parameters that must be matched on both sides: for GOST 34.10-2001, in addition to the public key, it is the modulus <i>p</i> , the coefficients of the elliptic curve <i>a</i> and <i>b,</i> and the order of the cyclic subgroup of points of the elliptic curve <i>q</i> .  And all this needs to be somehow conveyed to the addressee of the message. <br><a name="habracut"></a><br>  RSA Laboratories, in a series of its public key cryptography standards (PKCS), proposed a solution to this problem by defining the syntax for protected messages in the following standards: <br><ul><li>  <a href="http://www.emc.com/emc-plus/rsa-labs/standards-initiatives/pkcs-7-cryptographic-message-syntax-standar.htm">PKCS # 7 Cryptographic Message Syntax Standard</a> , </li><li>  <a href="http://www.emc.com/emc-plus/rsa-labs/standards-initiatives/pkcs10-certification-request-syntax-standard.htm">PKCS # 10 "Certificate Request Syntax Standard"</a> . </li></ul><br>  The development of these standards has become the CMS standard.  CMS, in addition to the <s>specific title of the article</s> , also supports encryption, hashing, and calculation of imitations, including Russian algorithms ( <a href="http://tools.ietf.org/html/rfc4490">RFC 4490</a> ), as well as multiple encapsulation.  The latter means that the message of the CMS format may lie within another CMS message. <br><br>  In total, the CMS supports six data types: <br><ul><li>  just data </li><li>  signed data (signed data) </li><li>  packed data (enveloped data), </li><li>  hashed data (digested data) </li><li>  encrypted data </li><li>  authenticated data. </li></ul><br>  Within the framework of the article we will consider in detail only data with an electronic signature (signed data). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In order not to be confused in terminology, the source data, which we want to transmit in a secure way, will be called <b>data</b> , and the resulting secure CMS <b>message will</b> simply be a <b>message</b> . <br><br><h2>  CMS Standard (PKCS # 7 and RFC 5652): Theory </h2><br><h3>  A bit of history </h3><br>  The cryptographic message syntax (CMS) was first defined in <a href="http://www.emc.com/emc-plus/rsa-labs/standards-initiatives/pkcs-7-cryptographic-message-syntax-standar.htm">PKCS # 7</a> , which was later published as a recommendation of <a href="http://tools.ietf.org/html/rfc2315">RFC 2315 "PKCS # 7: Cryptographic Message Syntax Version 1.5"</a> .  After a few more versions of the RFC in September 2009, <a href="http://tools.ietf.org/html/rfc5652">RFC 5652 ‚ÄúCryptographic Message Syntax (CMS)‚Äù</a> was adopted, which is the current standard. <br>  Under the spoiler is illustrated the hard fate of the standard. <br><div class="spoiler">  <b class="spoiler_title">Watch</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/storage3/801/6c3/ba9/8016c3ba93bab74d113993ef5ae69e7e.jpg"></div><br>  PKCS # 7 / CMS Evolution </div></div><br><br><h3>  Signature in CMS format (signed data type) </h3><br>  The signature described by the CMS standard is characterized by the following features: <br><ol><li>  Data can be signed by several parties (multiple signature).  In this case, the message will contain several SignerInfo structures with information about signatories: the value of the signature and the information necessary for verifying its authenticity. </li><li>  The data type is not regulated in any way, it only clarifies that a CMS format message can be used as data, that is, a message signed by Alice can be entirely signed by Bob. </li><li>  It is possible to sign not only data, but also some attributes of the message - message hash (digest message), signing time (the signing time), the value of another signature (countersignature). </li><li>  The signer's public key may be uncertified. </li><li>  The signature may be absent altogether. </li></ol><br>  Electronic signature data is not only used to sign content and is often used to distribute certificates and Certificate Revocation Lists (CRLs).  In this case, the signed data is missing, and the fields Certificates and CRLs, on the contrary, are present. <br><br>  A message signed by Alice in the CMS format will look like the following (optional attributes are grayed out): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage3/2c7/6f0/1c0/2c76f01c04dc7c79a2a632f468350599.jpg"></div><br><ul><li>  Version of CMS Version syntax depends on certificates, type of data to be signed and information about signers </li><li>  Digest Algorithms includes identifiers of the hashing algorithms used and their associated parameters. </li><li>  Encapsulated Content contains the data to be signed (Content) along with their Type (Content Type).  Content may be missing, type is not. </li><li>  Certificates is intended for a chain of certificates reflecting the certification path from the certification authority that issued the certificate to each of the signatories.  Certificates of signatories may also be present. </li><li>  CRLs (Certificate Revocation List) provides certificate revocation status information sufficient to determine the validity of the signer's certificate. </li><li>  Information about each signer is contained in the structures of the Signer Info type, which can be any number, including zero (in the case of no signature). <br><ul><li>  The CMS Version syntax version is determined by the Signer ID value. </li><li>  The Signer ID identifies the signer's public key (subjectKeyIdentifier) ‚Äã‚Äãor its public key certificate, which is required for signature verification (issuerAndSerialNumber). </li><li>  Digest Algorithm defines the hashing algorithm and all associated parameters used by the signer. </li><li>  Attributes that require a signature are placed in Signed Attributes.  The field can be absent only when signing simple data (Content Type = id-data), when signing other data (for example, Content Type = id-SignedData) must be present with at least two mandatory attributes - the type (Content Type) and the data hash (Message Digest). </li><li>  The Signature Algorithm contains the signature algorithm identifier along with its parameters. </li><li>  The Signature Value contains the value of the private key-signed hash of the data (Content) and Signature Attributes. </li><li>  In Unsigned Attributes, the remaining attributes that do not require a signature are placed. </li></ul></li></ul><br>  If Bob decides to fully sign the message from Alice, then the encapsulation mechanism is used, and the message will look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage3/84f/419/3fa/84f4193fafcfaba7a1917939c533ea6f.jpg"></div><br>  CMS offers two interesting attributes that extend the capabilities of a regular signature: Signing Time and Countersignature.  The first attribute defines the estimated time of the signature, and the second is intended to sign another signature (the hash of the signature value is signed).  The Countersignature attribute is a Signer Info structure with the Content Type attribute missing in Signed Attributes and the Message Digest attribute that is necessarily present.  The Countersignature attribute can have its own Countersignature attribute. <br><br>  If Bob decides to sign only the data transmitted by Alice, and at the same time sign Alice's signature, the message will look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage3/b7c/4e8/1ae/b7c4e81aeafe8329cfb159f9234d90e1.jpg"></div><br><h3>  Galloping <s>Europe for the</s> remaining types </h3><br>  CMS offers some more interesting types of messages not covered by the topic of this article.  Therefore, literally a couple of words about the remaining types for the overall picture. <br>  Enveloped data is encrypted data, along with keys encrypted for one or more recipients, with which the data was encrypted.  The combination of an encrypted message with one encrypted encryption key for one recipient is called a digital envelope.  This type is used as an envelope with (signed) data for one or several recipients. <br>  Hash data (data with its own hash) is used to check the integrity of the message and is often the contents of the packed data. <br>  Encrypted data is often used to encrypt data for local storage, sometimes with an encryption key generated from a password. <br>  The data from the authenticated source (authenticated data) includes the data along with its MAC code and encrypted authentication keys for one or more recipients.  Used to protect the integrity of messages for an unlimited number of recipients. <br><br>  In the next article we will focus on messages like enveloped data using Russian cryptoalgorithms. <br><br><h3>  CMS in real life </h3><br>  The CMS standard has many incarnations in the modern IT world - it is based on: <br><ul><li>  S / MIME Secure Email Standard ( <a href="http://tools.ietf.org/html/rfc3851">RFC 3851</a> ), </li><li>  Advanced security services for S / MIME ( <a href="http://tools.ietf.org/html/rfc2634">RFC 2634</a> , by the way, here are described the additional attributes of CMS and the technology of triple "wrapping" based on multiple encapsulation: the data is signed, then encrypted and signed again), </li><li>  Extended formats for presenting information about revoked certificates ( <a href="http://www.rfc-editor.org/rfc/rfc5940.txt">RFC 5940</a> ), etc. </li></ul><br>  The logical development of CMS ideas for messages with electronic signature has become CAdES (CMS Advanced Electronic Signature), an advanced standard of signed CMS messages, which will also be the subject of another of our articles. <br><br><h2>  How to put into practice? </h2><br>  The CMS / PKCS # 7 standard with the support of Russian cryptoalgorithms is implemented in certified partners of our partners: <br><ul><li>  <a href="http://www.cryptopro.ru/products/csp">CryptoPro CSP</a> Company Crypto Pro </li><li>  Infotex <a href="http://www.infotecs.ru/products/catalog.php%3FSECTION_ID%3D%26ELEMENT_ID%3D2096">VipNet CSP</a> </li><li>  <a href="http://signal-com.ru/ru/prod/crypt/signal_com/">SignalKom CSP</a> or <a href="http://signal-com.ru/ru/prod/crypt/message_pro/">Message-PRO</a> company SignalCom, etc. </li></ul><br>  In addition, the CMS standard with Russian cryptography is implemented in the Open Source application OpenSSL. <br><br>  Our company supported CMS with Russian cryptography in the product <a href="http://www.rutoken.ru/products/all/rutoken-plugin/">Rutoken Plugin</a> .  The Rutoken Plugin is designed for use in browsers, all cryptographic operations are performed in hardware, on board a USB token. </div><p>Source: <a href="https://habr.com/ru/post/191866/">https://habr.com/ru/post/191866/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../191856/index.html">Is cloudy IP PBX suitable for small companies?</a></li>
<li><a href="../191858/index.html">Another JavaScript preprocessor</a></li>
<li><a href="../191860/index.html">The attacker got caught selling root accesses to supercomputers</a></li>
<li><a href="../191862/index.html">A little bit about how we wrote a photo mosaic generator for Android</a></li>
<li><a href="../191864/index.html">The use of IT in the search for new drugs: an overview of areas</a></li>
<li><a href="../191868/index.html">File Monitoring with GCD</a></li>
<li><a href="../191870/index.html">Execution of an external file from an Oracle database in order to obtain information about disk space</a></li>
<li><a href="../191872/index.html">Regional market of Internet advertising and sites. And how are you?</a></li>
<li><a href="../191874/index.html">PPTP vs L2TP vs OpenVPN vs SSTP</a></li>
<li><a href="../191876/index.html">Choosing a budget UPS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>