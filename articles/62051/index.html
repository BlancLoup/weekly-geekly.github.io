<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using Direct3D with Qt</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One day, I had the need to use Direct3D with Qt. After several days of searching the Internet, I found just some scraps of information. There was no c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using Direct3D with Qt</h1><div class="post__text post__text-html js-mediator-article">  One day, I had the need to use Direct3D with Qt.  After several days of searching the Internet, I found just some scraps of information.  There was no complete description of the mechanism for using Direct3D anywhere.  As a result, after much research, I achieved what I wanted :) <br>  Under the cat there is an instruction ‚Äúapproaching‚Äú Direct3D and Qt, as well as a widget code that can be used as is <br><a name="habracut"></a><br>  When writing this article, the following tools were used: <br><ol><li>  Qt 4.5.0 </li><li>  VS2008 SP1 </li><li>  DirectX SDK August 2008 </li></ol><br>  If you use another.  IDE, the assembly time will be slightly different.  I give an example of the assembly, only for VS2008.  If you are sure that your build has direct3d engine support, then skip the Qt configuration and build step. <br><br><h4>  Qt configuration and build </h4><br><ul><li>  The first step is to set up environment variables for DirectX, for this we run the following command in the console: <br>  &gt; <b>"% DXSDK_DIR% \ Utilities \ Bin \ dx_setenv.cmd‚Äú</b> </li><li><br>  Go to the Qt directory and configure it.  In my case, it looked like this&gt; <b>configure -direct3d -platform win32-msvc2008</b> <br>  <b>-direct3d</b> can be omitted, this parameter must be calculated by the configurator. <br>  If everything went well, then the configurator's output will appear: <b>Direct3D support ... yes</b> <br><br></li><li>  We do nmake, and if there are no problems, then we wait for the end of the assembly.  I ran into a problem, during the build there was an unresolved external Direct3D related error.  To fix it, go to <b>% QTDIR% \ src \ gui \</b> and in both Makefiles (release and debug) change dxguid.lib to <b>"% DXSDK_DIR% \ Lib \ x86 \ dxguid.lib"</b> (or x64, depending on , under what platform you are collecting). After this, the problem should disappear, so we wait until the end of the assembly. </li></ul><br><h4>  Widget code </h4><br>  <b>Direct3DWidget.h</b> <br><blockquote><ol><li> <code><font color="black"><font color="#006E28">#ifndef DIRECT3DWIDGET_H <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></font></code> </li> <li> <code><font color="black"><font color="#006E28"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> #define DIRECT3DWIDGET_H <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></font></code> </li> <li></li><li> <code><font color="black"><font color="#006E28"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> #include &lt;QtGui/QWidget&gt; <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></font></code> </li> <li> <code><font color="black"><font color="#006E28"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> #include &lt;d3d9.h&gt; <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></font></code> </li> <li> <code><font color="black"><font color="#006E28"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> #include &lt;atlbase.h&gt; <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></font></code> </li> <li></li><li> <code><font color="black"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></code> </li> <li> <code><font color="black"><font color="#006E28"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> { <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></font></code> </li> <li> <code><font color="black"><font color="#0057AE"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> Q_OBJECT CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></font></code> </li> <li></li><li> <code><font color="black"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></code> </li> <li> <code><font color="black"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></code> </li> <li> <code><font color="black"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></code> </li> <li> <code><font color="black"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></code> </li> <li> <code><font color="black"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></code> </li> <li> <code><font color="black"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></code> </li> <li> <code><font color="black"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></code> </li> <li> <code><font color="black"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></code> </li> <li> <code><font color="black"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></code> </li> <li> <code><font color="black"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></code> </li> <li> <code><font color="black"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> <font color="#006E28">#endif</font></font></code> </li> <li></li><li> <code><font color="black"><font color="#006E28"><font color="#006E28">#ifndef DIRECT3DWIDGET_H</font> <font color="#006E28">#define DIRECT3DWIDGET_H</font> <font color="#006E28">#include &lt;QtGui/QWidget&gt;</font> <font color="#006E28">#include &lt;d3d9.h&gt;</font> <font color="#006E28">#include &lt;atlbase.h&gt;</font> <font color="#0057AE">class</font> Direct3DWidget <font color="#006E28">:</font> <font color="#0057AE">public</font> <font color="#22aadd">QWidget</font> <font color="#006E28">{</font> <font color="#0057AE">Q_OBJECT</font> CComPtr <font color="#006E28">&lt;</font> IDirect3D9 <font color="#006E28">&gt;</font> m_pD3D <font color="#006E28">;</font> CComPtr <font color="#006E28">&lt;</font> IDirect3DDevice9 <font color="#006E28">&gt;</font> m_pd3dDevice <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#006E28">:</font> Direct3DWidget <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> ~Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">bool</font> InitDirect3D <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">public</font> <font color="#0057AE">slots</font> <font color="#006E28">:</font> <font color="#0057AE">bool</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#0057AE">private</font> <font color="#006E28">:</font> <font color="#0057AE">void</font> paintEvent <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> <font color="#006E28">}</font> <font color="#006E28">;</font> #endif</font></font></code> </li> </ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </blockquote><br><br>  <b>Direct3DWidget.cpp</b> <br><blockquote><ol><li>  <font color="#006E28">#include "Direct3DWidget.h"</font> </li><li></li><li>  Direct3DWidget <font color="#006E28">::</font> <font color="#2B74C7">Direct3DWidget</font> <font color="#006E28">(</font> <font color="#22aadd">QWidget</font> <font color="#006E28">*</font> parent <font color="#888888"><i>/ * = 0 * /</i></font> <font color="#006E28">)</font> <font color="#006E28">:</font> <font color="#22aadd">QWidget</font> <font color="#006E28">(</font> parent <font color="#006E28">)</font> </li><li>  <font color="#006E28">{</font> </li><li>  setAttribute <font color="#006E28">(</font> Qt <font color="#006E28">::</font> <font color="#2B74C7">WA_PaintOnScreen</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#006E28">}</font> </li><li>  Direct3DWidget <font color="#006E28">::</font> <font color="#2B74C7">~ Direct3DWidget</font> <font color="#006E28">(</font> <font color="#006E28">)</font> </li><li>  <font color="#006E28">{</font> </li><li>  <font color="#006E28">}</font> </li><li>  <font color="#0057AE">bool</font> Direct3DWidget <font color="#006E28">::</font> <font color="#2B74C7">InitDirect3D</font> <font color="#006E28">(</font> <font color="#006E28">)</font> </li><li>  <font color="#006E28">{</font> </li><li>  m_pD3D <font color="#006E28">=</font> Direct3DCreate9 <font color="#006E28">(</font> D3D_SDK_VERSION <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#000000"><b>if</b></font> <font color="#006E28">(</font> <font color="#006E28">!</font> m_pD3D <font color="#006E28">)</font> </li><li>  <font color="#000000"><b>return</b></font> false <font color="#006E28">;</font> </li><li>  D3DPRESENT_PARAMETERS d3dpp <font color="#006E28">=</font> <font color="#006E28">{</font> <font color="#B08000">0</font> <font color="#006E28">}</font> <font color="#006E28">;</font> </li><li>  d3dpp.  <font color="#2B74C7">Windowed</font> <font color="#006E28">=</font> TRUE <font color="#006E28">;</font> </li><li>  d3dpp.  <font color="#2B74C7">SwapEffect</font> <font color="#006E28">=</font> D3DSWAPEFFECT_DISCARD <font color="#006E28">;</font> </li><li>  d3dpp.  <font color="#2B74C7">BackBufferFormat</font> <font color="#006E28">=</font> D3DFMT_UNKNOWN <font color="#006E28">;</font> </li><li>  d3dpp.  <font color="#2B74C7">FullScreen_RefreshRateInHz</font> <font color="#006E28">=</font> D3DPRESENT_RATE_DEFAULT <font color="#006E28">;</font> </li><li>  d3dpp.  <font color="#2B74C7">PresentationInterval</font> <font color="#006E28">=</font> D3DPRESENT_INTERVAL_IMMEDIATE <font color="#006E28">;</font> </li><li>  d3dpp.  <font color="#2B74C7">SwapEffect</font> <font color="#006E28">=</font> D3DSWAPEFFECT_DISCARD <font color="#006E28">;</font> </li><li>  d3dpp.  <font color="#2B74C7">EnableAutoDepthStencil</font> <font color="#006E28">=</font> TRUE <font color="#006E28">;</font> </li><li>  d3dpp.  <font color="#2B74C7">AutoDepthStencilFormat</font> <font color="#006E28">=</font> D3DFMT_D16 <font color="#006E28">;</font> </li><li>  HRESULT hrResult <font color="#006E28">=</font> m_pD3D <font color="#006E28">-&gt;</font> <font color="#2B74C7">CreateDevice</font> <font color="#006E28">(</font> D3DADAPTER_DEFAULT <font color="#006E28">,</font> D3DDEVTYPE_HAL <font color="#006E28">,</font> winId <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">,</font> </li><li>  D3DCREATE_HARDWARE_VERTEXPROCESSING <font color="#006E28">,</font> </li><li>  <font color="#006E28">&amp;</font> d3dpp <font color="#006E28">,</font> <font color="#006E28">&amp;</font> m_pd3dDevice <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#000000"><b>if</b></font> <font color="#006E28">(</font> FAILED <font color="#006E28">(</font> hrResult <font color="#006E28">)</font> <font color="#006E28">)</font> </li><li>  <font color="#000000"><b>return</b></font> false <font color="#006E28">;</font> </li><li>  <font color="#000000"><b>return</b></font> true <font color="#006E28">;</font> </li><li>  <font color="#006E28">}</font> </li><li>  <font color="#0057AE">bool</font> Direct3DWidget <font color="#006E28">::</font> <font color="#2B74C7">Rendering</font> <font color="#006E28">(</font> <font color="#006E28">)</font> </li><li>  <font color="#006E28">{</font> </li><li>  <font color="#000000"><b>if</b></font> <font color="#006E28">(</font> m_pd3dDevice <font color="#006E28">==</font> <font color="#B08000">0</font> <font color="#006E28">)</font> </li><li>  <font color="#000000"><b>return</b></font> false <font color="#006E28">;</font> </li><li>  m_pd3dDevice <font color="#006E28">-&gt;</font> <font color="#2B74C7">Clear</font> <font color="#006E28">(</font> <font color="#B08000">0</font> <font color="#006E28">,</font> <font color="#B08000">0</font> <font color="#006E28">,</font> D3DCLEAR_TARGET <font color="#006E28">|</font> D3DCLEAR_ZBUFFER <font color="#006E28">,</font> D3DCOLOR_XRGB <font color="#006E28">(</font> <font color="#B08000">255</font> <font color="#006E28">,</font> <font color="#B08000">255</font> <font color="#006E28">,</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">,</font> <font color="#800080">1.0f</font> <font color="#006E28">,</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#000000"><b>if</b></font> <font color="#006E28">(</font> SUCCEEDED <font color="#006E28">(</font> m_pd3dDevice <font color="#006E28">-&gt;</font> <font color="#2B74C7">BeginScene</font> <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">)</font> <font color="#006E28">)</font> </li><li>  <font color="#006E28">{</font> </li><li>  m_pd3dDevice <font color="#006E28">-&gt;</font> <font color="#2B74C7">EndScene</font> <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#006E28">}</font> </li><li>  m_pd3dDevice <font color="#006E28">-&gt;</font> <font color="#2B74C7">Present</font> <font color="#006E28">(</font> <font color="#B08000">0</font> <font color="#006E28">,</font> <font color="#B08000">0</font> <font color="#006E28">,</font> <font color="#B08000">0</font> <font color="#006E28">,</font> <font color="#B08000">0</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#000000"><b>return</b></font> true <font color="#006E28">;</font> </li><li>  <font color="#006E28">}</font> </li><li></li><li>  <font color="#0057AE">void</font> Direct3DWidget <font color="#006E28">::</font> <font color="#2B74C7">paintEvent</font> <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> </li><li>  <font color="#006E28">{</font> </li><li>  Q_UNUSED <font color="#006E28">(</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#006E28">}</font> </li></ol><br><br></blockquote><br><br>  <b>Example of use:</b> <br><blockquote><ol><li>  <font color="#006E28">#include &lt;QtGui / QWidget&gt;</font> </li><li>  <font color="#006E28">#include &lt;QtGui / QApplication&gt;</font> </li><li>  <font color="#006E28">#include &lt;QtGui / QHBoxLayout&gt;</font> </li><li>  <font color="#006E28">#include "Direct3DWidget.h"</font> </li><li></li><li>  <font color="#0057AE">int</font> main <font color="#006E28">(</font> <font color="#0057AE">int</font> argc <font color="#006E28">,</font> <font color="#0057AE">char</font> <font color="#006E28">*</font> argv <font color="#006E28">[</font> <font color="#006E28">]</font> <font color="#006E28">)</font> </li><li>  <font color="#006E28">{</font> </li><li>  <font color="#888888">// ------------------------------ Start initialization</font> </li><li>  <font color="#888888">// Additional parameters, just add a parameter separated by comma</font> </li><li>  std <font color="#006E28">::</font> <font color="#2B74C7">string</font> aAdditionalParameters <font color="#006E28">[</font> <font color="#006E28">]</font> <font color="#006E28">=</font> <font color="#006E28">{</font> <font color="#BF0303">"-direct3d"</font> <font color="#006E28">}</font> <font color="#006E28">;</font> </li><li>  <font color="#0057AE">int</font> iRealArgumentAmount <font color="#006E28">=</font> argc <font color="#006E28">+</font> <font color="#2B74C7">sizeof</font> <font color="#006E28">(</font> aAdditionalParameters <font color="#006E28">)</font> <font color="#006E28">/</font> <font color="#2B74C7">sizeof</font> <font color="#006E28">(</font> std <font color="#006E28">::</font> <font color="#2B74C7">string</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#888888">// This double pointer will contain parameters from argv and</font> </li><li>  <font color="#888888">// statical parameters which necessary for this application</font> </li><li>  <font color="#0057AE">char</font> <font color="#006E28">**</font> pArguments <font color="#006E28">=</font> <font color="#000000"><b>new</b></font> <font color="#0057AE">char</font> <font color="#006E28">*</font> <font color="#006E28">[</font> iRealArgumentAmount <font color="#006E28">]</font> <font color="#006E28">;</font> </li><li>  <font color="#888888">// Copy all source (from the command line) parameters</font> </li><li>  <font color="#000000"><b>for</b></font> <font color="#006E28">(</font> <font color="#0057AE">int</font> i <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">;</font> i <font color="#006E28">&lt;</font> argc <font color="#006E28">;</font> <font color="#006E28">++</font> i <font color="#006E28">)</font> </li><li>  <font color="#006E28">{</font> </li><li>  <font color="#006E28">*</font> <font color="#006E28">(</font> pArguments <font color="#006E28">+</font> i <font color="#006E28">)</font> <font color="#006E28">=</font> <font color="#000000"><b>new</b></font> <font color="#0057AE">char</font> <font color="#006E28">[</font> <font color="#2B74C7">strlen</font> <font color="#006E28">(</font> argv <font color="#006E28">[</font> i <font color="#006E28">]</font> <font color="#006E28">)</font> <font color="#006E28">+</font> <font color="#B08000">1</font> <font color="#006E28">]</font> <font color="#006E28">;</font> </li><li>  <font color="#2B74C7">strcpy</font> <font color="#006E28">(</font> <font color="#006E28">*</font> <font color="#006E28">(</font> pArguments <font color="#006E28">+</font> i <font color="#006E28">)</font> <font color="#006E28">,</font> argv <font color="#006E28">[</font> i <font color="#006E28">]</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#006E28">}</font> </li><li>  <font color="#888888">// Append parameters we want to add</font> </li><li>  <font color="#000000"><b>for</b></font> <font color="#006E28">(</font> <font color="#0057AE">int</font> i <font color="#006E28">=</font> argc <font color="#006E28">,</font> j <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">;</font> i <font color="#006E28">&lt;</font> iRealArgumentAmount <font color="#006E28">;</font> <font color="#006E28">++</font> i <font color="#006E28">,</font> <font color="#006E28">++</font> j <font color="#006E28">)</font> </li><li>  <font color="#006E28">{</font> </li><li>  <font color="#006E28">*</font> <font color="#006E28">(</font> pArguments <font color="#006E28">+</font> i <font color="#006E28">)</font> <font color="#006E28">=</font> <font color="#000000"><b>new</b></font> <font color="#0057AE">char</font> <font color="#006E28">[</font> aAdditionalParameters <font color="#006E28">[</font> j <font color="#006E28">]</font> .  <font color="#2B74C7">size</font> <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">+</font> <font color="#B08000">1</font> <font color="#006E28">]</font> <font color="#006E28">;</font> </li><li>  <font color="#2B74C7">strcpy</font> <font color="#006E28">(</font> <font color="#006E28">*</font> <font color="#006E28">(</font> pArguments <font color="#006E28">+</font> i <font color="#006E28">)</font> <font color="#006E28">,</font> aAdditionalParameters <font color="#006E28">[</font> j <font color="#006E28">]</font> . <font color="#2B74C7">c_str</font> <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#006E28">}</font> </li><li>  <font color="#22aadd">QApplication</font> xApplication <font color="#006E28">(</font> iRealArgumentAmount <font color="#006E28">,</font> pArguments <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#000000"><b>for</b></font> <font color="#006E28">(</font> <font color="#0057AE">int</font> i <font color="#006E28">=</font> <font color="#B08000">0</font> <font color="#006E28">;</font> i <font color="#006E28">&lt;</font> iRealArgumentAmount <font color="#006E28">;</font> <font color="#006E28">++</font> i <font color="#006E28">)</font> </li><li>  <font color="#000000"><b>delete</b></font> <font color="#006E28">[</font> <font color="#006E28">]</font> <font color="#006E28">*</font> <font color="#006E28">(</font> pArguments <font color="#006E28">+</font> i <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#000000"><b>delete</b></font> <font color="#006E28">[</font> <font color="#006E28">]</font> pArguments <font color="#006E28">;</font> </li><li>  <font color="#888888">// -------------------------------- Initialization complete</font> </li><li>  <font color="#22aadd">QWidget</font> xMainWindow <font color="#006E28">;</font> </li><li>  Direct3DWidget <font color="#006E28">*</font> xScene <font color="#006E28">=</font> <font color="#000000"><b>new</b></font> Direct3DWidget <font color="#006E28">(</font> <font color="#006E28">&amp;</font> xMainWindow <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#22aadd">QHBoxLayout</font> <font color="#006E28">*</font> xMainLayout <font color="#006E28">=</font> <font color="#000000"><b>new</b></font> QHBoxLayout <font color="#006E28">;</font> </li><li>  xMainLayout <font color="#006E28">-&gt;</font> <font color="#2B74C7">addWidget</font> <font color="#006E28">(</font> xScene <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  xMainWindow.  <font color="#2B74C7">setLayout</font> <font color="#006E28">(</font> xMainLayout <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#888888">// It is important to get the Direct3d after the widget</font> </li><li>  xScene <font color="#006E28">-&gt;</font> <font color="#2B74C7">InitDirect3D</font> <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  xMainWindow.  <font color="#2B74C7">show</font> <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li></li><li>  <font color="#000000"><b>return</b></font> xApplication.  <font color="#2B74C7">exec</font> <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#006E28">}</font> </li></ol><br><br></blockquote><br><br>  The result of the execution of this code will be such a window (if you stretch it): <br><img src="http://img2.pict.com/56/f6/ae/e13995ce7787a4970d897b00d3/f6WRx/example.png" alt="image"><br><br>  It would seem that now there is everything to calmly use direct3d with an excellent Qt framework, but, unfortunately, I discovered some pitfalls. <br>  After I started using Direct3d, on some computers, instead of the picture drawn by Direct3d, there was a screen, painted with the background color.  I went through all combinations of attributes, but I could not remove this defect.  It was also not possible to identify the cause of the incorrect operation of the direct3d engine on <u>some</u> machines.  Because Qt documentation states that ‚Äú <i><b>This functionality is experimental.</b></i>  , Then we can assume that the matter is in the dampness of support direct3d. <br><br>  But, this disadvantage can not be a reason for not using Direct3D :).  While trolltech finishes direct3d to a stable state, you can use the following workaround: <br>  Comment out the Rendering () call in paintEvent: <br><blockquote><ol><li>  <font color="#0057AE">void</font> Direct3DWidget <font color="#006E28">::</font> <font color="#2B74C7">paintEvent</font> <font color="#006E28">(</font> <font color="#22aadd">QPaintEvent</font> <font color="#006E28">*</font> pEvent <font color="#006E28">)</font> </li><li>  <font color="#006E28">{</font> </li><li>  Q_UNUSED <font color="#006E28">(</font> pEvent <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  <font color="#888888">// Rendering ();</font> </li><li>  <font color="#006E28">}</font> </li></ol><br><br></blockquote><br>  and add the following code to the place of use: <br><br><blockquote><ol><li>  ... </li><li>  <font color="#888888">// It is important to get the Direct3d after the widget</font> </li><li>  xScene <font color="#006E28">-&gt;</font> <font color="#2B74C7">InitDirect3D</font> <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  xMainWindow.  <font color="#2B74C7">show</font> <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li></li><li>  <font color="#22aadd">QTimer</font> xTimer <font color="#006E28">;</font> </li><li>  <font color="#22aadd">QWidget</font> <font color="#006E28">::</font> <font color="#0057AE">connect</font> <font color="#006E28">(</font> <font color="#006E28">&amp;</font> xTimer <font color="#006E28">,</font> <font color="#0057AE">SIGNAL</font> <font color="#006E28">(</font> timeout <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">)</font> <font color="#006E28">,</font> xScene <font color="#006E28">,</font> SLOT <font color="#006E28">(</font> Rendering <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">)</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  xTimer.  <font color="#2B74C7">start</font> <font color="#006E28">(</font> <font color="#B08000">100</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li></li><li>  <font color="#000000"><b>return</b></font> xApplication.  <font color="#2B74C7">exec</font> <font color="#006E28">(</font> <font color="#006E28">)</font> <font color="#006E28">;</font> </li><li>  ... </li></ol><br><br></blockquote><br>  I added this code to the code of the example I gave above. <br>  Don't forget to include the <em>QTimer</em> header. <br><br>  Enjoy your use of Direct3d API in Qt, and do not forget that the application should be launched with the <strong>-direct3d</strong> option, I have included this option in the code of my usage example. </div><p>Source: <a href="https://habr.com/ru/post/62051/">https://habr.com/ru/post/62051/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../62040/index.html">Several handy tools for testing the site</a></li>
<li><a href="../62043/index.html">Mandelbrot on .bat "for fun"</a></li>
<li><a href="../62045/index.html">UserJS. Part 4: libretki framework</a></li>
<li><a href="../62047/index.html">Beautiful cartoon, nothing more</a></li>
<li><a href="../62049/index.html">The English section of Wikipedia discusses the admissibility of writing articles for money.</a></li>
<li><a href="../62052/index.html">Macintosh Classic - Retro Classic</a></li>
<li><a href="../62053/index.html">Service exchange</a></li>
<li><a href="../62054/index.html">Everything I think about the exam</a></li>
<li><a href="../62055/index.html">Nokia will teach self-charging devices</a></li>
<li><a href="../62056/index.html">Production of souvenir usb-flash drives with the original design (question)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>