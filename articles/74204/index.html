<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Obfuscators (and deobfuscators) for .NET ¬ß0</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is no secret to anyone that from compiled assemblies (exe and dll) for the .NET platform, code in high-level languages ‚Äã‚Äã(C #, VB.net) can be easil...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Obfuscators (and deobfuscators) for .NET ¬ß0</h1><div class="post__text post__text-html js-mediator-article">  It is no secret to anyone that from compiled assemblies (exe and dll) for the .NET platform, code in high-level languages ‚Äã‚Äã(C #, VB.net) can be easily restored.  This means not only that if the program has a licensing system, it can be easily removed;  but also that your source code can be copied, for example, by dishonest competitors.  To protect themselves from such threats, most commercial software developers use various kinds of obfuscators. <br><a name="habracut"></a><br><h2>  <font color="#4F81BD">Why and from whom we defend?</font> </h2><br>  Obviously, obfuscation as one of the stages of protection is relevant only for commercial software. <br>  To protect the program, if it uses the registration system by serial number or activation, it is required from ‚Äúcrackers‚Äù, who either write for a lack of money (if the program is expensive) or because of their love for art.  Finding out where the necessary conditional transition is located, or checking the serial number, is much harder if you have at best a ‚Äúnode‚Äù from the IL code than if you see an easily understood C # code.  This, of course, is not a panacea, but adds the n-th number of minutes required for hacking.  (If n is large enough, then only very persistent individuals will try to break;) <br><br>  It is also necessary to protect against one of the varieties of industrial espionage.  It's simple: just remove the metadata and confuse the rest of the program so much so that it will be cheaper for a competitor to write a program from scratch than to disassemble yours. <br><br>  Usually, <a href="http://www.red-gate.com/products/reflector/">.NET Reflector is</a> used to view assembly metadata.  It has a simple and intuitive interface, as well as the ability to extend the functionality of plug-ins. <br>  Beginners can find screenshots and examples of use on the site of the reflector. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There are also several commercial viewers of assemblies and decompilers, maybe I will list them later (the trial versions parse only half of the build, and the ‚Äúhappy owners‚Äù of the licensed versions report not very big differences from the reflector). <br><br><h2>  <font color="#4F81BD">Obfuscators and packers</font> </h2><br>  .NET applications try to protect with two main methods: directly by <b>obfuscating the</b> IL code (when the output is a nearly valid * .net assembly, and it can be performed on unmodified MS.NET or <a href="http://www.mono-project.com/">mono</a> ).  And the <b>packaging</b> is a modification of the assembly so that the output is a winapi application containing the unpacking module and the packed IL code. <br>  <font color="#999999">* - assembly may contain invalid IL instructions, which however will not be executed.</font>  <font color="#999999">And the build as a whole looks ‚Äúnormal‚Äù and can be run on any supported runtime.</font> <br>  With obfuscation, everything seems to be clear: we submit the assembly to the .net input, we get the assembly to the output of the .net, everything works approximately the same.  No unnecessary ‚Äúhidden‚Äù data, everything is in place, only confused and renamed to something useless. <br>  In the case of the packer, some problems await us: <br><ul><li>  Our build will now be performed only under Windows (or neatly tuned mono + wine) </li><li>  The packer, which sends the original assembly to the mscoree input, is removed in 1 minute, and does not make sense for protection.  Packers that intercept the internal functions of mscoree are very dependent on the version of the framework and cause false positive reactions in some antiviruses.  Interception of internal functions in general is a delicate and ungrateful business. </li><li>  Packers are native-programs, and do not allow your application to be compiled in x86-64 code, where it is available (and in some cases it gives a big performance boost) </li><li>  For normal execution, the .net environment in any case requires access to the original IL bytecode.  And even preJITted assemblies should contain it.  And that means getting this bytecode is also real. </li><li>  And, lastly, quote: "if it runs it can be unpacked" </li></ul><br>  A variety of ‚Äúprotectors‚Äù ( <i>protectors</i> ) usually combine both approaches and will be considered in both parts of this review. <br><br><h2>  <font color="#4F81BD">Reverser tools</font> </h2><br>  The first and most basic tool is a <a href="http://www.red-gate.com/products/reflector/">reflector</a> .  Usually everyone pumps plugins to him to his own taste.  I will only recommend one: <a href="http://sebastien.lebreton.free.fr/reflexil/">reflexil</a> , it allows you to change the bytecode of methods, the properties of the assembly, and contains a convenient removal utility strong-name.  With this plugin it is very convenient to make cracks;) <br>  If the assembly has undergone obfuscation, then viewing it in the reflector is not very convenient, so before changing it (or pulling out the code), it must be ‚Äúdeobfuscated‚Äù, for this a variety of ready-made deobfuscators are used (of which you can find <a href="http://rongchaua.net/">a</a> <a href="http://www.reteam.org/">lot</a> on the Internet). <br>  It is also useful to have your own deobfuscator, which is always easy to ‚Äúfinish‚Äù to the needs of a particular task. <br>  If we deal with packers, we will need various tools for native reverse engineering, such as a debugger (WinDbg, OllyDbg), a dumper (PE tools), a PE-file editor (for example, CFF Explorer).  As well as .net-unpacking-specific tools: <a href="http://www.ntcore.com/netunpack.php">Generic .NET Unpacker</a> , <a href="http://reversengineering.wordpress.com/2008/08/31/kurapica-dotnet-dumper/">.net dumper (KDD)</a> , <a href="http://jithook.blogspot.com/2008/04/net-assembly-rebuilder-v10.html">.Net Assembly Rebuilder</a> .  We will get acquainted with them in the second part of the review. <br><br>  Everything, on this my verbiage ends, the next post will contain more details (even with pictures);) <br><br>  <a href="http://habrahabr.ru/blogs/net/74463/">Continuation ‚Üí</a> <br><br>  The approximate content of the following posts: <br><ul><li>  1. Obfuscators. <ul><li>  <a href="http://habrahabr.ru/blogs/net/74463/">1.1.</a>  <a href="http://habrahabr.ru/blogs/net/74463/">Techniques</a> </li><li>  1.2.  Overview Obfuscators </li><li>  1.3.  Deobfuscation techniques </li><li>  1.4.  Deobfuscators </li></ul></li><li>  2. Packers. </li><li>  3. Used sources, and what else to read on the topic </li></ul></div><p>Source: <a href="https://habr.com/ru/post/74204/">https://habr.com/ru/post/74204/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../74187/index.html">Tom Peters: ‚ÄúInnovation is easy!‚Äù</a></li>
<li><a href="../74194/index.html">Hacker modems face 20 years in prison</a></li>
<li><a href="../74195/index.html">Canon vs Nikon</a></li>
<li><a href="../74196/index.html">Habrasteti life cycle</a></li>
<li><a href="../74201/index.html">Good old DOOM on the iPhone!</a></li>
<li><a href="../74206/index.html">Exact check of email address by regular expression</a></li>
<li><a href="../74207/index.html">"Formula 1" in augmented reality</a></li>
<li><a href="../74208/index.html">"Dancing with a tambourine" around Thread</a></li>
<li><a href="../74210/index.html">Google Wave Checker for Google Chrome</a></li>
<li><a href="../74211/index.html">Maatkit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>