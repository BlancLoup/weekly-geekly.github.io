<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>As simple as possible about sorting combinations in real business problems</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you start looking for material about enumerating combinations, there are a lot of examples of how to sort through all combinations of all letters o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>As simple as possible about sorting combinations in real business problems</h1><div class="post__text post__text-html js-mediator-article">  If you start looking for material about enumerating combinations, there are a lot of examples of how to sort through all combinations of all letters or all numbers.  But how to create all the combinations of matrix elements, in which the dimensionality is unknown beforehand, without delving into Joseph Romanovsky and his ‚ÄúDiscrete Analysis‚Äù, I did not find such material, so I decided to write it here.  Suddenly someone will need. <br><a name="habracut"></a><br>  Why Office, Excel, Visual Basic and not OOP?  I have already partially answered these questions above.  I can also say that this choice is dictated by the specifics of the company for which this algorithm is written and the fact that Office is the main software used by all research managers in our company. <br><br>  This task is purely applied, arising constantly when using one of the methods of data analysis. <br><br>  <b>Given</b> : 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  On the sheet ‚Äúdata‚Äù there is a matrix of undetermined dimension, with an unknown number of elements. </li><li>  The length of each column of the matrix (that is, the number of elements in the column) is not known in advance. </li><li>  The length of the column N with a high probability does not coincide with the length of the column N + 1 and the length of the column N-1. </li><li>  <b>It is known</b> that the length of a certain column of an already formed matrix does not change with time. </li><li>  <b>It is known</b> that the length of the row of the matrix is ‚Äã‚Äãalways the same. </li><li>  The matrix is ‚Äã‚Äãpresented in the Excel table in such a way that each element of the matrix corresponds to one cell with the value of the element.  Let's call such a matrix the ‚Äúinitial conditions matrix‚Äù. </li></ol><br>  <b>The task: to</b> create on the sheet ‚Äúres‚Äù all variants of combinations of elements of the matrix of initial conditions with each other.  One of the matrix values ‚Äã‚Äãshould not be repeated more than <b>X</b> times. <br><br>  Well, the algorithm itself, is a working, tested on Excell 2010 script, which I tried to write as simple and clear as possible: <br><br><pre><code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> RangeArray() As Integer <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> PositionArray() As Integer <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> ResultArray() As Integer MaxCombination = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-comment"><span class="hljs-comment">'   . PresentValue = 1 ' ,     ,  ,        . MaxYSize = 0 '     . IterationCounter = 1 '        res. CombinationCounter = 0 '      . MaxIterationCoutner = 1 '       . PreviousIterationCounter = 0 '     ,   . WorkAreaXSize = Selection.Columns.Count '    . ReDim RangeArray(WorkAreaXSize) ReDim PositionArray(WorkAreaXSize + 1) ReDim ResultArray(WorkAreaXSize) RangeArray(0) = 1 '   .             For Each Column In Selection.Columns '    RangeArray,         . Column.SpecialCells(xlCellTypeConstants).Select WorkAreaYSize = Selection.Cells.Count If WorkAreaYSize &gt; MaxYSize Then MaxYSize = WorkAreaYSize End If RangeArray(Column.Column) = WorkAreaYSize Next '       RangeArray Range(Cells(1, 1), Cells(MaxYSize, WorkAreaXSize)).Select ValueArray = Selection '   ,   . ,    ,       PositionArray ,   RangeArray  ,       . '    ,  ,       .   - ,    - . For i = 1 To WorkAreaXSize PositionArray(i) = 1 Next i For i = 1 To WorkAreaXSize ' ,  ,    i  . For e = 1 To i '       ,   -     . MaxIterationCoutner = MaxIterationCoutner * RangeArray(e) '                . Next e For y = 1 To MaxIterationCoutner '    ResultArray()     PositionArray() If PreviousIterationCounter &lt; y Then '         ,    . For j = 1 To WorkAreaXSize ResultArray(j) = ValueArray(PositionArray(j), j) '    ResultArray()     PositionArray() If ResultArray(j) = PresentValue Then CombinationCounter = CombinationCounter + 1 '     PresentValue,       MaxCombination  End If Next j '  ResultArray(),   '  ResultArray()   res     IterationCounter       If CombinationCounter &lt;= MaxCombination Then For d = 1 To WorkAreaXSize Sheets("res").Cells(IterationCounter, d).Value = ResultArray(d) Next d IterationCounter = IterationCounter + 1 '        End If End If CombinationCounter = 0 '   .  if   . PositionArray(1) = PositionArray(1) + 1 '      PositionArray,   .           ,      RangeArray()      PositionArray() For ErrorCorrections = 1 To WorkAreaXSize If PositionArray(ErrorCorrections) &gt; RangeArray(ErrorCorrections) Then PositionArray(ErrorCorrections) = 1 'If IterationCounter &lt;= MaxIterationCoutner Then ' ,         PositionArray        . ToDo   ,      ,     PositionArray  1,        ,    . PositionArray(ErrorCorrections + 1) = PositionArray(ErrorCorrections + 1) + 1 ' End If End If Next ErrorCorrections Next y PreviousIterationCounter = MaxIterationCoutner ',      . MaxIterationCoutner = 1 '      For s = 1 To WorkAreaXSize PositionArray(s) = 1 Next s Next i '  </span></span></code> </pre> <br>  <a href="https://yadi.sk/d/A-JCcgeL3Rb7d6">Script with a macro and a variant of the matrix of initial conditions:</a> <br><br>  I will welcome any comments and constructive criticism. </div><p>Source: <a href="https://habr.com/ru/post/347206/">https://habr.com/ru/post/347206/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../347196/index.html">DDoS protection at the web server level</a></li>
<li><a href="../347198/index.html">Rust: swing the tape and parsing JSON</a></li>
<li><a href="../347200/index.html">Java with assembly inserts</a></li>
<li><a href="../347202/index.html">In the US with a bodyshop: go or not go?</a></li>
<li><a href="../347204/index.html">IT solutions architecture. Part 1. Enterprise architecture</a></li>
<li><a href="../347208/index.html">Kodein is an interesting alternative to Dagger 2 for dependency injection in Kotlin</a></li>
<li><a href="../347210/index.html">Behaviors - Erlang behaviors</a></li>
<li><a href="../347212/index.html">Configuring squid or how not to buy a paid solution</a></li>
<li><a href="../347216/index.html">The principle of the stream cipher with examples in C #. From One-time pad to stream cipher based on hashf and CTR</a></li>
<li><a href="../347218/index.html">Projection Modeling Technique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>