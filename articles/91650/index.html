<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using IoC containers. Pros and cons</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the light of the release of the new version of the Enterprise Library, one of the most important parts of which is the Unity IoC container, I perso...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using IoC containers. Pros and cons</h1><div class="post__text post__text-html js-mediator-article">  In the light of the release of the new version of the Enterprise Library, one of the most important parts of which is the Unity IoC container, I personally expect a surge of interest in the subject of IoC (Inversion of Control) containers, which, in fact, are the implementation of the rather well-known Service Locator pattern. <br><br>  In this topic, I would like to discuss on the subject of ‚Äúproper‚Äù use of such containers, as well as warn newbies against using it ‚Äúeverywhere and everywhere.‚Äù  Well, just interested in the possibilities of "new technologies" should also be curious. <br><a name="habracut"></a><br><h4>  Background problems </h4><br>  Usually acquaintance with IoC-containers pushes awareness of the need to follow the <a href="http://en.wikipedia.org/wiki/Solid_(object-oriented_design)">principles of class design (SOLID)</a> , namely, the last principle, which suggests that each class should depend not on specific objects, but on abstractions (interfaces), and quite wonderful when all these dependencies are declared in the constructor. <br><br>  That is, the view code: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">class</font> TextManager { <br> <font color="#0000ff">public</font> TextManager(ITextReader reader, ITextWriter writer) { <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  this is good, but the view code: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">class</font> TextManager { <br> <font color="#0000ff">public</font> TextManager(TextFromFileReader reader) { <br> } <br> <br> <font color="#0000ff">public</font> property DatabaseWriter Writer { <br> <font color="#0000ff">set</font> { <br> _writer = <font color="#0000ff">value</font> ; <br> } <br> } <br> }</font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  This is bad. <br><br>  At the same time, if you have a large application / library, ITextWriter is used in many classes, and which Writer will be used is determined at the library entrance (let's say we have Writers in the database and a file with a common interface), then there is a logical desire somehow connect ITextWriter with a DatabaseWriter somewhere in one place. <br><br>  Before SOLID, it was considered quite normal to declare a variable of type ITextWriter inside the library in a static class and to store the currently used Writer there.  But when you start thinking about normal architecture ... :) the disadvantages of static classes become obvious - it‚Äôs completely opaque on what exactly each class depends on what it needs for work and what it does not, and it‚Äôs scary to even imagine what it will ‚Äúpull‚Äù along with this class if suddenly it will be necessary to transfer it to another project or at least another library. <br><br><h4>  IoC container </h4><br>  What is offered to us to solve the problem?  The solution has long been invented in the form of IoC containers: we ‚Äúconnect‚Äù the interfaces with specific classes as soon as we receive the necessary information: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">var</font> container = <font color="#0000ff">new</font> UnityContainer(); <br> container.RegisterInstance&lt;ITextWriter&gt;( <font color="#0000ff">new</font> DatabaseWriter());</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  and we have a convenient way to create objects: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">container.Resolve&lt;TextManager&gt;();</font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  And if by the example of one dependence, the advantage of containers is not obvious, then if we imagine that designers require 2-3 interfaces, and we have at least 5-10 such classes, then the use of containers will seem like a real salvation to many. <br><br><h4>  When a container is good .. </h4><br>  Actually, Unity was created for active use in complex composite applications, with many implementations of identical interfaces and non-linear logic of interdependencies between implementations.  Simply put, if we have not only one IWriter interface with two implementations of DbWriter and TextWriter, but also, for example, IReader and ITextProcessor, for each of which there are also 3-4 implementations, and TextWriter only works with CsvReader om and ExcelReader'om, and which of the readers should be used depends on the specific type of the current TextProcessor'a, well, on the phase of the moon at the same time. <br><br>  It is very difficult to give specific code examples, the use of Unity in which, from my point of view, would be reasonable, and not to clutter the text with a ton of unnecessary code.  But the described ‚Äúexample‚Äù creates a kind of such a complex and complex task :) <br><br><h4>  And when - not very </h4><br>  The use of constructions like <i>container.Resolve ();</i>  it seems very convenient, and at first it makes one use it more often, and instantiate classes in this way wherever possible.  All of this leads to the container being thrown "across the depth" of the library / application, and accessing the IUnityContainer either through the class constructors or, returning to the past, through static classes. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">class</font> TextManager { <br> <font color="#0000ff">public</font> TextManager(IUnityContainer container) { <br> _writer = container.Resolve&lt;IWriter&gt;(); <br> _reader = container.Resolve&lt;IReader&gt;(); <br> } <br> }</font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  This is the extreme use of UnityContainer.  Because: <br><ul><li>  the presence of the ‚Äúincomprehensible‚Äù IUnityContainer in the constructor hides the ways to use it inside the class, and it will be unclear to a stranger when reusing your class which objects / interfaces the class needs to work; </li><li>  this complicates Unit testing, again because it is not clear which interfaces and operations to replace; </li><li>  and, finally, this is a direct violation of the <a href="http://en.wikipedia.org/wiki/Interface_segregation_principle">Interface Segregation</a> principle, which refers to the use of interfaces without ‚Äúextra‚Äù methods (methods that are not used in a class). </li></ul><br><br><h4>  ... Profit! </h4><br>  Summing up, it seems to me that the use of IoC containers is ideal precisely in situations with complex interweaving of interdependencies between specific implementations, and only at the very top levels of the library / application. <br>  That is, immediately after the entry point to the library should be registered in the Unity interface implementations, and as soon as possible rezolvit the types we need.  Thus, we use all the power of Unity to simplify the process of generating complex-dependent objects, while at the same time we follow the principles of good design and minimize the use of a very abstract ‚Äúcontainer‚Äù in our application, thereby simplifying its testing. <br><br>  PS Since I myself am not a guru in this topic, in the comments I will be glad to hear about my own mistakes, as well as about other possible uses of IoC containers. </div><p>Source: <a href="https://habr.com/ru/post/91650/">https://habr.com/ru/post/91650/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../91644/index.html">Do you patent technologies introduced in startups ?!</a></li>
<li><a href="../91645/index.html">Javascript. Separate the flies from cutlets</a></li>
<li><a href="../91646/index.html">Boomburum office</a></li>
<li><a href="../91647/index.html">Interview with Thomas Chang, as well as a photo report from the Russian office of Gigabyte</a></li>
<li><a href="../91649/index.html">Intel switches to new LGA 1155 connector</a></li>
<li><a href="../91657/index.html">Sharing screenshots on Mac OS X + Dropbox</a></li>
<li><a href="../91658/index.html">‚ÄúHow the planet of spiders was created‚Äù - a practical guide for technical designers and illustrators</a></li>
<li><a href="../91660/index.html">Russian Post Advertising</a></li>
<li><a href="../91661/index.html">Alt Linux 5.0 Ark. Do you need something else?</a></li>
<li><a href="../91662/index.html">McAfee stole millions of clean computers into an endless reboot</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>