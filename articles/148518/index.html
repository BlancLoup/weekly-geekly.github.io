<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The story of the bike</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sometimes programmers invent their own ‚Äúbikes‚Äù, but is it really bad, especially if the creation is not distinguishable from the original, and the aut...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The story of the bike</h1><div class="post__text post__text-html js-mediator-article"> <a href=""><img src="http://runserver.net/temp/solitaire/game.png" alt="image" align="right"></a>  Sometimes programmers invent their own ‚Äúbikes‚Äù, but is it really bad, especially if the creation is not distinguishable from the original, and the author gets invaluable experience? <br><br>  This story began a little over a year ago with the appearance of a modern smartphone for my wife.  She asked to find Solitaire solitaire, the same as it was once on the desktop Windows.  After reviewing a dozen programs, I was unpleasantly surprised - almost everywhere there was inconvenient control, controversial pictures of the cards, a sea of ‚Äã‚Äãextra bells and whistles like 250 solitaires in one, setting up a photo on a shirt and blackjack with harlots.  As a result, they chose one of the more or less suitable options and forgot about it for a while. <br>  Flew a year and I started writing programs for mobile.  At the same time, the issue of cross-platform, in-app debugging of purchases, content preparation for different platforms became an edge.  There was a thought to make a ‚ÄúTetris‚Äù pen or a regular calculator for testing, but still I chose ‚ÄúSolitaire‚Äù as a ‚Äúbicycle‚Äù.  The ideological core of the project was the most accurate repetition of the old, good solitaire from the Windows game set. <br><br><a name="habracut"></a><br><h4>  Content </h4><br> <a href=""><img src="http://runserver.net/temp/solitaire/jump.png" alt="image" align="right"></a>  The first problem arose with graphics: there are a lot of map drawings on the Internet, many of them are free, but almost all are pretty elaborate, they look strange on mobile screens, and they just don‚Äôt look like the old cards from cards.dll.  Cards for Windows pixel-by-pixel were painted by talented designer <a href="http://www.kare.com/portfolio/17_microsoft_solataire.html">Susan Care</a> in 1989, in 16-color mode.  If desired, they are easy to find on the network, but you can use it without violating IP.  The maps used in some games of the Linux world turned out to be much more interesting - they were distributed under the GPL license, although they looked a bit strange, with black and white older maps (figures).  The author of these cards was Comrade.  Oxymoron, on the <a href="http://www.waste.org/~oxymoron/cards/">site of which</a> the images themselves and the script of their assembly lie.  He drew his own figures and icons of suits, and took figures from an unknown source, but rather similar to the original.  I modified the script a bit so that it saved the maps in PNG, added transparency, and at the same time manually painted the higher maps.  For the ace of spades icon, a personalized stylized picture was drawn, similar to the original, resembling a Celtic pattern.  She also became the icon of the program. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For the shirt was chosen the most pleasant (in my opinion) picture with the beach and a palm tree with a hand-drawn.  It turned out very recognizable - the look in the picture does not linger, although if you look closely, the difference is obvious. <br><img src="http://runserver.net/temp/solitaire/deck.jpg" alt="image"><br><br><h4>  Gameplay </h4><br> <a href=""><img src="http://runserver.net/temp/solitaire/wine.png" alt="image" align="right"></a>  As it turned out, the gameplay in "Solitaire" is not so simple due to the scoring, timer, issuing one / three cards, and along with the Vegas mode.  For example, playing for money with the issuance of one card (that is, without the ability to turn the deck) differs markedly from the standard one: its goal is to transfer as many cards as possible to the aces and collect more than $ 42 to get out of the minus and start the next batch. if solitaire did not work out.  In the game, the transfer of the card from the deck ‚Äúdown‚Äù to the aces gives 15 points, while just 10 is right for the aces. Naturally, this is very conditional documented, so I had to drive the original game in wine and conduct a full-fledged search . <br><br><h4>  Code </h4><br>  I wrote the business logic of the program in pure Java 1.6, without using third-party libraries, Android, Swing, etc. For Android, this part is assembled as a separate library and connects to the GUI project without any problems, but for other OS I decided to go non-standard way and Do not engage in porting "in the forehead" to other languages.  After some file processing, the <a href="http://community.versant.com/Projects/html/projectspaces/db4o_product_design/sharpen.html">Sharpen</a> project was able to convert this code to pure C #, which opened the way for implementation under iOS using MonoTouch, and in the future for Windows Phone 7/8.  The simplest unit tests showed that the logic of the work has not changed, the translation was successful.  In the MonoTouch environment, I implemented GUI mapping without any nuances, debugged the game on the emulator and the iPod Touch and sent it for approval on the iTunes Store.  I implemented the program settings with the help of external binding to <a href="https://github.com/kgn/InAppSettings">KGN.InAppSettings</a> , stumbling over some trivialities like the lack of support for the thumb for external libraries. <br><br><h4>  Problems </h4><br><img src="http://runserver.net/temp/solitaire/logo.png" alt="image" align="right">  After a week of appruva at Apple, my ‚ÄúClassic Solitaire‚Äù appeared on the iTunes Store.  I expected criticism of the graphics or possible licensing disputes, but on the very first day all the reviews were unequivocal: the game crashes immediately upon launch.  I removed the game from the store and began to study the problems.  My friends started the game perfectly, the emulator and iPod Touch 4g also did not show any failures.  It took several days and the help of members of the forum to find the first serious bug: in the regional standards of iOS for Europe and Ukraine there is a decimal separator ‚Äúperiod‚Äù, and in Russia this is already a ‚Äúcomma‚Äù.  Accordingly, the conversion of float to string worked on some devices and crashed on others.  Within a week after being sent to the appr, it turned out that the game also crashed when launched in landscape mode.  On the iPod and iPhone, all programs start in portrait orientation, because it only shows up on the iPad, which I did not have.  At the re-up, another week went away, for which the game finally disappeared from the ‚ÄúNew‚Äù category and successfully sank beyond the Top 1000. In addition, the icon with a transparent background, perfectly accepted in the Android Market, was obscenely processed by Apple scripts and became frankly not pretty <br><br><h4>  High definition </h4><br> <a href=""><img src="http://runserver.net/temp/solitaire/ld-hd.png" alt="image" align="right"></a>  By the time the project was working properly, the icons were replaced, etc., I had a new iPad, where I found that the card resolution was frankly not enough for a 9.7 "screen, and on the Retina Display the" jumping cards "frankly slow down. Fighting It took a couple of days with lags, during which I managed to thoroughly intermarry with Core Animation, but I had to hire a designer to improve the resolution. The result of his work was the numbers, letters and suits of high resolution, most similar in style to the original. Zoom Pro, not to lose out  ntichnost pixel graphics. It turned out not ideal, but still quite well. <br><br>  A lot of effort was spent on this work, so it was logical to release the HD version separately, and at the same time add an in-game purchase to the regular version.  With the implementation of In-App Purchases under MonoTouch it was not all that simple, and in order to look organic, I decided to get rid of KGN.InAppSettings and make a single interface for settings and purchases.  I will not describe the technical details here, but there are a lot of them, including the monkey work of creating your own Settings, identical to the system ones, fighting the lack of documentation for StoreKit for Mono, various bugs with debugging purchases, etc. <br><br><h4>  Profit </h4><br>  The game did not become a masterpiece, did not hit the tops, and it is unlikely that it will pay back the cost of development and the work of the designer, but still I have on all devices (including the smartphone that started it all) there is the ‚ÄúKlondike‚Äù, which is the most similar to the original since the days of Windows 3.1.  The experience of writing portable code in Java and porting it to C # turned out to be invaluable - several large Android projects on iOS were ported by a similar method by my team, and debugging on a small game turned out to be a good idea to learn the MonoTouch underwater rake and generally develop under iOS, and at the same time write a certain number of useful libraries.  Maybe someone will laugh at this story, but as for me, the ‚Äúbicycle‚Äù came out very useful, and the time was not wasted. <br><br><h4>  Post Scriptum </h4><br>  I specifically avoided going into the details of porting and working with MonoTouch, because each of them is worthy of a separate topic.  Sooner or later I will gather my strength and put my class for the In-Game Settings, the shopping manager, etc., to the public. <br>  I do not post links to the project so that they do not consider it as an advertisement. <br>  If anyone needs an updated map generation script, write to scanwords@runserver.net, it is the derivative work from the GPL project, so I‚Äôll post it without any problems. </div><p>Source: <a href="https://habr.com/ru/post/148518/">https://habr.com/ru/post/148518/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148513/index.html">The second tournament Habraigre "Startup"</a></li>
<li><a href="../148514/index.html">Search for a lost phone on Windows Phone 7 - in practice</a></li>
<li><a href="../148515/index.html">The Modal - the correct modal windows</a></li>
<li><a href="../148516/index.html">[CLI Tip]: How to make a brief squeeze-review of running-config</a></li>
<li><a href="../148517/index.html">NetBeans IDE 7.2 release</a></li>
<li><a href="../148520/index.html">Humanities programmer</a></li>
<li><a href="../148521/index.html">Dark color scheme for IntelliJ IDEA: continuation and news</a></li>
<li><a href="../148522/index.html">Steve Jobs as Rorschach test</a></li>
<li><a href="../148524/index.html">Gtalk fell</a></li>
<li><a href="../148525/index.html">Ruby NoName Podcast S04E14</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>