<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vulnerabilities of cryptocontainers with remote attack</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, crypto containers are used to store confidential information on personal computers of users and in the corporate environment of companies and o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vulnerabilities of cryptocontainers with remote attack</h1><div class="post__text post__text-html js-mediator-article"> Today, crypto containers are used to store confidential information on personal computers of users and in the corporate environment of companies and organizations and can be created using virtually any encryption program.  Their wide distribution is primarily due to the convenience of working with encrypted files and the ability to implement "encryption on the fly." <br><br>  However, not all users realize how vulnerable the files in the crypto-container become after they are connected as a logical disk of the operating system and how easy it is to steal them from there.  This was the reason for writing this article, in which, using a concrete example, it will be shown how to steal information placed in a cryptocontainer created using practically cult in Runet (and not only) TrueCrypt encryption program.  However, the same is true for any other program that allows you to create cryptocontainers and does not have other additional functions to protect the encrypted data stored in them. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a2e/613/08b/a2e61308b468f5b994fcbef17f3a7757.jpg" alt="image"><br><a name="habracut"></a><br>  Let's consider the following example.  Suppose there is a certain AAA organization, which stores on its server (for which a regular PC is used) valuable information to which several employees of this organization have access.  Confidential files are stored in a cryptocontainer created using TrueCrypt.  In order to allow employees to access this information to work with it throughout the entire working day, the cryptocontainer is mounted at the beginning (for example, by the system administrator of this organization) and dismantled at the end.  The company's management is confident that, since their confidential files are stored in an encrypted form on the cryptocontainer, they are reliably protected. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In order to understand what danger threatens this organization, let us briefly present ourselves as a not very honest competing company BBB, who wants to acquire confidential information AAA.  You can implement your plan in several stages: <br><br>  1. Download <a href="http://darkcomet-rat.com/">DarkComet RAT</a> is a hidden remote administration utility that was officially created for legitimate control of a remote system.  It is difficult to say how clean the thoughts of Jean-Pierre Lesier, the developer of DarkComet, really were.  Perhaps, just as Albert Einstein didn‚Äôt imagine that the atomic energy discovered by him would find practical application in the atomic bomb for the first time, he also didn‚Äôt assume that its development would soon be effectively used by hackers around the world, and the Syrian government, for example, uses program against the opposition in the <a href="http://rus.azattyq.org/content/syria-darkcomet-program-oppozition/24648538.html">Syrian conflict</a> . <br><br>  DarkComet has many features: <br>  - file manager; <br>  - Manager of open windows, running tasks, active processes; <br>  - management of autoload and services; <br>  - remote registry management; <br>  - the installing and deleting of programms; <br>  - the seizure of control of the remote machine using VNC technology; <br>  - taking screenshots from a remote screen; <br>  - interception of sound from a microphone and video from built-in or external cameras, etc. <br><br>  Of course, all this allows you to use DarkComet as an excellent spyware program and turns it into a powerful weapon in the hands of cybercriminals.  Despite the fact that the creator of DarkComet RAT has decided to close his project, its development can still be freely downloaded from the network. <br><br>  This is what the main program window looks like: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c94/70e/308/c9470e308fd65f9059ec11be46ef095e.jpg" alt="image"><br><br>  2. After downloading and installing the program, you will need to create a hosting, on which we will download files from the victim's computer. <br><br>  3. With the help of DarkComet, we create an exe-file (stub) that will be used to infect the victim's computer ( <i>DarkCometRat&gt; ServerModule&gt; FullEditor</i> ).  In <i>Network Settings, we</i> register the previously created host and set other necessary settings (more <a href="http://bystrannik.blogspot.com/2013/02/darkcomet.html">here</a> ).  Or order the creation of such a file on the stock exchange (approximately $ 100). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/87d/c6d/582/87dc6d582dfb8f49bd5449bd2992dc52.jpg" alt="image"><br><br>  4. Naturally, the executable file created in DarkComet RAT is detected by antivirus software as malware, therefore, in order to successfully infect the victim‚Äôs computer, we need to encrypt it using a cryptor (or order it for $ 50-100).  With the help of a cryptograph, the source file of the program is encrypted, and its beginning is recorded with a code that, when launched, performs decryption and launch of the main program.  Encrypting the program, the cryptor protects it from all the most well-known antiviruses and signature search methods. <br><br>  5. Make sure that antivirus programs do not regard the encrypted file as a virus.  The check can be done on <a href="https://www.virustotal.com/">VirusTotal</a> , for example: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f5/fd8/79c/5f5fd879ca616ae9d66c7ef3deb5b0f9.jpg" alt="image"><br><br>  In this article, we do not directly upload the encrypted file so that there are no accusations about the spread of viruses, in particular, from the administration of the Habr.  However, if someone has a desire to make sure that at the time of creation, the exe file was not really regarded by antiviruses as a virus, we can give a link to it and you will see for yourself by comparing the hash sums in the video and on the file. <br><br>  6. Now it is necessary that our virus gets on the victim's computer.  There are many different ways to do this. <br>  For example, a computer may be infected by email.  During the working day, dozens and even hundreds of emails arrive at the corporate email of employees.  Of course, such a flow of correspondence does not allow to give due attention to each letter and the majority of employees treat the processing of such messages as shifting papers from one pile to another, which greatly facilitates the implementation of attacks.  When an attacker sends a simple request by mail, his victim very often, on the machine, does what he is asked for without thinking about his actions. <br><br>  This is just one example.  Any other methods of <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BE%25D1%2586%25D0%25B8%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25B8%25D0%25BD%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B5%25D1%2580%25D0%25B8%25D1%258F">social engineering</a> based on the characteristics of human psychology can be used. <br><br>  7. As soon as the virus enters the victim‚Äôs computer after opening the executable file, the attacker gains full access to the computer being attacked.  As you know, any application that accesses an encrypted file located on a connected cryptocontainer receives its copy in decrypted form.  The DarkComet file manager will be no exception - with its help you can copy any information from the cryptodisk. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4d6/f23/985/4d6f239854ceb239850ecabb28aa5f0c.jpg" alt="image"><br><br>  All the files we receive in decrypted form, they are available for reading and editing.  After that, you can use them to your advantage.  By the way, here is another drawback of cryptocontainers - their large size of hundreds of megabytes, which greatly simplifies the task of the cybercriminal to search for protected files. <br><br>  That's all.  Confidential information is copied and compromised, a competing firm can use it for their own selfish purposes, and the attacked organization does not even suspect that data has been stolen. <br><br>  More clearly the process of stealing information from a crypto-container TrueCrypt is demonstrated in this video: <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/lPTtg2uB5zM%3Ffeature%3Doembed&amp;xid=17259,15700019,15700186,15700191,15700253&amp;usg=ALkJrhhHwELvHkvJlFPINi8t0FAfAtz1Dw" frameborder="0" allowfullscreen=""></iframe><br><br><h4>  Conclusion </h4><br>  Cryptocontainer provides reliable protection of information only when it is disabled (dismantled);  at the time of connection (mounting) confidential information from it can be stolen and the attacker will receive it in decrypted form.  Therefore, if a cryptocontainer is still used to store valuable data, it should be connected for minimum periods of time and disconnected immediately after completion of the work. <br><br><h4>  Cybersafe </h4><br>  In <a href="http://cybersafesoft.com/rus/products/files-encryption/">CyberSafe Files Encryption</a> for added security, we added the <i>System of Trusted Applications</i> , described in detail in <a href="http://habrahabr.ru/company/cybersafe/blog/210458/">this article</a> .  The bottom line is that for the folder where encrypted files are stored, CyberSafe additionally assigns a list of trusted programs that can access these files.  Accordingly, all other applications will be denied access.  Thus, if the DarkComet RAT file manager, another remote administration tool, or any other program that is not included in the trusted group of files accesses the encrypted file, they will not be able to access the protected files. <br><br>  In the event that CyberSafe is used to <a href="http://habrahabr.ru/company/cybersafe/blog/211012/">encrypt network folders</a> , the files on the server are always stored in encrypted form and are never decrypted on the server side - they are decrypted only on the user side. </div><p>Source: <a href="https://habr.com/ru/post/214141/">https://habr.com/ru/post/214141/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../214131/index.html">Increase Redis performance with a simple cluster</a></li>
<li><a href="../214133/index.html">Smart City at Mobile World Congress 2014</a></li>
<li><a href="../214135/index.html">bb-mobile Techno 7.85 3G: iPad mini ‚Äúclone‚Äù with phone functionality and 4 cores</a></li>
<li><a href="../214137/index.html">ThL T100S - smartphone based on 8-core processor MT6592</a></li>
<li><a href="../214139/index.html">I invite you to test drive boxes for 28 million rubles - EMC XtremIO DSS</a></li>
<li><a href="../214147/index.html">New life old synthesizer. Part 1</a></li>
<li><a href="../214153/index.html">How to make printed circuit boards: a tour of the factory Tehnoteh</a></li>
<li><a href="../214155/index.html">Samsung introduced a new line of LED components for smartphones and tablets</a></li>
<li><a href="../214159/index.html">Frames decide everything</a></li>
<li><a href="../214161/index.html">How much is one error in our programs, or what errors happen in PVS-Studio and CppCat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>