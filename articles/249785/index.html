<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PARI / GP: finite field calculations. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Why PARI / GP? 
 PARI / GP is a computer-mathematics system with its own C-like interpreted language, focused on computational number theory. The syst...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PARI / GP: finite field calculations. Part 1</h1><div class="post__text post__text-html js-mediator-article"><h4>  <b>Why PARI / GP?</b> </h4><br>  <a href="http://pari.math.u-bordeaux.fr/">PARI / GP</a> is a computer-mathematics system with its own C-like interpreted language, focused on computational number theory.  The system is popular in the scientific community: according to Google Scholar, in 2014 alone, about 100 topical articles using PARI / GP were published in refereed journals / conferences. <br><a name="habracut"></a><br>  In my dissertation research, I often needed to solve the traditional problems of linear algebra (for example, for a matrix of large dimension to calculate its core and rank), but only over finite fields (for example, <img src="https://habrastorage.org/getpro/habr/post_images/d4b/62a/be2/d4b62abe216f1e9e8586f9c4058c2eb6.gif" alt="field of 8 elements">  or <img src="https://habrastorage.org/getpro/habr/post_images/7c6/d08/57c/7c6d0857c3d93ada43e97398d2191709.gif" alt="field of 27 elements">  ).  If we had just complex matrices, then all at least some well-known systems of symbolic mathematics would cope effectively: for example, in my favorite <a href="http://www.wolfram.com/mathematica/">Wolfram Mathematica, it</a> suffices to use the NullSpace and MatrixRank functions, respectively.  It would be great if the same functions were once earned for matrices over finite fields, albeit with a loss in performance due to the inefficiency of the general linear algebra algorithms for them ... Alas, I got an exponential growth (up to hours on my poor netopovy laptop ) computation time from the dimension of matrices (see my <a href="http://mathematica.stackexchange.com/questions/15140/finitefields-package-is-very-slow-any-fast-substitute-for-mathematica">question</a> on the Wolfram Mathematica profile forum).  True, in fairness, this was caused not so much by the problems of implementing algorithms for linear algebra as by the problems of the symbolic processor itself. <br><br>  To my great joy, PARI / GP is intended for calculations in various algebraic systems (rings, fields), operating with their elements as ‚Äúatomic‚Äù numbers, and not as symbolic structures over built-in types.  According to my empirical observation, PARI / GP has an unsurpassed speed of such calculations.  In addition, there is the possibility of translating the interpreted code into pure C. <br><br><h4>  <b>Basic functions for working in final fields</b> </h4><br>  The description below is rather ‚Äúhigh-level‚Äù, without reference to the algorithms and data structures used within PARI / GP (topics of future posts). <br><ul><li>  The function ffinit (q, n, {v}) computes the normalized irreducible over a <u>simple field</u> <img src="https://habrastorage.org/getpro/habr/post_images/d79/b52/50f/d79b5250fa0acebea2de0829a1d884b5.gif" alt="field of q elements">  a polynomial f (v) of degree n in the variable v (optional, the default is the polynomial of argument x).  For example: calling ffinit (2, 3, x) returns a primitive polynomial <img src="https://habrastorage.org/getpro/habr/post_images/611/0f0/ccd/6110f0ccdd96e16265e9b5092f04c3fe.png">  , and ffinit (2, 4, x) is simply an irreducible polynomial <img src="https://habrastorage.org/getpro/habr/post_images/f95/2fe/706/f952fe7068fa279c9fbf276442a8c097.png">  .  Now we can set the extension <img src="https://habrastorage.org/getpro/habr/post_images/3bd/2cc/c1b/3bd2ccc1b1a12cac34d347f4598c4adb.gif" alt="field of q ^ n elements">  finite field <img src="https://habrastorage.org/getpro/habr/post_images/d79/b52/50f/d79b5250fa0acebea2de0829a1d884b5.gif" alt="field of q elements">  classically as a factor ring <img src="https://habrastorage.org/getpro/habr/post_images/481/19c/aea/48119caeaa2e3b6d65135cdd4ebf43f0.png">  . </li><li>  Root <img src="https://habrastorage.org/getpro/habr/post_images/341/ec3/571/341ec3571c2a9dc1ca250e5a8a7a6233.png">  an irreducible polynomial f (x) as a PARI / GP object is created using the ffgen (f, x) function.  In other words, the call g = ffgen (f, x) returns the object g, identified with the equivalence class [x] - element of the factor ring <img src="https://habrastorage.org/getpro/habr/post_images/481/19c/aea/48119caeaa2e3b6d65135cdd4ebf43f0.png">  .  Now field <img src="https://habrastorage.org/getpro/habr/post_images/3bd/2cc/c1b/3bd2ccc1b1a12cac34d347f4598c4adb.gif">  considered as linear space over <img src="https://habrastorage.org/getpro/habr/post_images/d79/b52/50f/d79b5250fa0acebea2de0829a1d884b5.gif">  , it is possible to construct (its tables of addition and multiplication) with the help of the generating set <img src="https://habrastorage.org/getpro/habr/post_images/f6e/52e/cf8/f6e52ecf8dd6fb8fc3d7570e2a432813.png">  . </li><li>  You can find a primitive field element using the ffprimroot (g) function.  This function calculates a random element of order (n - 1) in the multiplicative group of a finite field, which is given by the object g. </li><li>  Using the minpoly (a) function, we can find the minimal polynomial of the element a of a finite field.  For example, calling p = minpoly (a) will return <img src="https://habrastorage.org/getpro/habr/post_images/cea/aa8/f63/ceaaa8f630fa777e25648aa27a25d032.png">  .  In other words, finding a primitive field element <img src="https://habrastorage.org/getpro/habr/post_images/3bd/2cc/c1b/3bd2ccc1b1a12cac34d347f4598c4adb.gif">  field can be represented in the traditional form <img src="https://habrastorage.org/getpro/habr/post_images/282/407/a51/282407a514d57c506cf6920a55e5a536.png">  where p is its primitive polynomial. </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  <b>Life example</b> </h4><br><h5>  Preliminary reference </h5><br>  As already mentioned, PARI / GP uses its C-like language.  A detailed guide can be found <a href="http://www.math.uiuc.edu/~r-ash/GPTutorial.pdf">here</a> .  The following is a brief description explaining some points of the example below (and even more): <br><ol><li>  All objects in PARI / GP are created on its internal stack.  By default, the internal stack occupies 3.8MB (4 million bytes) of computer dynamic memory.  To expand it, use the allocatemem (s) function, where s is the requested number of bytes. </li><li>  Separator ";"  at the end of the line is used to prohibit the printing of the result. </li><li>  By default, any identifier is a variable for polynomials.  You can use an apostrophe in front of the identifier, which indicates that it is a variable for polynomials, and not an object.  For example, <br><pre><code class="markdown hljs">x = 12; type(x) &gt;"t<span class="hljs-emphasis"><span class="hljs-emphasis">_INT" type('x) &gt;"t_</span></span>POL"</code> </pre> <br></li><li>  The curly brackets "{", "}" are used only for grouping commands (for example, multi-line).  Grouping does not specify the scope (life) of any object declared inside it.  By default, all declared variables are global.  For an object to become locally bound, it must be declared using the my specifier.  For example, <br><pre> <code class="markdown hljs">{ x = 12; } x &gt;12 { my(y = -13.2); } y &gt;y</code> </pre><br></li><li>  PARI / GP allows the user to create lambda functions.  The syntax is as follows: lambda = (argument list) -&gt; function body; </li></ol><br><br><h5>  Example itself </h5><br><pre> <code class="markdown hljs">createField = (q, n, var) -&gt; ffgen(minpoly(ffprimroot(ffgen(ffinit(q, n, var), var))), var); a = createField(2, 4, 'x) &gt;x fforder(a) \\     &gt;15 allocatemem(2^27); \\  128     PARI/GP M = matrix(1000, 1000, i,j, random(a)); \\   10001000    GF(16) {gettime(); matrank(M); gettime()} \\   ()      &gt;34209 {gettime(); kernel(M~); gettime()} \\         &gt;88425</code> </pre><br>  The configuration of my laptop is Intel Core (TM) i7-4702M CPU @ 2.20GHz 2.20GHz, 32kB L1 cache, 8Gb DDR3.  PARI / GP 2.7.2 (32bit, single thread) was used - this is the last out of the box release of this text under Windows OS. </div><p>Source: <a href="https://habr.com/ru/post/249785/">https://habr.com/ru/post/249785/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../249775/index.html">Zombies are attacking the App Store, Android is catching up with iOS, Liam Neeson is taking revenge on the offender - and other news of the week for a mobile developer</a></li>
<li><a href="../249777/index.html">Why did we make the Beeline application for Windows Phone and that there is something in this OS that is not in iOS and Android</a></li>
<li><a href="../249779/index.html">Blockchain Formation Algorithm</a></li>
<li><a href="../249781/index.html">Festival "City of Techno-Creativity" is held in Yekaterinburg</a></li>
<li><a href="../249783/index.html">Some interesting and useful things for web developer # 38</a></li>
<li><a href="../249787/index.html">Less is better, but better: airFiber 5X is a new generation of radio channels, or Lutz * for your radio route is now in retail</a></li>
<li><a href="../249789/index.html">How we built the data center alarm system</a></li>
<li><a href="../249791/index.html">Behind the Scenes of Skyforge Closed Beta</a></li>
<li><a href="../249793/index.html">Unconventional review of AngularJS</a></li>
<li><a href="../249795/index.html">The Five-Minute JavaScript Podcast, Issue 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>