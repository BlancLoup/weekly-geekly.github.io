<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Yourself Dropbox on OS X</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For a long time, I used Dropbox (in conjunction with GrabBox for quick uploading of screenshots), until one fine day it pleased me with error 429. Wel...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Yourself Dropbox on OS X</h1><div class="post__text post__text-html js-mediator-article">  For a long time, I used Dropbox (in conjunction with GrabBox for quick uploading of screenshots), until one fine day it pleased me with error 429. Well, everyone probably saw something like this: <br><img src="https://habrastorage.org/files/918/ea1/18b/918ea118b862405e8456a4243f94b15d.png"><br>  The reason for this error, oddly enough, is <a href="https://www.dropbox.com/help/4204">not necessarily related to the excess of traffic</a> .  Moreover: <br><blockquote>  Unfortunately, we do not provide detailed traffic information on the links.  Thus, it is impossible to find out about the traffic on which of the links led to blocking.  Statistics and metrics related to general links are not tracked, so we cannot provide information on the reasons for blocking access links. </blockquote>  For paid accounts, all this also remains in force, only traffic limits are increased 10 times.  And that's for $ 99 a year. <br><br>  It was a volitional decision to abandon Dropbox (as well as the rest of proprietary) and tried almost all the basic free solutions to install on your server - <a href="https://owncloud.org/">owncloud</a> , <a href="https://pydio.com/">pydio</a> , <a href="https://www.seafile.com/">seafile</a> .  I will not strongly focus on them, reviews and comparisons can be easily found on the net.  I can only say in general terms, this is one of the most disgusting examples of software that I have seen - heavy, buggy, overloaded with useless functionality.  In terms of moderation of resource consumption and speed, I was only pleased with the seafile, but there the developers have very strange priorities and a desire to monetize more.  At the same time, people writing a client and people writing a web interface have different ideas about it.  Complete mess. <br><br>  Further actions suggested themselves - to reinvent their own bicycle. <br><a name="habracut"></a><br>  There was not much time, so it was logical to use the existing tools.  With the synchronization of directories all was simple and clear - there is a great bunch of rsync + Automator.  We monitor the folder, when changing, we set rsync on it, then distribute it to any number of our servers. <br>  But this is not enough, we need direct links and the ability to quickly share them. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For these purposes, a <a href="https://github.com/deseven/esupload">small script</a> was written on ~ 100 lines, which greatly simplified the screenshots of both screenshots and other files. <br><br>  How it works in practice: <br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/sBbbaGIVKN4%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhkjG0iHqGiZH-ImmYmFmrmyNP_gA" frameborder="0" allowfullscreen=""></iframe><br><br>  So, what we need: <br>  - own server on Linux or OS X with configured web server and ssh access using keys <br>  - <a href="http://brew.sh/">homebrew</a> on the client machine to install the script and dependencies <br><br>  Open the terminal and perform the initial installation: <br><pre><code class="bash hljs">brew install http://deseven.info/sys/esupload.rb mkdir ~/.esupload</code> </pre> <br>  If you basically do not use homebrew, then you can <a href="https://raw.githubusercontent.com/deseven/esupload/master/esupload">manually download the script from the github</a> , put it somewhere and run from there.  Do not forget to also put the <b>terminal-notifier</b> and <b>pv</b> - the script actively uses them. <br><br>  The next step is to add profiles, the profiles are stored in <i>~ / .esupload</i> and are plain text files with a list of parameters. <br>  Parameters are: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#  remote_host=example.org #   remote_dir=/remotedir #     (   HTTP-) remote_url=http://example.org/share #   URL    #  (  ) remote_user=$USER # ssh  remote_ident=$HOME/.ssh/id_rsa # ssh  random_name=no #       chmod=u=rwx,g=rw,o=r #     is_screenshot=no #      delete_after_upload=no #     track_progress=no #    track_interval=30 #    </span></span></code> </pre><br>  Further on specific tasks. <br><br><br><h2>  Screenshots </h2><br>  The task is to make a screenshot using standard tools (‚åò‚áß3 or 4), we get a direct link to the clipboard. <br><br>  Create a separate directory for screenshots and reassign saving to this directory: <br><pre> <code class="bash hljs">mkdir ~/Screenshots defaults write com.apple.screencapture location ~/Screenshots killall SystemUIServer</code> </pre><br>  Next, create a profile named screenshot ( <i>~ / .esupload / screenshot</i> ): <br><pre> <code class="bash hljs">remote_dir=/var/www/example.org/screenshots remote_host=example.org remote_user=upload remote_url=http://example.org/screenshots random_name=yes is_screenshot=yes delete_after_upload=yes</code> </pre><br>  Thus, when uploading a screenshot, it will be assigned a random name, if necessary (on Retina displays) it will be reduced and deleted after upload. <br><br>  Finally, open Automator, create a new Folder Action, specify our directory with screenshots, and add the ‚ÄúRun shell script‚Äù action, in which we select ‚ÄúPass input: as arguments‚Äù and <i>/ usr / local / bin / esupload</i> with the <i>screenshot</i> profile as the processor. <br>  You can also add an additional filter with the conditions of which files will be transferred to the script for uploading, but since we use the catalog solely for screenshots, there is no special point in this. <br>  You should get something like this: <br><img src="https://habrastorage.org/files/746/ad7/03a/746ad703aa2e45e48410839b868842dd.png"><br><br>  Save, click Run to check.  Everything. <br><br>  To test the fill itself, you can run esupload manually: <br><pre> <code class="bash hljs">esupload screenshot <span class="hljs-string"><span class="hljs-string">"/path/to/screenshot"</span></span></code> </pre><br><br><h2>  Files </h2><br>  The task is to throw the file onto the application icon in the dock, we get a direct link to it in the clipboard. <br><br>  Create a file ( <i>~ / .esupload / file</i> ) profile: <br><pre> <code class="bash hljs">remote_dir=/var/www/example.org/share remote_host=example.org remote_user=upload remote_url=http://example.org/share track_progress=yes</code> </pre><br>  Using the <i>track_progress</i> parameter, the progress of filling the current file will be displayed every 30 seconds (by default).  This is useful for large files that can be poured long enough. <br><br>  Open Automator again, this time we create an application in which, as an action, we do everything the same as we did for the screenshots, not forgetting only to change the profile to <i>file</i> : <br><img src="https://habrastorage.org/files/1b4/563/295/1b4563295e254bddb69f03da498d4d78.png"><br><br>  Save the application in <i>/ Applications</i> , if you wish, you can replace the icon by replacing the file <i>Resources / AutomatorApplet.icns</i> inside the application. <br><br>  The bike is ready!  Pros and cons in my opinion are quite obvious, but I think we need to bring them as a result. <br><br>  Pros: <br><ul><li>  safe (ssh is used for file transfer and authorization) </li><li>  simple and flexible (can be sharpened under any scenario) </li><li>  no dependence on third-party services and products </li></ul><br>  Minuses: <br><ul><li>  there is no way to control already uploaded files and get links to them </li><li>  no queue and transfer control </li><li>  lack of access control and other features </li></ul><br><br>  Wishes and suggestions, both by the method itself and <a href="https://github.com/deseven/esupload">by the script</a> , are welcome. </div><p>Source: <a href="https://habr.com/ru/post/357806/">https://habr.com/ru/post/357806/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../357796/index.html">Cornell University created a self-learning system for defining sarcasm on the Web.</a></li>
<li><a href="../357798/index.html">The Internet Protection Society presented an indicator of Internet Runet connectivity</a></li>
<li><a href="../357800/index.html">YouTube shows Adblock Plus users an error instead of advertising ... and the video itself.</a></li>
<li><a href="../357802/index.html">Protected anonymous service ProtonMail from CERN developers has become public</a></li>
<li><a href="../357804/index.html">Amazon CloudDrive: not the fact that you can download back</a></li>
<li><a href="../357808/index.html">Personal data of 93.4 million Mexicans were made publicly available.</a></li>
<li><a href="../357810/index.html">Mail.Ru Group: theft of hundreds of millions of mail service accounts by the ‚ÄúRussian hacker‚Äù is a usual stuffing</a></li>
<li><a href="../357812/index.html">Netflix made a quick analogue of Speedtest.net</a></li>
<li><a href="../357814/index.html">Ultra-secure mail service GhostMail stops working with regular users</a></li>
<li><a href="../357816/index.html">Cloud storage Yunpan 360 will be closed in 2017</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>