<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Asynchronous vs delayed javascript</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In my article ‚ÄúUnderstanding the Critical Rendering Path‚Äù ( translation of the article ), I wrote about the effect of JavaScript files on the Critical...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Asynchronous vs delayed javascript</h1><div class="post__text post__text-html js-mediator-article"><p>  In my article <a href="https://bitsofco.de/understanding-the-critical-rendering-path/">‚ÄúUnderstanding the Critical Rendering Path‚Äù</a> ( <a href="https://habrahabr.ru/post/320430/">translation of the article</a> ), I wrote about the effect of JavaScript files on the Critical Rendering Path (CRP). </p><br><blockquote> JavaScript is a blocking resource for the parser.  This means that JavaScript blocks parsing of the HTML document itself.  When the parser reaches the <code>&lt;script&gt;</code> (whether it is internal or external), it stops, takes the file (if it is external), and starts it. </blockquote><p>  This behavior can cause problems if we load several JavaScript files on the page, as this increases the time of the first rendering, even if the document is not really dependent on these files. </p><br><p>  Fortunately, the <code>&lt;script&gt;</code> element has two <code>async</code> and <code>defer</code> attributes that give us the ability to control how external files are loaded and executed. </p><br><a name="habracut"></a><br><h2 id="normalnoe-vypolnenie">  Normal execution </h2><br><p>  Before understanding the difference between these two attributes, let's see what happens in their absence.  As mentioned earlier, by default JavaScript files interrupt the parsing of an HTML document until they are received and executed. <br>  Take an example in which the <code>&lt;script&gt;</code> element is located somewhere in the middle of the page: </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"script.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> .... </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">body</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">html</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><p>  Here is what happens when the parser processes the document: </p><br><img src="https://habrastorage.org/files/fc6/581/de4/fc6581de40d249e5905cf3fa238286eb.png"><br><p>  HTML parsing pauses until the script is loaded and executed, thereby increasing the amount of time until the first rendering. </p><br><h2 id="atribut-async">  <code>async</code> attribute </h2><br><p>  <code>Async</code> used to indicate to the browser that the script <strong><em>can</em></strong> be executed asynchronously. <br>  The HTML parser does not need to stop when it reaches the <code>&lt;script&gt;</code> for loading and execution.  Execution may occur after the script is received in parallel with the parsing of the document. </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">async</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"script.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="undefined"></span></code> </pre> <br><p>  Attribute is available only for files that connect externally.  If the external file has this attribute, then it can be loaded while the HTML document is still parsed.  The parser will be suspended for script execution as soon as the script file is loaded. </p><br><img src="https://habrastorage.org/files/a07/823/bae/a07823bae90b4612bc5e4933674b34ce.png"><br><h2 id="atribut-defer">  <code>defer</code> attribute </h2><br><p>  The <code>defer</code> attribute indicates to the browser that the script should be executed after the HTML document is completely parsed. </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">defer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"script.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="undefined"></span></code> </pre> <br><p>  As with asynchronous scripting, the file can be loaded while the HTML document is parsed.  However, even if the script file is fully loaded before the parser finishes, it will not be executed until the parser runs to the end. </p><br><img src="https://habrastorage.org/files/378/af7/eff/378af7eff5e34d89b75584d626c48cae.png"><br><h2 id="asinhronnoe-otlozhennoe-ili-normalnoe-vypolnenie">  Asynchronous, deferred or normal execution? </h2><br><p>  So, when should asynchronous, deferred, or normal JavaScript be used?  As always, it depends on the situation and there are several questions that will help you make the right decision. </p><br><h3 id="gde-raspolozhen-element-script-">  Where is the <code>&lt;script&gt;</code> element? </h3><br><p>  Asynchronous and deferred execution are most important when the <code>&lt;script&gt;</code> element is not at the very end of the document.  HTML documents are parsed in order, from opening <code>&lt;html&gt;</code> to closing it.  If an external JavaScript file is placed immediately before the closing <code>&lt;/body&gt;</code> , then using <code>async</code> and <code>defer</code> becomes less relevant, since the parser will have already parsed most of the document by that time, and the JavaScript files will no longer affect it. </p><br><h3 id="skript-samodostatochen">  Is the script self-contained? </h3><br><p>  For files that are independent of other files and / or have no dependencies, the <code>async</code> attribute will be most useful.  Since it does not matter to us when the file is executed, asynchronous loading is the most suitable option. </p><br><h3 id="polagaetsya-li-skript-na-polnostyu-razobrannyy-dom">  Does the script rely on a fully disassembled DOM? </h3><br><p>  In many cases, the script file contains functions that interact with the DOM.  Or perhaps there is a dependency on another file on the page.  In such cases, the DOM must be completely parsed before the script is executed.  As a rule, such a file is placed at the bottom of the page to make sure that everything has been disassembled for its operation.  However, in a situation where, for whatever reason, the file must be placed elsewhere - the <code>defer</code> attribute may be useful. </p><br><h3 id="skript-nebolshoy-i-zavisim">  Is the script small and dependent? </h3><br><p>  Finally, if the script is relatively small and / or depends on other files, then it may be worth defining it inline.  Despite the fact that the embedded code blocks the parsing of HTML-document, it should not be much hindered if its size is small.  In addition, if it depends on other files, a slight lock may be necessary. </p><br><h2 id="podderzhka-i-sovremennye-brauzernye-dvizhki">  Support and modern browser engines </h2><br><p>  Support for the <code>async</code> and <code>defer</code> very common: </p><br><img src="https://habrastorage.org/files/d33/64e/d8f/d3364ed8f1d34517b4d12d44f9eea73b.png"><br><p><br>  It is worth noting that the behavior of these attributes may differ slightly in different JavaScript engines.  For example, in V8 (used in Chromium), an attempt was made to parse all the scripts, regardless of their attributes, on a separate dedicated thread to execute the script.  Thus, the ‚Äúblocking parser‚Äù nature of JavaScript files should be minimized by default. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/323790/">https://habr.com/ru/post/323790/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../323778/index.html">[NeoQuest2017] ‚ÄúIn Search of Earthlings‚Äù and not only ...</a></li>
<li><a href="../323780/index.html">How programs are designed: from UML to automata</a></li>
<li><a href="../323784/index.html">Magento U has published a free course Fundamentals of Magento 2 Development</a></li>
<li><a href="../323786/index.html">Excursion to the Moscow production of components for communication networks. Part one</a></li>
<li><a href="../323788/index.html">INS-based interlocutor: recurrent networks</a></li>
<li><a href="../323792/index.html">Why play getKanban: experience Tutu.ru</a></li>
<li><a href="../323794/index.html">GUID-like primary keys in SQLite on Android</a></li>
<li><a href="../323796/index.html">Overview of data bootcamps abroad</a></li>
<li><a href="../323798/index.html">HR-technologies in Russia: expectation and reality</a></li>
<li><a href="../323802/index.html">How to talk about your side projects</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>