<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Manage Drones with Intel RealSense SDK Speech Recognition Applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The news is about drones - unmanned aerial vehicles - literally every day. They have a wide range of applications: reconnaissance and combat operation...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Manage Drones with Intel RealSense SDK Speech Recognition Applications</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/c96/48b/6c1/c9648b6c10d74245b0d667767f2efc57.jpg"><br><br>  The news is about drones - unmanned aerial vehicles - literally every day.  They have a wide range of applications: reconnaissance and combat operations, photo and video filming, and just entertainment.  Drones technology is quite new and deserves interest. <br><br>  Developers can create drone control applications.  The drone is ultimately a conventional programmable device, so you can connect to it and give commands to perform the necessary actions using conventional applications for PC and smartphones.  For this article, I chose one of the drones with the most powerful programming features - <a href="http://ardrone2.parrot.com/">Parrot's AR.Drone 2.0</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We learn how to interact with and manage such a drone using a library written in C #.  Based on this basis, we will add voice commands to control the drone using the <a href="https://software.intel.com/en-us/intel-realsense-sdk">Intel RealSense SDK</a> . <br><a name="habracut"></a><br>  Parrot's AR.Drone 2.0 model is one of the most interesting drones on the market for enthusiasts.  This drone has many functions and includes an integrated help system with stabilization and calibration interfaces.  The drone is equipped with a protective frame made of durable polystyrene, protecting the propeller blades and moving parts in case of a fall or collision with fixed obstacles. <br><br><img src="https://habrastorage.org/files/e66/995/dfa/e66995dfac964f1ca4d7de06548fb510.png"><br>  <i>AR.Drone * 2.0 by Parrot</i> <br><br>  The drone equipment provides its connection via its own Wi-Fi * network to external devices (smartphones, tablets, PCs).  The communication protocol is based on AT-like messages (similar commands were used several years ago to program modems for communication via the telephone network). <br><br>  Using this simple protocol, you can send the drone all the commands necessary for take-off, ascent or descent, and flight in different directions.  You can also read the stream of images taken by cameras (in high definition) mounted on the drone (one camera is pointing forward, the other is down) to save the photos taken in flight or to record video. <br>  The manufacturing company provides several applications for piloting the drone manually, but it is much more interesting to learn how to achieve autonomous flight control.  For this, I decided (with the assistance of my colleague Marco Minerva) to create an interface that would allow controlling the drone from different devices. <br><br><h2>  <font color="#0071c5">Software control drone</font> </h2><br>  The drone has its own Wi-Fi network, so we‚Äôll connect to it to send control commands.  We found all the necessary information in <a href="http://www.msh-tools.com/ardrone/ARDrone_Developer_Guide.pdf">the AR.Drone 2.0 Developer Guide</a> .  For example, the manual says that you need to send commands via UDP protocol to the IP address 192.168.1.1, port 5556. These are simple strings in the AT format: <br><br><ul><li>  AT * REF - take-off and landing control; </li><li>  AT * PCMD - drone movement (direction, speed, height). </li></ul><br>  After connecting to the drone, we will create a kind of "game" in which we will send commands to the drone based on the application's input data.  Let's try to create a class library. <br><br>  First you need to connect to the device. <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> async Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConnectAsync</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> hostName = HOST_NAME, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> port = REMOTE_PORT)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Set up the UDP connection. var droneIP = new HostName(hostName); udpSocket = new DatagramSocket(); await udpSocket.BindServiceNameAsync(port); await udpSocket.ConnectAsync(droneIP, port); udpWriter = new DataWriter(udpSocket.OutputStream); udpWriter.WriteByte(1); await udpWriter.StoreAsync(); var loop = Task.Run(() =&gt; DroneLoop()); }</span></span></code> </pre> <br>  As mentioned earlier, you need to use the UDP protocol, therefore, you need a DatagramSocket object.  After connecting using the ConnectAsync method, we create a DataWriter in the output stream to send commands.  Finally, we send the first byte over Wi-Fi.  It serves only to initialize the system and will be dropped by the drone. <br><br>  Check the command sent to the drone. <br><br><pre> <code class="cpp hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> async Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DroneLoop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { var commandToSend = DroneState.GetNextCommand(sequenceNumber); <span class="hljs-function"><span class="hljs-function">await </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SendCommandAsync</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(commandToSend)</span></span></span></span>; sequenceNumber++; await Task.Delay(<span class="hljs-number"><span class="hljs-number">30</span></span>); } }</code> </pre><br>  The <i>DroneState.GetNextCommand</i> tag formats a string AT command that needs to be sent to the device.  To do this, you need a sequence number: the drone expects that each team is accompanied by a sequence number, and ignores all commands whose numbers are less than or equal to the numbers of commands already received. <br><br>  After that, we use <i>WriteString</i> to send commands to the stream via <i>StreamSocket</i> , while <i>StoreAsync</i> writes the commands to the buffer and sends them.  Finally, we increase the sequence number and use the <i>Task Delay</i> parameter to introduce a delay of 30 milliseconds before the next iteration. <br>  The <i>DroneState</i> class defines which command to send. <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DroneState</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> StrafeX { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> StrafeY { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> AscendY { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> RollX { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> Flying { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> isFlying { get; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>; } <span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetNextCommand</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint sequenceNumber)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Determine if the drone needs to take off or land if (Flying &amp;&amp; !isFlying) { isFlying = true; return DroneMovement.GetDroneTakeoff(sequenceNumber); } else if (!Flying &amp;&amp; isFlying) { isFlying = false; return DroneMovement.GetDroneLand(sequenceNumber); } // If the drone is flying, sends movement commands to it. if (isFlying &amp;&amp; (StrafeX != 0 || StrafeY != 0 || AscendY != 0 || RollX != 0)) return DroneMovement.GetDroneMove(sequenceNumber, StrafeX, StrafeY, AscendY, RollX); return DroneMovement.GetHoveringCommand(sequenceNumber); } }</span></span></code> </pre><br>  The properties of <i>StrafeX</i> , <i>StrafeY</i> , <i>AscendY</i> and <i>RollX</i> determine, respectively, the speed of movement to the left and to the right, forward and backward, the height and angle of rotation of the drone.  These properties are of the Double data type, valid values ‚Äã‚Äãare from 1 to -1.  For example, if you set the <i>StrafeX</i> property to -0.5, the drone will move to the left with half the maximum speed;  If set to 1, the drone will fly to the right with the maximum speed. <br><br>  The variable <i>Flying</i> determines the takeoff and landing.  In the <i>GetNextCommand</i> method, we check the values ‚Äã‚Äãof these fields to determine which command to send to the drone.  These commands, in turn, are under the control of the <i>DroneMovement</i> class. <br>  Note that if the commands are not specified, the last instruction creates the so-called <i>Hovering</i> command.  This is an empty command that supports an open communication channel between the drone and the device.  The drone must constantly receive messages from the application managing it, even if no action is needed and nothing has changed. <br><br>  The most interesting method of the <i>DroneMovement</i> class is the <i>GetDroneMove</i> method, which is actually engaged in composing and sending commands to the drone.  For other motion-related methods, see this example. <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetDroneMove</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint sequenceNumber, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> velocityX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> velocityY, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> velocityAscend, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> velocityRoll)</span></span></span><span class="hljs-function"> </span></span>{ var valueX = FloatConversion(velocityX); var valueY = FloatConversion(velocityY); var valueAscend = FloatConversion(velocityAscend); var valueRoll = FloatConversion(velocityRoll); var command = <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"{0},{1},{2},{3}"</span></span>, valueX, valueY, valueAscend, valueRoll); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> CreateATPCMDCommand(sequenceNumber, command); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateATPCMDCommand</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint sequenceNumber, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> command, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> mode = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"AT*PCMD={0},{1},{2}{3}"</span></span>, sequenceNumber, mode, command, Environment.NewLine); }</code> </pre><br>  The FloatConversion method is not specified here, but it converts a Double value of the range from -1 to 1 into a signed integer value that can be used by AT commands, such as the PCMD string, for motion control. <br><br>  The code shown here is available as a <a href="https://www.nuget.org/packages/ArDrone2.Interaction">free library on the NuGet website</a> (AR.Drone 2.0 Interaction Library).  This library provides everything you need to control - from takeoff to landing. <br><br><img src="https://habrastorage.org/files/4af/67d/76e/4af67d76e921409f92d4ada7bd6df497.jpg"><br>  <i>AR.Drone UI user interface on NuGet website</i> <br><br>  Thanks to this sample application, you can forget about the intricacies of the implementation and focus on creating applications that give us the opportunity to fly drone using different methods of interaction. <br><br><h2>  <font color="#0071c5">Intel RealSense SDK</font> </h2><br>  Now let's look at one of the most interesting and easy-to-use (for me) features of Intel RealSense SDK - <a href="https://software.intel.com/sites/landingpage/realsense/camera-sdk/v1.1/documentation/html/index.html%3Fmanuals_command_control_and_dictation.html">speech recognition</a> . <br><br>  The SDK supports two approaches to speech recognition. <br><br><ul><li>  Recognition of commands (for a given dictionary). </li><li>  Free text recognition (dictation). </li></ul><br>  The first approach is a kind of list of commands specified by the application in the specified language, which is processed by the "recognizer".  All words that are not in the list are ignored. <br><br>  The second approach is something like a dictaphone, ‚Äúunderstanding‚Äù any text in free form.  This approach is ideal for transcribing, automatic subtitling, etc. <br><br>  In this project we use the first option, since it is required to support a finite number of commands sent to the drone. <br>  First you need to define some variables. <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> PXCMSession Session; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> PXCMSpeechRecognition SpeechRecognition; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> PXCMAudioSource AudioSource; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> PXCMSpeechRecognition.Handler RecognitionHandler;</code> </pre><br>  <i>Session</i> is the tag required for accessing I / O and the SDK algorithms, since all subsequent actions are inherited from this instance. <br>  <i>SpeechRecognition</i> is an instance of the recognition module created by the <i>CreateImpl</i> function in the <i>Session</i> environment. <br>  <i>AudioSource</i> is a device interface that allows you to install and select an audio input device (in our code example, for simplicity, we select the first available audio device). <br>  <i>RecognitionHandler</i> is the actual handler that assigns an event handler for the <i>OnRecognition</i> event. <br><br>  Now we initialize the session, the <i>AudioSource</i> and the <i>SpeechRecognition</i> instance. <br><br><pre> <code class="cpp hljs"> Session = PXCMSession.CreateInstance(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Session != null) { <span class="hljs-comment"><span class="hljs-comment">// session is a PXCMSession instance. AudioSource = Session.CreateAudioSource(); // Scan and Enumerate audio devices AudioSource.ScanDevices(); PXCMAudioSource.DeviceInfo dinfo = null; for (int d = AudioSource.QueryDeviceNum() - 1; d &gt;= 0; d--) { AudioSource.QueryDeviceInfo(d, out dinfo); } AudioSource.SetDevice(dinfo); Session.CreateImpl&lt;PXCMSpeechRecognition&gt;(out SpeechRecognition);</span></span></code> </pre><br>  As noted earlier, for simplicity of code, we select the first available audio device. <br><br><pre> <code class="cpp hljs">PXCMSpeechRecognition.ProfileInfo pinfo; SpeechRecognition.QueryProfile(<span class="hljs-number"><span class="hljs-number">0</span></span>, out pinfo); SpeechRecognition.SetProfile(pinfo);</code> </pre><br>  Then you need to poll the system, find out the actual configuration parameter and assign it to a variable ( <i>pinfo</i> ). <br><br>  You also need to configure a number of parameters in the profile to change the recognition language.  Set the recognition confidence level (with a higher value, more confident recognition is required), recognition end interval, etc. <br><br>  In our case, the default parameter is set as in profile 0 (obtained from <i>Queryprofile</i> ). <br><br><pre> <code class="cpp hljs"> String[] cmds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[] { <span class="hljs-string"><span class="hljs-string">"Takeoff"</span></span>, <span class="hljs-string"><span class="hljs-string">"Land"</span></span>, <span class="hljs-string"><span class="hljs-string">"Rotate Left"</span></span>, <span class="hljs-string"><span class="hljs-string">"Rotate Right"</span></span>, <span class="hljs-string"><span class="hljs-string">"Advance"</span></span>, <span class="hljs-string"><span class="hljs-string">"Back"</span></span>, <span class="hljs-string"><span class="hljs-string">"Up"</span></span>, <span class="hljs-string"><span class="hljs-string">"Down"</span></span>, <span class="hljs-string"><span class="hljs-string">"Left"</span></span>, <span class="hljs-string"><span class="hljs-string">"Right"</span></span>, <span class="hljs-string"><span class="hljs-string">"Stop"</span></span> , <span class="hljs-string"><span class="hljs-string">"Dance"</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] labels = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] { <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">128</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>, <span class="hljs-number"><span class="hljs-number">512</span></span>, <span class="hljs-number"><span class="hljs-number">1024</span></span> }; <span class="hljs-comment"><span class="hljs-comment">// Build the grammar. SpeechRecognition.BuildGrammarFromStringList(1, cmds, labels); // Set the active grammar. SpeechRecognition.SetGrammar(1);</span></span></code> </pre><br>  Then we set the grammatical dictionary for learning the recognition system.  Using <i>BuildGrammarFromStringList,</i> we create a simple list of verbs and corresponding return values, defining grammar number 1. <br><br>  You can specify several grammars for use in the application and include one of them if necessary, so you can create different command dictionaries for all supported languages ‚Äã‚Äãand allow the user to switch between the languages ‚Äã‚Äãrecognized in the SDK.  In this case, you need to install the appropriate language support DLL files, because when installing the SDK, only English (US) language support is installed by default.  In this example, we only use the default grammar along with the English (United States) language. <br><br>  Then choose which grammar should be designated as active in the <i>SpeechRecognition</i> instance. <br><br><pre> <code class="cpp hljs"> RecognitionHandler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PXCMSpeechRecognition.Handler(); RecognitionHandler.onRecognition = OnRecognition;</code> </pre><br>  These instructions define a new event handler for the <i>OnRecognition</i> event and assign it to the method described below. <br><br><pre> <code class="cpp hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnRecognition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PXCMSpeechRecognition.RecognitionData data)</span></span></span><span class="hljs-function"> </span></span>{ var RecognizedValue = data.scores[<span class="hljs-number"><span class="hljs-number">0</span></span>].label; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> movement = <span class="hljs-number"><span class="hljs-number">0.3</span></span>; TimeSpan duration = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TimeSpan(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">500</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (RecognizedValue) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: DroneState.TakeOff(); WriteInList(<span class="hljs-string"><span class="hljs-string">"Takeoff"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: DroneState.Land(); WriteInList(<span class="hljs-string"><span class="hljs-string">"Land"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>: DroneState.RotateLeftForAsync(movement, duration); WriteInList(<span class="hljs-string"><span class="hljs-string">"Rotate Left"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>: DroneState.RotateRightForAsync(movement, duration); WriteInList(<span class="hljs-string"><span class="hljs-string">"Rotate Right"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>: DroneState.GoForward(movement); Thread.Sleep(<span class="hljs-number"><span class="hljs-number">500</span></span>); DroneState.Stop(); WriteInList(<span class="hljs-string"><span class="hljs-string">"Advance"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span>: DroneState.GoBackward(movement); Thread.Sleep(<span class="hljs-number"><span class="hljs-number">500</span></span>); DroneState.Stop(); WriteInList(<span class="hljs-string"><span class="hljs-string">"Back"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span>: DroneState.GoUp(movement); Thread.Sleep(<span class="hljs-number"><span class="hljs-number">500</span></span>); DroneState.Stop(); WriteInList(<span class="hljs-string"><span class="hljs-string">"Up"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">64</span></span>: DroneState.GoDown(movement); Thread.Sleep(<span class="hljs-number"><span class="hljs-number">500</span></span>); DroneState.Stop(); WriteInList(<span class="hljs-string"><span class="hljs-string">"Down"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">128</span></span>: DroneState.StrafeX = <span class="hljs-number"><span class="hljs-number">.5</span></span>; Thread.Sleep(<span class="hljs-number"><span class="hljs-number">500</span></span>); DroneState.StrafeX = <span class="hljs-number"><span class="hljs-number">0</span></span>; WriteInList(<span class="hljs-string"><span class="hljs-string">"Left"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">256</span></span>: DroneState.StrafeX = <span class="hljs-number"><span class="hljs-number">-.5</span></span>; Thread.Sleep(<span class="hljs-number"><span class="hljs-number">500</span></span>); DroneState.StrafeX = <span class="hljs-number"><span class="hljs-number">0</span></span>; WriteInList(<span class="hljs-string"><span class="hljs-string">"Right"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span>: DroneState.Stop(); WriteInList(<span class="hljs-string"><span class="hljs-string">"Stop"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1024</span></span>: WriteInList(<span class="hljs-string"><span class="hljs-string">"Dance"</span></span>); DroneState.RotateLeft(movement); Thread.Sleep(<span class="hljs-number"><span class="hljs-number">500</span></span>); DroneState.RotateRight(movement); Thread.Sleep(<span class="hljs-number"><span class="hljs-number">500</span></span>); DroneState.RotateRight(movement); Thread.Sleep(<span class="hljs-number"><span class="hljs-number">500</span></span>); DroneState.RotateLeft(movement); Thread.Sleep(<span class="hljs-number"><span class="hljs-number">500</span></span>); DroneState.GoForward(movement); Thread.Sleep(<span class="hljs-number"><span class="hljs-number">500</span></span>); DroneState.GoBackward(movement); Thread.Sleep(<span class="hljs-number"><span class="hljs-number">500</span></span>); DroneState.Stop(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } Debug.WriteLine(data.grammar.ToString()); Debug.WriteLine(data.scores[<span class="hljs-number"><span class="hljs-number">0</span></span>].label.ToString()); Debug.WriteLine(data.scores[<span class="hljs-number"><span class="hljs-number">0</span></span>].sentence); <span class="hljs-comment"><span class="hljs-comment">// Process Recognition Data }</span></span></code> </pre><br>  This is a method of getting the value returned from the recognition data and executing the corresponding command (in our case, the corresponding drone's flight control command). <br><br>  Each drone command refers to calling a <i>DroneState</i> with a specific method ( <i>TakeOff, GoUp, DoDown</i> , etc.) and with a specific motion or duration parameter, which in each case relates to a specific amount or duration of the motion. <br><br>  Some teams need an explicit call to the <i>Stop</i> method to stop the current action, otherwise the drone will continue to move according to the received command (see the commands in the previous code snippet). <br><br>  In some cases, you need to insert <i>Thread.Sleep</i> between two different commands to wait for the previous action to complete before sending a new command. <br><br>  To check the recognition, even if there is no drone available, I inserted a variable (it is controlled by a checkbox in the main window) that turns on the Drone Stub function mode (in this mode, commands are created, but not sent). <br><br>  To close an application, call the <i>OnClosing</i> method to close and destroy all instances and handlers and for general system cleaning. <br><br>  The code contains some debug commands that display useful information in the Visual Studio * debug windows when testing the system. <br><br><h2>  <font color="#0071c5">Conclusion</font> </h2><br>  In this article, we saw how to interact with a device (as complex as a drone) using a natural language interaction interface.  We saw how you can create a simple command dictionary, teach the system to understand it and appropriately manage a complex device - the drone in flight.  Shown in this article - only a small fraction of the available options for managing drone.  The possibilities are truly endless. <br><br>  <a href="https://software.intel.com/en-us/articles/perceptual-drone-speech-recognition-using-realsense">Original article</a> </div><p>Source: <a href="https://habr.com/ru/post/273083/">https://habr.com/ru/post/273083/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../273071/index.html">Web without a mouse</a></li>
<li><a href="../273073/index.html">Free tools for database developers</a></li>
<li><a href="../273075/index.html">Xamarin and Xamarin.Forms - cactus in chocolate. Part 1</a></li>
<li><a href="../273077/index.html">Software multitasking timer on the MK</a></li>
<li><a href="../273081/index.html">Changes in RAD Studio 10 Seattle Update 1</a></li>
<li><a href="../273087/index.html">The button bar in the elevator: the door, do not rush to close</a></li>
<li><a href="../273089/index.html">Selenium for Python. Chapter 5. Expectations</a></li>
<li><a href="../273093/index.html">How to replace a domain controller and not break the current infrastructure</a></li>
<li><a href="../273095/index.html">Content filtering: why and how to do it</a></li>
<li><a href="../273101/index.html">Moscow Python Meetup ‚Ññ31</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>