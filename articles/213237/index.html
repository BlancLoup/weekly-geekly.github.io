<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>As we brought the smart outlet to the level of a mass product</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I continue to talk about the development of iron with us. So, the outlet. Able to turn on and off at the command, has a temperature sensor. 

 At firs...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>As we brought the smart outlet to the level of a mass product</h1><div class="post__text post__text-html js-mediator-article">  I continue to talk about the development of iron with us.  So, the outlet.  Able to turn on and off at the command, has a temperature sensor. <br><br>  At first glance, the situation is quite simple: there is a ready-made device, it is generally understandable how it works - but it did not enter the mass market.  Too complicated, incomprehensible and troublesome in normal use for a person without IT education.  And it costs quite a lot.  I want more convenient, easier, more understandable and cheaper. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/73d/1e7/779/73d1e7779e8c114eeb133c3dc1f01756.jpg"><br>  <i>The serial model in the analysis.</i>  <i>The main things: the case, the socket itself, the voltage control board with a capacitor, the board with the controller, the radio module with the antenna, the SIM slot.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Unlike the <a href="http://habrahabr.ru/company/beeline/blog/213235/">tracker</a> , where we had to work a lot with iron, the sockets of our manufacturing partner were already ‚Äúin shape‚Äù and, in general, showed themselves very well.  The main problems were in software, both low-level and high-level. <a name="habracut"></a><br><br><h4>  Outlet network </h4><br>  Of course, I immediately wanted to get rid of the SMS channel.  Regular sockets send and receive SMS themselves.  It is not very reliable and quite expensive for the owner.  So, we are completely with a clear conscience reduce the cost of use through the use of GPRS.  This already cuts costs for the owner almost tripled. <br><br>  All outlet commands come from our server.  All telemetry goes to our server.  The user interacts with this server, although for him he acts as something of a transparent proxy.  The server controls that the team has reached.  And he also sends an SMS with the status - the subscriber does not need to spend money on each individual message. <br><br>  That is, by introducing an intermediate proxy server, we achieved three important effects at once: <br><ul><li>  The socket has become cheaper to operate (we were able to designate a fixed 99 rubles per month instead of incomprehensible costs). </li><li>  We were able to "wind" any scripts over the iron without modifying this iron. </li><li>  And we have a place where you can easily and quickly configure and configure the device without a programmer and connections to anything.  At that time, there simply were no friendly interfaces, and we immediately wanted to make the socket clear even to pensioners. </li></ul><br>  An important factor in the transition from SMS sending from the outlet to the GPRS connection with the server was also the fact that when using a large number of devices in the long term (in three or four years, when they may be hundreds of thousands per district), we Let's create the problem of overloading the SMS channel.  There was also a GPRS outlet on the market, but at the cost of the purchase and operation it was almost twice as high as we wanted. <br><br><h4>  Software Functionality </h4><br>  So, the socket itself was able to initially process the SMS, respond to them with other SMS, give the sensor data and close-open the contacts on command from the chip.  Inside the device itself, all the logic was implemented - this is the functions of the schedule, and the reaction to temperature and the rest.  In fact, all this was hardcoded, and any change in the algorithm meant the need for a flashing device.  And we very little believed that someone on the mass market would seriously reflash the outlet. <br><br>  So, we carried out almost all logic on the server.  The server can do the following things: <br><ul><li>  Gives commands to the outlet, making sure that the outlet has worked.  Similarly for other direct teams. </li><li>  The schedule creation interface and the implementation of sending commands at the predetermined time are implemented. </li><li>  And in the same place can be programmed response to various kinds of events, for example, a change in temperature.  The user sets the necessary conditions in a very simple interface, and the server acts as a programmer of the socket, passing it down the technical stack (as if the user was directly writing a new configuration file to it). </li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d51/d89/918/d51d89918da1032f0dd96535945583bf.png"><br>  <i>The interface for setting the schedule and scripts</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/edf/081/c4a/edf081c4ac8938b321d50d3f6df92019.png"><br>  <i>Log temperature in our office.</i> <br><br><h4>  Tests </h4><br>  With the product will be in demand, we are happy to understand almost immediately.  The fact is that the first user of the device was our WEB-interface programmer, who without hesitation stuck one in front of his server.  As he explained, this is the easiest way to remotely restart it. <br><br>  All beta testers immediately recalled their dachas.  After a couple of words about the fact that it would be good to get ideas on the use associated with the thermal sensor, the director of our branch suddenly burst into the testing program.  ‚ÄúLast year, my pipes froze at my dacha - let's make a prototype‚Äù - and took one device.  He also became the most active beta tester, because the pipes in the country he was excited quite strongly.  Constantly wrote notes, explained what exactly I want to change in the interface and so on. <br><br>  Closer to winter, we put prototypes in our office and set up to turn on the heaters 1 hour before the start of the working day.  It turned out to be very convenient - warm, and no extra energy consumption for the night.  There are a couple of moments - the washing machine is unlikely to turn on after the power supply, since most of the models have their own programmer and require additional manual pressing of the buttons to start.  Also, for example, intelligent heaters behave (with a control panel). <br><br>  We also looked at crash tests - the socket should survive emergency situations and report about it.  Accordingly, the finals include the following functions: <br><ul><li>  Short circuit protection is provided by zener diodes. </li><li>  When any abnormal potentially dangerous situation, the socket opens the circuit (at the power input). </li><li>  Energy after a power outage lasts for 15 seconds of the radio module and the board.  Since the GPRS session is open all the time, this time is enough to send an alarm to the server so that it notifies the owner about the problem. </li></ul><br>  Considering that we are still working with a thermal sensor, users are asked to collect a temperature graph in their personal account.  It was very simple, but very interesting. <br><br><h4>  Total </h4><br>  The cost of the device is 2,700 rubles, the subscription fee is 99 rubles per month (an unlimited number of SMS alerts are included). <br><ul><li>  Power of connected devices: up to 3 kW. </li><li>  Load output: up to 16A - constant load, up to 70A - short-term load. </li><li>  Own consumption: 110-180mA. </li><li> Autonomous work on the condenser for 15 seconds. </li><li>  Short circuit protection. </li></ul><br><br>  <b>Here is what we got from usabilityists:</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f3/d77/496/3f3d77496b6eba5fa7efc289ae23a55e.png"><br><br>  In general, the product is very clear and has no complaints from the technical side.  However, it is difficult for ordinary users to master it at the first attempt.  The main steps are to refine the web interface.  We have already corrected the installation instructions after these results, changed the interface a bit, implementing step-by-step registration, and reduced all controls to one tab.  Users liked it more.  We also decided not to control the device via IVR, but we plan to make mobile applications instead. <br><br>  PS Socket is now sold in St. Petersburg and Kaliningrad, in the near future - throughout the North-West region. </div><p>Source: <a href="https://habr.com/ru/post/213237/">https://habr.com/ru/post/213237/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../213225/index.html">C ++ garbage collector</a></li>
<li><a href="../213227/index.html">Ideal 404 error page, or how to keep the user on the site?</a></li>
<li><a href="../213231/index.html">Nokia Treasure Tag: smart tags guarding your stuff</a></li>
<li><a href="../213233/index.html">UnionTest / KORAD UT3005EP Laboratory Programmable Linear Power Supply & Calibration / Control</a></li>
<li><a href="../213235/index.html">How we did a car tracker</a></li>
<li><a href="../213239/index.html">Google Fiber expands to 9 more US cities</a></li>
<li><a href="../213241/index.html">Camp game "Torrents"</a></li>
<li><a href="../213243/index.html">Our controller for smart home</a></li>
<li><a href="../213245/index.html">Facebook buys WhatsApp for $ 16 billion</a></li>
<li><a href="../213247/index.html">FDB switch tables. Adventures in the zoo. Part 1 - SNMP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>