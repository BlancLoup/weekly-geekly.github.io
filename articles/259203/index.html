<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sensors and microcontrollers. Part 2. Climate control</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Let us continue the story about the sensors and in this part we consider the various sensors of the most popular DIY-community types - these are numer...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sensors and microcontrollers. Part 2. Climate control</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/files/3f1/34a/d77/3f134ad771154faf95c5d1b9b583d4ea.jpg">  Let us continue the story about the sensors and in this part we consider the various sensors of the most popular DIY-community types - these are numerous temperature sensors and humidity sensors.  In addition, we will touch the air pressure sensors and the presence of gases.  We give a description of the nomenclature of the sensors and refer to the useful literature. <br><br><h4>  <b>Content</b> </h4><br>  <a href="http://habrahabr.ru/post/258967/"><b>Part 1. Mat.</b></a>  <a href="http://habrahabr.ru/post/258967/"><b>part.</b></a>  It considers a sensor that is not tied to any particular measured parameter.  The static and dynamic characteristics of the sensor are considered. <br>  <b>Part 2. Climate control sensors.</b>  It discusses the features of working with sensors of temperature, humidity, pressure and gas composition <br>  <a href="http://habrahabr.ru/post/260639/"><b>Part 3. Sensors of electrical quantities.</b></a>  In it, I touch the measurement of current and voltage <br><a name="habracut"></a><br><h4>  <b>5. temperature sensors</b> </h4><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/4-ZgA_6uCvU%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjVN-_7yCfyyDujtly0YeWrSChTJg" frameborder="0" allowfullscreen=""></iframe><br>  No project on automatic climate control systems can do without a temperature sensor whose main task is to produce the required object with the required accuracy, be it indoor air, cooling fluid, grilled steak or molten metal (In climate control, yeah). <br><br><h5>  <b>5.1 Thermocouples</b> </h5><br>  Generating temperature sensors, which are two conductors of different materials, soldered at one end with each other. <br>  The main advantage of thermocouples is their wide temperature range.  Limited, in fact, by absolute zero and the melting point of metals ‚Äî that is, it can measure there.  Where other sensors are simply powerless - from -270 to +1800 degrees Celsius and above. <br>  Thermocouples are different and, depending on the type of materials used, have a different range of operating temperatures. <br>  Their design also depends on the application.  For example, in one of the laboratories of my native department there were such 200-300mm drunks lying around: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/c7c/99a/9c6/c7c99a9c6e5e4e8cb480c8faef3b0b58.png"><br>  <i>Figure 1 Type K thermocouple for resistance furnaces</i> <br>  And this is how all known K-type thermocouples look, which come complete with multimeters (photo from my collection): <br><br><img src="https://habrastorage.org/files/811/19e/0e5/81119e0e5e4b4c62a033770f017c33fd.jpg"><br>  <i>Figure 2: Type K thermometers for multimeters.</i> <br><br>  The following types of thermocouples with their composition, letter designation and operating range are listed in GOST R 8.585-2001 (the thermopower coefficient for 25 degrees is shown in brackets): <br><ul><li>  platinum-platinum - TPP13 - Type R, range -50 +1600 C (9¬µV / C). </li><li>  platinum-platinum - TPP10 - Type S, range -50 +1600 C (6¬µV / C). </li><li>  platinum-rhodium-platinum-rhodium - TPR - Type B, range 0 +1800  </li><li>  iron-constantan (iron-copper-nickel) TFA - Type J, range -210 +1200  (52mkV / C) </li><li>  copper-constantan (copper-copper-nickel) TMKn - Type T, range -270 +400  (41¬µV / C) </li><li>  Nihrosil-nisilovye (nickel-chromic nickel-nickel-silicon) TNN - Type N, range +270 +1300  (27mkV / C) </li><li>  chromel-alumel - THA - Type K, range -270 +1372  (41¬µV / ). </li><li>  chromel-constantan THKH - Type E, range -270 +1000 C (61mkV / C). </li><li>  chromel-copel - THK - Type L, range -200 +800  </li><li>  Copper Copper - TMK - Type M, range -200 +100 C </li><li>  Silh-silinovye - TSS - Type I (not represented in GOST, is on Wikipedia) </li><li>  tungsten and rhenium - tungstennee - TVR - Type A-1, A-2, A-3, range 0 +1800, (+2500 for A-1) C. </li></ul><br>  By themselves, they are high-precision sensors (accuracy up to ¬± 0.01 degrees), but this accuracy is very difficult to obtain. <br>  The sensors are based on the thermoelectric effect discovered in 1821 by the German physicist Thomas Seebeck.  Its essence lies in the fact that if the junctions of two dissimilar materials forming a closed electrical circuit have different temperatures T1 and T2, then an electric current appears in the circuit, the direction of which depends on the sign of the temperature difference. <br><br><img src="https://habrastorage.org/files/bbf/7ec/682/bbf7ec682f3548118ce24e55caae831a.png"><br>  <i>Figure 3: Thermocouple.</i> <br><br>  But here the first problem appears - the emf depends on the temperature difference between the hot and cold junctions, so the temperature of the cold junction should be known with the necessary accuracy to determine the temperature of the hot end. <br>  A problem is added by the fact that, in fact, the points of connection of the thermocouple to the measuring system are also the junction points of two different metals, which introduces its own error.  Therefore, we place both cold ends together in order to equalize their temperature and we will monitor it with another sensor: <br><br><img src="https://habrastorage.org/files/3fc/c5f/593/3fcc5f5939dc4b1e800f8aa091b5cc68.png"><br>  <i>Figure 4: Cold Junction Software Compensation</i> <br><br>  In this case, by measuring with an ultimate accuracy with an absolute temperature sensor the temperature of the cold junction, we can programmatically compensate for it.  Why can't I use one absolute sensor right away?  Show me another sensor that can measure the temperature of the molten metal. <br>  If there is no absolute sensor at hand, but it is necessary to measure, take another thermocouple, connect it in series in antiphase and place it on Wednesday, the temperature of which we know - for example, water with ice: <br><br><img src="https://habrastorage.org/files/557/246/650/5572466509814e4fbe9d62d273f99e32.png"><br>  <i>Figure 5: Cold Junction Hardware Compensation</i> <br><br>  But in my opinion, in the presence of widely available accurate temperature sensors, it is a little non-technological to use a tank with melting water that requires constant monitoring.  Therefore, in the documentation there are variants of thermostatically controlled cold junctions in which the set temperature is maintained with the help of an accurate thermostat. <br><br><div class="spoiler">  <b class="spoiler_title">By the way, the thermostatic element is not such a rarity.</b> <div class="spoiler_text">  For example, the ‚Äúhyacinth‚Äù reference signal generators standing in the Soviet measuring equipment are a quartz resonator wrapped with high resistance wire and placed in a small Deward vessel in which a certain temperature is maintained.  As a result, frequency stability up to 7-8 decimal places is achieved. <br><br><img src="https://habrastorage.org/files/65e/881/645/65e8816457cd4310b742938bf72234cb.jpg"><br></div></div><br>  We dealt with the problem of relativity, now we will try to take readings from the thermocouple.  And here two more problems await us: <br>  Problem number one - thermoEMF is measured in microvolts.  For example, for a type K thermocouple, the temperature coefficient is 41 ¬µV / degree.  This means that millivolts will smell only degrees through 25 temperature differences. <br>  Let me remind you of the last part that a 12-bit ADC with a reference voltage of 3.3V has a sensitivity of 800 ¬µV.  i.e. in our case 20 degrees / division.  Not bad, however, error.  Of course, you need to take into account the small operating range of the output voltage of the thermocouple and put amplifiers on the base of an op amp, or include amplification in the ADC itself. <br><br>  There will arise other difficulties such as the accuracy of digitizing the ADC, the inherent noise of the analog paths of the OU and the ADC, and so on. <br>  We will follow one truth - to use precision and low-noise OU and ADC.  In the list of additional literature there are many different options for connection schemes.  However, one of the most common circuits in most mass measuring devices is using a thermistor: <br><br><img src="https://habrastorage.org/files/b52/9e6/46b/b529e646bed74703a7504b8c246c8a33.png"><br>  <i>Figure 6: Using a thermistor to compensate for the cold junction temperature</i> <br><br>  Problem number two - thermocouple nonlinear.  The nonlinearity is as follows: <br><br><img src="https://habrastorage.org/files/b94/e18/f3b/b94e18f3bb594a5180f9d795d9bb91c1.png"><br>  <i>Figure 7: Thermocouple Nonlinearity</i> <br><br>  But the blessing is everyone in the course of this non-linearity, each measured measurements were accurately entered into the tablet and calculated the exact coefficients of the polynomials of the form: <br><br><img src="https://habrastorage.org/files/2c9/0ef/97e/2c90ef97e0ca4e4dbc92dd06bef36297.jpg">  (one) <br><br>  To calculate the temperature based on the EMF value and vice versa: <br><br><img src="https://habrastorage.org/files/3ed/652/f51/3ed652f5130640dab01e9409a228d2a5.jpg">  (2) <br><br>  For each type of thermocouple, all the necessary coefficients of approximating polynomials for temperatures relative to 0 degrees Celsius are carefully listed in GOST 8.585-2001.  Here is a list of polynomial coefficients for a common K-type thermocouple: <br><br><img src="https://habrastorage.org/files/3ed/d38/e6e/3edd38e6e7a54ecbb5878ad845f9bc02.png"><br>  <i>Figure 8: A list of polynomials for a type K thermocouple in the temperature range from 0 to 500 degrees Celsius</i> <br><br>  In principle, it‚Äôs not difficult to calculate the total value of work, but if your cold junction dangles in the air at an unknown temperature - who needs it? <br><br>  As a result, the thermocouple is one of the best sensors for accurate measurement of very hot or very cold things. <br><br>  And in my favorite childhood book, Wojciechowski's Radio Electronic Toys, you can find a description of the design of the thermogenerator, from which it is proposed to power, for example, a transistor radio.  And on Mars from a thermogenerator of a similar design, only the smallest more technologically, is powered by the rover Curiosity - On Geektimes there is a survey post about <a href="http://geektimes.ru/post/231197/">RTGs</a> . <br><br><img src="https://habrastorage.org/files/bc2/f6d/6cd/bc2f6d6cd2864a62b6b27c17f7cb637d.png"><br>  <i>Figure 9: Temroelectric 0.6V 8mA battery</i> <br><br><h6>  <b>A moment of senseless and merciless practice.</b> </h6><br>  We have a debug board on an ATmega1280 microcontroller, a pair of thermocouples and a desire to measure the temperature with good accuracy.  And we will not succeed. <br>  The ADC of the controller is 10-bit, the minimum reference voltage can be set to 1.1V. <br>  Then the sensitivity of the ADC will be: <br><br><img src="https://habrastorage.org/files/853/e0a/0e9/853e0a0e93e342b8ae871eaaa8680af0.jpg">  (3) <br><br>  Analog ADC inputs allow operation in differential mode with a maximum gain of 200 times.  However, with such an increase, the reference voltage can only be 2.56V, and only 7 digits remain effective.  Then the sensitivity of the ADC will be: <br><br><img src="https://habrastorage.org/files/634/cd3/75d/634cd375d17a4f41b26780fcb3a7d405.jpg">  (four) <br><br>  Which is about 2.5 times less than the sensitivity of a type K thermocouple (41 ¬µV).  i.e. Theoretically, the accuracy of the measuring path will be no better than ¬± 2.5 degrees.  Practically, noise will prevent us.  And they are according to table 31-8 data protection of whole + -10 characters - that is, the final accuracy will be no better than + -25 degrees.  Hehe.  This we have not yet taken into account two half-meter wires to thermocouples, the lack of proper filtering of analog power and the power of the entire system from a rather noisy USB.  Give Scotch at least ¬± 50 degrees to pack. <br><br>  Let us write a program that will work on interrupts (I sketched it for one of the <a href="http://habrahabr.ru/post/257303/">comments</a> ).  Use the Arduino environment as a loader: <br><br><img src="https://habrastorage.org/files/f71/ef7/f93/f71ef7f93dfc483eb184aaaa7d188768.jpg"><br>  <i>Figure 10: A full-scale experiment with two thermocouples, glasses and paper clips</i> <br><br><div class="spoiler">  <b class="spoiler_title">Source:</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ autoadcsetup(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> coeff[] = {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2.508388e1</span></span>, <span class="hljs-number"><span class="hljs-number">7.860106e-2</span></span>, <span class="hljs-number"><span class="hljs-number">-2.503131e-1</span></span>, <span class="hljs-number"><span class="hljs-number">8.315270e-2</span></span>, <span class="hljs-number"><span class="hljs-number">-1.228034e-2</span></span>, <span class="hljs-number"><span class="hljs-number">9.804036e-4</span></span>, <span class="hljs-number"><span class="hljs-number">-4.413030e-5</span></span>, <span class="hljs-number"><span class="hljs-number">1.057734e-6</span></span>, <span class="hljs-number"><span class="hljs-number">-1.052755e-8</span></span> }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">autoadcsetup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">//set up TIMER0 to 61Hz //TIMER0_OVF will be the trigger for ADC /*normal mode, no prescaler 16MHz / 256 /1024 = 61 Hz*/ TCCR0B = (1 &lt;&lt; CS02) | (1 &lt;&lt; CS00);//timer frequency = clk/1024 //set ADC. ADMUX = (1 &lt;&lt; MUX3) | (1 &lt;&lt; MUX1)| (1 &lt;&lt; MUX0) | (1 &lt;&lt; REFS1)| (1 &lt;&lt; REFS0);//10-bit mode, ADC9-ADC8 channel, Gain 200, 2.56V ref ADCSRA = (1 &lt;&lt; ADEN) | (1 &lt;&lt; ADATE) | (1 &lt;&lt; ADIE) | (1 &lt;&lt; ADPS2)| (1 &lt;&lt; ADPS1)| (1 &lt;&lt; ADPS0);//TUrn ADC On, trigger enable, Interrupt enable, sysclk/128=125kHz_ADC_clk=9.6kHz conv freq(13ticks per conversion) ADCSRB = (1&lt;&lt; ADTS2) | (1 &lt;&lt; MUX5);//Auto trigger source //set UART to 8-n-1 1Mbod: UBRR0H = 0;//9600(use Examples of Baud Rate Setting table from datasheet) UBRR0L = 103;//9600 UCSR0B = (1&lt;&lt;TXEN0);//enable Transmitter UCSR0C = (3&lt;&lt;UCSZ00);//8-bit mode } int32_t result=0; float t=0; ISR(ADC_vect){ if( ( UCSR0A &amp; (1&lt;&lt;UDRE0)) ){ //calc: t=0; result = (ADCH &gt;&gt;1)*2560/512;//calc voltage in mV float edc = static_cast&lt;float&gt;(result);//convert to float for (uint8_t i = 0; i &lt; 10; i++){ t += coeff[i] * pow (edc, i); } UDR0 = static_cast&lt;uint8_t&gt;(t); } }</span></span></code> </pre> <br></div></div><br>  For boiling water around one thermocouple and glass with melting ice around the other at the exit is solid porridge with an average value of the first two lines of 124 degrees, which is a very good result - we will assume that we are within the accuracy of + -25 degrees. <br><br><img src="https://habrastorage.org/files/402/600/20a/40260020aba24fa39678199ba163afa1.png"><br>  <i>Figure 11: Raw Output</i> <br><br>  Of course, this hack does not represent any practical significance, and more accurate ADCs must be used to measure the temperature using a thermocouple.  For example, the ADuCM360 microcontroller has a good integrated ADC, and it is designed specifically for such small input signals.  There are specialized external ADCs for thermocouples - for example, Maxim Integrated manufactures several thermocouple chips - <a href="">MAX31850, MAX31851, MAX31855, MAX31856</a> .  <a href="http://www.analog.com/ru/products/sensors/temperature-sensor-control-devices/analog-temperature-sensors.html">Analog Devices has</a> drivers. The budget option will be the use of pre-amplifiers on low-noise op amps for our ADC.  I showed good results LMP2011. <br><h5>  <b>5.2 Resistance thermometers and thermistors</b> </h5><br>  As is known, the resistance of the metal varies with the ambient temperature.  This effect is used to conduct highly accurate (up to thousandths of a degree) temperature measurements using resistance thermometers.  Being made not from metal, but from a semiconductor, we get a thermistor. <br><br><img src="https://habrastorage.org/files/00f/a14/d91/00fa14d9166c4238a9d19569385cb261.png"><br>  <i>Figure 12: Honeywell Platinum RTD</i> <br><br>  Resistance thermometers allow you to work in a fairly wide range of temperatures - from -200 to 850 degrees. <br>  The resistance thermometer has two main characteristics: <br><ol><li>  Base resistance at a certain temperature.  Recommended - 10, 50, 100, 500, 1000 Ohms ... </li><li>  Temperature coefficient of resistance in thousandths in propromille per degree Kelvin (ppm / K). </li></ol><br>  Temperature coefficient of resistance is the ratio of the relative change in resistance to temperature change: <br><br><img src="https://habrastorage.org/files/0ca/438/34d/0ca43834d7e040dbb7a0c75b57c52020.jpg">  (five) <br><br>  Thus, knowing the current resistance of the thermistor and knowing its TKS and nominal temperature, you can calculate the current temperature: <br><img src="https://habrastorage.org/files/ef6/3c9/f44/ef63c9f443044c6690402b2cecff69fd.jpg">  (6) <br><br>  Thermometers of resistance have GOST R 8.625-2006, in which thermometers from platinum (TKS = 0.00385 and 0.00391), as well as from copper (TKS 0.00428) and nickel (TKS 0.00617) are normalized.  Nominal resistance for thermometers is resistance at a temperature of 0 degrees.  Like thermocouples, resistance thermometers have some non-linearity, but the polynomial coefficients are carefully listed in the GOSte.  By the way - much simpler than for thermocouples. <br>  For example, for a platinum thermometer with TKS = 0.00385 and a measurement range from -200 to 0 degrees there will be an equation of the form: <br><br><img src="https://habrastorage.org/files/888/d0c/a85/888d0ca857184793a02a0164f38d525b.jpg">  (7) <br><br>  And for the range of 0-850 degrees: <br><br><img src="https://habrastorage.org/files/795/63b/44d/79563b44d94c4de19a3d90fe45c4d89b.jpg">  (eight) <br><br>  With the following coefficient values: <br><br><img src="https://habrastorage.org/files/dd5/132/335/dd51323356904f138a18b1af93e8dcbf.jpg">  (9) <br><br>  One of the most popular is the standard platinum thermometer series 700 from Honeywell.  Although the cost of platinum thermometers are not cheap - from $ 5 or higher, depending on the temperature range and accuracy of the device. <br><br>  Measure resistance can be a variety of methods.  The simplest and recommended GOST is a measuring bridge with a voltage source.  On the other hand, connecting to a current source and using the differential input of the ADC will give a linear measurement. <br><br><img src="https://habrastorage.org/files/e7e/ea8/f00/e7eea8f00e1240689337d41dca7c45d0.png"><br>  <i>Figure 13: Different ways to connect two-wire RTD</i> <br><br>  I quote Comrade <a href="http://geektimes.ru/users/stross/" class="user_link">Stross</a> from the comments on the previous part: <br><blockquote>  The bridge can be considered as two resistive dividers connected in parallel.  One of them sets the "reference voltage" for the second.  And thus, when using a bridge, with your differential ADC, you will measure the voltage on the divider not relative to zero, but relative to a certain support.  This will have a good effect on sensitivity - you can set the ADC to a higher preamp ratio and ensure that the working range of the ADC will correspond to a narrow range of resistances. </blockquote><br>  On the other hand, your ADC in input gain modes should not make noise like a lone stream flowing from a fuji tractor <br>  In the annex to the section there are many useful links on connecting RTD and ways to improve accuracy. <br>  One of the problems of metallic resistance thermometers is low TKS, due to which a measuring path with high sensitivity is needed.  But this is only a constructive problem - measuring resistance with high accuracy, unlike very low currents and voltages, is not difficult. <br>  If we do not need high accuracy and enough ¬± 1-2 degrees, then you can use semiconductor thermistors, which have orders of magnitude higher TKS.  For example, thermistors of the KTY84 series from NXP have TKS = 0.61.  On the other hand, thermistors have a smaller operating temperature range of about -40 = 300 degrees. <br>  And thermistors are much more non-linear.  But again, the data of TKS and nominal resistance for different values ‚Äã‚Äãof temperature are carefully given in data boards: <br><br><img src="https://habrastorage.org/files/677/2a5/59e/6772a559e38747fcba7d830194849bc1.png"><br>  <i>Figure 14: Correspondence table of TCS, nominal resistance and temperature</i> <br><br>  According to this table, it will not be difficult to construct a piecewise linear function and use it to determine resistance. <br><br><h5>  <b>5.3 Linear Analog Converters</b> </h5><br><img src="https://habrastorage.org/files/180/6e4/348/1806e43487294995954de69a37be6546.png"><br>  <i>Figure 15: LM35DZ linear analog sensor</i> <br>  Let's move on to more integrated solutions.  Consider an analog linear temperature sensor chip.  This microcircuit is connected to a voltage source and gives the output an analog signal, linearly dependent on temperature with a slope of 10-20 mV / K.  The range of measured temperatures is much narrower than that of the previously presented sensors and averages -40 + 125 degrees.  Since our simple 10-bit ADC has a sensitivity of 1 mV, it is more than enough to read the readings from this sensor. <br>  Another useful property of these sensors is that their output voltage does not depend on the supply voltage, which can vary widely - for example, for the LM35 sensor from National Semi, the supply voltage range is 4-30V.  The accuracy of the sensors is 1-2 degrees.  It looks like a graph of the accuracy of the sensor depending on the temperature: <br><br><img src="https://habrastorage.org/files/6d2/c94/6bc/6d2c946bcb32470e98ac98cf0aadff22.png"><br>  <i>Figure 16: Sensor Accuracy vs. Temperature</i> <br><br>  There is nothing more to say about this sensor, so we are diverging. <br><br><h5>  <b>5.4 Digital temperature sensors</b> </h5><br>  Digital temperature sensors behind their huge range of conceal convenient integrated solutions that provide the ability to obtain temperature readings in finished form through digital interfaces. <br>  As a rule, digital temperature sensors are connected via SPI and I2C interfaces.  As for me, temperature sensors are low-speed devices and SPI waste on them. <br><br>  As an example, consider the SHT10 combined temperature and humidity sensor: <br><br><img src="https://habrastorage.org/files/816/9e6/6e0/8169e66e08bd427eab0bb9fdd425d189.png"><br>  <i>Figure 17: Sensor SHT10 general view</i> <br><br><img src="https://habrastorage.org/files/8d2/5b5/f55/8d25b5f552d04486ad0a07b7afe8a0df.png"><br>  <i>Figure 18: Sensor Error</i> <br><br>  But this sensor is not without a jamb - its interface is ‚Äúoptimized‚Äù.  Type in order to make it easier to count.  And it can not be addressed as an I2C device. <br><br><img src="https://habrastorage.org/files/50f/227/254/50f2272542974896ba777a42e685f747.png"><br><br>  Fortunately, the sensor allows you to connect yourself together with other devices, and you just need a software switch protocol communication.  We‚Äôll dwell on it a bit more: <br><br>  To start a command transfer, you must transfer the starting sequence: <br><br><img src="https://habrastorage.org/files/4f8/24c/177/4f824c1771534df4beceb00954cd52d0.png"><br>  <i>Figure 19: Starting Sequence</i> <br><br>  After the start sequence, the command byte is transmitted, consisting of 0 address bits (only address 000 is supported) and 5 instruction bits. <br><br><img src="https://habrastorage.org/files/8e4/50e/47a/8e450e47a4ba4932908703130420bc51.png"><br>  <i>Figure 20: Command List</i> <br><br>  After sending a command to measure temperature or humidity, depending on the bit width of 8, 12 or 14 bit measurements, the measurement procedure will take 20, 80 or 320 ms.  Upon completion of the measurement process, the sensor will attract the DATA line to zero and go to sleep.  As soon as the controller receives this signal, by clocking the SCK line, it is possible to receive two data bytes and a checksum byte (if it is activated), and at the end of each byte reception it is necessary to attract the controller to attract the ground to zero.  The data is transmitted with the right hand out, i.e. For a 14-bit value, the most significant data bit will appear only on the 5th tick of the SCK line.  For details, I send to the data sheet. <br>  The temperature sensor has a linear characteristic and the resulting sensor value is recalculated taking into account the supply voltage and the slope of the characteristic: <br><br><img src="https://habrastorage.org/files/fd2/89d/57b/fd289d57b3f24b78bb1af52113aa2775.png"><br>  <i>Figure 21: Calculate Temperature</i> <br><br>  Of course, there are temperature sensors with a normal I2C interface.  For example, LM75A from NXP. <br><br>  Its data reading diagram follows the basic I2C principles: <br><br><img src="https://habrastorage.org/files/a7a/1f4/e10/a7a1f4e10433479fbf54d7363e1bda12.png"><br>  <i>Figure 22: Reading Temperature Data from the LM75</i> <br><br>  This is an 11-bit sensor, with a resolution of 0.125 degrees Celsius, the output data is stored in two data registers with a specific address.  Using the I2C commands for our device, which has the address 1001XXX (three lower bits are set by the user and allow you to connect up to 8 such sensors to one bus), we set the register address pointer from which we start reading and using the read command we read two registers.  The resulting sign value is multiplied by 0.125 and we get the final temperature value in degrees Celsius.  Conveniently. <br><br><h5>  <b>5.5 DS18B20</b> </h5><br><img src="https://habrastorage.org/files/bbe/6fb/07a/bbe6fb07afda42fca350731aaa7cc201.png"><br>  <i>Figure 23: DS18B20 Digital Sensor</i> <br><br>  This sensor should be given special attention.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is a 12-bit temperature sensor with an operating range of -55 + 125 degrees Celsius, connected via the 1-wire protocol. Its main advantage is that you can hang dozens of these sensors on one line and they will all work. The sensor is very accurate ¬± 0.5 degrees, but slow - the measurement time is 750ms. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inside the sensor 9 registers, registers 0 and 1 store the value of the measured temperature, registers 2 and 3 can be used as general purpose memory, 4 registers stores the configuration according to the following table: </font></font><br><br><img src="https://habrastorage.org/files/006/c32/de0/006c32de0363490bb31a1211e83e4e15.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 24: Assignment of the configuration register bits The</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CRC is the ninth byte of the register memory. Calculated using the following formula based on the first 8 registers:</font></font><br><br><img src="https://habrastorage.org/files/e8d/404/03e/e8d40403ed1f45fe9a5b19371b973598.jpg">  (ten) <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In order to run the temperature calculation command, you must send the command 0x44. </font><font style="vertical-align: inherit;">Upon completion of the measurement process, the data will lie in the first two bytes of the register memory until the next measurement. </font><font style="vertical-align: inherit;">Reading 9 bytes of register memory data is performed by issuing the command 0xBE. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In general, this sensor, having a very affordable price, allows, using long lines of communication, to organize a network of sensors covering one or another area. </font><font style="vertical-align: inherit;">For example, you can mesh sensors in a greenhouse and monitor the temperature gradient inside it.</font></font><br><br><h5> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.6 IR temperature sensor</font></font></b> </h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This review would be incomplete without contactless IR temperature sensors. I casually mentioned it when I talked about the CC3200-launchxl board - there is such a sensor installed there. </font></font><br><br><img src="https://habrastorage.org/files/0cc/364/ed7/0cc364ed78bb4352a0645abeab8f1bf1.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 25: IR thermal sensor</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> These sensors consist of a thin plate. Absorbing IR radiation, as a result of which it is heated, which is detected by the thermal sensors described above. For example, in the Texas Instruments TMP006 sensor, judging by the image inside the set of series-connected thermocouples, the signal from which is removed and converted to digital with access via I2C. Hostess for a note - this sensor measures the temperature from -40 to +125 degrees with an accuracy of ¬± 1.5 degrees. I, as the owner of this sensor on the debug board, am gradually playing with it.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are analog solutions. </font><font style="vertical-align: inherit;">For example, TPS333 sensors from Excelitas have an internal thermistor inside. </font></font><br><br><img src="https://habrastorage.org/files/45e/b83/b7d/45eb83b7d1ed4f6a9514c29f2be14097.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 26: TPS333 sensors from Excelitas Of</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> course, the most interesting are contactless IR arrays, on the basis of which thermal imagers are made. </font><font style="vertical-align: inherit;">For example, the D6T-44L-06 sensor from Omron for $ 35 is a 4x4 bit matrix, with which you can measure the temperature from 5 to 50 degrees at a distance of up to 3 meters. </font></font><br><br><img src="https://habrastorage.org/files/c7a/0ba/716/c7a0ba716bca411e9695b8c4720be2e4.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 27: Detection area.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Here is a cool video presentation from the manufacturer:</font></font><br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/4UT1GBTdmzQ%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhibq9JohhR-x_kRvMN8W1gHzeOPpQ" frameborder="0" allowfullscreen=""></iframe><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The resolution of the sensor is of course so-so, and the temperature range is not very large, but such a matrix has its own niche, and the price pleased me personally. </font><font style="vertical-align: inherit;">You can take note.</font></font><br><br><h5> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.7 Further reading</font></font></b> </h5><br><ul><li> <a href="http://ww1.microchip.com/downloads/en/AppNotes/00844a.pdf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ww1.microchip.com/downloads/en/AppNotes/00844a.pdf</font></font></a> </li><li> <a href="http://cds.linear.com/docs/en/application-note/an28f.pdf">cds.linear.com/docs/en/application-note/an28f.pdf</a> </li><li> <a href="http://www.analog.com/library/analogDialogue/archives/44-10/thermocouple.html">www.analog.com/library/analogDialogue/archives/44-10/thermocouple.html</a> </li><li> <a href="http://www.ti.com/lit/an/snoa663b/snoa663b.pdf">www.ti.com/lit/an/snoa663b/snoa663b.pdf</a> </li><li> <a href="http://www.ti.com/lit/an/sbaa134/sbaa134.pdf">www.ti.com/lit/an/sbaa134/sbaa134.pdf</a> </li><li> <a href="http://www.ni.com/tutorial/7115/en/">www.ni.com/tutorial/7115/en</a> </li><li> <a href="https://www.acromag.com/sites/default/files/RTD_Temperature_Measurement_917A.pdf">www.acromag.com/sites/default/files/RTD_Temperature_Measurement_917A.pdf</a> </li><li> <a href="http://newton.ex.ac.uk/teaching/CDHW/Sensors/an046.pdf">newton.ex.ac.uk/teaching/CDHW/Sensors/an046.pdf</a> </li><li> <a href="http://www.analog.com/library/analogdialogue/archives/47-09/3_wire_rtd.pdf">www.analog.com/library/analogdialogue/archives/47-09/3_wire_rtd.pdf</a> </li><li> <a href="http://www.ti.com/lit/ug/slau520a/slau520a.pdf">www.ti.com/lit/ug/slau520a/slau520a.pdf</a> </li></ul><br><h4> <b>6  </b> </h4><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/LjuYU55WyyE%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhBkL-guhX2RxHVPfic-M-VqaAY2w" frameborder="0" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No climate control system will be complete without measuring the relative humidity of the air, since the comfort of a person in a controlled room depends on it. I think many people are familiar with the comfort zone graph: </font></font><br><br><img src="https://habrastorage.org/files/373/376/70d/37337670d2524d2f9c7c4a443de0b3c3.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 28: The comfort zone in</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Russia In Russia, acceptable values ‚Äã‚Äãfor temperature and humidity in residential areas are regulated by SanPiN 2.1.2.2645-10 ‚ÄúSanitary and epidemiological requirements for living conditions in residential buildings and rooms‚Äù (Appendix 2). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The task of the humidity sensors is to determine the relative humidity of the air. Relative humidity of air is the ratio of the partial pressure of water vapor in the air to the equilibrium pressure of saturated vapor at a given temperature:</font></font><br><br><img src="https://habrastorage.org/files/665/e77/660/665e77660e144b39b9695aed08ad7216.jpg">  (eleven) <br>  Where <img src="https://habrastorage.org/files/0f3/283/6d6/0f32836d6cdd46e99051f6a4dcb9ea03.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- partial pressure of water vapor in the air, </font></font><img src="https://habrastorage.org/files/a46/a72/741/a46a72741b104ed880032a058a0331f4.jpg"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- equilibrium pressure of saturated steam. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are several ways to measure air humidity. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of course it is worth mentioning the classic psychrometers - the assembly of a dry and wet thermometer, the difference in the readings of which fairly accurately determines the current humidity of the air. Nobody forbids to take two temperature sensors, one of them to supply wet cotton wool and on the basis of their readings to calculate the humidity. </font></font><br><br><img src="https://habrastorage.org/files/56d/722/f79/56d722f79e2042b4a166adf169df59e4.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 29: Psychrometer</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Next are mechanical hygrometers, where the defatted hair or polymer film acts as a sensitive element, changing its length depending on humidity. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But we are more interested in solutions with an electrical signal at the output.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Such sensors react to moisture by changing the capacity or resistance of a hygroscopic material saturated with moisture in an amount proportional to the partial vapor pressure of the measured air. </font><font style="vertical-align: inherit;">Widely received capacitive sensors. </font><font style="vertical-align: inherit;">Therefore, only we will consider them. </font></font><br><br><img src="https://habrastorage.org/files/b53/f69/bd5/b53f69bd5547425b9d69534d3e19ba26.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 30: Moisture Sensor Structure.</font></font></i> <br><br><h5> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.1 Humidity sensors with capacitive output</font></font></b> </h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The easiest in nature sensor. It is a capacitor with variable capacitance. The capacity of such a condenser is primarily dependent on humidity. But not the last indicator is the air temperature. For example, for a Honeywell HCH-1000 series sensor, the sensor sensitivity averages 0.6 pF /% RH. In this case, the temperature coefficient is 0.16 pF / degree. Clearly, the capacitance change graph looks like this: </font></font><br><br><img src="https://habrastorage.org/files/f94/c85/8d1/f94c858d1fae4622aab67352313752d0.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 31: HCH-1000 sensor capacitance variation</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Unlike resistance. Capacity is much more difficult to measure. Exact professional devices - immitance meters (RLC-meters) - not the cheapest equipment.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A simple way to measure capacitance is to determine the rate of charge and discharge of an RC chain. Determining the charge time constant with the required accuracy and knowing the exact resistance of the resistor, we can determine the capacitance of the capacitor. </font></font><br><br><img src="https://habrastorage.org/files/796/055/a40/796055a40efa4c84a6d1046a99459497.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 32: capacitor charge</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Since our capacitance varies between 300-360pF, to obtain a time constant of 1-2ms (which will be easy to catch with most timers and an ADC), resistance will be required</font></font><img src="https://habrastorage.org/files/6e3/496/0a7/6e34960a76bf484b94099feacfd861fd.jpg">  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">With this method of measurement, we need to measure the current charge level of the capacitor with the necessary accuracy, as well as note the time it takes for the capacitor to reach 63.2%. The procedure for reliability can be repeated several times. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is another way, though less stable: since we measure the period, then let us have a pulse signal. Let the capacitive sensor responsible for the frequency of signal generation. Humidity changes - output frequency changes. At the output of the buffer element D1.3 there will be a signal whose frequency depends on the capacity of our sensor. The only question is the accuracy of the threshold voltages of logic elements. By the way, the accuracy of the sensor HCH-1000 ¬± 2%. </font></font><br><br><img src="https://habrastorage.org/files/822/37b/8a1/82237b8a112e41a58b05a09f242e0c6d.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 32: A Simple Logic Generator</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Do not forget that to improve the accuracy of the testimony, it is necessary to take into account the current temperature indicators. </font></font><br><br><h5> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.2 Moisture Sensors with Voltage Output</font></font></b> </h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The electronics industry has already worked for us and has created devices that produce the finished analog signal. </font><font style="vertical-align: inherit;">An example of such sensors are HIH-4010 sensors from Honeywell, with an accuracy of ¬± 8%. </font></font><br><br><img src="https://habrastorage.org/files/bce/2f0/ab0/bce2f0ab03d949c4ab39f1830afc9237.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 33: Humidity sensors with voltage output. </font><font style="vertical-align: inherit;">General view</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> For such sensors, graphs of output voltage versus humidity are indicated in the data sheet: </font></font><br><br><img src="https://habrastorage.org/files/0db/565/83b/0db56583b53249c58638d3309dfb1635.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 34: Sensor output voltage versus humidity</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> With such sensors, a calibration passport is often supplied that contains output values ‚Äã‚Äãfor two different humidity values ‚Äã‚Äãat a certain temperature. . </font><font style="vertical-align: inherit;">Sufficiency to specify this data in the program and we get ready calibrated sensor values.</font></font><br><br><h5> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.3 Humidity sensors with digital output</font></font></b> </h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Our latest sensor in this category will be a digital humidity sensor. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We have already reviewed one of them in the section of temperature sensors - this is SHT1x. </font><font style="vertical-align: inherit;">However, there are many combined humidity and temperature sensors and, to be honest, I did not come across digital pure humidity sensors, which, incidentally, is not surprising - one without the other anywhere. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We continue our discussion regarding the calculation of humidity from the SHT1x sensor. </font><font style="vertical-align: inherit;">Derived from this sensor must be converted. </font><font style="vertical-align: inherit;">In the datasheet are the necessary formulas:</font></font><br><br><img src="https://habrastorage.org/files/1e5/85d/953/1e585d95342140ddb6fd25d03c78fcdd.jpg">  (12) <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And the polynomial coefficients: </font></font><br><br><img src="https://habrastorage.org/files/51c/76f/617/51c76f617dac4c68b13fa841ad59b97d.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 35: Polynomial coefficients for the V4 version</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It should be noted that the relative humidity depends on the temperature and requires an adjustment using the following formula: </font></font><br><br><img src="https://habrastorage.org/files/081/bc2/4d1/081bc24d1c354b63bd5bbac94c6b6cc1.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 36: The relative humidity correction depending on the temperature</font></font></i> <br><br><h4> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7 pressure sensors</font></font></b> </h4><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/Yx0SCIDRHQM%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjpeRrlrvcHxkgulAx5LN2FxjdIqw" frameborder="0" allowfullscreen=""></iframe><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A pressure sensor is a sensor that records the pressure of the medium being measured, which can be air, gas or liquid. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Depending on the task, it may be necessary to measure both absolute pressure, pressure relative to atmospheric pressure, and differential pressure ‚Äî that is, the pressure difference between two measurement points. </font></font><br><br><img src="https://habrastorage.org/files/072/2db/a56/0722dba56f2d4cc7b370e64fc1e123dd.jpg"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 37: Pressure. </font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the technical characteristics of the sensors can be specified different units of measurement:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> millimeters of mercury - mm Hg; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pascal - Pa, Pa; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pound-force per square. </font><font style="vertical-align: inherit;">inch - Psi</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bar - bar </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Physical atmosphere - ATM </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To assess the working range of the sensor, remember that 1 atm is approximately 1 bar or 100 kPa; similar to 760 mm Hg and 15psi. The second after kPa in the sensors is psi, so just remember that 100psi is about 7 atm. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wikipedia has a wonderful table with exact conversion factors from one unit of measurement to another: </font></font><a href="https://ru.wikipedia.org/wiki/%25D0%2595%25D0%25B4%25D0%25B8%25D0%25BD%25D0%25B8%25D1%2586%25D1%258B_%25D0%25B8%25D0%25B7%25D0%25BC%25D0%25B5%25D1%2580%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25B4%25D0%25B0%25D0%25B2%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://ru.wikipedia.org/wiki/Use of</font></font></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pressure_measurement_ pressure sensor is a sensitive element placed between two cameras - in one there is a measured pressure, in the other - reference. In absolute sensors, the impact on the crystal is only from one side. Consider the cut-away MPX2100 sensor diagram from Freescale: </font></font><br><br><img src="https://habrastorage.org/files/c0d/70d/9d4/c0d70d9d49854262bd20c6b1616c8c05.jpg"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 38: The design of the relative and absolute pressure sensor</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The figure shows a sensitive element that changes its properties under the pressure difference. There are several types of sensitive elements. One of the most common - strain gauge - the change in the resistance of the material under the influence of deformation. Often a monocrystal of silicon is taken as the material of such a sensor. One of the problems is the dependence of the sensor resistance on temperature, but, as a rule, thermal compensation is present in all sensors. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Another sensitive element under pressure changes its capacity. In the section of humidity sensors, we have already discussed that this method is problematic for subsequent measurements, and pressure sensors with capacitive output have never been caught by me.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is also a piezoelectric effect, where the sensing element generates a voltage under the influence of a certain pressure. </font><font style="vertical-align: inherit;">By the way, I have one such - it is installed in the charging station ZD-6 of a set of individual dosimeters ID-1. </font><font style="vertical-align: inherit;">The charger contains 4 parallel-connected piezoelectric elements and a mechanical amplifier that presses on the piezoelectric elements; </font><font style="vertical-align: inherit;">pressure is created by a rotating knob. </font><font style="vertical-align: inherit;">It is used to generate a voltage of 180-250V for charging the dosimeter. </font></font><br><img src="https://habrastorage.org/files/7a7/445/8dc/7a74458dcf474cff9fc2b0a59de28a59.jpg"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 39: Dose meter ID-1</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> There are sensors of other types - inductive, resonant and others, but they are found in very industrial facilities and we will not consider them in this article.</font></font><br><br><h5> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.1 Analog Pressure Sensors</font></font></b> </h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At the output of analog pressure sensors there is a level of current or voltage that must be fed to the measuring path of our device. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's make a small lyrical digression and mention sensors with industrial analog signal levels of 0-10V and 4-20mA, intended for connection to industrial automation. Harsh industrial sensors can be seen immediately: </font></font><br><br><img src="https://habrastorage.org/files/fa0/9ce/892/fa09ce89299e4f7892604637e778e5f9.jpg"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 40: Harsh industrial pressure sensors</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> However, their wiring is similar to everything described in section 3: </font></font><br><br><img src="https://habrastorage.org/files/712/d78/7df/712d787df85f43f496f8e9e091b4074c.jpg"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 41: Connecting an industrial sensor</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> By installing a voltage divider, or selecting a shunt resistance so that the output signal level matches the input ADC range, these sensors can be connected to conventional microcontrollers.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">With pressure sensors built according to the bridge balance scheme, there is often the same problem as with thermocouples - many sensors provide only about 40mV for their entire range. For example, this is how the output voltage depends on the pressure for the MPX2100 sensor: </font></font><br><br><img src="https://habrastorage.org/files/941/6df/2f3/9416df2f3cf04d86adf8664ccaaeaa09.jpg"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 42: Dependence of the output voltage of the sensor on pressure</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> So we </font><font style="vertical-align: inherit;">arm ourselves with a </font><font style="vertical-align: inherit;">differential low-noise ADC and forwards. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the other hand, there are more convenient, but more expensive sensors that have a 0-5V, or 0-3.3V output signal and the like, depending on the supply voltage. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">These sensors include 40PC from Honeywell: </font></font><br><br><img src="https://habrastorage.org/files/beb/559/8c8/beb5598c809e4f028b9282c106418fbe.jpg"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 43: 40PC sensor from Honeywell</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Any microcontroller ADC can digitize the output signal of such a sensor. </font><font style="vertical-align: inherit;">That's just with its accuracy of 0.2% of its value on the market - about $ 40-50.</font></font><br><br><h5> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.2 Digital pressure sensors</font></font></b> </h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Digital pressure sensor allows you to receive all the data in a more technological way. </font><font style="vertical-align: inherit;">Its essence is the same - a piezoresistive bridge, differential ADC and interface. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is what the inside of the MEMS sensor LPS331 from ST in a 3x3x1mm package looks like: </font></font><br><br><img src="https://habrastorage.org/files/fb1/1a8/800/fb11a88000a04fe9aa619ff333af817d.jpg"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 44: Block diagram of the pressure sensor LPS331</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> All digital pressure sensors have an integrated temperature sensor and, accordingly, thermal compensation. </font><font style="vertical-align: inherit;">The sensitivity of this particular pressure sensor is ¬± 200Pa. </font><font style="vertical-align: inherit;">Of course, the temperature from this sensor is also available, with an accuracy of ¬± 2 degrees.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One of the applications of the pressure sensor is barometric altimetry - that is, the determination of relative altitude. </font><font style="vertical-align: inherit;">As you know, as the height changes, the air pressure decreases. </font><font style="vertical-align: inherit;">So we will set a zero height on the ground and by rising up, or going down you can determine the distance traveled. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The dependence of air pressure on height is as follows: </font></font><br><br><img src="https://habrastorage.org/files/1f8/ec6/342/1f8ec63427ff4af6a0a1ae56bf828486.jpg"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 45: dependence of air pressure on height</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> To play, I can recommend the </font></font><a href="http://www.ti.com/tool/ez430-chronos%26DCMP%3DChronos%26HQS%3DOther%2BOT%2Bchronos"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EZ430 ‚Äë Chronos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> clock-debug kit </font><a href="http://www.ti.com/tool/ez430-chronos%26DCMP%3DChronos%26HQS%3DOther%2BOT%2Bchronos"><font style="vertical-align: inherit;">from Texas instruments</font></a><font style="vertical-align: inherit;"> based on the CC430F6137 controller. </font><font style="vertical-align: inherit;">On Habr√© there is a </font></font><a href="http://habrahabr.ru/post/114216/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">description of</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> this clock. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">They are embedded in a digital pressure sensor Bosh BMP085 worth $ 4. </font><font style="vertical-align: inherit;">It has a working range of 30-110 kPa and dimensions 5x5x1.2mm.</font></font><br><br><img src="https://habrastorage.org/files/5eb/7b0/fd1/5eb7b0fd1e68449a876e756f0b078ce0.jpg"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 46: In a few minutes they will show 4500. Meters.</font></font></i> <br><br><h4> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8 Gas Presence Sensors</font></font></b> </h4><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/yITi8mXlckE%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhz7bCBQWvkwR8k2jTLAgog_ELNEw" frameborder="0" allowfullscreen=""></iframe><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The sensors previously described make it possible to measure what we can sense on our own. </font><font style="vertical-align: inherit;">But there may be something else in the air that can kill us completely unnoticed. </font></font><br><br><img src="https://habrastorage.org/files/1dc/9ab/f24/1dc9abf24ee64f8880aec0749c5c7725.jpg"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 47: Gas Presence Sensor</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> This is gas. </font><font style="vertical-align: inherit;">CO2, CO, methane, propane, ammonia, hydrogen, ethanol, refrigerants and other gases. Most of which are difficult to detect, but which will lead to serious consequences. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A sensor of a certain type is designed, as a rule, only for one specific gas, so if you want to control different gases, then you need to use several sensors.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Various FIGARO sensors are most common, so we will look at them using the example of the TGS2442 carbon monoxide sensor. The sensitive element of such sensors is tin oxide (SnO2). The sensor has a multilayer structure. </font></font><br><br><img src="https://habrastorage.org/files/c38/51b/230/c3851b2309344161802eefcb633a64fe.jpg"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 48: Gas Sensor Structure</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> First comes a selective filter that passes the target gas and reduces the influence of other gases. After there is a camera with a sensitive element about four contacts. Two contacts are for the heater and two more for the resistor, the resistance of which depends on the gas concentration. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The sensor is connected as follows: </font></font><br><br><img src="https://habrastorage.org/files/e8f/ec7/428/e8fec74281ef4f778b2f5e13235d0e41.jpg"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 49: Gas sensor connection</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The accuracy of determining the concentration directly depends on the accuracy of the heating time and the time of the signal removal. Both circuits are connected to the power supply for a short time to prevent overheating of the sensitive material. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The heater is supplied with a voltage of 4.8V every second, with a duration of 14 ms. Average heater current 200mA. 5ms before the heater is turned on for 5ms, the meter circuit is turned on and the resistance is measured. </font></font><br><br><img src="https://habrastorage.org/files/c43/298/367/c4329836760148388336b43992e7c60a.jpg"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 50: Gas sensor operation cycle The</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> total gas concentration is determined depending on the ratio of the measured resistance to the resistance at a gas concentration of 100 propromille. The dependence is clearly seen in the following graph: </font></font><br><br><img src="https://habrastorage.org/files/fdd/d9e/47b/fddd9e47bdfe45009809d235c4c58811.jpg"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 51: Gas sensitivity. Ro = Rs at 100 ppm CO</font></font></i> <br><br><h4>  <b>PS</b> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This part has turned out more reference than practical, but I hope that this material will help in choosing the type of sensors for your future climate control system. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the final part of the cycle about the sensors, I will talk about current and voltage sensors, the knowledge of which we will apply when creating a homemade electricity metering device and calculating energy parameters. </font><font style="vertical-align: inherit;">I decided to split and bring up the issues of frequency, reactive and active power, power factor and harmonic distortion in a separate cycle.</font></font></div><p>Source: <a href="https://habr.com/ru/post/259203/">https://habr.com/ru/post/259203/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../259193/index.html">Qucs project news: preparing for release 0.0.19</a></li>
<li><a href="../259195/index.html">The digest of interesting materials for the mobile # 105 developer (on May 25-31)</a></li>
<li><a href="../259197/index.html">What do we know about MODX 3 at the moment?</a></li>
<li><a href="../259199/index.html">Introduction to KDF on the example of solving a cryptographic rebus</a></li>
<li><a href="../259201/index.html">MailChimp UX team: Improvements and iterations [the final part of the book]</a></li>
<li><a href="../259205/index.html">Real-time debugging via JTAG / SWJ-DP for ARM Cortex-M microcontrollers</a></li>
<li><a href="../259207/index.html">The digest of interesting materials from the world of web development and IT for the last week? 162 (May 15 - 31, 2015)</a></li>
<li><a href="../259209/index.html">Comparison of PHP7 and Hack type systems</a></li>
<li><a href="../259211/index.html">Delays are a stumbling block to the Internet of Things</a></li>
<li><a href="../259213/index.html">We write a simple code analyzer on Roslyn</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>