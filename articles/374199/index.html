<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to connect an LCD screen from cash register EKR-2102 to Arduino</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Somehow looking at ads on OLX, I stumbled upon a sale of old electronics at very low prices, in the end three cash registers and one modem were bought...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to connect an LCD screen from cash register EKR-2102 to Arduino</h1><div class="post__text post__text-html js-mediator-article">  Somehow looking at ads on OLX, I stumbled upon a sale of old electronics at very low prices, in the end three cash registers and one modem were bought (for analysis in order to replenish stocks).  Issue price of 1500 tenge - about 250 rubles. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sl/nc/hn/slnchn8ozg_kilaeybqlmzr2jk0.png" alt="image"></div><br>  Having examined this good, I became the owner of three LCD displays and three receipt printers. <br><br>  How to connect the display to Arduino?  Several inscriptions were found on the LCD display board.  5104219-01, 251 12, 251-T2.  The Holtek HT1621B chip is used, the datasheet was downloaded and studied.  Unfortunately, the type of LCD used was never identified. <br><a name="habracut"></a><br>  Having called the tester the conclusions (6 conclusions) I determined their purpose: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1) Data <br>  2) WR <br>  3) CS <br>  4) unknown * <br>  5) Gnd <br>  6) Vdd (+5 v) <br>  * - connected resistors, capacitors, as I needed, I did not understand deeply. <br><br><img src="https://habrastorage.org/webt/pi/-e/ki/pi-eki8iex8yeair3py7auk-f6u.jpeg" alt="image"><br><br>  I used <a href="http://arduino.ru/forum/programmirovanie/ht1621">ready-made procedures</a> for working with HT1621 ports from Arduino. <br><br>  Chip HT1621 128 cells for LCD, which are organized as follows 32x4 bits, in memory it is 16 bytes.  In my LCD, the outputs of Com0, Com1, Com2 and all segments 0-31 were connected. <br><br>  To determine which address and which bit is responsible for which segment a simple program was written that iterates over all addresses and all bits.  The results were recorded in a spreadsheet for further analysis.  This is how the filled table looks like. <br><br><img src="https://habrastorage.org/webt/y8/6u/ay/y86uayebk-jkug-9giyeg1z7qvy.png" alt="image"><br><br>  Now it became clear how to control the display.  So, for example, to enable <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B5%25D0%25BC%25D0%25B8%25D1%2581%25D0%25B5%25D0%25B3%25D0%25BC%25D0%25B5%25D0%25BD%25D1%2582%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B8%25D0%25BD%25D0%25B4%25D0%25B8%25D0%25BA%25D0%25B0%25D1%2582%25D0%25BE%25D1%2580">segments</a> B and C in the first position (leftmost), you need to change bits D5 and D6 to 1 at address 0x05, the remaining bits should be left unchanged, as they will affect other positions. <br><br>  If you look at the table, you can see that in order to display a digit, you need to change several bits in several bytes.  I solved this problem as follows.  Several tables were prepared: <br><br><ol><li>  <b>HT1681_Address (72 bytes), HT_1681_Value (72 bytes)</b> </li><li>  <b>b7SegDsp (10 bytes)</b> </li><li>  <b>HT1681_Screen (16 bytes)</b> </li></ol><br>  <b>HT1681_Address (72 bytes), HT_1681_Value (72 bytes),</b> these two tables are related as follows - the second table is a mask (for OR) to set the corresponding bit to 1, with the first nine bytes responsible for segments A, B, C, D , E, F, G + decimal point + or rather the ‚Äúunderscore‚Äù of the first familiarity, the next nine - behind the segments of the second familiarity, and so on.  The first table is the addresses that correspond to the second table.  To understand below is an illustration. <br><br><img src="https://habrastorage.org/webt/jt/fs/yn/jtfsyn6kcfgpvmsp-c9uxekstew.png"><br><br><div class="spoiler">  <b class="spoiler_title">Code for Arduino</b> <div class="spoiler_text"><pre><code class="hljs lua">// HT1681_Segments <span class="hljs-number"><span class="hljs-number">1</span></span>A <span class="hljs-number"><span class="hljs-number">1</span></span>B <span class="hljs-number"><span class="hljs-number">1</span></span>C <span class="hljs-number"><span class="hljs-number">1</span></span>D <span class="hljs-number"><span class="hljs-number">1</span></span>E <span class="hljs-number"><span class="hljs-number">1</span></span>F <span class="hljs-number"><span class="hljs-number">1</span></span>G <span class="hljs-number"><span class="hljs-number">1</span></span>DP <span class="hljs-number"><span class="hljs-number">1</span></span>Up ..... <span class="hljs-number"><span class="hljs-number">8</span></span>A <span class="hljs-number"><span class="hljs-number">8</span></span>B <span class="hljs-number"><span class="hljs-number">8</span></span>C <span class="hljs-number"><span class="hljs-number">8</span></span>D <span class="hljs-number"><span class="hljs-number">8</span></span>E <span class="hljs-number"><span class="hljs-number">8</span></span>F <span class="hljs-number"><span class="hljs-number">8</span></span>G <span class="hljs-number"><span class="hljs-number">8</span></span>DP <span class="hljs-number"><span class="hljs-number">8</span></span>Up const <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> HT1681_Address[]= { <span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x05</span></span>,<span class="hljs-number"><span class="hljs-number">0x05</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x05</span></span>,<span class="hljs-number"><span class="hljs-number">0x0E</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>,<span class="hljs-number"><span class="hljs-number">0x06</span></span>,<span class="hljs-number"><span class="hljs-number">0x06</span></span>,<span class="hljs-number"><span class="hljs-number">0x06</span></span>,<span class="hljs-number"><span class="hljs-number">0x05</span></span>,<span class="hljs-number"><span class="hljs-number">0x05</span></span>,<span class="hljs-number"><span class="hljs-number">0x06</span></span>,<span class="hljs-number"><span class="hljs-number">0x06</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>, <span class="hljs-number"><span class="hljs-number">0x07</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>,<span class="hljs-number"><span class="hljs-number">0x07</span></span>,<span class="hljs-number"><span class="hljs-number">0x07</span></span>,<span class="hljs-number"><span class="hljs-number">0x07</span></span>,<span class="hljs-number"><span class="hljs-number">0x07</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>,<span class="hljs-number"><span class="hljs-number">0x05</span></span>, <span class="hljs-number"><span class="hljs-number">0x09</span></span>,<span class="hljs-number"><span class="hljs-number">0x09</span></span>,<span class="hljs-number"><span class="hljs-number">0x09</span></span>,<span class="hljs-number"><span class="hljs-number">0x09</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>,<span class="hljs-number"><span class="hljs-number">0x09</span></span>,<span class="hljs-number"><span class="hljs-number">0x09</span></span>,<span class="hljs-number"><span class="hljs-number">0x07</span></span>, <span class="hljs-number"><span class="hljs-number">0x0A</span></span>,<span class="hljs-number"><span class="hljs-number">0x0B</span></span>,<span class="hljs-number"><span class="hljs-number">0x0B</span></span>,<span class="hljs-number"><span class="hljs-number">0x0A</span></span>,<span class="hljs-number"><span class="hljs-number">0x0A</span></span>,<span class="hljs-number"><span class="hljs-number">0x0A</span></span>,<span class="hljs-number"><span class="hljs-number">0x0A</span></span>,<span class="hljs-number"><span class="hljs-number">0x0B</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x0C</span></span>,<span class="hljs-number"><span class="hljs-number">0x0C</span></span>,<span class="hljs-number"><span class="hljs-number">0x0C</span></span>,<span class="hljs-number"><span class="hljs-number">0x0C</span></span>,<span class="hljs-number"><span class="hljs-number">0x0B</span></span>,<span class="hljs-number"><span class="hljs-number">0x0B</span></span>,<span class="hljs-number"><span class="hljs-number">0x0C</span></span>,<span class="hljs-number"><span class="hljs-number">0x0C</span></span>,<span class="hljs-number"><span class="hljs-number">0x0A</span></span>, <span class="hljs-number"><span class="hljs-number">0x0D</span></span>,<span class="hljs-number"><span class="hljs-number">0x0E</span></span>,<span class="hljs-number"><span class="hljs-number">0x0E</span></span>,<span class="hljs-number"><span class="hljs-number">0x0D</span></span>,<span class="hljs-number"><span class="hljs-number">0x0D</span></span>,<span class="hljs-number"><span class="hljs-number">0x0D</span></span>,<span class="hljs-number"><span class="hljs-number">0x0D</span></span>,<span class="hljs-number"><span class="hljs-number">0x0E</span></span>,<span class="hljs-number"><span class="hljs-number">0x0B</span></span>, <span class="hljs-number"><span class="hljs-number">0x0F</span></span>,<span class="hljs-number"><span class="hljs-number">0x0F</span></span>,<span class="hljs-number"><span class="hljs-number">0x0F</span></span>,<span class="hljs-number"><span class="hljs-number">0x0F</span></span>,<span class="hljs-number"><span class="hljs-number">0x0E</span></span>,<span class="hljs-number"><span class="hljs-number">0x0E</span></span>,<span class="hljs-number"><span class="hljs-number">0x0F</span></span>,<span class="hljs-number"><span class="hljs-number">0x0F</span></span>,<span class="hljs-number"><span class="hljs-number">0x0D</span></span> }; const <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> HT_1681_Value[]= { <span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x40</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x40</span></span>,<span class="hljs-number"><span class="hljs-number">0x02</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x02</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>,<span class="hljs-number"><span class="hljs-number">0x02</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x40</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x40</span></span>,<span class="hljs-number"><span class="hljs-number">0x02</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x02</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>,<span class="hljs-number"><span class="hljs-number">0x02</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x40</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x40</span></span>,<span class="hljs-number"><span class="hljs-number">0x02</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x02</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>,<span class="hljs-number"><span class="hljs-number">0x02</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x40</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x40</span></span>,<span class="hljs-number"><span class="hljs-number">0x02</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>, <span class="hljs-number"><span class="hljs-number">0x40</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x02</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>,<span class="hljs-number"><span class="hljs-number">0x02</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span> };</code> </pre> <br></div></div><br>  <b>b7SegDsp (10 bytes)</b> This table encodes which segments should be included to display the number. The first byte is the encoding of the number 0, the last byte encodes 9. The older seven bits of D7-D1 encode AG segments, the lower D0 is not used, I set it to 0 besides, it saves one bit-shift operation to the left ‚Äî I use the 0x80 mask to check the bit. <br><br><img src="https://habrastorage.org/webt/lb/im/mx/lbimmxqljnxqavj7nksr6had750.png"><br><br>  <b>HT1681_Screen (16 bytes) is</b> just video memory, all 16 bytes.  Initially, everything is rendered in memory, and then everything is copied to the HT1621. <br><br>  Below is the code that renders the HT1681_Screen, which is then simply output to the memory chip for display. <br><br><pre> <code class="hljs django"><span class="xml"><span class="xml">// 0</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">=bPos</span></span></span></span><span class="xml"><span class="hljs-tag">&lt;=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">7</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag">      </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bNum.</span></span></span></span><span class="xml"><span class="hljs-tag"> //     </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag">  </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">lDecimalPoint</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1</span></span></span></span><span class="xml"><span class="hljs-tag"> //    "" </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag">  </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">lUpperLine</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">void</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">HT1681_Display</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">byte</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bPos</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">byte</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bNum</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">byte</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">lDecimalPoint</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">byte</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">lUpperLine</span></span></span></span><span class="xml"><span class="hljs-tag">) { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">byte</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bCheckByte</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bAddr</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bValue</span></span></span></span><span class="xml"><span class="hljs-tag">; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bCheckByte</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">b7SegDsp[bNum];</span></span></span></span><span class="xml"><span class="hljs-tag"> //   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag">      </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">bPos*9;i</span></span></span></span><span class="xml"><span class="hljs-tag">&lt;=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">bPos*9+6;i++)</span></span></span></span><span class="xml"><span class="hljs-tag"> //   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">7</span></span></span></span><span class="xml"><span class="hljs-tag">  { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span></span><span class="xml"><span class="hljs-tag"> ( (</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bCheckByte</span></span></span></span><span class="xml"><span class="hljs-tag"> &amp; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0x80</span></span></span></span><span class="xml"><span class="hljs-tag">) == </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0x80)</span></span></span></span><span class="xml"><span class="hljs-tag"> //    =</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1</span></span></span></span><span class="xml"><span class="hljs-tag">   { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bAddr</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">HT1681_Address[i];</span></span></span></span><span class="xml"><span class="hljs-tag"> //    </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bValue</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">HT_1681_Value[i];</span></span></span></span><span class="xml"><span class="hljs-tag"> //     </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">HT1681_Screen</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bAddr</span></span></span></span><span class="xml"><span class="hljs-tag">] = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">(HT1681_Screen[bAddr]</span></span></span></span><span class="xml"><span class="hljs-tag"> | </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bValue</span></span></span></span><span class="xml"><span class="hljs-tag">); //   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">OR</span></span></span></span><span class="xml"><span class="hljs-tag">      </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span></span><span class="xml"><span class="hljs-tag"> }; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bCheckByte</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">bCheckByte</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;&lt; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0x01</span></span></span></span><span class="xml"><span class="hljs-tag">; //     } </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span></span><span class="xml"><span class="hljs-tag"> (</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">lDecimalPoint</span></span></span></span><span class="xml"><span class="hljs-tag">==</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1)</span></span></span></span><span class="xml"><span class="hljs-tag"> //     { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bAddr</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">HT1681_Address[(bPos*9)+7];</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bValue</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">HT_1681_Value[(bPos*9)+7];</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">HT1681_Screen</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bAddr</span></span></span></span><span class="xml"><span class="hljs-tag">] = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">(HT1681_Screen[bAddr]</span></span></span></span><span class="xml"><span class="hljs-tag"> | </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bValue</span></span></span></span><span class="xml"><span class="hljs-tag">); }; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span></span><span class="xml"><span class="hljs-tag"> (</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">lUpperLine</span></span></span></span><span class="xml"><span class="hljs-tag">==</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1)</span></span></span></span><span class="xml"><span class="hljs-tag"> //     { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bAddr</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">HT1681_Address[(bPos*9)+8];</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bValue</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">HT_1681_Value[(bPos*9)+8];</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">HT1681_Screen</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bAddr</span></span></span></span><span class="xml"><span class="hljs-tag">] = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">(HT1681_Screen[bAddr]</span></span></span></span><span class="xml"><span class="hljs-tag"> | </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bValue</span></span></span></span><span class="xml"><span class="hljs-tag">); }; }</span></span></span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Under the spoiler all the code is laid out for the Arduino</b> <div class="spoiler_text"><pre> <code class="hljs haskell">//    http://arduino.ru/forum/programmirovanie/ht1621 // http://arduino.ru/forum/programmirovanie/ht1621#comment<span class="hljs-number"><span class="hljs-number">-76371</span></span> #define sbi(x, y) (x |= (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; y)) /*set <span class="hljs-type"><span class="hljs-type">Register</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> y*/ #define cbi(x, y) (x &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt;y )) /*<span class="hljs-type"><span class="hljs-type">Clear</span></span> <span class="hljs-type"><span class="hljs-type">Register</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> y*/ #define uchar unsigned char #define uint unsigned int //<span class="hljs-type"><span class="hljs-type">Defined</span></span> <span class="hljs-type"><span class="hljs-type">HT1621's</span></span> command #define <span class="hljs-type"><span class="hljs-type">ComMode</span></span> <span class="hljs-number"><span class="hljs-number">0x48</span></span> //<span class="hljs-number"><span class="hljs-number">4</span></span>COM,<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">2</span></span>bias <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-number"><span class="hljs-number">010</span></span> <span class="hljs-number"><span class="hljs-number">1001</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> #define <span class="hljs-type"><span class="hljs-type">RCosc</span></span> <span class="hljs-number"><span class="hljs-number">0x30</span></span> //on-chip <span class="hljs-type"><span class="hljs-type">RC</span></span> oscillator(<span class="hljs-type"><span class="hljs-type">Power</span></span>-on <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>)1000 0011 0000 #define <span class="hljs-type"><span class="hljs-type">LCD_on</span></span> 0x06 //<span class="hljs-type"><span class="hljs-type">Turn</span></span> on <span class="hljs-type"><span class="hljs-type">LCD</span></span> #define <span class="hljs-type"><span class="hljs-type">LCD_off</span></span> 0x04 //<span class="hljs-type"><span class="hljs-type">Turn</span></span> off <span class="hljs-type"><span class="hljs-type">LCD</span></span> #define <span class="hljs-type"><span class="hljs-type">Sys_en</span></span> 0x02 //<span class="hljs-type"><span class="hljs-type">Turn</span></span> on system oscillator 1000 0000 0010 #define <span class="hljs-type"><span class="hljs-type">CTRl_cmd</span></span> 0x80 //<span class="hljs-type"><span class="hljs-type">Write</span></span> control cmd #define <span class="hljs-type"><span class="hljs-type">Data_cmd</span></span> 0xa0 //<span class="hljs-type"><span class="hljs-type">Write</span></span> data cmd // //<span class="hljs-type"><span class="hljs-type">Define</span></span> port <span class="hljs-type"><span class="hljs-type">HT1621</span></span> data port #define <span class="hljs-type"><span class="hljs-type">CS</span></span> 2 //<span class="hljs-type"><span class="hljs-type">Pin</span></span> 2 as chip selection output #define <span class="hljs-type"><span class="hljs-type">WR</span></span> 3 //<span class="hljs-type"><span class="hljs-type">Pin</span></span> 3 as read clock output #define <span class="hljs-type"><span class="hljs-type">DATA</span></span> 4 //<span class="hljs-type"><span class="hljs-type">Pin</span></span> 4 as <span class="hljs-type"><span class="hljs-type">Serial</span></span> data output #define <span class="hljs-type"><span class="hljs-type">CS1</span></span> digitalWrite(<span class="hljs-type"><span class="hljs-type">CS</span></span>, <span class="hljs-type"><span class="hljs-type">HIGH</span></span>) #define <span class="hljs-type"><span class="hljs-type">CS0</span></span> digitalWrite(<span class="hljs-type"><span class="hljs-type">CS</span></span>, <span class="hljs-type"><span class="hljs-type">LOW</span></span>) #define <span class="hljs-type"><span class="hljs-type">WR1</span></span> digitalWrite(<span class="hljs-type"><span class="hljs-type">WR</span></span>, <span class="hljs-type"><span class="hljs-type">HIGH</span></span>) #define <span class="hljs-type"><span class="hljs-type">WR0</span></span> digitalWrite(<span class="hljs-type"><span class="hljs-type">WR</span></span>, <span class="hljs-type"><span class="hljs-type">LOW</span></span>) #define <span class="hljs-type"><span class="hljs-type">DATA1</span></span> digitalWrite(<span class="hljs-type"><span class="hljs-type">DATA</span></span>, <span class="hljs-type"><span class="hljs-type">HIGH</span></span>) #define <span class="hljs-type"><span class="hljs-type">DATA0</span></span> digitalWrite(<span class="hljs-type"><span class="hljs-type">DATA</span></span>, <span class="hljs-type"><span class="hljs-type">LOW</span></span>) #define <span class="hljs-type"><span class="hljs-type">DelayTime</span></span> 1000 byte bMask; // <span class="hljs-type"><span class="hljs-type">HT1681_Segments</span></span> 1A 1B 1C 1D 1E 1F 1G 1DP 1Up ..... 8A 8B 8C 8D 8E 8F 8G 8DP 8Up const byte <span class="hljs-type"><span class="hljs-type">HT1681_Address</span></span>[]= { 0x04,0x05,0x05,0x04,0x04,0x04,0x04,0x05,0x0E, 0x06,0x06,0x06,0x06,0x05,0x05,0x06,0x06,0x04, 0x07,0x08,0x08,0x07,0x07,0x07,0x07,0x08,0x05, 0x09,0x09,0x09,0x09,0x08,0x08,0x09,0x09,0x07, 0x0A,0x0B,0x0B,0x0A,0x0A,0x0A,0x0A,0x0B,0x08, 0x0C,0x0C,0x0C,0x0C,0x0B,0x0B,0x0C,0x0C,0x0A, 0x0D,0x0E,0x0E,0x0D,0x0D,0x0D,0x0D,0x0E,0x0B, 0x0F,0x0F,0x0F,0x0F,0x0E,0x0E,0x0F,0x0F,0x0D }; const byte <span class="hljs-type"><span class="hljs-type">HT_1681_Value</span></span>[]= { 0x04,0x40,0x20,0x08,0x20,0x40,0x02,0x80,0x08, 0x40,0x04,0x02,0x80,0x02,0x04,0x20,0x08,0x80, 0x04,0x40,0x20,0x08,0x20,0x40,0x02,0x80,0x08, 0x40,0x04,0x02,0x80,0x02,0x04,0x20,0x08,0x80, 0x04,0x40,0x20,0x08,0x20,0x40,0x02,0x80,0x08, 0x40,0x04,0x02,0x80,0x02,0x04,0x20,0x08,0x80, 0x04,0x40,0x20,0x08,0x20,0x40,0x02,0x80,0x08, 0x40,0x04,0x02,0x80,0x02,0x04,0x20,0x08,0x80 }; // 0-9 7Segment <span class="hljs-type"><span class="hljs-type">Display</span></span> <span class="hljs-type"><span class="hljs-type">Description</span></span> // <span class="hljs-type"><span class="hljs-type">D7</span></span> <span class="hljs-type"><span class="hljs-type">D6</span></span> <span class="hljs-type"><span class="hljs-type">D5</span></span> <span class="hljs-type"><span class="hljs-type">D4</span></span> <span class="hljs-type"><span class="hljs-type">D3</span></span> <span class="hljs-type"><span class="hljs-type">D2</span></span> <span class="hljs-type"><span class="hljs-type">D1</span></span> <span class="hljs-type"><span class="hljs-type">D0</span></span> // <span class="hljs-type"><span class="hljs-type">ABCDEFG</span></span> * // const byte b7SegDsp[]= { 0xFC,0x60,0xDA,0xF2,0x66,0xB6,0xBE,0xE0,0xFE,0xE6 }; // virtual screen 12x6 bits = 72 bits (000X000X) byte <span class="hljs-type"><span class="hljs-type">HT1681_Screen</span></span>[]= { 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 }; // ********************************************************************************************************************************* void <span class="hljs-type"><span class="hljs-type">SendBit_1621</span></span>(<span class="hljs-title"><span class="hljs-title">uchar</span></span> <span class="hljs-title"><span class="hljs-title">sdata</span></span>,<span class="hljs-title"><span class="hljs-title">uchar</span></span> <span class="hljs-title"><span class="hljs-title">cnt</span></span>) //<span class="hljs-type"><span class="hljs-type">High</span></span> bit first { uchar i; for(<span class="hljs-title"><span class="hljs-title">i</span></span>=0;<span class="hljs-title"><span class="hljs-title">i</span></span>&lt;<span class="hljs-title"><span class="hljs-title">cnt</span></span>;<span class="hljs-title"><span class="hljs-title">i</span></span>++) { <span class="hljs-type"><span class="hljs-type">WR0</span></span>; delayMicroseconds(1); if(<span class="hljs-title"><span class="hljs-title">sdata</span></span>&amp;0<span class="hljs-title"><span class="hljs-title">x80</span></span>) <span class="hljs-type"><span class="hljs-type">DATA1</span></span>; else <span class="hljs-type"><span class="hljs-type">DATA0</span></span>; delayMicroseconds(1); <span class="hljs-type"><span class="hljs-type">WR1</span></span>; delayMicroseconds(1); sdata&lt;&lt;=1; } delayMicroseconds(1); } void <span class="hljs-type"><span class="hljs-type">Init_1621</span></span>(<span class="hljs-title"><span class="hljs-title">void</span></span>) { <span class="hljs-type"><span class="hljs-type">SendCmd_1621</span></span>(<span class="hljs-type"><span class="hljs-type">Sys_en</span></span>); <span class="hljs-type"><span class="hljs-type">SendCmd_1621</span></span>(<span class="hljs-type"><span class="hljs-type">RCosc</span></span>); <span class="hljs-type"><span class="hljs-type">SendCmd_1621</span></span>(<span class="hljs-type"><span class="hljs-type">ComMode</span></span>); <span class="hljs-type"><span class="hljs-type">SendCmd_1621</span></span>(<span class="hljs-type"><span class="hljs-type">LCD_on</span></span>); } void <span class="hljs-type"><span class="hljs-type">SendCmd_1621</span></span>(<span class="hljs-title"><span class="hljs-title">uchar</span></span> <span class="hljs-title"><span class="hljs-title">command</span></span>) { <span class="hljs-type"><span class="hljs-type">CS0</span></span>; <span class="hljs-type"><span class="hljs-type">SendBit_1621</span></span>(0<span class="hljs-title"><span class="hljs-title">x80</span></span>,4); <span class="hljs-type"><span class="hljs-type">SendBit_1621</span></span>(<span class="hljs-title"><span class="hljs-title">command</span></span>,8); <span class="hljs-type"><span class="hljs-type">CS1</span></span>; } void <span class="hljs-type"><span class="hljs-type">Write_1621</span></span>(<span class="hljs-title"><span class="hljs-title">uchar</span></span> <span class="hljs-title"><span class="hljs-title">addr</span></span>,<span class="hljs-title"><span class="hljs-title">uchar</span></span> <span class="hljs-title"><span class="hljs-title">sdata</span></span>) { addr&lt;&lt;=3; <span class="hljs-type"><span class="hljs-type">CS0</span></span>; <span class="hljs-type"><span class="hljs-type">SendBit_1621</span></span>(0<span class="hljs-title"><span class="hljs-title">xa0</span></span>,3); //<span class="hljs-type"><span class="hljs-type">Write</span></span> <span class="hljs-type"><span class="hljs-type">MODE</span></span>‚Äú101‚Äù <span class="hljs-type"><span class="hljs-type">SendBit_1621</span></span>(<span class="hljs-title"><span class="hljs-title">addr</span></span>,6); //<span class="hljs-type"><span class="hljs-type">Write</span></span> addr high 6 bits <span class="hljs-type"><span class="hljs-type">SendBit_1621</span></span>(<span class="hljs-title"><span class="hljs-title">sdata</span></span>,8); //<span class="hljs-type"><span class="hljs-type">Write</span></span> data 8 bits <span class="hljs-type"><span class="hljs-type">CS1</span></span>; } void <span class="hljs-type"><span class="hljs-type">LCDoff</span></span>(<span class="hljs-title"><span class="hljs-title">void</span></span>) { <span class="hljs-type"><span class="hljs-type">SendCmd_1621</span></span>(<span class="hljs-type"><span class="hljs-type">LCD_off</span></span>); } void <span class="hljs-type"><span class="hljs-type">LCDon</span></span>(<span class="hljs-title"><span class="hljs-title">void</span></span>) { <span class="hljs-type"><span class="hljs-type">SendCmd_1621</span></span>(<span class="hljs-type"><span class="hljs-type">LCD_on</span></span>); } void <span class="hljs-type"><span class="hljs-type">HT1681_Clear</span></span>(<span class="hljs-title"><span class="hljs-title">void</span></span>) { byte bAddress=0x00; for(<span class="hljs-title"><span class="hljs-title">byte</span></span> <span class="hljs-title"><span class="hljs-title">j</span></span>=0;<span class="hljs-title"><span class="hljs-title">j</span></span>&lt;=0<span class="hljs-title"><span class="hljs-title">x0F</span></span>;<span class="hljs-title"><span class="hljs-title">j</span></span>++) { bAddress=j; <span class="hljs-type"><span class="hljs-type">HT1681_Screen</span></span>[bAddress]=0x00; }; }; void <span class="hljs-type"><span class="hljs-type">HT1681_Show</span></span>(<span class="hljs-title"><span class="hljs-title">void</span></span>) { byte i; for(<span class="hljs-title"><span class="hljs-title">i</span></span>=0;<span class="hljs-title"><span class="hljs-title">i</span></span>&lt;=0<span class="hljs-title"><span class="hljs-title">x0F</span></span>;<span class="hljs-title"><span class="hljs-title">i</span></span>++) { <span class="hljs-type"><span class="hljs-type">Write_1621</span></span>(<span class="hljs-title"><span class="hljs-title">i</span></span>, <span class="hljs-type"><span class="hljs-type">HT1681_Screen</span></span>[<span class="hljs-title"><span class="hljs-title">i</span></span>]); }; } // 0&lt;=bPos&lt;=7 -      bNum. //     -  lDecimalPoint=1 //    "" -  lUpperLine=1 void <span class="hljs-type"><span class="hljs-type">HT1681_Display</span></span>(<span class="hljs-title"><span class="hljs-title">byte</span></span> <span class="hljs-title"><span class="hljs-title">bPos</span></span>, <span class="hljs-title"><span class="hljs-title">byte</span></span> <span class="hljs-title"><span class="hljs-title">bNum</span></span>, <span class="hljs-title"><span class="hljs-title">byte</span></span> <span class="hljs-title"><span class="hljs-title">lDecimalPoint</span></span>, <span class="hljs-title"><span class="hljs-title">byte</span></span> <span class="hljs-title"><span class="hljs-title">lUpperLine</span></span>) { byte i, bCheckByte, bAddr, bValue; bCheckByte=b7SegDsp[bNum]; //   -      for(<span class="hljs-title"><span class="hljs-title">i</span></span>=<span class="hljs-title"><span class="hljs-title">bPos</span></span>*9;<span class="hljs-title"><span class="hljs-title">i</span></span>&lt;=<span class="hljs-title"><span class="hljs-title">bPos</span></span>*9+6;<span class="hljs-title"><span class="hljs-title">i</span></span>++) //   7  { if ( (<span class="hljs-title"><span class="hljs-title">bCheckByte</span></span> &amp; 0<span class="hljs-title"><span class="hljs-title">x80</span></span>) == 0x80) //    =1   { bAddr=<span class="hljs-type"><span class="hljs-type">HT1681_Address</span></span>[i]; //    bValue=<span class="hljs-type"><span class="hljs-type">HT_1681_Value</span></span>[i]; //     <span class="hljs-type"><span class="hljs-type">HT1681_Screen</span></span>[bAddr] = (<span class="hljs-type"><span class="hljs-type">HT1681_Screen</span></span>[<span class="hljs-title"><span class="hljs-title">bAddr</span></span>] | <span class="hljs-title"><span class="hljs-title">bValue</span></span>); //   <span class="hljs-type"><span class="hljs-type">OR</span></span>      1 }; bCheckByte=bCheckByte &lt;&lt; 0x01; //     } if (<span class="hljs-title"><span class="hljs-title">lDecimalPoint</span></span>==1) //     { bAddr = <span class="hljs-type"><span class="hljs-type">HT1681_Address</span></span>[(<span class="hljs-title"><span class="hljs-title">bPos</span></span>*9)+7]; bValue = <span class="hljs-type"><span class="hljs-type">HT_1681_Value</span></span>[(<span class="hljs-title"><span class="hljs-title">bPos</span></span>*9)+7]; <span class="hljs-type"><span class="hljs-type">HT1681_Screen</span></span>[bAddr] = (<span class="hljs-type"><span class="hljs-type">HT1681_Screen</span></span>[<span class="hljs-title"><span class="hljs-title">bAddr</span></span>] | <span class="hljs-title"><span class="hljs-title">bValue</span></span>); }; if (<span class="hljs-title"><span class="hljs-title">lUpperLine</span></span>==1) //     { bAddr = <span class="hljs-type"><span class="hljs-type">HT1681_Address</span></span>[(<span class="hljs-title"><span class="hljs-title">bPos</span></span>*9)+8]; bValue = <span class="hljs-type"><span class="hljs-type">HT_1681_Value</span></span>[(<span class="hljs-title"><span class="hljs-title">bPos</span></span>*9)+8]; <span class="hljs-type"><span class="hljs-type">HT1681_Screen</span></span>[bAddr] = (<span class="hljs-type"><span class="hljs-type">HT1681_Screen</span></span>[<span class="hljs-title"><span class="hljs-title">bAddr</span></span>] | <span class="hljs-title"><span class="hljs-title">bValue</span></span>); }; } // *************************************************************************************************************************** void setup() { pinMode(<span class="hljs-type"><span class="hljs-type">CS</span></span>, <span class="hljs-type"><span class="hljs-type">OUTPUT</span></span>); //<span class="hljs-type"><span class="hljs-type">Pin</span></span> 2 pinMode(<span class="hljs-type"><span class="hljs-type">WR</span></span>, <span class="hljs-type"><span class="hljs-type">OUTPUT</span></span>); //<span class="hljs-type"><span class="hljs-type">Pin</span></span> 3 pinMode(<span class="hljs-type"><span class="hljs-type">DATA</span></span>, <span class="hljs-type"><span class="hljs-type">OUTPUT</span></span>); //<span class="hljs-type"><span class="hljs-type">Pin</span></span> 4 <span class="hljs-type"><span class="hljs-type">Init_1621</span></span>(); <span class="hljs-type"><span class="hljs-type">HT1681_Clear</span></span>(); <span class="hljs-type"><span class="hljs-type">HT1681_Show</span></span>(); <span class="hljs-type"><span class="hljs-type">Serial</span></span>.begin(9600); } // *************************************************************************************************************************** void loop() { byte i,j; <span class="hljs-type"><span class="hljs-type">HT1681_Clear</span></span>(); <span class="hljs-type"><span class="hljs-type">HT1681_Show</span></span>(); <span class="hljs-type"><span class="hljs-type">LCDoff</span></span>(); delay(100); for (<span class="hljs-title"><span class="hljs-title">i</span></span>=0; <span class="hljs-title"><span class="hljs-title">i</span></span>&lt;=7; <span class="hljs-title"><span class="hljs-title">i</span></span>++) { for (<span class="hljs-title"><span class="hljs-title">j</span></span>=0; <span class="hljs-title"><span class="hljs-title">j</span></span>&lt;=9; <span class="hljs-title"><span class="hljs-title">j</span></span>++) { <span class="hljs-type"><span class="hljs-type">HT1681_Clear</span></span>(); <span class="hljs-type"><span class="hljs-type">LCDoff</span></span>(); <span class="hljs-type"><span class="hljs-type">HT1681_Display</span></span>(<span class="hljs-title"><span class="hljs-title">i</span></span>,<span class="hljs-title"><span class="hljs-title">j</span></span>,0,0); <span class="hljs-type"><span class="hljs-type">HT1681_Show</span></span>(); <span class="hljs-type"><span class="hljs-type">LCDon</span></span>(); delay(150); }; }; }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Video of the program</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/gram.com/p/BeXasU4BSro/embed/captioned/?cr=1&amp;v=8&amp;rd=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div></div><p>Source: <a href="https://habr.com/ru/post/374199/">https://habr.com/ru/post/374199/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../374189/index.html">Google Lunar X Prize: No Winners</a></li>
<li><a href="../374191/index.html">To the mass emergence of electric vehicles need to adapt the grid</a></li>
<li><a href="../374193/index.html">Graduate student earned Bitcoin by deciphering the cipher written in DNA</a></li>
<li><a href="../374195/index.html">Friday cosmopost: collisions of galaxies, superkvazar and super hot planet</a></li>
<li><a href="../374197/index.html">‚ÄúThe era of the dog": the names and stories of space exploration in the USSR</a></li>
<li><a href="../374201/index.html">Shop of the future. How the first supermarket without cash registers operates in America</a></li>
<li><a href="../374203/index.html">Trends 2018</a></li>
<li><a href="../374205/index.html">Supernova in the Sky: Campfire Audio Polaris Headphones</a></li>
<li><a href="../374207/index.html">Homebody save energy, good for the environment</a></li>
<li><a href="../374209/index.html">You all look the same: 1 out of 50 people do not recognize others (and may not know about it)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>