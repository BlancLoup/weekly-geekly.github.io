<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we conquered chaos in the central warehouse</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! My name is Alexei Shikhov, I lead the CarPrice development team in Kirov. Carprice now ranks second in Russia in car sales in the secondary ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we conquered chaos in the central warehouse</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr!  My name is Alexei Shikhov, I lead the CarPrice development team in Kirov.  Carprice now ranks second in Russia in car sales in the secondary market, and almost all cars purchased in Moscow go through one huge central hub, from which buyers (dealers) pick them up or send them to car transporters.  There are always at least 700 cars in stock that do not stay there for more than five days.  In this article I will tell you how our team of friendly developers and caring testers fought with the inevitable chaos for such an anthill and defeated it. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/152/3d7/68d/1523d768de87f054149f8e2d07532249.png"><br><a name="habracut"></a><br>  The central hub of CarPrice is not just a guarded area where we dump cars waiting for someone to come after them.  All cars arriving at the warehouse undergo a technical inspection, documents are prepared for them and they are put in order by themselves - they charge batteries, add fuel, wash the liquid, etc.  And before the sale will arrange additional inspections for dealers. <br><br>  Dealers come unpredictably - the flow was very fickle.  Employees of the warehouse then ran, sticking their tongues out of the car to the car, then ‚Äúsmoking bamboo‚Äù, not knowing what to do.  It happened that one dealer took away a dozen cars at once - it took a whole day, from early morning to late night. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Booking system </h2><br>  To streamline the work, we have created a simple universal service record for services (he is also booking, he is an electronic queue).  In it, getting a car is divided into two steps - inspection and issuance.  The first one includes preparation for inspection and car inspection by a dealer in the presence of a warehouse manager.  Then the dealer pays the car and proceeds to the issuance step, at which documents are signed and the keys are transferred.  Inspection and issuance may take place on different days, some dealers sign up immediately for issuance without inspection, and some inspect one car several times. <br><br>  At first, the recording service did not represent a complex system; it solved simple and understandable tasks - it calculated free slots depending on the type and duration of the service (stage), taking into account the work schedule of the warehouse staff. <br><br>  The dealer enters the personal account, selects one of the cars won at the auction from the final warehouse, the type of service (inspection or issue) and is recorded on a free slot. <br><br><img src="https://habrastorage.org/webt/q9/n5/cm/q9n5cmllf0rvg95lgknobl_bosa.png"><br><br><img src="https://habrastorage.org/webt/rs/3q/do/rs3qdo4tzuj8kau3wwosumt-_qy.png"><br><br>  This can be done both from the desktop and through the mobile application.  If for some reason the dealer cannot register independently, a personal manager or a warehouse employee may record it. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uc/9p/v9/uc9pv9p3dnojocgrfqjjupjjbwg.png"></div><br>  Such schemes successfully work in many companies, and we hoped that as soon as we integrate the service, all problems would disappear. <br><br><h2>  Problems do not disappear </h2><br>  After some time, we understand that the system does not work in practice.  The reason is that most dealers are not very punctual: they come without an appointment, much later or earlier than the appointed time, and sometimes even on another day.  When this is recorded on the issue, and come for a visit.  Indicated the inspection of one car, and require you to show another five others.  Some dealers only want to work with a specific warehouse manager.  However, many dealers are very emotional and are not able to put up with inconsistencies.  With such unpredictability, warehouse staff do not understand which of the crowd of angry dealers need to be taken into work, which cars to prepare for inspection.  We thought, thought and decided to introduce a new solution. <br><br><h2>  Electronic queue </h2><br>  The idea was promising.  Managers do not need to think about whom to take to work, - pressed the button "next", and forward.  Dealers understand how the warehouse is loaded, see their position in the queue and know how long to wait.  By monitoring the maintenance time, you can dynamically adjust the slots, and in case of SLA violation, you can notify the management.  And for inspection / issue, you can sign up directly from the terminal in stock. <br><br>  On the backend, all the logic of the applications should be implemented, including the distribution of tasks between operators.  Front components: <br><br><ul><li>  A terminal with authorization by phone number, recording for services, viewing available cars, connecting paid services and issuing coupons for recording <br></li><li>  Dashboards with visualization of the queue and current coupons at work <br></li><li>  Operator (warehouse manager) console <br></li></ul><br>  From a technical point of view, the dealer, signing up for an auto inspection in his personal account, makes a request to the booking service on the backend, in response to receiving a list of possible machines for recording, free days and time.  In addition to the main, the system had to handle other, "vital" cases: <br><br><ul><li>  Dealer enrolled, arrived / not arrived <br></li><li>  The dealer signed up, arrived on time, went into the slot 30 minutes <br></li><li>  The dealer signed up, arrived later / earlier at 15, 40, 100 minutes <br></li><li>  Dealer is recorded / arrived at the VIP-issue <br></li><li>  The dealer signed up for a slot in 30 minutes - in fact, it turned out 10 minutes / 2 hours <br></li><li>  The dealer signed up for inspection, arrived, examined, went to pay, after 40 minutes returned to pick up the car <br></li></ul><br>  There were several additional requirements: <br><br><ul><li>  Flexible configuration of the warehouse staff with the services that each can provide.  And all this in the conditions of overlapping work schedules of employees - we have two shifts, from 9 to 18 and from 13 to 22 <br></li><li>  Quick connection to the new warehouse system <br></li><li>  Integration with other services - current booking, dealer authorization, etc. <br></li><li>  Easy vertical and horizontal scaling <br></li><li>  Realtime interfaces <br></li></ul><br>  The requirements did not seem exorbitant, so I didn‚Äôt want to dive into it with my head and stuff cones.  We thought that the electronic queue is already a well-developed topic, and decided to find a contractor with a ready-made box solution, who knows how to approach the specified business cases. <br><br><h2>  We develop ourselves </h2><br>  Search contractor gave nothing.  Most ready-made solutions have a very primitive algorithm.  Coupons are added to one common queue or broken down by category, and then the operators alternately take the coupons out of the queue.  Everything.  There is no flexible configuration, there is no logic for the distribution of coupons between operators, and the system usually works only in Windows.  I will not even talk about easy integration with internal services.  In this case, all the price tags space.  We still started working with one contractor, but he had about ten percent of the necessary functions, and everything else would have to be cut for a long time.  So we broke up and decided to write an electronic queue on our own. <br><br>  At this point, we already clearly understood our needs with all the nuances and immediately began to implement.  Backends were made on the basis of a previously created booking service - using Laravel, PHP 7, RabbitMQ, Percona, Websocket, and everything in Docker.  The whole front was implemented on the web-socket, which made it possible to create real-time interfaces. <br><br>  The terminal was assembled from a metal case, in which the iPad is hiding.  The case protects the tablet from theft and fixes it in the desired position. <br><br><img src="https://habrastorage.org/webt/j0/ob/0z/j0ob0z9kbvt58m3rwp1igvgncek.png"><br><br>  Guide-access is activated on the tablet and a third-party application on Vue.js (SPA) is running in a full-screen browser without controls.  First, the dealer is authorized in the terminal by SMS (JWT).  After authorization, he can look at his inspection / issue records and get coupons for them.  VIP-services are available to dealers with the blocking of funds in their personal wallet. <br><br><img src="https://habrastorage.org/webt/8v/2x/f7/8v2xf7tdhkmdy3x4ssmgaf7xv88.png"><br><br>  Each record for inspection and issue is pre-attached to a specific warehouse manager and, if possible, is automatically grouped with other records of the same dealer.  When assigning a manager, the schedule and workload of employees, the presence of other scheduled entries by the dealer and other factors are taken into account. <br><br><img src="https://habrastorage.org/webt/qf/kg/pe/qfkgpeht3t9gdxeg_zfs9p3c6dm.png"><br><br>  When you make an appointment for a dealer account, money is blocked, and when you receive a coupon, it is returned.  Entries for which a coupon was not received in time are automatically canceled, and the money for a false entry is written off from the dealer's account.  From the received coupons, a queue is formed, which is distributed among the working managers, taking into account the recording time and the dealer's waiting time, such as recording, etc. <br><br>  For VIP, a separate queue is allocated - the dealer can take a ticket for "right now" and immediately go to a meeting with the manager if there is no queue from the same VIP.  The service, though paid, is in great demand among dealers who arrived without an appointment or were late and do not want to wait. <br><br><img src="https://habrastorage.org/webt/qb/em/5l/qbem5lkc3emy78d85iciywu9xne.png"><br><br>  Another component of the system - dashboards - shows which ticket is served by which operator.  In addition, it displays the current queue and by voice invites the dealer to proceed to the operator.  In fact, this is a regular TV with a connected nettop, which runs a full-screen browser and opens the Vue.js (SPA) application with the parameters of a specific warehouse. <br><br><img src="https://habrastorage.org/webt/eg/ah/8u/egah8uumdnsfjzeyewwwkst6gm4.png"><br><br>  The operator for work has a remote - a laptop in the workplace. <br><br><img src="https://habrastorage.org/webt/_s/if/wb/_sifwb2gci4vdcfldyurff-pjxc.png"><br><br>  An operator interface is open on a laptop in which, after authorization, it can create, modify and cancel entries, record the result of the service, transfer customers and postpone work with them.  Using this interface, if you have certain rights, you can customize the work schedule of managers and their possible services. <br><br><img src="https://habrastorage.org/webt/u-/ne/z9/u-nez9mvcstyso7re_dittbsluq.png"><br><br><img src="https://habrastorage.org/webt/w-/yr/l2/w-yrl2ovi3orc83hcjjamcws07i.png"><br><br>  Through the same interface, each SLA can be configured in detail for each warehouse.  This makes it easy to scale our electronic queue for any number of new warehouses. <br><br><img src="https://habrastorage.org/webt/in/-t/re/in-tre_ypqyc5ks5pafn3ytqcai.png"><br><br>  There are many different settings for SLA, we monitor the work of warehouses in many ways. <br><br><img src="https://habrastorage.org/webt/-l/nw/pn/-lnwpno1lxeosn4efyp_9atcy_y.png"><br><br><img src="https://habrastorage.org/webt/jv/xs/29/jvxs29yzvhrh--ziesdfmpmtnom.png"><br><br>  The new system of electronic queue helps to solve various difficult cases.  Here are some examples: <br><br><ul><li>  The dealer signed up for several cars, very late and half of them became expired.  It turns out that the record is partially overdue, so the dealer still sees it in the terminal and can get a ticket for it.  The manager in the operator‚Äôs console sees that some of the services are overdue, can complete work with the coupon without them, or delete some of the active services and add overdue services instead. <br></li><li>  The dealer came to inspect and issue a car, but the car showed defects.  Now the dealer does not need to issue, and the formation of a claim for a refund.  In the operator‚Äôs console, the manager can do it with one button - change the type of service from issue to claim. <br></li><li>  The dealer came to inspect one car, and wants to inspect another.  The manager in the operator‚Äôs console can replace the car for inspection in the ticket. <br></li></ul><br><h2>  SLA monitoring via Telegram </h2><br>  If you carefully looked at the screenshots of the SLA settings above, then you saw there lines related to the messenger.  It used to happen that warehouse employees instead of working left to smoke for an hour, and their colleagues had to switch to emergency mode.  Now, if an employee has gone to work and does not take dealers for a long time, the management receives a notification of this type: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2ab/812/78e/2ab81278e6727f7b93a449b685e079e0.png"><br><br>  Or here are such warnings about dealers: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0ed/f3e/d96/0edf3ed967fca51807d057b944dacf6e.png"><br><br>  In addition to managers working with dealers, there are technicians in the warehouse who prepare the car for the scheduled inspection time: they dig it out of a snowdrift, fill it with fuel, wash the car, charge the battery, warm up the engine and distill the car from the closed parking lot.  A separate channel helps them to learn about the features of the engine start and complete the training faster.  Here are some interesting posts: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/37f/c92/035/37fc92035e345ee7f023a113ce14fa9b.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/fb5/765/4ba/fb57654baee4dc53f39c1bedd6583664.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/313/fb3/5e2/313fb35e2d5aee747a10fa90d6de26e0.png"><br><br>  But this option is perhaps the most original: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7fc/308/16e/7fc30816e4999eab25f0e0ffeb17008f.png"><br><br><h2>  Results </h2><br>  With the help of a new electronic queue, we won the chaos in the warehouse, simplified the lives of dealers and gave them a number of additional services.  If you list the business indicators, the dealers' waiting time has decreased threefold, the number of negative feedback has quadrupled, and the warehouse with the same number of employees can now skip not 700, but 3000 cars per day.  While we are watching the system and in the plans except to put a printer that will print coupons on paper. <br><br>  <i>Now we are looking for a <a href="https://hh.ru/vacancy/23122617">QA-specialist</a> and <a href="https://hh.ru/vacancy/25438987">backend developer</a> in our Moscow office.</i>  <i>We welcome your feedback!</i> </div><p>Source: <a href="https://habr.com/ru/post/358348/">https://habr.com/ru/post/358348/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../358338/index.html">New features LCD serial interfaces</a></li>
<li><a href="../358340/index.html">Russian production of embedded systems</a></li>
<li><a href="../358342/index.html">Chip aging is accelerating</a></li>
<li><a href="../358344/index.html">An inside look at a modern domestic plant for the production of microelectronics and not only</a></li>
<li><a href="../358346/index.html">"You can make your products on imported machines, from which it will not become less domestic"</a></li>
<li><a href="../358350/index.html">Will the Ministry of Defense be able to drown out Iridium, GlobalStar and OneWeb?</a></li>
<li><a href="../358352/index.html">The ‚Äúability‚Äù of machine learning to predict the future of chaotic systems</a></li>
<li><a href="../358356/index.html">How and why we made our ATMs</a></li>
<li><a href="../358358/index.html">7 tools that help us beat procrastination</a></li>
<li><a href="../358360/index.html">The Frontend Conf program for those who do not have a flywheel of time</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>