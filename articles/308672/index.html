<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>In the shadow of a random forest</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1. Introduction 


 This is a short story about the practical issues of machine learning for large-scale statistical studies of various data on the In...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>In the shadow of a random forest</h1><div class="post__text post__text-html js-mediator-article"><h3>  1. Introduction </h3><br><p>  This is a short story about the practical issues of machine learning for large-scale statistical studies of various data on the Internet.  The topic of applying basic methods of mathematical statistics for data analysis will also be discussed. </p><br><a name="habracut"></a><br><h3>  2. Classification by the assessor </h3><br><p>  The assessor often encounters normally distributed data sets.  There is a rule according to which, under a normal distribution (it is called a Gaussian distribution), the random variable rarely deviates by more than three sigmas (the Greek letter ‚Äúsigma‚Äù denotes the square root of the variance, that is, the standard deviation) from its expected value.  In other words: in a normal distribution, most objects will differ little from the average.  Consequently, the histogram will be as follows: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c71/c2a/dd8/c71c2add822f4e3184f086e3380b39a3.png"></div><br><p>  Such a random variable can correlate with another quantity and even form groups (clusters) according to some signs of similarity.  Consider a small example.  Assume that we have information about the mass and height of the object, and also know that in the general population there are objects of only two classes (bicycle and truck).  Obviously, the height and weight of the truck is clearly greater than that of a bicycle, therefore, both indicators are incredibly valuable for classification. </p><br><p>  If we display a cloud of points in two-dimensional space, the coordinates of which are given by the studied pair of sets, then it will be obvious that the points are not distributed randomly, but are grouped into groups (clusters).  Consequently, the space can be divided into a linear (hyperplane), which will allow to distinguish trucks from bicycles (for example, if the mass is more than 1000 kg, then this is clearly a truck). </p><br><p>  Moreover, it is possible to fix a linear relationship between these metrics (with increasing position along the ordinate there is a clear increase on the abscissa).  Thus, the dots line up from the lower left corner to the upper right corner, as if around a stretched thread.  For greater clarity, we will add (by the least squares method) a straight line of regression analysis, note the centroids of the clusters, and also display the graphs of these variables: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e70/af8/f9b/e70af8f9b75b432aa99e9e51485be4bd.png"></div><br><p>  Using the available data, we calculate the degree of relationship.  For such datasets in mathematical statistics, the linear correlation coefficient of Karl Pearson is used.  This is quite convenient, since it is in the range from -1 to 1. To calculate it, it is necessary to divide the covariance by the product of the standard deviations of the sets (the square root of the variance).  By the way, the covariance does not change, if we swap the compared sets, and if they are the same, we get the variance of the random variable.  It is important to note that the relationship must be strictly linear. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b35/f17/80e/b35f1780e3c84f908c82e3b7fa5446b1.png"></div><br><p>  However, there are a number of other independent variables (predictors) that influence the dependent (criterial) variable.  There is no functional dependence, which would allow to calculate one variable by the formula, knowing the other.  For example, this is how a person's height depends on weight (dependence exists, but there is no formula that allows knowing only weight to accurately calculate height).  How to act if there are a lot of variables and it is necessary to evaluate the importance of each of them? </p><br><p>  One approach to solving this problem is the use of machine learning algorithms.  For example, the CART algorithm (developed by the scientists Leo Breiman, Jerome Friedman, Charles Stone and Richard Olschen in the early 80s of the 20th century) will make it possible to display decision trees quite well.  Naturally, he assumes that all the vectors of features are already labeled by the assessor.  However, for more complex tasks, Random forest or Gradient Boosting is more often used.  Using the methods mentioned (as well as logistic regression), we visually reflect the degree of importance of each variable: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e1d/61b/326/e1d61b32663041c6823a741b4a357235.png"></div><br><p>  Naturally, the choice of methods directly depends on the task and the specifics of the data set.  But in the vast majority of tasks, automatic classification begins with a preliminary data analysis.  It is likely that assessors and experts will be able to see important patterns simply by studying the visual presentation of data and indicators of descriptive statistics (correlation, minimum value, maximum value, average value, median, quartile, variance). </p><br><h3>  3. Automatic classification </h3><br><p>  In fact, instead of a specific object (site, person, car, plane), we are faced with a set of its characteristics (mass, speed, presence of USB).  This means that the process of turning an entity into a feature vector occurs.  So how to deal with really complex data sets? </p><br><p>  A single approach cannot exist, since there are so many specific requirements.  For automatic image recognition, some algorithms are needed (for example, artificial neural networks), and for complex linguistic text analysis, completely different ones are needed. </p><br><p>  In the overwhelming majority of cases, machine learning begins with pre-clearing data.  At this stage, the removal of obviously unsuitable objects and simpler methods of classification may occur.  The following example searches for centroids of two clusters.  A rather popular solution (the recently published second version of Apache Spark) will be a concrete implementation. </p><br><pre><code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.mllib.clustering.{<span class="hljs-type"><span class="hljs-type">KMeans</span></span>, <span class="hljs-type"><span class="hljs-type">KMeansModel</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.mllib.linalg.<span class="hljs-type"><span class="hljs-type">Vectors</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> data = sc.textFile(clusterDataFile).map(s =&gt; <span class="hljs-type"><span class="hljs-type">Vectors</span></span>.dense(s.split(',').map(_.toDouble))).cache() <span class="hljs-type"><span class="hljs-type">KMeans</span></span>.train(data, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>).clusterCenters.map(h =&gt; h(<span class="hljs-number"><span class="hljs-number">0</span></span>) + <span class="hljs-string"><span class="hljs-string">","</span></span> + h(<span class="hljs-number"><span class="hljs-number">1</span></span>)).mkString(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>)</code> </pre> <br><p>  As the complexity of the task increases, so does the complexity of machine learning systems.  For example, some search engines use the Gradient Boosting Machine to automatically analyze the quality of sites.  Such an algorithm builds a large number of decision trees that use boosting (gradual improvement through improving the prediction quality of previous decision trees).  Let's move on to an example.  Here are a few lines from the input file: </p><br><pre> <code class="hljs css">0 1<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:86</span></span> 2<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:33</span></span> 3<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:79</span></span> 4<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:77</span></span> 5<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:74</span></span> 6<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:81</span></span> 7<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:90</span></span> 8<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:63</span></span> 9<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:8</span></span> 10<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:27</span></span> 11<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:33</span></span> 12<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:29</span></span> 13<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:99</span></span> 14<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:14</span></span> 15<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:92</span></span> 1 1<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:100</span></span> 2<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:82</span></span> 3<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:18</span></span> 4<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:8</span></span> 5<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:73</span></span> 6<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:27</span></span> 7<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:18</span></span> 8<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:11</span></span> 9<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:25</span></span> 10<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:46</span></span> 11<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:79</span></span> 12<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:88</span></span> 13<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:62</span></span> 14<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:12</span></span> 15<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:20</span></span> 0 1<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:98</span></span> 2<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:53</span></span> 3<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:79</span></span> 4<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:74</span></span> 5<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:26</span></span> 6<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:60</span></span> 7<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:64</span></span> 8<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:89</span></span> 9<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:67</span></span> 10<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:91</span></span> 11<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:22</span></span> 12<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:95</span></span> 13<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:90</span></span> 14<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:35</span></span> 15<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:87</span></span> 0 1<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:89</span></span> 2<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:17</span></span> 3<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:4</span></span> 4<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:96</span></span> 5<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:89</span></span> 6<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:31</span></span> 7<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:13</span></span> 8<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:99</span></span> 9<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:55</span></span> 10<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:59</span></span> 11<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:78</span></span> 12<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:43</span></span> 13<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:20</span></span> 14<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:90</span></span> 15<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:62</span></span> 0 1<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:20</span></span> 2<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:88</span></span> 3<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:14</span></span> 4<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:99</span></span> 5<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:62</span></span> 6<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:40</span></span> 7<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:58</span></span> 8<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:26</span></span> 9<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:28</span></span> 10<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:25</span></span> 11<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:16</span></span> 12<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:49</span></span> 13<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:20</span></span> 14<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:5</span></span> 15<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:84</span></span> 0 1<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:6</span></span> 2<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:94</span></span> 3<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:100</span></span> 4<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:10</span></span> 5<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:89</span></span> 6<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:88</span></span> 7<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:40</span></span> 8<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:2</span></span> 9<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:87</span></span> 10<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:95</span></span> 11<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:61</span></span> 12<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:65</span></span> 13<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:37</span></span> 14<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:81</span></span> 15<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:55</span></span> 1 1<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:99</span></span> 2<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:100</span></span> 3<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:42</span></span> 4<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:12</span></span> 5<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:98</span></span> 6<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:4</span></span> 7<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:52</span></span> 8<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:56</span></span> 9<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:29</span></span> 10<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:79</span></span> 11<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:80</span></span> 12<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:44</span></span> 13<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:28</span></span> 14<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:99</span></span> 15<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:49</span></span> 0 1<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:5</span></span> 2<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:42</span></span> 3<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:11</span></span> 4<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:14</span></span> 5<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:31</span></span> 6<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:98</span></span> 7<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:54</span></span> 8<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:33</span></span> 9<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:85</span></span> 10<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:48</span></span> 11<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:93</span></span> 12<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:49</span></span> 13<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:85</span></span> 14<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:73</span></span> 15<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:3</span></span></code> </pre> <br><p>  Suppose that this is some statistics on the most important behavioral factors.  The first character of the string is the class (strictly nominative variable: 0 or 1), and the rest is the object characteristics (index: value).  This dataset is required for machine learning.  After this, the model will be able to independently identify the class by the feature vector.  There is a second such file, but with other observations.  It is necessary to verify the correctness of the automatic classification. </p><br><p>  For training and testing, a large number of observations are needed, where classes are already precisely known (as an option, you can resort to dividing the sample into training and testing parts).  We compare the actual (already known) class with the result of machine learning algorithms.  Ideally, the ROC-curve of the accuracy of the binary classifier should have an area under the curve, which is close to unity.  But, if it is close to half the space, then it will be similar to the process of random guessing, which, naturally, is categorically unacceptable. </p><br><p>  Suppose that, by the condition of the problem, it is necessary to use a dichotomous (binary) classification.  In this example, the number of trees will be 180 (with a height limit of 4), and the number of classes is strictly equal to two.  The model has a method, predict, which performs the classification (returns a class label) by the vector specified by the argument: </p><br><pre> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.mllib.tree.<span class="hljs-type"><span class="hljs-type">GradientBoostedTrees</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.mllib.tree.configuration.<span class="hljs-type"><span class="hljs-type">BoostingStrategy</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.mllib.tree.model.<span class="hljs-type"><span class="hljs-type">GradientBoostedTreesModel</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.mllib.util.<span class="hljs-type"><span class="hljs-type">MLUtils</span></span> <span class="hljs-comment"><span class="hljs-comment">/** *      */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> boostingStrategy = <span class="hljs-type"><span class="hljs-type">BoostingStrategy</span></span>.defaultParams(<span class="hljs-string"><span class="hljs-string">"Classification"</span></span>) boostingStrategy.numIterations = <span class="hljs-number"><span class="hljs-number">180</span></span> boostingStrategy.treeStrategy.numClasses = <span class="hljs-number"><span class="hljs-number">2</span></span> boostingStrategy.treeStrategy.maxDepth = <span class="hljs-number"><span class="hljs-number">4</span></span> boostingStrategy.treeStrategy.categoricalFeaturesInfo = <span class="hljs-type"><span class="hljs-type">Map</span></span>[<span class="hljs-type"><span class="hljs-type">Int</span></span>, <span class="hljs-type"><span class="hljs-type">Int</span></span>]() <span class="hljs-comment"><span class="hljs-comment">/** *        */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> data = <span class="hljs-type"><span class="hljs-type">MLUtils</span></span>.loadLibSVMFile(sc, trainingDataFile) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> newData = <span class="hljs-type"><span class="hljs-type">MLUtils</span></span>.loadLibSVMFile(sc, testDataFile) <span class="hljs-comment"><span class="hljs-comment">/** *   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> model = <span class="hljs-type"><span class="hljs-type">GradientBoostedTrees</span></span>.train(data, boostingStrategy) <span class="hljs-comment"><span class="hljs-comment">/** *    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> cardinality = newData.count <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> errors = newData.map{p =&gt; (model.predict(p.features), p.label)}.filter(r =&gt; r._1 != r._2).count.toDouble println(<span class="hljs-string"><span class="hljs-string">"   = "</span></span> + cardinality) println(<span class="hljs-string"><span class="hljs-string">"  = "</span></span> + errors) println(<span class="hljs-string"><span class="hljs-string">"  = "</span></span> + errors / cardinality)</code> </pre> <br><p>  Such algorithms can be used in order to increase the conversion of sites.  Such a dichotomous (binary) classifier is very convenient in practical application, since it requires only the feature vector, and returns its class.  You can automatically mark up huge amounts of information.  The most important drawback is the need for a large set of already marked vectors of features.  I repeat that a lot will depend on the accuracy of the selection of signs and on the primary analysis of data. </p><br><p>  Machine learning and methods of mathematical statistics are used in various fields of science and industry.  It is very difficult to draw a line between the tasks of evaluating the effectiveness of behavioral factors on portals and the tasks of machine learning.  Statistics applies in all spheres of human life.  Moreover, the use of the mentioned machine learning algorithms allows us to perform such tasks that several years ago were impossible without human participation. </p><br><h4>  4. Application </h4><br><p>  R code to visualize the examples shown. </p><br><pre> <code class="hljs django"><span class="xml"><span class="xml"># #   # dataset </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">read.csv</span></span></span></span><span class="xml"><span class="hljs-tag">("</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">dataset.csv</span></span></span></span><span class="xml"><span class="hljs-tag">") #   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">setwd</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span></span><span class="xml"><span class="hljs-tag">) # #      # </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">plot</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">dataset</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ylim</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">c(1,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">25</span></span></span></span><span class="xml"><span class="hljs-tag">), </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xlim</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">c(1,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">25</span></span></span></span><span class="xml"><span class="hljs-tag">), </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pch</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">20)</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">abline</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">lm</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">dataset</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">b</span></span></span></span><span class="xml"><span class="hljs-tag"> ~ </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">dataset</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">a</span></span></span></span><span class="xml"><span class="hljs-tag">), </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">col</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"blue"</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">clusters</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">kmeans</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">dataset</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">nstart</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">50)</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">dimnames</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">clusters</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">centers</span></span></span></span><span class="xml"><span class="hljs-tag">) &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">list</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">c</span></span></span></span><span class="xml"><span class="hljs-tag">("</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Alpha</span></span></span></span><span class="xml"><span class="hljs-tag">", "</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Beta</span></span></span></span><span class="xml"><span class="hljs-tag">"), </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">c</span></span></span></span><span class="xml"><span class="hljs-tag">("</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">X</span></span></span></span><span class="xml"><span class="hljs-tag">", "</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Y</span></span></span></span><span class="xml"><span class="hljs-tag">")) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">points</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">clusters</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">centers</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">col</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"red"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">cex</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pch</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">8)</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">text</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">clusters</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">centers</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">row.names</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">clusters</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">centers</span></span></span></span><span class="xml"><span class="hljs-tag">), </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">cex</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1.3,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pos</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">4,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">col</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"red"</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">plot</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">hclust</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">dist</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">dataset</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"euclidean"</span></span></span></span><span class="xml"><span class="hljs-tag">), </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"average"</span></span></span></span><span class="xml"><span class="hljs-tag">), </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">col</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"blue"</span></span></span></span><span class="xml"><span class="hljs-tag">) # #        # </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">paste</span></span></span></span><span class="xml"><span class="hljs-tag">("</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Pearson</span></span></span></span><span class="xml"><span class="hljs-tag">'</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">s</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">product-moment</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">correlation:</span></span></span></span><span class="xml"><span class="hljs-tag"> ", </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">cor</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">dataset</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">a</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">dataset</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">b</span></span></span></span><span class="xml"><span class="hljs-tag">)) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">plot</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">dataset</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">a</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"o"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">main</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">title,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">lty</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">2,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ylim</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">c(0,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">25</span></span></span></span><span class="xml"><span class="hljs-tag">), </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xlim</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">c(0,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">10</span></span></span></span><span class="xml"><span class="hljs-tag">), </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">col</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"red"</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">lines</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">dataset</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">b</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"o"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pch</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">22,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">lty</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">2,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">col</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"blue"</span></span></span></span><span class="xml"><span class="hljs-tag">) # #     # </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">library</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">party</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">library</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">randomForest</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">library</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">gbm</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rd</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">read.csv</span></span></span></span><span class="xml"><span class="hljs-tag">("</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rd.csv</span></span></span></span><span class="xml"><span class="hljs-tag">") </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rd</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">as.factor</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rd</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">) # #   # </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">plot</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ctree</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag"> ~ </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">rd))</span></span></span></span><span class="xml"><span class="hljs-tag"> # # </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Random</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Forest</span></span></span></span><span class="xml"><span class="hljs-tag"> # </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">varImpPlot</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">randomForest</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag"> ~ </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">rd,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">importance</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">TRUE,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">keep.forest</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">FALSE,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ntree</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">15),</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">main</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Random Forest"</span></span></span></span><span class="xml"><span class="hljs-tag">) # # </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">GBM</span></span></span></span><span class="xml"><span class="hljs-tag"> # </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">summary</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">gbm</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag"> ~ </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">alpha</span></span></span></span><span class="xml"><span class="hljs-tag"> + </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">beta</span></span></span></span><span class="xml"><span class="hljs-tag"> + </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">gamma</span></span></span></span><span class="xml"><span class="hljs-tag"> + </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">delta</span></span></span></span><span class="xml"><span class="hljs-tag"> + </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">epsilon</span></span></span></span><span class="xml"><span class="hljs-tag"> + </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">zeta</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">rd,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">shrinkage</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0.01,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">n.trees</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">100,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">cv.fold</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">10,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">interaction.depth</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">4,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">distribution</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"gaussian"</span></span></span></span><span class="xml"><span class="hljs-tag">)) # #   # </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">summary</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">glm</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">formula</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">class</span></span></span></span><span class="xml"><span class="hljs-tag"> ~ </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">rd,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">family</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">binomial))</span></span></span></span></span></span></code> </pre> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/308672/">https://habr.com/ru/post/308672/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../308654/index.html">PHP function speed analysis tool</a></li>
<li><a href="../308656/index.html">Interfaces in the real world: user error insurance</a></li>
<li><a href="../308658/index.html">Facebook is trying to please everyone, constantly changing the "rules of the game"</a></li>
<li><a href="../308660/index.html">Scrapy: collect data and save to database</a></li>
<li><a href="../308662/index.html">To the question about pins</a></li>
<li><a href="../308674/index.html">The digest of interesting materials for the mobile # 168 developer (August 22-28)</a></li>
<li><a href="../308676/index.html">Solve problems with remote connections in 3CX</a></li>
<li><a href="../308680/index.html">15 bugs or html and css tips</a></li>
<li><a href="../308684/index.html">We optimize our effort when developing an application in Google Material Design</a></li>
<li><a href="../308686/index.html">Why do companies so hard to have Fullstack developers?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>