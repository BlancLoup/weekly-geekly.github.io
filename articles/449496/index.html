<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hackathon DevDays'19 (part 2): a parser of sound messages for Telegram and grammar checker in IntelliJ IDEA</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue to talk about the projects of the spring hackathon DevDays, which was attended by students of the master program "Software Engineering / S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hackathon DevDays'19 (part 2): a parser of sound messages for Telegram and grammar checker in IntelliJ IDEA</h1><div class="post__text post__text-html js-mediator-article">  We continue to talk about the projects of the spring hackathon DevDays, which was attended by students of the master program <a href="http://mse.itmo.ru/">"Software Engineering / Software Engineering"</a> . <br><br><img src="https://habrastorage.org/webt/cz/gr/an/czgran29lxbwd-wwbrkoj3jquio.jpeg"><br><br>  By the way, we want to invite readers to join the <a href="https://vk.com/mse_itmo">VK-group of magistracy</a> .  In it, we will publish the latest news about recruitment and study.  Video from the day of open doors will also be found in the group.  We remind: the event will be held on April 29, details <a href="http://mse.itmo.ru/">on the website</a> . <br><a name="habracut"></a><br><h2>  Telegram Desktop Voice Message Parser </h2><br><img src="https://habrastorage.org/webt/md/sa/oo/mdsaoonicw-hw7y0d2_1jfzapsy.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Idea author</b> <br>  Khoroshev Artyom <br><br>  <b>Line-up</b> <br><br>  Khoroshev Artem - project manager / developer / QA <br>  Anton Eliseev - business analyst / marketing specialist <br>  Maria Kuklina - UI Designer / Developer <br>  Pavel Bakhvalov - UI Designer / Developer / QA <br><br>  From our point of view, Telegram is a modern and convenient messenger, and its PC version is popular and open source, as a result of which it is possible to modify it.  The client offers quite rich functionality.  In addition to standard text messages, it contains voice calls, video messages, voice messages.  And it is the latter that sometimes brings inconvenience to their recipient.  Often there is no possibility to listen to the voice message while at the computer or laptop.  Ambient noise, lack of headphones may interfere, or you do not want someone to hear the contents of the message.  There are almost no such problems if you use telegrams on a smartphone, because you can simply bring it to your ear, unlike a laptop or PC.  We tried to solve this problem. <br><br>  The task of our project on DevDays was to add to the desktop client Telegram (hereinafter Telegram Desktop) the ability to broadcast the received voice messages into text. <br><br>  All analogues at the moment are bots with which you can send an audio message, and receive text in response.  This does not suit us very well: it is not very convenient to send a message to the bot, I would like to have native functionality.  In addition, any bot is a third party that acts as an intermediary between the speech recognition API and the user, and this is at least unsafe. <br><br>  As noted earlier, the telegram-desktop has two weight advantages: ease and speed.  And this is no accident, because it is completely written in C ++.  And since we decided to add new functionality directly to the client, we had to develop it in C ++. <br><br><img align="right" src="https://habrastorage.org/webt/8w/wp/n2/8wwpn2h7s2duvglwj4_b-xlhykk.jpeg">  There were 4 people in our team.  Initially, two people were searching for a suitable speech recognition library, one person studied the source code of Telegram-desktop, another one deployed a build of the <a href="https://github.com/telegramdesktop/tdesktop">Telegram Desktop</a> project.  Later, everyone was doing fix UI and debugging. <br><br>  It seemed that the implementation of the conceived functionality was not difficult, but, as always happens, difficulties arose. <br><br>  The solution of the problem consisted of two independent subtasks: choosing the appropriate means for speech recognition and implementing the UI for new functionality. <br><br>  When choosing a library for voice recognition, we immediately had to abandon all offline APIs, because language models take up a lot of space.  But we are talking only about one language.  It became clear that you have to use the online API.  Later it turned out that the speech recognition services of such giants as Google, Yandex and Microsoft are not at all free, and we will have to be content with the trial period.  As a result, Google Speech-To-Text was chosen, as it allows you to get a token to use the service, which is enough for a whole year. <br><br>  The second problem we encountered is associated with some drawbacks of C ++ - the zoo of various libraries in the absence of a central repository.  It so happened that Telegram Desktop depends on many other libraries of specific versions.  In the official repository there is <a href="">an</a> assembly <a href="">instruction</a> for the project.  As well as a large number of open issues about build issues, for example, <a href="https://github.com/telegramdesktop/tdesktop/issues/4275">one</a> and <a href="https://github.com/telegramdesktop/tdesktop/issues/4926">two</a> .  All problems were connected with the fact that the build script was written for Ubuntu 14.04, and in order to successfully build a telegram for Ubuntu 18.04, it was necessary to make changes. <br><br>  Telegram Desktop itself is built for a long time: on a laptop with an Intel Core i5-7200U, a complete build (-j 4 flag) with all dependencies takes about three hours.  Of these, about 30 minutes are taken by the linking of the client itself (it later turned out that in the Debug configuration, linking takes about 10 minutes), and the linking stage has to be repeated every time after making changes. <br><br>  Despite the problems, we managed to realize the conceived idea, as well as update the <a href="">build script</a> for Ubuntu 18.04.  Work demonstration can be seen on the <a href="https://drive.google.com/open%3Fid%3D1otJjbAicudfzRlRHhNJAWcuS1vBX_c5D">link</a> .  We also apply several animations.  A button appeared near all voice messages, allowing you to translate a message into text.  When you click the right mouse button, you can optionally specify the language that will be used for the broadcast.  The <a href="https://github.com/AntonCoon/tdesktop/releases">link</a> is available for download client. <br><br>  <a href="https://github.com/AntonCoon/tdesktop">Repository</a> <br><br>  In our opinion, it turned out a good Proof of Concept functionality that would be convenient for many users.  We hope to see it in future releases of Telegram Desktop. <br><br><h2>  Enhanced natural language support in IntelliJ IDEA </h2><br><img src="https://habrastorage.org/webt/xt/bu/ep/xtbuep8pkflphnvfvcfb6hm4eio.png"><br><br>  <b>Idea author</b> <br><br>  Tankov Vladislav <br><br>  <b>Line-up</b> <br><br>  Tankov Vladislav (timlid, work with LanguageTool and IntelliJ IDEA) <br>  Nikita Sokolov (working with LanguageTool and creating UI) <br>  Alexander Khvorov (work with LanguageTool and performance optimization) <br>  Alexander Sadovnikov (support for parsing markup languages ‚Äã‚Äãand code) <br><br>  We developed a plugin for IntelliJ IDEA that checks various texts (comments and documentation, literal strings in code, Markdown text or XML markup) for grammatical, spelling and stylistic fidelity (in English, this is called proofreading). <br><br>  The idea of ‚Äã‚Äãthe project was to extend the standard spellcheck IntelliJ IDEA to Grammarly scales, to make a kind of Grammarly inside IDE. <br><br>  Look at what happened, you can <a href="https://plugins.jetbrains.com/plugin/12175-grazi">link</a> . <br><br>  Well, below we will tell you more about the possibilities of the plug-in, as well as the difficulties encountered when creating it. <br><br>  <b>Motivation</b> <br><br>  There are many products created for writing texts in natural languages, but documentation and code comments are written most often in development environments.  At the same time, IDEs do an excellent job of finding errors in writing code, but are poorly suited for texts in natural languages.  Because of this, it is very easy to make mistakes in grammar, punctuation, or style, and the development environment does not indicate them.  The most critical is to make a mistake in the writing of the user interface, since not only the clarity of the code will suffer, but also the users of the developed application. <br><br>  One of the most popular and developed development environments is IntelliJ IDEA, as well as IDE based on IntelliJ Platform.  The IntelliJ Platform already has a built-in spellchecker, however, it does not eliminate even the simplest grammatical errors.  We decided to integrate one of the popular natural language analysis systems into IntelliJ IDEA. <br><br>  <b>Implementation</b> <br><br><img align="right" src="https://habrastorage.org/webt/e2/5_/cr/e25_crjowbelpxdvftvxetn-ut4.jpeg">  We did not set ourselves the task of creating our own text verification system, so we took advantage of the existing solution.  The most suitable option was <a href="http://languagetool.org/">LanguageTool</a> .  The license allowed us to use it freely for our purposes: it is free, written in Java and uploaded in open-source.  In addition, it supports 25 languages ‚Äã‚Äãand has been developing for more than fifteen years.  Despite its openness, LanguageTool is a serious competitor to paid text verification solutions, and the fact that it is able to work locally is literally its killer feature. <br><br>  The plugin code is in <a href="https://github.com/TanVD/Grazi">the GitHub repository</a> .  The whole project was written on Kotlin with a slight addition of Java for the UI.  During the hackathon, we managed to implement support for Markdown, JavaDoc, HTML and Plain Text.  After the hackathon, XML support, string literals in Java, Kotlin and Python, as well as spell checking were added in a large update. <br><br>  <b>Difficulties</b> <br><br>  Pretty quickly, we realized that if we feed the entire text to LanguageTool every time, the IDEA interface would hang on any more or less serious texts, since the inspection itself blocks the flow of UI.  The problem was solved by checking `ProgressManager.checkCancelled` - this function throws an exception if the IDEA believes that it is time to stop the inspections. <br><br>  This completely eliminated the hangs, but it is impossible to use it: the text is being processed for too long.  In this case, in our case, very often a very small part of the text changes and I want to somehow cache the results.  That is what we did.  In order not to check everything every time, we deterministically split the text into pieces and checked only those that have changed.  Since texts can be large and do not want to load the cache, we did not store the texts themselves, but their hashes.  This made it possible to achieve smooth operation of the plug-in even on large files. <br><br>  LanguageTool supports more than 25 languages, but hardly one user needs them all.  I wanted to give the opportunity to download libraries for a specific language on request (if they ticked it in the UI).  We even realized it, but it turned out too difficult and unreliable.  In particular, we had to load the LanguageTool with a new set of languages ‚Äã‚Äãwith a separate classloader, and then carefully initialize it.  At the same time, all the libraries were in the user .m2 repository, and at each start we had to check their integrity.  In the end, we decided that if users had problems with the size of the plug-in, then we would supply a separate plug-in for several of the most popular languages. <br><br>  <b>After hackathon</b> <br><br>  The hackathon ended, but the work on the plugin continued with a narrower composition.  I wanted to support lines, comments, and even language constructs, such as the names of variables and classes.  Now it is supported only for Java, Kotlin and Python, but we hope that this list will grow.  We fixed a lot of small errors and became more compatible with the built-in Idea spell checker.  In addition, there is support for XML and spell checking.  All this can be found in the second version, which we published recently. <br><br>  <b>What's next?</b> <br><br>  Such a plugin can be useful not only to developers, but also to technical writers (often working, for example, with XML in the IDE).  Every day they have to work with natural language, while not having an assistant in the form of editor's hints about possible errors.  Our plugin provides such hints and does it with a high degree of accuracy. <br>  We plan to develop a plugin, both by adding new languages ‚Äã‚Äãand by exploring a general approach to organizing text verification.  In the near future, the implementation of stylistics profiles (sets of rules that define style guide for text, for example, ‚Äúdo not write eg, but write the full form‚Äù), expand the dictionary and improve the user interface (in particular, we want to give the user the opportunity to not just ignore the word, but add it in the dictionary, indicating part of speech). </div><p>Source: <a href="https://habr.com/ru/post/449496/">https://habr.com/ru/post/449496/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../449484/index.html">We create air quality control sensor on InfluxDB, Grafana, Docker and Raspberry Pi</a></li>
<li><a href="../449486/index.html">Mass outcome of browser games</a></li>
<li><a href="../44949/index.html">Perpetuum mobile Magnetogenerator free energy.</a></li>
<li><a href="../449490/index.html">Slurm: intense by Kubernetes. Program and bonuses</a></li>
<li><a href="../449494/index.html">AI interfaces and where they live</a></li>
<li><a href="../449498/index.html">Analysts: Microsoft's estimate will soon exceed $ 1 trillion</a></li>
<li><a href="../4495/index.html">Investors admitted: a lot of money, but there are not enough startups</a></li>
<li><a href="../449500/index.html">How not to succumb to panic, if a lot of programmers came to visit?</a></li>
<li><a href="../449502/index.html">Antiquities: an incredible videotape</a></li>
<li><a href="../449506/index.html">Overview: six ways to use resident proxies to solve corporate problems</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>