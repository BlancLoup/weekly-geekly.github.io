<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Enabling anything over HTTP without problems with OpenWRT</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the comments on the article about the experience of manufacturing the ‚ÄúInternet outlet‚Äù two comments caught my attention. One in which it was claim...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Enabling anything over HTTP without problems with OpenWRT</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/c26/eb7/2da/c26eb72da051dc970a3d9bba79262374.jpg"><br>  In the comments on the article about the experience of manufacturing the <a href="http://habrahabr.ru/post/149289/">‚ÄúInternet outlet‚Äù</a> two comments caught my attention.  One in which it was claimed that such a thing, in fact, was useless, seemed unfair to me - I remember well how I once needed, for example, to remotely ‚Äúreset‚Äù one tricky little thing and think that I‚Äôm not alone.  But the idea that it is possible to solve a similar question is easier and cheaper, using, for example, TP-LINK TL-MR3020 + OpenWRT seemed to me practical.  I also decided to do without disassembling the device, programming and microcontrollers - in short, to make the decision as accessible as possible.  And I almost got it! <br><a name="habracut"></a><br>  As an output device, we use a regular USB keyboard.  When I met at the supermarkets of the disgusting quality of the keyboard at ridiculous prices, I was always surprised - why would you need it?  Yes, that's what for!  In the keyboard there are three LEDs that can be programmed to control from any device that supports this keyboard.  Replacing the LEDs with a control circuit - we get control of three loads.  As a bonus - the possibility of further finishing the device for use as an input device.  Of course, you can not shoot the gun on the sparrows, collect (or purchase) the simplest device on the microcontroller, which will have indisputable advantages (more inputs / outputs, normal logic levels, etc.).  But the ‚Äúkeyboard‚Äù approach also has advantages - it is available to people unfamiliar with MCs who do not have a programmer.  You can simply take and make a working device today, now.  In addition, among the advantages: <br><ul><li>  the solution is easily portable to other platforms: I didn‚Äôt check it, but in theory it can be plugged into any ASUS or D-Link peacefully distributing Internet from its own corner (if it has USB) - and it will work; </li><li>  the router can be used for its intended purpose; </li><li>  disassembling the router and interfering with its scheme is not required (and the TL-MR3020, by the way, is not easy to disassemble); </li><li>  no programming (except a small shell script) and compilation is required; </li><li>  All components can be purchased at a computer store (if you simply ‚Äúflash the LED‚Äù, for real control you will have to buy a couple of available radio components), while the total costs will be less than 1500 rubles. </li></ul><br><h5>  Install OpenWRT and configure the network interface. </h5><br>  For this step, you will actually need a router.  My cost me 850r. <br>  <a href="http://wiki.openwrt.org/toh/tp-link/tl-mr3020">The model page on openwrt.org</a> gives comprehensive instructions on flashing and allows us to use the trunk snapshot.  I myself will timidly suggest taking the <a href="">Attitude Adjustment beta 12.09</a> .  Moreover, at the time of publication snapshots are not available on the openwrt website, and AA12.09 is finally uploaded. <br><div class="spoiler">  <b class="spoiler_title">The installation consists of several elementary operations:</b> <div class="spoiler_text"><ol><li>  Configure the network connection of your PC to automatically obtain an IP address and connect the router with an Ethernet cable (after flashing, the WiFi interface will be disabled) </li><li>  Log into the router administration page (default address is 192.168.0.254 user: admin, password: admin) </li><li>  On the System Tools&gt; Firmware upgrade tab, select the previously downloaded firmware, click ‚ÄúUpgrade‚Äù and wait until the download indicator reaches 100% twice. </li><li>  Since the default OpenWRT network parameters differ from TP-LINK's, the easiest way to re-initialize the interface is to disconnect and reconnect the ethernet cable. </li><li>  We go to the telnet router (192.168.1.1 - the address of the ‚Äúfresh‚Äù OpenWRT by default) and set the password using the passwd command - now the router is accessible via SSH (and unavailable via telnet). </li></ol><br></div></div><br>  To install additional packages, you need access to the repository via the Internet, which requires its configuration as a client of the local network. <br><div class="spoiler">  <b class="spoiler_title">For example:</b> <div class="spoiler_text">  To configure a static IP in the segment 192.168.1.x do the following: <br><pre><code class="bash hljs">uci <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> network.lan.proto=static uci <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> network.lan.ipaddr=192.168.1.222 uci <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> network.lan.netmask=255.255.255.0 uci <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> network.lan.gateway=192.168.1.1 uci <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> network.lan.dns=8.8.8.8 uci changes uci commit /etc/init.d/network restart</code> </pre> <br>  Where 192.168.1.1 is the gateway address in our network, and 192.168.1.222 is the unused IP, which will be assigned to our box.  The ‚Äúuci changes‚Äù command provides the ability to view all the changes made.  I try not to neglect this opportunity, since a device with an incorrectly configured interface, being inaccessible from the outside, turns into a ‚Äúzombie‚Äù.  <i>In case all the same trouble occurred, OpenWRT provides a ‚Äúrecovery mode‚Äù: when booting, as soon as the ‚ÄúWPS‚Äù button starts blinking, hold it down - the MR3020 will boot with the default network settings.</i> <br>  If DHCP is working on the network, you can configure it automatically: <br><pre> <code class="bash hljs">uci <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> network.lan.proto=dhcp uci <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> network.lan.hostname=etherelay uci commit /etc/init.d/network restart</code> </pre><br>  The second line is optional, but can be extremely useful for finding a device.  It will be possible to access the device not by IP, but by hostname, if the network supports it.  If you want to avoid searching for a device on the network by 100%, use a static configuration. <br>  It is also useful to prohibit the work of the dhcp server built into our TP-LINK: <br><pre> <code class="bash hljs">uci <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> dhcp.lan.ignore=1 uci commit /etc/init.d/dnsmasq restart</code> </pre><br>  Everything, you can disconnect our box from the computer (all the same, the ssh session was already terminated after the last command) and connect it to the router or switch. <br></div></div><br><h5>  Connecting the keyboard and checking the LED control </h5><br>  The <a href="http://h-wrt.com/ru/doc/kb">H-WRT</a> website informs us that only the kmod-usb-hid module is needed to install the keyboard. <br>  Install it: <br><pre> <code class="bash hljs">opkg update opkg install kmod-usb-hid</code> </pre><br>  It's time to connect the keyboard and see if it was identified: <br><pre> <code class="bash hljs">root@OpenWrt:~<span class="hljs-comment"><span class="hljs-comment"># dmesg | tail [ 66.380000] hub 1-0:1.0: connect-debounce failed, port 1 disabled [ 68.780000] hub 1-0:1.0: connect-debounce failed, port 1 disabled [ 71.180000] hub 1-0:1.0: connect-debounce failed, port 1 disabled root@OpenWrt:~#</span></span></code> </pre><br>  Bummer!  This is not what I expected.  What is the matter? <br>  A similar <a href="https://dev.openwrt.org/ticket/11985">bug report is</a> quickly located - the developers explain this behavior by the hardware limitations of the applied chipset.  It seems that the on-board USB hub does not favor the low-speed device.  Although at this moment the spirit of Zen evaporated without a trace - we will not give up and try to solve the problem by connecting the keyboard through an external USB hub: <br><pre> <code class="bash hljs">root@OpenWrt:~<span class="hljs-comment"><span class="hljs-comment"># dmesg | tail [ 143.120000] usb 1-1: new high-speed USB device number 2 using ehci-platform [ 143.270000] hub 1-1:1.0: USB hub found [ 143.270000] hub 1-1:1.0: 4 ports detected [ 143.580000] usb 1-1.2: new low-speed USB device number 3 using ehci-platform [ 143.730000] input: Generic USB Keyboard as /devices/platform/ehci-platform/usb1/1-1/1-1.2/1-1.2:1.0/input/input0 [ 143.730000] generic-usb 0003:040B:2000.0001: input: USB HID v1.10 Keyboard [Generic USB Keyboard] on usb-ehci-platform-1.2/input0 [ 143.770000] input: Generic USB Keyboard as /devices/platform/ehci-platform/usb1/1-1/1-1.2/1-1.2:1.1/input/input1 [ 143.780000] generic-usb 0003:040B:2000.0002: input: USB HID v1.10 Mouse [Generic USB Keyboard] on usb-ehci-platform-1.2/input1 root@OpenWrt</span></span></code> </pre><br>  Much better.  Let because of this I had to write ‚Äúalmost succeeded‚Äù at the beginning of the article and ‚Äúthe way of serving‚Äù in the photo, but this is how our ‚ÄúGeneric USB Keyboard‚Äù was identified.  Two ‚Äúdevices‚Äù are always created on the keyboard, but don‚Äôt even ask why this particular keyboard was also called a mouse ... One way or another, we‚Äôre ready for a ‚Äúhardware hello shape‚Äù ‚Äîto turn on the LED. <br><pre> <code class="bash hljs">cat /dev/input/event0 &gt; /dev/null &amp; <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x11\x00\x01\x00\x00\x00\x01"</span></span> &gt; /dev/input/event0</code> </pre><br>  The ‚ÄúCaps Lock‚Äù LED should light up here.  Those who are simply happy with this fact can move on to the next step.  Those who can not move on without knowing what a crazy spell is given above - look into <div class="spoiler">  <b class="spoiler_title">muddled explanation:</b> <div class="spoiler_text">  For everything that happens with the keyboard (or another input device), an input event is generated that is visible in the corresponding file (in our case / dev / input / event0, but this is a special case due to the fact that no other input devices are connected).  The structure of the event is defined in the <a href="">input.h</a> header file: <br><pre> <code class="cpp hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">input_event</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">timeval</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">time</span></span></span><span class="hljs-class">;</span></span> __u16 type; __u16 code; __s32 value; };</code> </pre><br>  Where type indicates the type of input item (keyboard button or mouse / joystick movement, etc.), the code is the item-specific code for each type (for example, the key number for the EV_KEY key event will be passed here), and value is, respectively what effect and what magnitude (for devices supporting it) was produced.  For example, when you press the "Q" key on the keyboard, we get: <br><pre> <code class="bash hljs">root@OpenWrt:~<span class="hljs-comment"><span class="hljs-comment"># cat /dev/input/event0 | hexdump 0000000 505b 0ed9 0009 6bdd 0004 0004 0007 0014 0000010 505b 0ed9 0009 6be6 0001 0010 0000 0001 0000020 505b 0ed9 0009 6bec 0000 0000 0000 0000 0000030 505b 0ed9 000a 2756 0004 0004 0007 0014 0000040 505b 0ed9 000a 275e 0001 0010 0000 0000 0000050 505b 0ed9 000a 2762 0000 0000 0000 0000</span></span></code> </pre><br>  where the first 8 bytes (505b 0ed9 000 * ****) is the event time, the next two bytes (0001) are the event type (EV_KEY), then two bytes of the key number (0010), which for the alphanumeric keys correspond to the scan code in Set 1. By the way, pressing any "pumped" keys like volume control, playback control, etc.  sent to the second handler created for the keyboard (in our case / dev / input / event1).  For them, the auto-repeat event is not generated, which can be very useful - remember, I wrote about the "bonus" ability of the device to work on input?  The last 4 bytes (0000 0001 or 0000 0000) indicate that a press or release occurred, respectively.  Packages consisting of zeros are special separating events EV_SYN, but I don‚Äôt know why type 4 events are needed.  Definitions for types and codes are given in the same <i>input.h</i> , and are described <a href="http://www.kernel.org/doc/Documentation/input/event-codes.txt">in</a> more detail <a href="http://www.kernel.org/doc/Documentation/input/event-codes.txt">in this document</a> .  Then the fun begins.  Although most events are transmitted from the device to user space, some events can go in the opposite direction.  This is done to support, for example, joysticks with feedback or (ta-dam!) LEDs.  That is, by recording an event with type EV_LED, code LED_CAPSL and value 1 in / dev / event / input0, we will order the keyboard to light the ‚ÄúCaps Lock‚Äù LED.  Enough details about working with input devices, especially USB, are told in the articles by Brad Hards (Brad Hards) <a href="http://www.linuxjournal.com/article/6396">The Linux USB Input Subsystem</a> and <a href="http://www.linuxjournal.com/article/6429">Using the Input Subsystem</a> (continuation of the first article, even with <a href="http://www.linuxjournal.com/files/linuxjournal.com/linuxjournal/articles/064/6429/6429l9.html">sample code</a> to control the LED).  It is a pity that I found them too late, when the problem has already been solved experimentally.  By the way, I was very lucky - the last snapshots, as well as beta 12.09, have one <i>feature</i> , because of which the sending of events is unstable if the device file is not constantly read.  This is what the command is for. <pre> <code class="bash hljs">cat /dev/input/event0 &gt; /dev/null &amp;</code> </pre>  I experimented first with the r31214 firmware, where there were no such features, so the LED on me came on right away - if that hadn't happened, then I would have been looking for the right way for a long time. <br></div></div><br><h5>  Script </h5><br>  To automate the management of LEDs, we need a script.  To blink them over HTTP in the next step, we will immediately put it in the / www / cgi-bin folder: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /www mkdir cgi-bin <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> cgi-bin wget http://etherelay.googlecode.com/files/ctlrelay chmod +x ctlrelay</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Here is its text and description:</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh KB_LEDS=/dev/input/event0 EV_LED="\x00\x11" LED_NUML="\x00\x00" LED_CAPSL="\x00\x01" LED_SCROLLL="\x00\x02" TURN_ON="\x00\x00\x00\x01" TURN_OFF="\x00\x00\x00\x00" DT_DUMMY="\x00\x00\x00\x00\x00\x00\x00\x00" # 16-       NUM_ON=$DT_DUMMY$EV_LED$LED_NUML$TURN_ON NUM_OFF=$DT_DUMMY$EV_LED$LED_NUML$TURN_OFF CAPS_ON=$DT_DUMMY$EV_LED$LED_CAPSL$TURN_ON CAPS_OFF=$DT_DUMMY$EV_LED$LED_CAPSL$TURN_OFF SCROLL_ON=$DT_DUMMY$EV_LED$LED_SCROLLL$TURN_ON SCROLL_OFF=$DT_DUMMY$EV_LED$LED_SCROLLL$TURN_OFF #"",        if ! ps | grep -qe "[c]at $KB_LEDS"; then cat $KB_LEDS &gt; /dev/null &amp; fi #   "" command GET- #   -      if [ -z "$QUERY_STRING" ]; then COMMAND=$1; else COMMAND=`echo "$QUERY_STRING" | sed -n 's/^.*command=\([^&amp;]*\).*$/\1/p'` printf "Content-type: text/plain\r\n\r\n" fi #     case $COMMAND in num_on) printf $NUM_ON &gt; $KB_LEDS;; num_off) printf $NUM_OFF &gt; $KB_LEDS;; caps_on) printf caps_on &gt; /var/rrr printf $CAPS_ON &gt; $KB_LEDS;; caps_off) printf caps_off &gt; /var/rrr printf $CAPS_OFF &gt; $KB_LEDS;; scroll_on) printf $SCROLL_ON &gt; $KB_LEDS;; scroll_off) printf $SCROLL_OFF &gt; $KB_LEDS;; num_pulse) printf $NUM_ON &gt; $KB_LEDS sleep 1 printf $NUM_OFF &gt; $KB_LEDS ;; caps_pulse) printf $CAPS_ON &gt; $KB_LEDS sleep 1 printf $CAPS_OFF &gt; $KB_LEDS ;; scroll_pulse) printf $SCROLL_ON &gt; $KB_LEDS sleep 1 printf $SCROLL_OFF &gt; $KB_LEDS ;; *) WRONG_ARG=1;; esac #       if [ -z $WRONG_ARG ] then STATE_FILE=/var/ledstate DEFAULT_STATE={\"num\":false,\"caps\":false,\"scroll\":false} if ! [ -e $STATE_FILE ]; then echo $DEFAULT_STATE &gt; $STATE_FILE; fi AFFECTED_LED=`echo $COMMAND | sed -r -e 's/_[az]+$//'` NEW_STATE=`echo $COMMAND | sed -r -e 's/^[az]+_//' -e 's/on/true/' -e 's/off|pulse/false/'` sed -i -r 's/"'"$AFFECTED_LED"'":[az]+/"'"$AFFECTED_LED"'":'"$NEW_STATE"'/' $STATE_FILE fi</span></span></code> </pre><br>  The constants EV_LED, LED_NUML, LED_CAPSL, LED_SCROLLL, as I said, are defined in <i>input.h</i> .  Time does not bother us - we fill it with zeros.  Of course, the code will turn out to be more compact if you form "events" on the fly, based on the command received, and not just send pre-filled templates in a switch, but it seemed to me that the basic idea was so clearer.  We still need to read from the event file while writing to it, from which the proverbial crutch appeared.  Again, this was not necessary in earlier assemblies, and most likely will not be needed in the future.  But for now it is necessary to put up.  The last fragment modifies the file of the current state of the LEDs, which consists of one approximately the following line: <pre>  {"num": true, "caps": false, "scroll": false} </pre>  If there is no such file, it will be created with all the values ‚Äã‚Äã‚Äúfalse‚Äù.  In OpenWRT, the / var / directory is in RAM, which means that the file is created after each reboot, when all the LEDs are turned off.  Cozy shemka!  I read the parameters from the HTTP request, probably <a href="http://www.team2053.org/docs/bashcgi/gettingstarted.html">here</a> (I read it a long time and did not save the link, only a line of code, but it‚Äôs very similar here).  The script displays <i>"Content-type: text / plain"</i> if it is called via CGI, because otherwise the result of the query will be 502 (Bad Gateway), and not 200 (OK), which is not fatal, but ugly. <br></div></div><br>  Now control LEDs easily.  To enable, say, the LED "Scroll Lock", we write: <br><pre> <code class="bash hljs">./ctlrelay scroll_on</code> </pre><br>  Turn off: <br><pre> <code class="bash hljs">./ctlrelay scroll_off</code> </pre><br>  You can still blink (scroll_pulse).  As the already respected Anant Agarwal says here already: ‚ÄúI could do this all day.  This is so much fun! ‚Äù  But still, move on to the next stage and create ... <br><br><h5>  Web interface </h5><br>  What is a web interface without a web server?  Check its availability: <br><pre> <code class="bash hljs">opkg status uhttpd</code> </pre><br>  If there is a <i>Status: install user installed</i> line in the output (and this will be the case if you use Attitude Adjustment 12.09 beta) then the server is already installed.  Otherwise, install it and configure its launch: <br><pre> <code class="bash hljs">opkg update opkg install uhttpd /etc/init.d/uhttpd <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> /etc/init.d/uhttpd start</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Next we need a web page:</b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Relay control<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"content-type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html; charset=utf-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">command</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">action</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span></span><span class="javascript">{ url=</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"/cgi-bin/ctlrelay?command="</span></span></span><span class="javascript">+action; url=url+</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"&amp;fuie="</span></span></span><span class="javascript"> + </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">Math</span></span></span><span class="javascript">.random(); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> xmlhttp=</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">new</span></span></span><span class="javascript"> XMLHttpRequest(); xmlhttp.open(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"GET"</span></span></span><span class="javascript">,url,</span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">false</span></span></span><span class="javascript">); xmlhttp.send(); } </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">get_status</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> xmlhttp=</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">new</span></span></span><span class="javascript"> XMLHttpRequest(); xmlhttp.onreadystatechange=</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (xmlhttp.readyState==</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">4</span></span></span><span class="javascript"> &amp;&amp; xmlhttp.status==</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">200</span></span></span><span class="javascript">) { ledstate = </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">JSON</span></span></span><span class="javascript">.parse(xmlhttp.responseText) </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">for</span></span></span><span class="javascript"> (led </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">in</span></span></span><span class="javascript"> ledstate) { </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.getElementById(led).checked=ledstate[led] } } } xmlhttp.open(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"GET"</span></span></span><span class="javascript">,</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"/ledstate?fuie="</span></span></span><span class="javascript">+ </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">Math</span></span></span><span class="javascript">.random(),</span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">false</span></span></span><span class="javascript">); xmlhttp.send(); setTimeout(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"get_status()"</span></span></span><span class="javascript">,</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">500</span></span></span><span class="javascript">); } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onload</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"get_status()"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"controls"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"control"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"scroll"</span></span></span><span class="hljs-tag">&gt;</span></span>Scroll Lock LED<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"scroll"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"checkbox"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"if (this.checked) command ('scroll_on'); else command ('scroll_off')"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"control"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"caps"</span></span></span><span class="hljs-tag">&gt;</span></span>Caps Lock LED<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"caps"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"checkbox"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"if (this.checked) command ('caps_on'); else command ('caps_off')"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"control"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"num"</span></span></span><span class="hljs-tag">&gt;</span></span>Num Lock LED<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"num"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"command('num_pulse')"</span></span></span><span class="hljs-tag">&gt;</span></span>1s blink<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  At first, I wanted to use jQuery.get (), but then I considered it unnecessary to involve JQuery for the sake of just a couple of GET requests.  We have two JavaScript functions.  The first, <i>command (action)</i> , runs our script, passing the ‚Äúcommand‚Äù in the ‚Äúcommand‚Äù parameter of the GET request.  Which one is defined in the onclick events of the controls.  It does not look very elegant, no doubt, but it gives a good idea of ‚Äã‚Äãhow everything works.  The second function, <i>get_status (),</i> runs on the <i>onload event</i> , requests a file with the current state of the LEDs (the one that forms at the end of the script) and reflects it on the page controls.  By incredible coincidence, the state file is a JSON representation of an associative array, and we very easily get access to the data using <i>JSON.parse ()</i> .  Repeating the request every half second allows you to track status changes made from another client.  The addition to the url <i>fuie = Math.random () is</i> needed so that the address is unique each time - then the browser will not be able to refuse the page request, finding that it is already in the cache.  As you can guess from the name of the variable, it is especially prone to this behavior of Internet Explorer. <br></div></div><br>  A small nuance - the browser, of course, does not have access to the / var folder on the server, so we will give it the opportunity to read the ledstate file from where it ‚Äúreaches out‚Äù using the symlink: <br><pre> <code class="bash hljs">ln -s /var/ledstate /www/ledstate</code> </pre><br>  A link to download this page, slightly modified, can be found almost at the very end of the article.  Now you can blink the LEDs of the keyboard, poking at the checkboxes.  But, not even considering the fact that now it‚Äôs impossible to surprise anyone with a flashing LED, you will have to agree that it is absolutely useless from a practical point of view.  Therefore, let's get down to iron! <br><br><h5>  Scheme </h5><br>  You can already disassemble the keyboard and pull the board out of it: <br><img src="https://habrastorage.org/storage2/81d/bc6/d31/81dbc6d319c3cb6f4fc4dc48ef2ebe08.jpg"><br>  The scheme of switching on the LEDs of the keyboard is represented by the following (very simplified) model (for the on state): <br><img src="https://habrastorage.org/storage2/35f/9d8/ca8/35f9d8ca8875644665e487f33a9f5b5f.png" alt="Keyboard LEDs"><br>  <b>Scheme 1. Turning on the keyboard LED</b> <br>  Three proven ‚Äúclavs‚Äù from the ‚Äúscrubber‚Äù segment had just such an inclusion of LEDs, only their currents differ - usually around 18mA, but sometimes 3mA.  It must be borne in mind that other schemes are possible. <br>  The simplest is if you need to switch a small voltage and current (remote "Reset" of any device or emulation of other buttons / logic signals).  You can do the usual optocoupler: <br><img src="https://habrastorage.org/storage2/1da/d28/a23/1dad28a2308b864e5ec110a3d9870f5d.png" alt="wiring diagram of the optocoupler to the keyboard to control the logic levels"><br>  <b>Scheme 2. Formation of a logical signal</b> <br>  To control the device with mains powered, we take a solid-state relay: <br><img src="https://habrastorage.org/storage2/eed/c3b/d18/eedc3bd189f703a69655c7ce946d2d69.png" alt="solid state relay on circuit instead of keyboard LED"><br>  <b>Diagram 3. Control of a solid-state relay</b> <br>  I used the domestic relay <a href="http://www.proton-orel.ru/File/optron1/pdf/293kp13.pdf">K293KP13P</a> because of the price of 170 rubles.  The maximum current in the load for which it is designed - 1A.  The current through the control LED should not be lower than the minimum (in the documentation it is designated I <sub>F</sub> min) for the type of relay used.  If the keyboard board gives less current (unsolder one lead of the LED and measure the current in the gap) - an additional transistor switch will help: <br><img src="https://habrastorage.org/storage2/4d1/97b/4a7/4d197b4a7bb0885d2242cedcaac884e8.png" alt="the inclusion of a solid-state relay through a transistor switch."><br>  <b>Scheme 4. Connecting a solid-state relay through a key</b> <br>  He will save if you use a solid-state relay, voltage controlled or "classic" electromechanical relay: <br><img src="https://habrastorage.org/storage2/f9e/850/3c6/f9e8503c633e5460f2cf2b9920a8dc91.png" alt="wiring diagram of the relay instead of the keyboard LED"><br>  <b>Diagram 5. Control of an electromechanical relay</b> <br>  A solid-state relay is rather expensive, and the more powerful the more expensive.  A regular relay gives more ‚Äúamps per ruble‚Äù, but it has its drawbacks.  Among them - the big consumed current in the included state.  If you simultaneously turn on three relays of the same model as in the diagram, the current consumed from USB will be almost 300 mA.  If you do not want to ‚Äúmilk‚Äù the port so much - connect the emitter not to it (the dotted line in the diagram), but to an independent source. <br>  Circuits 4 and 5, of course, work only on keyboards where the LEDs are turned on according to the circuit with a ‚Äúcommon anode‚Äù (check the resistance between the anodes of the diodes and the ‚Äúplus‚Äù of the board - it should be 0 Ohm).  If reluctance to bother with this - you can use low-power optorele instead of a key.  It turns on instead of the standard LED and operates at a current on the LED from 5 to 25 mA, that is suitable for all variants of keyboards with a probability of 99%.  If you need to switch the voltage up to 60 V and current up to 300 mA - you can remove the relay and use the optolera directly. <br><img src="https://habrastorage.org/storage2/405/779/1b3/4057791b3c5b85d8d8f24b814b39a3da.png" alt="wiring diagram of the relay instead of the keyboard LED"><br>  <b>Diagram 6. Control of an electromechanical relay using an optorele</b> <br><div class="spoiler">  <b class="spoiler_title">There are many simplifications in the scheme and its implementation:</b> <div class="spoiler_text">  Not bad to add a fuse to the switched circuit.  The transistor in circuit 5 operates with an almost maximum collector current ‚Äî it is desirable to take a smaller response current, or at least a more powerful transistor.  At the outputs of the solid-state relay you need to put a damping RC-chain when working on a motor or other inductive load.  The components were selected only according to the criterion of availability and price in the nearest (to me) very expensive radio store - if you have a choice, you can pick up a solid body from a normal seller for the desired current with a wide range of I <sub>F</sub> and then close the issue with switching.  In addition, the presented switching model is inaccurate: the keyboard board behaves as a current source in relation to our ‚ÄúLED‚Äù only when the anode voltage is 2.5V and higher - I tried, if possible, to provide a voltage drop similar to that of the replaced LED, so that The board "did not feel" the substitution. <br></div></div>  What you always have to take into account is elementary electrical safety.  Even a test device ‚Äî <i>especially a</i> test device, which will most likely hang around somewhere on the wiring or will be forgotten to be included, among other things, junk on the table ‚Äî must be protected from accidentally touching live parts, if it provides for connection to the network.  Otherwise, an absolutely real electric current can flow through you. <br>  I collected options 3 and 6 on the breadboard, it turned out like this: <br><img src="https://habrastorage.org/storage2/f04/60d/170/f0460d1704785e6d66cac63197d0da2f.jpg"><br>  Despite the fact that this is nothing more than a ‚Äúproof of concept‚Äù, I wanted to ‚Äúbring beauty‚Äù a little, even in my own perverted interpretation.  Such now times: the appearance is valued not less, and sometimes unnecessarily more functional load.  Which brings us to the next stage. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Cosmetics and Demonstration </h5><br>  From the HTML - interface for kilometer carries the botanist, biker shirts with pellets and pasta from a glass jar: <br><img src="https://habrastorage.org/storage2/a99/150/204/a99150204883da808dde867f9f883879.png"><br>  Let's try to somehow brighten it up. <br><ol><li>  Since my artistic abilities are at zero, and the taste is somewhere near them - <s>I stole the idea from here,</s> I got inspiration (and some css) here: <a href="http://www.seanslinsky.com/demo/ios-toggle-switches/">http://www.seanslinsky.com/demo/ios-toggle-switches/</a> . </li><li>  With the help of a gradient generator, <a href="http://mudcu.be/bg">mudcu.be/bg</a> made a <a href="http://mudcu.be/bg">non-dull</a> <s>wallpaper</s> backdrop. </li><li>  The cool toggle generator <a href="http://proto.io/freebies/onoff/">proto.io/freebies/onoff</a> creates buttons that work in almost all browsers ‚Äî even in Opera, if you make them square, and even in IE, if it is&gt; = 9. </li><li>  Since on different systems the zoom works differently - we make the zoom buttons inside the <a href="http://davidwalsh.name/change-text-size-onclick-with-javascript">davidwalsh.name/change-text-size-onclick-with-javascript</a> page <a href="http://davidwalsh.name/change-text-size-onclick-with-javascript">.</a> </li></ol><br>  CSS does not make sense to give, because 90% generated automatically, and HTML - 90% of the above.  Therefore, I just write as to download: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /www mkdir luci mv index.html luci wget http://etherelay.googlecode.com/files/index.html wget http://etherelay.googlecode.com/files/style.css</code> </pre><br>  The second and third lines "hide" the file of the web-interface of the router (if it is installed) into a separate folder, now it is available at the address of the router_address / luci.  And the ‚Äúmain‚Äù page accessible to the server‚Äôs address is ours. <br>  And finally, they say that a picture is worth a thousand words.      . ,   -   . <iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/H2U-RjV61Mk%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700253,15700255,15700259&amp;usg=ALkJrhg1P0oDSAzeKhGE6r9NYKdLkdhM_w" frameborder="0" allowfullscreen=""></iframe><br> <b>Update:</b> <a href="https://geektimes.ru/users/nm11/" class="user_link">nm11</a> ,     - (,   <i>wizard</i>   <i>lumos</i> ): <br><pre> <code class="bash hljs">uci <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> uhttpd.main.config=/etc/httpd.conf uci commit uhttpd <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/:wizard:lumos"</span></span> &gt; $(uci get uhttpd.main.config) /etc/init.d/uhttpd restart</code> </pre></div><p>Source: <a href="https://habr.com/ru/post/151982/">https://habr.com/ru/post/151982/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../151976/index.html">Scripting Java using JSR 223 - an example of writing a template engine in 20 lines from personal experience</a></li>
<li><a href="../151977/index.html">Zoom windows</a></li>
<li><a href="../151978/index.html">Facebook added ‚Äúsearch history‚Äù</a></li>
<li><a href="../151980/index.html">CBS: From Student to Entrepreneur, or Model Danish University</a></li>
<li><a href="../151981/index.html">Forcing providers to prosecutors to block YouTube and VKontakte without a court is scheduled to be committed throughout Russia</a></li>
<li><a href="../151984/index.html">Windows XP in the domain as Terminal Server (Linux way)</a></li>
<li><a href="../151986/index.html">Why do they make music on iOS, but not on Android and Windows Phone?</a></li>
<li><a href="../151987/index.html">How we came to this: modern smartphones and their prospects</a></li>
<li><a href="../151988/index.html">DIY music in the bathroom</a></li>
<li><a href="../151989/index.html">A textbook on the history of art came out without pictures</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>