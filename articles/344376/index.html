<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vulnerability found in all versions of Windows, which does not close any antivirus</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Hacker News portal reports that a vulnerability has been detected in the Windows loader, which allows you to run executable code so that it is not...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vulnerability found in all versions of Windows, which does not close any antivirus</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://thehackernews.com/2017/12/malware-process-doppelganging.html">The Hacker News</a> portal reports that a vulnerability has been detected in the Windows loader, which allows you to run executable code so that it is not detected by antivirus programs, while the exploit leaves no trace on the file system. <br><br><img src="https://habrastorage.org/webt/8b/ma/0b/8bma0btw2shnpjisc42nu3olbiq.png"><br><a name="habracut"></a><br>  The technology used in the exploit, called Process Doppelg√§nging (from "doppelganger" - "twin"), and uses the technology NTFS Transactions to hide traces and launch Malvar.  The general scheme of the exploit is as follows: <br><br>  At the first stage, an NTFS transaction is created to change a legitimate Windows file, its body is replaced with malicious code.  The transaction does not close. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The second stage is creating a copy of the modified file in memory (memory section).  Malicious code gets into the memory, but since there was no actual access to the file system, the antiviruses do not respond to the appeal to the file system. <br><br>  The third stage is the rollback of the NTFS transaction.  The file has not changed, there are no traces on the disk, but the malware has already been stored in the memory. <br><br>  The fourth stage is a call to the Windows loader using a call that creates a process from a section of memory created from an executable file (ZwCreateProcess), which actually contains the malicious code.  The antivirus scanner's algorithms react, but they read the image of the file from the disk, and there no one has changed anything, and the process is launched for execution. <br><br>  The developers claim that currently this exploit cannot be blocked, but anti-virus solutions can be updated to detect attacks through this method.  Currently, the vulnerability exists in all versions of Windows, starting with <s>Windows XP</s> Windows Vista, in which NTFS transactions were entered, and ending with the latest version of Windows 10 Fall Creators Update.  The last one had a bug, because of which the use of Process Doppelg√§nging dropped the system into a ‚Äúblue screen of death‚Äù, but Microsoft has since fixed this bug. <br><br>  Proven antivirus solutions that allow exploit on December 7, 2017 (from source): Windows Defender, Kaspersky Endpoint Protection 14, AVG Internet Security, ESET NOD 32, Symantec Endpoint Protection 14, Trend Micro, Avast, McAfee VSE 8.8, Panda Antivirus, Qihoo 360 </div><p>Source: <a href="https://habr.com/ru/post/344376/">https://habr.com/ru/post/344376/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../344366/index.html">30-hour hakaton Yandex. Weather, or how to predict precipitation on signals from users</a></li>
<li><a href="../344368/index.html">React, Drag & Drop and performance</a></li>
<li><a href="../344370/index.html">Check Point Instructions and Useful Documentation</a></li>
<li><a href="../344372/index.html">Overview of Fujitsu PRIMERGY TX1330 M3 floor server</a></li>
<li><a href="../344374/index.html">Case SMS working on customer loyalty</a></li>
<li><a href="../344378/index.html">The fastest and most energy-efficient implementation of the BFS algorithm on various parallel architectures</a></li>
<li><a href="../344380/index.html">Introducing dependencies in .Net Mark Siman 2 - Implementing a constructor, lifetime</a></li>
<li><a href="../344382/index.html">How we created a password manager with strong cryptography and a master password. Experience team Yandex. Browser</a></li>
<li><a href="../344384/index.html">Authentication and authorization in Ember, Part 1: ember library simple auth</a></li>
<li><a href="../344386/index.html">Formula 1 for drones: ITMO University team ranked first at Robotex-2017</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>