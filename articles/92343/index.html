<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We pull out a bunch of passwords from peer-to-peer networks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There was this idea for a long time - ever since when I learned about wand.dat. Until recently, all did not reach the hands. 

 So what do we have 

1...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We pull out a bunch of passwords from peer-to-peer networks</h1><div class="post__text post__text-html js-mediator-article"> <a title="95 wand.dat with just eight hubs; screenshot taken at 8:30 MSK on April 29, 2010" href=""><img src="https://habrastorage.org/storage/habraeffect/25/b2/25b271f1d4c187fbe3d3495f41e89c69.png" align="right"></a>  There was this idea for a long time - ever since when I learned about wand.dat.  Until recently, all did not reach the hands. <br><br>  So what do we have <ol><li>  Opera browser.  It stores all memorized passwords from sites in the open file wand.dat.  True in the open only if it is not worth the master password, which of course no one puts.  What made the developers save passwords in an unencrypted form, if there is no master password?  Unknown.  It would be logical to forcefully not save passwords at all until the user sets the master password. </li><li>  Direct Connect.  "Partially Centralized File Sharing (P2P) Network."  A user shares folders / files on his computer, enters hubs, downloads / distributes.  Search works within connected hubs.  The uniqueness of the files is determined by Tiger Tree Hashing.  People who have nothing to share (many hubs are not allowed without balls at a minimum of 10-15 GB), share Program Files, Windows, and others like them. </li><li>  <abbr title="Straight arms">/ dev / hands</abbr> .  Well, without this in any way. </li></ol><br><a name="habracut"></a>  What was the idea: to write a bot sitting on hubs and regularly searching <b>and swinging</b> wand.dat.  I wrote a program on your favorite Delphi. <br>  Actually, the algorithm of the bot: <ol><li>  The bot scans the folder for the saved files, enumerates the files by the specified name pattern, saves the TTH files (the TTH removal module for Delphi is written by MetalFan and taken <a href="http://forum.vingrad.ru/topic-139574/kw-tth.html">from here</a> ) in memory.  At the same time, a batch script is created to process all existing wands in one double click.  For example, <a href="http://www.virustotal.com/ru/analisis/cfe79acf9235a8621e6aeec62a7f261dfe7f79654e4dfd22b0a172ff4ca04374-1272301955">this is</a> used as a parser. </li><li>  A pre-prepared list of hubs in the format "one line - one hub."  For each hub, a separate thread is created. </li><li>  Where to get a list of hubs?  The <a href="">bz2-file with hubs is downloaded</a> , unpacked, parsed with anything you like (below is an example of a parser in php). </li><li>  Go to the hub.  We are looking for wand.dat size of at least kilobyte.  Repeat the search every 20 minutes. </li><li>  We download every wand.dat found if there is no such TTH in the internal database of the program.  We save in the folder to the rest.  Add a TTH of the new file to your list, update the batch script to handle the inflated. </li><li>  When you get tired of downloading, turn off the bot, run the script, we get one final file with all the passwords </li></ol> The only knowledge that was required when programming: WinSock, multithreaded applications, <a href="http://www.teamfair.info/DC-Protocol.htm">Direct Connect</a> protocol (and even that is not all).  From the new for me was only the protocol itself.  It took 8 hours to write.  380 lines of code without modules.  The compiled program takes 149 kilobytes.  <b><font color="red">I will not post the bot, it is fraught.</font></b> <br><br>  Well, the parser list of hubs in php here: <br> <code><font color="green">&lt;?</font> <font color="#0000FF">php</font> <font color="green"><br> header(</font> <font color="#FF0000">'Content-type: text/plain'</font> <font color="green">); <br></font> <font color="#0000FF">$f_name</font> <font color="green">=</font> <font color="#FF0000">'./hublist.xml'</font> <font color="green">; <br></font> <font color="#0000FF">$f</font> <font color="green">=fopen(</font> <font color="#0000FF">$f_name</font> <font color="green">,</font> <font color="#FF0000">'r'</font> <font color="green">); <br></font> <font color="#0000FF">$buf</font> <font color="green">=fread(</font> <font color="#0000FF">$f</font> <font color="green">,filesize(</font> <font color="#0000FF">$f_name</font> <font color="green">)); <br> fclose(</font> <font color="#0000FF">$f</font> <font color="green">); <br> preg_match_all(</font> <font color="#FF0000">'|address="dchub://([a-z0-9:.-]+?)"|i'</font> <font color="green">,</font> <font color="#0000FF">$buf</font> <font color="green">,</font> <font color="#0000FF">$a</font> <font color="green">);</font> <font color="#FF9900">#-, ,     <br></font> <font color="#0000FF">$f</font> <font color="green">=fopen(</font> <font color="#FF0000">'./hublist.txt'</font> <font color="green">,</font> <font color="#FF0000">'w</font> <font color="green"><font color="#FF0000">'</font> ); <br> for (</font> <font color="#0000FF">$i</font> <font color="green">=0;</font> <font color="#0000FF">$i</font> <font color="green">&lt;count(</font> <font color="#0000FF">$a</font> <font color="green">[</font> <font color="#0000FF">1</font> <font color="green">]);</font> <font color="#0000FF">$i</font> <font color="green">++){fwrite(</font> <font color="#0000FF">$f</font> <font color="green">,</font> <font color="#0000FF">$a</font> <font color="green">[</font> <font color="#0000FF">1</font> <font color="green">][</font> <font color="#0000FF">$i</font> <font color="green">].</font> <font color="#FF0000">"\r\n"</font> <font color="green">);} <br> fclose(</font> <font color="#0000FF">$f</font> <font color="green">); <br> echo</font> <font color="#FF0000">'done '</font> <font color="green">.count(</font> <font color="#0000FF">$a</font> <font color="green">[</font> <font color="#0000FF">1</font> <font color="green">]); <br> ?&gt;</font></code> <br>  If necessary, the pattern can be corrected, for example, on exclusively .ru-hubs. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Test </h5>  I tested the program from April 25 to April 28, 2010. During this time, <b>232</b> wand.dat has been pumped.  The fattest was 129 kilobytes.  What found in these vandah?  <b>I did not even open them</b> , because it is already not good.  Yes, and no passwords from contact were the goal.  The purpose of writing a bot was to check for the difficulty of automating the stealing of passwords lying in a prominent place unattended. <br><br><h5>  What to do with inflated wealth </h5>  And what <i>could be</i> in these vands? <ol><li>  First, a list of valid email addresses.  Can be used for spam.  (In fact, the cost of extracting them in this way does not pay off at all; it‚Äôs easier to use MailAgent‚Äôs built-in search). </li><li>  Passwords from all contacts / classmates / Facebook - values ‚Äã‚Äãfor hackers no. </li><li>  Access to ftp sites is more dangerous - from the inscription "Haxored by xakep Vasya666" to an exploit on the main hacker, only a fiction separates. </li><li>  List of mail accounts with passwords.  In my opinion, this is the most dangerous.  Mail, as we all know, no one deletes from the servers. </li><li>  Passwords from the accounts of your provider.  The truth for such a provider will definitely punish you.  A cruel oh-oko will punish. </li></ol>  In fact, in vandahs, everyone else can lie, but I will not describe anything, so as not to wave a red rag in front of hackers who have returned from school. <br><br><h5>  Result </h5>  Passwords  A lot of passwords for a fairly small period of time with minimal one-time effort. <br><br><h5>  Conclusion </h5>  Conclusion?  What else could be the <b>new</b> conclusion?  Again, remind you that you need to put master passwords on browsers, if you save passwords in a browser?  To remind you to keep track of what you share?  <b>BUT WHY?!</b>  <b>Nobody will listen to this anyway.</b>  Just do not cry when the roasted rooster pecks in one place. </div><p>Source: <a href="https://habr.com/ru/post/92343/">https://habr.com/ru/post/92343/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../92330/index.html">Seminar on transhumanism in Moscow and its 50th meeting</a></li>
<li><a href="../92332/index.html">Youtube design updates: the further, the more wonderful</a></li>
<li><a href="../92335/index.html">Ubuntu "Lucid Lynx" 10.04 LTS</a></li>
<li><a href="../92336/index.html">Icons materialize through polymer clay</a></li>
<li><a href="../92341/index.html">The transition to paid education in Russia will not take place?</a></li>
<li><a href="../92345/index.html">Suggestion for adding data binding</a></li>
<li><a href="../92346/index.html">Network infrastructure and network control center in the data center</a></li>
<li><a href="../92347/index.html">What salary would you choose yourself?</a></li>
<li><a href="../92348/index.html">Why CSS3 is worse than messing with IE6 bugs</a></li>
<li><a href="../92349/index.html">IT management system. SharePoint</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>