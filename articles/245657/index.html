<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>IPv6: How many addresses do you need for happiness?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The picture, which some networkers accustomed to IPv4 can enter into a stupor: 



R6#sh ipv6 interface brief FastEthernet0/0 [up/up] FE80::218:18FF:F...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>IPv6: How many addresses do you need for happiness?</h1><div class="post__text post__text-html js-mediator-article">  The picture, which some networkers accustomed to IPv4 can enter into a stupor: <br><br><pre><code class="bash hljs">R6<span class="hljs-comment"><span class="hljs-comment">#sh ipv6 interface brief FastEthernet0/0 [up/up] FE80::218:18FF:FE45:F0E2 1::1 1::2 1::3 1::10 1::100:500 2::1 2::2</span></span></code> </pre> <br>  Moreover, each of these addresses can be used along with the others.  How so? <br><a name="habracut"></a><br><h4>  Important IPv6 Changes </h4><br><ol><li>  There can be a lot of addresses on the interface. </li><li>  Addresses have scope - scope or scope. </li><li>  Actively used addresses with a scope within the segment - the so-called link-local. </li><li>  Addresses can be generated independently. </li></ol><br><br>  Now more. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  1. Many addresses on the interface </h4><br>  Of course, one could argue that IPv4 also had various methods, how to assign several addresses to the interface (secondary, alias, and so on).  But in IPv6, the addresses were made equal, and this opens up broad possibilities. <br><br>  For example, a node can use one address for communication in its local network, another address for communication within the organization, and a third one for access to the Internet.  Or 10 for Internet access at once - send requests from a new address to each site. <br><br>  Introduced mechanism of preference and aging of addresses, with which you can make a smooth change of addresses in the network.  At the first stage, all requests begin to be sent from the new addresses, but the nodes continue to respond to the old ones too.  Then, after some time, the old addresses are completely written off as scrap. <br><br>  At first glance, it may seem like "Well, okay," but such small details will lead to a completely different logic of address assignment. <br><br><h4>  2. Scope </h4><br>  Again, formally, IPv4 addresses also had scope. <br><br>  There are <b>link-local</b> addresses.  They are usually known under the code name "$ @ # * !!! Again, DHCP does not work!"  and are selected from the range of <b>169.254.0.0/16</b> .  But in general, they have functions besides "To let the admin understand that his DHCP server does not give out addresses". <br><br>  First, such an address can be automatically generated by the device itself.  Secondly, it is quite suitable for communication within the network.  Restriction: it generally should not be routed, for link-local. <br><br>  Besides them, <b>RFC 1918</b> defines three ranges of private addresses: everyone's favorite <b>192.168.0.0/16</b> , large <b>10.0.0.0/8,</b> and undeservedly forgotten <b>172.16.0.0/12</b> (that is, from <b>172.16.0.0</b> to <b>172.31.255.255</b> ).  They are routed, but only within your internal network.  For communication on the Internet can not use them. <br><br>  Finally, there are (not enough) many unique (‚Äúpublic‚Äù, ‚Äúwhite‚Äù) addresses that are issued for use by organizations and providers and are suitable for communication on a global scale. <br><br>  Significant IPv4 Restriction: You cannot use these addresses at the same time.  Either link-local, and sit without communication with other networks, or private, but without NAT you can‚Äôt get to the Internet, or public ones that are suitable for everything, but now in terrible shortage. <br><br>  In IPv6, you can use addresses with different scope at the same time.  We need to knock on a neighbor on the network - use link-local.  We went to the Internet - we take a globally unique one. <br><br>  For nodes, there are three options for addresses: <br><br><ul><li>  <b>Link-local.</b>  Range <b>FE80 :: / 10</b> .  Must be on all nodes with IPv6.  It is created by the node itself (for example, according to EUI-64), or we can set it with pens.  As the name implies, operates within a segment, therefore uniqueness is required only within this segment (as with MAC addresses, for example).  From here on different interfaces can be the same. </li><li>  <b>Unique-local address (ULA)</b> .  This is an analogue of "private" addresses.  Scope is generally global ( <b><a href="https://tools.ietf.org/html/rfc4193">RFC 4193</a></b> ), but no one is obliged to route them on the Internet, so in most cases they will be cut off by the provider, for example.  You can assign by analogy with the addresses 192.168 ..., but now there are many more, so the probability of choosing the same is much lower. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Note</b> <div class="spoiler_text">  In IPv4 there is one unpleasant situation with private addresses when firm A buys firm B, and in these firms the same network is used (in the worst case, 10.0.0.0/8).  Splicing them is a headache.  Although it is possible to take any ULA addresses, it is recommended to generate them randomly and enter them into one of the public directories (for example, <a href="https://www.sixxs.net/tools/grh/ula/">here</a> ).  This guarantees a very small chance of crossing.  If you take the ‚Äúbeautiful‚Äù ULA addresses, and then you have to merge the same networks together with another similar <s>loser, the</s> admin - you are to blame. </div></div><br><ul><li>  <b>Globally unique addresses</b> .  Those most.  Routed, unique throughout the world, a direct analogue of public IPv4 addresses. </li></ul><br><br><div class="spoiler">  <b class="spoiler_title">Note</b> <div class="spoiler_text">  Previously there were so-called.  <b>site-local</b> address with its scope - one site (site).  But the developers of IPv6 came to the conclusion that the concept of the site is too muddy, and was refused from site-local in favor of ULA. </div></div><br><br>  In addition to the general concept of "scope", each specific address <u>on a specific interface</u> has <b>a coverage zone</b> .  This is part of the topology to which the scope of a given address extends from this interface.  For programmers, the following explanation is usually offered: the scope is an abstract class, and the scope is an instance of a class.  For example, a link-local address on the Fa0 / 0 interface will have a network segment connected to the Fa0 / 0 interface. <br><br>  The boundaries of the zones pass through the nodes.  From here, the link-local addresses on different interfaces of the router will lie in different zones. <br><br>  The image will help to visualize the scope and area of ‚Äã‚Äãaction: <br><img src="https://habrastorage.org/getpro/habr/post_images/654/a61/1a9/654a611a924c0d1deabd8e9df6b97c91.png" alt="image"><br><br>  <b>Side effect</b> : ambiguity.  If we say ‚ÄúSend a packet to FE80 :: 101‚Äù, then the counter question will be ‚ÄúTo which of the interfaces?‚Äù, Because this address can be on any of the interfaces.  Therefore, for the link-local addresses, the interface to be used is necessarily specified.  In Windows, entries like FE80 :: 1% 5 are used, where after the character "%" there is an interface ID.  In Linux, the name applies (FE80 :: 1% eth0). <br><br><h4>  3. Benefits of link-local addresses </h4><br>  The ability to simultaneously use addresses of different types opens up very interesting possibilities. <br><br>  Let's take this topology: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d95/76c/8a0/d9576c8a07e7d50d1e697418e42c733d.png" alt="image"><br><br>  How many subnets do we need to have an IP connection between the computer and the server? <br><br>  In IPv4, we need 4 subnets, and even if we take networks / 31, these are 8 addresses. <br><br>  How many subnets will be enough to configure in IPv6? <br><br><div class="spoiler">  <b class="spoiler_title">Correct answer</b> <div class="spoiler_text">  Two, one between the computer and Router0, and the other between the server and Router2.  Other addresses can be link-local, they can be generated automatically. </div></div><br><br>  How is this possible? <br><br>  A very simple.  Routing works hop by hop.  At each stage, we need to know only the outgoing interface and the address of the next transition, and the physical one, and we need IP, insofar as. <br><br>  The computer knows the link-local address of the nearest router (Router0).  Router0 knows the link-local of the next one in the chain (Router1).  Router1 knows the address of Router2.  Router2 can deliver a message to the server.  The back is the same. <br><br>  <b>Clarification</b> : As rightly noted in the comments of <a href="http://habrahabr.ru/users/alukardd/" class="user_link">Alukardd</a> , there is such a possibility in IPv4.  Therefore, on the Internet, you can easily see private addresses in the trace results. <br><br>  Check it out. <br><br>  Enable IPv6 routing: <br><br><pre> <code class="bash hljs">Router<span class="hljs-comment"><span class="hljs-comment">#conf t Router(config)#ipv6 unicast-routing</span></span></code> </pre><br>  Enable IPv6 on interfaces; link-local addresses will be created automatically: <br><br><pre> <code class="bash hljs">Router(config)<span class="hljs-comment"><span class="hljs-comment">#interface fa0/0 Router(config-if)#ipv6 enable Router(config-if)#interface fa0/1 Router(config-if)#ipv6 enable Router(config-if)#end Router#</span></span></code> </pre><br>  Checking: <br><br><pre> <code class="bash hljs">Router<span class="hljs-comment"><span class="hljs-comment">#show ipv6 interface brief FastEthernet0/0 [up/up] FE80::201:C7FF:FE8D:B001 FastEthernet0/1 [up/up] FE80::201:C7FF:FE8D:B002</span></span></code> </pre><br>  Configure global addresses: <br><br><pre> <code class="bash hljs">Router0<span class="hljs-comment"><span class="hljs-comment">#conf t Router0(config)#interface fa0/0 Router0(config-if)#ipv6 address 1::1/64</span></span></code> </pre><br><pre> <code class="bash hljs">Router2<span class="hljs-comment"><span class="hljs-comment">#conf t Router2(config)#interface fa0/1 Router2(config-if)#ipv6 address 2::1/64</span></span></code> </pre><br>  Please note that on computers in general, you do not need to configure anything, addresses will be automatically obtained.  How - the topic of a separate article. <br><br>  Finally, you need routing.  Configure OSPFv3. <br><br><pre> <code class="bash hljs">Router0<span class="hljs-comment"><span class="hljs-comment">#conf t Router0(config)#ipv6 router ospf 1 %OSPFv3-4-NORTRID: OSPFv3 process 1 could not pick a router-id,please configure manually ! ,   router-id,       Router0(config-rtr)#router-id 1.0.0.0 Router0(config-rtr)#exit Router0(config)#interface fa0/0 Router0(config-if)#ipv6 ospf 1 area 0 Router0(config-if)#interface fa0/1 Router0(config-if)#ipv6 ospf 1 area 0</span></span></code> </pre><br>  Repeat the procedure on the remaining routers (changing the router-id, of course).  After that, we will establish a neighborhood (via link-local addresses!), And the necessary routes will get into the routing table. <br><br><pre> <code class="bash hljs">Router0<span class="hljs-comment"><span class="hljs-comment">#sh ipv6 route IPv6 Routing Table - 4 entries Codes: C - Connected, L - Local, S - Static, R - RIP, B - BGP U - Per-user Static route, M - MIPv6 I1 - ISIS L1, I2 - ISIS L2, IA - ISIS interarea, IS - ISIS summary O - OSPF intra, OI - OSPF inter, OE1 - OSPF ext 1, OE2 - OSPF ext 2 ON1 - OSPF NSSA ext 1, ON2 - OSPF NSSA ext 2 D - EIGRP, EX - EIGRP external C 1::/64 [0/0] via ::, FastEthernet0/0 L 1::1/128 [0/0] via ::, FastEthernet0/0 O 2::/64 [110/3] via FE80::201:63FF:FE59:4501, FastEthernet0/1</span></span></code> </pre><br>  Then you can make sure that everything works. <br><br><div class="spoiler">  <b class="spoiler_title">On the verge of extreme</b> <div class="spoiler_text">  You can get by with just two global addresses (per computer and per server).  However, in this case, Router0 and Router2 will have to create static routes to the computer and server, respectively, since routers will not find out about these addresses themselves.  Then you can redistribute into OSPF and verify that there will be a connection even in such a strange case. </div></div><br><br>  <b>Conclusion</b> : for traffic transit it is enough to use link-local addresses.  Globally-unique addresses and ULA will be needed only if you want to access the device itself (for example, log into the router via SSH). <br><br>  The undoubted advantage of routing to link-local addresses is that the binding to a specific address is removed.  It is possible to make the following analogy: in IPv4, the route was recorded through the names of streets and houses - ‚ÄúOn Lenin Street to 51 and right‚Äù.  In IPv6, the route can be written as ‚Äútwo traffic lights straight on the third to the right‚Äù.  In the case of a change of addressing (‚Äúrenaming streets‚Äù), IPv4 routes need to be rebuilt, and everything will continue to work as usual in IPv6. <br><br><h4>  4. Automatic address assignment </h4><br>  There was a clarification about the EUI-64 earlier, but the topic as a whole is worthy of a separate article. <br><br>  <a href="http://habrahabr.ru/post/245323/">IPv6 addresses via EUI-64: Points above i</a> <br><br>  Hope the article was helpful.  Next in line is the distribution of address <s>elephants</s> . </div><p>Source: <a href="https://habr.com/ru/post/245657/">https://habr.com/ru/post/245657/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../245643/index.html">SPA architecture for CRM systems: part 2</a></li>
<li><a href="../245645/index.html">ActivityManager report generator. Another bike, but in profile</a></li>
<li><a href="../245647/index.html">How was the Dell Solution Forum 2014 in Moscow</a></li>
<li><a href="../245651/index.html">Installation, configuration and testing of Fedora 21 Workstation on a personal or gaming computer</a></li>
<li><a href="../245653/index.html">Electrofocus on the base of the Arduino Uno debug board, part 3</a></li>
<li><a href="../245659/index.html">Perl. 27 years later</a></li>
<li><a href="../245661/index.html">Transparent authentication in Redmine</a></li>
<li><a href="../245663/index.html">Transfer Windows to another computer using Linux</a></li>
<li><a href="../245665/index.html">One-page store with shopping cart at Phalcon + AngularJS + Zurb Foundation</a></li>
<li><a href="../245667/index.html">Migrating Windows Server 2003 to Windows Server 2012 R2: Active Directory</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>