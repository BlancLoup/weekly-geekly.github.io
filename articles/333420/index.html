<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Comodo Internet Security Local Update Server</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This manual will detail the process of raising your local Comodo update server on Windows without using any paid components. Unlike Comodo Offline Upd...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Comodo Internet Security Local Update Server</h1><div class="post__text post__text-html js-mediator-article">  This manual will detail the process of raising your local Comodo update server on Windows without using any paid components.  Unlike <a href="https://forums.comodo.com/empty-t54363.0.html">Comodo Offline Updater</a> and analogs, there is no need to configure a proxy on the client side. <br><br>  Requirements: <br><br><ul><li>  OS: Windows 7 SP1 and above or Windows Server 2008 and above (for 7 and 2008 you need <a href="https://www.microsoft.com/en-us/download/details.aspx%253Fid%253D34595">WMF 3.0</a> or <a href="https://www.microsoft.com/ru-ru/download/details.aspx%253Fid%253D40855">WMF 4.0</a> ) </li><li>  <a href="https://www.iis.net/downloads/microsoft/url-rewrite">URL Rewrite 2.1</a> module </li><li>  Script download updates on PowerShell </li><li>  <a href="http://www.7-zip.org/">7-zip</a> </li></ul><a name="habracut"></a><br>  Windows 7 SP1 Pro x64 (IIS 6.7) will be used as a server.  For newer OS installation and configuration is similar. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  1) Installing IIS </h3><br>  "Enable or disable Windows components" in the "Add or Remove Programs" section, check "IIS" for installation.  Automatically marked components are enough. <br><br><img src="https://habrastorage.org/web/293/11c/511/29311c51176b4883b35b6cd5c7126a29.png"><br><br><h3>  2) Script and logic for downloading updates </h3><br>  The script is written in PowerShell v4, so to work correctly on Windows 7 you need to update WMF4.0.  Reboot after installation is required.  7-Zip is also required for unpacking.  By itself, to run a script, you need to translate the PS Execution Policy to Unrestricted.  This is done with the <i>Set-ExecutionPolicy Unrestricted</i> command. <br><br>  Comodo updates are divided into 2 parts: the base and the update of the program itself.  Files of both parts can be packaged or not.  I recommend using packaged ones, since they occupy much less disk space - 290MB versus 635MB only in databases. <br><div class="spoiler">  <b class="spoiler_title">COU.ps1</b> <div class="spoiler_text"><div class="oembed"><script type="text/javascript" src="https://gist.github.com/999ddcd1b7f9546f8223bc1ff5d77625.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-6a0c0e7fc2e433191d469ef5051df9f8.css"><div id="gist73480246" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-cou-ps1" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-powershell ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-cou-ps1-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-cou-ps1-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span> 2017/10/06 AcidVenom v6.1<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-cou-ps1-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>     COU<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-cou-ps1-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>   : cis, av, av-clean<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-cou-ps1-LC4" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-cou-ps1-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-k">param</span>(<span class="pl-smi">$1</span>)</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-cou-ps1-LC6" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-cou-ps1-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>######################################################################<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-cou-ps1-LC8" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>###################   ######################<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-cou-ps1-LC9" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-cou-ps1-LC10" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$7z</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>C:\Program Files\7-Zip\7z.exe<span class="pl-pds">"</span></span>            <span class="pl-c"><span class="pl-c">#</span>   7z.exe<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-cou-ps1-LC11" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$downloadpath</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>C:\inetpub\wwwroot<span class="pl-pds">"</span></span>             <span class="pl-c"><span class="pl-c">#</span>  <span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-cou-ps1-LC12" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$serverurl</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>https://cdn.download.comodo.com<span class="pl-pds">"</span></span>   <span class="pl-c"><span class="pl-c">#</span>  Comodo<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-cou-ps1-LC13" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$inis</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>5070<span class="pl-pds">"</span></span>                                   <span class="pl-c"><span class="pl-c">#</span>  <span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-cou-ps1-LC14" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$proto</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>10<span class="pl-pds">"</span></span>                                    <span class="pl-c"><span class="pl-c">#</span>  <span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-cou-ps1-LC15" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$xx</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>x32<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>x64<span class="pl-pds">"</span></span>                                <span class="pl-c"><span class="pl-c">#</span>    ("x32","x64")<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-cou-ps1-LC16" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$cispacked</span> <span class="pl-k">=</span> <span class="pl-c1">$True</span>                               <span class="pl-c"><span class="pl-c">#</span>   (*.7z)  ($True/$False)<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-cou-ps1-LC17" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$avpacked</span> <span class="pl-k">=</span> <span class="pl-c1">$True</span>                                <span class="pl-c"><span class="pl-c">#</span>   (*.cav.z)  ($True/$False)<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-cou-ps1-LC18" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$release_notes</span> <span class="pl-k">=</span> <span class="pl-c1">$True</span>                           <span class="pl-c"><span class="pl-c">#</span>  Release Notes? ($True/$False)<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-cou-ps1-LC19" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-cou-ps1-LC20" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>######################################################################<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-cou-ps1-LC21" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>##################       ##########################<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-cou-ps1-LC22" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L23" class="blob-num js-line-number" data-line-number="23"></td>
        <td id="file-cou-ps1-LC23" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$inispath</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$downloadpath</span>\cis\download\updates\release\inis_<span class="pl-smi">$inis</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L24" class="blob-num js-line-number" data-line-number="24"></td>
        <td id="file-cou-ps1-LC24" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$recognizerspath</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span>\recognizers\proto_v<span class="pl-smi">$proto</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L25" class="blob-num js-line-number" data-line-number="25"></td>
        <td id="file-cou-ps1-LC25" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$updates58path</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$downloadpath</span>\av\updates58<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L26" class="blob-num js-line-number" data-line-number="26"></td>
        <td id="file-cou-ps1-LC26" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$updatesurlpath</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$downloadpath</span>\av\updatesurl<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L27" class="blob-num js-line-number" data-line-number="27"></td>
        <td id="file-cou-ps1-LC27" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$basespath</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updates58path</span>\sigs\bases<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L28" class="blob-num js-line-number" data-line-number="28"></td>
        <td id="file-cou-ps1-LC28" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$updatespath</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updates58path</span>\sigs\updates<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L29" class="blob-num js-line-number" data-line-number="29"></td>
        <td id="file-cou-ps1-LC29" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$urlpath</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updatesurlpath</span>\sigs\updates<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L30" class="blob-num js-line-number" data-line-number="30"></td>
        <td id="file-cou-ps1-LC30" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$tvlpath</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$downloadpath</span>\av\tvl<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L31" class="blob-num js-line-number" data-line-number="31"></td>
        <td id="file-cou-ps1-LC31" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L32" class="blob-num js-line-number" data-line-number="32"></td>
        <td id="file-cou-ps1-LC32" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$inisurl</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$serverurl</span>/cis/download/updates/release/inis_<span class="pl-smi">$inis</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L33" class="blob-num js-line-number" data-line-number="33"></td>
        <td id="file-cou-ps1-LC33" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$recognizersurl</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inisurl</span>/recognizers/proto_v<span class="pl-smi">$proto</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L34" class="blob-num js-line-number" data-line-number="34"></td>
        <td id="file-cou-ps1-LC34" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$updates58url</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$serverurl</span>/av/updates58<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L35" class="blob-num js-line-number" data-line-number="35"></td>
        <td id="file-cou-ps1-LC35" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$updatesurlurl</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$serverurl</span>/av/updatesurl<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L36" class="blob-num js-line-number" data-line-number="36"></td>
        <td id="file-cou-ps1-LC36" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$basesurl</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updates58url</span>/sigs/bases<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L37" class="blob-num js-line-number" data-line-number="37"></td>
        <td id="file-cou-ps1-LC37" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$updatesurl</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updates58url</span>/sigs/updates<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L38" class="blob-num js-line-number" data-line-number="38"></td>
        <td id="file-cou-ps1-LC38" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$urlurl</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updatesurlurl</span>/sigs/updates<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L39" class="blob-num js-line-number" data-line-number="39"></td>
        <td id="file-cou-ps1-LC39" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$tvlurl</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$serverurl</span>/av/tvl<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L40" class="blob-num js-line-number" data-line-number="40"></td>
        <td id="file-cou-ps1-LC40" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L41" class="blob-num js-line-number" data-line-number="41"></td>
        <td id="file-cou-ps1-LC41" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>######################################################################<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L42" class="blob-num js-line-number" data-line-number="42"></td>
        <td id="file-cou-ps1-LC42" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>##############        ###################<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L43" class="blob-num js-line-number" data-line-number="43"></td>
        <td id="file-cou-ps1-LC43" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L44" class="blob-num js-line-number" data-line-number="44"></td>
        <td id="file-cou-ps1-LC44" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$1</span> <span class="pl-k">-eq</span> <span class="pl-s"><span class="pl-pds">"</span>cis<span class="pl-pds">"</span></span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L45" class="blob-num js-line-number" data-line-number="45"></td>
        <td id="file-cou-ps1-LC45" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L46" class="blob-num js-line-number" data-line-number="46"></td>
        <td id="file-cou-ps1-LC46" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$cispacked</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>) {<span class="pl-smi">$packed</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>.7z<span class="pl-pds">"</span></span>} <span class="pl-k">else</span> {<span class="pl-smi">$packed</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L47" class="blob-num js-line-number" data-line-number="47"></td>
        <td id="file-cou-ps1-LC47" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L48" class="blob-num js-line-number" data-line-number="48"></td>
        <td id="file-cou-ps1-LC48" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span> Updates<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L49" class="blob-num js-line-number" data-line-number="49"></td>
        <td id="file-cou-ps1-LC49" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L50" class="blob-num js-line-number" data-line-number="50"></td>
        <td id="file-cou-ps1-LC50" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$testinis</span> <span class="pl-k">=</span> <span class="pl-c1">Test-Path</span> <span class="pl-smi">$inispath</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L51" class="blob-num js-line-number" data-line-number="51"></td>
        <td id="file-cou-ps1-LC51" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$testrecognizers</span> <span class="pl-k">=</span> <span class="pl-c1">Test-Path</span> <span class="pl-smi">$recognizerspath</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L52" class="blob-num js-line-number" data-line-number="52"></td>
        <td id="file-cou-ps1-LC52" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$testinis</span> <span class="pl-k">-eq</span> <span class="pl-c1">$False</span>) {<span class="pl-c1">New-Item</span> <span class="pl-k">-</span>ItemType Directory <span class="pl-k">-</span>path <span class="pl-smi">$inispath</span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L53" class="blob-num js-line-number" data-line-number="53"></td>
        <td id="file-cou-ps1-LC53" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$testrecognizers</span> <span class="pl-k">-eq</span> <span class="pl-c1">$False</span>) {<span class="pl-c1">New-Item</span> <span class="pl-k">-</span>ItemType Directory <span class="pl-k">-</span>path <span class="pl-smi">$recognizerspath</span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L54" class="blob-num js-line-number" data-line-number="54"></td>
        <td id="file-cou-ps1-LC54" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L55" class="blob-num js-line-number" data-line-number="55"></td>
        <td id="file-cou-ps1-LC55" class="blob-code blob-code-inner js-file-line"><span class="pl-k">foreach</span> (<span class="pl-smi">$x</span> <span class="pl-k">in</span> <span class="pl-smi">$xx</span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L56" class="blob-num js-line-number" data-line-number="56"></td>
        <td id="file-cou-ps1-LC56" class="blob-code blob-code-inner js-file-line"><span class="pl-c1">Invoke-WebRequest</span> <span class="pl-k">-</span>Uri <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inisurl</span>/cis_update_<span class="pl-smi">$x</span>.xml<span class="pl-smi">$packed</span><span class="pl-pds">"</span></span> <span class="pl-k">-</span>OutFile <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span>/cis_update_<span class="pl-smi">$x</span>.xml<span class="pl-smi">$packed</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L57" class="blob-num js-line-number" data-line-number="57"></td>
        <td id="file-cou-ps1-LC57" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$cispacked</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>) {<span class="pl-k">&amp;</span> <span class="pl-smi">$7z</span> x <span class="pl-k">-</span>o<span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span><span class="pl-pds">"</span></span> <span class="pl-smi">$inispath</span>\cis_update_<span class="pl-smi">$x<span class="pl-smi">.xml.7z</span></span> <span class="pl-k">-</span>y}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L58" class="blob-num js-line-number" data-line-number="58"></td>
        <td id="file-cou-ps1-LC58" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$lines</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Content</span> <span class="pl-smi">$inispath</span>\cis_update_<span class="pl-smi">$x<span class="pl-smi">.xml</span></span> <span class="pl-k">|</span> <span class="pl-k">?</span> {<span class="pl-c1">$_</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;file name=<span class="pl-pds">"</span></span> <span class="pl-k">-and</span> <span class="pl-c1">$_</span> <span class="pl-k">-notmatch</span> <span class="pl-s"><span class="pl-pds">"</span>\\<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L59" class="blob-num js-line-number" data-line-number="59"></td>
        <td id="file-cou-ps1-LC59" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L60" class="blob-num js-line-number" data-line-number="60"></td>
        <td id="file-cou-ps1-LC60" class="blob-code blob-code-inner js-file-line"><span class="pl-k">foreach</span> (<span class="pl-smi">$line</span> <span class="pl-k">in</span> <span class="pl-smi">$lines</span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L61" class="blob-num js-line-number" data-line-number="61"></td>
        <td id="file-cou-ps1-LC61" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$line</span> <span class="pl-k">=</span> <span class="pl-smi">$line</span> <span class="pl-k">-split</span> <span class="pl-s"><span class="pl-pds">"</span> <span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L62" class="blob-num js-line-number" data-line-number="62"></td>
        <td id="file-cou-ps1-LC62" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$name</span> <span class="pl-k">=</span> <span class="pl-smi">$line</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>name=<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L63" class="blob-num js-line-number" data-line-number="63"></td>
        <td id="file-cou-ps1-LC63" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$name</span> <span class="pl-k">=</span> <span class="pl-smi">$name</span> <span class="pl-k">-replace</span> <span class="pl-s"><span class="pl-pds">"</span>name=|<span class="pl-cce">`"</span><span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L64" class="blob-num js-line-number" data-line-number="64"></td>
        <td id="file-cou-ps1-LC64" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$sha</span> <span class="pl-k">=</span> <span class="pl-smi">$line</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>sha=<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L65" class="blob-num js-line-number" data-line-number="65"></td>
        <td id="file-cou-ps1-LC65" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$sha</span> <span class="pl-k">=</span> <span class="pl-smi">$sha</span> <span class="pl-k">-replace</span> <span class="pl-s"><span class="pl-pds">"</span>sha=|<span class="pl-cce">`"</span><span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L66" class="blob-num js-line-number" data-line-number="66"></td>
        <td id="file-cou-ps1-LC66" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$sha</span> <span class="pl-k">=</span> <span class="pl-smi">$sha<span class="pl-smi">.toupper</span></span>()</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L67" class="blob-num js-line-number" data-line-number="67"></td>
        <td id="file-cou-ps1-LC67" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$src</span> <span class="pl-k">=</span> <span class="pl-smi">$line</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>src=<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L68" class="blob-num js-line-number" data-line-number="68"></td>
        <td id="file-cou-ps1-LC68" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$src</span> <span class="pl-k">=</span> <span class="pl-smi">$src</span> <span class="pl-k">-replace</span> <span class="pl-s"><span class="pl-pds">"</span>src=|<span class="pl-cce">`"</span>|&gt;<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L69" class="blob-num js-line-number" data-line-number="69"></td>
        <td id="file-cou-ps1-LC69" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$srcf</span> <span class="pl-k">=</span> <span class="pl-smi">$src<span class="pl-smi">.substring</span></span>(<span class="pl-c1">0</span><span class="pl-k">,</span><span class="pl-smi">$src<span class="pl-smi">.lastindexof</span></span>(<span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>))</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L70" class="blob-num js-line-number" data-line-number="70"></td>
        <td id="file-cou-ps1-LC70" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$srcp</span> <span class="pl-k">=</span> <span class="pl-smi">$src</span> <span class="pl-k">-replace</span> <span class="pl-s"><span class="pl-pds">"</span>\/<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>\<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L71" class="blob-num js-line-number" data-line-number="71"></td>
        <td id="file-cou-ps1-LC71" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L72" class="blob-num js-line-number" data-line-number="72"></td>
        <td id="file-cou-ps1-LC72" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$fileexist</span> <span class="pl-k">=</span> <span class="pl-c1">Test-Path</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span>\<span class="pl-smi">$srcp$packed</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L73" class="blob-num js-line-number" data-line-number="73"></td>
        <td id="file-cou-ps1-LC73" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$folderexist</span> <span class="pl-k">=</span> <span class="pl-c1">Test-Path</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span>\<span class="pl-smi">$srcf</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L74" class="blob-num js-line-number" data-line-number="74"></td>
        <td id="file-cou-ps1-LC74" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L75" class="blob-num js-line-number" data-line-number="75"></td>
        <td id="file-cou-ps1-LC75" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$fileexist</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L76" class="blob-num js-line-number" data-line-number="76"></td>
        <td id="file-cou-ps1-LC76" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$remove</span> <span class="pl-k">=</span> <span class="pl-c1">$False</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L77" class="blob-num js-line-number" data-line-number="77"></td>
        <td id="file-cou-ps1-LC77" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$cispacked</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L78" class="blob-num js-line-number" data-line-number="78"></td>
        <td id="file-cou-ps1-LC78" class="blob-code blob-code-inner js-file-line"><span class="pl-k">try</span> {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L79" class="blob-num js-line-number" data-line-number="79"></td>
        <td id="file-cou-ps1-LC79" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$remove</span> <span class="pl-k">=</span> <span class="pl-c1">$True</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L80" class="blob-num js-line-number" data-line-number="80"></td>
        <td id="file-cou-ps1-LC80" class="blob-code blob-code-inner js-file-line"><span class="pl-k">&amp;</span> <span class="pl-smi">$7z</span> x <span class="pl-k">-</span>o<span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span>/<span class="pl-smi">$srcf</span><span class="pl-pds">"</span></span> <span class="pl-smi">$inispath</span><span class="pl-k">/</span><span class="pl-smi">$srcp<span class="pl-smi">.7z</span></span> <span class="pl-k">-</span>y</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L81" class="blob-num js-line-number" data-line-number="81"></td>
        <td id="file-cou-ps1-LC81" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L82" class="blob-num js-line-number" data-line-number="82"></td>
        <td id="file-cou-ps1-LC82" class="blob-code blob-code-inner js-file-line"><span class="pl-k">catch</span> {}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L83" class="blob-num js-line-number" data-line-number="83"></td>
        <td id="file-cou-ps1-LC83" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L84" class="blob-num js-line-number" data-line-number="84"></td>
        <td id="file-cou-ps1-LC84" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$hash</span> <span class="pl-k">=</span> <span class="pl-c1">Get-FileHash</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span>/<span class="pl-smi">$srcp</span><span class="pl-pds">"</span></span> <span class="pl-k">-</span>Algorithm SHA1</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L85" class="blob-num js-line-number" data-line-number="85"></td>
        <td id="file-cou-ps1-LC85" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$remove</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>) {<span class="pl-c1">Remove-Item</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span>\<span class="pl-smi">$srcp</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L86" class="blob-num js-line-number" data-line-number="86"></td>
        <td id="file-cou-ps1-LC86" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$hash<span class="pl-smi">.Hash</span></span> <span class="pl-k">-eq</span> <span class="pl-smi">$sha</span>) {<span class="pl-k">Continue</span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L87" class="blob-num js-line-number" data-line-number="87"></td>
        <td id="file-cou-ps1-LC87" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L88" class="blob-num js-line-number" data-line-number="88"></td>
        <td id="file-cou-ps1-LC88" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$folderexist</span> <span class="pl-k">-eq</span> <span class="pl-c1">$False</span>) {<span class="pl-c1">New-Item</span> <span class="pl-k">-</span>ItemType Directory <span class="pl-k">-</span>path <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span>\<span class="pl-smi">$srcf</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L89" class="blob-num js-line-number" data-line-number="89"></td>
        <td id="file-cou-ps1-LC89" class="blob-code blob-code-inner js-file-line"><span class="pl-k">try</span> {<span class="pl-c1">Invoke-WebRequest</span> <span class="pl-k">-</span>Uri <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inisurl</span>/<span class="pl-smi">$src$packed</span><span class="pl-pds">"</span></span> <span class="pl-k">-</span>OutFile <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span>/<span class="pl-smi">$srcp$packed</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L90" class="blob-num js-line-number" data-line-number="90"></td>
        <td id="file-cou-ps1-LC90" class="blob-code blob-code-inner js-file-line"><span class="pl-k">catch</span> {<span class="pl-c1">Invoke-WebRequest</span> <span class="pl-k">-</span>Uri <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inisurl</span>/<span class="pl-smi">$src</span><span class="pl-pds">"</span></span> <span class="pl-k">-</span>OutFile <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span>/<span class="pl-smi">$srcp</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L91" class="blob-num js-line-number" data-line-number="91"></td>
        <td id="file-cou-ps1-LC91" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L92" class="blob-num js-line-number" data-line-number="92"></td>
        <td id="file-cou-ps1-LC92" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L93" class="blob-num js-line-number" data-line-number="93"></td>
        <td id="file-cou-ps1-LC93" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$cispacked</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>) {<span class="pl-c1">Remove-Item</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span>\cis_update_<span class="pl-smi">$x</span>.xml<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L94" class="blob-num js-line-number" data-line-number="94"></td>
        <td id="file-cou-ps1-LC94" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L95" class="blob-num js-line-number" data-line-number="95"></td>
        <td id="file-cou-ps1-LC95" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span> Recognizers<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L96" class="blob-num js-line-number" data-line-number="96"></td>
        <td id="file-cou-ps1-LC96" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L97" class="blob-num js-line-number" data-line-number="97"></td>
        <td id="file-cou-ps1-LC97" class="blob-code blob-code-inner js-file-line"><span class="pl-c1">Invoke-WebRequest</span> <span class="pl-k">-</span>Uri <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$recognizersurl</span>/cmdscope_update_<span class="pl-smi">$x</span>.xml<span class="pl-smi">$packed</span><span class="pl-pds">"</span></span> <span class="pl-k">-</span>OutFile <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$recognizerspath</span>/cmdscope_update_<span class="pl-smi">$x</span>.xml<span class="pl-smi">$packed</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L98" class="blob-num js-line-number" data-line-number="98"></td>
        <td id="file-cou-ps1-LC98" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$cispacked</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>) {<span class="pl-k">&amp;</span> <span class="pl-smi">$7z</span> x <span class="pl-k">-</span>o<span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$recognizerspath</span><span class="pl-pds">"</span></span> <span class="pl-smi">$recognizerspath</span>\cmdscope_update_<span class="pl-smi">$x<span class="pl-smi">.xml.7z</span></span> <span class="pl-k">-</span>y}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L99" class="blob-num js-line-number" data-line-number="99"></td>
        <td id="file-cou-ps1-LC99" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$lines</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Content</span> <span class="pl-smi">$recognizerspath</span>\cmdscope_update_<span class="pl-smi">$x<span class="pl-smi">.xml</span></span> <span class="pl-k">|</span> <span class="pl-k">?</span> {<span class="pl-c1">$_</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>&lt;file name=<span class="pl-pds">"</span></span> <span class="pl-k">-and</span> <span class="pl-c1">$_</span> <span class="pl-k">-notmatch</span> <span class="pl-s"><span class="pl-pds">"</span>\\<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L100" class="blob-num js-line-number" data-line-number="100"></td>
        <td id="file-cou-ps1-LC100" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L101" class="blob-num js-line-number" data-line-number="101"></td>
        <td id="file-cou-ps1-LC101" class="blob-code blob-code-inner js-file-line"><span class="pl-k">foreach</span> (<span class="pl-smi">$line</span> <span class="pl-k">in</span> <span class="pl-smi">$lines</span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L102" class="blob-num js-line-number" data-line-number="102"></td>
        <td id="file-cou-ps1-LC102" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$line</span> <span class="pl-k">=</span> <span class="pl-smi">$line</span> <span class="pl-k">-split</span> <span class="pl-s"><span class="pl-pds">"</span> <span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L103" class="blob-num js-line-number" data-line-number="103"></td>
        <td id="file-cou-ps1-LC103" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$name</span> <span class="pl-k">=</span> <span class="pl-smi">$line</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>name=<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L104" class="blob-num js-line-number" data-line-number="104"></td>
        <td id="file-cou-ps1-LC104" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$name</span> <span class="pl-k">=</span> <span class="pl-smi">$name</span> <span class="pl-k">-replace</span> <span class="pl-s"><span class="pl-pds">"</span>name=|<span class="pl-cce">`"</span><span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L105" class="blob-num js-line-number" data-line-number="105"></td>
        <td id="file-cou-ps1-LC105" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$sha</span> <span class="pl-k">=</span> <span class="pl-smi">$line</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>sha=<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L106" class="blob-num js-line-number" data-line-number="106"></td>
        <td id="file-cou-ps1-LC106" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$sha</span> <span class="pl-k">=</span> <span class="pl-smi">$sha</span> <span class="pl-k">-replace</span> <span class="pl-s"><span class="pl-pds">"</span>sha=|<span class="pl-cce">`"</span><span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L107" class="blob-num js-line-number" data-line-number="107"></td>
        <td id="file-cou-ps1-LC107" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$sha</span> <span class="pl-k">=</span> <span class="pl-smi">$sha<span class="pl-smi">.toupper</span></span>()</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L108" class="blob-num js-line-number" data-line-number="108"></td>
        <td id="file-cou-ps1-LC108" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$src</span> <span class="pl-k">=</span> <span class="pl-smi">$line</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>src=<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L109" class="blob-num js-line-number" data-line-number="109"></td>
        <td id="file-cou-ps1-LC109" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$src</span> <span class="pl-k">=</span> <span class="pl-smi">$src</span> <span class="pl-k">-replace</span> <span class="pl-s"><span class="pl-pds">"</span>src=|<span class="pl-cce">`"</span>|&gt;<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L110" class="blob-num js-line-number" data-line-number="110"></td>
        <td id="file-cou-ps1-LC110" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$srcf</span> <span class="pl-k">=</span> <span class="pl-smi">$src<span class="pl-smi">.substring</span></span>(<span class="pl-c1">0</span><span class="pl-k">,</span><span class="pl-smi">$src<span class="pl-smi">.lastindexof</span></span>(<span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>))</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L111" class="blob-num js-line-number" data-line-number="111"></td>
        <td id="file-cou-ps1-LC111" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$srcp</span> <span class="pl-k">=</span> <span class="pl-smi">$src</span> <span class="pl-k">-replace</span> <span class="pl-s"><span class="pl-pds">"</span>\/<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>\<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L112" class="blob-num js-line-number" data-line-number="112"></td>
        <td id="file-cou-ps1-LC112" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L113" class="blob-num js-line-number" data-line-number="113"></td>
        <td id="file-cou-ps1-LC113" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$fileexist</span> <span class="pl-k">=</span> <span class="pl-c1">Test-Path</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$recognizerspath</span>\<span class="pl-smi">$srcp$packed</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L114" class="blob-num js-line-number" data-line-number="114"></td>
        <td id="file-cou-ps1-LC114" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$folderexist</span> <span class="pl-k">=</span> <span class="pl-c1">Test-Path</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$recognizerspath</span>\<span class="pl-smi">$srcf</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L115" class="blob-num js-line-number" data-line-number="115"></td>
        <td id="file-cou-ps1-LC115" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L116" class="blob-num js-line-number" data-line-number="116"></td>
        <td id="file-cou-ps1-LC116" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L117" class="blob-num js-line-number" data-line-number="117"></td>
        <td id="file-cou-ps1-LC117" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$fileexist</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L118" class="blob-num js-line-number" data-line-number="118"></td>
        <td id="file-cou-ps1-LC118" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$remove</span> <span class="pl-k">=</span> <span class="pl-c1">$False</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L119" class="blob-num js-line-number" data-line-number="119"></td>
        <td id="file-cou-ps1-LC119" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$cispacked</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L120" class="blob-num js-line-number" data-line-number="120"></td>
        <td id="file-cou-ps1-LC120" class="blob-code blob-code-inner js-file-line"><span class="pl-k">try</span> {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L121" class="blob-num js-line-number" data-line-number="121"></td>
        <td id="file-cou-ps1-LC121" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$remove</span> <span class="pl-k">=</span> <span class="pl-c1">$True</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L122" class="blob-num js-line-number" data-line-number="122"></td>
        <td id="file-cou-ps1-LC122" class="blob-code blob-code-inner js-file-line"><span class="pl-k">&amp;</span> <span class="pl-smi">$7z</span> x <span class="pl-k">-</span>o<span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$recognizerspath</span>/<span class="pl-smi">$srcf</span><span class="pl-pds">"</span></span> <span class="pl-smi">$recognizerspath</span><span class="pl-k">/</span><span class="pl-smi">$srcp<span class="pl-smi">.7z</span></span> <span class="pl-k">-</span>y</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L123" class="blob-num js-line-number" data-line-number="123"></td>
        <td id="file-cou-ps1-LC123" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L124" class="blob-num js-line-number" data-line-number="124"></td>
        <td id="file-cou-ps1-LC124" class="blob-code blob-code-inner js-file-line"><span class="pl-k">catch</span> {}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L125" class="blob-num js-line-number" data-line-number="125"></td>
        <td id="file-cou-ps1-LC125" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L126" class="blob-num js-line-number" data-line-number="126"></td>
        <td id="file-cou-ps1-LC126" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$hash</span> <span class="pl-k">=</span> <span class="pl-c1">Get-FileHash</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$recognizerspath</span>/<span class="pl-smi">$srcp</span><span class="pl-pds">"</span></span> <span class="pl-k">-</span>Algorithm SHA1</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L127" class="blob-num js-line-number" data-line-number="127"></td>
        <td id="file-cou-ps1-LC127" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$remove</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>) {<span class="pl-c1">Remove-Item</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$recognizerspath</span>\<span class="pl-smi">$srcp</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L128" class="blob-num js-line-number" data-line-number="128"></td>
        <td id="file-cou-ps1-LC128" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$hash<span class="pl-smi">.Hash</span></span> <span class="pl-k">-eq</span> <span class="pl-smi">$sha</span>) {<span class="pl-k">Continue</span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L129" class="blob-num js-line-number" data-line-number="129"></td>
        <td id="file-cou-ps1-LC129" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L130" class="blob-num js-line-number" data-line-number="130"></td>
        <td id="file-cou-ps1-LC130" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$folderexist</span> <span class="pl-k">-eq</span> <span class="pl-c1">$False</span>) {<span class="pl-c1">New-Item</span> <span class="pl-k">-</span>ItemType Directory <span class="pl-k">-</span>path <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$recognizerspath</span>\<span class="pl-smi">$srcf</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L131" class="blob-num js-line-number" data-line-number="131"></td>
        <td id="file-cou-ps1-LC131" class="blob-code blob-code-inner js-file-line"><span class="pl-k">try</span> {<span class="pl-c1">Invoke-WebRequest</span> <span class="pl-k">-</span>Uri <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$recognizersurl</span>/<span class="pl-smi">$src$packed</span><span class="pl-pds">"</span></span> <span class="pl-k">-</span>OutFile <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$recognizerspath</span>/<span class="pl-smi">$srcp$packed</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L132" class="blob-num js-line-number" data-line-number="132"></td>
        <td id="file-cou-ps1-LC132" class="blob-code blob-code-inner js-file-line"><span class="pl-k">catch</span> {<span class="pl-c1">Invoke-WebRequest</span> <span class="pl-k">-</span>Uri <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$recognizersurl</span>/<span class="pl-smi">$src</span><span class="pl-pds">"</span></span> <span class="pl-k">-</span>OutFile <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$recognizerspath</span>/<span class="pl-smi">$srcp</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L133" class="blob-num js-line-number" data-line-number="133"></td>
        <td id="file-cou-ps1-LC133" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L134" class="blob-num js-line-number" data-line-number="134"></td>
        <td id="file-cou-ps1-LC134" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L135" class="blob-num js-line-number" data-line-number="135"></td>
        <td id="file-cou-ps1-LC135" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L136" class="blob-num js-line-number" data-line-number="136"></td>
        <td id="file-cou-ps1-LC136" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$cispacked</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>) {<span class="pl-c1">Remove-Item</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$recognizerspath</span>\cmdscope_update_<span class="pl-smi">$x</span>.xml<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L137" class="blob-num js-line-number" data-line-number="137"></td>
        <td id="file-cou-ps1-LC137" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L138" class="blob-num js-line-number" data-line-number="138"></td>
        <td id="file-cou-ps1-LC138" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L139" class="blob-num js-line-number" data-line-number="139"></td>
        <td id="file-cou-ps1-LC139" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>#################################################<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L140" class="blob-num js-line-number" data-line-number="140"></td>
        <td id="file-cou-ps1-LC140" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>Release Notes<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L141" class="blob-num js-line-number" data-line-number="141"></td>
        <td id="file-cou-ps1-LC141" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L142" class="blob-num js-line-number" data-line-number="142"></td>
        <td id="file-cou-ps1-LC142" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$release_notes</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L143" class="blob-num js-line-number" data-line-number="143"></td>
        <td id="file-cou-ps1-LC143" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$rn</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>ComodoLogo.png<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>Fixed.png<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>Header.png<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>Improved.png<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>Logo.png<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>New.png<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>Panel_body.png<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>Panel_footer.png<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>Panel_header.png<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>Panel_left_body.png<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>Panel_left_footer.png<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>Panel_left_header.png<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span>Panel_left_hr.png<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L144" class="blob-num js-line-number" data-line-number="144"></td>
        <td id="file-cou-ps1-LC144" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$testrn</span> <span class="pl-k">=</span> <span class="pl-c1">Test-Path</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span>\images<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L145" class="blob-num js-line-number" data-line-number="145"></td>
        <td id="file-cou-ps1-LC145" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$testrn</span> <span class="pl-k">-eq</span> <span class="pl-c1">$False</span>) {<span class="pl-c1">New-Item</span> <span class="pl-k">-</span>ItemType Directory <span class="pl-k">-</span>Path <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span>\images<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L146" class="blob-num js-line-number" data-line-number="146"></td>
        <td id="file-cou-ps1-LC146" class="blob-code blob-code-inner js-file-line"><span class="pl-c1">Invoke-WebRequest</span> <span class="pl-k">-</span>Uri <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inisurl</span>/release_notes.html<span class="pl-pds">"</span></span> <span class="pl-k">-</span>OutFile <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span>/release_notes.html<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L147" class="blob-num js-line-number" data-line-number="147"></td>
        <td id="file-cou-ps1-LC147" class="blob-code blob-code-inner js-file-line"><span class="pl-k">foreach</span> (<span class="pl-smi">$r</span> <span class="pl-k">in</span> <span class="pl-smi">$rn</span>) {<span class="pl-c1">Invoke-WebRequest</span> <span class="pl-k">-</span>Uri <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inisurl</span>/images/<span class="pl-smi">$r</span><span class="pl-pds">"</span></span> <span class="pl-k">-</span>OutFile <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$inispath</span>/images/<span class="pl-smi">$r</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L148" class="blob-num js-line-number" data-line-number="148"></td>
        <td id="file-cou-ps1-LC148" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L149" class="blob-num js-line-number" data-line-number="149"></td>
        <td id="file-cou-ps1-LC149" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L150" class="blob-num js-line-number" data-line-number="150"></td>
        <td id="file-cou-ps1-LC150" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L151" class="blob-num js-line-number" data-line-number="151"></td>
        <td id="file-cou-ps1-LC151" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>######################################################################<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L152" class="blob-num js-line-number" data-line-number="152"></td>
        <td id="file-cou-ps1-LC152" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>##################        #####################<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L153" class="blob-num js-line-number" data-line-number="153"></td>
        <td id="file-cou-ps1-LC153" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L154" class="blob-num js-line-number" data-line-number="154"></td>
        <td id="file-cou-ps1-LC154" class="blob-code blob-code-inner js-file-line"><span class="pl-k">elseif</span> (<span class="pl-smi">$1</span> <span class="pl-k">-eq</span> <span class="pl-s"><span class="pl-pds">"</span>av<span class="pl-pds">"</span></span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L155" class="blob-num js-line-number" data-line-number="155"></td>
        <td id="file-cou-ps1-LC155" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L156" class="blob-num js-line-number" data-line-number="156"></td>
        <td id="file-cou-ps1-LC156" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$avpacked</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>) {<span class="pl-smi">$packed</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>.z<span class="pl-pds">"</span></span>} <span class="pl-k">else</span> {<span class="pl-smi">$packed</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L157" class="blob-num js-line-number" data-line-number="157"></td>
        <td id="file-cou-ps1-LC157" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L158" class="blob-num js-line-number" data-line-number="158"></td>
        <td id="file-cou-ps1-LC158" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>updates58<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L159" class="blob-num js-line-number" data-line-number="159"></td>
        <td id="file-cou-ps1-LC159" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L160" class="blob-num js-line-number" data-line-number="160"></td>
        <td id="file-cou-ps1-LC160" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$folders</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$basespath</span><span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updatespath</span><span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$urlpath</span><span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$tvlpath</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L161" class="blob-num js-line-number" data-line-number="161"></td>
        <td id="file-cou-ps1-LC161" class="blob-code blob-code-inner js-file-line"><span class="pl-k">foreach</span> (<span class="pl-smi">$folder</span> <span class="pl-k">in</span> <span class="pl-smi">$folders</span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L162" class="blob-num js-line-number" data-line-number="162"></td>
        <td id="file-cou-ps1-LC162" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$testfolder</span> <span class="pl-k">=</span> <span class="pl-c1">Test-Path</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$folder</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L163" class="blob-num js-line-number" data-line-number="163"></td>
        <td id="file-cou-ps1-LC163" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$testfolder</span> <span class="pl-k">-eq</span> <span class="pl-c1">$False</span>) {<span class="pl-c1">New-Item</span> <span class="pl-k">-</span>ItemType directory <span class="pl-k">-</span>Path <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$folder</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L164" class="blob-num js-line-number" data-line-number="164"></td>
        <td id="file-cou-ps1-LC164" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L165" class="blob-num js-line-number" data-line-number="165"></td>
        <td id="file-cou-ps1-LC165" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L166" class="blob-num js-line-number" data-line-number="166"></td>
        <td id="file-cou-ps1-LC166" class="blob-code blob-code-inner js-file-line"><span class="pl-c1">Invoke-WebRequest</span> <span class="pl-k">-</span>Uri <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$tvlurl</span>/delven.txt<span class="pl-pds">"</span></span> <span class="pl-k">-</span>OutFile <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$tvlpath</span>\delven.txt<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L167" class="blob-num js-line-number" data-line-number="167"></td>
        <td id="file-cou-ps1-LC167" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L168" class="blob-num js-line-number" data-line-number="168"></td>
        <td id="file-cou-ps1-LC168" class="blob-code blob-code-inner js-file-line"><span class="pl-c1">Invoke-WebRequest</span> <span class="pl-k">-</span>Uri <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updates58url</span>/versioninfo.ini<span class="pl-pds">"</span></span> <span class="pl-k">-</span>OutFile <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updates58path</span>\versioninfo.ini<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L169" class="blob-num js-line-number" data-line-number="169"></td>
        <td id="file-cou-ps1-LC169" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$file</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Content</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updates58path</span>\versioninfo.ini<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L170" class="blob-num js-line-number" data-line-number="170"></td>
        <td id="file-cou-ps1-LC170" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$base</span> <span class="pl-k">=</span> <span class="pl-smi">$file</span> <span class="pl-k">|</span> <span class="pl-k">Where</span> {<span class="pl-c1">$_</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>MaxBase=<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L171" class="blob-num js-line-number" data-line-number="171"></td>
        <td id="file-cou-ps1-LC171" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$base</span> <span class="pl-k">=</span> <span class="pl-smi">$base<span class="pl-smi">.substring</span></span>(<span class="pl-c1">8</span>)<span class="pl-k">/</span><span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L172" class="blob-num js-line-number" data-line-number="172"></td>
        <td id="file-cou-ps1-LC172" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$inc</span> <span class="pl-k">=</span> <span class="pl-smi">$file</span> <span class="pl-k">|</span> <span class="pl-k">Where</span> {<span class="pl-c1">$_</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>MaxAvailVersion=<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L173" class="blob-num js-line-number" data-line-number="173"></td>
        <td id="file-cou-ps1-LC173" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$inc</span> <span class="pl-k">=</span> <span class="pl-smi">$inc<span class="pl-smi">.substring</span></span>(<span class="pl-c1">16</span>)<span class="pl-k">/</span><span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L174" class="blob-num js-line-number" data-line-number="174"></td>
        <td id="file-cou-ps1-LC174" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$diff</span> <span class="pl-k">=</span> <span class="pl-smi">$file</span> <span class="pl-k">|</span> <span class="pl-k">Where</span> {<span class="pl-c1">$_</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>MaxDiff=<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L175" class="blob-num js-line-number" data-line-number="175"></td>
        <td id="file-cou-ps1-LC175" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$diff</span> <span class="pl-k">=</span> <span class="pl-smi">$diff<span class="pl-smi">.substring</span></span>(<span class="pl-c1">8</span>)<span class="pl-k">/</span><span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L176" class="blob-num js-line-number" data-line-number="176"></td>
        <td id="file-cou-ps1-LC176" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$incr</span> <span class="pl-k">=</span> <span class="pl-smi">$inc</span> <span class="pl-k">-</span> <span class="pl-smi">$diff</span> <span class="pl-k">+</span> <span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L177" class="blob-num js-line-number" data-line-number="177"></td>
        <td id="file-cou-ps1-LC177" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$incr</span> <span class="pl-k">-gt</span> <span class="pl-smi">$base</span>) {<span class="pl-smi">$incr</span> <span class="pl-k">=</span> <span class="pl-smi">$base</span> <span class="pl-k">+</span> <span class="pl-c1">1</span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L178" class="blob-num js-line-number" data-line-number="178"></td>
        <td id="file-cou-ps1-LC178" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L179" class="blob-num js-line-number" data-line-number="179"></td>
        <td id="file-cou-ps1-LC179" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$testbases</span> <span class="pl-k">=</span> <span class="pl-c1">Test-Path</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$basespath</span>\BASE_END_USER_v<span class="pl-smi">$base</span>.cav<span class="pl-smi">$packed</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L180" class="blob-num js-line-number" data-line-number="180"></td>
        <td id="file-cou-ps1-LC180" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$testbases</span> <span class="pl-k">-eq</span> <span class="pl-c1">$False</span>) {<span class="pl-c1">Invoke-WebRequest</span> <span class="pl-k">-</span>Uri <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$basesurl</span>/BASE_END_USER_v<span class="pl-smi">$base</span>.cav<span class="pl-smi">$packed</span><span class="pl-pds">"</span></span> <span class="pl-k">-</span>OutFile <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$basespath</span>\BASE_END_USER_v<span class="pl-smi">$base</span>.cav<span class="pl-smi">$packed</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L181" class="blob-num js-line-number" data-line-number="181"></td>
        <td id="file-cou-ps1-LC181" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L182" class="blob-num js-line-number" data-line-number="182"></td>
        <td id="file-cou-ps1-LC182" class="blob-code blob-code-inner js-file-line"><span class="pl-k">do</span> {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L183" class="blob-num js-line-number" data-line-number="183"></td>
        <td id="file-cou-ps1-LC183" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$testupdates</span> <span class="pl-k">=</span> <span class="pl-c1">Test-Path</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updatespath</span>\BASE_UPD_END_USER_v<span class="pl-smi">$incr</span>.cav<span class="pl-smi">$packed</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L184" class="blob-num js-line-number" data-line-number="184"></td>
        <td id="file-cou-ps1-LC184" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$testupdates</span> <span class="pl-k">-eq</span> <span class="pl-c1">$False</span>) {<span class="pl-c1">Invoke-WebRequest</span> <span class="pl-k">-</span>Uri <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updatesurl</span>/BASE_UPD_END_USER_v<span class="pl-smi">$incr</span>.cav<span class="pl-smi">$packed</span><span class="pl-pds">"</span></span> <span class="pl-k">-</span>OutFile <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updatespath</span>\BASE_UPD_END_USER_v<span class="pl-smi">$incr</span>.cav<span class="pl-smi">$packed</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L185" class="blob-num js-line-number" data-line-number="185"></td>
        <td id="file-cou-ps1-LC185" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$incr</span><span class="pl-k">++</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L186" class="blob-num js-line-number" data-line-number="186"></td>
        <td id="file-cou-ps1-LC186" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L187" class="blob-num js-line-number" data-line-number="187"></td>
        <td id="file-cou-ps1-LC187" class="blob-code blob-code-inner js-file-line"><span class="pl-k">while</span> (<span class="pl-smi">$incr</span> <span class="pl-k">-le</span> <span class="pl-smi">$inc</span>)</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L188" class="blob-num js-line-number" data-line-number="188"></td>
        <td id="file-cou-ps1-LC188" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L189" class="blob-num js-line-number" data-line-number="189"></td>
        <td id="file-cou-ps1-LC189" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span> updatesurl<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L190" class="blob-num js-line-number" data-line-number="190"></td>
        <td id="file-cou-ps1-LC190" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L191" class="blob-num js-line-number" data-line-number="191"></td>
        <td id="file-cou-ps1-LC191" class="blob-code blob-code-inner js-file-line"><span class="pl-c1">Invoke-WebRequest</span> <span class="pl-k">-</span>Uri <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updatesurlurl</span>/versioninfo.ini<span class="pl-pds">"</span></span> <span class="pl-k">-</span>OutFile <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updatesurlpath</span>\versioninfo.ini<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L192" class="blob-num js-line-number" data-line-number="192"></td>
        <td id="file-cou-ps1-LC192" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$file</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Content</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updatesurlpath</span>\versioninfo.ini<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L193" class="blob-num js-line-number" data-line-number="193"></td>
        <td id="file-cou-ps1-LC193" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$base</span> <span class="pl-k">=</span> <span class="pl-smi">$file</span> <span class="pl-k">|</span> <span class="pl-k">Where</span> {<span class="pl-c1">$_</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>MaxBase=<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L194" class="blob-num js-line-number" data-line-number="194"></td>
        <td id="file-cou-ps1-LC194" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$base</span> <span class="pl-k">=</span> <span class="pl-smi">$base<span class="pl-smi">.substring</span></span>(<span class="pl-c1">8</span>)</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L195" class="blob-num js-line-number" data-line-number="195"></td>
        <td id="file-cou-ps1-LC195" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$inc</span> <span class="pl-k">=</span> <span class="pl-smi">$file</span> <span class="pl-k">|</span> <span class="pl-k">Where</span> {<span class="pl-c1">$_</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>MaxAvailVersion=<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L196" class="blob-num js-line-number" data-line-number="196"></td>
        <td id="file-cou-ps1-LC196" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$inc</span> <span class="pl-k">=</span> <span class="pl-smi">$inc<span class="pl-smi">.substring</span></span>(<span class="pl-c1">16</span>)</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L197" class="blob-num js-line-number" data-line-number="197"></td>
        <td id="file-cou-ps1-LC197" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$incr</span> <span class="pl-k">=</span> <span class="pl-smi">$base</span><span class="pl-k">/</span><span class="pl-c1">1</span> <span class="pl-k">+</span> <span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L198" class="blob-num js-line-number" data-line-number="198"></td>
        <td id="file-cou-ps1-LC198" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L199" class="blob-num js-line-number" data-line-number="199"></td>
        <td id="file-cou-ps1-LC199" class="blob-code blob-code-inner js-file-line"><span class="pl-k">do</span> {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L200" class="blob-num js-line-number" data-line-number="200"></td>
        <td id="file-cou-ps1-LC200" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$testupdatesurl</span> <span class="pl-k">=</span> <span class="pl-c1">Test-Path</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$urlpath</span>\BASE_UPD_END_USER_v<span class="pl-smi">$incr</span>.cav.z<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L201" class="blob-num js-line-number" data-line-number="201"></td>
        <td id="file-cou-ps1-LC201" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$testupdatesurl</span> <span class="pl-k">-eq</span> <span class="pl-c1">$False</span>) {<span class="pl-c1">Invoke-WebRequest</span> <span class="pl-k">-</span>Uri <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$urlurl</span>/BASE_UPD_END_USER_v<span class="pl-smi">$incr</span>.cav.z<span class="pl-pds">"</span></span> <span class="pl-k">-</span>OutFile <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$urlpath</span>\BASE_UPD_END_USER_v<span class="pl-smi">$incr</span>.cav.z<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L202" class="blob-num js-line-number" data-line-number="202"></td>
        <td id="file-cou-ps1-LC202" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$incr</span><span class="pl-k">++</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L203" class="blob-num js-line-number" data-line-number="203"></td>
        <td id="file-cou-ps1-LC203" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L204" class="blob-num js-line-number" data-line-number="204"></td>
        <td id="file-cou-ps1-LC204" class="blob-code blob-code-inner js-file-line"><span class="pl-k">while</span> (<span class="pl-smi">$incr</span> <span class="pl-k">-le</span> <span class="pl-smi">$inc</span>)</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L205" class="blob-num js-line-number" data-line-number="205"></td>
        <td id="file-cou-ps1-LC205" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L206" class="blob-num js-line-number" data-line-number="206"></td>
        <td id="file-cou-ps1-LC206" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L207" class="blob-num js-line-number" data-line-number="207"></td>
        <td id="file-cou-ps1-LC207" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>######################################################################<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L208" class="blob-num js-line-number" data-line-number="208"></td>
        <td id="file-cou-ps1-LC208" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>####################        #####################<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L209" class="blob-num js-line-number" data-line-number="209"></td>
        <td id="file-cou-ps1-LC209" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L210" class="blob-num js-line-number" data-line-number="210"></td>
        <td id="file-cou-ps1-LC210" class="blob-code blob-code-inner js-file-line"><span class="pl-k">elseif</span> (<span class="pl-smi">$1</span> <span class="pl-k">-eq</span> <span class="pl-s"><span class="pl-pds">"</span>av-clean<span class="pl-pds">"</span></span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L211" class="blob-num js-line-number" data-line-number="211"></td>
        <td id="file-cou-ps1-LC211" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L212" class="blob-num js-line-number" data-line-number="212"></td>
        <td id="file-cou-ps1-LC212" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$avpacked</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>) {<span class="pl-smi">$packed</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>.z<span class="pl-pds">"</span></span>} <span class="pl-k">else</span> {<span class="pl-smi">$packed</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L213" class="blob-num js-line-number" data-line-number="213"></td>
        <td id="file-cou-ps1-LC213" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L214" class="blob-num js-line-number" data-line-number="214"></td>
        <td id="file-cou-ps1-LC214" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$test58ver</span> <span class="pl-k">=</span> <span class="pl-c1">Test-Path</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updates58path</span>\versioninfo.ini<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L215" class="blob-num js-line-number" data-line-number="215"></td>
        <td id="file-cou-ps1-LC215" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$testurlver</span> <span class="pl-k">=</span> <span class="pl-c1">Test-Path</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updatesurlpath</span>\versioninfo.ini<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L216" class="blob-num js-line-number" data-line-number="216"></td>
        <td id="file-cou-ps1-LC216" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>$message = ""<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L217" class="blob-num js-line-number" data-line-number="217"></td>
        <td id="file-cou-ps1-LC217" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L218" class="blob-num js-line-number" data-line-number="218"></td>
        <td id="file-cou-ps1-LC218" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$test58ver</span> <span class="pl-k">-eq</span> <span class="pl-c1">$True</span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L219" class="blob-num js-line-number" data-line-number="219"></td>
        <td id="file-cou-ps1-LC219" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$file</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Content</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updates58path</span>\versioninfo.ini<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L220" class="blob-num js-line-number" data-line-number="220"></td>
        <td id="file-cou-ps1-LC220" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$base</span> <span class="pl-k">=</span> <span class="pl-smi">$file</span> <span class="pl-k">|</span> <span class="pl-k">Where</span> {<span class="pl-c1">$_</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>MaxBase=<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L221" class="blob-num js-line-number" data-line-number="221"></td>
        <td id="file-cou-ps1-LC221" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$base</span> <span class="pl-k">=</span> <span class="pl-smi">$base<span class="pl-smi">.substring</span></span>(<span class="pl-c1">8</span>)<span class="pl-k">/</span><span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L222" class="blob-num js-line-number" data-line-number="222"></td>
        <td id="file-cou-ps1-LC222" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$aval</span> <span class="pl-k">=</span> <span class="pl-smi">$file</span> <span class="pl-k">|</span> <span class="pl-k">Where</span> {<span class="pl-c1">$_</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>MaxAvailVersion=<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L223" class="blob-num js-line-number" data-line-number="223"></td>
        <td id="file-cou-ps1-LC223" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$aval</span> <span class="pl-k">=</span> <span class="pl-smi">$aval<span class="pl-smi">.substring</span></span>(<span class="pl-c1">16</span>)<span class="pl-k">/</span><span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L224" class="blob-num js-line-number" data-line-number="224"></td>
        <td id="file-cou-ps1-LC224" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$diff</span> <span class="pl-k">=</span> <span class="pl-smi">$file</span> <span class="pl-k">|</span> <span class="pl-k">Where</span> {<span class="pl-c1">$_</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>MaxDiff=<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L225" class="blob-num js-line-number" data-line-number="225"></td>
        <td id="file-cou-ps1-LC225" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$diff</span> <span class="pl-k">=</span> <span class="pl-smi">$diff<span class="pl-smi">.substring</span></span>(<span class="pl-c1">8</span>)<span class="pl-k">/</span><span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L226" class="blob-num js-line-number" data-line-number="226"></td>
        <td id="file-cou-ps1-LC226" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$del</span> <span class="pl-k">=</span> <span class="pl-smi">$aval</span> <span class="pl-k">-</span> <span class="pl-smi">$diff</span> <span class="pl-k">+</span> <span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L227" class="blob-num js-line-number" data-line-number="227"></td>
        <td id="file-cou-ps1-LC227" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$del</span> <span class="pl-k">-gt</span> <span class="pl-smi">$base</span>) {<span class="pl-smi">$del</span> <span class="pl-k">=</span> <span class="pl-smi">$base</span> <span class="pl-k">+</span> <span class="pl-c1">1</span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L228" class="blob-num js-line-number" data-line-number="228"></td>
        <td id="file-cou-ps1-LC228" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L229" class="blob-num js-line-number" data-line-number="229"></td>
        <td id="file-cou-ps1-LC229" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$names</span> <span class="pl-k">=</span> (<span class="pl-c1">Get-ChildItem</span> <span class="pl-k">-</span>Path <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$basespath</span><span class="pl-pds">"</span></span>).basename <span class="pl-k">-replace</span> <span class="pl-s"><span class="pl-pds">"</span>BASE_END_USER_v|.cav<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L230" class="blob-num js-line-number" data-line-number="230"></td>
        <td id="file-cou-ps1-LC230" class="blob-code blob-code-inner js-file-line"><span class="pl-k">foreach</span> (<span class="pl-smi">$name</span> <span class="pl-k">in</span> <span class="pl-smi">$names</span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L231" class="blob-num js-line-number" data-line-number="231"></td>
        <td id="file-cou-ps1-LC231" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$name</span> <span class="pl-k">=</span> <span class="pl-smi">$name</span><span class="pl-k">/</span><span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L232" class="blob-num js-line-number" data-line-number="232"></td>
        <td id="file-cou-ps1-LC232" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$name</span> <span class="pl-k">-lt</span> <span class="pl-smi">$base</span>) {<span class="pl-c1">Remove-Item</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$basespath</span>\BASE_END_USER_v<span class="pl-smi">$name</span>.cav<span class="pl-smi">$packed</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L233" class="blob-num js-line-number" data-line-number="233"></td>
        <td id="file-cou-ps1-LC233" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L234" class="blob-num js-line-number" data-line-number="234"></td>
        <td id="file-cou-ps1-LC234" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L235" class="blob-num js-line-number" data-line-number="235"></td>
        <td id="file-cou-ps1-LC235" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$names</span> <span class="pl-k">=</span> (<span class="pl-c1">Get-ChildItem</span> <span class="pl-k">-</span>Path <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updatespath</span><span class="pl-pds">"</span></span>).basename <span class="pl-k">-replace</span> <span class="pl-s"><span class="pl-pds">"</span>BASE_UPD_END_USER_v|.cav<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L236" class="blob-num js-line-number" data-line-number="236"></td>
        <td id="file-cou-ps1-LC236" class="blob-code blob-code-inner js-file-line"><span class="pl-k">foreach</span> (<span class="pl-smi">$name</span> <span class="pl-k">in</span> <span class="pl-smi">$names</span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L237" class="blob-num js-line-number" data-line-number="237"></td>
        <td id="file-cou-ps1-LC237" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$name</span> <span class="pl-k">=</span> <span class="pl-smi">$name</span><span class="pl-k">/</span><span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L238" class="blob-num js-line-number" data-line-number="238"></td>
        <td id="file-cou-ps1-LC238" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$name</span> <span class="pl-k">-lt</span> <span class="pl-smi">$del</span>) {<span class="pl-c1">Remove-Item</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updatespath</span>\BASE_UPD_END_USER_v<span class="pl-smi">$name</span>.cav<span class="pl-smi">$packed</span><span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L239" class="blob-num js-line-number" data-line-number="239"></td>
        <td id="file-cou-ps1-LC239" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L240" class="blob-num js-line-number" data-line-number="240"></td>
        <td id="file-cou-ps1-LC240" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L241" class="blob-num js-line-number" data-line-number="241"></td>
        <td id="file-cou-ps1-LC241" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L242" class="blob-num js-line-number" data-line-number="242"></td>
        <td id="file-cou-ps1-LC242" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$testurlver</span> <span class="pl-k">-eq</span> <span class="pl-c1">$true</span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L243" class="blob-num js-line-number" data-line-number="243"></td>
        <td id="file-cou-ps1-LC243" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$file</span> <span class="pl-k">=</span> <span class="pl-c1">Get-Content</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$updatesurlpath</span>\versioninfo.ini<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L244" class="blob-num js-line-number" data-line-number="244"></td>
        <td id="file-cou-ps1-LC244" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$aval</span> <span class="pl-k">=</span> <span class="pl-smi">$file</span> <span class="pl-k">|</span> <span class="pl-k">Where</span> {<span class="pl-c1">$_</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>MaxAvailVersion=<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L245" class="blob-num js-line-number" data-line-number="245"></td>
        <td id="file-cou-ps1-LC245" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$aval</span> <span class="pl-k">=</span> <span class="pl-smi">$aval<span class="pl-smi">.substring</span></span>(<span class="pl-c1">16</span>)<span class="pl-k">/</span><span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L246" class="blob-num js-line-number" data-line-number="246"></td>
        <td id="file-cou-ps1-LC246" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$diff</span> <span class="pl-k">=</span> <span class="pl-smi">$file</span> <span class="pl-k">|</span> <span class="pl-k">Where</span> {<span class="pl-c1">$_</span> <span class="pl-k">-match</span> <span class="pl-s"><span class="pl-pds">"</span>MaxDiff=<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L247" class="blob-num js-line-number" data-line-number="247"></td>
        <td id="file-cou-ps1-LC247" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$diff</span> <span class="pl-k">=</span> <span class="pl-smi">$diff<span class="pl-smi">.substring</span></span>(<span class="pl-c1">8</span>)<span class="pl-k">/</span><span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L248" class="blob-num js-line-number" data-line-number="248"></td>
        <td id="file-cou-ps1-LC248" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$del</span> <span class="pl-k">=</span> <span class="pl-smi">$aval</span> <span class="pl-k">-</span> <span class="pl-smi">$diff</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L249" class="blob-num js-line-number" data-line-number="249"></td>
        <td id="file-cou-ps1-LC249" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L250" class="blob-num js-line-number" data-line-number="250"></td>
        <td id="file-cou-ps1-LC250" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$names</span> <span class="pl-k">=</span> (<span class="pl-c1">Get-ChildItem</span> <span class="pl-k">-</span>Path <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$urlpath</span><span class="pl-pds">"</span></span>).basename <span class="pl-k">-replace</span> <span class="pl-s"><span class="pl-pds">"</span>BASE_UPD_END_USER_v|.cav<span class="pl-pds">"</span></span><span class="pl-k">,</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L251" class="blob-num js-line-number" data-line-number="251"></td>
        <td id="file-cou-ps1-LC251" class="blob-code blob-code-inner js-file-line"><span class="pl-k">foreach</span> (<span class="pl-smi">$name</span> <span class="pl-k">in</span> <span class="pl-smi">$names</span>) {</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L252" class="blob-num js-line-number" data-line-number="252"></td>
        <td id="file-cou-ps1-LC252" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">$name</span> <span class="pl-k">=</span> <span class="pl-smi">$name</span><span class="pl-k">/</span><span class="pl-c1">1</span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L253" class="blob-num js-line-number" data-line-number="253"></td>
        <td id="file-cou-ps1-LC253" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> (<span class="pl-smi">$name</span> <span class="pl-k">-lt</span> <span class="pl-smi">$del</span>) {<span class="pl-c1">Remove-Item</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-smi">$urlpath</span>\BASE_UPD_END_USER_v<span class="pl-smi">$name</span>.cav.z<span class="pl-pds">"</span></span>}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L254" class="blob-num js-line-number" data-line-number="254"></td>
        <td id="file-cou-ps1-LC254" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L255" class="blob-num js-line-number" data-line-number="255"></td>
        <td id="file-cou-ps1-LC255" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L256" class="blob-num js-line-number" data-line-number="256"></td>
        <td id="file-cou-ps1-LC256" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L257" class="blob-num js-line-number" data-line-number="257"></td>
        <td id="file-cou-ps1-LC257" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L258" class="blob-num js-line-number" data-line-number="258"></td>
        <td id="file-cou-ps1-LC258" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L259" class="blob-num js-line-number" data-line-number="259"></td>
        <td id="file-cou-ps1-LC259" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>######################################################################<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L260" class="blob-num js-line-number" data-line-number="260"></td>
        <td id="file-cou-ps1-LC260" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">#</span>###################         ###################<span class="pl-c"></span></span></td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L261" class="blob-num js-line-number" data-line-number="261"></td>
        <td id="file-cou-ps1-LC261" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-cou-ps1-L262" class="blob-num js-line-number" data-line-number="262"></td>
        <td id="file-cou-ps1-LC262" class="blob-code blob-code-inner js-file-line"><span class="pl-k">else</span> {<span class="pl-k">exit</span>}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">COU.ps1</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br></div></div><br><div class="spoiler">  <b class="spoiler_title">List of changes</b> <div class="spoiler_text">  v6 - Fixed the problem of lack of incremental databases in some cases, fixed database cleanup. <br>  v6.1 - In the next update, we changed deletevendors.txt to delven.txt. <br></div></div><br>  The script uses the following user variables: <br><br>  <b>$ 7z</b> - Path to 7z.exe <br>  <b>$ downloadpath</b> - The path for downloading, folders are created automatically.  In this example, ‚ÄúC: \ inetpub \ wwwroot‚Äù <br>  <b>$ serverurl</b> - Comodo server to download from <br>  <b>$ inis</b> - Update branch, more on that below. <br>  <b>$ proto</b> - the version of the recognizer <br>  <b>$ xx</b> - Bit rate for download ("x32", "x64"), you can specify only one <br>  <b>$ cispacked</b> - Downloading packaged (* .7z) updates or not.  Possible values: $ true or $ false <br>  <b>$ avpacked</b> - Download packaged (* .cav.z) databases.  Possible values: $ true or $ false <br>  <b>$ release_notes</b> - Downloading Release Notes.  Possible values: $ true or $ false. <br><br>  Regarding the program's update branches: up to version 8.2.0.4508 inclusive, inis_4010 is used, then any existing above, for example 4080. That is, if you need to update clients of versions 8 and below, then you need to deflate inis_4010 ($ inis = "4010", $ proto = "6") and current ($ inis = "4080", $ proto = "10").  Thus, I managed to upgrade from v6 to the current v10 with two reboots without any problems. <br><br>  To facilitate administration, the script has 3 startup parameters: <br><br>  <b>cis</b> - download program updates <br>  <b>av</b> - database download <br>  <b>av-clean</b> - removal of obsolete databases <br>  It remains only to add tasks with a specified frequency in the Task Scheduler. <br><br><div class="spoiler">  <b class="spoiler_title">Add example</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/60a/bc7/90b/60abc790bf58426ab529f744b9cd13cf.png"><br><img src="https://habrastorage.org/web/19f/679/57e/19f67957e0c94fbdb7f619ae83836198.png"><br><img src="https://habrastorage.org/web/4be/fb4/b4c/4befb4b4c14645469f2add64f8edc5a6.png"><br></div></div><br><h3>  3) Configure IIS </h3><br>  In this example, the Default Web Site, created automatically, will be used. <br>  For debugging, I recommend enabling the "Browse Directory".  To do this, select the desired site, go to the "Browse Directory" menu and click "Enable" on the right side. <br><br>  To download updates correctly, you need to configure MIME Types: in the corresponding menu item, add file extensions and assign <i>application / octet-stream</i> type to them. <br><br><div class="spoiler">  <b class="spoiler_title">MIME Types for Packaged Updates</b> <div class="spoiler_text">  .ini <br>  .7z <br></div></div><br><div class="spoiler">  <b class="spoiler_title">MIME types for unpacked updates</b> <div class="spoiler_text">  .xml <br>  .ini <br>  .dat <br>  .lang <br>  .set <br>  .theme <br>  .sys <br>  .cav <br></div></div><br><h3>  4) Rewrite module </h3><br>  Installing the URL Rewrite 2.1 module is trivial.  This module is required to redirect to the desired inis_ branch. <br>  After installation, you must re-open IIS Manager, otherwise the corresponding menu item will not be visible.  To configure, go to the ‚ÄúURL Redefinition‚Äù item and add an empty rule for incoming traffic with the following content: <br><br>  <b>Name:</b> arbitrary <br>  <b>Template:</b> <br>  (cis / download / updates / release / inis) _ [0-9] * / (. *) <br>  <b>Override URL:</b> <br>  {R: 1} _4080 / {R: 2} <br><br>  In the last address, specify those numbers that are specified in the script in the <b>$ inis</b> variable. <br><br><div class="spoiler">  <b class="spoiler_title">Self-Test Image</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/e40/097/92b/e4009792b17647a0956f1535d7ce2f8f.png"><br></div></div><br>  If you need to update outdated versions, you need to create another rule above. <br><br>  <b>Name:</b> arbitrary <br>  <b>Template:</b> <br>  (cis / download / updates / release / inis) _ [0-9] * / (. *) <br>  <b>Conditions (match with any of the elements):</b> <br>  {REQUEST_URI},. * / Inis_40 [0-1] 0 /.* and {REQUEST_URI},. * / Inis_ [1-3] [0-9] * /. * <br>  <b>Override URL:</b> <br>  {R: 1} _4010 / {R: 2} <br>  <b>Stop processing subsequent rules</b> <br><br><div class="spoiler">  <b class="spoiler_title">Self-Test Image</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/3bd/1e2/570/3bd1e2570e6448bfa3e089f925cc54b9.png"><br></div></div><br>  This completes the server side setup. <br><br><h3>  5) Setting up clients on a local server </h3><br>  The easiest way to do this manually or through the registry.  In the registry, the list of update servers is located at <i>HKEY_LOCAL_MACHINE \ SOFTWARE \ COMODO \ CIS \ Options</i> in the <i>UpdateURL</i> parameter. <br>  For example, this option looks like when setting up the av.local server and disabling the default server: <i><a href="http://av.local/">av.local</a> ! Https: //download.comodo.com/</i> <br><br>  As a result, you get a local Comodo update server and significantly reduce the load on the external channel. </div><p>Source: <a href="https://habr.com/ru/post/333420/">https://habr.com/ru/post/333420/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../333406/index.html">How Angry Birds 2 increased revenue several times over the year</a></li>
<li><a href="../333410/index.html">Developing wrapper scripts using the Sparrow tool</a></li>
<li><a href="../333412/index.html">Creating a schedule for SCADA systems based on cron</a></li>
<li><a href="../333414/index.html">The road to C ++ 20</a></li>
<li><a href="../333418/index.html">We pump over NES Classic Mini - continuation</a></li>
<li><a href="../333422/index.html">Unity on Linux? No problem</a></li>
<li><a href="../333424/index.html">Creating a directory of address information with blackjack and API</a></li>
<li><a href="../333426/index.html">Exact calculation of averages and covariances by the Welford method</a></li>
<li><a href="../333428/index.html">Is it possible to leave Klintsy? (data mining of blablacar.ru)</a></li>
<li><a href="../333432/index.html">Atlassian certification: how to get a crust from Atlassian that you're cool</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>