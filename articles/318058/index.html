<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Convert data presentation form using Excel + PowerQuery</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In our managerial work there is a lot of good and not so much. But nothing spoils our life as many echelki, in which we constantly need something to d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Convert data presentation form using Excel + PowerQuery</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/7be/aff/213/7beaff213a354631a32a6c6dc8f47e3e.jpg"></div><br>  In our managerial work there is a lot of good and not so much.  But nothing spoils our life as many echelki, in which we constantly need something to do, to sum up, to sum up, and to do other routine operations, which take a lot of time and effort.  There is a tool that allows, if not to remove, then minimize the routine wherever there are data patterns.  So, your attention is invited to a little deeper immersion in the principles of PowerQuery. <br><a name="habracut"></a><br>  Immediately I want to give guidance about what is already on Habr√© on this topic: <br><br><ul><li>  <a href="https://habrahabr.ru/post/271019/">https://habrahabr.ru/post/271019/</a> - An excellent overview of the PowerQuery features for beginners.  Gives an idea of ‚Äã‚Äãthe tool with examples.  If you have never used PowerQuery, then you should probably start with this article.  The author will bring up to date. <br><br></li><li>  <a href="https://habrahabr.ru/post/311600/">https://habrahabr.ru/post/311600/</a> - Immersion in the function of the language "M" on the example of localization of the list of months.  The author briefly touched upon the powerful function List.Accumulate, the description of which deserves a separate material on Habr√©.  As a teaser for such a publication, I can say that List.Accumulate accepts absolutely any type of argument as input. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </li><li>  <a href="https://habrahabr.ru/post/274615/">https://habrahabr.ru/post/274615/</a> - A brief overview of PowerQuery‚Äôs ability to retrieve data from SQL databases.  For newbies </li></ul><br><br><h2>  What is Power Query (PQ) </h2><br>  In order not to repeat what has already been said in the materials referenced above, I will be brief: Power Query is a tool for transforming the presentation form of any logically organized data.  That is, any porridge can be at the entrance, but in which there is at least some logic.  And at the exit - the table.  According to <a href="https://solutiondesign.com/blog/-/blogs/power-query-an-etl-heavyweight-for-self-service-1">some experts</a> , PQ is an ETL tool.  That is, it serves for Extract - Extract, Transform - Transform and Load - Data Upload.  By experience, this work takes up to 60% of the working time, for example, a contextual advertising manager and up to 90% of the analyst time.  An important feature of this work is that, as a rule, it must be repeated from day to day, week by week.  Infinitely transfer data, copy-paste, calculate.  For especially difficult cases, programmers write a solution in which all this is done automatically.  The problem is that solutions are expensive, and programmers are almost always busy with more pressing issues than automating manager‚Äôs routine operations.  PQ solves these difficulties: <br><br><ul><li>  Automatically pull data from almost anywhere </li><li>  Convert data in accordance with a previously created model, without having to repeat the same actions manually again. </li><li>  Present the data in the form (s) that are needed </li></ul><br>  Immediately let's differentiate Power Query and the Power BI tool, which is very similar to it.  So, Power Query is used to convert data, as a rule, into a convenient tabular view with which we work further in Excel.  Power BI is designed to convert data and translate it into a form of graphs and other generalized views (for example, summary tables).  Power BI and Power Query use the same ‚ÄúM‚Äù language for data conversion.  That is, the ‚ÄúM‚Äù language code can be almost literally transferred by copy-paste from PQ to Power BI and back.  Almost, because in PQ there may be specific constructions for accessing the Excel workbook, or named ranges of cells, which, of course, is not applicable to Power BI. <br><br>  To date, Power Query is available only for MS Excel, running under Windows.  Prior to Excel 2013, inclusive, distributed as a <a href="https://www.microsoft.com/ru-ru/download/details.aspx%253Fid%253D39379">plug-in</a> .  Starting with Excel 2016 has become embedded. <br><br>  Methods of data conversion "buttons" are discussed in detail in the articles mentioned above, especially in the first one.  Further, the article will be somewhat complicated for beginners, since we are sorting out the background, and specifically what can be seen when clicking on the Advanced Editor button in the query editor. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/0df/0b0/ff0/0df0b0ff0ea64a1ab89adb7cc768ac60.png"></div><br>  <i>Advanced Editor Button</i> <br><br><h2>  How is the language ¬´M¬ª </h2><br>  It is important to always keep in mind that the let construction ...  in ... is just ‚Äú <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D0%25BD%25D1%2582%25D0%25B0%25D0%25BA%25D1%2581%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D1%2581%25D0%25B0%25D1%2585%25D0%25B0%25D1%2580">syntactic sugar</a> ‚Äù.  let in fact is a record with a set of pairs of the form ‚Äúname = value‚Äù, and in is just a link to some value in this record (and not necessarily the last one).  It's hard.  But let's try to figure it out.  The language "M" has the following types of values: <br><br><ol><li>  <b>Primitive types (Null, Logical, Number, Text, Date, Time, DateTime, DateTimeZone, Duration):</b> ‚Äústring‚Äù, 14, false, #date (2013,3,8), etc. </li><li>  <b>List (List)</b> - a sequence of values: Source = {1,2,3, "hi"} </li><li>  <b>Record</b> - a pair (or set of pairs) of the form: [a = 1, b = {1,2,3}, c = true] </li><li>  <b>Table (Table)</b> is a construction that includes a list of columns and a list of records: #table ({"Col1", "Col2"}, {{1, 2}, {3, 4}}) </li><li> <b>Function (Function)</b> - construction of the form: <br><br> <code>MyFunction = (x, y, optional z) =&gt; <br> if z = null then x+y <br> else (x+y) / z <br></code> <br></li><li>  <b>Type (Type)</b> - for classifying other values.  For details on this type, see the <a href="http://download.microsoft.com/download/8/1/A/81A62C9B-04D5-4B6D-B162-D28E4D848552/Power%2520Query%2520Formula%2520Language%2520Specification%2520(August%25202015).pdf">‚ÄúM‚Äù language specification.</a> </li><li>  <b>Binary</b> : #binary ({0x68, 0x65, 0x6C}) </li></ol><br>  Thus, the following construction: <br><br><img src="https://habrastorage.org/files/793/d93/18f/793d9318f6ed419bb23d79c03fcda4e4.png"><br><br>  Absolutely identical to this: <br><br> <code>[X=2,Y=X+3][Y]</code> <br> <br>  Calculations are based on the values ‚Äã‚Äãobtained as a result of previous actions.  Something like this Excel formula chain: <br><br> <code>A1=A2+A3 <br> A2=A3+2 <br> A3=5 <br></code> <br>  In the case of PQ, the reference is not to cells, but to values.  Expressions that are included in the record or list are calculated by the method of "lazy" calculations.  That is, until we directly refer to the value resulting from the execution of some expression, it will not be executed. <br><br><h2>  Short sections </h2><br>  PQ uses the concept of sections.  Section - creates a scope.  This is something like the $ scope in Angular.  There is an internal #sections variable that returns all available sections.  All actions that are performed in the document belong to one single section: Section1.  It is not possible to create another section, for example, Section2.  However, we can refer to the elements of other sections using the #shared variable.  This variable addresses the record containing all the elements that we can see: created by us, as well as the types, constants, and functions available to us.  Thus, we do not need to crawl into the ‚ÄúM‚Äù language guide every time in order to recall the name of one or another function.  Just access the #shared variable.  When clicking on an empty field around the name of each function, we can see its description at the bottom of the screen. <br><br> <a href=""><img src="https://habrastorage.org/files/af0/0ec/d6a/af00ecd6a0254bdbacb7da60317eb509.png"></a> <br>  <i>The value of the #shared variable.</i>  <i>You can see the quick reference on the built-in function.</i> <br><br>  In conclusion, I would like to remind you that any, even the most complex constructions of the language ‚ÄúM‚Äù are inherently composed of the types indicated above.  In the overwhelming majority of cases, these are records and lists, plus some built-in functions for conversions.  To make it easier to navigate the variety of available functionality, here are some useful links that I use regularly. <br><br><h2>  useful links </h2><br><ul><li>  <a href="http://download.microsoft.com/download/8/1/A/81A62C9B-04D5-4B6D-B162-D28E4D848552/Power%2520Query%2520Formula%2520Language%2520Specification%2520%2528August%25202015%2529.pdf">Power Query Formula Language Specification (August 2015) .pdf</a> </li><li>  <a href="https://msdn.microsoft.com/en-us/library/mt211003.aspx">Power Query (informally known as "M") Formula reference</a> </li><li>  <a href="https://www.powerquery.training/">Power Query Training</a> is a resource with a bunch of free samples and tricks.  There are both free and paid lessons. </li><li>  <a href="http://exceltables.com/power-query-language-file-for-notepad-plus-plus/">Language file Notepad ++ to highlight the syntax of the language "M"</a> </li><li>  <a href="https://github.com/hohlick/pquery">The repository of Max Zelensky's Power Query guru on Github with a bunch of ready-made functions in the ‚ÄúM‚Äù language</a> - Max developed an algorithm that loads the functions you need to work.  See Readme.md </li></ul></div><p>Source: <a href="https://habr.com/ru/post/318058/">https://habr.com/ru/post/318058/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318048/index.html">The story of my startup: 500,000 users in 5 days on a hundred dollar server</a></li>
<li><a href="../318050/index.html">Vulnerability in Nagios monitoring system allows privilege escalation</a></li>
<li><a href="../318052/index.html">"Corporate" backup for nothing (on the network of home media players)</a></li>
<li><a href="../318054/index.html">RFC prototype HTTP status codes for developer errors (range 7XX)</a></li>
<li><a href="../318056/index.html">We calculate content that will become viral in the future.</a></li>
<li><a href="../318060/index.html">Google has introduced a test suite Wycheproof</a></li>
<li><a href="../318066/index.html">Multi-Tale of Lost Time</a></li>
<li><a href="../318068/index.html">10 things that must be done after registration Ltd.</a></li>
<li><a href="../318070/index.html">The enemy is inside: we invite hackers and speakers on PHDays VII</a></li>
<li><a href="../318072/index.html">Publishing Desktop Applications in Windows Store using Desktop Application Converter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>