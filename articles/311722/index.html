<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>All about Cisco FastLocation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The further I dive into the topic of Wi-Fi positioning, the more obvious the fact that the main task is not to achieve the necessary accuracy, but to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>All about Cisco FastLocation</h1><div class="post__text post__text-html js-mediator-article">  The further I dive into the topic of Wi-Fi positioning, the more obvious the fact that the main task is not to achieve the necessary accuracy, but to obtain the required number of measurements!  Why do I think so? <br><br>  The requirements for the density of access points are increasing every year, which has a positive effect on positioning accuracy, but the frequency of measurements on the Probe Request does not become higher, rather the opposite. <br><br>  In this regard, many manufacturers have developed their own tools to increase the frequency of measurements.  Traditionally, one of the innovators in this area is Cisco, which launched a tool called Cisco FastLocation. <br>  Let's try to understand all the nuances of this tool. <br><a name="habracut"></a><br><h1>  FastLocate = Data RSSI </h1><br>  For a start, what is meant by the marketing words of Cisco FastLocate?  In short, this is the signal level measurement (RSSI) not by the management of the Probe Request packages, but by the data packages (data).  This metering mode is called ‚ÄúData RSSI‚Äù (in addition to ‚ÄúProbe RSSI‚Äù).  Later in the article, I will use both terms depending on the context. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  FastLocate Release 8.0 vs FastLocate Release 10.2 </h1><br>  Cisco FastLocation technology appeared in 2014, when Cisco's positioning system began to evolve strongly. <br><br>  At that time, it had a rather limited functionality, it was supported only on specially installed monitoring modules WSM (Wireless Security Module), which were installed in modular, that is, top-end office access points.  This was the so-called <a href="http://www.cisco.com/c/en/us/td/docs/wireless/controller/technotes/8-0/CMX_FastLocate_DG/b_CMX-FastLocate-DG.html">FastLocate MSE Release 8.0</a> . <br><br>  We will not consider this technology, as a new, completely revised version of <a href="http://www.cisco.com/c/en/us/td/docs/wireless/mse/release/notes/cmx_10_2_rn.html">FastLocate CMX Release 10.2 is</a> now relevant. <br><br>  We will be testing it using the Cisco WLC 2504 controller with software version 8.1.131.20 and Cisco Aironet 3602 series points. <br><br><h1>  FastLocate without additional modules </h1><br>  The first question that came to my mind was: is it possible to do Data RSSI without using additional modules?  In the arsenal of Cisco, it is already possible to transfer the access point to the monitoring (scanning) mode of all channels, there is a hybrid mode of operation, when the point serves both users and scans adjacent channels.  Can we use these modes for Data RSSI? <br><br><h2>  FastLocate in ELM hybrid mode </h2><br>  If this was not possible in the 8th version of CMX, then by the 10th version of CMX this option appeared.  Cisco access points have a special Enhanced Local Mode (ELM) mode, in which, in addition to customer service, the access point performs the so-called Off-Channel Scanning, that is, it scans adjacent channels.  This is not happening without loss of performance, which is about 15%. <br><br><h3>  Off-Channel Scanning with FastLocate turned off </h3><br>  Off-Channel Scanning occurs in a very unhurried manner and was originally designed to detect foreign access points on adjacent channels.  How it works you can see <a href="http://www.cisco.com/c/en/us/support/docs/wireless/4400-series-wireless-lan-controllers/112045-handling-rogue-cuwn-00.html">here</a> and <a href="http://www.cisco.com/c/en/us/support/docs/wireless/aironet-3600-series/115612-Aironet-Access-Point-Module-for-WSSI-Guide-00.html">here</a> . <br><br>  For example, the default in the 2.4 GHz band is configured to scan all channels and a full scan interval of 180s.  In this mode, the access point every 180/13 = 14 seconds is interrupted by 50ms for scanning the adjacent channel (10ms is also spent on switching to each side).  The picture looks like this: <br><img src="https://habrastorage.org/files/589/0ae/9c0/5890ae9c0a7b486ea65e64ab1653b2bf.png" alt="image"><br>  The operation of this algorithm can be checked directly on the access point using the command <b>debug dot11 do0 trace print channel</b> <br><br><pre><code class="bash hljs">Hyperlocation_2<span class="hljs-comment"><span class="hljs-comment">#debug dot11 do0 trace print channel Oct 4 10:09:37.909: CC0CDA4C-0 Channel 8 (2447) promiscuous 20MHz Oct 4 10:09:37.957: CC0D772F-0 Channel 11 (2462) 20MHz Oct 4 10:09:50.753: CCD0DEF8-0 Channel 9 (2452) promiscuous 20MHz Oct 4 10:09:50.801: CCD17BD3-0 Channel 11 (2462) 20MHz Oct 4 10:09:53.955: CD948399-0 Channel 10 (2457) promiscuous 20MHz Oct 4 10:09:53.999: CD951CFD-0 Channel 11 (2462) 20MHz Oct 4 10:10:06.763: CE57FEC4-0 Channel 11 (2462) promiscuous 20MHz Oct 4 10:10:06.811: CE589BA7-0 Channel 11 (2462) 20MHz</span></span></code> </pre> <br>  From this conclusion, you can see that the scan frequency is about 13 seconds, which converges with the documentation.  The use of Data RSSI in this mode would not be very effective (looking ahead to say that it is not used). <br><br><h3>  Off-Channel Scanning with FastLocate Enabled </h3><br>  If FastLocate is enabled on the wireless controller, Off-Channel Scanning starts to work a little differently. <br><br><pre> <code class="bash hljs">Hyperlocation_2<span class="hljs-comment"><span class="hljs-comment">#debug dot11 do0 trace print channel Oct 4 10:05:40.887: BDEC139E-0 Channel 12 (2467) promiscuous 20MHz Oct 4 10:05:40.967: BDED365C-0 Channel 11 (2462) 20MHz Oct 4 10:05:43.691: BE16D8E7-0 Channel 13 (2472) promiscuous 20MHz Oct 4 10:05:43.771: BE17FBC2-0 Channel 11 (2462) 20MHz Oct 4 10:05:46.775: BE45D2A0-0 Channel 11 (2462) 20MHz Oct 4 10:05:46.983: BE4919C1-0 Channel 14 (2484) promiscuous listen_only 20MHz Oct 4 10:05:47.063: BE4A3D27-0 Channel 11 (2462) 20MHz Oct 4 10:05:49.795: BE7407C6-0 Channel 1 (2412) promiscuous 20MHz Oct 4 10:05:49.879: BE75291D-0 Channel 11 (2462) 20MHz</span></span></code> </pre><br>  The time intervals are reduced to three seconds.  I did not find technical documentation on how Off-Channel Scanning works with activated FastLocate, but based on the above output, we can conclude that the scanning time is also about 50 ms (967-887 = 80 ms, it is 50-60 ms scan + 10 ms to switch between channels). <br><br>  Obviously, a decrease in time intervals was made to improve the operation of the FastLocation mechanism. <br><br><h3>  Off-Channel Scanning dependence on wIPS operation mode </h3><br>  The access point can work with local or centralized wIPS (intrusion detection and prevention system), which is regulated by the setting on the access point.  Testing Off-Channel Scanning in different wIPS operation modes, I didn‚Äôt see any differences. <br><br><h2>  FastLocate in Monitor Mode </h2><br>  Even before the advent of FastLocate technology, access points were able to work in Monitor mode AP.  This mode was used for centralized intrusion detection system.  When switching to this mode, both radio modules no longer serve clients and sequentially scan channels with a duration of 1.2 seconds. <br><br><img src="https://habrastorage.org/files/f02/30d/5a8/f0230d5a84f04b8a928b2d37abf30cd5.png" alt="image"><br>  This algorithm is confirmed by the output from the access point: <br><br><pre> <code class="bash hljs">pod1-1140<span class="hljs-comment"><span class="hljs-comment">#debug dot11 do0 trace print channel *Oct 4 10:51:22.031: 1FB01CC6-0 Channel 12 (2467) promiscuous 20MHz *Oct 4 10:51:23.246: 1FC2A970-0 Channel 13 (2472) promiscuous 20MHz *Oct 4 10:51:24.458: 1FD5283F-0 Channel 14 (2484) promiscuous listen_only 20MHz *Oct 4 10:51:25.670: 1FE7A716-0 Channel 1 (2412) promiscuous 20MHz</span></span></code> </pre> <br>  In the case of Monitor mode AP, the operation algorithm did not change when FastLocate was turned on / off. <br><br><h3>  FastLocate works only for connected clients. </h3><br>  When using the Monitor mode, there is a nuance: FastLocate works only for clients connected to the infrastructure, and when the access point is switched to Monitor mode, the point ceases to serve the clients.  That is, it is assumed that the infrastructure will include other access points serving clients. <br><br>  Access points in the Monitor mode are proposed to be placed in a ratio of 1: 5 to the usual access points. <br><br><h2>  FastLocate using the WSM add-on </h2><br>  This is the main mode of operation for FastLocate, which provides for installing <a href="http://www.cisco.com/c/en/us/td/docs/wireless/technology/wips/deployment/guide/WiPS_deployment_guide.html">2: 5</a> aspect ratio modules into WSM access points (that is, at least 2: 5 access points must be modular, that is, the top ones). <br><br>  WSM has its own work algorithm.  The WSM module, unlike the radio in the monitoring mode, scans the channel not for 1.2 seconds, but for 250 ms.  But he does not do this consistently, but in accordance with certain rules: <br><br><pre> <code class="bash hljs">&lt;L1, L1, L1, L1, L1, CA, L2&gt; It will scan 5 slots of L1(serving channel of the APs) followed by a cleanAir slot (<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> enabled), followed by one slot of L2 (channels <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the country/DCA list). If there are less than 5 channels <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the L1 list, the same channels will be scanned repeatedly till the 5 L1 slots are filled up.</code> </pre><br>  It can be said that high priority is given to infrastructure channels (on which their access points operate), which is understandable, because FastLocation only works for connected clients and scanning adjacent channels is not so important. <br><br>  What this algorithm looks like when outputting to an access point: <br><br><pre> <code class="bash hljs">Sep 20 16:24:17.824: 2EC10B2D-2 Channel 1 (2412) promiscuous 20MHz Sep 20 16:24:17.903: 2EC24019-2 Channel 48 (5240) promiscuous 20MHz Sep 20 16:24:18.151: 2EC60A5D-2 Channel 6 (2437) promiscuous 20MHz Sep 20 16:24:18.383: 2EC99BD3-2 Channel 11 (2462) promiscuous 20MHz Sep 20 16:24:18.627: 2ECD54AC-2 Channel 1 (2412) promiscuous 20MHz Sep 20 16:24:18.895: 2ED16A1E-2 Channel 161 (5805) promiscuous 20MHz Sep 20 16:24:19.435: 2ED99B31-2 Channel 6 (2437) promiscuous 20MHz Sep 20 16:24:19.555: 2EDB7010-2 Channel 60 (5300) promiscuous 20MHz Sep 20 16:24:19.807: 2EDF53C5-2 Channel 48 (5240) promiscuous 20MHz Sep 20 16:24:20.046: 2EE2EF52-2 Channel 6 (2437) promiscuous 20MHz Sep 20 16:24:20.282: 2EE695CB-2 Channel 11 (2462) promiscuous 20MHz Sep 20 16:24:20.514: 2EEA16E6-2 Channel 1 (2412) promiscuous 20MHz Sep 20 16:24:21.010: 2EF1B48A-2 Channel 11 (2462) promiscuous 20MHz Sep 20 16:24:21.166: 2EF40C9B-2 Channel 161 (5805) promiscuous 20MHz Sep 20 16:24:21.454: 2EF86DA9-2 Channel 60 (5300) promiscuous 20MHz Sep 20 16:24:21.710: 2EFC5A8F-2 Channel 48 (5240) promiscuous 20MHz Sep 20 16:24:21.929: 2EFFBC42-2 Channel 6 (2437) promiscuous 20MHz Sep 20 16:24:22.161: 2F033F09-2 Channel 11 (2462) promiscuous 20MHz Sep 20 16:24:22.645: 2F0AA07D-2 Channel 36 (5180) promiscuous 20MHz Sep 20 16:24:22.785: 2F0CCDC0-2 Channel 1 (2412) promiscuous 20MHz Sep 20 16:24:23.061: 2F10F3CB-2 Channel 161 (5805) promiscuous 20MHz Sep 20 16:24:23.337: 2F1539E8-2 Channel 60 (5300) promiscuous 20MHz Sep 20 16:24:23.593: 2F192133-2 Channel 48 (5240) promiscuous 20MHz Sep 20 16:24:23.813: 2F1C798A-2 Channel 6 (2437) promiscuous 20MHz Sep 20 16:24:24.297: 2F23E056-2 Channel 48 (5240) promiscuous 20MHz Sep 20 16:24:24.433: 2F25EE6C-2 Channel 11 (2462) promiscuous 20MHz Sep 20 16:24:24.673: 2F299DFA-2 Channel 1 (2412) promiscuous 20MHz Sep 20 16:24:24.937: 2F2D9ABB-2 Channel 161 (5805) promiscuous 20MHz Sep 20 16:24:25.221: 2F31F49A-2 Channel 60 (5300) promiscuous 20MHz Sep 20 16:24:25.473: 2F35CF9A-2 Channel 48 (5240) promiscuous 20MHz Sep 20 16:24:25.977: 2F3D7AA1-2 Channel 40 (5200) promiscuous 20MHz Sep 20 16:24:26.097: 2F3F532D-2 Channel 6 (2437) promiscuous 20MHz Sep 20 16:24:26.329: 2F42D521-2 Channel 11 (2462) promiscuous 20MHz</code> </pre><br>  The scan interval is not as smooth as in other modes, and is within 50-250ms. <br><br>  And indeed, non-infrastructure channels (in my case, these are channels 36, 40) were rarely managed, with a frequency of more than 3 seconds, which can also be seen in the logs. <br><br><h1>  Evaluation frequency measurement </h1><br>  When activating the FastLocation mode, the frequency of measurements directly depended on the client's activity.  If the client (smartphone, phone, laptop) was in sleep mode, that is, the Wi-Fi adapter was not used actively, the frequency of measurements was comparable to the Probe RSSI method.  If the device is actively used Wi-Fi adapter, the frequency of measurements has increased dramatically. <br><br>  I did not test all possible Cisco FastLocation operation schemes, since there are so many factors that affect the frequency of measurements, both from the infrastructure and from the client, so the tests were conducted only in WSM mode. <br><br>  Three types of devices were used: a smartphone, a tablet and a laptop.  For all tested devices, the interval between measurements was comparable and was about 2-6 seconds with active use of the Wi-Fi adapter. <br><br><h1>  General conclusions </h1><br>  <strong>1.</strong> FastLocate (Data RSSI) compared to Probe RSSI in general for personal devices allows to significantly increase the frequency of measurements, especially when using a Wi-Fi module. <br><br>  <strong>2.</strong> But if the client device is in sleep mode and does not use a Wi-Fi adapter, the measurement frequency drops to the standard with Probe RSSI. <br><br>  <strong>3.</strong> It is very difficult to talk about a specific value of the frequency of measurements in the case of using Wi-Fi positioning for personal devices.  There are many factors, from both the infrastructure and the client, affecting this characteristic.  To obtain specific values, I believe, it is necessary to act by analogy with the radio survey, that is, to carry out field tests of the entire system and with the required client devices. </div><p>Source: <a href="https://habr.com/ru/post/311722/">https://habr.com/ru/post/311722/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../311708/index.html">How DLCs can increase the number of players: an example of Street Fighter V</a></li>
<li><a href="../311714/index.html">Installing OTRS 5 on a server with Nginx</a></li>
<li><a href="../311716/index.html">RetroBase - an analogue of Retrofit for database queries</a></li>
<li><a href="../311718/index.html">How much does it cost to enter the top cash categories of the app store and is there any point?</a></li>
<li><a href="../311720/index.html">WordCamp Europe in Vienna and the WordPress Development Vector</a></li>
<li><a href="../311726/index.html">libsodium: Public-key authenticated encryption or how I decrypted the message without the private key</a></li>
<li><a href="../311728/index.html">Proof of Fermat's Big Theorem for a cube, as a key</a></li>
<li><a href="../311730/index.html">OpenGL ES 2.0. Deferred lighting</a></li>
<li><a href="../311732/index.html">Docker in production: ‚ÄúWhen you eat it, you are at least not disgusted, especially if you know how to cook‚Äù</a></li>
<li><a href="../311734/index.html">Implementation of alpha testing and alpha lab in projects</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>