<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What hash-set is for</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The hash-set data structure (and set in general) is such a rare structure that it is not present in all standard libraries. In the .NET Framework, for...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What hash-set is for</h1><div class="post__text post__text-html js-mediator-article">  The hash-set data structure (and set in general) is such a rare structure that it is not present in all standard libraries.  In the .NET Framework, for example, it appeared only from version 3.5.  However, in some cases a hash-set can be quite useful. <br><br>  In this article I will show when it makes sense to use a hash-set and what you will have to pay for. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      First, what set is.  This is such a collection, elements of which are disordered and unique (that is, they are present in the collection no more than once).  Set supports basic operations: <br><br><ul><li>  Add item. </li><li>  Delete item. </li><li>  Check if item exists. </li><li>  Enumerate all items. </li></ul><br><br>  Implementations of set differ only in the data structure used for the search ‚Äî it can be an array, a list, a tree, a hash table, or whatever.  In practice, a hash table is most often used, since it gives maximum performance with acceptable overhead. <br><br>  Now consider an example.  Suppose we need to implement the grouping of a large number of elements according to the equality of the list of tags, and ignore list is defined for tags - that is, tags that should not participate in the comparison.  Tags, in this case, are short strings (mostly words).  Suppose also that ignore list contains about 100 tags. <br><br>  On Ruby, the algorithm is as follows: <br><br><pre><code class="ruby hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">group_elements</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(elements, ignore_list)</span></span></span></span> groups = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> element <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> elements assigned = <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> group <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> groups <span class="hljs-comment"><span class="hljs-comment">#   ,     true; #  ,  false. if group.accept(element, ignore_list) assigned = true break end end #      , #     . if !assigned groups &lt;&lt; Group.new(element) end end return groups end</span></span></code> </pre> <br><br>  Here is how the Group :: accept () method is implemented: <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Group</span></span></span><span class="hljs-class"> ... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">accept</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">element</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ignore_list</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">my_element</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">in</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">elements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">if</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">my_element</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">match</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">element</span></span></span><span class="hljs-class">) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">elements</span></span></span><span class="hljs-class"> &lt;&lt; element </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> ... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre><br><br>  And finally, the Element :: match () method: <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Element</span></span></span><span class="hljs-class"> ... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">match</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">element</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ignore_list</span></span></span><span class="hljs-class">) </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#  . my_tags_filtered = </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@tags</span></span></span></span><span class="hljs-class"><span class="hljs-comment">.select { |tag| !ignore_list.include?(tag) } its_tags_filtered = element.tags.select { |tag| !ignore_list.include?(tag) } #  . intersection = my_tags_filtered &amp; its_tags_filtered #        #      . return intersection.length &gt; 0 &amp;&amp; intersection.length == [my_tags_filtered.length, its_tags_filtered.length].max end ... end</span></span></span></span></code> </pre><br><br>  Here, the implementation is shown in the forehead, where both the tag lists themselves and ignore list are normal dynamic arrays.  That is, the operation ignore_list.include?  has linear complexity.  In addition, we recall that tags are strings with an average length of 5-10 characters, and the comparison of strings itself has linear complexity.  Considering that grouping has O (n <sup>2</sup> ) complexity, optimization of basic comparison operations can give a significant performance boost. <br><br>  The hash-set helps to make the implementation more optimal.  If we implement ignore list with it, we will get two serious advantages.  First, we will get rid of the linear search in the list, replacing it with the search for a hash-key;  secondly, we get rid of string comparisons.  There is a true one nuance - in Ruby there is no hash-set data structure.  However, this is not a problem, because a hash-set can replace a regular hash table in which elements are used as keys (you can use any type as small as possible as values).  This strange technique applies, for example, in NHibernate, and works well if there is no better. <br><br>  I compared two implementations of the above Ruby algorithm with the number of elements in the order of 2000-3000, the tag size of 2-15 UTF-8 characters and the number of tags per element, on average, 5. Replacing the hash-set array produced a performance gain of about 10 time. <br><br>  In general, hash-sets allow for more optimal implementation of operations on sets - intersection, union and subtraction.  However, do not forget about their redundancy.  Hash-sets reserve significantly more memory than they need to store their elements, so it makes sense to use them only for medium-sized sets (100-10000 elements).  In fact, you spend memory to get faster calculations.  For large sets, trees should be used. </div><p>Source: <a href="https://habr.com/ru/post/126169/">https://habr.com/ru/post/126169/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../126162/index.html">Facebook kept all the numbers from users' mobile phones.</a></li>
<li><a href="../126163/index.html">Web Ready and Aalto Venture Garage in Siberia</a></li>
<li><a href="../126164/index.html">Russian Orthodox alternatives to backward Skype</a></li>
<li><a href="../126166/index.html">Determining positions for pros</a></li>
<li><a href="../126167/index.html">The first photos of Ice Cream Sandwich</a></li>
<li><a href="../126170/index.html">Why shy of Google?</a></li>
<li><a href="../126171/index.html">Games appeared on Google+</a></li>
<li><a href="../126172/index.html">New computer "rat" from Mad Catz</a></li>
<li><a href="../126173/index.html">An expert on network security from Germany created a system for intercepting and decrypting GPRS traffic</a></li>
<li><a href="../126175/index.html">ERP? First, a holistic understanding of the business system</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>