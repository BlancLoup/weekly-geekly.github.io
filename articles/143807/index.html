<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We read passport data of students, schoolchildren and pensioners from their pocket.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Thanks to the government of Moscow and personally to comrade Gaev 

 Introduction 
 As you know, all students, pensioners and schoolchildren in Moscow...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We read passport data of students, schoolchildren and pensioners from their pocket.</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/047/463/83d/04746383d209ba74fda8366827fdffe9.jpg"><br><br>  Thanks to the government of Moscow and personally <a title="gaev" href="http://www.soccard.ru/project/constructor/">to comrade Gaev</a> <br><a name="habracut"></a><br><h2>  Introduction </h2><br>  As you know, all students, pensioners and schoolchildren in Moscow are issued a Muscovite social card (SCM), which simultaneously serves as a bank card and a travel card for various types of transport. <br><br>  Technically, the card is a Mifare Classic RFID card in one of two versions, 1K or 4K. <br>  The Mifare Classic map is divided into sectors (16 and 40 respectively), access to each of which is provided by key (6 bytes).  The Mifare Classic card implements proprietary encryption and restricts access to sectors independently. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In SCM, sectors <a href="http://www.moscow-portal.info/law1/mix_yv/d_cqhaq/index.htm">are divided</a> between different organizations. <br>  Some sectors (13-14) are open, they are accessed according to the standard key A0 ... A5 defined in the card <a href="http://www.nxp.com/documents/application_note/AN10787.pdf">description</a> . <br><habracut><br>  According to the developers of the system, this standard key can only be known as ‚Äúan organization registered by the MCP State Unitary Enterprise as an acceptor of a social card,‚Äù which, to put it mildly, is not true. <br><br>  However, the open sectors of the card do not contain anything serious: they contain only the name of the cardholder, gender and date of birth and social card number, which naturally has nothing to do with the number of the banking component of the card. <br><br>  The remaining sectors of the map, for example, containing travel cards, are closed and can be accessed only by knowing the corresponding keys. <br><br><h2>  Keys </h2><br>  Starting from 2008, when the proprietary encryption algorithm was restored, you can access the data on the card without keys.  There are at least three types of key attacks: <br><ul><li>  with the interception of information transmitted over the air between the card and the reader, "knowing" the keys </li><li>  using vulnerability of software RNG and encryption algorithm using only the card </li><li>  accelerated modification of the previous method, using only the map and knowledge of the key to at least one sector </li></ul><br><br>  Because  Since SCM has open sectors, the simplest is to use a third attack. <br><br><h2>  Key recovery </h2><br>  This type of attack is carried out, for example, by the <a href="http://code.google.com/p/nfc-tools/">MFOC</a> utility.  To launch an attack, you will need a reader <a href="http://www.libnfc.org/documentation/hardware/compatibility">supported by</a> libnfc, for example <a href="http://www.identive-infrastructure.com/index.php/en/products-solutions/smart-card-readers-a-terminals/contactless-readers/scl3711">SCM SCL3711</a> .  More available in Russia readers ACR122T or ACR122U on the same chip. <br><br>  Recovering keys to all private sectors takes about 5 minutes.  The result of the work will be a complete memory dump of the card, including keys to all sectors.  With this dump, you can then freely read and write dumps. <br><br><h2>  We look inside </h2><br>  Inside is nothing interesting.  Of all the closed sectors information is contained only in the sectors of the metro, electric trains and buses.  You can view this information, but you cannot change it, much less copy it to other cards in accordance with Art.  327 of the Criminal Code. <br><br><h2>  The most interesting </h2><br><br>  It turned out that, starting from recent times, probably from last year, SCM are based on Mifare Classic 4K, and not on 1K, as it was before.  Having restored the keys to such a card and looking at the contents of the new closed sectors (17-40), in the 17th sector you may stumble upon the following: <br><img src="https://habrastorage.org/storage2/65c/8ce/b1d/65c8ceb1d026413bf9f41c9e735fb922.png"><br><br>  Here <br><ul><li>  XX, YY, ZZ - surname, name and patronymic in CP-1251 </li><li>  BB is the date of birth in the format YYYYMMDD, written in numbers in hex, i.e.  2012-05-13 will be encoded as 0x20 0x12 0x05 0x13 </li><li>  NN - social card number, the format is the same. </li><li>  EE - end date (month, two digits of the year), RR - region of issue (0177). </li><li>  ??  - unknown, 0x21 (document type?) </li><li>  PP - Passport Number and Series, ASCII </li><li>  SS - unit code, digits in hex </li><li>  DD - issue date, YYYYMMDD, digits in hex </li><li>  further - issued by whom, CP1251 in large letters, left in the dump </li><li>  byte at the end - 0x8C - is unknown. </li></ul><br><br>  In the dump, personal data is smeared. <br><br>  Those.  in this undocumented sector, the <b>full passport details of the</b> person are recorded!  It should be noted that this information appeared on SCM after 2008, i.e.  when Mifare Classic encryption was already compromised, and on one-time metro tickets and in the trains, strong encryption methods were already used. <br><br><h2>  Why is this dangerous? </h2><br>  Anyone who has $ 30 to buy a reader can restore the keys to SCM.  Let me remind you that these keys are the same for <b>all</b> social cards.  Knowing these keys, an attacker can read data from SCM, lying in your pocket from a distance of several meters, using an external antenna.  The obtained passport data could be used further for criminal purposes, if not for the FZ-152. <br><br><h2>  How to live? </h2><br>  There are two ways to prevent this.  First, it is possible, by restoring the keys, to overwrite this sector, filling it with garbage or passport data of a neighbor. <br><br>  Secondly, you can use the old, proven method: wrap the card with foil and get it if necessary.  You can turn around at the same time foil yourself. </habracut></div><p>Source: <a href="https://habr.com/ru/post/143807/">https://habr.com/ru/post/143807/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../143802/index.html">First experience in developing a distance education portal</a></li>
<li><a href="../143803/index.html">Testing and using a battery for the 1800 mAh HTC Desire S smartphone</a></li>
<li><a href="../143804/index.html">Rules for the development of complex systems. The story of one project</a></li>
<li><a href="../143805/index.html">121 megapixel snapshot of the earth</a></li>
<li><a href="../143806/index.html">Informational anarchy, or how to defeat torrents and legalize copyright</a></li>
<li><a href="../143808/index.html">Linux for ARM in qemu emulator</a></li>
<li><a href="../143809/index.html">QuickBlox: Sample Review and SDK</a></li>
<li><a href="../143810/index.html">Entertaining ten-gigabit</a></li>
<li><a href="../143811/index.html">All the secrets of the ATP Pravo.ru application for tablets</a></li>
<li><a href="../143814/index.html">Encrypt messages for a specified time</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>