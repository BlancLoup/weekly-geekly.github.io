<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Simple ruby ‚Äã‚Äãtests for web</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="To study ruby, an educational project was chosen in which a simple task, writing tests for the web. Due to lack of knowledge and experience, it was de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Simple ruby ‚Äã‚Äãtests for web</h1><div class="post__text post__text-html js-mediator-article">  To study ruby, an educational project was chosen in which a simple task, writing tests for the web.  Due to lack of knowledge and experience, it was decided to use the simplified <a href="http://sinatraruby.ru/">sinatra</a> framework. <a name="habracut"></a>  As a result, there are only two files in my solution to this problem.  The first is mutaAlim.json, in which we have a database in json format. <br><br><h5>  Consider the structure of this file on the example of several questions: </h5><br><pre><code class="ruby hljs">[ { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"question"</span></span> : <span class="hljs-string"><span class="hljs-string">" !"</span></span>, <span class="hljs-string"><span class="hljs-string">"answers"</span></span> : [<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>] }, { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">"question"</span></span> : <span class="hljs-string"><span class="hljs-string">" ?"</span></span>, <span class="hljs-string"><span class="hljs-string">"answers"</span></span> : [<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>] }, ‚Ä¶..(     ) ]</code> </pre> <br><br>  We have this way in json array of hash elements. <br>  The answers in the array are key answers, in which the first answer is correct. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  The second file is mutaAlim.rb in which the application code. </h5><br>  Consider it closer.  The first lines include the gems sinatra and json: <br><br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'sinatra'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'json'</span></span></code> </pre><br><br>  To go to the welcome page the following code <br><br><pre> <code class="ruby hljs">get <span class="hljs-string"><span class="hljs-string">'/'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> erb <span class="hljs-symbol"><span class="hljs-symbol">:index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br><br>  When you go to the <a href="http://localhost:4567/">address</a> , we will have a page that is described in the same file: <br><br><pre> <code class="html hljs xml">@@index <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>  I  hh  h!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>  ,    !<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>     <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>          . <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"test_begin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"location.href='/test'"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Simple page with a button to go to the test page.  Further in the code we have variables necessary for the application to work: <br><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment">#   @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_hash #  @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@kol</span></span></span><span class="hljs-comment">_testov = 13 #      @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_test_number = Array.new(@</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@kol</span></span></span><span class="hljs-comment">_testov) #  , -1         @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_test_answer #    test_file = File.open('mutaAlim.json',"rb") @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_hash = JSON.parse(test_file.read) test_file.close #   @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@not</span></span></span><span class="hljs-comment">_answer = "   " #  @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@answers</span></span></span><span class="hljs-comment"> #   @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@ball</span></span></span><span class="hljs-comment"> #   @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@procent</span></span></span><span class="hljs-comment">_tru_answers #   </span></span></code> </pre><br><br>  As you noticed, I had to declare all variables in the class, otherwise there were errors on the output in erb, which I could not understand and correct.  Further, the main element of the application is the code of the test page: <br><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment">#   get '/test' do if params[:var] == nil @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_test_answer = Array.new(@</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@kol</span></span></span><span class="hljs-comment">_testov) { |i| -1} #      @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_test_number @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_test_number[0] = Random.rand(@</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_hash.length) @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_test_number.each_index do |i| begin flag = true buf = Random.rand(@</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_hash.length) 0..i.times do |j| if @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_test_number[j]==buf flag = false end end if flag @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_test_number[i] = buf end end until flag==true end @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_number = 0; #       @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_random_variants @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_random_variants = Array.new(@</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@kol</span></span></span><span class="hljs-comment">_testov) @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_random_variants.each_index do |i| @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_random_variants[i] = Array.new(@</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_hash[@</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_test_number[i]]["answers"].size) end @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_random_variants.each_index do |i| @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_random_variants[i][0] = Random.rand(@</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_hash[@</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_test_number[i]]["answers"].size) @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_random_variants[i].each_index do |j| begin flag = true buf = Random.rand(@</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_hash[@</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_test_number[i]]["answers"].size) 0..j.times do |k| if @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_random_variants[i][k]==buf flag = false end end if flag @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_random_variants[i][j] = buf end end until flag==true end end else #      @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_test_answer @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_test_answer[@</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_number] = params[:var].to_i #     if @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_number != @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@kol</span></span></span><span class="hljs-comment">_testov - 1 @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_number += 1 end end erb :test end</span></span></code> </pre><br><br>  By the condition <code>params[:var] == nil</code> we determine that the user is on the page for the first time and ‚Äúprepare‚Äù everything necessary (randomly select tests from the database, randomly ‚Äúmix‚Äù response options and create an array to store the answers), otherwise we write the answer chosen by the user in array  The entire functionality of the application is built on get requests, and there is a lot of confusion due to the fact that it was written in the "just to work" mode.  For example, if a user clicks on the link <a href="http://localhost:4567/test%3Fvar%3D0">http: // localhost: 4567 / test? Var = 0,</a> then in the array of answers to the current question, the value will be set to 0. <br><br><h5>  Consider the test page code </h5><br><pre> <code class="html hljs xml">@@test <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>  ‚Ññ<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span><span class="hljs-tag"> @@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">test_number</span></span></span><span class="hljs-tag"> +</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span><span class="hljs-tag"> @@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">test_hash</span></span></span><span class="hljs-tag">[@@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mas_test_number</span></span></span><span class="hljs-tag">[@@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">test_number</span></span></span><span class="hljs-tag">]]["</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">question</span></span></span><span class="hljs-tag">"] %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"get"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/test"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%</span></span></span><span class="hljs-tag"> @@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">test_hash</span></span></span><span class="hljs-tag">[@@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mas_test_number</span></span></span><span class="hljs-tag">[@@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">test_number</span></span></span><span class="hljs-tag">]]["</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">answers</span></span></span><span class="hljs-tag">"]</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">.each_index</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">do</span></span></span><span class="hljs-tag"> |</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span><span class="hljs-tag">| %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"radio"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"var"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"&lt;%= @@mas_random_variants[@@test_number][i] %&gt;"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span><span class="hljs-tag"> @@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">test_hash</span></span></span><span class="hljs-tag">[@@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mas_test_number</span></span></span><span class="hljs-tag">[@@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">test_number</span></span></span><span class="hljs-tag">]]["</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">answers</span></span></span><span class="hljs-tag">"][@@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mas_random_variants</span></span></span><span class="hljs-tag">[@@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">test_number</span></span></span><span class="hljs-tag">][</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span><span class="hljs-tag">]] %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">end</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"next_question"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"location.href='/test/pred'"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%</span></span></span><span class="hljs-tag"> @@</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mas_test_number.each_index</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">do</span></span></span><span class="hljs-tag"> |</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span><span class="hljs-tag">| %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'/test/question/&lt;%= i + 1 %&gt;'</span></span></span><span class="hljs-tag">&gt;</span></span> ‚Ññ <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%=</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span><span class="hljs-tag"> + </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">end</span></span></span><span class="hljs-tag"> %&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pred_question"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"location.href='/test/next'"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"result"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"location.href='/test/result'"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  As you have noticed, inserting the code on the page is done with erb as follows <code>&lt;%= #    %&gt;</code> and <code>&lt;%     %&gt;</code> .  On the page itself is a question, answer options (radiobutton), links to all questions.  test navigation buttons and a test completion button that directs the user to the test results page. <br><br><h5>  The operation of the navigation buttons and links to the questions: </h5><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment">#     get '/test/question/:id' do @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_number = params[:id].to_i - 1 erb :test end #   get '/test/next' do if @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_number != @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@kol</span></span></span><span class="hljs-comment">_testov - 1 @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_number += 1 end erb :test end #   get '/test/pred' do if @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_number != 0 @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@test</span></span></span><span class="hljs-comment">_number -= 1 end erb :test end</span></span></code> </pre><br><br><h5>  It remains to analyze the code of the test results page that calculates the results. </h5><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment">#   get '/test/result' do @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@ball</span></span></span><span class="hljs-comment"> = 0 @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@answers</span></span></span><span class="hljs-comment"> = 0 #   @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@mas</span></span></span><span class="hljs-comment">_test_answer.each do |i| if i == 0 @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@ball</span></span></span><span class="hljs-comment"> += 1 end if i != -1 @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@answers</span></span></span><span class="hljs-comment"> += 1 end end @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@procent</span></span></span><span class="hljs-comment">_tru_answers = (100/@</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@kol</span></span></span><span class="hljs-comment">_testov) * @</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@ball</span></span></span><span class="hljs-comment"> erb :result end</span></span></code> </pre><br><h5>  And the code in html + erb </h5><br><pre> <code class="ruby hljs">@@result &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;&lt;<span class="hljs-regexp"><span class="hljs-regexp">/title&gt; &lt;/head</span></span>&gt; &lt;body&gt; &lt;h1&gt;    &lt;<span class="hljs-regexp"><span class="hljs-regexp">/h1&gt; &lt;div&gt; &lt;table cellspacing="2" border="1" cellpadding="5"&gt; &lt;tr&gt; &lt;td&gt; ‚Ññ &lt;/td</span></span>&gt; &lt;td&gt;  &lt;<span class="hljs-regexp"><span class="hljs-regexp">/td&gt; &lt;td&gt;   &lt;/td</span></span>&gt; &lt;td&gt;   &lt;<span class="hljs-regexp"><span class="hljs-regexp">/td&gt; &lt;tr&gt; &lt;% @@mas_test_answer.each_index do |i| %&gt; &lt;tr&gt; &lt;td&gt; &lt;%= i+1 %&gt; &lt;/td</span></span>&gt; &lt;td&gt; &lt;%= @@test_hash[@@mas_test_number[i]][<span class="hljs-string"><span class="hljs-string">"question"</span></span>] %&gt; &lt;<span class="hljs-regexp"><span class="hljs-regexp">/td&gt; &lt;td&gt; &lt;%= if (@@mas_test_answer[i] == -1) @@not_answer else @@test_hash[@@mas_test_number[i]]["answers"][@@mas_test_answer[i]] end %&gt; &lt;/td</span></span>&gt; &lt;td&gt; &lt;%= @@test_hash[@@mas_test_number[i]][<span class="hljs-string"><span class="hljs-string">"answers"</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>] %&gt; &lt;<span class="hljs-regexp"><span class="hljs-regexp">/td&gt; &lt;tr&gt; &lt;% end %&gt; &lt;/table</span></span>&gt; &lt;<span class="hljs-regexp"><span class="hljs-regexp">/div&gt; &lt;div&gt; &lt;h3&gt;   = &lt;%= @@kol_testov %&gt; &lt;/h</span></span>3&gt; &lt;h3&gt;   = &lt;%= @@answers %&gt; &lt;<span class="hljs-regexp"><span class="hljs-regexp">/h3&gt; &lt;h3&gt;    = &lt;%= @@ball %&gt; &lt;/h</span></span>3&gt; &lt;h3&gt;    = &lt;%= @@procent_tru_answers %&gt; <span class="hljs-string"><span class="hljs-string">%&lt;/h3&gt;</span></span> &lt;div&gt; &lt;div&gt; &lt;p&gt;          . &lt;<span class="hljs-regexp"><span class="hljs-regexp">/p&gt; &lt;/div</span></span>&gt; &lt;input value=<span class="hljs-string"><span class="hljs-string">" "</span></span> name=<span class="hljs-string"><span class="hljs-string">"test_begin"</span></span> onclick=<span class="hljs-string"><span class="hljs-string">"location.href='/test'"</span></span> type=<span class="hljs-string"><span class="hljs-string">"button"</span></span>&gt; &lt;<span class="hljs-regexp"><span class="hljs-regexp">/body&gt; &lt;/html</span></span>&gt;</code> </pre><br><br>  I understand that this application is easier to write from scratch and correctly, rather than understand or accompany it.  I started to learn ruby ‚Äã‚Äãlanguage on this application exactly as a sinatra engine, erb markup language and json format, so please do not judge strictly for what I used and how. <br>  In the future, it is planned to transfer from sinatra to ror, from json to a full database, from erb to haml, from single-type questions (radiobutton) to questions 5-6 types, from tests to the game and plus design with layout. <br><br>  The application in the working form can be seen on the <a href="http://daavat-ru.herokuapp.com/">site</a> . <br>  The <a href="https://github.com/asker1327/mutaAlim">githaba</a> repository. </div><p>Source: <a href="https://habr.com/ru/post/226869/">https://habr.com/ru/post/226869/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../226853/index.html">What should be a good map - guidelines on Yandex.Maps</a></li>
<li><a href="../226855/index.html">How we made WordPress friendlier for Russian users</a></li>
<li><a href="../226859/index.html">Implementation of the secret visual information sharing scheme in MATLAB</a></li>
<li><a href="../226861/index.html">3 facts about PHP that you might not know</a></li>
<li><a href="../226863/index.html">Demotivator for gamers</a></li>
<li><a href="../226871/index.html">Retention and return to the audience using Email and Push notifications</a></li>
<li><a href="../226873/index.html">How to win in the game stone-paper-scissors? (implementation of the optimal strategy in Wolfram Mathematica)</a></li>
<li><a href="../226875/index.html">Why is NginX with Fast-CGI faster than Apache with mod_php?</a></li>
<li><a href="../226877/index.html">The first drone to break up rallies</a></li>
<li><a href="../226879/index.html">The ProtonMail mail service team from CERN began collecting funds for additional servers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>