<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>QGIS and Tile Export</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For several years I have been engaged in panning and keeping up to the ridge schemes of two mountain regions. Dzhungar Ala Tau and Central Tien Shan. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>QGIS and Tile Export</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/3r/xp/qo/3rxpqonbc9bpny5n0esihlfssb8.jpeg"></div><br>  For several years I have been engaged in panning and keeping up to the ridge schemes of two mountain regions.  Dzhungar Ala Tau and Central Tien Shan. <br><br>  Initially, I drew everything in the Ocad program.  This is a special program for drawing orienteering maps.  The project was divided into dozens of sheets.  Then these sheets were exported to pictures, stitched and cut into tiles.  Tiles were uploaded to ftp. <br><br>  <a href="https://nakarte.me/">Here is an example of what happens in QGis</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="https://nakarte.me/">And that's how it was in Ocad</a> <br><a name="habracut"></a><br>  And once I met QGIS. <br><br>  The program impressed me.  A nice renderer.  Not as expressive as in OCAD, but the quality suited me.  The ability to work directly with geodata.  Ability to work with the whole project without breaking it into pieces. <br>  All this prompted to transfer the entire project to QGIS. <br><br>  But now I regret it a little. <br>  <b>The QGIS renderer is not suitable for generating tiles.</b> <br>  Of course, there are two QTiles and QMetaTiles plugins for QGIS 2. I adapted them for QGIS 3 as well. <br><br>  I'll tell you more about unrecoverable jambs that prevent the generation of tile maps in QGIS. <br>  The export is made using the QTiles plugin. <br><br>  <b>Jamb ‚Ññ1.</b>  <b>When the renderer calculates which objects fall within its scope (in QGIS This is called canvas), it does not take into account the size of the characters of the objects.</b> <br><br>  <b>Example 1a</b>  <b>Point Object</b> <br><br><img src="https://habrastorage.org/webt/eg/gk/nm/eggknmsu4gnitkztdps8rtfqdiw.jpeg" alt="image"><br><br>  As you can see, the vertex icon was cut off.  On the bottom tile, the renderer made it, but on the top one - no.  Because the center of the top did not fall into the boundaries of the tile. <br><br>  <b>Example 1b</b>  <b>Linear object</b> <br><br><img src="https://habrastorage.org/webt/9z/-k/b9/9z-kb90ujubf1xxqvrpn0dsde20.jpeg"><br><br>  A thick line passes near the border of the tile.  It partially hit the bottom tile.  On the top tile did not hit at all. <br><br>  The line does not have to go along the border of tiles.  There may still be such an artifact <br><br><img src="https://habrastorage.org/webt/c9/ju/mx/c9jumxyc_0h66y8ohjvhsm4jtn8.jpeg"><br><br>  <b>The jamb number 2.</b>  <b>Arrangement of inscriptions.</b> <br><br>  <b>Example 2a</b>  <b>Short inscription on a linear object</b> <br><br><img src="https://habrastorage.org/webt/0z/51/cq/0z51cqyapbsggzsexvxulffzymu.jpeg"><br>  Renderer derived the name on each tile. <br><br>  <b>Example 2b</b>  <b>Long inscription on a linear object</b> <br><br>  Z15 <img src="https://habrastorage.org/webt/ka/m7/gi/kam7gihdqmdbhifcerrls0fpulq.jpeg"><br><br>  Z16 <img src="https://habrastorage.org/webt/gd/2n/r_/gd2nr_-0_ktpnoermw0eykkd5dk.jpeg"><br><br>  On Z15 there is an inscription, because it completely fits into the boundaries of the tile. <br>  On the Z16, the inscriptions are no longer, because the long inscription does not fit into the boundaries of the tile. <br><br>  Imagine that you want to draw a map of the world, and on it on the entire continent in large letters to write "EURASIA".  Nothing will come of it.  The inscription will appear only on those zooms where it is placed in the entire tile. <br><br>  <b>Example 2c</b>  <b>Inscription on a point object</b> <br><br>  I turned on the option "Show Partial Labels" <br><br>  Z16 <img src="https://habrastorage.org/webt/uj/lt/ru/ujltrutwyddzyef2qofd_utjdhw.jpeg"><br><br>  Z15 <img src="https://habrastorage.org/webt/e9/ra/hg/e9rahgmmi4wlx1vzen_k5my-tng.jpeg"><br><br>  On the Z16, the renderer only shows the part of the label that fits into the tile.  When rendering a neighboring tile, he, of course, forgets about it. <br><br>  If the option ‚ÄúShow partial labels‚Äù is turned off, then there will be no label on the Z16 at all. <br><br>  Two methods are designed to deal with these problems. <br><br>  1. Metataling <br>  2. Buffer zones <br><br>  <b>Metatayling.</b> <br>  Not every tile is rendered individually, but a group of several tiles.  Say, 4x4, and then cut into smaller pieces. <br><br>  <b>Buffer zones</b> <br>  The area is rendered larger than a tile or meta file, and then the necessary piece is cut from it. <br><br>  Both methods do not correct the above-mentioned jambs, but shift them by several zoom levels below.  The same shoals appear already on the borders of the tiles, and on the borders of the metatails or buffer zones. <br><br>  <b>Example 2d.</b>  <b>Point Object</b> <br>  I do export by plugin QMetaTiles.  Metatail size 2x2.  This means that the area is rendered in 2x2 tiles, and then cut into pieces. <br><br>  Z16 <img src="https://habrastorage.org/webt/-p/20/th/-p20thjawza5j1jee969dqgzqey.jpeg" alt="image"><br><br>  Really.  The inscription is no longer cut off, because it fits entirely into the 2x2 tile area.  But on the border of the metatail, the object itself was clipped.  The same will happen with the linear object. <br>  The problem moved one zoom level lower. <br><br>  <b>Jamb number 3.</b>  <b>Jumping inscriptions</b> <br>  <b>Example 3a</b> <br>  The aligner each time chooses the most advantageous position for the next label.  Moreover, the location of the labels depends on the position of the canvas.  Move it a couple of millimeters, and all the inscriptions will be completely different. <br><br>  This means that when rendering one metatail and the buffer zone around it, the inscription can be in one place, and when rendering the next metatail - completely in another. <br><br>  I export a piece of the map into tiles.  Inscriptions occupy one order. <br><br>  Then I shift the canvas a bit and do the export again.  Inscriptions already occupy a completely different order.  At the same time there are such artifacts. <br><br><img src="https://habrastorage.org/webt/ei/ym/fd/eiymfdaaw2bddxxxb9ct--vwhds.jpeg"><br><br>  <b>What to do with it all?</b> <br><br>  Metatayling and buffer areas do not solve the problems described above, but push them to lower zoom levels. <br><br>  1. When the renderer calculates which objects it should draw, it should consider not only the geodata of objects, but their symbolism. <br><br>  For example, for all objects, the renderer should store BBOX, which the object takes up after the individual rendering.  When rendering a scene, you must consider the intersection of the canvas with the individual BBOXs of the rendered objects. <br><br>  In this case, it is desirable that BBOX also contains the inscriptions attached to the object. <br><br>  2. The location of the labels should not depend on the location of the canvas.  Then, with partial export, the inscription fragments will be well stitched.  There will be no need for metatailing and buffer zones. <br><br>  Unfortunately, at the moment the export of tiles from QGIs is just awful, and when it will be fixed it is not clear. <br><br>  Maybe there is someone here taking part in the development of QGis? </div><p>Source: <a href="https://habr.com/ru/post/429426/">https://habr.com/ru/post/429426/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../429416/index.html">Build a chat bot using Azure Bot</a></li>
<li><a href="../429418/index.html">.NET Standard 2.1</a></li>
<li><a href="../429420/index.html">PlayStation Classic uses PCSX ReARMed emulator for work, there are no proprietary solutions.</a></li>
<li><a href="../429422/index.html">UHCI, or the very first USB</a></li>
<li><a href="../429424/index.html">In California, there will be a robot from Daimler and Bosch</a></li>
<li><a href="../429430/index.html">Own VPN client on JavaScript. Part 3 - OpenVPN component</a></li>
<li><a href="../429432/index.html">Own VPN client on JavaScript. Part 4 - Configs Component</a></li>
<li><a href="../429434/index.html">Own VPN client on JavaScript. 5 part - Electron component Vpn</a></li>
<li><a href="../429436/index.html">Own VPN client on JavaScript. 6 part - Electron component Notify</a></li>
<li><a href="../429438/index.html">Own VPN client on JavaScript. Part 7 - Electron Context Component</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>