<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Smart feeder: Machine Learning, Raspberry Pi, Telegram, a little learning magic + assembly instructions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It all started with the fact that his wife wanted to hang a bird feeder. I liked the idea, but immediately wanted to optimize. A light day in winter i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Smart feeder: Machine Learning, Raspberry Pi, Telegram, a little learning magic + assembly instructions</h1><div class="post__text post__text-html js-mediator-article">  It all started with the fact that his wife wanted to hang a bird feeder.  I liked the idea, but immediately wanted to optimize.  A light day in winter is short - there is no time to sit in the afternoon and look at the feeder.  So you need more Computer Vision! <br><br><img width="800" src="https://habrastorage.org/files/8b1/611/504/8b16115046c64b369f10fe74bf4a123c.jpg"><br><br>  The idea was simple: a bird flies in - vzhuuuuh - it turns out to be on the phone.  It remains to figure out how to do it and implement it. <br>  In the article: <br><ul><li>  Launch Caffe on Raspberry Pi B + (I have long wanted to do this) </li><li>  Building a data collection system </li><li>  Neural network selection, architecture optimization, training </li><li>  Wrapping, selecting and attaching an interface </li></ul><br>  All sources are open + described the full order of deployment of the resulting structure. <br><a name="habracut"></a><br>  To be honest, I was not sure that everything will turn out + I was not very sure about the final architecture.  In the course of work, it has changed quite a lot.  Therefore on Habr√© I write after there is a ready version.  The ups and downs of development can be tracked on GitHub and in the blog, where I made small reports on the campaign (links at the end of the article). <br>  The idea of ‚Äã‚Äã‚ÄúI want to recognize birds‚Äù can have dozens of implementations.  At the beginning of work, I wanted the system to automatically detect the birds coming to the feeder, determine what kind of birds they were, choose the best photo, lay out somewhere + lead the attendance statistics.  Not everything worked out from here. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  <b>Complete set</b> </h3><br><ul><li>  System core: Raspberry Pi first model, B +.  I lay in my box for a year and a half with almost no business.  Now, of course, it will be more logical to take the RPi 3. There, the memory is bigger and faster too.  Price RPi 3 - somewhere 3-3.5 tr. </li><li>  SD card for RPi.  Like 32 gig.  I bought a long time, I do not remember the price.  Somewhere around 500-1000r </li><li>  Power supply (microUSB).  Took from their stocks.  Again, somewhere in the 500-1000r. </li><li>  Camera: <br><ul><li>  Initially, I planned to use the most basic camera from Rpi (Raspberry Pi Camera 1.3rev), which I had in the same box.  But she did not start.  Judging by the tests, either the RPi connector or the cable died.  Another option - firewood flew.  In the near future I will finally understand what is wrong there.  The price of such a camera, depending on the lens and the characteristics of 1.5t.r - 2.5 tr. </li><li>  So as a starting decision, I decided to install a webcam from a computer.  Normal Creative, good on Rpi B + many USB ports.  FaceCam100x.  I did not buy right now, it is worth somewhere in the neighborhood of 1t.r.  The option is bad, as the quality is miserable.  But dial the base and test it - it will come down. </li></ul><br></li><li>  WiFi dongle  I took the most common - TP-Link TL-WN727N for 400r. </li><li>  Actually feeder.  Himself was doing laziness, bought ready.  Cost somewhere in the 2t.r.  with delivery </li></ul><br><br><h3>  <b>Infrastructure</b> </h3><br>  A piece of my home network that is responsible for the project has the following configuration: <br><br><img src="https://habrastorage.org/files/e11/72d/a83/e1172da83d794ee782945438b7971e5f.png"><br><br>  Rpi + camera hang near the window.  I spent a lot of experiments to find a convenient mount and a good view: <br><br><img width="400" src="https://habrastorage.org/files/a27/24e/4f8/a2724e4f8f6d4381a5802e948dba7490.jpg"><img width="200" src="https://habrastorage.org/files/977/583/11f/97758311f6fc4d5a881352d225b6831a.jpg"><br><br>  As a result, stuck in a stand for knives.  It is mobile, you can gain a base from different angles.  Not to say that my wife liked this idea, but I assure you that this is a temporary solution: <br><br><img width="300" src="https://habrastorage.org/files/6c5/e32/770/6c5e327709b849099092e188f55f0e96.jpg"><br><br>  Pictures are as follows: <br><br><img width="400" src="https://habrastorage.org/files/25e/6f5/497/25e6f5497eff43ba8e6cf6cd69daf5bd.jpg"><img width="400" src="https://habrastorage.org/files/f57/9db/fcb/f579dbfcba9e41a688204cb1ecd8e3ef.jpg"><img width="400" src="https://habrastorage.org/files/987/239/1c4/9872391c4ac24b479d03eef31987a9b9.jpg"><br>  The quality of the webcam is not so hot.  But, in principle, it is clear what is happening. <br><br>  Let's return to architecture.  In Rpi, a WiFi module is plugged in that is connected to the router.  Photos are saved to a network drive (WD MyBook live).  This is a prerequisite for dialing a base (there will not be enough for RPi flash drives).  When used, of course, can be disabled.  But it is convenient for me. <br><br>  Rpi itself hangs without a monitor.  Its management, programming and configuration is now done from the main computer via SSH.  In the beginning, I set something up by inserting it into the monitor, but this is not necessary. <br><br><h3>  <b>Base collection</b> </h3><br>  A well-assembled base is much more complicated than choosing the right neural network.  Using broken markup or non-representative data can degrade system quality far more than using <a href="http://www.robots.ox.ac.uk/~vgg/research/very_deep/">VGG</a> instead of <a href="https://habrahabr.ru/post/303196/">ResNet</a> . <br><br>  Base collection is a mass of manual, even unskilled labor.  Especially for marking large databases there are Yandex.Toloka and Amazon Mechanical Turk services.  I will refrain from using them: I will mark everything manually by myself, not for long here.  Although, maybe it would make sense to drive there, to practice using it. <br><br>  Naturally, I want to automate such a process.  To do this, consider what we want. <br>  What is the base in our situation: <br><ul><li>  The system works with video - it means that there must be frames from the video.  Power for analyzing video sequences on an old RPi is definitely not enough </li><li>  The system should recognize the birds in the video, so there should be examples of frames in which the birds are present in the database, as well as examples of frames where they are not present. </li><li>  The system must recognize the quality of the images.  This means that there should be marks in the database that determine the quality of the frame. </li><li>  The system should have a set of frames for each type of bird it recognizes. </li></ul><br>  In fact, the event "arrival of the bird."  For this event, we must determine what kind of bird flew in and make a good shot. <br><br>  The easiest thing to do is to make a trivial "motion detector" and dial its entire output.  Motion detector will do the easiest way: <br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>W</mi><mo>,</mo><mi>H</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;></mrow></msubsup><msubsup><mi>I</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>,</mo><mi>y</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>f</mi><mi>r</mi><mi>a</mi><mi>m</mi><msub><mi>e</mi><mn>1</mn></msub></mrow></msubsup><mo>&amp;#x2212;</mo><msubsup><mi>I</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>,</mo><mi>y</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>f</mi><mi>r</mi><mi>a</mi><mi>m</mi><msub><mi>e</mi><mn>2</mn></msub></mrow></msubsup><mo>&amp;gt;</mo><mi>D</mi></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.612ex" height="3.383ex" viewBox="0 -1091.4 13180 1456.5" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-57" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMAIN-2C" x="1048" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-48" x="1327" y="0"></use></g></g><g transform="translate(3837,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-49" x="0" y="0"></use><g transform="translate(523,490)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-66" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-72" x="550" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-61" x="1002" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-6D" x="1531" y="0"></use><g transform="translate(1704,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMAIN-31" x="659" y="-213"></use></g></g><g transform="translate(440,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMAIN-2C" x="572" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-79" x="851" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMAIN-2212" x="7038" y="0"></use><g transform="translate(8038,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-49" x="0" y="0"></use><g transform="translate(523,490)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-66" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-72" x="550" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-61" x="1002" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-6D" x="1531" y="0"></use><g transform="translate(1704,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-65" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMAIN-32" x="659" y="-213"></use></g></g><g transform="translate(440,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMAIN-2C" x="572" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-79" x="851" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMAIN-3E" x="11295" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/322520/&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi8NEPvF5Pvb7WtBoATSErPuWHBoQ#MJMATHI-44" x="12351" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>W</mi><mo>,</mo><mi>H</mi></mrow><mrow class="MJX-TeXAtom-ORD"></mrow></msubsup><msubsup><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>,</mo><mi>y</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>f</mi><mi>r</mi><mi>a</mi><mi>m</mi><msub><mi>e</mi><mn>1</mn></msub></mrow></msubsup><mo>‚àí</mo><msubsup><mi>I</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>,</mo><mi>y</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>f</mi><mi>r</mi><mi>a</mi><mi>m</mi><msub><mi>e</mi><mn>2</mn></msub></mrow></msubsup><mo>&gt;</mo><mi>D</mi></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> \ sum_ {W, H} ^ {} I_ {x, y} ^ {frame_1} -I_ {x, y} ^ {frame_2}> D </script></p><br><br>  Code on several lines: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cv2 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time video_capture = cv2.VideoCapture(<span class="hljs-number"><span class="hljs-number">0</span></span>) video_capture.set(<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">1280</span></span>) video_capture.set(<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">720</span></span>) video_capture.set(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.6</span></span>) ret, frame_old = video_capture.read() i=<span class="hljs-number"><span class="hljs-number">0</span></span> j=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: time.sleep(<span class="hljs-number"><span class="hljs-number">0.5</span></span>) ret, frame = video_capture.read() diffimg = cv2.absdiff(frame, frame_old) <span class="hljs-comment"><span class="hljs-comment">#      d_s = cv2.sumElems(diffimg) d = (d_s[0]+d_s[1]+d_s[2])/(1280*720) frame_old=frame print d if i&gt;30: # 5-10     ,    if (d&gt;15): #  cv2.imwrite("base/"+str(j)+".jpg", frame) j=j+1 else: i=i+1</span></span></code> </pre> <br><br><h4>  <b>Detector Result</b> </h4><br>  The detector worked on any stirrer.  At its beginning and at its end.  As a result of the detector operation, a base of approximately 2,000 frames was recruited during the week.  We can assume that there are birds in every second frame =&gt; approximately 1000 images of birds + 1000 images of non-birds. <br><br>  Given that the viewpoint does not move much - we can assume that the base plus minus is sufficient. <br><br><h4>  <b>Base marking</b> </h4><br>  For the markup, I wrote a simple program on python.  Bottom, source links.  Thank you so much my wife for helping us with markup!  Two hours of time killed :) And a couple of hours I spent myself. <br><br>  For each picture two signs were marked: <br><ol><li>  Type of bird.  Unfortunately, only two kinds of tits came to me.  So there are three types: <br><ol><li>  There are no birds. </li><li>  <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%258B%25D0%25BA%25D0%25BD%25D0%25BE%25D0%25B2%25D0%25B5%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BB%25D0%25B0%25D0%25B7%25D0%25BE%25D1%2580%25D0%25B5%25D0%25B2%25D0%25BA%25D0%25B0">Blue tit</a> </li><li>  <a href="https://ru.wikipedia.org/wiki/%25D0%2591%25D0%25BE%25D0%25BB%25D1%258C%25D1%2588%25D0%25B0%25D1%258F_%25D1%2581%25D0%25B8%25D0%25BD%25D0%25B8%25D1%2586%25D0%25B0">Great tit</a> </li></ol></li><li>  Image quality.  The subjective score on the scale [0,8]. </li></ol><br>  In total, we have for each image a vector of two quantities.  Well, for example, here: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/156/7d1/998/1567d19982631a1415b03d0f70687ba6.jpg" alt="image"><br><br>  Obviously, the quality is zero (0), and the big tit is sitting (2). <br><br>  In total, about half of the frames with birds turned out, half the empty ones.  At the same time, the tit Azureque was only 3-5% of the base.  Yes, it is difficult to get a large base from them.  And yes, learning from these 3-5% (~ 40 pictures) is unreal.  As a result, I had to train only in ordinary tits.  And hope that sooner or later the base of the azure will be much more. <br><br><h4>  <b>Base expansion</b> </h4><br>  Now I will skip through the stage to preserve the continuity of the narrative.  About the network, the choice of the network and its training will be discussed in the next section.  Everything was more or less studied there, except for the blue tit.  On the basis of the percentage of frame recognition accuracy was somewhere 95%. <br><br>  When I say that machine learning in contests and in reality - these are two things that are not related to each other - they look at me like a psycho.  Tasks for machine learning at competitions are a matter of optimizing grids and finding loopholes.  In a rare case - the creation of a new architecture.  The tasks of machine learning in reality is a matter of creating a base.  Set, markup, automate further retraining. <br><br>  I liked the task with the feeder largely because of this.  On the one hand, it is very simple - it is done almost instantly.  On the other hand, it is very indicative.  90% of the tasks here are unrelated to contests. <br><br>  The base that we recruited above is extremely small for tasks of this type and is not optimal.  It does not imply "stability."  Only 4-5 camera positions.  One weather outside the window. <br><br>  But it helps to create the ‚Äúfirst stage‚Äù algorithm.  Which will help you gain a good base. <br>  Modify the detector that I described above: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (d&gt;<span class="hljs-number"><span class="hljs-number">20</span></span>): frame = frame[:, :, [<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>]] <span class="hljs-comment"><span class="hljs-comment">#   transformed_image = transformer.preprocess('data', frame) #   net.blobs['data'].data[0] = transformed_image #   net.forward() #   if (net.blobs['pool10'].data[0].argmax()!=0): # 0 -   misc.imsave("base/"+str(j)+"_"+ str(net.blobs['pool10_Q'].data[0].argmax())+".jpg",frame) j=j+1 else: #- : ?! misc.imsave("base_d/"+str(k)+".jpg",frame) k=k+1</span></span></code> </pre> <br>  How to set the base!?  And what did we do before? <br><br>  We used to get the usual base.  And now - we are recruiting a database of errors.  In one morning, the net produced more than 500 situations identified as tits: <br><br><img width="300" src="https://habrastorage.org/getpro/habr/post_images/71f/30b/675/71f30b675a22a5347f251aeab7710c7f.jpg" alt="image"><img width="300" src="https://habrastorage.org/getpro/habr/post_images/528/1ed/94e/5281ed94eabd896e3efb2a0936cad582.jpg" alt="image"><br><img width="300" src="https://habrastorage.org/getpro/habr/post_images/1f9/dc4/435/1f9dc443593d0f8762c6ca2232afc414.jpg" alt="image"><img width="300" src="https://habrastorage.org/getpro/habr/post_images/9e8/eb3/238/9e8eb323813199a0ce8bfeeeb449c63f.jpg" alt="image"><br><br>  But let me!  Maybe your mesh is not working?  Maybe you confused the channels when you transferred the image to from camera to grid? <br><br>  Unfortunately not.  This is the fate of all the grids trained on a small amount of data (especially for simple networks).  In the training set there were only 6-9 different camera positions.  Few highlights.  Little extraneous noise.  And when the grid sees something completely new - it can throw out the wrong result. <br><br>  But it's not scary.  After all, we screwed the collection base.  Only 300-400 empty frames in our base - and the situation is improving.  Instead of 500 false alarms in the morning, they are already zero.  Only here something and birds were detected only 2/3 of their total number.  These did not recognize these: <br><br><img width="300" src="https://habrastorage.org/getpro/habr/post_images/33a/e39/d60/33ae39d60d2bb1d4dc1ca724bd3937f3.jpg" alt="image"><img width="300" src="https://habrastorage.org/getpro/habr/post_images/fd3/9fb/cb3/fd39fbcb301b8e3cf87be27f58fae313.jpg" alt="image"><br><br>  For their collection and it is "else" in the code above.  View the base of the motion detection for the whole day and select 2-3 passes simply.  For these pictures it took me time - twenty seconds. <br><br>  The actual implementation of the system is a permanent workflow, where the grid has to be tightened every few days.  And sometimes introduce additional mechanisms: <br><br><img src="https://habrastorage.org/files/2d2/bd5/d9a/2d2bd5d9a6ac446c9ca5b55fb8504cc4.png"><br><br>  The solution of the problem in practice is the construction of such a scheme, with all the processes of additional training, retraining, collecting and optimizing the collection. <br><br>  To invent and build a model is much more power than to train a good model.  Often it is necessary to use ancient algorithms: SIFT, SURF.  And sometimes take a trained grid, but from a completely different task.  For example, a face detector. <br><br>  It's all?  Is the base ready?  Does the system work?  Of course <b>not</b> .  Outside the window is soft, white and fluffy snow.  But it becomes hard and icy.  Spring is coming.  In the last two days, they spoiled the spoons again: <br><br><img width="600" src="https://habrastorage.org/files/63c/2cf/47d/63c2cf47d1d2428ea1e3bc80bdb87cf1.jpg"><br><br>  The sun does not shine from there.  The snow melted.  Kapel pounded. <br><br>  A good base for this task is spring + winter + summer + autumn.  For all the birds, for different types of the window, for different weather.  I already wrote a long-long <a href="https://habrahabr.ru/post/311558/">article</a> here about how to build a database. <br>  It seems to me that such a task requires a base of at least 2-3 thousand frames for each bird in different conditions. <br><br>  There is no such thing yet. <br><br><h4>  <b>Base generation</b> </h4><br>  The base can be supplemented automatically in order to generate distortions.  This greatly increases stability.  I did not do all possible increments.  You can do more and raise quality.  What did I do: <br><ul><li>  Mirroring Pictures </li><li>  Turns the pictures at angles within 15 degrees </li><li>  Crop pictures (5-10%) </li><li>  Changes in the brightness of the image channels in different combinations </li></ul><br>  And this could be added: <br><ul><li>  Homography </li><li>  Breaking a picture into 2 parts and gluing a new one.  The increment went very well in <a href="https://habrahabr.ru/post/307078/">this</a> competition. </li><li>  Knocking out pieces of image squares of different colors </li><li>  nonlinear transformations </li></ul><br>  To be honest, I did not fully introduce all these distortions.  Need more time.  But still the quality of the base is not surpassed.  It is not Kaggle to fight for the fractions of a percent. <br><br><h3>  <b>Network Setup and Startup</b> </h3><br><h4>  <b>Installation</b> </h4><br>  One of the main questions that I wanted to understand for myself was the possibility of running ML frameworks for CV on simple devices.  For example on the Raspberry Pi. <br>  Thank God that someone thought this for me.  GitHub has a <a href="https://github.com/benjibc/caffe-rpi">useful</a> repository with almost no instructions. <br>  On RPi B + Caffe and everything you need for it, you can assemble and install it somewhere in a day (you need to approach yourself once an hour and shove the next team).  On RPi3, as I understand it, it can be much faster (in 2-3 hours it should cope). <br><br>  In order not to litter the article with a bunch of Linux commands, I just drop the link <a href="http://cv-blog.ru/%3Fp%3D105">here</a> , where I described them all.  Caffe is going!  Works! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ffc/db5/dc6/ffcdb5dc67f4c74df21241aa0a0e5baf.png" alt="image"><br><br>  Initially, I thought to use some kind of unpretentious mesh, such as <a href="https://github.com/BVLC/caffe/blob/master/models/bvlc_reference_caffenet/deploy.prototxt">CaffeNet</a> , or even VGG16.  But the author of the port of Caffe under RPi strongly advised using <a href="https://github.com/DeepScale/SqueezeNet/tree/e06795b9855dafe82fa950b20ead468f83554020">SqueezeNet</a> .  I tried - and I liked it.  Fast, enough memory takes up.  Accuracy, of course, not the ResNet level.  The first attempt to deploy the network was not very successful.  The network ate 500 MB of RAM out of my 400 free.  I quickly realized that the main problem was in the output layer.  He was from ImageNet at 1000 pins.  I needed only a dozen output neurons.  This reduced the size of the network immediately to 150 meters.  The grid itself is very interesting.  In accuracy, it is comparable to AlexNet.  In this case, 50 times faster, according to the authors.  The grid itself implements the following principles: <br><ol><li>  3 * 3 convolutions are replaced by 1 * 1 convolutions.  Each such replacement reduces the number of parameters 9 times. </li><li>  At the entrance of the remaining bundles of 3 * 3 try to submit only a small number of channels </li><li>  Size reduction is done as late as possible so that the convolutional layers have a large activation area. </li><li>  Complete abandonment of fully connected layers at the exit.  Instead, direct exits to recognition neurons from the convolution layer via avg-pooling are used. </li><li>  Adding Analogue Residual Layers </li></ol><br>  Total  There is a local component: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7c2/db2/6e1/7c2db26e1d8f973fb906bcc08f14a9f3.png" alt="image"><br><br>  And there is a global one created from these local ones: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/01e/6e5/289/01e6e5289dbe4890c57d91f47114fb0d.png" alt="image"><br><br>  Good ideas.  On RPi3, apparently, it gives real time (I sense that there should be 10-15 fps). <br>  On my RPi B + it gave 1.5-2 frames per second.  Well, for more, I honestly did not count. <br><br>  The authors of the port under Caffe used a mesh through C ++ to improve performance.  But I dragged to Python.  It is much faster to develop. <br><br><h4>  <b>Network training</b> </h4><br>  First, as I said above, I had to change the last fully connected layer: <br><br><pre> <code class="bash hljs">layer { name: <span class="hljs-string"><span class="hljs-string">"conv10_BIRD"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">type</span></span>: <span class="hljs-string"><span class="hljs-string">"Convolution"</span></span> bottom: <span class="hljs-string"><span class="hljs-string">"fire9/concat"</span></span> top: <span class="hljs-string"><span class="hljs-string">"conv10"</span></span> convolution_param { num_output: 3 kernel_size: 1 weight_filler { <span class="hljs-built_in"><span class="hljs-built_in">type</span></span>: <span class="hljs-string"><span class="hljs-string">"gaussian"</span></span> mean: 0.0 std: 0.01 } } } layer { name: <span class="hljs-string"><span class="hljs-string">"conv10_Q"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">type</span></span>: <span class="hljs-string"><span class="hljs-string">"Convolution"</span></span> bottom: <span class="hljs-string"><span class="hljs-string">"fire9/concat"</span></span> top: <span class="hljs-string"><span class="hljs-string">"conv10_Q"</span></span> convolution_param { num_output: 3 kernel_size: 1 weight_filler { <span class="hljs-built_in"><span class="hljs-built_in">type</span></span>: <span class="hljs-string"><span class="hljs-string">"gaussian"</span></span> mean: 0.0 std: 0.01 } } }</code> </pre> <br>  I replaced it with two outs.  At one exit - the presence of a bird + its type.  The second is quality. <br>  The final speed of work on RPi B + of such a thing is ~ 2-3 seconds per frame + its preprocessing (cleaning the code from converting unnecessary, teaching in a format in which OpenCV directly receives data - will be 1.5-2 seconds). <br><br>  In reality, learning the layer on "quality" is still a trouble.  I used three approaches (yes, you can approach correctly and take special layers of losses. But laziness: <br><ol><li>  Nine output neurons, each with L2 regularization (Euclidian).  The decision was pulled to the center of expectation.  No. </li><li>  Nine output neurons, but which are scattered not by 1-0, but by a certain value of expectation.  For example, for a frame marked as ‚Äú4‚Äù: 0, 0, 0.1, 0.4, 0.9, 0.4, 0.1.0, 0. The error in Gauss with this approach smooths the noise in the sample.  Training more or less went, but did not like the accuracy. </li><li>  Three neurons with SoftMax at the exit.  ‚ÄúNo bird‚Äù, ‚Äúbird of poor quality‚Äù (value ‚Äú0‚Äù in the quality metric), ‚Äúbird of normal quality‚Äù (value ‚Äú1-8‚Äù in the quality metric).  This method worked best.  Statistics is average, but somehow it works.  Plus, when training, put a small weight to the layer (0.1) </li></ol><br>  Left - the last.  He is the only one who has ever worked. <br>  With the birds in the base everything is fine.  88% -90% correct classifications.  In this case, of course, 100% loss of all azureworms.  After I got the base - the quality has improved. <br>  Even slightly improved due to increments from the database (described above). <br><br><h3>  <b>Information output, Telegram</b> </h3><br>  Go to the last mile.  Need to deliver pictures to the user.  There were several options: <br><ul><li>  Leave on a network drive.  Despondency.  You can see only at home. </li><li>  Post to Twitter.  Minus - I do not use it.  No habit.  Plus, who needs nafig need such spam in the tape (sometimes 100 birds fly in a day) </li><li>  Post office.  I tried, I know.  Awful.  Not.  Of course, I once on mail clients did manage a network of telescopes, but no longer wanted. </li><li>  Telegram.  Something new for me, but it has been on the phone for half a year already, it has been used 5 times. </li><li>  Make your http client. </li></ul><br>  After reading about Telegram and making sure that everything is not so terrible there, plus there are some mysterious ‚Äúchannels‚Äù - I decided to use it.  Begin to fear.  It seemed that I had to take a day or two to complete the task.  Finally I got up with the spirit to read the documentation about the front of work.  Allocated an hour in the evening. <br><br>  And then I was pleasantly surprised.  Incredibly pleasantly surprised.  This hour was almost enough for me to write and connect everything that I had in mind.  No, of course I'm lying.  Spent 2 hours.  And then another one and a half to fasten an unnecessary whistle.  So it is all simple / convenient / recklessly works.  Essentially make a bot: <br><ol><li>  Login to Telegram </li><li>  Connect the bot "@BotFather".  Write / start, follow the instructions.  After 15 seconds you have your own bot. </li><li>  Choose a convenient programming language, find the appropriate wrapper.  I took a <a href="https://github.com/python-telegram-bot/python-telegram-bot">python</a> . </li><li>  Examples that will be there - 90% will close the functionality you need. </li></ol><br>  As I understand it, the processing of / start and / help commands is very desirable. <br>  If I ever do a smart home, I feel that it will not do without this thing. <br>  What can a bot.  The link to the bot will be lower: <br><ol><li>  Send on request the last frame with a bird.  I will divide this into 2 teams later: just a frame and a good frame. </li><li>  Include the mode ‚Äúsend all new shots with birds from the feeder‚Äù.  Every time a bird arrives, I send a photo of it to all interested people.  Since this whole farm is spinning on the Raspberry Pi - I imposed a limit on the number of people who can connect to this mode so as not to overload it (15 people).  In this case, the last 10 people will periodically reset, so that someone else could look.  Here in this channel this mode will be duplicated - @win_feed. </li><li>  How many birds were today.  A simple question is a simple answer. </li><li>  Mysterious "inline mode".  This is a piece in a telegram that allows you to send a request to the bot when typing text in any message.  I do not know why I added it.  So carried away that he could not stop.  In the query, I added the output of the last 5 photos with birds.  Type "appeal to the archive."  He did more for the sake of experiment. </li></ol><br>  Bot combined with recognition.  Its text is in the source.  Capture.py file <br><br>  Link to the bot and the channel with the output of the bot - below, in the basement of the article. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f51/aae/930/f51aae930fb72d590d4277cdcea47f28.jpg" alt="image"><br><br>  And this is what spam mode looks like: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c5/774/0bf/1c57740bfcf9cc46fa9e7f143223d8a6.jpg" alt="image"><br><br><h3>  <b>How to develop</b> </h3><br>  I have a few further ideas on how to improve and what to do next: <br><ul><li>  Pick up the camera from PRi.  It is possible to pick up some kind of good camera specifically for this task. </li><li>  Gain a more complete base.  Hang on another window, dial the base in the summer.  To build a base at the cottage, etc. </li><li>  Make more than one type of bird.  At least notorious azure tit. </li></ul><br>  There are more global plans.  Ideally, for the next winter I would like to make a feeder that would be completely autonomous.  To hang it in the country and manage from the city.  But for this you need to solve a number of problems.  First, find an adequate provider and make a system that would not have survived an insanely large amount of traffic.  Secondly, to make a feed dispenser, which could be remotely controlled.  Thirdly, to make an adequate assembly of this whole miracle into a single kulechek. <br><br><h3>  <b>Time budget</b> </h3><br>  I did a lot of this in parallel with other tasks.  So the score may shift.  If you want to do the same for yourself, part of the way will help to cut off my source code, but you will have to repeat a lot. <br><ul><li>  Run old RPI.  Testing, checking, connecting WiFi, connecting network drives - 3-4 hours. </li><li>  Build a layout for monitoring, hanging - 1 hour </li><li>  Writing the first base build program - 0.5 hours </li><li>  Analysis of the database, analysis, markup - 5 hours, 2 of them - the wife. </li><li>  Installation on RPi caffe - about 10-15 hours.  Upgrading the system, assembling Pip modules, etc.  The process is purely in the background.  Once an hour to go to check what has gathered what is not and run on. </li><li>  Reading manuals on SqueezeNet, training, launching the network, optimization, testing, comparing, writing a training program, tests - approximately 4-5 hours + 4 hours of training time. </li><li>  Recognition of the program for disengaging movement for recognition - 1 hour </li><li>  Telegramm bot (all the time in total) - 4 hours </li><li>  Analysis of the collected base, analysis of work, additional training, etc.  - 3 hours + 5 hours of computer time </li></ul><br>  In reality, this whole thing lasted three or four weeks.  It seems to me that with the source and the new RPi, you can make it 2-3 times faster. <br><br><h3>  <b>Sources</b> </h3><br>  I post links how it all looks in a running form.  Links to all of its source code in the process.  As well as links to all used frameworks / guides / forums <br><br><h4>  <b>How to test</b> </h4><br>  There are several limitations: <br><ol><li>  Recognition and Telegram bot spin on raspberry pi.  It is clear that he has not much power.  And from the Habr effect, he will possibly fall.  Therefore, I specifically limited the part.  I limited the function "send a fresh picture."  This is the most loaded function.  In total, I made access to the first 15 people to this function.  On 5-6 people checked, it works fine.  Plus, I will periodically reset, so that if someone is interested to be able to turn it on.  In addition, this function is duplicated on <a href="https://t.me/win_feed">this</a> Telegram channel.  In case the bot overloads and the habroeffect does not pull, I registered a duplicate bot account for it.  I‚Äôm writing here that I‚Äôve fallen, I'll throw it on him and I‚Äôll not give you the address.  Then pictures can be viewed only in the channel.  Then I will return, so that someone is interested - postestil. </li><li>  Birds.  In January, they flew to the trough constantly.  There were 200 arrivals each day.  But as time went on, the fewer they became.  Do not quite understand why.  Whether the flock migrated, or found a kosher place to eat, or overeat seeds, or smelled spring.  Last week, 2-3 birds flew in a day.  And even none.  So if you connect, and there will be no birds - excuse me. </li><li>  There are false detections.  Not often, but there are.  Usually they are caused by some effect which.  before that was not observed and the friend became.  Therefore, often go in series.  Moreover.  Spring is now.  I think that as the snow melts (in 2-3 days) - either it will trample false specimens ten times more, or it will pass. </li><li>  Birds fly between 8 am and 6 pm (Moscow time). </li><li>  The feeder will not work all the time.  I want to disassemble the piece of iron and improve it.  Plus, the snow will soon melt.  I will keep the week on, then I will turn it off.  I will definitely return it next winter, most likely in a much more adequate form. </li></ol><br>  Hope you scared. <br>  Here is a link to the bot - @WindowFeeder_bot <br>  And here again the channel - <a href="https://t.me/win_feed">t.me/win_feed</a> <br><br><h4>  <b>Source code</b> </h4><br>  Project <a href="https://github.com/ZlodeiBaal/BirdProject">repository</a> . <br>  <a href="https://github.com/ZlodeiBaal/BirdProject/tree/master/SortBase">Here</a> are programs for marking the base.  Under Windows and under Ubuntu (for some reason, OpenCV perceives keyboard codes in different ways, it was too lazy to be steamed). <br>  <a href="https://github.com/ZlodeiBaal/BirdProject/tree/master/SqNet">Here</a> is an example of network training.  In my opinion very useful for Caffe.  When I teach something myself, it often turns out some kind of similar program of this type. <br>  <a href="https://github.com/ZlodeiBaal/BirdProject/blob/master/capture.py">This</a> is the main code.  Here implemented: motion detection, Telegram bot, neural grid for recognition. <br>  <a href="https://yadi.sk/d/Wf0kaFZa3G9tNK">Here is a</a> base of photos.  For most photos there is a text file.  It has two digits.  The first is the type of bird.  The second is the quality of the image (relevant only when there is a bird).  There are also pictures without tektovichkov.  There is always no bird.  I took part of the database from VOC2012 to create a subsample with images that are completely irrelevant to the topic.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So you will see cats or dogs - do not be surprised. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you type your base, then my additive should increase stability.</font></font><br><br><h4> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instructions, helpful commands, etc.</font></font></b> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I cut off a rather large amount of details on how to configure RPi in this article. In my blog, I talked in more detail about some of the configuration steps. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plus, here I cut off some of the ideas that did not get a continuation - there they are. Total 4 notes on the topic: </font></font><a href="http://cv-blog.ru/%3Fp%3D89"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="http://cv-blog.ru/%3Fp%3D105"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="http://cv-blog.ru/%3Fp%3D115"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="http://cv-blog.ru/%3Fp%3D135"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Caffe version of the Raspberry Pi is dragged </font></font><a href="https://github.com/benjibc/caffe-rpi"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">away</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is almost no description on the installation. You can read in my blog, you can try to </font><font style="vertical-align: inherit;">act </font><font style="vertical-align: inherit;">on the closest </font></font><a href="https://github.com/BVLC/caffe/wiki/Ubuntu-16.04-or-15.10-Installation-Guide"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">guide</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (skipping a piece from hdf5). </font><a href="http://www.pyimagesearch.com/2015/02/23/install-opencv-and-python-on-your-raspberry-pi-2-and-b/"><font style="vertical-align: inherit;">OpenCV</font></a></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> launch </font><font style="vertical-align: inherit;">guide on RPi. </font><font style="vertical-align: inherit;">Useful </font><a href="https://habrahabr.ru/post/262247/"><font style="vertical-align: inherit;">instruction</font></a></font><a href="http://www.pyimagesearch.com/2015/02/23/install-opencv-and-python-on-your-raspberry-pi-2-and-b/"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><a href="https://habrahabr.ru/post/262247/"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to create a bot in Telegram. </font><font style="vertical-align: inherit;">In general, I took most of the samples about him </font></font><a href="https://github.com/python-telegram-bot/python-telegram-bot"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Good repository (API for Python).</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Z.Y. </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If suddenly someone wants his birds to be recognized, there is RPI, but there is no deployed computer to train the grid on your data - send the database marked in the specified format. </font><font style="vertical-align: inherit;">I will retrain with the addition of my own, I will post it in general</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Z.Y.Y.Y. </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">He was very afraid that today none of the birds would fly in and it would be broken. </font><font style="vertical-align: inherit;">Posted an article - and empty. </font><font style="vertical-align: inherit;">But one has already arrived, pleased. </font><font style="vertical-align: inherit;">Maybe there will be more.</font></font><br><br><img width="600" src="https://habrastorage.org/files/3f9/5b6/d03/3f95b6d034554edbb85dcce8e1a4c389.jpg"></div><p>Source: <a href="https://habr.com/ru/post/322520/">https://habr.com/ru/post/322520/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322504/index.html">Generation of polygonal maps for games</a></li>
<li><a href="../322508/index.html">15 oddities in ruby ‚Äã‚Äãthat you should know</a></li>
<li><a href="../322510/index.html">Vertica + Anchor Modeling = start growing your mycelium</a></li>
<li><a href="../322512/index.html">Conversion and payment types in traffic arbitration</a></li>
<li><a href="../322514/index.html">Neural network imitation game</a></li>
<li><a href="../322524/index.html">Unscientific revolution: how the lack of real research is ruining technological projects</a></li>
<li><a href="../322526/index.html">Another node.js library ...</a></li>
<li><a href="../322528/index.html">Functional patterns in domain modeling - anemic patterns and behavioral layout</a></li>
<li><a href="../322530/index.html">How IT professionals work. Mamikon Vartapetyan, Head of the Lester IT Database Development Team</a></li>
<li><a href="../322532/index.html">MySQL and MongoDB - when and what is better to use</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>