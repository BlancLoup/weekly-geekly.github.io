<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Multi-level tree with markers (HTML, CSS, jQuery). Remember the selected node</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is a continuation of the topic about the tree . I want to bring it to the rank of ‚Äúready for implementation‚Äù. Therefore, I fiddled with JavaScrip...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Multi-level tree with markers (HTML, CSS, jQuery). Remember the selected node</h1><div class="post__text post__text-html js-mediator-article"><img src="http://s47.radikal.ru/i115/0904/56/bca837f45f4f.jpg" align="right" alt="The tree remembers the selected node by url">  This is a continuation of the topic about the <a href="http://habrahabr.ru/blogs/css/56278/">tree</a> .  I want to bring it to the rank of ‚Äúready for implementation‚Äù.  Therefore, I fiddled with JavaScript and made memorization of the selected node based on the address of the link. <br>  If the link is nested in a subtree, the tree will expand to its level and, if it itself has a subtree, it will also be expanded. <br><br>  JavaScript did as best it could, because  I have not used it for a long time.  I ask for help in the refinement and optimization. <br><a name="habracut"></a><br><br>  In this version, HTML and CSS did not change, if you want - see it in the <a href="http://habrahabr.ru/blogs/css/56278/">previous article</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The next article continued is a <a href="http://habrahabr.ru/blogs/webdev/59823/">tree with state preservation of nodes</a> . <br><br><h4>  Javascript </h4><blockquote><code><font color="black">&lt;script src= <font color="#A31515">"http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"</font> type= <font color="#A31515">"text/javascript"</font> &gt;&lt;/script&gt; <br> &lt;script&gt; <br> <font color="#008000">/*&lt;![CDATA[*/</font> <br> <font color="#008000">/*</font> <br> <font color="#008000">    HTML .</font> <br> <font color="#008000">&nbsp;&nbsp; </font> <br> <font color="#008000">        .</font> <br> <font color="#008000">        .</font> <br> <font color="#008000">-     (/).</font> <br> <font color="#008000">-      ,   </font> <br> <font color="#008000"> ,     .</font> <br> <font color="#008000">-          (.current)</font> <br> <font color="#008000">    .</font> <br> <font color="#008000">-        </font> <br> <font color="#008000">     .</font> <br> <font color="#008000">*/</font> <br> $( <font color="#0000ff">document</font> ).ready( <font color="#0000ff">function</font> () { <br> <font color="#008000">/*    ,    .</font> <br> <font color="#008000">  'li'    'ul',   </font> <br> <font color="#008000">, ..    'li'   'a'</font> <br> <font color="#008000">     '&lt;em class="marker"&gt;&lt;/em&gt;'.</font> <br> <font color="#008000">a:first ,    1  </font> <br> <font color="#008000">   .</font> <br> <font color="#008000">*/</font> <br> $( <font color="#A31515">'#multi-derevo li:has("ul")'</font> ).find( <font color="#A31515">'a:first'</font> ).prepend( <font color="#A31515">'&lt;em class="marker"&gt;&lt;/em&gt;'</font> ); <br> <font color="#008000">//      </font> <br> $( <font color="#A31515">'#multi-derevo li span'</font> ).click( <font color="#0000ff">function</font> () { <br> <font color="#008000">//    </font> <br> $( <font color="#A31515">'a.current'</font> ).removeClass( <font color="#A31515">'current'</font> ); <br> <font color="#0000ff">var</font> a = $( <font color="#A31515">'a:first'</font> , <font color="#0000ff">this</font> .parentNode); <br> <font color="#008000">//   </font> <br> <font color="#008000">// a.hasClass('current')?a.removeClass('current'):a.addClass('current');</font> <br> a.toggleClass( <font color="#A31515">'current'</font> ); <br> toggleNode( <font color="#0000ff">this</font> .parentNode); <br> <br> }); <br> postLoad(); <br> }) <br> <font color="#008000">//      </font> <br> <font color="#0000ff">function</font> toggleNode(Node) { <font color="#008000">// node= li</font> <br> prepareLast(Node); <br> <font color="#008000">//       </font> <br> <font color="#0000ff">var</font> ul=$( <font color="#A31515">'ul:first'</font> ,Node); <font color="#008000">//  </font> <br> <font color="#0000ff">if</font> (ul.length) { <font color="#008000">//  </font> <br> ul.slideToggle(200); <font color="#008000">//  </font> <br> <font color="#008000">//     /</font> <br> <font color="#0000ff">var</font> em=$( <font color="#A31515">'em:first'</font> ,Node); <font color="#008000">// this = 'li span'</font> <br> <font color="#008000">//  em.hasClass('open')?em.removeClass('open'):em.addClass('open');</font> <br> em.toggleClass( <font color="#A31515">'open'</font> ); <br> } <br> } <br> <font color="#008000">//      </font> <br> <font color="#0000ff">function</font> prepareLast(Node) { <br> <font color="#008000">/*     ,     </font> <br> <font color="#008000">   */</font> <br> $(Node).each( <font color="#0000ff">function</font> (){ <br> <font color="#0000ff">if</font> (!$( <font color="#0000ff">this</font> ).next().length) { <br> <font color="#008000">/*    &lt;li&gt;,     &lt;ul&gt;,</font> <br> <font color="#008000">   ul &gt; li,    'last' */</font> <br> $( <font color="#0000ff">this</font> ).find( <font color="#A31515">'ul:first &gt; li'</font> ).addClass( <font color="#A31515">'last'</font> ); <br> } <br> }) <br> } <br> <font color="#008000">//       </font> <br> <font color="#0000ff">function</font> postLoad(){ <br> <font color="#0000ff">var</font> url = window.location.toString(); <br> <font color="#0000ff">var</font> max = 0; <br> <font color="#0000ff">var</font> a = <font color="#0000ff">null</font> ; <br> $( <font color="#A31515">'#multi-derevo li span a'</font> ).each( <font color="#0000ff">function</font> (){ <br> <font color="#008000">//       </font> <br> <font color="#0000ff">if</font> (url.indexOf( <font color="#0000ff">this</font> .href) &gt;= 0 &amp;&amp; <font color="#0000ff">this</font> .href.length &gt; max){ <br> a = <font color="#0000ff">this</font> ; <br> max = <font color="#0000ff">this</font> .href.length; <br> } <br> }); <br> <font color="#008000">//    ,   </font> <br> <font color="#0000ff">if</font> ($(a). <font color="#0000ff">is</font> ( <font color="#A31515">':hidden'</font> ) || $(a).parents( <font color="#A31515">':hidden'</font> ).length) { <br> <font color="#0000ff">var</font> li = $(a).parents().filter( <font color="#A31515">'li'</font> ); <br> prepareLast(li); <br> toggleNode(li); <br> } <br> <font color="#008000">//   </font> <br> <font color="#0000ff">if</font> (a) { <br> $(a).toggleClass( <font color="#A31515">'current'</font> ); <br> } <br> <font color="#0000ff">else</font> { <font color="#008000">//  ,    (    )</font> <br> $( <font color="#A31515">'#multi-derevo li span a:first'</font> ).toggleClass( <font color="#A31515">'current'</font> ); <br> } <br> } <br> <font color="#008000">/*]]&gt;*/</font> <br> &lt;/script&gt;</font></code> </blockquote> <br><br>  For some reason, for the first level, it was not possible to make auto expansion of the subtree after loading if the node was selected earlier. <br>  It needs to be improved, I will accept all the improvements with pleasure. <br><br>  This example has the disadvantage that the state of all nodes is not remembered, but only the position of the selected one. <br>  Those.  Previously, the tree was deployed on 3 levels deep, then after clicking on a link from the very top, only the first sublayer will unfold. <br><br>  See <a href="http://r3code.ru/projects/multi-derevo/multi-derevo-jquery-v4-utf8.html">an example</a> . <br><br>  I also want to make a modification with cookies, which will remember all the expanded subtrees, i.e.  If the user previously expanded the tree and then turned the top level, then about the deployment, the nested tree will also be expanded.  And of course all the status thanks to cookies will be saved when switching between pages. <br><br>  Tell HabrNarod that this topic fits into this block, or you can transfer everything to web development or jQuery - I doubt it. </div><p>Source: <a href="https://habr.com/ru/post/56870/">https://habr.com/ru/post/56870/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../56859/index.html">Flash banners: changing the banner link using the <object> parameters in the page code</a></li>
<li><a href="../56860/index.html">CSS Naked Day</a></li>
<li><a href="../56864/index.html">PHP code variant to output a string in the plural</a></li>
<li><a href="../56865/index.html">Disabled chariot</a></li>
<li><a href="../56869/index.html">Windows was blocked ... in a funny way :)</a></li>
<li><a href="../56873/index.html">Semi-automatic tagging - solution</a></li>
<li><a href="../56874/index.html">New type of transport: skateboard on tracks with electric</a></li>
<li><a href="../56875/index.html">Web services monetization: business models</a></li>
<li><a href="../56876/index.html">My rating</a></li>
<li><a href="../56878/index.html">YouTube launches Click-To-Buy in 8 more countries</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>