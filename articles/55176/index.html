<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Moving from SimpleTest to PHPUnit</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Background: One of the critical parts of the project code is covered by unit tests based on the SimpleTest framework. In connection with the transitio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Moving from SimpleTest to PHPUnit</h1><div class="post__text post__text-html js-mediator-article">  Background: One of the critical parts of the project code is covered by unit tests based on the SimpleTest framework.  In connection with the transition to PHPUnit, it was necessary to adapt existing tests for a new test framework. <br>  And it was necessary to leave the running tests in SimpleTest mode, well, and get them to work in PHPUnit.  The code for the tests themselves is naturally the same. <br><br>  Three key points were highlighted where there are differences between SimpleTest and PHPUnit: <br><ul><li>  1. Run tests </li><li>  2. Used methods of checking and inheritance </li><li>  3. Processing test results </li></ul><br><a name="habracut"></a><br><br>  Which framework should work is defined very simply, if the constant <b>PHPUNITRUN</b> == true, then PHPUnit works, otherwise SimpleTest 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  1. Run tests </h3><br>  Consider the differences with if and put the results in $ reporter: <br> <code>if (PHPUNITRUN) { // PHPUnit run <br> $testSuite = new PHPUnit_Framework_TestSuite( $testCase ); <br> $testSuite-&gt;addTestSuite( $testCase ); <br> $reporter = PHPUnit_TextUI_TestRunner::run( $testSuite ); <br> } <br> else { // SimpleTest run <br> $testSuite = new TestSuite(); <br> $testSuite-&gt;addTestClass( $testCase ); <br> $testSuite-&gt;run( $reporter ); <br> } <br></code> <br><br><h3>  2. Used methods of checking and inheritance </h3><br>  Each framework requires test cases to be inherited from specific base classes. <br>  This distinction is solved as follows, at the same time the differences between the name of the verification methods are taken into account.  For example, in PHPUnit, the <b>assertIsA ($ actual, $ expected, $ message = '')</b> <b>method</b> sounds like <b>assertType ($ expected, $ actual, $ message)</b> : <br> <code>if ( PHPUNITRUN ) { <br> <br> class Overload_TestCase extends PHPUnit_Framework_TestCase { <br> <br> protected $backupGlobals = false; <br> <br> public static function assertIsA($actual, $expected, $message = '') <br> { <br> self::assertType($expected, $actual, $message); <br> } <br> <br> public static function assertNotA($actual, $expected, $message = '') <br> { <br> self::assertNotType($expected, $actual, $message); <br> } <br> <br> public static function assertTrue($condition, $message = '') <br> { <br> parent::assertTrue((bool)$condition, $message); <br> } <br> <br> public static function assertFalse($condition, $message = '') <br> { <br> parent::assertFalse((bool)$condition, $message); <br> } <br> <br> public static function assertEqual($expected, $actual, $message = '') <br> { <br> self::assertEquals($expected, $actual, $message); <br> } <br> } <br> } <br> else { <br> class Overload_TestCase extends UnitTestCase { <br> } <br> } <br></code> <br><br>  All test cases of the project are inherited from the <b>Overload_TestCase</b> class.  Thus, each test case is inherited from the base class required for a particular framework. <br><br>  3. Processing test results <br>  Test results are stored in the $ reporter object. <br>  For further processing of the results (saving to the database, sending letters, if problems are identified, etc.), the standard <b>HtmlReporter</b> from SimpleTest is brought to the <b>PHPUnit_Framework_TestResult</b> interface from PHPUnit. <br> <code>class NewHtmlReporter extends HtmlReporter <br> { <br> /** <br> * Gets the number of detected errors. <br> * <br> * @return integer <br> */ <br> public function errorCount() <br> { <br> return $this-&gt;_exceptions; <br> } <br> <br> /** <br> * Gets the number of detected failures. <br> * <br> * @return integer <br> */ <br> public function failureCount() <br> { <br> return $this-&gt;_fails; <br> } <br> <br> /** <br> * Gets the number of run tests. <br> * <br> * @return integer <br> */ <br> public function count() <br> { <br> return $this-&gt;_passes; <br> } <br> }; <br></code> <br><br>  Now tests can be run and processed both in SimpleTest mode and in PHPUnit mode. </div><p>Source: <a href="https://habr.com/ru/post/55176/">https://habr.com/ru/post/55176/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../55169/index.html">How to read Habrahabr from a cell phone screen.</a></li>
<li><a href="../5517/index.html">The opus about the family of jacks or why everything is bad in Russia</a></li>
<li><a href="../55170/index.html">Operating experience BlackBerry 8800</a></li>
<li><a href="../55172/index.html">About the dash in the ranges. Finally it came to him.</a></li>
<li><a href="../55173/index.html">"Home office", or when you do not need to go to work</a></li>
<li><a href="../5518/index.html">"Insulating tape"</a></li>
<li><a href="../55181/index.html">Network infrastructure: AS, PI, LIR and other goodies. :)</a></li>
<li><a href="../55182/index.html">What's in the box?</a></li>
<li><a href="../55185/index.html">PHP 5.3 programming</a></li>
<li><a href="../55187/index.html">Twit. Continued.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>