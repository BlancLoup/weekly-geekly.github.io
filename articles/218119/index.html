<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What is a switch and how to deal with it?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A program without branching is a very simple and strange program. The program should think, figure out the options, respond differently to various ext...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What is a switch and how to deal with it?</h1><div class="post__text post__text-html js-mediator-article">  A program without branching is a very simple and strange program.  The program should think, figure out the options, respond differently to various external influences and not be monotonous at all.  And this is all impossible without branching.  Branches are implemented using the if and switch statements.  So why bother with him? <br><a name="habracut"></a><br>  Periodically, when viewing someone else's code, I come across long methods and cumbersome constructions of nested if and switch.  For example, such: <br><br><pre><code class="hljs pgsql">//     Objective C,           - (NSUInteger)numberOfItemsInSection:(NSUInteger)section { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (self.loggedIn) { swtich (section) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (self.settings.showDetails) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { swtich (section) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (self.settings.showDetails) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>; } } }</code> </pre> <br><br>  Me personally, such methods are scary and they just do not fit in my head.  The first thing that is asked is to give names to all magic numbers.  For example: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SectionIndex</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-type"><span class="hljs-type">LoginSection</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-type"><span class="hljs-type">DetailsSection</span></span>, <span class="hljs-type"><span class="hljs-type">ExtendedSection</span></span> }</code> </pre><br><br>  But if you take a closer look, we do not consider LoginSection if the value is set to self.loggedIn and hide DetailsSection if the value of self.settings.showDetails is reset.  But we simply convert the value of section to SectionIndex based on the current state: <br><br><pre> <code class="hljs objectivec">- (SectionIndex)sectionIndexForSection:(<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)section { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.loggedIn) { ++section; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.settings.showDetails) { ++section; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (SectionIndex)section; } - (<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)numberOfItemsInSection:(<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)section { SectionIndex sectionIndex = [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> sectionIndexForSection:section]; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (sectionIndex) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> LoginSection: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> numberOfItemsInLoggedInSection]; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> DetailsSection: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> numberOfItemsInDetailsSection]; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ExtendedSection: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> numberOfItemsInExtendedSection] } } }</code> </pre><br><br>  In my opinion, it already looks much nicer, especially considering that there are usually several such branches in an object.  For example, -titleForItem: inSection :, -performActionForItem: inSection:, etc.  But what if we recall that our language is object-oriented, and the state of the system can be brought into an object-state?  Then all these methods will be reduced to one line - referring to the state object? <br><br><pre> <code class="hljs objectivec">- (<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)numberOfSections { retun [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.state numberOfSections]; } - (<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)numberOfItemsInSection:(<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)section { retun [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.state numberOfItemsInSection:section]; } - (<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *)titleForItem:(<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)item inSection:(<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)section { retun [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.state titleForItem:item inSection:section]; } - (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)performActionForItem:(<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)item inSection:(<span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span>)section { retun [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.state performActionForItem:item inSection:section]; }</code> </pre><br><br>  In my opinion, quite beautiful.  It remains only to get somewhere from this very state.  You can configure state objects in the object itself or write several classes that define states. <br><br><pre> <code class="hljs markdown">@interface State : NSObject @property (nonatomic, strong) NSArray <span class="hljs-emphasis"><span class="hljs-emphasis">*sections; // ... @end @implementation State - (NSUInteger)numberOfSections { return [self.sections count]; } - (NSUInteger)numberOfItemsInSection:(NSUInteger)section { return [self.sections[section] count]; } - (NSString *</span></span>)titleForItem:(NSUInteger)item inSection:(NSUInteger)section { return self.sections[<span class="hljs-string"><span class="hljs-string">section</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">item</span></span>][<span class="hljs-string"><span class="hljs-string">@"title"</span></span>]; } - (void)performActionForItem:(NSUInteger)item inSection:(NSUInteger)section { void(^actionBlock)() = self.sections[<span class="hljs-string"><span class="hljs-string">section</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">item</span></span>][<span class="hljs-string"><span class="hljs-string">@"action"</span></span>]; actionBlock(); } //   - (void)setupForState { NSMutableDictionary <span class="hljs-emphasis"><span class="hljs-emphasis">*state = [NSMutableDictionary dictionary]; if (self.loggedIn) { [state addObject:[self loggedInSection]]; } if (self.showDetails) { [state addObject:[self detailsSection]]; } [state addObject:[self extendedSection]]; self.sections = state; } - (NSArray *</span></span>)loggedInSection {...} - (NSArray <span class="hljs-emphasis"><span class="hljs-emphasis">*)detailsSection {...} - (NSArray *</span></span>)extendedSection {...} // ...</code> </pre><br><br>  It turns out that we got rid of branches in several places, replacing it with one setting of the state, and the states themselves turned out to be complete, understandable and collected in one place. </div><p>Source: <a href="https://habr.com/ru/post/218119/">https://habr.com/ru/post/218119/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../218105/index.html">Overview of the Highscreen Zera F smartphone: "skit" from the flagships for 3,990 rubles</a></li>
<li><a href="../218107/index.html">Windows 8 on Intel Galileo now, for free already in the plans of Microsoft!</a></li>
<li><a href="../218109/index.html">Tame ZoG (Part 5: Mana Collection)</a></li>
<li><a href="../218113/index.html">A thousand and one gif</a></li>
<li><a href="../218115/index.html">Run Windows Server 2012R2 from a VHDX file from a USB disk through UEFI</a></li>
<li><a href="../218121/index.html">How to write a "skorochitku" for iOS in half an hour</a></li>
<li><a href="../218123/index.html">Unity 3D Web Player on Linux via Pipelight</a></li>
<li><a href="../218125/index.html">dub: dependency manager for D language</a></li>
<li><a href="../218127/index.html">#FailOverConf on May 23 in Moscow. Why do you need to be ...</a></li>
<li><a href="../218129/index.html">Urthecast - Hello, World!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>