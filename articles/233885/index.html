<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>JSOC: the experience of the young Russian MSSP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As part of the corporate blog, I would like to launch a series of articles about our young (but, nevertheless, very bright) initiative in the field of...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>JSOC: the experience of the young Russian MSSP</h1><div class="post__text post__text-html js-mediator-article">  As part of the corporate blog, I would like to launch a series of articles about our young (but, nevertheless, very bright) initiative in the field of information security - the JSOC (Jet Security Operation Center) - a commercial center for monitoring and responding to incidents.  In the articles I will try to do less self-promotion and pay more attention to practice: our experience and the principles of building a service.  Nevertheless, this is my first "habro-experience", and therefore do not judge strictly. <br><br><h4>  SOC - prerequisites </h4><br>  I don‚Äôt really want to tell why a large Russian company is needed at all (there are too many different articles and studies on this subject written).  But statistics is another matter, and it is a sin not to remember about it.  For example: <br><ul><li>  in a company of from 1 to 5 thousand people during the year fixed: <br><ul><li>  90 million security events; </li><li>  16,865 events with suspicion of the incident; </li><li>  109 real IS incidents; </li></ul></li><li>  total losses from IS incidents in 2013 amounted to $ 25 billion; </li><li>  a large company uses at least 15 dissimilar protection tools, not more than 7 of them conduct active log analysis to detect incidents. </li></ul><br>  If we add to this another 3-4 news headlines on the relevant topic, then the idea that security needs to be monitored and information security incidents to identify and analyze is absolutely logical and understandable. <br><a name="habracut"></a><br>  What do security experts advise on this issue?  Of course, make the SIEM solution the core of an existing or under construction SOC.  This will solve several problems at once: <br><ul><li>  to close the incidents recorded by other systems independently, within the framework of one single core incident management; </li><li>  get a convenient tool to search for necessary events, investigate incidents, store the collected data; </li><li>  identify statistical deviations and slowly developing incidents by analyzing large intervals and amounts of information from specific remedies; </li><li>  compare and correlate data from different systems, and, as a result, build complex chains of incident detection scenarios, ‚Äúenrich‚Äù information in the logs of some systems with data from others. </li></ul><br><h4>  Some common methodology </h4><br>  There are several levels of SOC-SOMM maturity (Security Operations Maturity Model): <br><div style="text-align:center;"><img src="https://habrastorage.org/files/22d/acb/9ac/22dacb9ac0b047df90fe89725a19d3ca.jpg" alt="SOMM levels"></div><br>  <b>Fig.</b>  <b>1 - SOMM Levels</b> <br><br>  Unfortunately, most companies, having taken the first step on the way to their own incident monitoring center, stop there.  According to HP estimates, 24% SOC in the world do not reach level 1, and only 30% SOC correspond to the base (2) level.  Statistics of the distribution of SOMM levels depending on the business area of ‚Äã‚Äãcompanies, collected in 13 countries of the world (including Canada, USA, China, UK, Germany, South Africa, etc.) is as follows: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/26b/d32/71b/26bd3271bccd41d98a106ab85aaf7e9f.gif" alt="Distribution of SOMM Levels by Business Area"></div><br>  <b>Fig.</b>  <b>2 - Distribution of SOMM levels by business area</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  SOC in-house: issues </h4><br>  At the same time, almost all large Russian companies passed through the implementation of large-scale SIEM solutions.  Did they manage to build effective SOC `s?  Unfortunately, most often not: today we know the experience of only four successful SOC launches in Russia. <br><br>  And, as a rule, when starting to build your own SOC, everyone faces three facets of one problem. <br><br>  First, with a quantitative shortage of personnel for a variety of reasons: from personnel shortage and the lack of specialized universities to the difficulty of acquiring the required competencies.  De facto, within the framework of the it-security unit, today there are 4‚Äì5 people who carry out the entire cycle of work to ensure the security of a company (from administering protective equipment to regular risk analysis and developing a strategy for the development of the subject matter in the company).  Naturally, with such a load, it is almost impossible to devote the proper time to SOC tasks. <br><br>  The second point is related to the impossibility of building an effective monitoring process with internal SLAs.  In addition to the need to allocate personnel, the launch of SOC usually entails the creation in the it-security unit of a full-time shift shift, working on an extended working day or around the clock.  And this is from 2 to 5 new staff units.  At the same time, the allocation of personnel is directly related to the need for continuous monitoring of personnel turnover (extremely rarely IB specialists are ready to work in the night shift), building processes and internal quality control of the work performed. <br><br>  Well, the third point is not to mention the need not only to handle emerging incidents, but also to constantly ‚Äútune‚Äù and adjust the system to changing infrastructure or emerging security threats.  And this, regardless of the chosen instrument, is a very time-consuming task for the analyst, requiring you to keep your finger on the pulse.  And the presence of a person engaged in clean analytics and SOC development is a great luxury (even for a large company). <br><br>  Estimating the need for creating SOC on the market together with the described nuances led us first to the idea and then to actually build our own commercial SOC. <br><br><h4>  Platform Selection </h4><br>  Naturally, starting SOC, we first of all faced the question: ‚ÄúWhat kind of SIEM solution should be made the core of our system‚Äù?  Responding to it, we have formed a list of requirements for the system being created.  In particular, it should: <br><ul><li>  allow physically and logically to separate the accumulated data for different resource pool (in our case - for different customers) with the possibility of separation of access rights; </li><li>  allow building the most complex chains and interrelations between events, using various reference books and events to supplement the incident with important information.  At the same time, we needed a framework for building our own logic for identifying incidents rather than rules and scenarios already written; </li><li>  to have the possibility of writing and developing integration buses both in the direction of source systems (and here maximum flexibility in writing connectors to target systems / directories is of key importance) and api for bundling with external incident management, reporting and visualization systems; </li><li>  allow customization of internal resources for changing SOC tasks.  In particular, the creation of an internal profile of monitoring sources, maintaining and customizing their incident management, etc.  (By the way, these surveys will be the subject of a separate article). </li></ul><br>  We stopped our choice on the flagship product in the SIEM - HP ArcSight class (and, despite various difficulties in the life of the system, we never regretted our choice).  Technologically, JSOC is no longer just HP ArcSight.  SIEM `s core gradually acquired various useful features: traffic monitoring, ips \ ids, vulnerability assessment, etc.  At the same time, we have accumulated a large number of scripts, add-ons and our own developments, integrated with our own Security Intelligence solution (JiVS), which is: <br><ul><li>  a tool for high-level search for anomalies at the client and tracking general trends in activities and incidents; </li><li>  control system and visualization of our performance of SLA to the customer; </li><li>  an effective visual dashboard and reporting system for customer business management. </li></ul><br>  As a result, we have formed such protection profiles / lines for identifying incidents with customer companies, such as: <br><ul><li>  attacks on external web resources of the company; </li><li>  unauthorized access to systems and applications; </li><li>  comprehensive security of business applications; </li><li>  virus and malware activity on the company's network, including heuristic detection of zero-day viruses; </li><li>  violation of the policy of using remote access to the company's network; </li><li>  Illegitimate actions of users when accessing the Internet and working with external devices; </li><li>  anomalies in the authentication and use of accounts; </li><li>  and other categories of incidents depending on the company's infrastructure, its internal IS policies and the means of protection used. </li></ul><br><h4>  Infrastructure </h4><br><div style="text-align:center;"><img src="https://habrastorage.org/files/1f4/9ee/815/1f49ee81501b4579b8697a30aa91dfec.gif" alt="JSOC Service Infrastructure"></div><br>  <b>Fig.</b>  <b>3 - JSOC service infrastructure</b> <br><br>  After the selection of the main technological platform, it was necessary to solve the problems of creating the infrastructure and determine the location of the location.  The experience of our Western colleagues shows that the target accessibility of the architecture should be at least 99.5% (and with maximum cataclysm resistance).  At the same time, the question of geography remained fundamental: collocation is possible only within the borders of the Russian Federation, which excluded for us the possibility of using popular western providers.  Natural questions of providing information security infrastructure at all levels of access were superimposed here, and we, by and large, have no choice left: we turned to the team of our ITC.  As part of a large colocation for our JSOC, we specifically identified a fragment where we were able to deploy our architecture, while at the same time tightening up the security profiles that already exist within the ETSC.  The IT infrastructure is deployed in the Tier 3 data center of our company, and its availability rates are 99.8%.  As a result, we were able to reach the target indicators of the availability of our service and received substantial freedom of action in the work and adaptation of the system for ourselves. <br><br><h4>  Team </h4><br>  At the initial launch of the service, the JSOC team consisted of 3 people: two monitoring engineers closing the time interval from 8 to 22 hours, and one analyst / administrator who was involved in the development of the rules.  The SLA for the service, indicated to the clients, was also quite mild: the reaction time to the detected incident was up to 30 minutes, the time for analysis, preparation of analytical information and informing the client was up to 2 hours.  But, after the first months of work, we made some very significant conclusions: <br><ol><li>  The monitoring shift must necessarily work in the 24 * 7 mode.  Despite the significantly smaller number of incidents in the evening and at night, the most important and critical events (the launch of DDoS attacks, the final phases of slow attacks on penetration through the outer perimeter, malicious actions of counterparties, etc.) occur all the same at night and by the time of the start of the morning shift already lose their relevance. </li><li>  The time to resolve a critical incident should not exceed 30 minutes.  Otherwise, the chances of preventing it or minimizing damage significantly catastrophically fall. </li><li>  To ensure the required time for analysis, a full-fledged toolkit for its investigation should be prepared for each incident: active channels with filtered target events for analysis, trends showing statistical changes in suspicious activities and targeted analytical reports to quickly analyze activities and make operational decisions. </li><li>  The administration team for the protection of our customers should be separated from the monitoring and incident detection team.  Otherwise, the risk of the influence of the human factor in the chain ‚Äúmade changes to the configuration ‚Äî recorded the incident in fact ‚Äî indicated a false response‚Äù could have a significant effect on the quality of our service. </li></ol><br>  In practice, all these conclusions resulted in the creation within the framework of the Information Security Company Jet Infosystems a separate structural unit focused on a three-tier model for ensuring each of the tasks: both monitoring and resolving incidents, and administering protection.  Now the division has more than 30 people, has a formed structure (see. Fig. 4) and includes: <br><ul><li>  2 duty shifts that work 24 * 7: one is engaged in monitoring and analysis of incidents, the other - the system administration; </li><li>  dedicated development team, abstracted from operational activities within our customers, and allowing us to maintain the relevance of the service and threat monitoring profile. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/files/1f7/d40/6df/1f7d406df1f54c34af37df8e223461dd.gif" alt="JSOC organizational structure"></div><br>  <b>Fig.</b>  <b>4 - JSOC Organizational Structure</b> <br><br>  This organizational structure allowed us to reach the following SLA targets: <br><table><tbody><tr><th colspan="2">  Jet Security Operation Center Parameters </th><th>  Base </th><th>  Advanced </th><th> Premium </th></tr><tr><th colspan="2">  Service time </th><td>  8 * 5 </td><td>  24 * 7 </td><td>  24 * 7 </td></tr><tr><th rowspan="2" width="200">  Incident Detection Time (min) </th><th width="200">  Critical Incidents </th><td>  15-30 </td><td>  10-20 </td><td>  5-10 </td></tr><tr><th>  Other incidents </th><td>  up to 60 </td><td>  up to 60 </td><td>  up to 45 </td></tr><tr><th rowspan="2">  The time of basic diagnosis and informing the customer (min) </th><th>  Critical Incidents </th><td>  45 </td><td>  thirty </td><td>  20 </td></tr><tr><th>  Other incidents </th><td>  up to 120 </td><td>  up to 120 </td><td>  up to 90 </td></tr><tr><th rowspan="2">  The time of issue of recommendations on counteraction </th><th>  Critical Incidents </th><td>  up to 2 h </td><td>  up to 1.5 h </td><td>  up to 45 min </td></tr><tr><th>  Other incidents </th><td>  up to 8 h </td><td>  up to 6 h </td><td>  up to 4 h </td></tr></tbody></table><br>  At the moment, we serve already 12 clients and solve the tasks facing us to ensure their information security.  These are the results of the first one and a half years of JSOC. <br><br><hr><br>  I hope this material did not seem to you too marketing.  In future articles we plan to cover topics such as: <br><ul><li>  SOC availability: what it is, what it is made of and how to measure it; </li><li>  How far the path from the correlation rule in the SIEM to the working incident detection scenario is; </li><li>  Organizational issues: what to teach and not to teach SOC specialists; </li><li>  A little practice on the analysis of incidents. </li></ul><br><hr><br>  To be continued ...;) <a href="http://habrahabr.ru/users/dryukov/" class="user_link">dryukov</a> </div><p>Source: <a href="https://habr.com/ru/post/233885/">https://habr.com/ru/post/233885/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../233875/index.html">The principle of Level-up in the management of the company: use with caution</a></li>
<li><a href="../233877/index.html">Why shouldn't the software be free?</a></li>
<li><a href="../233879/index.html">Developer Stories: Trekkit Traveler</a></li>
<li><a href="../233881/index.html">What happens to the smart wearables?</a></li>
<li><a href="../233883/index.html">Trivial SMS alert when server \ hardware is unavailable</a></li>
<li><a href="../233889/index.html">Working with graphic objects in Android</a></li>
<li><a href="../233891/index.html">The big story about BlackHat USA'2014</a></li>
<li><a href="../233895/index.html">Why Habr popular science?</a></li>
<li><a href="../233897/index.html">Docsvision database structure. From developer to developer!</a></li>
<li><a href="../233899/index.html">Integrating Git into Sublime Text</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>