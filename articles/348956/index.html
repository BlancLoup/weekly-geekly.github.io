<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Installation of a certification authority in the enterprise. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue our series of articles about the certification authority in the enterprise. Today we'll talk about building a public key diagram, planning...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Installation of a certification authority in the enterprise. Part 2</h1><div class="post__text post__text-html js-mediator-article">  We continue our series of articles about the certification authority in the enterprise.  Today we'll talk about building a public key diagram, planning the name of the certification authority, planning certificate revocation lists and a few other points.  Join now! <br><br><img src="https://habrastorage.org/webt/l5/km/nm/l5kmnmr4vwebza_ffcfoxkghjam.jpeg"><a name="habracut"></a><br><br><blockquote>  <a href="https://habrahabr.ru/company/microsoft/blog/348944/"><i>The first part of the series</i></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="https://habrahabr.ru/company/microsoft/blog/349202/"><i>Third part of the series</i></a> </blockquote><br><h2>  Introduction </h2><br><h4>  Glossary </h4><br>  The following abbreviations and abbreviations have been used in this part of the series: <br><br><ul><li>  <b>PKI</b> ( <i>Public Key Infrastructure</i> ) is a public key infrastructure, a set of tools (technical, material, human, etc.), distributed services and components, used together to support crypto tasks based on private and public keys.  Since the abbreviation PKI is not common, hereafter, the more familiar English-language abbreviation PKI will be used. </li><li>  <b>X.509</b> is the ITU-T standard for public key infrastructure and privilege management infrastructure. </li><li>  <b>CA</b> ( <i>Certification Center</i> ) - a service that issues digital certificates.  A certificate is an electronic document confirming that the public key belongs to the owner. </li><li>  <b>CRL</b> ( <i>Certificate Revocation List</i> ) - certificate revocation list.  A signed electronic document published by the CA and containing a list of revoked certificates whose validity was terminated due to external reasons.  For each revoked certificate, its serial number, date and time of revocation, as well as the reason for revocation (optional) are indicated.  Applications can use the CRL to confirm that the certificate presented is valid and not revoked by the publisher ... Applications can use the CRL to confirm that the certificate presented is valid and not revoked by the publisher. </li><li>  <b>SSL</b> ( <i>Secure Sockets Layer</i> ) or <b>TLS</b> ( <i>Transport Layer Security</i> ) is a technology that ensures the security of data transmission between a client and a server over open networks. </li><li>  <b>HTTPS</b> ( <i>HTTP / Secure</i> ) - secure HTTP, is a special case of using SSL. </li><li>  <b>Internet PKI</b> is a set of standards, agreements, procedures and practices that provide a single (unified) data transmission protection mechanism based on the X.509 standard over open data transmission channels. </li><li>  <b>CPS</b> ( <i>Certificate Practice Statement</i> ) is a document that describes the procedures for managing public key infrastructure and digital certificates. </li></ul><br><h2>  General planning issues </h2><br>  For the successful implementation of any technical solution, careful planning is necessary.  PKI implementation is no exception.  Moreover, if in certain cases, initial planning errors can be corrected relatively quickly and easily, then this is definitely not the case in PKI.  As I have already noted, PKI services are designed to work for many years with minimal (or noncritical) changes in the course of work. <br><br>  For example, the validity of CA certificates is about 10-20 years.  One of the reasons for such a long lifespan is that reissuing these certificates is a somewhat time consuming operation and may require changes on a large number of clients.  This is aggravated by the fact that changes will be required on clients to whom you may not have access.  Another point is that when you make some changes to the PKI architecture, you will need to maintain the current configuration for the lifetime of the certificates already issued.  In other words, for the new certificates, the new configuration will act, but in parallel with it, it will be necessary to maintain the previous configuration so that the already issued certificates can work correctly.  This also adds difficulty in maintaining PKI in a healthy state. <br><br>  Given these points, planning a PKI should be approached very seriously.  And only then will the PKI successfully perform its functions in ensuring digital security over the long term. <br><br>  The multi-stage planning process is based on a logical diagram of the selected model.  At each stage, the elements of the diagram unfold (elaborate) and the relations, tasks and requirements are formalized for it.  If necessary, the detailing continues until a fully formalized system is obtained.  This article shows an example of such an approach to planning. <br><br><h2>  PKI Plotting </h2><br>  As I said, it all starts with a logical diagram of the selected model.  The logical diagram displays all the components of the PKI and must be transferred to the physical topology.  In the case of the use of a two-tier PKI model, this diagram may have the following form: <br><br><img src="https://habrastorage.org/webt/lj/wn/oj/ljwnojwuwhclhsfet8bw6fvsfp0.jpeg"><br><br>  The diagram shows the following components and their logical connections: <br><br><ul><li>  <b>Root CA</b> - issues a certificate only to a subordinate CA and publishes its certificate and revocation lists to the revocation server (Revocation Server); </li><li>  <b>Slave (intermediate) CA</b> - issues certificates to end users and publishes its certificate and revocation lists to the revocation server.  At the same time, it downloads the revocation list of the root CA from the revocation server; </li><li>  <b>Revocation Server</b> - is a repository of CA certificates and revocation lists that any client can download; </li><li>  <b>Client connections</b> - get their certificates from a subordinate CA and download revocation lists from the revocation server. </li></ul><br>  The physical topology will be slightly different and look like this: <br><br><img src="https://habrastorage.org/webt/1z/u6/ne/1zu6neovmzciqucc3xeibtagl5u.jpeg"><br><br>  In the physical topology, it is explicitly stated that the revocation server is accessible to all clients, both inside and outside the network, so that clients can check certificates anywhere. <br><br><h2>  CA Name Planning </h2><br>  The CA name is the name that will be displayed in the <code>Subject</code> field of a specific CA.  Not to be confused with the name of the host on which the certificate service is running.  The full name of the CA will consist of two components, the name itself (CN attribute or Common Name) and an optional X.500 suffix.  By default, ADCS assigns a name in the following format: <br><br>  For Standalone CA: &lt; <code>ComputerName</code> &gt; - <code>CA</code> <br><br>  For Enterprise CA: &lt; <code>DomainShortName</code> &gt; - &lt; <code>ComputerName</code> &gt; - <code>CA,</code> &lt; <code>X500DomainSuffix</code> &gt; <br><br>  Is it good or bad?  Technically, you can choose any name, functionally it will not affect anything.  It is believed that the name of your CA is somewhat of a business card of your PKI, reflecting your attitude to details that are not directly related to the functionality, but provide a sufficient level of information and openness.  Therefore, when choosing the full name of the certificate you should follow several recommendations: <br><br><ul><li>  The name should reflect the name of the organization (it can be abbreviated) and the role of the specific CA in the hierarchy (attribute CN, Common Name); </li><li>  The suffix should reflect the name of the department or division that is responsible for its management in the attribute OU (Organizational Unit); </li><li>  Duplicate the full name of the organization (attribute O, Organization); </li><li>  Legal location of the CA.  For this it is enough to use the attributes L (Locality) and C (Country).  As a rule, this is the name of the city and country where the organization is legally registered.  If necessary, you can specify the state / region using the S attribute (State). </li></ul><br>  Suppose you select a name for the root CA of Contoso Pharmaceuticals Ltd., which you find in Riga, Latvia, and the management is provided by the information technology department.  In this case, the name of the CA can be as follows: <br><br><pre> <code class="cs hljs">CN=Contoso Pharm Root Certification Authority, OU=<span class="hljs-function"><span class="hljs-function">Division Of </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IT</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DoIT</span></span></span><span class="hljs-function">), O</span></span>=Contoso Pharmaceuticals Ltd., L=Riga, C=LV</code> </pre> <br>  Note that the Country attribute only supports a two-letter country index.  For example, LV, GB, RU, US, etc.  As additional examples, you can refer to CA certificates of commercial providers like VeriSign / Symantec, DigiCert, etc.  For a subordinate CA, this name will be similar, except that the word Root in the name will be replaced by Subordinate or Issuing.  In the case of a three-level hierarchy, where the CA of the politician is clearly distinguished, the word Root will be replaced with the Policy.  As I noted above, other rules may apply in your company, and you can embed them in the names of the CA, this will not affect the functionality.  You should avoid: <br><br><ul><li>  Excessively long names in the CN attribute (no more than 50 characters).  If the length of the CN attribute is over 51 characters, it will be shortened with the hash attachment of the discarded name fragment to the end of the name.  This is called the sanitizing process of the name, which is described in <a href="https://msdn.microsoft.com/en-us/library/cc249826.aspx">¬ß3.1.1.4.1.1 of</a> the [ <a href="https://msdn.microsoft.com/en-us/library/cc249879.aspx">MS-WCCE</a> ] protocol.  Those.  it may happen that if the name is too long, the word will break off in the middle and will have an unsightly appearance. </li><li>  Use letters that are not part of the Latin alphabet, i.e.  no krillitsy or diacritical letters (for example, ƒÅ, ≈æ, √ú, ·∫û).  ADCS only supports single-byte character encodings for the CN attribute and for a limited set of characters.  Unsupported characters will be converted to another encoding and will become unreadable.  A complete list of prohibited characters is provided in <a href="https://msdn.microsoft.com/en-us/library/cc249743.aspx">¬ß3.1.1.4.1.1.2 of</a> the [ <a href="https://msdn.microsoft.com/en-us/library/cc249879.aspx">MS-WCCE</a> ] protocol.  The principle of ‚Äúthe best is the enemy of the good‚Äù works here, so the names should be sufficiently concise and informative. </li></ul><br><h2>  Scheduling Call List (CRL) </h2><br>  In accordance with the logical diagram, each CA will publish its own revocation list.  Feedback lists will be described in two main categories: <br><br><ol><li>  Points of publication and distribution of revocation lists; </li><li>  Composition and validity of revocation lists. </li></ol><br><h4>  Points of publication and distribution of revocation lists </h4><br>  Two types of CRL distribution points are used to publish revocation lists: the publication point (where the physical file will be recorded) and the distribution point (receipt) of the file. <br><br>  The first point type indicates the local or network path (in UNC format) where the file will be written.  The second type of points will be registered in the issued certificates with an indication of the way in which customers can download the revocation list.  These paths are published in the CRL Distribution Points certificate extension.  In general, these paths will not be the same (except for the LDAP protocol, where the publication and distribution paths are the same).  In determining the points of publication should be guided by the following rules: <br><br><ul><li>  For the root CA, a strictly local path is specified, since this server will be isolated from the network.  Copying the file to the distribution server (IIS) will be done manually.  This is not a problem, since the frequency of publication of revocation lists for the root CA will be measured in months (see below for more on this). </li><li>  For issuing CAs, the network path is indicated.  I recommend creating a shared folder in DFS, which can easily be defined as a virtual directory in IIS.  In this case, the process of publishing a physical file to the distribution point will be fully automated. </li><li>  LDAP should not be used to publish and distribute revocation lists. </li></ul><br>  You can read more about planning CRL Distribution Points and Authority Information Access extensions and practices in my blog article: <a href="https://www.sysadmins.lv/blog-en/designing-crl-distribution-points-and-authority-information-access-locations.aspx">Designing CRL Distribution Points and Authority Information Access locations</a> . <br><br><h4>  The list of reviews </h4><br>  Before planning the composition and validity of revocation lists, it is necessary to understand the purpose of revocation lists and the optimal parameters depending on their operating conditions.  As you know, each CA periodically publishes lists of reviews, which include lists of all certificates that have been revoked by a specific CA.  And each list includes all revoked certificates for the entire CA lifetime.  With a CA's lifespan, for example, in 10 years, this list can grow to an impressive size (on the order of several megabytes). <br><br>  Even with high-speed connections, revocation list traffic will be substantial in size, since  all certificate consumers need the latest revocation list version. <br>  To reduce the traffic of revocation lists, two types of CRLs are published: base (Base CRL) and differential (Delta CRL).  The basic list includes a complete review list.  The differential list includes only a list of revoked certificates that have been revoked since the last publication of the base CRL.  This allows you to publish a basic list less frequently and for a longer period, and to speed up customer response times to revoked certificates, in the meantime, issue several short-lived differential CRLs. <br><br>  The selection of parameters depends on several factors.  For example, the planned volume of issued certificates and the planned volume of revocation.  Consider typical scenarios. <br><br>  <b>Root CA</b> <br><br>  The root CA issues certificates only to intermediate CAs, the number of which is usually within a dozen.  The validity period of intermediate CAs is comparable to the lifetime of the root CA certificate.  It is also assumed that the risk of withdrawal from downstream CAs is very low, as they are managed by trained personnel and are provided with appropriate security measures.  Therefore, it can be argued that the volume of the revocation list may include only a small number of revoked certificates and, accordingly, the CRL file will be guaranteed to be small in size. <br><br>  <i>Help: how to calculate the planned size of the CRL file based on the amount of feedback?</i>  <i>A typical empty CRL takes about 600-800 bytes.</i>  <i>Each certificate revocation entry is 88 bytes.</i>  <i>Based on these values, you can calculate the size of the CRL, depending on the number of revoked certificates.</i> <br><br>  It follows that throughout the lifetime of the root CA, the revocation list will be within 1kb and there is no point in the differential CRL. <br><br>  <b>Publishing CA</b> <br><br>  For the publishing CA, the picture changes.  The volume of certificates issued is already high, it can be thousands and millions of pieces.  Consumers are users and devices that are at high risk of revocation, since they are not under the constant supervision of qualified personnel, and it is impossible to provide adequate measures.  As a result, the review list can reach serious sizes.  For example, if you lay a 10% risk of revocation, then a million certificates issued account for about 100k revoked.  100k records of 88 bytes will be a little less than 10mb.  It is not very practical to update the file on 10mb very often, it is more expedient to publish it less often, and to distribute several lightweight differential Delta CRLs between publications of the main CRL.  Those.  if only a basic revocation list is sufficient for a root CA, then deltas should be used for CAs issuing certificates to end users. <br><br><h4>  CRL scheduling validity </h4><br>  It was all about the composition of the revocation lists for each CA.  Now we need to determine the dates: <br><br><ul><li>  How long should a review list be published? </li><li>  How long the information in it can be considered reliable and quite relevant? </li></ul><br>  Here, too, you can apply the approach depending on the operating conditions.  The risk of withdrawing an intermediate CA is very low, therefore, there is no point in publishing an empty CRL too often.  In modern practice, the following typical values ‚Äã‚Äãare applied for the CRL validity period for a CA, which issue certificates only to another CA: 3, 6 or 12 months.  Here it is necessary to build on the degree of risk and administrative costs of maintaining the revocation lists.  If there are no special conditions, then I recommend choosing something average, about 6 months. <br><br>  For subordinate CAs, the scheme is the same.  Since the risk of revocation of client certificates is high, one can assume a high revocation rate.  Therefore, such CAs should publish revocation lists much more often, and to save traffic, combine basic and differential CRLs.  By default, Microsoft CA publishes revocation lists with the following frequency: base CRL once a week, deltas - daily.  In this situation, customers will be notified of the latest revoked certificates within 24 hours. <br><br>  You can understand the desire of administrators to reduce this time (ideally - instantly) so that customers do not recognize the revoked certificate as valid.  However, reducing one risk leads to an increase in another risk.  Imagine that for some reason the CA server failed at a time when the previous CRL was about to expire, and the new CRL could not be published.  Then problems will begin with checking certificate revocation and stopping them until the CA server is restored.  This point must be taken into account when setting the validity of revocation lists. <br><br>  Microsoft CA by default already lays some time reserve for emergencies and when distributing revocation lists to all publishing points takes some time (for example, caused by replication latency).  This reserve in English terminology is called CRL overlap.  The idea behind the defense mechanism is that the CA generates and publishes revocation lists before the previous published list expires. <br><br>  This is achieved using two fields in the revocation list: Next CRL Publish and Next Update.  The Next CRL Publish field indicates the time when the CA publishes the updated revocation list (automatically).  Next Update indicates the time when the current list will expire.  The Next Update field will always be set a little later than the Next CRL Publish.  In other words, the CA will publish an updated revocation list before the previous one expires.  The algorithm for calculating automatic values ‚Äã‚Äãfor these fields is non-trivial and is described in the following article: <a href="https://www.sysadmins.lv/blog-en/how-thisupdate-nextupdate-and-nextcrlpublish-are-calculated-v2.aspx">How ThisUpdate, NextUpdate and NextCRLPublish are calculated (v2)</a> .  If the default values ‚Äã‚Äãdo not suit you for one reason or another, you can edit them.  It is necessary to take into account that the time reserve has lower and upper bounds.  For example, the upper bound cannot exceed the validity period of the CRL itself.  So, if the CRL validity period is 1 day, then the stock can be a maximum of 1 day, and then the CA will publish revocation lists daily, but the validity period will be 2 days.  Thereby, a time margin for restoring the CA in case of unforeseen circumstances is achieved. <br><br>  <i>In practice, I quite often observed the desire of administrators to tighten the CRL expiration settings to the minimum limit with the following rationale: ‚Äúthe user left and should not be able to authenticate with a revoked certificate‚Äù.</i>  <i>The motivation is understandable, but solving the problem through revocation lists is not entirely correct.</i>  <i>In case the user needs to stop access to corporate systems, it is necessary to disable the user account or computer.</i> <br><br>  When planning the CRL validity and periodicity, the following guidelines should be followed: <br><br><ul><li>  All CAs that issue certificates only to other CAs (not end users) must publish a CRL valid from 3 to 12 months with a one-month supply. </li><li>  All CAs that issue certificates to end users (users and devices) should publish basic CRLs at least once a week and differential lists at least 3 days (preferably daily).  The time margin should not be adjusted (use the one that will be automatically calculated by the internal logic of the CA). </li></ul><br><h4>  Online Certificate Status Protocol </h4><br>  Within this series of articles, I will not use OCSP servers for an additional method of distributing information about revoked certificates.  If you wish, you can refer to the comprehensive article on TechNet: <a href="">Online Responder Installation, Configuration, and Troubleshooting Guide</a> .  As practice shows, in most cases, installation and support of OCSP is not justified for several reasons. <br><br>  The main task of OCSP is to offload CRL download traffic.  As you know, the CRL contains a list of all revoked certificates for the entire CA lifetime, and at some point with intensive revocation of certificates, its size can reach impressive sizes (several megabytes).  As noted above, 100k revoked certificates will be about 9MB in the CRL file.  While checking the revocation of any certificate using OCSP will take a fixed size of ~ 2.5KB.  There is a tangible difference.  In practice, the response rate is often much lower.  If we talk about root CA or CA policy, they will have a piece of feedback, and the size of their review list will hardly exceed 1KB. <br><br>  It should be noted that OCSP can be effective in a situation where there is one verifiable certificate and many clients that want to verify it.  This is a typical SSL / TLS certificate script.  In this case, each client will spend 2.5KB of OCSP traffic instead of downloading a conditional 9MB revocation list.  But in the opposite situation (one server verifies a lot of client certificates) OCSP can cause significant network load.  This includes typical corporate network scenarios: client authentication using certificates, such as EAP-TLS authentication in wireless networks and VPN, Kerberos authentication on domain controllers.  Suppose employees come to work and use certificates for network authentication (smart cards, certificates on mobile devices) and a domain controller, RADIUS servers are forced to verify each client certificate.  To check only 1K certificates will be spent 2.5MB of traffic.  In this situation, there is no benefit from OCSP, quite the contrary. <br><br>  This aspect is taken into account in the logic of Microsoft products.  If within a certain period of time, the Crypto API client checks 50 (this value can be configured) certificates from one publisher using OCSP, then this ends the work with OCSP and the client downloads and caches the CRL for that publisher.  You can learn more about this behavior in the <a href="https://technet.microsoft.com/en-us/library/ee619783(v%3Dws.10).aspx">Optimizing the Revocation Experience</a> section of <a href="https://technet.microsoft.com/en-us/library/ee619783(v%3Dws.10).aspx">the</a> <a href="https://technet.microsoft.com/en-us/library/ee619730(v%3Dws.10).aspx">Certificate Revocation Checking in Windows Vista and Windows Server 2008</a> document. <br><br><h2>  Certificate issuance planning </h2><br>  Certificate issuance policies are one of the most difficult to understand aspects of certificate operation and are often completely ignored by administrators when planning and deploying PKI in an enterprise.  However, the understanding and ability to manage issuance policies gives us a more flexible system, an additional level of control, and ultimately, a method of describing and documenting PKI. <br><br><h4>  Policy Definition </h4><br>  First you need to enter the definition of certificate issuance policies.  Any process of issuing / receiving a certificate is essentially a contract between the certificate recipient and the issuing CA.  This contract defines many aspects, such as issuance, use, and areas of responsibility. <br><br>  Each company may have different methods for checking applications and issuing certificates.  Consider a few typical cases: <br><br><ul><li>  Certificates for signing email can be issued automatically with minimal verification of the applicant (only on the basis of successful user authentication in Active Directory).  No additional steps are taken to issue these certificates. </li><li>  Certificates for digital signature of documents can be issued only after agreement with the immediate supervisor and submission of a written application with all the necessary signatures. </li><li>  Certificates for smart cards can be issued only with the personal presence of the employee, along with briefing on the rules for using the cards, signing the relevant regulatory documents. </li><li>              ,       ,        -. </li></ul><br>           .       ,     .        ,   ‚Äî      .. ,      ,           (,       ). <br><br>         ,       .           .       <b>Network Policy Server (NPS)</b>  <b>Active Directory Dynamic Access Control</b> . ,             .     ,           -. <br><br>  NPS   ,       ,  ,           -.      , NPS      (   )   .     ,          ,       .      Active Directory Dynamic Access Control,        . <br><br><h4>   </h4><br>           ,       .  ,       ,        .        ,   ?      . <br><br>    ,   -     .       ,   .        ,     .      .  ,    (  PKI  )  ,   ,         ,    . <br><br>     :            PKI       ‚Äì <b>Certificate Practice Statement</b>  CPS ( ,       ,     ).        (  ) , <a href="https://tools.ietf.org/html/rfc3647">  RFC 3647</a> .  ,             PKI.         .    ,     ,   - . <br><br>    CPS     : <br><br><ol><li>   PKI,      ,        . </li><li>       .     PKI,  ,       CPS,         ,    . </li></ol><br><h4>   </h4><br>    CPS         (    ).           CPS (   ). <br><br>        ITU-T  ISO.           : <a href="https://www.sysadmins.lv/blog-ru/chto-v-oide-tebe-moem.aspx">  OID'  ?</a>      ,    IANA (Internet Assigned Numbers Authority)   .   ,         , : 1.3.6.1.4.1.x.1,  x ‚Äì   ,   IANA.        : <br><br><ul><li> 1.3.6.1.4.1.x.1.1 </li><li> 1.3.6.1.4.1.x.1.2 </li><li> 1.3.6.1.4.1.x.1.3 </li><li> 1.3.6.1.4.1.x.1.4 </li><li>  ... </li></ul><br>        ,    . ,       ,        .        Certificate Policies  ,      . <br><br><img src="https://habrastorage.org/webt/sz/9b/mz/sz9bmzglmdxr1shzbfprittkpqi.png"><br><br> ,     DigiCert,         2.16.840.1.114412.2.1 (    <b>Extended Validation</b> )  2.23.140.1.1 (,       CAB/Forum)     CPS.          CPS        . <br><br>    ,      ,        ,      .                    . ,  -     ,          ,        (  ).          : <a href="https://www.sysadmins.lv/blog-en/certificate-policies-extension-all-you-should-know-part-1.aspx">Certificate Policies extension ‚Äì all you should know (part 1)</a>  <a href="https://www.sysadmins.lv/blog-en/certificate-policies-extension-all-you-should-know-part-2.aspx">Certificate Policies extension ‚Äì all you should know (part 2)</a> .     ,    ,               Windows. <br><br>     :        (10   )               ,         .         (,  ),    .  <a href="https://tools.ietf.org/html/rfc5280">RFC 5280 ¬ß4.2.1.4</a>    (global wildcard) anyPolicy = 2.5.29.32.0,     . <br><br> ,        ,         .    , ..    ,           ,     ,  ,    anyPolicy   ,        .        ,                     .        anyPolicy    . <br><br><h2>    </h2><br>   AD CS       (    ).           (,   ).  ,           (AD CS  JET Database Engine).  This is in theory. <br><br>                ,            .   Windows Server 2003    <a href="http:/technet.microsoft.com/en-us/library/cc778985(WS.10).aspx">Evaluating CA Capacity, Performance, and Scalability</a> (   , ..     TechNet),   ,       .    (,         ),     . <br><br>  2010 , Windows PKI Team         ( 2007 )   Windows Server 2008.       : <a href="https://blogs.technet.microsoft.com/pki/2010/01/11/windows-ca-performance-numbers/">Windows CA Performance Numbers</a> .    ,   ,   AD CS     2007     150   .          .              .    ,    .      Windows Server 2016 ( <a href="https://docs.microsoft.com/en-us/windows-server/get-started/system-requirements">Windows Server 2016 System Requirements</a> ): <br><br><ul><li> CPU ‚Äî dual-core 1.4 GHz; </li><li>  ‚Äî 1GB RAM; </li><li>  ‚Äî 48 GB       48 GB    .        RAID1. </li><li>  ‚Äî SVGA (800*600); </li><li>  ‚Äî   . </li></ul><br>   ,         (   )   (      )         . <br><br><h2>   </h2><br>             (  ),      .    , , .           . <br><br><h4>   </h4><br>                        . <br><br><table><tbody><tr><th>   </th><th>   </th></tr><tr><td colspan="2" align="center"> <b> </b> </td></tr><tr><td>   </td><td> Standalone CA </td></tr><tr><td>   </td><td> Root CA </td></tr><tr><td>     </td><td> 15  </td></tr><tr><td>   AD () </td><td> Certification Authorities <br> AIA </td></tr><tr><td>   CRT </td><td> 1) - <br> 2) C:\CertData\contoso-rca&lt;CertificateName&gt;.crt <br> 3) IIS:\InetPub\PKIdata\contoso-rca&lt;CertificateName&gt;.crt* </td></tr><tr><td>   CRT </td><td> 1) URL=http://cdp.contoso.com/pki/contoso-rca&lt;CertificateName&gt;.crt </td></tr><tr><td>   CRL </td><td> 1) - <br> 2) C:\CertData\contoso-rca&lt;CRLNameSuffix&gt;.crt <br> 3) IIS:\InetPub\PKIdata\contoso-rca&lt;CRLNameSuffix&gt;.crt* </td></tr><tr><td>   CRL </td><td> 1) URL=http://cdp.contoso.com/pki/contoso-rca&lt;CRLNameSuffix&gt;.crt </td></tr><tr><td colspan="2" align="center"> <b></b> </td></tr><tr><td>   </td><td> Contoso Lab Root Certification authority </td></tr><tr><td>   </td><td> OU=Division Of IT, O=Contoso Pharmaceuticals, C=US </td></tr><tr><td>   </td><td> RSA#Microsoft Software Key Storage Provider </td></tr><tr><td>   </td><td> 4096  </td></tr><tr><td>   </td><td> SHA256 </td></tr><tr><td>  Validity </td><td> 15  </td></tr><tr><td>  CRL </td><td> Base CRL </td></tr><tr><td colspan="2" align="center"> <b>Base CRL</b> </td></tr><tr><td>  Type of </td><td> Base CRL </td></tr><tr><td>  Validity </td><td>  6 months </td></tr><tr><td>    </td><td>  1 month </td></tr><tr><td>   </td><td> SHA256 </td></tr><tr><td>   AD </td><td>  Not </td></tr></tbody></table> * ‚Äî    IIS . <br><br><h4>   </h4><br>       . <br><br><table><tbody><tr><th>   </th><th>   </th></tr><tr><td colspan="2" align="center"> <b> </b> </td></tr><tr><td>   </td><td> Enterprise CA </td></tr><tr><td>   </td><td> Subordinate CA </td></tr><tr><td>     </td><td> : 5  (   ) </td></tr><tr><td>    </td><td>  Not </td></tr><tr><td>   AD () </td><td> AIA <br> NTAuthCertificates </td></tr><tr><td>  CRL </td><td> Base CRL <br> Delta CRL </td></tr><tr><td>   CRT </td><td> 1) - <br> 2) \\IIS\PKI\contoso-pica&lt;CertificateName&gt;.crt </td></tr><tr><td>   CRT </td><td> 1) URL=http://cdp.contoso.com/pki/contoso-pica&lt;CertificateName&gt;.crt </td></tr><tr><td>   CRL </td><td> 1) - <br> 2) \\IIS\PKI\contoso-pica&lt;CRLNameSuffix&gt;&lt;DeltaCRLAllowed&gt;.crl </td></tr><tr><td>   CRL </td><td> 1) URL=http://cdp.contoso.com/pki/contoso-pica&lt;CRLNameSuffix&gt;&lt;DeltaCRLAllowed&gt;.crl </td></tr><tr><td colspan="2" align="center"> <b></b> </td></tr><tr><td>   </td><td> Contoso Lab Issuing Certification authority </td></tr><tr><td>   </td><td> OU=Division Of IT, O=Contoso Pharmaceuticals, C=US </td></tr><tr><td>   </td><td> RSA#Microsoft Software Key Storage Provider </td></tr><tr><td>   </td><td> 4096  </td></tr><tr><td>   </td><td> SHA256 </td></tr><tr><td>  Validity </td><td> 15  (  ) </td></tr><tr><td>   </td><td> 1) : All Issuance Policies <br> OID=2.5.29.32.0 <br> URL=http://cdp.contoso.com/pki/contoso-cps.html </td></tr><tr><td> Basic Constraints </td><td> isCA=True (  ‚Äî  ) <br> PathLength=0 (       ). </td></tr><tr><td colspan="2" align="center"> <b>Base CRL</b> </td></tr><tr><td>  Type of </td><td> Base CRL </td></tr><tr><td>  Validity </td><td>  Week 1 </td></tr><tr><td>    </td><td>  Default </td></tr><tr><td>   </td><td> SHA256 </td></tr><tr><td>   AD </td><td>  Not </td></tr><tr><td colspan="2" align="center"> <b>Delta CRL</b> </td></tr><tr><td>  Type of </td><td> Delta CRL </td></tr><tr><td>  Validity </td><td>  1 day </td></tr><tr><td>    </td><td> - </td></tr><tr><td>   </td><td> SHA256 </td></tr><tr><td>   AD </td><td>  Not </td></tr></tbody></table><h4>  IIS </h4><br><table><tbody><tr><th>   </th><th>   </th></tr><tr><td colspan="2" align="center"> <b> </b> </td></tr><tr><td> - </td><td> cdp </td></tr><tr><td>   </td><td> cdp.contoso.com </td></tr><tr><td>   </td><td> PKI=C:\InetPub\wwwroot\PKIdata </td></tr><tr><td> Double Escaping </td><td>  </td></tr></tbody></table><br>   ,          .        ,       . <br><br><h2>  about the author </h2><br><img src="https://habrastorage.org/webt/yi/eq/4o/yieq4os65jmmhcqhrnv9y9ws76u.jpeg" align="left" width="120"> <b> </b> ‚Äî     PowerShell  Public Key Infrastructure, Microsoft MVP: Cloud and Datacenter Management  2009     PowerShell PKI.   9           PKI  .    PKI  PowerShell     <a href="https://www.sysadmins.lv/"></a> . </div><p>Source: <a href="https://habr.com/ru/post/348956/">https://habr.com/ru/post/348956/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../348942/index.html">How to "learn to learn." Part 2 - Metacognitive Processes and Dudling</a></li>
<li><a href="../348944/index.html">Installation of a certification authority in the enterprise. Part 1</a></li>
<li><a href="../348946/index.html">Why you should not use a two-tier architecture in developing client-server applications</a></li>
<li><a href="../348950/index.html">Layout of a collection of abstracts of the conference in LaTeX</a></li>
<li><a href="../348952/index.html">Authorization of the user on your site through Telegram for Django</a></li>
<li><a href="../348960/index.html">Applying the observer pattern in Redux and Mobx</a></li>
<li><a href="../348962/index.html">English version of Habr: to be or not to be?</a></li>
<li><a href="../348964/index.html">Develop isomorphic RealWorld applications with SSR and Progressive Enhancement. Part 1 - Introduction and Stack Selection</a></li>
<li><a href="../348966/index.html">Psychological portrait using neural network and ordinary camera</a></li>
<li><a href="../348968/index.html">10 IT Heroes According to Kodabra: Web Development</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>