<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Build Tesseract OCR under MinGW</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In one of my projects, I needed character recognition and my choice was tesseract ocr. On Habr√© was already a similar article , but at the moment it i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Build Tesseract OCR under MinGW</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/b83/8fc/996/b838fc9967bd461bedd6420de8a7f777.png" alt="tesseract ocr" width="299" height="60"><br><br>  In one of my projects, I needed character recognition and my choice was tesseract ocr.  On Habr√© was already a similar <a href="http://habrahabr.ru/post/126834/">article</a> , but at the moment it is not relevant, during the installation did not work exactly repeat the instructions of the author.  This article describes the process of installing Tesseract OCR under MinGW. <br><a name="habracut"></a><br>  At the moment, Google is developing tesseract ocr, which may mean that the library will develop in the near future.  I will try to describe the installation process in as much detail as possible, starting with the installation of MinGW. <br><br><h1>  Install MinGW </h1><br>  First we need to install MinGW, it can be downloaded from the <a href="http://sourceforge.net/projects/mingw/files/">official site of the project</a> .  During installation, you must select the following options: <br><ul><li>  C ++ Compiler </li><li>  MSYS Basic System </li></ul><br>  Step 1. Install MinGW: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/010/4fc/b46/0104fcb4693be4a4e9d05b30be8a9e8d.png" alt="tesseract ocr" width="648" height="484"><br><br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/df1/5bf/397/df15bf397f7516e4680fd917aea389d9.png" alt="complete the mingw installation" width="648" height="486"><br><br><br><br>  Do not forget to mark the options we need: C ++ Compiler and MSYS Basic System. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ce9/8b8/73a/ce98b873a39b3fbaf412e39649e8e2ae.png" alt="set options" width="648" height="486"><br><br>  Next, go to the <strong>Installation</strong> section and select <strong>Apply Chanages</strong> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6d3/2fb/5c1/6d32fb5c1d9eb2c4fbf97b82f489e7d3.png" alt="applying changes" width="648" height="486"><br><br>  Next, select the selected <b>Apply</b> package for installation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c4c/fe7/670/c4cfe767088ef529e8e385f3ea65d1ce.png" alt="component installation" width="648" height="486"><br><br>  We wait until the end of the installation of the MinGW packages and click <strong>Close</strong> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b5c/275/19a/b5c27519a149b6df2d25c277ee97779d.png" alt="installation completion" width="648" height="486"><br><br>  After completing these steps, the installer can be closed. <br><br>  Before starting the installation of additional packages, we need to add the MinGW directory to the PATH. <br><br>  To do this, go to the properties of the system. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/884/bd3/399/884bd3399a1f7188d378befa39ffd456.png" alt="system properties" width="648" height="486"><br><br>  Next, go to <strong>Advanced System Settings</strong> -&gt; <strong>Environment Variables</strong> -&gt; <strong>Create</strong> . <br><br>  Enter <strong>PATH in the</strong> variable name.  In the Value of the variable, enter the path to the folder with mingw, in our case it is <strong>C: \ MinGW \ bin</strong> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/db3/02c/17f/db302c17f1a0ff56b93e600405b2c91a.png" alt="PATH installation" width="648" height="486"><br><br>  Now we need to install several packages using the <strong>MinGW Shell</strong> , which we will need when collecting the <strong>Tesseract OCR</strong> library. <br><br>  To open <strong>MinGW Shell,</strong> go to the folder <strong>C: \ MinGW \ msys \ 1.0</strong> and run the binary file <strong>msys.bat</strong> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f67/bfa/aa0/f67bfaaa05162d8aa579e7bb4df12fe2.png" alt="start msys" width="648" height="486"><br><br>  In the opened console enter the following command: <br><pre>  mingw-get install mingw32-automake mingw32-autoconf mingw32-autotools mingw32-libz </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/262/55e/507/26255e5076e3ef385a15073ae6d40fd1.png" alt="installation result" width="648" height="486"><br><br>  In this case, we were told that we already have these packages installed, that's okay, this is normal. <br><br>  <strong>Important point</strong> !  We need to mount a folder with our MinGW in MinSYS. <br><br>  To do this, follow these steps: <br><br>  Create a file C: \ MinGW \ msys \ 1.0 \ etc \ fstab to mount the directory C: \ MinGW to the mount point / mingw: <br><pre>  # Win32_Path Mount_Point
 c: / MinGW / mingw </pre><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d61/7db/1d2/d617db1d2874894ab7587818b18fd62a.png" alt="mount mingw" width="648" height="486"><br><br>  Well, after creating fstab, you need to restart MinGW Shell, just close and re-open <strong>msys.bat</strong> . <br><br><h1>  Installing the Leptonica Library </h1><br>  After setting up MinGW, we need to install the <strong>Leptonica</strong> library.  Tesseract ocr uses the Leptonica library for working with images, but before installing it we need to install several auxiliary libraries: <br><ul><li>  libJpeg </li><li>  libPng </li><li>  libTiff </li></ul><br><h2>  Install LibJpeg </h2><br>  First, create a directory in which we will store our libraries, for example <strong>C: \ libs \</strong> .  In this directory, create a sub-folder <strong>libjpeg</strong> to store the library.  Now that we have prepared our workplace, you can download LibJpeg from the <a href="">official site</a> and unpack it in our folder <strong>C: \ libs \ libjpeg</strong> . <br><br>  After unpacking, I got the following path to the libjpeg folder: <strong>C: \ libs \ libjpeg \ jpegsrc.v8c.tar \ jpegsrc.v8c \ jpeg-8c.</strong> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d9e/0c4/d1a/d9e0c4d1a6c6b7db097f679bc8fb2b7c.png" alt="way to ligjpeg" width="648" height="486"><br><br>  Now we need to build and install the library, to do this, go to the MinGW Shell and enter the following commands: <br><pre>  cd /C/libs/libjpeg/jpegsrc.v8c.tar/jpegsrc.v8c/jpeg-8c/
 ./configure CFLAGS = '- O2' CXXFLAGS = '- O2' --prefix = / mingw
 make
 make install </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/fc6/3f7/4e7/fc63f74e70424e12915112d065b2b69c.png" alt="configure" width="648" height="490"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/151/c00/218/151c00218ced7c3be7ae05508d962806.png" alt="configure 2" width="648" height="490"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d2c/09c/a58/d2c09ca58c5fe005580a6ae0f787f800.png" alt="end make" width="648" height="490"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/697/3d0/fa9/6973d0fa9f4e1b6d1a9e79f5370fe6a6.png" alt="make install" width="648" height="490"><br><br>  Excellent at this stage the installation of libJpeg is complete. <br><br><h2>  Install libPng </h2><br>  Download the archive with source codes from the <a href="">official site of the</a> project and unpack it in the <strong>C <i>: \ libs \ libpng</i></strong> directory.  We return to MinGW Shell, the installation procedure for this library will be identical to the libJpeg installation.  After unpacking, I got the following directory: <strong>C: \ libs \ libpng \ libpng-1.5.4.tar \ libpng-1.5.4</strong> <br><pre>  cd /C/libs/libpng/libpng-1.5.4.tar/libpng-1.5.4/
 ./configure CFLAGS = '- O2' CXXFLAGS = '- O2' --prefix = / mingw
 make
 make install </pre><br><br><h2>  LibTiff build </h2><br>  The source code archive can be downloaded from <a href="">the</a> project's <a href="">ftp server</a> .  Unpack the archive in <strong>C <i>: \ libs \ libtiff</i> .</strong>  Building this library is similar to building the previous two libraries. <br><br>  After unpacking, we got the following path: <strong>C: \ libs \ libtiff \ tiff-3.9.5.tar \ tiff-3.9.5</strong> . <br><pre>  cd /C/libs/libtiff/tiff-3.9.5.tar/tiff-3.9.5/
 ./configure CFLAGS = '- O2' CXXFLAGS = '- O2' --prefix = / mingw
 make
 make install </pre><br><br><h2>  Build Leptonica </h2><br>  After installing all the additional libraries, we proceed to collecting Leptonica.  First we need to download Leptonica <strong>1.71</strong> , this is important, we need version <strong>1.71</strong> .  As tests have shown, if you take a version higher or lower, the tesseract ocr itself will not be assembled.  But in this version there is one bug that we have to fix.  First, download the archive with source files from the <a href="">official site</a> .  Extract the downloaded archive into the folder <strong>C: / libs / leptonica /</strong> .  After unpacking, I got the following path: <strong>C: \ libs \ leptonica \ leptonica-1.71.tar \ leptonica-1.71</strong> . <br><br>  The next step is to build the library, it is no different from the assembly of previous libraries: <br><pre>  cd /C/libs/leptonica/leptonica-1.71.tar/leptonica-1.71/
 ./configure CFLAGS = '- O2' CXXFLAGS = '- O2' --prefix = / mingw
 make
 make install </pre><br>  Fine.  We proceed to build Tesseract OCR. <br><br><h1>  Tesseract OCR Build </h1><br>  After successfully assembling Leptonica, you can begin to build Tesseract OCR.  Download the archive with the source code from the <a href="">official site</a> .  Extract the downloaded archive with the Tesseract OCR source code to the <strong>C: \ libs \ tesseract folder</strong> .  After unpacking, I got the following path: <strong>C: \ libs \ tesseract \ tesseract-ocr-3.02.02.tar \ tesseract-ocr-3.02.02 \ tesseract-ocr</strong> . <br><br>  Putting our Tesseracr OCR. <br><pre>  cd /C/libs/tesseract/tesseract-ocr-3.02.02.tar/tesseract-ocr-3.02.02/tesseract-ocr
 ./configure CFLAGS = '- D__MSW32__ -O2' CXXFLAGS = '- D__MSW32 __- O2' LIBS = '- lws2_32' LIBLEPT_HEADERSDIR = '/ mingw / include' --prefix = / mingw
 make
 make install </pre><br>  Tesseracrt build process takes a lot of time while you can go for tea. <br><br>  The tesseract ocr header files will be in C: \ MinGW <i>\ include \ tesseract</i> , the <i>Leptonica</i> header files in C: \ MinGW <i>\</i> <i>include \ leptonica</i> , all the libraries in C: \ <i>mingw \</i> <i>lib</i> . <br><br>  For the success of future programs, you should download and install the Tesseract ocr SDK from the <a href="">official site</a> . <br><br>  It remains to fix the small bugs that appear after installing Tesseract OCR. <br><br>  To do this, go to the folder with the Tesseract OCR C: \ MinGW <i>\ <strong>include</strong> \ tesseract</i> header files <i>.</i> <br><br>  We comment in the file <strong>platform.h the</strong> repeated declaration of the <b>BLOB</b> type <b>.</b>  You should get something like this: <br><pre>  / * typedef struct _BLOB {
 unsigned int cbSize;
 char * pBlobData;
 } BLOB, * LPBLOB; * / </pre><br>  Commenting on the <b>PBLOB</b> class <b>declaration</b> in <i>baseapi.h</i> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/510/ab7/38b/510ab738bcb4c2f62586141d8d0f5744.png" alt="fix" width="648" height="486"><br><br><h1>  Tesseract OCR Testing App </h1><br>  After installing the tesseract, you can test it, write a simple C ++ application. <br><pre>  #include &lt;tesseract / baseapi.h&gt;
 #include &lt;leptonica / allheaders.h&gt;
 #include &lt;string&gt;
 #include &lt;iostream&gt;

 int main (int argc, char * argv [])
 {
	 tesseract :: TessBaseAPI ocr;
	 ocr.Init (NULL, "eng");

	 if (argc&gt; 1) 
	 {
		 PIX * pix = pixRead (argv [1]);
		 ocr.SetImage (pix);
		 std :: string result = ocr.GetUTF8Text ();

		 std :: cout &lt;&lt; "Recognition text:" &lt;&lt; result &lt;&lt; std :: endl;
	 }
	 else
		 std :: cout &lt;&lt; "drag and drop image" &lt;&lt; std :: endl;

	 return 0;
 } </pre><br>  You can build the application from the command line: <br><pre>  g ++ -O2 main.cpp -o ocr.exe -ltesseract -llept -lws2_32
</pre><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/40b/f42/4ed/40bf424ed2f5e05d9aeb4a5021fcf48b.png" alt="Result" width="1150" height="596"></a> <br></div><p>Source: <a href="https://habr.com/ru/post/262483/">https://habr.com/ru/post/262483/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../262467/index.html">Stop shot. Recorded and transmitted</a></li>
<li><a href="../262469/index.html">Do the opposite or portable channel for secure data transmission</a></li>
<li><a href="../262471/index.html">High Level C or a couple of words about Cello</a></li>
<li><a href="../262475/index.html">How to embed banners in the Android application without blocking other elements</a></li>
<li><a href="../262479/index.html">Instruction: we implement HIDS OSSEC</a></li>
<li><a href="../262487/index.html">The most boring build Vivaldi 1.0.219.34</a></li>
<li><a href="../262489/index.html">5 reasons for Angular developers to use Meteor</a></li>
<li><a href="../262493/index.html">Creating a map of a comfortable walk</a></li>
<li><a href="../262497/index.html">Magic of tensor algebra: Part 8 - On convolutions of the Levi-Civita tensor</a></li>
<li><a href="../262499/index.html">Quick backup setup for Linux and not only (UrBackup)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>