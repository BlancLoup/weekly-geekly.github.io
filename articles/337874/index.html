<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Streaming api A small example in PHP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the summer, there was a contest from VKontakte on the topic ‚ÄúStreaming API Contest‚Äù. I decided to participate, but since I couldn‚Äôt find a normal i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Streaming api A small example in PHP</h1><div class="post__text post__text-html js-mediator-article">  In the summer, there was a contest from VKontakte on the topic ‚ÄúStreaming API Contest‚Äù.  I decided to participate, but since I couldn‚Äôt find a normal idea for the implementation of all the features of the Streaming API, I decided to just output the recordings according to the specified rules. <br><br><div class="spoiler">  <b class="spoiler_title">More about the rules</b> <div class="spoiler_text">  A rule is a set of keywords whose presence in the text of an object means that the object will fall into the stream.  If words are specified without double quotes, the search is simplified (all word forms, case insensitive).  To search by exact entry (taking into account the register, word forms, etc.) each word must be specified in double quotes. <br><br>  More detail <a href="https://vk.com/dev/streaming_api_docs">here</a> . <br></div></div><br>  At first I thought about implementing everything on Node.Js, but then, in order not to waste time setting it up on a VPS server, I decided to use PHP. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I decided to give the entire logic of the project to the client, on the server only small settings for working with the VK API and the analyzer. <br><a name="habracut"></a><br>  Let's start with the interesting - the main thing: <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    var socket = new WebSocket("wss://streaming.vk.com/stream?key=" + window.key); var close_connect = ge("close_connect"); /* *      */ socket.onmessage = function(event) { var incomingMessage = event.data; var loading = document.getElementById("loading_text"); var preview = document.getElementById("preview_text"); var serf = document.getElementById("serf"); loading.classList.add("none"); preview.classList.add("none"); serf.classList.remove("none"); parser(event.data); //     console.log(event.data); }; socket.onclose = function(event) { if (event.wasClean) { console.warn('  '); } else { console.warn(' '); } console.info(': ' + event.code + ' : ' + event.reason); var loading = ge("loading_text"); if (event.code == 1006) { loading.innerHTML = "     ,     .&lt;br/&gt;  -   .   . &lt;br/&gt;   - " + event.code; } else { loading.innerHTML = "-  -   ... &lt;br/&gt;   - " + event.code; } }; socket.onerror = function(error) {}; //close connect close_connect.addEventListener("click", function() { socket.close(); close_connect.innerHTML = "  ."; ge("analiz_block").classList.remove("none"); }, false);</span></span></code> </pre> <br>  As it became clear from the code above, the site has one session for all users, i.e.  while someone is already sitting and parsing the rules, another will not get access to the site. <br><br><div class="spoiler">  <b class="spoiler_title">There is a minus here</b> <div class="spoiler_text">  While one person creates the rules and receives news, another can see these same rules and delete them.  I noticed it late, after the contest, so I did not fix it. <br></div></div><br>  Next, we <b>analyze the</b> main function <b>parser (event.data)</b> .  I love templates, they are easy to manage and easy to interact with. <br><br><div class="spoiler">  <b class="spoiler_title">Lot of code</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parser = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">json</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> response = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(json); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(response); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> code = response.code; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(code); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (code != <span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tpl_block = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"tpl"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tpl = tpl_block.innerHTML; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> main_tpl = tpl_block.innerHTML; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> content = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"main"</span></span>).innerHTML; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> main = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"main"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> time = response.event[<span class="hljs-string"><span class="hljs-string">'creation_time'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> date = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>(time); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> type; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cnt = ge(<span class="hljs-string"><span class="hljs-string">"cnt"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cnt_value = +cnt.innerHTML; cnt.innerHTML = cnt_value + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> creation_time = timestampToDate(response.event[<span class="hljs-string"><span class="hljs-string">'creation_time'</span></span>] * <span class="hljs-number"><span class="hljs-number">1000</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.event[<span class="hljs-string"><span class="hljs-string">'event_type'</span></span>] == <span class="hljs-string"><span class="hljs-string">"post"</span></span>) { type = <span class="hljs-string"><span class="hljs-string">""</span></span>; count[<span class="hljs-string"><span class="hljs-string">'post'</span></span>] = ++count[<span class="hljs-string"><span class="hljs-string">'post'</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.event[<span class="hljs-string"><span class="hljs-string">'event_type'</span></span>] == <span class="hljs-string"><span class="hljs-string">"comment"</span></span>) { type = <span class="hljs-string"><span class="hljs-string">""</span></span>; count[<span class="hljs-string"><span class="hljs-string">'comment'</span></span>] = ++count[<span class="hljs-string"><span class="hljs-string">'comment'</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.event[<span class="hljs-string"><span class="hljs-string">'event_type'</span></span>] == <span class="hljs-string"><span class="hljs-string">"share"</span></span>) { type = <span class="hljs-string"><span class="hljs-string">""</span></span>; count[<span class="hljs-string"><span class="hljs-string">'share'</span></span>] = ++count[<span class="hljs-string"><span class="hljs-string">'share'</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> photo_context; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.event.attachments) { <span class="hljs-comment"><span class="hljs-comment">//image if (response.event.attachments[0].type == "photo") { photo_context = '&lt;div class="body-img"&gt;&lt;img alt="image" src="' + response.event.attachments[0].photo['photo_604'] + '" /&gt;&lt;/div&gt;'; } else { photo_context = ""; } } else { photo_context = ""; } tpl = tpl.split("{event_type}").join(type); tpl = tpl.split("{text}").join(response.event['text']); tpl = tpl.split("{url}").join(response.event['event_url']); tpl = tpl.split("{date}").join(creation_time); tpl = tpl.split("{photo}").join(photo_context); tpl = tpl.split("{type}").join(response.event['event_type']); tpl = tpl.split("{cnt}").join(cnt_value+1); tpl = tpl.split("\"").join("'"); if (filter.top) main.innerHTML = tpl + "" + content; else main.innerHTML = content + "" + tpl; //post_id if (response.event['event_type'] != "comment") { var post_owner_id = response.event.event_id['post_owner_id']; var post_id = response.event.event_id['post_id']; var wall_id = post_owner_id + "_" + post_id; array_post_id.push(wall_id); } //limit if (cnt_value + 1 &gt;= +filter.limit) { socket.close(); close_connect.innerHTML = "  ."; ge("analiz_block").classList.remove("none"); } }</span></span></code> </pre><br></div></div><br>  The template itself: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">section</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"tpl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"none"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"template-container block-md_"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{type}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-num</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{cnt}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"template-header"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"template-title"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"tpl_title"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>{event_type}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"template-body"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-body-text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"data-body-text-{cnt}"</span></span></span><span class="hljs-tag">&gt;</span></span>{text}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {photo} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"template-footer flex"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>  - {date}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript: return;"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"none button-footer-post button-spam"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"spam.addMSG({cnt})"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{url}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button-footer-post"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_blank"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">section</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  In the code above occurs: <br><br>  1. Pars json with information about the records (comment, repost or publication) <br>  2. Pars a template for information we received from json <br><br>  One template for three types of publication.  Conveniently. <br><br>  The project is working, the records are displayed, everything is gorgeous, but boring.  To hand over such a project to a competition is the same thing as not to take it.  Therefore, it was decided to write a small filter on the records, which would be able to show small statistics.  I took as a basis information on the number of records, total coverage, the ‚ÄúLike‚Äù button and repost, as well as the average age of the audience reached and the percentage of the sex. <br><br><div class="spoiler">  <b class="spoiler_title">Code analysis</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> analiz = { <span class="hljs-attr"><span class="hljs-attr">start</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// if (count['post'] == 0 &amp;&amp; count['comment'] == 0 &amp;&amp; count['share'] == 0) { alert("  .  -   ."); return; } var url = "/vk-competition/VKanaliz.php"; var loading = ge("loading_sp"); var button = ge("btn_analiz"); var analiz_stats = ge("analiz_stats"); loading.classList.remove("none"); button.classList.add("none"); ajax.post({ url: url, data: "post_id=" + array_post_id.join(","), callback: function(data) { var resp = JSON.parse(data); if (resp.error) { alert(resp.error); return; } else { var count_likes_all_ = resp.response.count_likes_all; var count_share_all_ = resp.response.count_share_all; var count_views_all_ = resp.response.count_views_all; var analiz_posts = ge("analiz_post"); var analiz_share = ge("analiz_share"); var analiz_comments = ge("analiz_comments"); var analiz_likes = ge("analiz_likes"); var analiz_views = ge("analiz_views"); var analiz_reposts = ge("analiz_reposts"); var analiz_years = ge("analiz_years_"); var analiz_sex = ge("analiz_sex"); var percent_sex_m, percent_sex_w; if (resp.response.percent_sex_w == "-") percent_sex_w = 0; else percent_sex_w = resp.response.percent_sex_w; if (resp.response.percent_sex_w == "-") percent_sex_m = 0; else percent_sex_m = 100 - +percent_sex_w; console.log("spam " + resp.response.spam + "%"); //insert data analiz_posts.innerHTML = count['post']; analiz_share.innerHTML = count['share']; analiz_comments.innerHTML = count['comment']; analiz_likes.innerHTML = count_likes_all_; analiz_views.innerHTML = "‚âà" + count_views_all_; analiz_reposts.innerHTML = count_share_all_; analiz_sex.innerHTML = percent_sex_w + "%, " + percent_sex_m + "%"; analiz_years.innerHTML = resp.response.middle_years; //show stats loading.classList.add("none"); analiz_stats.classList.remove("none"); } } }); } }</span></span></code> </pre><br></div></div><br>  <b>VKanaliz.php</b> - a file that returns data in json.  Its contents can be viewed <a href="https://github.com/artemmolod/Streaming-API/blob/master/example/VKanaliz.php">here</a> . <br><br>  What was the result?  As a result, a small project came out that allows analyzing the publication, its scope and feedback.  Already better than before. <br><br>  ‚Üí See live example <a href="https://cebattle.com/vk-competition/">here</a> <br>  ‚Üí Source code is available on <a href="https://github.com/artemmolod/Streaming-API">GitHub</a> <br><br>  All good! </div><p>Source: <a href="https://habr.com/ru/post/337874/">https://habr.com/ru/post/337874/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337862/index.html">RailsClub 2017. Interview with Luca Guidi, author Hanami: mix FP and OOP in Ruby</a></li>
<li><a href="../337864/index.html">Parallel Hystrix. Improve the performance of distributed applications</a></li>
<li><a href="../337866/index.html">Hi, Programmer</a></li>
<li><a href="../337868/index.html">How to write a good solution for Highload Cup, but not good enough to get to the top</a></li>
<li><a href="../337870/index.html">Neural networks: how artificial intelligence helps in business and life</a></li>
<li><a href="../337878/index.html">A few words about the inevitable turn in the development of the IT industry</a></li>
<li><a href="../337880/index.html">"Patterns" of functional programming</a></li>
<li><a href="../337882/index.html">Oh, the very long-awaited release of Sublime Text 3.0</a></li>
<li><a href="../337888/index.html">Using different metrics to cluster key queries</a></li>
<li><a href="../337890/index.html">HPE ProLiant Gen8 and Gen9 vs. Servers Gen10</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>