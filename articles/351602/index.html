<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The book ‚ÄúNode.js in action. 2nd edition ¬ª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The second edition of ‚ÄúNode.js in action‚Äù has been completely redesigned to reflect the realities that every Node developer now faces. You will learn ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The book ‚ÄúNode.js in action. 2nd edition ¬ª</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/piter/blog/351602/"><img src="https://habrastorage.org/webt/4e/lr/yv/4elryvrpllihtkwfsiezolmo12o.jpeg" align="left" alt="image"></a>  The second edition of ‚ÄúNode.js in action‚Äù has been completely redesigned to reflect the realities that every Node developer now faces.  You will learn about interface building systems and popular Node web frameworks, as well as learn how to build Express-based web applications from scratch.  Now you can learn not only about Node and JavaScript, but also get all the information, including front-end building systems, choosing a web framework, working with databases in Node, testing and deploying web applications. <br><br>  Node technology is increasingly being used in conjunction with command-line tools and Electron-based desktop applications, so chapters on both areas were included in the book.  Inside the post will be considered an excerpt "Storing data in applications" <br><a name="habracut"></a><br>  Node.js focuses on an incredibly wide range of developers with equally diverse needs.  No database or storage technology is able to satisfy most of the use cases that Node maintains.  This chapter provides a broad overview of data storage capabilities along with some important high-level concepts and terminology. <br><br><h3>  8.1.  Relational databases </h3><br>  Throughout almost the entire lifetime of web technologies, relational databases have been at the forefront of data storage.  This topic has already been addressed in many other books and educational programs, so we will not spend much time reviewing it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Relational databases based on mathematical concepts of relational algebra and set theory have been known since the 1970s.  A schema defines the format of various types of data and the relationships that exist between these types.  For example, when building a social network, you can create User and Post data types and define one-to-many relationships between User and Post.  Further, in SQL (Structured Query Language) formulated queries to data such as "Receive all messages belonging to the user with ID 123", or SQL: SELECT * FROM post WHERE user_id = 123. <br><br><h3>  8.2.  PostgreSQL </h3><br>  MySQL and PostgreSQL (Postgres) remain the most popular relational databases for Node applications.  The differences between relational databases are mostly aesthetic, so this section applies equally to other relational databases ‚Äî for example, MySQL in Node.  But first, let's figure out how to install Postgres on the development machine. <br><br><h3>  8.2.1.  Installation and Setup </h3><br>  First you need to install Postgres on your system.  A simple npm install command is not enough for this.  Installation instructions are platform dependent.  In macOS, installation comes down to a simple sequence of commands: <br><br><pre><code class="hljs sql">brew <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> brew <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> postgres</code> </pre> <br>  If Postgres support is already installed on your system, you may encounter problems when attempting to upgrade.  Follow the instructions for your platform to migrate existing databases, or completely delete the database directory: <br><br><pre> <code class="hljs pgsql"># <span class="hljs-built_in"><span class="hljs-built_in">WARNING</span></span>: will <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> existing postgres <span class="hljs-keyword"><span class="hljs-keyword">configuration</span></span> &amp; data rm ‚Äìrf /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/var/postgres</code> </pre> <br>  Then initialize and run Postgres: <br><br><pre> <code class="hljs pgsql">initdb -D /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/var/postgres pg_ctl -D /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/var/postgres -l logfile <span class="hljs-keyword"><span class="hljs-keyword">start</span></span></code> </pre> <br>  These commands launch the Postgres daemon.  The daemon should start every time you restart the computer.  Perhaps you are building to configure the Postgres daemon auto-load on startup;  In many online manuals, you can find a description of this process for your operating system. <br><br>  Postgres installs some command-line administrative programs.  Check them out;  necessary information can be found in the electronic documentation. <br><br><h3>  8.2.2.  Database creation </h3><br>  After the Postgres daemon runs, you need to create a database.  This procedure is sufficient to perform only once.  The easiest way to use the createdb program from the command line.  The following command creates a database named articles: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">createdb</span></span> articles</code> </pre> <br>  If the operation completes successfully, the command displays nothing.  If a database with the specified name already exists, the command does nothing and reports an error. <br><br>  As a rule, applications at any time are connected to only one database, although you can configure several databases at once, depending on the mode in which the database is running.  In many applications, at least two modes are distinguished: development mode and real operation mode. <br><br>  To remove all data from an existing database, run the dropdb command from the terminal, passing in the name of the database in the argument: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">dropdb</span></span> articles</code> </pre> <br>  To use the database again, you must execute the createdb command. <br><br><h3>  8.2.3.  Connect to Postgres from Node </h3><br>  The most popular package for interacting with Postgres from Node is called pg.  It can be installed using npm: <br><br><pre> <code class="hljs sql">npm <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> pg <span class="hljs-comment"><span class="hljs-comment">--save</span></span></code> </pre> <br>  When the Postgres server is up, the database is created, and the pg package is installed, you can switch to using the database from Node.  Before entering any commands to the server, you need to create a connection to it, as shown in listing 8.1 <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> pg = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'pg'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> db = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> pg.Client({ <span class="hljs-attr"><span class="hljs-attr">database</span></span>: <span class="hljs-string"><span class="hljs-string">'articles'</span></span> });  ‚Üê   . db.connect(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err, client</span></span></span><span class="hljs-function">) =&gt;</span></span> {  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> err;  <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Connected to database'</span></span>, db.database);  db.end();  ‚Üê       ,   node . });</code> </pre> <br>  Detailed documentation on pg.Client and other methods can be found on the pg package wiki on <a href="https://github.com/brianc/node-postgres/wiki">GitHub</a> . <br><br><h3>  8.2.4.  Table definition </h3><br>  To store data in PostgreSQL, you first need to define the tables and the format of the data that will be stored in them.  An example of this kind is shown in Listing 8.2 (ch08-databases / listing8_3 in the archive of the source code of the book). <br><br>  Listing 8.2.  Schema definition <br><pre> <code class="hljs pgsql">db.query(` <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXISTS</span></span> snippets (  id <span class="hljs-type"><span class="hljs-type">SERIAL</span></span>,  <span class="hljs-keyword"><span class="hljs-keyword">PRIMARY KEY</span></span>(id),  body <span class="hljs-type"><span class="hljs-type">text</span></span>  ); `, (err, result) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) throw err; console.log(<span class="hljs-string"><span class="hljs-string">'Created table "snippets"'</span></span>); db.<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>(); });</code> </pre> <br><h3>  8.2.5.  Insert data </h3><br>  After the table is defined, you can insert data into it with INSERT queries (Listing 8.3).  If the id value is not specified, PostgreSQL will select it for you.  To find out which identifier has been selected for a particular entry, append the RETURNING id condition to the query;  the identifier will be displayed in the rows of the result passed to the callback function. <br><br>  Listing 8.3.  Insert data <br><br><pre> <code class="hljs pgsql">const body = <span class="hljs-string"><span class="hljs-string">'hello world'</span></span>; db.query(`  <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> snippets (body) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (    <span class="hljs-string"><span class="hljs-string">'${body}'</span></span>  )  <span class="hljs-keyword"><span class="hljs-keyword">RETURNING</span></span> id `, (err, result) =&gt; {  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) throw err;  const id = result.<span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>].id;  console.log(<span class="hljs-string"><span class="hljs-string">'Inserted row with id %s'</span></span>, id);  db.query(`    <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> snippets (body) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (      <span class="hljs-string"><span class="hljs-string">'${body}'</span></span>    )    <span class="hljs-keyword"><span class="hljs-keyword">RETURNING</span></span> id  `, () =&gt; {    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) throw err;    const id = result.<span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>].id;    console.log(<span class="hljs-string"><span class="hljs-string">'Inserted row with id %s'</span></span>, id);  }); });</code> </pre> <br><h3>  8.2.6.  Data update </h3><br>  After the data is inserted, it can be updated with an UPDATE query (Listing 8.4).  The number of records involved in the update will be available in the rowCount property of the query result.  A complete example for this listing is contained in the ch08-databases / listing8_4 directory. <br><br>  Listing 8.4.  Data update <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> id = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> body = <span class="hljs-string"><span class="hljs-string">'greetings, world'</span></span>; db.query(<span class="hljs-string"><span class="hljs-string">`  UPDATE snippets SET (body) = (    '</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${body}</span></span></span><span class="hljs-string">'  ) WHERE id=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${id}</span></span></span><span class="hljs-string">; `</span></span>, (err, result) =&gt; {  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> err;  <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Updated %s rows.'</span></span>, result.rowCount); });</code> </pre> <br><h3>  8.2.7.  Requests for data sampling </h3><br>  One of the most remarkable features of relational databases is the ability to perform complex random queries to data.  Queries are executed with the SELECT command, and the simplest example of this kind is shown in Listing 8.5. <br><br>  Listing 8.5.  Data request <br><br><pre> <code class="hljs pgsql">db.query(`  <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> snippets <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> id `, (err, result) =&gt; {  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) throw err;  console.log(result.<span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>); });</code> </pre> <br><h3>  8.3.  Knex </h3><br>  Many developers prefer to work with SQL commands in their applications not directly, but through an abstract add-in.  This desire is completely understandable: concatenating strings into SQL commands can be a cumbersome process that complicates understanding and maintaining queries.  This is especially true of the JavaScript language, which did not have the syntax for presenting multi-line strings before the appearance of template literals in ES2015 (see <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals">https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Template_literals</a> ).  In fig.  8.1 shows Knex statistics with the number of downloads proving popularity. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ba/uy/ei/bauyeitznjae61tugfxf4noimze.png" alt="image"></div><br>  Knex is a Node package that implements a lightweight abstraction for SQL, known as Query Builder.  The query builder generates SQL strings through a declarative API, which has much in common with the generated SQL commands.  Knex API is intuitive and predictable: <br><br><pre> <code class="hljs cs">knex({ client: <span class="hljs-string"><span class="hljs-string">'mysql'</span></span> })  .<span class="hljs-keyword"><span class="hljs-keyword">select</span></span>()  .<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>(<span class="hljs-string"><span class="hljs-string">'users'</span></span>)  .<span class="hljs-keyword"><span class="hljs-keyword">where</span></span>({ id: <span class="hljs-string"><span class="hljs-string">'123'</span></span> })  .toSQL();</code> </pre> <br>  This call creates a parameterized SQL query in the MySQL dialect: <br><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">`users`</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-string"><span class="hljs-string">`id`</span></span> = ?</code> </pre> <br><br><h3>  8.3.1.  jQuery for databases </h3><br>  Although the ANSI and ISO SQL standards appeared in the mid-1980s, most databases continue to use their own SQL dialects.  PostgreSQL is a notable exception: this database can boast of adhering to the SQL: 2008 standard.  The query builder is able to normalize the differences between SQL dialects, providing a single unified interface for generating SQL in different technologies.  This approach has obvious advantages for groups that regularly switch between different database technologies. <br><br>  Currently Knex.js supports the following databases: PostgreSQL;  MSSQL;  MySQL;  MariaDB;  SQLite3;  Oracle. <br><br>  In tab.  8.1 compares how to generate an INSERT command depending on the selected database. <br><br>  Table 8.1.  Comparing SQL commands generated by Knex for different databases <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2-/cv/ns/2-cvns4cksvqugqvmcab4xjd4vy.png" alt="image"></div><br>  Knex supports promises and Node-style callbacks. <br><br><h3>  8.3.2.  Connecting and querying in Knex </h3><br>  Unlike many other query builders, Knex can also connect and execute queries to the selected database driver for you. <br><br><pre> <code class="hljs cs">db(<span class="hljs-string"><span class="hljs-string">'articles'</span></span>)  .<span class="hljs-keyword"><span class="hljs-keyword">select</span></span>(<span class="hljs-string"><span class="hljs-string">'title'</span></span>)  .<span class="hljs-keyword"><span class="hljs-keyword">where</span></span>({ title: <span class="hljs-string"><span class="hljs-string">'Today'</span></span>s News<span class="hljs-string"><span class="hljs-string">' })  .then(articles =&gt; {    console.log(articles);  });</span></span></code> </pre> <br>  By default, Knex requests return promises, but they also support Node callback agreements using .asCallback: <br><br><pre> <code class="hljs scala">db(<span class="hljs-symbol"><span class="hljs-symbol">'article</span></span>s')  .select(<span class="hljs-symbol"><span class="hljs-symbol">'titl</span></span>e')  .where({ title: <span class="hljs-symbol"><span class="hljs-symbol">'Toda</span></span>y<span class="hljs-symbol"><span class="hljs-symbol">'s</span></span> <span class="hljs-type"><span class="hljs-type">News</span></span>' })  .asCallback((err, articles) =&gt; {    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> err;    console.log(articles);  });</code> </pre> <br>  In Chapter 3, we interacted with the SQLite database directly using the sqlite3 package.  This API can be rewritten using Knex.  Before running this example, first check from npm that the knex and sqlite3 packages are installed: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">npm</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">install</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">knex</span></span>@~<span class="hljs-keyword"><span class="hljs-keyword">0</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">12</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">0</span></span> sqlite3@~<span class="hljs-number"><span class="hljs-number">3.1</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> --save</code> </pre> <br>  Listing 8.6 uses sqlite to implement a simple Article model.  Save the file as db.js;  it will be used in Listing 8.7 to interact with the database. <br><br>  Listing 8.6.  Using Knex to connect and issue queries to sqlite3 <br><br><pre> <code class="hljs pgsql">const knex = require(<span class="hljs-string"><span class="hljs-string">'knex'</span></span>); const db = knex({  client: <span class="hljs-string"><span class="hljs-string">'sqlite3'</span></span>,  <span class="hljs-keyword"><span class="hljs-keyword">connection</span></span>: {    filename: <span class="hljs-string"><span class="hljs-string">'tldr.sqlite'</span></span>  },  useNullAsDefault: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>  ‚Üê             . }); module.exports = () =&gt; {  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> db.<span class="hljs-keyword"><span class="hljs-keyword">schema</span></span>.createTableIfNotExists(<span class="hljs-string"><span class="hljs-string">'articles'</span></span>, table =&gt; {    <span class="hljs-keyword"><span class="hljs-keyword">table</span></span>.increments(<span class="hljs-string"><span class="hljs-string">'id'</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">primary</span></span>();  ‚Üê       ¬´id¬ª,      .    <span class="hljs-keyword"><span class="hljs-keyword">table</span></span>.string(<span class="hljs-string"><span class="hljs-string">'title'</span></span>);    <span class="hljs-keyword"><span class="hljs-keyword">table</span></span>.text(<span class="hljs-string"><span class="hljs-string">'content'</span></span>);  }); }; module.exports.Article = {  <span class="hljs-keyword"><span class="hljs-keyword">all</span></span>() {    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> db(<span class="hljs-string"><span class="hljs-string">'articles'</span></span>).orderBy(<span class="hljs-string"><span class="hljs-string">'title'</span></span>);  },  find(id) {    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> db(<span class="hljs-string"><span class="hljs-string">'articles'</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">where</span></span>({ id }).first();  },  <span class="hljs-keyword"><span class="hljs-keyword">create</span></span>(data) {    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> db(<span class="hljs-string"><span class="hljs-string">'articles'</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">insert</span></span>(data);  },  <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>(id) {    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> db(<span class="hljs-string"><span class="hljs-string">'articles'</span></span>).del().<span class="hljs-keyword"><span class="hljs-keyword">where</span></span>({ id });  } };</code> </pre> <br>  Listing 8.7.  Interaction with API based on Knex <br><br><pre> <code class="hljs coffeescript">db().<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {  db.Article.create({    title: <span class="hljs-string"><span class="hljs-string">'my article'</span></span>,    content: <span class="hljs-string"><span class="hljs-string">'article content'</span></span>  }).<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {    db.Article.all().<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(articles =&gt; {      <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(articles);      process.exit();    });  }); }) .<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(err =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> err });</code> </pre> <br>  SQLite requires minimal configuration: you do not need to load the server daemon or create databases outside the application.  SQLite writes all the data in one file.  Having executed the previous code, you will see that in the current directory appeared the file articles.sqlite.  To destroy the SQLite database, it is enough to delete only one file: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">rm</span></span> articles.sqlite</code> </pre> <br>  SQLite also supports an in-memory mode in which writing to the disk is not performed at all.  This mode is commonly used to speed up automated tests.  To set the memory mode, a special file name is used: memory :.  When opening multiple connections to the file: memory: each connection gets its own isolated database: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> db = knex({  client: <span class="hljs-string"><span class="hljs-string">'sqlite3'</span></span>,  connection: {    filename: <span class="hljs-string"><span class="hljs-string">':memory:'</span></span>  },  useNullAsDefault: <span class="hljs-literal"><span class="hljs-literal">true</span></span> });</code> </pre> <br><br>  ¬ªMore information about the book can be found on <a href="https://www.piter.com/product_by_id/96424749">the publisher's website.</a> <br>  ¬ª <a href="https://storage.piter.com/upload/contents/978549603212/978549603212_X.pdf">Table of Contents</a> <br>  ¬ª <a href="https://storage.piter.com/upload/contents/978549603212/978549603212_p.pdf">Excerpt</a> <br><br>  For Habrozhiteley a 20% discount on the coupon - <b>Node.js</b> </div><p>Source: <a href="https://habr.com/ru/post/351602/">https://habr.com/ru/post/351602/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../351588/index.html">Mobile on CodeFest: about architecture, Kotlin and AR</a></li>
<li><a href="../351592/index.html">PowerShell Empire: advanced post-operation of Windows systems</a></li>
<li><a href="../351594/index.html">We turn logs as we want - analysis of logs on Windows systems</a></li>
<li><a href="../351596/index.html">US military must urgently rethink machine learning strategy</a></li>
<li><a href="../351598/index.html">Fintech Digest: Visa calculates Moscow's benefits of a bank transfer, PayPal VS cryptocurrency, Amazon plans something big</a></li>
<li><a href="../351610/index.html">We are looking for patterns on the stock exchange</a></li>
<li><a href="../351614/index.html">TP-Link T2600G-28MPS: work with PoE, LLDP and Voice VLAN</a></li>
<li><a href="../351616/index.html">Overview of the first day of Data Science Weekend 2018. Machine learning practice, a new approach to competition and much more</a></li>
<li><a href="../351618/index.html">Mosdroid # 6 - Report</a></li>
<li><a href="../351620/index.html">JS ‚Üî DOM tracing, or back and forth</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>