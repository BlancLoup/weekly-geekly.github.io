<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Attempting the number of times to create an almost perfect htaccess</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="- Google ranks higher sites that load faster. - If on eBay or Amazone to increase the loading time of pages by 9%, they lose 1% of the profits. - Make...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Attempting the number of times to create an almost perfect htaccess</h1><div class="post__text post__text-html js-mediator-article"><pre>  - Google ranks higher sites that load faster.
     - If on eBay or Amazone to increase the loading time of pages by 9%, they lose 1% of the profits.
     - Make your website faster to save on client traffic and on the number of calls to the server. </pre><br><br><h3>  .htaccess is our hero </h3><br>  Professionals know what htaccess is. <br>  Those who are going to leave with narod.ru on php-hosting just have to find out what it is. <br>  Those who have just installed their first jooml or wordpress urgently need to learn about our hero - htaccess <br><br><h3>  Why do we need .htaccess? </h3><br>  Imagine that you bought a hosting and it seems that you have almost found happiness.  But once (and maybe twice, and maybe three times) your site stops responding.  It starts to slowly boot and generally behave strangely.  And virtual hosting is such a tricky thing, that besides your website there are two dozen other sites on this server.  They are all different in power, organization and traffic.  And when your neighbor accidentally, and maybe intentionally runs on his hosting complex or redundant scripts in the algorithms, it responds to you. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Or another example.  Let's say your resource begins to gain popularity, but it is still too early to move to a dedicated server, and the capacity of the VPS is not enough.  You can really help out htaccess. <br><br>  And htaccess can solve some issues with the security of your site. <br><br>  And also ... <br><br><a name="habracut"></a><h1>  I want the perfect .htaccess! </h1><br>  It turns out on the Internet a lot of different conflicting information on how to use. Htaccess.  It took a long and tedious experiment to understand what is true and what is false.  In most cases, the authors of the councils in their blogs forget to mention that one or another Apache module is needed for certain conditions to work. <br>  But enough words, it's time to work.  Let's try to create an almost perfect .htaccess <br><br>  1. The first line sets the main options: <br><br><pre><code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">Options</span></span></span></span> <span class="hljs-literal"><span class="hljs-literal">All</span></span> -ExecCGI -Indexes -Includes +FollowSymLinks</code> </pre> <br>  Using the options is very convenient when you do not have access to Apache configuration or you need different Apache settings for different sites on the same server. <br><br>  The option -ExecCGI prohibits running CGI scripts.  It is better to allow only for specific folders.  Increase safety. <br>  The -Indexes option prohibits showing the contents of directories if there is no index file in them.  On shared hosting is usually enabled by default.  By changing the minus to plus + Indexes, on the contrary, you can allow viewing the contents of the directory (or directories). <br>  The -Includes option disables SSI.  If you do not know what it is - prohibit it (You can index ( <abbr title="A word is what made up ...">!</abbr> ) On request Server Side Include if you want to know more about this).  You can use the IncludesNOEXEC option, which allows SSI to be used without running scripts. <br>  The + FollowSymLinks option allows you to use symbolic links to files or directories that are not within the root of your site. <br><br><div class="spoiler">  <b class="spoiler_title">Note</b> <div class="spoiler_text">  You can use htaccess with different settings for different directories.  At the root of the site you can declare -Indexes, and in the selected directories create another .htaccess file and declare + Indexes in it.  Remember that the options htaccess spreads from top to bottom on the directory tree to the deepest nesting, until they are canceled by other htaccess. <br><br>  It is not necessary to list all the options in the child .htaccess completely if they do not change.  It is enough to specify (reassign) only those options and directives that change.  The remaining options are also inherited from the parent. </div></div><br><div class="spoiler">  <b class="spoiler_title">Example</b> <div class="spoiler_text">  Let's say you have this way / site / folder_one / subfolder / other / <br>  In the file /site/.htaccess you specify: <br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">Options</span></span></span></span> -Indexes Allow from <span class="hljs-literal"><span class="hljs-literal">all</span></span></code> </pre> <br>  In the file /site/folder_one/.htaccess you specify: <br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">Deny</span></span></span></span> from <span class="hljs-literal"><span class="hljs-literal">all</span></span></code> </pre> <br>  In the file /site/folder_one/subfolder/.htaccess you specify: <br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">Options</span></span></span></span> +Indexes Allow from <span class="hljs-literal"><span class="hljs-literal">all</span></span></code> </pre> <br>  Get this: <br>  Files of any content will be displayed in the site folder, unless you directly access them.  Or an index file, if not explicitly referring to one of the files.  In the absence of the index file received 403 error. <br>  Access to the folder_one folder is closed.  Even if you know the name of the file and type it in the address bar in response, the server will return error 403. <br>  The subfolder folder is allowed for referrals to a direct address, or in the absence of an index file will show the contents of the directory.  The same rights apply to the other folder. <br>  If you remove the file, htaccess from the folder_one folder, it will inherit the rights from the parent site. <br></div></div><br>  2. A bit of SEO (where to go without it) <br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;IfModule mod_rewrite.c&gt;</span></span> <span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">RewriteEngine</span></span></span></span> <span class="hljs-literal"><span class="hljs-literal">on</span></span> RewriteBase / RewriteCond <span class="hljs-variable"><span class="hljs-variable">%{HTTP_HOST}</span></span> ^black-web RewriteRule (.*) http://www.black-web.ru/<span class="hljs-number"><span class="hljs-number">$1</span></span><span class="hljs-meta"><span class="hljs-meta"> [R=301,L] RewriteCond %{THE_REQUEST} ^[AZ]{3,9}\ /index\.php\ HTTP/ RewriteRule ^index\.php$ http://www.black-web.ru/ [R=301,L] &lt;/IfModule&gt;</span></span></code> </pre> <br>  Be sure not to forget about the condition &lt;IfModule mod_rewrite.c&gt;.  Do not be at the host of this module and your site will produce a 500th error.  This particular module is included in the default Apache build.  Well, what if ... Hosters and their admins are all sorts. <br><br>  In this part, the benefits are more for SEO.  The rewrite module, as its name implies, deals with redirections <sup>(hello to Cap)</sup> . <br><br>  In this part of the file, we indicated two gluing: we glued your_site and <a href="http://www.xn--_-7sbbf2b7bj7b/">www.your_site,</a> even if the user type your website without WWW, transfer it to 301 with a redict on <a href="http://www.xn--_-7sbbf2b7bj7b/">www.your_site</a> . <br>  And also we got rid of /index.php in the query string.  If the user <a href="http://www.xn--_-7sbbf2b7bj7b/index.php">types www.your_site/index.php,</a> he will transfer it (again 301 rerunders) to <a href="http://www.xn--_-7sbbf2b7bj7b/">www.your_site</a> <br>  Now search engines will not be confused between www and will not duplicate the main page in the indexing results of your site.  We google seo gluing domain if you do not understand why it is needed. <br><br>  3. Who is in the main folder? <br><br>  If you have a folder there are index.html and index.php files (I don‚Äôt know why and who needed it, but have seen it more than once) then how to tell the server who they are more index? <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">DirectoryIndex</span></span> index.php</code> </pre> <br>  And you can also specify there we say roosso.php and then typing in the request line the address of the website.bla / bla / bla / you will see not the index, but the roosso <br><br>  4. More settings ... <br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;IfModule mod_setenvif.c&gt;</span></span> <span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">SetEnv</span></span></span></span> TZ Europe/Moscow &lt;/IfModule&gt; ServerSignature <span class="hljs-literal"><span class="hljs-literal">Off</span></span> AddDefaultCharset UTF-8</code> </pre> <br>  The first line sets the time zone.  For example, in Apache 2.22.22 there was a bug associated with this option.  Time functions in php did not work until you set the time zone. <br><br>  The second line is the server signature.  You have seen them more than once on any system pages like the 500th error or 403s.  Usually there is some technical information and mail webmasters.  I prefer even in such trifles to hide data about the software on the server.  Colleagues paranoid support me. <br><br>  Guess what the third line does? <br><br>  5. When there is no access to php.ini <br><br>  With .htaccess, we can also manage a number of PHP settings.  On the virtual hosting, as a rule, there is no possibility to change the settings of php.ini.  Most often this is not required.  But still there are a number of options control over which may be useful to us.  For example, increase the limit on downloading files, or the transfer limit of this method POST. <br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;ifModule mod_php.c&gt;</span></span> <span class="hljs-attribute"><span class="hljs-attribute">php_value</span></span> upload_max_filesize 32M php_value post_max_size 10M php_value default_charset utf-8 php_value max_execution_time 200 &lt;/ifModule&gt;</code> </pre> <br>  The first line allows you to upload files up to 32 megabytes.  By default, php is usually 8 or 16 megabytes. <br>  The second line allows posting up to 10 megabytes.  The default value is usually 2 megabytes. <br>  The third line sets the encoding used by your scripts.  At its core, it duplicates the line: "AddDefaultCharset UTF-8."  But I often resort to installing the encoding via php. <br>  The fourth line we change the time limit allocated to the execution of the script.  By default, it is usually 30 seconds.  But sometimes it takes more time to perform some complex processing. <br><br>  6. Types of files.  Sleight of hand and not any fraud. <br><br>  In my practice it happened a couple of times that after any update by the software provider, the file types flew.  Although this is rare.  For 10 years, just two cases.  But sometimes I needed to make html work like php.  And sometimes you want to teach the Apache to distinguish between types of files that he does not know.  (As it turned out, Apache doesn't know much about rare file types.) In this situation, the following code will save us: <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">AddHandler</span></span> application/x-httpd-php .html AddHandler cgi-script .pl .py .jsp .asp .htm .shtml .sh .cgi AddType application/x-javascript .js AddType text/css .css AddType text/xml .xml AddType application/octet-stream .doc .mov .avi .pdf .xls # ForceType application/x-httpd-php</code> </pre><br><br>  The first line will allow our php files to have the html extension, but run as php.  It is useful in many cases.  And in the good old when the search engines indexed CNC better, such a line always came to the rescue. <br>  We can reassign, add or replace any file types under permissions that are convenient for us. <br><br><div class="spoiler">  <b class="spoiler_title">Interesting trick</b> <div class="spoiler_text">  By the way, you can easily write for example the following line: <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">AddHandler</span></span> application/x-httpd-php .i</code> </pre> <br>  Then rename all your files by changing the extension to .i (without forgetting links, of course) and the file addresses on your site will not be site.my / index.php? Uri, but website.my / index.i? Uri <br><br>  For example, I am writing <br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-attribute">AddHandler</span></span> application/x-httpd-php .roosso</code> </pre> <br>  and create the alex.roosso file in the root of my site inside a regular php code.  This is kind of like a favorite page about me.  And in the address bar it will look like <a href="http://www.black-web.ru/alex.roosso">www.black-web.ru/alex.roosso</a> (link is working, you can see what it is). </div></div><br>  The second line indicates which file extensions should be executed as cgi scripts. <br><br>  The third, fourth and fifth lines, just in case, specify the mime type of files with css, js, xml resolution.  Do not confuse with the assignment of a header in the server's response to the request, as is done in the first two lines. <br><br>  The sixth line of this site is needed if your site has content downloaded for users.  If you add this line, then when accessing these files they will be offered to download them to a computer, and not like a bunch of plugins that even word open in the browser now in modern browsers. <br><br>  I commented out the seventh line.  This is a line in a voluntary-voluntary manner, all files from your server will run as php.  It is better to use it only in separate folders, if necessary. <br><br>  7. Adults and children know that archives weigh less ... <br><br>  Useful when your pages load faster.  Therefore, people came up with archived files.  And then they thought and decided that you can also archive pages on websites and images.  And do it imperceptibly for the user, but significantly reduce traffic and speed up page loading.  Magic words have sounded, now we will discuss how this can be done. <br><br>  Apache has two compression modules.  Both are not default modules, so they may not necessarily be present with your provider.  But as practice has shown in 99% of providers, one of them is worth it.  The most common mod_deflate.  To compress it using all the content on your site, add the following lines to .htaccess: <br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;ifModule mod_deflate.c&gt;</span></span> <span class="hljs-attribute"><span class="hljs-attribute">AddOutputFilterByType</span></span> DEFLATE text/html text/plain text/xml application/xml application/xhtml+xml text/css text/javascript application/javascript application/x-javascript &lt;/ifModule&gt;</code> </pre> <br>  As you can see, we need to list the mime type of files that should be compressed.  Here you can add videos and pictures, but it will give little sense.  Because jpeg or gif are already compressed formats.  Also avi or flv.  You actually have nothing to win by pointing them out. <br><br>  The second less popular module is mod_gzip. To enable compression with it, add these lines: <br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;IfModule mod_gzip.c&gt;</span></span> <span class="hljs-attribute"><span class="hljs-attribute">mod_gzip_on</span></span> Yes mod_gzip_dechunk Yes mod_gzip_item_include file \.(html?|txt|css|js|php|pl)$ mod_gzip_item_include mime ^text\.* mod_gzip_item_include mime ^application/x-javascript.* mod_gzip_item_exclude mime ^image\.* mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.* &lt;/IfModule&gt;</code> </pre> <br>  This module can work with masks, which is undoubtedly a big plus.  And the syntax is much more flexible than the previous one.  But use it less often.  And by compression, I can not even judge which module is better.  I did not notice a strong difference in the tests. <br><br>  8. Is it even faster? <br><br>  Can.  If you apply caching pages.  Caching has both pluses and minuses, so you need to be prepared for this issue.  For a dynamically updated website every 2-3 minutes, for example, a popular forum, you need to consider that the user must see the actual information.  But any site has content that is more or less static.  For example, the same pictures, or style files.  Therefore, we need to use different caching of different content on the site.  In html markup, we can always use meta tags.  And through php we can set the server response headers.  The question remains, how to deal with css, js, image, etc.  etc. <br><br>  Two modules can help us with this: mod_headers and mod_expires which can set headers in the server‚Äôs response and tell your browser what to cache.  One of the modules usually stands with the provider, but as is the case with any module that is not included in the standard Apache assembly, no one will give you a 100% guarantee.  Therefore, again in order to avoid a 500th error, the conditions for each of the modules are indicated. <br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;ifModule mod_headers.c&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment"># html  htm     &lt;FilesMatch "\.(html|htm)$"&gt; Header set Cache-Control "max-age=43200" &lt;/FilesMatch&gt; # css, javascript       &lt;FilesMatch "\.(js|css|txt)$"&gt; Header set Cache-Control "max-age=604800" &lt;/FilesMatch&gt; #      &lt;FilesMatch "\.(flv|swf|ico|gif|jpg|jpeg|png)$"&gt; Header set Cache-Control "max-age=2592000" &lt;/FilesMatch&gt; #  &lt;FilesMatch "\.(pl|php|cgi|spl|scgi|fcgi)$"&gt; Header unset Cache-Control &lt;/FilesMatch&gt; &lt;/IfModule&gt;</span></span></code> </pre> <br>  Here is the syntax for mod_headers.  I think the comments clearly what's what. <br>  In this section, I turned off the caching of php files.  Although in my opinion a small time interval of caching does not hurt them.  5-30 seconds is a time interval for which little changes.  And many users like to use the back key.  In order not to load the page for them a second time, but to pick it up from the cache, a reasonable cache interval is still appropriate. <br><br>  In the second section, where the conditions for mod_expires go, I do just that - for php I set a small cache interval. <br><br><pre> <code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;ifModule mod_expires.c&gt;</span></span> <span class="hljs-attribute"><span class="hljs-attribute">ExpiresActive</span></span> <span class="hljs-literal"><span class="hljs-literal">On</span></span> #    5  ExpiresDefault <span class="hljs-string"><span class="hljs-string">"access plus 5 seconds"</span></span> #      ExpiresByType image/x-icon <span class="hljs-string"><span class="hljs-string">"access plus 2592000 seconds"</span></span> ExpiresByType image/jpeg <span class="hljs-string"><span class="hljs-string">"access plus 2592000 seconds"</span></span> ExpiresByType image/png <span class="hljs-string"><span class="hljs-string">"access plus 2592000 seconds"</span></span> ExpiresByType image/gif <span class="hljs-string"><span class="hljs-string">"access plus 2592000 seconds"</span></span> ExpiresByType application/x-shockwave-flash <span class="hljs-string"><span class="hljs-string">"access plus 2592000 seconds"</span></span> # css, javascript       ExpiresByType text/css <span class="hljs-string"><span class="hljs-string">"access plus 604800 seconds"</span></span> ExpiresByType text/javascript <span class="hljs-string"><span class="hljs-string">"access plus 604800 seconds"</span></span> ExpiresByType application/javascript <span class="hljs-string"><span class="hljs-string">"access plus 604800 seconds"</span></span> ExpiresByType application/x-javascript <span class="hljs-string"><span class="hljs-string">"access plus 604800 seconds"</span></span> # html  htm     ExpiresByType text/html <span class="hljs-string"><span class="hljs-string">"access plus 43200 seconds"</span></span> # xml     ExpiresByType application/xhtml+xml <span class="hljs-string"><span class="hljs-string">"access plus 600 seconds"</span></span> &lt;/ifModule&gt;</code> </pre> <br><br>  9. Rules polite tone ... <br><br>  In the process of upgrading your site, we often leave tails in the form of links that lead to the pages that we removed.  Sometimes such links come from other sites or from search engines.  In order not to lose users in a polite tone, it is considered to have your own pages for various types of errors.  Including even server errors.  For example, the standard message about the 500th error is very boring and gloomy, and it is unlikely that the user will want to visit your page again.  But in htaccess there are tricks that can make even this page more friendly. <br><br><pre> <code class="apache hljs"><span class="hljs-comment"><span class="hljs-comment"># Bad Rquest ErrorDocument 400 /400.html # Authorization Required ErrorDocument 401 /401.html # Forbidden ErrorDocument 403 /403.html # Not found ErrorDocument 404 /404.html # Method Not Allowed ErrorDocument 405 /405.html # Request Timed Out ErrorDocument 408 /408.html # Request URI Too Long ErrorDocument 414 /414.html # Internal Server Error ErrorDocument 500 /500.html # Not Implemented ErrorDocument 501 /501.html # Bad Gateway ErrorDocument 502 /502.html # Service Unavailable ErrorDocument 503 /503.html # Gateway Timeout ErrorDocument 504 /504.html</span></span></code> </pre> <br>  For 400 errors, you can use dynamic pages on php.  But for 500 it is better to do it on html and js.  This part of the errors is usually associated with server errors (in most cases) and php or cgi usually do not work in this situation. <br><br>  If you are too lazy to do so many pages, set the error page to the main page of your site or a site map. <br><br>  All this you do exclusively for people.  Search robots do not care if you have an error page or not.  They see the server response with an error code and block your page in the search.  So keep in mind, this is not a panacea.  This is only courtesy to your audience and the image of your site. <br><br>  10. To summarize <br><br>  Connoisseurs understand that not all are described in this article.  I have touched here only the surface of the iceberg.  In fact, the possibilities of .htaccess are much more extensive than described in the article.  But I did not pursue the goal to translate manaul on htaccess into Russian.  All I wanted was to create a small backbone of the .htaccess file for those who had just begun to study this issue in order to save their time searching for information on the network. <br><br>  As a result of all the manipulations, we should have received the following file: <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">Options</span></span></span></span> <span class="hljs-literal"><span class="hljs-literal">All</span></span> -ExecCGI -Indexes -Includes +FollowSymLinks &lt;IfModule mod_rewrite.c&gt; RewriteEngine <span class="hljs-literal"><span class="hljs-literal">on</span></span> RewriteBase / RewriteCond <span class="hljs-variable"><span class="hljs-variable">%{HTTP_HOST}</span></span> ^black-web RewriteRule (.*) http://www.black-web.ru/<span class="hljs-number"><span class="hljs-number">$1</span></span><span class="hljs-meta"><span class="hljs-meta"> [R=301,L] RewriteCond %{THE_REQUEST} ^[AZ]{3,9}\ /index\.php\ HTTP/ RewriteRule ^index\.php$ http://www.black-web.ru/ [R=301,L] &lt;/IfModule&gt; DirectoryIndex index.php &lt;IfModule mod_setenvif.c&gt; SetEnv TZ Europe/Moscow &lt;/IfModule&gt; ServerSignature Off #AddDefaultCharset UTF-8 &lt;ifModule mod_php.c&gt; php_value upload_max_filesize 32M php_value post_max_size 10M php_value default_charset utf-8 php_value max_execution_time 200 &lt;/ifModule&gt; AddHandler application/x-httpd-php .html AddHandler cgi-script .pl .py .jsp .asp .htm .shtml .sh .cgi AddType application/x-javascript .js AddType text/css .css AddType text/xml .xml AddType application/octet-stream .doc .mov .avi .pdf .xls # ForceType application/x-httpd-php &lt;ifModule mod_deflate.c&gt; AddOutputFilterByType DEFLATE text/html text/plain text/xml application/xml application/xhtml+xml text/css text/javascript application/javascript application/x-javascript &lt;/ifModule&gt; &lt;IfModule mod_gzip.c&gt; mod_gzip_on Yes mod_gzip_dechunk Yes mod_gzip_item_include file \.(html?|txt|css|js|php|pl)$ mod_gzip_item_include mime ^text\.* mod_gzip_item_include mime ^application/x-javascript.* mod_gzip_item_exclude mime ^image\.* mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.* &lt;/IfModule&gt; &lt;ifModule mod_headers.c&gt; # html  htm     &lt;FilesMatch "\.(html|htm)$"&gt; Header set Cache-Control "max-age=43200" &lt;/FilesMatch&gt; # css, javascript       &lt;FilesMatch "\.(js|css|txt)$"&gt; Header set Cache-Control "max-age=604800" &lt;/FilesMatch&gt; #      &lt;FilesMatch "\.(flv|swf|ico|gif|jpg|jpeg|png)$"&gt; Header set Cache-Control "max-age=2592000" &lt;/FilesMatch&gt; #  &lt;FilesMatch "\.(pl|php|cgi|spl|scgi|fcgi)$"&gt; Header unset Cache-Control &lt;/FilesMatch&gt; &lt;/IfModule&gt; &lt;ifModule mod_expires.c&gt; ExpiresActive On #    5  ExpiresDefault "access plus 5 seconds" #      ExpiresByType image/x-icon "access plus 2592000 seconds" ExpiresByType image/jpeg "access plus 2592000 seconds" ExpiresByType image/png "access plus 2592000 seconds" ExpiresByType image/gif "access plus 2592000 seconds" ExpiresByType application/x-shockwave-flash "access plus 2592000 seconds" # css, javascript       ExpiresByType text/css "access plus 604800 seconds" ExpiresByType text/javascript "access plus 604800 seconds" ExpiresByType application/javascript "access plus 604800 seconds" ExpiresByType application/x-javascript "access plus 604800 seconds" # html  htm     ExpiresByType text/html "access plus 43200 seconds" # xml     ExpiresByType application/xhtml+xml "access plus 600 seconds" &lt;/ifModule&gt; # Bad Rquest ErrorDocument 400 /400.html # Authorization Required ErrorDocument 401 /401.html # Forbidden ErrorDocument 403 /403.html # Not found ErrorDocument 404 /404.html # Method Not Allowed ErrorDocument 405 /405.html # Request Timed Out ErrorDocument 408 /408.html # Request URI Too Long ErrorDocument 414 /414.html # Internal Server Error ErrorDocument 500 /500.html # Not Implemented ErrorDocument 501 /501.html # Bad Gateway ErrorDocument 502 /502.html # Service Unavailable ErrorDocument 503 /503.html # Gateway Timeout ErrorDocument 504 /504.html</span></span></code> </pre> <br><br>  11. Afterword. <br><br>  I tried not to hurry in writing the article and it took almost a day.  But still somewhere I could make mistakes in spelling or punctuation.  Please do not execute, and mercy.  And better to write in a personal, so I corrected the error. <br><br>  And finally, for those who like experiments, a few lines of .htaccess.  Judging by my own experience - in practice, knowledge is absorbed better than in theory. <br><div class="spoiler">  <b class="spoiler_title">Various interesting examples</b> <div class="spoiler_text"><pre> <code class="apache hljs"><span class="hljs-comment"><span class="hljs-comment"># SECURE ____________________ &lt;IfModule mod_ssl.c&gt; SSLOptions +StrictRequire SSLRequireSSL SSLRequire %{HTTP_HOST} eq "black-web.ru" &lt;/IfModule&gt; &lt;IfModule mod_rewrite.c&gt; RewriteCond %{HTTPS} !on RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} &lt;/IfModule&gt; # HOTLINKING ________________ &lt;IfModule mod_rewrite.c&gt; RewriteCond %{HTTP_REFERER} !^$ RewriteCond %{HTTP_REFERER} !^http://([ -a-z0-9] \.)?black-web\.ru [NC] RewriteRule \.(gif|jpe?g|png)$ - [F,NC,L] &lt;/IfModule&gt; # REDIRICT __________________ Redirect 301 /index.html /index.php &lt;IfModule mod_rewrite.c&gt; RewriteRule ^news/([^/\.]+)/?$ news.php?news=$1 [L] RewriteRule ^(.*\.((js)|(css)))$ plugin/GzipFile.php?file=$1 RewriteRule \.css$ plugin/GzipFile.php?file=$1 RewriteRule \.js$ plugin/GzipFile.php?file=$1 &lt;/IfModule&gt; RedirectMatch 301 /blog(.*) http://www.black-web.ru/$1</span></span></code> </pre> </div></div><br><br>  <b>PS</b> <br><blockquote>  ... For those who have succeeded, go to <a href="http://www.webpagetest.org/">www.webpagetest.org to</a> measure the beauty before and after. <br>  <a href="http://habrahabr.ru/users/andrey_zentavr/" class="user_link">Andrey_Zentavr</a> </blockquote><blockquote>  Who should take a fully ready .htaccess <a href="https://github.com/Roosso/other/blob/master/.htaccess">here</a> <br>  This file showed the highest performance on the tests. <br>  Also, there are a lot of things commented out about what I did not mention in the article and what can be useful in certain cases. </blockquote></div><p>Source: <a href="https://habr.com/ru/post/154643/">https://habr.com/ru/post/154643/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../154629/index.html">Bundle Transformer 1.6.5 released</a></li>
<li><a href="../154633/index.html">The digest of interesting news and materials from the world of ayti for the last week ‚Ññ26 (October 6 - 12, 2012)</a></li>
<li><a href="../154637/index.html">‚ÄúArguments for Mars‚Äù - a music video from the Symphony of Science series</a></li>
<li><a href="../154639/index.html">[Html 5] SharedWorker: examples of use</a></li>
<li><a href="../154641/index.html">Your look at the life cycle of Ubuntu on the desktop</a></li>
<li><a href="../154647/index.html">Alternative DNS owner sues ICANN</a></li>
<li><a href="../154653/index.html">Interactorium: Get to Mars today</a></li>
<li><a href="../154657/index.html">TechCrunch: Vertu Moves to Android</a></li>
<li><a href="../154661/index.html">DriverPack Solution Update Configurator</a></li>
<li><a href="../154663/index.html">mysqlnd</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>