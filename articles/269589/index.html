<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Pure architecture</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From the translator: this article was written by Uncle Bob in August 2012, but, in my opinion, quite relevant to this day. 



 Over the past few year...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Pure architecture</h1><div class="post__text post__text-html js-mediator-article">  <i>From the translator: this article was <a href="http://blog.8thlight.com/uncle-bob/2012/08/13/the-clean-architecture.html">written by Uncle Bob</a> in August 2012, but, in my opinion, quite relevant to this day.</i> <br><br><img src="https://habrastorage.org/files/23a/0de/4d9/23a0de4d93d747c89f1e216077c2d604.jpg"><br><br>  Over the past few years, we have seen a variety of ideas regarding system architecture.  Each of them gave the output: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  <b>Independence from the framework</b> .  The architecture does not depend on the existence of any library.  This allows the framework to be used as a tool, rather than squeezing its system into the framework of its limitations. </li><li>  <b>Testability</b>  Business rules can be tested without a user interface, database, web server, or any other external component. </li><li>  <b>Independence from UI</b> .  The user interface can be easily changed without changing the rest of the system.  For example, the web interface can be replaced by the console, without changing business rules. </li><li>  <b>Independence from the database</b> .  You can change Oracle or SQL Server to MongoDB, BigTable, CouchDB or something else.  Your business rules are not associated with the database. </li><li>  <b>Independence from any external service</b> .  In fact, your business rules simply do not know anything about the outside world. </li></ol><br><br>  The diagram at the beginning of this article is an attempt to combine all these ideas into a single effective scheme. <a name="habracut"></a><br><br><h2>  Dependency Rule </h2><br>  The concentric circles in the diagram represent the different layers of software.  In general, the further you go, the more general the level becomes.  Outer circles - mechanics.  Internal circles are politics. <br><br>  The main rule that makes this architecture work is the <i>Rule of Dependencies</i> .  This rule states that dependencies in the source code can only indicate inside.  Nothing from the inner circle can know anything about the outer circle, nothing from the inner circle can point to the outer circle.  This applies to functions, classes, variables, etc. <br><br>  Moreover, the data structures used in the outer circle should not be used in the inner circle, especially if these structures are generated by the framework in the outer circle.  We do not use anything from the outer circle to affect the inner. <br><br><h3>  Entities </h3><br>  Entities are determined by the business rules of the enterprise.  An entity can be an object with methods or it can be a set of data structures and functions.  It does not matter how long the entity can be used in different applications. <br><br>  If you are writing just a single application, in this case the entities are the business objects of this application.  They encapsulate the most common high-level rules.  It is least likely that they will change with any external changes.  For example, they should not be affected when changing page navigation or security rules.  External changes should not affect the entity layer. <br><br><h3>  Scenarios </h3><br>  This layer implements the specifics of business rules.  It encapsulates and implements all uses of the system.  These scripts implement the flow of data to and from the <i>Entities</i> layer to implement business rules. <br><br>  We do not expect changes in this layer that affect <i>Entities</i> .  We also do not expect that this layer may be affected by external changes, such as databases, user interfaces, or frameworks.  This layer is isolated from such problems. <br><br>  We, however, expect changes in the application to affect <i>Scripting</i> .  If there are any changes in the behavior of the application, they will undoubtedly affect the code in this layer. <br><br><h3>  Interface Adapters </h3><br>  The software in this layer is a set of adapters that convert data from the format that is most convenient for <i>Scenarios</i> and <i>Entities</i> into the format that is most convenient for further use, for example, in a database.  It is this layer, for example, that will fully contain the MVC architecture.  <i>Models</i> are most likely data structures that are passed from controllers to <i>Scenarios</i> , and then back from <i>Scenarios</i> to <i>Views</i> . <br><br>  In the same way, the data is converted, in this layer, from the form most convenient for <i>Scenarios</i> and <i>Entities</i> , to the form most convenient for permanent storage, for example in a database.  The code inside this circle should not know anything about the database.  If the database is a SQL database, then any SQL statements should not be used at this level. <br><br><h3>  Framework and drivers. </h3><br>  The outer layer usually consists of frameworks, databases, UI, etc.  As a rule, a lot of code is not written in this layer, except for the code that communicates with the inner circles. <br><br>  This is a cluster of parts.  The Internet is a part, the DB is a detail, we keep these things outside to reduce their influence. <br><br><h2>  Only four laps? </h2><br>  No, the circles are sketchy.  You may decide that you need more than these four.  There is no rule stating that you should always have only these four.  However, the <i>Dependency Rule</i> always applies.  Dependencies in the source code always point inside.  As you move inside, the level of abstraction increases.  The outer circle is the level of detail.  The inner circle is the most common. <br><br><h2>  Crossing borders. </h2><br>  The lower right side of the diagram shows an example of how we cross the boundaries of a circle.  <i>Controllers</i> and <i>Views</i> interact with <i>Scenarios</i> from the next layer.  Take a snapshot on the control flow.  It starts in the <i>Controller</i> , moves through the <i>Scenario</i> , and then ends execution in the <i>View</i> .  Note the dependencies in the source code.  Each of them points inward to the <i>Scenario</i> . <br><br>  Usually we solve this apparent contradiction with the help of the <i><a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25B8%25D0%25BD%25D1%2586%25D0%25B8%25D0%25BF_%25D0%25B8%25D0%25BD%25D0%25B2%25D0%25B5%25D1%2580%25D1%2581%25D0%25B8%25D0%25B8_%25D0%25B7%25D0%25B0%25D0%25B2%25D0%25B8%25D1%2581%25D0%25B8%25D0%25BC%25D0%25BE%25D1%2581%25D1%2582%25D0%25B5%25D0%25B9">Principle of Inversion of Dependencies</a></i> . <br><br>  For example, suppose you need to refer to the <i>View</i> from the <i>Scenario</i> .  However, this call should not be direct, in order not to violate the <i>Rule of Dependencies</i> - the inner circle does not know anything about the outside.  Thus, the <i>Scenario</i> calls the interface (shown in the diagram as the Output Port) in the inner circle, and the <i>View</i> from the outer circle implements it. <br><br>  The same technique is used to cross all boundaries in architecture.  We will take advantage of dynamic polymorphism to create dependencies in the source code so that the flow of control complies with the <i>Rule of Dependencies</i> . <br><br><h2>  How data crosses borders. </h2><br>  Typically, data that crosses boundaries is simply data structures.  You can use basic structures or, if you wish, Data Transfer Objects (DTO is one of the design patterns used to transfer data between application subsystems).  Or the data may simply be function call arguments.  Or you can pack it into a hash table or object.  It is important that the transmitted data structures be isolated when passing across borders.  We do not want to cheat and transmit the <i>Essence</i> or DB lines.  We do not want data structures to have any dependencies that violate the <i>Dependency Rule</i> . <br><br>  For example, many frameworks (ORM) in response to a query to the database return data in a convenient format.  We could call it RowStructure.  We do not want to transfer this structure across the border.  This would be a violation of the <i>Dependencies Rule,</i> since in this case the inner circle receives information about the outer circle. <br><br>  Therefore, the transfer of data across the border should always be in a format convenient for the inner circle. <br><br><h2>  Conclusion </h2><br>  Following these simple rules is not difficult and they will save you a lot of time in the future.  By separating the software into layers and following the <i>Rule of Dependencies,</i> you will create a system to be tested, with all the attendant advantages.  When any of the external subsystems becomes obsolete, be it a database or a web framework, you can easily replace them. <br><br>  PS This article is translated as preparation for a later and slightly more practical oriented article on pure architecture on Go.  Interesting? </div><p>Source: <a href="https://habr.com/ru/post/269589/">https://habr.com/ru/post/269589/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../269573/index.html">Perl5 plugin for IntelliJ IDEA v1.1</a></li>
<li><a href="../269575/index.html">Mobile NFC payments market: key players, current situation and future prospects</a></li>
<li><a href="../269577/index.html">Yes, I am writing a Windows desktop application.</a></li>
<li><a href="../269579/index.html">I2P: Transparent EdDSA Signature Implementation</a></li>
<li><a href="../269581/index.html">npm @ 3: the future is here</a></li>
<li><a href="../269591/index.html">Debugging Shaders in Java + Groovy</a></li>
<li><a href="../269597/index.html">Webinar third. Backup as the basis of peace. Backup schemes</a></li>
<li><a href="../269599/index.html">Search for uninitialized class members</a></li>
<li><a href="../269601/index.html">Step-by-step work GOST R 34.12-2015 in ECB mode</a></li>
<li><a href="../269603/index.html">Turn a group of surveillance cameras into a botnet? Nothing is easier</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>