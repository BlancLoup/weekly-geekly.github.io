<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Replace the standard element input file</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, while customizing (forgive me Russian scholars), I would even call it web modding (sorry again, dear Russian scholars) of standard form elem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Replace the standard element input file</h1><div class="post__text post__text-html js-mediator-article">  Recently, while customizing (forgive me Russian scholars), I would even call it web modding (sorry again, dear Russian scholars) of standard form elements, and in particular the file element, I came across a big nuisance: it turned out to be unprofitable for customization.  The point is this: from the file element we especially need its "Upload files" dialog box, which cannot be extracted using software in Mozilla and Opera browsers, i.e.  command document.getElementById ('SaveForm'). click ();  will return nothing.  The developers claim that it is unsafe, which is debatable.  But IE pleased me, it sends a mouse click to the file element without hindrance, most likely due to an oversight of developers who left the ‚Äúmost dangerous hole‚Äù in your security. <br><a name="habracut"></a><br>  As I just did not dodge nothing.  Googling for three hours, stumbled upon the first testimony of the ideal <a href="http://www.quirksmode.org/dom/inputfile.html">solution</a> : put the file in a div, make the div transparent (opacity: 0%), draw your attention to the fact that it should be made transparent, but not invisible (visibility: hidden), relatively speaking opacity : 0% hides the element from the eyes, and visibility: hidden also from the mouse.  But if you play with the font sizes, the method begins to lose its appeal, you have the opportunity to miss the invisible button. <br>  An hour later, I came across another example of <a href="http://sourceforge.net/projects/yamzbrowser/">yamzbrowser</a> (allows you to upload files to the server from a swf object inserted into an html page).  He repeats the first method, but!  with one difference: it inserts a div under the mouse cursor when moving.  By the way, I managed to find it out thanks to Opera (I usually use Fox, and this is a great coincidence that I opened the example with Opera), since the author forgot to set transparency for her too. <br><br>  Having studied both methods, I combined them into one and developed a solution for wider use on the Web.  And so, sit down comfortably we begin. <br><h3>  Assumptions </h3><br><ol><li>  The size of the file substitute element may differ significantly from the size of the file itself. </li><li>  The file element is part of the form. </li><li>  Only paranoid disables JavaScript in the browser. </li><li>  The visitor refers to those modest 99% of users using Firefox, Opera or IE </li><li>  The solution should work using the same algorithm in all browsers, i.e.  the option of using different tools for IE is document.getElementById ('SaveForm'). click (); and substitution for FF and Opera is unacceptable </li><li>  The solution can be duplicated on the page. </li></ol><br><h3>  Algorithm </h3><br>  When you hover the mouse over the substitute button, the layer with the element is inserted under the cursor so that the cursor is in the middle of the layer, so  we will know for sure that the user will not miss the button and the visibility changes to visible: the layer with the element remains invisible but accessible to the mouse.  When the cursor is moved, we move the layer within the substituting button, upon reaching the edge of the button, visibility is set to hidden. <br><h3>  Recipe </h3><br><h4>  HTML </h4><br> <code><font color="#006600">&lt;form&gt; <br> &lt;div id="divFile1" class="file" onmousemove="divFileMove(this.id, 'buttonFile1',event);"&gt; <br> &lt;input type="file" name="UploadFile" id="file1" size="1" onchange="result(this.id, 'divResult');" tabindex="1" /&gt; <br> &lt;/div&gt; <br> &lt;div id="divResult"&gt; &lt;/div&gt; <br> &lt;image src="./images/fileUploadButton.jpg" id="buttonFile1" onmouseover="divFileShow('divFile1', event);"/&gt; <br> &lt;/form&gt;</font></code> <br> <h4>  CSS </h4><br> <code><br> <font color="#FF00CC">div.file{</font> <br> <font color="#000099">position</font> <font color="#FF00cc">:</font> <font color="#0033FF">absolute</font> <font color="#FF00CC">;</font> <br> <font color="#000099">top</font> <font color="#FF00CC">:</font> <font color="#0033FF">-1000px</font> <font color="#FF00CC">;</font> <br> <font color="#000099">left</font> <font color="#FF00CC">:</font> <font color="#0033FF">-1000px</font> <font color="#FF00CC">;</font> <br> <font color="#000099">-moz-opacity</font> <font color="#FF00CC">:</font> <font color="#0033FF">0</font> <font color="#FF00CC">;</font> <br> <font color="#000099">filter</font> <font color="#FF00CC">:</font> <font color="#0033FF">alpha(opacity=0)</font> <font color="#FF00CC">;</font> <br> <font color="#000099">opacity</font> <font color="#FF00CC">:</font> <font color="#0033FF">0%</font> <font color="#FF00CC">;</font> <br> <font color="#000099">visibility</font> <font color="#FF00CC">:</font> <font color="#0033FF">hidden</font> <font color="#FF00CC">;</font> <br> <font color="#FF00CC">}</font></code> <br> <br>  div.file - it is the .file class that is used and not id, in view of assumption number 6. <br>  top, left: -1000px - hides the layer before javascript gets to it, just in case. <br>  -moz-opacity, filter: alpha, opacity - sets the transparency for FF, IE and Opera, respectively. <br>  visibility: hidden - hides from the mouse. <br><h4>  Javascript </h4><br>  Function divFileShow (divId, e), where divId is the id of the layer with the element file, e is the event.  The mouseX and mouseY functions calculate the mouse position relative to the upper left corner for all browsers.  It makes the layer visible to the mouse and inserts it under the cursor so that the cursor is in the middle of the layer, so we don‚Äôt miss. <br><br> <code><b>function</b> divFileShow <b><font color="#000099">(</font></b> divId,e <b><font color="#000099">){</font></b> <br> <b><font color="#000099">var</font></b> div <font color="#0033FF">=</font> <font color="#990066">document</font> .getElementById <b><font color="#000099">(</font></b> divId <b><font color="#000099">)</font></b> ; <br> div.style.left <font color="#0033FF">=</font> <b><font color="#000099">(</font></b> mouseX <b><font color="#000099">(</font></b> e <b><font color="#000099">)</font></b> <font color="#0033FF">-</font> <font color="#009999">Math</font> . <font color="#009999">round</font> <b><font color="#000099">(</font></b> div.offsetWidth <font color="#0033FF">/</font> <font color="#FF0000">2</font> <b><font color="#000099">))</font></b> <font color="#0033FF">+</font> <font color="#0033FF">"px"</font> <b>;</b> <br> div.style.top <font color="#0033FF">=</font> <b><font color="#000099">(</font></b> mouseY <b><font color="#000099">(</font></b> e <b><font color="#000099">)</font></b> <font color="#0033FF">-</font> <font color="#009999">Math</font> . <font color="#009999">round</font> <b><font color="#000099">(</font></b> div.offsetHeight <font color="#0033FF">/</font> <font color="#FF0000">2</font> <b><font color="#000099">))</font></b> <font color="#0033FF">+</font> <font color="#0033FF">"px"</font> ; <br> div.style.visibility <font color="#0033FF">=</font> <font color="#0033FF">"visible"</font> ; <br> <b><font color="#000099">}</font></b></code> <br>  The divFileMove function (divId, butId, e), where divId is the layer id, butId is the replacement button id (necessary for getting the button dimensions), e-event.  It makes the layer move after the mouse when the butId object reaches the boundary. <br> <code><b>function</b> divFileMove <b><font color="#000099">(</font></b> divId, butId, e <font color="#000099"><b>){</b></font> <br> <b><font color="#000099">var</font></b> div <font color="#0033FF">=</font> <font color="#990066">document</font> .getElementById <font color="#000099"><b>(</b></font> divId <font color="#000099"><b>)</b></font> ; <br> <b><font color="#000066">var</font></b> button <font color="#0033FF">=</font> <font color="#990066">document</font> .getElementById <font color="#000099"><b>(</b></font> butId <font color="#000099"><b>)</b></font> ; <br> <b><font color="#000066">var</font></b> move <font color="#0033FF">=</font> <font color="#000099"><b>true</b></font> ; <br> <b><font color="#000066">var</font></b> divX <font color="#0033FF">=</font> <font color="#009999">parseInt</font> <b><font color="#000099">(</font></b> div.style.left <font color="#000099"><b>)</b></font> <font color="#0033FF">+</font> <font color="#009999">Math</font> . <font color="#009999">round</font> <b><font color="#000099">(</font></b> div.offsetWidth <font color="#0033FF">/</font> <font color="#FF0000">2</font> <font color="#000099"><b>)</b></font> ; <br> <b><font color="#000066">var</font></b> divY <font color="#0033FF">=</font> <font color="#009999">parseInt</font> <b><font color="#000099">(</font></b> div.style.top <font color="#000099"><b>)</b></font> <font color="#0033FF">+</font> <font color="#009999">Math</font> . <font color="#009999">round</font> <b><font color="#000099">(</font></b> div.offsetHeight <font color="#0033FF">/</font> <font color="#FF0000">2</font> <font color="#000099"><b>)</b></font> ; <br> <b><font color="#000099">if (</font></b> divX <font color="#0033FF">&lt;</font> button.offsetLeft <font color="#0033FF">||</font> divX <font color="#0033FF">&gt;</font> <font color="#000099"><b>(</b></font> button.offsetLeft <font color="#0033FF">+</font> button.offsetWidth <font color="#000099"><b>)) {</b></font> <br> move <font color="#0033FF">=</font> <font color="#000099"><b>false</b></font> ; <br> <b><font color="#000099">}</font></b> <br> <b><font color="#000099">if (</font></b> divY <font color="#0033FF">&lt;</font> button.offsetTop <font color="#0033FF">||</font> divY <font color="#0033FF">&gt;</font> <font color="#000099"><b>(</b></font> button.offsetTop <font color="#0033FF">+</font> button.offsetHeight <font color="#000099"><b>)){</b></font> <br> move <font color="#0033FF">=</font> <b><font color="#000099">false</font></b> ; <br> } <br> <font color="#000099"><b>if (</b></font> move <font color="#000099"><b>){</b></font> <br> div.style.left <font color="#0033FF">=</font> <font color="#000099"><b>(</b></font> mouseX <font color="#000099"><b>(</b></font> e <font color="#000099"><b>)</b></font> <font color="#0033FF">-</font> div.offsetWidth <font color="#0033FF">/</font> <font color="#FF0000">2</font> <font color="#000099"><b>)</b></font> <font color="#0033FF">+ "px"</font> ; <br> div.style.top <font color="#0033FF">=</font> <font color="#000099"><b>(</b></font> mouseY <font color="#000099"><b>(</b></font> e <font color="#000099"><b>)</b></font> <font color="#0033FF">-</font> div.offsetHeight <font color="#0033FF">/</font> <font color="#FF0000">2</font> <font color="#000099"><b>)</b></font> <font color="#0033FF">+ "px"</font> ; <br> <b><font color="#000099">} else {</font></b> <br> div.style.visibility <font color="#0033FF">= "hidden"</font> ; <br> <b><font color="#000099">} <br> }</font></b></code> <br>  Function result (fileId, divResultId), where fileId is the id of the file element, divResultId is the layer id where the name of the selected file will be displayed.  The function passes only the file name to the innerHTML layer (for example, ‚Äúall my passwords.txt‚Äù), and in the title attribute it places the full path, in my opinion, this is more convenient. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code><b>function</b> result <font color="#000099"><b>(</b></font> fileId, divResultId <font color="#000099"><b>){</b></font> <br> <font color="#000099"><b>var</b></font> divResult <font color="#0033FF">=</font> <font color="#990066">document</font> .getElementById <font color="#000099"><b>(</b></font> divResultId <font color="#000099"><b>)</b></font> ; <br> <font color="#000099"><b>var</b></font> formFile <font color="#0033FF">=</font> <font color="#990066">document</font> .getElementById <font color="#000099"><b>(</b></font> fileId <font color="#000099"><b>)</b></font> ; <br> divResult.innerHTML <font color="#0033FF">=</font> formFile.value. <font color="#009999">replace</font> <font color="#000099"><b>(</b></font> <font color="#006633">/^([^\\\/]*(\\|\/))*/</font> ,"" <font color="#000099"><b>)</b></font> ; <br> divResult.setAttribute <font color="#000099"><b>(</b></font> "title",formFile.value <font color="#000099"><b>)</b></font> ; <br> <font color="#000099"><b>}</b></font></code> <br>  And lastly, two functions (mouseX (e), mouseY (e), where e is event) that determine the location of the cursor on the page for IE and other browsers, they differ only in two letters, so I‚Äôll give one of them. <br> <code><b>function</b> mouseX <font color="#000099"><b>(</b></font> e <font color="#000099"><b>){</b></font> <br> <font color="#000099"><b>if (</b></font> e.pageX <font color="#000099"><b>)</b></font> <font color="#000099"><b>return</b></font> e.pageX; <br> <font color="#000099"><b>if (</b></font> e.clientX <font color="#000099"><b>)</b></font> <font color="#000099"><b>return</b></font> e.clientX <font color="#0033FF">+</font> <font color="#990066">document</font> . <font color="#990066">body</font> .scrollLeft; <br> <font color="#000099"><b>}</b></font></code> <br> <h3>  Note </h3><br>  Since the layer with the file element overlaps the button, the event is not passed to it: hover, so if you need to simulate mouse pointing, you will have to add the corresponding functionality yourself either by changing the button class or changing the image. <br>  <a href="http://www.box.net/shared/15yynriuum">Working example</a> , if someone wants to help the right case, place an example for your online presentation, I guarantee the link and thanks to this article. <br>  Tested in browsers Firefox 2, Opera 9, IE 6. <br>  Thanks for attention. <br><br>  <strong>PS</strong> Report bugs in advance without departing from the checkout;) </div><p>Source: <a href="https://habr.com/ru/post/13704/">https://habr.com/ru/post/13704/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../137033/index.html">Transfer to an electronic type of medical record</a></li>
<li><a href="../137034/index.html">Do you use LuCI when setting up your OpenWRT router?</a></li>
<li><a href="../137037/index.html">[archlinux testing news] KDE 4.8 appeared in testing</a></li>
<li><a href="../137038/index.html">SqlBulkCopy - reloading big data without a crash or how to ride a wild horse (C #)</a></li>
<li><a href="../137039/index.html">Without knowing the ford, do not go into the water. Part one</a></li>
<li><a href="../137040/index.html">LTE in Moscow in March 2012</a></li>
<li><a href="../137041/index.html">Man without e-mail</a></li>
<li><a href="../137042/index.html">New Google Privacy Policy</a></li>
<li><a href="../137043/index.html">Web Studio - business "for the soul." There are easier ways to make money online!</a></li>
<li><a href="../137047/index.html">Harmattan 1.2 PR2 for Nokia N950 has been released</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>