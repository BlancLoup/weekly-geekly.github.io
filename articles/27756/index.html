<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Form Spam Bot Blocker: Protecting Web Forms Without CAPTCHA!</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="- You so protected your form that you yourself can not always make out what CAPTCHA drew? 
- You have established a good captcha and you still read th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Form Spam Bot Blocker: Protecting Web Forms Without CAPTCHA!</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/25b/90b/8b4/25b90b8b47cdd5ea8018121556a18cb8.jpg" align="right" hspace="5"><br><br><ul><li>  You so protected your form that you yourself can not always make out what CAPTCHA drew? </li><li>  You have established a good captcha and you still read the news from time to time in your feedback. <br>  about extenders of some organs, cheap viagra, etc.? </li></ul><br><br>  Well then, I propose to look at the problem of protecting Web forms from a different angle. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  I assume that you already know what <a href="http://www.captcha.ru/">CAPTCHA is</a> , perhaps many of you use this technology in your projects. <br><br><br>  Recently I downloaded a file from rapidshare.com, there you need to specify the letters on which the cat is attached. <br><img src="https://habrastorage.org/getpro/habr/post_images/113/965/e92/113965e92762e7873c34a8548c8f3d22.jpg"><br>  <i>(The correct answer is ' <b>X6VK</b> ')</i> . <br><br><br>  So, neither from the first nor the second time did I ‚Äúrecognize‚Äù the captcha.  Is there really no other way to identify the real user?  Probably, it is, but after all rapidshare fights not with bots but with hackers who purposefully ‚Äúpunch‚Äù RapidShare. <br><br><br>  So, in my article it will be about bots, i.e.  systems for automatic search for Web-forms for their auto-submit, since  I'm sure that with a targeted attack, you can add <u>any form</u> , in which case the developer‚Äôs actions should be aimed at maximizing the cost of one submission. <br><br><br>  I am against drawing in users of the site into this ‚Äúwar‚Äù, because in the case of RapidShare I became a hostage of the ‚Äúwar of robots‚Äù of what ‚Äúprotects‚Äù and what ‚Äúbreaks through‚Äù. <br><br><br><h2>  The myth of the "impenetrability" CAPTCHA </h2><br>  <a href="http://www.securitylab.ru/contest/239642.php">Hacking problems CAPTCHA is</a> well described by <b>Vladislav Thought</b> .  I advise skeptics to read this topic.  Below I will briefly list the main accents of the article. <br><br><br>  It makes no sense to dwell on software vulnerabilities when implementing CAPTCHA, when a developer forgets that <br><br><br><blockquote><ul><li>  the duration of the session should be limited </li><li>  after receiving the form, the session should be immediately removed </li><li>  you need to check the data for empty values </li></ul><br></blockquote><br><br>  The main way to get around CAPTCHA is to recognize it.  To date, there are already many projects dedicated exclusively to CAPTCHA recognition.  The most famous of them are two: ‚ÄúUC Berkeley Computer Vision Group‚Äù and ‚Äú <a href="http://libcaca.zoy.org/wiki/PWNtcha">PWNtcha</a> ‚Äù.  The degree of successful recognition in both projects is quite high (the <a href="http://www.cs.sfu.ca/~mori/research/gimpy/ez/">list of CAPTCHA, which is already learned to recognize</a> ). <br><br><br>  For a very complex CAPTCHA, SPAMs practice using human resources.  In the recognition process, free porn lovers who are offered to respond to the CAPTCHA test are used to view the next photo or video.  The test itself is selected from the form of the server on which the SPAM-attack is made, the user's response, respectively, is inserted into the same form.  The scheme is very simple in technical implementation, in addition, there are enough porn lovers too :). <br><br><br><h2>  What can "catch" Spam Bot </h2><br>  A year ago, digging into <a href="http://phpclasses.org/">phpclasses.org</a> , I came across a rather original PHP solution called <b><a href="http://www.phpclasses.org/browse/package/3817.html">Form Spam Bot Blocker</a></b> .  The developer of this php-class went the other way, his approach does not require any additional user input. <br><br><br>  This technique is based on how the user behaves, and not on what he enters.  The class creates /&gt; tags with encrypted values ‚Äã‚Äãor visually hides the fields (by means of CSS) that the SPAM bot sees.  The combination of several methods can really confuse a SPAM bot, even if it has just read the html code.  It should be noted that no <b>Capthca</b> , <b>Session</b> , <b>Cookie</b> or <b>Javascript-</b> based methods are used here.  Only pure (x) html and small CCS inserts. <br><br><br>  Basic ideas: <br><br><br><ol><li>  The user (human or robot) must have the same IP and the same http user agent ID as on the page with the HTML form and on the page-handler using the POST or GET method.  The user always first visits the page with the HTML form, then the handler goes to the page, the robots do not always do this, as they often only access the landing page with the required parameters.  In other words: the page containing the html form must be loaded before passing the parameters of the target page (the page that takes the parameters. IP and the consumer browser must be the same on both pages. <br>  <i><b>Spambot is forced to use the same IP and agent ID, scanning and attacking</b></i> <br><br></li><li>  The user will not be affected by hidden tags whose names change daily. <br>  In fact, they could affect the user, for example, if he zashol on a page with a 23.57 form and sent a request at 0.06 (the next day), but there is a simple solution to this problem.  Another handwork for the robot is to use the prescan (preliminary scan) html of the page containing the form and send a request with the scanned parameters.  A daily change of hidden parameter names will require the robot to produce hstml pages before an attack. <br>  <i><b>Spambot is forced to pre-scan the form on the day of the attack.</b></i> <br><br></li><li>  The form must be zababmitit within a certain time period.  If the time from loading the form to submission is too short or too long, then we are most likely dealing with a robot.  For example, a user cannot fill in 6 fields in less than 2 seconds ... <br>  <i><b>Spambot is forced to zababmitit form within a certain time period,</b></i> <i><b><br></b></i>  <i><b>scanning and attacking</b></i> <br><br></li><li>  Spambot will try to fill each form element with some value. <br>  This is best guaranteed successful submit.  If the standard input tag is placed in a form and visually hidden from the user by means of CSS, the user will not enter anything in this field.  But it is very likely that the spambot will not ‚Äúsee through‚Äù and will fill this field. <br>  <i><b>Spambot is forced to identify the elements of visually hidden forms of traps and neglect them when attacking</b></i> <br><br></li></ol><br><br><h2>  Experience using Form Spam Bot Blocker </h2><br><br>  A few weeks ago I put this class on a fairly attended and loaded project in my organization.  On the day, more than 1500-1700 ‚Äúfailed‚Äù attempts to register a form with a bot are registered.  With the number of legal submit about 1200-1400.  So far, the percentage of spam is quite low (most likely not from bots but from ‚Äúthemed‚Äù spammers), which partially automate their work with the help of browser plug-ins. <br><br><br>  Perhaps, over time, this defense will be ‚Äúpunched‚Äù by many bots.  But I liked the approach, it can be modified, deliver more traps. <br><br><br>  In very responsible forms, it can be combined with CAPTCHA.  It does not interfere. <br><br><br><h2>  How to use this class </h2><br><ol><li>  Create the necessary tags on the page containing the form <br><ol><li>  Optionally set the default values ‚Äã‚Äãin the source code of the class (public variables) </li><li>  Include class in your script </li><li>  Create an object: <b>$ blocker = new formSpamBotBlocker ();</b> </li><li>  Optionally, run public methods or set public variables to adapt the default variables to your web form. </li><li>  You will output in the lice html-form: <b>print $ blocker-&gt; makeTags ();</b> </li></ol><br><br>  Check the <b>$ _POST</b> or <b>$ _GET</b> arrays to see if they contain <br>  valid parameters from the html form <br><pre> if ($ _POST) {// or $ _GET
	 $ blocker = new formSpamBotBlocker ();
	 $ nospam = false;
	 $ nospam = $ blocker-&gt; checkTags ($ _ POST);  // or $ _GET
		 if ($ nospam) print "Successful sabmit";  // handle valid request
		 else print "There is a suspicion that this is a SPAM bot";  // handle invalid request
 } 
</pre><br><br></li></ol></div><p>Source: <a href="https://habr.com/ru/post/27756/">https://habr.com/ru/post/27756/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277541/index.html">Another approximation by polynomial of a function of several variables</a></li>
<li><a href="../277543/index.html">Clean code architecture and development through testing in PHP</a></li>
<li><a href="../277545/index.html">Game design f2p games or how not to make mistakes</a></li>
<li><a href="../27755/index.html">Last.fm API</a></li>
<li><a href="../277559/index.html">How Relap.io is organized - a service that issues 30 billion recommendations per month</a></li>
<li><a href="../277563/index.html">Word2Vec: classification of text documents</a></li>
<li><a href="../277565/index.html">Framer Animation for Beginners</a></li>
<li><a href="../277567/index.html">Windows 10 application with data in the cloud using Azure Mobile Apps</a></li>
<li><a href="../277569/index.html">Battle for sound speed on Android x86</a></li>
<li><a href="../277571/index.html">Security Week 07: Apple vs. FBI, global glibc vulnerability, crypto-fiber and medicine</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>