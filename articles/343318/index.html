<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to describe layout in code</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What do we have? 


 A UI can be defined as a set of views that display data, react to events, and are located in a certain way on the screen. 


 How...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to describe layout in code</h1><div class="post__text post__text-html js-mediator-article"><h1 id="what-do-we-have">  What do we have? </h1><br><p>  A UI can be defined as a set of views that display data, react to events, and are located in a certain way on the screen. </p><br><p>  How do we place items on the screen? </p><br><ul><li>  Qt proposes to use containers that can position elements within themselves in a certain way.  By putting these containers into each other, you can get the necessary arrangement. </li><li>  WPF / XAML offers similar containers. </li><li>  Android offers similar containers + system konstraintov. </li><li>  iOS offers Autolayout.  It is necessary to describe a set of constraints (equations) that consistently and unambiguously describe the location of elements.  Having solved the system of equations with these constraints, the engine will get the coordinates and dimensions of the elements. </li><li>  Delphi has anchors: nailing edges to a container.  Very similar to resizing masks in iOS. </li><li>  In the web, as far as I understand, inserting containers into each other, whose behavior is described by styles. </li></ul><br><h1 id="what-is-the-problem-with-this">  What is the problem with this? </h1><br><p>  <em>We need to use code for special cases.</em> </p><br><p>  The described tools are sharpened for typical cases, often we cannot (or can, but it is very inconvenient) to describe the location of an element with the help of these tools.  You have to do it in code.  The logic of the layout description is spread over several places. <br>  There must be a better way. </p><a name="habracut"></a><br><h1 id="layout---what-is-it-really">  Layout - what is it really? </h1><br><p>  <em>Layout is a function</em> </p><br><p>  What is layout?  This is a description of the location of the elements.  It can be expressed as a function. <br>  The input function receives the size of the container and an array of elements, the output gives the coordinates of these elements. <br>  Theoretically, the layout can be any - here as a designer draws.  Therefore, to describe such a function, we need a turing-complete language.  UI frameworks offer us anything, just not turing-full language, hence the problems.  It would be logical to take the language in which the rest of the program is written: for iOS, objc / swift, for android, java / kotlin, etc. </p><br><h1 id="what-does-it-mean">  What does it mean? </h1><br><p>  <em>We can easily describe the layout in code</em> </p><br><p>  We can easily describe layout in code!  It is enough to write one function.  Often we will have elements relative to the existing ones (to the right, below, etc.).  You can hide such calculations in a function with readable names.  Under iOS, this is done in the <a href="https://github.com/mamaral/Facade">Facade (objc)</a> , <a href="https://github.com/mamaral/Neon">Neon (swift)</a> libraries.  You can easily write your own in any language. </p><br><h1 id="example-libraries">  Example libraries </h1><br><p> In iOS, if you want to define a custom layout for a view, you need to override the <code>layoutSubviews()</code> method (or the <code>viewDidLayoutSubviews()</code> ) and set the frame to its children.  This method is called when changing the size of the view, that is, turns, Split View and so on. This method will be generated. </p><br><p>  Here is an example from the official Neon page: </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> isLandscape : Bool = UIDevice.currentDevice().orientation.isLandscape.boolValue <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bannerHeight : CGFloat = view.height() * <span class="hljs-number"><span class="hljs-number">0.43</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> avatarHeightMultipler : CGFloat = isLandscape ? <span class="hljs-number"><span class="hljs-number">0.75</span></span> : <span class="hljs-number"><span class="hljs-number">0.43</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> avatarSize = bannerHeight * avatarHeightMultipler searchBar.fillSuperview() bannerImageView.anchorAndFillEdge(.Top, xPad: <span class="hljs-number"><span class="hljs-number">0</span></span>, yPad: <span class="hljs-number"><span class="hljs-number">0</span></span>, otherSize: bannerHeight) bannerMaskView.fillSuperview() avatarImageView.anchorInCorner(.BottomLeft, xPad: <span class="hljs-number"><span class="hljs-number">15</span></span>, yPad: <span class="hljs-number"><span class="hljs-number">15</span></span>, width: avatarSize, height: avatarSize) nameLabel.alignAndFillWidth(align: .ToTheRightCentered, relativeTo: avatarImageView, padding: <span class="hljs-number"><span class="hljs-number">15</span></span>, height: <span class="hljs-number"><span class="hljs-number">120</span></span>) cameraButton.anchorInCorner(.BottomRight, xPad: <span class="hljs-number"><span class="hljs-number">10</span></span>, yPad: <span class="hljs-number"><span class="hljs-number">7</span></span>, width: <span class="hljs-number"><span class="hljs-number">28</span></span>, height: <span class="hljs-number"><span class="hljs-number">28</span></span>) buttonContainerView.alignAndFillWidth(align: .UnderCentered, relativeTo: bannerImageView, padding: <span class="hljs-number"><span class="hljs-number">0</span></span>, height: <span class="hljs-number"><span class="hljs-number">62</span></span>) buttonContainerView.groupAndFill(<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>: .Horizontal, views: [postButton, updateInfoButton, activityLogButton, moreButton], padding: <span class="hljs-number"><span class="hljs-number">10</span></span>) buttonContainerView2.alignAndFillWidth(align: .UnderCentered, relativeTo: buttonContainerView, padding: <span class="hljs-number"><span class="hljs-number">0</span></span>, height: <span class="hljs-number"><span class="hljs-number">128</span></span>) buttonContainerView2.groupAndFill(<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>: .Horizontal, views: [aboutView, photosView, friendsView], padding: <span class="hljs-number"><span class="hljs-number">10</span></span>)</code> </pre> <br><p><img src="https://habrastorage.org/getpro/habr/post_images/b51/84c/0d3/b5184c0d3c0202063155f24a9b5b5a20.png" alt="portrait"><br><img src="https://habrastorage.org/getpro/habr/post_images/f92/c6c/4a8/f92c6c4a83ef682eb3521f9e4b113f11.png" alt="landscape"></p><br><p>  Not bad for 10 lines of code, right? </p><br><h1 id="pros">  Pros </h1><br><ul><li>  Computing frames is very fast.  If you believe <a href="https://github.com/lucdion/LayoutFrameworkBenchmark">LayoutFrameworkBenchmark</a> manual calculation of frames is 10-15 times faster than Autolayout. </li><li>  Layout code in one place - easier to maintain. </li><li>  Easy debugging. </li><li>  Full control, you can describe any layout. </li><li>  Writing a UI in code naturally leads to decomposition and re-use of the view. </li><li>  Writing a UI in code simplifies the use of shared resources (fonts, colors, etc.) </li></ul><br><h1 id="cons">  Cons </h1><br><p>  Often, the UI is declared declaratively in the form of markup (xml, xaml, xib), which then turns into code (Qt, Delphi, C # WinForms) or from which a ready-made object graph (xib, xaml) is created.  In this case, IDE provide a means of preview, which is very convenient. <br>  Describing the layout in code, we discard the preview tools. </p><br><p>  Usually the layout goes from top to bottom: we have the screen size, knowing this size we will lay out the first layer of the views, getting their dimensions go deeper and so on.  Sometimes you need to go the other way: stretch the container to the size of the contents.  Describing this is not always convenient. </p><br><h1 id="what-about-rtl-split-view-iphone-x-">  What about RTL, Split View, iPhone X? </h1><br><ul><li>  RTL - can be processed manually;  there are also ready-made workouts: for Neon, there is a <a href="https://github.com/mamaral/Neon/pull/56">PR</a> for using leading trailing like in Autolayout. </li><li>  Split View - you can catch the change in trait collection and call different layout functions for each size class. </li><li>  iPhone X - safeAreaGuide is available inside the view, you can take into account the appropriate indents. </li></ul><br><h1 id="conclusion">  Conclusion </h1><br><p>  In my opinion, this is a good approach if you are already writing UI in code.  The code is about the same as when using Autolayout, but it works faster and more predictable. <br>  The main disadvantage is that visibility in the form of preview tools is lost. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/343318/">https://habr.com/ru/post/343318/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../343308/index.html">Quantum versus classical: why do we need so many digits</a></li>
<li><a href="../343310/index.html">Regular expressions for the smallest</a></li>
<li><a href="../343312/index.html">Setting up an environment for web development in Windows based on VMware Player virtual machine</a></li>
<li><a href="../343314/index.html">Atomic icebreaker Lenin - almost like a spaceship, only an icebreaker</a></li>
<li><a href="../343316/index.html">What is hidden behind the term modeling</a></li>
<li><a href="../343320/index.html">"Without further ado": the shortest scientific articles</a></li>
<li><a href="../343322/index.html">Five things that online shoppers should know about in the summer</a></li>
<li><a href="../343324/index.html">Is it difficult to develop software?</a></li>
<li><a href="../343326/index.html">LizardFS - a brief overview of the cluster file system</a></li>
<li><a href="../343328/index.html">DDoS bypassing the Curator: simple steps for a quiet life</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>