<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Computer control via SMS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I want to bring to your attention a program that I wrote for the sake of experiment. The program is a system service that works with a GSM modem, is a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Computer control via SMS</h1><div class="post__text post__text-html js-mediator-article">  I want to bring to your attention a program that I wrote for the sake of experiment.  The program is a system service that works with a GSM modem, is able to receive and send SMS messages.  Depending on the text of the incoming message, calls the specified scripts and sends the response. <br>  It may be useful, for example, to manage a server to which access is restricted (located on the company's internal network).  Do not judge strictly, because  rather, it is a prototype, the first version. <br><br><a name="habracut"></a><br>  Download the program <a href="">here</a> . <br><br>  The program's archive contains several files: the program itself (SMSRC.exe), the installation file (options.ini), examples of ready-made scripts (the scripts folder). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Iron</b> <br>  It should work with any GSM modem or cell phone that can be connected in GSM modem mode.  To determine the port number on which the modem ‚Äúhangs‚Äù, you need to go to the control panel, open the <b>Phone and modem</b> panel on the Modems tab in the <b>Connected to</b> column <b>to</b> view the port number. <br><br>  <b>Setup and Startup</b> <br>  Before starting, you need to change the settings file (specify the port, at least register your numbers), make sure that no other programs running on the GSM modem are running on the computer. <br><br>  To install the program as a service, you must run it with the <b>-install</b> key.  To uninstall from <b>-uninstall</b> services.  To start without adding to system services <b>-debug</b> (it will not create windows at startup, for stopping you will have to kill through the process list). <br><br>  The settings file is an ini file in which parameters for connecting to the device and message processing scripts are set. <br><br>  <font color="#0000ff">[Settings]</font> <br>  <font color="#008000">;</font>  <font color="#008000">Port number on which the modem hangs</font> <br>  port = com8 <br>  rate = 115200 <br>  <font color="#008000">;</font>  <font color="#008000">Check interval in milliseconds</font> <br>  timeout = 5000 <br><br>  The following are scripts.  Consider one of these for example. <br><br>  <font color="#008000">;</font>  <font color="#008000">In brackets the text of the incoming message</font> <br>  <font color="#0000ff">[123]</font> <br>  <font color="#008000">;</font>  <font color="#008000">Script path</font> <br>  script = scripts \ cpuLoad.vbs <br>  <font color="#008000">;</font>  <font color="#008000">Send reply.</font>  <font color="#008000">If the key is missing,</font> <br>  <font color="#008000">;</font>  <font color="#008000">or its value is not equal to the unit, the answer will not be sent</font> <br>  reply = 1 <br>  <font color="#008000">;</font>  <font color="#008000">The number to which the response should be sent</font> <br>  replyTo = 7917XXXXXXX <br>  <font color="#008000">;</font>  <font color="#008000">Action allowed if the request came from one of the specified numbers</font> <br>  allowedTo = 7917XXXXXXX, 7902YYYYYYY <br><br>  If from the number 7917XXXXXXX or 7902YYYYYYY you receive a message with the text 123, the script cpuLoad.vbs will be executed and the answer will be sent to the number 7917XXXXXXXX <br><br>  The cpuLoad.vbs script contains: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">On</font> <font color="#0000ff">Error</font> <font color="#0000ff">Resume</font> <font color="#0000ff">Next</font> <br> <br> <font color="#0000ff">Dim</font> strComputer : strComputer = <font color="#A31515">"."</font> <br> <font color="#0000ff">Dim</font> strResponse <br> <br> <font color="#0000ff">Set</font> objWMIService = GetObject( <font color="#A31515">"winmgmts:\\"</font> &amp; strComputer &amp; <font color="#A31515">"\root\CIMV2"</font> ) <br> <br> <font color="#0000ff">Set</font> colItems = objWMIService.ExecQuery( <font color="#A31515">"SELECT * FROM Win32_Processor"</font> ,,48) <br> <br> <font color="#0000ff">For</font> <font color="#0000ff">Each</font> objItem <font color="#0000ff">in</font> colItems <br> strResponse = strResponse &amp; <font color="#A31515">"CPU load: "</font> &amp; objItem.LoadPercentage &amp; <font color="#A31515">"%"</font> &amp; vbCrLf <br> <font color="#0000ff">Next</font> <br> <br> Wscript.Echo strResponse</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  The script, through WMI, receives information about the installed processors, for each of them determines the current load and returns the result via Wscript.Echo.  This text will be sent by SMS. <br><br>  <u>Attention!</u>  <u>Do not use the MsgBox script, when executing such a script, the program will wait for the script to complete, and the script, in turn, will close the message window.</u> <br><br>  As an example, the archive also contains a script for determining the IP address of a connection to a local network and opening an mp3 file. <br><br>  After launching, a debug.log file will be created in the program directory, which, in case of nonoperability, will be able to tell where to look for the cause. <br><br>  For myself, I could not find a practical application of this program, since  do not administer. <br>  In the process of development I used only fun for the sake of (send a message to turn on the music, while puzzling the spouse, who at that time is sitting at the computer). <br><br>  I would be glad if the program will be useful to anyone. <br><br>  <b>UPD</b> <br><br>  A set of classes for receiving, sending SMS messages and an example of using source code in C ++ is <a href="">here.</a> The idea is to work under any version of Windows. <br><br>  <b>UPD2</b> Added <b>-send</b> key for sending SMS from the command line.  Example: <br><br>  SMSRC.exe -send XXXXXXXXXXX "from cmd line!" <br><br>  Where XXXXXXXXXXX is the number to which the SMS should be sent. <br><br>  At the moment, the program is working in the "pipe or jug" mode, i.e.  it is impossible to start the program as a service and at the same time use it to send SMS from the command line.  The first copy will open the COM port to which the modem is connected, and no one else will get access to the modem anymore.  At the moment I am deciding how to allow one port to be used for several instances.  How to decide - post update. </div><p>Source: <a href="https://habr.com/ru/post/68989/">https://habr.com/ru/post/68989/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../68984/index.html">Puls - a revolution in 256 byte intro</a></li>
<li><a href="../68985/index.html">Little assistant for the management of their working time</a></li>
<li><a href="../68986/index.html">The story of one invite</a></li>
<li><a href="../68987/index.html">The best age for starting a startup is 40 years</a></li>
<li><a href="../68988/index.html">Men, do you really want to know?</a></li>
<li><a href="../68990/index.html">Search@Mail.Ru: search preferences ratings</a></li>
<li><a href="../68992/index.html">Hacker help for broken hearts</a></li>
<li><a href="../68995/index.html">Part 1/3. Ideal VM compiler for ICFPC 2009, on Haskell, with popularizing comments</a></li>
<li><a href="../68998/index.html">We leave in DOS, in normal, pure DOS</a></li>
<li><a href="../69000/index.html">Patterns and methods of their destruction</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>