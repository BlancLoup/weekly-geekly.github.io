<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Storing the code in the database or collect the code brick by brick</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is written by Napolsky . For a known reason, he could not publish it. If you liked the article - encourage the author in a known manner. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Storing the code in the database or collect the code brick by brick</h1><div class="post__text post__text-html js-mediator-article"><h6>  This article is written by <a href="https://habrahabr.ru/users/napolsky/" class="user_link">Napolsky</a> .  For a known reason, he could not publish it.  If you liked the article - encourage the author in a known manner. </h6><br>  In this topic, I will talk about one approach I developed in web programming, the heart of which is storing code in a database.  A few notes on the following text: <br><ul><li>  Under the phrase "page code" means the executable (php) code </li><li>  In all matters relating to performance, there is a net page generation time, without the use of accelerators, caching systems, and so on. </li></ul><br><h3>  How it all began </h3><br>  In order to understand, and ‚Äúwhy it is actually necessary,‚Äù we will quickly go through the path that led me to the storage of the code in the database.  It so happened that I started my way in web programming not by writing any scripts or modules for existing systems, but immediately by writing my own website engine from absolute zero.  At this point, I had two years of programming experience in C ++ and, of course, tried to build my own web engine on OOP (though at that time PHP had one name from PHP :)).  Within reason, I really love my ‚Äúbikes‚Äù.  Especially big ones.  And before using a ready-made solution, I always ask myself: ‚ÄúIs it possible to write better?‚Äù. <br><a name="habracut"></a><br><br>  <font color="#888">In general, the writing of their bikes is very useful, especially for novice developers (when the first place is to raise professionalism, and not to write code in the allotted time and budget).</font>  <font color="#888">Only writing your own solutions gives an understanding of how something is arranged from the inside at the lowest level.</font>  <font color="#888">And this in turn gives an understanding of the complexity, resource intensity, speed of various approaches, which ultimately results in the choice of the right tools for solving the problem.</font>  <font color="#888">For example, at the university we were forced to write our pushbacks for arrays, so that we would not forget that something much larger could seem to be hidden behind simple and trivial things.</font> <br><br>  The result was an engine built according to a rather classical scheme: folders with classes, modules, templates, and so on.  Well, respectively, the endless inclusions of all this when generating pages.  And since the rationalizer lives in me, as in many programmers, I was worried about the costs of this approach.  In particular, most of all I didn‚Äôt like the fact that I <strong>had to plug in a lot of ‚Äúunnecessary‚Äù code</strong> (‚Äúdead‚Äù code that will not be executed on the page) for pages (for example, the entire library, when this page only needs one function her). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <font color="#888">Have you thought about the number of "dead" code on the page?</font>  <font color="#888">In fact, its amount is usually 7-15 times the amount of code that will actually be executed when the page is accessed.</font>  <font color="#888">Take for example a class of comments.</font>  <font color="#888">It will have the render (), delete (), edit (), add (), compress (), answer (), and so on methods. At the same time, only 1 of these methods will usually be called for 1 script execution (delete delete, edit - when editing and t d), and the rest will not be called.</font>  <font color="#888">So consider how many such extra code runs on the page.</font> <br><br>  At first, I tried to optimize, ‚Äúcutting‚Äù and ‚Äúgluing together‚Äù large libraries or classes to the needs of different pages, thus reducing the number of inclusions and dead code.  But this, of course, is a dead end road.  Time went by.  Projects written on this engine (the kingdom of heaven :) they became more and more.  Along with this, the number and size of the connected code grew, and with it the time of page generation.  I began to think more and more about how to get rid of the "dead" code.  And then I was visited by a bold, even crazy thought.  What if‚Ä¶ <br><br><h3>  The birth of an idea </h3><br>  <strong>But what if you divide the code into as small independent parts as possible so that you can only collect what you really need on the page?</strong>  That is, to separate all functions, classes (ideally, and methods of classes), and so on.  Thus, we will get many many small "bricks", from which we will later fold the page.  Thus, it will be possible to <strong>completely get rid of the "dead" code and inclusions</strong> .  I was really excited by this idea, but there were more questions than answers: how to do it, would it work, what pitfalls await in implementation, how fast is such a system?  In short, so far I have not had any idea how to implement it and how it will work.  But try, of course, worth it. <br><br><h3>  Warrior's way </h3><br>  The ideology is that by breaking everything into as small pieces of code as possible, we can collect anything from them. There was no question of how to store code ‚Äúbricks‚Äù - since they were not code, but were essentially data with a set attributes, the only possible option was to use db.  I will try to show the principle of operation of such a system as simply and abstractly as possible, only by conveying the essence. <br><br><h6>  1 Storing bricks </h6><br>  Everything is simple and clear: each individual function, a class (and even a class method is better), a module controller, a module presentation, and so on are a separate line in the database.  For example, in the simplest case, the table can be of the form <strong>id | code | name | componentType</strong> (where <strong>componentType</strong> is a type of brick (function, class, module ..)) <br><br><h6>  2 Storage dependencies </h6><br>  Since the code of one brick can cause another brick (for example, function-function type, module-function dependencies, or even page-module dependencies), you need to store replications.  This can be done using the replication table, which, in the simplest case, has the form <strong>id | parentId | childId</strong> .  Thus, we solve the problem of proper collection of ‚Äúbricks‚Äù for nested structures: <br><br><blockquote><code>function A()<br>
{<br>
 B();<br>
}<br>
</code><br>
</blockquote><br>
<br>
       ,  <strong></strong> ¬´¬ª  <strong>B</strong>.    <strong></strong>    <strong>B</strong>.<br>
<h6>3   </h6><br>
,     ,       ?  ,  ,   ,          ¬´¬ª   .    Codegen.      ,         ¬´¬ª.        :             .    ¬´¬ª .   : <strong>     1 ,       </strong>.<br>
<br>
        .  ,    Codegen,         ,          ( eval  ).<br>
<br>
<h3> </h3><br>
       :<br>
<strong> ‚Äî     <br>
 ‚Äî  ¬´¬ª   <br>
</strong><br>
<br>
       :<br>
<ul>
<li>    12000-14000  1500-2000   </li>
<li>      16-22  0</li>
<li>     0.25-0.3  0.04-0.05  (~600%. ,      .     )</li>
</ul><br>
<br>
<h3>  </h3><br>
         .<br>
<br>
<strong></strong><br>
-<strong>   IDE</strong>. .     ,    /    (    ).    ,   <a href=""></a>.         .     ( ,  ..)       .  ,   ,   IDE   .<br>
<br>
-<strong> </strong>.    .  ,     -          eval,       . <br>
<br>
-<strong></strong>.    ,           .  ,    .<br>
<br>
  <a href="http://seniorbart.habrahabr.ru/blog/66204/"></a>     <a href="http://seniorbart.habrahabr.ru/blog/66204/"></a> <a href="http://seniorbart.habrahabr.ru/blog/66204/"></a>     :<br>
<br>
<blockquote>  ,         </blockquote><br>
 ,         ,        . ,    ‚Äî      .<br>
<blockquote>/backup/update</blockquote><br>
‚Ä¶    sql( )    ,       .<br>
<blockquote>,      </blockquote><br>
   .         .<br>
<blockquote>, ,  ,    ,     ¬´¬ª on site      </blockquote><br>
   (    )    .         .<br>
<br>
<strong></strong><br>
 ‚Äî <strong></strong>.      . ,       ¬´¬ª    ,    .<br>
 ‚Äî <strong>  </strong>.         ,        .<br>
 ‚Äî <strong>   </strong>.       ,          ,    .     ,     .<br>
 ‚Äî <strong>        </strong>.   ,       codegen,          . ,        .    :      - ,  <br>
<blockquote><code>if(!$user-&gt;isAdmin()) {ErrorLog(' '); return;}<br>
</code><br>
</blockquote><br>
      <br>
<blockquote><code>_CHECKADMIN<br>
</code><br>
</blockquote><br>
          .           .<br>
<br>
<h3></h3><br>
     ,         ,      .     ,    ,       . ,  ,    ,    :         .   -,      ¬´¬ª   .      ,      ,    .   ,     ,               CMS,   .<br>
<br>
P.S.   ,          .</div><p>Source: <a href="https://habr.com/ru/post/66309/">https://habr.com/ru/post/66309/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../66301/index.html">MaxXBot - IM-bot to everyone!</a></li>
<li><a href="../66305/index.html">Social commerce & social shopping</a></li>
<li><a href="../66306/index.html">What is your attitude towards MMORPG?</a></li>
<li><a href="../66307/index.html">Automation of work * nix system administrator</a></li>
<li><a href="../66308/index.html">Mug - meter</a></li>
<li><a href="../66310/index.html">Timbild SIMPALS: Rubilovo and Myasko)</a></li>
<li><a href="../66311/index.html">What materials about Java you are interested in in Russian?</a></li>
<li><a href="../66314/index.html">CARGADOR DE CELULAR - charge mobile phone with your left foot</a></li>
<li><a href="../66317/index.html">Amateur radio, hackers, amateurs and models of railways</a></li>
<li><a href="../66318/index.html">Boost is easy. Part 2. Boost.Date_time</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>