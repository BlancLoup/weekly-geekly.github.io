<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CTFzone write-ups - MISC it all up</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Friends, according to the tradition that has developed over the last month, we suggest you start a new week with a new raitap. In this post we will ex...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CTFzone write-ups - MISC it all up</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/b2f/f73/48a/b2ff7348a87641faa463c5d73d01cae8.png" alt="image"></p><br><p>  Friends, according to the tradition that has developed over the last month, we suggest you start a new week with a new raitap.  In this post we will examine in detail the tasks from the <strong>MISC</strong> direction, which includes all tasks that are not suitable for any other category.  There was a need for a special creative;) </p><br><p>  Vetka MISC found a response in the soul of our players - during the competition we received about 300 flags.  Note that of all tasks for 1000, the task from this category was the most popular - many were puzzled over it, but only a few people achieved success.  Therefore, we decided to skip tasks for 50 and 100 points and immediately move on to more complex and interesting tasks.  Go! </p><br><a name="habracut"></a><br><h4 id="misc_300-lithiumbeta">  MISC_300.  Lithium | Beta </h4><br><blockquote>  <em><strong>AURORA:</strong> Lieutenant Friend, seems to be this computer.</em>  <em>This calculator interface (nc).</em>  <em>It was a very lazy idea to complete the compiler Design course.</em>  <em>So he wrote a calculator in the easiest way using the simplest tools.</em>  <em>I know that it‚Äôs quite complicated, we haven't got much time!</em> </blockquote><p><br>  <strong>Decision:</strong> </p><br><p>  Run the program and see that this is a regular calculator. </p><br><p><img src="https://habrastorage.org/files/789/bc0/8df/789bc08df36f43068dcad10fd1edda64.png" alt="image"></p><br><p>  As follows from the legend, this program was written by a lazy developer.  Most likely, this indicates that instead of parsing mathematical expressions, use simple eval. </p><br><p>  As you can see in the screenshot, there is an error name output, but without the traces: </p><br><p><img src="https://habrastorage.org/files/81d/5e6/18d/81d5e618dd2940678f3653340237f607.png" alt="image"></p><br><p>  Judging by the errors, the result given to the type float is returned.  If the result cannot be given, then ValueError is raised.  If there is no such function, then NameError. </p><br><p>  Let's try to find out the list of available functions by brute force. </p><br><p><img src="https://habrastorage.org/files/84b/40c/1f9/84b40c1f966b4a9aa5cc20d92f055672.png" alt="image"></p><br><p>  However, all attempts to use underscore, for example, class, do not work because of HackingAttempt. <br>  But using ord and str, you can calculate any variable, for example, the result dir, which returns a list of all the available names in the environment. </p><br><p>  Brutter code: </p><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python2 import socket s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect(("95.85.41.197", 8888)) print s.recv(1024) result = '' for i in range(0, 300): request = "ord(str(dir())[%d])" % i # request = "ord(verysecretflag[%d])" % i s.send(request) response = s.recv(32) if 'Err' in response or 'occurred' in response: result += '_' else: result += chr(int(response.split(': ')[1].split('.')[0])) print result</span></span></code> </pre> <br><p>  The result of the search is the following list: </p><br><pre> <code class="bash hljs">[<span class="hljs-string"><span class="hljs-string">'HackingAttempt'</span></span>, <span class="hljs-string"><span class="hljs-string">'__builtins__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__cached__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__doc__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__file__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__loader__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__name__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__package__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__spec__'</span></span>, <span class="hljs-string"><span class="hljs-string">'e'</span></span>, <span class="hljs-string"><span class="hljs-string">'f'</span></span>, <span class="hljs-string"><span class="hljs-string">'inp'</span></span>, <span class="hljs-string"><span class="hljs-string">'print1337'</span></span>, <span class="hljs-string"><span class="hljs-string">'re'</span></span>, <span class="hljs-string"><span class="hljs-string">'regex'</span></span>, <span class="hljs-string"><span class="hljs-string">'sys'</span></span>, <span class="hljs-string"><span class="hljs-string">'verysecretflag'</span></span>]</code> </pre> <br><p>  The flag is in the verysecretflag variable.  Print, it is renamed print1337 <br>  To get the answer, you should do this: </p><br><p><img src="https://habrastorage.org/files/8a2/006/4e6/8a20064e6f9e4069bcab51aff697366d.png" alt="image"></p><br><p>  Here is our flag! </p><br><p>  <strong>Answer:</strong> <em>ctfzone {123456}</em> </p><br><h4 id="misc_500-archive-maniac">  MISC_500.  Archive maniac </h4><br><blockquote>  <em><strong>AURORA:</strong> Oh God!</em>  <em>Lieutenant, I need you here on the ship control station.</em>  <em>It is a rule.</em>  <em>It is a dead drunk.</em>  <em>I noticed that he was concerned about storage efficiency and confidentiality.</em>  <em>And he also preferred number 32 to 64 with no obvious reason.</em> </blockquote><p><br>  <strong>Decision:</strong> </p><br><p>  In this task, the participant is asked to find the secret code, but the difficulty lies in the fact that this key is encrypted.  Unfortunately, the person who has the information will not be able to say anything intelligible in the next day ... We know that he tried to ensure reliable storage and confidentiality, and for some reason also preferred the number 32 instead of 64. Let's try to figure it out. </p><br><p>  For a start, look at our source data.  The task itself provides a link to the arch.tar.gz archive, which contains the following files: </p><br><div class="spoiler">  <b class="spoiler_title">Archive files</b> <div class="spoiler_text"><pre> <code class="bash hljs">[briskly@archlinux tmp]$ tar -xvf arch.tar.gz archive/ archive/flag3.png archive/flag9.png archive/flag7.png archive/flag6.png archive/flag2.png archive/flag4.png archive/flag5.png archive/flag0.png archive/flag1.png archive/flag8.png archive/.gitkeep [briskly@archlinux tmp]$ file archive/* archive/flag0.png: cpio archive archive/flag1.png: bzip2 compressed data, block size = 900k archive/flag2.png: bzip2 compressed data, block size = 900k archive/flag3.png: compress<span class="hljs-string"><span class="hljs-string">'d data 16 bits archive/flag4.png: LRZIP compressed data - version 0.6 archive/flag5.png: rzip compressed data - version 2.1 (370344 bytes) archive/flag6.png: compress'</span></span>d data 16 bits archive/flag7.png: Zip archive data archive/flag8.png: ARJ archive data, v11, slash-switched, original name: , os: Unix archive/flag9.png: cpio archive</code> </pre> </div></div><br><p>  It looks like there are 10 files in the archive with the extension .png, but each file is an archive.  Judging by the file listing, the archives are very different.  It's time to learn to use exotic. </p><br><p>  Perhaps we start: </p><br><pre> <code class="bash hljs">[briskly@archlinux archive]$ bzip2 -d flag1.png bzip2: Can<span class="hljs-string"><span class="hljs-string">'t guess original name for flag1.png -- using flag1.png.out [briskly@archlinux archive]$ file flag1.png.out flag1.png.out: LRZIP compressed data - version 0.6</span></span></code> </pre> <br><p>  It seems that there are other archives in these archives.  We are trying to decrypt the zip file.  7z immediately asked for a password: </p><br><pre> <code class="bash hljs">[briskly@archlinux archive]$ 7z x flag7.png 7-Zip [64] 16.02: Copyright (c) 1999-2016 Igor Pavlov: 2016-05-21 p7zip Version 16.02 (locale=ru_RU.UTF-8,Utf16=on,HugeFiles=on,64 bits,2 CPUs Intel(R) Core(TM) i7-6600U CPU @ 2.60GHz (406E3),ASM,AES-NI) Scanning the drive <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> archives: 1 file, 385755 bytes (377 KiB) Extracting archive: flag7.png -- Path = flag7.png Type = zip Physical Size = 385755 Enter password (will not be echoed):</code> </pre> <br><p>  In this case, it is worth automating the process of extracting from the archive, since there are a lot of them: </p><br><div class="spoiler">  <b class="spoiler_title">Extract from archive</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash FILE="$1" FLAG="flag.png" TMP_DIR="PNGs" # Dirty: [ ! -d "./$TMP_DIR" ] &amp;&amp; mkdir "$TMP_DIR" &amp;&amp; echo -e "\n [+] Creating temp folder: $TMP_DIR." [ ! -f "./$FLAG" ] &amp;&amp; cp $FILE flag.png &amp;&amp; echo -e " [+] Creating temp file: $FLAG.\n" deArch () { CHECK=`file "$FLAG"` if [[ $CHECK == *"rzip compressed data"* ]] then echo -e " [*] Now $FLAG is RZIP data (.rz)\n [+] Extracting $FLAG\n" mv flag.png{,.rz} runzip -d flag.png.rz #rm flag.png.rz sleep 1 deArch elif [[ $CHECK == *"LRZIP compressed data"* ]] then echo -e " [*] Now $FLAG is LRZIP archive (.lrz)\n [+] Extracting $FLAG\n" mv flag.png{,.lrz} lrunzip flag.png.lrz &gt; /dev/null rm flag.png.lrz sleep 1 deArch elif [[ $CHECK == *"bzip2 compressed data"* ]] then echo -e " [*] Now $FLAG is BZIP file (.bz2)\n [+] Extracting $FLAG\n" mv flag.png{,.bz2} bzip2 -d flag.png.bz2 #&gt; /dev/null sleep 1 deArch elif [[ $CHECK == *"compress'd data 16 bits"* ]] then echo -e " [*] Now $FLAG is unix compressed file (.z)\n [+] Extracting $FLAG\n" mv flag.png{,.z} uncompress flag.png.z sleep 1 deArch elif [[ $CHECK == *"7-zip archive data"* ]] then echo -e " [*] Now $FLAG is 7-ZIP archive (.7z)\n [+] Extracting $FLAG\n" mv flag.png{,.7z} 7z x flag.png.7z &gt; /dev/null rm flag.png.7z sleep 1 deArch elif [[ $CHECK == *"ARJ archive data, v11, slash-switched"* ]] then echo -e " [*] Now $FLAG is ARJ archive (.arj)\n [+] Extracting $FLAG\n" mv flag.png{,.arj} arj x flag.png.arj &gt; /dev/null rm flag.png.arj sleep 1 deArch elif [[ $CHECK == *"cpio archive"* ]] then echo -e " [*] Now $FLAG is CPIO archive (.cpio)\n [+] Extracting $FLAG\n" mv flag.png{,.cpio} cpio -idv &lt; flag.png.cpio 2&gt; /dev/null rm flag.png.cpio sleep 1 deArch elif [[ $CHECK == *"current ar archive"* ]] then echo -e " [*] Now $FLAG is AR archive (.a)\n [+] Extracting $FLAG\n" mv flag.png{,.a} ar x flag.png.a rm flag.png.a sleep 1 deArch elif [[ $CHECK == *"Zip archive data"* ]] then echo -e " [*] Now $FLAG is zip archive (.zip)\n [+] Extracting $FLAG\n" mv flag.png{,.zip} #mv flag.png{,.7z} ENC_CHCK=`7z l -slt -- flag.png.zip | grep -ic "Encrypted = +"` if [ "$ENC_CHCK" -eq "1" ] then #exit 1 echo " [!] PASSWORD pretocted archive" zip2john flag.png.zip | awk -F: '{print $2}' &gt; hash.lst rm -rf /root/.john/john.* #ZIP_PASS=`john hash.lst 2&gt;&amp;1 &gt; /dev/null | awk '/\(\?\)/ {print $1}'` ZIP_PASS=`john hash.lst --wordlist=/usr/share/wordlists/rockyou.txt 2&gt;&amp;1 | awk '/\(\?\)/ {print $1}'` if [[ -z "$ZIP_PASS" ]] then #echo -e "$ZIP_PASS" echo -e " [-] Your pass was not found, please, try it manually..." else echo -e " [+] Voila! Your pass is: \e[1;33m$ZIP_PASS\e[0;0m, extracting an archive...\n" 7z x -p"$ZIP_PASS" flag.png.zip &gt; /dev/null rm flag.png.zip sleep 1 deArch fi else 7z x flag.png.zip sleep 1 deArch fi #sleep 1 #deArch elif [[ $CHECK == *"PNG image data"* ]] then echo -e " [\e[1;32m*\e[0;0m] Now $FLAG is PNG image file !!!\n [\e[1;32m+\e[0;0m] Open this: ./$TMP_DIR/$FILE\n" sleep 1 #eog flag.png 2&gt; /dev/null mv $FLAG $TMP_DIR/$FILE exit 0 else echo -e "\n [-] Hernya! $CHECK" fi } deArch</span></span></code> </pre> </div></div><br><p>  The result of the script: </p><br><div class="spoiler">  <b class="spoiler_title">Result</b> <div class="spoiler_text"><pre> <code class="bash hljs">bash deArch.sh flag4.png [+] Creating temp folder: PNGs. [+] Creating temp file: flag.png. [*] Now flag.png is ARJ archive (.arj) [+] Extracting flag.png [*] Now flag.png is zip archive (.zip) [+] Extracting flag.png [!] PASSWORD pretocted archive [+] Voila! Your pass is: love123, extracting an archive... [*] Now flag.png is unix compressed file (.z) [+] Extracting flag.png [*] Now flag.png is AR archive (.a) [+] Extracting flag.png [*] Now flag.png is BZIP file (.bz2) [+] Extracting flag.png [*] Now flag.png is CPIO archive (.cpio) [+] Extracting flag.png [*] Now flag.png is RZIP data (.rz) [+] Extracting flag.png [*] Now flag.png is 7-ZIP archive (.7z) [+] Extracting flag.png [*] Now flag.png is LRZIP archive (.lrz) [+] Extracting flag.png [*] Now flag.png is PNG image file !!! [+] Open this: ./PNGs/flag4.png</code> </pre> </div></div><br><p>  As a result, flag4.png is pulled out of the file. </p><br><p><img src="https://habrastorage.org/files/295/3c5/f05/2953c5f05b2d4571b15d7f772ec25b05.png" alt="image"></p><br><p>  So, the picture is received!  Let's see what's inside - maybe there is a steganography? <br>  To do this, run Stegsolve, and by changing some settings, we‚Äôll get something quite legible: </p><br><p><img src="https://habrastorage.org/files/ad4/6e7/d27/ad46e7d2765944298e13539cc76c3821.png" alt="image"></p><br><p>  Judging by the signs =, it looks like base64.  But all capital letters (uppercase).  Let us recall the legend, where it is said that the person who possessed knowledge preferred the number 32. Let's try base32, as a result we get TPAU'XAPDEP. </p><br><p>  We carry out the same actions in relation to other files. </p><br><p>  As a result, we obtain the following: </p><br><pre> <code class="bash hljs">thisnotaflag thisisflag,joke noflaghere noo000000op CTFZONE{5dbb39d62d31b1c notflagagain flagwashere 025f3b0e3a987d375}part2 kakoyflag? TPAU<span class="hljs-string"><span class="hljs-string">'XAPDEP</span></span></code> </pre> <br><p>  Here is our flag! </p><br><p>  <strong>Answer:</strong> <em>ctfzone {5dbb39d62d31b1c025f3b0e3a987d375} part2</em> </p><br><h4 id="misc_1000-molibdengamma">  MISC_1000.  Molibden | Gamma </h4><br><blockquote>  <em><strong>AURORA:</strong> Lieutenant, you've got to the command center.</em>  <em>It's time to go home and join our comrades!</em>  <em>Wait, something is wrong with the systems.</em>  <em>Some basic libraries are lost.</em>  <em>Computer can't find the route.</em>  <em>Make some simple calculations.</em>  <em>Quick, we are almost there!</em> </blockquote><p><br>  <strong>Decision:</strong> </p><br><p>  So, we are almost there!  To get control of the ship, you need to correct the error in the system. </p><br><p>  So, run the program.  An example of the program we see in the screenshot. </p><br><p><img src="https://habrastorage.org/files/93a/a82/f7d/93aa82f7d68649f4bd40ad93ccc6cec6.png" alt="image"></p><br><p>  From the legend it is clear that we need to interpret the code that the server sends.  To get a solution you will have to show your programming skills. </p><br><p>  Since the code is written in Python, the first obvious solution is to do exec and send the result back.  The code will look like this: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> socket <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> create_connection <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time sock = create_connection((<span class="hljs-string"><span class="hljs-string">"95.85.41.197"</span></span>, <span class="hljs-number"><span class="hljs-number">8887</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">10</span></span>): res = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> code = sock.recv(<span class="hljs-number"><span class="hljs-number">102400</span></span>) code = code.decode() code = <span class="hljs-string"><span class="hljs-string">"\n"</span></span>.join(code.split(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>)[:<span class="hljs-number"><span class="hljs-number">-2</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"gone wrong"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> code: print(code) exit(<span class="hljs-number"><span class="hljs-number">0</span></span>) start = time() l = res = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> print(code) exec(code) res = res <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> l print(time() - start) code = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> res = str(res).encode() <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: sock.send(res + <span class="hljs-string"><span class="hljs-string">b"\n"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception: print(sock.recv(<span class="hljs-number"><span class="hljs-number">102400</span></span>)) print(sock.recv(<span class="hljs-number"><span class="hljs-number">102400</span></span>)) print(sock.recv(<span class="hljs-number"><span class="hljs-number">102400</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span></code> </pre> <br><p>  After that comes the code with sleep, which slows down the execution: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sleep k = <span class="hljs-number"><span class="hljs-number">96</span></span> s = <span class="hljs-number"><span class="hljs-number">36</span></span> c = <span class="hljs-number"><span class="hljs-number">98</span></span> mas = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(c): sleep(<span class="hljs-number"><span class="hljs-number">0.1</span></span>) mas.append(s) s += k res = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> el <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> mas: sleep(<span class="hljs-number"><span class="hljs-number">0.1</span></span>) res += el print(res)</code> </pre> <br><p>  This problem is solved simply by cutting out sleep on a regular basis.  For example, like this: </p><br><pre> <code class="python hljs">code = code.replace(<span class="hljs-string"><span class="hljs-string">"sleep(0.1)"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>)</code> </pre> <br><p>  The following complication is that sleep is renamed upon import: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sleep <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> JecYvyk</code> </pre> <br><p>  In this case, you can write a regular-schedule or simply replace: </p><br><pre> <code class="python hljs">code = code.replace(<span class="hljs-string"><span class="hljs-string">"sleep"</span></span>, <span class="hljs-string"><span class="hljs-string">"gmtime"</span></span>)</code> </pre> <br><p>  The next time the solution stops at a step with a code that uses large numbers: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> gmtime <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> rluVx k = <span class="hljs-number"><span class="hljs-number">82194181</span></span> s = <span class="hljs-number"><span class="hljs-number">55474764</span></span> c = <span class="hljs-number"><span class="hljs-number">54888629</span></span> mas = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(c): rluVx(<span class="hljs-number"><span class="hljs-number">2</span></span>*<span class="hljs-number"><span class="hljs-number">0.01</span></span>) mas.append(s) s += k res = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> el <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> mas: rluVx(<span class="hljs-number"><span class="hljs-number">2</span></span>*<span class="hljs-number"><span class="hljs-number">0.01</span></span>) res += el print(res)</code> </pre> <br><p>  At this stage, the program is not executed for two reasons - either the memory is running low or the server gives an error: </p><br><pre> <code class="bash hljs">Something gone wrong: TimeoutError</code> </pre> <br><p>  Obviously, just to solve this problem will not work, you will have to understand the code.  When you first evaluate the code, you will notice that this is very similar to the sum of an arithmetic progression. </p><br><p>  Since the function is really inefficiently written, instead of the usual linear formula, an array with all elements of an arithmetic progression is formed, and then it is added.  We write this formula: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">solve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(k, s, c)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> str((<span class="hljs-number"><span class="hljs-number">2</span></span>*s + k*(c<span class="hljs-number"><span class="hljs-number">-1</span></span>))*c//<span class="hljs-number"><span class="hljs-number">2</span></span>)</code> </pre> <br><p>  It looks pretty simple. </p><br><p>  The next problem is that the code stops running: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sleep <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Rkyv <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> shuffle l = [<span class="hljs-number"><span class="hljs-number">5984807</span></span>, <span class="hljs-number"><span class="hljs-number">6299947</span></span>, <span class="hljs-number"><span class="hljs-number">10119240</span></span>, <span class="hljs-number"><span class="hljs-number">13578507</span></span>, <span class="hljs-number"><span class="hljs-number">14224900</span></span>, <span class="hljs-number"><span class="hljs-number">15238270</span></span>, <span class="hljs-number"><span class="hljs-number">15513380</span></span>, <span class="hljs-number"><span class="hljs-number">16429758</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: Rkyv(<span class="hljs-number"><span class="hljs-number">0o10</span></span>*<span class="hljs-number"><span class="hljs-number">0.01</span></span>) shuffle(l) prev = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> is_sorted = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> el <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> l: Rkyv(<span class="hljs-number"><span class="hljs-number">0o10</span></span>*<span class="hljs-number"><span class="hljs-number">0.01</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> prev <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: prev = el <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> prev &gt;= el: is_sorted = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> prev = el <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> is_sorted: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> print(l)</code> </pre> <br><p>  We'll have to deal with this task.  Very similar to monkey_sort, but, apparently, this code cannot be executed.  Rewrite to the usual sort, which provides us with Python.  But this is not enough. </p><br><p>  As a result, there comes a time when a regular exec no longer has time to read the 'scary' obfuscated code: </p><br><div class="spoiler">  <b class="spoiler_title">Scary obfuscated code</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sleep <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> EB s = <span class="hljs-string"><span class="hljs-string">b'Vt\xe9\xe9\xed\x05J\xdaEQ'</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OOOOOOOOO0000OOO0 )</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> PI_SUBST =[<span class="hljs-number"><span class="hljs-number">41</span></span> ,<span class="hljs-number"><span class="hljs-number">46</span></span> ,<span class="hljs-number"><span class="hljs-number">67</span></span> ,<span class="hljs-number"><span class="hljs-number">201</span></span> ,<span class="hljs-number"><span class="hljs-number">162</span></span> ,<span class="hljs-number"><span class="hljs-number">216</span></span> ,<span class="hljs-number"><span class="hljs-number">124</span></span> ,<span class="hljs-number"><span class="hljs-number">1</span></span> ,<span class="hljs-number"><span class="hljs-number">61</span></span> ,<span class="hljs-number"><span class="hljs-number">54</span></span> ,<span class="hljs-number"><span class="hljs-number">84</span></span> ,<span class="hljs-number"><span class="hljs-number">161</span></span> ,<span class="hljs-number"><span class="hljs-number">236</span></span> ,<span class="hljs-number"><span class="hljs-number">240</span></span> ,<span class="hljs-number"><span class="hljs-number">6</span></span> ,<span class="hljs-number"><span class="hljs-number">19</span></span> ,<span class="hljs-number"><span class="hljs-number">98</span></span> ,<span class="hljs-number"><span class="hljs-number">167</span></span> ,<span class="hljs-number"><span class="hljs-number">5</span></span> ,<span class="hljs-number"><span class="hljs-number">243</span></span> ,<span class="hljs-number"><span class="hljs-number">192</span></span> ,<span class="hljs-number"><span class="hljs-number">199</span></span> ,<span class="hljs-number"><span class="hljs-number">115</span></span> ,<span class="hljs-number"><span class="hljs-number">140</span></span> ,<span class="hljs-number"><span class="hljs-number">152</span></span> ,<span class="hljs-number"><span class="hljs-number">147</span></span> ,<span class="hljs-number"><span class="hljs-number">43</span></span> ,<span class="hljs-number"><span class="hljs-number">217</span></span> ,<span class="hljs-number"><span class="hljs-number">188</span></span> ,<span class="hljs-number"><span class="hljs-number">76</span></span> ,<span class="hljs-number"><span class="hljs-number">130</span></span> ,<span class="hljs-number"><span class="hljs-number">202</span></span> ,<span class="hljs-number"><span class="hljs-number">30</span></span> ,<span class="hljs-number"><span class="hljs-number">155</span></span> ,<span class="hljs-number"><span class="hljs-number">87</span></span> ,<span class="hljs-number"><span class="hljs-number">60</span></span> ,<span class="hljs-number"><span class="hljs-number">253</span></span> ,<span class="hljs-number"><span class="hljs-number">212</span></span> ,<span class="hljs-number"><span class="hljs-number">224</span></span> ,<span class="hljs-number"><span class="hljs-number">22</span></span> ,<span class="hljs-number"><span class="hljs-number">103</span></span> ,<span class="hljs-number"><span class="hljs-number">66</span></span> ,<span class="hljs-number"><span class="hljs-number">111</span></span> ,<span class="hljs-number"><span class="hljs-number">24</span></span> ,<span class="hljs-number"><span class="hljs-number">138</span></span> ,<span class="hljs-number"><span class="hljs-number">23</span></span> ,<span class="hljs-number"><span class="hljs-number">229</span></span> ,<span class="hljs-number"><span class="hljs-number">18</span></span> ,<span class="hljs-number"><span class="hljs-number">190</span></span> ,<span class="hljs-number"><span class="hljs-number">78</span></span> ,<span class="hljs-number"><span class="hljs-number">196</span></span> ,<span class="hljs-number"><span class="hljs-number">214</span></span> ,<span class="hljs-number"><span class="hljs-number">218</span></span> ,<span class="hljs-number"><span class="hljs-number">158</span></span> ,<span class="hljs-number"><span class="hljs-number">222</span></span> ,<span class="hljs-number"><span class="hljs-number">73</span></span> ,<span class="hljs-number"><span class="hljs-number">160</span></span> ,<span class="hljs-number"><span class="hljs-number">251</span></span> ,<span class="hljs-number"><span class="hljs-number">245</span></span> ,<span class="hljs-number"><span class="hljs-number">142</span></span> ,<span class="hljs-number"><span class="hljs-number">187</span></span> ,<span class="hljs-number"><span class="hljs-number">47</span></span> ,<span class="hljs-number"><span class="hljs-number">238</span></span> ,<span class="hljs-number"><span class="hljs-number">122</span></span> ,<span class="hljs-number"><span class="hljs-number">169</span></span> ,<span class="hljs-number"><span class="hljs-number">104</span></span> ,<span class="hljs-number"><span class="hljs-number">121</span></span> ,<span class="hljs-number"><span class="hljs-number">145</span></span> ,<span class="hljs-number"><span class="hljs-number">21</span></span> ,<span class="hljs-number"><span class="hljs-number">178</span></span> ,<span class="hljs-number"><span class="hljs-number">7</span></span> ,<span class="hljs-number"><span class="hljs-number">63</span></span> ,<span class="hljs-number"><span class="hljs-number">148</span></span> ,<span class="hljs-number"><span class="hljs-number">194</span></span> ,<span class="hljs-number"><span class="hljs-number">16</span></span> ,<span class="hljs-number"><span class="hljs-number">137</span></span> ,<span class="hljs-number"><span class="hljs-number">11</span></span> ,<span class="hljs-number"><span class="hljs-number">34</span></span> ,<span class="hljs-number"><span class="hljs-number">95</span></span> ,<span class="hljs-number"><span class="hljs-number">33</span></span> ,<span class="hljs-number"><span class="hljs-number">128</span></span> ,<span class="hljs-number"><span class="hljs-number">127</span></span> ,<span class="hljs-number"><span class="hljs-number">93</span></span> ,<span class="hljs-number"><span class="hljs-number">154</span></span> ,<span class="hljs-number"><span class="hljs-number">90</span></span> ,<span class="hljs-number"><span class="hljs-number">144</span></span> ,<span class="hljs-number"><span class="hljs-number">50</span></span> ,<span class="hljs-number"><span class="hljs-number">39</span></span> ,<span class="hljs-number"><span class="hljs-number">53</span></span> ,<span class="hljs-number"><span class="hljs-number">62</span></span> ,<span class="hljs-number"><span class="hljs-number">204</span></span> ,<span class="hljs-number"><span class="hljs-number">231</span></span> ,<span class="hljs-number"><span class="hljs-number">191</span></span> ,<span class="hljs-number"><span class="hljs-number">247</span></span> ,<span class="hljs-number"><span class="hljs-number">151</span></span> ,<span class="hljs-number"><span class="hljs-number">3</span></span> ,<span class="hljs-number"><span class="hljs-number">255</span></span> ,<span class="hljs-number"><span class="hljs-number">25</span></span> ,<span class="hljs-number"><span class="hljs-number">48</span></span> ,<span class="hljs-number"><span class="hljs-number">179</span></span> ,<span class="hljs-number"><span class="hljs-number">72</span></span> ,<span class="hljs-number"><span class="hljs-number">165</span></span> ,<span class="hljs-number"><span class="hljs-number">181</span></span> ,<span class="hljs-number"><span class="hljs-number">209</span></span> ,<span class="hljs-number"><span class="hljs-number">215</span></span> ,<span class="hljs-number"><span class="hljs-number">94</span></span> ,<span class="hljs-number"><span class="hljs-number">146</span></span> ,<span class="hljs-number"><span class="hljs-number">42</span></span> ,<span class="hljs-number"><span class="hljs-number">172</span></span> ,<span class="hljs-number"><span class="hljs-number">86</span></span> ,<span class="hljs-number"><span class="hljs-number">170</span></span> ,<span class="hljs-number"><span class="hljs-number">198</span></span> ,<span class="hljs-number"><span class="hljs-number">79</span></span> ,<span class="hljs-number"><span class="hljs-number">184</span></span> ,<span class="hljs-number"><span class="hljs-number">56</span></span> ,<span class="hljs-number"><span class="hljs-number">210</span></span> ,<span class="hljs-number"><span class="hljs-number">150</span></span> ,<span class="hljs-number"><span class="hljs-number">164</span></span> ,<span class="hljs-number"><span class="hljs-number">125</span></span> ,<span class="hljs-number"><span class="hljs-number">182</span></span> ,<span class="hljs-number"><span class="hljs-number">118</span></span> ,<span class="hljs-number"><span class="hljs-number">252</span></span> ,<span class="hljs-number"><span class="hljs-number">107</span></span> ,<span class="hljs-number"><span class="hljs-number">226</span></span> ,<span class="hljs-number"><span class="hljs-number">156</span></span> ,<span class="hljs-number"><span class="hljs-number">116</span></span> ,<span class="hljs-number"><span class="hljs-number">4</span></span> ,<span class="hljs-number"><span class="hljs-number">241</span></span> ,<span class="hljs-number"><span class="hljs-number">69</span></span> ,<span class="hljs-number"><span class="hljs-number">157</span></span> ,<span class="hljs-number"><span class="hljs-number">112</span></span> ,<span class="hljs-number"><span class="hljs-number">89</span></span> ,<span class="hljs-number"><span class="hljs-number">100</span></span> ,<span class="hljs-number"><span class="hljs-number">113</span></span> ,<span class="hljs-number"><span class="hljs-number">135</span></span> ,<span class="hljs-number"><span class="hljs-number">32</span></span> ,<span class="hljs-number"><span class="hljs-number">134</span></span> ,<span class="hljs-number"><span class="hljs-number">91</span></span> ,<span class="hljs-number"><span class="hljs-number">207</span></span> ,<span class="hljs-number"><span class="hljs-number">101</span></span> ,<span class="hljs-number"><span class="hljs-number">230</span></span> ,<span class="hljs-number"><span class="hljs-number">45</span></span> ,<span class="hljs-number"><span class="hljs-number">168</span></span> ,<span class="hljs-number"><span class="hljs-number">2</span></span> ,<span class="hljs-number"><span class="hljs-number">27</span></span> ,<span class="hljs-number"><span class="hljs-number">96</span></span> ,<span class="hljs-number"><span class="hljs-number">37</span></span> ,<span class="hljs-number"><span class="hljs-number">173</span></span> ,<span class="hljs-number"><span class="hljs-number">174</span></span> ,<span class="hljs-number"><span class="hljs-number">176</span></span> ,<span class="hljs-number"><span class="hljs-number">185</span></span> ,<span class="hljs-number"><span class="hljs-number">246</span></span> ,<span class="hljs-number"><span class="hljs-number">28</span></span> ,<span class="hljs-number"><span class="hljs-number">70</span></span> ,<span class="hljs-number"><span class="hljs-number">97</span></span> ,<span class="hljs-number"><span class="hljs-number">105</span></span> ,<span class="hljs-number"><span class="hljs-number">52</span></span> ,<span class="hljs-number"><span class="hljs-number">64</span></span> ,<span class="hljs-number"><span class="hljs-number">126</span></span> ,<span class="hljs-number"><span class="hljs-number">15</span></span> ,<span class="hljs-number"><span class="hljs-number">85</span></span> ,<span class="hljs-number"><span class="hljs-number">71</span></span> ,<span class="hljs-number"><span class="hljs-number">163</span></span> ,<span class="hljs-number"><span class="hljs-number">35</span></span> ,<span class="hljs-number"><span class="hljs-number">221</span></span> ,<span class="hljs-number"><span class="hljs-number">81</span></span> ,<span class="hljs-number"><span class="hljs-number">175</span></span> ,<span class="hljs-number"><span class="hljs-number">58</span></span> ,<span class="hljs-number"><span class="hljs-number">195</span></span> ,<span class="hljs-number"><span class="hljs-number">92</span></span> ,<span class="hljs-number"><span class="hljs-number">249</span></span> ,<span class="hljs-number"><span class="hljs-number">206</span></span> ,<span class="hljs-number"><span class="hljs-number">186</span></span> ,<span class="hljs-number"><span class="hljs-number">197</span></span> ,<span class="hljs-number"><span class="hljs-number">234</span></span> ,<span class="hljs-number"><span class="hljs-number">38</span></span> ,<span class="hljs-number"><span class="hljs-number">44</span></span> ,<span class="hljs-number"><span class="hljs-number">83</span></span> ,<span class="hljs-number"><span class="hljs-number">13</span></span> ,<span class="hljs-number"><span class="hljs-number">110</span></span> ,<span class="hljs-number"><span class="hljs-number">133</span></span> ,<span class="hljs-number"><span class="hljs-number">40</span></span> ,<span class="hljs-number"><span class="hljs-number">132</span></span> ,<span class="hljs-number"><span class="hljs-number">9</span></span> ,<span class="hljs-number"><span class="hljs-number">211</span></span> ,<span class="hljs-number"><span class="hljs-number">223</span></span> ,<span class="hljs-number"><span class="hljs-number">205</span></span> ,<span class="hljs-number"><span class="hljs-number">244</span></span> ,<span class="hljs-number"><span class="hljs-number">65</span></span> ,<span class="hljs-number"><span class="hljs-number">129</span></span> ,<span class="hljs-number"><span class="hljs-number">77</span></span> ,<span class="hljs-number"><span class="hljs-number">82</span></span> ,<span class="hljs-number"><span class="hljs-number">106</span></span> ,<span class="hljs-number"><span class="hljs-number">220</span></span> ,<span class="hljs-number"><span class="hljs-number">55</span></span> ,<span class="hljs-number"><span class="hljs-number">200</span></span> ,<span class="hljs-number"><span class="hljs-number">108</span></span> ,<span class="hljs-number"><span class="hljs-number">193</span></span> ,<span class="hljs-number"><span class="hljs-number">171</span></span> ,<span class="hljs-number"><span class="hljs-number">250</span></span> ,<span class="hljs-number"><span class="hljs-number">36</span></span> ,<span class="hljs-number"><span class="hljs-number">225</span></span> ,<span class="hljs-number"><span class="hljs-number">123</span></span> ,<span class="hljs-number"><span class="hljs-number">8</span></span> ,<span class="hljs-number"><span class="hljs-number">12</span></span> ,<span class="hljs-number"><span class="hljs-number">189</span></span> ,<span class="hljs-number"><span class="hljs-number">177</span></span> ,<span class="hljs-number"><span class="hljs-number">74</span></span> ,<span class="hljs-number"><span class="hljs-number">120</span></span> ,<span class="hljs-number"><span class="hljs-number">136</span></span> ,<span class="hljs-number"><span class="hljs-number">149</span></span> ,<span class="hljs-number"><span class="hljs-number">139</span></span> ,<span class="hljs-number"><span class="hljs-number">227</span></span> ,<span class="hljs-number"><span class="hljs-number">99</span></span> ,<span class="hljs-number"><span class="hljs-number">232</span></span> ,<span class="hljs-number"><span class="hljs-number">109</span></span> ,<span class="hljs-number"><span class="hljs-number">233</span></span> ,<span class="hljs-number"><span class="hljs-number">203</span></span> ,<span class="hljs-number"><span class="hljs-number">213</span></span> ,<span class="hljs-number"><span class="hljs-number">254</span></span> ,<span class="hljs-number"><span class="hljs-number">59</span></span> ,<span class="hljs-number"><span class="hljs-number">0</span></span> ,<span class="hljs-number"><span class="hljs-number">29</span></span> ,<span class="hljs-number"><span class="hljs-number">57</span></span> ,<span class="hljs-number"><span class="hljs-number">242</span></span> ,<span class="hljs-number"><span class="hljs-number">239</span></span> ,<span class="hljs-number"><span class="hljs-number">183</span></span> ,<span class="hljs-number"><span class="hljs-number">14</span></span> ,<span class="hljs-number"><span class="hljs-number">102</span></span> ,<span class="hljs-number"><span class="hljs-number">88</span></span> ,<span class="hljs-number"><span class="hljs-number">208</span></span> ,<span class="hljs-number"><span class="hljs-number">228</span></span> ,<span class="hljs-number"><span class="hljs-number">166</span></span> ,<span class="hljs-number"><span class="hljs-number">119</span></span> ,<span class="hljs-number"><span class="hljs-number">114</span></span> ,<span class="hljs-number"><span class="hljs-number">248</span></span> ,<span class="hljs-number"><span class="hljs-number">235</span></span> ,<span class="hljs-number"><span class="hljs-number">117</span></span> ,<span class="hljs-number"><span class="hljs-number">75</span></span> ,<span class="hljs-number"><span class="hljs-number">10</span></span> ,<span class="hljs-number"><span class="hljs-number">49</span></span> ,<span class="hljs-number"><span class="hljs-number">68</span></span> ,<span class="hljs-number"><span class="hljs-number">80</span></span> ,<span class="hljs-number"><span class="hljs-number">180</span></span> ,<span class="hljs-number"><span class="hljs-number">143</span></span> ,<span class="hljs-number"><span class="hljs-number">237</span></span> ,<span class="hljs-number"><span class="hljs-number">31</span></span> ,<span class="hljs-number"><span class="hljs-number">26</span></span> ,<span class="hljs-number"><span class="hljs-number">219</span></span> ,<span class="hljs-number"><span class="hljs-number">153</span></span> ,<span class="hljs-number"><span class="hljs-number">141</span></span> ,<span class="hljs-number"><span class="hljs-number">51</span></span> ,<span class="hljs-number"><span class="hljs-number">159</span></span> ,<span class="hljs-number"><span class="hljs-number">17</span></span> ,<span class="hljs-number"><span class="hljs-number">131</span></span> ,<span class="hljs-number"><span class="hljs-number">20</span></span> ] O00OOOO0OOOO00000 =OOOOOOOOO0000OOO0 OO00OO000OO0OO000 =len (O00OOOO0OOOO00000 ) O00OOOO0OOOO00000 +=chr (<span class="hljs-number"><span class="hljs-number">16</span></span> -(OO00OO000OO0OO000 %<span class="hljs-number"><span class="hljs-number">16</span></span> )).encode (<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>)*(<span class="hljs-number"><span class="hljs-number">16</span></span> -(OO00OO000OO0OO000 %<span class="hljs-number"><span class="hljs-number">16</span></span> )) O00OOOO0O0OOO00O0 =O00OOOO0OOOO00000 OO00OO000OO0OO000 =len (O00OOOO0OOOO00000 ) OOOOO0O0000000OO0 =bytearray (<span class="hljs-string"><span class="hljs-string">b"\x00"</span></span>*<span class="hljs-number"><span class="hljs-number">16</span></span> ) OO0O0O000OOOO0O0O =<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> O0OOO0OO000OO00O0 <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range (OO00OO000OO0OO000 //<span class="hljs-number"><span class="hljs-number">16</span></span> ): EB(<span class="hljs-number"><span class="hljs-number">0x3</span></span>*<span class="hljs-number"><span class="hljs-number">0.01</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> OO00O00OOO000OO00 <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range (<span class="hljs-number"><span class="hljs-number">16</span></span> ): EB(<span class="hljs-number"><span class="hljs-number">0x3</span></span>*<span class="hljs-number"><span class="hljs-number">0.01</span></span>) O0O0OOOO000O0OO0O =O00OOOO0O0OOO00O0 [O0OOO0OO000OO00O0 *<span class="hljs-number"><span class="hljs-number">16</span></span> +OO00O00OOO000OO00 ] OOOOO0O0000000OO0 [OO00O00OOO000OO00 ]=OOOOO0O0000000OO0 [OO00O00OOO000OO00 ]^PI_SUBST [O0O0OOOO000O0OO0O ^OO0O0O000OOOO0O0O ] OO0O0O000OOOO0O0O =OOOOO0O0000000OO0 [OO00O00OOO000OO00 ] OO0OOO00OOO00000O =O00OOOO0O0OOO00O0 +OOOOO0O0000000OO0 OO00OO000OO0OO000 +=<span class="hljs-number"><span class="hljs-number">16</span></span> OOO00O00O0O0O0OO0 =bytearray ([<span class="hljs-number"><span class="hljs-number">0</span></span> ])*<span class="hljs-number"><span class="hljs-number">48</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> O0OOO0OO000OO00O0 <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range (OO00OO000OO0OO000 //<span class="hljs-number"><span class="hljs-number">16</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> OO00O00OOO000OO00 <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range (<span class="hljs-number"><span class="hljs-number">16</span></span> ): EB(<span class="hljs-number"><span class="hljs-number">0x3</span></span>*<span class="hljs-number"><span class="hljs-number">0.01</span></span>) OOO00O00O0O0O0OO0 [<span class="hljs-number"><span class="hljs-number">16</span></span> +OO00O00OOO000OO00 ]=OO0OOO00OOO00000O [O0OOO0OO000OO00O0 *<span class="hljs-number"><span class="hljs-number">16</span></span> +OO00O00OOO000OO00 ] OOO00O00O0O0O0OO0 [<span class="hljs-number"><span class="hljs-number">32</span></span> +OO00O00OOO000OO00 ]=OOO00O00O0O0O0OO0 [<span class="hljs-number"><span class="hljs-number">16</span></span> +OO00O00OOO000OO00 ]^OOO00O00O0O0O0OO0 [OO00O00OOO000OO00 ] OOOO0O0OO000000OO =<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> OO00O00OOO000OO00 <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range (<span class="hljs-number"><span class="hljs-number">18</span></span> ): EB(<span class="hljs-number"><span class="hljs-number">0x3</span></span>*<span class="hljs-number"><span class="hljs-number">0.01</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> OOOO00O00OOO0OOOO <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range (<span class="hljs-number"><span class="hljs-number">48</span></span> ): EB(<span class="hljs-number"><span class="hljs-number">0x3</span></span>*<span class="hljs-number"><span class="hljs-number">0.01</span></span>) OOOO0O0OO000000OO =OOO00O00O0O0O0OO0 [OOOO00O00OOO0OOOO ]=OOO00O00O0O0O0OO0 [OOOO00O00OOO0OOOO ]^PI_SUBST [OOOO0O0OO000000OO ] OOOO0O0OO000000OO =(OOOO0O0OO000000OO +OO00O00OOO000OO00 )%<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> bytes (OOO00O00O0O0O0OO0 [:<span class="hljs-number"><span class="hljs-number">16</span></span> ]) OO0OOOO00OO0O0O0O = <span class="hljs-string"><span class="hljs-string">b'Vt\xe9\xe9\xed\x05J\xdaEQ'</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OO0OOOO00OO0O0O0O)</span></span></span><span class="hljs-function">:</span></span> O00O00OO000OOO00O =<span class="hljs-string"><span class="hljs-string">'0123456789abcdef'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">b''</span></span>.join(map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x.encode(), map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> O00O0OO0O0OOOO0O0 :O00O00OO000OOO00O [(O00O0OO0O0OOOO0O0 &gt;&gt;<span class="hljs-number"><span class="hljs-number">4</span></span> )&amp;<span class="hljs-number"><span class="hljs-number">0xf</span></span> ]+O00O00OO000OOO00O [O00O0OO0O0OOOO0O0 &amp;<span class="hljs-number"><span class="hljs-number">0xf</span></span> ],func1 (OO0OOOO00OO0O0O0O )))) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">100</span></span>): OO0OOOO00OO0O0O0O = func2(OO0OOOO00OO0O0O0O) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> OO0OOOO00OO0O0O0O.decode() <span class="hljs-comment"><span class="hljs-comment">#print(''.join (map (lambda O00O0OO0O0OOOO0O0 :O00O00OO000OOO00O [(O00O0OO0O0OOOO0O0 &gt;&gt;4 )&amp;0xf ]+O00O00OO000OOO00O [O00O0OO0O0OOOO0O0 &amp;0xf ],func1 (OO0OOOO00OO0O0O0O )))) res = func3(s) print(res)</span></span></code> </pre> </div></div><br><p>  In the course of a small deobfuscation, it becomes clear that this is most likely some kind of hash function that is applied 100 times in succession.  Then you can go in two ways: either simply rewrite this function on something faster (for example, C ++), or try to look for the replacement table that is hardcoded in the code. </p><br><p>  Let's google it: </p><br><p><img src="https://habrastorage.org/files/b28/9cb/349/b289cb3492a54a049abc77193636a159.png" alt="image"></p><br><p>  It's easy enough to guess that this is md2.  PYCRYPTO has a quick implementation of this feature: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Crypto.Hash <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MD2 <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">solve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inp)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(params.get(<span class="hljs-string"><span class="hljs-string">"count"</span></span>)): h = MD2.new() h.update(inp) inp = h.hexdigest() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> inp</code> </pre><br><p>  Resulting solver code: </p><br><div class="spoiler">  <b class="spoiler_title">Code solver</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> re <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> json <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> socket <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> create_connection <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> solves <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> md2 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> solves <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> arifmetic <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time sock = create_connection((<span class="hljs-string"><span class="hljs-string">"95.85.41.197"</span></span>, <span class="hljs-number"><span class="hljs-number">8887</span></span>)) r1 = re.compile(<span class="hljs-string"><span class="hljs-string">r"l = (\[.*\])"</span></span>) r21 = re.compile(<span class="hljs-string"><span class="hljs-string">r"OO0OOOO00OO0O0O0O = (b('|\").*('|\"))\n"</span></span>) r22 = re.compile(<span class="hljs-string"><span class="hljs-string">r" for i in range\((\d+)\):"</span></span>) r3 = re.compile(<span class="hljs-string"><span class="hljs-string">r".*k = (?P&lt;k&gt;\d+)\ns = (?P&lt;s&gt;\d+)\nc = (?P&lt;c&gt;\d+).*"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">solve1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(code)</span></span></span><span class="hljs-function">:</span></span> reverse = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"&gt;"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> code: reverse = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> code = code.split(<span class="hljs-string"><span class="hljs-string">"while True:"</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>] lst = r1.findall(code)[<span class="hljs-number"><span class="hljs-number">0</span></span>] lst = json.loads(lst) lst.sort(reverse=reverse) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lst <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">solve2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(code)</span></span></span><span class="hljs-function">:</span></span> data = eval((r21.findall(code))[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>]) count = int(r22.findall(code)[<span class="hljs-number"><span class="hljs-number">0</span></span>]) res = md2.solve({<span class="hljs-string"><span class="hljs-string">"string"</span></span>: data, <span class="hljs-string"><span class="hljs-string">"count"</span></span>: count}) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">solve3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(code)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> m <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> r3.finditer(code): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (arifmetic.solve({k: int(v) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> k, v <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> m.groupdict().items()})) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> arifmetic.solve({k: int(v) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> k, v <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> m.groupdict().items()}) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: res = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> code = sock.recv(<span class="hljs-number"><span class="hljs-number">102400</span></span>) code = code.decode() code = <span class="hljs-string"><span class="hljs-string">"\n"</span></span>.join(code.split(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>)[:<span class="hljs-number"><span class="hljs-number">-2</span></span>]) code = code.replace(<span class="hljs-string"><span class="hljs-string">"sleep(0.1)"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"gone wrong"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> code: print(code) exit(<span class="hljs-number"><span class="hljs-number">0</span></span>) start = time() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"shuffle"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> code: res = solve1(code) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> <span class="hljs-string"><span class="hljs-string">"OO0OOOO00OO0O0O0O"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> code: res = solve2(code) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> <span class="hljs-string"><span class="hljs-string">"mas.append"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> code: res = solve3(code) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: print(<span class="hljs-string"><span class="hljs-string">"EXECING"</span></span>) print(code) exec(code) print(sock.recv(<span class="hljs-number"><span class="hljs-number">102400</span></span>)) print(sock.recv(<span class="hljs-number"><span class="hljs-number">102400</span></span>)) print(sock.recv(<span class="hljs-number"><span class="hljs-number">102400</span></span>)) print(sock.recv(<span class="hljs-number"><span class="hljs-number">102400</span></span>)) exit(<span class="hljs-number"><span class="hljs-number">0</span></span>) print(time()-start) code = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> res = str(res).encode() <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: sock.send(res + <span class="hljs-string"><span class="hljs-string">b"\n"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception: print(sock.recv(<span class="hljs-number"><span class="hljs-number">102400</span></span>)) print(sock.recv(<span class="hljs-number"><span class="hljs-number">102400</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span></code> </pre> </div></div><br><p>  As a result, we get the long-awaited flag! </p><br><p><img src="https://habrastorage.org/files/f46/6ef/b4b/f466efb4be55421e8fba66e1f2cd0798.png" alt="image"></p><br><p>  <strong>Answer:</strong> <em>ctfzone {YouRealyHaveSoMuchTime?}</em> </p><br><p>  By the way, according to your numerous requests, we posted offline tasks - now you can play around with raitaps <a href="https://ctf.bi.zone/files/">on this portal</a> .  But do not forget about our <a href="https://tasks.bi.zone/">hiring tasks</a> , they will be available for another 10 days until <a href="https://tasks.bi.zone/">December 15th</a> - there is still time! </p><br><p>  If you have any questions - leave comments and write to <a href="https://telegram.me/joinchat/Aj-l2UC2XdOvF_ogMsQE0w">our chat in Telegram</a> .  Nothing is as inspiring as your activity :) </p><br><p>  All good and good luck! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/316846/">https://habr.com/ru/post/316846/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../316834/index.html">Tips for Indie Developers: The Dark Triad and Five Tips with Top ROI</a></li>
<li><a href="../316836/index.html">How not to use the Repository pattern</a></li>
<li><a href="../316838/index.html">Bot for telegram with status in DBMS and text classification</a></li>
<li><a href="../316840/index.html">How to gently get into the guts of WebRTC when transmitting voice and video</a></li>
<li><a href="../316844/index.html">JetBrains tools are half cheaper for companies</a></li>
<li><a href="../316848/index.html">10 unique Internet entrepreneurs of Russia</a></li>
<li><a href="../316850/index.html">Veeam Availability Suite 9.5 - about updates to Veeam ONE, as well as free NFR keys</a></li>
<li><a href="../316854/index.html">"Performance is a feature." Interview with Marco Cecconi, Stack Overflow</a></li>
<li><a href="../316856/index.html">FIAS addresses in the PostgreSQL environment. Part 4. EPILOGUE</a></li>
<li><a href="../316858/index.html">Testing UWP applications using Appium</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>