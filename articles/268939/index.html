<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cybercriminals use Win32 / Brolux.A banking trojan to compromise users in Japan</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, our analysts discovered a malicious campaign in which the Win32 / Brolux.A banking Trojan was used. The campaign was targeted at Japanese In...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cybercriminals use Win32 / Brolux.A banking trojan to compromise users in Japan</h1><div class="post__text post__text-html js-mediator-article">  Recently, our analysts discovered a malicious campaign in which the Win32 / Brolux.A banking Trojan was used.  The campaign was targeted at Japanese Internet banking users, and its goal was to spread this malware.  The attackers resorted to using exploits for two vulnerabilities.  The first vulnerability relates to the Flash Player software, an exploit for which was in the leaked data of the Hacking Team, and so on.  unicorn bug, which is a vulnerability in the Internet Explorer web browser, which was discovered at the end of 2014. <br><br><img src="https://habrastorage.org/files/43a/512/9ae/43a5129aee1649e790afb80e5433833b.jpeg"><br><br>  Both of these exploits are still distributed through an adult website and attempt to install a digitally signed executable malware file.  The malware itself specializes in stealing the victim's personal data and online banking data.  This distribution mechanism reminds us of another banking Trojan that was also targeted at Japanese banks and financial institutions.  It was called <a href="http://habrahabr.ru/company/eset/blog/230833/">Win32 / Aibatook</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  When a user visits a maliciously crafted adult website, the system will execute an exploit for either a vulnerability in Internet Explorer (CVE-2014-6332) or a vulnerability in Flash Player (CVE-2015-5119).  The experimental PoC code for the first vulnerability has been publicly available for some time.  For use in their malicious campaign, attackers subjected it to modifications.  A working exploit for the Flash Player vulnerability was made publicly available after <a href="http://habrahabr.ru/company/eset/blog/261887/">a</a> data <a href="http://habrahabr.ru/company/eset/blog/261887/">leak</a> from the Hacking Team cyber group. <br><br>  Although the above vulnerabilities have already been included by the authors of exploit kits in their cybercrime creations, we do not have information that exploit kits were used in this malicious campaign.  Unlike the exploits used in the kits, no obfuscation is provided for exploits from this campaign.  As you can see in the screenshot below, a malicious adult website is trying to compromise visitors, while downloading videos from another, real site. <br><br><img src="https://habrastorage.org/files/2f5/69a/e0b/2f569ae0b9a641f4ac2d0fe73584dabb.png"><br><br>  The malware payload code uses two configuration files.  The first one contains a list of 88 URLs of Japanese websites for working with online banking, which are targeted by the Trojan, and the second one contains the names of the corresponding web browser windows.  Win32 / Brolux.A is a simple Trojan that tracks visits to users of online banking websites.  It supports the compromise of web browsers such as Internet Explorer, Firefox, and Google Chrome. <br><br>  When a user visits a website using Internet Explorer, the malware gets the current URL and compares it with a list from the configuration file.  In the case of Chrome and Firefox, the malware's code will compare the web browser window title with the list from the second configuration file.  In case of coincidence, the malware will create a new web browser process that will display a phishing web page.  This web page contains a special form that asks the user for information to log in to the online banking account, as well as answers to secret questions to log in to the account.  The attackers are trying to disguise the web page as a trusted agency in Japan.  This institution is either a procurator (Public Prosecutors Office) or a Financial Services Agency.  The URL uses the link to both of these institutions, and the content of the web page only on the FSA. <br><br><img src="https://habrastorage.org/files/1c5/f49/60a/1c5f4960a6a14f65b4c842c0c2112963.png"><br><br>  The above web page contains the following suggestions: <br><ul><li>  Please note the possible fraud associated with online banking! </li><li>  The following security measures should be used by the client: </li><li>  To protect the important personal information of the client, the financial services agency specializes in providing services to the bank to enhance its protection. </li><li>  Each bank will be obliged to provide its customers with updated bank cards, as well as information necessary for customer identification. </li></ul><br><img src="https://habrastorage.org/files/0f9/ac5/637/0f9ac5637c0449fcb0e20a05c94615d0.png"><br><br>  This web page contains the following sentences: <br><ul><li>  Please note the possible fraud associated with online banking! </li><li>  For every bank, there are those authentication cases where secret answers to questions are not required. </li><li>  If you are notified that you do not need to enter a secret phrase, simply click ‚ÄúNext‚Äù to go to the next field. </li></ul><br><img src="https://habrastorage.org/files/68c/5ed/7fc/68c5ed7fca9e4dde9107c95a67270606.png"><br><br>  The user is required to enter the following information in the form fields: <br><ul><li>  Personal information: <br><ul><li>  Registration number </li><li>  Secret phrase </li><li>  E-mail address </li><li>  Email account password </li><li>  Second pin </li></ul></li><li>  We do not use the personal information of the user's credit card or his other personal information, which is determined by the document on the protection of personal data, 2004 Financial Services Agency Notification No.  67, for those purposes that differ from those stated, as indicated by the Banking Act (Ordinance for Enforcement of the Banking Act). </li></ul><br>  It is interesting to note that both the Public Prosecutors Office and the FSA both published security notices about this type of fraud. <br><br>  The Win32 / Brolux.A sample we analyzed creates a mutex with a Chinese name, it is also signed with the digital certificate indicated below.  In addition, the phishing web page itself contains syntax errors and is not completely written in Japanese: two fields on the third web page (see the screenshot above) are written in Chinese. <br><br><img src="https://habrastorage.org/files/606/e2c/de3/606e2cde31aa437ebb69f39311b46109.png"><br><br>  It is interesting to note that this certificate, which was issued to a Chinese company, was used in the past to sign various potentially unwanted applications (PUA).  Analyzing various samples of malicious programs that have come hand in hand with us, we found that the principle of operation of another banking Trojan called Venik is very similar to Win32 / Brolux.  Venik specializes in modifying the hosts file in the victim's OS to redirect users from legitimate online banking sites to phishing web pages. <br><br>  Despite the fact that the Win32 / Brolux malware uses simple tricks in its work, it is another reminder for users that the necessary precautions should be taken when working with online banking.  First, Win32 / Brolux uses outdated exploits for its distribution, so users should always be aware of the timely update of their operating system.  Users should also track the appearance of additional or strange web forms on the online banking page. <br><br><img src="https://habrastorage.org/files/d9c/565/ce3/d9c565ce311c4c34a50115f4aa4e9925.png"></div><p>Source: <a href="https://habr.com/ru/post/268939/">https://habr.com/ru/post/268939/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../268925/index.html">From participating in the hackathon to winning the Imagine Cup</a></li>
<li><a href="../268929/index.html">Event-oriented Python backtesting step by step. Part 4</a></li>
<li><a href="../268931/index.html">5 internships for programmers abroad</a></li>
<li><a href="../268933/index.html">Megahakaton IoT Russia from Intel and Microsoft</a></li>
<li><a href="../268935/index.html">Programming Philosophy 10 - AI</a></li>
<li><a href="../268941/index.html">Mail Productivity: How Evernote was created for Outlook</a></li>
<li><a href="../268945/index.html">The program of the second international conference of mobile developers MBLTdev is published.</a></li>
<li><a href="../268947/index.html">A multi-line textarea placeholder that works in Firefox</a></li>
<li><a href="../268949/index.html">PostgreSQL Evangelist Memo: criticize MySQL correctly</a></li>
<li><a href="../268951/index.html">Git is enough to be (less) dangerous</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>