<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We write a simple file parser (for beginners)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I would like to tell you how to write a simple parser using the example of aimp.ru and geekbrains.ru sites. The article is intended st...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We write a simple file parser (for beginners)</h1><div class="post__text post__text-html js-mediator-article">  In this article I would like to tell you how to write a simple parser using the example of aimp.ru and geekbrains.ru sites.  The article is intended strictly for those who already have a basic knowledge of the C # programming language and have already written their first "Hello world". <br><br>  I always liked the Aimp audio player (no, this is not an advertisement), but it has too few built-in skins, and there was no desire to go to the site, watch skins, download and try how they would look.  So I decided to write a skin parser from this site.  Having looked at the site a bit, I noticed that the skins are stored there sequentially with the assigned id.  Since  until recently, I only knew 1C and a bit of command line, without thinking twice, I decided to write it on the command line.  But when testing, I found out that if you download a large number of files, firstly, the part may simply not be downloaded, and secondly, there may be an overflow of RAM.  In the end, I then threw this venture. <br><br>  Having started studying C # not long ago, I decided to return to this idea in order to practice a bit.  What came out of this read under the cut. <br><a name="habracut"></a><br>  For development we need only a development environment, I used <a href="https://www.visualstudio.com/">Visual Studio</a> , you can use any other to your taste. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>I will not delve into the basic concepts of C #, for this a lot of different books have been written and countless clips have been shot.</i> <br><br>  First of all, let's start Visual Studio and create a console application (since <s>I am too lazy to make forms,</s> we do not need an interface).  The development environment itself will prepare a project template.  We will have something like this: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">ConsoleApplication2</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { } } }</code> </pre> <br>  Remove the directives that we will not use now: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks;</code> </pre><br>  And we add those directives that we will use: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Diagnostics; <span class="hljs-comment"><span class="hljs-comment">// ,     using System.Net; // ,    Web using System.Threading; // ,   </span></span></code> </pre><br>  Then in the <i>Main</i> method we declare a variable: <br><br><pre> <code class="cs hljs">WebClient wc = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebClient(); <span class="hljs-comment"><span class="hljs-comment">//       Web</span></span></code> </pre><br><h3>  Parsim aimp skins </h3><br>  Next, we write the function itself: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DownloadSkinsForAimp</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WebClient wc</span></span></span><span class="hljs-function">)</span></span> { Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Downloading began"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt;= <span class="hljs-number"><span class="hljs-number">5</span></span>; i++) { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> id = <span class="hljs-string"><span class="hljs-string">"79"</span></span> + i; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> name = GetNameOfSkin(wc, id); <span class="hljs-comment"><span class="hljs-comment">// ,     string path = "aimp.ru/index.php?do=download&amp;sub=catalog&amp;id=" + id; try { //             Process.Start("chrome.exe", path); Console.WriteLine("Download " + name + " is succesfull!"); //  5 ,    ,      Thread.Sleep(5000); } catch { Console.WriteLine("Download" + name + "failed"); } } } catch { return "\nSomething went is wrong"; } return "\nDownloading complete"; }</span></span></code> </pre><br>  <u>All skins are downloaded to the directory specified in the browser settings.</u>  We need <i>try / catch</i> constructs so that the program does not ‚Äúfall out‚Äù due to errors.  Although it was possible to do without them. <br><br>  You may have noticed the <i>GetNameOfSkin</i> function.  It is needed in order to get the name of the skin that we download.  You can do without it, it is needed only for beauty, but since we only learn, we will write it too: <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetNameOfSkin</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WebClient wc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//    html  string html = wc.DownloadString("http://www.aimp.ru/index.php?do=catalog&amp;rec_id=" + id); //        id      //     5    id string rightPartOfHtml = html.Substring(html.IndexOf(id) + 5); //         string name = rightPartOfHtml.Substring(0, rightPartOfHtml.IndexOf("&lt;")).Replace(" ", "_"); //         return name; }</span></span></code> </pre><br>  Then in the <i>Main</i> method you need to call download for execution: <br><br><pre> <code class="cs hljs">Console.WriteLine(DownloadSkinsForAimp(wc)); <span class="hljs-comment"><span class="hljs-comment">//     ,  //       </span></span></code> </pre><br><h3>  Parsim Geekbrains certificates </h3><br>  Certificates on the site are stored in clear form, and opening them through the site as aimp skins, we can download them only manually by clicking the download button.  But this is not the case, we are programmers. <br><br>  This is where the <i>WebClient</i> class comes to our rescue, namely its <i>DownloadFile</i> method.  We just give him the path to download and save path and he does everything for us.  It sounds easy, try to do: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DownloadCertificates</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WebClient wc</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   ,      string currentUser = Environment.UserName; Console.WriteLine("Downloading began"); try { for (int i = 0; i &lt;= 5; i++) { try { //         '.pdf' wc.DownloadFile("https://geekbrains.ru//certificates//7075" + i + ".pdf", "c:\\users\\" + currentUser + "\\downloads\\7075" + i + ".pdf"); Console.WriteLine("Download certificate ‚Ññ7075" + i + " is succesfull"); } catch { Console.WriteLine("Download certificate ‚Ññ7075" + i + " is failed"); } } } catch { return "\nSomething went is wrong"; } return "\nDownloading certificates are complite!"; }</span></span></code> </pre><br>  And after that, just call this function from the <i>Main</i> method. <br><br>  In general, both of these functions still have to be improved, but I think they are quite suitable for familiarization and the most basic functions of parsing.  To whom laziness to collect all this in one project - here the <a href="https://github.com/Diamed/parser">link to GitHub</a> . <br><br>  Thank you for your attention and I hope this will help someone. <br><br>  PS: Certificates with geekbrains you can download and <s>change the owner's name and surname to his</s> admire them. <br><br>  PPS: All skins downloaded from the Aimp website are stored in the '.zip' format and, if desired, the function can be further developed so that it unarchives them.  You can also add that they are immediately transferred to the folder with Aimp skins. <br><br>  PPPS: The article is informative only and does not carry an advertising character. </div><p>Source: <a href="https://habr.com/ru/post/282119/">https://habr.com/ru/post/282119/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../282107/index.html">As I looked all ...</a></li>
<li><a href="../282111/index.html">ONLYOFFICE 8.8.0: mail and calendar integration, the right to review and other updates</a></li>
<li><a href="../282113/index.html">Emoji ?! No, I have not heard</a></li>
<li><a href="../282115/index.html">Essay tool: from idea to monetization</a></li>
<li><a href="../282117/index.html">Free Practical Courses on Basic JavaScript Programming</a></li>
<li><a href="../282121/index.html">The new cryptographer CryptoBit is distributed through exploit kits that affect the browser.</a></li>
<li><a href="../282123/index.html">Manage database structure without pain</a></li>
<li><a href="../282125/index.html">How I tried Microsoft Project Oxford + Telegram Bot API</a></li>
<li><a href="../282127/index.html">Striving for nil: how the prices for mobile communications have changed in a quarter of a century</a></li>
<li><a href="../282129/index.html">Work with geofences (geofences) in Android. Update</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>