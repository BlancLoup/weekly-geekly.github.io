<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Guide: Pyramid for People - part 3</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part 2: concept, installation and simple ‚Äúhello world‚Äù application 

 Step 02: unit and functional testing 
 Of course, testing helps ensure future qu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Guide: Pyramid for People - part 3</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://habrahabr.ru/blogs/python/136222/">Part 2: concept, installation and simple ‚Äúhello world‚Äù application</a> <br><br><a name="uandftesting"></a><h5>  Step 02: unit and functional testing </h5><br>  Of course, testing helps ensure future quality and facilitates refactoring.  And this, of course, makes development faster, especially when using smart editors and <a href="http://ru.wikipedia.org/wiki/%25D0%2598%25D0%25BD%25D1%2582%25D0%25B5%25D0%25B3%25D1%2580%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2581%25D1%2580%25D0%25B5%25D0%25B4%25D0%25B0_%25D1%2580%25D0%25B0%25D0%25B7%25D1%2580%25D0%25B0%25D0%25B1%25D0%25BE%25D1%2582%25D0%25BA%25D0%25B8">IDEs</a> .  Restarting your application and clicking on your browser is a drag. <br><br>  In this step, the same code is used as in step one, but we will add some tests. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Goals </h5><ul><li>  Cover code with unit tests </li><li>  Create functional response tests </li></ul><h5>  Technical requirements </h5><ul><li>  Write a unit test in Pyramid style </li><li>  Use WebTest to include a function test in the test module. </li><li>  Use the nose and nosetests viewer to run tests. </li></ul><h5>  Steps </h5><br> <code>$ cd ../../creatingux; mkdir step02; cd step02</code> <br>  Create a directory in the right place. <br>  Copy the following into the newly created file <code>step02/application.py</code> : <br><blockquote>  <font color="#008000"><strong>from</strong></font> <font color="#0000FF"><strong>wsgiref.simple_server</strong></font> <font color="#008000"><strong>import</strong></font> make_server <br><br>  <font color="#008000"><strong>from</strong></font> <font color="#0000FF"><strong>pyramid.config</strong></font> <font color="#008000"><strong>import</strong></font> Configurator <br>  <font color="#008000"><strong>from</strong></font> <font color="#0000FF"><strong>pyramid.response</strong></font> <font color="#008000"><strong>import</strong></font> Response <br><br>  <font color="#008000"><strong>def</strong></font> <font color="#0000FF">hello_world</font> (request): <br>  <font color="#008000"><strong>return</strong></font> response ( <font color="#BA2121">'hello!'</font> ) <br><br>  <font color="#008000"><strong>def</strong></font> <font color="#0000FF">main</font> (): <br>  config <font color="#666666">=</font> Configurator () <br>  config <font color="#666666">.</font>  add_view (hello_world) <br>  app <font color="#666666">=</font> config <font color="#666666">.</font>  make_wsgi_app () <br>  <font color="#008000"><strong>return</strong></font> app <br><br>  <font color="#008000"><strong>if</strong></font> __name__ <font color="#666666">==</font> <font color="#BA2121">'__main__'</font> : <br>  app <font color="#666666">=</font> main () <br>  server <font color="#666666">=</font> make_server ( <font color="#BA2121">'0.0.0.0'</font> , <font color="#666666">8080</font> , app) <br>  server <font color="#666666">.</font>  serve_forever () <br></blockquote>  This is the same code that we saw in step one. <br>  Copy the following in <code>step02/tests.py</code> : <br><blockquote>  <font color="#008000"><strong>import</strong></font> <font color="#0000FF"><strong>unittest</strong></font> <br><br>  <font color="#008000"><strong>class</strong></font> <font color="#0000FF"><strong>ProjectorViewsUnitTests</strong></font> (unittest <font color="#666666">.</font> TestCase): <br>  <font color="#008000"><strong>def</strong></font> <font color="#0000FF">test_hello_world</font> ( <font color="#008000">self</font> ): <br>  <font color="#008000"><strong>from</strong></font> <font color="#0000FF"><strong>application</strong></font> <font color="#008000"><strong>import</strong></font> hello_world <br>  result <font color="#666666">=</font> hello_world ({}) <br>  <font color="#008000">self</font> <font color="#666666">.</font>  assertEqual (result <font color="#666666">.</font> body, <font color="#BA2121">'hello!'</font> ) <br><br>  <font color="#008000"><strong>class</strong></font> <font color="#0000FF"><strong>ProjectorFunctionalTests</strong></font> (unittest <font color="#666666">.</font> TestCase): <br>  <font color="#008000"><strong>def</strong></font> <font color="#0000FF">setUp</font> ( <font color="#008000">self</font> ): <br>  <font color="#008000"><strong>from</strong></font> <font color="#0000FF"><strong>application</strong></font> <font color="#008000"><strong>import</strong></font> main <br>  app <font color="#666666">=</font> main () <br>  <font color="#008000"><strong>from</strong></font> <font color="#0000FF"><strong>webtest</strong></font> <font color="#008000"><strong>import</strong></font> TestApp <br>  <font color="#008000">self</font> <font color="#666666">.</font>  testapp <font color="#666666">=</font> TestApp (app) <br><br>  <font color="#008000"><strong>def</strong></font> <font color="#0000FF">test_it</font> ( <font color="#008000">self</font> ): <br>  res <font color="#666666">=</font> <font color="#008000">self</font> <font color="#666666">.</font>  testapp <font color="#666666">.</font>  get ( <font color="#BA2121">'/'</font> , status <font color="#666666">= 200</font> ) <br>  <font color="#008000">self</font> <font color="#666666">.</font>  failUnless ( <font color="#BA2121">'hello'</font> <font color="#AA22FF"><strong>in</strong></font> res <font color="#666666">.</font> body) <br></blockquote> <code>$ nosetests</code> <br>  After that we should see the following result: <br> <code>.. <br> -------------------------------------------------------- <br> Ran 2 tests in 0.301s <br> <br> OK</code> <br> <br><h5>  Additional questions </h5><ul><li>  How does nose know what tests are in the tests.py file? </li><li>  Does WebTest run a real HTTP server to send an HTTP request? </li><li>  If your code gives an error, does Pyramid handle it correctly? </li></ul><h5>  Analysis </h5><br>  Unit tests are hard.  Unit tests with the framework are even more difficult.  The Pyramid culture, in spite of this, aims at full test coverage, and Pyramid works very hard to make writing tests a useful activity. <br><br>  Even if you do not do full test coverage, you will find that most basic unit tests catch standard errors faster than opening your browser, for verification, with each code change.  This is a bit like installing your editor, or IDE, to start <a href="http://ru.wikipedia.org/wiki/Python">pylint</a> which allows you to know before saving (much less before executing) whether you have any errors. <br><br>  Functional tests are easier to write, and for UX-people, they help with the problem in question. <br><br><h5>  Theses </h5><ul><li>  Pyramid (and repoze.bfg before it) and loyalty to the test coverage </li><li>  Philosophy of unit testing against functional tests, against doc tests </li><li>  Configuration, registries, and machinery under the surface (both your frameworks and yours!) </li></ul><a name="hwinchameleon"></a><h5>  Step 03: Hello World at Chameleon </h5><br>  Most web systems have a template language for generating HTML.  This gives the UX-person the opportunity to concentrate on the thing they know (the markup) and interspersed in the code, and not vice versa. <br><br>  Pyramid doesn‚Äôt have much to say about languages.  This tutorial does though.  We're Chameleon / ZPT folks.  So let's do ‚Äúhello world‚Äù using the page template. <br><br><h5>  Goals </h5><ul><li>  The easiest possible step to understand the pattern </li></ul><h5>  Technical task </h5><ul><li>  Move the views (views) to a separate module </li><li>  Change application.py to find a module to declare views. </li><li>  Demonstrate the freshness of rendering and data-oriented views, especially for testing. </li><li>  Bring tests to data-oriented views. </li></ul><h5>  Steps </h5><br>  Recall that the installation section <code>$ export PYRAMID_RELOAD_TEMPLATES=1</code> to make <code>$ export PYRAMID_RELOAD_TEMPLATES=1</code> , which allows you to edit templates and not have to reload your Pyramid application. <br> <code>$ cd ../../creatingux; mkdir step03; cd step03</code> <br>  Copy the following to <code>step03/application.py</code> : <br><blockquote>  <font color="#008000"><strong>from</strong></font> <font color="#0000FF"><strong>wsgiref.simple_server</strong></font> <font color="#008000"><strong>import</strong></font> make_server <br><br>  <font color="#008000"><strong>from</strong></font> <font color="#0000FF"><strong>pyramid.config</strong></font> <font color="#008000"><strong>import</strong></font> Configurator <br><br>  <font color="#008000"><strong>def</strong></font> <font color="#0000FF">main</font> (): <br>  config <font color="#666666">=</font> Configurator () <br>  config <font color="#666666">.</font>  scan ( <font color="#BA2121">"views"</font> ) <br>  app <font color="#666666">=</font> config <font color="#666666">.</font>  make_wsgi_app () <br>  <font color="#008000"><strong>return</strong></font> app <br><br>  <font color="#008000"><strong>if</strong></font> __name__ <font color="#666666">==</font> <font color="#BA2121">'__main__'</font> : <br>  app <font color="#666666">=</font> main () <br>  server <font color="#666666">=</font> make_server ( <font color="#BA2121">'0.0.0.0'</font> , <font color="#666666">8080</font> , app) <br>  server <font color="#666666">.</font>  serve_forever () <br></blockquote>  Copy the following into <code>step03/views.py</code> : <br><blockquote>  <font color="#008000"><strong>from</strong></font> <font color="#0000FF"><strong>pyramid.view</strong></font> <font color="#008000"><strong>import</strong></font> view_config <br><br>  <font color="#AA22FF">@view_config</font> (renderer <font color="#666666">=</font> <font color="#BA2121">"hello.pt"</font> ) <br>  <font color="#008000"><strong>def</strong></font> <font color="#0000FF">hello_view</font> (request): <br>  <font color="#008000"><strong>return</strong></font> { <font color="#BA2121">"tutorial"</font> : <font color="#BA2121">"Little Dummy"</font> } <br></blockquote>  And further, the HTML template layout is <code>step03/hello.pt</code> in <code>step03/hello.pt</code> : <br><blockquote>  <font color="#008000"><strong>&lt;html&gt;</strong></font> <br>  <font color="#008000"><strong>&lt;head&gt;</strong></font> <br>  <font color="#008000"><strong>&lt;title&gt;</strong></font> Hello <font color="#008000"><strong>&lt;/ title&gt;</strong></font> <br>  <font color="#008000"><strong>&lt;/ head&gt;</strong></font> <br>  <font color="#008000"><strong>&lt;body&gt;</strong></font> <br>  <font color="#008000"><strong>&lt;p&gt;</strong></font> Hello, $ {tutorial} <font color="#008000"><strong>&lt;/ p&gt;</strong></font> <br>  <font color="#008000"><strong>&lt;/ body&gt;</strong></font> <br>  <font color="#008000"><strong>&lt;/ html&gt;</strong></font> <br></blockquote>  And here it is - <code>step03/tests.py</code> : <br><blockquote>  <font color="#008000"><strong>import</strong></font> <font color="#0000FF"><strong>unittest</strong></font> <br><br>  <font color="#008000"><strong>class</strong></font> <font color="#0000FF"><strong>ProjectorViewsUnitTests</strong></font> (unittest <font color="#666666">.</font> TestCase): <br>  <font color="#008000"><strong>def</strong></font> <font color="#0000FF">test_hello_view</font> ( <font color="#008000">self</font> ): <br>  <font color="#008000"><strong>from</strong></font> <font color="#0000FF"><strong>views</strong></font> <font color="#008000"><strong>import</strong></font> hello_view <br>  result <font color="#666666">=</font> hello_view ({}) <br>  <font color="#008000">self</font> <font color="#666666">.</font>  assertEqual (result [ <font color="#BA2121">'tutorial'</font> ], <font color="#BA2121">'Little Dummy'</font> ) <br><br>  <font color="#008000"><strong>class</strong></font> <font color="#0000FF"><strong>ProjectorFunctionalTests</strong></font> (unittest <font color="#666666">.</font> TestCase): <br>  <font color="#008000"><strong>def</strong></font> <font color="#0000FF">setUp</font> ( <font color="#008000">self</font> ): <br>  <font color="#008000"><strong>from</strong></font> <font color="#0000FF"><strong>application</strong></font> <font color="#008000"><strong>import</strong></font> main <br>  app <font color="#666666">=</font> main () <br>  <font color="#008000"><strong>from</strong></font> <font color="#0000FF"><strong>webtest</strong></font> <font color="#008000"><strong>import</strong></font> TestApp <br>  <font color="#008000">self</font> <font color="#666666">.</font>  testapp <font color="#666666">=</font> TestApp (app) <br><br>  <font color="#008000"><strong>def</strong></font> <font color="#0000FF">test_it</font> ( <font color="#008000">self</font> ): <br>  res <font color="#666666">=</font> <font color="#008000">self</font> <font color="#666666">.</font>  testapp <font color="#666666">.</font>  get ( <font color="#BA2121">'/'</font> , status <font color="#666666">= 200</font> ) <br>  <font color="#008000">self</font> <font color="#666666">.</font>  failUnless ( <font color="#BA2121">'Hello'</font> <font color="#AA22FF"><strong>in</strong></font> res <font color="#666666">.</font> body) <br></blockquote>  And finally, we write: <br> <code>$ nosetests</code> <br>  Following what should see: <br> <code>.. <br> ---------------------------------------------------------------- <br> Ran 2 tests in 0.885s <br> <br> OK</code> <br> <br>  Trying to run: <code>$ python application.py</code> <br>  And open <code>127.0.0.1:8080</code> in your browser. <br><br><h5>  Additional questions </h5><br>  If you are editing a theme, do you need to restart the application to see the changes? <br>  What other values ‚Äã‚Äãare possible for the renderer, on @view_config? <br><br><h5>  Analysis </h5><br>  This step gives an idea of ‚Äã‚Äãcode parsing.  There are several different ways to make configuration in Pyramid: imperative (which we saw in the first step: Hello World in Pyramid), scanning (close to many modern web frameworks), and our old friend ZCML.  The choice is mainly one of the style, though there are some sharp edges in some cases. <br><br>  Note the coolness ... all you have to do is return the dictionary to your submission, and your template is invoked on the way out the door, with this data. <br><br><h5>  Theses </h5><br>  Configuration history in Zope2, Zope3, BFG, then Pyramid <br>  How things worked before renderers <br><br>  Following is <a href="http://habrahabr.ru/blogs/python/136251/">part 4</a> . </div><p>Source: <a href="https://habr.com/ru/post/136245/">https://habr.com/ru/post/136245/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../136238/index.html">Gorgeous Stickers with CSS3</a></li>
<li><a href="../136239/index.html">Fredo & Pid'jin and SOPA</a></li>
<li><a href="../136240/index.html">A look at men's smartphones Motorola RAZR, RAZR MAXX and DROID 4</a></li>
<li><a href="../136241/index.html">Olivetti personal computer m15</a></li>
<li><a href="../136244/index.html">A new version of Regex Tester for Visual Studio 2010 has been released.</a></li>
<li><a href="../136247/index.html">Microsoft collects data from botnet networks to deal with them</a></li>
<li><a href="../136248/index.html">Youtube ratings</a></li>
<li><a href="../136249/index.html">Wikipedia 11 years!</a></li>
<li><a href="../136250/index.html">Inspiration - your internal motor!</a></li>
<li><a href="../136251/index.html">Manual: Pyramid for People - Part 4</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>