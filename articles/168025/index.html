<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mega: security review</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! 
 Being a simple Russian ... no matter by whom, I usually do not write articles, but read them quietly (we, no matter who, love silence). Ho...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mega: security review</h1><div class="post__text post__text-html js-mediator-article">  Good day! <br>  Being a simple Russian ... no matter by whom, I usually do not write articles, but read them quietly (we, no matter who, love silence).  However, recently my attention was attracted by the abundance of English-language articles about the (un) security of the sweet soul of the Mega service.  Since in the Russian-speaking environment the issue is discussed less vigorously, I decided to bring to your attention a small digest of publications about ‚Äúscandalous intrigues and investigations‚Äù that recently turned around around the service uv.  Comrade  Dotcom.  I should warn you right away that this article does not contain the original research, in other words my <i>own</i> opinion on cryptography in Mega, but only seeks to inform the Russian-speaking reader about the state of foreign discussion on this topic. <br><a name="habracut"></a><br>  So, one of the first topics of security Mega raised ArsTechnica, in the publication with the funny name ‚Äú <a href="http://arstechnica.com/business/2013/01/megabad-a-quick-look-at-the-state-of-megas-encryption/">Megabad: A quick look</a> ‚Äù.  Despite the fact that the article failed to avoid a number of absurd journalistic bloopers (most of which have now been corrected and perpetuated only in the comments), the author rightly noted a number of rather large flaws on the Mega side: <br><br><ul><li>  The weakness of the random number generator used by Mega to create an RSA pair (created by Cryptocat, Nadim Kobeissi, has long and evil traversed their generator on Twitter) </li><li>  The overall complexity of the system and some ambivalence of documentation </li><li>  Explicit indication of the presence of deduplication in the TOS ( <i>if you need it). access that original data "</i> ) </li></ul><br>  The importance of the last point should be discussed separately.  The fact is that usually the possibility of ciphertext deduplication is achieved by convergent encryption (a similar approach is used in the Bitcasa service, and also, in a somewhat more complex form, in the distributed file system Tahoe-LAFS).  The essence of this approach is that encryption is implemented so that the same plaintext gives the same ciphertext (sometimes with some reservations).  On the one hand, it can be not bad in its own way, as it allows for deduplication.  But on the other hand, convergent encryption can be quite nice to strike at such precious privacy, since it allows interested parties to find out if there is a duplicate of a file on the service, provided that they themselves already have it in unencrypted form (if you understand what I mean ... ).  And this is not good.  Very bad. <br>  Later, commenting on the article ‚Äú <a href="http://www.forbes.com/sites/andygreenberg/2013/01/21/researchers-warn-megas-new-encrypted-cloud-cant-keep-its-megasecurity-promises/">Researchers Warn: Mega's New Encrypted Cloud</a> in Forbes, co-founder of Mega Bram van der Kolk stated that deduplication occurs at the level of individual files and is possible only in cases when the user <i>‚Äú downloads the same file encrypted with the same key ‚Äù</i> or when importing an existing file using a file manager.  However, user comments on the article quickly began to sound objections due to the fact that both of these scenarios are likely to be very rare, which means that this kind of deduplication is economically inexpedient and hardly worth the effort of writing a special (and, in general, That, uneasy) code. <br>  So the situation with deduplication remains a bit strange. <br><br>  In addition to discussing deduplication, the Forbes article contains some rather sharp comments (in particular, the aforementioned Nadim Kobeissi told Forbes the following: <i>‚ÄúTo be honest, I got the impression that I myself programmed it in 2011, while being drunk‚Äù</i> ).  Of particular note is the point of view of Matthew Green (professor of cryptography at the Johns Hopkins Institute for Information Security), who condemned the entire practice of encryption using only javascript as a whole - <i>‚ÄúVerification of javascript itself is like trying to pull yourself up by your laces.</i>  <i>Nothing will come of it</i> . <i>‚Äù</i>  Interestingly, Green is not the first to talk about the fundamental vulnerability of browser-based javascript cryptography - the thesis about the unreliability of such systems was outlined in 2011 by <a href="http://www.matasano.com/articles/javascript-cryptography/">experts from Matasano Security</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Megu and <a href="https://spideroak.com/blog/20130123130638-spideroaks-analysis-and-recommendations-for-the-crypto-in-kim-dotcoms-mega-part-one">their colleagues from SpiderOak</a> criticized politely but severely, publishing a very interesting article about the peculiarities of the foundations of ‚ÄúMega cryptography‚Äù.  In it, they point to the extreme weakness of the self-made key derivation function applied by the Dotcom team when converting a password into a master key used to further encrypt an asymmetric key (by the way, some have already <a href="http://www.tobtu.com/news.php%3Fn%3D29">concocted a utility for brute-force hashes of Megov passwords</a> that are contained in the registration confirmation link ) and the vulnerability of the authentication procedure to replay attacks. <br><br>  SpiderOak promises to continue to explore the architecture of Mega with the mandatory publication of (probably juicy) results. <br><br>  And finally, sweet, good passers-by from the fail0verflow team <a href="http://fail0verflow.com/blog/2013/megafail.html">found</a> that the validation mechanism of the page components used by Mega (the same mechanism that Matthew Green spoke about the fundamental unreliability) has a frankly textbook error - CBC-MAS is used instead of crypto-resistant hash function .  For those who do not really know a lot about cryptographic perversions, it‚Äôs probably worth explaining that SVS-MAS is an authentication code of a message (and not a hash in the strict sense of the word), and it is harmful for health (users), because it allows The ‚Äústrong‚Äù opponent (for example, the CDN operator) will steal user keys. <br>  Mega responded to the fail0verflow vulnerability found extremely quickly, and are currently using SHA-256 ... However, the presence of such a crude bloop in a service, proud of its "cryptographicity", can not but be disturbed. <br><br>  Well, that's probably all for today. <br><br>  Perhaps in the future I will continue to publish popular science reviews of scadadalo-intrigue and investigations related to the security of various services (not just Mega). <br><br>  [UPD] <br>  In response to the heated discussion, Mega organized a program of financial incentives for ‚Äúresponsible passersby‚Äù, and plans to pay rewards for the bugs found. <br><br>  The reward can claim the bugs that allow <br><ul><li>  remote code execution on the Mega server (including SQL-injection) </li><li>  remote code execution in the client browser (XSS, etc.) </li><li>  compromise the cryptographic security model, manipulate data and keys </li><li>  bypass access control, unauthorized overwriting and destruction of keys and user data </li><li>  jeopardize user data in the event of an account-bound mailbox </li></ul><br>  The reward can reach 10,000 euros. <br><br>  Yummy?  Not really ... <br><br>  There are still limitations, namely: mega will not pay for bugs that require very large computing power (which is reasonable) for use, which are conditionally academic in nature (which is <i>unreasonable</i> , because as commanded by Schneer, <i>‚ÄúAttacks always get better; they never get worse "</i> ), as well as RE / DOS vulnerabilities (which, to put it mildly, is strange, since such attacks are by no means belong to the category of problems that the normal host of the web service would like to know" upon use ") and attacks requiring (indefinitely) a large number of requests to the server. <br><br>  Mega‚Äôs attitude to the problem of insufficient entropy in key generation, which Mega referred to as ‚Äúacademic‚Äù problems, and demanded ‚Äúto show real vulnerability‚Äù (I remind you that <a href="http://eprint.iacr.org/2012/064.pdf">RSA‚Äôs ‚Äúaccidental‚Äù keys)</a> is <a href="http://eprint.iacr.org/2012/064.pdf">alarmingly alarming</a> .  Unfortunately, cryptographic problems cannot be solved by systematic self-suggestion about the ‚Äúlack of real vulnerability‚Äù ... <br><br>  Also, the mega neatly bypassed the question regarding the possible identification of stored ciphertexts (that is, content identification without decryption, by the deduplication mechanism or other architectural features), especially by owners of a copy of the playtext (well, you understand who I am) <br><br>  In general, all this leaves a mixed impression - although the amount of ‚Ç¨ 10,000 cannot be called a little, the conditions of the event leave some unpleasant aftertaste. </div><p>Source: <a href="https://habr.com/ru/post/168025/">https://habr.com/ru/post/168025/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../168009/index.html">New to Windows Server 2012 - Part 2: Storage Systems</a></li>
<li><a href="../168011/index.html">Manage Windows services using PowerShell. Part 3. Configuring Services with WMI and CIM</a></li>
<li><a href="../168013/index.html">Life with a tablet or a list of applications for Android</a></li>
<li><a href="../168015/index.html">CodeIgniter Framework Overview</a></li>
<li><a href="../168017/index.html">One and a half years of life under the sign of IT. As manager manager</a></li>
<li><a href="../168027/index.html">Tweetping - all tweets on the world map live</a></li>
<li><a href="../168029/index.html">Mactracker - encyclopedia of Apple devices</a></li>
<li><a href="../168031/index.html">Tail scaling</a></li>
<li><a href="../168033/index.html">We control the iRobot Roomba robot vacuum cleaner via IR</a></li>
<li><a href="../168035/index.html">Table with backlight for sealing boards</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>