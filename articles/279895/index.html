<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Many-sided GOST R 34.11-94</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I was preparing somehow tests for the system, one of the modules of which, among other things, calculated the value of the hash function for the downl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Many-sided GOST R 34.11-94</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/f72/224/3c4/f722243c420d4ed3bffd85f509302dbd.jpg"><br><br>  I was preparing somehow tests for the system, one of the modules of which, among other things, calculated the value of the hash function for the downloaded file.  The required algorithm was prescribed in the TZ - GOST R 34.11-94.  For the standard, I took the value of the hash counted by the third-party utility <b>Rhash</b> . <br><br> <code>f86c9ecfb6e63726b35ebc79528d013d52b781e06e29d7eb0c9d1cb256efb7c1</code> <br> <br>  Understanding that the function is calculated by the standard library, I sent a request to clear my conscience, which corresponds to loading the file into the module.  But the fate of man is full of surprises.  And you just have to relax, as you see something like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>964ba8755ca782ec3c5e0f98c93347f9b96d9f39cf5c7fdef43a23273fe8868a</code> <br> <br>  Who is not right - the developer of the module or utility? <br><a name="habracut"></a><br>  It turned out neither one nor the other. <br><br>  The fact is that GOST R 34.11-94 implies the use of parameters - the so-called replacement nodes and the starting hash vector.  But does not regulate specific values.  Nevertheless, in the annex to GOST there are examples of these values ‚Äã‚Äãand recommendations: <br><blockquote>  Use only in test cases for this standard. <br></blockquote><br>  After studying the subject area, it turned out that there are two RFCs.  <a href="http://tools.ietf.org/html/rfc4357">RFC 4357</a> , which uses the parameters created by CryptoPro, and <a href="http://tools.ietf.org/html/rfc5831">RFC 5831</a> with the same values ‚Äã‚Äãfrom GOST.  Rhash by default considers a hash as per RFC 5831. The use of CryptoPro parameters must explicitly specify: <br><br> <code>rhash <b>--gost-cryptopro</b> &lt; &gt;</code> <br> <br>  It would seem that the problem is solved.  But to make it even more interesting, the standard does not define the format of the hash output.  And so the question arises with the <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D1%2580%25D1%258F%25D0%25B4%25D0%25BE%25D0%25BA_%25D0%25B1%25D0%25B0%25D0%25B9%25D1%2582%25D0%25BE%25D0%25B2">order of bytes</a> . <br><br><img src="https://habrastorage.org/files/e7b/dfe/739/e7bdfe7396c54cd98f2d306f17110d51.jpg"><br><br>  For the uninitiated, there are two basic ways to present data.  From high byte to low (Big-endian) and vice versa (Little-endian). <br><br>  Consider an example.  For clarity, highlighted bytes. <br><br>  Big-endian byte order: <br><br> <code>rhash --gost-cryptopro <b>--gost-reverse</b> &lt; &gt; <br> 8a86e83f27233af4de7f5ccf399f6db9f94733c9980f5e3cec82a75c75a84b <b>96</b></code> <br> <br>  Little-endian order: <br><br> <code>rhash --gost-cryptopro &lt; &gt; <br> <b>96</b> 4ba8755ca782ec3c5e0f98c93347f9b96d9f39cf5c7fdef43a23273fe8868a</code> <br> <br>  Thus, there is no contradiction - all of the above values, as well as <br><br> <code>rhash --gost --gost-reverse &lt; &gt; <br> c1b7ef56b21c9d0cebd7296ee081b7523d018d5279bc5eb32637e6b6cf9e6cf8</code> <br> <br>  correspond to GOST R 34.11-94. <br><br>  References: <br>  <a href="https://ru.wikipedia.org/wiki/%25D0%2593%25D0%259E%25D0%25A1%25D0%25A2_%25D0%25A0_34.11-94">Wikipedia</a> <br>  <a href="http://gosthash.chat.ru/">Detailed description</a> </div><p>Source: <a href="https://habr.com/ru/post/279895/">https://habr.com/ru/post/279895/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../279883/index.html">#FailOverConf April 8th! Free, without SMS, but with registration</a></li>
<li><a href="../279887/index.html">The first hakkaton, from idea to implementation</a></li>
<li><a href="../279889/index.html">Gestures in design and design</a></li>
<li><a href="../279891/index.html">NetApp ONTAP with Veeam Backup & Replication</a></li>
<li><a href="../279893/index.html">User Authentication for Arduino with RFID</a></li>
<li><a href="../279897/index.html">Moving from Windows to Linux Ubuntu 14.04 LTS with Jetbrains IntelliJ Idea 14.1.5</a></li>
<li><a href="../279903/index.html">Scaling Wix to 100 million users. Start</a></li>
<li><a href="../279905/index.html">Percona Server Upgrade to 5.7 on Ubuntu 14.04</a></li>
<li><a href="../279907/index.html">NetApp ONTAP Cloud: Amazon & Azure</a></li>
<li><a href="../279909/index.html">How to make content recommendations</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>