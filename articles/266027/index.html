<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>#NoHacked: eliminating the effects of hacking with loading URLs containing meaningless text</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habrahabr! Today, as part of the #nohacked campaign, we would like to talk about how to solve the problem of unauthorized introduction of content ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>#NoHacked: eliminating the effects of hacking with loading URLs containing meaningless text</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habrahabr!  Today, as part of the #nohacked campaign, we would like to talk about how to solve the problem of unauthorized introduction of content to the site.  Even if you have not been subjected to such an attack, do not neglect our recommendations - they will help protect your resource from other hacking methods.  Follow the discussion on <a href="http://twitter.com/googlewmc">Twitter</a> and <a href="http://g.co/ruwebmasters">Google+</a> with the hashtag #nohacked (see <a href="https://productforums.google.com/forum/">part 1</a> , <a href="https://productforums.google.com/forum/">part 2</a> , <a href="https://productforums.google.com/forum/">part 3</a> , <a href="https://productforums.google.com/forum/">part 4</a> ). <br><br><img src="https://habrastorage.org/files/2a1/ba8/0cc/2a1ba80cc98d4c44b2d64358cbe6b3e8.png" alt="NoHacked: eliminating the effects of hacking with loading URL"><br><a name="habracut"></a><br>  Hacks are completely different.  Someone just hooligans and ‚Äúdefacesists‚Äù of the site (post provocative or offensive information on it, spoils the layout, turns the site of a large corporation into the world's most expensive fan club My Little Pony).  Often, damages of this type are treated by restoring the last backup and removing all unwanted information, however, without a subsequent security audit of the site, no one is immune from the repetition of such outrage. <br><br>  It is much more dangerous when a website is hacked with data theft, substitution of information, or is carried out with the aim of spreading any malware.  In this case, the most important thing is to protect potential visitors (users or clients) from communication with similar content. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  <font color="#2196F3">Temporary site shutdown for maintenance</font> </h1><br>  The first and main thing that needs to be done is to ‚Äúclose‚Äù the site for repairs.  Here we are guided only by security considerations: in the metro, when repairing an escalator, do they block the entrance to it?  So we close the site temporarily.  Users will not be able to get on the hacked pages, and you can safely work on the restoration of the site. <br><br>  In addition, if the hacking was carried out through one of the ‚Äúholes‚Äù in the working files, if you do not close the site for maintenance, you run the risk of being confronted by hackers again while you eliminate the consequences of hacking. <br><br><h1>  <font color="#2196F3">Site recovery</font> </h1><br>  The simplest recovery is to find the latest backup and deploy it.  Unfortunately, backups in the same way can be rubbed by attackers, or backups can concern only the content part, or ... yes a million or.  In general, if the magic solution in one button "restore" we can not help, you have to do everything yourself. <br><br>  Of course, we all know that before starting work it is worth making a backup of everything that is possible.  But an article can be reposted somewhere else, so reminding will not be superfluous.  Yes, the new (and this time full) backup will contain the hacked content, so you can use it only if you do something wrong during the restoration of the working version and the site breaks completely.  When performing further instructions, be sure to make a copy of each file that you will delete, isn‚Äôt it?  Delete copies always have time. <br><br><h1>  <font color="#2196F3">Step 1: Verify the .htaccess file</font> </h1><br>  One of the most popular ways of hacking: hackers create or change the contents of the <a href="https://ru.wikipedia.org/wiki/.htaccess">.htaccess</a> file to add their own pages or redirect users to a phishing clone site. <br><br>  Check for suspicious lines in the .htaccess file.  If you do not know how to analyze its content, read the relevant materials on <a href="httpd.apache.org/docs/2.0/misc/rewriteguide.html">Apache.org</a> , ask questions in the help forum or consult a specialist.  An example of a .htaccess file modified by hackers: <br><br> <code>&lt;IfModule mod_rewrite.c&gt;</code> <br> <code>RewriteEngine On</code> <br>  <i># Visitors navigating to the Google Search site will be redirected</i> <br> <code>RewriteCond %{HTTP_REFERER} google\.com</code> <br>  <i># Visitors are redirected to the malicious PHP file happypuppy.php</i> <br> <code>RewriteRule (.*pf.*) /happypuppy.php?q=$1 [L]</code> <br> <br><br>  Remove all detected elements of malicious code.  If there is a lot of them in the .htaccess file, it will be easier to create a new .htaccess than repair the existing one.  It may also turn out that it contains a malicious PHP file (we called it happypuppy.php, but often these names use a random combination of two words).  This is important to consider when searching for other malicious files. <br><br><h1>  <font color="#2196F3">Step 2: Search for other malicious files</font> </h1><br>  Most often, hackers work with JavaScript and PHP files.  Two main methods are used: the addition of malicious files and the modification of existing ones.  In the first case, new .php or .js files are added to the server, and their names can be very similar to the standard names, for example, wp-cache.php is disguised as a safe wp_cache.php file.  The second option provides that malicious content is added to files already existing on the server.  For example, if your site has JavaScript templates or plugins, hackers can change their code. <br><br>  Let's look at an example.  A malicious file happypuppy.php, previously found in the .htaccess file, was added to one of the folders on <a href="http://www.example.com/">www.example.com</a> .  In addition, hackers injected a malicious code into a JavaScript file called json2.min.js, which already exists on the server.  In the screenshot below, this code added to the very end of the file is highlighted in red.  As a result, the contents of the file will look like this: <br><br><img src="https://habrastorage.org/files/80b/51b/420/80b51b420b1a49649c9484cfe2b09a34.png" alt="hackers injected malicious code into a javascript file"><br><br>  To effectively detect malicious code, you need to understand how the site uses JavaScript and PHP files.  If you are engaged in the layout, design, content or administration of the portal, but did not look under the hood, you may need to examine the documentation on the content management system. <br><br>  In addition, find and check on the site all the files that have recently been changed, especially if they relate to templates.  The "Application" section lists the tools that will help you detect disguised PHP files. <br><br><h1>  <font color="#2196F3">Step 3: Remove Malicious Content</font> </h1><br>  As mentioned earlier, before deleting or changing any files, you need to create backup copies of the site.  And if you do it regularly, then to fix the problems on the site, it will be enough to restore its archive version, which was preceded by hacking. <br><br>  But even if you are not backing up, other solutions are available to you.  First, remove the malicious content added by the hackers.  For example, on the site <a href="http://www.example.com/">www.example.com</a> this will be the file happypuppy.php.  If the attacker has modified the existing PHP and JavaScript files, such as json2.min.js, download their secure versions.  Try to re-add key plug-in files and content management system to the site, if you use it. <br><br><h1>  <font color="#2196F3">Step 4: Search for vulnerabilities</font> </h1><br>  After deleting the malicious file, you need to find and fix the vulnerability that led to the hacking of the site, otherwise it may be subjected to repeated hacker attacks.  This can be anything from a stolen password to an outdated site software.  Read how to find and fix a vulnerability in our <a href="https://support.google.com/webmasters/answer/3013681">Help Center</a> .  If you cannot understand how the hacking was carried out, change all the passwords, completely update the software on the website and, if possible, contact the specialists. <br><br><h1>  <font color="#2196F3">Next steps</font> </h1><br>  By eliminating problem content, make sure Googlebot no longer sees the hacked pages.  Use the " <a href="https://www.google.com/webmasters/tools/googlebot-fetch%3Fpli%3D1%26hl%3Dru">View as Googlebot</a> " tool for this.  Do not forget to check for hacked content and the main page.  If nothing is found, then you are all right.  If ‚ÄúView as Googlebot‚Äù still finds hacked content, you have a lot of work to do.  You probably missed any malicious PHP or JavaScript file.  Keep searching. <br><br>  Before you start the site again, make sure to eliminate all vulnerabilities and the consequences of hacking.  If <a href="https://support.google.com/webmasters/answer/2604824">manual measures are taken</a> with respect to your resource <a href="https://support.google.com/webmasters/answer/2604824">,</a> log in to your Search Console account and send a <a href="https://support.google.com/webmasters/answer/35843">request for rescanning</a> .  Also consider how to protect your site from new attacks.  Some tips on this topic can be found in our <a href="http://www.google.com/intl/ru/webmasters/hacked/">Help Center</a> . <br><br>  Of course, part of the advice seems fairly obvious, but we are all strong with our back mind, and when confronted with such a thing for the first time, you can also break wood.  We hope that this article will help you eliminate the consequences of unauthorized content injection on the site.  Look for us on social networks using the hashtag #nohacked and do not forget to share your personal experiences and techniques of safe work on the Internet. <br><br>  If you have any questions, you can ask them on the <a href="https://productforums.google.com/forum/">webmaster help forum</a> and in our <a href="http://g.co/ruwebmasters">community on Google+</a> .  And, you can also watch our <a href="https://youtu.be/TCZVpq7yZfQ">security video call on</a> August 27th. <br><br><h1>  <font color="#2196F3">application</font> </h1><br>  There are tools to which Google has no direct relationship, but they may come in handy. <br><br>  For example, utilities for deobfuscating <a href="http://ddecode.com/phpdecoder/">PHP Decoder</a> and <a href="http://www.unphp.net/">UnPHP</a> .  An attacker could distort PHP files to make them harder to analyze.  However, they can be cleaned using the above tools and understand what they are for.  Write <a href="https://plus.google.com/%2BAndreyLipattsev/posts/BMZHaFY9ZYi">here</a> about your favorite service or tool with a description of its work and how it can help in the restoration of the site, and we will add to this list. </div><p>Source: <a href="https://habr.com/ru/post/266027/">https://habr.com/ru/post/266027/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../266017/index.html">Centrifuge + Go = Centrifugo - harder, better, faster, stronger</a></li>
<li><a href="../266019/index.html">The first book of the young programmer. Learning to write programs on Scratch</a></li>
<li><a href="../266021/index.html">Publish DITA to PDF using the DITA Open Toolkit</a></li>
<li><a href="../266023/index.html">Error compensation for floating-point operations</a></li>
<li><a href="../266025/index.html">Working with text data in scikit-learn (translation of documentation) - part 2</a></li>
<li><a href="../266031/index.html">1C: Summer School 2015 - how to organize a "smart" vacation for young programmers - part 3. Protection and distribution of elephants</a></li>
<li><a href="../266033/index.html">Reliable maintenance of MS SQL Server databases for employees</a></li>
<li><a href="../266035/index.html">The course "Basics of effective work with Wolfram technologies". Session 1: Wolfram Mathematica and Wolfram Cloud Review</a></li>
<li><a href="../266037/index.html">Ruby Go shared library connections</a></li>
<li><a href="../266039/index.html">Underground carders market. Translation of the book "KingPIN". Chapter 12. ‚ÄúFree Amex!‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>