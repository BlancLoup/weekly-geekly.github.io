<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Back / Forward Cache - browser caching mechanism</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Since version 1.5, a caching mechanism has appeared in Firefox that preserves the state of the page in memory. Caching is valid for one browser sessio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Back / Forward Cache - browser caching mechanism</h1><div class="post__text post__text-html js-mediator-article">  Since version 1.5, a caching mechanism has appeared in Firefox that preserves the state of the page in memory.  Caching is valid for one browser session.  Navigating through the visited pages using the ‚ÄúBack / Forward‚Äù buttons, there is no need to download the page from the entire server.  At the same time, the entire page, including js-scripts, is ‚Äúpreserved‚Äù in the state in which they were when the user left them.  This mechanism allows you to navigate through the visited pages extremely quickly.  The cache state remains unchanged while the browser session is in effect (until the user closes the bookmark, or the browser). <br><br><h5>  Not "bug", but "feature" </h5><br>  Among other things, the lack of understanding of this mechanism of browsers causes a real headache for developers.  Consider an example. <br>  There is a form whose data we want to send to the server.  We want to somehow visualize this process and run the spinner when submitting the form.  The browser goes to the next page.  If we go back using the browser's back button (or through <i>window.history.back ()</i> ), we most likely see that the spinner rotates, although in fact nothing happens. <br><br>  The developer may consider that this behavior is nothing more than a browser bug or some of its features, and in search of a quick solution, mindlessly insert an extra handler to the unload event (the first item in the list below).  Thus, the developer refuses BFCache in general, thereby depriving its users of the possibility of almost instantaneous movement through the pages visited. <br><a name="habracut"></a><br><h5>  Working conditions </h5><br>  The page caching mechanism does not work if: <br><ul><li>  the page defines handlers for <i>unload</i> and <i>beforeunload events</i> ; </li><li>  for page set <i>ache-control: no-store;</i> </li><li>  The site is under HTTPS and at least one of the following rules is set for the page: <br><ul><li>  <i>Cache-Control: no-cache</i> </li><li>  <i>Pragma: no-cache</i> </li><li>  <i>Expires: 0</i> or ‚ÄúExpires‚Äù is listed in the past relative to the ‚ÄúDate‚Äù header (except when </li><li>  " <i>Cache-Control: max-age =</i> " is also specified) </li></ul></li><li>  page not fully loaded; </li><li>  the page uses the <i>IndexedDB</i> transaction <i>mechanism</i> ; </li><li>  top level page contains frame, iframe (which, by the way, is never cached). </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Events <i>pageshow</i> , <i>pagehide</i> </h5><br>  With the advent of BFCache, along with it, two new events have appeared.  To get closer to them, consider the standard behavior of a web page: <br><ol><li>  The user goes to the page. </li><li>  With loading of the page js-scripts are executed. </li><li>  As soon as the page is loaded, a <i>load</i> event occurs. </li></ol><br>  For some pages, there is a 4th step.  If the page uses handlers for <i>unload</i> , <i>beforeunload</i> , then these events are <i>raised by the</i> browser when the user leaves the page.  In this case, the page is not cached. <br><br>  When the user returns to the cached page, the scripts are not executed again, and the <i>load</i> event also does not occur (steps 2,3), since  In most cases, this work is not needed, and therefore the state of the page remains the same. <br><br>  If you need the ability to run scripts every time a user is on the page, you should use the pageshow event. <br>  Similarly, if you need to take action when the user leaves the page, you should use the pagehide event. <br><br><h6>  Event pageshow </h6><br>  This event is triggered just like the <i>load</i> event, except that it is called every time the user hits the page (and the load event does not occur on the cached page).  When a page is first loaded, the pageshow event occurs immediately after the <i>load</i> event. <br><br>  The pageshow event contains a <b>persisted</b> boolean property that is <i>false</i> when the page is first loaded.  It is set to <i>true</i> if the page has been cached by the browser (that is, if this is not the first page load). <br><br><h6>  <i>Pagehide</i> event </h6><br>  If it is necessary to define behavior for the moment when the user leaves the page, but there is no desire to use the <i>unload</i> event (which will not allow the page to be cached), use the <i>pagehide</i> event. <br><br>  Like pageshow, pagehide contains a <b>persisted</b> boolean property.  Similarly, it is <i>false</i> if the page is not cached, and <i>true</i> otherwise. <br>  If this property is set to <i>false</i> , then the <i>unload</i> handler executes immediately after the <i>pagehide</i> event. <br><br><h5>  Caching despite <i>unload</i> and <i>beforeunload</i> </h5><br>  If there is a situation when you need to use unload events, beforeunload, but at the same time retain the possibility of <i>BFCache</i> , you can simply delete these events in their handler, and reassign them to the pageshow event handler: <br><br><pre><code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'pageshow'</span></span>, PageShowHandler, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'unload'</span></span>, UnloadHandler, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PageShowHandler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'unload'</span></span>, UnloadHandler, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnloadHandler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.removeEventListener(<span class="hljs-string"><span class="hljs-string">'unload'</span></span>, UnloadHandler, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); }</code> </pre> <br><br><h5>  Cross platform </h5><br>  The <i>BFCache</i> mechanism appeared in Firefox 1.5, and has long been actively supported by all modern browsers.  To check browser support, you can use the following approach: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">'onpagehide'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'pagehide'</span></span>, exitFunction, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'unload'</span></span>, exitFunction, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); }</code> </pre><br><br><h6>  Related Links </h6><br>  <a href="https://developer.mozilla.org/en-US/docs/Using_Firefox_1.5_caching">Using Firefox 1.5 caching</a> <br>  <a href="https://developer.mozilla.org/en-US/docs/Working_with_BFCache">Working with BFCache</a> <br></div><p>Source: <a href="https://habr.com/ru/post/225091/">https://habr.com/ru/post/225091/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../225069/index.html">The first Tizen smartphone Samsung Z will appear in Russia in the autumn</a></li>
<li><a href="../225077/index.html">The author of the banker Trojan Zeus is wanted</a></li>
<li><a href="../225079/index.html">How to build WhatsApp for the day. Part 1</a></li>
<li><a href="../225083/index.html">June 5, 2014 - World Day Against Internet Surveillance</a></li>
<li><a href="../225089/index.html">Swift - innovations</a></li>
<li><a href="../225093/index.html">About common sense and company management</a></li>
<li><a href="../225095/index.html">What do neural networks hide?</a></li>
<li><a href="../225097/index.html">Floating password</a></li>
<li><a href="../225099/index.html">How to deploy MS SQL Server 2012 failover cluster on Windows Server 2012R2 for beginners</a></li>
<li><a href="../225101/index.html">My experience developing Android games and a few words about monetization</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>