<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The synapse ensemble is a structural unit of the neural network</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last May, Google‚Äôs deep-learning laboratory staff and scientists from two American universities published the study Intriguing properties of neural ne...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The synapse ensemble is a structural unit of the neural network</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/d2f/bb6/5f1/d2fbb65f1362462aa64998719c22d773.jpg"><br><br>  Last May, Google‚Äôs deep-learning laboratory staff and scientists from two American universities published the study <a href="http://cs.nyu.edu/~zaremba/docs/understanding.pdf">Intriguing properties of neural networks</a> .  The article about him was freely retold <a href="http://geektimes.ru/post/225095/">here on Habr√©</a> , and the study itself was also criticized by a <a href="http://habrahabr.ru/company/abbyy/blog/225349/">specialist from ABBYY</a> . <br><br>  As a result of their research, Google researchers became disillusioned with the ability of neurons in the network to disentangle attributes of the input data and began to think that neural networks did not unravel the semantically significant features by individual structural elements, but stored them throughout the network as a whole as in a hologram.  In the lower part of the illustration to this article in black and white, I led the activation cards of the 29th, 31st and 33rd neurons of the network I taught to draw the picture.  The fact that the carcass of a bird without a head and wings, depicted for example by the 29th neuron, will seem to people to be a semantically significant feature, Google users consider only the interpretation of the observer as a mistake. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the article I will try to show with a real example that disintegrating signs can be detected in artificial neural networks.  I will try to explain why the Google users saw what they saw, and could not see the unraveled signs, and show you where semantically significant signs are hidden on the net.  The article is a popular version of the report, read at the conference " <a href="http://neuroinfo.ru/index.php/ru/schedule/sections%3Fyear%3D2015">Neuroinformatics - 2015</a> " in January of this year.  The science version of the article can be read in the conference materials. <br><a name="habracut"></a><br>  The question is now being actively discussed both among those interested and among professionals.  Evidence to withstand criticism has not yet been able to present until any side. <br><br>  Despite the fact that experimenters with the help of electrodes implanted into the brain in human experiments, were able to detect the so-called ‚Äúneuron Jennifer Aniston‚Äù - a neuron that responds only to the image of the actress.  It was possible to catch both Luke Skywalker's neuron and Elizabeth Taylor's neuron.  With the discovery of " <a href="http://en.wikipedia.org/wiki/Grid_cell">coordinate neurons</a> ", " <a href="https://en.wikipedia.org/wiki/Place_cell">neurons of a place</a> " and " <a href="https://en.wikipedia.org/wiki/Boundary_cell">neurons of borders</a> " in rats and bats, many finally get used to saying "a neuron of such and such a property".  Although the discoverers of the neuron Jennifer Aniston, interpreting the data responsibly, rather say that they have found part of large assemblies of neurons, rather than individual neurons of the signs.  Her neuron reacted to concepts related to it (for example, scenes from the series, in which it is not in the frame), and Luke Skywalker's neuron found in humans also worked on Master Yoda.  In order to completely confuse everyone <a href="http://ethology.ru/news/%3Fid%3D1390">in one study</a> , neurons selectively reacting to a snake could be found in monkeys that snakes had never seen in their lives. <br><br>  In general, the topic of ‚Äú <a href="http://en.wikipedia.org/wiki/Grandmother_cell">Grandmother</a> 's <a href="http://en.wikipedia.org/wiki/Grandmother_cell">Neuron</a> ‚Äù, raised by neurophysiologists in 1967-69, causes considerable excitement to this day. <br><br><h3>  Part One: Data </h3><br>  Most often, the neural network is used for classification.  At the entrance it receives a lot of input noisy images, and at the exit it should successfully classify them by a small number of signs.  For example, is there a cat in the picture or not.  This typical task is inconvenient for searching the network for meaningful features in the input data for a number of reasons.  And the first of them is that there is no possibility to strictly observe the relationship between the semantic feature and the state of some inner element.  In the article from Google and several other studies, a clever trick was used - first, the input data were calculated that would maximize the selected neuron, and then the researcher carefully examined these data, trying to find meaning in them.  But we know that the human brain can skillfully find meaning even where it is not there.  The brain has long evolved in this direction, and the fact that on the Rorschach test, people see something other than ink blots on paper, makes it necessary to be wary of any method of searching for meaning in a picture containing many elements.  Including on my pictures. <br><br>  The method used in this and a number of other studies is also bad because the maximal excitation may not be the normal mode of operation of a neuron.  For example, in the middle picture, where the activation map of the 31st neuron is shown, it can be seen that on the correct input data up to the maximum value it is not excited, and generally when looking at the picture it seems that the meaning is more likely to be areas where it is not active .  To see something present it may be useful to study the behavior of the network in small neighborhoods from its normal operating mode. <br><br>  In addition, a very large network was explored in the Google study.  Unsupervised learning networks contained up to a billion variable parameters, for example.  Even if there is a neuron in the network, it would be very difficult to stumble upon it in large black letters writing out the word ‚Äúexistence‚Äù. <br><br>  Therefore, we will experiment with a completely different task.  First, the experimenter makes a picture.  The network has only two inputs, and two real numbers are fed to them - the coordinates X and Y. And at three outputs R, G and B we will expect a prediction of what color the point should be in the picture in these coordinates.  All values ‚Äã‚Äãare normalized to the segment (-1; 1).  The RMS error for all points of the picture in the amount will be the criterion for the success of learning to draw (in some pictures it is written in the lower left corner, RMSE). <br>  The article uses a non-recurrent network of 37 neurons with hypertangent as a sigmoid and somewhat nonstandard synaptic location.  For training, the method of back propagation of error was used, with the Mini-Batch version of the algorithm, and an additional algorithm, which is a distant relative of the energy-limiting algorithms.  In general, nothing supernatural.  There are more modern algorithms, but most of them are not able to achieve more accurate results on a network of such modest size. <br>  And now fill the image with pixels that are colored the way our network predicts.  A map of the neural network's representations of the beautiful will be obtained, used at the beginning of the article as an image to attract attention.  On the left is the original picture of a flying peacock, and on the right is how the neural network imagined it. <br><br>  The first important conclusion can be made from the first glance at the picture.  It is not very meaningful to hope that the signs of the image are described by neurons.  If only because the picture clearly visible elements of the image is simply more than neurons.  That is, the authors of most studies looking for signs in neurons are not looking there. <br><br><h3>  Part Two: A little bit of reverse engineering </h3><br><img src="https://habrastorage.org/files/bf7/940/5df/bf79405dfd234e5fa19ea2a7a2325fb0.gif" align="right">  Imagine that we were faced with the task: without any training, construct a classifier from neurons that determines where the input point is located - above or below the straight line passing through the point (0,0).  To solve this problem, a single neuron is enough.  The weights of synapses correlate as a straight line slope coefficient and have different signs.  A sign of potential at the exit will give us the answer. <br><br>  Now significantly complicate the task.  We will compare the two values ‚Äã‚Äãin the same way, but now the input values ‚Äã‚Äãwill come in the form of a binary number.  For example, 4-bit.  By the way, not every learning algorithm will cope with such a task.  However, the analytical answer is also obvious.  We manage all the same one neuron.  For the first four synapses, which take the first value, the weights are related as 8: 4: 2: 1, for the second one - the same, but different by -k times.  Spreading the solution of this problem into two separate neurons means complicating the solution of the problem, unless the input value converted from the binary code is necessary somewhere else in the other part of the network.  And what happens: on the one hand, the neuron is one, but, on the other hand, it reveals two completely separate ensembles of synapses representing the processing of different properties of the input data.  Hence the first conclusion: <br><ul><li>  <b>For the presentation of properties in the neural network can respond not to neurons, but groups of synapses.</b> </li><li>  <b>In one neuron, we often see a combination of several signs.</b> </li></ul><br><img src="https://habrastorage.org/files/008/b06/2f9/008b062f9fe44ddfabb17e9ff0a7a7e9.png">  Let's do the third thought experiment.  Suppose we have only one input and we need the neuron to be turned on only on one range of values.  This task cannot be solved on a single neuron with a monotonic activation function.  We need three neurons.  The first one will be activated on the first border and activate the output neuron, the second one will be activated at a higher input value and inhibit the output neuron on the second border. <br><br>  This thought experiment teaches us important new findings: <br><ul><li>  <b>The ensemble of synapses can capture several neurons.</b> </li><li>  <b>If there are several synapses in the system that change a certain boundary with different intensity and at a different moment, the ensemble of synapses, including them both, can be used to control the new ‚Äúgap between borders‚Äù property.</b> </li></ul><br><img src="https://habrastorage.org/files/a5f/679/952/a5f6799527b2455bac104cac5457309a.png" align="right">  Finally put the last fourth thought experiment. <br>  Suppose we need to include the output neuron in two independent and non-overlapping sections.  You can solve the puzzle using 4 neurons.  The first neuron is activated and activates the output.  The second neuron is activated partially and inhibits the output neuron.  At this time, the third is activated, again activating the output neuron.  Finally, the second neuron gains maximum activation and, due to the greater weight of its synapse, retards the output neuron again.  Then the 1st boundary depends almost completely on the first neuron, and the fourth on the last one in the first layer.  However, the position of the second and third frontiers, although it can be changed without affecting other frontiers, but this will have to change the weights of several synapses in concert.  This thought experiment taught us a few more principles. <br><br>  Despite the fact that every synapse in the network of this type affects the processing of the entire signal, only a few of them affect individual properties strongly, ensuring their presentation and modification.  The impact of most synapses is significantly less severe.  If you try to influence a property by changing such ‚Äúweak‚Äù synapses, then those properties that they are strongly involved in managing will change unacceptably much earlier than you notice any changes in the selected attribute. <br><ul><li>  <b>Some synapses are ensembles that can change individual signs.</b>  <b>The ensemble works only within the framework of the environment surrounding other neurons and synapses.</b>  <b>At the same time, the work of the ensemble is almost independent of small changes in the environment.</b> </li></ul><br>  These are the ensembles of synapses, characterized by the described properties, we will look in our network to confirm the possibility of their existence with a real example. <br><h3>  Part Three: Synaptic Ensembles </h3><br>  The small size of the network, given by us in the first part of the article, gives us the opportunity to directly study how the change in the weight of each of the synapses affects the picture generated by the network.  Let's start with the very first synapse, strictly speaking, number 0. This synapse, in proud solitude, is responsible for tilting the bird carcass to the left side, and for nothing else.  No other synapse takes part in the formation of this reference line. <br><br><img src="https://habrastorage.org/files/ad5/48a/ba2/ad548aba22d74e5683fdcc5c5c56bf94.gif"><br><br>  The picture shows a very large change in the weight of the synapse, from -0.8 to +0.3, specifically, so that the change caused is more noticeable.  With such a large change in the weight of the synapse, other properties begin to change.  In reality, the working range of changes in the weight of a given synapse is much smaller. <br><br><img src="https://habrastorage.org/files/6d8/06d/170/6d806d1708bc46a6b230ef803562c2bd.jpg"><br><br>  Looking at the activation map of the neuron to which this synapse leads, one might think that the second synapse of this neuron will also somehow manage the inclination of the first reference line, around which the whole geometry of our birdie is built, but not.  Changes in the weight of the second synapse leads to a change in another property ‚Äî the width of the bird‚Äôs body. <br><br><img src="https://habrastorage.org/files/8a9/c7a/e3b/8a9c7ae3b3be453283d9f43e7f086d6f.gif"><br><br>  It should be noted here that the effect of closely located synapses on a property can often be interpreted as a separate property.  However, this is generally not the case.  For example, look at the map of changes caused by the 418th synapse, which is part of an ensemble that controls the balance of green in the picture. <br><br><img src="https://habrastorage.org/files/4f7/24e/0ee/4f724e0ee22c4bd6ab366514ba2ee216.gif"><br><br>  If we try to move the network along the base, consisting of the 0th and 418th synapses, we will see how the bird leans to the left and becomes less green, but it is hardly possible to consider this as one property.  In their article, Google researchers argued that the natural basis, which excites as much as possible one structural element of the network, seems to have a semantic significance not worse than the basis assembled from a linear combination of such vectors for several elements.  But we see that this is true only when the synapses, along which the greatest change occurs, enter into close synaptic ensembles.  But if the synapses regulate very different properties, then mixing does not help in confusing them. <br><br><img src="https://habrastorage.org/files/2d6/719/3ad/2d67193ad44e46d8954f54a1e220b18e.gif"><br><br>  Now consider some more complex property affecting a small part of the picture.  For example, the size and shape of the areas under the wings, where our peacock has short tail feathers.  We write out all the neurons that directly affect these areas (for example, the left one), namely, they are responsible for changing individual parts of the bird, not its general geometry.  It turns out that the ensemble includes synapses 21,22, 23, 24, 25, 26, 27. <br><br><img src="https://habrastorage.org/files/55b/b04/ccc/55bb04cccedc46198e97e12154b589b3.gif"><br><br>  For example, the 23rd and 24th synapses increase the area chosen by us, in the opposite way affecting the length of the wing.  So, changing them at the same time, you can change the area under the wing, having little effect on the length of the wing.  Just as in the fourth thought experiment we proposed. <br><br><img src="https://habrastorage.org/files/8df/7a2/da6/8df7a2da644846318b63324a9ae5bf61.gif"><br><br>  All these synapses lead to the 6th neuron, and when looking at its activation map, to put it mildly, it is not obvious that it participates in the control of this property.  What speaks in favor of the effectiveness of the visualization method proposed in this article. <br><br><img src="https://habrastorage.org/files/0eb/c4f/efc/0ebc4fefc08149fca96bcc7d2aefd946.jpg"><br><br>  If we look at which synapses affect the size and shape of this area together with other areas, then another couple of dozen 37-46 (8th neuron), 70-83 (11th and 12th neurons), 90-94 (12 and 13th neurons), 129-138 (16th neuron) and a few more, for example, 178th (19th neuron).  In total, about 46 synapses from 460 available on the network are involved in the ensemble.  At the same time, the rest of the synapses can bend almost the entire image, but the selected area is almost unaffected, such as the 28th, even if you twitch for it. <br><br><img src="https://habrastorage.org/files/890/70b/09d/89070b09dee44a219212b72643a60445.gif"><br><br>  So what do we see?  An ensemble of synapses regulating the property we have chosen.  Its effect on other properties of the network, if necessary, is compensated by coordinated changes in the weights of synapses in the ensemble or by using other ensembles.  The synapse ensemble employs at least 7 neurons, this is the fifth part of all neurons in the network and they are also used by many other ensembles. <br><br>  Similarly, you can consider in detail the synapses affecting the color of the areas, or the shape of the flight feathers.  On many other signs present in the image. <br><br><h3>  Part Four: Analyzing the Results </h3><br>  The network elements that encode semantically meaningful signs may be in the network, but these are not neurons, but ensembles of synapses of different sizes. <br><br>  Most neurons are involved in multiple ensembles at once.  Therefore, studying the activation parameters of an individual neuron, we will see a combination of the influence of these ensembles.  On the one hand, this makes it very difficult to determine the role of neurons, and on the other hand, most of the combinations of ensembles will seem to the researcher, if not literally meaningful, then containing obvious signs of meaning. <br><br>  In the study of Googlelots, which was mentioned at the very beginning, of course, it was not stated directly that the structural units of the network do not encode semantically significant features.  Proving non-existence is generally extremely difficult.  Instead, they compared data that activated one random neuron and data activating a linear combination of several randomly selected neurons of one layer.  They showed that the degree of apparent meaningfulness of such data does not differ and interpreted this as an indication that the individual signs are not coded. <br><br>  However, now looking at the material of the article, we understand that one neuron, as well as linear combinations of several close neurons, demonstrate the answer to the data of several ensembles of synapses, and indeed, the content of information does not differ fundamentally.  That is, the observation made in the study is correct, and it could be expected, only its interpretation given in the most general words was in doubt. <br><br>  It also becomes clear why different works on the topic of identifying semantically significant features in the structural elements of the network gave so many different results. <br><br>  In conclusion I want to quite briefly say what I started with.  About the activation maps of the latest neurons in the network, so eloquently looking.  The neural network can approach the function required from it as a sum of functions that effectively approximate individual segments.  But the more data a network successfully learns, the less it can select its structural elements to encode each individual attribute.  The more she is forced to seek and apply qualitative generalizations.  If you need to implement a simple classification with a billion adjustable parameters, each of them is likely to manage the property only on one small area and only along with hundreds of others.  However, if you force the network to learn a picture in which it has a hundred significant properties, and it has only four dozen neurons at its disposal, it either cannot cope or allocates semantically significant features into separate structural units, where they will be easy to detect.  The output neurons of the network are connected with a not very large number of neurons, and to form a picture with so many significant elements, the network had to collect the results of the work of several synapse ensembles on the penultimate neurons.  Neurons 29, 31 and 33 were lucky, they gathered geometric data that is easy to recognize and we immediately paid attention to them.  Neurons 27, 28 or 32 were less fortunate, they gathered information about the location of the color spots in the picture and understand what this cacophony means only the neural network itself can. <br><br><img src="https://habrastorage.org/files/c9a/82d/e84/c9a82de84fdd40a8a586192ef48337bd.jpg"></div><p>Source: <a href="https://habr.com/ru/post/249031/">https://habr.com/ru/post/249031/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../249021/index.html">The evolution of SAAS website designers</a></li>
<li><a href="../249023/index.html">Candelabrum vs Lollipop</a></li>
<li><a href="../249025/index.html">Announcement of the JPoint 2015 Java Conference</a></li>
<li><a href="../249027/index.html">Procedural generation of planetary textures based on the Diamond-Square algorithm, part 1</a></li>
<li><a href="../249029/index.html">Xcode 6 Objective-C Modernization Tool</a></li>
<li><a href="../249037/index.html">Scan and index pages in multiple languages</a></li>
<li><a href="../249039/index.html">How I implemented multilingualism on the site and in the project</a></li>
<li><a href="../249041/index.html">YouTube abandoned Flash in favor of HTML5 by default.</a></li>
<li><a href="../249045/index.html">C # for AS3 developers. Part 4: Abstract Classes and Functions</a></li>
<li><a href="../249047/index.html">Sass-architecture of your project</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>