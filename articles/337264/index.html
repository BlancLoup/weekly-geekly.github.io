<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Poker AI: how to teach algorithms to bluff</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="About how to improve artificial intelligence, you can judge by the usual games. Over the past two decades, the algorithms have surpassed the world's b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Poker AI: how to teach algorithms to bluff</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/web/c4b/8b5/d9f/c4b8b5d9f2574288bb3b0a1ae5f09f31.png" alt="image"></div><br><p>  About how to improve artificial intelligence, you can judge by the usual games.  Over the past two decades, the algorithms have surpassed the world's best players: backgammon first fell and checkers, then chess, Own Game (Jeopardy!), In 2015 - Atari video games and last year - Go. </p><br><p>  All these successes are about games with information symmetry, where players have identical information about the current state of the game.  This property of completeness of information underlies the algorithms that ensure these successes, for example, local search during the game. </p><br><p>  But what about games with incomplete information? </p><br><p>  The most obvious example of such a game is poker.  In order to actually deal with this game and the algorithms for solving this problem, we will organize a hackathon to write game bots based on machine learning.  On how to teach algorithms to bluff and try your hand at poker, without touching the card, under the cut. </p><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Article layout</b> <div class="spoiler_text"><p>  1. <a href="https://habr.com/ru/company/sberbank/blog/337264/">AI in games with incomplete information</a> <br>  - <a href="https://habr.com/ru/company/sberbank/blog/337264/">Challenges in agent programming</a> <br>  - <a href="https://habr.com/ru/company/sberbank/blog/337264/">poker AI</a> <br>  - <a href="https://habr.com/ru/company/sberbank/blog/337264/">Practical value of decisions</a> <br>  2. <a href="https://habr.com/ru/company/sberbank/blog/337264/">Sberbank Holdem Challenge</a> <br>  - <a href="https://habr.com/ru/company/sberbank/blog/337264/">The task of the participants</a> <br>  - <a href="https://habr.com/ru/company/sberbank/blog/337264/">Competition program</a> <br>  3. <a href="https://habr.com/ru/company/sberbank/blog/337264/">Programming strategies</a> <br>  - <a href="https://habr.com/ru/company/sberbank/blog/337264/">An example of a simple bot</a> <br>  - <a href="https://habr.com/ru/company/sberbank/blog/337264/">Analysis of game replays</a> <br>  - <a href="https://habr.com/ru/company/sberbank/blog/337264/">Preparation of the decision for sending</a> <br>  4. <a href="https://habr.com/ru/company/sberbank/blog/337264/">Approaches to creating strategies</a> <br>  - <a href="https://habr.com/ru/company/sberbank/blog/337264/">Classic approaches</a> <br>  - <a href="https://habr.com/ru/company/sberbank/blog/337264/">Machine learning based approaches</a> <br>  5. <a href="https://habr.com/ru/company/sberbank/blog/337264/">Hackathon platform</a> <br>  6. <a href="https://habr.com/ru/company/sberbank/blog/337264/">References</a> </p></div></div><br><h1 id="1-ii-v-igrah-s-nepolnoy-informaciey">  1. AI in games with incomplete information </h1><br><p>  The world is full of tasks related to the interaction between several agents.  Historically, people were the main participants in these multi-agent situations; however, with the development of AI, we had the opportunity to introduce algorithms into our daily life as equal participants and agents with whom we can interact.  Right now, similar computer agents solve many problems: from simple and innocuous as automatic telephone systems, to critical ones like security management and even autonomous transport management.  This allows you to significantly automate many everyday processes, transferring decision-making to algorithms and thereby reducing the burden on people. </p><br><p>  A feature of many tasks where we use computer agents is the large number of real-world constraints affecting the complexity of their programming.  And the most important thing for computer agents is access to all the information necessary for decision making.  Let us examine how this affects the model problems of AI - how our agents play games. </p><br><p>  Games with asymmetry and incompleteness of information require much more complex approaches to decision-making compared to similar-sized games with perfect information, fully accessible at any time.  The optimal solution at any time depends on the knowledge of the strategy of opponents, depending on the information that is hidden to us and available only to them, which can only be assessed by their past actions.  However, their previous actions also depend on the information hidden from them about our actions and how our actions revealed this information.  This recursive process shows the main difficulty in building efficient decision-making algorithms. </p><br><h3 id="slozhnosti-v-programmirovanii-agentov">  Challenges in agent programming </h3><br><p>  By agent we shall mean any autonomous participant in the decision-making process: both a person and a computer.  In a multi-agent environment, agents interact with each other and do not always know the strategies, goals, and capabilities of other agents.  The optimal behavior of an agent that maximizes its outcome in a similar environment depends on the actions of other agents.  To build an effective agent in a multi-agent environment, it is necessary to adapt to the actions of other agents, modeling their strategies and learning from their behavior. </p><br><p><img src="https://habrastorage.org/web/537/be7/b5f/537be7b5f348423a8d98356aa683003c.png" align="right" width="30%">  In order for agents to adapt in real time, they need to choose the optimal actions in the course of achieving their results.  If you use approaches based on training with reinforcements (Reinforcement Learning), agents will accumulate a reward for their actions.  Agents will also balance between following their planned exploitation behavior and exploration experimental actions, trying to learn useful information about the strategies of other players. </p><br><p>  In addition to the already complex task formulation, agents will face other constraints related to working in a multi-agent environment with incomplete information.  We write out the main difficulties that our agents will face: </p><br><ul><li>  Limited number of observations.  As a rule, only a small set of observations will be available for agents.  This is especially critical in real world applications where human agents are not available for a long time. </li><li>  Stochastic observations.  Both the environment of interaction between agents and the agents themselves are often subject to a large number of random factors.  Selecting a useful signal for training and adaptation becomes especially difficult if the behavior of the agent is a random variable, depending on a large number of other random variables. </li><li>  Incompleteness of the observed information.  This is a key feature of the environment in which agents operate.  Agents have access to only a partial and limited review of it, which hides most of the information about the world from agents. </li><li>  Dynamic behavior.  With the passage of time, agents can adapt to each other's behavior, leveling the progress made in the course of training and adaptation.  The environment can also change with the passage of time, provoking agents to new actions, strategies and behavior. </li></ul><br><p>  All these characteristics impose serious difficulties on writing computer agents.  Modeling the behavior of agents, even with one of these difficulties, is a complex knowledge-intensive task, not to mention real-world environments, where engineers and authors of such agents will have to face a complete list of these difficulties.  We talked about the general case of complex environments ‚Äî now let's get to the games. </p><br><h3 id="ii-dlya-pokera">  Poker AI </h3><br><p>  An illustrative example of a complex environment with all the properties described by us is poker.  In it there are also incomplete information about the cards, and strategies of the participating players, and the element of randomness associated with the distribution of cards, and the other difficulties we have arising during the game.  Moreover, the number of possible game states that characterize game situations is enormous.  So huge that only slightly (on a logarithmic scale) is inferior to Guo: in no-limit Hold'em there are <sup>10,160</sup> , while in Guo there are about <sup>10,170</sup> . </p><br><p>  Despite the fact that poker is a gamble, it is recognized as an official sport, and there are national federations of sports poker in almost every country (including Russia).  Today this game has millions of fans around the world, but even when poker was still far from world popularity, it was appreciated not only by players, but also by scientists.  The pioneer of modern game theory, John von Neumann, was so fascinated by this bluffing and betting game that he said: </p><blockquote>  ‚ÄúReal life is all about bluffing, from little tricks of deception, from thinking about what the other person expects from you.  That's what the game is in my theory. ‚Äù  John von neumann </blockquote><br>  The history of the development of AI for the game of poker has more than 30 years, but the most outstanding achievements have occurred literally in the last 3 years. <br><p>  The first programs and algorithms of the poker game appeared in the 1980s, for example, the Orac system from Mike Caro, written by him in 1984 and demonstrated at the Stratosphere tournament.  In 1991, the world's first research group on the development of AI for poker was created at the University of Alberta (Canada).  In 1997, this group demonstrated its Loki system, the first successful and significant implementation of AI for poker.  Loki played at a level slightly worse than the average human player, but this was a significant milestone for the entire research direction.  In the 2000s, there was a shift in the paradigm of writing AI for poker bots.  Researchers moved away from approaches to poker, inspired by the success of Deep Blue in chess (successfully defeating Garry Kasparov in 1996), to a full-fledged methodology and setting simulation problems for poker right away. </p><br><p><img src="https://habrastorage.org/web/bb9/072/681/bb9072681e454f95ac0bff75f3bf317b.jpg" align="right" width="40%">  In 2015, the University of Alberta presented its Cepheus system, which literally ‚Äúdecided‚Äù one of the types of poker - limit heads-up poker (a simplified version, about 10 <sup>18</sup> game situations).  This is a significant milestone in the development of AI, since it is currently the only incomplete information game with a complete optimal solution.  We managed to achieve this by putting Cepheus to play with myself for two months (AlphaGo, who won the world Go champion, also studied in a similar way). </p><br><p>  It is important to note that the system is not perfect in the sense that it can sometimes lose chips in some hands.  However, with a sufficient number of parties, Cepheus will still be the winner.  It is also important to note that the unlimited version of heads-up poker still does not have a similar full solution due to too many game states. </p><br><p>  This year there were just two important events in the world of poker bots.  The University of Alberta introduced the DeepStack algorithm for playing unlimited Heads-Up Poker.  Based on deep neural networks, the algorithm successfully overcame many human rivals, including professional players and, similarly, AlphaGo could ‚Äúlearn‚Äù to imitate human intuition by continuously playing many games with itself. </p><br><img src="https://habrastorage.org/web/d34/b28/7a1/d34b287a1e9147b0aa2af30204d13445.jpg"><br><p>  <em>Broadcast tournament Libratus vs man</em> </p><br><p>  The most significant event of 2017 in the world of poker bots, and possibly the AI ‚Äã‚Äãas a whole.  The Libratus system from Carnegie Mellon University overpowered professional poker players with confidence - a team of the world's best unlimited Heads-Up poker players.  In their assessment, the algorithm was so good that it seemed as if he was flirting and seeing the cards of his rivals.  Matches were played in real time during the 20-day tournament, and the actions of the algorithm were considered on the Pittsburgh supercomputer. </p><br><h3 id="prakticheskaya-cennost-resheniy">  Practical value of decisions </h3><br><p>  Despite the seeming inapplicability of poker bots to real-world problems, their development has brought many methods that can be transferred from practice to the card game.  The algorithms of modern poker bots that overwhelm the best human players are universal and are generally aimed at training agents in environments with incomplete and asymmetric information.  They can be transferred to a variety of applications where decision-making is required in a medium of similar complexity: from security to marketing, in which you can simulate bidding for an audience. </p><br><p>  In the banking sector, too, there are many practical problems, where the algorithms behind the advanced Poker bots would find application.  Among such business objectives of Sberbank, first of all, it is worth mentioning risk-return management and pricing in the market with many other object banks.  But the list of these applications can be easily extended to tasks such as Customer Value Management or Next Best Action. </p><br><h1 id="2-sberbank-holdem-challenge">  2. Sberbank Holdem Challenge </h1><br><img src="https://habrastorage.org/web/e1c/002/4d5/e1c0024d5cd54c6eaa20a6a034b735d4.jpg"><br><p>  <em>Hackathon on writing game bots based on machine learning</em> </p><br><p>  To spur the development of machine learning and artificial intelligence, we organize a unique hackathon, which is preceded by an online competition.  We invite machine learning experts to try their hand at writing game artificial intelligence that can make optimal decisions in the face of uncertainty and simulate the behavior of other players in poker. </p><blockquote>  "Artificial intelligence today should serve not only to develop rational algorithms, but also to simulate the irrational behavior of market participants or, as is the case with our tournament, poker players."  Alexander Vedyakhin, Senior Vice President, Sberbank </blockquote><br><p>  We hope that the achievements of the winners can be applied in the development of Sberbank artificial intelligence.  Nevertheless, even if it may take years before the practical applicability of these developments, such hackathons are important for the development of science on such model problems. </p><br><h3 id="zadacha-uchastnikov">  The task of the participants </h3><br><p><img src="https://habrastorage.org/web/f39/82b/033/f3982b033c2d4c62ac841f11249c87c2.jpg" align="right" width="40%">  The game for which you need to write your poker bot is the most popular type of poker: No-limit Texas Hold'em.  It is also the most complex variety of the game, to the success in which not a single research group approached: not 2, but 9 players participate in it, but the number of game combinations is huge and reaches <sup>10,160</sup> . </p><br><p>  Participants will have to implement an agent who will play poker.  A poker game is a sequential series of hands (rounds), which ends when all the poker chips remain with only one player, or until the limit of the number of rounds is released.  In each game, 9 agents-bot players take part. </p><br><p>  Participant agents will randomly form games and tournaments, which will determine the best strategies.  At the time of the start of the game, each agent is given a time bank, which can be used to make decisions during the tournament.  If the agent goes beyond the time limit or the agent sends a response that does not comply with the data transfer protocol, the simulator performs an automatic reset of cards in each of the hands before the end of the tournament. </p><br><h3 id="programma-sorevnovaniya">  Competition program </h3><br><p>  The competition takes place in 2 stages: an individual qualifying tournament and a team offline hackathon for 100 finalists.  The 100 best participants who will pass the qualifying online stage will be invited to a closed offline hackathon. </p><br><ul><li>  <b>August 30, 12:00</b> <br>  The start of the online stage of the competition on the platform of the competition, the beginning of sending solutions. </li><li>  <b>September 18, 03:00 (term extended from September 15, 23:59)</b> <br>  Closing the online stage, rating the participants and selecting the finalists (top 100). </li><li>  <b>September 23, 10:00</b> <br>  Start of the offline hackathon stage at Sberbank Corporate University. </li><li>  <b>September 24, 16:00.</b> <br>  Final hakaton, summing up, award ceremony winners. </li></ul><br><p>  Qualifying online stage takes place individually.  During the online stage, the competition team provides a test environment for offline hackathons, so that participants learn how to write their poker bots.  Also during the online stage, every midnight on schedule, more than 100 random tournaments are held, each day determining the ranking of bots.  During the offline stage, participants will be able to form teams among themselves, and the rating-determining tournaments will take place between all participants every hour. </p><br><p>  The hackathon is held with the direct participation of the <a href="http://www.sberbankatd.online/">Academy of Technologies and Data</a> of the Sberbank Corporate University, the hackathon final will be held on the <a href="http://www.sberbank-university.ru/ru/campus/">campus of the Corporate University</a> , where the finalists will have to refine their algorithms. </p><br><img src="https://habrastorage.org/web/183/7aa/cf7/1837aacf7bf34ffd88699bde385e5d24.jpg"><br><p>  <em>Campus of the Sberbank Corporate University</em> </p><br><p>  Participants of the offline stage are provided with transfer from Moscow to campus, hotel accommodation, meals, as well as other services and excellent campus facilities.  There will be the final competition and a poker tournament between bots with the participation of professional commentators. </p><br><p>  Unfortunately, only citizens of the Russian Federation can take part in this competition.  Logistics to Moscow also remains on the participants themselves.  In this regard, the places in the offline hackathon of those who will be in the top 100, but for some reason will not be able to come to the offline stage, will be transferred next after them in the list of the rating table. </p><br><p>  The prize fund for the top three winning teams is 600,000 rubles. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/web/766/bc5/b2c/766bc5b2cfcb4275a71a7215ab3365b9.jpg" alt="image"></div><br><h1 id="3-programmirovanie-strategiy">  3. Programming strategies </h1><br><p>  Let's see how you can implement your poker bot and bring it to victory.  For this we need 3 things: </p><br><p>  - A programming language with which we feel confident (there are ready examples in Python and C ++). <br>  - A simulator of poker, within which our bot will work.  The simulator uses the Open-Source <a href="https://github.com/sberbank-ai/holdem-challenge/tree/master/PyPokerEngine">PyPokerEngine</a> library <a href="https://github.com/sberbank-ai/holdem-challenge/tree/master/PyPokerEngine">.</a> <br>  - The code of the bot itself, which performs game actions inside the simulator. </p><br><p>  Let's first deal with the bot to see that it is not so difficult. </p><br><h3 id="primer-prostogo-bota">  An example of a simple bot </h3><br><p>  Let's look at an example of the simplest bot in the Python language, which performs a CALL operation every time, that is, it is always self-confident and only does what equalizes the opponents bet: </p><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pypokerengine.players <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> BasePokerPlayer <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FishPlayer</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(BasePokerPlayer)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">declare_action</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, valid_actions, hole_card, round_state)</span></span></span><span class="hljs-function">:</span></span> call_action_info = valid_actions[<span class="hljs-number"><span class="hljs-number">1</span></span>] action, amount = call_action_info[<span class="hljs-string"><span class="hljs-string">"action"</span></span>], call_action_info[<span class="hljs-string"><span class="hljs-string">"amount"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> action, amount <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">receive_game_start_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, game_info)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">receive_round_start_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, round_count, hole_card, seats)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">receive_street_start_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, street, round_state)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">receive_game_update_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, action, round_state)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">receive_round_result_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, winners, hand_info, round_state)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre> <br><p>  A bot is an object that implements methods of game event handlers and a method for selecting an action at the moment of the declare_action bot move.  More information about the implementation of game strategies can be found in the <a href="">documentation for the library</a> . </p><br><p>  Game strategy development is not only available in the Python language and can be implemented in any other programming language.  For a description of the API and how to create bots, see the <a href="">bot preparation guide</a> . </p><br><p>  Every day at 00:00 MSK a tournament is held between all bots sent to the system.  If a participant has sent several agents, then only his last submitted decision is taken into account. </p><br><p>  During the tournament, each bot plays a series of games with random opponents - bots of other participants.  The results table is constructed by descending the average amount of the remaining chips at the bot on the basis of all the games for the tournament. </p><br><p>  In the tournament game take part exactly 9 bots.  The maximum number of rounds is 50. At the beginning of the game, each bot receives 1500 chips, the size of the small blind is 15. </p><br><p>  This corresponds to the following parameters of the round in PyPokerEngine: </p><br><pre> <code class="python hljs">config = setup_config(max_round=<span class="hljs-number"><span class="hljs-number">50</span></span>, initial_stack=<span class="hljs-number"><span class="hljs-number">1500</span></span>, small_blind_amount=<span class="hljs-number"><span class="hljs-number">15</span></span>)</code> </pre> <br><h3 id="analiz-repleev-igr">  Game Replay Analysis </h3><br><p>  At the end of the tournament, participants will be available archives with a magazine of games of all bots.  Thus, you will be able to analyze the strategy of your opponents, viewing their actions during the game.  However, remember that other participants can also analyze your bot's playing style and arrange an ambush for your next tournament. </p><br><p>  An example of a game replay file: <a href="">example_game_replay.json</a> </p><br><p>  Game replays are recorded as a JSON object with fields: </p><br><p>  <strong>rule</strong> : game options <br>  <strong>seats</strong> : information about bots, in particular, for each bot its name is indicated - this name corresponds to the participant who sent the bot <br>  <strong>rounds</strong> : a list of all rounds indicating the actions performed by bots </p><br><h3 id="podgotovka-resheniya-k-otpravke">  Preparation of the decision for sending </h3><br><p>  A specially prepared docker image is used as the launch environment for bots.  In the testing system, you must send the bot code, packed in a ZIP-archive. </p><br><p>  Sample archives: </p><br><p>  ‚Üí <a href="">example-python-bot.zip</a> <br>  ‚Üí <a href="">example-cpp-bot.zip</a> </p><br><p>  In the root of the archive must be a file metadata.json with the following content: </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"image"</span></span>: <span class="hljs-string"><span class="hljs-string">"sberbank/python"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"entry_point"</span></span>: <span class="hljs-string"><span class="hljs-string">"python bot.py"</span></span> }</code> </pre> <br><p>  Here image is the name of the docker image in which the solution will be launched, entry_point is the command with which the solution should be launched.  For a bot program, the current directory will be the root of the archive, except for the executable file you can put any other auxiliary ones.  Archive size limit - 1GB. </p><br><p>  For almost any programming language, there is a docker environment in which you can run your bot: </p><br><ul><li>  <a href="https://hub.docker.com/r/sberbank/python/">sberbank / python</a> - Python3 with a large set of libraries installed </li><li>  <a href="https://hub.docker.com/_/gcc/">gcc</a> - to run compiled C / C ++ solutions ( <a href="">more here</a> ) </li><li>  <a href="https://hub.docker.com/_/node/">node</a> - to run javascript </li><li>  <a href="https://hub.docker.com/_/openjdk/">openjdk</a> - for java </li><li>  <a href="https://hub.docker.com/_/mono/">mono</a> - for C # </li><li>  Any other image available for download from <a href="http://dockerhub.com/">DockerHub will also work.</a> </li></ul><br><p>  The executable command is exchanged with the game simulator via stdin / stdout.  The simulator sends one event in the stdin line, in the format <code>event_type&lt;\t&gt;data</code> , where <code>data</code> is a JSON object with event parameters.  <a href="https://github.com/sberbank-ai/holdem-challenge/blob/master/simulator_stdin_example.jsonlines">An example of the input</a> that the simulator provides to stdin.  <a href="">Description of events and their parameters</a> . </p><br><p>  In response to the <code>declare_action</code> event <code>declare_action</code> bot should respond to stdout with a line in the allotted time format: </p><br><pre> <code class="hljs xml">action<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">\t</span></span></span><span class="hljs-tag">&gt;</span></span>amount</code> </pre> <br><p>  Here <code>action</code> is one of the actions available to the player (fold, call, raise), amount is the number of chips for a raise, 0 in other cases. </p><br><p>  In the case of using buffered I / O, remember to <code>flush()</code> buffer ( <code>flush()</code> ) after writing the action to stdout.  Otherwise, the simulator may not receive a message and the bot will have a time limit. </p><br><p>  Development of a bot in Python is most conveniently done using the PyPokerEngine library as shown in the example above.  It is recommended to run it in the <strong><a href="https://hub.docker.com/r/sberbank/python/">sberbank / python</a></strong> docker environment, in which Python 3 is installed, as well as a large set of libraries, including PyPokerEngine directly and the data scientist‚Äôs gentlemen‚Äôs set: numpy, scipy, pandas, sklearn, tensorflow, keras.  A complete list of installed python packages can be found <a href="https://github.com/sberbank-ai/holdem-challenge/blob/master/images/python/conda_list.txt">in this file</a> . </p><br><p>  The full code of the example of the poker bot in python is available below. </p><br><div class="spoiler">  <b class="spoiler_title">bot.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> json <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pypokerengine.players <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> BasePokerPlayer <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyPlayer</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(BasePokerPlayer)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># Do not forget to make parent class as "BasePokerPlayer" # we define the logic to make an action through this method. (so this method would be the core of your AI) def declare_action(self, valid_actions, hole_card, round_state): # valid_actions format =&gt; [raise_action_info, call_action_info, fold_action_info] call_action_info = valid_actions[1] action, amount = call_action_info["action"], call_action_info["amount"] return action, amount # action returned here is sent to the poker engine def receive_game_start_message(self, game_info): pass def receive_round_start_message(self, round_count, hole_card, seats): pass def receive_street_start_message(self, street, round_state): pass def receive_game_update_message(self, action, round_state): pass def receive_round_result_message(self, winners, hand_info, round_state): pass if __name__ == '__main__': player = MyPlayer() while True: line = sys.stdin.readline().rstrip() if not line: break event_type, data = line.split('\t', 1) data = json.loads(data) if event_type == 'declare_action': action, amount = player.declare_action(data['valid_actions'], data['hole_card'], data['round_state']) sys.stdout.write('{}\t{}\n'.format(action, amount)) sys.stdout.flush() elif event_type == 'game_start': player.set_uuid(data.get('uuid')) player.receive_game_start_message(data) elif event_type == 'round_start': player.receive_round_start_message(data['round_count'], data['hole_card'], data['seats']) elif event_type == 'street_start': player.receive_street_start_message(data['street'], data['round_state']) elif event_type == 'game_update': player.receive_game_update_message(data['new_action'], data['round_state']) elif event_type == 'round_result': player.receive_round_result_message(data['winners'], data['hand_info'], data['round_state']) else: raise RuntimeError('Bad event type "{}"'.format(event_type))</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">metadata.json</b> <div class="spoiler_text"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"image"</span></span>: <span class="hljs-string"><span class="hljs-string">"sberbank/python"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"entry_point"</span></span>: <span class="hljs-string"><span class="hljs-string">"python bot.py"</span></span> }</code> </pre> </div></div><br><p>  For C / C ++, also pay attention to the <a href="">instructions for launching bots</a> in compiled languages.  Full documentation on how to prepare bots for shipping <a href="">is available here</a> . </p><br><h1 id="4-podhody-k-sozdaniyu-strategiy">  4. Approaches to creating strategies </h1><br><p>  For the more than 30-year history of poker bots, several families of poker strategy approaches have been created. </p><br><h3 id="klassicheskie-podhody">  Classic approaches </h3><br><p>  One of the easiest to implement and least time consuming is the expert system.  In essence, this is a set of fixed IF-THEN rules that relates the game situation to one of the predefined classes.  Depending on the strength of the collected combination, the system suggests making one of the many available solutions. </p><br><p>  Also, this problem can be solved purely by a mathematical method and at each time point to calculate the optimal solution from the point of view of Nash equilibrium.  However, the solution will be optimal if the decisions of the other participants are also optimal.  The search for such a solution is resource intensive, so in practice it can only be used along with a large number of restrictions in the rules.  For example, in limit Texas Hold'em for two agents or when certain game situations occur. </p><br><h3 id="podhody-na-osnove-mashinnogo-obucheniya">      </h3><br><p>     ,           -.         . ,    ,      ,      -                 .                     .    ,               ,     ,   <a href="https://en.wikipedia.org/wiki/Monte_Carlo_tree_search">Monte Carlo Tree Search</a> . <a href="http://propokerpro.bid/article/prodvinutaya-strategiya-pokera.htm">   </a> . </p><br><p> ,           ,        ,    ‚Äî   .       ,          .    ,          AlphaGo,            .               <a href="http://poker.cs.ualberta.ca/publications.html">  </a> ,        . </p><br><img src="https://habrastorage.org/web/72a/001/a21/72a001a21fcf4c8986cf620b98d79c1b.jpg"><br><p> <em>   Deepstack</em> </p><br><p>  ,     ,    DeepStack,       .        ,      ,        ¬´  ¬ª.      7-  ,      -   -   .   DeepStack   <a href="http://poker.cs.ualberta.ca/publications/17science.pdf">  </a> . </p><br><p>    ,               .  Sberbank Holdem Challenge       ,     . </p><br><h3 id="5-platforma-hakatona"> 5.   </h3><br><p>     -   <a href="http://holdem.sberbank.ai/">holdem.sberbank.ai</a> .       ,          -. </p><br><p></p><div style="text-align:center;"> <a href="http://holdem.sberbank.ai/"><img src="https://habrastorage.org/web/844/9a6/c5f/8449a6c5f5254ee08ae351dd8388099a.jpg" alt="image"></a> </div><p></p><br><p>    -     ,   ,        . ,   -      ,      . </p><br><p>  ,  - ,    -  ‚Äî       -100 :) </p><br><p>   -     ‚Äî ! </p><br><h1 id="6-ssylki"> 6.  </h1><br><div class="spoiler">  <b class="spoiler_title">useful links</b> <div class="spoiler_text"><p> <a href="http://www.sberbank.ai/">   Sberbank Holdem Challenge</a> <br> <a href="http://holdem.sberbank.ai/"> Sberbank Holdem Challenge</a> <br> <a href="https://geektimes.ru/company/mailru/blog/285314/"> 2017  - Libratus</a> <br> <a href="http://www.pokerlistings.com/from-loki-to-libratus-a-look-at-20-years-of-poker-ai-development">20-      (En)</a> <br> <a href="https://geektimes.ru/post/173273/">     </a> <br> <a href="http://poker.cs.ualberta.ca/publications.html">   ML  ,  </a> <br> <a href="http://fishki.net/2190663-pokernaja-programma-deepstack-obygryvaet-professionalov-odin-na-odin.html"> DeepStack,     Heads-Up  </a> <br> <a href="http://poker.cs.ualberta.ca/publications/17science.pdf">    DeepStack (En)</a> <br> <a href="https://www.pokerstarter.live/articles/Pravila-tehasskogo-holdema">   Texas Hold'em Poker]</a> </p></div></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/337264/">https://habr.com/ru/post/337264/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337254/index.html">Nonfictional stories about advertising budgets</a></li>
<li><a href="../337256/index.html">How to enter IT: a new set of HeadHunter School of Programmers</a></li>
<li><a href="../337258/index.html">SCS Protection Day - how to remove more gigabit from Wi-Fi</a></li>
<li><a href="../337260/index.html">Visual Explanation of Floating Numbers</a></li>
<li><a href="../337262/index.html">Data Ensemble Workflow Visualization with InterSystems DeepSee</a></li>
<li><a href="../337268/index.html">The largest manufacturer of avionics, Rockwell Collins will buy for $ 30 billion</a></li>
<li><a href="../337270/index.html">Top 10 internships for IT professionals</a></li>
<li><a href="../337272/index.html">How to create a racist AI, without even trying. Part 2</a></li>
<li><a href="../337274/index.html">Abbreviated Properties</a></li>
<li><a href="../337280/index.html">Software Asset Management at Raiffeisenbank - process and result</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>