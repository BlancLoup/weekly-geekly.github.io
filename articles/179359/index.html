<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MaskJS - HMV * framework</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Developing MaskJS for more than half a year, we managed to turn the DOM template into a very powerful, but at the same time productive web framework. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MaskJS - HMV * framework</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/690/9b5/d62/6909b5d6218992d251e1aa7dd7677997.png"><br>  Developing MaskJS for more than half a year, we managed to turn the DOM template into a very powerful, but at the same time productive web framework.  The article will acquaint you with perhaps interesting approaches to development.  I'm sure it will be interesting to read about using signals and slots instead of DOM events.  And how components make our lives easier.  The mask can be easily integrated into an already finished project, and can even be used with any other framework.  The main difference is probably the <i><code>render flow</code></i> , where in the process a Document Fragment / controllers / "binders" are created in stages.  Actually all the flexibility is even difficult to convey, but I will try, and invite under the cat. <br><a name="habracut"></a><br><br>  <a href="http://github.com/tenbits/MaskJS">MaskJS @ GitHub</a> <br>  A small todo <a href="http://libjs.it/mask-try/">example</a> for warming up.  <i>mask-fiddle works best on webkit.</i> <br><br><h2>  View </h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Markup </h4><br>  In case someone does not know, the templates use syntax similar to css / less / sass.  Recently, various bugs have been fixed, so the work of the engine should now be stable. <br><br><pre> <code class="javascript hljs">p { div#info.dark &gt; <span class="hljs-string"><span class="hljs-string">'Single Child'</span></span> button data-user=<span class="hljs-string"><span class="hljs-string">'123'</span></span> style=<span class="hljs-string"><span class="hljs-string">'cursor:pointer;'</span></span> &gt; span &gt; <span class="hljs-string"><span class="hljs-string">'Submit'</span></span> input type=hidden value=x; }</code> </pre><br>  As you can see, we removed the "&lt;&gt;" from the tags and removed the closing tags, but instead blocks are allocated with the usual "{}" brackets.  <i>(For simplicity, a block with one child does not look like a selector with a "&gt;" transition, but without children at all - closed with a semicolon).</i>  The text is placed in literals, as in javascript.  This is not a tricky transformation, we easily concentrated the markup on the <u>structure</u> - which is actually more in demand in the application architecture than html redundancy, which is aimed at text markup.  This is surprising to many html supporters, but let's face it - we, and probably as well as you, are developing applications with multiple localization.  We don‚Äôt have text in the views - only the keys to json with localization, then why is the hypertext markup syntax being asked? <br>  And unlike templates based on indents, the mask is easily minified and takes up minimal space. <br><br><h4>  Speed </h4><br>  This is the main priority in the development of MaskJS - to offer maximum performance on mobile devices.  It was possible to achieve a speed more or less comparable to html, and in the case of the webkit engine - even to increase, this especially applies to mobile platforms.  And not because <i>html parsing</i> in webkit is slow, but because <i>str.charCodeAt</i> and <i>document.createElement are</i> very fast).  And most importantly, the overhead of controller / interpolation / dom events / data bindings in the MaskJS architecture is minimal.  As a result, we no longer need to compile the templates, and this is already a big plus to the enjoyment of the development.  If interested, several links to jsperf.com can be found in the readme on the <a href="https://github.com/tenbits/MaskJS">github</a> . <br><br><h4>  Flexibility </h4><br>  MaskJS is a fairly extensible system.  We can define controllers for any tags and create new ones; in fact, the entire hierarchy of controllers ( <b>H</b> MVC) is built on this feature.  We can define handlers for any attributes.  We can also define utilities that, when interpolating a model in a template, will transform or redefine data.  And let me remind you that the mask on the client is rendered directly in the DocumentFragment, so we always work with DOM elements. <br>  All controllers are created through the similarity of IoC containers, and if you are ‚Äúin the subject line‚Äù, then you yourself understand how easy it will be to redefine or imitate them <i>(‚Äúmock‚Äù)</i> . <br>  Do you have a jQuery widget (or equivalent) and are you tired of initializing it every time after inserting it into a house? and initialized <i>widgets</i> .  With MaskJS, you create a Tag wrapper on your widget, and the mask will do everything for you: <br><pre> <code class="javascript hljs">mask.registerHandler(<span class="hljs-string"><span class="hljs-string">':timer'</span></span>, Compo({ <span class="hljs-comment"><span class="hljs-comment">//     template: '.cotainer &gt; .someInnerPanel', slots: { domInsert: function(){ //        " ", //  ,    -  } } onRenderEnd: function(){ this.$.mySuperTimer({ timespan: this.attr.timespan &lt;&lt; 0 }); /**   -    ,         / ,       ,     .            (int) ,  undefined  . */ } }); // =  // ... :timer timespan="5000";</span></span></code> </pre><br><br>  Now, you can use this tag in the template as much as you like, but you no longer need to initialize it.  A small example is the creation of timers: <br><br><pre> <code class="javascript hljs">$.getJSON(url).done(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">collection</span></span></span><span class="hljs-function">)</span></span>{ jmask(<span class="hljs-string"><span class="hljs-string">"ul &gt; % each=timers &gt; li &gt; :timer timespan='~[timespan]'; "</span></span>, collection).appendTo(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body); });</code> </pre><br><br><h2>  Design Patterns </h2><br><br>  There are many different architectural solutions, but everyone has a common goal - to reduce connections and dependencies.  In MaskJS, the main focus is on <b>V</b> ( <i>View</i> ) from MVC, and we are trying to abstract from the Model.  The mask doesn't care what your Business Layer looks like and where it comes from.  And this means that all classes, data and any business logic are independent of the view and controllers - and not only architecturally, but also from the MaskJS library as a whole.  A model can be either a Data Centric (note - json service response) or a complex Domain Model.  But in any case, it is separate and thus easy to develop and test. <br>  Next I will give small examples of different MVC scenarios, something will be exaggerated - so do not judge strictly, I do it only for the sake of better clarity. <br><ul><li>  Here we have a View: <pre> <code class="javascript hljs">mask.render(<span class="hljs-string"><span class="hljs-string">" div &gt; 'A' "</span></span>);</code> </pre> <br></li><li>  Add dynamism by displaying a letter from the model ( <code>var model = { letter: 'A' }</code> ): <pre> <code class="javascript hljs">mask.render(<span class="hljs-string"><span class="hljs-string">" div &gt; '~[letter]' "</span></span>, model)</code> </pre>  - we get (Data) Model / View <br></li><li>  We associate the model with the view so that if the letter is changed in the model, the view is updated: <br><pre> <code class="javascript hljs">mask.render(<span class="hljs-string"><span class="hljs-string">" div &gt; '~[bind: letter]' "</span></span>, model);</code> </pre>  - here is Model / View / ViewModel <br></li><li>  If we need to change or supplement the data for the view - we get the Model / View / Adapter: <br><pre> <code class="javascript hljs">mask.registerHandler(<span class="hljs-string"><span class="hljs-string">':myModelAdapter'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">renderStart</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">model</span></span></span><span class="hljs-function">)</span></span>{ _extendModelFromLocalStorage(model); } }); mask.render(<span class="hljs-string"><span class="hljs-string">" :myModelAdapter &gt; div &gt; '~[letter]' "</span></span>, model);</code> </pre><br></li><li>  If we need to separate the view from the model, we get Model / View / Presenter <br><pre> <code class="javascript hljs">mask.registerHandler(<span class="hljs-string"><span class="hljs-string">':myPresenter'</span></span>, Compo({ <span class="hljs-attr"><span class="hljs-attr">onRenderStart</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">model</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.letter = _handle(model); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.model = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } }); mask.render(<span class="hljs-string"><span class="hljs-string">" :myPresenter &gt; div &gt; '~[letter]' "</span></span>, model);</code> </pre><br></li><li>  If necessary, so that the letter would change to ‚ÄúB‚Äù when clicked - hello Model / View / Controller: <br><pre> <code class="javascript hljs">mask.registerHandler(<span class="hljs-string"><span class="hljs-string">':letterChanger'</span></span>, Compo({ <span class="hljs-attr"><span class="hljs-attr">events</span></span>: { <span class="hljs-string"><span class="hljs-string">'click: div'</span></span> : <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.model.letter = <span class="hljs-string"><span class="hljs-string">'B'</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     -     // this.$.text('B'); /* this.$ = jQuery/Zepto wrapper */ } } }); mask.render(" :letterChanger &gt; div &gt; '~[bind: letter]' ");</span></span></code> </pre><br></li><li>  If you need to add a model + react to a click - and now the hierarchy is HMVC <br><pre> <code class="javascript hljs">mask.render(<span class="hljs-string"><span class="hljs-string">':myAdapter &gt; :letterChanger &gt; div &gt; ‚Äú~[bind: letter]" '</span></span>);</code> </pre> <br></li><li>  If you need to hide the view in the controller, we get the usual encapsulation - (this is certainly not an architectural design pattern, but a very important point in MaskJS) <br><pre> <code class="javascript hljs">mask.registerHandler(<span class="hljs-string"><span class="hljs-string">':letter'</span></span>, Compo({ <span class="hljs-attr"><span class="hljs-attr">template</span></span>: <span class="hljs-string"><span class="hljs-string">":letterChanger &gt; div &gt; '~[bind: letter]' "</span></span> }); mask.render(<span class="hljs-string"><span class="hljs-string">" :myAdapter &gt; :letter; "</span></span> , model);</code> </pre><br><br>  <i>And you knew that for the full power of encapsulation, it is not bad to use different boot loaders, thereby taking controllers, their representations and styles into separate files.</i>  <i>A simple example of the composition of the component:</i> <br><pre> <code class="javascript hljs">header { #logo; :menu; :userInfo; } :viewManager { :userView; :aboutView; } :pageActivity; :notifier; :footer;</code> </pre><br>  <i>The names of components begin with a colon only for the best semantics of representations.</i> <br><br></li></ul><br>  But the main thing in all these MV * - not their names, especially here everything is far-fetched (I hope no one offended?).  And the essence itself, how we create controllers for different purposes.  And as you can see, we point the dependencies directly from the view ‚Äî by unloading the controllers themselves, and leave them to deal only with their immediate tasks. <br><br><h2>  Component / (Controller) / (Widget) </h2><br><h5>  AST </h5><br><h6>  MaskDOM </h6><br>  Parser transforms the View into a node tree.  A ‚Äúbuilder‚Äù is then traversed along it and interpolates the model - creates HTMLElements and Controllers (arbitrary tags).  The standard assembly MaskJS includes another good library - <a href="https://github.com/tenbits/mask-j">jmask @ github</a> .  It helps to work with the maskDOM tree, it uses the jQuery syntax and it is convenient to use it wherever you need to dynamically create a maskdom tree or modify it, for example, in <i>onRenderStart</i> components: <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//.. onRenderStart: function() { jmask(this).tag('div').addClass('pixel').wrappAll('.container data-id=dialog'); // eq. == jmask(this).wrappAll('.pixel &gt; .container data-id=dialog'); }</span></span></code> </pre><br>  If somewhere you use jQuery to create a DOM, then the mask will cope with this in the same way, and <a href="http://jsperf.com/dom-builder-mask-vs-jquery/4">much more quickly</a> , a small example <br><pre> <code class="javascript hljs">$(<span class="hljs-string"><span class="hljs-string">'&lt;div&gt;&lt;span&gt;&lt;/span&gt;&lt;/div&gt;'</span></span>).addClass(<span class="hljs-string"><span class="hljs-string">'container'</span></span>).data(<span class="hljs-string"><span class="hljs-string">'foo'</span></span>,<span class="hljs-string"><span class="hljs-string">'bar'</span></span>).children(<span class="hljs-string"><span class="hljs-string">'span'</span></span>).text(<span class="hljs-string"><span class="hljs-string">'2013'</span></span>).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>) <span class="hljs-comment"><span class="hljs-comment">//    jmask jmask('div &gt; span').addClass('container').data('foo','bar').children('span').text('2013').appendTo(document.body) jmask('.container foo=bar &gt; span &gt; "~[text]"').appendTo(document.body, { year: 2013 })</span></span></code> </pre><br><br><h6>  Controllers Tree </h6><br>  The builder also creates a tree from components, so you can find other controllers through selectors. <br><pre> <code class="javascript hljs">mask.registerHandler(<span class="hljs-string"><span class="hljs-string">':page'</span></span>, Compo({ <span class="hljs-comment"><span class="hljs-comment">// ... foo: function(){ // ... //  find     this.find(':scroller').scroller.refresh(); this.closest(':item[data-id=5]]').bar(); //  jmask     jmask(this).find(':listItem').each(function(x) { x.bar() }) } });</span></span></code> </pre><br><br><br><h4>  Signals / Slots </h4><br>  <a href="https://github.com/tenbits/mask-compo">mask-compo @ github</a> <br><br>  A component can have a hash object with a list of all the events it wants to process - <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _myCompo = Compo({ <span class="hljs-attr"><span class="hljs-attr">constructor</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = <span class="hljs-string"><span class="hljs-string">'C'</span></span>; }, <span class="hljs-attr"><span class="hljs-attr">events</span></span>: { <span class="hljs-string"><span class="hljs-string">'touchstart: .pane'</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> _myCompo <span class="hljs-comment"><span class="hljs-comment">// -&gt; true }, //... } });</span></span></code> </pre><br>  <b>But</b> in this way, we bind to the markup (css classes) - which means binding to the <u>implementation of the</u> view, which makes it difficult for us to replace the View.  And this is not good.  In many frameworks, you can call controller methods directly from the view, but this is also not the case, although MaskJS supports <i>expressions</i> in templates - <code>div &gt; '~[: controllerMethod("test") ]'</code> <i>(I note that the mask has its <i>expression parser</i> and <i>evaluator implemented</i> without <i>with / new Function / eval</i> ).</i>  It is much better when the view sends signals up the tree of controllers, starting with the "owner" of the element - and there already, who wants, implements the logic. <br><pre> <code class="javascript hljs">mask.registerHandler(<span class="hljs-string"><span class="hljs-string">':myCompo'</span></span>, Compo({ <span class="hljs-attr"><span class="hljs-attr">constructor</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = <span class="hljs-string"><span class="hljs-string">'C'</span></span>; }, <span class="hljs-attr"><span class="hljs-attr">slots</span></span> : { <span class="hljs-attr"><span class="hljs-attr">greet</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sender</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">// sender   dom    event object,     alert(this.name); // "C" // return false -  ,          . }, //... } })); mask.render(" :myCompo &gt; .panel x-signal='click: greet'; ");</span></span></code> </pre><br>  Notice the declarative declaration of slots in the <code>slots</code> object ‚Äî by this we clearly share the logic of the controller, and the mask itself will call these handlers when the corresponding signals are triggered. <br>  Additionally, we can deactivate a slot or a signal at any time, and at the same time, all elements that send this signal in a given ‚Äúscope‚Äù of controllers will receive the status <i>: disabled</i> . <br><br><h5>  Pipes </h5><br>  Normal signals walk only up or down the component tree, and in order to connect two components that lie outside the hierarchy, you need to use tubes. <br><pre> <code class="javascript hljs">mask.registerHandler(<span class="hljs-string"><span class="hljs-string">':userInfo'</span></span>, Compo({ <span class="hljs-attr"><span class="hljs-attr">pipes</span></span>: { <span class="hljs-comment"><span class="hljs-comment">// pipe name user: { logout: function(){ this.model.authenticated = false; } } } })); // = template.mask = menu { #logout x-pipe-signal='click: user.logout' &gt; button &gt; 'Sign out' // .... } section #content { //   "user"       % use="user" &gt; :userInfo type='brief' ; // .. } section #footer { // bind to "user.authenticated" prop %% if="user.authenticated" &gt; % each="user.keys" &gt; "~[.]" }</span></span></code> </pre><br>  <i>In this example, I tried to complicate the presentation a little.</i> <br><br>  All signals can also be sent from the controllers themselves: <br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.emitIn(<span class="hljs-string"><span class="hljs-string">'name'</span></span>, args...); <span class="hljs-comment"><span class="hljs-comment">//  this.emitOut('name', args...); //  Compo.pipe('user').emit('logout'); //       "".</span></span></code> </pre><br><br><h4>  Bindings </h4><br>  <a href="https://github.com/tenbits/mask-binding">mask-binding @ github</a> <br>  How is a web framework without ‚Äúbindings‚Äù?  Here everything is in the best traditions of the genre: One- / Two-way Bindings, Custom Binding Providers, Array Mutators, Validators. <br>  An example can be viewed at <a href="http://libjs.it/mask-try">mask-try |</a>  <a href="http://libjs.it/mask-try">bindings</a> .  Bindings are by their nature very productive, since in render time they only save the links to the house elements, and are attached to the model via <code>defineProperty/ __defineSetter__</code> .  And yes - you rightly noticed, old browsers are not supported - but by redefining the standard provider, you can bind to functions like <code>setX/getX</code> , or other templates like <code>.get("x")/.set("x")</code> .  Actually, if necessary, you can bypass restrictions. <br>  Interesting moments: <br><ul><li>  we can use expressions, example: <br><pre> <code class="hljs axapta"> <span class="hljs-keyword"><span class="hljs-keyword">div</span></span> style=<span class="hljs-string"><span class="hljs-string">'height: ~[bind: item.age * index + 10]px'</span></span></code> </pre>  Depending on how the age or index will change - this will be the height of the <code>div</code> panel. <br></li><li>  two-way binding based on <code>dom events / (jquery) custom events</code> . </li><li>  in order for the model to be complete, two-directional bindings can have component (s) <code>:validate</code> .  Before assigning a model value, the provider will first check it, and in case of an error, inform the user about it and offer to return to the last correct value.  So our model remains holistic. <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">input</span></span> #device-<span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> &gt; :dualbind <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>="age" { :<span class="hljs-keyword"><span class="hljs-keyword">validate</span></span> match="^[az]{2}-[\d]{4}$" message=" ... pattern: xx-1234" }</code> </pre><br></li><li>  As you may have already noticed, the mask has a standard <code>%</code> component, which implements <code>if/else/each/repeat/use</code> logic and so on.  So, the bindings module also implements one-way binding for these things: <br><pre> <code class="hljs mel">%% <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=<span class="hljs-string"><span class="hljs-string">"state == true"</span></span> { %% each=userList { <span class="hljs-comment"><span class="hljs-comment">// ... template</span></span></code> </pre><br><br></li></ul><br><br><h5>  Development </h5><br>  It is important not only to write large and productive applications, but also to get maximum pleasure from it.  Dividing the development into components, ranging from the smallest ( <code>:customCheckBox</code> ) to the largest ( <code>:inbox</code> ), we always concentrate on what is necessary.  To catch bugs, there are <code>debugger</code> and <code>log</code> attributes in the system controller: <br><pre> <code class="hljs pgsql">.<span class="hljs-keyword"><span class="hljs-keyword">user</span></span> { % debugger; .<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>-status &gt; <span class="hljs-string"><span class="hljs-string">'~[bind:info.status]'</span></span> %% <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>="info.status"; }</code> </pre><br><ul><li>  <code>debugger</code> - during the <i>render flow</i> we stop and we can see the stack components, the current model and the html element. <br></li><li>  <code>log</code> - output data to the console.  We can access both the model and the controller. <br></li></ul><br><h6>  Hot Reload Plugin </h6><br>  <font color="#555">... for <a href="http://github.com/tenbits/IncludeJS">IncludeJS</a></font> <br>  A ‚Äúhot‚Äù update of resources without page reload will not surprise anyone now - and the implementation is rather trivial, but not everything is so simple with scripts.  This should include closures, dom events, and so on.  We use the <code>IncludeJS</code> library to load all modules, and each script file can export the reload method.  Also, <code>IncludeJS.Builder</code> includes a server that monitors changes to the requested files and notifies <code>IncludeJS</code> via <code>IncludeJS</code> .  Actually the script is quite simple.  But MaskJS, in turn, in the <i>reload plugin</i> redefines <code>mask.registerHandler</code> - in it it records all the components that are registered and relates them to the path of the current script.  The plugin also subscribes to the controller creation event, and saves the current model and a link to the controller.  Thus, when through socket.io we receive a notification about a file change, we have a list of the names of the components that this file creates, as well as a list of instances <code>(instances)</code> .  And then the matter of technology is to call <code>remove/dispose</code> each controller, and initialize the updated components into their places.  Using signals and slots, parents do not need to subscribe to the dom events of the updated components - the signal will come.  If the component loads <i>mask markup</i> separately and we have changed something in it, then <code>IncludeJS</code> will regard this as a change in the <code>customCompo.js</code> file itself.  The topic IncludeJS is quite capacious and about all its possibilities some other time.  But the fact that the MaskJS architecture allows you to replace components on the fly greatly simplifies development, especially if the component is hidden behind N clicks (note somewhere in the dialog). <br><br><h4>  Node.js and TODO </h4><br>  Currently, MaskJS also works in node.js.  The principles of operation are the same, only after creating mask dom, the html dom is created, which in turn turns into a <i>string buffer</i> .  And on the client, all components will be initialized and to complete, they will receive the necessary DOM elements in the <i>onRenderEnd</i> method. <br>  Routing is tied not to controllers, as in many frameworks, but to views.  Remember?  The view itself initializes the necessary controllers.  Here you can use Master Pages technology and so on. <br>  Work in this area is not finished yet, it will be necessary to deal with some nuances.  But the goal is that the components / controllers / widgets work as on the client (first of all), but also with the ability to render on the <i>backend</i> with termination on the client. <br>  I also want to create a wrapper from a component over some kind of css framework.  The mask will simplify the markup at times - hide the css classes and <code>div wrappers</code> ).  And simplify the creation of menus / calendars / dialogs, etc. <br><br> <code>FIN</code> <br> <br>  This is probably all the highlights.  Much has not yet been told, but I hope it was clear at least what I was talking about, because the narrator is not from me, but there is a lot of material, so it is difficult to concentrate. <br>  In the comments, please do not write - ‚Äúlook at the X-framework!‚Äù - we follow the mainstream, but I will be <u>very</u> happy for deeper comments. <br><br><br>  I would also like to thank rma4ok <a href="https://habrahabr.ru/users/rma4ok/" class="user_link">habrauyazar</a> for many good advice.  Tried to take into account much.  Also I will be glad to any other advice or suggestions.  If you know interesting techniques from other languages ‚Äã‚Äã/ frameworks - please share your knowledge).  And you can also join the development. <br><br>  Good luck. </div><p>Source: <a href="https://habr.com/ru/post/179359/">https://habr.com/ru/post/179359/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../179337/index.html">How I calculated the millionth article in Russian Wikipedia</a></li>
<li><a href="../179339/index.html">Monitor Magazine (April 1992) and the Parables of Computer Residents</a></li>
<li><a href="../179345/index.html">NeoLucida - 21st Century Portable Camera-Lucid</a></li>
<li><a href="../179349/index.html">Network caching in iOS. NSURLCache</a></li>
<li><a href="../179351/index.html">Mysterious stationery. Test 2</a></li>
<li><a href="../179367/index.html">We turn Google Search to face us</a></li>
<li><a href="../179369/index.html">What should an IT person do in the Russian army</a></li>
<li><a href="../179371/index.html">Some statistics on email marketing</a></li>
<li><a href="../179373/index.html">Mnemonic: you can remember everything</a></li>
<li><a href="../179375/index.html">Little Computer People: the progenitor of Tamagotchi and Sims</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>