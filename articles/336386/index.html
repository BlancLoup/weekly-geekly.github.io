<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Weather and routes in MajorDoMo</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the second article in which I will try to tell you how to adjust the weather and routes in the MajorDoMo smart home system and make separate s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Weather and routes in MajorDoMo</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/af4/abf/50f/af4abf50fcb946e4ab5a1b694003889c.jpeg"><br><br>  This is the second article in which I will try to tell you how to adjust the weather and routes in the <b>MajorDoMo</b> smart home <b>system</b> and make separate scenes for them.  And also set up the output of weather data on the main stage. <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Table of contents</b> <div class="spoiler_text">  Part 1: <a href="https://habrahabr.ru/post/336310/">Install and configure the main scene in MajorDoMo</a> <br>  Part 2: <a href="https://habrahabr.ru/post/336386/">Weather and routes in MajorDoMo</a> <br></div></div><br><h2>  Introduction </h2><br>  In the <a href="https://habrahabr.ru/post/336310/">first</a> article we covered in detail how to install and configure the main scene in MajorDoMo.  Now, using the knowledge gained, set up two more scenes.  First we need to download our scene templates for <a href="https://drive.google.com/open%3Fid%3D0ByA4-Qy4DiPYTXFlSmVoOHgwLXc">weather</a> and <a href="http://majordomo.smartliving.ru/forum/download/file.php%3Fid%3D3324">routes</a> .  Downloaded?  Great, let's install and configure them. <br><br><h2>  Weather setting </h2><br>  As in the previous article, we launch MajorDoMo by clicking on the link we need (if this is the computer you are sitting at, then <a href="http://127.0.0.1/">127.0.0.1</a> , if not, then the IP of the device where MajorDoMo is installed).  Go to <i>Control Panel</i> -&gt; <i>Scenes</i> and click on <i>Add New Scene</i> .  We call it <u>weather</u> and click <i>Add</i> (you can not put the <i>background image</i> ), let's make the background change automatically, depending on the season.  Next, go to the <i>Elements</i> tab and then select the downloaded and unzipped file for the weather and click <i>Import</i> .  Like last time, we need our scene to be animated, for this we need to change the indexes that I have, to the ones that you have.  Briefly recall. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the <i>Elements</i> panel there is an element <b>general_CSS (only CSS)</b> , we go into it and in the code we find <b>.element_ *</b> , where * is the id of the element (for each such element there is a comment indicating which element it belongs to).  Focusing on the comments again go to the <i>Elements</i> tab, click on the one we need and look in the address bar of the element id and in <b>general_CSS (only CSS)</b> change what is there, what we have just learned. <br><br>  Let's now make it so that the background changes depending on the time of year.  Go to the Internet and download four pictures of the time of year with the extension you need (in my case 1024x600).  Put the downloaded images in the folder \ htdocs \ cms \ scenes \ backgrounds. <br><br>  After you need to add a new script, <i>Control Panel</i> ‚Üí <i>Scripts</i> click <i>Add New Script</i> , call it <u>getSceneImage</u> and click <i>Add</i> . <br><br>  Now we insert into the <i>Code</i> field: <br><br><div class="spoiler">  <b class="spoiler_title">Scenario</b> <div class="spoiler_text"><pre><code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($params[<span class="hljs-string"><span class="hljs-string">'scene'</span></span>] == <span class="hljs-string"><span class="hljs-string">"weather"</span></span>) { $winter = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">"cms/scenes/backgrounds/winter.jpg"</span></span>); $spring = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">"cms/scenes/backgrounds/spring.jpg"</span></span>); $summer = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">"cms/scenes/backgrounds/summer.jpg"</span></span>); $autumn = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">"cms/scenes/backgrounds/autumn.jpg"</span></span>); $seasons = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span> =&gt; $winter, <span class="hljs-number"><span class="hljs-number">1</span></span> =&gt; $spring, <span class="hljs-number"><span class="hljs-number">2</span></span> =&gt; $summer, <span class="hljs-number"><span class="hljs-number">3</span></span> =&gt; $autumn); $season = $seasons[floor(date(<span class="hljs-string"><span class="hljs-string">'n'</span></span>) / <span class="hljs-number"><span class="hljs-number">3</span></span>) % <span class="hljs-number"><span class="hljs-number">4</span></span>]; $img = $season[rand(<span class="hljs-number"><span class="hljs-number">0</span></span>, count($season) - <span class="hljs-number"><span class="hljs-number">1</span></span>)]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (file_exists($img)) { header(<span class="hljs-string"><span class="hljs-string">"Content-type: image/jpg"</span></span>); readfile($img); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $images = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">"cms/scenes/backgrounds/weather_1067x640.jpg"</span></span>, <span class="hljs-string"><span class="hljs-string">"cms/scenes/backgrounds/city_1067x640.jpg"</span></span>, <span class="hljs-string"><span class="hljs-string">"cms/scenes/backgrounds/plants_1067x640.jpg"</span></span>); $img = $images[rand(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (file_exists($img)) { header(<span class="hljs-string"><span class="hljs-string">"Content-type: image/jpg"</span></span>); readfile($img); } }</code> </pre> <br><br>  If you called the scene somehow differently, then in the first line change the word weather to the one you wrote in yourself.  In the 2-5 lines instead of my picture names write your own. <br></div></div><br>  The script is ready.  Now back to our scene <i>Control Panel</i> -&gt; <i>Scenes</i> find the created scene and click on the pencil in front of the scene, then the familiar editing window will appear.  In the <i>Background image</i> field we write the following code (if you called the scene not weather, then write your name): <br><br><pre> <code class="php hljs">/objects/?script=getSceneImage&amp;scene=weather</code> </pre> <br>  This, of course, can be customized in the fon element, but in this way you can change the picture from the weather conditions (rain, snow, thunderstorm) or you can take several pictures at one time of year. <br><br><h3>  Where to get weather data? </h3><br>  To display the weather, we need to take it from somewhere.  There are various services for this (weather Yandex, OpenWeatherMap, etc.).  I stopped at the OpenWeatherMap, and we will customize it.  The MajorDoMo system has a ready-made module for OpenWeatherMap.  Go to the <i>Control Panel</i> -&gt; <i>Market Add-ons</i> in the <i>Information</i> tab, find the <b>Open Weather</b> module <b>(by nick7zmail)</b> and click <i>Add</i> .  After adding in the <i>Applications</i> section we find and click on the <b>Weather from the OpenWeatherMap</b> .  On the <i>Settings</i> tab, select the desired city, put a tick <b>Use cached icons</b> , set up for how many days you need a forecast and a period of updates.  To fill in the <b>API Key</b> field.  Go to the site <a href="https://openweathermap.org/">OpenWeatherMap</a> register and get the API key.  How to get it, I will not describe here, on the Internet there is information about this. <br><br>  The weather pictures that are on the site are not very beautiful, you can replace them with your own, for example <a href="https://drive.google.com/file/d/0BxLihxCmD14jZ0J0aE5PUTVBVW8/view">these</a> .  Unzip them with a replacement in the \ htdocs \ cached \ openweather \ image folder. <br><br><h3>  Weather chart </h3><br>  To plot the actual temperature, we need to save history.  To save history, go to <i>Control Panel</i> -&gt; <i>Objects</i> and find <b>openweather</b> <i>Weather Open Weather Map</i> .  Opposite him click on the pencil and go to the <i>Properties</i> tab and create a new property called <u>temperature</u> in the <i>Store history (days)</i> field <i>:</i> set as many days as you need.  Everything, history for temperature is saved, if you need to save history for something else, then you just need to look at the name of the property for the parameter you need. <br><br><div class="spoiler">  <b class="spoiler_title">Several screenshots for pinning</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/be7/265/955/be7265955d564671bcff4e001613d663.PNG"><br><img src="https://habrastorage.org/web/d62/808/64f/d6280864fdde4261b69c41d293f1ddc1.PNG"><br>  It can be seen that the properties that you have created are highlighted in bold and that <u><b>H</b></u> stands near this property, this indicates that the history for this property is saved. <br></div></div><br>  Go to our scene, open the element cont1 ‚Üí chart and replace the code that is there on our <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">align</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/pChart/?p=ow_fact.temperature&amp;title=.&amp;type=1d&amp;unit=¬∞C&amp;type=1d&amp;width=450&amp;height=250&amp;gcolor=red&amp;gtype=curve&amp;px=10"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"-moz-border-radius: 10px 0px 0px 10px; -webkit-border-radius: 10px; border-radius: 10px; opacity:0.8;"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Now for the remaining elements in cont1 -&gt; chart we need to slightly change the code that is there.  Choose, for example, panel-now.  In the code we find% ow_fact.image%,% ow_fact.weather_type%, etc. we need to change everything.  They need to be taken from the properties of the object (on the screenshots above they are visible).  For panel-now, this is the actual temperature, respectively, we go into the property of the object we need, copy and replace it in panel-now.  Do not forget and change the link to the picture. <br><br><div class="spoiler">  <b class="spoiler_title">What we should have in the element panel-now</b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">align</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"panel-now"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mainInfo"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/cached/openweather/image/%ow_fact.image%.png"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"%ow_fact.weather_type%"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"%ow_fact.weather_type%"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"temp"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"value"</span></span></span><span class="hljs-tag">&gt;</span></span>%ow_fact.temperature%<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"degree"</span></span></span><span class="hljs-tag">&gt;</span></span>¬∞C<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"row"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"info"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fa fa-paper-plane-o"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"value"</span></span></span><span class="hljs-tag">&gt;</span></span>%ow_fact.wind_speed% /<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"info"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fa fa-arrows"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"value"</span></span></span><span class="hljs-tag">&gt;</span></span>%ow_fact.wind_direction%<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"info"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fa fa-tint"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"value"</span></span></span><span class="hljs-tag">&gt;</span></span>%ow_fact.humidity% %<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"info"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fa fa-sort-amount-asc"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"value"</span></span></span><span class="hljs-tag">&gt;</span></span>%ow_fact.pressure_mmhg%  ..<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  I think the principle is clear, the same thing, but for other properties we do it with the other elements. <br><br>  If you want a compass to spin around your city name, then you need to change something in the panel-location element.  You can replace my code and put your city. <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"panel-location"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"icon"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fa fa-compass fa-spin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">aria-hidden</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"title"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  If you play around with it a bit, you end up with something like this. <br><br><div class="spoiler">  <b class="spoiler_title">Weather scene</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/2c2/a14/6a8/2c2a146a844c9bdfcc457deab5ee1f4f.gif" alt="image"></div></div><br><h3>  Weather on the main stage </h3><br>  So that on the main stage in the window where the weather is located, your actual temperature is displayed, it is enough to do a few simple actions.  Go to the settings of the main scene and find the element panel-weather.  And we edit that code, as we did above. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"panel-weather"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"location"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/cached/openweather/image/%ow_fact.image%.png"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"%ow_fact.weather_type%"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"%ow_fact.weather_type%"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"temp-weather"</span></span></span><span class="hljs-tag">&gt;</span></span>%ow_fact.temperature%<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"degree"</span></span></span><span class="hljs-tag">&gt;</span></span>¬∞C<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text-weather"</span></span></span><span class="hljs-tag">&gt;</span></span>%ow_fact.weather_type% <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"font-size: 8px"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>/div&gt;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br><h2>  Routes </h2><br>  There is also a good module for routes in MajorDoMo.  Go to the <i>Marketplace add-ons</i> and in the <i>Information</i> tab we find the <b>GPS tracker</b> module (by SergeJey).  Add it and see the <i>GPS tracker</i> appeared in the <i>Applications</i> section.  Find the <i>Devices</i> tab and click <i>Add New Record</i> .  You have one default user admin in the <i>Settings</i> -&gt; <i>Users</i> section.  You can of course go there and change at your discretion (for example, change the name).  We write some name, select a user (the list will contain the name specified in <i>Users</i> ), and in order to fill in the <i>Device</i> field, you need to install a program on your phone, I have <u>Big Brothr GPS</u> (although I have not used others).  In the program settings, we find the URL and enter the following line <a href="http://192.168.20.161/gps.php">192.168.20.161/gps.php</a> (you have your address, of course);  You can put all the checkboxes so that the phone sends data to this address that you indicated in the URL.  We are now interested in the checkmark <u>Send device id</u> .  If GPS is enabled on the phone and you did everything correctly, a line will appear in the GPS tracker in the <i>Event Log</i> tab.  From it, we learn the ID that we need to enter. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/2fd/317/400/2fd31740042140c9b5b3e456211f2b16.PNG"><br></div></div><br>  On the <i>Settings</i> tab, you need to put <i>Yandex</i> in the <i>Map Service</i> section <i>:</i> because Google requires an API key. <br><br>  We still have the <i>Places</i> tab.  We can add some place to the map and draw a circle of the radius you set around this place.  If you enter / exit the radius of this circle, you can configure it to perform some action.  But we will not dwell on this in this article in detail, and even then the article has already dragged on.  So, we add a new place, find out the coordinates of latitude and longitude from Yandex or Google maps and enter them, the radius of action is at your discretion, in the <i>Virtual user</i> field <i>:</i> set 0. Ready, if you send your coordinates using the phone, then everything should work and show your route. <br><br>  Do not forget to first open the 1883 port, so that your device on which MajorDoMo is installed was visible from the outside. <br><br><h3>  Setting the scene for GPS </h3><br>  We act according to the old scheme.  Create a new scene, put your picture in the <i>Background image</i> field (which you saved in the \ htdocs \ cms \ scenes \ backgrounds folder with the necessary extension).  We edit the id of the elements, as we did earlier, so that your elements are animated. <br><br>  To your new and customized scenes displayed on the main stage.  That is, when you click on the buttons on the main stage (weather and routes), your scenes will open.  You need to go to the settings of the main scene and for the function_1 and function_2 elements in the lines of the code put the path to your new scenes. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/23a/f4a/065/23af4a06542e42b5ac2438be96c66918.PNG"><br></div></div><br><h2>  Conclusion </h2><br>  In this article, we learned how to set up and adjust two scenes, one for the weather, the second for the routes.  We also track our phone and show our route.  Now on the main stage we show our actual temperature.  On the weather scene, a forecast is shown and a temperature graph is plotted.  I would like to specifically thank the user <u>Vovix</u> for making such wonderful scenes.  As well as the developer MajorDoMo - <u>Sergey</u> .  I hope this article will be useful to someone. </div><p>Source: <a href="https://habr.com/ru/post/336386/">https://habr.com/ru/post/336386/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../336376/index.html">Technical implementation of the new Yota product for smartphones</a></li>
<li><a href="../336378/index.html">Minimal value types</a></li>
<li><a href="../336380/index.html">A little bit about vpxuser</a></li>
<li><a href="../336382/index.html">The book "Introduction to Drupal 8"</a></li>
<li><a href="../336384/index.html">‚ÄúThe State in the Clouds‚Äù and one GIS example from our practice</a></li>
<li><a href="../336388/index.html">Welcome to Rust Gamedev Mitap September 14</a></li>
<li><a href="../336390/index.html">Data Science: About love, names and more</a></li>
<li><a href="../336392/index.html">Better than C</a></li>
<li><a href="../336396/index.html">Work with CST parameters from Matlab</a></li>
<li><a href="../336398/index.html">Shipbuilding of the 17th century and your unsuccessful development projects: find five differences</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>