<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>JScriptInclude Gear v 0.1.0 is a mechanism for cascading import of scripts / libraries. (Revenge)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, dear habrazhiteli. 

 I offer you a post-rematch, called JScriptInclude Gear, a mechanism for cascading import of scripts / libraries. The p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>JScriptInclude Gear v 0.1.0 is a mechanism for cascading import of scripts / libraries. (Revenge)</h1><div class="post__text post__text-html js-mediator-article">  Good day, dear habrazhiteli. <br><img align="right" src="https://habrastorage.org/storage2/2f7/40b/79d/2f740b79ddbb0c1ee70486f5f0f8abde.png"><br>  I offer you a post-rematch, called <b>JScriptInclude Gear, a mechanism for cascading import of scripts / libraries.</b>  The previous post, the presenter of <b>JScriptInclude Gear</b> , is now selflessly taken up in drafts, now it is not relevant at all, despite the fact that the previous presentation was rather harshly perceived by Habra-javascript, and there it was for that :), a lot of disgraces were caused misunderstanding of the essence, namely the fact that <br>  <b>JScript (WSH)! = JavaScript (browsers)</b> , in connection with which <b>JScriptInclude Gear</b> was raised to the rank of crutches, bicycles, ‚Äúit was already‚Äù, ‚Äúin-trainer‚Äù, etc. <br>  I really wanted to share my decision then, but I had no idea how to make it ‚Äútasty‚Äù and understandable, but it seems to me that I have now succeeded. <br>  Nevertheless, the ‚ÄúObscuren‚Äù case got a move, people write, people use, people like it.  Over the past week I received a lot of feedback, which stimulated me to work on my decision, in the end it was transformed beyond recognition.  Thanks to everyone who came out with me to the line of fire. <br><br>  But those who do not know what the actual speech is about are a small, enticing preface: <br>  <b>JScriptInclude Gear</b> is a mechanism for cascading import of scripts / libraries designed for use in automation scripts written in <b>JScript</b> interpreted by <b>WSH (Windows Script Host)</b> technology in the environment of the Windows operating system family.  Additionally providing functionality for organizing scripts in the form of basic modules, supporting their definition in configuration files and their subsequent calling by aliases, and so on and so forth :) <br><br>  Those who have already read about <b>JScriptInclude Gear</b> in the previous post, in spite of maybe the remaining negative, I will ask you to stay behind, I assure you - there will be something interesting here, because almost everything has changed: the mechanism is now exported by the <b>COM component</b> and connects to your script with two lines of code, an <b>SFX package has been</b> prepared for installing the mechanism into the system with automatic registration of components and automatic configuration of the necessary paths, the documentation has been reworked "from and to", and is now presented in the form of HTML, the example now starts without  ‚ÄúDances with a tambourine‚Äù, and as a pleasant bonus, it contains several useful modules, which are described in the documentation (they, nevertheless, are an example of use and ‚Äúdo not pretend‚Äù), and the code itself is naturally ‚Äúpodylizan‚Äù, although in the process You don't actually use it now. <br>  For those who love it, you are welcome on <b>GitHub</b> : <br>  Mechanism <b>JScriptInclude Gear</b> <a href="">SFX installation package.</a> <br>  (independent to ugliness :)) <br>  The mechanism of <b>JScriptInclude Gear</b> <a href="https://github.com/RUVATA/JScriptInclude-Gear">is as it is.</a> <br>  (About deployment in additional comments to the last commit, or in the help section <b>jsImport Object sidebar</b> "Attention !!!") <br>  And yet I would like you to read the remaining "many bukaf", at least to the point <b>Features JScriptInclude Gear</b> : 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Interested mercy I ask under habrakat ... <br><a name="habracut"></a><br><br><h4>  Assigning JScriptInclude Gear: </h4><br>  First of all, to compensate for the lack of technology in the ability to connect scripts / libraries as such.  <b>Windows Scripting</b> technology suggests partially resolving this issue by wrapping code in the XML format of a specific <b>WSF</b> file <b>(Windows Script File)</b> , but its use does not allow for a " <i>cascade of connections</i> ."  Due to this circumstance, it is impossible to form the structure of libraries with their own dependencies.  In this solution, you are invited to overcome this problem by providing a <u>cascade import</u> . <br>  <b>Cascade import</b> is an opportunity worthy of special attention - its principle was borrowed by the author from the Node.JS technology.  In such a model, a set of <b>JavaScript</b> code files make up the flexible and uncluttered structure of modules and their dependencies on each other. <br>  In <b>Node.JS,</b> such a mechanism is provided by the core of the technology, and it also provides control, in the case of <b>JScriptInclude Gear</b> ‚Äî the mechanism is naturally imitation, and is implemented by means of the <b>JScript</b> language and some related technologies. <br><br><h4>  JScriptInclude Gear implementation: </h4><br>  Compared with the first editions of <b>JScriptInclude Gear, they</b> suggested that the user place the mechanism code at the beginning of the target script, and this is not less than <u>110 lines of code</u> , in this edition the author overcomes this inconvenience using the <b>Windows Script Components</b> technology, which allows, in a special way, described in <b>XML</b> - format, scripts register as <b>COM components</b> .  Thus, the author prepared the <b>JScriptInclude.wsc</b> component, the main purpose of which is to export the source code of the mechanism. <br>  The author took into account the inconvenience associated with the need for some manual configuration of the paths, and overcome this circumstance by preparing a special <b>SFX package</b> , which, in addition to providing the necessary files, also registers the above-mentioned component in the system as " <b>JScriptIncludeGear</b> ", and calls the script to automatically execute the necessary <b>updates</b> . source paths of the mechanism. <br>  As for the obligatory use of the <s>godless</s> <b>eval ()</b> for initializing the imported code, and now for initializing the code of the mechanism itself in the global stack, this problem is <u>insurmountable</u> , since  in <b>WSH</b> there is no possibility, in any way, to execute code in the context of a global object, except by calling it through <b>eval ()</b> from the main stack of the executable script. <br>  <b>PS:</b> Let me remind you once again that <b>JScript (WSH)! = JavaScript (in browsers),</b> despite the fact that both are implementations of the <b>ECMA 262</b> standard, they exist in completely different environments. <br>  There is no <b>window</b> in <b>WSH</b> , there is no <b>DOM</b> , and others like <b>script</b> tags, and so on and so forth. <br><br>  After successful installation in any of your <b>JScript</b> scripts on the target system, you can connect the <b>JScriptInclude Gear</b> cascade import <b>mechanism</b> , as well as access the system of its basic modules as follows: <br><pre><code class="javascript hljs">jsIncludeGear = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ActiveXObject(<span class="hljs-string"><span class="hljs-string">"JScriptIncludeGear"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(jsIncludeGear.getSourceCode());</code> </pre> <br>  The component mentioned by the author is intended only for exporting the source code of the mechanism itself by calling the <b>getSourceCode ()</b> method, initializing the result of its execution through <b>eval ()</b> you can access the global <b>jsImport</b> object, through the properties and methods of which the main functionality of the mechanism is implemented. <br>  For example, the main import / declaration dependency instruction: <br><pre> <code class="javascript hljs">jsImport.require(targetScript)</code> </pre><br>  The <b>jsImprot</b> object, its methods and properties are covered in a separate section of the reference tool supplied with the JScriptInculde Gear mechanism.  (After successful installation from the <b>SFX-package,</b> you will be asked to familiarize yourself with it, as well as its location will be shown in a message) <br><br>  Also in the target directory of the installation of the <b>JSciprInclude Gear</b> mechanism is the <b>\\ example \\</b> directory, in it, in the <b>TestDir</b> directory you will find the <b>JScriptExample.js</b> file <b>,</b> which is an example of using the mechanism, it demonstrates the main features and the concept proposed by the author.  (After successful installation from the <b>SFX-package,</b> you will be asked to start it, as well as the directory containing the example opens in the explorer) <br><br>  The final instruction of any import procedure should be to initialize the loaded code, as follows: <br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(jsImport.initialization());</code> </pre> <br><br><br><h4>  JScriptInclude Gear features: </h4><br>  <b>1)</b> <b>Connecting an arbitrary script</b> - given the possibility of a simple design <br><pre> <code class="javascript hljs">jsImport.require(targetScript)</code> </pre> <br>  connect another script to the executable, execute its code, or access the entities declared in it. <br>  This allows you to reuse existing practices and turnkey solutions in their work. <br>  <b>2)</b> <b>Cascade import</b> - it is possible to connect scripts / libraries, which, in turn, also have the opportunity to indicate the need to connect other scripts / libraries (the author suggests to call this later " <u>dependencies</u> ", and their fact of their connection as " <u>dependency implementation</u> " ). <br>  The dependency designation in the connected scripts / modules is implemented by including the same connection instruction in the code: <br><pre> <code class="javascript hljs">jsImport.require(targetScript)</code> </pre> <br>  i.e.  the same challenge as the one with which they were connected. <br>  In general, the connection is based on the principle of a downward recursive call to the import procedure.  In this mechanism, the use of absolute and relative paths in determining dependency is applicable.  It is worth emphasizing that relative paths, when declaring a dependency, are considered on the basis of the location of the script in which this dependency is declared, i.e.  in a connected script, <u>relative to this actual connected script</u> , and not relative to <u>the initiator</u> script (the script in which the mechanism is declared, and the first import is performed in a cascade). <br><br>  <b>3) Connection Singularity</b> - This mechanism, during the import process, keeps track of already connected files and does not allow them to be reinitialized, even if the link to the same script / library is present in a set of dependencies along the cascade branching path. <br><br>  <b>4) Providing a model of standard modules</b> - This mechanism provides the means for organizing the structure of basic modules when scripts / libraries are standardized or universal and are assumed to be present in the system.  To do this, <b>JScriptInclude Gear</b> uses the <u>configuration files of the basic modules</u> describing them by aliases, through which later any script that connects the mechanism can use all of its basic modules.  The toolkit includes methods for defining new and redefining existing modules, loading custom configurations: <br>  Definition of a new module with a special instruction.  In the case of a cascade of connections, it makes it possible to use the declared module throughout the underlying part of the cascade, as well as in all subsequent import procedures: <br><pre> <code class="javascript hljs">jsImport.defineBaseModule(moduleName, modulePath)</code> </pre> <br>  , the configuration file itself " <b>jsModulesConfig.js</b> ", by default is the root directory of the <b>JScriptInclude Gear</b> installation, during installation it automatically detects modules from the base distribution.  If it is necessary to add / change / replace any modules, you can: <br>  <b>-</b> edit the base configuration file, which is not recommended because  for example, in the case of an update, this file is likely to be changed. <br>  <b>-</b> use custom configuration files, and during the execution of your code connect them with special instructions: <br><pre> <code class="javascript hljs">jsImport.getConfig(ConfigFilePath)</code> </pre> <br>  <b>Warning</b> The modules declared in the user configuration file, if the aliases coincide with the aliases of the modules declared in the basic configuration, will prevail over them and overlap them. <br><br>  <b>5) Caching imported code for debugging or reuse</b> - In the process of developing this mechanism, the question of debugging imported code was repeatedly raised.  Due to the fact that it is initialized through <b>eval ()</b> , it is not possible to receive a correct error message in the loaded code - the link to the line of code that caused the exception is not informative about your script.  To resolve this problem, caching of the imported code is provided, i.e.  its materialization through writing to a separate <b>CacheFile.js</b> script <b>file</b> .  The need for writing is determined by the establishment of a special property: <br><br><pre> <code class="javascript hljs">jsImport.WriteCache = <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br><br>  Later, through its launch, it is possible to get the correct error message. <br>  <b>PS:</b> The cache file can be used as a compiled solution, i.e.  later use it instead of the new import procedure; in this case, the goal of using JSscriptInclude Gear is not clear, although the author sees that such a solution may be useful, if only by means of simplifying the assembly of code from multiple files. <br><br>  About all a little more dear, in the attached documentation. <br><br><h4>  And once more ... Yes, please! </h4><br>  Mechanism <b>JScriptInclude Gear</b> <a href="">SFX installation package.</a> <br>  (independent to ugliness) <br>  The mechanism of <b>JScriptInclude Gear</b> <a href="https://github.com/RUVATA/JScriptInclude-Gear">is as it is.</a> <br>  (About deployment in additional comments to the last commit, or in the help section <b>jsImport Object sidebar</b> "Attention !!!") <br><br>  <b>UPD:</b> For some users, the SFX package does not register components. <br>  SFX is a bit redone, now it seems to work, but again not everyone, for example, there are problems on x64, the main suspects so far are antiviruses. <br>  If, after installing the example, it was not possible to start the example immediately, then register <b>JScriptInclude.wsc</b> manually, <br>  Or run the <b>AfterInstall.js</b> script <b>yourself</b> . </div><p>Source: <a href="https://habr.com/ru/post/148416/">https://habr.com/ru/post/148416/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148409/index.html">OS X, Dual Stack and VK API problem</a></li>
<li><a href="../148410/index.html">How to create a simple tower defense game on Unity3D, part one</a></li>
<li><a href="../148411/index.html">System approach to requirements management</a></li>
<li><a href="../148413/index.html">CRIU - an ambitious new project to preserve and restore the state of processes</a></li>
<li><a href="../148415/index.html">IOS Application Testing Systems</a></li>
<li><a href="../148417/index.html">Google Earth Engine - a platform for monitoring the state of the Earth</a></li>
<li><a href="../148420/index.html">Mirrorless revolution</a></li>
<li><a href="../148421/index.html">Scientists have created artificial jellyfish</a></li>
<li><a href="../148422/index.html">BitTorrent is testing a new advertising system.</a></li>
<li><a href="../148425/index.html">Trends raised to the cult</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>