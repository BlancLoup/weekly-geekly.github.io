<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to reduce the number of measurements and benefit from it</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At first, I wanted to write honestly and in detail about the methods for reducing the dimensionality of the data - PCA , ICA , NMF , throw out a bunch...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to reduce the number of measurements and benefit from it</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/b11/20c/622/b1120c6223db4bb0a50134d3a7dbc7e5.jpg" align="left">  At first, I wanted to write honestly and in detail about the methods for reducing the dimensionality of the data - <a href="https://en.wikipedia.org/wiki/Principal_component_analysis">PCA</a> , <a href="https://en.wikipedia.org/wiki/Independent_component_analysis">ICA</a> , <a href="https://en.wikipedia.org/wiki/Non-negative_matrix_factorization">NMF</a> , throw out a bunch of formulas and say what an important role <a href="https://en.wikipedia.org/wiki/Singular_value_decomposition">SVD</a> plays in this whole zoo.  Then I realized that the text would be similar to the cutouts from the opuses from <a href="http://habrahabr.ru/post/155451">Mathgen</a> , so the number of formulas was minimized, but I left the most favorite code and images in full. <br><a name="habracut"></a><br><br clear="left">  I also thought to write about autoencoders.  In R, as is well known, the trouble with neural network libraries is either <a href="https://cran.r-project.org/web/packages/nnet/index.html">slow</a> , or <a href="https://cran.r-project.org/web/packages/RSNNS/index.html">buggy</a> , or <a href="https://cran.r-project.org/web/packages/deepnet/index.html">primitive</a> .  This is understandable, because without full-fledged GPU support (and this is a huge minus R compared to Python), working with any complex neural networks - and especially with <a href="http://deeplearning.net/tutorial/contents.html">Deep Learning</a> - is practically meaningless (although there is a promising developing project <a href="https://github.com/dmlc/mxnet/tree/master/R-package">MXNet</a> ).  Also of interest is the relatively recent <a href="https://en.wikipedia.org/wiki/H2O_%2528software%2529">h2o</a> framework, the authors of which are advised by the notorious <a href="https://en.wikipedia.org/wiki/Trevor_Hastie">Trevor Hastie</a> , and Cisco, eBay and PayPal even use it to create <a href="">their plans to enslave humanity</a> .  The framework is written in Java (yes, and loves RAM).  Unfortunately, he also does not support working with the GPU, because  has a slightly different target audience, but it scales well and provides an interface to R and Python (although fans of masochism can use the <a href="">web-interface</a> hanging by default on <a href="">localhost: 54321)</a> . <br><br>  So, if there is a question about the number of measurements in a data set, then this means that, well, let's say, quite a lot of them, which makes the use of machine learning algorithms not very convenient.  And sometimes a piece of data is just information noise, useless trash.  Therefore, it is desirable to remove the extra dimensions by pulling out the most valuable of them, if possible.  By the way, an inverse problem may arise - add more measurements, and simply more interesting and useful features.  Selected components can also be useful for visualization purposes ( <a href="https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding">t-SNE</a> , for example, is oriented to this).  The decomposition algorithms are interesting in their own right as machine learning methods without a teacher, which, you see, sometimes can lead to the solution of the primary problem. <br><br><h3>  Matrix decomposition </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In principle, to reduce the dimensionality of data with one or another efficiency, most machine learning methods can be adapted - in fact, they do this, mapping some multidimensional spaces to others.  For example, the results of PCA and K-means are equivalent in some sense.  But usually you want to reduce the dimension of the data without much fuss with finding model parameters.  The most important among such methods, of course, is <a href="https://en.wikipedia.org/wiki/Singular_value_decomposition">SVD</a> .  ‚ÄúWhy SVD, not PCA?‚Äù - you ask.  Because SVD, firstly, is in itself a separate important method for analyzing data, and the resulting matrix decomposition has quite a meaningful interpretation from the point of view of machine learning;  secondly, it can be used for PCA and with <a href="http://arxiv.org/pdf/1410.2786v1.pdf">some reservations for NMF</a> (as well as other matrix factorization methods);  Thirdly, SVD can be tailored to <a href="http://www.gipsa-lab.grenoble-inp.fr/~jerome.mars/2004_Signal_Processing_SVD_ICA_Vrabie.pdf">improve the performance of ICA</a> .  In addition, SVD does not have such inconvenient properties as, for example, applicability only to square ( <a href="https://en.wikipedia.org/wiki/LU_decomposition">LU</a> , <a href="https://en.wikipedia.org/wiki/Schur_decomposition">Schur</a> expansions) or square symmetric positively defined matrices ( <a href="https://en.wikipedia.org/wiki/Cholesky_decomposition">Cholesky</a> ), or only to matrices whose elements are non-negative ( <a href="https://en.wikipedia.org/wiki/Non-negative_matrix_factorization">NMF</a> ).  Naturally, one has to pay for universality - the singular decomposition is rather slow;  therefore, when matrices are too large, <a href="https://web.stanford.edu/group/mmds/slides2010/Martinsson.pdf">randomized algorithms</a> are applied. <br><br>  The essence of SVD is simple - any matrix (real or complex) is represented as a product of three matrices: <br>  <b>X = UŒ£V <sup>*</sup> ,</b> <br>  where U is a <a href="https://en.wikipedia.org/wiki/Unitary_matrix">unitary</a> matrix of order m;  Œ£ is the mxn matrix, on the main diagonal of which there are non-negative numbers, called <a href="https://en.wikipedia.org/wiki/Singular_value">singular</a> (the elements outside the main diagonal are zero ‚Äî such matrices are sometimes called rectangular diagonal matrices);  V <sup>*</sup> is the <a href="https://en.wikipedia.org/wiki/Conjugate_transpose">Hermitian-conjugate</a> matrix of order n to V.  The m columns of the matrix U and the n columns of the matrix V are called the left and right singular vectors of the matrix X, respectively. For the problem of reducing the number of dimensions, it is the matrix Œ£ whose elements, being raised to the second power, can be interpreted as a variance, which each ‚Äúinvests‚Äù component, and in descending order: œÉ <sub>1</sub> ‚â• œÉ <sub>2</sub> ‚â• ... ‚â• œÉ <sub>noise</sub> .  Therefore, when choosing the number of components in SVD (as in PCA, by the way), they are guided precisely by the sum of the variances given by the components taken into account.  In R, the singular decomposition operation is performed by the svd () function, which returns a list of three elements: the vector dc with singular values, the matrices u and v. <br><div style="text-align:center;"><img src="https://habrastorage.org/files/37f/8e3/6cf/37f8e36cfe1241a382e4672634f337af.png"></div><br>  Yes, Sasha looks like this in gray halftones <i>with just one component</i> , but even here you can see the basic linearized structure - in accordance with the gradations in the original image.  The component itself is obtained by multiplying the left singular vector by the corresponding singular value and the right singular vector.  As the number of vectors increases, the quality of image reconstruction also grows: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/bae/394/6e4/bae3946e45284ff2aee872f4b5db5bfd.png"></div><br>  The following graph shows that the first component explains more than 80% of the variance: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/b2b/39e/282/b2b39e282c8c4a64963cad3a1d96def9.png"></div><br><div class="spoiler">  <b class="spoiler_title">Code on R, singular decomposition:</b> <div class="spoiler_text"><pre><code class="hljs mel">library(jpeg) img &lt;- readJPEG(<span class="hljs-string"><span class="hljs-string">"source.jpg"</span></span>) svd1 &lt;- svd(img) #   comp1 &lt;- svd1$u[, <span class="hljs-number"><span class="hljs-number">1</span></span>] %*% t(svd1$v[, <span class="hljs-number"><span class="hljs-number">1</span></span>]) * svd1$d[<span class="hljs-number"><span class="hljs-number">1</span></span>] par(mfrow=c(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">image</span></span>(t(img)[,nrow(img):<span class="hljs-number"><span class="hljs-number">1</span></span>], col=gray(<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">255</span></span> / <span class="hljs-number"><span class="hljs-number">255</span></span>), main=<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">image</span></span>(t(comp1)[,nrow(comp1):<span class="hljs-number"><span class="hljs-number">1</span></span>], col=gray(<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">255</span></span> / <span class="hljs-number"><span class="hljs-number">255</span></span>), main=<span class="hljs-string"><span class="hljs-string">"1 "</span></span>) #   par(mfrow=c(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> c(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>)) { comp &lt;- svd1$u[,<span class="hljs-number"><span class="hljs-number">1</span></span>:i] %*% diag(svd1$d[<span class="hljs-number"><span class="hljs-number">1</span></span>:i])%*% t(svd1$v[,<span class="hljs-number"><span class="hljs-number">1</span></span>:i]) <span class="hljs-keyword"><span class="hljs-keyword">image</span></span>(t(comp)[,nrow(comp):<span class="hljs-number"><span class="hljs-number">1</span></span>], col=gray(<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">255</span></span> / <span class="hljs-number"><span class="hljs-number">255</span></span>), main=paste0(i,<span class="hljs-string"><span class="hljs-string">" ()"</span></span>)) } par(mfrow=c(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)) plot(svd1$d^<span class="hljs-number"><span class="hljs-number">2</span></span>/sum(svd1$d^<span class="hljs-number"><span class="hljs-number">2</span></span>),pch=<span class="hljs-number"><span class="hljs-number">19</span></span>,xlab=<span class="hljs-string"><span class="hljs-string">""</span></span>,ylab=<span class="hljs-string"><span class="hljs-string">"%   "</span></span>, cex=<span class="hljs-number"><span class="hljs-number">0.4</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span>()</code> </pre> <br></div></div><br><br>  What will happen if we subtract the average values ‚Äã‚Äãof each column from the original image, divide the resulting matrix into the square root of the number of columns in the original matrix, and then perform a singular decomposition?  It turns out that the columns of the matrix V in the resulting decomposition exactly correspond to the main components, which are obtained by PCA (by the way, in R for PCA, you can use the prcomp () function) <br><pre> <code class="hljs matlab">&gt; img2 &lt;- apply(img, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function"> - </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mean</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">) / </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sqrt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ncol(img)</span></span></span><span class="hljs-function">) &gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">svd2</span></span></span><span class="hljs-function"> &lt;- </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">svd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(img2)</span></span></span><span class="hljs-function"> &gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pca2</span></span></span><span class="hljs-function"> &lt;- </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prcomp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(img2)</span></span></span><span class="hljs-function"> &gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">svd2</span></span></span><span class="hljs-function">$</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">v</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[1:2, 1:5]</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[,1]</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[,2]</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[,3]</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[,4]</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[,5]</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[1,]</span></span></span><span class="hljs-function"> 0.007482424 0.0013505222 -1.059040</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e</span></span></span><span class="hljs-function">-03 0.001079308 -0.01393537 </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[2,]</span></span></span><span class="hljs-function"> 0.007787882 0.0009230722 -2.512017</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e</span></span></span><span class="hljs-function">-05 0.001324682 -0.01373691 &gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pca2</span></span></span><span class="hljs-function">$</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rotation</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[1:2, 1:5]</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PC1</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PC2</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PC3</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PC4</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PC5</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[1,]</span></span></span><span class="hljs-function"> 0.007482424 0.0013505222 -1.059040</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e</span></span></span><span class="hljs-function">-03 0.001079308 -0.01393537 </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[2,]</span></span></span><span class="hljs-function"> 0.007787882 0.0009230722 -2.512017</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e</span></span></span><span class="hljs-function">-05 0.001324682 -0.01373691</span></span></code> </pre><br>  Thus, when performing the singular decomposition of a normalized initial matrix, it is not difficult to distinguish the main components.  This is one of the ways to calculate them;  the second is based directly on the search for <a href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors">the eigenvectors of the covariance matrix</a> XX <sup>T.</sup> <br><br>  Let us return to the question of choosing the number of principal components.  The captain rule is: the larger the component, the more variance they describe.  <a href="https://en.wikipedia.org/wiki/Andrew_Ng">Andrew Ng</a> , for example, advises targeting&gt; 90% of the variance.  Other researchers argue that this number may be 50%.  Even coined the so-called <a href="http://www.apa.org/pubs/journals/features/met-a0030005.pdf">parallel analysis of</a> Horn, which is based on a Monte Carlo simulation.  In R for this <a href="https://cran.r-project.org/web/packages/paran/">package</a> is.  A very simple approach is to use a <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/screeplot.html">scree plot</a> : on the graph, look for an ‚Äúelbow‚Äù and discard all the components that form the flat part of this ‚Äúelbow‚Äù.  In the figure below, I would say that 6 components must be considered: <br><div style="text-align:center;"> <a href="" title="David Duchovny aka Dennis Bryson aka Fox Mulder"><img src="https://habrastorage.org/files/39c/1b3/25f/39c1b325f2b24f558622766012e71420.jpg"></a> </div><br>  In general, as you can see.  The question is well developed.  There is also an opinion that PCA is applicable only for normally distributed data, but the <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4_%25D0%25B3%25D0%25BB%25D0%25B0%25D0%25B2%25D0%25BD%25D1%258B%25D1%2585_%25D0%25BA%25D0%25BE%25D0%25BC%25D0%25BF%25D0%25BE%25D0%25BD%25D0%25B5%25D0%25BD%25D1%2582">Wiki</a> does not agree with this, and you can use SVD / PCA with data of any distribution, but, of course, it is not always effective (it turns out empirically). <br><br>  Another interesting decomposition is the <a href="https://en.wikipedia.org/wiki/Non-negative_matrix_factorization">factorization of non-negative matrices</a> , which, as the name implies, is used to decompose non-negative matrices into non-negative matrices: <br>  <b>X = WH</b> . <br>  In general, such a problem does not have an exact solution (unlike SVD), and numerical algorithms are used for its calculations.  The problem can be formulated in terms of <a href="https://en.wikipedia.org/wiki/Quadratic_programming">quadratic programming</a> - and in this sense it will be close to <a href="https://en.wikipedia.org/wiki/Support_vector_machine">SVM</a> .  In the problem of reducing the dimension of space, the following is important: if the matrix X has dimension mxn, then the matrix W and H respectively have dimension mxk and kxn, and choosing k is much smaller than m and n themselves, this original dimension can be significantly reduced.  NMF likes to be used for <a href="http://csweb.cs.wfu.edu/~pauca/publications/SIAMDM03.pdf">analyzing textual data</a> , where non-negative matrices are in good agreement with the very nature of the data, but in general, the <a href="https://en.wikipedia.org/wiki/Non-negative_matrix_factorization">range of application of the technique is</a> not inferior to PCA.  The decomposition of the first picture in R gives the following result: <br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/files/b52/535/e81/b52535e81e7843bb8fe4ef7caca0d499.png"></a> </div><br><div class="spoiler">  <b class="spoiler_title">Code on R, NMF:</b> <div class="spoiler_text"><pre> <code class="hljs mel">library(NMF) par(mfrow=c(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> c(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>)) { m.nmf &lt;- nmf(img, i) W &lt;- m.nmf@fit@W H &lt;- m.nmf@fit@H X &lt;- W%*%H <span class="hljs-keyword"><span class="hljs-keyword">image</span></span>(t(X)[,nrow(X):<span class="hljs-number"><span class="hljs-number">1</span></span>], col=gray(<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">255</span></span> / <span class="hljs-number"><span class="hljs-number">255</span></span>), main=paste0(i,<span class="hljs-string"><span class="hljs-string">" ()"</span></span>)) }</code> </pre><br></div></div><br><br><h3>  If you need something more exotic </h3><br>  There is a method that was originally developed for decomposing a signal with additive components ‚Äî I am talking about <a href="https://en.wikipedia.org/wiki/Independent_component_analysis">ICA</a> .  In this case, the hypothesis is accepted that these components have a non-normal distribution, and their sources are independent.  The simplest example is a <a href="https://en.wikipedia.org/wiki/Cocktail_party_effect">party</a> where a lot of voices are mixed, and the task is to select each sound signal from each source.  Two approaches are usually used to search for independent components: 1) with minimization of <a href="https://en.wikipedia.org/wiki/Mutual_information">mutual information</a> based on <a href="https://en.wikipedia.org/wiki/Kullback%25E2%2580%2593Leibler_divergence">Kullback-Leibler divergence</a> ;  2) with maximization of ‚Äúnon-Gaussianity‚Äù (here measures such as the <a href="https://en.wikipedia.org/wiki/Kurtosis">coefficient of kurtosis</a> and <a href="https://en.wikipedia.org/wiki/Negentropy">negentropy are used</a> ). <br>  The picture below is a simple example where two sinusoids mix, then they are also highlighted with the help of ICA. <br><div style="text-align:center;"><img src="https://habrastorage.org/files/c7d/af1/6a7/c7daf16a7701410eb7e3746f15097dc9.png"></div><br><div class="spoiler">  <b class="spoiler_title">Code on R, ICA:</b> <div class="spoiler_text"><pre> <code class="hljs django"><span class="xml"><span class="xml">x </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">seq</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span></span><span class="xml"><span class="hljs-tag">*</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pi</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">length.out</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">5000)</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y1</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">sin</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y2</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">sin</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">10</span></span></span></span><span class="xml"><span class="hljs-tag">*</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag">+</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pi</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">S</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">cbind</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y1</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y2</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">A</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">matrix</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">c</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span></span><span class="xml"><span class="hljs-tag">/</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">3</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span></span><span class="xml"><span class="hljs-tag">/</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span></span><span class="xml"><span class="hljs-tag">/</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">4</span></span></span></span><span class="xml"><span class="hljs-tag">), </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">S</span></span></span></span><span class="xml"><span class="hljs-tag"> %*% </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">A</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">library</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">fastICA</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">IC</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">fastICA</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">par</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mfcol</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">c(2,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">3</span></span></span></span><span class="xml"><span class="hljs-tag">)) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">plot</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y1</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"l"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">col</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"blue"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pch</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">19,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">cex</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0.1,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xlab</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ylab</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">main</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">plot</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y2</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"l"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">col</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"green"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pch</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">19,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">cex</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0.1,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xlab</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ylab</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">plot</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag">[,</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span></span><span class="xml"><span class="hljs-tag">], </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"l"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">col</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"red"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pch</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">19,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">cex</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0.5,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xlab</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ylab</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">main</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">plot</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag">[,</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span></span><span class="xml"><span class="hljs-tag">], </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"l"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">col</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"red"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pch</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">19,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">cex</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0.5,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xlab</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ylab</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">plot</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">IC</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">S</span></span></span></span><span class="xml"><span class="hljs-tag">[,</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span></span><span class="xml"><span class="hljs-tag">], </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"l"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">col</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"blue"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pch</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">19,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">cex</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0.5,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xlab</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ylab</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">main</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"ICA"</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">plot</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">IC</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">S</span></span></span></span><span class="xml"><span class="hljs-tag">[,</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span></span><span class="xml"><span class="hljs-tag">], </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"l"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">col</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"green"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pch</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">19,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">cex</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0.5,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xlab</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ylab</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">)</span></span></span></span></code> </pre><br></div></div><br>  What does ICA have to do with reducing data dimension?  Let us try to present the data - regardless of their nature - as a mixture of components, then it will be possible to divide this mixture into the number of ‚Äúsignals‚Äù that suits us.  There is no particular criterion, as in the case of PCA, the choice of the number of components is not - it is selected experimentally. <br><br>  The last test subject in this review is <a href="https://en.wikipedia.org/wiki/Autoencoder">autoencoders</a> , which represent a special class of neural networks that are configured so that the response at the autocoder output is as close as possible to the input signal.  With all the power and flexibility of neural networks, we simultaneously get a lot of problems associated with finding the optimal parameters: the number of hidden layers and neurons in them, activation functions ( <a href="https://en.wikipedia.org/wiki/Sigmoid_function">sigmoid</a> , <a href="https://en.wikipedia.org/wiki/Hyperbolic_function">tanh</a> , <a href="https://en.wikipedia.org/wiki/Rectifier_%2528neural_networks%2529">ReLu</a> ,), learning algorithm and its parameters, methods of regularization ( <a href="https://en.wikipedia.org/wiki/Regularization_%2528mathematics%2529">L1, L2</a> , <a href="https://en.wikipedia.org/wiki/Dropout_%2528neural_networks%2529">dropout</a> ).  If you train an autoencoder on noisy data so that the network restores them, you get <a href="http://deeplearning.net/tutorial/dA.html">denoising autoencoder</a> .  Pre-configured auto-encoders can also be <a href="">"docked" in the form of cascades for pre-training deep networks</a> without a teacher. <br><br>  In the simplest representation, the autoencoder can be modeled as a <a href="https://en.wikipedia.org/wiki/Multilayer_perceptron">multilayer perceptron</a> , in which the number of neurons in the output layer is equal to the number of inputs.  From the figure below it is clear that by choosing an intermediate hidden layer of small dimension, we thereby ‚Äúcompress‚Äù the original data. <br><div style="text-align:center;"><img src="https://habrastorage.org/files/422/d01/077/422d0107714641e7a1c112068dbb2e9c.png"></div><br>  Actually, in the <a href="https://cran.r-project.org/web/packages/h2o/h2o.pdf">h2o</a> package, which I mentioned above, such an auto-associate is present, so we will use it.  At first, I wanted to show an example with <a href="">gestures</a> , but I quickly became convinced that with a few sentences you would not get off, therefore there will be pictures with handwritten numbers from this <a href="https://www.kaggle.com/c/digit-recognizer">competition</a> . <br><div style="text-align:center;"><img src="https://habrastorage.org/files/b4e/cdd/b04/b4ecddb043f848b58c7794d611dfaf9b.png"></div><br>  The data is presented in the form of .csv files (train.csv and test.csv), there are quite a lot of them, so in the future, for simplicity, I will work with 10% of the data from train.csv;  The column with labels will be used for visualization purposes only.  But before we figure out what can be done with an autoencoder, let's see what the first three components give us when decomposing PCA, ICA, NMF: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/41c/3bf/745/41c3bf74546c408fb1e7322ab79526e0.png"></div><br>  All three methods have coped well with the clustering task ‚Äî groups are seen more or less clearly in the image, which merge into each other.  These transitions are borderline cases where numbers are especially difficult to recognize.  In the picture with PCA clusters, it is very noticeable how the principal component method solves an important problem ‚Äî it decorrelates variables: clusters ‚Äú0‚Äù and ‚Äú1‚Äù are maximally spaced apart.  The ‚Äúunusual‚Äù pattern with NMF is connected with the fact that the method works only with non-negative matrices.  But such a separation of sets can be obtained using the auto-encoder: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/b60/665/7c3/b606657c30214f7996a27a170b782b13.png"></div><br><div class="spoiler">  <b class="spoiler_title">Code on R, h2o autoencoder:</b> <div class="spoiler_text"><pre> <code class="hljs django"><span class="xml"><span class="xml">train </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">read.csv</span></span></span></span><span class="xml"><span class="hljs-tag">("</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">train.csv</span></span></span></span><span class="xml"><span class="hljs-tag">") </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">label</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">label</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">train</span></span></span></span><span class="xml"><span class="hljs-tag">$</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">label</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">NULL</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">train</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">train</span></span></span></span><span class="xml"><span class="hljs-tag"> / </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">train</span></span></span></span><span class="xml"><span class="hljs-tag">) #     </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">library</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">caret</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">tri</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">createDataPartition</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">label</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">p</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0.1)$Resample1</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">train</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">train</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">tri</span></span></span></span><span class="xml"><span class="hljs-tag">, ] </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">label</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">label</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">tri</span></span></span></span><span class="xml"><span class="hljs-tag">] #   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">h2o</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">library</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">h2o</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">h2o.init</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">nthreads</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">4,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">max_mem_size</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'14G'</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">train.h2o</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">as.h2o</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">train</span></span></span></span><span class="xml"><span class="hljs-tag">) #      </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">m.deep</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">h2o.deeplearning</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1:ncol(train.h2o),</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">training_frame</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">train.h2o,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">activation</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Tanh"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">hidden</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">c(150,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">25</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">3</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">25</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">150</span></span></span></span><span class="xml"><span class="hljs-tag">), </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">epochs</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">600,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">export_weights_and_biases</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">T,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ignore_const_cols</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">F,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">autoencoder</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">T)</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">deep.fea</span></span></span></span><span class="xml"><span class="hljs-tag"> &lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">as.data.frame</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">h2o.deepfeatures</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">m.deep</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">train.h2o</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">layer</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">3))</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">library</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rgl</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">palette</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rainbow</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">length</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">unique</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">labels</span></span></span></span><span class="xml"><span class="hljs-tag">)))) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">plot3d</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">deep.fea</span></span></span></span><span class="xml"><span class="hljs-tag">[, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span></span><span class="xml"><span class="hljs-tag">], </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">deep.fea</span></span></span></span><span class="xml"><span class="hljs-tag">[, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span></span><span class="xml"><span class="hljs-tag">], </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">deep.fea</span></span></span></span><span class="xml"><span class="hljs-tag">[, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">3</span></span></span></span><span class="xml"><span class="hljs-tag">], </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">col</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">label+1,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"s"</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">box</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">F,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">axes</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">F,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">xlab</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ylab</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">zlab</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">, </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">main</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"AEC"</span></span></span></span><span class="xml"><span class="hljs-tag">)</span></span></span></span></code> </pre><br></div></div><br>  Here clusters are more clearly defined and spaced apart.  The network has a fairly simple architecture with 5 hidden layers and a small number of neurons;  in the third hidden layer there are only 3 neurons, and the features from there are just depicted above.  Some more fun pictures: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/f5e/ee1/b98/f5eee1b98c304028a187485eb23faf68.jpg"></div><br><div class="spoiler">  <b class="spoiler_title">R code, visualization of weights of the first hidden layer:</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">W &lt;- <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.data.frame(h2o.weights(m.deep, <span class="hljs-number"><span class="hljs-number">1</span></span>)) pdf("fea.pdf") <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>:(nrow(W))){ x &lt;- matrix(<span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.numeric(W[i, ]), ncol=sqrt(ncol(W))) image(x, axes=F, col=gray(<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">255</span></span> / <span class="hljs-number"><span class="hljs-number">255</span></span>)) } dev.<span class="hljs-keyword"><span class="hljs-keyword">off</span></span>()</code> </pre><br></div></div><br>  In fact, these are just images of the weights of the neurons: each picture is associated with a separate neuron and represents a filter that selects specific information for a given neuron.  Here, for comparison, the scales of the output layer: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/669/69e/df2/66969edf2de54d309b522fd62717f482.png"></div><br>  The above autoencoder is easy to turn into denoising autoencoder.  Since such an auto-encoder must be fed distorted images at the input, it is enough to place a <a href="https://en.wikipedia.org/wiki/Convolutional_neural_network">dropout layer</a> in front of the first hidden <a href="https://en.wikipedia.org/wiki/Convolutional_neural_network">layer</a> .  Thanks to him, with some probability, the neurons will be in the "off" state, which a) will distort the processed image;  b) will serve as a kind of regularization in training. <br>  Another interesting application of the auto-encoder is the definition of anomalies in the data by the error of image reconstruction.  In general, if the data supplied to the input of the autoencoder is not from the training sample, then, of course, the reconstruction error of each image from the new sample will be higher than that of the training sample, but more or less one order of magnitude.  If there are anomalies, this error will be dozens or even hundreds of times more. <br><br><h3>  Conclusion </h3><br>  Of course, it would be wrong to write that some kind of compression method is better or worse than others: each has its own specifics and scope;  much depends on the nature of the data itself.  Not the last role here is played by the speed of the algorithm.  Of the above, SVD / PCA turned out to be the fastest, then ICA, NMF go in order, and the autoencoder completes the series.  It is especially difficult to work with the autosociators - not least because of the nontriviality in the selection of parameters. </div><p>Source: <a href="https://habr.com/ru/post/275273/">https://habr.com/ru/post/275273/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../275259/index.html">Bareos: tapes, Hyper-V and more</a></li>
<li><a href="../275265/index.html">The digest of interesting materials for the mobile # 136 developer (on January 11-17)</a></li>
<li><a href="../275267/index.html">Personal account for dealers in 5 minutes</a></li>
<li><a href="../275269/index.html">Parallel Sequential Scan Commited</a></li>
<li><a href="../275271/index.html">The story of one integration, or how we stopped worrying and fell in love with InterSystems Ensemble</a></li>
<li><a href="../275275/index.html">Microsoft will force new microprocessor owners to switch to Windows 10</a></li>
<li><a href="../275279/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ194 (January 11 - 17, 2016)</a></li>
<li><a href="../275281/index.html">Rating system in a high load project</a></li>
<li><a href="../275283/index.html">New victims of BlackEnergy are found in Ukraine</a></li>
<li><a href="../275285/index.html">Announcement of the sixth meeting of the Java User Group EKB</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>