<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Out-of-box intrusion prevention systems. Test Drive</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habrovchane! 

 Today we want to talk about how intrusion detection / prevention systems do their job right after you get them out of the box, ini...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Out-of-box intrusion prevention systems. Test Drive</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habrovchane! <img align="right" src="https://habrastorage.org/getpro/habr/post_images/e9a/c66/685/e9ac6668570ffe5ed2d4b81b76b93c28.png"><br><br>  Today we want to talk about how intrusion detection / prevention systems do their job right after you get them out of the box, initialize them, and put them in your network.  The following hardware platforms will participate in today's test drive: <br><br>  ‚Ä¢ Cisco IPS 4240; <br>  ‚Ä¢ IBM Proventia GX4004; <br>  ‚Ä¢ StoneGate IPS 1060. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Based on our experience, approximately 80% of IPS organizations are not configured properly.  This is due to the fact that there is simply no one to configure them or the system was installed only ‚Äúfor a tick‚Äù in order to comply with certain requirements of regulators.  Therefore, we decided to compare the intrusion detection systems at the default settings. <br><br>  In the article we want to share the results of our test drive with respected Habrazhiteli. <br><br>  All interested are invited under the cat. <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">A couple of words about IPS</b> <div class="spoiler_text">  The Intrusion Prevention System is a software or hardware system for network and computer security that detects intrusions or security breaches and automatically protects against them. <br>  IPS systems can be viewed as an extension of intrusion detection systems (IDS), since the task of tracking attacks remains the same.  However, they differ in that IPS must monitor activity in real time and quickly implement actions to prevent attacks.  Possible measures are blocking traffic flows in the network, dropping connections, and issuing signals to the operator.  IPS can also perform packet defragmentation, TCP packet reordering to protect against packets with modified SEQ and ACK numbers, etc. </div></div><br><h4>  Technical description of comparable IPS </h4><br>  Here, in fact, our experimental: <br><img src="https://habrastorage.org/getpro/habr/post_images/aa1/92b/4a0/aa192b4a0006679ea34d94368def8927.png"><br><br>  To begin with, we will give a few dry numbers describing the performance characteristics of hardware platforms, taken from open information sources: <br><img width="600" src="https://habrastorage.org/getpro/habr/post_images/0f2/8c1/f58/0f28c1f580a882b069f52f6587341c9c.png"><br><br><h4>  Program test drive </h4><img align="right" width="350" src="https://habrastorage.org/getpro/habr/post_images/711/fd1/de5/711fd1de508f73819a48be4927b7efe7.png"><br>  We will compare the work of three IPS under the same conditions: work in IDS mode (comparison was carried out in a real network), work in IPS mode and ‚Äúvery conditional‚Äù load testing (comparison was carried out in the laboratory).  As a result, we get a summary table with data on the number of found and blocked vulnerabilities. <br><br>  At once I would like to say that the comparison took place on the latest available software version and with the latest signatures at the time of testing, the <u><b>default policies were</b></u> used to detect and block threats. <br><br><h4>  Our "racing track" </h4><br><h5>  IDS operation </h5><br>  Testing of hardware platforms for intrusion detection systems in IDS mode (monitoring network activity) was carried out according to the scheme shown in the figure below by connecting all the hardware to the Cisco Catalyst 3750 switch ports, on which traffic from the organization‚Äôs real network was mirrored. <br><img src="https://habrastorage.org/getpro/habr/post_images/b55/d10/319/b55d103196e100d2a2b6bd48119acdf7.png"><br><br>  After three days of work in the monitoring mode of the IPS network, we found the following number of vulnerabilities / attacks (we took into account only vulnerabilities of the High, Medium and Low levels, the Info vulnerabilities were not taken into account): <br><br>  ‚Ä¢ Cisco IPS 4240 - 17 vulnerabilities / attacks; <br>  ‚Ä¢ IBM Proventia GX4004 - 32 vulnerabilities / attacks; <br>  ‚Ä¢ StoneGate IPS 1060 - 103 vulnerabilities / attacks. <br><br>  There are not so many common vulnerabilities / attacks that could detect all the glands: <br><br>  ‚Ä¢ ICMP Network Sweep w / Address Mask; <br>  ‚Ä¢ ICMP Network Sweep w / Timestamp; <br>  ‚Ä¢ TCP_Port_Scan; <br>  ‚Ä¢ UDP_Port_Scan; <br>  ‚Ä¢ ICMP_Subnet_Mask_Request; <br>  ‚Ä¢ ICMP_Timestamp_Request. <br><br>  A summary table with a list of all found vulnerabilities / attacks and a breakdown by piece of hardware can be viewed under the spoiler. <br><div class="spoiler">  <b class="spoiler_title">Vulnerabilities found</b> <div class="spoiler_text"><table border="1" width="584"><tbody><tr><td width="242">  <b>Signatures</b> <br></td><td width="108">  <b>Cisco IPS 4240</b> <br></td><td width="120">  <b>IBM Proventia GX4004</b> <br></td><td width="113">  <b>Stonegate IPS 1060</b> <br></td></tr><tr><td width="242">  ICMP Network Sweep w / Address <br>  Mask <br></td><td width="108">  <b>+</b> <br></td><td width="120">  <b>+</b> <br></td><td width="113">  + <br></td></tr><tr><td width="242">  ICMP Network Sweep w / Timestamp <br></td><td width="108">  + <br></td><td width="120">  + <br></td><td width="113">  + <br></td></tr><tr><td width="242">  Microsoft Windows CIFS <br>  Clientside Buffer Overflow (CVE-2011-0654) <br></td><td width="108">  + <br></td><td width="120">  - <br></td><td width="113">  - <br></td></tr><tr><td width="242">  SNMP Protocol Violation <br>  (CVE-2002-0012, CVE-2002-0013) <br></td><td width="108">  + <br></td><td width="120">  - <br></td><td width="113">  - <br></td></tr><tr><td width="242">  UPnP LOCATION Overflow <br></td><td width="108">  + <br></td><td width="120">  - <br></td><td width="113">  - <br></td></tr><tr><td width="242">  Invalid DHCP Packet (CVE-2004-1111) <br></td><td width="108">  + <br></td><td width="120">  - <br></td><td width="113">  - <br></td></tr><tr><td width="242">  TCP Segment Overwrite <br></td><td width="108">  + <br></td><td width="120">  - <br></td><td width="113">  - <br></td></tr><tr><td width="242">  DHCP Client DoS (CVE-2008-0084) <br></td><td width="108">  + <br></td><td width="120">  - <br></td><td width="113">  - <br></td></tr><tr><td width="242">  TCP MSS exceeds maximum <br></td><td width="108">  + <br></td><td width="120">  - <br></td><td width="113">  - <br></td></tr><tr><td width="242">  SQL Query in HTTP Request <br>  (CVE-2005-4643, CVE-2006-0581) <br></td><td width="108">  + <br></td><td width="120">  - <br></td><td width="113">  - <br></td></tr><tr><td width="242">  Email_Calendar_Code_Exec <br>  (CVE-2007-0039) <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  Email_Mime_Filename_Overflow <br>  (CVE-1999-0004) <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  Email_Mime_Name_Overflow <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  HTML_UTF8_Overflow (CVE-2006-2382) <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  HTTP_CheckPoint_FW1_FormatString <br>  (CVE-2004-0039) <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  Image_JPEG_IE_Component_Overflow <br>  (CVE-2005-2308) <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  OTF_Windows_Cmap_Table_Corruption <br>  (CVE-2010-3959) <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  PsExec_Service_Accessed <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  PsExec_Installed <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  Script_IE_Improper_Ref_Counting <br>  (CVE-2012-4787) <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  SMB_Empty_Password <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  BackOrifice_Ping (CVE-1999-0660) <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  Email_Executable_Extension <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  Flash_NavigateToURL_XSS (CVE-2007-6244) <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  HTTP_Connect_Proxy_Bypass_SMTP <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  HTTP_Field_With_Binary <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  HTTP_Proxy_Cache_Poisoning <br>  (CVE-2005-1215) <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  HTTP_URL_repeated_char <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  HTTPS_Proxy_Info_Disclosure <br>  (CVE-2005-2830) <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  ICMP_Flood <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  Ping_sweep <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  Smurf_Attack (CVE-1999-0513) <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  SNMP_Default_Backdoor (CVE-2000-0147) <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  TCP_Port_Scan <br></td><td width="108">  + <br></td><td width="120">  + <br></td><td width="113">  + <br></td></tr><tr><td width="242">  UDP_Port_Scan <br></td><td width="108">  + <br></td><td width="120">  + <br></td><td width="113">  + <br></td></tr><tr><td width="242">  DNS_Version_Request <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  HTTP_Authentication <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  HTTP_Microsoft_Error_Report <br></td><td width="108">  - <br></td><td width="120">  + <br></td><td width="113">  - <br></td></tr><tr><td width="242">  ICMP_Subnet_Mask_Request <br></td><td width="108">  + <br></td><td width="120">  + <br></td><td width="113">  + <br></td></tr><tr><td width="242">  ICMP_Timestamp_Request <br></td><td width="108">  + <br></td><td width="120">  + <br></td><td width="113">  + <br></td></tr><tr><td width="242">  ASN.1_Oversize-Block <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  HTTP_CRL-Excessively-Long-Options-Request-Argument <br>  (CVE-2010-0361) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  SMTP_CS-Novell-Groupwise-Client-Img-Tag-Src-Parameter-Buffer-Overflow <br>  (CVE-2007-6435) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  MSRPC-TCP_CPS-Samba-Spoolss-RPC-SmbIoNotifyOptionTypeData-Request-Handling-BOF <br>  (CVE-2007-2446) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  SMB-TCP_Negotiate-Protocol-Smb2-Remote-Code-Execution <br>  (CVE-2009-3103) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-File-Handling-Code-Execution-Vulnerability <br>  (CVE-2008-0081) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-VBA6-Stack-Memory-Corruption <br>  (CVE-2010-0815) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-WordPad-Text-Converter-CVE-2010-2563 <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-WordPad-Text-Converter-Buffer-Overflow <br>  (CVE-2010-1900) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Graphic-Object-Deref-Vulnerability-CVE-2011-0977 <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Office-Word-Sprmcmajority-Record-Buffer-Overflow <br><br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Heap-Overflow-Vulnerability-CVE-2011-0098 <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Style-Record-Data-Handling-Code-Execution <br>  (CVE-2008-0114) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Merge-Cell-Record-Pointer-CVE-2010-3237 <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Office-Art-Property-Table-Memory-Corruption <br>  (CVE-2008-0114) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Office-Drawing-Exception-Handling-CVE-2010-3335 <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Office-Excel-Table-Record-Parsing-Code-Execution <br>  (CVE-2010-3232) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Graphics-Rendering-Engine-Thumbnail-Stack-Buffer-Overflow <br>  (CVE-2010-3970) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Office-Excel-Malformed-Records-Stack-Buffer-Overflow <br>  (CVE-2009-0559) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Office-Excel-Unexpected-Field-Value-Memory-Corruption <br>  (CVE-2009-0560) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Version-Information-Handling-Code-Execution <br>  (CVE-2010-0262) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Word-File-Information-Memory-Corruption-MS09-068 <br>  (CVE-2009-2135) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Conditional-Formatting-Values-Handling-Code-Execution <br>  (CVE-2008-0117) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Autonomy-Keyview-Excel-File-Sst-Parsing-Integer-Overflow <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Frtwrapper-Record-Buffer-Overflow <br>  (CVE-2008-3471) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Named-Graph-Record-Parsing-Stack-Overflow <br>  (CVE-2007-0215) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Office-Excel-Remote-Code-Execution-CVE-2009-3134 <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Use-After-Free-WriteAV-Vulnerability <br>  (CVE-2011-1986) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Array-Indexing-Vulnerability-CVE-2011-1990 <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Conditional-Expression-Parsing-Vulnerability <br>  (CVE-2011-1989) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Malformed-Fngroupcount-Value-Code-Execution <br>  (CVE-2006-1308) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Sst-Invalid-Length-Use-After-Free <br>  (CVE-2012-1887) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Memory-Corruption-CVE-2012-1886 <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-Binary_Oracle-Java-Runtime-CMM-Readmabcurvedata-Buffer-Overflow <br>  (CVE-2010-0838) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-MPEG_Microsoft-DirectShow-QuickTime-Movie-Parsing-Code-Execution <br>  (CVE-2009-1537) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-Binary_IBM-Lotus-Notes-1-2-3-Work-Sheet-File-Viewer-Buffer-Overflow <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-Text_Mozilla-Firefox-Multiple-URI-Handlers-Command-Execution <br>  (CVE-2007-4041, CVE-2007-3896) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-Binary_Adobe-Reader-Security-Bypass-CVE-2013-0624 <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-Text_Microsoft-Internet-Explorer-Object-Reference-Count-Memory-Corruption <br>  (CVE-2007-3902) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-Text_Microsoft-Internet-Explorer-Virtual-Function-Table-Memory-Corruption <br>  (CVE-2011-2001) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-Text_Microsoft-Internet-Explorer-HTML-Layout-CVE-2012-0011 <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  HTTP_Reply-Chunked-Encoded-Chunk-Unparseable <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  TCP_Segment-Content-Conflict <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  TCP_Window-Shrinked <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  Shared_CS-x86-X41nop-Shellcode <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  Shared_SS-x86-X41nop-Shellcode <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  HTTP_CSU-Potential-Dot-Dot-Slash-Directory-Traversal <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  HTTP_CRL-Microsoft-ASP.NET-ViewState-Denial-Of-Service <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  HTTP_CRL-Php-Quot-Print-Encode-Heap-Buffer-Overflow <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  SMB-TCP_Samba-Authentication-Bypass <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  SMB-TCP_MS-Windows-Print-Spooler-Service-Format-String-Vulnerability <br>  (CVE-2010-2563) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  SNMP-UDP_Default-Community-String-Accepted <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  MSRPC_SS-Sourcefire-Snort-Rule20275eval-Buffer-Overflow <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Linked-List-Corruption-Vulnerability-CVE-2011-0979 <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Memory-Heap-Overwrite-Vulnerability-CVE-2011-1275 <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Office-PowerPoint-FB1h-Parsing-BOF-CVE-2010-2572 <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Office-Excel-SxView-SXStreamID-CVE-2010-1245 <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Office-Excel-Malformed-Object-Record-Parsing-Code-Execution <br>  (CVE-2009-0557) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Office-Excel-Malformed-LBL-Record-Memory-Corruption <br>  (CVE-2009-0558) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Colinfo-Record-Buffer-Overflow <br>  (CVE-2006-3875) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_OpenOffice-OLE-File-Stream-Buffer-Overflow <br>  (CVE-2008-0320) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-Malformed-Selection-Record-Code-Execution <br>  (CVE-2006-1301) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Office-Excel-File-Obj-Record-Memory-Corruption <br>  (CVE-2008-4264) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-PowerPoint-OfficeArt-Shape-RCE-Vulnerability <br>  (CVE-2011-3413) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Excel-MergeCells-Record-Heap-Overflow-Vulnerability <br>  (CVE-2012-0185) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-OLE_Microsoft-Office-Excel-Publisher-Record-Memory-Corruption <br>  (CVE-2010-1250) <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-Text_x86-X41nop-Shellcode <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  HTTP_Reply-Content-Type-Missing <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  UDP_Checksum-Mismatch <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  E-Mail_IMF-Multipart-Delimiter-Use-Invalid <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  E-Mail_IMF-Base64-Length-Inconsistency <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  IP_Checksum-Mismatch <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  DNS_Client-Name-Bad-Label-Type <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  DNS_Client-Class-Unknown <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  TCP_Segment-SYN-Unexpected <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  TCP_Segment-SYN-ACK-Unexpected <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  E-Mail_IMF-Too-Long-Header <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  E-Mail_IMF-Too-Long-Header-Field <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  POP3_Server-Syntax-Error <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  E-Mail_Message-Syntax-Error <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  E-Mail_Content-Transfer-Encoding-Duplicate <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  SMTP_Unknown-Command <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  HTTP_IIS-Unicode-Encoding <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  HTTP_Version-Varies <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  HTTP_Request-Extra-Data <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  TCP_Segment-SYN-ISN-Mismatch <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  DNS-UDP_Nameserver-Version-Query <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  HTTP_CS-Long-HTTP-Authorization-Negotiate-Token <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  HTTP_CSU-Windows-Style-Absolute-Path-In-URI <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  MSRPC-TCP_CPS-Windows-Local-Security-Authority-Username-Disclosure <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  SNMP-UDP_Linux-Kernel-SNMP-NAT-Helper-SNMP-Decode-DoS-2 <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  SNMP-UDP_Default-Community-String-Rejected <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-Binary_Windows-LNK-File-Transfer <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  HTTP_SHS-HTTP-0.9-Response-After-HTTP-1.0-Request <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  HTTP_SHS-Content-After-Zero-Content-Length <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-PNG_Conflicting-Content-Type-Text <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr><tr><td width="242">  File-PNG_Conflicting-Content-Type-Text-Plain <br></td><td width="108">  - <br></td><td width="120">  - <br></td><td width="113">  + <br></td></tr></tbody></table><br></div></div><br>  It is worth noting that IPS in monitoring mode can not only detect attacks, but also find vulnerable services and applications on the network, for example, using the default settings of the SNMP community, using blank passwords, unpatched software. <br><br><h5>  IPS operation </h5><br>  Testing of hardware platforms for intrusion detection systems in IPS mode (monitoring network activity and blocking malicious traffic) was carried out according to the scheme shown below by alternately turning on all hardware platforms in Inline mode (in the gap) between the Attacker Workstation and the Victims (servers).  The Victims had Microsoft Windows 2003 R2 installed and the following application software: <br><br>  ‚Ä¢ Oracle express 10g; <br>  ‚Ä¢ MySQL 5.2; <br>  ‚Ä¢ Apache 2.2.26; <br>  ‚Ä¢ WEB IIS 6 / FTP ISS 6; <br>  ‚Ä¢ Filezilla FTP Server 0.9.41 beta; <br>  ‚Ä¢ TFTPD 32 4.0; <br>  ‚Ä¢ MSSQL Express 2005. <br><img src="https://habrastorage.org/getpro/habr/post_images/cdd/6b2/757/cdd6b27572b5b9fe78dedfad8d790f43.png"><br><br>  With the Attacker Workstation, the Victims were scanned using the Nessus security scanner and a list of vulnerable services running on them was determined.  After scanning, attempts were made to exploit vulnerabilities (launch exploits) on the Victims using the Metasploit Framework exploit pack. <br><br>  Below is a summary table of the IPS attack response: <br><img src="https://habrastorage.org/getpro/habr/post_images/1da/04e/e60/1da04ee60c9a41047e7f9ba3af3e831f.png"><br><br>  It can be seen that IPS with default settings can block not all attacks, even those that do not use the latest vulnerabilities.  Therefore, it is strongly recommended to customize the piece of hardware specifically for your needs and services. <br><br><h5>  "Very conditional" load testing </h5><br>  This testing was performed using the hping3 utility (you can read about the utility <a href="http://wiki.hping.org/">here</a> ) from the Backtrack 5 R3 distribution kit.  The purpose of the testing was to test the ‚Äúresistance‚Äù of IPS to flood attacks, i.e.  we did not try to compare the performance of devices, but only investigated their response to overload. <br><br>  Stand description: <br>  IPS was established in the gap between the attacking node (OS Backtrack 5 R3) and the victim node (Windows Server 2003 R2).  The hping3 utility was launched within 5 minutes with the ‚Äú--flood‚Äù parameter; this key allows you to use the maximum possible packet generation rate. <br><br>  Command example: <br> <code>hping3 ip_address --flood</code> <br> <br>  Below is a summary table with the results: <br><img width="600" src="https://habrastorage.org/getpro/habr/post_images/d11/320/3d9/d113203d92482b593a55e824429c2328.png"><br><br>  As we can see, none of the IPS systems (on the default settings) could protect the node from a flood attack.  Cisco and IBM in the logs issued alerts and did not try to block the attack, StoneGate began to block the connections, but went into reboot, and the attack on the victim continued successfully.  This is due to the fact that by default the mode of operation of inline-interfaces is chosen fail-open, i.e.  all traffic passes freely between interfaces without inspection in case of failure of the hardware platform. <br><br><h4>  Conclusion </h4><img align="right" width="200" src="https://habrastorage.org/getpro/habr/post_images/971/405/669/9714056695d1d76b8432abfbfccb9982.png"><br>  If you decide to put IPS in order to really protect your users or some important services from outside threats and to be aware of what is happening in your network, we recommend that you do fine-tune the hardware.  Properly tuned IPS is able to close a very large number of ‚Äúholes‚Äù in security, even if it is already old and weak.  And on the default settings, none of the manufacturers showed results that could be called "impressive." <br><br>  Thank you all for your attention! <br><br>  Glebov Maxim, Selishchev Ivan </div><p>Source: <a href="https://habr.com/ru/post/209714/">https://habr.com/ru/post/209714/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../209694/index.html">Results of 2013: threats and exploitation of Windows</a></li>
<li><a href="../209696/index.html">Dart 1.1 is 25% faster, caught up with idiomatic JavaScript and is now suitable for servers</a></li>
<li><a href="../209698/index.html">Day-to-Day Maintenance Plan - Part 1: Automatic Index Defragmentation</a></li>
<li><a href="../209704/index.html">Botnet detected, consisting of "smart" TVs, media centers, PC and ... refrigerator</a></li>
<li><a href="../209706/index.html">System Update - ImageCMS 4.5.2</a></li>
<li><a href="../209716/index.html">The leading representative of the IT world will talk about modular program development as the main agile development tool in the Luxoft webinar series.</a></li>
<li><a href="../209720/index.html">Interview with Sid Meier: Ace Patrol, Civ Evolution and the Future of Strategy Games</a></li>
<li><a href="../209722/index.html">Payler: PCI DSS audit passed!</a></li>
<li><a href="../209724/index.html">Scientists suggest NASA explore a giant metal asteroid</a></li>
<li><a href="../209726/index.html">NeoQUEST-2014: registration is announced open</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>