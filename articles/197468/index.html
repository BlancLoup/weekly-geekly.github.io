<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A couple of shortcomings in creating a web application on Go</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If it is interesting to you, what defect is in all web applications in the Go language placed on Habr√©. And if you want to know how to make your Go we...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A couple of shortcomings in creating a web application on Go</h1><div class="post__text post__text-html js-mediator-article">  If it is interesting to you, what defect is in all web applications in the Go language placed on Habr√©.  And if you want to know how to make your Go web application one step closer to production ready, then welcome to cat. <br><a name="habracut"></a><br>  The important difference with Go web programming is that as a result you usually get a program that is a web server.  Therefore, you become responsible for what the web server usually answers. <br><br>  If we compare how Hello World looks like in PHP and Go, we will see <br><br><h6>  Php </h6><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> ‚ÄúHello World‚Äù; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br><h6>  Go </h6><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span></span></span> { fmt.Fprintf(w, <span class="hljs-string"><span class="hljs-string">"Hi there, I love %s!"</span></span>, r.URL.Path[<span class="hljs-number"><span class="hljs-number">1</span></span>:]) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { http.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, handler) http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">":8080"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) }</code> </pre><br>  Taken from the Go Language <a href="http://golang.org/doc/articles/wiki/">wiki</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Similar code is used in the following articles on Habr√©: <a href="http://habrahabr.ru/post/122095/">Web development on Go</a> , <a href="http://habrahabr.ru/post/141068/">Writing a web terminal emulator on Go, using Websocket</a> , <a href="http://habrahabr.ru/post/142287/">Goblog: Homemade static blog engine for Go</a> , <a href="http://habrahabr.ru/post/183508/">Writing your Web application on Go</a> . <br><br>  I myself, in the article <a href="http://habrahabr.ru/post/192446/">My Certificate Authority - in 5 OpenSSL commands</a> , cited a similar example on Go. <br><br>  Close on topic: <a href="http://habrahabr.ru/post/126461/">Go Language.</a>  <a href="http://habrahabr.ru/post/126461/">A small client-server application</a> , <a href="http://habrahabr.ru/post/142527/">TCP / IP proxy on Go</a> . <br><br>  An important difference and advantage of Go is how Go works with the network and can hold many open connections, for example, to implement long polling. <br><br>  In the article <a href="http://habrahabr.ru/post/145796/">C10k (Problem 10,000 connections) in different languages ‚Äã‚Äã/ platforms,</a> Go showed the second result after Erlang, opening 9775 connections from 10,000. <br><br>  The second advantage of Go is the simplicity and readability of the code, ease of learning, which makes it often the No. 1 choice when developing applications in which you need to work with many open connections. <br><br><h4>  <s>Error</s> Lack of all these examples. </h4><br>  The flaw is that Timeout (Deadline) for connections is 0 by default (i.e. timeout is not set at all).  If the client does not send a packet stating that the connection is closed, then such a connection will hang forever.  This will block goroutine in idle mode until the end of the web server‚Äôs life.  The number of open connection resource is usually limited.  By default, in Linux, an application can open 1024 files (a TCP connection is equal to a file). <br><br>  This means - the server created on Go as follows <br><br><pre> <code class="go hljs">http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">":8080"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)</code> </pre><br>  Will gradually accumulate not closed compounds and choke them in a day, month or year. <br><br>  Therefore, it is important to install Timeouts, which are installed by default in regular web servers. <br><br>  for example <br><br><pre> <code class="go hljs"> <span class="hljs-comment"><span class="hljs-comment">// log.Fatal(http.ListenAndServe(":8085", nil)) { s := &amp;http.Server{ Addr: ":8085", Handler: nil, ReadTimeout: 1000 * time.Second, WriteTimeout: 1000 * time.Second, MaxHeaderBytes: 1 &lt;&lt; 20, } log.Fatal(s.ListenAndServe()) }</span></span></code> </pre><br>  The second <s>drawback</s> parameter, which in a regular web server is often indicated is the maximum number of connections that the web server is ready to open.  If this restriction is reached, the web server begins to sacrifice keep-alive connections or give an error and close the connections. <br><br>  Go does not do this by default, and it‚Äôs not at all obvious how to limit the number of connections in Go or count the number of connections or, moreover, control this process. <br><br>  To figure out how to manage connections, you need to look into the source code of <a href="http://golang.org/src/pkg/net/">func (* Server) ListenAndServe</a> and <a href="http://golang.org/src/pkg/net/">func (* Server) ListenAndServeTLS</a> , then we will see that both functions use the function <a href="http/">func (* Server) Serve</a> . <br><br>  This function takes the <b>net.Listener</b> interface as an argument. <br>  This is what we can implement to limit and control connections. <br>  An example of a wrapper around a <b>net.Listener</b> interface is <a href="">LimitListener</a> <br><br>  Having passed on articles on Habr√© with a tag <a href="http://habrahabr.ru/search/%3Fq%3D%255Bgo%255D">[go]</a> I did not find examples in which Timeout, DeadLine were installed or the number of connections was controlled. <br><br>  If we consider that Go was created as a super-parallel, network language, then the implementation of a correct and well-thought-out strategy for working with connections is a mandatory element of the Go application. </div><p>Source: <a href="https://habr.com/ru/post/197468/">https://habr.com/ru/post/197468/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../197456/index.html">How we migrated millions of countries in a working day</a></li>
<li><a href="../197460/index.html">LG TVs: 2013 model range</a></li>
<li><a href="../197462/index.html">Big data is an integral part of our lives.</a></li>
<li><a href="../197464/index.html">The ninth Forum for IT directors "Efficiency in our genes!"</a></li>
<li><a href="../197466/index.html">How I hacked Habrahabr</a></li>
<li><a href="../197470/index.html">Comet Halley? She flew away, but promised to return ...</a></li>
<li><a href="../197472/index.html">7 useful books for the head</a></li>
<li><a href="../197474/index.html">Internal device llst, part 3. Magic JIT, or how to speed up a virtual machine 50 times</a></li>
<li><a href="../197476/index.html">UNPIVOT</a></li>
<li><a href="../197484/index.html">Organization of a shared calendars and contacts service for corporate use based on free software</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>