<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>IPv6 for P2P</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="IPv6 is usually associated with the problem of lack of IPv4 addresses, which the yellow press likes to write about. That from day to day there will be...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>IPv6 for P2P</h1><div class="post__text post__text-html js-mediator-article">  IPv6 is usually associated with the problem of lack of IPv4 addresses, which the yellow press likes to write about.  That from day to day there will be no free addresses and the transition to IPv6 will be inevitable.  Skeptics believe that the problem is as bloated as the ‚Äúmistake 2000‚Äù at one time, when everyone was afraid that after 1999 there would be 1900 and a man-made disaster would happen. <br><br>  For most users, indeed, no benefit from IPv6.  What is the difference, for example, that packet headers are more convenient for the router?  But for P2P, the NAT problem (due to which IPv4 addresses have not yet ended) is real, since  for peer-to-peer communication (even to send a file via Jabber or ICQ) it is necessary that at least one of the participants is accessible from the outside, i.e.  I had a real IP address or at least a port.  Some providers provide an external address for a fee, some do not have such a possibility, and it is for NAT sufferers that IPv6 will be most useful. <br><br>  It will also be useful to those who have a provider that cuts p2p traffic.  In Russia, this (for now?) Is not so common, but abroad is far from uncommon.  IPv6 traffic (more precisely, wrapped in regular UDP packets) is not cut by them.  It can also help in a situation where p2p traffic is blocked by the corporate firewall, but you can configure IPv6 through the tunnel. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At the user level, the main difference is that the IP address does not consist of 4 bytes, and is written not in the decimal system through a dot, but 16 bytes, which are written in hexadecimal form of 4 digits (2 bytes) and separated by a colon.  Zeros at the beginning of numbers can be omitted, and the longest chain: 0: 0: 0: 0: in the address, you can simply replace with two colons.  At the same time :: - normal IPv6-address, consisting entirely of zeros.  In the browser, if you need to specify the numeric address of the site, then it is placed in square brackets, for example <a href="http://%5B2001:4860:a003::68%5D/">http: // [2001: 4860: a003 :: 68] /</a> <br><br><h4>  Connection methods </h4><br>  If you are lucky, your provider provides Native IPv6.  Congratulations, you are lucky!  The rest is to transmit IPv6 packets, wrapping them in IPv4 over ‚Äúold‚Äù networks.  There are a lot of ways to connect, both automatic (such as 6to4 and teredo) and manually created tunnels, and working with or without a static external IPv4 address, even behind the most tricky NATs. <br><br><h4>  6to4 </h4><br>  The easiest way is if you have an external IPv4.  You pick up the 6to4 interface (stf in BSD, sit in Linux), configure your IPv6 address like 2002: xxyy: zztt: where xx.yy.zz.tt is your IPv4 address in hexadecimal format, and send all outgoing packets to 192.88.99.1.  Specific actions for specific systems do not write, in Google they are complete ( <a href="http://www.getipv6.info/index.php/Linux_or_BSD_6to4_Relays">example</a> ). <br><br>  Plus of such connection - simplicity of setup.  IPv6 packets over IPv4 can be sent to you by anyone, you can be sent to the nearest gate.  192.88.99.1 - this is the so-called anycast address, there can be any number of them in the network, and your provider sends them, as a rule, to the nearest one.  The reverse side of this is that it is impossible to figure out why some address or subnet was unavailable, because  Real routes are unpredictable and may change over time.  The second point is that one machine under FreeBSD has rebooted twice for unknown reasons in two days, and it works with a static tunnel.  On the other hand, for several acquaintances on Linux, this option has long been working without problems. <br><br><h4>  Teredo </h4><br>  An option for automatic configuration due to NAT.  If you have uTorrent 1.8 and higher, the button ‚ÄúInstall IPv6 / Teredo‚Äù appeared in the settings - it is enough to press it to configure.  To install manually, you need to run two commands from the command line: <pre>  ipv6 install
 netsh int ipv6 set teredo client </pre>  In * nix systems, it is enough to install miredo for example, with the command: <pre>  sudo apt-get install miredo </pre>  In Vista, it is enabled by default. <br><br>  The disadvantage of this option is that it does not work with all types of NAT.  If after installation you do not open <a href="http://ipv6.google.com/">ipv6.google.com</a> run from the command line <pre>  netsh int ipv6 show teredo </pre>  if it says "Error: client is behind symmetric NAT" - you are not lucky.  In any case, it is highly advisable to install the latest service packs, for example XP SP2 created an address with the 3ffe prefix: not 2001: This is fixed in SP3, in SP2 you can put <a href="http://www.microsoft.com/downloads/details.aspx%3Fdisplaylang%3Den%26FamilyID%3D9fd73d12-ff7c-411d-944d-a6f147b20775">KB922819</a> or correct / add \ HKLM \ System \ CurrentControlSet \ Services \ Tcpip6 \ in regedit Parameters \ GlobalParams \ TeredoPrefix at 0x120 (288).  The second disadvantage is that in spite of the seeming simplicity of setup, not everything is always simple.  For some, everything only works when the built-in Windows firewall is turned off, for someone, on the contrary, only when it is turned on.  And to describe in advance all possible problems, conflicts, and ways to solve them is simply impossible. <br><br>  A big plus (as in the case of 6to4) is that with those who are also connected via teredo, you will connect directly, the external server will only help to establish a connection through NAT Traversal, and it is possible to start pinging yourself.  Therefore, the speed will not be worse than in the case of a direct connection (the loss on wrapping IPv6 packets into UDPv4 packets is minimal). <br><br><h4>  Hexago (go6) </h4><br>  If automatic configuration did not help (symmetric NAT), or you want predictable packet masturization, there are plenty of free <a href="http://en.wikipedia.org/wiki/List_of_IPv6_tunnel_brokers">Tunnel Brokers</a> .  His choice should be taken very carefully, as well as the choice of a proxy server, because  both ping and speed will depend on this (this is true for teredo too - you can change the default server to teredo.remlab.net, it‚Äôs closer to Russia).  The main tools are ping and traceroute.  See who your ISP‚Äôs overseas traffic is going through.  See the route to 192.88.99.1 (for many, it will go to Hurricane Electric - .he.net). <br><br>  The easiest way to install is <a href="http://go6.net/">go6.net.</a> It‚Äôs enough to download the program from their site, if you want to register, install (it will swear at the "unsigned driver" - you need to confirm the installation), that's all.  It works with all types of NAT (unless it is necessary to allow outgoing port 3653 in the firewall).  Although there are problems too, and with the built-in firewall, and because of his absence, he only worked for me when the teredo was on (but not working because of Symmetric NAT). <br><br>  The downside is that go6 is in Canada, and all traffic, as I understand it, passes through itself.  Because of this, ping from 300 ms and up, low speed.  Somewhere came across information that hexago-hexago and ayiya-ayiya can establish ‚Äústraight‚Äù tunnels with each other, if possible (NAT Traversal), but I can neither confirm nor deny it. <br><br><h4>  Hurricane Electric </h4><br>  Official site - <a href="http://www.tunnelbroker.net/">www.tunnelbroker.net</a> Minus: provide only static tunnels, i.e.  An external IPv4 address is required.  The site needs registration.  Plus: they have many ‚Äúaccess points‚Äù through which you can connect in many countries, so you can choose quite close to yourself, and the speed will be almost as good as direct IPv4. <br><br><h4>  SixXS </h4><br>  Official website: <a href="http://www.sixxs.net/">www.sixxs.net</a> They have the most difficult registration (data are checked manually, from several hours to days), but also the widest range of possible connection methods and <a href="http://www.sixxs.net/pops/">access points</a> , so there is a high chance of finding within 10 ‚Äújumps‚Äù (by traceroute) from myself.  I stopped on this option, I recommend. <br><br>  After registration, you must order AYIYA tunnel.  At the same time they let me choose one of the access points (we check the trace and ping; the closest from me was sesto in Sweden).  The order is also checked manually (hours, days), while taking the internal "conventional units" for it, so the type of tunnel must initially be ordered the correct one.  Then - <a href="http://www.sixxs.net/tools/aiccu/">download the software</a> , and there are pitfalls.  Tap32-driver and client are downloaded and installed separately.  unzip tap901, run addtap.bat once - every time it starts it creates a new interface, if you accidentally create unnecessary ones - deltapall.bat deletes everything at once.  There are two clients (AICCU), with and without GUI, but the GUI is not compatible with the latest driver version.  It is better to download both, run the GUI once, enter the login / password, get the settings from the server, and select the Save Configuration button by clicking the icon.  No more GUI needed.  If you now run the client from the command line, everything should work.  If you're lucky, of course.  In order for IPv6 to start when the computer is booted, you need the instsrv and srvany utilities, which allow you to register this client as a Windows service (service).  A very detailed description of the settings is <a href="http://yorickdowne.wordpress.com/2008/04/05/ipv6-at-home-part-2-tunnel-brokers-windows-ayiya-tunnel/">in English</a> . <br><br><h4>  Bittorrent </h4><br>  To connect to someone via IPv6, you need to know his address.  Naturally, IPv6 should support a torrent client.  This is uTorrent since 1.8 (and the corresponding version of the official BitTorrent), Azureus since 4.1.0.0 (the old ones cursed at ‚Äúerror 16‚Äù), Transmission from version 1.50, I don‚Äôt know about others. <br><br>  You can find each other by DHT.  They have 2 implementations.  Azureus has its own, is no longer compatible with anyone, but supports IPv6.  In uTorrent and all the others - not yet, but it is planned in the future.  But IPv6 is supported by PEX.  But all this works only on open trackers, without the private flag in the torrent. <br><br>  Best of all, if IPv6 supports tracker.  According to the <a href="http://www.bittorrent.org/beps/bep_0007.html">documentation</a> , for this, the peers6 field was added to the response protocol (‚Äúcompact‚Äù, to which almost everyone switched), where a binary list of addresses is transmitted, 18 bytes each (16 is the address, 2 is the port).  In addition, the client can transmit the &amp; ipv6 = parameter and, in principle, the tracker can transmit IPv6 addresses to each other to clients, even if it cannot accept connections over IPv6.  The disadvantage of this approach is that through this parameter it is possible to transfer ‚Äúleft‚Äù addresses, thus littering the tracker. <br><br>  If the tracker itself is accessible via IPv6, then it will see the real addresses of the person who accesses it.  But if the A tracker‚Äôs domain name has both an A record and AAAA, then the clients will only connect via IPv6, and the tracker will not know their IPv4 addresses (the &amp; ip = and &amp; ipv4 = arguments also allow to ‚Äúlitter‚Äù, and nobody actually sends them , uTorrent is the only one transmitting &amp; ipv6 =).  It turns out, ideally, in the torrent file you need to register 2 addresses for both protocols. <br><br><h4>  Trackers </h4><br>  Trackers with IPv6 support are few.  There is <a href="http://www.sixxs.net/tools/tracker/catalog/">www.sixxs.net/tools/tracker/catalog</a> but there is practically nothing there, it is more for tests and demonstrations.  The Pirate Bay announced IPv6 support <a href="http://thepiratebay.org/blog/146/">in January</a> (only the tracker, their IPv6 site itself is not available).  In February, IPv6 support appeared on <a href="http://ipv6.nnm-club.ru/forum/">runet</a> on <a href="http://ipv6.nnm-club.ru/forum/">ipv6.nnm-club.ru</a> (registration there is either opened or closed only by invite, but it is always open when logging in via IPv6). <br><br>  But in order for all this to make sense, it is necessary that there be a sufficient number of clients.  The TPB main page last time was statistics on the number of peers, according to which only 0.12% were IPv6 (at the moment for some reason, by zeros).  This roughly corresponds to my personal experience - for a hundred peers, at best, 1-2 for IPv6.  According to statistics from nnm-club, 14% of clients transmit &amp; ipv6 = or connect via IPv6 to the tracker.  In fact, some of them are transmitted by the ‚Äúlocal‚Äù addresses of fe80: i.e.  Their IPv6 is not configured, but somewhere around 12% the address is real. <br><br><h4>  Programming </h4><br>  And a few words and programming, more precisely - porting ready-made applications for IPv6.  I highly recommend the book Jun-ichiro itojun Hagino "IPv6 Network Programming" just about that.  The best part is that almost all functions - socket, connect, listen, send, recv - IPv6 support, and you don‚Äôt have to touch them at all. <br><br>  The first main point is that it is necessary to abandon the use of the sockaddr_in structure (and even more so the storage of the IP address in int and functions of the inet_addr type).  Instead, there is a universal sockaddr_storage structure, if desired, its ss_family field can be checked for AF_INET and converted to sockaddr_in, or, if it is equal to AF_INET6, sockaddr_in6. <br><br>  The second point - working with DNS and string representation of addresses.  It should be translated to the universal functions getaddrinfo and getnameinfo.  It should be borne in mind that getaddrinfo can return several addresses, while the server needs to listen (bind, listen) all, the client - try to connect in turn, until it turns out with one of the addresses. <br><br>  In php, the main thing to pay attention to is that in $ _SERVER ['REMOTE_ADDR'] there can be not only an IPv4 address, but also an IPv6 if your web server supports it. </div><p>Source: <a href="https://habr.com/ru/post/53625/">https://habr.com/ru/post/53625/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../53619/index.html">On Nokia 6220c launched Windows 98</a></li>
<li><a href="../53620/index.html">Why do we need it or just another useless resource?</a></li>
<li><a href="../53621/index.html">Joy of Tech Comics - Part 2</a></li>
<li><a href="../53623/index.html">Release Candidate SP2 for Windows Vista and Server 2008 released</a></li>
<li><a href="../53624/index.html">About converting an image from VMWare to XenServer</a></li>
<li><a href="../53626/index.html">Falling in love with F #: Dose 2: Building a fractal image, or a set of Mandelbrot do it yourself</a></li>
<li><a href="../53628/index.html">New Mac Mini Pricing Announced</a></li>
<li><a href="../53630/index.html">x86 processor from nvidia?</a></li>
<li><a href="../53632/index.html">How ADV-Schnicki sofa bought</a></li>
<li><a href="../53633/index.html">Open Source gurus go to Microsoft</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>