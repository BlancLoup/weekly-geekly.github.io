<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Autodocumenting Perfect Server</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last time we said that Perfect does not have autodocumentation of the implemented API out of the box. It is possible that in the next implementation, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Autodocumenting Perfect Server</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/428/3d4/20e/4283d420e88c42ca83097626a0e8036c.png" alt="image"><br>  <a href="https://habrahabr.ru/post/283260/">Last time</a> we said that <b>Perfect</b> does not have autodocumentation of the implemented API out of the box.  It is possible that in the next implementation, developers will fix this annoying omission.  But nothing prevents us from taking care of this on our own.  Fortunately, you need to add quite a bit of code. <br><a name="habracut"></a><br>  We already have some stub that allows you to see the commands supported by the server.  Let's try to expand the possibilities of this approach. <br><br>  <b>Step 1</b> : Run the previously created Perfect server and enter the / cars command to get JSON.  This JSON is copied to <a href="http://jsonschema.net/">jsonschema.net/#</a> and we form the scheme from it, which we add as the cars.json file to the project.  Do not forget to go to Xcode -&gt; Project -&gt; Build phase and add the created file to the ‚ÄúCopy Files‚Äù list just as we did with index.html <br><div class="spoiler">  <b class="spoiler_title">cars.json</b> <div class="spoiler_text"><pre><code class="hljs perl">&lt;code&gt; { <span class="hljs-string"><span class="hljs-string">"$schema"</span></span>: <span class="hljs-string"><span class="hljs-string">"http://json-schema.org/draft-04/schema#"</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"object"</span></span>, <span class="hljs-string"><span class="hljs-string">"properties"</span></span>: { <span class="hljs-string"><span class="hljs-string">"address"</span></span>: { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"object"</span></span>, <span class="hljs-string"><span class="hljs-string">"properties"</span></span>: { <span class="hljs-string"><span class="hljs-string">"streetAddress"</span></span>: { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span> }, <span class="hljs-string"><span class="hljs-string">"city"</span></span>: { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span> } }, <span class="hljs-string"><span class="hljs-string">"required"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"streetAddress"</span></span>, <span class="hljs-string"><span class="hljs-string">"city"</span></span> ] }, <span class="hljs-string"><span class="hljs-string">"phoneNumber"</span></span>: { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"array"</span></span>, <span class="hljs-string"><span class="hljs-string">"items"</span></span>: { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"object"</span></span>, <span class="hljs-string"><span class="hljs-string">"properties"</span></span>: { <span class="hljs-string"><span class="hljs-string">"location"</span></span>: { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span> }, <span class="hljs-string"><span class="hljs-string">"code"</span></span>: { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"integer"</span></span> } }, <span class="hljs-string"><span class="hljs-string">"required"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"location"</span></span>, <span class="hljs-string"><span class="hljs-string">"code"</span></span> ] } } }, <span class="hljs-string"><span class="hljs-string">"required"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"address"</span></span>, <span class="hljs-string"><span class="hljs-string">"phoneNumber"</span></span> ] } &lt;<span class="hljs-regexp"><span class="hljs-regexp">/code&gt;</span></span></code> </pre> <br></div></div><br>  There is no great need for this, but it is always better to give the opportunity to get a JSON response scheme.  Client application developers will be grateful to you. <br><br>  <b>Step 2</b> : Add the IRestHelp Interface <br><div class="spoiler">  <b class="spoiler_title">IRestHelp.swift</b> <div class="spoiler_text"><pre> <code class="hljs cs">&lt;code&gt; import Foundation protocol IRestHelp { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> details:String {<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-keyword"><span class="hljs-keyword">params</span></span> :String {<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> schema :String {<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>} } &lt;/code&gt;</code> </pre><br></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Step 3</b> : Add the RestApi class <br><div class="spoiler">  <b class="spoiler_title">RestApi.swift</b> <div class="spoiler_text"><pre> <code class="hljs javascript">&lt;code&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> PerfectLib <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RestApi</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> prefix:<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>? <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> commands:[<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>]? = nil <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handler:RequestHandler? init(prefix:<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>?=nil, <span class="hljs-attr"><span class="hljs-attr">commands</span></span>:[<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>]? = nil, <span class="hljs-attr"><span class="hljs-attr">handler</span></span>:RequestHandler?=nil) { self.prefix = prefix self.commands = commands self.handler = handler } } &lt;<span class="hljs-regexp"><span class="hljs-regexp">/code&gt;</span></span></code> </pre><br></div></div><br>  For what it is needed - it will become clear further. <br><br>  <b>Step 4</b> : Add the RestApiReg class <br><div class="spoiler">  <b class="spoiler_title">RestApiReg.swift</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">&lt;code&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Foundation <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> PerfectLib <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> RestApiReg { typealias APIList = [RestApi] // MARK: - <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> Properties private var commandList = APIList() // MARK: - Private Properties private var globalRegistered = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> // MARK: - Singletone Implementation private init() { } private <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> var sharedInstance: RestApiReg { struct Static { static var instance: RestApiReg? static var token: dispatch_once_t = <span class="hljs-number"><span class="hljs-number">0</span></span> } dispatch_once(&amp;Static.token) { Static.instance = RestApiReg() } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Static.instance! } // MARK: - Methods <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> func registration(list:APIList) { self.sharedInstance.commandList = list self.sharedInstance.linkAll() } <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> func <span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(command:RestApi) { self.sharedInstance.commandList += [command] self.sharedInstance.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(command) } <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> var list: APIList { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.sharedInstance.commandList } // MARK: - Private methods private func linkAll() { Routing.<span class="hljs-keyword"><span class="hljs-keyword">Handler</span></span>.registerGlobally() self.globalRegistered = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> api <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.commandList { self.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(api) } } private func <span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(api:RestApi) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !self.globalRegistered { Routing.<span class="hljs-keyword"><span class="hljs-keyword">Handler</span></span>.registerGlobally() } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let <span class="hljs-keyword"><span class="hljs-keyword">handler</span></span> = api.<span class="hljs-keyword"><span class="hljs-keyword">handler</span></span> { let prefix = api.prefix == nil ? "*" : api.prefix! <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let commands = api.commands { Routing.Routes[prefix, commands] = { (_:WebResponse) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">handler</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Routing.Routes[prefix] = { (_:WebResponse) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">handler</span></span> } } } } } &lt;/code&gt;</code> </pre><br></div></div><br>  I could not come up with a better name for this class.  The class mediates the registration of new server APIs. <br><br>  <b>Step 5</b> : Replace the HelpHandler class with the following code: <br><div class="spoiler">  <b class="spoiler_title">HelpHandler.swift</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">&lt;code&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Foundation <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> PerfectLib <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> HelpHandler:RequestHandler, IRestHelp { var details = "Show server comands list" var params = "" var schema = "" func handleRequest(request: WebRequest, response: WebResponse) { let list = self.createList() let html = ContentPage(title:"HELP", body:list).page(request.documentRoot) response.appendBodyString("\(html)") response.requestCompletedCallback() } private func createList() -&gt; String { let list = RestApiReg.list var code = "" let allPrefixes = list.map { (api) -&gt; String <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> api.prefix != nil ? api.prefix! : "/*" } let <span class="hljs-keyword"><span class="hljs-keyword">groups</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>&lt;String&gt;(allPrefixes).sort() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">groups</span></span> { let commandsApi = self.commandsByGroup(<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>, list:list) code += self.titleOfGroup(<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>) code += self.tableWithCommnads(commandsApi) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> code } private func commandsByGroup(<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>:String, list:RestApiReg.APIList) -&gt; [String:RestApi] { var dict = [String:RestApi]() let commandsOfGroup = list.<span class="hljs-keyword"><span class="hljs-keyword">filter</span></span>({ (api) -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> api.prefix == <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> }) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> api <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> commandsOfGroup { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let commands = api.commands { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cmd <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> commands { dict[cmd] = api } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { dict[""] = api } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dict } private func titleOfGroup(<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>:String) -&gt; String { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> " &lt;B&gt;\(group):&lt;/B&gt; " } private func tableWithCommnads(commands:[String:RestApi]) -&gt; String { let sortedList = commands.keys.sort() var table = "" <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> += "&lt;table border = \"<span class="hljs-number"><span class="hljs-number">1</span></span>px\" width=\"<span class="hljs-number"><span class="hljs-number">100</span></span>%\"&gt;" <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sortedList { let cmd = commands[<span class="hljs-type"><span class="hljs-type">name</span></span>]! <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> += "&lt;tr&gt;" <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> += "&lt;td width=\"<span class="hljs-number"><span class="hljs-number">15</span></span>%\"&gt;&lt;a href=\"\(<span class="hljs-type"><span class="hljs-type">name</span></span>)\"&gt;\(name)&lt;/a&gt;&lt;/td&gt;" <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let help = cmd.<span class="hljs-keyword"><span class="hljs-keyword">handler</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? IRestHelp { <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> += "&lt;td&gt;\(help.details)&lt;/td&gt;" <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> += "&lt;td&gt;\(help.params)&lt;/td&gt;" <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> += help.<span class="hljs-keyword"><span class="hljs-keyword">schema</span></span>.characters.count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? "&lt;td&gt;&lt;a href=\"\(help.<span class="hljs-keyword"><span class="hljs-keyword">schema</span></span>)\"&gt;/\(help.schema)&lt;/a&gt;&lt;/td&gt;" : "&lt;td&gt;&lt;/td&gt;" } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> += "&lt;td&gt;&lt;/td&gt;" <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> += "&lt;td&gt;&lt;/td&gt;" <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> += "&lt;td&gt;&lt;/td&gt;" } <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> += "&lt;/tr&gt;" } <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> += "&lt;/table&gt;" <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> } } &lt;/code&gt;</code> </pre><br></div></div><br><br>  <b>Step 6</b> : Add the implementation of the IRestHelp protocol to the handler of each command that should be autodocumented.  This step is optional.  Those commands that do not support the protocol will have empty values ‚Äã‚Äãin the appropriate fields.  For example, the handler of the / list command (CarsJson class) looks like this: <br><div class="spoiler">  <b class="spoiler_title">CarsJson.swift</b> <div class="spoiler_text"><pre> <code class="hljs cs">&lt;code&gt; import Foundation import PerfectLib <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CarsJson</span></span>:<span class="hljs-title"><span class="hljs-title">RequestHandler</span></span>, <span class="hljs-title"><span class="hljs-title">IRestHelp</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> details = <span class="hljs-string"><span class="hljs-string">"Show complexly JSON object"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-keyword"><span class="hljs-keyword">params</span></span> = <span class="hljs-string"><span class="hljs-string">"{}"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> schema = <span class="hljs-string"><span class="hljs-string">"cars.json"</span></span> <span class="hljs-function"><span class="hljs-function">func </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleRequest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">request: WebRequest, response: WebResponse</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> car1:[JSONKey: AnyObject] = [<span class="hljs-string"><span class="hljs-string">"Wheel"</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-string"><span class="hljs-string">"Color"</span></span>:<span class="hljs-string"><span class="hljs-string">"Black"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> car2:[JSONKey: AnyObject] = [<span class="hljs-string"><span class="hljs-string">"Wheel"</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">"Color"</span></span>:[<span class="hljs-string"><span class="hljs-string">"mixColor"</span></span>:<span class="hljs-number"><span class="hljs-number">0xf2f2f2</span></span>]] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cars = [car1, car2] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> restResponse = RESTResponse(data:cars) response.appendBodyBytes(restResponse.array) response.requestCompletedCallback() } } &lt;/code&gt;</code> </pre><br></div></div><br><br>  <b>Step 7</b> : Replace the PerfectServerModuleInit () method with new code: <br><div class="spoiler">  <b class="spoiler_title">PerfectServerModuleInit ()</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">&lt;code&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> func PerfectServerModuleInit() { RestApiReg.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(RestApi(<span class="hljs-keyword"><span class="hljs-keyword">handler</span></span>: StaticFileHandler())) RestApiReg.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(RestApi(prefix: "GET", commands: ["/dynamic"], <span class="hljs-keyword"><span class="hljs-keyword">handler</span></span>: StaticPageHandler(staticPage: "index.mustache"))) RestApiReg.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(RestApi(prefix: "GET", commands: ["/index", "/list"], <span class="hljs-keyword"><span class="hljs-keyword">handler</span></span>: StaticPageHandler(staticPage: "index.html"))) RestApiReg.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(RestApi(prefix: "GET", commands: ["/hello"], <span class="hljs-keyword"><span class="hljs-keyword">handler</span></span>: HelloHandler())) RestApiReg.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(RestApi(prefix: "GET", commands: ["/help"], <span class="hljs-keyword"><span class="hljs-keyword">handler</span></span>: HelpHandler())) RestApiReg.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(RestApi(prefix: "GET", commands: ["/cars", "/car"], <span class="hljs-keyword"><span class="hljs-keyword">handler</span></span>: CarsJson())) RestApiReg.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>(RestApi(prefix: "POST", commands: ["/list"], <span class="hljs-keyword"><span class="hljs-keyword">handler</span></span>: CarsJson())) } &lt;/code&gt;</code> </pre><br></div></div><br><br>  <b>Run!</b> <br><br>  The original page remained the same. <br>  We try to enter / help in the browser command line: <br><img src="https://habrastorage.org/files/b91/53a/d07/b9153ad07b294bfeb713086ce01c182b.jpg" alt="image"><br>  We see that all the teams are arranged in a table in alphabetical order and got hyperlinks.  After logging in to the help page, it is no longer necessary to enter each of the commands in the browser command line to execute it.  And in the extreme right column there is a link to the schema to validate this command. <br>  In the future, we ourselves can use the validation scheme to verify the correctness of the response we create, before it leaves the client application.  And the client application, potentially, can load validation schemes directly from the server.  With validation, this results in a double profit. <br><br>  The table, of course, clumsy.  Using CSS can significantly improve its aesthetic appearance.  But for work, as a rule, this is enough. <br>  <i>Initially, there was a desire to display, on request / help, an XML file with a schema that would line the data into a similar table.</i>  <i>However, improving the look and feel of HTML is much more exciting than having fun with all sorts of XML mappings.</i> <br><br>  <b>PS</b> As it became known, Perfect developers are all working towards getting rid of NextStep (Objective-C) heavy legacy in order to enable the server to run on * nix system, and therefore, some of the usual ways of working in the NS namespace are now considered not kosher. </div><p>Source: <a href="https://habr.com/ru/post/283432/">https://habr.com/ru/post/283432/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../283418/index.html">RTKLib + Python + Google Maps JS API. Making your navigator</a></li>
<li><a href="../283422/index.html">UI tests: Cucumber + Selenide</a></li>
<li><a href="../283424/index.html">Introduction to OAuth (in simple words)</a></li>
<li><a href="../283428/index.html">Come to the meetings of the IT communities in your cities</a></li>
<li><a href="../283430/index.html">All-Russian Engineering Olympiad for high school students: BigData and Intelligent Energy Systems</a></li>
<li><a href="../283436/index.html">Connect to the webinar: "SQL Server 2016 Data Management Platform." Beginning May 13 at 11:00 (Moscow time)</a></li>
<li><a href="../283440/index.html">Intel Edison in IoT: securely connecting the touch node to the Internet using MQTT</a></li>
<li><a href="../283442/index.html">Google I / O Extended 2016</a></li>
<li><a href="../283444/index.html">Who and how earns on public public financial data?</a></li>
<li><a href="../283446/index.html">Back to the future: Megamind returns to Habrahabr</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>