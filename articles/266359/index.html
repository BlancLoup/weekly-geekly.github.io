<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>In the guests' sitting "Grasshopper"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In June of this year, a new block encryption standard was adopted in Russia - GOST R 34.12-2015. This standard, in addition to the good old GOST 28147...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>In the guests' sitting "Grasshopper"</h1><div class="post__text post__text-html js-mediator-article">  In June of this year, a new block encryption standard was adopted in Russia - GOST R 34.12-2015.  This standard, in addition to the good old GOST 28147-89, which is now called "Magma" and has a fixed set of substitutions, contains a description of the Grasshopper block cipher.  I will tell about it in this post. <br><a name="habracut"></a><br>  In contrast to GOST 28147-89, the new cipher is not a network of its Feistel, but the so-called.  SP network: a transformation consisting of several identical rounds, with each round consisting of non-linear and linear transformations, as well as a key-overlay operation.  Unlike the Feistel network, using the SP network converts the entire input block, not half of it.  Such a structure is sometimes also called AES-like (similar to AES), however, unlike the latter, ‚ÄúGrasshopper‚Äù has a number of its own ‚Äúchips‚Äù: <br><ul><li>  linear transformation can be implemented in using the shift register; </li><li>  the key scan is implemented using the Feistel network, which uses a round transformation of the original algorithm as a function. </li></ul><br>  The length of the input block "Grasshopper" - 128 bits, key - 256 bits. <br><br><h4>  Transformations </h4><br>  Encryption is based on the sequential application of several of the same type of rounds, each of which contains three transformations: addition with a round key, transformation by a substitution unit, and linear transformation. <br><br>  The 128-bit input vector of the next round is added bit by bit with a round key: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/de7/760/18d/de776018de3e4f4b851eaa7c21a63cd9.png"><br><br>  The nonlinear transformation is the application to each 8-bit sub-vector of a 128-bit input vector of a fixed substitution: <br><br><img src="https://habrastorage.org/files/f62/e09/16c/f62e0916c4004ca8bc769475afbf6960.png"><br><br>  The Grasshopper uses the same substitution as the Stribog hash function. <br><br>  Linear transformation, as I have already said, can be implemented not only as usual in block ciphers ‚Äî a matrix, but also with the help of a RLOS ‚Äî a linear feedback shift register, which moves 16 times. <br><br><img src="https://habrastorage.org/files/762/0c9/77d/7620c977dd064fc5b6428d13572d58c1.png"><br><br>  The register itself is realized over a Galois field modulo an irreducible polynomial of degree 8: <img src="https://habrastorage.org/files/b0f/a5f/1ae/b0fa5f1aebb14383a09dc7dd493dd6f0.png">  : <br><br><img width="50%" height="50%" src="https://habrastorage.org/files/7f2/d3e/32f/7f2d3e32f5d14ffd9f5272268b8d5b0e.png"><br><br>  Round conversion can be represented as follows: <br><br><img width="30%" height="30%" src="https://habrastorage.org/files/49d/03c/a78/49d03ca787f74c9591d789c8c74c2376.png"><br><br><h4>  Generation of round keys </h4><br>  Now consider the procedure for generating round keys from the master key.  The first two are obtained by splitting the master key in half.  Next, to generate the next pair of round keys, 8 iterations of the Feistel network are used, where, in turn, the counter sequence using the linear transformation of the algorithm is used as the round keys: <br><br><img src="https://habrastorage.org/files/81c/dd0/d80/81cdd0d801754b7893481768425273d9.png"><br><img src="https://habrastorage.org/files/a28/642/64e/a2864264e3be46f9ab1fc1d676e04fbf.png"><br><img src="https://habrastorage.org/files/7e0/487/6de/7e04876de820463bbf83926172848589.png"><br><br>  The key sweep round can be represented as follows: <br><br><img width="30%" height="30%" src="https://habrastorage.org/files/0d1/895/e83/0d1895e83af94ab7ac60d3c13cd2509d.png"><br><br>  And the whole procedure for generating round keys as follows: <br><br><img width="30%" height="30%" src="https://habrastorage.org/files/e11/d1e/2b2/e11d1e2b21d8417bb3e81a4e34001285.png"><br><br><h4>  Encryption and decryption </h4><br>  As a result, the encryption of a single 128-bit input block is described by the following equation: <br><br><img src="https://habrastorage.org/files/c97/5db/8e3/c975db8e31a446fa985a992f101aeb1d.png"><br><br>  And in the form of a flowchart can be represented as follows: <br><br><img width="20%" height="20%" src="https://habrastorage.org/files/120/3fc/c8f/1203fcc8f1c9483aa1055f70138aa2b3.png"><br><br>  Decryption is implemented by reversing the basic transformations and applying them in the reverse order: <br><br><img src="https://habrastorage.org/files/c30/ac9/a84/c30ac9a84ac1437492cd0d744de7c722.png"><br><br><h4>  Links </h4><br><ul><li>  The original description of the standard is available <a href="http://tc26.ru/standard/gost/GOST_R_3412-2015.pdf">here</a> . </li><li>  You can also download the <a href="">reference implementation</a> . </li><li>  In addition, Markku-Juhani Saarinen has his own realization on the <a href="https://github.com/mjosaarinen/kuznechik">githaba</a> . </li></ul></div><p>Source: <a href="https://habr.com/ru/post/266359/">https://habr.com/ru/post/266359/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../266349/index.html">Practical training in pentest laboratories. Part 1</a></li>
<li><a href="../266351/index.html">Battered banality. As a schoolboy bot wrote</a></li>
<li><a href="../266353/index.html">Ansible and Rails - flexible replacement for Capistrano while maintaining familiar comfort</a></li>
<li><a href="../266355/index.html">Firebase queue: steroids for firebase</a></li>
<li><a href="../266357/index.html">100 out of 100 in Google PageSpeed ‚Äã‚ÄãInsights (Bug or feature)?</a></li>
<li><a href="../266361/index.html">1–°: Programmers Club - Teacher‚Äôs View</a></li>
<li><a href="../266363/index.html">We draw on electronic map tiles in MSSQL</a></li>
<li><a href="../266367/index.html">We write a simple * game physics of the aircraft</a></li>
<li><a href="../266369/index.html">How to write dizdok</a></li>
<li><a href="../266371/index.html">Announcement of the third meeting of the Java User Group Sevastopol</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>