<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Internet map</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello to all! 

 I want to present you the Internet Map or the result of clustering more than 350 thousand sites in accordance with the transitions of...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Internet map</h1><div class="post__text post__text-html js-mediator-article">  Hello to all! <br><br>  I want to present you the <a href="http://internet-map.net/">Internet Map</a> or the result of clustering more than 350 thousand sites in accordance with the transitions of users between them.  The size of the circle is determined by the attendance of the site, the color - by nationality, and the position on the map - by its links to other sites.  If two sites have a steady stream of users between them, they will ‚Äútry‚Äù to get closer to each other.  After the completion of the algorithm, on the map one can observe clusters of sites (clusters) united by common users. <br><br> <a href="http://internet-map.net/"><img src="https://habrastorage.org/getpro/habr/post_images/8ae/6cc/4fc/8ae6cc4fcb1262b02dd5de44fa7b793a.jpg" alt="image"></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For example, if you type in the search for habrahabr.ru, you can see that dirty.ru and leprosorium.ru are in the same ‚Äúconstellation‚Äù, and even further away livejournal.ru.  This suggests that the one who is reading this text now also visits these sites with a high probability (with respect to the average Runet user of course). <br><br>  An even more interesting example of clustering can be seen at the bottom of the map, between violet Japan and yellowish Brazil: there is a whole pornostran located in sizes comparable to the whole Euronette.  Interestingly, being sufficiently competent in the question under consideration, within a large pornocluster, one can distinguish thematic subclusters of a smaller size. <br><br>  Those who are interested in a brief technical description - welcome under the cat <br><a name="habracut"></a><br><br><h4>  Engineering part </h4><br>  The entire project is written in C # and consists of three parts: a clustering program, a tile generation program, and a website.  Each part deserves separate consideration and, if there is interest, I could tell more about them later. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/50e/c49/6e4/50ec496e4c325b245ca46431a10fa58c.png" alt="image"><br><br>  The original data was taken from Alex, they are records of attendance, upstream and downstream transitions of users (upstream - where they came from, downstream - where they left).  After normalization, we get a weighted undirected graph with 350 thousand vertices and more than 2 million edges. <br><br>  Counting such a graph is a complicated computational task, so a special module for the GPU was written, but fortunately it was not needed.  After tricky optimizations, the entire calculation took several weeks of continuous work of powerful, but still household iron. <br><br>  To put it simply, the algorithm was to move the sites on the map in accordance with the forces acting on them.  Many user transitions - strong power tries to bring the sites together;  if the sites are too close, the repulsive force starts to work, etc.  More details can be found in this work <a href="http://reports-archive.adm.cs.cmu.edu/anon/1998/CMU-CS-98-189.pdf">reports-archive.adm.cs.cmu.edu/anon/1998/CMU-CS-98-189.pdf</a> <br><br>  The main problem was the enormous computational complexity of such an algorithm.  After all, when solving the problem ‚Äúin the forehead‚Äù, at each step it is necessary to calculate the superposition of forces for each site,  calculate forces for each pair of sites, and there are about 122 billion of such pairs (not bad for one step, right?).  Therefore, a strict optimization of the algorithm and complete parallelization of computations were carried out.  Fortunately, the .net platform was surprisingly good for this kind of fun. <br><br>  The second stage is the generation of tiles.  A tile is a small picture of 256x256 pixels of which the image of the map consists of on google maps, yandex and other services.  In general, nothing complicated - I generated a big picture, cut it into squares of the right size, business.  But there were almost 30 million of such pictures. Even just copying or deleting a directory with tiles in windows takes two days.  And pour them on the hosting a separate problem. <br><br>  The third stage is to fasten the google maps engine, put everything together and make it show the map.  Here, in general, there is nothing difficult, although there were some difficulties with the projections and positioning of the map. <br><br>  The last stage - the choice of hosting and release.  Here, too, was not without adventures.  Now everything is spinning in the Amazon cloud and it turned out to be much easier and cheaper than I imagined. <br><br>  In general, I have gained some experience, and I will be happy to share it with a respected community.  Of course, in general, nothing special, on Habr√© there are really interesting projects and non-trivial solutions, but still, I think, many of them may be interested. <br><br>  Also, I will be glad to any ideas, reviews, criticism - any feedback! <br><br>  <b>Thank you all for your kind words!</b>  <b>For me it was very important to get support from the professional community, from people who not only see the result, but understand how much work has been done to achieve it.</b>  <b>Also thanks to Habr for the fact that there is a platform in Runet uniting all of us!</b> <br><br>  Continued: <a href="http://habrahabr.ru/post/148721/">Web Map Web Architecture</a> </div><p>Source: <a href="https://habr.com/ru/post/148351/">https://habr.com/ru/post/148351/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148343/index.html">Clever waste bin from Japan picks it up on the fly</a></li>
<li><a href="../148344/index.html">Interactive glasses with built-in translator based on Raspberry Pi</a></li>
<li><a href="../148345/index.html">Business Card Reader 2.0 for Android - now with its card holder</a></li>
<li><a href="../148346/index.html">Did you pay for Mac OSX Lion? (in anticipation of Mountain Lion)</a></li>
<li><a href="../148348/index.html">Automatic generation of structure comparison operators in C ++</a></li>
<li><a href="../148353/index.html">HP P6000 system performance and best practices for organizing data storage</a></li>
<li><a href="../148356/index.html">10 myths of modern education</a></li>
<li><a href="../148357/index.html">How to achieve 10 million downloads or "guerilla marketing" for mobile applications</a></li>
<li><a href="../148358/index.html">What does it mean to be responsible in practical terms?</a></li>
<li><a href="../148359/index.html">How we connected our data center with the customer data center</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>