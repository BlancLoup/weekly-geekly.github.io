<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>On the experience of translating the asp.net mvc project to .net 4 (mvc 2)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! In this article I will tell you about my experience in converting an asp.net mvc project to .net 4. There is a post on the net called ASP.NET M...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>On the experience of translating the asp.net mvc project to .net 4 (mvc 2)</h1><div class="post__text post__text-html js-mediator-article">  Hello!  In this article I will tell you about my experience in converting an asp.net mvc project to .net 4. There is a post on the net called <a href="http://www.infoq.com/news/2010/03/ASP-MVC-Break">ASP.NET MVC 2 Brings Breaking Changes</a> .  Here you can familiarize yourself with the main innovations in asp.net mvc 2. My project migration experience concerns both this post and the fact that it is not mentioned.  I will say right away that after the conversion, the project was compiled, but was inoperable.  Did not respond to actions, or generated exceptions.  Let us analyze each feature I found in order. <a name="habracut"></a><br><br><h4>  Changed JsonResult behavior </h4><br>  Let's start with a class like JsonResult.  I work with him jQuery Grid.  In MVC 2, JsonResult by default began to invert JSON not valid for GET requests, i.e.  My grid received not valid JSON and could not reject it.  It is treated by changing the call. <br><br> <code>//convert to JSON and return to client <br> //  GET   MVC1 <br> return Json(result); <br> <br> //convert to JSON and return to client <br> //      MVC2,    <br> return Json(result,JsonRequestBehavior.AllowGet);</code> <br> <br><h4>  HTML helpers now generate only valid form element IDs. </h4><br>  In my project, the library is used for client-side and server-side validation based on validators and attributes from MS EnterpriseLibrary.  The code for validation on the client is generated by a special class.  The selection of form elements for validation on the client (script) is based on their ID.  MVC1 generated an ID based on the name of the object property being rendered, that is: <br> <code>&lt;%= Html.TextArea("_", Model._, 2, 30)%&gt;</code> <br>  Generated by: <br> <code>textarea cols="30" id="_" name="_" rows="2"</code> <br>  In MVC2, this behavior has changed: the helper generates only valid IDs, that is, in our case, not containing Cyrillic characters.  And ... client validation did not work, because  The ID of the item RealName was not generated, and the script tried to find it. <br>  Solving the problem for MVC2: <br> <code>&lt;%= Html.TextArea("_", Model._, 2, 30, new { id = "_" })%&gt;</code> <br> <br>  This is not a good decision, because  I'm using hard coding.  But thanks to the MVC pattern, you almost always know where you need it and what to change in case of changes in names.  In MVC2, typed helpers appeared that help get rid of this bad work with strings in views. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Binder to the empty fields of the html form instead of String.Empty assigns null </h4><br>  The essence is reflected in the title.  Suppose I have a nullable property in the class, but there is a validator on it: <br> <code>[StringLengthValidator(250, MessageTemplate = "  250 ")] <br> public string {get; set;}</code> <br> <br>  In MVC1, binder on a blank field sets String.Empty and the validator executes without errors.  String.Empty - a string of zero characters and it skips it. <br><br>  In MVC2, binder sets null, and the validator raises an exception.  Validation fails. <br><br>  To solve the problem, I did not write my binder, because  this adds extra complexity to the project.  I think that the project should have as few samopisnyh elements as possible, and for the sake of such a minor correction, it is impractical to write your binder. <br>  I changed the properties of the object as follows: <br>  (This piece of functionality is well localized, we can say that it does not introduce additional dependencies) <br><br> <code>[StringLengthValidator(250, MessageTemplate = "  250 ")] <br> public string  <br> { <br> get <br> { <br> return this._.; <br> } <br> set <br> { <br> if (value == null) this._. = string.Empty; <br> else <br> this._. = value; <br> } <br> }</code> <br> <br><h4>  Binder reads fields marked with bind = exclude </h4><br>  We have the following class: <br> <code>[System.Web.Mvc.Bind(Exclude = "_,_")] <br> public class View : IView <br> { <br> public View() <br> { <br> this._ = new (); <br> this._.Reference.EntityKey = <br> new System.Data.EntityKey("ModelWebUchetCon.", "_", 0); <br> this._.Reference.EntityKey = <br> new System.Data.EntityKey("ModelWebUchetCon.", "_", 0); <br> this._.Reference.EntityKey = <br> new System.Data.EntityKey("ModelWebUchetCon.", "_", 0); <br> this._.Reference.EntityKey = <br> new System.Data.EntityKey("ModelWebUchetCon.", "_", 0); <br> this._.Reference.EntityKey = <br> new System.Data.EntityKey("ModelWebUchetCon.", "_", 0); <br> this._. = string.Empty; <br> <br> } <br> public View( Base) <br> { <br> this._ = Base; <br> } <br> <br> }</code> <br>  We have two constructors - the first to create a completely new object, and the second to create an object based on an existing one.  The first constructor initializes its fields with values, which will then be rewritten.  In MVC1, binder works (for the purpose of validation, reading, writing) only with those fields that are not filtered by the Bind attribute, so I do not initialize them in the first constructor.  In MVC2, the validation of the entire model is used, that is, all object properties are checked for validity, and therefore all are read, including properties not initialized by the first constructor, and NullReference is raised.  To overcome this behavior, we had to turn on the logic for initializing these properties.  Maybe someone will write an attribute for the class, which disables the full validation of the model.  There is an example of <a href="http://blog.stevensanderson.com/2010/02/19/partial-validation-in-aspnet-mvc-2/">such an attribute</a> for the entire controller. <br><br><h4>  Changes in the web.config file </h4><br>  In .NET 4.0, web.config has visibly cleaned up.  Previously, all add-ins that appeared after .NET 2.0 were registered in this file.  Now that the new CLR has been released, this need has disappeared and you can noticeably clean your configs.  To ensure that everything goes smoothly I recommend doing this: <br><ul><li>  Make a backup of the old config. </li><li>  Create a new MVC2 project. </li><li>  Connect to the new project all the assemblies that you need in the project where we ‚Äúclean up configs‚Äù. </li><li>  Add a new config from the old: connection strings, app settings, data providers, everything related to security and, if available, your samopisnye moduls, handlers. </li><li>  Add a new config to the target project. </li></ul><br><h5>  Conclusion </h5><br>  As we know the transition to the new version of .net is not always painless.  Microsoft every two years pleases and disappoints us.  In this article, I described basically what made me somewhat disappointed and sweat. It was necessary to re-test the project, search for and fix non-obvious run-time errors (everything worked before).  True, I managed to find errors related to the fact that IE caches ajax requests.  That is, I found a real mistake that took place in the project.  There is a plus. </div><p>Source: <a href="https://habr.com/ru/post/96825/">https://habr.com/ru/post/96825/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../96818/index.html">Cardapio is a great replacement for the Ubuntu main menu.</a></li>
<li><a href="../96820/index.html">Rating of domain zones according to Verisign</a></li>
<li><a href="../96821/index.html">Updated free fonts for Linux Libertine, Linux Biolinum, as well as some of the Arkandis Digital Foundry fonts</a></li>
<li><a href="../96822/index.html">Hyper-V Architecture</a></li>
<li><a href="../96823/index.html">First call of Beltelecom</a></li>
<li><a href="../96826/index.html">Microsoft BizSpark a year and a half after the start - reviews from</a></li>
<li><a href="../96827/index.html">Configure client certificate authentication in IIS using OpenSSL</a></li>
<li><a href="../96828/index.html">CSS3 in IE 6-8 at any cost</a></li>
<li><a href="../96831/index.html">Petrik began to judge the journalists who defamed him</a></li>
<li><a href="../96833/index.html">old post that nobody wants</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>