<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Integrating the OneNote Services API into mobile apps</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, Microsoft introduced for developers a new OneNote Services API, which allows you to create notes in the user's Notebook directly from your a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Integrating the OneNote Services API into mobile apps</h1><div class="post__text post__text-html js-mediator-article">  Recently, Microsoft introduced for developers a new OneNote Services API, which allows you to create notes in the user's Notebook directly from your application.  At the moment, the API supports the creation of records consisting of text, html, URLs and images, as well as the creation of snapshots of web pages by URL (using Bing).  News360, as a partner of Microsoft, was among the first to integrate the API into all its mobile applications (iOS, Android, WinPhone and Windows 8).  Integration is easy - Microsoft provides Live SDK for iOS, Android and Windows, as well as REST API for web and mobile applications. <br><a name="habracut"></a><br>  Live SDK makes it possible to integrate OneNote at minimal cost, as it provides out-of-the-box authorization and greatly simplifies the entire process of creating records.  But News360 has its own subsystem of working with external APIs, which is based on the separation of the model and presentation when interacting with the API (authorization, sharing, etc.), so integration was done through REST.  But first things first. <br><br><h5>  Application registration </h5><br>  To integrate the OneNote Services API, you must first register your application via Live Connect <a href="https://account.live.com/developers/applications/create%3Ftou%3D1">here</a> . <br>  After registration you get ClientID and Secret.  If you integrate the API into a mobile application, you need to turn on the ‚ÄúMobile or desktop client app‚Äù setting in the Settings section of the API. <br><br><h5>  Authorization in the mobile application </h5><br>  In order for a user to create records in OneNote, he needs to log in with his Live ID. <br>  If you use the Live SDK, the integration is much simpler.  You will need ClientID and scope to allow entries.  Microsoft recommends using wl.signin office.onenote_create.  The Live SDK provides the entire UI required for authorization, and also provides storage of the credentials received. <br>  For authorization through REST, Microsoft provides a standard OAuth2 Authorization code flow. <br>  To obtain authorization code, go to WebView at: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> https://<span class="hljs-keyword"><span class="hljs-keyword">login</span></span>.live.com/oauth20_authorize.srf?client_id=&lt;your_client_id&gt;&amp;scope=&lt;your_scopes&gt;&amp;response_type=code&amp;redirect_uri=https://<span class="hljs-keyword"><span class="hljs-keyword">login</span></span>.live.com/oauth20_desktop.srf&amp;display=touch</code> </pre> <br>  The scope parameter should be ‚Äúwl.signin% 20office.onenote_create‚Äù.  If you plan to use long-lived tokens and the refresh-tokens mechanism, then you should also request the scope ‚Äúwl.offline_access‚Äù, then along with the access token you will have a refresh token, which you can use to refresh the access token without re-authorization.  In this case, the resulting scope will be ‚Äúwl.signin% 20wl.offline_access% 20office.onenote_create‚Äù. <br>  The redirect_uri parameter for mobile applications must be equal to ‚Äúhttps://login.live.com/oauth20_desktop.srf‚Äù. <br>  The display = touch parameter will provide a web page authorization optimized for mobile devices. <br><br>  After successful authorization, WebView will follow the link: <br><br><pre> <code class="hljs objectivec">https:<span class="hljs-comment"><span class="hljs-comment">//login.live.com/oauth20_desktop.srf?code=&lt;your_authorization_code&gt;</span></span></code> </pre> <br>  This transition needs to be processed and an authorization code derived from it. <br>  After that, you can hide the WebView and in any convenient way execute the query: <br><br><pre> <code class="hljs xml">POST https://login.live.com/oauth20_token.srf ‚Äúclient_id=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">your_clint_id</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;client_secret=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">your_secret</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;redirect_uri=https://login.live.com/oauth20_desktop.srf&amp;code=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">your_authorization_code</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;grant_type=authorization_code‚Äù</code> </pre> <br>  If everything is done correctly, then in response to this request you will get json with access token and expire date, as well as refresh token if you specify wl.offline_access in the scope. <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"access_token"</span></span> : <span class="hljs-string"><span class="hljs-string">"&lt;your_access_token&gt;"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"expires_in"</span></span> : &lt;expires_in_seconds&gt;, <span class="hljs-attr"><span class="hljs-attr">"refresh_token"</span></span> : <span class="hljs-string"><span class="hljs-string">"&lt;your_refresh_token&gt;"</span></span> }</code> </pre> <br>  Now access token can be used to create entries. <br><br><h5>  Access token update </h5><br>  The lifetime of the access token is 30 minutes and should be updated for a long time.  To update the access token you need to run a query <br><br><pre> <code class="hljs xml">POST https://login.live.com/oauth20_token.srf ‚Äúclient_id=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">your_clint_id</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;client_secret=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">your_secret</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;redirect_uri=https://login.live.com/oauth20_desktop.srf&amp;refresh_token=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">your_refresh_token</span></span></span><span class="hljs-tag">&gt;</span></span>&amp;grant_type=refresh_token‚Äù</code> </pre> <br>  The response must be processed in the same way as the initial access token. <br><br><h5>  Creating entries in OneNote </h5><br>  After successful login, you can create entries in OneNote.  At the moment, the API does not support notepad selection and creates all notes in a notebook called ‚ÄúQuick Notes‚Äù. <br>  Creating a record is very simple.  If you want to create a simple entry that contains text and images, as News360 does, then you need to set a simple html template like: <br><br><pre> <code class="hljs django"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">html</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">head</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">title</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Story title</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">title</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">\</span></span></span></span><span class="xml"><span class="hljs-tag">"</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">created</span></span></span></span><span class="xml"><span class="hljs-tag">\" </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">\</span></span></span></span><span class="xml"><span class="hljs-tag">"&lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ISO8601_date_string</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">\" /&gt;" </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">head</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">body</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">your_story_text</span></span></span></span><span class="xml"><span class="hljs-tag">/</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">html</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">body</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">html</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre><br>  You can also send html to body, which among other things supports the img tag. <br><br>  After filling in the template, you need to run the query: <br><br><pre> <code class="hljs pgsql">POST https://www.onenote.com/api/v1<span class="hljs-number"><span class="hljs-number">.0</span></span>/pages Content-<span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> : <span class="hljs-type"><span class="hljs-type">text</span></span>/html <span class="hljs-keyword"><span class="hljs-keyword">Authorization</span></span> : Bearer &lt;your_access_token&gt; "your_html_template_with_data"</code> </pre><br>  If everything is done correctly, json will come back with links to the record created: <br><br><pre> <code class="hljs erlang-repl"><span class="hljs-number"><span class="hljs-number">201</span></span> Created <span class="hljs-string"><span class="hljs-string">"{ "</span></span>links<span class="hljs-string"><span class="hljs-string">" : { "</span></span>oneNoteClientUrl<span class="hljs-string"><span class="hljs-string">" : {"</span></span>href<span class="hljs-string"><span class="hljs-string">" : "</span></span>onenote:https://...<span class="hljs-string"><span class="hljs-string">"}, "</span></span>oneNoteWebUrl<span class="hljs-string"><span class="hljs-string">" : {"</span></span>href<span class="hljs-string"><span class="hljs-string">" : "</span></span>https://...<span class="hljs-string"><span class="hljs-string">"} } }"</span></span></code> </pre><br>  These links can be used for deep linking and complement the user experience - a client url can be used to go to the OneNote client, if it is installed on the device, and web url to go to the web version. <br><br>  Thus, the integration of the OneNote Services API presents no difficulty, even when using the REST API for authorization.  I hope someone will find this article useful. <br><br>  Related link: <br>  <a href="http://blogs.office.com/2014/03/18/news360-a-news-app-that-learns/">Microsoft Office Blogs - News360 and OneNote</a> </div><p>Source: <a href="https://habr.com/ru/post/220169/">https://habr.com/ru/post/220169/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../220159/index.html">2500 Bunsen burners and sound wave imaging</a></li>
<li><a href="../220161/index.html">We treat problems with dialing a GPON router from MGTS</a></li>
<li><a href="../220163/index.html">Introduction to Marionette.js Behaviors</a></li>
<li><a href="../220165/index.html">Personal experience Web development in Mac OS X</a></li>
<li><a href="../220167/index.html">Kidhak Prehistorik 2: unlocked levels</a></li>
<li><a href="../220171/index.html">Big code theory - May 28-29 at DevCon 2014 conference</a></li>
<li><a href="../220173/index.html">Blogger Template Designer</a></li>
<li><a href="../220177/index.html">Cyclical and temporary shutdown of event receivers in SharePoint</a></li>
<li><a href="../220179/index.html">PRT Transport Management System</a></li>
<li><a href="../220181/index.html">Installing and configuring the LAMP web server for PHP development</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>