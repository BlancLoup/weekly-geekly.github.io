<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>C ++ tricks and tips from Boost for every day</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In a recent post, habrovchane voted for the chapters from the book to be translated into Russian. A little thought, I decided to cheat, and instead of...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>C ++ tricks and tips from Boost for every day</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="https://habrastorage.org/getpro/habr/post_images/0ea/319/f67/0ea319f675357f8444c12181e0819ee6.png"><br>  In a recent <a href="http://habrahabr.ru/post/196008/">post,</a> habrovchane voted for the chapters from the book to be translated into Russian.  A little thought, I decided to cheat, and instead of translating the chapters from the open access, to tell about what is in the closed. <br><br>  In order not to violate the rights of publishers, this will not be a literal translation, but a squeeze from those techniques that may seem interesting even to people who do not work with Boost. <br><br>  What awaits you under the cut: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Avoid macro calls instead of functions, for example, max / min. </li><li>  We call the optimal function, using the example of std :: swap and its specialization in different namespaces. </li><li>  Faster insertion into std :: vector. </li><li>  Destructors in C ++ 11. </li></ul><br><a name="habracut"></a><br><br><h1>  Avoid macro calls instead of functions, for example, max / min. </h1><br>  Those who work a lot with Visual Studio must have come across the fact that min / max are macros.  Because of this, practically any min / max functions in any classes and namespaces are treated by the preprocessor as macro substitutions.  As a consequence, the following code examples do not compile: <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> max_int = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::numeric_limits&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;::max(); my_class_variable.max();</code> </pre> <br><br>  There are various ways to avoid macro calls instead of functions, but the most portable and short is to simply enclose the entire function call in parentheses (except for the parentheses themselves): <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> max_int = (<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::numeric_limits&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;::max)(); (my_class_variable.max)();</code> </pre><br><br>  Now the preprocessor will not accept max as a macro call and the code will compile correctly.  This trick works with all macros, not only with min / max, and is often used in Boost. <br><br><h1>  We call the optimal function, using the example of std :: swap and its specialization in different namespaces. </h1><br>  Imagine the situation: you need to exchange the values ‚Äã‚Äãof two variables in the most efficient way.  Usually, swap functions are used for this.  But the trouble is, we write a generalized code that should work with custom types: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">my_function</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value1</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value1</span></span></span><span class="hljs-class">) {</span></span> <span class="hljs-comment"><span class="hljs-comment">// ... std::swap(value1, value2); //   ! // ... }</span></span></code> </pre><br>  The non-optimal solution is that custom types can have their own swap function, which works much more efficiently than the standard version: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> some_namespace { <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">my_vector</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">swap</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(my_vector&amp; value1, my_vector&amp; value2)</span></span></span></span>; } <span class="hljs-comment"><span class="hljs-comment">// some_namespace</span></span></code> </pre><br>  A very simple solution to the problem is to fix the code as follows: <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">my_function</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value1</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">value1</span></span></span><span class="hljs-class">) {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::swap; <span class="hljs-comment"><span class="hljs-comment">// ... swap(value1, value2); // ... }</span></span></code> </pre><br>  Now the compiler will first try to find the swap function from the parameter namespaces value1 and value2.  In other words, if value1 and value2 are instances of the class some_namespace :: my_vector, then the compiler will first try to use the swap from some_namespace.  If the parameter spaces value1 and value2 do not have a swap function, the compiler will use std :: swap. <br><br>  Why is it that way?  Because the compiler must perform an Argument Dependent Lookup (aka Koenig Lookup) before attempting to make a function call from using.  This trick is used by boost :: swap, and boost :: numeric_cast uses a similar approach for the functions floor, ceil, etc. <br><br><h1>  Faster insertion into std :: vector. </h1><br>  Let's start with a rather trivial advice: if you know the number of elements that will be inserted into a vector, then before insertion you must call <i>reserve (the number of elements to insert)</i> : <br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; numbers; numbers.reserve(<span class="hljs-number"><span class="hljs-number">1000</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">1000</span></span>; ++i) numbers.push.back(i); <span class="hljs-comment"><span class="hljs-comment">// ...</span></span></code> </pre><br>  This advice is available in many programming tutorials, but for some reason it is often forgotten.  From recent examples where they forgot about it - Unity code (Ubuntu GUI). <br><br>  Now less trivial advice.  In C ++ 11, it was decided that std :: vector and a number of other containers can use move constructors and move-assignment operators for elements <b>only if</b> move constructors and move-assignment operators of these elements do not throw exceptions (well, or if the elements do not can be copied). <br><br>  In other words, in C ++ 11, for best performance, you should mark constructors and operators that do not throw exceptions, as <b>noexcept</b> . <br><br>  In addition to containers from the standard library, many classes from Boost are sensitive to noexcept, for example, boost :: variant and boost :: circular_buffer. <br><br><h1>  Destructors in C ++ 11. </h1><br>  Even before the C ++ 11 standard, throwing exceptions in destructors was considered a very bad tone.  In C ++ 11, this leads to the death of the application. <br><br>  In C ++ 11, <b>all</b> object destructors are automatically marked as <b>noexcept</b> .  This leads to the fact that if you have a class that throws an exception in the destructor, then in C ++ 11, std :: terminate () will be called in this case and the entire application will terminate without calling the destructors for the created objects. <br><br>  Of course, you can get around this, explicitly tell the compiler that the destructor throws an exception ... But is it not better to do everything for good? <br><br><h1>  Instead of totals </h1><br>  The book has many interesting things in C ++ and Boost, you can talk for a long time.  What would you like to hear first: </div><p>Source: <a href="https://habr.com/ru/post/206412/">https://habr.com/ru/post/206412/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../206400/index.html">About advertising</a></li>
<li><a href="../206402/index.html">Hamburg score</a></li>
<li><a href="../206404/index.html">How and how fast do you feel in your mind at the elementary level?</a></li>
<li><a href="../206408/index.html">5000 mAh Battery Case Cover for HTC One</a></li>
<li><a href="../206410/index.html">Original Tomb Raider released for iOS</a></li>
<li><a href="../206414/index.html">Split testing of the landing page. results</a></li>
<li><a href="../206416/index.html">Ruby: cheatsheet to explore</a></li>
<li><a href="../206418/index.html">What to do with Bitcoin us, ordinary people</a></li>
<li><a href="../206420/index.html">Python interpreter: what does a snake think? (part I-III)</a></li>
<li><a href="../206422/index.html">Four HeadHunter experiences in social networks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>