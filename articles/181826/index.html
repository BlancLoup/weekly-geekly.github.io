<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Modification of stock firmware for Android. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello Habr! 

 A few years ago, when I first met Android, I heard from my work colleague that Android provides for the ability to install modified or ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Modification of stock firmware for Android. Part 1</h1><div class="post__text post__text-html js-mediator-article">  Hello Habr! <br><br>  A few years ago, when I first met Android, I heard from my work colleague that Android provides for the ability to install modified or self-made firmware.  Frankly, then I was far from that.  And even half a year ago, I was hardly interested in such things.  Deep in my heart, I was sure that what the manufacturer was doing was already intended for normal use. <br><br>  What was my disappointment when I purchased a phone from China, where the use of Google, Skype, Facebook and other applications was forbidden by factory settings.  In principle, it was possible to close my eyes to some things, but when my phone did not imply the use of a Google account, I made a promise to make sure I didn't become so. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Half a year has passed and my custom firmware has been successfully used around the world. <br><br>  This series of articles will cover how to do reverse programming for Android, implement patches, tweaks, and mods. <br><a name="habracut"></a><br><h4>  Preamble </h4><br>  So!  Let's first define the concepts that will be used in <u>this</u> article.  Your usual understanding, however, can be very different. <br><br>  <b>Patch</b> - change or replacement of existing program code in order to modify the program's algorithm. <br>  <b>Mod</b> - as a rule, adding additional functionality to an existing program code without changing the algorithm. <br>  <b>Tweak</b> - improving the functionality of the program in order to facilitate access to system parameters. <br><br>  I also want to note that all the examples will be taken for the HTC phone, but this does not mean that this information cannot be used on other phones. <br><br>  I draw your attention to the fact that I, as an author, are not responsible for the possible loss of data on your phone as a result of using the information below. <br><br><h4>  Environment preparation </h4><br>  I can do without detailed instructions on how to use this or that software.  If you are interested in this article and you have finished reading these lines, then I hope that you are already an experienced user and have experience using, well, or at least experimenting in this area.  Instructions, articles and test results are fully available, however, as well as on Habr√©.  I will also manage without a description of some terms, otherwise the article will be very large and tedious.  We will write only on the case.  I am sure that your environment has been standing for a long time.  If not, I suggest to download and install. <br><br>  <b>1</b> .  <a href="http://developer.android.com/sdk/index.html"><b>Android SDK</b></a> .  This is an application development environment for Android.  In order to make modifications, we will definitely have to check our program code.  The development environment is the best we can use. <br>  <b>2</b>  <a href="http://forum.xda-developers.com/showthread.php%3Ft%3D633246"><b>Android Kitchen</b></a> .  This utility will allow you to work with images of the system partitions of the official well or unofficial firmware. <br>  <b>3</b>  <a href="http://java.decompiler.free.fr/%3Fq%3Djdgui"><b>JD-GUI</b></a> .  Decompiler for Java code.  Immediately, I note that this is the best decompiler in terms of ease of use. <br>  <b>4</b>  <a href="http://www.neshkov.com/dj.html"><b>DJ Java Decompiler</b></a> .  Another decompiler, or disassembler, as some like to call it, is Java programming code.  Not convenient in terms of use, but parses the code, which sometimes does not understand the JD-GUI. <br>  <b>5</b>  <a href="https://code.google.com/p/smali/"><b>smali</b></a> .  Another disassembler, but already <a href="http://ru.wikipedia.org/wiki/Dalvik_virtual_machine">dalvik</a> code.  smali is needed for disassembling, and backsmali for assembling code. <br>  <b>6</b>  <a href="https://code.google.com/p/dex2jar/"><b>dex2jar</b></a> .  A utility for converting executable files Dalvik code. <br><br><h4>  Firmware conversion </h4><br>  Of course, the firmware that you have on the phone from the manufacturer is optimized in order to reduce energy consumption.  In order to be able to change the firmware, it must be converted to a format that allows you to change the code.  It uses Android Kitchen.  You can of course with your hands, as I did before, until I found this very ‚Äúkitchen‚Äù.  How to pull the system area out of the phone, set the environment, make DEODEX firmware, you can read on the Internet.  If you don‚Äôt already understand anything, I think you should postpone the article until you gain enough experience. <br><br>  After the firmware from the optimized view (ODEX - optimized dalvik executable code, if memory serves me) became DEODEX (that is, NOT optimized), all executable files are ready for modification. <br><br><h4>  Directly modifications </h4><br><h5>  Creating patches </h5><br>  As I already told, my phone initially had a ban on using Google.  Well, at least you burst, do not go to Playstore, do not configure your account, the phone book does not really synchronize.  Why do you need such an Android?  Long digging into the logs (logcat) of the device itself, I found records that said that using Google is prohibited.  The most inconvenient in Android, you see the log, but do not know which system application produces it.  To find where my legs grow from, I had to gut all system applications to disassembled Java code.  It took a lot of time, but I still use the work done in analyzing and searching for the right code.  The steps to get this tool are as follows: <br>  <b>1</b> .  Make deodex all firmware <br>  <b>2</b>  Your new DEODEX firmware will need to be assembled and flashed to your phone.  How this is done is the topic of another article. <br>  <b>3</b>  From each file located in / system / framework, pull out the classes.dex file and convert to JAR using dex2jar. <br>  <b>4</b>  Open each JAR in the JD-GUI and re-save it to the source code. <br>  <b>5</b>  Unpack the source code from the archive. <br><br>  As a result, I got as many folders as there were JAR files in the / system / framework, and each folder had a Java source code structure. <br>  By simple manipulations, I quickly found the place that generated the logcat entries. <br><br>  We will not consider the entire logic of the ban, as for each case it is a separate story.  I had to spend a couple of hours before I found where the checks are being made, build in my head a block diagram of the algorithm and understand where to go to get the algorithm a little bit ‚Äúspoil‚Äù. <br><br>  It turned out all simple.  There is a subroutine that, on the basis of predetermined constants, responded to the call when it came to whether the phone belongs to China or not. <br><br>  The code was in the file <i>HTCExtension.jar</i> , and the class that contained this subroutine was in <i>\ com \ htc \ util \ contacts \ BuildUtils $ Customization.java</i> <br><br><h6>  Unpacking and analyzing the original file </h6><br>  <b>1</b> .  First we need to take the original DEODEX JAR file, which is responsible for the part of the code we need.  In our case, <i>HTCExtension.jar</i> . <br>  <b>2</b>  Open with any archiver and pull classes.dex from there <br>  <b>3</b>  Using dex2jar converter, convert it to a JAR file.  Team: <code>dex2jar.bat classes.dex</code> <br>  <b>4</b>  View the received classes_dex2jar.jar file in the JD-GUI. <br>  <b>5</b>  Yes, most often JD-GUI decompiles the code not as it looks in the original, it is understandable, but it is quite possible to read.  In the source code, we see that the subroutine checks the project parameters and the language flag of the firmware.  In our unfortunate case, it returns TRUE. <br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">216</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">218</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">23</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">27</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> </pre><br>  <b>6</b>  To make a patch, we need to disassemble the Dalvik code itself.  For this we use baksmali.  The most convenient way is to create a separate folder and put there three files together: <i>HTCExtension.jar</i> , <i>smali.jar</i> and <i>baksmali.jar</i> .  Give the <code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code></code> command <code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code></code> <code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <pre> <code class="hljs java"><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  <span class="hljs-number"><span class="hljs-number">16</span></span> <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a <span class="hljs-number"><span class="hljs-number">16</span></span> -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .        HTCExtension,       Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">8</span></span></b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 3 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x1 .line 276 sget-</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> v1, Lcom/htc/htcjavaflag/HtcBuildFlag</span></span>;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xd8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xda</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x17</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v2, :cond_14 .line <span class="hljs-number"><span class="hljs-number">297</span></span> :cond_13 :goto_13 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v0 .line <span class="hljs-number"><span class="hljs-number">283</span></span> :cond_14 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v0, :cond_1d .line <span class="hljs-number"><span class="hljs-number">285</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v1, <span class="hljs-number"><span class="hljs-number">0x2</span></span> sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">291</span></span> :cond_1d sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x1b</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13 .end method</code> <br> <b><span class="hljs-number"><span class="hljs-number">9</span></span></b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x1</span></span></code>    v0  <span class="hljs-number"><span class="hljs-number">1</span></span>,   TRUE.    ,     ,    : <br> <code class="java"> .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13</code> <br> <b><span class="hljs-number"><span class="hljs-number">10</span></span></b> .       ,     : <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span></code> ,       <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     FALSE   JD-GUI     <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">216</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">218</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">23</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">27</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">11</span></span></b> . ,  , .        -  . -   .   -  <br> <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">12</span></span></b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b><span class="hljs-number"><span class="hljs-number">1</span></span></b> .  Android SDK. <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .   ,          <br> <code class="java"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.habrahabr.test; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }</code> <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .           . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .     ,      JAR . <br> <b><span class="hljs-number"><span class="hljs-number">5</span></span></b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b><span class="hljs-number"><span class="hljs-number">6</span></span></b> .        Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .    test.smali     <br> .<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue .line 7 </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">8</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">   </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> . Dalvik   ,       .     ,      .       . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .     ,     </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">   </span></span><i><span class="hljs-function"><span class="hljs-function">\com\htc\util\contacts\BuildUtils$Customization.java</span></span></i><span class="hljs-function"><span class="hljs-function"> . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="java"><span class="hljs-function"><span class="hljs-function">.method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .  . ,  ,   ,  Notepad++  EditPlus.   . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">     JAR  </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .   backsmali    JAR ,      . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><code><span class="hljs-function"><span class="hljs-function">java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .      </span></span><code><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">4</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">        </span></span><i><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></i><span class="hljs-function"><span class="hljs-function">     . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">5</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,  </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">      </span></span><br><span class="hljs-function"><span class="hljs-function"> ,      ,   recovery .     . -   , -          . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .       ,      DEODEX    root : </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="bash"><span class="hljs-function"><span class="hljs-function">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span></span>=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod <span class="hljs-number"><span class="hljs-number">644</span></span> /system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br> <span class="hljs-number"><span class="hljs-number">1</span></span>-       <br> <span class="hljs-number"><span class="hljs-number">2</span></span>-   shell <br> <span class="hljs-number"><span class="hljs-number">3</span></span>-   root  <br> <span class="hljs-number"><span class="hljs-number">4</span></span>-      / <br> <span class="hljs-number"><span class="hljs-number">5</span></span>-      <br> <span class="hljs-number"><span class="hljs-number">6</span></span>-      . <br> <span class="hljs-number"><span class="hljs-number">7</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">8</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">9</span></span>-    . <br> <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .      ,  . <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .         . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </pre> <code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <pre> <code class="hljs java"><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  <span class="hljs-number"><span class="hljs-number">16</span></span> <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a <span class="hljs-number"><span class="hljs-number">16</span></span> -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .        HTCExtension,       Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">8</span></span></b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 3 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x1 .line 276 sget-</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> v1, Lcom/htc/htcjavaflag/HtcBuildFlag</span></span>;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xd8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xda</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x17</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v2, :cond_14 .line <span class="hljs-number"><span class="hljs-number">297</span></span> :cond_13 :goto_13 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v0 .line <span class="hljs-number"><span class="hljs-number">283</span></span> :cond_14 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v0, :cond_1d .line <span class="hljs-number"><span class="hljs-number">285</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v1, <span class="hljs-number"><span class="hljs-number">0x2</span></span> sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">291</span></span> :cond_1d sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x1b</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13 .end method</code> <br> <b><span class="hljs-number"><span class="hljs-number">9</span></span></b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x1</span></span></code>    v0  <span class="hljs-number"><span class="hljs-number">1</span></span>,   TRUE.    ,     ,    : <br> <code class="java"> .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13</code> <br> <b><span class="hljs-number"><span class="hljs-number">10</span></span></b> .       ,     : <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span></code> ,       <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     FALSE   JD-GUI     <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">216</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">218</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">23</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">27</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">11</span></span></b> . ,  , .        -  . -   .   -  <br> <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">12</span></span></b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b><span class="hljs-number"><span class="hljs-number">1</span></span></b> .  Android SDK. <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .   ,          <br> <code class="java"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.habrahabr.test; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }</code> <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .           . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .     ,      JAR . <br> <b><span class="hljs-number"><span class="hljs-number">5</span></span></b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b><span class="hljs-number"><span class="hljs-number">6</span></span></b> .        Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .    test.smali     <br> .<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue .line 7 </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">8</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">   </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> . Dalvik   ,       .     ,      .       . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .     ,     </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">   </span></span><i><span class="hljs-function"><span class="hljs-function">\com\htc\util\contacts\BuildUtils$Customization.java</span></span></i><span class="hljs-function"><span class="hljs-function"> . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="java"><span class="hljs-function"><span class="hljs-function">.method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .  . ,  ,   ,  Notepad++  EditPlus.   . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">     JAR  </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .   backsmali    JAR ,      . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><code><span class="hljs-function"><span class="hljs-function">java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .      </span></span><code><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">4</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">        </span></span><i><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></i><span class="hljs-function"><span class="hljs-function">     . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">5</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,  </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">      </span></span><br><span class="hljs-function"><span class="hljs-function"> ,      ,   recovery .     . -   , -          . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .       ,      DEODEX    root : </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="bash"><span class="hljs-function"><span class="hljs-function">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span></span>=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod <span class="hljs-number"><span class="hljs-number">644</span></span> /system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br> <span class="hljs-number"><span class="hljs-number">1</span></span>-       <br> <span class="hljs-number"><span class="hljs-number">2</span></span>-   shell <br> <span class="hljs-number"><span class="hljs-number">3</span></span>-   root  <br> <span class="hljs-number"><span class="hljs-number">4</span></span>-      / <br> <span class="hljs-number"><span class="hljs-number">5</span></span>-      <br> <span class="hljs-number"><span class="hljs-number">6</span></span>-      . <br> <span class="hljs-number"><span class="hljs-number">7</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">8</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">9</span></span>-    . <br> <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .      ,  . <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .         . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </pre> <code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <pre> <code class="hljs java"><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  <span class="hljs-number"><span class="hljs-number">16</span></span> <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a <span class="hljs-number"><span class="hljs-number">16</span></span> -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .        HTCExtension,       Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">8</span></span></b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 3 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x1 .line 276 sget-</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> v1, Lcom/htc/htcjavaflag/HtcBuildFlag</span></span>;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xd8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xda</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x17</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v2, :cond_14 .line <span class="hljs-number"><span class="hljs-number">297</span></span> :cond_13 :goto_13 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v0 .line <span class="hljs-number"><span class="hljs-number">283</span></span> :cond_14 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v0, :cond_1d .line <span class="hljs-number"><span class="hljs-number">285</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v1, <span class="hljs-number"><span class="hljs-number">0x2</span></span> sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">291</span></span> :cond_1d sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x1b</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13 .end method</code> <br> <b><span class="hljs-number"><span class="hljs-number">9</span></span></b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x1</span></span></code>    v0  <span class="hljs-number"><span class="hljs-number">1</span></span>,   TRUE.    ,     ,    : <br> <code class="java"> .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13</code> <br> <b><span class="hljs-number"><span class="hljs-number">10</span></span></b> .       ,     : <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span></code> ,       <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     FALSE   JD-GUI     <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">216</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">218</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">23</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">27</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">11</span></span></b> . ,  , .        -  . -   .   -  <br> <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">12</span></span></b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b><span class="hljs-number"><span class="hljs-number">1</span></span></b> .  Android SDK. <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .   ,          <br> <code class="java"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.habrahabr.test; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }</code> <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .           . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .     ,      JAR . <br> <b><span class="hljs-number"><span class="hljs-number">5</span></span></b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b><span class="hljs-number"><span class="hljs-number">6</span></span></b> .        Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .    test.smali     <br> .<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue .line 7 </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">8</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">   </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> . Dalvik   ,       .     ,      .       . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .     ,     </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">   </span></span><i><span class="hljs-function"><span class="hljs-function">\com\htc\util\contacts\BuildUtils$Customization.java</span></span></i><span class="hljs-function"><span class="hljs-function"> . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="java"><span class="hljs-function"><span class="hljs-function">.method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .  . ,  ,   ,  Notepad++  EditPlus.   . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">     JAR  </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .   backsmali    JAR ,      . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><code><span class="hljs-function"><span class="hljs-function">java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .      </span></span><code><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">4</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">        </span></span><i><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></i><span class="hljs-function"><span class="hljs-function">     . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">5</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,  </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">      </span></span><br><span class="hljs-function"><span class="hljs-function"> ,      ,   recovery .     . -   , -          . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .       ,      DEODEX    root : </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="bash"><span class="hljs-function"><span class="hljs-function">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span></span>=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod <span class="hljs-number"><span class="hljs-number">644</span></span> /system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br> <span class="hljs-number"><span class="hljs-number">1</span></span>-       <br> <span class="hljs-number"><span class="hljs-number">2</span></span>-   shell <br> <span class="hljs-number"><span class="hljs-number">3</span></span>-   root  <br> <span class="hljs-number"><span class="hljs-number">4</span></span>-      / <br> <span class="hljs-number"><span class="hljs-number">5</span></span>-      <br> <span class="hljs-number"><span class="hljs-number">6</span></span>-      . <br> <span class="hljs-number"><span class="hljs-number">7</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">8</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">9</span></span>-    . <br> <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .      ,  . <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .         . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </pre> <code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <pre> <code class="hljs java"><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  <span class="hljs-number"><span class="hljs-number">16</span></span> <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a <span class="hljs-number"><span class="hljs-number">16</span></span> -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .        HTCExtension,       Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">8</span></span></b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 3 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x1 .line 276 sget-</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> v1, Lcom/htc/htcjavaflag/HtcBuildFlag</span></span>;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xd8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xda</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x17</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v2, :cond_14 .line <span class="hljs-number"><span class="hljs-number">297</span></span> :cond_13 :goto_13 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v0 .line <span class="hljs-number"><span class="hljs-number">283</span></span> :cond_14 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v0, :cond_1d .line <span class="hljs-number"><span class="hljs-number">285</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v1, <span class="hljs-number"><span class="hljs-number">0x2</span></span> sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">291</span></span> :cond_1d sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x1b</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13 .end method</code> <br> <b><span class="hljs-number"><span class="hljs-number">9</span></span></b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x1</span></span></code>    v0  <span class="hljs-number"><span class="hljs-number">1</span></span>,   TRUE.    ,     ,    : <br> <code class="java"> .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13</code> <br> <b><span class="hljs-number"><span class="hljs-number">10</span></span></b> .       ,     : <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span></code> ,       <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     FALSE   JD-GUI     <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">216</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">218</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">23</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">27</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">11</span></span></b> . ,  , .        -  . -   .   -  <br> <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">12</span></span></b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b><span class="hljs-number"><span class="hljs-number">1</span></span></b> .  Android SDK. <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .   ,          <br> <code class="java"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.habrahabr.test; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }</code> <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .           . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .     ,      JAR . <br> <b><span class="hljs-number"><span class="hljs-number">5</span></span></b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b><span class="hljs-number"><span class="hljs-number">6</span></span></b> .        Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .    test.smali     <br> .<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue .line 7 </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">8</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">   </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> . Dalvik   ,       .     ,      .       . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .     ,     </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">   </span></span><i><span class="hljs-function"><span class="hljs-function">\com\htc\util\contacts\BuildUtils$Customization.java</span></span></i><span class="hljs-function"><span class="hljs-function"> . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="java"><span class="hljs-function"><span class="hljs-function">.method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .  . ,  ,   ,  Notepad++  EditPlus.   . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">     JAR  </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .   backsmali    JAR ,      . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><code><span class="hljs-function"><span class="hljs-function">java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .      </span></span><code><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">4</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">        </span></span><i><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></i><span class="hljs-function"><span class="hljs-function">     . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">5</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,  </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">      </span></span><br><span class="hljs-function"><span class="hljs-function"> ,      ,   recovery .     . -   , -          . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .       ,      DEODEX    root : </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="bash"><span class="hljs-function"><span class="hljs-function">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span></span>=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod <span class="hljs-number"><span class="hljs-number">644</span></span> /system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br> <span class="hljs-number"><span class="hljs-number">1</span></span>-       <br> <span class="hljs-number"><span class="hljs-number">2</span></span>-   shell <br> <span class="hljs-number"><span class="hljs-number">3</span></span>-   root  <br> <span class="hljs-number"><span class="hljs-number">4</span></span>-      / <br> <span class="hljs-number"><span class="hljs-number">5</span></span>-      <br> <span class="hljs-number"><span class="hljs-number">6</span></span>-      . <br> <span class="hljs-number"><span class="hljs-number">7</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">8</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">9</span></span>-    . <br> <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .      ,  . <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .         . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </pre> <code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <pre> <code class="hljs java"><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  <span class="hljs-number"><span class="hljs-number">16</span></span> <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a <span class="hljs-number"><span class="hljs-number">16</span></span> -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .        HTCExtension,       Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">8</span></span></b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 3 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x1 .line 276 sget-</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> v1, Lcom/htc/htcjavaflag/HtcBuildFlag</span></span>;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xd8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xda</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x17</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v2, :cond_14 .line <span class="hljs-number"><span class="hljs-number">297</span></span> :cond_13 :goto_13 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v0 .line <span class="hljs-number"><span class="hljs-number">283</span></span> :cond_14 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v0, :cond_1d .line <span class="hljs-number"><span class="hljs-number">285</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v1, <span class="hljs-number"><span class="hljs-number">0x2</span></span> sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">291</span></span> :cond_1d sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x1b</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13 .end method</code> <br> <b><span class="hljs-number"><span class="hljs-number">9</span></span></b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x1</span></span></code>    v0  <span class="hljs-number"><span class="hljs-number">1</span></span>,   TRUE.    ,     ,    : <br> <code class="java"> .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13</code> <br> <b><span class="hljs-number"><span class="hljs-number">10</span></span></b> .       ,     : <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span></code> ,       <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     FALSE   JD-GUI     <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">216</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">218</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">23</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">27</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">11</span></span></b> . ,  , .        -  . -   .   -  <br> <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">12</span></span></b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b><span class="hljs-number"><span class="hljs-number">1</span></span></b> .  Android SDK. <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .   ,          <br> <code class="java"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.habrahabr.test; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }</code> <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .           . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .     ,      JAR . <br> <b><span class="hljs-number"><span class="hljs-number">5</span></span></b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b><span class="hljs-number"><span class="hljs-number">6</span></span></b> .        Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .    test.smali     <br> .<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue .line 7 </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">8</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">   </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> . Dalvik   ,       .     ,      .       . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .     ,     </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">   </span></span><i><span class="hljs-function"><span class="hljs-function">\com\htc\util\contacts\BuildUtils$Customization.java</span></span></i><span class="hljs-function"><span class="hljs-function"> . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="java"><span class="hljs-function"><span class="hljs-function">.method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .  . ,  ,   ,  Notepad++  EditPlus.   . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">     JAR  </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .   backsmali    JAR ,      . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><code><span class="hljs-function"><span class="hljs-function">java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .      </span></span><code><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">4</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">        </span></span><i><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></i><span class="hljs-function"><span class="hljs-function">     . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">5</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,  </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">      </span></span><br><span class="hljs-function"><span class="hljs-function"> ,      ,   recovery .     . -   , -          . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .       ,      DEODEX    root : </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="bash"><span class="hljs-function"><span class="hljs-function">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span></span>=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod <span class="hljs-number"><span class="hljs-number">644</span></span> /system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br> <span class="hljs-number"><span class="hljs-number">1</span></span>-       <br> <span class="hljs-number"><span class="hljs-number">2</span></span>-   shell <br> <span class="hljs-number"><span class="hljs-number">3</span></span>-   root  <br> <span class="hljs-number"><span class="hljs-number">4</span></span>-      / <br> <span class="hljs-number"><span class="hljs-number">5</span></span>-      <br> <span class="hljs-number"><span class="hljs-number">6</span></span>-      . <br> <span class="hljs-number"><span class="hljs-number">7</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">8</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">9</span></span>-    . <br> <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .      ,  . <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .         . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </pre> <code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <pre> <code class="hljs java"><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  <span class="hljs-number"><span class="hljs-number">16</span></span> <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a <span class="hljs-number"><span class="hljs-number">16</span></span> -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .        HTCExtension,       Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">8</span></span></b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 3 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x1 .line 276 sget-</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> v1, Lcom/htc/htcjavaflag/HtcBuildFlag</span></span>;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xd8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xda</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x17</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v2, :cond_14 .line <span class="hljs-number"><span class="hljs-number">297</span></span> :cond_13 :goto_13 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v0 .line <span class="hljs-number"><span class="hljs-number">283</span></span> :cond_14 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v0, :cond_1d .line <span class="hljs-number"><span class="hljs-number">285</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v1, <span class="hljs-number"><span class="hljs-number">0x2</span></span> sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">291</span></span> :cond_1d sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x1b</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13 .end method</code> <br> <b><span class="hljs-number"><span class="hljs-number">9</span></span></b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x1</span></span></code>    v0  <span class="hljs-number"><span class="hljs-number">1</span></span>,   TRUE.    ,     ,    : <br> <code class="java"> .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13</code> <br> <b><span class="hljs-number"><span class="hljs-number">10</span></span></b> .       ,     : <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span></code> ,       <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     FALSE   JD-GUI     <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">216</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">218</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">23</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">27</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">11</span></span></b> . ,  , .        -  . -   .   -  <br> <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">12</span></span></b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b><span class="hljs-number"><span class="hljs-number">1</span></span></b> .  Android SDK. <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .   ,          <br> <code class="java"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.habrahabr.test; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }</code> <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .           . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .     ,      JAR . <br> <b><span class="hljs-number"><span class="hljs-number">5</span></span></b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b><span class="hljs-number"><span class="hljs-number">6</span></span></b> .        Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .    test.smali     <br> .<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue .line 7 </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">8</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">   </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> . Dalvik   ,       .     ,      .       . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .     ,     </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">   </span></span><i><span class="hljs-function"><span class="hljs-function">\com\htc\util\contacts\BuildUtils$Customization.java</span></span></i><span class="hljs-function"><span class="hljs-function"> . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="java"><span class="hljs-function"><span class="hljs-function">.method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .  . ,  ,   ,  Notepad++  EditPlus.   . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">     JAR  </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .   backsmali    JAR ,      . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><code><span class="hljs-function"><span class="hljs-function">java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .      </span></span><code><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">4</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">        </span></span><i><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></i><span class="hljs-function"><span class="hljs-function">     . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">5</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,  </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">      </span></span><br><span class="hljs-function"><span class="hljs-function"> ,      ,   recovery .     . -   , -          . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .       ,      DEODEX    root : </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="bash"><span class="hljs-function"><span class="hljs-function">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span></span>=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod <span class="hljs-number"><span class="hljs-number">644</span></span> /system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br> <span class="hljs-number"><span class="hljs-number">1</span></span>-       <br> <span class="hljs-number"><span class="hljs-number">2</span></span>-   shell <br> <span class="hljs-number"><span class="hljs-number">3</span></span>-   root  <br> <span class="hljs-number"><span class="hljs-number">4</span></span>-      / <br> <span class="hljs-number"><span class="hljs-number">5</span></span>-      <br> <span class="hljs-number"><span class="hljs-number">6</span></span>-      . <br> <span class="hljs-number"><span class="hljs-number">7</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">8</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">9</span></span>-    . <br> <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .      ,  . <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .         . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </pre> <code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <h6> <code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </h6> <code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <pre> <code class="hljs java"><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  <span class="hljs-number"><span class="hljs-number">16</span></span> <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a <span class="hljs-number"><span class="hljs-number">16</span></span> -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .        HTCExtension,       Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">8</span></span></b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 3 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x1 .line 276 sget-</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> v1, Lcom/htc/htcjavaflag/HtcBuildFlag</span></span>;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xd8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xda</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x17</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v2, :cond_14 .line <span class="hljs-number"><span class="hljs-number">297</span></span> :cond_13 :goto_13 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v0 .line <span class="hljs-number"><span class="hljs-number">283</span></span> :cond_14 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v0, :cond_1d .line <span class="hljs-number"><span class="hljs-number">285</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v1, <span class="hljs-number"><span class="hljs-number">0x2</span></span> sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">291</span></span> :cond_1d sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x1b</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13 .end method</code> <br> <b><span class="hljs-number"><span class="hljs-number">9</span></span></b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x1</span></span></code>    v0  <span class="hljs-number"><span class="hljs-number">1</span></span>,   TRUE.    ,     ,    : <br> <code class="java"> .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13</code> <br> <b><span class="hljs-number"><span class="hljs-number">10</span></span></b> .       ,     : <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span></code> ,       <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     FALSE   JD-GUI     <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">216</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">218</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">23</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">27</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">11</span></span></b> . ,  , .        -  . -   .   -  <br> <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">12</span></span></b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b><span class="hljs-number"><span class="hljs-number">1</span></span></b> .  Android SDK. <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .   ,          <br> <code class="java"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.habrahabr.test; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }</code> <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .           . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .     ,      JAR . <br> <b><span class="hljs-number"><span class="hljs-number">5</span></span></b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b><span class="hljs-number"><span class="hljs-number">6</span></span></b> .        Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .    test.smali     <br> .<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue .line 7 </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">8</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">   </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> . Dalvik   ,       .     ,      .       . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .     ,     </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">   </span></span><i><span class="hljs-function"><span class="hljs-function">\com\htc\util\contacts\BuildUtils$Customization.java</span></span></i><span class="hljs-function"><span class="hljs-function"> . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="java"><span class="hljs-function"><span class="hljs-function">.method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .  . ,  ,   ,  Notepad++  EditPlus.   . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">     JAR  </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .   backsmali    JAR ,      . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><code><span class="hljs-function"><span class="hljs-function">java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .      </span></span><code><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">4</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">        </span></span><i><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></i><span class="hljs-function"><span class="hljs-function">     . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">5</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,  </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">      </span></span><br><span class="hljs-function"><span class="hljs-function"> ,      ,   recovery .     . -   , -          . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .       ,      DEODEX    root : </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="bash"><span class="hljs-function"><span class="hljs-function">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span></span>=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod <span class="hljs-number"><span class="hljs-number">644</span></span> /system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br> <span class="hljs-number"><span class="hljs-number">1</span></span>-       <br> <span class="hljs-number"><span class="hljs-number">2</span></span>-   shell <br> <span class="hljs-number"><span class="hljs-number">3</span></span>-   root  <br> <span class="hljs-number"><span class="hljs-number">4</span></span>-      / <br> <span class="hljs-number"><span class="hljs-number">5</span></span>-      <br> <span class="hljs-number"><span class="hljs-number">6</span></span>-      . <br> <span class="hljs-number"><span class="hljs-number">7</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">8</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">9</span></span>-    . <br> <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .      ,  . <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .         . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </pre> <code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <pre> <code class="hljs java"><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  <span class="hljs-number"><span class="hljs-number">16</span></span> <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a <span class="hljs-number"><span class="hljs-number">16</span></span> -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .        HTCExtension,       Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">8</span></span></b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 3 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x1 .line 276 sget-</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> v1, Lcom/htc/htcjavaflag/HtcBuildFlag</span></span>;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xd8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xda</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x17</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v2, :cond_14 .line <span class="hljs-number"><span class="hljs-number">297</span></span> :cond_13 :goto_13 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v0 .line <span class="hljs-number"><span class="hljs-number">283</span></span> :cond_14 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v0, :cond_1d .line <span class="hljs-number"><span class="hljs-number">285</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v1, <span class="hljs-number"><span class="hljs-number">0x2</span></span> sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">291</span></span> :cond_1d sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x1b</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13 .end method</code> <br> <b><span class="hljs-number"><span class="hljs-number">9</span></span></b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x1</span></span></code>    v0  <span class="hljs-number"><span class="hljs-number">1</span></span>,   TRUE.    ,     ,    : <br> <code class="java"> .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13</code> <br> <b><span class="hljs-number"><span class="hljs-number">10</span></span></b> .       ,     : <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span></code> ,       <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     FALSE   JD-GUI     <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">216</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">218</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">23</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">27</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">11</span></span></b> . ,  , .        -  . -   .   -  <br> <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">12</span></span></b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b><span class="hljs-number"><span class="hljs-number">1</span></span></b> .  Android SDK. <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .   ,          <br> <code class="java"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.habrahabr.test; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }</code> <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .           . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .     ,      JAR . <br> <b><span class="hljs-number"><span class="hljs-number">5</span></span></b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b><span class="hljs-number"><span class="hljs-number">6</span></span></b> .        Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .    test.smali     <br> .<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue .line 7 </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">8</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">   </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> . Dalvik   ,       .     ,      .       . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .     ,     </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">   </span></span><i><span class="hljs-function"><span class="hljs-function">\com\htc\util\contacts\BuildUtils$Customization.java</span></span></i><span class="hljs-function"><span class="hljs-function"> . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="java"><span class="hljs-function"><span class="hljs-function">.method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .  . ,  ,   ,  Notepad++  EditPlus.   . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">     JAR  </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .   backsmali    JAR ,      . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><code><span class="hljs-function"><span class="hljs-function">java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .      </span></span><code><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">4</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">        </span></span><i><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></i><span class="hljs-function"><span class="hljs-function">     . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">5</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,  </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">      </span></span><br><span class="hljs-function"><span class="hljs-function"> ,      ,   recovery .     . -   , -          . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .       ,      DEODEX    root : </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="bash"><span class="hljs-function"><span class="hljs-function">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span></span>=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod <span class="hljs-number"><span class="hljs-number">644</span></span> /system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br> <span class="hljs-number"><span class="hljs-number">1</span></span>-       <br> <span class="hljs-number"><span class="hljs-number">2</span></span>-   shell <br> <span class="hljs-number"><span class="hljs-number">3</span></span>-   root  <br> <span class="hljs-number"><span class="hljs-number">4</span></span>-      / <br> <span class="hljs-number"><span class="hljs-number">5</span></span>-      <br> <span class="hljs-number"><span class="hljs-number">6</span></span>-      . <br> <span class="hljs-number"><span class="hljs-number">7</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">8</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">9</span></span>-    . <br> <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .      ,  . <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .         . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </pre> <code><code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <h6> <code><code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </h6> <code><code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <pre> <code class="hljs java"><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  <span class="hljs-number"><span class="hljs-number">16</span></span> <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a <span class="hljs-number"><span class="hljs-number">16</span></span> -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .        HTCExtension,       Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">8</span></span></b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 3 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x1 .line 276 sget-</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> v1, Lcom/htc/htcjavaflag/HtcBuildFlag</span></span>;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xd8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xda</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x17</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v2, :cond_14 .line <span class="hljs-number"><span class="hljs-number">297</span></span> :cond_13 :goto_13 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v0 .line <span class="hljs-number"><span class="hljs-number">283</span></span> :cond_14 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v0, :cond_1d .line <span class="hljs-number"><span class="hljs-number">285</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v1, <span class="hljs-number"><span class="hljs-number">0x2</span></span> sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">291</span></span> :cond_1d sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x1b</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13 .end method</code> <br> <b><span class="hljs-number"><span class="hljs-number">9</span></span></b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x1</span></span></code>    v0  <span class="hljs-number"><span class="hljs-number">1</span></span>,   TRUE.    ,     ,    : <br> <code class="java"> .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13</code> <br> <b><span class="hljs-number"><span class="hljs-number">10</span></span></b> .       ,     : <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span></code> ,       <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     FALSE   JD-GUI     <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">216</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">218</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">23</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">27</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">11</span></span></b> . ,  , .        -  . -   .   -  <br> <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">12</span></span></b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b><span class="hljs-number"><span class="hljs-number">1</span></span></b> .  Android SDK. <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .   ,          <br> <code class="java"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.habrahabr.test; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }</code> <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .           . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .     ,      JAR . <br> <b><span class="hljs-number"><span class="hljs-number">5</span></span></b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b><span class="hljs-number"><span class="hljs-number">6</span></span></b> .        Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .    test.smali     <br> .<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue .line 7 </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">8</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">   </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> . Dalvik   ,       .     ,      .       . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .     ,     </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">   </span></span><i><span class="hljs-function"><span class="hljs-function">\com\htc\util\contacts\BuildUtils$Customization.java</span></span></i><span class="hljs-function"><span class="hljs-function"> . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="java"><span class="hljs-function"><span class="hljs-function">.method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .  . ,  ,   ,  Notepad++  EditPlus.   . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">     JAR  </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .   backsmali    JAR ,      . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><code><span class="hljs-function"><span class="hljs-function">java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .      </span></span><code><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">4</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">        </span></span><i><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></i><span class="hljs-function"><span class="hljs-function">     . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">5</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,  </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">      </span></span><br><span class="hljs-function"><span class="hljs-function"> ,      ,   recovery .     . -   , -          . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .       ,      DEODEX    root : </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="bash"><span class="hljs-function"><span class="hljs-function">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span></span>=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod <span class="hljs-number"><span class="hljs-number">644</span></span> /system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br> <span class="hljs-number"><span class="hljs-number">1</span></span>-       <br> <span class="hljs-number"><span class="hljs-number">2</span></span>-   shell <br> <span class="hljs-number"><span class="hljs-number">3</span></span>-   root  <br> <span class="hljs-number"><span class="hljs-number">4</span></span>-      / <br> <span class="hljs-number"><span class="hljs-number">5</span></span>-      <br> <span class="hljs-number"><span class="hljs-number">6</span></span>-      . <br> <span class="hljs-number"><span class="hljs-number">7</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">8</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">9</span></span>-    . <br> <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .      ,  . <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .         . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </pre> <code><code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <h6> <code><code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </h6> <code><code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <h6> <code><code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </h6> <code><code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <pre> <code class="hljs java"><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  <span class="hljs-number"><span class="hljs-number">16</span></span> <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a <span class="hljs-number"><span class="hljs-number">16</span></span> -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .        HTCExtension,       Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">8</span></span></b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 3 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x1 .line 276 sget-</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> v1, Lcom/htc/htcjavaflag/HtcBuildFlag</span></span>;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xd8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xda</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x17</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v2, :cond_14 .line <span class="hljs-number"><span class="hljs-number">297</span></span> :cond_13 :goto_13 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v0 .line <span class="hljs-number"><span class="hljs-number">283</span></span> :cond_14 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v0, :cond_1d .line <span class="hljs-number"><span class="hljs-number">285</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v1, <span class="hljs-number"><span class="hljs-number">0x2</span></span> sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">291</span></span> :cond_1d sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x1b</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13 .end method</code> <br> <b><span class="hljs-number"><span class="hljs-number">9</span></span></b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x1</span></span></code>    v0  <span class="hljs-number"><span class="hljs-number">1</span></span>,   TRUE.    ,     ,    : <br> <code class="java"> .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13</code> <br> <b><span class="hljs-number"><span class="hljs-number">10</span></span></b> .       ,     : <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span></code> ,       <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     FALSE   JD-GUI     <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">216</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">218</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">23</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">27</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">11</span></span></b> . ,  , .        -  . -   .   -  <br> <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">12</span></span></b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b><span class="hljs-number"><span class="hljs-number">1</span></span></b> .  Android SDK. <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .   ,          <br> <code class="java"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.habrahabr.test; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }</code> <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .           . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .     ,      JAR . <br> <b><span class="hljs-number"><span class="hljs-number">5</span></span></b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b><span class="hljs-number"><span class="hljs-number">6</span></span></b> .        Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .    test.smali     <br> .<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue .line 7 </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">8</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">   </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> . Dalvik   ,       .     ,      .       . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .     ,     </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">   </span></span><i><span class="hljs-function"><span class="hljs-function">\com\htc\util\contacts\BuildUtils$Customization.java</span></span></i><span class="hljs-function"><span class="hljs-function"> . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="java"><span class="hljs-function"><span class="hljs-function">.method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .  . ,  ,   ,  Notepad++  EditPlus.   . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">     JAR  </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .   backsmali    JAR ,      . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><code><span class="hljs-function"><span class="hljs-function">java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .      </span></span><code><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">4</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">        </span></span><i><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></i><span class="hljs-function"><span class="hljs-function">     . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">5</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,  </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">      </span></span><br><span class="hljs-function"><span class="hljs-function"> ,      ,   recovery .     . -   , -          . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .       ,      DEODEX    root : </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="bash"><span class="hljs-function"><span class="hljs-function">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span></span>=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod <span class="hljs-number"><span class="hljs-number">644</span></span> /system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br> <span class="hljs-number"><span class="hljs-number">1</span></span>-       <br> <span class="hljs-number"><span class="hljs-number">2</span></span>-   shell <br> <span class="hljs-number"><span class="hljs-number">3</span></span>-   root  <br> <span class="hljs-number"><span class="hljs-number">4</span></span>-      / <br> <span class="hljs-number"><span class="hljs-number">5</span></span>-      <br> <span class="hljs-number"><span class="hljs-number">6</span></span>-      . <br> <span class="hljs-number"><span class="hljs-number">7</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">8</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">9</span></span>-    . <br> <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .      ,  . <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .         . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </pre> <code><code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <pre> <code class="hljs java"><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  <span class="hljs-number"><span class="hljs-number">16</span></span> <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a <span class="hljs-number"><span class="hljs-number">16</span></span> -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .        HTCExtension,       Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">8</span></span></b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 3 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x1 .line 276 sget-</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> v1, Lcom/htc/htcjavaflag/HtcBuildFlag</span></span>;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xd8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0xda</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x17</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v2, :cond_14 .line <span class="hljs-number"><span class="hljs-number">297</span></span> :cond_13 :goto_13 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v0 .line <span class="hljs-number"><span class="hljs-number">283</span></span> :cond_14 sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-ne v1, v0, :cond_1d .line <span class="hljs-number"><span class="hljs-number">285</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v1, <span class="hljs-number"><span class="hljs-number">0x2</span></span> sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">291</span></span> :cond_1d sget-<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span> v2, <span class="hljs-number"><span class="hljs-number">0x1b</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-eq v1, v2, :cond_13 .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13 .end method</code> <br> <b><span class="hljs-number"><span class="hljs-number">9</span></span></b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x1</span></span></code>    v0  <span class="hljs-number"><span class="hljs-number">1</span></span>,   TRUE.    ,     ,    : <br> <code class="java"> .line <span class="hljs-number"><span class="hljs-number">297</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span> goto :goto_13</code> <br> <b><span class="hljs-number"><span class="hljs-number">10</span></span></b> .       ,     : <br> <code class="java"> .prologue <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> v0, <span class="hljs-number"><span class="hljs-number">0x0</span></span></code> ,       <span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">0</span></span>.      ,     FALSE   JD-GUI     <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">216</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">218</span></span>) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">23</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (((HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == <span class="hljs-number"><span class="hljs-number">27</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">11</span></span></b> . ,  , .        -  . -   .   -  <br> <code class="java"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> <br> <b><span class="hljs-number"><span class="hljs-number">12</span></span></b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b><span class="hljs-number"><span class="hljs-number">1</span></span></b> .  Android SDK. <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .   ,          <br> <code class="java"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.habrahabr.test; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }</code> <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .           . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .     ,      JAR . <br> <b><span class="hljs-number"><span class="hljs-number">5</span></span></b> .   <code><code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b><span class="hljs-number"><span class="hljs-number">6</span></span></b> .        Dalvik . <br> <b><span class="hljs-number"><span class="hljs-number">7</span></span></b> .    test.smali     <br> .<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue .line 7 </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">8</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">   </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> . Dalvik   ,       .     ,      .       . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .     ,     </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">   </span></span><i><span class="hljs-function"><span class="hljs-function">\com\htc\util\contacts\BuildUtils$Customization.java</span></span></i><span class="hljs-function"><span class="hljs-function"> . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="java"><span class="hljs-function"><span class="hljs-function">.method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isChina</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">Z .registers 1 .prologue </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">/4 v0, 0x0 return v0 .end method</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .  . ,  ,   ,  Notepad++  EditPlus.   . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">     JAR  </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .   backsmali    JAR ,      . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">2</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><code><span class="hljs-function"><span class="hljs-function">java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">3</span></span></b><span class="hljs-function"><span class="hljs-function"> .      </span></span><code><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></code><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">4</span></span></b><span class="hljs-function"><span class="hljs-function"> .   </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">        </span></span><i><span class="hljs-function"><span class="hljs-function">classes.dex</span></span></i><span class="hljs-function"><span class="hljs-function">     . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">5</span></span></b><span class="hljs-function"><span class="hljs-function"> . ,  </span></span><i><span class="hljs-function"><span class="hljs-function">HTCExtension.jar</span></span></i><span class="hljs-function"><span class="hljs-function">    . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function">      </span></span><br><span class="hljs-function"><span class="hljs-function"> ,      ,   recovery .     . -   , -          . </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><b><span class="hljs-function"><span class="hljs-function">1</span></span></b><span class="hljs-function"><span class="hljs-function"> .       ,      DEODEX    root : </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><br><span class="hljs-function"><span class="hljs-function"> </span></span><code class="bash"><span class="hljs-function"><span class="hljs-function">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span></span>=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod <span class="hljs-number"><span class="hljs-number">644</span></span> /system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br> <span class="hljs-number"><span class="hljs-number">1</span></span>-       <br> <span class="hljs-number"><span class="hljs-number">2</span></span>-   shell <br> <span class="hljs-number"><span class="hljs-number">3</span></span>-   root  <br> <span class="hljs-number"><span class="hljs-number">4</span></span>-      / <br> <span class="hljs-number"><span class="hljs-number">5</span></span>-      <br> <span class="hljs-number"><span class="hljs-number">6</span></span>-      . <br> <span class="hljs-number"><span class="hljs-number">7</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">8</span></span>-    <br> <span class="hljs-number"><span class="hljs-number">9</span></span>-    . <br> <br> <b><span class="hljs-number"><span class="hljs-number">2</span></span></b> .      ,  . <br> <b><span class="hljs-number"><span class="hljs-number">3</span></span></b> .         . <br> <b><span class="hljs-number"><span class="hljs-number">4</span></span></b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system<span class="hljs-meta"><span class="hljs-meta">@framework</span></span><span class="hljs-meta"><span class="hljs-meta">@HTCExtension</span></span>.jar<span class="hljs-meta"><span class="hljs-meta">@classes</span></span>.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </pre> <code><code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> <h4> <code><code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </h4> <code><code><code><code><code>java -Xmx512m -jar baksmali.jar -a -d -o HTCExtension -x HTCExtension.jar <br> <br> -  API   Android.  JB -  16 <br> - ,     . <br> <br>       <br> java -Xmx512m -jar baksmali.jar -a 16 -d S:\dev\Android\Android-Kitchen\WORKING_JB_15\system\framework -o HTCExtension -x HTCExtension.jar</code> <br> <b>7</b> .        HTCExtension,       Dalvik . <br> <b>8</b> .     <i>\com\htc\util\contacts\BuildUtils$Customization.java</i>   : <br> <code class="java">.method public static isChina()Z .registers 3 .prologue const/4 v0, 0x1 .line 276 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xd8 if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0xda if-eq v1, v2, :cond_13 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x17 if-ne v1, v2, :cond_14 .line 297 :cond_13 :goto_13 return v0 .line 283 :cond_14 sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S if-ne v1, v0, :cond_1d .line 285 const/4 v1, 0x2 sget-short v2, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_LANGUAGE_flag:S if-eq v1, v2, :cond_13 .line 291 :cond_1d sget-short v1, Lcom/htc/htcjavaflag/HtcBuildFlag;-&gt;Htc_PROJECT_flag:S const/16 v2, 0x1b if-eq v1, v2, :cond_13 .line 297 const/4 v0, 0x0 goto :goto_13 .end method</code> <br> <b>9</b> . ,   ?    . ,   .         ,        .   ,    <br> <code class="java"> .prologue const/4 v0, 0x1</code>    v0  1,   TRUE.    ,     ,    : <br> <code class="java"> .line 297 const/4 v0, 0x0 goto :goto_13</code> <br> <b>10</b> .       ,     : <br> <code class="java"> .prologue const/4 v0, 0x0</code> ,       1  0.      ,     FALSE   JD-GUI     <code class="java"> public static boolean isChina() { if ((HtcBuildFlag.Htc_PROJECT_flag == 216) || (HtcBuildFlag.Htc_PROJECT_flag == 218) || (HtcBuildFlag.Htc_PROJECT_flag == 23)); while (((HtcBuildFlag.Htc_PROJECT_flag == 1) &amp;&amp; (2 == HtcBuildFlag.Htc_LANGUAGE_flag)) || (HtcBuildFlag.Htc_PROJECT_flag == 27)) return false; return false; }</code> <br> <b>11</b> . ,  , .        -  . -   .   -  <br> <code class="java"> public static boolean isChina() { return false; }</code> <br> <b>12</b> .     Dalvik    ?      . <br> <br>  Dalvik  <br> <b>1</b> .  Android SDK. <br> <b>2</b> .   ,          <br> <code class="java">package ru.habrahabr.test; public class test { public static boolean isChina() { return false; } }</code> <br> <b>3</b> .           . <br> <b>4</b> .     ,      JAR . <br> <b>5</b> .   <code class="java">java -Xmx512m -jar baksmali.jar -a -d -o test -x test .apk <br> <b>6</b> .        Dalvik . <br> <b>7</b> .    test.smali     <br> .method public static isChina()Z .registers 1 .prologue .line 7 const/4 v0, 0x0 return v0 .end method</code> <br> <b>8</b> . ,    . <br> <br>   <br> <b>1</b> . Dalvik   ,       .     ,      .       . <br> <b>2</b> .     ,     ()   <i>\com\htc\util\contacts\BuildUtils$Customization.java</i> . <br> <code class="java">.method public static isChina()Z .registers 1 .prologue const/4 v0, 0x0 return v0 .end method</code> <br> <b>3</b> .  . ,  ,   ,  Notepad++  EditPlus.   . <br> <br>     JAR  <br> <b>1</b> .   backsmali    JAR ,      . <br> <b>2</b> .   <code>java -Xmx512m -jar smali.jar -a 16 HTCExtension -o classes.dex</code> <br> <b>3</b> .      <code>classes.dex</code> <br> <b>4</b> .   <i>HTCExtension.jar</i>        <i>classes.dex</i>     . <br> <b>5</b> . ,  <i>HTCExtension.jar</i>    . <br> <br>      <br> ,      ,   recovery .     . -   , -          . <br> <br> <b>1</b> .       ,      DEODEX    root : <br> <br> <code class="bash">adb push HTCExtension.jar /sdcard/HTCExtension.jar adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar of=/system/framework/HTCExtension.jar.back dd if=/sdcard/HTCExtension.jar of=/system/framework/HTCExtension.jar chmod 644 /system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br> 1-       <br> 2-   shell <br> 3-   root  <br> 4-      / <br> 5-      <br> 6-      . <br> 7-    <br> 8-    <br> 9-    . <br> <br> <b>2</b> .      ,  . <br> <b>3</b> .         . <br> <b>4</b> .       ,          . <br> <code class="bash">adb shell su mount -o remount -rw /system dd if=/system/framework/HTCExtension.jar.back of=/system/framework/HTCExtension.jar rm /data/dalvik-cache/system@framework@HTCExtension.jar@classes.dex reboot</code> <br> <br>  <br> , -     , - -,  - .                 . -,          . -,       ,  ,    . <br> <br>        .          .    . <br> <br> PS  -    ,   -      .</code></code></code></code> </div><p>Source: <a href="https://habr.com/ru/post/181826/">https://habr.com/ru/post/181826/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../181812/index.html">The new game system in Human Asteroids was tested by the founder of Atari (video)</a></li>
<li><a href="../181816/index.html">The digest of news from the world of mobile development for the last week # 14 (May 27 - June 2, 2013)</a></li>
<li><a href="../181820/index.html">The basics of layout for native Android applications</a></li>
<li><a href="../181822/index.html">10Gbit network storage at reasonable cost</a></li>
<li><a href="../181824/index.html">[Translation] BADLAND - game on cocos2d-iphone</a></li>
<li><a href="../181828/index.html">NOMAD: Optimizing Black Boxes at Home</a></li>
<li><a href="../18183/index.html">Opera - the guarantor of safe web surfing</a></li>
<li><a href="../181830/index.html">Introduction to GTD</a></li>
<li><a href="../181832/index.html">Kohana 3.2: multi-lingual organization</a></li>
<li><a href="../181834/index.html">LabVIEW and heart rate variability (+ sources)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>