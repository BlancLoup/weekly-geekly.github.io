<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Isolation of passwords in MAC OS X - the evolution of malware?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Finnish researcher Juuso Salonen has published a special utility ( http://juusosalonen.com/post/30923743427/breaking-into-the-os-x-keychain ), the pur...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Isolation of passwords in MAC OS X - the evolution of malware?</h1><div class="post__text post__text-html js-mediator-article"> Finnish researcher Juuso Salonen has published a special utility ( <a href="http://juusosalonen.com/post/30923743427/breaking-into-the-os-x-keychain">http://juusosalonen.com/post/30923743427/breaking-into-the-os-x-keychain</a> ), the purpose of which is to extract passwords from the Keychain password information subsystem.  <a href="https://github.com/juuso/keychaindump">Keychaindump</a> has already attracted the attention of researchers who are convinced that this approach can be successfully used in the development of malicious code under MAC OS X. <br>  For the first time, it was introduced in MAC OS 8.6.  Keychain stores various types of password information (forms for WEB-sites, FTP, SSH-accounts, access to network "balls", wireless networks, digital certificates). <br><br>  <a href="http://support.apple.com/kb/PH10698">Keychain</a> files are stored in ~ / Library / Keychains /, / Library / Keychains /, and / Network / Library / Keychains /, respectively.  The login, the Keychain file by default, automatically unlocks the user immediately after successfully logging in to the system with their user password.  However, the real password to it may not differ from that used by the user.  It is not allowed to set a zero password, automatic locking is carried out over time during a long idle system. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/287/b07/9f7/287b079f72c9a95e67a838c9ca87778c.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/e80/39c/40f/e8039c40f2153adc09b81ac0f212f531.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As soon as the user has unlocked the keychain, the password is turned into a 24-byte master key and is stored in the memory segment of the securityd process.  By a separate study, a specific storage structure was identified in the memory area, which indicates the ‚Äúmaster key‚Äù.  It contains an 8-byte field with the corresponding value ‚Äú0x18‚Äù (24 in HEX). <br><a name="habracut"></a><br> <code>$ sudo ./keychaindump <br> [*] Searching process 15 heap range 0x7fa809400000-0x7fa809500000 <br> [*] Searching process 15 heap range 0x7fa809500000-0x7fa809600000 <br> [*] Searching process 15 heap range 0x7fa809600000-0x7fa809700000 <br> [*] Searching process 15 heap range 0x7fa80a900000-0x7fa80ac00000 <br> [*] Found 17 master key candidates <br> [*] Trying to decrypt wrapping key in /Users/juusosalonen/Library/Keychains/login.keychain <br> [*] Trying master key candidate: b49ad51a672bd4be55a4eb4efdb90b242a5f262ba80a95df <br> [*] Trying master key candidate: 22b8aa80fa0700605f53994940fcfe9acc44eb1f4587f1ac <br> [*] Trying master key candidate: 1d7aa80fa0700f002005043210074b877579996d09b70000 <br> [*] Trying master key candidate: a0a20000000200f7474d400000700d01a980fa00007f085e <br> [*] Trying master key candidate: 180000000000000000000000000000000000000007000001 <br> [*] Trying master key candidate: 0000b107000001000000803e970aa8710ae567eff7ff0000 <br> [*] Trying master key candidate: 796a63507e6c2a84d9f095fae2896058dfe029cd0f7105da <br> [*] Trying master key candidate: 16ac866d636215c01e337e942f48cfed12d7c45bfab8dbf7 <br> [*] Trying master key candidate: 070020539baab0d1d6a3aa80fa006877ed57f80fa0000000 <br> [*] Trying master key candidate: 88edbaf22819a8eeb8e9b75120c0775de8a4d7da842d4a4a <br> [+] Found master key: 88edbaf22819a8eeb8e9b75120c0775de8a4d7da842d4a4a <br> [+] Found wrapping key: e9acc39947f1996df940fceb1f458ac74b877579f54409b7 <br> xxxxxxx:192.168.1.1:xxxxxxx <br> xxxxxxx:news.ycombinator.com:xxxxxxx <br> xxxxxxx@gmail.com:login.facebook.com:xxxxxxx <br> xxxxxxx@gmail.com:smtp.google.com:xxxxxxx <br> xxxxxxx@gmail.com:imap.google.com:xxxxxxx <br> xxxxxxx@gmail.com:api.heroku.com:xxxxxxx <br> xxxxxxx:www.freechess.org:xxxxxxx <br> xxxxxxx:twitter.com:xxxxxxx <br> xxxxxxx@gmail.com:www.google.com:xxxxxxx <br> xxxxxxx:imap.gmail.com:xxxxxxx</code> <br> <br>  By obtaining the ‚Äúmaster key‚Äù there is the possibility of disclosing the so-called ‚Äúwrapping key‚Äù.  By <a href="http://en.wikipedia.org/wiki/PBKDF2">decrypting</a> it, it becomes possible to obtain stored passwords in the clear.  The researcher believes that this vulnerability is the use of loopholes of the OS architecture itself.  The main problem is that the root can read the keychains of other users, and the search for the ‚Äúmaster key‚Äù and ‚Äúwrapping key‚Äù themselves is rather primitive. <br><br>  <b>Read more:</b> <a href="http://juusosalonen.com/post/30923743427/breaking-into-the-os-x-keychain">http://juusosalonen.com/post/30923743427/breaking-into-the-os-x-keychain</a> </div><p>Source: <a href="https://habr.com/ru/post/151041/">https://habr.com/ru/post/151041/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../151034/index.html">Bitcoin, crime chronicles: Bitfloor PWND!</a></li>
<li><a href="../151035/index.html">Casus nokia</a></li>
<li><a href="../151036/index.html">Green Wave today</a></li>
<li><a href="../151037/index.html">Tale of how we ordered design in America</a></li>
<li><a href="../151038/index.html">Live broadcast of Windows Camp directly on Habr√©</a></li>
<li><a href="../151042/index.html">Revolights</a></li>
<li><a href="../151043/index.html">Fifteen myths about data recovery and loss</a></li>
<li><a href="../151044/index.html">Porting Windows Phone Applications to Windows 8</a></li>
<li><a href="../151045/index.html">Google starts renting a Chromebook for rent</a></li>
<li><a href="../151046/index.html">S02.02. Mobilization</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>