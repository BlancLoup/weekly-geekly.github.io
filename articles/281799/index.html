<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hadoop performance comparison on DAS and Isilon</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I already wrote about that, with the help of Isilon, you can create data lakes that can simultaneously serve several clusters with different versions ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hadoop performance comparison on DAS and Isilon</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/e73/147/3cb/e731473cb70947b59bcd44ba83828300.jpg"><br><br>  I already <a href="http://stefanradtke.blogspot.ru/2015/05/how-to-access-data-with-different-hdfs.html">wrote</a> about that, with the help of Isilon, you can create data lakes that can simultaneously serve several clusters with different versions of Hadoop.  In that post, I mentioned that in many cases, Isilon systems run faster than traditional clusters that use DAS storage.  Later this was <a href="http://www.emc.com/collateral/analyst-reports/isd707-ar-idc-isilon-scale-out-datalakefoundation.pdf">confirmed</a> in IDC, having banished various Hadoop benchmarks on the respective clusters.  And this time I want to consider the reasons for the higher performance of Isilon clusters, as well as how it changes depending on the distribution of data and balancing within the clusters. <br><a name="habracut"></a><br><h3>  Test environment </h3><br><ul><li>  Distribution Cloudera Hadoop CDH5. </li><li>  DAS cluster of 7 nodes (one master, six workers), with eight ten-thousand disks of 300 GB each. </li><li>  Isilon cluster of 4 x410 nodes, each of which is equipped with 57 TB on disks and 3.2 TB on SSD, connected by 10 GBE. </li></ul><br>  Other details can be found in the <a href="http://www.emc.com/collateral/analyst-reports/isd707-ar-idc-isilon-scale-out-datalakefoundation.pdf">report</a> . <br><br><h3>  NFS access </h3><br>  First of all, IDC tested reading and writing with NFS access.  As expected, Isilon showed MUCH better results even with four nodes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/017/e58/456/017e584562d24af4a4cce8caca501a60.png"><br>  <i>The duration of copying a file of 10 GB in size (the block length is not indicated, but most likely it is 1 MB or more).</i> <br><br>  According to the record, Isilon was 4.2 times faster.  This is especially important if it is important if you want to receive data via NFS.  And the reading speed is 37 times faster. <br><br><h3>  Hadoop workload </h3><br>  During testing, three types of workload were compared using standard Hadoop benchmarks: <br><br><ol><li>  TeraGen Serial Recording </li><li>  Alternate Write / Read with TeraSort </li><li>  TeraValidate sequential read </li></ol><br><img src="https://habrastorage.org/files/118/e4f/582/118e4f582c1842f3952b7f14ca0a561c.png"><br>  <i>Runtime with three different load types: TeraGen, TeraSort and TeraValidate.</i> <br><br>  When recording, Isilon's performance turned out to be 2.6 times higher, and on the other two types, 1.5 times higher.  Specific results are presented in the table: <br><br><table><tbody><tr><th></th><th>  Isilon </th><th>  Hadoop das </th></tr><tr><td>  Teragen </td><td>  1681 MB / s </td><td>  605 MB / s </td></tr><tr><td>  TeraSort </td><td>  642 MB / s </td><td>  416 MB / sec. </td></tr><tr><td>  Teravalidate </td><td>  2832 MB / s </td><td>  1828 MB / sec. </td></tr></tbody></table><br>  <i>The performance of Isilon and DAS clusters with the same configuration of computing nodes (rounded).</i> <br><br>  The data speak for themselves.  Let's now see how OneFS managed to achieve such a performance advantage over the DAS cluster. <br><br><h3>  Reading Isilon Files </h3><br>  Although I / O operations are distributed across all nodes in a DAS cluster, each individual 64 MB block is serviced by only one node.  At the same time, in Isilon, the workload is divided between nodes in smaller portions.  The reading operation consists of the following steps: <br><br><ol><li>  The compute node requests HDFS metadata from the Name Node service running on all Isilon nodes (without SPoF). </li><li>  The service returns the IP addresses and block numbers of each of the three nodes in the same rack in which the computing node is located.  This increases the efficiency of the locality of the rack. </li><li>  The compute node requests the readout of a 64 MB HDFS block from the Data Node service running on the first node in the resulting list. </li><li>  The requested node via the internal network Infiniband collects all 128-kilobyte Isilon-blocks that make up the required 64-megabyte HDFS-block.  If these blocks are no longer in the second level cache, then they are read from disks.  This is a fundamental difference from the DAS cluster, in which the entire 64 MB block is read from a single node.  In other words, in the Isilon cluster, the I / O operation is serviced by a much larger number of disks and processors than in the DAS cluster. </li><li>  The requested node is returned to the compute node by the full HDFS block. </li></ol><br><h3>  Write files to Isilon </h3><br>  When a client wants to write a file to the cluster, the node to which the client has connected is receiving and processing the file. <br><br><ol><li>  The node creates a plan for recording the file, including the FEC calculation (from the point of view of volume, this is much more economical than the DAS cluster, which usually creates three copies of each block to ensure data integrity). </li><li>  The data blocks assigned to this node are recorded in its NVRAM.  The presence of NVRAM cards is one of the advantages of Isilon, they cannot be used in DAS clusters. </li><li>  The data blocks assigned to other nodes are first transmitted over the Infiniband network to the second-level caches of these nodes, and from there to NVRAM. </li><li>  As soon as the corresponding data and FEC blocks are loaded into NVRAM of all nodes, the client receives confirmation of the successful recording.  This means that you can not expect to write data to the disks while all I / O operations are buffered in NVRAM. </li><li>  Data blocks are stored in the second-level caches of each node in case read requests are received. </li><li>  Then the data is written to the disks. </li></ol><br><h3>  The myth of the importance of disk locality for Hadoop performance </h3><br>  Sometimes we are faced with the objections of admins, who say that disk locality is important for high performance of Hadoop.  But it must be remembered that Hadoop was originally designed to work in slow networks with a star topology, which are characterized by a capacity of 1 Gbit / s.  In such conditions, it remains only to strive to carry out all I / O operations within a specific server (locality of disks). <br><br>  A number of facts suggest that disk locality is not related to Hadoop performance: <br><br><h4>  I. Fast networks have already become standard. </h4><br><ul><li>  Today, a single non-blocking 10-gigabit switch port (full duplex up to 2500 Mbit / s) has a higher throughput than the typical disk subsystem with 12 disks (360 - Mbit / s). </li><li>  There is no longer any need to maintain data locality for the sake of a satisfactory level of I / O operations. </li><li>  In Isilon, rack locality is provided, not disk, which reduces Ethernet traffic between the racks. </li></ul><br>  This illustration shows the route of I / O operations.  Obviously, the bottleneck is the disks, not the network (if it is a 10 GBE network). <br><br><img src="https://habrastorage.org/files/c4c/4ee/5e9/c4c4ee5e90c843aa9c291ab342f76151.png"><br>  <i>The route of the I / O operation in the DAS architecture.</i>  <i>Even if you double the number of disks, they still remain a bottleneck.</i>  <i>So the locality of disks in most cases does not affect performance.</i> <br><br><h4>  Ii.  The localization of disks is lost in the following typical situations: </h4><br><ul><li>  In a DAS cluster with block replication, all nodes perform the maximum number of jobs.  This is extremely typical for high-loaded clusters! </li><li>  Incoming files are compressed using non-splittable codecs like gzip. </li><li>  ‚ÄúThe <a href="http://www.cs.berkeley.edu/~ganesha/disk-irrelevant_hotos2011.pdf">analysis of Hadoop tasks on Facebook</a> proves the difficulty of achieving disk locality: only 34% of the task is performed on the same node where the input data is stored.‚Äù </li><li>  The disk locality provides a very low latency when performing I / O operations, but it has very little value when performing batch jobs like MapReduce. </li></ul><br><h4>  Iii.  Data Replication for Performance </h4><br><ul><li>  In high-load traditional clusters, a high degree of replication can be useful when working with files that are often used in multiple simultaneous tasks.  This is required to ensure data locality and high speed parallel reading. </li><li>  Isilon does not require a high degree of replication, because: <br><ol><li>  No need for data locality. </li><li>  Read operations are distributed across multiple nodes with a global coherent cache (globally coherent cache), which provides a very high parallel read speed. </li></ol></li></ul><br><h4>  Other technologies affecting Isilon performance </h4><br>  OneFS is a very mature product that has been improved for over a decade in terms of high performance and low latency with multi-protocol access.  You can find a lot of information about this on the net.  I will mention only the key points: <br><br><ul><li>  All write operations are buffered using backup NVRAM, which provides very high performance. </li><li>  In OneFS, the first level cache, globally coherent second level cache, and third level caches on SSD are used to speed up reading. </li><li>  You can configure access templates for the entire cluster, for a pool, or even at the folder level.  This allows you to optimize and balance the pre-fetching procedure.  Templates can be random, parallel or streaming. </li><li>  Work with metadata is accelerated using a third-level cache, or configured separately.  OneFS stores all metadata on SSD. </li></ul><br><h3>  Finally </h3><br>  Isilon is a horizontally scalable NAS storage with a distributed file system designed for intensive workloads like Hadoop.  HDFS is implemented as a protocol and Name Node and Data Node services, access to which is provided on all nodes.  IDC performance testing showed a 2.5-fold advantage of the Isilon cluster over the DAS cluster.  Thanks to advances in networking, disk locality does not affect the operation of Hadoop on an Isilon system.  In addition to performance, Isilon has a number of other advantages, like more efficient use of disk space and various features typical of corporate storage.  Moreover, compute nodes and storage nodes can be scaled independently of each other.  You can also access the same data from several different versions and distributions of Hadoop at the same time. </div><p>Source: <a href="https://habr.com/ru/post/281799/">https://habr.com/ru/post/281799/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../281787/index.html">The source code of the bot Gozi leaked to the network</a></li>
<li><a href="../281789/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ207 (11 - 17 April 2016)</a></li>
<li><a href="../281791/index.html">Spring meeting of Pattern Recognition and Computer Vision Colloquium 2016 in Prague: how it was</a></li>
<li><a href="../281793/index.html">How a secure printing system is implemented on a follow-me printing device</a></li>
<li><a href="../281797/index.html">Integration of two Dynamics CRM Online tenants using the Azure Service Bus and the Azure Cloud Service</a></li>
<li><a href="../281803/index.html">IaaS-digest: 30 materials on the topic of information security</a></li>
<li><a href="../281805/index.html">IaaS-cases: How the "cloud" helps the business</a></li>
<li><a href="../281807/index.html">Guide: How to calculate the benefits of migration to the "cloud"</a></li>
<li><a href="../281809/index.html">Experience of using IaaS by large (and not so) companies</a></li>
<li><a href="../281811/index.html">IaaS-digest: 30 materials on projects implemented in the cloud</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>