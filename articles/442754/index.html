<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Operational vs analytical databases: column vs row-by-line data storage</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Databases can be implemented using Excel, GSheet or using large ORM systems. In my practice of business analyst, I came across different solutions. An...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Operational vs analytical databases: column vs row-by-line data storage</h1><div class="post__text post__text-html js-mediator-article"><p>  Databases can be implemented using Excel, GSheet or using large ORM systems.  In my practice of business analyst, I came across different solutions.  And since I came to business analysis from finance and auditing, every time I met a new system I asked myself questions - how do they all differ from each other and what tasks do they solve?  Found some answers.  This article will discuss the two main purposes of databases: </p><br><p>  1 - accounting operations <br>  2 - data analysis </p><a name="habracut"></a><br><p>  The first type of problem is solved by the OLTP systems: from <u>O</u> n <u>L</u> ine <u>T</u> ransaction <u>P</u> rocessing.  The second type is solved by OLAP systems: from <u>O</u> n <u>L</u> ine nalytical <u>P</u> rocessing </p><br><h2 id="oltp">  OLTP </h2><br><p>  The data storage model in OLTP can be compared with the entries in the phone book.  The row in the table is presented as an index and data corresponding to this index: (indexN, data).  Therefore, such a table cannot be called a table.  It is rather a regular book, with numbered lines.  If you need to write a new operation in the book, add a line, assign an index and close the book.  From the book, stick labels on which you can quickly O (log n), find the desired line and make CRUD. </p><br><p>  For accounting purposes, this is a friendly mapping.  But it is unfriendly for data analysis, in which we are not concerned with the lines themselves, but with calculations based on the contents of these lines.  And if you make an analytical query based on the content of the lines, i.e.  for non-indexed fields, such queries will work slower. </p><br><p>  Indexing all records is not an option.  Although the book becomes similar to the table, since the attributes become available for a quick search, but at the same time, the creation of new lines and the update of existing lines slow down significantly.  Since these operations will require re-sorting of the entire array. </p><br><h2 id="kompromiss-mezhdu-olap-i-oltp">  Compromise between OLAP and OLTP </h2><br><p>  In 1C solutions, the compromise is implemented as follows.  Events when writing to the database are written in several places at once.  In one place, records have few indexes and are optimized for OLTP loads, in another place records are indexed across all fields and adapted for OLAP loads.  Such tables are called accumulation registers and information registers.  Since an entry in several places multiplies the occupied space, for saving, not all transaction attributes are included in the registers, but only those that are considered important for this section of analytical accounting.  Such a compromise is called the ROLAP model, i.e.  relational-analytical mapping. </p><br><h2 id="olap">  OLAP </h2><br><p>  In SAP, the German 1C analog went further.  The relational OLTP model in this software can be replicated to the OLAP model.  SAP HANA has a storage column structure.  This means that the "tables" are stored there not as a set of rows, but as a set of columns. </p><br><p>  A similar storage scheme is implemented in solutions such as Google Bigquery, Microsoft SSAS Tabular, Amazon Redshift, Yandex ClickHouse. </p><br><h2 id="otlichie-kolonochnogo-hraneniya-ot-postrochnogo">  The difference between column and line storage </h2><br><p>  If in a line-by-line structure, data is stored as "horizontal" tuples, each of which is a transaction: </p><br><pre><code class="plaintext hljs">period, product, department (Q1, SKU1, 1) (Q1, SKU2, 1) (Q1, SKU1, 1) ... (Q2, SKU1, 1) (Q2, SKU1, 1) (Q3, SKU1, 1) (Q3, SKU1, 1) ...</code> </pre> <br><p>  Then in the column such data is stored "vertically": </p><br><pre> <code class="plaintext hljs">(Q1, Q1, Q1, ... Q2, Q2, Q3, Q3, ...) (SKU1, SKU2, SKU1, ... SKU1, SKU1, SKU1, SKU1, ...) (1,1,1, ... 1,1,1,1, ...)</code> </pre> <br><p>  Replays can be optimized, conditionally, as follows: </p><br><pre> <code class="plaintext hljs">period = (Q1, {start: 0, count: n}, Q2, {start: n+1; count: m}, ...) product = (SKU1, {start: 0, count: 1}, SKU2, {start: 1; count: 1}, SKU1, {start: 2; count: m}, ...) department = (1,{start:0, count:m}...)</code> </pre> <br><p>  If there is a column for which such optimization will not reduce the initial volume, then the data is stored in its original form. </p><br><p>  The column table engine itself selects the column sorting sequence, but if you know your data and sort it manually, this often increases compression and eases the analytical workload.  My compression of individual tables exceeded 300 times.  In practice, this storage structure is: </p><br><ol><li>  allows you to compress data to the level when they are placed in RAM, i.e.  make available in-memory calculations that are not comparable in speed with queries to relational databases </li><li>  sets its own rules for building a data model, without requiring such normalization as in OLTP </li><li>  sets its semantics for the construction of analytical expressions. </li></ol><br><p>  The specificity of expressions is described in detail: <br>  <a href="https://netpeak.net/ru/blog/kak-rabotat-s-okonnymi-funktsiyami-v-google-bigquery-podrobnoe-rukovodstvo/">here</a> for Google BigQuery. <br>  <a href="https://www.sqlbi.com/articles/filter-arguments-in-calculate/">here</a> for the Microsoft DAX. </p><br><h2 id="bi-kak-infrastruktura-kolonochnyh-baz">  BI as infrastructure of column bases </h2><br><p>  BI is a solution serving analytical loads.  And they make life much easier if they are built on top of column databases.  This could be a self-made ClickHouse-Grafana-Python bundle or a Google stack bundle: Bigquery-Data Studio-Dataprep-Dataflow or monolithic Power BI. </p><br><p>  Multidimensional cubes are another OLAP alternative storage column scheme.  But for me, MDX expressions, when compared with SQL in BQ or DAX, are redundant and complex. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/442754/">https://habr.com/ru/post/442754/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../442742/index.html">Laptop Compaq LTE 5000, part two and a half - bonus</a></li>
<li><a href="../442744/index.html">RIPE decision and its consequences on the elimination of two Russian LIRs (Netup, gcxc.net)</a></li>
<li><a href="../442746/index.html">Fool app for Windows Store</a></li>
<li><a href="../442748/index.html">The point: the top 10 reports of Heisenbug 2018 Moscow</a></li>
<li><a href="../442750/index.html">Virtual Djinn on March 8 - or how to surprise your female employees on the very spring day</a></li>
<li><a href="../442758/index.html">5 lifehacks optimize SQL queries in Greenplum</a></li>
<li><a href="../442760/index.html">An article on how CommVault makes PostgreSQL backups.</a></li>
<li><a href="../442764/index.html">Product Management Digest. What worries productologists and marketers in 2019</a></li>
<li><a href="../442772/index.html">Math for Data Scientist: Required Chapters</a></li>
<li><a href="../442784/index.html">BGP hijacking by adding the victim's AS to the attacker's AS-SET</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>