<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Rapid development on 1C-Bitrix or how I met gulp</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I want to show my frontend development environment, configured under the cmx of Bitrix, using the Gulp collector. This is primarily a ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Rapid development on 1C-Bitrix or how I met gulp</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/c0c/1c6/f1d/c0c1c6f1d52246a98cf2392abf5b65b0.jpg"><br><br>  In this article I want to show my frontend development environment, configured under the cmx of Bitrix, using the <a href="http://gulpjs.com/">Gulp</a> collector.  This is primarily a set of tools under the hood of an excellent collector, which will save you from the routine and greatly accelerate the development. <br><br><h4>  Do not judge strictly </h4><br>  So fate happened that I ran into CMS 1C-Bitrix.  I fully understand how cumbersome and ‚Äúdirty‚Äù it is, but I have to deal with what is.  Based on this, please do not strongly criticize the article, it is primarily aimed at those who work with this system. <br><a name="habracut"></a><br><h2>  Let's start </h2><br>  The first step is to set up a working environment, namely, to get the <b>npm package manager</b> that comes with nodejs.  Stop, stop young bitriksoidy, do not scatter, on windows it can also be put and through the console will also work, checked.  And if you have any questions, google will help you (note the user environment variables, the paths must be correctly spelled for the npm command to be global). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Having established npm, we have an opportunity to establish all demanded dependences.  To do this, create a file: <br><br><h4>  <i>package.json</i> </h4><br><pre><code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"frontend-bitrix"</span></span>, <span class="hljs-string"><span class="hljs-string">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.0.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">"jmaks"</span></span>, <span class="hljs-string"><span class="hljs-string">"license"</span></span>: <span class="hljs-string"><span class="hljs-string">"ISC"</span></span>, <span class="hljs-string"><span class="hljs-string">"dependencies"</span></span>: { <span class="hljs-string"><span class="hljs-string">"gulp"</span></span>: <span class="hljs-string"><span class="hljs-string">"^3.8.11"</span></span>, <span class="hljs-string"><span class="hljs-string">"gulp-autoprefixer"</span></span>: <span class="hljs-string"><span class="hljs-string">"^2.1.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"gulp-minify-css"</span></span>: <span class="hljs-string"><span class="hljs-string">"^1.0.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"gulp-rigger"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.5.8"</span></span>, <span class="hljs-string"><span class="hljs-string">"gulp-sass"</span></span>: <span class="hljs-string"><span class="hljs-string">"^1.3.3"</span></span>, <span class="hljs-string"><span class="hljs-string">"gulp-uglify"</span></span>: <span class="hljs-string"><span class="hljs-string">"^1.1.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"gulp-sourcemaps"</span></span>: <span class="hljs-string"><span class="hljs-string">"^1.5.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"gulp-watch"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.1.1"</span></span>, <span class="hljs-string"><span class="hljs-string">"gulp-imagemin"</span></span>: <span class="hljs-string"><span class="hljs-string">"^2.2.1"</span></span>, <span class="hljs-string"><span class="hljs-string">"imagemin-pngquant"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.0.0"</span></span>, <span class="hljs-string"><span class="hljs-string">"gulp.spritesmith"</span></span>: <span class="hljs-string"><span class="hljs-string">"latest"</span></span>, <span class="hljs-string"><span class="hljs-string">"gulp-plumber"</span></span>: <span class="hljs-string"><span class="hljs-string">"latest"</span></span> } }</code> </pre> <br>  This file contains a list of all required packages for our collector, consider it in detail: <br><br><ul><li>  gulp - the collector himself </li><li>  gulp-autoprefixer - automatically adds vendor prefixes to CSS properties </li><li>  gulp-minify-css - compress css code </li><li>  gulp-rigger - allows you to import one file into another with a simple construction </li><li>  gulp-sass - to compile our SCSS code </li><li>  gulp-uglify - compress our js </li><li>  gulp-sourcemaps - to generate css sourscemaps that will help us in debugging code </li><li>  gulp-watch - monitor file changes </li><li>  gulp-imagemin - image compression </li><li>  imagemin-pngquant - image compression |  working with PNG </li><li>  gulp.spritesmith - creating png sprites </li><li>  gulp-plumber - catch errors so watch is not interrupted </li></ul><br>  We also need such a great package manager like <a href="http://bower.io/">Bower</a> .  First we install it using npm (the bower installation goes separately from our dependencies installation, since we need to install bower globally), and then we will similarly create a file with settings: <br><br><h4>  <i>bower.json</i> </h4><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"frontend-bitrix"</span></span>, <span class="hljs-string"><span class="hljs-string">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.0.1"</span></span>, <span class="hljs-string"><span class="hljs-string">"authors"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"jmaks1 &lt;my.mailname@mail.ru&gt;"</span></span> ], <span class="hljs-string"><span class="hljs-string">"license"</span></span>: <span class="hljs-string"><span class="hljs-string">"MIT"</span></span>, <span class="hljs-string"><span class="hljs-string">"ignore"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"**/.*"</span></span>, <span class="hljs-string"><span class="hljs-string">"node_modules"</span></span>, <span class="hljs-string"><span class="hljs-string">"bower_components"</span></span>, <span class="hljs-string"><span class="hljs-string">"test"</span></span>, <span class="hljs-string"><span class="hljs-string">"tests"</span></span> ], <span class="hljs-string"><span class="hljs-string">"dependencies"</span></span>: { <span class="hljs-string"><span class="hljs-string">"jquery"</span></span>: <span class="hljs-string"><span class="hljs-string">"2.*"</span></span>, <span class="hljs-string"><span class="hljs-string">"bootstrap-sass"</span></span>: <span class="hljs-string"><span class="hljs-string">"*"</span></span> } }</code> </pre><br>  Everything is similar to package.json, there is a dependencies block that contains a list of downloadable packages.  Here we will load jquery and bootstrap-sass. <br><br>  As you have already noticed, I use a bunch of bootstrap and css sass preprocessor. <br>  On the first point - bootstrap, I use it in view of the fact that 1C-Bitrix itself gradually begins to use this CSS framework (well, I‚Äôm just used to it). <br>  On the second point - Sass.  This preprocessor is more functional than less, the last one I really liked, but it could not compete with Sass. <br><br><h4>  <i>Create a new project structure</i> </h4><br>  Creating a new store / portal / ‚Äúsomething else on Bitrix‚Äù I install the necessary Bitrix edition on the local server.  During the installation, select any ready-made template from the start-up templates, and then just cancel the installation wizard so as not to clutter up the site with demo data, we end up with the following site structure: <br><blockquote>  auth <br>  bitrix <br>  upload <br></blockquote><br>  Now create partitions for the build and development files.  Build is our site template, all files will be collected in it, it should be placed in the / local / directory.  For those who are in the tank, this directory is equivalent to / bitix /, that is, we can create components, templates, and so on.  The development will be carried out in the / src / directory, inside it we will create a simple structure. <br><br>  As a result, we get: <br><blockquote>  auth <br>  bitrix <br>  upload <br>  local <br>  - templates <br>  - - main <br>  src <br>  - fonts <br>  - images <br>  - sprite <br>  - js <br>  - - partials <br>  - styles <br>  - - partials <br></blockquote><br>  Everything is trivial: <br>  The local directory contains the basic site template <b>main</b> . <br>  The src directory contains: <br><br><ul><li>  fonts - fonts </li><li>  images - pictures </li><li>  sprite - icons for sprite </li><li>  js - scripts.  At the root of this folder will be the file script.js, which is useful for us to build. </li><li>  styles - styles.  There is also at the root of template_styles.scss. </li></ul><br>  In both cases, the files from the partials directory will be additional, we will simply include them in the main file, respectively, we will include all scripts in script.js, and all additional style files in template_styles.scss. <br><br>  We will include the files with the <em>// =</em> construction for script.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// include jquery //= ../../bower_components/jquery/dist/jquery.min.js // include bootstrap.js //= ../../bower_components/bootstrap-sass/assets/javascripts/bootstrap.min.js console.log("i'm a live!"); // another scripts //= partials/app.js</span></span></code> </pre><br>  Scss files are connected using <em>@import</em> : <br><br><pre> <code class="css hljs">// <span class="hljs-selector-tag"><span class="hljs-selector-tag">include</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">bootstrap</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sass</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"../../bower_components/bootstrap-sass/assets/stylesheets/bootstrap"</span></span>; // <span class="hljs-selector-tag"><span class="hljs-selector-tag">include</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">variables</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"partials/variables"</span></span>; // <span class="hljs-selector-tag"><span class="hljs-selector-tag">include</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sprite</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"partials/sprite"</span></span>; // <span class="hljs-selector-tag"><span class="hljs-selector-tag">include</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mixin</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"partials/mixin"</span></span>; // <span class="hljs-selector-tag"><span class="hljs-selector-tag">include</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">fonts</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"partials/fonts"</span></span>;</code> </pre><br>  After receiving the project structure, we will add our <i>bower.json</i> and <i>package.json</i> files to its root.  It remains only to create a configuration file for our collector - <i>gulpfile.js</i> .  This file will be responsible for all the magic. <br><br><h4>  <i>gulpfile.js</i> </h4><br>  All dependencies that we have specified in the <i>package.json</i> file are <i>included</i> inside <i>gulpfile.js</i> : <br><br><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">'use strict'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gulp = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp'</span></span>), watch = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp-watch'</span></span>), prefixer = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp-autoprefixer'</span></span>), uglify = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp-uglify'</span></span>), rigger = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp-rigger'</span></span>), sass = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp-sass'</span></span>), sourcemaps = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp-sourcemaps'</span></span>), cssmin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp-minify-css'</span></span>), imagemin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp-imagemin'</span></span>), pngquant = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'imagemin-pngquant'</span></span>), spritesmith = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp.spritesmith'</span></span>), plumber = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'gulp-plumber'</span></span>);</code> </pre><br>  Create a path object with all the paths so that if necessary it is easy to edit them in one place.  They will be used by our task (task - task, set tasks for our manager, and he quickly performs everything). <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> path = { <span class="hljs-attr"><span class="hljs-attr">build</span></span>: { <span class="hljs-attr"><span class="hljs-attr">js</span></span>: <span class="hljs-string"><span class="hljs-string">'local/templates/main/'</span></span>, <span class="hljs-attr"><span class="hljs-attr">css</span></span>: <span class="hljs-string"><span class="hljs-string">'local/templates/main/'</span></span>, <span class="hljs-attr"><span class="hljs-attr">images</span></span>: <span class="hljs-string"><span class="hljs-string">'local/templates/main/images/'</span></span>, <span class="hljs-attr"><span class="hljs-attr">fonts</span></span>: <span class="hljs-string"><span class="hljs-string">'local/templates/main/fonts/'</span></span>, <span class="hljs-attr"><span class="hljs-attr">fontsBootstrap</span></span>:<span class="hljs-string"><span class="hljs-string">'local/templates/main/fonts/bootstrap/'</span></span> }, <span class="hljs-attr"><span class="hljs-attr">src</span></span>: { <span class="hljs-attr"><span class="hljs-attr">js</span></span>: <span class="hljs-string"><span class="hljs-string">'src/js/script.js'</span></span>, <span class="hljs-attr"><span class="hljs-attr">styles</span></span>: <span class="hljs-string"><span class="hljs-string">'src/styles/template_styles.scss'</span></span>, <span class="hljs-attr"><span class="hljs-attr">stylesPartials</span></span>:<span class="hljs-string"><span class="hljs-string">'src/styles/partials/'</span></span>, <span class="hljs-attr"><span class="hljs-attr">spriteTemplate</span></span>:<span class="hljs-string"><span class="hljs-string">'src/sass.template.mustache'</span></span>, <span class="hljs-attr"><span class="hljs-attr">images</span></span>: <span class="hljs-string"><span class="hljs-string">'src/images/**/*.*'</span></span>, <span class="hljs-attr"><span class="hljs-attr">sprite</span></span>: <span class="hljs-string"><span class="hljs-string">'src/sprite/*.*'</span></span>, <span class="hljs-attr"><span class="hljs-attr">fonts</span></span>: <span class="hljs-string"><span class="hljs-string">'src/fonts/**/*.*'</span></span>, <span class="hljs-attr"><span class="hljs-attr">fontsBootstrap</span></span>:<span class="hljs-string"><span class="hljs-string">'bower_components/bootstrap-sass/assets/fonts/bootstrap/*.*'</span></span> }, <span class="hljs-attr"><span class="hljs-attr">watch</span></span>: { <span class="hljs-attr"><span class="hljs-attr">js</span></span>: <span class="hljs-string"><span class="hljs-string">'src/js/**/*.js'</span></span>, <span class="hljs-attr"><span class="hljs-attr">styles</span></span>:<span class="hljs-string"><span class="hljs-string">'src/styles/**/*.scss'</span></span>, <span class="hljs-attr"><span class="hljs-attr">images</span></span>:<span class="hljs-string"><span class="hljs-string">'src/images/**/*.*'</span></span>, <span class="hljs-attr"><span class="hljs-attr">sprite</span></span>:<span class="hljs-string"><span class="hljs-string">'src/sprite/*.*'</span></span>, <span class="hljs-attr"><span class="hljs-attr">fonts</span></span>: <span class="hljs-string"><span class="hljs-string">'src/fonts/**/*.*'</span></span> } };</code> </pre><br>  By connecting all the dependencies and writing the routes, we will create taskkis that are responsible for all the work of our collector. <br><br><div class="spoiler">  <b class="spoiler_title">Js file collector</b> <div class="spoiler_text"><pre> <code class="javascript hljs">gulp.task(<span class="hljs-string"><span class="hljs-string">'js:build'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ gulp.src(path.src.js) <span class="hljs-comment"><span class="hljs-comment">//   main  .pipe(plumber()) .pipe(rigger()) //   rigger .pipe(sourcemaps.init()) //  sourcemap .pipe(uglify()) //   js .pipe(sourcemaps.write()) //   .pipe(plumber.stop()) .pipe(gulp.dest(path.build.js)) //     build });</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">Css file collector</b> <div class="spoiler_text"><pre> <code class="javascript hljs">gulp.task(<span class="hljs-string"><span class="hljs-string">'styles:build'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ gulp.src(path.src.styles) <span class="hljs-comment"><span class="hljs-comment">//   main.scss .pipe(plumber()) .pipe(sourcemaps.init()) //       js .pipe(sass()) //  .pipe(prefixer()) //    .pipe(cssmin()) //  .pipe(sourcemaps.write()) //   .pipe(plumber.stop()) .pipe(gulp.dest(path.build.css)) //   build });</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">Task, responsible for the compression of all images</b> <div class="spoiler_text"><pre> <code class="javascript hljs">gulp.task(<span class="hljs-string"><span class="hljs-string">'image:build'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ gulp.src(path.src.images) <span class="hljs-comment"><span class="hljs-comment">//   .pipe(plumber()) .pipe(imagemin({ //  progressive: true, svgoPlugins: [{removeViewBox: false}], use: [pngquant()], interlaced: true })) .pipe(plumber.stop()) .pipe(gulp.dest(path.build.images)) });</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">Task Collecting Sprite</b> <div class="spoiler_text"><pre> <code class="javascript hljs">gulp.task(<span class="hljs-string"><span class="hljs-string">'sprite:build'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> spriteData = gulp.src(path.src.sprite) .pipe(spritesmith({ <span class="hljs-attr"><span class="hljs-attr">imgName</span></span>: <span class="hljs-string"><span class="hljs-string">'sprite.png'</span></span>, <span class="hljs-attr"><span class="hljs-attr">cssName</span></span>: <span class="hljs-string"><span class="hljs-string">'sprite.scss'</span></span>, <span class="hljs-attr"><span class="hljs-attr">cssFormat</span></span>: <span class="hljs-string"><span class="hljs-string">'scss'</span></span>, <span class="hljs-attr"><span class="hljs-attr">algorithm</span></span>: <span class="hljs-string"><span class="hljs-string">'binary-tree'</span></span>, <span class="hljs-attr"><span class="hljs-attr">padding</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-attr"><span class="hljs-attr">cssTemplate</span></span>: path.src.spriteTemplate, <span class="hljs-attr"><span class="hljs-attr">cssVarMap</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sprite</span></span></span><span class="hljs-function">) </span></span>{ sprite.name = <span class="hljs-string"><span class="hljs-string">'s-'</span></span> + sprite.name } })); spriteData.img.pipe(gulp.dest(path.build.images)); spriteData.css.pipe(gulp.dest(path.src.stylesPartials)); });</code> </pre><br>  It takes all our icons from the sprite folder and generates a sprite, in parallel, based on the sass.template.mustache file, it creates a scss file in which all sizes and icon positions are written. <br><br><h4>  <i>sass.template.mustache</i> </h4><br><pre> <code class="javascript hljs">{{#items}} ${{name}}: {{px.x}}, {{px.y}}, {{px.offset_x}}, {{px.offset_y}}, {{px.width}}, {{px.height}}, {{px.total_width}}, {{px.total_height}}, <span class="hljs-string"><span class="hljs-string">'{{{escaped_image}}}'</span></span>; {{/items}}</code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">Transfer fonts to build</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  bootstrap',    gulp.task('icons:build', function() { gulp.src(path.src.fontsBootstrap) .pipe(gulp.dest(path.build.fontsBootstrap)); }); //     src gulp.task('fonts:build', function() { gulp.src(path.src.fonts) .pipe(gulp.dest(path.build.fonts)) });</span></span></code> </pre></div></div><br>  Create the last two task'a that will launch everything in the work.  The first is required to run, the second to monitor file changes so that we do not need to restart our manager all the time. <br><br><pre> <code class="javascript hljs">gulp.task(<span class="hljs-string"><span class="hljs-string">'build'</span></span>, [ <span class="hljs-string"><span class="hljs-string">'js:build'</span></span>, <span class="hljs-string"><span class="hljs-string">'sprite:build'</span></span>, <span class="hljs-string"><span class="hljs-string">'icons:build'</span></span>, <span class="hljs-string"><span class="hljs-string">'fonts:build'</span></span>, <span class="hljs-string"><span class="hljs-string">'styles:build'</span></span>, <span class="hljs-string"><span class="hljs-string">'image:build'</span></span>, ]); gulp.task(<span class="hljs-string"><span class="hljs-string">'watch'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ watch([path.watch.js], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event, cb</span></span></span><span class="hljs-function">) </span></span>{ gulp.start(<span class="hljs-string"><span class="hljs-string">'js:build'</span></span>); }); watch([path.watch.sprite], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event, cb</span></span></span><span class="hljs-function">) </span></span>{ gulp.start(<span class="hljs-string"><span class="hljs-string">'sprite:build'</span></span>); }); watch([path.watch.styles], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event, cb</span></span></span><span class="hljs-function">) </span></span>{ gulp.start(<span class="hljs-string"><span class="hljs-string">'styles:build'</span></span>); }); watch([path.watch.fonts], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event, cb</span></span></span><span class="hljs-function">) </span></span>{ gulp.start(<span class="hljs-string"><span class="hljs-string">'fonts:build'</span></span>); }); watch([path.watch.images], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event, cb</span></span></span><span class="hljs-function">) </span></span>{ gulp.start(<span class="hljs-string"><span class="hljs-string">'image:build'</span></span>); }); }); gulp.task(<span class="hljs-string"><span class="hljs-string">'default'</span></span>, [<span class="hljs-string"><span class="hljs-string">'build'</span></span>, <span class="hljs-string"><span class="hljs-string">'watch'</span></span>]);</code> </pre><br>  As a result, we get three configuration files in the project root, execute them by writing commands to the console: <br><br><ul><li>  npm install - install all the dependencies required by gulp (the node_modules directory will be created) </li><li>  bower install - we will put plugins for our site (the bower_components directory will be created) </li><li>  gulp - we will start our collector </li></ul><br>  profit! <br><br><h2>  Total </h2><br>  After a successful launch, we got a comfortable development environment.  Compressed versions of files, scripts, styles and images will be automatically generated in our template.  Download the already customized version from <a href="https://github.com/jmaks1/bitrix-frontend">Github</a> .  It will be enough for you to unpack the archive into the directory with the new site and execute commands from the console. <br><br><h4>  <i>Underwater rocks</i> </h4><br>  Before creating a backup copy of the site, do not forget to put an exception on the directory: node_modules and bower_components, otherwise the backup copy will not be created.  These folders are needed only for development, they will not be needed in the ‚Äúcombat‚Äù version of the site. <br><br><hr><br>  <b>ps</b> <br>  The article originates from the article ‚ÄúA <a href="http://habrahabr.ru/post/250569/">pleasant assembly of the frontend project</a> ‚Äù - I recommend to read it. <br>  If anyone is interested, I can add the generation of svg sprites to the collector. </div><p>Source: <a href="https://habr.com/ru/post/261467/">https://habr.com/ru/post/261467/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../261455/index.html">Truly responsive letters. Part one</a></li>
<li><a href="../261457/index.html">Deploying the Postgres-xl Cluster for Dummies</a></li>
<li><a href="../261459/index.html">Analysis of tasks of the Competitive Intelligence Competition on PHDays V</a></li>
<li><a href="../261461/index.html">Automate routine operations between Excel and AutoCAD using VBA</a></li>
<li><a href="../261463/index.html">Comparing the speed of .NET providers for working with Oracle DB</a></li>
<li><a href="../261469/index.html">Love and mathematics. Heart of hidden reality</a></li>
<li><a href="../261471/index.html">Started Golden Site 2015</a></li>
<li><a href="../261473/index.html">We teach Raspberry Pi to accept telegrams with the help of Bot API and Python</a></li>
<li><a href="../261475/index.html">Alternative to callback</a></li>
<li><a href="../261477/index.html">OpenCV and the illusion of circles on the water</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>