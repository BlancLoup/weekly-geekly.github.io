<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Safe JSONP? An interesting feature of the Bing API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I just learned the Microsoft Bing search engine API (which is actually a Live Search rebranding, also switching to ‚Äúlow bandwidth browsing‚Äù to be able...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Safe JSONP? An interesting feature of the Bing API</h1><div class="post__text post__text-html js-mediator-article"> I just learned the <a href="http://msdn.microsoft.com/en-us/library/dd251056.aspx">Microsoft Bing search engine API</a> (which is actually a Live Search rebranding, also switching to ‚Äúlow bandwidth browsing‚Äù to be able to use documents more flexibly), and found an interesting trick to protect the code from throwing exceptions. <a name="habracut"></a><br><br>  When you submit a JSON output format to developers, it makes sense to also give the option to pass the ‚Äúcallback function‚Äù parameter.  In this case, it becomes possible to use your output format by simply using the script tag, without using any Ajax.  Suppose, for example, that you provide an API to return the names of members of a group of Beatles, providing an end point and a parameter for setting the output format: <br><br> <code><a href="http://example.com/API/getBeatles%3Foutput%3Djson"></a> example.com/API/getBeatles?output=json</code> <br> <br>  The returned data is in the form: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">{ <br> <font color="#A31515">"members"</font> : <br> [ <br> <font color="#A31515">'Paul'</font> :{ ... more info ... }, <br> <font color="#A31515">'Ringo'</font> :{ ... more info ... }, <br> <font color="#A31515">'John'</font> :{ ... more info ... }, <br> <font color="#A31515">'George'</font> :{ ... more info ... } <br> ] <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  This I can not use in JavaScript without feints.  I will need to perform eval (or more secure <a href="">JSON.parse</a> ) on the received data, and besides the usual Ajax, I will not be able to access data outside my domain.  To make accessing JSON data easier, you can provide a callback parameter. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code><a href="http://example.com/API/getBeatles%3Foutput%3Djson%26callback%3DeleanorRigby"></a> example.com/API/getBeatles?output=json&amp;callback=eleanorRigby</code> <br> <br>  With this parameter, the results are wrapped in a function call, which means that the result will already be calculated, and the user has defined a callback function to read this information. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">eleanorRigby({ <br> <font color="#A31515">"members"</font> : <br> [ <br> <font color="#A31515">'Paul'</font> :{ ... more info ... }, <br> <font color="#A31515">'Ringo'</font> :{ ... more info ... }, <br> <font color="#A31515">'John'</font> :{ ... more info ... }, <br> <font color="#A31515">'George'</font> :{ ... more info ... } <br> ] <br> });</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  If I define a function like <code>eleanorRigby(o){}</code> , the parameter <code>o</code> will be an object with the received data, and I can use them immediately. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">function</font> eleanorRigby(o){ <br> alert(o[ <font color="#A31515">'John'</font> ]); <font color="#008000">// will alert the information about John</font> <br> } <br> <font color="#0000ff">&lt;/</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">script</font> <font color="#ff0000">src</font> <font color="#0000ff">="http://example.com/API/getBeatles?output=json&amp;callback=eleanorRigby"</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  But in this case, the problem arises that if the function <code>eleanorRigby</code> not defined, an exception will be thrown. <br><br>  The Bing API is the first instance of the service I saw that frames its output in the form: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> eleanorRigby == <font color="#A31515">'function'</font> ) eleanorRigby( <br> { <br> <font color="#A31515">"SearchResponse"</font> : <br> { <br> <font color="#A31515">"Version"</font> : <font color="#A31515">"2.2"</font> , <br> <font color="#A31515">"Query"</font> : <br> { <br> <font color="#A31515">"SearchTerms"</font> : <font color="#A31515">"a hard day's night"</font> <br> }, <br> <font color="#A31515">"Translation"</font> : <br> { <br> <font color="#A31515">"Results"</font> : <br> [ <br> { <font color="#A31515">"TranslatedTerm"</font> : <font color="#A31515">"einem harten Tag-Nacht "</font> } <br> ] <br> } <br> } <br> } <font color="#008000">/* pageview_candidate */</font> );</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  I don‚Äôt know what the comment / * pageview_candidate * / means, and I don‚Äôt like the absence of the {} block after if, but I like the idea. <br><br>  The problem in this code is only one - errors of this kind are now silently skipped, which can complicate the debugging process.  It would probably be more beautiful to write a message to the console in case of an error if the callback function is not defined. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> callback === <font color="#A31515">'function'</font> ) { <br> callback(... data ... ); <br> } <font color="#0000ff">else</font> { <br> <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> console!== <font color="#A31515">'undefined'</font> &amp;&amp; <br> <font color="#0000ff">typeof</font> console.log !== <font color="#A31515">'undefined'</font> ){ <br> console.log( <font color="#A31515">'Error: Callback method not defined'</font> ); <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  In general, a very interesting approach! <br><br>  <i>From the translator: By the way, getting data through the script tag is often also <a href="http://habrahabr.ru/blogs/javascript/55553/">more productive</a> than eval and sometimes even compared to native JSON.parse.</i>  <i>According to the link, however, there is no comparison with JSONP.</i> </div><p>Source: <a href="https://habr.com/ru/post/62314/">https://habr.com/ru/post/62314/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../62307/index.html">The Pirate Bay begins testing anonymizer</a></li>
<li><a href="../62308/index.html">Children's Wikipedia. Need?</a></li>
<li><a href="../62309/index.html">Until the roof has moved out - paint it white</a></li>
<li><a href="../62311/index.html">Open air do it yourself</a></li>
<li><a href="../62312/index.html">Weather Monitoring or Cacti HowTo</a></li>
<li><a href="../62315/index.html">Easy way to add license file support to your .Net application</a></li>
<li><a href="../62316/index.html">Elections in Iran: Internet media as a means of fighting for freedom of choice</a></li>
<li><a href="../62317/index.html">Miranda 0.8 released</a></li>
<li><a href="../62318/index.html">1048 characters / minute 0_o</a></li>
<li><a href="../62320/index.html">New Evernote - specifically for iPhone 3.0</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>