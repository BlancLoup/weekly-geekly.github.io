<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Exploration and engineering: 3D-models of buildings, junctions and quarries by photo</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At some point, we came across a man in civilian clothes with a whole hard disk of photographs of a single engineering object (for definiteness, let's ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Exploration and engineering: 3D-models of buildings, junctions and quarries by photo</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/ee2/063/22a/ee206322ac6540e8abf60c7ddb20a070.jpg"><br><br>  <b>At some point, we came across a man in civilian clothes with a whole hard disk of photographs of a single engineering object</b> (for definiteness, let's call it a railroad overpass).  The task was reduced to the traditional "once built for a long time, and then lost the original documentation," and you need to restore the project with an error of a centimeter or two. <br><br>  To understand how good accuracy can be obtained in architecture and engineering research of this kind, we decided to shoot our 11-story office and create a 3D model.  At the end of the work, we received a building model and measured a pair of windows on it.  Then we went and measured the same windows in the real world - the average discrepancy was within a centimeter, the maximum was two. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      By the way, one of our partners had a somewhat similar task - it was necessary to remove a quarry with an area of ‚Äã‚Äã470 hectares and: <br><ol><li>  Determine the volume of rock production. </li><li>  Calculate the volume of the warehouse of products. </li><li>  Get the surface to clarify the level of the hydraulic mine dump. </li><li>  Get a 3D model of the whole territory. </li></ol><br><br><img src="https://habrastorage.org/files/c12/1ad/fb7/c121adfb7303463ba6a183c24fc17449.jpeg"><br>  <i>Part of the routes</i> <br><br>  She was decided with the help of a drone, long nails, a GPS-receiver and two packs of plastic plates for 5 rubles per piece. <a name="habracut"></a><br><br><h4>  Tasks and vendors </h4><br>  The task of obtaining a 3D model from the prototype of the object or the object itself is quite easily solved in the gaming industry and other similar areas by 3D scanning of the object.  We have our own 3D scanners, but putting something larger than a dog inside them seems rather difficult.  Most buildings, alas, are larger than dogs.  Of course, there are still hand-held scanners and industrial technologies, where you can drive a helicopter at least, but this is all quite a separate specialized area.  Incidentally, it is also suitable for buildings.  But the use of photogrammetry and drone more advantageous in time. <br><br>  In the case of a building, the model is used the same as for the scanner, but there are nuances: <br><ul><li>  Both technologies assume the presence of a multitude of images from different points, and for each image there is meta information with camera location. </li><li>  The scanner works in "sterile" conditions, so filtering and preparing images is not needed.  For large surveys, the lighting is different (elementary - during the shooting the cloud covered the sun), so the algorithms require more explicit reference points. </li><li>  Shooting engineering objects is usually done with drones, helicopters or different high-altitude, so the set of shooting points is much more limited, and plus we need to filter images made during the platform-shake anti-missile maneuver. </li></ul><br>  <b>The principle of operation is as follows:</b> on the basis of photo metadata and the search for similar image fragments, clearly defined reference points are built.  As a rule, these are different angles, contrasting elements of the drawings, and borders of objects.  Each pixel in the photo is searched for color matching in other photos based on the hypothesis of exactly where the pixel will be, taking into account the rotation and change of the camera position. <br><br><img src="https://habrastorage.org/files/e88/aa0/7bb/e88aa07bb9b548d7a6f67321c5d9229f.png"><br><br>  Matches found become key points.  If there are at least three reference photos, this point is already built in the 3D model.  Spatial coordinates are triangulated: directresses are drawn from each point of the survey to the selected point, and their intersection gives the desired value. <br><br><img src="https://habrastorage.org/files/67f/e08/211/67fe082118624a2e803521983a9bc77a.png"><br>  <i>These planes - the estimated shooting plans, and in the middle - a crocodile.</i>  <i>Below is an example of how this looks for a building.</i> <br><br>  To improve the signal / noise ratio, filtering methods are also used.  The most popular is the Levenberg-Marquardt algorithm (or the bundle method) for specifying the coordinates of points.  Then, on the basis of the reference points, the remaining points are restored with some accuracy, and all this is covered by polygons. <br><br><img src="https://habrastorage.org/files/b74/c78/dfb/b74c78dfb9d84f5097be32fc3850e0b6.jpg"><br><br>  The next step is texturing.  The 3D model is expanded into a plane, and then the spatial position of the point is aligned with the original photo to set the color. <br><br><img src="https://habrastorage.org/files/08f/613/30b/08f61330ba9d4daea2c7177dfe0332aa.jpg"><br><br><img src="https://habrastorage.org/files/b40/81c/5de/b4081c5deed047f6a3feea854a565515.jpg"><br><br>  Our task was best answered by ready-made packages Photoscan from Agisoft, Pix4Dmapper from Pix4D, ContexCapture from Bentley. <br><br>  Photoscan is a Russian ‚Äúsemi-professional‚Äù package that is fairly affordable, but hardly applicable on farms.  Pix4Dmapper is a Swiss product for processing aerial reconnaissance drone data.  It is considered one of the best solutions for working with orthophotomaps, point clouds and digital terrain models.  As a rule, well out of the box takes metadata from drones.  Slow, dear.  ContexCapture is a versatile French product.  Difficult to configure, but very convenient for work, because it knows how to work with very noisy data and fits well with large infrastructures, obviously industrial.  As a result, we stopped at it. <br><br><img src="https://habrastorage.org/files/d6b/911/044/d6b911044b934add8cfb85053ca701fb.jpg"><br>  <i>The resulting holographic 3D-model based on 290 photos.</i>  <i>We used it for demonstration on 3D-tables.</i> <br><br><h4>  Practice </h4><br>  First of all, we started not from the building, but from tests in the laboratory.  It was necessary to understand how many photos on a complex object is minimal and sufficient.  It turned out that a very small number of photos naturally leads to a deterioration of the model (this is understandable intuitively), but a large number too.  It is important not to overdo it, because with a significantly excessive amount of source images, the filtering algorithms begin to wonder and "blur" the coordinates.  This results in uneven outlines of objects.  Surely this is solved by fine tuning the input parameters, but it is much easier to select only suitable images of good quality in the right quantity. <br><br><img src="https://habrastorage.org/files/8da/f5b/4c7/8daf5b4c768f4838bb09c4ffa808d66c.jpg"><br>  <i>Test Crocodile</i> <br><br>  On a cluster of 6 cars, difficult terrain was calculated overnight. <br><br>  As a result, all the work on the building took less than one working day.  Naturally, the resulting model cannot yet replace the elaborated model created by the engineer manually, since there are quite a few errors or inaccuracies of the image in the layout.  Hence, the third task has grown - to make it beautifully, that is, to finalize it with my hands after the calculation.  The fact is that we showed the results to different people, and they reacted differently. <br><ol><li>  We show the reconstruction of an archaeological find to a museum representative.  The reaction is just wow. </li><li>  We show the pit to the engineer - it is keenly wondering whether it will be possible for the drone to fly even from inside the building (it‚Äôs not possible, for this purpose to use laser scanners correctly). </li><li>  We show the building to the architect - delighted. </li><li>  We show it to the construction company financial director: ‚ÄúWhat kind of cartoon sucks?‚Äù </li></ol><br>  In general, the result at the output of the calculation module is not the most aesthetic, although quite good.  Let's just say, for a commercial result like architecture presentations, tailored textures with pure colors and precise outlines are exactly needed.  For us, the first model was enough for our measurement task. <br><br><h4>  Career </h4><br>  While we were experimenting with the building, we found out that a similar problem was already being solved by our partners - Photometer LLC.  Their task was to quickly and cheaply remove a quarry of 4 square kilometers: <br><ol><li>  Determine the volume of rock production. </li><li>  Calculate the volume of the warehouse of products. </li><li>  Get the surface to clarify the level of the hydraulic mine dump. </li><li>  Get a 3D model of the whole territory. </li></ol><br>  Of course, the task of calculating the size of the warehouse promised excellent civil and not very application.  For the decision was taken Quadcopter DJI Fantom 3, 5 batteries, a laptop and a GPS receiver for coordination on the ground.  They decided to place ‚Äúbeacons‚Äù on the spot for greater accuracy: on 470 hectares they took 24 white plastic disposable plates, which were fastened with nails-weave.  The coordinates of each plate were taken from the receiver with the minimum possible error. <br><br><img src="https://habrastorage.org/files/c44/f9c/f30/c44f9cf30936416cab37e3d1fd0d6522.jpeg"><br>  <i>Flight plan</i> <br><br>  A strong wind was blowing (about 10 m / s) and it was snowing.  It was difficult to fly, so it took about 5 hours to shoot, all 5 batteries were consumed, 27 GB of material was filmed.  The total length of the route is 45 km. <br><br><img src="https://habrastorage.org/files/582/927/db5/582927db56b94c65a0c2717ed9903e95.jpeg"><br>  <i>An example of the image from the video</i> <br><br>  In the same Context Capture, they downloaded 27 GB of video and coordinates in the WGS 84 system. They started the video processing process and the aerial triangulation process.  Calculation - 2.5 hours on a dual-core office computer.  Then another 28 hours for a 3D model.  The machine processed as a result of 1860 photos and built a three-dimensional model of the entire career (470 Ha).  The required formats were obtained from this model: Las (point cloud), OBJ (textured model), FBX (three-dimensional graphics) and orthophotomap.  At this stage of processing photographic ended. <br><br>  Las 1.5 GB was transferred to the customer to compare the results of aerial photography and the classical method used in the career.  Unfortunately, they were unable to open this file on-site, because when they tried to ‚Äúchew on‚Äù AutoCAD Civil 3D, they refused to give at least some signs of life.  It was decided to discharge the cloud of points 300 times. <br><br><img src="https://habrastorage.org/files/bf4/129/cfc/bf4129cfce4c4efab2a5134e6956a77a.jpeg"><br><br>  The result - in this simplified file, the difference between the work of the surveyor with the total station and the aerial photography was 0.5% with an allowance in mining up to 5% (according to the standard depending on the volume). <br><br><img src="https://habrastorage.org/files/4e0/8b0/a60/4e08b0a60fad452aadc2070046c35aee.jpeg"><br><br>  The accuracy of aerial photography is higher because the model is built on a surface with millions of points, while the surveyor gains them much less.  On the other hand, 3 days for all work (or 1‚Äì2 days when calculating in a cluster) instead of a month, and from equipment - an available drone for 100 thousand rubles, and it was launched almost from the knees. <br><br><h4>  Summary </h4><br>  Previously, photogrammetry was used in geology, topography and archaeological excavations.  Then - after one epic survey of the junction for the restoration of the project and a few more surveys to control the state of the project - gained fame in construction.  Recently, photometry began to be applied in the film industry.  As you can see, something has changed since 1852, since French engineer E. Losseda was shooting Paris from a balloon. <br><br><h4>  Links </h4><br><ul><li>  <a href="https://thedrone.ru/semka-karera/">The task</a> of the career on the website of partners </li><li>  Why else <a href="https://habrahabr.ru/company/croc/blog/221921/">are 3D solutions used by engineers?</a> </li><li>  My mail is YChalyy@croc.ru </li></ul></div><p>Source: <a href="https://habr.com/ru/post/301178/">https://habr.com/ru/post/301178/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../301156/index.html">Report from Moscow CocoaHeads Meetup April 29</a></li>
<li><a href="../301166/index.html">Functional autotest</a></li>
<li><a href="../301172/index.html">Two availability, or why accessibility and availability are not the same</a></li>
<li><a href="../301174/index.html">Generics in Kotlin vs. Generics in JAVA: similarities, differences, features</a></li>
<li><a href="../301176/index.html">R in Microsoft Azure to win the hackathon. Instructions for use</a></li>
<li><a href="../301180/index.html">Digest of recent advances in cryptography. Zero release</a></li>
<li><a href="../301182/index.html">[St. Petersburg, Announcement] Meeting with Andrey Pangin - Everything you wanted to know about stack-traces and hip dumps</a></li>
<li><a href="../301186/index.html">Magento 2: cookies, registry, session</a></li>
<li><a href="../301188/index.html">10 types of insane customers</a></li>
<li><a href="../301190/index.html">We control the computer from an Android device</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>