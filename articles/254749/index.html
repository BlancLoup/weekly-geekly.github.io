<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bubot is a very easy Python 3 framework for robot programming and home automation.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prehistory 
 I wanted to create my own robot, as well as automate the control of light and climate at home. To this end, began to explore the possibil...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bubot is a very easy Python 3 framework for robot programming and home automation.</h1><div class="post__text post__text-html js-mediator-article"><h4>  Prehistory </h4><br>  I wanted to create my own robot, as well as automate the control of light and climate at home.  To this end, began to explore the possibilities.  For myself, I divided all the solutions into two groups: systems in which the code on the controller is executed in one main loop (arduino, lego, etc.) and systems consisting of parallel processes exchanging messages between themselves. <br>  Intuitively, I chose the second group, because I wanted to find the simplest solution with a friendly user interface.  Of the most popular members of this ‚Äúfamily‚Äù, <a href="https://ru.wikipedia.org/wiki/Microsoft_Robotics_Developer_Studio">Microsoft Robotics Studio</a> and <a href="http://robocraft.ru/blog/robosoft/721.html">ROS</a> liked very much.  But unfortunately, at the current moment, it is not easy to tie them to a specific hardware, and it is also not a very trivial task to understand them from scratch.  In the end, I decided to write myself, but I really didn‚Äôt want to ‚Äúcode‚Äù in C, Soul asked for something simpler and easier.  As a result, I chose Python.  And taking into account that a bunch of other ideas started to creep into the head by the robot and the ‚Äúsmart home‚Äù, I decided to immediately create a small framework in which the main focus would be on the simplicity of development. <br><br><h4>  Concept </h4><br>  Conceptually, the framework is a set of user-supported modules that implement various functions of robotics.  When running, Bubot builds a network of processes that can asynchronously receive and send messages among themselves.  You can also build a network of robots that will communicate with each other. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9c9/13d/b54/9c913db54addf2478103893654bcadf8.png" alt="Bubot - Scheme">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The process network is built on the basis of the standard Python module multiprocessing.  The messaging system and shared memory are implemented using <a href="http://devacademy.ru/posts/vvedenie-v-redis-py/">Redis</a> . <br><br>  Each Bubot has a built-in web server, the <a href="http://wiki.python.su/%25D0%2594%25D0%25BE%25D0%25BA%25D1%2583%25D0%25BC%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B0%25D1%2586%25D0%25B8%25D0%25B8/Tornado-web%3Fhighlight%3D%2528%2528%25D0%2594%25D0%25BE%25D0%25BA%25D1%2583%25D0%25BC%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B0%25D1%2586%25D0%25B8%25D0%25B8%257CTornado-web%2529%2529">Tornado</a> web server, which allows you to monitor the status, control the robot, change (calibrate) the robot on the go, and also enable the data exchange between robots. <br>  Bubot is not a real-time system, although Bubot can be integrated with a real-time code. <br><a name="habracut"></a><br><br><h4>  Hello bubot </h4><br>  Learning something new is always easier with an example, and the first thing that comes to mind is to remake a radio-controlled toy for management via a web interface via wi-fi or 3G. <br><br>  To do this, we need any Chinese radio-controlled machine and any mini computer on which Python 3 can work. As the guinea pig, one of the most affordable was purchased - raspberry pi b +. <br><br>  Initially, almost any radio-controlled machine is two motors and a primitive radio module.  We only need motors from it and that the machine itself be the right size to accommodate all the electronics. <br><br>  To begin with, let's simplify the task - our machine must perform four actions: go forward or backward, turn left or right. <br><br>  To solve the problem we need: <br><ul><li>  Connect motors to raspberry </li><li>  Implement a service that will accept and interpret user commands for specific physical devices. </li><li>  Implement a web interface that will send user commands: Set the power of the main or rotary engine -100% / 0% / 100%. </li></ul><br><h4>  We connect the motors </h4><br>  The simplest way to connect the motors to the Raspberry Pi is to use a ready-made controller, the choice of which depends only on the expected power of the motors.  I chose with a margin based on L298N.  The search string on aliexpress "L298N motor driver board" will cost you about $ 3 with shipping. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1f0/028/386/1f0028386bacc626ee4cf3a887638c9b.png" alt="The simplest example - Connection Diagram"><br><br>  Also, to power a raspberry, you will need at least one step-down voltage converter.  I took the base LM2596.  The search string on aliexpress "DC-DC LM2596" will cost you about $ 1 with shipping. <br><br>  With this connection, in order to force the machine to execute one of our teams, it is enough to set a high level on the corresponding GPIO. <br><br><h4>  We realize the motor module </h4><br>  In order to simplify the model, let our teams go directly to the motors. <br><br>  Since we have two identical (from a software point of view) motor, we will need one module.  All modules are inherited either from the base class Buject, or from its descendants.  From the base class, the developer receives the main infinite loop, methods for processing and transmitting events.  The modules in the framework are in the buject directory.  Each module consists of two files: <br><ul><li>  [module name] .py - module logic </li><li>  [module name] .json - module description.  It contains a list of module parameters, their default values, a list of possible statuses, a description of messages generated by the module, and a list of messages to which the module is signed. </li></ul><br>  An example of the module for our motors \ buject \ MotorTest.py: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> json <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> buject.Buject <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Buject <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RPi.GPIO <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> GPIO <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MotorTest</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Buject)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#     def __init__(self, user_config=None): super(MotorTest, self).__init__(user_config) #       #    GPIO def on_ready(self): GPIO.setmode(self.param["mode"]) GPIO.setwarnings(False) #    ,       #        #           # set_power       def incoming_request_set_power(self, message): data = json.loads(message['data']) if data['param']['value'] &gt; 0: #    GPIO.setup(self.param['GPIO_reward'], GPIO.OUT, 0) GPIO.setup(self.param['GPIO_forward'], GPIO.OUT, 1) self.status['action'] = "forward" elif data['param']['value'] == 0: GPIO.setup(self.param['GPIO_forward'], GPIO.OUT, 0) GPIO.setup(self.param['GPIO_reward'], GPIO.OUT, 0) self.status['action'] = "stopped" else: GPIO.setup(self.param['GPIO_forward'], GPIO.OUT, 0) GPIO.setup(self.param['GPIO_reward'], GPIO.OUT, 1) self.status['action'] = "backward {0}%".format(self.status["power"]) #     ,    if self.param['debug'] &gt; 1: self.log('Buject "{0}" {1}'.format(self.param['name'], self.status['action']))</span></span></code> </pre> <br>  Comments, I think unnecessary.  A request arrives, in the parameters of which the motor power is indicated, if it is greater than zero, we tell the motor to go forward, less - backward, equal to zero - we stand. <br><br>  The infinite loop was not involved in this case.  In case of its presence, it is sufficient to define the method main_loop (). <br><br>  An example of a module description for our motors \ buject \ Motor.json: <br><br><pre> <code class="bash hljs">{ <span class="hljs-string"><span class="hljs-string">"param"</span></span>: { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: { <span class="hljs-string"><span class="hljs-string">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">"MotorTest"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"   "</span></span> }, <span class="hljs-string"><span class="hljs-string">"parent"</span></span>: { <span class="hljs-string"><span class="hljs-string">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">"Buject"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"  ,     "</span></span> }, <span class="hljs-string"><span class="hljs-string">"buject"</span></span>: { <span class="hljs-string"><span class="hljs-string">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">"MotorTest"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"  =  "</span></span> }, <span class="hljs-string"><span class="hljs-string">"GPIO_forward"</span></span>: { <span class="hljs-string"><span class="hljs-string">"value"</span></span>: 0, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">" GPIO   "</span></span> }, <span class="hljs-string"><span class="hljs-string">"GPIO_backward"</span></span>: { <span class="hljs-string"><span class="hljs-string">"value"</span></span>: 0, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">" GPIO   "</span></span> }, <span class="hljs-string"><span class="hljs-string">"GPIO_mode"</span></span>: { <span class="hljs-string"><span class="hljs-string">"value"</span></span>: 11, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"value for GPIO.setmode GPIO.BOARD=10 GPIO.BCM=11"</span></span> } }, <span class="hljs-string"><span class="hljs-string">"incoming_request"</span></span>: { <span class="hljs-string"><span class="hljs-string">"set_power"</span></span>: { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"set_power"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">"param"</span></span>: { <span class="hljs-string"><span class="hljs-string">"value"</span></span>: { <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"   "</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"int"</span></span> } } } } }</code> </pre><br>  The param section contains a list of parameters required for starting and operating the module.  The first three are required for each module, and are inherited from the base class Buject.  The latter are specific only for this module, the number and name of them you yourself invent depending on your needs.  GPIO_mode sets the GPIO addressing mode and will not be redefined later.  While for GPIO_forward and GPIO_backward there is no point in setting default values, since  they depend solely on what conclusions a particular motor will be connected to and we will define them further in the launch parameters of this module. <br><br>  The module description may also contain a status section - where all calculated parameters are described - reflecting the current state of the module.  In our module there are no added statuses, however, if you noticed, in the code of the module itself, we change the status of 'action', which is defined in the description of the basic module Buject. <br><br>  The framework provides the ability to use five types of messages. <br><ul><li>  incoming_request - a list of requests that the module can handle. </li><li>  outgoing_request - a list of requests generated by the module.  As parameters, you must specify the name of the service receiving the requests and the name of the request. </li><li>  incoming_event - list of subscriptions to events of other modules, you must specify the name of the service and the name of the event. </li><li>  outgoing_event - a list of events to which other modules can subscribe. </li><li>  incoming_response - service type, which is declared on the outgoing request.  Says that the service will wait for an asynchronous response to the request. </li></ul><br><h4>  We implement web interface </h4><br>  Each robot can have an unlimited number of web interfaces.  In our case, to control the robot, we need only one - implementing 4 buttons, which will give a command when pressed, and cancel if released. <br><br>  User interfaces are stored in the ui directory.  Each page of the user interface is described in a separate subdirectory, and consists of at least 2 files: <br><ul><li>  [Page name] .html - page layout. </li><li>  [Page name] .json - interface description.  Each page (session) for the framework is essentially a separate service, this file contains a description of the events on which this page is signed, as well as the messages it generates. </li><li>  [Page name] .py - (optional) may contain server-side logic for processing commands of this user interface, in our case it is not useful. </li></ul><br>  Let's again, to improve perception, a little more simplified.  In the example below, we consider the algorithm for one button ahead.  The rest can be done by analogy. <br><br>  So, we create in the ui directory the subdirectory scout_easy and in it two files scout_easy.html and scout_easy.json with the following content (comments on the text). <br><br>  \ ui \ scout_easy \ scout_easy.html <br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UTF-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/jquery-ui-1.11.2/jquery-ui.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/jquery-2.1.3.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/jquery-ui-1.11.2/jquery-ui.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/bubot_socket.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>BuBot<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="actionscript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="actionscript"><span class="hljs-function"><span class="hljs-title">bubot_on_open</span></span></span></span><span class="hljs-params"><span class="actionscript"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span><span class="actionscript"><span class="hljs-function"> </span></span></span><span class="actionscript">{ </span><span class="hljs-comment"><span class="actionscript"><span class="hljs-comment">//       , //    WebSocketa       //  ,      ui/studio  ui/scout--&gt; } function get_bubot_actions() { //       ,    , //        . //      ui/studio  ui/scout--&gt; return {}; } $(function () { //      $("#command_move_forward").button({}).mousedown(function () { //      , //      100% //       0%--&gt; bubot_send_message('send_request', {'name': "set_move_motor_power", 'data': {'value': 100}}); }).mouseup(function () { bubot_send_message('send_request', {'name': "set_move_motor_power", 'data': {'value': 0}}); }); }) </span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ui-widget-content"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"command_move_forward"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"command_button"</span></span></span><span class="hljs-tag">&gt;</span></span>forward<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"console"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ui-widget-content"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Pay attention to the div id = console, if it is present, the framework will display all console messages in it, including  server-side error code. <br><br>  bubot_socket.js - must be present on every ui page, since it is he who is responsible for establishing a connection with the server and exchanging messages. <br><br>  The connection to the server takes place via the web socket, the bubot_send_message method ([message name], [message parameters]) is responsible for sending messages to the server.  On the server, when a message arrives, a method of the same name is called, to which the message parameters are passed.  In our case, the method sending the request set_move_motor_power is called, the framework service of the message recipient is taken from the user interface description file, the names of these services are defined in the final section when describing the robot. <br><br>  \ ui \ scout_easy \ scout_easy.json <br><pre> <code class="bash hljs">{ <span class="hljs-string"><span class="hljs-string">"incoming_request"</span></span>: { <span class="hljs-string"><span class="hljs-string">"console"</span></span>: { <span class="hljs-string"><span class="hljs-string">"time"</span></span>: {}, <span class="hljs-string"><span class="hljs-string">"message"</span></span>: {} } }, <span class="hljs-string"><span class="hljs-string">"outgoing_request"</span></span>: { <span class="hljs-string"><span class="hljs-string">"set_move_motor_power"</span></span>: { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"set_power"</span></span>, <span class="hljs-string"><span class="hljs-string">"buject"</span></span>: <span class="hljs-string"><span class="hljs-string">"move_motor"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"     "</span></span>, <span class="hljs-string"><span class="hljs-string">"param"</span></span>: { <span class="hljs-string"><span class="hljs-string">"value"</span></span>: { <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"   ,  &gt; 0,  &lt; 0"</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"int"</span></span> } } }, <span class="hljs-string"><span class="hljs-string">"set_rotate_motor_power"</span></span>: { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"set_power"</span></span>, <span class="hljs-string"><span class="hljs-string">"buject"</span></span>: <span class="hljs-string"><span class="hljs-string">"rotate_motor"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"     "</span></span>, <span class="hljs-string"><span class="hljs-string">"param"</span></span>: { <span class="hljs-string"><span class="hljs-string">"value"</span></span>: { <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"   ,  &gt; 0,  &lt; 0"</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"int"</span></span> } } } } }</code> </pre><br><h4>  Run the robot </h4><br>  So, we have prepared all the parts of the robot.  To run it, you need another file with a description of the robot itself. <br><br>  The config directory stores descriptions of all your robots.  You can create a description both manually and with the help of the configurator - but more about this in the bubot: scout video. <br><br>  So, for our first robot, the description will look like this: <br><br>  \ config \ scout_easy.json <br><pre> <code class="bash hljs">{ <span class="hljs-string"><span class="hljs-string">"param"</span></span>: { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: { <span class="hljs-string"><span class="hljs-string">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">"scout_easy"</span></span> } }, <span class="hljs-string"><span class="hljs-string">"depend_buject"</span></span>: { <span class="hljs-comment"><span class="hljs-comment">#         "move_motor": { #  ,      ,          "param": { "buject": { #        "value": "MotorTest" }, "name": { #   "value": "move_motor" }, "GPIO_forward": { #        "value": 20 }, "GPIO_reward": { "value": 21 } } }, "rotate_motor": { #     "param": { "buject": { "value": "MotorTest" }, "name": { "value": "rotate_motor" }, "GPIO_forward": { "value": 13 }, "GPIO_reward": { "value": 19 } } } } }</span></span></code> </pre><br>  According to this description, at launch, Bubot will create two copies of the MotorTest module with different parameters: one for the main motor - move_motor, the other for the steering motor - rotate_motor and will start out as processes.  As you can see, we did not specify the way of GPIO addressing, since  we are satisfied with the default value, but we redefined the GPIO_forward and GPIO_backward parameters in accordance with the motor connection scheme. <br><br>  Now we have absolutely everything ready.  You can run. <br><pre> <code class="bash hljs">python3 StartBubot scout_easy</code> </pre><br>  Open the user interface <a href="http://localhost/ui/scout_easy">http: // localhost / ui / scout_easy in the browser</a> and try to click on the button.  When you first start you will be asked to enter a username and password - enter any values, the default access rights to the system are not installed. <br><br><h4>  Bubot scout </h4><br>  If we progressively develop our machine further, the next step is adjustment of the drive speed, replacement of the steering motor for servus, installation of the camera, camera drives, speech synthesizer, recognition of voice commands, etc.  <a href="http://habrahabr.ru/post/255669/">But that's another story.</a> <br><br><img src="http://wiki.razgovorov.ru/images/thumb/5/5b/Scout_scheme.png/500px-Scout_scheme.png" alt="Bubot: scout - Connection Diagram"><br><img src="http://wiki.razgovorov.ru/images/thumb/d/dd/Scout_buject.png/500px-Scout_buject.png" alt="Bubot: scout - Scheme of services"><br><br>  <a href="https://sourceforge.net/projects/bubot/">Download Bubot</a> </div><p>Source: <a href="https://habr.com/ru/post/254749/">https://habr.com/ru/post/254749/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254737/index.html">Talking panda or what can be done with FFmpeg and OpenCV on Android</a></li>
<li><a href="../254739/index.html">Techno-Designed Alarm Clock - Arduino Based Desk Clock</a></li>
<li><a href="../254741/index.html">Traffic Inspector: full reboot</a></li>
<li><a href="../254743/index.html">Stepic seeking talents</a></li>
<li><a href="../254747/index.html">Comparison of deep learning libraries on the example of the handwriting numbers classification problem</a></li>
<li><a href="../254751/index.html">How Wheatfield Diffie helped Bob and Alice trick Eve</a></li>
<li><a href="../254753/index.html">Determine the weight of chess pieces by regression analysis</a></li>
<li><a href="../254755/index.html">From complex to simple: the evolution of interfaces of mobile trading terminals</a></li>
<li><a href="../254757/index.html">We write the postal address, as humans</a></li>
<li><a href="../254759/index.html">Genetic algorithm - visual implementation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>