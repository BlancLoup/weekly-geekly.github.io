<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why doesn't Wi-Fi based positioning take off</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Preface or "If we have Wi-Fi, but let's position it with the help of it!" 
 Now geo-positioning on the basis of GPS technology is used by everyone who...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why doesn't Wi-Fi based positioning take off</h1><div class="post__text post__text-html js-mediator-article"><h4>  Preface or "If we have Wi-Fi, but let's position it with the help of it!" </h4><br>  Now geo-positioning on the basis of GPS technology is used by everyone who has a smartphone.  But as soon as a person enters the building, the GPS stops working (although the smartphone shows the coordinate, but with much less accuracy).  On the one hand, it was not very desirable, on the other hand, and why not, there are practical tasks for this. <br><br>  But if you look at what the market offers us, until you see an adequate solution that is ready to offer the consumer an affordable and fairly accurate solution at the same time. <br><br>  In this article I will try to consider the technical aspects (not related to the applied applicability) of positioning based on Wi-Fi technology (this technology is most common indoors and is suitable for solving this problem) and analyze the reasons for failure in implementation. <br><a name="habracut"></a><br><h4>  At first sight </h4><br>  At first glance (and only!), The Wi-Fi infrastructure is very well suited for indoor positioning: it has a sufficient number of points with known coordinates (meaning Wi-Fi access points, then just TD), every smartphone has Wi-Fi inside. Fi adapter (Client).  Now it is possible to calculate the distance between the TD and the Client and calculate the Client's location using trilateration. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To solve the trilateration problem, it is necessary to have measurements from at least three points with known coordinates.  To calculate the distance, the client‚Äôs signal level on the TD is measured, or rather its attenuation (we can get this data from the Wi-Fi infrastructure, this is within the scope of the IEEE 802.11 standard).  Attenuation is converted to a distance using the formula for signal propagation in open space (FSPL - free space path loss).  Next, we recruit the required number of measurements.  If the distance from one TD is known, then a circle of a known radius can be described around it.  If the distance from the two TDs is known, then the determined location will be located at the intersection of two circles.  The presence of the third measurement determines the point at the intersection of the three circles. <br><br>  And now we can arrange the Wi-Fi client on the plane.  The task is clear, the implementation is clear.  Many manufacturers took up the implementation (in general, they began to do the right thing, I think).  But unfortunately, there are still a lot of questions in this decision. <br><br><h4>  Main questions </h4><br>  1. The increase in the number of TD more than doubled compared with their usual number. <br>  2. Poor positioning accuracy even in ideal conditions (about 10 meters).  And the cardinally deteriorating accuracy in the case of at least a small neglect of some requirements. <br>  3. Unpredictable frequency of updating Wi-Fi client position data. <br><br><h4>  Wi-Fi Positioning Requirements </h4><br>  ‚Ä¢ Direct visibility is desirable between the three TDs and the Client; <br>  ‚Ä¢ The client should hear well at least three TDs (and not one, which is usually enough); <br>  ‚Ä¢ Hearing ‚Äúgood‚Äù, this is -75dBm and more, and this is not just ‚Äúgood‚Äù, it is very confident; <br>  ‚Ä¢ Access points should be placed around the perimeter of the building and in a staggered manner; <br>  ‚Ä¢ Wi-Fi client should not be very silent. <br><br>  Why are such stringent demands being made and what threatens us if we do not satisfy these stringent requirements? <br><br><h5>  Direct visibility is desirable between the three TDs and the Client. </h5><br>  Perhaps the main problem that developers of indoor positioning algorithms had to face was a large number of signal reflections.  This is the worst enemy of all positioning systems, which are based on measuring the propagation time or attenuation of the signal. <br><br>  And what, for example, GPS?  In GPS technology, we are dealing with a signal without reflections, with satellites in direct line of sight.  This allows us to achieve very good positioning accuracy.  As soon as GPS has to deal with a re-reflected signal, positioning accuracy catastrophically decreases. <br><br>  Why it happens?  Because we are actually measuring the length of the signal path (by counting the time delay or attenuation of the signal) and if it is reflected, then let it become longer than the actual distance.  In the case of Wi-Fi indoors, we are always dealing with reflections.  Moreover, all the main technologies of the IEEE 802.11n, 802.11ac standards (MIMO, MRC, BF) use this effect in their basis, without which they work worse. <br><br>  For trilateration, this is very bad, the length of the path is measured with a large error, thereby increasing the overall positioning error. <br><br>  Direct visibility can minimize the reflections and, therefore, reduce the error.  Therefore, there is a recommendation to place the access point in the line of sight. <br><br>  What does this requirement lead to?  Such a requirement leads to a significant increase in TD, since within the framework of the usual coverage we only need one access point for 3-5 premises (the access points well ‚Äúpierce‚Äù one / two non-capital walls). <br><br><h5>  The client should hear well at least three TDs (and not one, which is usually enough) </h5><br>  An ordinary Client has enough signal from one access point, it is obvious. <br>  For positioning, a good signal level of three to four TDs is required. <br><br><h5>  Hearing ‚Äúgood‚Äù is -75dBm and more, and this is not just ‚Äúgood‚Äù, it is very confident </h5><br>  Take the official Cisco guide, which says that in order for the positioning accuracy to be about 10m in 90% of cases, the Wi-Fi client must ‚Äúhear‚Äù at least three access points with a signal level at least -75dBm.  Why precisely -75dBm and what happens if the signal is worse? <br><br>  The fundamental role in the fact that the value of -75dBm, from my point of view, has the nature of the attenuation of the signal (the very FSPL).  The signal decays not with a linear, but with a <s>logarithmic</s> quadratic dependence (the logarithm appears from the translation of FSPL to dB).  That is, for example, the farther from the transmitter, the greater the distance the signal has to overcome, so that its level drops by half.  It follows from this that the farther from the transmitter, the greater the error in distance measurements based on its level. <br><br>  The crucial role is played by the fact that the accuracy of the Wi-Fi receiver is very small, zero decimal places (signal level is measured in dBm), and the accuracy of power measurement in this case has a decisive role for the error of distance measurement. <br><br>  For example, we can cite as an example the GPS technology, in which we have to use atomic frequencies, which ensure the accuracy of measuring the signal propagation time up to the seventh decimal place (measured in seconds).  The seventh decimal place is an error of about 30 meters per meter. <br><br>  Suppose that to achieve acceptable positioning accuracy, for Wi-Fi technology, the error per 1dBm should be no more than 10 meters. <br><br>  To calculate the measurement error in meters per 1 dBm, I will take the FSPL formula and present it as a graph for clarity. <br><br>  The formula for signal propagation for the 2.4GHz frequency can be summarized as follows: <br>  FSPL = 32.4 + (20log10 (2,400)) + (20log10 (x)), where x is the distance in km. <br>  FSPL = 100dB + 20log10 (x) <br><br>  At the first meter, the signal level drops by 40dB, that is, the error is no more than 2.5 cm per dB.  On the second meter, the drop is already at 6dB (the error is already 16 cm per dB), at the third - by 3.5dB (the error is 30 cm per dB). <br><br>  The following graph shows the FSPL values ‚Äã‚Äãalong the X axis, while the Y axis shows the error values ‚Äã‚Äãin meters per 1 dBm. <br><br><img src="https://habrastorage.org/files/c21/558/018/c21558018434424e98b69a560cc42a9c.png" alt="image"><br><br>  An error of 10m corresponds to a signal attenuation of 80dBm.  Moreover, the error begins to increase sharply. <br><br>  Take a modern AP with built-in antennas (5dBi), estimate its transmitter power under current conditions at 12mW (11dBm) and calculate the effective isotropic radiated power (EIRP) from which we subtract our FSPL. <br>  EIRP-FSPL = 11dBm + 5dBi-80dB = -64dBm. <br>  This is the desired signal level required to ensure acceptable positioning accuracy.  Recall that Cisco general recommendations are 75dBm. <br><br>  Considering that my calculation is very approximate, in general the values ‚Äã‚Äãare very similar.  In this case, the main idea is not to calculate a specific value (there are a lot of variables affecting this value), but to understand that with further attenuation of the signal, the positioning accuracy drops very sharply. <br><br>  Surely the next question immediately arises, how much is it, -75dBm (or -64dBm), a lot or a little? <br><br>  The speed of WiFi (modulation, which is used) depends primarily on the SNR (signal / noise), and not only on the signal level.  In general, you can estimate the noise level inside buildings of the order of -95 - -90dBm (office space with several tenants).  High speeds (MCS 5 modulations - MCS 7 (64 QAM)) require SNR values ‚Äã‚Äãof 20 and above.  This means that the signal level must be at least ‚Äì75 - -70dBm. <br><br>  That is, in other words, the -75dBm signal is a ‚Äúconfident‚Äù signal that provides high transmission rates. <br><br>  And finally, the main conclusion is that at least three of these signals are needed for positioning, although in normal conditions one is enough, which inevitably affects the total number of APs. <br><br><h5>  Access points should be placed around the perimeter of the building and in a checkerboard pattern. </h5><br>  The trilateration error also depends on how the meters are located.  On the meter there is information only about the distance to the object.  When drawing circles, it is best to distribute them evenly over the surface, and also to be located, including at the perimeter. <br><br>  In the case of GPS technology, all these issues are elegantly solved by the uniform distribution of satellites in Earth orbit. <br><br>  If for Wi-Fi to arrange access points evenly inside the building is not so unusual (although sometimes it is very convenient to arrange three access points on one straight line in the corridor, which is contraindicated for positioning), then nobody places them around the perimeter, rather, on the contrary, try to avoid it because the coverage of the vast majority of office access points has a circular pattern and the location of the AP on the perimeter leads to incomplete use of the coverage of the access point and the output of the signal outside the building. <br><br><h5>  Frequency of indication </h5><br>  If we are dealing with specialized positioning systems, they care about the frequency of measurements.  GPS satellites constantly transmit a signal, achieving positioning in real time (with quite a small delay, for example, sufficient for navigators). <br><br>  The Wi-Fi infrastructure is not designed to solve the positioning problem and therefore there is no constant transmission of packets at equal intervals.  Wi-Fi positioning systems have to work with the traffic that is.  The more traffic, the better for positioning.  But for Wi-Fi, everything is just the opposite.  Throughout his adult life, the Wi-Fi community has been working on the task of reducing the client‚Äôs airtime, primarily to increase the overall Wi-Fi bandwidth, and secondly, to increase the lifetime of mobile devices.  As a result, Wi-Fi positioning systems have to work with packages that come with unpredictable and often quite large intervals. <br><br>  But even if the Client has transmitted a packet, this packet still needs to be detected by all necessary access points, which is not so easy for Wi-Fi.  I will try to explain with an example. <br><br>  Suppose the client sent a packet on the 1st channel of the 2.4 GHz band.  It is in sight of three access points, according to the standard, they work on the 1st, 6th and 11th channels and if they do not transmit a signal, they should listen.  The first point is the first channel, the second is the sixth, the third is the 11th.  The first access point received this signal and measured its power.  The second and third access points did not hear this packet, since they listened to the sixth and eleventh channels, respectively! <br><br>  All this leads to the fact that the position update frequency is unpredictable and in some cases is very large, can reach several tens of seconds and sometimes minutes. <br><br>  There are different ways to solve this issue.  A typical access point spends a small portion of its time monitoring adjacent channels.  But since this time is short and many channels have to be bypassed, the probability of ‚Äúcatching‚Äù such a package is still small. <br><br>  Also, to solve this problem, additional radio is used on the TD operating in the monitoring mode, which uses all its time exclusively for monitoring and does not serve customers.  But even despite this, there is a chance not to hear the required packet: in the 2.4 GHz band, you need to listen to 3 channels (sequentially) and 16 channels in 5 GHz.  The task is slightly simplified, if we track the location of the connected devices, if the task is to track the position of all known devices, then it will be necessary to bypass the still unused channels (for example, all 13 channels in the 2.4 GHz band). <br><br>  The conclusions are as follows: without the use of special monitoring modules and even with them, there may be a problem with the frequency of updating positions. <br><br><h4>  General conclusions </h4><br>  Good positioning requirements are largely at odds with the requirements for optimal coverage. <br><br>  This leads to an increase in access points of at least two times, as well as to higher prices for TDs themselves (additional modules are needed).  As a result, this leads to an increase in the budget for Wi-Fi infrastructure by two or more times.  While as a result, the positioning accuracy does not exceed 10 meters, and the frequency of updates still turns out to be quite unpredictable, then these solutions, to put it mildly, are controversial and are implemented either in designated areas or with non-compliance with all necessary requirements with a known result. <br><br>  But technologies do not stand still and in the next article I would like to try to analyze in detail the attempts to solve the above problems, and specifically: <br>  - implementation of AoA (angle-of-arrival) technology in Wi-Fi using Cisco Hyperlocation as an example; <br>  - an attempt to increase the frequency of position updates using a dedicated monitoring module using the example of Cisco FastLocation. </div><p>Source: <a href="https://habr.com/ru/post/306044/">https://habr.com/ru/post/306044/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../306032/index.html">Introduction to Veeam Agent for Linux</a></li>
<li><a href="../306034/index.html">Removing a key from a token with a non-recoverable key</a></li>
<li><a href="../306036/index.html">How to make the next bot in Telegram</a></li>
<li><a href="../306038/index.html">Webinar: Meet Asterisk</a></li>
<li><a href="../306040/index.html">Hiring technicians sank by 40% - and no one talks about it</a></li>
<li><a href="../306046/index.html">Interview with mom, bank programmer on COBOL</a></li>
<li><a href="../306048/index.html">Text Editors vs IDE</a></li>
<li><a href="../306050/index.html">How to move your iron server to the clouds in 1 day</a></li>
<li><a href="../306052/index.html">How to "make" a service for mailing manually</a></li>
<li><a href="../306054/index.html">PDF report in 4 minutes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>