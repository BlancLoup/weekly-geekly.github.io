<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How can you use interrupted Yandex.Cloud virtual machines and save on solving large-scale tasks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we want to talk about such a useful function of Yandex. Oblak as interrupted virtual machines. This is a special option that you can choose when...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How can you use interrupted Yandex.Cloud virtual machines and save on solving large-scale tasks</h1><div class="post__text post__text-html js-mediator-article">  Today we want to talk about such a useful function of Yandex. Oblak as interrupted virtual machines.  This is a special option that you can choose when creating a virtual machine to use computational resources at a reduced price.  What is so special about interrupted virtual machines, why are they cheaper than usual, and in what cases is it reasonable to use them? <br><br><img src="https://habrastorage.org/webt/ox/8d/3e/ox8d3etklg4mebfli2f7r0ofdf0.png"><br><a name="habracut"></a><br>  The power of Yandex.Oblak, or rather, the <a href="https://cloud.yandex.ru/services/compute%3Futm_source%3Dhabr%26utm_content%3Dpost250619">Yandex Compute Cloud</a> infrastructure service, is much more than those that are used by users.  By default, it is assumed that users should be able to conditionally unlimited scaling.  At least from these considerations, without taking into account other aspects, the available resources of the cloud platform significantly exceed current demand.  Interrupted virtual machines are created on these free capacities. <br><br><h2>  Main limitations </h2><br>  In short, the essence of interrupted virtual machines can be described as follows: the service offers to use its free computing resources at a lower price, provided that these resources can be withdrawn at any time. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In general, interrupted virtual machines work like regular virtual machines, but for them there are a number of limitations: <br><br><ul><li>  They are not covered by a service level agreement (SLA). </li><li>  Cannot be created and launched. </li><li>  They can be forcibly stopped at any time.  The probability of stopping is small, but not zero, it can change over time and vary in different <a href="https://cloud.yandex.ru/docs/overview/concepts/geo-scope%3Futm_source%3Dhabr%26utm_content%3Dpost250619">accessibility areas of Yandex</a> . <a href="https://cloud.yandex.ru/docs/overview/concepts/geo-scope%3Futm_source%3Dhabr%26utm_content%3Dpost250619">Cloud</a> . </li><li>  An interrupted virtual machine cannot be made normal, but a normal interrupted one.  The corresponding flag is set once and does not change. </li><li>  The machine will necessarily be stopped in a period not exceeding 24 hours. </li></ul><br>  In practice, in the overwhelming majority of cases, interrupted virtual machines work out all 24 hours provided by the terms of service.  A forced shutdown, as a rule, occurs only when a large number of normal virtual machines are created in a specific availability zone in a short period: a new user appears with serious needs or current users are massively scaled. <br><br>  At the same time, the stopped virtual machine can be restarted: all data on the disks is saved both with automatic and manual shutdown. <br><br><h2>  Usage scenarios </h2><br>  Restrictions for interrupted virtual machines raise a logical question: how to use them if resources can be recalled at any time?  As an explanation, here are some possible use cases. <br><br><h3>  Batch processing </h3><br>  Batch processing involves the parallel execution of a large number of resource-intensive tasks.  This can be file format conversion, image processing and recognition, <a href="https://ru.wikipedia.org/wiki/ETL">ETL operations</a> .  The bottom line is that during batch processing there is a queue of tasks and a whole set of working processes (performers) that receive tasks from the queue.  If an individual performer running on an interrupted machine stops, the task will simply be transferred to the next performer.  In other words, stopping one or even several virtual machines will not have a significant negative impact on the process and the result of processing. <br><br><img src="https://habrastorage.org/webt/o9/tt/ny/o9ttnycyli2d6s7sg-c9i47rusk.png"><br><br>  When batch processing, we are talking about using dozens of virtual machines.  The use of interrupted machines gives a very noticeable savings.  Now one of the main consumers of productive interrupted virtual machines with 32 cores is a long-time client of Yandex.Oblaka, Seismotek.  Seismotech processes seismic data that is necessary for the exploration of gas and oil fields.  Seismic exploration involves working with large volumes of information.  Data is processed by the batch method.  The company simultaneously uses up to 60-odd interrupted machines: a total of up to 2000 vCPU and 4000 GB RAM. <br><br><h3>  Hadoop Projects </h3><br>  Hadoop is used to design and execute distributed programs running on clusters of hundreds and thousands of low-cost nodes.  The mechanisms of file replication and automatic restart of tasks performed on failed nodes provided in Hadoop ensure the stability of the distributed system to the failures of individual machines.  That is why, where Hadoop is applied, at least some of the nodes can be easily deployed on interrupted virtual machines.  In case of their early shutdown, the tasks will be sent to other nodes. <br><br><h3>  Fail safety of web services </h3><br>  Continuous availability of a web service can be achieved using a cluster.  A cluster consists of two or more servers.  One of its tasks in the application to web services is to ensure stable operation at the time of peak loads.  Typical examples are online shopping sites or sports sites where traffic growth is tied to specific dates.  For stores, these can be traditional holidays or discount periods, and for sports-related websites, there are days of events when there are broadcasts, reviews and photo reports are published.  At such times, the amount of traffic may increase significantly. <br><br>  The cluster must cope with the influx of visitors, distributing traffic to different nodes.  For a period of sharp, but briefly increasing load, fault tolerance can be provided by adding servers on interrupted virtual machines.  This option is inexpensive and copes well with its task.  It is important to observe one condition: such a cluster must necessarily be hybrid, that is, include ordinary virtual machines.  In this case, even an unlikely stop of the interrupted machines will not lead to a failure of the service. <br><br><h3>  Projects at Kubernetes </h3><br>  Kubernetes allows you to automate the deployment, scaling and management of containerized applications on a large number of nodes.  One of the main entities, which can be called the Kubernetes building block, is under (pod).  Pod provides running one or more containers on a single node.  A node for each hearth is selected and assigned by the scheduler Kubernetes.  If a separate node with a running hearth fails, the scheduler will automatically transfer it to a node that is operating normally.  Such a maintenance scheme assumes that part of the nodes can be placed on interrupted virtual machines. <br><br><h3>  Continuous Integration Testing </h3><br>  The practice of continuous integration is based on the frequent assembly and testing of the project.  This applies mainly automated testing.  Schematically, it looks like this: a test environment is created on the virtual machine, the last build of the application is unloaded into it, automated testing is performed, the test results are unloaded, the virtual machine is deleted.  As a rule, testing takes several tens of minutes, less often - several hours. <br><br>  Traditionally weak points of continuous integration are considered to be the significant costs of supporting the integration process itself and the high need for computing resources.  From this point of view and taking into account the timeframe of automated tests, interrupted virtual machines look more than a suitable option for continuous integration.  They are much cheaper, and the probability of stopping the machine directly at the time of testing is vanishingly small.  Moreover, even if the car is still stopped, the damage from the point of view of business will be minimal. <br><br><h3>  Use in conjunction with other services Yandeks.Oblaka </h3><br>  The <a href="https://cloud.yandex.ru/services/instance-groups%3Futm_source%3Dhabr%26utm_content%3Dpost250619">Yandex Instance Groups service</a> allows you to automatically monitor the status of a whole group of interrupted virtual machines.  It can independently create virtual machines with specified characteristics, maintain the required number of machines in a group, and restart interrupted instances if they stop.  It does not matter whether the forced stop occurred or 24 hours have passed since the launch.  Only one thing is important: a restart will occur if there are available resources.  Yandex Instance Groups makes working with interrupted virtual machines more convenient, but it cannot guarantee that there will necessarily be free capacity in a specific availability zone. <br><br><h2>  Economic indicators </h2><br>  As we mentioned, interruptible virtual machines can reduce the cost of using computational resources.  Inside Yandex, we started working on the implementation of a similar function a few years ago.  To divide computational tasks into guaranteedly executed and interrupted ones, considerable investments were required.  But it was not for nothing: as a result, we increased the level of useful utilization of the server infrastructure from 30-40% to 70-80%. <br><br><img src="https://habrastorage.org/webt/t5/co/jm/t5cojmli_xdhso9kjwoqbwciksk.png"><br><br>  Now similar features are available to all users of Yandex. Cloud by pressing a single button.  A simple example: if you translate half of used virtual machines with one hundred percent kernel load into interrupted format, you can save up to 35-40% of the budget. <br><br>  At reduced cost, available CPU and RAM resources.  Disk space and IP addresses are charged at regular rates.  This is what a simple calculation for the Cascade Lake platform shows. <br><br><img src="https://habrastorage.org/webt/2z/u2/vh/2zu2vhioohfo6zfv77cl1a3lweq.png"><br><br>  If you wish, you can compare the cost of using virtual machines in different modes using a <a href="https://cloud.yandex.ru/prices%3Futm_source%3Dhabr%26utm_content%3Dpost250619">calculator</a> . <br><br>  Hopefully, we were able to bring some clarity and give some useful examples in which cases interrupted virtual machines can be used to reduce the cost of computing resources without losing the quality of task execution. <br><br><h3>  Other publications about Cloud on Habr√© </h3><br><ul><li>  <a href="https://habr.com/ru/company/yandex/blog/455642/">Distributed Message Queuing Service Architecture</a> </li><li>  <a href="https://habr.com/ru/company/yandex/blog/448588/">Network Load Balancer Architecture</a> </li><li>  <a href="https://habr.com/ru/company/yandex/blog/437816/">MPLS is everywhere.</a>  <a href="https://habr.com/ru/company/yandex/blog/437816/">How is the network infrastructure of Yandex.Oblaka</a> </li><li>  <a href="https://habr.com/ru/company/yandex/blog/433814/">How to scale databases without downtime.</a>  <a href="https://habr.com/ru/company/yandex/blog/433814/">Three hosts example</a> </li><li>  <a href="https://habr.com/ru/company/yandex/blog/432042/">Yandex opens the Cloud.</a>  <a href="https://habr.com/ru/company/yandex/blog/432042/">New Platform Architecture</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/457538/">https://habr.com/ru/post/457538/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../457522/index.html">Raise your mailing service or use ready-made solutions? What I learned for 5 years of work in UniSender</a></li>
<li><a href="../457524/index.html">Depth cameras - silent revolution (when robots see) Part 1</a></li>
<li><a href="../457526/index.html">Technical media as a bazaar</a></li>
<li><a href="../45753/index.html">DARPA Binoculars beats the diffraction limit</a></li>
<li><a href="../457534/index.html">Certified versions - a rake that we choose</a></li>
<li><a href="../457540/index.html">Intel Optane DC Persistent Memory, a year later</a></li>
<li><a href="../457542/index.html">Breaking and protection of disk encryption LUKS</a></li>
<li><a href="../457546/index.html">Demo Day: why is this all and how to make it UPD + Broadcast</a></li>
<li><a href="../457548/index.html">Generation of multi-phase PWM signal on TMS320F28027</a></li>
<li><a href="../457550/index.html">What does the digital industry need to be protected from</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>