<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Who works here or how to quickly find out information about callback for Drupal‚Äôs menu</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi Habrayuzer! 

 I am a web developer, I program in PHP. My main focus is the development of sites using CMS / CMF Drupal. I work in a small IT organ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Who works here or how to quickly find out information about callback for Drupal‚Äôs menu</h1><div class="post__text post__text-html js-mediator-article">  Hi Habrayuzer! <br><br>  I am a web developer, I program in PHP.  My main focus is the development of sites using CMS / CMF Drupal.  I work in a small IT organization, there are all sorts of projects (large, small, new, arriving at the end, etc.).  Recently (in my case, this is already a year) I have come across such projects on which some have worked, then others, and still others ... And basically, on such projects, the customer asks, as a rule, to fix something on trivia (there is an element in the form to insert, there - an additional class is needed, etc.) But since large projects sometimes happen such that even it‚Äôs not always possible to determine ‚Äúwhat is working here?  which module?  Since 2 years ago I learned about drush, it is very convenient, useful, but the most important thing is not to waste time rendering pages (it takes a lot to build a page).  And then I realized that it would be good to somehow find out such petty information through the console, it turned out pretty quickly and conveniently, as it seems to me. <br><a name="habracut"></a><br>  Most projects based on some kind of ready-made modular database (like Drupal) always have their own modules written exclusively for the goals of a specific project.  Well, it is worthwhile to use one of them in our case for integration with drush.  Let the module be called cm.  Drupal 6 is used. Next, I provide the code from the cm.drush.inc file. <br><br>  Standard hooks to describe the functionality of drush commands: <br><pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Implementation of hook_drush_help(). */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cm_drush_help</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($section)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> ($section) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'drush:browse-url'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dt(<span class="hljs-string"><span class="hljs-string">'Show URL\'s info'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">'drush:browse-theme'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dt(<span class="hljs-string"><span class="hljs-string">'Show theme function info'</span></span>); } } <span class="hljs-comment"><span class="hljs-comment">/** * Implements hook_drush_command(). */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cm_drush_command</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $items = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); $items[<span class="hljs-string"><span class="hljs-string">'browse-url'</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'description'</span></span> =&gt; dt(<span class="hljs-string"><span class="hljs-string">'Show URL\'s info.'</span></span>), <span class="hljs-string"><span class="hljs-string">'arguments'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'url'</span></span> =&gt; dt(<span class="hljs-string"><span class="hljs-string">'URL from browser'</span></span>), ), <span class="hljs-string"><span class="hljs-string">'aliases'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'burl'</span></span>), ); $items[<span class="hljs-string"><span class="hljs-string">'browse-theme'</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'description'</span></span> =&gt; dt(<span class="hljs-string"><span class="hljs-string">'Show theme function info.'</span></span>), <span class="hljs-string"><span class="hljs-string">'arguments'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'theme_item'</span></span> =&gt; dt(<span class="hljs-string"><span class="hljs-string">'theme function'</span></span>), ), <span class="hljs-string"><span class="hljs-string">'aliases'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'btheme'</span></span>), ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $items; }</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Now directly by the teams </h4><br><h5>  browse-url (burl) </h5><br>  displays information about the callback that was passed to this command <br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drush_cm_browse_url</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($url)</span></span></span><span class="hljs-function"> </span></span>{ $url = drupal_get_normal_path($url); drush_print(dt(<span class="hljs-string"><span class="hljs-string">'Original path is: "!path"'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'!path'</span></span> =&gt; $url))); $router_item = menu_get_item($url); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($router_item[<span class="hljs-string"><span class="hljs-string">'file'</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span>($router_item[<span class="hljs-string"><span class="hljs-string">'file'</span></span>]); } $data = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); $data[<span class="hljs-string"><span class="hljs-string">'path'</span></span>] = $router_item[<span class="hljs-string"><span class="hljs-string">'path'</span></span>]; $data[<span class="hljs-string"><span class="hljs-string">'access_callback'</span></span>] = $router_item[<span class="hljs-string"><span class="hljs-string">'access_callback'</span></span>]; $data[<span class="hljs-string"><span class="hljs-string">'access_arguments'</span></span>] = implode(<span class="hljs-string"><span class="hljs-string">", "</span></span>, unserialize($router_item[<span class="hljs-string"><span class="hljs-string">'access_arguments'</span></span>])); $data[<span class="hljs-string"><span class="hljs-string">'page_callback'</span></span>] = $router_item[<span class="hljs-string"><span class="hljs-string">'page_callback'</span></span>]; $data[<span class="hljs-string"><span class="hljs-string">'page_arguments'</span></span>] = implode(<span class="hljs-string"><span class="hljs-string">", "</span></span>, unserialize($router_item[<span class="hljs-string"><span class="hljs-string">'page_arguments'</span></span>])); $data[<span class="hljs-string"><span class="hljs-string">'tab_root'</span></span>] = $router_item[<span class="hljs-string"><span class="hljs-string">'tab_root'</span></span>]; $data[<span class="hljs-string"><span class="hljs-string">'title'</span></span>] = $router_item[<span class="hljs-string"><span class="hljs-string">'title'</span></span>]; $data[<span class="hljs-string"><span class="hljs-string">'title_callback'</span></span>] = $router_item[<span class="hljs-string"><span class="hljs-string">'title_callback'</span></span>]; drush_print(_cm_getting_function_info($router_item[<span class="hljs-string"><span class="hljs-string">'page_callback'</span></span>])); drush_print_table(drush_key_value_to_array_table($data)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_cm_getting_function_info</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($function_name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">include_once</span></span> <span class="hljs-string"><span class="hljs-string">'./includes/install.inc'</span></span>; drupal_load_updates(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (strpos($function_name, <span class="hljs-string"><span class="hljs-string">'::'</span></span>) === <span class="hljs-keyword"><span class="hljs-keyword">FALSE</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!function_exists($function_name)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> drush_set_error(dt(<span class="hljs-string"><span class="hljs-string">'Function not found'</span></span>)); } $reflect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ReflectionFunction($function_name); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">list</span></span>($class, $method) = explode(<span class="hljs-string"><span class="hljs-string">'::'</span></span>, $function_name); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!method_exists($class, $method)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> drush_set_error(dt(<span class="hljs-string"><span class="hljs-string">'Method not found'</span></span>)); } $reflect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ReflectionMethod($class, $method); } $func_info = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'!file'</span></span> =&gt; $reflect-&gt;getFileName(), <span class="hljs-string"><span class="hljs-string">'!startline'</span></span> =&gt; $reflect-&gt;getStartLine(), <span class="hljs-string"><span class="hljs-string">'!endline'</span></span> =&gt; $reflect-&gt;getEndLine()); <span class="hljs-comment"><span class="hljs-comment">//drush_print_pipe(dt("!file -line !startline", $func_info)); return dt("Execute in : !file, lines !startline-!endline", $func_info); }</span></span></code> </pre><br>  The result of the work of the team is quite simpotichny <br><pre> <code class="bash hljs">$ drush burl admin Original path is: <span class="hljs-string"><span class="hljs-string">"admin"</span></span> Execute <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> : /var/www/d6/modules/system/system.admin.inc, lines 11-59 path : admin access_callback : user_access access_arguments : access administration pages page_callback : system_main_admin_page page_arguments : tab_root : admin title : Administer title_callback : t</code> </pre><br>  we see the original path (this is in case if suddenly the system of aliases has already tried), in which file, which lines and the menu description itself.  Pretty comfortable, isn't it?  but the truth is, there are such callbacks and forms like here for example <br><pre> <code class="bash hljs">drush burl admin/settings/file-system Original path is: <span class="hljs-string"><span class="hljs-string">"admin/settings/file-system"</span></span> Execute <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> : /var/www/d6/includes/form.inc, lines 70-149 path : admin/settings/file-system access_callback : user_access access_arguments : administer site configuration page_callback : drupal_get_form page_arguments : system_file_system_settings tab_root : admin/settings/file-system title : File system title_callback : t</code> </pre><br>  In this case, the script will be useful at least from the point of view that shows at least the name of the function for generating the form. <br><br>  There is another command in the description of the hooks. <br><h5>  browse-theme (btheme) </h5><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drush_cm_browse_theme</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($theme_item)</span></span></span><span class="hljs-function"> </span></span>{ init_theme(); $hooks = theme_get_registry(); var_dump($hooks[$theme_item]); }</code> </pre><br>  It shows information about the theme function, but the truth here is to make a reservation that it is made in draft form, so to speak, as is. <br><pre> <code class="bash hljs">$ drush btheme item_list array(7) { [<span class="hljs-string"><span class="hljs-string">"arguments"</span></span>]=&gt; array(4) { [<span class="hljs-string"><span class="hljs-string">"items"</span></span>]=&gt; array(0) { } [<span class="hljs-string"><span class="hljs-string">"title"</span></span>]=&gt; NULL [<span class="hljs-string"><span class="hljs-string">"type"</span></span>]=&gt; string(2) <span class="hljs-string"><span class="hljs-string">"ul"</span></span> [<span class="hljs-string"><span class="hljs-string">"attributes"</span></span>]=&gt; NULL } [<span class="hljs-string"><span class="hljs-string">"type"</span></span>]=&gt; string(6) <span class="hljs-string"><span class="hljs-string">"module"</span></span> [<span class="hljs-string"><span class="hljs-string">"theme path"</span></span>]=&gt; string(14) <span class="hljs-string"><span class="hljs-string">"modules/system"</span></span> [<span class="hljs-string"><span class="hljs-string">"function"</span></span>]=&gt; string(15) <span class="hljs-string"><span class="hljs-string">"theme_item_list"</span></span> [<span class="hljs-string"><span class="hljs-string">"include files"</span></span>]=&gt; array(0) { } [<span class="hljs-string"><span class="hljs-string">"theme paths"</span></span>]=&gt; array(1) { [0]=&gt; string(14) <span class="hljs-string"><span class="hljs-string">"modules/system"</span></span> } [<span class="hljs-string"><span class="hljs-string">"preprocess functions"</span></span>]=&gt; array(1) { [0]=&gt; string(19) <span class="hljs-string"><span class="hljs-string">"template_preprocess"</span></span> } }</code> </pre><br>  This is an example of displaying information about the theme function item_ <br><hr><br>  In order to adapt all this to Drupal 7, it does not take much time (and maybe it will not be necessary at all, I did not check to be honest), I just came to finish these projects for me on the 6th version, so I built it for this version. </div><p>Source: <a href="https://habr.com/ru/post/145180/">https://habr.com/ru/post/145180/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../145174/index.html">Ideas about the self-limiting protection mechanism in Windows</a></li>
<li><a href="../145175/index.html">Atomic force microscopy</a></li>
<li><a href="../145176/index.html">DroidParts - library for Android 8-in-1</a></li>
<li><a href="../145177/index.html">Comparative performance testing of OpenOffice and LibreOffice</a></li>
<li><a href="../145178/index.html">Effective use of WebAPI: self hosting REST services</a></li>
<li><a href="../145181/index.html">Pay mobile tax?</a></li>
<li><a href="../145183/index.html">Upgrade to Windows 8 inexpensively. Opening of the Russian portal</a></li>
<li><a href="../145184/index.html">Electronic thermometer with web interface based on UniPing RS-485</a></li>
<li><a href="../145185/index.html">How to withdraw Paypal in Russia? How to open a virtual account in the US?</a></li>
<li><a href="../145186/index.html">Podcast "Notes on Qt" s01e05</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>