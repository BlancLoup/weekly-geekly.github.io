<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Reactjs gamma generator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 

 Not so long ago a javascript library for building user interfaces from facebook - Reactjs appeared on the Internet. This library is ideal fo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Reactjs gamma generator</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br><br>  Not so long ago a javascript library for building user interfaces from facebook - <a href="http://facebook.github.io/react/">Reactjs</a> appeared on the Internet.  This library is ideal for creating simple and complex javascript applications.  Allows you to organize your client-side in the form of independent components.  It takes care of modifying the DOM structure of the tree.  And it does it very efficiently and reasonably. <br><br>  In general, as a result of a small acquaintance with reactjs, such an application appeared - <a href="http://alexmost.github.io/fretboard/">demo</a> .  The purpose of this post is to share impressions of working with reactjs + gruntjs + browserify. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Below will be stated: <br><br><ul><li>  The main points of creating the application and personal impressions (symbiosis of reactjs + browserify + gruntjs + coffeescript). </li><li>  The server prerenderg reactjs components for static pages. </li><li>  Approach to building reactjs applications using gruntjs and gh-pages deploy with one command. </li></ul><br><br>  Those who are interested in asking under the cat ... <br><a name="habracut"></a><br><br><h5>  The idea of ‚Äã‚Äãthe application </h5><br>  I will not prevaricate, the idea of ‚Äã‚Äãthe online gamma generator is not new, and I drew my inspiration from this <a href="http://www.scalerator.com/">resource</a> by adding a few buns from myself.  Gammas, first of all, are useful for people who are trying to master improvisation.  And as useful as an exercise to improve the technique of the game.  Each gamma, in fact, consists of certain notes, which are calculated by a specific formula.  It is a pleasure for me, as a guitar lover, to guess the key and try to select a solo to my favorite music.  And this application is very good at helping. <br><br><h5>  What was implemented </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/7f4/55f/b8c/7f455fb8c31f80ee37a90c4327ca58ae.png"><br><ol><li>  The choice of tonality. </li><li>  Gamma selection (minor, major, blues, pentatonic). </li><li>  The choice of guitar pitch. </li><li>  The alternate reproduction of notes for the selected part of the neck of the guitar. </li><li>  Change the direction of music playback (top down / bottom up). </li><li>  Possibility of looping (for learning). </li><li>  Automatically change the direction of music playback. </li></ol><br><br><h5>  Organization of the application </h5><br>  For good karma, and I just love to tinker with it - all javascript was designed as commonjs modules, glued into 1 file and minified, and reactjs components are prerendered during the build and inserted into the html pages. <br>  This effect was achieved with the help of such tools: <br><ul><li>  <a href="http://gruntjs.com/">gruntjs</a> - build and deploy projects </li><li>  <a href="http://browserify.org/">browserify</a> - for running commonjs modules in a browser </li><li>  <a href="https://github.com/AlexMost/grunt-react-render">grunt-react-prerender</a> - pre-rendering of components on the server </li></ul><br>  The commonjs format is very convenient and allows you to use the same javascript code on both the server and the client. <br><br><h5>  Server Pre-Rendering </h5><br>  One of the most attractive features in reactjs for me is the possibility of server-side pre-rendering of components.  After all, it is great to be able to initialize the initial state of your application and draw the components before they get to the browser.  The beauty of reacjs is that he himself understands when the component has already been drawn, and does not try to do it again.  If you look at the code for a page from <a href="http://alexmost.github.io/fretboard/">demo</a> , you can see that the main component of the page has already been rendered before the content is sent to the browser.  The main requirement for server rendering is the ability to make the require component on the server.  Since the pre-rendering procedure is necessary only when deploying - I decided to make a separate grunt plugin for it, which will process html files before loading it on gh-pages - <a href="https://github.com/AlexMost/grunt-react-render">grunt-react-render</a> . <br>  The plugin is quite simple and operates according to this algorithm: <br><br><ol><li>  We read the file for processing. </li><li>  Parsing the html structure, we find tags with the data-rcomp attribute. </li><li>  Read the relative path to the component from the data-rcomp attribute. </li><li>  Make the require of the component and call the method react.renderComponentToString (). </li><li>  Insert inside the tag with the data-rcomp attribute. </li><li>  Save the file. </li></ol><br><br>  Here is the html section of the main page code that is processed by this plugin: <br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Scales generator<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-rcomp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./lib-js/pages/scales_page_component"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  This is what the grunt plugin configuration looks like: <br><br><pre> <code class="coffeescript hljs"> react_render: index: options: src: <span class="hljs-string"><span class="hljs-string">'.dist/index.html'</span></span></code> </pre><br><br><h5>  Impressions of Reactjs </h5><br>  Reactjs pushes to form the application logic as separate configurable components that can be reused as much as possible.  The philosophy of reactjs says that components must keep state to a minimum, since the stored state in different places is a source of magic and side effects.  Therefore, it is better to save and change the state in the top-level components and pass it to the internal components via properties (props). <br><br>  In the process of creating an application, I faced the fact that there are few ready-made solutions for simple components on the Internet.  At first, I was very embarrassed and I spent some time searching for ready-made solutions, for example for the same drop-down lists.  I tried to integrate them into my project and adapt the layout, but then I tried to implement the functionality of such a drop-down list from scratch: <br><img src="https://habrastorage.org/getpro/habr/post_images/12b/388/f3c/12b388f3c4eb7d15e40709b0d5f0c3e9.png" alt="image"><br><br>  And I was surprised how simple it is with reactjs.  In fact, the component becomes very simple when the whole rendering takes on reactjs, and you just have to ask how to draw the component in different states and switch it correctly. <br><br><div class="spoiler">  <b class="spoiler_title">drop-down code</b> <div class="spoiler_text"><pre> <code class="ruby hljs">React = <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> {ul, li, span, div, a} = React.DOM SimpleDropdown = React.createClass <span class="hljs-symbol"><span class="hljs-symbol">displayName:</span></span> <span class="hljs-string"><span class="hljs-string">"SimpleDropdown"</span></span> <span class="hljs-symbol"><span class="hljs-symbol">getDefaultProps:</span></span> -&gt; <span class="hljs-symbol"><span class="hljs-symbol">onChange:</span></span> -&gt; <span class="hljs-symbol"><span class="hljs-symbol">getInitialState:</span></span> -&gt; <span class="hljs-symbol"><span class="hljs-symbol">isOpen:</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-symbol"><span class="hljs-symbol">value:</span></span> @props.value <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-symbol"><span class="hljs-symbol">toggle:</span></span> -&gt; @setState {<span class="hljs-symbol"><span class="hljs-symbol">isOpen:</span></span> !@state.isOpen} <span class="hljs-symbol"><span class="hljs-symbol">itemClick:</span></span> (ev) -&gt; ev.preventDefault() value = (ev.target.getAttribute <span class="hljs-string"><span class="hljs-string">"value"</span></span>) @setState {value, <span class="hljs-symbol"><span class="hljs-symbol">isOpen:</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>} @props.onChange value <span class="hljs-symbol"><span class="hljs-symbol">render:</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> = @ options = @props.options.map ([value, text]) -&gt; (li {<span class="hljs-symbol"><span class="hljs-symbol">key:</span></span> <span class="hljs-string"><span class="hljs-string">"opt_</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">#{value}</span></span></span><span class="hljs-string">"</span></span>}, (a {value, <span class="hljs-symbol"><span class="hljs-symbol">href:</span></span> <span class="hljs-string"><span class="hljs-string">"#"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">onClick:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.itemClick}, text)) openCls = <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> @state.isOpen <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-string"><span class="hljs-string">"open"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> currentOption = (@props.options.filter ([value, text]) =&gt; value.toString() is @state.value.toString())?[<span class="hljs-number"><span class="hljs-number">0</span></span>] (div <span class="hljs-symbol"><span class="hljs-symbol">className:</span></span> <span class="hljs-string"><span class="hljs-string">"btn-group </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">#{openCls}</span></span></span><span class="hljs-string">"</span></span> (button <span class="hljs-symbol"><span class="hljs-symbol">className:</span></span> <span class="hljs-string"><span class="hljs-string">"btn btn-default"</span></span> <span class="hljs-symbol"><span class="hljs-symbol">onClick:</span></span> @toggle (span {<span class="hljs-symbol"><span class="hljs-symbol">className:</span></span> <span class="hljs-string"><span class="hljs-string">"glyphicon"</span></span>}, <span class="hljs-string"><span class="hljs-string">""</span></span>) currentOption?[<span class="hljs-number"><span class="hljs-number">1</span></span>] (span {<span class="hljs-symbol"><span class="hljs-symbol">className:</span></span> <span class="hljs-string"><span class="hljs-string">"caret"</span></span>}, <span class="hljs-string"><span class="hljs-string">""</span></span>)) (ul <span class="hljs-symbol"><span class="hljs-symbol">className:</span></span> <span class="hljs-string"><span class="hljs-string">"dropdown-menu"</span></span> <span class="hljs-symbol"><span class="hljs-symbol">ref:</span></span> <span class="hljs-string"><span class="hljs-string">"select"</span></span> options))</code> </pre><br></div></div><br>  Coffeescript was very convenient for describing the html structure of components.  Especially useful is its restructuring assignment. <br><br><pre> <code class="ruby hljs">{div, ul, span, li} = React.DOM (div {<span class="hljs-symbol"><span class="hljs-symbol">className:</span></span> <span class="hljs-string"><span class="hljs-string">"div"</span></span>} (span {<span class="hljs-symbol"><span class="hljs-symbol">className:</span></span> <span class="hljs-string"><span class="hljs-string">"span"</span></span>, <span class="hljs-string"><span class="hljs-string">"span Text"</span></span>) (ul (li <span class="hljs-string"><span class="hljs-string">"option 1"</span></span>) (li <span class="hljs-string"><span class="hljs-string">"option 2"</span></span>) )</code> </pre><br><br>  As for me, it is enough to not use <a href="http://facebook.github.io/react/docs/jsx-in-depth.html">jsx</a> .  I also had to tinker with the bootstrap buttons and the draggable behavior of the components. <br><br><h5>  Business logic </h5><br>  Since the application was created not only to master the reactor, but also to simplify your life for others in studying the scales on the guitar - I tried to make all the logic as simple as possible so that, if possible, someone could add a different scale or scale without much effort. guitars.  So, for example, the description of gammas in the code looks like: <br><pre> <code class="coffeescript hljs">SCALES = Minor: desc: <span class="hljs-string"><span class="hljs-string">"Minor scale"</span></span> size: [STEP, hSTEP, STEP, STEP, hSTEP, STEP, STEP] get_notes: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Tonica)</span></span></span><span class="hljs-function"> -&gt;</span></span> generate_scale Tonica, SCALES.Minor Major: desc: <span class="hljs-string"><span class="hljs-string">"Major scale"</span></span> size: [STEP, STEP, hSTEP, STEP, STEP, STEP, hSTEP] get_notes: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Tonica)</span></span></span><span class="hljs-function"> -&gt;</span></span> generate_scale Tonica, SCALES.Major ...</code> </pre><br>  Each gamma has its own formula (size), a function for generating notes and a description.  Having shown this project to one friend, he, having a deeper knowledge of music, easily added several other scales. <br><br>  The data for guitar lines is just as simple: <br><pre> <code class="coffeescript hljs">TUNINGS = <span class="hljs-string"><span class="hljs-string">"Standart"</span></span>: name: <span class="hljs-string"><span class="hljs-string">"Standart E"</span></span> notes: [E, B, G, D, A, E] offset: [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-string"><span class="hljs-string">"DropD"</span></span>: name: <span class="hljs-string"><span class="hljs-string">"Dropped D"</span></span> notes: [E, B, G, D, A, D] offset: [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-2</span></span>] ...</code> </pre><br><br>  The sequential playback of sounds is implemented using the <a href="http://goldfirestudios.com/blog/104/howler.js-Modern-Web-Audio-Javascript-Library">howler.js</a> library. <br>  If someone from those who read up to this place has a desire to add and improve something in the project, I will be extremely happy. <br><br><h5>  Build and warm 1st team </h5><br>  Many do not bother at all on the assembly of the project and the organization of the code, maybe this is correct.  Personally, I get pleasure from the automation process, so I was a little confused over this and organized the assembly and the project deployment on gruntjs.  There are 3 main commands: <br><ul><li>  grunt build (coffeescript compilation, browser modules for commonjs, js and css gluing into 1 file) </li><li>  grunt deploy (build + minify js and css, copy to the directory for deployment, pre-rendering the reactant of components) </li><li>  grunt deploy-gh (deploy + deploy on github pages) </li></ul><br>  Gruntfile can tell more details about the build project in the <a href="https://github.com/AlexMost/fretboard">repository</a> . <br><br><h5>  findings </h5><br>  In general, working with reactjs left a positive impression, in the future I want to try it along with some kind of FRP library (RxJs or bacon.js).  Also, I plan to add another useful functionality to this project. <br>  Thank you for attention!  Any criticism, suggestions and feedback are welcome. <br><br>  Source Code - <a href="https://github.com/AlexMost/fretboard">github</a> </div><p>Source: <a href="https://habr.com/ru/post/220845/">https://habr.com/ru/post/220845/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../220835/index.html">As I lagged Navigation Drawer fought</a></li>
<li><a href="../220837/index.html">Basic animation with iTween</a></li>
<li><a href="../220839/index.html">What is Excel Mashup, and to whom it may be useful?</a></li>
<li><a href="../220841/index.html">N2O: Erlang WebSockets Web Framework</a></li>
<li><a href="../220843/index.html">Commercial nanotechnology</a></li>
<li><a href="../220847/index.html">8 Two Wheel MODX Revolution Tips</a></li>
<li><a href="../220849/index.html">Sample pen on supercomputer Lomonosov</a></li>
<li><a href="../220851/index.html">(Self) processor identification. Part two. Hairy CPUID</a></li>
<li><a href="../220853/index.html">Friday's announcement #FailOverConf. And buns to participants</a></li>
<li><a href="../220855/index.html">Mother's wisdom to guard your marketing</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>