<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Wardriving in Mac OS X</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The de facto standard in wardriving is usually considered the Linux system (modified drivers, Kismet in conjunction with aircrack-ng ). But few people...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Wardriving in Mac OS X</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage1/a3091181/ba061f68/da14a804/7bd74a15.jpg"><br><br>  The de facto standard in wardriving is usually considered the Linux system (modified drivers, <a href="http://www.kismetwireless.net/">Kismet</a> in conjunction with <a href="http://www.aircrack-ng.org/">aircrack-ng</a> ).  But few people know that the poppy has powerful tools for <s>hacking</s> security audits of wireless networks, which are almost as good as, and in many respects, superior to, Linux analogs in functionality. <br>  <font color="red"><b>UPD: The tools described in the article are now obsolete.</b></font>  <font color="red"><b>Linux recommended</b></font> <br><br><a name="habracut"></a><br>  To familiarize yourself with the general concepts of wardriving, it is recommended to read <a href="http://habrahabr.ru/blogs/infosecurity/50174/">this article.</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://trac.kismac-ng.org/">Kismac</a> - Powerful all-in-one program.  A big advantage over Linux is that the wi-fi card drivers are integrated directly into the program and there is no need to install additional modules.  All network scanning, collecting and analyzing traffic (in Linux, the commands airdump, airmon, airplay) are performed in one place from the graphical interface, which greatly simplifies the process. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/645/f3a/e5c/645f3ae5c58a4ff381fe9cc00f9e6f73.png"></div><br>  Program features: <br><ul><li>  passive scanner / sniffer </li><li>  packet injection </li><li>  <nobr>dumping in standard PCAP format, understandable for all packet analyzers (for example,</nobr> <a href="http://www.wireshark.org/">Wireshrak</a> ) </li><li>  with GPS module can mark found networks on the map </li><li>  sound indication of signal strength (as a metal detector) </li><li>  dump from kismet drone server </li></ul><br>  Kismac also has tools for decoding WEP / WPA algorithms, but the program's authors say that they have not been developed for a long time and recommend using the latest version of aircrack-ng, which can be installed from source or using <a href="http://www.finkproject.org/">the port fink system</a> . <br><br><h4>  Choice of equipment </h4><br>  The Airport Extreme card built into the MacBook is not suitable for wardding.  It cannot inject packets, and because of the low sensitivity of the receiver, it is necessary to collect traffic for analysis in close proximity to the source of the signal.  The only thing for which it is suitable is the initial inspection of networks: you can find out the type of encryption used, the presence of clients at points, etc. <br><br>  For more in-depth study, a map is needed that supports packet injection (see the <a href="http://trac.kismac-ng.org/wiki/HardwareList">list of devices</a> ).  The best choice would be the <a href="http://www.google.com/search%3Fhl%3Dru%26q%3Dalfa%2Bawus036h%26lr%3D%26aq%3D0%26aqi%3Dg10%26aql%3D%26oq%3DAlfa%2Bawu%26gs_rfai%3D">Alfa AWUS036H card</a> on the RTL8187L chipset.  It is recommended by the developers of kismac and aircrack-ng.  Supported by all software programs in all operating systems, it has a very sensitive receiver.  The power transmission is 500 milliwatts.  Equipped with RP-SMA plug for connecting external antennas. <br>  The Chinese make these cards under different names, for example <a href="http://www2.dealextreme.com/details.dx/sku.20646">G-SKY</a> or <a href="http://www.dealextreme.com/details.dx/sku.24128">IDU-2850UG-8G</a> or <a href="http://www.dealextreme.com/details.dx/sku.24218">Kinmax</a> . <br>  In principle, you can choose any of the supported cards, but this one has the best characteristics, it is cheap and easy to find. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/146/2c3/f54/1462c3f54cda0db3e1c78cc3b7ccf4e4.jpg"></div><br><br>  To get started, you need to select a driver for your device: <br>  <i>KisMac =&gt; Preferences ... =&gt; Driver</i> <br><br>  To get acquainted with the program and in the absence of other cards, select Airport Extreme Passive mode. <br><img src="https://habrastorage.org/getpro/habr/post_images/505/30c/39a/50530c39abd2df34cfe3cf991fc097cb.png"><br><br>  <i>Channel Hopping</i> - select all European channels 1-11. <br>  <i>Use as primary device</i> - to activate the package injection function (not possible at the Airport) <br>  <i>Dump Filter</i> - what data to write to the dump file, select "Keep everything". <br>  <i>Save Dumps At</i> - path and name of the dump file. <br><br>  Now you can start scanning.  The program will report on all found networks.  Changing numbers in the lower right corner means that the device is in Channel Hopping mode, jumping on frequencies to find networks running on all channels.  It is also necessary to keep in mind that the card jumps through the channels very quickly (the speed is adjusted when the driver is selected), so there is a possibility that some networks may not be detected.  To eliminate this, you can go through each channel separately.  When you have selected the network of interest, you must stop Channel hopping and set the channel on which the selected network is running. <br><img src="https://habrastorage.org/getpro/habr/post_images/29b/e6a/d98/29be6ad9808ea34299e82db214c0c8ef.png"><br><br>  Double-clicking on the selected network will show detailed information. <br>  On the left - technical information, on the right - a list of clients connected to a point.  Really connected clients have Last Seen value. <br><img src="https://habrastorage.org/getpro/habr/post_images/f9a/85e/038/f9a85e038d19c339011d8575eefa80d6.png"><br><br>  An important factor is the signal level. <br>  Signal - signal power <br>  AvgSignal - signal quality (useful signal considering interference) <br>  MaxSignal - the maximum recorded signal level <br><br>  For successful packet injection, the signal point and the client signal must not be lower than 40-50.  It is necessary to find the optimal position of the antenna at which the signal will be at its maximum.  Sometimes changing the position by even one centimeter can significantly affect the signal level.  You can also turn on the sound indication of the signal strength in the ‚ÄúNetwork =&gt; Monitor Signal Strenght‚Äù menu, depending on the signal level, the tone of the sound will change. <br><br><h4>  Sniffing in open networks </h4><br><br>  On networks without encryption, all traffic can be freely viewed.  To do this, simply configure the card to listen to the frequency on which the network is running (Main channel), and collect all traffic into a file.  Then the dump can be viewed with a packet analyzer. <br><br>  For example, at the next table in the cafe Vasya! * SuPeR-ViP *!  Pupkin logged in contact: <br><img src="https://habrastorage.org/getpro/habr/post_images/f8e/96f/2b3/f8e96f2b33fce0500515c8ec30762f93.png"><br>  In loaded networks, dumps are filled very quickly, and filters can be used to speed up the opening of wireshark dumps.  For example, do a sample only by protocol or IP.  You can also disable rezolv addresses. <br><br><h4>  Hacking WEP </h4><br>  The bottom line is to collect a large number of service packets containing the Initial Vector (Initial Vector), and from them to decrypt the network key.  Initialization vectors are transmitted to control the connection of the point with the client, respectively, the attack is feasible only when there are connections to the point. <br>  For the successful finding of the key, it is necessary to collect more than 70 thousand packages (in practice, 20 thousand is sufficient)  It is not possible to collect such a number, passively listening to the broadcast.  To speed up the process, there is a packet injection method to force hosts to generate a large number of IV packets.  To start the injection, you need to have a certain amount of Initial Vectors, so you can just wait or catch up with traffic by authorization flood: Network =&gt; Authentication Flood (DoS attack similarity. Be careful with this option, the access point may hang).  After that, you can start the injection: <i>Network =&gt; Reinject Packets</i> . <br><br>  If the injection attempt was successful, the number of packages we need (Unique IV's) will begin to increase dramatically. <br><br>  Let's start parallel key decryption using the program aircrack-ng. <br>  In the terminal we enter: <br><br>  <i>aircrack-ng /path/to_dump.file</i> <br><br>  If you do not specify the mac-address of the attacked access point, the program will suggest that you select from all points found in the dump.  You can specify the mac address with the -b option: <br><br>  <i>aircrack-ng -b 00: 00: 00: 00: 00: 00 /path/to_dump.file</i> <br><br><h4>  Hacking WPA / WPA2 </h4><br>  To date, the WPA algorithm is fairly reliable.  The only possibility of hacking is brute force (dictionary search). <br>  The task is to intercept the ‚Äúhandshake‚Äù (handshake) at the time of authorization of the client at the access point and the subsequent search of passwords in the dictionary.  To do this, we need to either wait for the moment when the client comes to log in or try to break the existing connections in order to provoke a reconnection: <br><br>  <i>Network =&gt; Deauthenticate</i> <br><br>  It is important to catch both sides of the handshake: Challenge and ‚ÄúResponse.  If successful, the red dot Ch / Re will turn green. <br>  It often happens that you can only catch the answer point (Challenge), and the answer is a low-power client (such as a mobile phone) fails.  In this case, you need to find the position of the antenna, which will be the maximum client signal <br><img src="https://habrastorage.org/getpro/habr/post_images/796/a5d/695/796a5d695227c8013c08627100660030.png"><br><br>  Looking through the key looks like this: <br><br>  <i>aircrack-ng -w keys.txt -b 00: 00: 00: 00: 00: 00 dump.file</i> <br><br>  where keys.txt is the path to the dictionary, 00: 00: 00: 00: 00: 00 is the mac-address of the attacked point, dump.file is the path to the file with handheld. <br><br><hr><br><br>  Having an encryption key, you can listen to all traffic passing through the network.  To do this, use the decryptor dump: <br><br>  For WEP encryption, the key is specified with the -w option: <br><br>  <i>airdecap-ng -w 12345678 /path/to/wep.dump.file</i> <br><br>  for WPA / WPA2 with the -e netname option -p network_key: <br><br>  <i>airdecap-ng -e 'Cool-WiFi' -p 12345678 /path/to/wpa.dump.file</i> <br><br>  As a result, a decrypted dump file will be created that can already be viewed by the packet analyzer. </div><p>Source: <a href="https://habr.com/ru/post/90307/">https://habr.com/ru/post/90307/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../90300/index.html">Solar powered Solar Impulse aircraft successfully completed its first flight</a></li>
<li><a href="../90301/index.html">Internship at Google. One more glance</a></li>
<li><a href="../90303/index.html">Building a pilot. The story of a startup - part II</a></li>
<li><a href="../90305/index.html">New version of Rpod.ru</a></li>
<li><a href="../90306/index.html">Advertising for clients Makhosta</a></li>
<li><a href="../90308/index.html">Apple iPad Review</a></li>
<li><a href="../90309/index.html">33th issue of Russian Full Circle Magazine</a></li>
<li><a href="../90310/index.html">The Future of iPad Web Apps</a></li>
<li><a href="../90311/index.html">Ericsson LX588 (DAMPS)</a></li>
<li><a href="../90312/index.html">GTA in real life</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>