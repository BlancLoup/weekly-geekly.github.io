<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>An example of using a telnet server in firefox</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Every time they say ‚Äúoh! The new chromium has become even faster, and the new opera is even more melodic, ‚Äùin response, I ask a simple question:‚Äú Do y...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>An example of using a telnet server in firefox</h1><div class="post__text post__text-html js-mediator-article">  Every time they say ‚Äúoh!  The new chromium has become even faster, and the new opera is even more melodic, ‚Äùin response, I ask a simple question:‚Äú Do you have a telnet server in your browser?  But in firefox - there is ", - after which adherents of other religions understand that propaganda is useless. <br><br>  This post will discuss how to expand and manage the fire fox from other applications through the aforementioned telnet server implemented by the <a href="http://hyperstruct.net/projects/mozlab">mozrepl</a> plugin.  As an example, I will show how to implement the function of creating a screenshot of the site with minimal effort. <br><a name="habracut"></a><br>  But first, a few additional preconditions.  First, the screenshot should be full-sized, and not cropped by viewport.  Secondly, I do not really want to write without the need for low-level languages. <br><br>  Among others, the use of khtml2png and pairs from xwd + imagemagic was considered, but the khtml3 renderer was godlessly buggy, and the second option was not as trivial as we would like. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If everything revolves around the browser, then it is necessary either to add code to the browser, or to influence the browser from an external program.  In the process of finding a solution, a wonderful <a href="http://www.screengrab.org/">Screen grab</a> plugin was found <a href="http://www.screengrab.org/">!</a>  , who was shooting the necessary options for screenshots and it only remained to learn how to manage this plugin.  Remembering that in the case of OpenOffice, this functionality can be obtained using the ability to test the user interface, I went in search of test plugins.  The search was a success, and after viewing the inspiring screencast about managing firefox from emacs, a draft of the code was written quite quickly. <br><br>  The idea is simple to impossible - on the fly, the function of opening a screengrab file is patched, and then one of the functions of the plugin is called and, accordingly, the screenshot is saved directly to the file without any questions to the user. <br><br>  Later the code turned into this: <br><blockquote><code><a href="http://code.activestate.com/recipes/576366/"></a> <a href="http://en.wikipedia.org/wiki/Fixed_point_combinator"></a> <font color="#008b8b">var</font> ScreenshotSaver = <font color="#008b8b">{</font> &lt;br&gt; <br> lambda: <font color="#a52a2a"><b>null</b></font> , <font color="#406090">// EventListener</font> &lt;br&gt; <br> mixin: <font color="#a52a2a"><b>null</b></font> , <font color="#406090">// our file opener</font> &lt;br&gt; <br> pure: <font color="#a52a2a"><b>null</b></font> , <font color="#406090">// screengrab's file opener</font> &lt;br&gt; <br> answer: 42, <font color="#406090">// to check `this' validity</font> &lt;br&gt; <br> <font color="#008b8b">}</font> ;&lt;br&gt; <br> &lt;br&gt; <br> ScreenshotSaver.assert = <font color="#008b8b">function</font> (bool) <font color="#008b8b">{</font> &lt;br&gt; <br> <font color="#a52a2a"><b>if</b></font> (!bool) <font color="#008b8b">{</font> &lt;br&gt; <br> repl.print( <font color="#c00058">'assertion failed'</font> );&lt;br&gt; <br> repl.print( <font color="#008b8b">arguments</font> .callee.caller);&lt;br&gt; <br> <font color="#008b8b">}</font> &lt;br&gt; <br> <font color="#008b8b">}</font> ;&lt;br&gt; <br> &lt;br&gt; <br> ScreenshotSaver.save = <font color="#008b8b">function</font> (url, fpath) <font color="#008b8b">{</font> &lt;br&gt; <br> <font color="#008b8b">this</font> ._install_onload(fpath);&lt;br&gt; <br> <font color="#a52a2a"><b>window</b></font> .content. <font color="#a52a2a"><b>location</b></font> .href = url;&lt;br&gt; <br> <font color="#008b8b">}</font> ;&lt;br&gt; <br> &lt;br&gt; <br> ScreenshotSaver._install_onload = <font color="#008b8b">function</font> (fpath) <font color="#008b8b">{</font> &lt;br&gt; <br> <font color="#008b8b">this</font> .assert( <font color="#008b8b">this</font> .lambda === <font color="#a52a2a"><b>null</b></font> );&lt;br&gt; <br> &lt;br&gt; <br> <font color="#406090">// Looks like hack, but I need valid `this' in _dump_screenshot</font> &lt;br&gt; <br> <font color="#406090">// I need this.lambda to be precise.</font> &lt;br&gt; <br> <font color="#008b8b">this</font> .lambda = <font color="#008b8b">function</font> (ev) <font color="#008b8b">{</font> &lt;br&gt; <br> repl.print( <font color="#c00058">'ScreenshotSaver: some `load</font> <font color="#6a5acd">\'</font> <font color="#c00058">event catched...'</font> );&lt;br&gt; <br> <font color="#a52a2a"><b>if</b></font> (!ev.target.mIsBusy)&lt;br&gt; <br> ScreenshotSaver._dump_screenshot(fpath);&lt;br&gt; <br> <font color="#008b8b">}</font> ;&lt;br&gt; <br> <font color="#a52a2a"><b>window</b></font> .getBrowser().addEventListener( <font color="#c00058">"load"</font> , <font color="#008b8b">this</font> .lambda, <font color="#c00058">false</font> );&lt;br&gt; <br> <font color="#008b8b">}</font> ;&lt;br&gt; <br> &lt;br&gt; <br> ScreenshotSaver._uninstall_onload = <font color="#008b8b">function</font> () <font color="#008b8b">{</font> &lt;br&gt; <br> <font color="#008b8b">this</font> .assert( <font color="#008b8b">this</font> .lambda !== <font color="#a52a2a"><b>null</b></font> );&lt;br&gt; <br> <font color="#a52a2a"><b>window</b></font> .getBrowser().removeEventListener( <font color="#c00058">"load"</font> , <font color="#008b8b">this</font> .lambda, <font color="#c00058">false</font> );&lt;br&gt; <br> <font color="#008b8b">this</font> .lambda = <font color="#a52a2a"><b>null</b></font> ;&lt;br&gt; <br> <font color="#008b8b">}</font> ;&lt;br&gt; <br> &lt;br&gt; <br> ScreenshotSaver._dump_screenshot = <font color="#008b8b">function</font> (fpath) <font color="#008b8b">{</font> &lt;br&gt; <br> <font color="#008b8b">this</font> .assert( <font color="#008b8b">this</font> .answer === 42);&lt;br&gt; <br> <font color="#008b8b">this</font> .assert( <font color="#008b8b">this</font> .lambda !== <font color="#a52a2a"><b>null</b></font> );&lt;br&gt; <br> &lt;br&gt; <br> repl.print( <font color="#c00058">'ScreenshotSaver._dump_screenshot starts'</font> );&lt;br&gt; <br> <font color="#406090">/* Wanna deregister handler from itself? Here are some useless links:</font> &lt;br&gt; <br> <font color="#406090">* http://code.activestate.com/recipes/576366/</font> &lt;br&gt; <br> <font color="#406090">* http://en.wikipedia.org/wiki/Fixed_point_combinator</font> &lt;br&gt; <br> <font color="#406090">* eval:"repl.print(arguments.callee)" */</font> &lt;br&gt; <br> <font color="#008b8b">this</font> ._uninstall_onload();&lt;br&gt; <br> &lt;br&gt; <br> <font color="#008b8b">this</font> ._install_screengrab_mixin(fpath);&lt;br&gt; <br> Screengrab.grabCompleteDocument();&lt;br&gt; <br> <font color="#008b8b">this</font> ._uninstall_screengrab_mixin();&lt;br&gt; <br> &lt;br&gt; <br> repl.print( <font color="#c00058">'ScreenshotSaver._dump_screenshot exits'</font> );&lt;br&gt; <br> <font color="#008b8b">}</font> ;&lt;br&gt; <br> &lt;br&gt; <br> ScreenshotSaver._install_screengrab_mixin = <font color="#008b8b">function</font> (fpath) <font color="#008b8b">{</font> &lt;br&gt; <br> <font color="#008b8b">this</font> .assert( <font color="#008b8b">this</font> .mixin === <font color="#a52a2a"><b>null</b></font> &amp;&amp; <font color="#008b8b">this</font> .pure === <font color="#a52a2a"><b>null</b></font> );&lt;br&gt; <br> &lt;br&gt; <br> <font color="#008b8b">this</font> .mixin = <font color="#008b8b">function</font> (defaultName) <font color="#008b8b">{</font> &lt;br&gt; <br> <font color="#008b8b">var</font> file = Components.classes <font color="#008b8b">[</font> <font color="#c00058">"@mozilla.org/file/local;1"</font> <font color="#008b8b">]</font> .&lt;br&gt; <br> createInstance(Components.interfaces.nsILocalFile);&lt;br&gt; <br> file.initWithPath(fpath);&lt;br&gt; <br> <font color="#a52a2a"><b>return</b></font> file;&lt;br&gt; <br> <font color="#008b8b">}</font> &lt;br&gt; <br> &lt;br&gt; <br> <font color="#008b8b">this</font> .pure = SGNsUtils.askUserForFile;&lt;br&gt; <br> SGNsUtils.askUserForFile = <font color="#008b8b">this</font> .mixin;&lt;br&gt; <br> <font color="#008b8b">}</font> ;&lt;br&gt; <br> &lt;br&gt; <br> ScreenshotSaver._uninstall_screengrab_mixin = <font color="#008b8b">function</font> () <font color="#008b8b">{</font> &lt;br&gt; <br> <font color="#008b8b">this</font> .assert(SGNsUtils.askUserForFile === <font color="#008b8b">this</font> .mixin);&lt;br&gt; <br> <font color="#008b8b">this</font> .assert( <font color="#008b8b">this</font> .mixin !== <font color="#a52a2a"><b>null</b></font> &amp;&amp; <font color="#008b8b">this</font> .pure !== <font color="#a52a2a"><b>null</b></font> );&lt;br&gt; <br> &lt;br&gt; <br> SGNsUtils.askUserForFile = <font color="#008b8b">this</font> .pure;&lt;br&gt; <br> <font color="#008b8b">this</font> .pure = <font color="#a52a2a"><b>null</b></font> ;&lt;br&gt; <br> <font color="#008b8b">this</font> .mixin = <font color="#a52a2a"><b>null</b></font> ;&lt;br&gt; <br> <font color="#008b8b">}</font> ;&lt;br&gt; <br></code> </blockquote><br>  Download the file <a href="">here</a> . <br><br>  Loading such an ‚Äúextension‚Äù on the fly is no less trivial: <br><blockquote><pre> $ firefox &amp;
 $ telnet localhost 4242 # 4242 - the port on which mozrepl is listening
 repl&gt; repl.load ('file: ///home/luser/ScreenshotSaver.js');
 repl&gt; ScreenshotSaver.save ('http://habrahabr.ru', '/tmp/habr.png');
 repl&gt; ScreenshotSaver.save ('http://linux.org.ru', '/tmp/lor.png');
</pre></blockquote><br>  After that, two corresponding screenshots appear in / tmp. <br><br>  How else can mozrepl be used?  Anyhow, from automated testing of websites and an ‚Äúinteractive console‚Äù when developing plug-ins for firefox to www-bots, which will be practically indistinguishable from people without Turing test. <br><br>  <b>UPD:</b> thanks for the karma, moved the topic to the ‚Äúfire fox‚Äù. <br><br>  From open questions remain, for example, error handling and hiding the vertical scrollbar.  At a resolution of 1024x768, the screenshot made in this way will be 1009px wide, i.e.  will be already on the width of the scrollbar - 15px. </div><p>Source: <a href="https://habr.com/ru/post/49581/">https://habr.com/ru/post/49581/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../49572/index.html">Remote OS installation</a></li>
<li><a href="../49573/index.html">Installing kde from svn to gentoo</a></li>
<li><a href="../49574/index.html">Spam, porn, Narod.ru</a></li>
<li><a href="../49576/index.html">Who wins - an elephant or a whale? Joint meeting of Moscow user groups MySQL and PostgreSQL.</a></li>
<li><a href="../49578/index.html">LiveExpert.ru - Choose an expert and consult right now</a></li>
<li><a href="../49582/index.html">We learn Java. The third cup: primitive types, and objects. Basic designs</a></li>
<li><a href="../49586/index.html">About broken windows.</a></li>
<li><a href="../49588/index.html">Correct wording</a></li>
<li><a href="../49592/index.html">Kohana vs Codeigniter, Performance Synthetics</a></li>
<li><a href="../49595/index.html">Modality beyond dialog boxes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>