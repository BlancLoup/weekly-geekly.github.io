<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ODR - On-Demand Routing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1. Introduction to ODR - On-Demand Routing 
 Before learning the ODR technology, let's recall two main methods of filling routing tables with informat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ODR - On-Demand Routing</h1><div class="post__text post__text-html js-mediator-article"><h4>  1. Introduction to ODR - On-Demand Routing </h4><br>  Before learning the ODR technology, let's recall two main methods of filling routing tables with information: <br><ul><li>  Static routing - routes are added manually by the administrator. </li><li>  Dynamic routing - the administrator configures dynamic routing protocols. </li></ul><br>  But in each of these cases there are drawbacks: <br><ul><li>  The main disadvantage of static routing is the need to reconfigure devices when changing the network structure or addresses. </li><li>  The main disadvantages of dynamic routing drawbacks are: additional load on the channels and a decrease in security. </li></ul><br>  In principle, it cannot be said that these shortcomings are significant in modern conditions.  It is unlikely that networks will often be reconfigured, modern communication channels are wide enough to transfer relatively small traffic generated by routing protocols without problems.  And even the problem of external dynamic IP addresses received from the provider can be solved by using dynamic DNS technology. <br>  But in fact there is another drawback common to both options - you need support staff at every point where the router is located.  The one who will prescribe static routes or configure a dynamic routing protocol. <br>  For such cases, Cisco has developed a proprietary protocol ODR, which in fact is not even a dynamic configuration protocol, it is an extension of another proprietary protocol - CDP.  Using the ODR protocol, routers can exchange routing information in a specific way (as a result, the amount of information transmitted is substantially less than that of other dynamic routing protocols), and the configuration of all routers on the network is not required.  Only one router is <b>configured</b> - the main router of the company; all other routers <b>do not require any</b> routing <b>configuration at all</b> , neither static nor dynamic. <br>  Thus, it turns out that ODR does not have the above disadvantages: <br><ul><li>  The amount of data transferred is minimal compared to the protocols of dynamic routing protocols. </li><li>  Requires minimal configuration on a single router. </li></ul><br><a name="habracut"></a><br>  However, ODR has a disadvantage, or rather a limitation - it can only be applied in the star topology (the term ‚Äúhub-and-spoke‚Äù is often used in English literature).  That is, if no more than one hop (jump) is removed from the central router of the branch network.  In more complex topologies, this protocol does not work.  An example of such a topology is shown in Figure 1-1.  R1 is the central router ("hub"), R2 and R3 routers are the remote branch routers ("spoke"). <br>  Figure 1-1.  Network with a star topology (‚Äúhub-and-spoke‚Äù). <br><img src="https://habrastorage.org/getpro/habr/post_images/82a/40a/77c/82a40a77c514e7f766d599741110a820.jpg" alt="image"><br><br><h4>  2. The principle of ODR </h4><br>  As mentioned above, ODR is not a full-featured dynamic routing protocol.  ODR is an extension of the CDP protocol, and in order to understand how ODR transmits information using CDP, you need to parse the basic principles of this protocol, so a slight digression. <br><blockquote>  The device (router or switch) regularly sends special CDP (Cisco Discovery Protocol) messages to the group MAC address 01-00-0c-cc-cc-cc.  By default, this happens every 60 seconds.  If a device that understands this protocol receives a similar message, it enters the information contained in it in a special table and considers the sender of this message as its ‚ÄúCDP neighbor.‚Äù  If no messages are received from the neighbor during the three mailing interval, then information about it is deleted from this table.  Mailing and deletion timers are configurable; you can read about them in the CDP protocol course. <br>  The main purpose of the CDP protocol is to enable devices located on the same channel network to receive information about each other, even if different protocols are used at the network layer. <br>  The CDP protocol provides information transfer in the form of TLV (Type / Length / Value - type / length / value) blocks.  That is, the data field has a variable length and depends on the type and number of TLV blocks included in the message.  At the same time, situations are possible when the devices, for example, due to different production dates, ‚Äúknow‚Äù a different set of TVL blocks.  But this does not interfere with the devices to interact normally, since the format of these blocks is standard, and if a block comes with an unknown ‚ÄúType‚Äù field, then based on the ‚ÄúLength‚Äù field, you can simply skip the ‚ÄúValue‚Äù field and move on to the next block. <br>  An example of a CDP frame is shown in Figure 2-1. <br>  Figure 2-1.  An example of a CDP frame captured by a traffic analyzer. <br><img src="https://habrastorage.org/getpro/habr/post_images/d2c/765/442/d2c76544273dc56d2d76dac7844f6ecf.jpg" alt="image"></blockquote><br>  So, to implement the protocol ODR, Cisco has used the ability to extend the protocol CDP.  A new type, <b>0x0007</b> , was added to <b>it</b> , and with it, routers can exchange routing information in a very limited way. <br>  The structure of this option is the same: <br><ul><li>  Type - 0x0007 </li><li>  Length - the length of the entire option, depending on the amount of data transferred. </li></ul><br>  When transferring data from the central router, the data length is always 4 bytes - the IP address that the remote router should use as the default gateway, as a result, the whole option will be 8 bytes long.  An example of such an option is shown in Figure 2-2. <br>  When transferring data from a remote router, the data length is variable, the message shows the numbers of one or several networks connected to this router in the format ‚Äú4 bytes IP address, and 1 byte mask‚Äù.  These networks will be added by the central router to the routing table.  As a result, the length of the entire option will be - 4 + N * 5 (where N is the number of networks connected to the remote router, except for the network through which it communicates with the central one).  An example of such an option is shown in Figure 2-3. <br><ul><li>  Value - IP address of the gateway, or a set of networks, depending on the direction in which the packet is sent. </li></ul><br>  Figure 2-2.  An example of a CDP frame captured by the traffic analyzer with the ODR option transmitted from the central router is the address that should be used by the remote router as the default gateway. <br><img src="https://habrastorage.org/getpro/habr/post_images/02a/b20/8f9/02ab208f9c5c54b4ab49559251c2f849.jpg" alt="image"><br>  Figure 2-3.  An example of a CDP frame captured by the traffic analyzer with the ODR option transmitted to the central router is transmitted to the network addresses that the central router must add to the routing table. <br><img src="https://habrastorage.org/getpro/habr/post_images/418/fdf/ea3/418fdfea3773a4cb185e0154f4ed78b3.jpg" alt="image"><br><br><h4>  3. Configure ODR </h4><br>  First of all, we should not forget that ODR runs on top of CDP, and it must be enabled on all routers ( <b>cdp run</b> command in global configuration mode). <br>  Enabling On-Demand Routing is performed only on the central router by entering the <b>router odr command</b> in global configuration mode.  However, unlike other dynamic routing protocols, no commands are required any more (for example, <b>network</b> ).  An example of setting up the ODR protocol is shown in Figure 3-1; as you can see, only one <b>router odr</b> command has been <b>entered</b> . <br>  Figure 3-1.  An example of setting the protocol ODR. <br><img src="https://habrastorage.org/getpro/habr/post_images/82a/40a/77c/82a40a77c514e7f766d599741110a820.jpg" alt="image"><br>  At the same time, the central router on all its interfaces includes in the CDP ODR distribution an option that will indicate the IP address that the remote routers should use as a gateway.  All remote routers that see this option in CDP packets, and no dynamic routing protocol is configured on them ( <u>this is a prerequisite</u> ), include in their CDP the same option with information about the connected networks (except the one that belongs to the interface) which these ads are sent). <br>  Figure 3-2.  The routing table of the central router. <br><img src="https://habrastorage.org/getpro/habr/post_images/a0a/7be/1db/a0a7be1db7fc6ea2dd77fcc8610c8634.jpg" alt="image"><br>  As a result, at the central router after some time (determined by the CDP packet distribution interval), records about networks connected to remote routers are added to the routing table.  An example of the routing table of the central router is shown in Figure 3-2. <br>  One additional entry appears on the remote routers - the default route to the central router.  An example of the routing table of a remote router is shown in Figure 3-2. <br>  The administrative distance in both cases is 160 by default. <br>  The default metric is - 1 (which is quite logical, given that remote routers cannot be more than one hop away from the central one). <br>  Figure 3-3.  Routing table of the remote router. <br><img src="https://habrastorage.org/getpro/habr/post_images/0e3/96e/43e/0e396e43e7065a4125fe3b7cb760993f.jpg" alt="image"><br>  In this case, only connected networks are transmitted to the central router.  The networks described by static routing are not transmitted (and dynamic routing on remote routers cannot be enabled by definition).  Attention should be paid to the fact that even when describing a static route, we will use the interface as the target of the route, not the gateway IP address, despite the fact that in the routing table this network described by the static route will be signed as <u>directly connected</u> ( Cisco routing tables, shown in Figure 3-4), it will not get into the list. <br>  Figure 3-4.  A static route that has an interface as a target, and not a gateway IP address, is displayed on the Cisco routers as a connected network. <br><img src="https://habrastorage.org/getpro/habr/post_images/c40/af3/44f/c40af344f22165342728a5ed543fff11.jpg" alt="image"><br>  As can be seen in Figure 3-5, only the networks connected to the nearest remote routers are present in the routing table of the central router R1, and the network 172.16.3.0/24 connected to R4 and described by R3 with a static route did not get into its routing table. <br>  Figure 3-5.  The routing table of the central router contains only ‚Äúreally connected‚Äù to the remote routers of the network. <br><img src="https://habrastorage.org/getpro/habr/post_images/11b/5c0/4a2/11b5c04a29d0845aef0d798704699608.jpg" alt="image"><br>  Figure 3-6.  If you disable the CDP protocol, then the ORD protocol will not work. <br><img src="https://habrastorage.org/getpro/habr/post_images/fa2/c19/e62/fa2c19e6216a18b25b22bc85dd3ee38d.jpg" alt="image"><br>  Naturally, since ODR requires CDP for its operation, disabling the latter causes routers to stop sharing route information.  Figure 3-6 shows that if the remote router (in the example on R2) disables the CDP, it will stop transmitting the routing information (in fact, it will stop transmitting all the information that it previously transmitted using this protocol).  As a result, on the central router, the timers of these networks will not be updated in the routing table, and after about 180 seconds the routes will be labeled as "possibly down", and after another 60 seconds they will disappear completely from the routing table. <br><blockquote>  Please note that routers do not consider these intervals to within a second; this would obviously be too resource intensive.  The system has a timer that ‚Äúticks‚Äù in accordance with the message delivery interval, by default, once a minute.  And the router simply counts three such ‚Äúticks‚Äù in order to understand that the CDP message was missed three times.  And depending on the moment when the last CDP message was received regarding the nearest ‚Äútick‚Äù, we will get a delay of a little more than 180 seconds, or approaching 240 seconds. <br>  This conclusion was obtained by studying the system response time to receiving CDP messages in conjunction with the ODR protocol, taking into account that both the operating system and these protocols are proprietary, closed, there is no information about exact processing algorithms.  It may well be that on other versions of IOS everything will be different. <br>  Do not despair, by and large this is not so important, but this implementation is very interesting, especially considering that the idea of ‚Äã‚Äã"ticks" is not unique and is used in many operating systems. </blockquote><br>  The remote router will also lose the default route entry, since it will ignore all CDP messages coming to it. <br>  And of course, ODR does not have built-in security (encryption, digital signature), which does not affect its reputation very well and limits its scope. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  <b>4. ODR timers</b> </h4><br>  Although the message delivery time is determined by the settings of the CDP, you can control the message processing timers with <u>limited time</u> using the <b>timers basic</b> command in the router configuration mode.  But here it should be remembered that the control will not be complete, since the re-sending interval will depend only on the CDP setting and cannot be influenced by the <b>timers basic</b> command.  It is important to understand that if you set too small values, without changing the CDP timers, this will lead to the periodic disappearance of routes from the routing table.  You should also not set these values ‚Äã‚Äãtoo large, since then information about unreachable networks will be in the routing tables for too long. <br>  As in other dynamic routing protocols, the parameters used at the moment, and in particular the protocol timers, can be viewed using the <b>show ip protocols</b> command.  The output of this command is shown in Figure 4-1. <br>  Figure 4-1.  The output of the show ip protocols command for the ODR protocol. <br><img src="https://habrastorage.org/getpro/habr/post_images/d26/16b/ab2/d2616bab23e2102007f85725d308d956.jpg" alt="image"><br>  To change the timers, use the <b>timers basic</b> command, the parameters of which are transmitted successively the values ‚Äã‚Äãof standard timers: <br><ul><li>  Update </li><li>  Invalid </li><li>  Holddown </li><li>  Flush </li><li>  Sleep Time (optional) </li></ul><br>  When analyzing the output of the <b>show ip protocols</b> command, you can see that the Holddown timer is not applicable for the ODR, but since it is impossible to skip it using the <b>timers basic</b> syntax, you need to specify something, but the specified value will not affect anything. <br>  It should also be noted that the period for sending messages is not governed by the Update parameter, but by the time settings of the CDP protocol (in general, you can read about the CDP protocol itself and its timers in particular in the course on this protocol).  But unlike Holddown, which doesn‚Äôt affect anything at all, the Update value is used in a specific way, which will be shown below with an example. <br>  For example, if we give the command <b>timers basic 5 15 25 50</b> (instead of the third value, we could write any number), and without changing the properties of the CDP, the message distribution period will remain as before - one minute.  This is easily seen when analyzing the traffic captured on the router interface shown in Figure 4-2. <br>  Figure 4-2.  Capturing CDP traffic, the default CDP frame broadcast interval is 1 minute. <br><img src="https://habrastorage.org/getpro/habr/post_images/83c/fa3/43c/83cfa343c321028ade572233bac94d85.jpg" alt="image"><br>  For clarity, we will enable the CDP protocol debugging mode and the routing table processing ( <b>debug cdp packets</b> and <b>debug ip routing</b> ), and also disable the right (fa0 / 1) interface to monitor the traffic of only one interface. <br>  Figure 4-3.  Diagnostics of CDP and ODR protocol interaction using the <b>debug</b> command, stage 1. <br><img src="https://habrastorage.org/getpro/habr/post_images/61a/88c/93f/61a88c93fae1f4e4141e15136a0fc1da.jpg" alt="image"><br>  Figure 4-3 shows that when a CDP packet is received from a neighbor, the received routes are added to the routing table (at 25 minutes 12 (almost 13) seconds according to the local time of the router). <br>  Figure 4-4.  Diagnostics of CDP and ODR protocol interaction using the <b>debug</b> command, stage 2. <br><img src="https://habrastorage.org/getpro/habr/post_images/3ab/49e/ac9/3ab49eac9b859fee153a6cc13ab2e94a.jpg" alt="image"><br>  After 19 seconds (Figure 4-4), the Invalid timer is triggered (we set the Invalid parameter to 15 in the <b>timers basic</b> command). <br><blockquote>  Here, the router also does not count seconds.  Based on the results of the experiments, we can conclude the following: it starts the timer that ‚Äúticks‚Äù every few seconds, the duration of the tick is determined by the Update parameter.  Then the system takes an integer amount of "ticks" included in the interval of Invalid, and waits until they pass.  Considering that the tick timer is not synchronized with the arrival of CDP messages, it turns out that a little longer time actually passes from the moment of receiving the last CDP message to the triggering of the Invalid timer. </blockquote><br>  The system, without receiving updates, marks routes as ‚Äúpossibly down‚Äù - ‚Äúpossibly unreachable‚Äù.  But at the same time, the router continues to successfully send packets to these networks. <br>  Figure 4-5.  Diagnostics of CDP and ODR protocol interaction using the <b>debug</b> command, stage 3. <br><img src="https://habrastorage.org/getpro/habr/post_images/7dd/fbe/138/7ddfbe13846163d5f7c42a4c5edc53b7.jpg" alt="image"><br>  After another 35 seconds, at 26 minutes 7 seconds (Figure 4-5) according to the local time of the router, the system still without receiving updates removes routes from the routing table.  This triggers the Flush timer, which we set to 50 seconds (about 55 seconds passed since the last update, but here, as well as in the Invalid timer, the system counts not the seconds, but the timer ticks, in our case five seconds, from here and small discrepancy). <br>  Figure 4-6.  Diagnostics of CDP and ODR protocol interaction using the debug command, step 4. <br><img src="https://habrastorage.org/getpro/habr/post_images/3cc/a7c/c25/3cca7cc255d18bc70b038c61e1b3e8f2.jpg" alt="image"><br>  And finally, having received the next CDP update, exactly in a minute (Figure 4-6) from the moment of receiving the previous one, the routes appear again in the routing table. <br>  Thus, we can draw the following conclusions: <br><ul><li>  The value of the <b>Update</b> parameter, which in other dynamic routing protocols affects the announcement distribution period, indirectly affects the calculation of the invalid and flush timers, and should not be less than the CDP announcement distribution timer, in order to exclude the premature deletion of routing information from the routing table </li><li>  The value of the <b>Invalid</b> parameter, works in the same way as in other dynamic routing protocols and determines the time period if after the expiration of which a certain network does not receive an update, it is marked as ‚Äúpossibly unattainable‚Äù (possibly down).  Must be more than update, recommended three times, so that even if three consecutive updates are lost, since they are transmitted without a delivery guarantee, the route is not considered unattainable. </li><li>  The value of the <b>Flush</b> parameter works in the same way as in other dynamic routing protocols and determines the time period if after the expiration of which a certain network does not receive an update, it is considered unreachable and is deleted from the routing table.  Must be more than invalid, at least one interval of the update period. </li></ul><br><blockquote>  The default timers basic values ‚Äã‚Äãare: <br><ul><li>  update: 60 </li><li>  invalid: 180 </li><li>  holddown: 0 </li><li>  flush: 240 </li><li>  sleeptime: 0 </li></ul><br></blockquote><br><br><h4>  <b>5. Filtering routes in ODR</b> </h4><br>  In some cases, there may be a situation in which for some time it will be necessary to exclude a specific network belonging to remote routers from the routing table of the central router. <br>  This can be done, for example, by disabling the interface or CDP protocol on the corresponding device, but in this case we completely stop communicating with this device or lose all networks connected to it. <br>  If it is necessary to remove from the routing table only one network from several that are accessible through a redistributed remote router, such cardinal methods are not suitable.  In this case, you can use the <b>distribute-list</b> command, with which you can control the filtering of routes that are received or sent in announcements. <br>  Figure 5-1.  The routing table of the central router at the beginning of the experiment, it contains all the networks connected to remote routers. <br><img src="https://habrastorage.org/getpro/habr/post_images/4fc/80f/259/4fc80f259e99f099bb2d9fcab89b438e.jpg" alt="image"><br>  For example, we want to temporarily exclude from the routing table one of the networks connected to router R2, namely the network 172.16.1.0/24.  Figure 5-1 shows the networks present in the routing table of the central router at the beginning of the experiment. <br>  The <b>distribute-list</b> command requires a pre-configured access list with described networks that can and cannot be received or transmitted in announcements. <br><blockquote>  ACL - Access Control List, in this course we will not discuss in detail the syntax and features of the use of access lists, you can read about them in more detail in the course on the configuration of security on Cisco devices). </blockquote><br>  Figure 5-2.  Create ACL. <br><img src="https://habrastorage.org/getpro/habr/post_images/765/311/12c/76531112c4931cd95c01e6635c71e70c.jpg" alt="image"><br>  Creating an access list is shown in Figure 5-2 and is done using the access-list command.  In it, we configure that we will ignore ads falling within the 172.16.1.0/24 range, and will accept all other ads. <br>  Figure 5-3.  Reconciling the created ACL with the distribute-list command. <br><img src="https://habrastorage.org/getpro/habr/post_images/835/861/501/83586150110ffc0b488c26bcda3a277e.jpg" alt="image"><br>  After creating the sheet, you need to apply the <b>distribute-list</b> in ODR configuration mode, as shown in Figure 5-3.  You must specify the direction - <b>in</b> (incoming announcements), and also, if necessary, you can specify the interface for which this filter will be applied.  If the interface is not specified, then filtering will occur for all ads coming to all interfaces. <br>  Figure 5-4.  The routing table of the central router after applying the <b>distribute-list</b> command. <br><img src="https://habrastorage.org/getpro/habr/post_images/ec9/6d0/1fd/ec96d01fdef46f40279faf833a6709a8.jpg" alt="image"><br>  After that, the router stops processing incoming announcements about the network 172.16.1.0/24, and when the Flush timer comes, it disappears from the routing table, as shown in Figure 5-4. <br><blockquote>  The <b>distribute-list</b> command also has an <b>out</b> parameter, the use of which is to filter network entries for outgoing announcements, but it does not work for ODR.  Actually, the central router sends only the default route, so there‚Äôs really nothing to filter. </blockquote><br><br><h4>  <b>6. Interworking with other routing protocols.</b> </h4><br>  It makes sense to talk about the interaction of the ODR protocol with other dynamic routing protocols only in terms of transferring data about networks connected to remote routers (in the context of ODR) to another protocol, but not vice versa. <br>  Configuring the transmission of routing information from an ODR occurs in the dynamic routing protocol that is to receive the routing information using the <b>redistribute command</b> .  As parameters, you must pass the name of the protocol whose routes you want to import, in our case <b>odr</b> , as well as the <b>subnets</b> parameter, if there are subnets of class networks in the network. <br>  The application of this command is shown in Figure 6-1.  In the OSPF protocol configuration mode, the <b>redistribute odr subnets command is issued</b> , which causes the networks learned by the central router to be imported using OSPF protocol to their base using the ODR protocol and transferred further to the part of the network that is served by the OSPF protocol.  Figure 6-1 shows the routing table of router R4, which received information about networks 172.16.0.0/24 and 172.16.2.0/24 from router R1 via the OSPF protocol, but since these networks were first studied by ODR and then imported from it into OSPF, this routing information is ‚Äúnon-native‚Äù for OSPF and the corresponding routes in the routing table are marked with ‚ÄúE2‚Äù symbols - external routes. <br>  Please note that transmitting data in the opposite direction does not make sense.  Route information collected by OSPF on the central router is already available, since this protocol is running on it.  And remote routers, in any case, receive only default routes.  Therefore, it does not make sense to apply the <b>redistribute</b> command to the ODR protocol (although this command is present in its configuration), therefore, there is no <b>redistribute</b> command in the configuration example in Figure 6-1 in the ODR configuration. <br>  Figure 6-1.  Apply the redistribute command to the OSPF protocol. <br><img src="https://habrastorage.org/getpro/habr/post_images/0a6/df0/90c/0a6df090cb2ac79f02af767f4140043c.jpg" alt="image"><br>  The example also leaves the filter applied to the ODR, which excludes the 172.16.1.0/24 network from processing, and as a result, only the 172.16.0.0/24 and 172.16.2.0/24 networks on the R4 router were transferred to OSPF. <br><blockquote>  If necessary, you can also define a redistribution filter in OSPF by applying route maps to the <b>redistribute</b> command, you can read about them in the course on routing optimization. </blockquote><br>  Configuring routing information to other internal routing protocols, such as RIP and EIGRP, is done in a similar way. <br><br><h4>  <b>7. Additional ODR Setup</b> </h4><br>  In addition to setting timers, filtering routes, and interacting with other routing protocols for ODR, several other configuration commands are applicable: <br><ul><li>  <b>maximum-paths</b> ‚Äî changes the number of routes installed in the routing table when there are multiple paths.  The default value is four.  It can be changed in the range from 1 to 6. </li></ul><br>  Figure 7-1.  ORD supports load balancing. <br><img src="https://habrastorage.org/getpro/habr/post_images/0e6/d82/6f2/0e6d826f2e0d5969fd61a9c02070d985.jpg" alt="image"><br>  Considering that the metrics of all routes will be equal to one, we cannot talk about balancing along routes with different costs.  A network and an example of a routing table with several possible options for achieving one network is shown in Figure 7-1.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you give the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">maximum-paths 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> command in the ORD protocol configuration mode </font><font style="vertical-align: inherit;">, the load balancing feature will be disabled and the routing table will have one path that was previously studied, as shown in Figure 7-2. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 7-2. </font><font style="vertical-align: inherit;">Disabling load balancing by setting the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">maximum-paths</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value </font><font style="vertical-align: inherit;">to one. </font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/084/5bb/fa6/0845bbfa662503e3316e83704752bdaa.jpg" alt="image"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If the number of routes is greater than the permissible limit, those that were previously studied fall into the routing table.</font></font><br><ul><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Distance</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - changes the administrative distance.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 7-3. Change the administrative distance for the ODR protocol. </font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/db0/4fa/9ff/db04fa9ff471ce75268faad292f30331.jpg" alt="image"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Given that administrative distance is not transmitted in CDP messages, the configuration is local only for the central router, you cannot change the administrative distance on remote routers (the distance command is given in router configuration mode, and the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">router odr command</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on remote routers cannot be given, because they will go into central mode, stop sending information about their networks, and ignore messages from the ‚Äúreal‚Äù central router). An example of a change in administrative distance is shown in Figure 7-3.</font></font><br><ul><li> <b>default</b> ‚Äì   -     .        <b>no</b> . </li></ul><br><ul><li> <b>passive-interface</b> ‚Äì    . </li><li> <b>redistribute</b> ‚Äì   ,        ,   -     </li><li> <b>network</b> ‚Äì    . </li><li> <b>neighbor</b> ‚Äì   , CDP     ,      . </li><li> <b>default-metric</b> ‚Äì   ,          ,     . </li></ul><br><br><h4> <b>8. .</b> </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And so, for those who read to the end, you can summarize the protocol ODR: </font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It works only on Cisco devices, as it is proprietary. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It works on top of the CDP protocol and practically does not load lines with additional traffic. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Works only in the star topology (‚Äúhub-and-spoke‚Äù). </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Requires minimal configuration ‚Äî enabled by the router odr command on the central router. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A prerequisite for work is the absence of other dynamic routing protocols on remote routers. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It processes only connected routes, static routes are not processed. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> No built-in security. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Possibly limited route mapping management. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Studied networks can be transferred to other routing protocols. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Timer management may also require changing the settings of the CDP protocol. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frankly, in view of the fact that at least some configuration is required for remote routers, the appropriateness of using the ODR protocol in modern networks is highly questionable. </font><font style="vertical-align: inherit;">Especially given its weak functionality. </font><font style="vertical-align: inherit;">But, nevertheless, it is certainly possible to find a scope for this protocol. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the other hand, this protocol is an interesting, academic example of a non-standard approach to implementing a dynamic routing protocol. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EIGRP, OSPF, IPV6 and BGP are on the way.</font></font></div><p>Source: <a href="https://habr.com/ru/post/210932/">https://habr.com/ru/post/210932/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../210920/index.html">Stored functions. Pros and cons</a></li>
<li><a href="../210922/index.html">The new head of Microsoft will be Satya Nadella</a></li>
<li><a href="../210924/index.html">North Korean Red Star OS goes to Macs</a></li>
<li><a href="../210926/index.html">Development for Android in NetBeans IDE without plug-ins. Part 2</a></li>
<li><a href="../210930/index.html">As I classes in Vim wrote</a></li>
<li><a href="../210934/index.html">Data migration between different e-commerce engines</a></li>
<li><a href="../210936/index.html">Is it necessary to make a client a friend, and a friend a client?</a></li>
<li><a href="../210938/index.html">Dislocker Or find a common language with BitLocker in Linux Mint</a></li>
<li><a href="../210942/index.html">How I invent a method of simulating annealing</a></li>
<li><a href="../210946/index.html">Analyzing traffic sources to increase conversion</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>