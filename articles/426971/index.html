<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Fatalism in error handling</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 


 This article is a reaction to the article: What will happen to error handling in C ++ 2a . After each paragraph I had an itch, healed wou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Fatalism in error handling</h1><div class="post__text post__text-html js-mediator-article"><h2 id="predislovie">  Foreword </h2><br><p>  This article is a reaction to the article: <a href="https://habr.com/post/426965/">What will happen to error handling in C ++ 2a</a> .  After each paragraph I had an itch, healed wounds opened and started to bleed.  Maybe I take too much to heart what is written.  But I just want to howl about the myopia and illiteracy that C ++ programmers show in the 21st century.  And not even at the beginning. </p><br><p>  Let's get started </p><br><h2 id="klassifikaciya">  Classification </h2><br><blockquote>  Conventionally, all erroneous situations in the program can be divided into 2 large groups: <br><ol><li>  Fatal errors. </li><li>  Not fatal, or expected errors. </li></ol><br></blockquote><a name="habracut"></a><br><p>  I will now find fault.  But fatal errors are also in some sense expected.  We expect that a trip through memory often leads to a fall, but it may not lead to it.  And this is expected, isn't it?  When a classification is introduced, it would always be to check its consistency. </p><br><p>  But this is so often a subtle mistake. </p><br><p>  Let's look at fatal errors. </p><br><p>  <strong>The division by 0</strong> .  I wonder why this error is fatal?  I would gladly throw an exception in this case and catch it for further processing.  Why is she fatal?  Why is the specific behavior of my own program being imposed on me, and I cannot influence it in any way?  Isn't C ++ about flexibility and the fact that the language is turned to face the programmer?  Although... </p><br><p> <strong>Null pointer dereferencing</strong> .  Java is remembered <code>NullPointerException</code> , there is a <code>NullPointerException</code> that can be handled.  The Poco library also has a <a href="https://pocoproject.org/docs/Poco.NullPointerException.html"><code>NullPointerException</code></a> !  So why the developers of the standard with the stubbornness of the deaf-and-dumb repeat the same mantra? </p><br><p>  In general, why did I start this topic?  It is very important and just reveals the developer‚Äôs understanding of error handling.  Speech here does not go about error handling as such, it is a prelude to an important action.  Speech is always about application reliability, fault tolerance, and sometimes, in the rarest and most endangered, I would say, endangered types of programs, transactional and consistent behavior. </p><br><p>  In this aspect, all disputes about dividing by zero and dereferencing pointers look like bird fights for bread crumbs.  Of course, an important process.  But only in terms of birds. </p><br><p>  Let us return to the division into fatalism and its absence ... I will begin with a simple question: if I received incorrect data over the network, is this a fatal error? </p><br><p>  The simple and correct answer: depends on.  It is clear that in most cases this is not a fatal error, and all data received over the network must be validated, and 4xx should be returned in case of data error.  Are there any cases when you have to crash?  And to crash with a wild howl to send SMS, for example.  Yes, and not one. </p><br><p>  There are.  I can give an example from my subject area: a distributed algorithm of consensus.  A node receives a response that contains a hash from chains of changes from another node.  And this hash is different from the local one.  This means that something went wrong, and to continue further execution is simply dangerous: the data may diverge if not already.  It happens when the availability of the service is less important than its consistency.  In this case, we need to fall, and with a crash, so that everyone can hear around.  Those.  we got the data over the network, checked it in, and dropped it.  For us, this mistake is nowhere more fatal.  Is this error expected?  Well, yes, we wrote the code with validation.  It is foolish to say the opposite.  Only we do not want to continue the program after this.  Manual intervention is required, automation did not work. </p><br><h2 id="vybor-fatalizma">  The choice of fatalism </h2><br><p>  The most obscure thing about error handling is deciding what is fatal and what is not.  But this question every programmer asks himself throughout the development.  Therefore, somehow answers itself to this question.  The correct answer comes for some reason from practice. </p><br><p>  However, this is only the visible part of the iceberg.  In the depths there is a much more monstrous question.  To understand the depth of the depths, you need to set a simple task and try to answer it. </p><br><p>  <em>Task</em> .  Make a framework of something. </p><br><p>  It's simple.  We do a framework, for example, network interaction.  Or parsing json.  Or, at worst, XML.  The question immediately arises: when an error occurs from a socket, is it a fatal error or not?  I paraphrase: should I throw an exception, or return an error?  Is this an exceptional situation or not?  And can return <code>std::optional</code> ?  Or monadka?  (^ 1) </p><br><p>  The paradoxical conclusion is that the framework itself cannot answer this question.  Only the code using it knows.  That is why in the excellent, in my opinion, <a href="https://www.boost.org/doc/libs/1_68_0/doc/html/boost_asio.html">boost.asio</a> library uses both options.  Depending on the personal preferences of the author of the code and application logic, you can choose one or another error handling method.  At first, I was a little embarrassed by this approach, but over time I became imbued with the flexibility of this approach. </p><br><p>  However, this is not all.  The worst thing to come.  We write application code, but it seems to us that it is application code.  For other higher level code, our code will be library.  Those.  division into application / library (framework, etc.) code is a pure convention, which depends on the level of component reuse.  You can always screw something up and the application code will cease to be so.  And this immediately means that the choice of what is valid and what is not, is already decided by the code using, and not used. </p><br><p>  If we jump aside, it turns out that sometimes it is even impossible to understand who is using whom.  Those.  component <strong>A</strong> can use component <strong>B</strong> , and component <strong>B</strong> can use component <strong>A</strong> (^ 2).  Those.  who determines what will happen is generally incomprehensible. </p><br><h2 id="rasputyvanie-klubka">  Unraveling the coil </h2><br><p>  When you look at all this disgrace, then the question immediately arises: how to live with it?  What to do?  What guidelines for yourself to choose, so as not to drown in diversity? </p><br><p>  For this it is useful to look around and understand how such issues are resolved in other places.  However, we must look wisely: we must distinguish between "collecting stamps" from full-fledged solutions. </p><br><p>  What is "stamp collecting"?  This is a collective term, which means that we exchanged a goal but something else.  For example: we had a goal - to call and communicate with loved ones.  And we have once, and bought an expensive toy, because it is "fashionable" and "beautiful" (^ 3).  Familiar?  Do you think programmers don't do that?  Do not flatter yourself. </p><br><p>  Error handling is not a goal.  Whenever we talk about error handling, we immediately come to a standstill.  Because it is - a way to achieve the goal.  And the initial goal is to make our software reliable, simple and understandable.  Such goals should be set and always adhere to them.  And error handling is a shit that is not worth discussing.  I want to throw an exception - yes to health!  Returned the error - well done!  Want monadka?  Congratulations, you created the illusion of advancement, but only in your own head (^ 4). </p><br><p>  I also wanted to write here how to do it correctly, but I already wrote out.  The wounds healed and stopped bleeding.  In short, the tips are: </p><br><ol><li>  Separate into components with clear boundaries. </li><li>  At the borders, describe what and how can fly.  It is desirable to be uniform.  But much more important that it was. </li><li>  Make it easy to handle errors in the code it will use. </li><li>  If something can be processed inside without load on the user code - do not push it out.  The fewer errors a user must handle, the better. </li><li>  Respect your user, do not be assholes!  Write understandable interfaces with expected behavior so that it does not need to read comments and use foul language. </li></ol><br><p>  The 5th Council is the most important, because  he combines the first four. </p><br><p>  <em>PS</em> As a child I was always curious to look at the anthill.  Thousands of ants, each doing something, crawling about their business.  The process is underway.  Now I also watch with interest.  Also behind the anthill.  Where thousands of individuals are engaged in their small business.  I wish them good luck in their difficult task! </p><br><p>  ^ 1: People are susceptible to fancy stuff.  When everyone had played enough, C ++ programmers woke up, and then everything started to happen. </p><br><p>  ^ 2: This can happen when there are several abstractions in the component <strong>B</strong> that binds them.  See <a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D0%25BD%25D0%25B2%25D0%25B5%25D1%2580%25D1%2581%25D0%25B8%25D1%258F_%25D1%2583%25D0%25BF%25D1%2580%25D0%25B0%25D0%25B2%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F">Inversion Control</a> . </p><br><p>  ^ 3: And the next day, bang, and the screen crashed. </p><br><p>  ^ 4: I don‚Äôt mind monads, I don‚Äôt want to breathe, like, look, here is a monad, i.e.  monoid in the monoidal category of endofunctors!  Applause and approving nods are heard.  And somewhere far, far away, barely audible, someone orgasm. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/426971/">https://habr.com/ru/post/426971/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../426961/index.html">How Microsoft rewrote the C # compiler in C # and made it open</a></li>
<li><a href="../426963/index.html">Do applications on Flutter dream about platform-oriented widgets?</a></li>
<li><a href="../426965/index.html">What will happen with error handling in C ++ 2a</a></li>
<li><a href="../426967/index.html">Online ABAP code generator</a></li>
<li><a href="../426969/index.html">Alert "Lida": security testing automation</a></li>
<li><a href="../426973/index.html">Corporate Sandwiches</a></li>
<li><a href="../426975/index.html">Joker 2018: the impossible is possible</a></li>
<li><a href="../426977/index.html">LibreOffice: a bad dream accountant</a></li>
<li><a href="../426979/index.html">How to learn English for free: 3 banal tools and detailed instructions for each</a></li>
<li><a href="../426981/index.html">10 tricks for advanced dashboarding in Splunk. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>