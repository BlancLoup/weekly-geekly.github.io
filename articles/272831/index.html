<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>2015 is the year of Cryptolocker, and how cyber criminals have perfected their attacks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the end of 2013, the first signs of new threats appeared, which will soon become one of the most profitable types of attacks carried out by cyber-c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>2015 is the year of Cryptolocker, and how cyber criminals have perfected their attacks</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/f08/723/f23/f08723f235094b419a9696bf4edeee06.jpg"><br><br>  At the end of 2013, the first signs of new threats appeared, which will soon become one of the most profitable types of attacks carried out by cyber-criminals.  <b>Cryptolocker</b> is the most popular ransomware family that eventually became used as a name for all threats of this type. <br><br>  This threat always works according to the same scenario: it encrypts documents and requires a ransom in order to recover encrypted documents. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This year <a href="http://club.cnews.ru/blogs/entry/cryptolocker_chto_eto_takoe_i_kak_ego_izbezhat">we have already written</a> about how Cryptolocker works.  Briefly about how <b>files</b> are <b>encrypted</b> after <a name="habracut"></a>  install malware. <br><br>  The trojan generates a random symmetric key for each file it intends to encrypt, and then encrypts the contents of the file using the AES algorithm using this key.  The program then encrypts a random key using an encryption algorithm using an asymmetric public-private key (RSA) and keys longer than 1024 bits (we saw patterns that used keys of 2048 bits), and adds it to the encrypted file.  Thus, the trojan ensures that only the owner of the RSA private key can obtain the random key that was used to encrypt the file.  In addition, computer files are overwritten and therefore cannot be accessed using special methods. <br><br>  <i>Fig.</i>  <i>Once launched, the trojan gets the public key (PK) from its C &amp; C server.</i>  <i>To find the active C &amp; C server, the Trojan includes a domain generation algorithm (DGA) or ‚ÄúMersenne twister‚Äù for generating random domain names.</i>  <i>This algorithm takes the current date as a basis and is able to generate up to 1000 different fixed-size domains daily.</i>  <i>(Note. The quality of the picture does not allow to fully reproduce the code)</i> . <br><br><img src="https://habrastorage.org/files/0e3/d38/bef/0e3d38bef8304be987a608a4571e57e2.png"><br><br>  After the Trojan has downloaded the PK, it saves it in the Windows registry key: HKCUSoftwareCryptoLockerPublic Key. <br><br>  The Trojan then encrypts files on the hard disk of the computer, as well as on each network drive of the infected user, to which it gains access. <br><br>  <i>Fig.</i>  <i>CryptoLocker does not encrypt every file found, but only encrypts non-executable files with extensions contained in the malicious code:</i> <br><img src="https://habrastorage.org/files/2af/64e/3bd/2af64e3bd2c64948aed7b381d9ae722e.png"><br><br>  Additionally, CryptoLocker logs each encrypted file to the registry key: HKEY_CURRENT_USERSoftwareCryptoLockerFiles <br><br>  <i>Fig.</i>  <i>When a trojan finishes encrypting each file that satisfies the above conditions, it shows this message asking the user to pay a ransom, limiting the time for sending the payment to the period until the private key is destroyed by the malware author.</i> <br><img src="https://habrastorage.org/files/6a4/69c/08d/6a469c08d0de4e39899a833fbc150b4b.png"><br><br>  <i>Fig.</i>  <i>The malicious program does not ask the user for the same amount of money, but contains its own currency conversion table:</i> <br><img src="https://habrastorage.org/files/e95/e41/f6c/e95e41f6ce104c70aa037d96af16a5d1.png"><br><br>  As a rule, cyber criminals locate a victim by its IP address in order to display a message with instructions on how to make a ransom in the victim‚Äôs native language.  Often payments must be made via Bitcoin, and all contacts with extortionists are made through Tor, which helps hackers to remain out of reach for law enforcement. <br><br>  These attacks became increasingly popular during 2014, but first they were directed at individuals, and later attacks began at businesses, which turned out to be more profitable: the stolen information was of great importance for companies, and the ransom (usually within 300 euro) is quite capable of any enterprise. <br><br>  In 2015, we saw <b>how cyber criminals perfected their attacks</b> in order to try to overcome any security tools that might be in their way: <br><br>  ‚Ä¢ They no longer make mistakes when encrypting files.  These errors allowed the developers of security solutions to create tools for recovering documents without redemption. <br>  ‚Ä¢ New families of threats have appeared - an increasing number of cyber-criminals groups are using Cryptolocker, which has become the most popular type of threat at the moment. <br>  ‚Ä¢ They all use Bitcoin as a means of payment, as a result of which they can hardly be tracked. <br>  ‚Ä¢ They focused on two ways to spread: <br>  o Through exploits; <br>  o By email as an archived attachment <br>  ‚Ä¢ Cyber ‚Äã‚Äãcriminals create new forms of attack, and we have already seen how they started using <a href="https://en.wikipedia.org/wiki/Windows_PowerShell">PowerShell</a> scripts, which come with Windows 10 by default <br>  ‚Ä¢ As for mobile devices, although we have seen some attacks (for example, which change the access code to the device), but for the time being, they are still an exception to the rule. <br><br>  <b>How to protect yourself from Cryptolocker</b> <br><br>  As for self-protection, it is necessary to remember that Cryptolocker has certain differences from traditional malware: it is not a constant threat (after encrypting documents there is no need to leave this threat in the system, and some samples even delete themselves), while their authors are not too worried that the threat will be detected by the antivirus.  For cyber criminals, only the fact that it is possible to launch this attack until the moment of detection matters, and after that it is no longer important. <br><br>  Currently, traditional forms of detection are often useless, because  Before each attack, it is verified that these technologies cannot detect this sample, otherwise minor changes can be made to avoid detection.  Behavioral analysis is not able to detect what such threats do in most cases, because  they usually install themselves into working systems to encrypt files from the inside, which makes the process look like a normal computer mode. <br><br>  But a system like <a href="http://www.pandasecurity.com/russia/enterprise/solutions/adaptive-defense-360/">Adaptive Defense 360</a> , which tracks all the processes running on a computer, can be an effective way to stop attacks from encrypters in a timely manner before they encrypt your documents. <br><br>  We offer to evaluate the capabilities of Adaptive Defense 360 ‚Äã‚Äãusing a demo console (without the need to install the product). <br><br>  The demo console is designed to demonstrate Panda Adaptive Defense 360, which already has certain information on user settings, profiles, etc., which allows you to evaluate the console in a mode as close as possible to real work. <br><br>  <a href="http://demologin.pandasecurity.com/">Access to the demo console with full rights</a> <br>  Login: DRUSSIAN_FEDERATION_C13@panda.com <br>  Password: DRUSSIAN # 123 <br><br>  <i><b>Note:</b> Reset changes in the settings of products that are made when viewing the demo console, occurs daily.</i> </div><p>Source: <a href="https://habr.com/ru/post/272831/">https://habr.com/ru/post/272831/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../272813/index.html">"Taskbook" for ABBYY Compreno</a></li>
<li><a href="../272815/index.html">Magic beatboards and Russian checkers</a></li>
<li><a href="../272817/index.html">Create a simple Realtime chat.</a></li>
<li><a href="../272821/index.html">Marmalade C ++ and ShiVa3D: getting started with game engines for the Android x86 platform</a></li>
<li><a href="../272825/index.html">50 typical gaming camera design errors (part 2)</a></li>
<li><a href="../272833/index.html">The virtual PBX market is dead</a></li>
<li><a href="../272835/index.html">Weighty arguments. To the question of analytics in the company</a></li>
<li><a href="../272837/index.html">Raffle free testing of your project in the Mail.Ru Group UX-lab</a></li>
<li><a href="../272841/index.html">Investigation materials: "200 years since the birth of Ada Lovelace, the first programmer of mankind"</a></li>
<li><a href="../272843/index.html">How we implemented GLPI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>