<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to make your server for receiving, processing and sending SMS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, dear habrosoobschestvo! 
 Recently, at the university, I was tasked with creating a service for sending SMS notifications to elders (dean's ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to make your server for receiving, processing and sending SMS</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/8c6/11f/195/8c611f195772b51bdd986a0207c37af0.jpg"><br>  Good day, dear habrosoobschestvo! <br>  Recently, at the university, I was tasked with creating a service for sending SMS notifications to elders (dean's office and others) to my groups. <br>  The main requirements for the service were as follows: <br>  - The service must be multi-user (warden more than 1) with the ability to simultaneously process requests <br>  - Should not be tied to online distribution services (so as not to leak the user base) <br>  - Should be light enough and mobile <br>  - Maximum low cost <br>  - Must use only open source software. <br>  - Must ensure that notifications are sent, even if the sending party does not have access to the Internet and / or computer.  (i.e., not only send, but also receive incoming SMS messages from elders + determine from whom exactly they did and send out to their groups) <br><br>  How did you manage to implement it - look under the cut. <a name="habracut"></a><br><br>  So, let's begin. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  List of ingredients. </h4><br><br>  In order to proceed with the organization of the service, we will need to collect all the necessary glands. <br><br><ul><li>  My computer will be a netbook ASUS EEEPC 701 </li><li>  Mobile phone used to send SMS - Nokia 3110 </li><li>  USB bluetooth adapter - for computer and phone communication </li><li>  Chargers for mobile phone and netbook for permanent support of working condition </li><li>  Internet connection.  By LAN or Wi-Fi. </li><li>  Sim card with MTS Super MTS tariff.  They have all the sms on the RO at any OPPOS for 10 kopecks. </li><li>  Registered hosting and any domain name. </li></ul><br><br>  In principle, this can be limited.  But for more comfortable work, I would advise more: <br><br><ul><li>  Monitor </li><li>  Wireless keyboard </li><li>  Additional cooling for the netbook (for when working 24/7 of its own small cooler it will obviously not be enough) </li></ul><br><br><h5>  Cooling. </h5><br><br>  As for the cooling - to make it completely elementary.  Take the old 80mm cooler, strip the red and black wiring coming from it.  Then cut half of the unnecessary USB cable.  Also strip the red and black wires on it.  Wind the wires from the cooler and from the USB together, insulate and your cooling is ready.  It is advisable to place the cooler under the netbook on the plasticine legs, so that it does not resonate loudly. <br><br>  Actually, this is what it looks like: <br><br><img src="https://habrastorage.org/storage2/5ff/132/a2f/5ff132a2f3990e3244e167b553cea0af.jpg"><br><br>  If someone does not understand, <a href="http://www.cyberforum.ru/modding/thread340042.html">here is a detailed manual</a> . <br><br>  As for stripping wires - I like to first singe their ends on a kerosene burner, and then with a knife it is easy to clean off the remnants.  You should not buy a kerosene lamp either - it can be made from the usual 60 Watt Ilyich light bulb.  Punch the top of the cap, pour kerosene in there, insert a piece of old rag instead of a wick, and you're done.  Here's what it looks like: <br><br><img src="https://habrastorage.org/storage2/72d/493/1b9/72d4931b9b097b8315301b8c308d6c25.jpg"><br><br><h4>  Prepare the iron to work. </h4><br><br><h5>  OS </h5><br>  As an operating system for a netbook, I chose EasyPeasy, a system for netbooks based on the Linux kernel and modified for weak computers.  Download it, install on a USB flash drive, and then on a netbook, you can <a href="http://www.geteasypeasy.com/">here.</a> <br><br><h5>  Bluetooth </h5><br>  After the operating system has taken its place, we connect the bluetooth adapter to a free USB port.  The system should recognize it automatically.  Turn on Nokia and pair the phone and computer. <br><br><h5>  Install gnokii </h5><br>  Need to install gnokii.  I have already referred <a href="http://debian.3dn.ru/blog/priem_i_otpravka_sms_v_linux/2011-02-01-17">to this article</a> on installing it on Linux.  I think you figure it out. <br>  After installation, type in the console something like echo "Hello, friend!" |  gnokii --sendsms '+ 7number your friend' and check whether the SMS has gone. <br><br><h5>  Hosting Preparation </h5><br>  It may be that some other way of organizing multi-user work will suit you, but I used the capabilities of Joomla ACL (access levels).  How to set it up is described in great detail in <a href="http://joomlablog.ru/uroki-joomla/282-joomla-acl-urovni-dostupa">this article</a> .  I just want to note that at the exit you should have a website where each of the users (those who will <b>send</b> sms) will have their own personal account, into which they can enter their mobile phone number (as login, in the format 79XX XXX XX XX) and a five-digit numeric code as a password.  For example, as on the site <a href="http://site.ru/">vamsms.ru</a> <br><br><h4>  We prepare the software for work. </h4><br>  <u>Attention!</u>  <u>I wrote all the programs myself.</u>  <u>You can use them as you like, just give feedback if you find any serious jamb.</u> <br><br>  So, our task is to teach our server to communicate with a remote site, collect requests for sending and send messages.  In addition, the server <b>should be able to receive</b> incoming messages (to Nokia, with which SMS messages are sent), to be aware that they were sent by the elders and also to queue for the newsletter for the group to which the particular elder belongs.  Plus, all this needs to be synchronized.  Well, keep logs, of course. <br><br><h5>  MySQL database organization </h5><br>  First you need to make a database related to the hosting on which you have organized the site.  I called my database - pXXXX_sender (under XXX my user's hosting numbers are hidden) <br>  Inside this database you need to create 3 tables.  I have the following structure: <br><br>  <i>starosti</i> (identification and range of activities for elders) <br>  - number <br>  - group <br>  - course <br>  - facultet <br>  - pass <br><br>  <i>telephones</i> (all phones in the database) <br>  - number <br>  - groups <br>  - course <br>  - facultet <br><br>  <i>on_demand</i> (messages for sending are stored here) <br>  - message <br>  - group <br>  - course <br>  - id_this_trans <br>  - date_log <br><br>  Great, on this with all the databases. <br><br><h5>  The organization of a shell script on a netbook (server). </h5><br>  Now you need to make sure that the netbook checks every 10 minutes: <br>  1) Have new messages been received from the site?  If yes, then send them to the right groups. <br>  2) Received new incoming sms?  If so, are they elders?  If not, then simply delete them, if so, then I determine which group the elder is responsible for and send the message to that group. <br><br>  Here is the listing of the shell script: <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash a=1 #    test_trigger=`cat cache_test_trig.txt` #      while [ $a == 1 ] #   do if ping -c1 ya.ru &amp;&gt; /dev/null then test_trigger_now=$(wget http://site.ru/trigger.txt --quiet -O -) #    if [ $test_trigger_now -eq $test_trigger ]; then #     ? echo "Nothing new :(" # ,       ############################### ######### Mobile extention ############################### aa=1 #    #count=1 #       1 while [ $aa == 1 ] #      1 do sms_test=$(gnokii --getsms IN 1 1) # 1    (1 1,2 2  ..) echo $sms_test&gt;mobile_temp.txt #     answer_test=$(grep -c Date/time: mobile_temp.txt) #    ,  (Date/time:) if [ "$answer_test" != "1" ]; then #    ,  ,   aa=2 #   echo "messages over! Stop" elif [ "$answer_test" == "1" ]; then #   , echo "Here is 1 message" #let count=$count+1 #      #   sms_test    '1. Inbox Message (Unread) Date/time: 07/02/2013 15:33:16 +0400 Sender: +7904xxxxxx Msg Center: Text: 51235  .' server_send=$(wget http://site.ru/serv_mobile.php?text="$sms_test" -O /dev/null) #     /   sleep 1 gnokii --deletesms IN 1 1 #   1  fi sleep 3 done ############################### ######### Mobile extention ############################### sleep 500 else #  ,   - echo "i need to do something!" let different=$test_trigger_now-$test_trigger #(-),   #echo $different #   get_sender=$(wget http://site.ru/trigger.php?diff=$different --quiet -O -) #         (  ) #echo $get_sender #      different  echo $get_sender #    sleep 3 #    #Start SMS-sending n=0 while [ $n -lt $different ] #  n &lt; different do let n=$n+1 #!!!!!!!!!!!SENDING!!!!!!!!!!!!!! echo "send files from send$n folder" #   gnokii mess_for_gnok=$(wget http://site.ru/send$n/message.txt --quiet -O -) #  numb_for_gnok=$(wget http://site.ru/send$n/numbers.txt) #  cat numbers.txt | while read line do inp=$line echo "$mess_for_gnok" | gnokii --sendsms $inp echo $line echo $mess_for_gnok sleep 2 done rm numbers.txt #delete temporary files sleep 1 #!!!!!!!!!!!SENDING!!!!!!!!!!!!!! done terminator=$(wget http://site.ru/terminate.php?kill=$different --quiet -O -) # delete all temperal folders in root #echo "i kill all files" test_trigger=$test_trigger_now # ,       trigger.txt echo $test_trigger&gt;cache_test_trig.txt sleep 10 #    fi else echo "Here is no Internet. Find it!" sleep 500 fi done</span></span></code> </pre> <br><br>  In addition, in the folder with the script you need to create a file cache_test_trig.txt with a value of 1 (and make the first entry in the on_demand table) <br><br><h5>  Organization of php scripts on remote hosting. </h5><br>  The following form should be in the joomla user account: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">isNotMax</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">e</span></span></span></span><span class="javascript"><span class="hljs-function">)</span></span></span><span class="javascript">{ e = e || </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.event;</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> target = e.target || e.srcElement;</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> code=e.keyCode?e.keyCode:(e.which?e.which:e.charCode)</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">switch</span></span></span><span class="javascript">(code){</span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">case13</span></span></span><span class="javascript">:case8:case9:case46:case37:case38:case39:case40:returntrue;}</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">return</span></span></span><span class="javascript"> target.value.length &lt;= target.getAttribute(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'maxlength'</span></span></span><span class="javascript">);} </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span> -.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">strong</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://site.ru/handler.php"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"POST"</span></span></span><span class="hljs-tag">&gt;</span></span>  :<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Group"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"11"</span></span></span><span class="hljs-tag">&gt;</span></span> 11 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Course"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4"</span></span></span><span class="hljs-tag">&gt;</span></span> 4 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Facult"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">option</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">select</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"color:#B4B4B4; border:thin groove"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>      <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>70<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>  (/,  )<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"color:#B4B4B4; border:thin groove"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span>  :<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textarea</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"message"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rows</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cols</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"46"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">maxlength</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"70"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onkeypress</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"return isNotMax(event)"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textarea</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" !"</span></span></span><span class="hljs-tag"> /&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Obviously, the data from the form is transferred to a file located in the root directory of the hosting handler.php <br><br>  Here is its listing: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $prev_page = $_SERVER[<span class="hljs-string"><span class="hljs-string">'HTTP_REFERER'</span></span>]; $who_is_you = substr_count(<span class="hljs-string"><span class="hljs-string">"$prev_page"</span></span>, <span class="hljs-string"><span class="hljs-string">"http://site.ru/index.php/"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//       if ($who_is_you == 1) { $message=$_POST['message']; $message=htmlspecialchars(stripslashes($message)); //    $course=$_POST['Course']; $course=htmlspecialchars(stripslashes($course)); //    $groups=$_POST['Group']; $groups=htmlspecialchars(stripslashes($groups)); //    $facult=$_POST['Facult']; $facult=htmlspecialchars(stripslashes($facult)); //    //validation----------------------------- if (empty($message)) { echo " &lt;body style='background-image: url(body_bg.gif); background-repeat: repeat-x'&gt; &lt;div align='center' style='margin-top: 14%'&gt; &lt;p style='color: #666666; font-family: Verdana,Helvetica,sans-serif; font-size: 18px; line-height: 1.8em;'&gt;&lt;i&gt;   !&lt;/i&gt; &lt;br&gt;   . &lt;a href = '$prev_page'&gt;    .&lt;/a&gt; &lt;/p&gt; &lt;/div&gt; &lt;/body&gt; "; } //validation----------------------------- else { //connect_to_BD-------------------------- include(db_connect.php); //connect_to_BD-------------------------- mysql_query("SET NAMES 'utf8'"); $r = mysql_query("SELECT id_this_trans FROM on_demand ORDER BY id_this_trans DESC LIMIT 0, 1"); //     while($row = mysql_fetch_array($r)) { $last_tranzaktion = $row['id_this_trans']; } $last_tranzaktion++; //  id   $heutige_datum = date("Ymd H:i:s"); mysql_query ("INSERT INTO on_demand VALUES('$message','$groups','$course','$last_tranzaktion', '$heutige_datum')"); //     file_put_contents("trigger.txt", $last_tranzaktion); echo " &lt;body style='background-image: url(body_bg.gif); background-repeat: repeat-x'&gt; &lt;div align='center' style='margin-top: 14%'&gt; &lt;p style='color: #666666; font-family: Verdana,Helvetica,sans-serif; font-size: 18px; line-height: 1.8em;'&gt;&lt;i&gt;    !&lt;/i&gt; &lt;br&gt;      ,  &lt;a href = 'http://site.ru/'&gt;    &lt;/a&gt; &lt;/p&gt; &lt;/div&gt; &lt;/body&gt; "; } } else { echo " &lt;html&gt; &lt;head&gt;&lt;title&gt; 404 Not Found &lt;/title&gt;&lt;/head&gt; &lt;body&gt;&lt;h1&gt; 404 Not Found &lt;/h1&gt; The resource requested could not be found on this server!&lt;hr /&gt; Powered By &lt;a href='http://www.litespeedtech.com'&gt;LiteSpeed Web Server&lt;/a&gt;&lt;br /&gt; &lt;font face='Verdana, Arial, Helvetica' size=-1&gt;LiteSpeed Technologies is not responsible for administration and contents of this web site!&lt;/font&gt;&lt;/body&gt;&lt;/html&gt; "; } </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br><br>  Further, in order for the remote hosting to respond to requests from the shell script, it is necessary that the following files be located in its root directory: <br><br><h5>  file serv_mobile.php - is responsible for processing messages <b>received by a</b> mobile phone </h5><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">#$sms_text=mysql_real_escape_string($_GET['text']); //      +    $sms_text=$_GET['text']; //      +    file_put_contents("temp_mobile_mess.txt", $sms_text); //      $get_from_file = file_get_contents("temp_mobile_mess.txt"); //     $number = substr("$get_from_file", 72, 11); //   (   read/unread) $pass = substr("$get_from_file", 103, 5); //  $message = substr("$get_from_file", 109); //   //connect_to_BD-------------------------- include(db_connect.php); //connect_to_BD-------------------------- mysql_query("SET NAMES 'utf8'"); //   $number = mysql_real_escape_string($number); $pass = mysql_real_escape_string($pass); $message = mysql_real_escape_string($message); //   $r = mysql_query("SELECT COUNT(*) FROM `starosti` WHERE pass='$pass' AND number='$number'"); //   /   while($row = mysql_fetch_array($r)) { if($row[0] == 1) //,     { //------------   id_this_trans--------------- $q = mysql_query("SELECT id_this_trans FROM on_demand ORDER BY id_this_trans DESC LIMIT 0, 1"); //     while($rowq = mysql_fetch_array($q)) { $last_tranzaktion = $rowq['id_this_trans']; } $last_tranzaktion++; //  id   //------------   id_this_trans--------------- //------------      on_demand---- $second_r = mysql_query("SELECT * FROM `starosti` WHERE pass='$pass' AND number='$number'"); //    ,   while($second_row = mysql_fetch_array($second_r)) { $groups = $second_row['group']; $course = $second_row['course']; $heutige_datum = date("Ymd H:i:s"); mysql_query ("INSERT INTO on_demand VALUES('$message','$groups','$course','$last_tranzaktion','$heutige_datum')"); //     } //------------      on_demand---- #        file_put_contents("trigger.txt", $last_tranzaktion); } } ?&gt;</span></span></code> </pre><br><br><h5>  The script trigger.php, also in the root directory, creates folders on the hosting, containing a file with a message and a file with numbers to which this message will be sent. </h5><br>  His listing: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $inp_diff = $_GET[<span class="hljs-string"><span class="hljs-string">'diff'</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//     //connect_to_BD-------------------------- include(db_connect.php); //connect_to_BD-------------------------- mysql_query("SET NAMES 'utf8'"); //Create files AND Folders--------------- for($i=1; $i&lt;=$inp_diff;$i++) { mkdir("send$i"); file_put_contents("send$i/message.txt",''); file_put_contents("send$i/numbers.txt",''); } //Create files AND Folders--------------- $counter=1;//     ,     //    ----- $r = mysql_query("SELECT * FROM on_demand ORDER BY id_this_trans DESC LIMIT 0, $inp_diff"); //    while($row = mysql_fetch_array($r)) { file_put_contents("send$counter/message.txt",$row['message']); //   message.txt    //   numbers.txt    $help_course = $row['course']; $help_group = $row['group']; $second_r = mysql_query("SELECT * FROM telephones WHERE course='$help_course' AND groups='$help_group'"); while($second_row = mysql_fetch_array($second_r)) { $insert_number = $second_row['number']; //     1   1  $fp=fopen("send$counter/numbers.txt","a"); fputs($fp,$insert_number. "\n"); fclose($fp); } //   numbers.txt    $counter++; } //    ----- echo "ok"; </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br><br><h5>  The last file in the root directory is the terminate.php file.  Removes previously created folders from the server when messages have already been sent. </h5><br>  His listing: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $inp_diff = $_GET[<span class="hljs-string"><span class="hljs-string">'kill'</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//     //Delete files AND Folders--------------- for($i=1; $i&lt;=$inp_diff;$i++) { unlink("send$i/message.txt"); unlink("send$i/numbers.txt"); rmdir("send$i"); } //Delete files AND Folders--------------- </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br><br><h4>  Summarizing. </h4><br>  Please forgive me if my story turned out to be unnecessarily muddled.  I really tried to put my thoughts on as consistently as possible here :) Successful to you setting, I will gladly answer questions in the comments. <br><br>  By the way, this is what it looks like with me: <br><br><img src="https://habrastorage.org/storage2/913/958/ff1/913958ff18e0292943f497e30467ed87.jpg"></div><p>Source: <a href="https://habr.com/ru/post/170901/">https://habr.com/ru/post/170901/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../170887/index.html">Canadian startup Coinkite Cryptobank from Toronto presents offline payment service for cryptocurrency</a></li>
<li><a href="../170889/index.html">Airspace app store from Leap Motion announced</a></li>
<li><a href="../170891/index.html">Toshiba Satellite U840W Ultrabook Video Review</a></li>
<li><a href="../170895/index.html">Networks for the smallest. Part Seven. VPN</a></li>
<li><a href="../170897/index.html">Runetology (187): Vladimir Gorbunov, founder of Workle.ru</a></li>
<li><a href="../170903/index.html">Monitoring HP EVA status from icinga / nagios. Plugin check_eva.py</a></li>
<li><a href="../170905/index.html">OPPO Finder X907 - Thin Facts</a></li>
<li><a href="../170907/index.html">Mobility is a guide to business change.</a></li>
<li><a href="../170909/index.html">Using OpenCV in Delphi</a></li>
<li><a href="../170911/index.html">New geolocation service Maptrix</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>