<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>C ++ SDK for Amazon Web Services</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the end of last year, Amazon released (finally!) The C ++ SDK for its AWS platform. It is not clear why they took so long to drag on - there are a ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>C ++ SDK for Amazon Web Services</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/609/2e8/ab6/6092e8ab6c5f4375a35c8910fe670126.png"><br>  At the end of last year, Amazon released (finally!) The <a href="https://aws.amazon.com/blogs/aws/introducing-the-aws-sdk-for-c/">C ++ SDK</a> for its AWS platform.  It is not clear why they took so long to drag on - there are a lot of applications written in C ++, of which we have long wanted to use AWS conveniently.  Not a single java, in fact. <br><br>  It is always interesting to look at something written in C ++ nowadays from scratch, without the burden of backward compatibility and strange architectural solutions inherent in some of the developments of the past.  I will not retell the documentation here, but I will focus on the key points that determine the entire behavior of the SDK. <br><a name="habracut"></a><br><h4>  C ++ 11 </h4><br>  As Carthage should have been <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D0%25B0%25D1%2580%25D1%2584%25D0%25B0%25D0%25B3%25D0%25B5%25D0%25BD_%25D0%25B4%25D0%25BE%25D0%25BB%25D0%25B6%25D0%25B5%25D0%25BD_%25D0%25B1%25D1%258B%25D1%2582%25D1%258C_%25D1%2580%25D0%25B0%25D0%25B7%25D1%2580%25D1%2583%25D1%2588%25D0%25B5%25D0%25BD">destroyed</a> in its time, today all libraries and applications that have not yet switched to C ++ 11 should die.  They simply have no place in the modern world.  With tears in my eyes, I read posts <a href="https://habrahabr.ru/company/abbyy/blog/277261/">like this</a> about libraries, which ‚Äúin order to expand the audience, they try to do without C ++ 11.‚Äù  As for me, this decision is somewhere around ‚Äúwe will ride horses, because they are accustomed to cars.‚Äù  Amazon‚Äôs new SDK doesn‚Äôt pursue retrogrades - all C ++ 11 features are offered out of the box: auto, smart pointers, lambdas, etc.  To give the opportunity to specify a lambda in the form of a callback function is vital, without this even Javascript will laugh us.  Well, no new \ delete explicitly, of course.  Beauty! <br><br><h4>  Code simplicity </h4><br>  As a result of the previous item, look only at the code that is obtained as a result.  Put a key-value pair in DynamoDB: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="cpp hljs">DynamoDBClient client; AttributeValue haskKeyAttribute; hashKeyAttribute.SetS(<span class="hljs-string"><span class="hljs-string">"SampleHashKeyValue"</span></span>) AttributeValue valueAttribute; valueAttribute.SetS(<span class="hljs-string"><span class="hljs-string">"SampleValue"</span></span>) PutItemRequest putItemRequest; putItemRequest.WithTableName(<span class="hljs-string"><span class="hljs-string">"TestTableName"</span></span>).AddItem(<span class="hljs-string"><span class="hljs-string">"HashKey"</span></span>, hashKeyAttribute).AddItem(<span class="hljs-string"><span class="hljs-string">"Value"</span></span>, valueAttribute); client.PutItem(putItemRequest);</code> </pre> <br><br>  Well, tell me, lovers of expressions like ‚ÄúC ++ is too complex and redundant‚Äù - why is this worse than Java or Python?  And the memory will eat less and run faster. <br><br><h4>  No extra dependencies </h4><br>  The guys from Amazon understand that every extra dependency creates additional complexity when connecting and building a project, and therefore reduces the number of users.  Therefore, AWS C ++ SDK does not depend on boost or on other fundamental frameworks.  Even small libraries, like logging, are not in it.  The only dependency is the HTTP client.  Still, stuffing your own implementation of this business into the SDK would be too much.  Out of the box, you can choose to bind to system CURL, WinHTTP, WinInet, or the ability to implement your own implementation. <br><br><h4>  CMake </h4><br>  World C ++ is moving towards standardization of project descriptions in a small way.  CMake may still not be completely defeated yet, but for those who need to be given the opportunity to build under the widest possible set of platforms and compilers, this option comes to mind first.  Amazon has not distinguished itself here either - everything is in CMake and compile for yourself on anything.  It is very convenient to work in CLion. <br><br><h4>  Dependency Injection </h4><br>  Dependency injection as the basis for application configuration.  We have the ability to use default implementations from Amazon or, instead, our own literally for everything: http-client, logging, authorization, memory allocator, strategies for speed limiting and retry, handler for asychronic events, etc.  As a result, each of these components is small, testable and does not cause problems with integration. <br><br><h4>  Logging </h4><br>  There are no libraries for logging in dependencies.  If you want to receive logs - implement a specific interface and transfer it to the config when the client is initialized.  You will receive callback calls with the text of logs - and write them where you want.  The default implementation writes everything to the logs in the current folder and deletes the old logs every hour. <br><br><h4>  Synchronous and asynchronous versions of all operations </h4><br>  Amazon understands that the application architecture is different and therefore all operations are presented in both synchronous and asynchronous versions.  In the synchronous version, you are waiting for the end of the operation (perhaps you are waiting for a long time, for example, if you are loading a large file), and after that check what the function returned: <br><br><pre> <code class="cpp hljs">CreateTableOutcome createTableOutcome = dynamoDbClient-&gt;CreateTable(createTableRequest); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (createTableOutcome.IsSuccess()) { ... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ... }</code> </pre><br><br>  In the asynchronous version, you specify the callback function that will be called at the end of the operation.  The callback function will transfer the data of the request, the response plus some context that you can define before the call in order to understand what the call is and how to handle its result. <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">putItemFinished</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> DynamoDBClient *client, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> PutItemRequest&amp; request, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> PutItemOutcome&amp; outcome, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">shared_ptr</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;AsyncContext&gt;&amp; context)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (outcome.IsSuccess()) { SEND_QUEUE.erase(context-&gt;GetUUID()); } } <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> context = Aws::MakeShared&lt;AsyncContext&gt;(<span class="hljs-string"><span class="hljs-string">"Hello!"</span></span>); context.SetUUID(<span class="hljs-string"><span class="hljs-string">"UniqueRequestKey"</span></span>); SEND_QUEUE[<span class="hljs-string"><span class="hljs-string">"UniqueRequestKey"</span></span>] = putItemRequest; client.PutItemAsync(putItemRequest, &amp;putItemFinished, context);</code> </pre><br><br>  Again, the glory of C ++ 11: as a callback, you can pass not only a function, but also a class method of some object (via std :: bind) or lambda. <br><br><h4>  Asynchronous executor support </h4><br>  If you like asynchronous operations and you already have some background-thread pool, asynchronous operations execution class, you can use it to run AWS C ++ SDK operations.  Thus, all asynchronous operations in your application will be executed according to one scheme and you will save resources on the background threads that the SDK would otherwise run. <br><br><h4>  Speed ‚Äã‚ÄãLimit </h4><br>  If you need to limit the data transfer rate for some operations - all in your power.  Implement the RateLimiter interface, transfer your implementation to the config when initialized - and get full control of the data transfer band. <br><br><h4>  No exceptions </h4><br>  The question of using or not using exceptions is a long-standing holivar in the C ++ world.  But in an increasing number of examples in recent times, exceptions are being avoided.  There are no exceptions in AWS C ++ SDK either.  Argued by greater flexibility and performance.  I need an error code - check the outcome.IsSuccess (), if there is false - the outcome will also contain additional data about the error.  I do not know about you, but I like this approach. <br><br><h4>  Included default retry strategy </h4><br>  Since any Amazon SDK is first and foremost a story about network operations, you need to understand that network operations often end in errors.  Somewhere, Wi-Fi let down, somewhere a mobile network, and somewhere it seemed to be a stable terrestrial channel for some reason refused to download a funny three-byte byte file.  AWS C ++ SDK by default tries to repeat the operation that ended in error.  The details of the algorithm (the number of retry attempts, the time between attempts) can be controlled by your own implementation of the retry strategy. <br><br><h4>  Ability to determine memory allocators </h4><br>  If it matters to you how much memory your application uses, when it allocates it and when it deletes, how quickly it happens (and for you all this should be interesting, why else would you write in C ++?) - you can define your own allocator of memory.  To do this, you need to inherit from MemorySystemInterface and define several methods.  You can try to pull a good allocator from somewhere, sharpen it to fit your data volumes and algorithms and get a good performance boost. <br><br><h4>  Github </h4><br>  Everything lives on <a href="https://github.com/awslabs/aws-sdk-cpp">GitHub</a> , Issues, Pull Requests are accepted.  Contact with the community is good. <br><br>  Good luck with AWS from C ++ apps! </div><p>Source: <a href="https://habr.com/ru/post/277711/">https://habr.com/ru/post/277711/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277697/index.html">The digest of interesting materials from the world of web development and IT for the last week? 199 (February 15 - 21, 2016)</a></li>
<li><a href="../277699/index.html">Understanding Docker</a></li>
<li><a href="../277703/index.html">Leona Philpot - ‚Äúunderwater‚Äù way to cool Microsoft data center</a></li>
<li><a href="../277705/index.html">Library development for iOS / Android on Golang</a></li>
<li><a href="../277707/index.html">10 habits of content developer.js</a></li>
<li><a href="../277713/index.html">Preparing for the CISA exam. Business Continuity Definitions</a></li>
<li><a href="../277715/index.html">D std.ndslice as a replacement for Python Numpy</a></li>
<li><a href="../277717/index.html">LLVM: do-it-yourself compiler. Introduction</a></li>
<li><a href="../277721/index.html">Mesh router is easy</a></li>
<li><a href="../277723/index.html">Asymmetric solutions. ICS Information Security in Energy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>