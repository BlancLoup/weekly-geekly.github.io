<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to hack telecom providers: analysis of a real attack</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Image: Kevin Spencer | Flickr 

 Very often, cybercriminals use common mechanics for hacking, as well as weaknesses in the protection and vulnerabilit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to hack telecom providers: analysis of a real attack</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/pt/blog/323292/"><img src="https://habrastorage.org/files/a91/c18/abe/a91c18abea1a4601a48f0dff59c133f2.png"></a> <br><br>  <i>Image: Kevin Spencer |</i>  <i><a href="https://www.flickr.com/photos/vek/">Flickr</a></i> <br><br>  Very often, cybercriminals use common mechanics for hacking, as well as weaknesses in the protection and vulnerability of IT systems.  This thesis is confirmed by the example of one of the investigations into the attack on a telecommunications company from Eastern Europe - we will tell you more about it today. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  The first stage of the attack: breaking the perimeter </h2><br>  As a rule, attacks on corporate infrastructure take place in two stages: first, the attacker hacks the network perimeter resources from the Internet, and then, once inside the internal network, it is fixed in the infrastructure and gains access to critical information and systems. <br><br>  In this case, the attacker was able to identify publicly available services of the company and discovered a vulnerability in one of them - this was helped by the use of the Acunetix automated vulnerability scanner. <br><br><img src="https://habrastorage.org/files/f37/dd0/422/f37dd04229a744cbb628633c2936ef22.png"><br><br>  At the same time, the hacker practically did not hide his actions - when analyzing the incident, an abnormal increase in the number of requests was detected in the logs of the web server.  But even such careless actions were not revealed by representatives of the company - the attack developed over the course of several months.  There were a lot of suspicious activity records in the event logs, but nobody even analyzed them from time to time. <br><br><img src="https://habrastorage.org/files/091/799/4e7/0917994e794341d0b90f12035bc38f80.png"><br><br>  <i>Web Server Error Logs</i> <br><br>  As a result of the scan, the attacker was able to find in a web application of the company a critical vulnerability, ‚Äúthe introduction of SQL statements.‚Äù  Having exploited it, the hacker received not only root access to the database with accounts of all users, including administrators, but also the ability to execute commands on the server with DBMS privileges. <br><br>  The attacked server was connected to the internal network, which opened access to its other resources.  Network interaction during the attack was carried out via an ICMP tunnel ‚Äî data was transferred to an external dedicated server leased in the United States.  During the investigation, it turned out that the attacker had compromised only three web servers, having obtained access to them with local administrator rights ‚Äî these machines became the entry points to the organization‚Äôs internal network. <br><br><h2>  The second stage: the development of attacks in the internal network </h2><br>  Having penetrated into the internal network, the attacker began to search for targets for the development of the attack - using the nmap network scanner, he was able to detect open connection interfaces for network services (TCP and UDP) on active nodes, identify software versions used for banners, and identify potentially vulnerable services.  In parallel, he was engaged in the search for web applications and manual analysis of the company's resources. <br><br>  Terminal servers were selected as the next target, providing users with resources for various tasks.  Due to insufficient isolation of user sessions, the compromise of one account could lead to the compromise of accounts of other terminal server users.  Because of the use of dictionary passwords for local administrator accounts, the attacker easily gained privileged access to several terminal servers at once and downloaded the contents of the databases hosted on them. <br><br>  In addition, the privileges obtained on one of the servers allowed creating a memory dump of the lsass process - it corresponds to a service that is part of Windows and is responsible for authenticating local users of the computer.  From the memory dump using the common mimikatz utility, a lot of credentials (including open passwords) of users authenticated on this server, including privileged ones, were extracted.  Among the data obtained were service accounts to support terminal servers, as well as various domain accounts. <br><br>  The privilege level obtained by the attacker allowed the attack to be easily developed using the credentials of legitimate users.  In just one month, he managed to compromise a multitude of resources.  For example, during the attack, information was obtained about the identifiers and password hashes of users of the Windows operating system (SAM database), configuration and addressing data of the network, information about user accounts, cryptographic keys of base stations, and other information. <br><br>  Next, the attack developed in the direction of several servers running an outdated version of Windows - they were based on databases and LSI resources.  To obtain anonymous access with system privileges to these servers, the attacker took advantage of the critical vulnerability MS08-067, details of which were published back in 2008, at the same time a public exploit was published.  The servers were completely compromised, and the contents of the databases were stolen. <br><br><img src="https://habrastorage.org/files/173/93b/c2f/17393bc2f41443768eb08fc355e6e179.png"><br><br><h2>  Investigation </h2><br>  The incident was revealed when the attack had already been developing for a long time - the company's specialists noticed numerous attempts to select SSH credentials for internal nodes from compromised DBMS services registered on weekends.  At the first stage of the investigation, they identified the compromised resources on their own, and then involved specialists from Positive Technologies.  The investigation revealed that by this time the attacker had access to the internal nodes of the corporate network for 5 months already. <br><br>  Emergency measures, which included changing passwords for compromised accounts, as well as turning off or isolating compromised infrastructure, made it possible to stop the development of the attack.  At the same time, it continued until all the identified channels of interaction between the intruder and sites on the Internet, from which the attack was conducted, were not blocked.  However, all this does not exclude the fact that an attacker may have an alternative way of accessing the network. <br><br><h2>  How could problems be avoided </h2><br>  The attack affected key divisions of the organization, with a high probability that the interests and data of the organization‚Äôs clients were affected.  But with all this, the attack could have been easily prevented if the protection of corporate resources were at a higher level. <br><br>  For example, if centralized monitoring was implemented by the affected organization using the <a href="https://www.ptsecurity.com/ru-ru/products/mpsiem/">Security Event Correlation and Consolidation System (SIEM) system</a> , the security service would receive timely notification of events related to the launch of the attack and be able to take the necessary measures to prevent the incident. <br><br>  Reflecting the attack even at the stage of an attacker's hacking to search for vulnerabilities could be a firewall application level (WAF) - for example, <a href="https://www.ptsecurity.com/ru-ru/products/af/">PT AF</a> .  Such a tool allows you to block hacking attempts and identify chains of development of real attacks, transfer information about the events to the SIEM to notify security personnel and the subsequent rapid response. <br><br>  The risks of such incidents can be minimized by introducing well-known information security measures, including analyzing the security of web applications and eliminating found vulnerabilities, introducing a strict password policy, applying current OS versions, as well as network segmentation and strict access control. <br><br><blockquote>  <b>The full report on the results of the investigation of the described incident is available at:</b> <a href="https://www.ptsecurity.com/upload/corporate/ru-ru/analytics/Telecom-Incident-Investigation-rus.pdf">www.ptsecurity.com/upload/corporate/ru-ru/analytics/Telecom-Incident-Investigation-rus.pdf</a> </blockquote></div><p>Source: <a href="https://habr.com/ru/post/323292/">https://habr.com/ru/post/323292/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../323280/index.html">The work of the writer in video games</a></li>
<li><a href="../323284/index.html">Release of 3CX V15 SP5 and client updates for macOS and iOS</a></li>
<li><a href="../323286/index.html">IBM will add deep learning for mainframes</a></li>
<li><a href="../323288/index.html">Ransomware Development Projections for 2017</a></li>
<li><a href="../323290/index.html">Overview uniset2-testsuite - a small bike for functional testing</a></li>
<li><a href="../323294/index.html">Testing problems: why 100% code coverage is bad</a></li>
<li><a href="../323296/index.html">We connect VKontakte SDK for Xamarin.Forms</a></li>
<li><a href="../323298/index.html">Windows Server 2016 and Hyper-V Integration Services</a></li>
<li><a href="../323300/index.html">The Turing Competition for Student Theory. computer science and discrete mathematics</a></li>
<li><a href="../323302/index.html">Encryption algorithm based on elementary cellular automata</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>