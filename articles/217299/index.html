<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Remote controller for PC server with text console, no soldering iron and Arduino</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="annotation 
 Although one of the heroes of the second plan is the infrared port on the motherboard, I will not tell you about the TV remotes and how t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Remote controller for PC server with text console, no soldering iron and Arduino</h1><div class="post__text post__text-html js-mediator-article"><h4>  annotation </h4><br>  Although one of the heroes of the second plan is the infrared port on the motherboard, I will not tell you about the TV remotes and how they switch tracks in your favorite media player.  In the continuation of the story about the <a href="http://habrahabr.ru/post/214707/">FreeNAS server</a> , built of old iron, I will tell you how to provide it with an equally simple onboard controller with a serial port (console) over IP (Serial-over-LAN), remote reset (RESET) and controlled power.  The question is: why?  After all, * nix and so unpretentious in remote control: turned on the same SSH and manage your health.  But what about the accident?  Starting operating system failure?  What if you need to press RESET?  To upgrade the system?  Or run fsck in single user?  Or restore the <s>sawed bitch</s> misconfigured firewall?  Do not go to the site every time, connect a monitor, keyboard and hang around the office at night for maintenance ... or make your eyes look like an angry Business day. <br><br><h4>  Another NAS do-it-yourself, part 4: the ghost of Chernobyl </h4><br>  I have long realized that laziness is the main engine of human progress.  Probably the most elegant forms of laziness are found in the most progressive field: the sphere of information technology, where laziness is already part of the profession.  We are implementing complex helpdesk-regulations in order not to install the necessary programs for users.  We have been debugging the script for two days in order to save ourselves half an hour later.  This is what we manage the desktop in the next room, using a server in the neighboring continent.  That we have come up with a moratorium on work, to rest even a week before the New Year.  Who is there waiting for the elevator in the evening rush hour, in order to decorously descend it from the second floor to the first floor?  Business condescendingly calls us IT specialists, but we proudly magnify ourselves as IT Engineers ... <br><br>  This suggests a device, often referred to as an off-band (baseboard) management controller, or a stand-alone on-board remote control controller.  This is such a <s>silver</s> silvered bullet that reduces excessive loads on the sacred sysadminsky ass.  In terms of its functions, our product is close to <a href="http://ru.wikipedia.org/wiki/Intelligent_Platform_Management_Interface">IPMI,</a> after a deduction, and real server products like <a href="http://ru.wikipedia.org/wiki/Integrated_Lights-Out">iLO</a> or <a href="http://www.wikipedia.org/wiki/Dell_DRAC">DRAC</a> are far from here.  Yes, it is better to buy a ready-made controller for half the cost of an old computer (or a server platform for a fivefold cost) if the importance of data and the associated risks require it.  I assembled a working device a little more expensive than $ 70, which by the time the post was published had already managed to help me out several times, which I wish everyone. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Using an old Linux server PC at home or in the office?  No one to press RESET?  Not enough money for a server platform?  Perhaps you will learn new ways to simplify your life.  We almost will not program, a soldering iron and a Chorus of Druids will not be needed, but let us recall the merry 90s.  Microelectronics is easy! <br><br><a name="habracut"></a><br><h4>  DISCLAIMER </h4><br>  The information is provided by AS-IS without any liability for its use by anyone, anywhere and ever.  All inadvertently mentioned trademarks are the property of their respective owners.  Some of them do not need advertising so much that I make them funny names. <br><br><h4>  Technical requirements </h4><br>  So, in the <a href="http://habrahabr.ru/post/214707/">first part</a> we collected the NAS server from <s>trash and</s> old iron <s>sticks</s> , in the <a href="http://habrahabr.ru/post/214803/">second part we</a> picked up the flash memory for the OS loader, and in the <a href="http://habrahabr.ru/post/218387/">third part we</a> practically shoved dozens of spindle disks into the usual ‚Äútower‚Äù without fear of starting them or overheating .  Go through the <i>server</i> checklist: <br><div class="spoiler">  <b class="spoiler_title">Serverhood Checklist</b> <div class="spoiler_text"><table><tbody><tr><td>  ECC memory motherboard </td><td>  Not budgeted </td></tr><tr><td>  SMP CPU architecture </td><td>  One core, but with HyperThreading </td></tr><tr><td>  Redundant power supply </td><td>  Not budgeted </td></tr><tr><td>  SAN and Fiber Channel technologies </td><td>  Joke of humor :) </td></tr><tr><td>  X * Disc Blown Case </td><td>  there is </td></tr><tr><td>  Disk array </td><td>  there is </td></tr><tr><td>  Specialized file system </td><td>  <s>ZFS</s> UFS (due to RAM) </td></tr><tr><td>  Health Monitoring and Telemetry </td><td>  there is </td></tr><tr><td>  Physical security </td><td>  No requirements </td></tr><tr><td>  Watchdog timer </td><td>  Not </td></tr><tr><td>  Server OS </td><td>  FreeNAS (embedded) </td></tr><tr><td>  Remote control platform </td><td>  <b>TBD **</b> </td></tr></tbody></table>  * X - Roman "ten" <br>  ** TBD - To Be Done (English: to do) </div></div><br>  Yes, our product is far from the Real Server ... And we recognize right away: the usual motherboard on the serial port in the BIOS will not let us in: <br><br>  <b><s>0. Remote BIOS Access</s></b> <br><br>  But this is a feature of the motherboard itself, and if it interferes too much, I recommend the reader to stop and look for either a solution in the form of a server platform (where the onboard remote controller should be embedded), or a PCI expansion card with KVM-over-IP (like <a href="http://www.raritan.de/eric-g4">eRIC G4</a> ) .  It will, of course, be more expensive.  In the meantime, we will continue to write requirements for our DIY solution. <br><br>  <b>1. Connect to the server serial port via TCP / IP</b> <br><br>  This is quite a typical problem solved by an ordinary RS232-Ethernet interface converter.  Literally the first thing that came to hand was the <a href="http://www.moxa.com/product/NE-4110S.htm">MOXA NE-4110S, which</a> cost about $ 50.  Meet the protagonist of our current story - a packageless, slightly brutal product: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f18/454/e49/f18454e49bbb9f1f1a6dc656640247f5.jpg"><br><br>  Of course, this is not the only option: there are converters produced under the trademarks WIZnet, TIBBO ( <b>UPD:</b> colleagues in the comments also recommend Lantronix).  And besides converters, I accidentally opened another type of device, and even devoted a spoiler to it later in the text (read, it's worth it ;-) <br>  So, ‚Äúmoha‚Äù I found it easier to order in the nearest store, and the brand is proven.  As it turned out, it works on the good old i80186 and seems to be using the BSD IP stack.  By the way, the NE-4110S has a programmable brother, its name is <a href="http://www.moxa.com/doc/manual/NE/4100/P_user_manaul/V1/NE-4100-P_Series_Users_Manual_v1.pdf">NE-4110S-P</a> , the <a href="http://www.moxa.com/doc/manual/NE/4100/SDK2P/v2/NESDK2P_2.pdf">Network Enabler SDK</a> is also available to it.  You <i>know</i> , the brother is half the price of a sister, it sells less frequently, and it still does not save you from writing the firmware.  Therefore, I did not order a ‚Äúbrother‚Äù.  And, cheers, one more childhood dream came true: ‚Äúto work on 80186‚Äù.  I always somehow lacked this missing link of evolution ... <br><br><div class="spoiler">  <b class="spoiler_title">Flashback from funny 90s</b> <div class="spoiler_text">  I found an IBM PS / 2 with an i8086, sculpted in an IBM PC / XT assembler with an i8088 (on that old monitor, in the intervals between pixels, you could probably stick a match).  I played on i80286 (and on both AT and XT; and what a juicy VGA graphics seemed then!). <br>  But the thought wondered for a long time: where the hell did the 186th go?  What kind of processor <i>is</i> this? <br>  At the time of <a href="http://en.wikipedia.org/wiki/FidoNet">FidoNet, there</a> was a US Robotics firm known for its Sportster and Courier modems.  They were like two brothers: the younger Sportster (for the home) and the older Courier (for the business), and both are built on i80186. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/753/b7a/36f/753b7a36f2691ea100bd2fb90c5616c0.jpg"><br>  The budget Sportster Soap Dish 14400, but it was lucky to accelerate more than 9,600;  was still green 28800 <br><br>  Since the x86 command system was widely known in certain circles, there were also orders of magicians-brooders who were able to turn the Sportster soap box into Courier, a bulldozer for the Russian off-road telephone, on the <a href="http://ru.wikipedia.org/wiki/HST">HST</a> tracked half-duplex protocol with their spells.  There was no Internet at that time, so it was possible to <abbr title="FREQ, File REQuest"><i>fret</i></abbr> even at half-duplex.  And how sounded HST!  Advanced users did not turn off the modem speaker in order to listen to the modulation noise and determine the quality of the connection using the <abbr title="Re-handshaking modems without breaking the link, often with a transition down or up on the speed scale"><i>retrains</i></abbr> .  But at HST it was just a symphony: one could almost physically feel how streams of bits dodge at full speed from the floating logs of the old Soviet PBX, as if guided by the skillful hand of an invisible captain.  As much as 16.8kbps, but believe me, then it was not bad at all. <br>  The bulldozer reworked from the ‚Äúsoap box‚Äù, however, was buggy, and was often obtained with one ‚Äútransfer‚Äù: either only ‚Äúforward‚Äù (to dial) or to receive a call, depending on the DNA of the ‚Äúsoap box‚Äù (this is how lucky).  And therefore, before the arrival of the Internet, all self-respecting <abbr title="before the advent of the Internet, perhaps the most advanced part of the IT community"><i>fidoshews</i></abbr> dreamed of getting a red-eyed telecommunication devil with a real Courier logo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/77d/579/e4a/77d579e4a985f9ac19510dde307caee6.jpg"><br>  The red-eyed telecommunication devil, the thunderstorm of all interference and the bulldozer of urban telephone networks <br><br>  But only a few lucky ones fell asleep under the automatic lines of the courier relay courier dialing.  The hardest to sleep was for those who had the <abbr title="The node (node) in the postal hierarchy FidoNet, obeyed the hubs and serviced points; the latter were generally considered plankton"><i>boss's</i></abbr> phone number containing zeroes, nines and other particularly long and harsh combinations.  Real ninjas, of course, were soldered to silent <abbr title="relay based on hermetic magnetic contact"><i>reed relays</i></abbr> , which they later remarked about in <abbr title="ehokonferentsiya, fidoshny ancestor of modern Internet forums"><i>echoes</i></abbr> , causing a burning envy of the owners of simple soap boxes.  And at the same time, everyone amicably dreamed that a new era would one day come, and our urban exchanges would also begin to understand tonal dialing, as in very distant and very happy countries ... <br>  Peers, we get a napkin and catch it with a mean tear ... Hello, 80186, have not seen each other for a long time. <br></div></div><br><br>  So, while the dish I ordered crossed the state borders, I found an interesting fact: it turns out that many interface converters supply up to a heap of digital I / O (GPIO or DIO).  Probably to manage something, is not it? <br><br><h4>  Do I Need a Druid Choir </h4><br>  The phrase "without Al Durillo" in some circles means something like a quality mark: they say, not <s>fuckers are</s> amateurs, some have gathered, but real electronic engineers.  Forgive me, dear readers, but then I made my choice not in spite of, but by simple ignorance, and therefore I propose to do without broken copies, holivars and other kapslok.  Having missed the successes of amateur microelectronics, under the influence of old reflexes, I simply rushed to look for an interface converter ... <br><div class="spoiler">  <b class="spoiler_title">Against programming MK</b> <div class="spoiler_text">  Have I done right by avoiding programming microcontrollers?  It seems to be a simple transfer of bytes back and forth, and all the work for five minutes, as one friend of mine said.  But if I had a quick look at the forums on the subject area, I had enough relief to imagine such an encoding of the IP server in an assembler.  I figured that I need at least two UART: one to the RS232 console, the second to a direct connection to the host (do not reset the same watchdog timer by IP!).  Then he began to count the number of UART on the MK, used in the popular models of Ai Drobino.  With <a href="http://www.atmel.com/devices/atmega162.aspx%3Ftab%3Dparameters">rare exceptions</a> , it turned out to be only one.  Therefore, we had to imagine pushing the bits into the wire using the popular scientific AVR method (bit bang, soft serial).  Continuing the thought experiment, I put it all in parallel with an imaginary IP server in assembly language ... Brr!  No, this is already some kind of long and spicy Asian dish for the whole family, and I asked for a light, dietary meal for one person. <br>  I do not impose my point of view, but there is a subjective feeling that interconnection is a very weak link in microcontrollers, sometimes aggravated by the lack of elementary information security skills of hardcore hardware workers (the code is very vulnerable).  Caesar - Caesar. </div></div><br><div class="spoiler">  <b class="spoiler_title">For programming MK</b> <div class="spoiler_text">  If it comes to that, personally it seems to me that the STM32 platform with its stuffed periphery seems more appropriate to me.  And once again I can not fail to mention in this regard the <a href="http://easyelectronics.ru/">EasyElectronics</a> project.  As you can imagine, Chelyabinsk electronics engineers are so severe that they start microcontrollers with their own fingers.  Do you doubt?  Read about the <a href="http://easyelectronics.ru/avr-uchebnyj-kurs-konfiguraciya-fuse-bit.html">FUSE and finger method</a> .  If these guys are given a soldering iron in their hands (or put in a senior engineering position in a respectable concern), I‚Äôm generally afraid to imagine the consequences for the global electronics industry ... <br>  There is a <a href="http://shop.easyelectronics.ru/index.php%3FcategoryID%3D102">debug board</a> for such Ambidextr microelectronics, with interchangeable AVR, STM32, PIC and FPGA mezzanines.  But I do not want to look at the card itself, but at the inconspicuous <a href="http://shop.easyelectronics.ru/index.php%3FproductID%3D157">LAN Ethernet Adapter</a> product <a href="http://shop.easyelectronics.ru/index.php%3FproductID%3D157">on the ENC28J60</a> .  The point is that on the back of the <i>LAN Ethernet Adapter is a</i> socket for the same AVR or STM32 mezzanine board.  On board, we get all the necessary strapping for the MK, USART legs from STM32 are also connected to the male connectors.  For the problem to be solved, it remains to screw the adapters from USART to RS232 and USB, supply the device with power.  Perhaps, for industrial needs, <a href="http://ru.wikipedia.org/wiki/POE">PoE</a> will not interfere, along with more heat-resistant performance and vibration protection, but that's another story ... <br>  It would seem that now almost finished product based on a programmable MC, but ... who will breathe life into it?  No one canceled the firmware, and this is still entertainment for the <i>mythical man-month</i> .  Nothing is impossible, but you go to a restaurant for lunch and not live a week or two, is not it?  Think while on the shore ... </div></div><br><br>  I will not mess with MK, I always have enough time to play enough.  Here, by the way, from the recent one: <a href="http://habrahabr.ru/post/208026">habrahabr.ru/post/208026</a> <br>  And under my kindly comic names the reader, of course, easily recognized the popular platform used by amateurs and professionals all over the world.  The market puts everything in its place ... <br><br>  So, with the Serial-over-LAN task, everything is clear, but let's add the first dish to our main technical requirements menu: <br><br>  <b>2. Remote server reset using the RESET line on the motherboard</b> <br><br>  Let's see what has already been done on this topic.  As soon as I saw the <a href="http://habrahabr.ru/post/147164/">post of a</a> noble don <a href="http://geektimes.ru/users/workdnk/" class="user_link">workDNK</a> , the baggage of knowledge obtained at the institute came to life and asked for a job.  Dear don, with good reason, put the optorele directly on the digital output of the MK, but I had bad luck with the ‚Äúmokha‚Äù.  Page  3-8 <a href="http://www.moxa.com/doc/man/NE-4100_Series_Users_Manual_v9.pdf">NE-4100 Users Manual</a> hints very unequivocally: <br><blockquote>  The output current for digital output channels is only 1 mA. </blockquote>  Those.  unlike the PIC18F1320-I / P, the digital port on the moss will not squeeze more than 1mA out of itself, and for reliable opening the optorele must be more than ten times.  From a distant nook of memory, there is suddenly a transistor switch (I was surprised, because the last time was fifteen years ago).  We throw a sketchy scheme right into the <a href="http://toster.ru/q/71632">toaster</a> standing next to the habr, and what do you think?  Almost immediately we get a couple of useful answers from the noble dons.  There was already a mean tear, probably, <a href="http://www.youtube.com/watch%3Fv%3DefPwChPPJXI">Mr. Gates</a> himself would have dropped (you would not think of anything like that, this is his famous speech about information at your fingertips). <br><br>  In theory, everything is quite simple, and I almost stopped at that;  but appetite, as you know, comes with eating. <br><br>  Is it possible to control the <i>switched off</i> PC?  Sure you may.  Moreover, we do it all the time, by pressing a large button on the PC case (for some it is small and not on the case, and not on the PC, but that's not the point).  Even the simplest ATX power supplies have a + 5VSB line, powering the motherboard in the STANDBY state (switch on, computer off; <b>UPD:</b> also called <i>standby power</i> ).  Turning on the PC from the keyboard is all from there.  By the way, in STANDBY on some motherboards you can even burn something by rearranging the memory bars, but this is not about that now.  Usually the power in the STANDBY mode is about 10W, but enough to power our controller, the tea is not a hadron collider.  Therefore, let‚Äôs add another salad and side dish: <br><br>  <b>3. Independent controller power in STANDBY mode</b> <br>  <b>4. Remotely power on and off the host using the PWR_BTN line</b> <br><br>  An attentive reader, of course, will argue on clause 4: what about the <a href="http://www.wikipedia.org/wiki/Wake-on-LAN">Wake-on-LAN</a> ?  And it will be absolutely right: indeed, even the most ordinary motherboard today allows the computer to wake up from hibernation with a special network package.  And, by the way, do not look for <i>ethtool</i> in FreeNAS, <a href="http://www.freebsd.org/cgi/man.cgi%3Fifconfig(8)">ifconfig (8)</a> serves there for these purposes.  All this is quite demanded and therefore well chewed, there are <a href="http://zyxel.ru/kb/3517">examples of settings</a> for popular home routers, <a href="http://linux.die.net/man/1/wol">a launcher utility for Linux</a> and much more.  Well, you can not order a side dish, I do not insist.  But I don‚Äôt intend to leave the reader without dessert. <br>  Today we have <s>apple jelly</s> green power indicator for sweets: <br><br>  <b>5. Remote monitoring of power on with full preservation of the functions of the visual indicator on the body</b> <br><br>  My server does not respond to ping ... Haha, check <s>if the power cord is</s> plugged in if the server is on.  Of course, I mean reading the status of the PWR_LED LED, although it is possible to read the + 5V line as well.  I like the idea with the LED that is good, since it is the most trusted witness and is adjacent to the rest of the ingredients on the motherboard.  What is the easiest way to replace the green LED in the circuit so that the computer does not notice anything?  Obviously, to another LED, built-in optorele, and the signal to the cabinet LED, just return back on the other line.  Further, I think, it is not necessary to explain, everything will be clear on the diagram. <br>  Our RESET and PWR_BTN buttons must be released for normal operation of the computer, but in theory it can either pierce the transistor or the enemy can send the wrong logical signal.  As a result, our controller will unauthorized close the optorele, and the buttons will turn out to be ‚Äúnormally pressed‚Äù, so to speak.  I want to protect myself from this without disassembling our hypothetical fee.  Also at the debugging stage, we want to visually monitor what is happening.  Therefore, do not forget about salt, pepper and other seasonings to our table: <br><br>  <b>6. Hardware blocking of control lines RESET and PWR_BTN</b> <br>  <b>7. Control LEDs on the RESET and PWR_BTN lines</b> <br>  <b>8. Duplicate LEDs on the LED_100M and LED_10M line</b> <br><br>  And compote?  <s>Morse from wild berries</s> red indicator of disk activity on the case still displays only two disk ports out of ten available, so we will find a more useful application for it: <br><br>  <b>9. Visual monitoring of controller readiness (READY_LED) on the PC case through the HDD_LED indicator</b> <br><br>  Those.  a lighted (red) indicator (disk activity) on the PC case will indicate that the controller is working (the PC switch is turned on, power is on).  The green PC indicator retains its function and glows only when the server is running.  If everything is completely bad, you can call the site and read the LED readings using the <s>biorobot of an</s> office manager or another employee. <br><br>  Here's what happened (forgive me, readers, some neglectful liberties): <br><div class="spoiler">  <b class="spoiler_title">Scheme</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/282/4cb/dd2/2824cbdd20ca369b56dcd24626a408d9.png"><br>  The electrical circuit of the onboard control controller;  if small, open the image separately </div></div><br><br><div class="spoiler">  <b class="spoiler_title">Comment for beginners electronics</b> <div class="spoiler_text">  Make sure the top spoiler with the circuit is open.  Go. <br>  <b>The core of the circuit: the</b> small square on the left in the middle is like a J2 MOXA NE-4110S connector, it all starts with it. <br>  <b>The limiting resistors</b> R4, R7, R8 for LEDs and R1, R2 for optorele are considered (you won‚Äôt believe it!) According to Ohm's law.  To open the optorele and light the LED (but do not burn to death!), We need a current of the order of 10mA.  We presume that the diode will drop from one and a half to two volts (we look at both the current and voltage in the characteristics of the devices).  Since the power bus gives 5V, on the resistor it is necessary to ‚Äúlose‚Äù 3V at a current of 10 mA, i.e.  You need a resistance of about 300 ohms.  Nothing complicated, and without <a href="http://www.casemods.ru/services/raschet_rezistora.html">calculators</a> .  Excuse me, but what happened to the limiting resistor for the opto-switch along the PWR_LED line?  There, where for the READY_LED (HDD_LED) indicator: they are both built into the circuits of our finished products, one on the motherboard, the other on the moss.  Without cheating. <br>  <b>Pull-up resistors</b> R3, R5, R6 (see <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D0%25B4%25D1%2582%25D1%258F%25D0%25B3%25D0%25B8%25D0%25B2%25D0%25B0%25D1%258E%25D1%2589%25D0%25B8%25D0%25B9_%25D1%2580%25D0%25B5%25D0%25B7%25D0%25B8%25D1%2581%25D1%2582%25D0%25BE%25D1%2580">wikipedia</a> ) 10 kOhm.  We will tighten up the logic levels so that they do not dangle in the air and do not catch interference from there. <br>  <b>Transistor keys</b> .  To solve the problem with the lack of control current (need 10mA, but there is only 1mA), put a pair of keys 2N7000.  Field-effect transistors are voltage-controlled devices: when moha gives a high level, the transistor gate opens, but it does not consume much current.  At the same time, the drain-source circuit closes, and electricity runs from the + 5V bus through the limiting resistor to ground, turning on the LED on the road, or opening the optorele.  A field device is a good device, only static electricity is scared to death in a literal sense. <br>  <b>Optorele</b> dual unidirectional, normally open.  This useful device allows you to close (or open in the normally closed case) electrical circuits, while isolating them from each other.  The control current is supplied according to the same laws as the LED through the limiting resistor.  Our relay is unidirectional: this means that the controlled (driven) current through it can be started strictly in one direction: the ‚Äúplus‚Äù must be connected to pin 6 or 8, otherwise the current will not go, the relay will seem to be closed.  Optorele is also afraid of electrostatics. <br>  As you can see, not a quantum theory at all. <br></div></div><br><br>  Well, let me remind you at the end that we are dealing with an embedded packageless product.  If it is not secured properly, if you carelessly pull the Ethernet cable, our controller will chatter in the PC case, <i>like pants in a washing machine</i> .  To prevent this, serve cutlery: <br><br>  <b>10. Ethernet port fixed on computer case</b> <br><br>  The task was solved as follows: <div class="spoiler">  <b class="spoiler_title">Why do we really need internal modems and 10 / 100BaseT adapters to the PCI bus</b> <div class="spoiler_text">  It turns out that there is an excellent use of old, unnecessary PCI cards with square connectors. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6d7/3d2/26a/6d73d226a87ffd56af417419a2224511.jpg"><br>        PCI <br><br>      ¬´¬ª,  ,    ,         :   ,           RJ-45  ¬´¬ª. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a75/668/77f/a7566877f5d93eabe0d28d0b814d3d3a.jpg"><br>    ‚Äî     <br><br>        PCI (),       PCI (   10  100 ,  1000  ).    , ,   ,    . </div></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> So, your order is accepted, prepare meals and proceed to food! </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Another interesting remote access solution.</font></font></b> <div class="spoiler_text">   ,     <a href="http://www.tp-link.com/lk/products/details/%3Fmodel%3DTL-MR3020">TP-LINK MR3020</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ca8/b4c/f33/ca8b4cf33ba2d96103867a95f68bc02c.jpg"><br><br> ,   ,                 ,        .      Atheros AR7240@400MHz, 4 -,  32,   (    <u></u> ) <b>   GPIO</b> .     USB-, Ethernet  WiFi (,   ). ,         $25: <a href="http://wiki.openwrt.org/toh/tp-link/tl-mr3020">http://wiki.openwrt.org/toh/tp-link/tl-mr3020</a> . , USB-   microSD (    <a href="http://habrahabr.ru/post/214803/">  -</a>    Linux,    ). <br>  ,    -    ,     +5VSB     (:  TTL-,  RS232  ,   USB ‚Äî     ).    ,   ‚Äî    ,   ¬´¬ª    ‚Ä¶ <br> <b>UPD:</b>     <a href="http://habrahabr.ru/post/151982/">habrahabr.ru/post/151982</a> <br></div></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In order not to get involved with aggressive media, a soldering iron and his friend with an iron (these are no longer heroes from the 90s, they are doing this at home now), but I tried everything on real hardware and decided to assemble my simple product on a solderless breadboard ( breadboard). </font><font style="vertical-align: inherit;">By the way, a very practical thing, especially for those who are on "you" with a soldering iron. </font><font style="vertical-align: inherit;">As for self-made model jumpers, I respect the professionals, but I do not like all these ‚Äúexplosions on the telephone switchboard‚Äù, so I bought a beautiful brand set of different-sized jumpers.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Heartbreaking scene</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/fa3/131/0b1/fa31310b17541c16d0d5799ebafba95e.jpg"><br>   : <a href="http://www.rfcafe.com/references/electrical/bob-pease-breadboard.htm">www.rfcafe.com/references/electrical/bob-pease-breadboard.htm</a> </div></div><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Depressant</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/9b6/de7/954/9b6de79546a5e2ee54b51edcee8f156f.jpg"><br>  ¬´ ¬ª    </div></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Although the jumpers and cost money, but you can sit for hours and stick them in the breadboard so and that, choosing the optimal length. </font><font style="vertical-align: inherit;">This is such a special therapy for stress-tormented workers of the information shop, it calms no worse than gluing ships with airplanes: there is neither white-orange, nor white-green, nor white-blue, nor white-brown, everything is specially monotonous. </font><font style="vertical-align: inherit;">More stress-resistant colleagues can, of course, cut jumpers from a single twisted pair, the section is suitable. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In general, I recommend a beginner to read a bestseller: </font></font><a href="http://habrahabr.ru/post/148656/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">habrahabr.ru/post/148656</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , after which I could barely restrain myself from buying the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">entire assortment of the</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nearest radio amateur store.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scheme of solderless prototyping board in the freestyle notation system</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/ebd/654/735/ebd6547352dc71bcf581c9a56e541d81.png"><br>   Visio  : <a href="http://www.sandrila.co.uk/articles/visio-articles/electronics-breadboards/">www.sandrila.co.uk/articles/visio-articles/electronics-breadboards</a> </div></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By the way, if someone wants to make it in the form of a real board, let me know in a personal, perhaps I will even take part. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Surely this is not news, but along the way, I found (literally) a cool way to pair the bezel-free layout with the surrounding world with connectors on a flat Insulation-Displacement Connector (IDC): we pin a DIP connector on one end of the loop (in 2.54mm pitch, go into the layout), and the other end is dissected and crimped with a crimper, then we shoe with the necessary BLS / BLD pin connector (the crimping pliers use the same ones as in </font></font><a href="http://habrahabr.ru/post/218387/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">another post</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Either we do not dismember the train, but simply prick another IDC connector. You can chop them up a lot, like on cables for old IDE disks. How many wonderful discoveries are being made by an electronics store.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">According to this principle, I assembled two cables: one (simple) to connect my board with the MOXA NE-4110S, and the second (tricky) to interface with the connectors on the motherboard. </font><font style="vertical-align: inherit;">I highly recommend the color loop: it will not only please the eye with a cheerful rainbow of color markings, but on non-standard tasks it will also greatly save expensive resources of your central nervous system, freeing it for more interesting tasks. </font><font style="vertical-align: inherit;">The dull gray train is good for simple and straightforward variants, it‚Äôs better not to perform any inverted pieces on it.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If anyone has not seen fun</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/9ed/771/c02/9ed771c02c7ce5ee3ccfd4da83f79444.jpg"><br>    </div></div><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4ea/5e5/34d/4ea5e534d888618792dad7613c945e5d.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This IDC connector plug with a 2.54mm pitch we pin on the end of the </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/0bf/27c/de6/0bf27cde67e3ae56ba936204741649b9.jpg"><img src="https://habrastorage.org/getpro/habr/post_images/198/ee0/29a/198ee029a68029b3ace2baf6f387d280.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cable </font><font style="vertical-align: inherit;">furthest from the breadboard board </font><font style="vertical-align: inherit;">Sly loop </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Left: connect the buttons and LEDs from the PC case to the plug (IDC connector) on the loop; </font><font style="vertical-align: inherit;">from the connector further go two pairs ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cprava: two pairs reached the standard contacts and RST_SW PWR_SW on the motherboard, nearly all the required chain locked </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f51/9c0/532/f519c05328707422728b348c730393b6.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">These two IDC connector (2.54mm pitch) prick on the proximal end of the loop, they "sit" on the breadboard </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2a9/447/218/2a9447218729bfa7e90b0835d37144c3.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">breadboard board with two connected cables.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The assembly is centered on the left, and the Reserve Property of the Instrument stands alone on the right edge (a field effect transistor, if it breaks through the existing one). </font><font style="vertical-align: inherit;">In my opinion, it turned out neatly, even despite the cyclopean dimensions of the limiting resistors (your humble servant hurried a little while purchasing).</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> About nutrition </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To fulfill requirement No. 3 on independent power in the STANDBY mode, we will look for something suitable on the motherboard. </font><font style="vertical-align: inherit;">Well no incision </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tsya same 20-pin ATX power connector, in fact. </font><font style="vertical-align: inherit;">This is luck: judging from page 17 of </font></font><a href="http://download.asrock.com/manual/P4i65G.pdf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the P4i65G manual</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the completely useless IR port connector feeds on the + 5VSB line (looking ahead, I note that this turned out to be a cynical deception). </font><font style="vertical-align: inherit;">Great, add to the basket the corresponding 2-row 6-pin connector with a 2.54mm pitch, sometimes referred to as BLD 2x3. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/6eb/eaf/b56/6ebeafb56397aef63c1bd5e675fcbe13.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Almost useless connector for connecting IR devices to the P4i65G motherboard, BLD 2x3</font></font><br><br><blockquote> ,     +5VSB (aka  ,  ),     -    USB,     PS/2.      BIOS  ,     .  ,      ,      ¬´¬ª +5VSB. </blockquote><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ed/a4d/2ee/7eda4d2ee42e5cbddba29045d14cbe67.png"><br>  J2 connector on MOXA NE-4110S, BLD 2x7 <br><br>  In addition to the serial port J1 in the RS232 standard (analogous to what sticks out on motherboards), there is an unambiguous J2 connector for power supply, GPIO (DIO), control LEDs and a TTL-level debug serial port (TXD1, RXD1, GND) on the ‚Äúmoss‚Äù. ).  Just in case, I would say that the TTL UART requires a linear driver to interface with the RS232, there are different voltages;  but we will not connect and use this port.  Just add to the purchase of a 14-pin connector type "mother", with a known pitch 2.54mm (1/10 "). <br>  Stop, why does Mocha have two VCC + 5V contacts?  Having read <a href="http://easyelectronics.ru/podklyuchenie-mikrokontrollera-likbez.html">dispensary</a> about tasty and healthy nutrition of microcontrollers, I already began to suspect a separate bus.  But when I saw a very unambiguous soldering on the board in front of a single voltage stabilizer (and even measuring its resistance just in case), I realized that such a double power supply has nothing to do with the internal strapping.  Therefore, we will turn the situation around for our own selfish purposes: we will supply power with + 5VSB for one contact, and with the other we will immediately take it to our prototype.  And the wolves are safe and the sheep are fed.  Maybe for me and left these two contacts? <br><br><div class="spoiler">  <b class="spoiler_title">Little about electrostatics</b> <div class="spoiler_text">  I was last on the radio market, probably in the late 90s.  Recently, I did not know anything at all about the solderless models, or about the AVR and their Chopped Crushes.  All this immersion in microelectronics took about two weeks in the hobby mode, during which they had to read a lot. <br>  At the same time, I decided to first of all pass my self-assessment on mock-ups, having bought a 7-segment indicator for exercise and every mikruha with crumbling.  It is clear that instead of a common cathode, I took a common anode, and when connected to the 4511 chip, my indicator showed the numbers inversely and required many transistors.  It's good that no one has seen my microelectronic bullying ... <br>  Not only from laziness, but also for the sake of experiment, I decided to almost completely neglect electrostatic safety, taking a pair of protective tweezers and a dozen field-effect transistors in reserve.  And as he looked into the water: in the process of passing the test, the death of the brave fell as many as seven out of ten "field men."  Conclusion: if you work with field-effect transistors or other CMOS parts, protect the legs of these delicate devices from electrostatics, the reality of the problem is now confirmed by another experiment.  There are a lot of protection options: from ritual wrapping in foil in which the mother gave birth to special bracelets and rugs.  Only if there is no real ‚Äúland‚Äù in the apartment, please note that during your electronic meditations, a kind neighbor according to the laws of the genre <s>will</s> surely <s>drop the phase</s> that <s>will</s> ground the washing machine to the same pipe.  And then, if your defense is not protected by itself, then you can inadvertently get a virtual reality helmet from a foil cap, as in one long-forgotten <a href="http://dibr.nnov.ru/n%253D7381">fidosh bayan</a> (then I didn‚Äôt have the concept of ‚ÄúI‚Äôm patstal,‚Äù but now I know what it is called).  Personally, I preferred to pay with a pair of tweezers and several punched transistors (their eternal memory).  And forgive me, electronics monsters.  But seriously, google the <i>electrostatic bracelet</i> . </div></div><br><br><h4>  Security </h4><br>  Let's not forget, however, about doors, windows and similar fences.  Our NE-4110S device is not locked with passwords, but it can use simple ACLs for IP addresses, which are recommended to be restricted by the administrative network.  The server operating system must necessarily request a login and password to enter through the serial port.  All the contents of Serial-over-LAN are transmitted over the network in open form (telnet), so the transfer over public networks without encrypted VPN cannot be done at all (otherwise the root password, which you will probably enter, will leave).  For the same reason, a separate VLAN is also needed (a simple Ethernet network switch with overflowed ARP tables turns into a hub, which starts to call packets to all ports of the segment).  All devices for remote access to servers are potential vulnerabilities, they need to be treated with due respect, errors are rarely forgiven. <br>  By the way, as some users have discovered, FreeNAS did not have everything going smoothly with the release of 9.2.x with the implementation of the serial console ( <a href="https://bugs.freenas.org/issues/4266">https://bugs.freenas.org/issues/4266</a> ).  Be careful if you use this system. <br><br><h4>  Lazy null modem </h4><br>  I made a null modem RS232 cable for connecting the serial ports of the server and the controller from a cord from a disabled reader, to which Business dislocated a dozen feet some time ago.  I had to order new 2-row 10-pin connectors such as "mother", because  The old fool protection (in the form of a ‚Äúflooded foot‚Äù) just did not allow us to connect the USB cable to the COM-port connector.  You can easily make such a cable out of a flat cable, I'm just lazy, and so I took the finished cord, I had to compress the crimper just a couple of wires instead of two dozen.  Again, I recommend the reader to use a fun color loop for such tasks. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c7a/d3b/059/c7ad3b059bf7cd1971d11d5f1752f19b.gif"><br>  The complete null modem cable scheme borrowed from <a href="http://bogpeople.com/networking/SerialComms/rs232pinouts.shtml">bogpeople.com/networking/SerialComms/rs232pinouts.shtml</a> <br><br>  The question is: do we need all these DTR, DSR, RTS, CTS?  And anyway, why is DCD in a null modem?  A long time ago, I connected the console to a <i>Frame Relay</i> switch with three wires (RXD, TXD, GND) over a twisted pair, and everything worked.  But look at the serial console device in FreeNAS.  It uses freenas_serial9600 entries from <a href="http://www.freebsd.org/cgi/man.cgi%3Fquery%3Dgettytab%26sektion%3D5">gettytab (5)</a> , and the `` nc '' attribute is not visible there.  And in theory, this means that in the absence of a DCD signal, the serial port will be considered "dead", and the console will not go through it, at least without interfering with the FreeNAS code.  I may be mistaken and not take into account the electrical properties of the line hanging in the air, but Crepsondo‚Äôs philosophical practices recommend pressing DCD lines in such cases, and not hooking the FreeNAS firmware on the read-only file system, sweating with each remote server upgrade.  Do not read stories on the Internet about non-standard null modems, do the standard.  Then it is useful somewhere else. <br>  So, I will bring the null-modem crimping scheme to the form on imaginary 10-pin mother-type connectors sitting on an imaginary cable.  The scheme, by the way, at the time of testing, almost brought me to <abbr title="here: indecent state">Zugunder</abbr> , but more on that later. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/346/310/cae/346310cae47907450ec7e67a559752fd.jpg"><br>  Null-modem circuit, view on mother connectors, USB cable color marking (two black: one thicker, the second thinner) <br><br><h4>  Soft </h4><br>  Brothers, look at the length of this post, and we are not even going to program the microcontroller!  However, the simplest perl script for remotely pressing buttons I still add to complete the narration.  It's a bit redundant, but it's for beauty. <br><br><div class="spoiler">  <b class="spoiler_title">Sending a second push of the power button</b> <div class="spoiler_text"><pre><code class="perl hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/perl use IO::Socket::INET; $|=1; #flush my $s = new IO::Socket::INET ( PeerHost =&gt; '10.100.200.1', # NE-4110S host PeerPort =&gt; 5001, # DIO port Proto =&gt; 'tcp', ) or die "IO::Socket::INET: $!\n"; my $CMD_PWR_ACTIVE = pack('C7', 2, # command number, fixed 2, # version, fixed 0, # this byte is only used in response 3, # data length, fixed 3, # desired DIO channel number 1, # 1: set to output mode 1, # 1: set to high ); my $CMD_PWR_INACTIVE = pack('C7', 2, # command number, fixed 2, # version, fixed 0, # this byte is only used in response 3, # data length, fixed 3, # desired DIO channel number 1, # 1: set to output mode 0, # 0: set to low ); my $res; my ($hdr_cmd, $hdr_ver, $hdr_err, $hdr_len); my @data; print "PWR_ACTIVE\n"; print $s $CMD_PWR_ACTIVE; $s-&gt;recv($res, 4); ($hdr_cmd, $hdr_ver, $hdr_err, $hdr_len) = unpack('C4', $res); printf("result: CMD %d VER %d ERR %d LEN %d\n", $hdr_cmd, $hdr_ver, $hdr_err, $hdr_len); $s-&gt;recv($res, $hdr_len); @data = unpack("C$hdr_len", $res); sleep(1); print "PWR_INACTIVE\n"; print $s $CMD_PWR_INACTIVE; $s-&gt;recv($res, 4); ($hdr_cmd, $hdr_ver, $hdr_err, $hdr_len) = unpack('C4', $res); printf("result: CMD %d VER %d ERR %d LEN %d\n", $hdr_cmd, $hdr_ver, $hdr_err, $hdr_len); $s-&gt;recv($res, $hdr_len); @data = unpack("C$hdr_len", $res); sleep(1); $s-&gt;close(); exit(0);</span></span></code> </pre> <br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">Sending a second click on the RESET button</b> <div class="spoiler_text"><pre> <code class="perl hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/perl use IO::Socket::INET; $|=1; #flush my $s = new IO::Socket::INET ( PeerHost =&gt; '10.100.200.1', # NE-4110S host PeerPort =&gt; 5001, # DIO port Proto =&gt; 'tcp', ) or die "IO::Socket::INET: $!\n"; my $CMD_RST_ACTIVE = pack('C7', 2, # command number, fixed 2, # version, fixed 0, # this byte is only used in response 3, # data length, fixed 2, # desired DIO channel number 1, # 1: set to output mode 1, # 1: set to high ); my $CMD_RST_INACTIVE = pack('C7', 2, # command number, fixed 2, # version, fixed 0, # this byte is only used in response 3, # data length, fixed 2, # desired DIO channel number 1, # 1: set to output mode 0, # 0: set to low ); my $res; my ($hdr_cmd, $hdr_ver, $hdr_err, $hdr_len); my @data; print "RST_ACTIVE\n"; print $s $CMD_RST_ACTIVE; $s-&gt;recv($res, 4); ($hdr_cmd, $hdr_ver, $hdr_err, $hdr_len) = unpack('C4', $res); printf("result: CMD %d VER %d ERR %d LEN %d\n", $hdr_cmd, $hdr_ver, $hdr_err, $hdr_len); $s-&gt;recv($res, $hdr_len); @data = unpack("C$hdr_len", $res); sleep(1); print "RST_INACTIVE\n"; print $s $CMD_RST_INACTIVE; $s-&gt;recv($res, 4); ($hdr_cmd, $hdr_ver, $hdr_err, $hdr_len) = unpack('C4', $res); printf("result: CMD %d VER %d ERR %d LEN %d\n", $hdr_cmd, $hdr_ver, $hdr_err, $hdr_len); $s-&gt;recv($res, $hdr_len); @data = unpack("C$hdr_len", $res); sleep(1); $s-&gt;close(); exit(0);</span></span></code> </pre> </div></div><br><br><h4>  Equipment </h4><br><div class="spoiler">  <b class="spoiler_title">The list of ingredients with prices</b> <div class="spoiler_text"><table><tbody><tr><th>  Name </th><th>  Qty </th><th>  Cost of </th></tr><tr><td>  Interface Converter MOXA NE-4110S </td><td>  1 PC. </td><td>  $ 50 </td></tr><tr><td>  Fee breadboard </td><td>  1 PC. </td><td>  from $ 10 </td></tr><tr><td>  Dual optorele KR293KP4B, body DIP8 </td><td>  2 pcs. </td><td>  $ 4 </td></tr><tr><td>  Field Effect Transistor 2N7000, TO92 package </td><td>  2 pcs. </td><td>  $ 1 </td></tr><tr><td>  Limiting resistor 330 Ohm 5%, "pin" case </td><td>  5 pieces. </td><td>  $ 0.30 </td></tr><tr><td>  Pull-down resistor 10kŒ© 5%, ‚Äúpin‚Äù case </td><td>  3 pcs. </td><td>  $ 0.20 </td></tr><tr><td>  LED red AL307LM d = 5mm </td><td>  1 PC. </td><td>  $ 0.30 </td></tr><tr><td>  Yellow LED AL307ZHM d = 5mm </td><td>  1 PC. </td><td>  $ 0.30 </td></tr><tr><td>  LED AL307HM d = 5mm green </td><td>  2 pcs. </td><td>  $ 0.60 </td></tr><tr><td>  DIP switch, 4 pins </td><td>  1 PC. </td><td>  $ 1 </td></tr><tr><td>  Connector-plug 2.54mm IDC (on the cable), two-row 10 pins </td><td>  1 PC. </td><td>  $ 0.50 </td></tr><tr><td>  DIP IDC connector (on the loop), 10 pins </td><td>  2 pcs. </td><td>  $ 0.50 </td></tr><tr><td>  Color cable, 10 contacts </td><td>  1m </td><td>  $ 2.40 </td></tr><tr><td>  2.54mm female connector for BLD 2x7 cable (for MOXA J2) </td><td>  1 PC. </td><td>  $ 0.50 </td></tr><tr><td>  2.54mm female connector for BLD 2x5 cable (for COM port) </td><td>  2 pcs. </td><td>  $ 1 </td></tr><tr><td>  2.54mm female connector for BLD 2x3 cable (for IR port) </td><td>  1 PC. </td><td>  $ 0.30 </td></tr><tr><td>  Socket 2.54mm to cable BLS 2x1 (for connection to the motherboard.) </td><td>  3 pcs. </td><td>  $ 0.45 </td></tr><tr><td>  Unnecessary fee int.  PCI modem </td><td colspan="2">  lying around </td></tr><tr><td>  Small nylon tie </td><td colspan="2">  was </td></tr><tr><td>  Crimping pliers for crimping BLS and BLD connectors </td><td colspan="2">  were also, but generally from $ 20 </td></tr><tr><td>  Patch cord Cat5e </td><td colspan="2">  found;) </td></tr><tr><td>  Jumper for prototyping board </td><td colspan="2">  buy or make yourself </td></tr><tr><td>  Time </td><td colspan="2">  not considered </td></tr><tr><td>  <b>TOTAL</b> </td><td colspan="2">  <b>a little more than $ 70</b> </td></tr></tbody></table><br>  All devices in the DIP, or in the "pinout" (not SMD, not planar) packages - for solderless prototyping board </div></div><br><br><img src="https://habrastorage.org/getpro/habr/post_images/23d/3fc/0ba/23d3fc0ba2aa6efe50f02d72343258df.jpg"><br>  Converter MOXA NE-4110S (on the bracket), as well as circuit board and cables <br><br><h4>  Spirit of experiment </h4><br>  Friday evening.  Lightly buzzing at low fan speeds, our hard worker Zeus, methodically sucking the nearby office dust, methodically shelters a couple embracing from his switchboard and home router on his back.  All data is saved.  All users are dispersed to their homes and taverns.  The LEDs blink comfortably, and the Spirit of Experiment is already in the air. <br>  First of all, let's replace the <i>home</i> router with a <i>wild one</i> .  This, of course, is a separate story;  It is worth saying that the brought <i>wild</i> router is already fully tamed on the stand: all firmware have been updated, all settings, addresses, passwords, attendances and firewalls have been set.  Spend a few minutes on the mess with the wires, and everything went the first time.  Ay, what a great man I am.  Home router will go to the country. <br>  Then we return to the main goal of the visit and try to implement the original plan, relying on the availability of the promised + 5VSB on the connector of the IR port. <br>  We get our constructor, assemble and turn it on.  It is dark and quiet, but it does not smell like smoke, but still an experimental spirit.  We are looking for jumper PS2_USB_PWR1.  Damn, it is under the cooler duct.  Having analyzed our controlled vector of thrust for a while (see <a href="http://habrahabr.ru/post/214707/">habrahabr.ru/post/214707</a> ), we try it in this way and that.  Nothing happens. <br>  As they say, read, finally, the instructions.  On page 26 of <a href="http://download.asrock.com/manual/P4i65G.pdf">the P4i65G manual</a> in section 3.3.3, the ACPI Configuration of the devices mentioned is Ring-In (modem), PCI (Wake-on-LAN) and PS / 2 (keyboard).  The IR port is not explicitly mentioned.  Hm  And about USB in general not a word.  Ok, try the PS / 2 keyboard.  When the PS2_USB_PWR1 jumper is in the correct position, the PS / 2 keyboard in STANDBY mode really shines with an indicator and takes the computer out of hibernation.  Yeah, in a pinch, lend power to the PS / 2.  The USB keyboard in the STANDBY mode is deaf, like a fish on a fence, and obviously does not want to wake the computer.  Therefore, the PS2_ <i>USB</i> _PWR1 jumper name should be read as PS2_PWR1, and the promised + 5VSB on the IR connector - as a joke of the manufacturer.  USB in the STANDBY state this motherboard does not power at all.  Apparently, the developers thought that no one would notice such a cynical swindle. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/16f/627/bd0/16f627bd05dc6223d2232c934053bd1a.png"><br>  Jumper PS2_USB_PWR1, which actually has no relation to USB <br><br>  But how to power our economy without unaesthetic snot protruding from the PS / 2 outside the case?  We remove the jumper PS2_USB_PWR1 completely and connect the power of our circuit to pin No. 3.  Turn on.  The server somehow sounded offended and indignantly, and does not seem to be about to start.  And now the barely perceptible Ghost of Chernobyl seemed in the air ... The brain reflexively calculates the possible expense: one motherboard, one power supply, what else can you burn there?  Not deadly, but running on Saturday for iron, and even with the feeling of loss, was not part of the plans of the great schemer.  Okay, we quickly cut out of harm's way and again look at our electronic rebus. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d79/a63/00d/d79a6300d07c0157b7fce56ed5e49e80.png"><br>  Electronic rebus: how many positions does the jumper have? <br><br>  We have not considered something.  Probably a five-volt power bus, on which sits a keyboard controller and, perhaps, half a dozen useful devices.  Apparently, this is her entrance sticking out at us right under the nose in the form of contact No. 2.  On the left under No. 1 is the output from the + 5V line, and on the right under No. 3 is the output from + 5VSB.  Thank you, Captain Obvious, and where were you wearing <a href="http://ru.wikipedia.org/wiki/%25D0%2590%25D0%25B2%25D0%25B0%25D1%2580%25D0%25B8%25D1%258F_%25D0%25BD%25D0%25B0_%25D0%25A7%25D0%25B5%25D1%2580%25D0%25BD%25D0%25BE%25D0%25B1%25D1%258B%25D0%25BB%25D1%258C%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B9_%25D0%2590%25D0%25AD%25D0%25A1">on April 26, 1986?</a>  ?  ‚ÄúCome to Kiev, you will be <i>amazed</i> !‚Äù - then one respectable gentleman joked.  ‚ÄúIdiot, run a five-volt bus to me!‚Äù - the computer squeaked for me ... <br><br><blockquote>  And here in general the accident at the Chernobyl nuclear power plant?  And you will remember yourself in the famous pose of <abbr title="character of folk tale, in the processing of Pavel Petrovich Bazhov; all similarities, as they say, are random">Danila-master</abbr> with a <abbr title="product manufactured by danila who never went out">stone flower</abbr> : how many times did you have to get a <abbr title="an artifact that does not need comments">shaman tambourine</abbr> , connect <abbr title="genetic engineering has nothing to do with it">hippopotamuses with rhinos</abbr> and rely on <abbr title="cornerstone of all engineering">chance</abbr> ?  How many times did you have to turn on something that you can‚Äôt turn on and turn off something that you don‚Äôt want to touch?  I recently read some kind of global research, from which it followed quite clearly: a significant part of accidents in the IT sphere is caused by personnel, in the process of what is commonly called <i>routine maintenance</i> .  This IT site is not Russian, it is worldwide.  So I suffered there.  Perhaps, will carry ... </blockquote><br><br><img src="https://habrastorage.org/getpro/habr/post_images/0f2/3db/fcc/0f23dbfcc29d823f2236b9f01b352ddc.jpg"><br>  Another avtos scheme <br><br>  We put the jumper in position 1-2 (we give the usual + 5V to the bus), and we feed our product directly from contact No. 3 + 5VSB by borrowing the ‚Äúground‚Äù from the useless IR port connector.  Be sure to shoe the terminal in heat shrinkage or the BLS 1x1 connector (otherwise it will necessarily short; this is usually not fatal, but the protection of the power supply will prevent the machine from starting).  We take a deep breath and turn on the switch ... Exhale under the merry wink of the LED LED_100M.  Fans and all other mechanics silently stand and wait.  Telnet cheerfully gives the main menu of the controller.  Hooray, now we really manage the computer turned off!  The ghost of Chernobyl melts safely in the air, leaving a whitish cloud of childhood memories.  A curtain. <br><br>  Stop, stop, what curtain?  The reader is well aware that so beautiful servers start only in fairy tales.  Therefore, yes, between turning on the switch and the result was a half-hour crawling on the floor around the deaf serial port, accompanied by attempts to switch the speed / flow mode, turnip cues and UNIX commands, interspersed with the mat.  Because when I crimped both ends of the cord, I looked at the same picture (both times on the left), having assembled the usual straight cable instead of the null modem ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/346/310/cae/346310cae47907450ec7e67a559752fd.jpg"><br>  One connector must be crimped on the left picture, and the other on the right;  order is not important <br><br>  Ugh!  Finding such an epic jamb, I immediately cheered up, squeezed the clip out of the office stapler and began to unbend the connector back.  Having reworked the cable as it should, I received the FreeNAS console menu as a reward.  Zugunder passed.  Of course, there was the most magical moment of the check, when the box standing half a meter obediently gloh and came to life, obeying the invisible commands from a server in a distant country.  The control LEDs blinked, telemetry on the digital input (green LED) showed ‚Äúdown‚Äù with the server on and ‚Äúup‚Äù with the power off, and all this under the dumb but cheerful blink of the LED_100M indicator. <br>  Apart from the jamb with a null modem cable, the experiment was a success the first time. <br>  As demanded by Her Majesty Engineering. <br><br>  At parting, another long-forgotten, but favorite button accordion from the 90s by an unknown author: <br><div class="spoiler">  <b class="spoiler_title">Was orthogonal</b> <div class="spoiler_text">  Slowly rocking on the waves of a sine wave, the argument smoothly slides to infinity.  Hypotenuses and legs are rushing past rapidly.  Whistling fly limits. <br>  Inverse trigonometric functions are slowly dragged, giving way to an important Higher-order Derivative.  Modules and flag subspaces silently stand on the sides of the road.  Occasionally it will flash and disappear, dragging its tail behind itself, a power series.  On short legs, bouncing and stumbling, groups, algebras, domains D, Omega run, accompanied by a flock of restless ideals. <br>  The normal vector tends to factoriality, the phase space tends to the limiting point, already supremum with infinum, having drawn power, were approximated by a constant, the bipods are smaller, like the headmistress and the center of mass already approached a small number of small numbers of Delta, all bad points were forced out without limiting the generality, Dirac distribution is applied to the system with connections;  convergence was coming.  The polynomials not yet given are multiplied vectorially by the transition matrix, and those who did not have time were crushed by the exponent.  Everywhere shastali wavy coordinates.  Small powerless logarithms chasing an epsilon, waving helplessly with a summable feature. <br>  It was orthogonal. <br>  In the ensuing instability, the crunch of rings rang out here and there.  They acted on the second quadratic form. <br>  The factor space, pursued by pointwise convergence, hung about between double and repeated integrals, which were proudly taken and carefully selected expressions in elementary functions. <br>  Homomorphisms, choosing a corner more local, made love with the matrices of Gram and Jacobi. <br>  Continuity went on as usual.  Complex variables - the guardians of order, narrowing to an equivalence class, were decomposed into a Fourier series and quickly reduced the order, if any conditional extremum given by the Euclidean algorithm tried to clamp an infinitesimal sequence on both sides.  O-large and o-small, up to the values ‚Äã‚Äãof the first order, were evaluated conditionally convergent series.  The trigonometric system of functions flowed softly.  Behind them, they were full of generalized ones.  The smoothness did not change, the linearity was not broken, the singularity manifested itself only at the points of accumulation.  The Riemannian manifold was covered with a subharmonic haze, the implication with the determinant silently satisfied the boundary conditions. <br>  Began the next step.  More and more will follow, and so on, ad infinitum.  This will continue as long as there is a delta for any epsilon, while the amounts are Darboux, the rule is L'H√¥pital, the principle is Maximum Module.  Until the new Gauss, Cauchy, Lagrange, Pythagoras, Farm, Fourier, new Ostrogradsky come and will not reveal to the world a new, previously unknown knowledge, <br>  new revelation <br>  new math. <br></div></div><br>  A curtain. </div><p>Source: <a href="https://habr.com/ru/post/217299/">https://habr.com/ru/post/217299/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../217289/index.html">TOX: What happened in the project for six months</a></li>
<li><a href="../217291/index.html">Why the world needs OpenStreetMap</a></li>
<li><a href="../217293/index.html">Girl put a new skull, printed on a 3D-printer</a></li>
<li><a href="../217295/index.html">React Diff</a></li>
<li><a href="../217297/index.html">Report from InterSystems Global Summit 2014</a></li>
<li><a href="../217303/index.html">Dell PowerEdge R820 12G server overview</a></li>
<li><a href="../217305/index.html">Modification for the "Master"</a></li>
<li><a href="../217307/index.html">Steve Jobs has banned Google from hiring even former Apple employees</a></li>
<li><a href="../217309/index.html">How to catch a hedgehog</a></li>
<li><a href="../217315/index.html">Photo report from the exhibition of retrocomputers in Minsk</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>