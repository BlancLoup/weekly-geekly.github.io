<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Camera logic in a 2D platformer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Correctly adjusting the camera behavior in a classic 2D platformer is not as easy as it may seem. 

 The easiest approach is to tightly tie the camera...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Camera logic in a 2D platformer</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4ac/332/ba3/4ac332ba3b0e8d16ea957978dae35a4a.jpg" alt="image"></div><br><br>  Correctly adjusting the camera behavior in a classic 2D platformer is not as easy as it may seem. <br><br>  The easiest approach is to tightly tie the camera to the player‚Äôs character so that it is always in the center of the screen.  This may come down for prototypes, but this camera has flaws that annoy players. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For example, if the camera shifts up with each jump of a character, then it can easily cause nausea.  In addition, during instant acceleration and stopping of a character, the camera can jerk sharply. <br><br>  In our new <a href="https://www.asylumsquare.com/tinythor">Tiny Thor</a> game, we experimented with various options.  I want to talk about what techniques we stopped as a result. <br><a name="habracut"></a><br>  First, we process the X and Y axes independently of each other. <br><br><h2>  X scrolling </h2><br>  For the X axis, we set the left and right borders (the Focus area in the screenshot). <br><br>  When a player moves, the camera calculates the distance between the previous camera position and the new player position.  This way we will know how many pixels to scroll.  To smooth this movement, we divide this distance by 32 so that the camera lags a bit.  We also have a maximum camera speed that is never exceeded. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/461/9ce/934/4619ce934e81016c410750f131835727.png"></div><br>  <i>Different camera zones</i> <br><br>  To avoid triggering the camera during each small movement, we apply scrolling only if the character leaves the left or right border of the focus area.  At the same time, the camera immediately catches it. <br><br>  Because of this camera lag, the visible area in the direction of the player‚Äôs gaze has decreased.  This reduces the amount of important information on the screen that a player needs to react to enemies, obstacles, platforms, etc. <br><br>  To solve this problem, we move the horizontal focus area based on the orientation of the character's sprite. <br><br><div class="spoiler">  <b class="spoiler_title">The camera is now looking in the same direction as the player.</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5bb/591/333/5bb591333280670a7d288e78153eedda.gif"></div><br></div></div><br><div class="spoiler">  <b class="spoiler_title">When a player moves to the right, the focus area shifts to the left, so that the character remains to the left of the center of the screen.</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2af/aa4/f7e/2afaa4f7eed63c29aa9a547c516b7b90.gif"></div><br></div></div><br>  With increasing character speed along the X axis, we shift the focus area further away from the center.  Due to the increased apparent distance, the player can react to the difficulty level. <br><br>  As a result, we received smooth camera movements, adapting to the following player actions, relieved him of irritation and provided greater freedom in level design. <br><br><h2>  Y scrolling </h2><br>  Scrolling along the Y axis follows a similar logic and uses the upper and lower boundaries of the focus area. <br><br>  Instead of dividing the difference between the coordinates of the character and the camera by 32, we use divider 16 for the smoothing effect.  Moreover, the camera begins to move only when the character is standing on the object, so that she does not follow each jump. <br><br><div class="spoiler">  <b class="spoiler_title">The camera starts scrolling along the Y axis as soon as the character has the ground under its feet.</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/85d/239/ccc/85d239ccc70b511fa001986432ad7655.gif"></div><br></div></div><br><div class="spoiler">  <b class="spoiler_title">The camera does not move along the Y axis when the player jumps.</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/abf/c04/cc8/abfc04cc85180e164cc093a1390270b0.gif"></div><br></div></div><br><div class="spoiler">  <b class="spoiler_title">The behavior of the camera along the X and Y axes in action.</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4be/8a8/954/4be8a8954e2763f9c0e66c6ec0e2d1a3.gif"></div><br></div></div><br>  It seems that for ordinary cases these rules are enough, but if a player jumps near the top of the screen or falls into the abyss, the camera behavior ‚Äúbreaks‚Äù. <br><br>  To solve this problem, we added two more horizontal lines checking the vertical position of the character.  We call them ‚Äúpanic lines‚Äù (shown in dark yellow in the illustrations) because crossing them causes the camera to move quickly. <br><br>  Therefore, when a character jumps or falls and crosses one of these lines, the camera quickly begins to follow it. <br><br><div class="spoiler">  <b class="spoiler_title">The camera catches up with the character as soon as he crosses the lines of panic.</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/842/7cc/ee6/8427ccee601918622b0e034c17e47415.gif"></div><br></div></div><br>  All this works fine in most situations at our levels, but in some cases we need to manually override this behavior. <br><br>  We do this with simple rectangles in the level editor, which allow you to lock the camera along one of the axes while the character is in a given area. <br><br>  This is very useful when you need to show the player that falling from the edge of the platform is safe. <br><br>  Also, this function can be used in random areas of levels that are mainly oriented in one direction, for example, when falling down into a deep abyss filled with jewels. <br><br>  We also use this logic to lock the camera in boss fights, when the player is still locked on the screen, and a stable camera helps him avoid all attacks and shots. <br><br>  Another example of use is to completely switch the focus of the camera to another part of the level.  The logic here is that the camera flies along the line between the position of the character and the desired area, stops there for a second and comes back again.  We use it, for example, to demonstrate the consequences of using a switch. <br><br>  All this allowed us to get the dynamic behavior of the camera, working without problems 95% of the time, and giving us the tools to manually set the camera behavior in those 5% of situations that are needed in the gameplay or for a dramatic effect. <br><br><h2>  about the author </h2><br>  Jochen is the founder of <a href="https://asylumsquare.com/">Asylum Square</a> , an independent game studio engaged in retrostyle games, which we loved so much in childhood.  Inspired by the games of the 16-bit era, the Tiny Thor platformer will be released soon on <a href="http://store.steampowered.com/app/541310/Tiny_Thor/">Steam</a> . </div><p>Source: <a href="https://habr.com/ru/post/343376/">https://habr.com/ru/post/343376/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../343366/index.html">UX-design: common misconceptions and myths</a></li>
<li><a href="../343368/index.html">Accelerate Ansible</a></li>
<li><a href="../343370/index.html">EPAM + universities: how we work with universities in Russia</a></li>
<li><a href="../343372/index.html">Actual man month</a></li>
<li><a href="../343374/index.html">Real-time application on Vue.js</a></li>
<li><a href="../343378/index.html">Errors of PD operators related to personnel work</a></li>
<li><a href="../343380/index.html">IT events digest for December</a></li>
<li><a href="../343382/index.html">IntelliJ IDEA 2017.3. What is new and interesting?</a></li>
<li><a href="../343384/index.html">In Fiztech. Chitalka will be held a free lecture on the topic "How to create a game in virtual reality"</a></li>
<li><a href="../343386/index.html">Physically uncloneable functions: protecting electronics against illegal copying</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>