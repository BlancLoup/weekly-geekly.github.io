<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Angular - setting up the development and production environment for assemblies with AOT compilation and tree-shaking (Gulp, Rollup, SystemJS)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One of the features of Angular, inherent in both the first and the new version is the high threshold of entry. New Angular, among other things, it is ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Angular - setting up the development and production environment for assemblies with AOT compilation and tree-shaking (Gulp, Rollup, SystemJS)</h1><div class="post__text post__text-html js-mediator-article"><p>  One of the features of Angular, inherent in both the first and the new version is the high threshold of entry.  New Angular, among other things, it is difficult to even run.  And running it is easy to get 1-2 MB of scripts and the order of several hundred requests when loading the hello world page.  You can, of course, use all sorts of starters, seed'y or Angular CLI, but for use in a serious project you need to figure it out for yourself. </p><br><p>  In this article I will try to describe how to set up a convenient development environment using SystemJS, and production build Angular applications based on Rollup, with the output of about 100kb scripts and several requests when opening the page.  We will use TypeScript and SCSS. </p><br><p>  You can try everything in my <a href="https://github.com/PFight/angular-gulp-starter">angular-gulp-starter</a> project. </p><br><img src="https://habrastorage.org/files/dc0/c30/6b9/dc0c306b93f9458db1ede6a226571123.jpeg"><a name="habracut"></a><br><br><h1 id="sreda-razrabotki">  Development environment </h1><br><p>  During development, in my opinion, the most important thing is to quickly see your code at work.  You make changes to the code, look at it in work, edit the code again.  The faster all this happens, the more comfortable the environment.  In addition, it is important to have a comfortable debugging, informative error messages (which are easy to find in the code).  In case of unforeseen situations, it is important to keep everything under control - you need to have access to all intermediate files to easily investigate the problem. </p><br><p>  Technically, we need to solve three problems: </p><br><ol><li>  Compile TypeScript </li><li>  Compile scss </li><li>  Download all (including dependencies) to the browser in the correct order </li></ol><br><p>  The first two tasks are most conveniently solved using the compile-on-save function, which works in almost any IDE.  With this approach, it is enough to save your edits in the code, switch to the browser window and press F5 - very quickly and conveniently.  In addition, the compilation results are easy to control, js-files lie next to c ts, and in which case you can always search for them. </p><br><p>  From the IDE to work with TypeScript I can recommend Visual Studio (for example, Visual Studio 2015 Community Edition), which has built-in support for the TypeScript + <a href="https://marketplace.visualstudio.com/items%3FitemName%3DMadsKristensen.WebCompiler">Web Compiler</a> extension for SCSS.  I tried Atom, Visual Studio Code, but on my laptop they are too slow.  Visual Studio (not Code) does well with backlighting, autocompletion and compilation on the fly, even on a weak machine.  Although there are some backlight problems when using es6 import. </p><br><p>  The third task (download everything to the browser) is the most problematic, since  The scripts are dependent on each other, and must be loaded in the correct order.  Manually controlling all this is difficult and unnecessary.  It is best to leave the SystemJS library to deal with dependencies: in the code we use the ES6 import / export syntax, and based on this, SystemJS loads all the necessary files dynamically.  No need to build any bundles, perform some special build, just configure the config. </p><br><p>  The SystemJS configuration is a js file that might look something like this: </p><br><div class="spoiler">  <b class="spoiler_title">SystemJS Configuration Example for Angular Application</b> <div class="spoiler_text"><pre><code class="hljs perl">System.config({ defaultJSExtensions: true, paths: { <span class="hljs-string"><span class="hljs-string">"*"</span></span>: <span class="hljs-string"><span class="hljs-string">"node_modules/*"</span></span>, <span class="hljs-string"><span class="hljs-string">"app/*"</span></span>: <span class="hljs-string"><span class="hljs-string">"app/*"</span></span>, <span class="hljs-string"><span class="hljs-string">"dist-dev/*"</span></span>: <span class="hljs-string"><span class="hljs-string">"dist-dev/*"</span></span>, <span class="hljs-string"><span class="hljs-string">"@angular/common"</span></span>: <span class="hljs-string"><span class="hljs-string">"node_modules/@angular/common/bundles/common.umd"</span></span>, <span class="hljs-string"><span class="hljs-string">"@angular/core"</span></span>: <span class="hljs-string"><span class="hljs-string">"node_modules/@angular/core/bundles/core.umd"</span></span>, <span class="hljs-string"><span class="hljs-string">"@angular/http"</span></span>: <span class="hljs-string"><span class="hljs-string">"node_modules/@angular/http/bundles/http.umd"</span></span>, <span class="hljs-string"><span class="hljs-string">"@angular/compiler"</span></span>: <span class="hljs-string"><span class="hljs-string">"node_modules/@angular/compiler/bundles/compiler.umd"</span></span>, <span class="hljs-string"><span class="hljs-string">"@angular/platform-browser-dynamic"</span></span>: <span class="hljs-string"><span class="hljs-string">"node_modules/@angular/platform-browser-dynamic/bundles/platform-browser-dynamic.umd"</span></span>, <span class="hljs-string"><span class="hljs-string">"@angular/platform-browser"</span></span>: <span class="hljs-string"><span class="hljs-string">"node_modules/@angular/platform-browser/bundles/platform-browser.umd"</span></span>, <span class="hljs-string"><span class="hljs-string">"@angular/router"</span></span>: <span class="hljs-string"><span class="hljs-string">"node_modules/@angular/router/bundles/router.umd"</span></span>, <span class="hljs-string"><span class="hljs-string">"@angular/forms"</span></span>: <span class="hljs-string"><span class="hljs-string">"node_modules/@angular/forms/bundles/forms.umd"</span></span> }, packageConfigPaths: [<span class="hljs-string"><span class="hljs-string">"node_modules/*/package.json"</span></span>] });</code> </pre> </div></div><br><p>  Here we do the following: </p><br><ol><li>  We specify that SystemJS automatically substitute js extensions to files (defaultJSExtensions). </li><li>  We indicate that, unless otherwise specified, search for everything in the node_modules ( <code>"*": "node_modules/*"</code> ) folder.  This makes it easy to install dependencies via npm. </li><li>  We prescribe that modules starting with the <code>app</code> need to be loaded not from the <code>node_modules</code> , but from the app folder (our main folder with scripts).  This is used only in index.html, where <code>app/main</code> imported. </li><li>  Register paths to <a href="https://habrahabr.ru/users/angular/" class="user_link">angular</a> modules.  Ideally, this should happen automatically due to the <code>packageConfigPaths</code> parameter, but I could not get it to work (what did I do wrong?). </li><li>  If some third-party library is not automatically located, then we also prescribe the path to it explicitly. </li></ol><br><p>  After that, we just need to include in the <a href="https://github.com/PFight/angular-gulp-starter/blob/master/index.html">index.html a</a> number of service scripts: zone.js, reflect-metadata, core-js (or es6-shim), systemjs itself, its config and call the import of the main module: </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript">System.import(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'app/main'</span></span></span><span class="actionscript">);</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  As a result, SystemJS will load the file <code>app/main.js</code> , analyze its <code>import</code> and load these imported files, analyze their import and so all the application files will be downloaded in turn. </p><br><p>  However, this is not all.  The fact is that the rxjs library, actively used in Angular, consists of many small modules.  Therefore, if you leave everything so, then when you refresh the page, they will all be loaded one by one, which is somewhat slow (up to 100-300 requests). </p><br><img src="https://habrastorage.org/files/379/b4c/9a2/379b4c9a2c32415287041bfa80a84b73.png"><br><br><a name="rxjs-es"></a><br><p>  Therefore, in my starter project I collect all the rxjs in one bundle using Rollup.  Before this, it is additionally compiled in ES6, which is used later, in production assembly. </p><br><div class="spoiler">  <b class="spoiler_title">Build rxjs into one bundle to speed up page loading in a dev-environment</b> <div class="spoiler_text"><p>  Building this rxjs bundle is quite complicated.  First, TypeScript sources are compiled in ES6 (from the <code>node_modules/rxjs/src</code> folder), after which all of this is packaged with the help of a Rollup into one file, and transported to ES5.  At the same time, in order to make this bandl friend with SystemJS, a temporary file is created, which serves as an entry point for the Rollup, and looks like this: </p><br><pre> <code class="hljs cs">import * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pkg0 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rxjs/add/observable/bindCallback'</span></span>; System &amp;&amp; System.<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> &amp;&amp; System.<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(<span class="hljs-string"><span class="hljs-string">'rxjs/add/observable/bindCallback'</span></span>, System.newModule(pkg0)); import * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pkg1 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rxjs/add/observable/bindNodeCallback'</span></span>; System &amp;&amp; System.<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> &amp;&amp; System.<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(<span class="hljs-string"><span class="hljs-string">'rxjs/add/observable/bindNodeCallback'</span></span>, System.newModule(pkg1)); ...     rxjs</code> </pre> <br><p>  All this can be found in the files <a href="">build.common.js</a> / rxjsToEs and <a href="">build.dev.js</a> / rxjsBundle.  Source code compiled in ES is also used in production, therefore compilation is made separately. </p><br><p>  After the bundle is compiled, it must be downloaded before the code of our application is loaded.  This is done like this: </p><br><pre> <code class="hljs pgsql"> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(<span class="hljs-string"><span class="hljs-string">'dist-dev/rxjs.js'</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">function</span></span> () { <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(<span class="hljs-string"><span class="hljs-string">'app/main'</span></span>); });</code> </pre> </div></div><br><p>  As a result, we get about a second faster page load: </p><br><img src="https://habrastorage.org/files/028/95e/ce2/02895ece2ff74455b3e67e67b2fa15dd.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>  For ease of development, you also need a simple web server that supports HTML5 routing (when index.html is returned to all requests).  An example of such a server based on express can also be found in the <a href="https://github.com/PFight/angular-gulp-starter/blob/master/build-tools/express-">starter</a> . </p><br><p>  A knowledgeable reader may still ask, why not a webpack?  In short - webpack is good for production, but, IMHO, inconvenient during development.  More details in the spoiler below. </p><br><div class="spoiler">  <b class="spoiler_title">Why not Webpack, not JSPM, not Browserify</b> <div class="spoiler_text"><p>  <strong>Webpack</strong> </p><br><p>  Angular CLI and many starter and seed projects use Webpack.  He is now able to do tree-shaking, and they say, even hot module reloading (did anyone try in the context of Angular?).  But I do not share the hype around this collector, and I do not understand where it comes from.  Webpack is a bundler, and he can only build a bundle.  This raises many problems: </p><br><ol><li>  Assembly takes some significant time (at least a few seconds).  We can't use compile-on-save, which is much faster (at least it's not that easy). </li><li>  Yes, you can use watch, so when you save changes, the assembly will start automatically.  But this does not solve the problem.  1. In practice, everything looks like this: I enter a part of the code, save, build starts, while it lasts, I enter the following code and save - the result is an outdated bundle, without recent edits.  Has anyone encountered this problem?  How do you solve it? </li><li>  If source maps do not work for you (and for some reason they constantly break down and sometimes slow down), then error messages will be difficult to localize. </li></ol><br><p>  However, I could be wrong, since I didn‚Äôt work with Webpack. </p><br><p>  <strong>Jspm</strong> </p><br><p>  JSPM is the first thing that comes to mind when it comes to SystemJS.  Indeed, using it is quite easy to set up a convenient development environment for Angular.  You can use both the compile-on-save and TypeScript bootloader.  They say that there even works tree-shaking based on the Rollup.  It would seem that everything is perfect. </p><br><p>  But this is only at first glance.  Sometimes it seems to me that JSPM lives in some kind of parallel world, far from everything that is happening around.  For some reason, they needed to store all the packages, including npm-packages, in their own folder in a special way.  As a result, instead of a convenient out-of-the-box tool, you get a bunch of headaches about how to get all the other utilities (which, as a rule, can work with node_modules) make friends with JSPM. </p><br><p>  At a minimum, you will have to set up separate typings for dependencies in order to make JSPM friends with TypeScipt (or even worse, prescribe paths).  Making the AOT compiler work is also a separate topic.  If you need to do something non-standard (as with rxjs), also problems.  In general, I just did not manage to tie everything up and make a production build on JSPM.  If someone succeeds, it would be very interesting to see. </p><br><p>  <strong>Browserify</strong> </p><br><p>  It seems there is <a href="https://github.com/nolanlawson/rollupify">support for Rollup</a> .  Perhaps it is worth trying to build an assembly on its basis, I haven't tried it.  However, to be honest, I don‚Äôt see much point in this when the Rollup itself does a good job with the task.  The rest is the same as with the Webpack. </p></div></div><br><br><h1 id="production-sborka">  Production build </h1><br><p>  The Angular release build includes the following steps: </p><br><ol><li>  Ahead of time (AOT) compilation of templates (html and css parts of components).  In the dev-environment, they are compiled right in the browser, but for release it is better to do it in advance.  Then we don‚Äôt have to drag the compiler code into the browser, the tree-shaking efficiency will increase, the launch of the application will speed up a bit. </li><li>  Compiling TypeScript in ES6 (including the results of the first step).  We need exactly ES6, because  Rollup can only work with ES6.  We also compile SCSS, run post-processing. </li><li>  Build a bundle using tree-shaking using a Rollup.  As a result, all unused parts are removed from the code, and the size of scripts is reduced tenfold. </li><li>  Resulting the result in ES5 using the same TypeScript, minification. </li><li>  Preparing release index.html, copying files to dist. </li></ol><br><h3 id="aot-kompilyaciya">  AOT compilation </h3><br><p>  AOT compilation is done using the <code>@angular/compiler-cli</code> (also called ngc), which is based on the TypeScript compiler.  To perform the compilation you need: </p><br><ol><li>  Install packages: <code>@angular/compiler</code> , <code>@angular/core</code> , <code>@angular/platform-browser-dynamic</code> , <code>typescript</code> and, actually, <code>@angular/compiler-cli</code> .  Best of all, install everything locally in the project. </li><li>  Create a tsconfig.json file (for example, <a href="">such</a> ). </li><li>  Start the compilation with the command <code>"./node_modules/.bin/ngc" -p tsconfig.ngc.json</code> , or with the help of <a href="https://www.npmjs.com/package/gulp-ngc">gulp-plugin</a> . </li></ol><br><div class="spoiler">  <b class="spoiler_title">Unpleasant features of the AOT compiler</b> <div class="spoiler_text"><p>  NGC is built on the basis of TypeScript, but built, it should be said, bad.  Not all the features of TypeScript in it work as it should.  For example, <a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-1.html">inheritance of configurations</a> does not work (therefore, there are 3 separate tsconfig files in the starter).  In <a href="https://medium.com/%40isaacplmann/making-your-angular-2-library-statically-analyzable-for-aot-e1c6f3ebedd5">this article,</a> you can see what the AOT compiler does not yet support.  The list is far from complete (for example), so be prepared that there will be problems with this.  The compiler can "fall" somewhere in its depths or go into an infinite loop, and finding out the cause is not always easy.  Check that everything is compiled often, so you do not have to deal with it all at once. </p></div></div><br><p>  The configuration file looks basically the same as the main tsconfig.  However, the compiler generates a lot of files, cluttering with which the source folder is unpleasant.  Therefore, in the configuration, it is desirable to specify the folder where the compilation results will be placed: </p><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"angularCompilerOptions"</span></span>: { <span class="hljs-string"><span class="hljs-string">"genDir"</span></span>: <span class="hljs-string"><span class="hljs-string">"app-aot"</span></span> }</code> </pre> <br><p>  This is also true because the compiler also processes the components of Angular itself.  Therefore, if you do not specify genDir, then part of the results will appear in the node_modules folder.  This is at least <a href="https://github.com/angular/angular/issues/12725">strange</a> . </p><br><p>  It is worth paying attention that AOT-files refer to the main sources by relative paths.  Therefore, the relative position of the folders is important. </p><br><h3 id="reliznaya-kompilyaciya-typescript">  TypeScript release compilation </h3><br><p>  The difference between release compilation and the usual one is, firstly, that it is necessary to create a separate <a href="">main.ts</a> file.  During development, it should be excluded from compilation, and in the release build, on the contrary, it should replace the dev version.  The difference of this file is that a special bootstrap function is used, which uses the results of the AOT compilation.  In particular, we run the AppModuleNgFactory (the result of the compilation of the AppModule) from the genDir AOT compilation: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { platformBrowser } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@angular/platform-browser'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { AppModuleNgFactory } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../app-aot/app/app.module.ngfactory'</span></span>; platformBrowser().bootstrapModuleFactory(AppModuleNgFactory);</code> </pre> <br><p>  Also here we turn on the production mode for Angular (this is important to do, since it greatly affects the performance): </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { enableProdMode } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> "@angular/core"; enableProdMode();</code> </pre> <br><p>  The second difference in release compilation is the use of the ES6 target platform.  If you do not do this, Rollup will not give an error, but tree-shaking will not.  For the same reason, we need an ES6 version of rxjs.  Previously, rxjs had a special rxjs-es package, and all the examples of building Angular on gulp, which Google shows on the first pages, use it.  Unfortunately, this package is <a href="https://github.com/ReactiveX/rxjs/issues/1671">no longer supported</a> .  Therefore, we need to <a href="">compile</a> rxjs from TypeScript sources ourselves, as described <a href="https://habr.com/ru/company/docsvision/blog/321236/">above</a> . </p><br><p>  <a href="">The release compilation configuration</a> includes the <code>app</code> , and <code>app-aot</code> (genDir AOT compilation) and excludes dev <code>main.ts</code> , as described above.  Also, for order, in my starter, the results of the prod compilation are placed in temp / app-prod-compiled.  All this is in the file <a href="">build.prod.js</a> . </p><br><h3 id="tree-shaking-pri-pomoschi-biblioteki-rollup">  Tree-shaking with the Rollup library </h3><br><p>  Build with Rollup is a key build step that can turn 1 MB of source code into 100 KB.  Rollup analyzes the source code, and throws out of them those parts of the code that are not used. </p><br><p>  It accepts a single file as input: main.js (more precisely, main-aot.js), analyzing an import expression in which all other modules are assembled.  It follows that the Rollup must be able to find the necessary libraries.  Most problems are solved by the plugin <code>rollup-plugin-node-resolve</code> , which finds the libraries in node_modules.  Its use is prescribed in the corresponding <a href="">configuration file</a> . </p><br><p>  In case you need to do something specific, then it is easy to write your own plugin.  For example, in this way I specify Rollup that rxjs should be taken from <a href="https://habr.com/ru/company/docsvision/blog/321236/">the same folder</a> where our compiled ES6 version lies (RollupNG2 in the same <a href="">rollup-config</a> ). </p><br><p>  Of the configuration features, it is worth noting the <code>treeshake: true</code> parameter (of course), <code>context: 'window'</code> (we say that we build for the browser) and <code>format: 'iife'</code> .  The IIFE format will do without SystemJS, simply by adding the resulting file as a script tag in index.html. </p><br><p>  Translating the result in ES5 using TypeScript is quite simple, the main thing is to set the parameter allowJs.  The operation takes a couple of lines in the <a href="">bundling.js</a> file in the rollupBundle function. </p><br><h3 id="podgotovka-reliznogo-indexhtml">  Preparing the release index.html </h3><br><p>  After all the work done above, we can only collect all the auxiliary libraries in one bundle, and add the result of the rollup to the page via the script tag.  All these are standard tasks for gulp. </p><br><p>  In the starter, all this is done on the basis of maximum simplicity, so as not to force users to once again figure it out.  You can find the corresponding code in the <a href="">build-prod.js file</a> .  For testing, there is also configured an <a href="https://github.com/PFight/angular-gulp-starter/blob/master/build-tools/express-">express-server</a> , with gzip-compression enabled. </p><br><p>  As a result, we get 118 KB after gzip: </p><br><img src="https://habrastorage.org/files/13d/169/bbe/13d169bbe0914574a9c0173d1bda6d87.png"><br><br><p>  The example uses the Tour of Heroes from the official Angular guides, which is not exactly "Hello world".  If to simplify completely, it can turn out up to 50-80 Kb. </p><br><p>  On the links below you can try both versions of the assembly live: </p><br><p>  ‚Üí <a href="https://pfight.github.io/angular-gulp-starter-online-dev/">DEV version online</a> <br>  ‚Üí <a href="https://pfight.github.io/angular-gulp-starter-online-prod">PROD version online</a> </p><br><p>  In conclusion, I want to recommend an excellent <a href="http://blog.mgechev.com/2016/06/26/tree-shaking-angular2-production-build-rollup-javascript/">article on the topic of</a> Minko Gechev.  In it, he gives an example of the <a href="https://github.com/mgechev/angular2-ngc-rollup-build">simplest assembly</a> of 6 npm-scripts, which performs all the basic steps (note that rxjs-es is used there, which is no longer supported).  True, the seed-project for its authorship I did not like, because of the high complexity and not very high convenience. </p><br><p>  That's all, good luck! </p></div><p>Source: <a href="https://habr.com/ru/post/321236/">https://habr.com/ru/post/321236/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../321226/index.html">How we created a hosting provider with our own data center (continued)</a></li>
<li><a href="../321228/index.html">Visual C ++ for Linux Development: Practicing for Windows Developers</a></li>
<li><a href="../321230/index.html">Translation of excerpts from Robert Heinlein‚Äôs book, Take Your Government Back - part 21</a></li>
<li><a href="../321232/index.html">We continue testing: on the queue server Fujitsu PRIMERGY RX2540 M2</a></li>
<li><a href="../321234/index.html">Brave new messenger API</a></li>
<li><a href="../321238/index.html">Electronic ink for Wirenboard 5 or paint barcodes on Go</a></li>
<li><a href="../321240/index.html">What is traffic arbitration?</a></li>
<li><a href="../321242/index.html">Why I do not like synthetic tests</a></li>
<li><a href="../321244/index.html">Work with Flexbox in gifs</a></li>
<li><a href="../321246/index.html">How to create a Viber bot using PHP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>