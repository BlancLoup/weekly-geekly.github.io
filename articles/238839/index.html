<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Back to the Future: Testing a Trading Robot with Historical Data</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We have previously considered the issue of the mandatory stages of developing a trading strategy for working in the stock market. One of the most impo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Back to the Future: Testing a Trading Robot with Historical Data</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/itinvest/blog/238839/"><img src="https://habrastorage.org/getpro/habr/post_images/adb/b8d/e0e/adbb8de0e34421469d8d45da728f677b.jpg" alt="image"></a> <br><br>  We have previously considered the issue of the mandatory <a href="http://habrahabr.ru/company/itinvest/blog/224353/">stages of developing a</a> trading strategy for working in the stock market.  One of the most important stages is the testing of the performance of the strategy on historical data ‚Äî backtesting.  Today we will talk about him. <a name="habracut"></a><br><br><h4>  What is it </h4><br>  In simple terms, backtesting is to run a trading strategy algorithm using historical financial data.  The algorithm, when detecting certain stock exchange events (‚Äúsignals‚Äù), will generate orders to buy or sell financial instruments ‚Äî these operations will have an associated income or loss. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The total amount of income or loss (profit and loss, P &amp; L, PnL) for the time specified in the trading strategy will be an indicator of the success or failure of the algorithm. <br><br>  There are several goals that trading program developers achieve using backtesting: <br><br><ul><li>  <b>Filtering</b> - each strategy has certain indicators of production and efficiency, which are incorporated in it by the developer.  Accordingly, any strategy that does not allow to achieve the goals set should be ‚Äúfiltered‚Äù. </li><li>  <b>Modeling</b> - using backtesting, developers can test various market models (changing liquidity conditions, transaction costs, order processing speed, channel delays, etc.) without the risk of losing real money. </li><li>  <b>Optimization</b> - using the ‚Äúrun‚Äù strategy on historical data can improve its performance in specific market situations. </li><li>  <b>Verification</b> - with the help of testing, the developer can understand whether there were any errors in the description of the strategy in the program code. </li></ul><br>  As you can see, backtesting is a useful tool for developers of financial systems, but it is not always possible to correctly test for historical data.  The more high-frequency strategy must be implemented, the more difficult it is to correctly simulate the impact of certain market situations and parameters of a specific exchange platform on the overall system performance. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c85/187/155/c85187155a0fb20784a130e808122bf5.png" alt="image"><br><br><h4>  Misconceptions about backtesting </h4><br>  Michael Halls-Moore, a well-known expert in stock trading, Quant, and the developer of exchange robots, is convinced that novice developers of exchange systems often make mistakes when they are created due to certain misconceptions.  In particular, the expert <a href="http://www.quantstart.com/articles/Successful-Backtesting-of-Algorithmic-Trading-Strategies-Part-I">cites</a> four such errors: <br><br><h5>  Waiting for equally high results in the future. </h5><br>  Often, the developer is tempted to make changes to the test parameters to obtain more convincing results. <br><br>  At the same time, if in the case of historical data there is an opportunity to change something and accurately predict the result, then in the ‚Äúcombat‚Äù mode the robot may not work at all so effectively.  It is necessary to measure the performance of the strategy for different values ‚Äã‚Äãof input parameters. <br><br><h5>  Use of "future" data </h5><br>  In some cases, creators of trading strategies include assumptions about the future state of affairs in the data set.  In case of errors in the code, incorrect calculation of optimal parameters for the strategy or incorrect use of extreme price values ‚Äã‚Äã(highs and lows), the launch of such a strategy in the real market may fail (this is one of the most frequent reasons why strategies work more effectively on historical data than in real time). <br><br><h5>  Invalid assessment of their psychological stability </h5><br>  When conducting tests, the developer sees the ultimate performance of his algorithm.  If at a certain time period (say, a year or five years) the system makes a profit, then there is a great temptation not to pay attention to deposit drawdowns (losses incurred) that occurred along this road to success.  It seems to people that they can easily survive the loss of 25% of their money (after all, the robot must then recoup). <br><br>  In practice, not everyone has enough stamina to survive such moments without performing rash actions (and if the algorithm allows 25% of money to be lost on history, then in reality this situation is very likely), which often lead to even greater losses. <br><br><h4>  What parameters need to be considered </h4><br>  Developers of trading systems need to take into account many different parameters that may affect the ultimate financial viability of a particular strategy. <br><br><h5>  Transaction costs </h5><br>  Novice traders often pay attention only to the performance of their algorithm directly on the market, but they forget to take into account the associated costs that can level all their income.  In this case, the most obvious costs will be transaction fees charged by the exchange and the broker (in ITinvest, on some tariffs, <a href="http://www.itinvest.ru/pricing-n-docs/tariffs/broker_tarif/">fees are</a> roughly equivalent to exchange <a href="http://www.itinvest.ru/pricing-n-docs/tariffs/broker_tarif/">fees</a> ). <br><br><h5>  Slippage and delays </h5><br>  Slippage is the price difference between the one for which the trading robot intended to make a deal and the one for which it actually passed.  It takes time to ‚Äúdeliver‚Äù an order to the core of an exchange trading system.  In the case of high-speed trading robots (HFT) every millisecond on the account, for which the price may slightly change, making the transaction not so profitable (or unprofitable in general). <br><br>  Some financial instruments have a high volatility (their price changes frequently), so when working with them you need to make allowances for possible slippage. <br><br><h5>  Liquidity impact </h5><br>  When dealing with relatively illiquid instruments, a trader must keep in mind the possible impact that the actions of his trading system will have on the market.  If a certain share is bought and sold by not so many people, the order to purchase a significant number of such shares can greatly change their price.  In order to avoid such a situation, it is necessary to teach the robot to break deals into a large number of small orders that cannot greatly affect the market. <br><br><h5>  Types of trading orders </h5><br>  The work of a trading strategy is also influenced by the fact that trade orders its developer plans to use to complete transactions.  Most often, traders resort to market orders and limit orders. <br><br>  The market order (‚Äúby market‚Äù) is executed immediately at the price of a financial instrument (stock, <a href="http://habrahabr.ru/post/222257/">futures</a> , <a href="http://habrahabr.ru/post/226829/">option</a> , etc.) that has emerged on the market. Accordingly, if a major transaction is necessary, for example, buying a large number of shares, the market order will the fact that there will be several transactions at different prices - the market may not have the right amount of people willing to sell shares at the same price, then having bought all their shares, the robot will proceed to the next price offered and so on. <br><br>  Market orders are an aggressive tool - they will always be executed, while the final price of the transaction remains unknown to the merchant. <br><br>  Limit orders allow the robot to determine the worst price at which it makes sense to conduct a transaction.  Such an order may remain unfulfilled (if the market did not have anyone willing to sell or buy at a specified price) or partially executed (there were not enough volunteers), as a result of which it is considered a more passive means of making deals. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d20/2ce/2b4/d202ce2b46a64e7bd1e6e174ebffce16.png" alt="image"><br><br>  Their advantage is undoubtedly the fact that the price of the transaction is predetermined.  The list of currently placed orders of the Limit type is called the order book (Order Book) and is displayed in the trading terminals as a separate window. <br><br>  When testing a strategy, it is important to pay attention to its behavior when using market and limit orders.  In the event that the order queue is incorrectly modeled, the trading strategy may show the worst results when working in real time, compared to running on historical data. <br><br><h4>  Backtesting tools </h4><br>  There are quite a few publicly available systems that can be used to test financial strategies: <br><br><ul><li>  <b>MS Excel</b> - familiar to everyone and everyone Microsoft Excel can be used to write mechanical trading systems.  Most brokers allow you to associate this tool with their software products (uploading data and generating trading signals using VBA).  The disadvantage of such a decision will be the low speed of work, and the benefit of free and quick implementation of simple strategies.  Alternative - Open Office </li><li>  <b><a href="http://www.mathworks.co.uk/products/matlab/">Matlab</a></b> is a software environment designed to perform complex calculations.  There are plugins for use in stock trading.  With it, you can create small scripts, which nevertheless describe fairly complex strategies.  Minus - the system is not cheap and paid.  Alternatives for the Russian market <a href="http://www.tslab.ru/">TSlab</a> and <a href="http://stocksharp.com/">StockSharp</a> .  Also, traders use <a href="http://www.metastock.com/">MetaStock</a> , <a href="http://www.wealth-lab.com/">Wealth-Lab</a> and Omega products to create mechanical trading systems. </li><li>  <b>C ++ / C #</b> are programming languages ‚Äã‚Äãthat are widely used in the financial world.  Gradually, Java and Scala are gaining popularity. </li><li>  <b>Embedded tools for trading terminals</b> - some trading terminals have built-in tools for creating trading robots and backtesting strategies.  The corresponding <a href="http://www.itinvest.ru/software/comp/smartx/plagin-konstruktor-robotov/">plug-in</a> can be installed in the <a href="http://www.itinvest.ru/software/comp/smartx/">SmartX</a> terminal.  For writing robots used scripting language <a href="http://habrahabr.ru/company/itinvest/blog/214601/">TradeScript</a> . </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/472/793/c8e/472793c8e17f01e1dfd1f5f6039cc2f2.png" alt="image"><br><br>  <i>Window for back-testing of the plug-in for creating robots on TradeScript in the SmartX terminal</i> <br><br><h4>  Conclusion </h4><br>  Backtesting is the most important stage in the development of a trading strategy, without which it is difficult to count on the adequate operation of a trading robot in the ‚Äúcombat‚Äù conditions of the real market.  At the same time, it is important to understand that successful work of a strategy on historical data does not guarantee an equally good result when used in real-time trading. <br><br>  In addition to testing on historical data, developers should test the program in real time - this can be done with the help of special test trading systems provided by exchanges and brokers.  With the help of such risk-free systems with virtual money, you can debug the robot's response to changing market conditions - usually data in such cases is provided by exchange platforms (with a delay or ‚Äúthinned out‚Äù). <br><br>  That's all, thank you for your attention.  We will be happy to answer questions in the comments. <br><br>  <b>Attention!</b>  In ITinvest, a vacancy for a GUI C # developer has opened, the job is to implement front-end development of software products for trading on the exchange.  Details on the link <a href="http://www.itinvest.ru/about/vacancies/programmer-gui-c/">www.itinvest.ru/about/vacancies/programmer-gui-c</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bfd/50e/cac/bfd50ecace09cb61a956a1ab8a39dbba.jpg" alt="image"><br><br>  PS If you notice a typo or mistake - write a personal message, and we will fix everything promptly. <br><br>  <b>Links and posts on the topic:</b> <br><br><ul><li>  <a href="http://www.quantstart.com/articles/Successful-Backtesting-of-Algorithmic-Trading-Strategies-Part-I">Successful backtesting of algorithmic trading strategies - Part I</a> </li><li>  <a href="http://www.quantstart.com/articles/Successful-Backtesting-of-Algorithmic-Trading-Strategies-Part-II">Successful backtesting of algorithmic trading strategies - Part II</a> </li><li>  <a href="http://habrahabr.ru/company/itinvest/blog/224353/">How-to: a step-by-step guide to the development of a trading system for the stock market</a> </li><li>  <a href="http://habrahabr.ru/company/itinvest/blog/223551/">Interview: how C # and C ++ help make money on the stock market</a> </li><li>  <a href="http://habrahabr.ru/company/itinvest/blog/216937/">How-to: how to choose a programming language to create a trading robot</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/238839/">https://habr.com/ru/post/238839/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../238825/index.html">How can a programmer draw a logo without knowing how to draw?</a></li>
<li><a href="../238829/index.html">Modular smartphone ‚ÄúProject Ara‚Äù: new details from Google</a></li>
<li><a href="../238831/index.html">Transferring files to an isolated DOS-based virtual machine using the ... keyboard</a></li>
<li><a href="../238835/index.html">Wi-Fi on the passport will be only for paid access points</a></li>
<li><a href="../238837/index.html">Catch up and overtake Moore! Competition of innovative hardware IT projects "More than Moore"</a></li>
<li><a href="../238845/index.html">Party hard programmatically, or as we wrote ClojureCup 2014</a></li>
<li><a href="../238847/index.html">Guided tour of the data centers of Scandinavia, 12-15 November</a></li>
<li><a href="../238849/index.html">Microsoft and IIDF invite to a series of student hackathons Imagine Cup</a></li>
<li><a href="../238853/index.html">English words with pictures and pronunciation from a native speaker</a></li>
<li><a href="../238855/index.html">Autothysis128t: SSD with a very serious information protection system</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>