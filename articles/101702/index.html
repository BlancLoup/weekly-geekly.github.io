<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Remote reinstallation of linux using a Debian example</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There are many features that simplify the life of a system administrator. Various remote control systems allow you to install the OS on a pristine-cle...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Remote reinstallation of linux using a Debian example</h1><div class="post__text post__text-html js-mediator-article">  There are many features that simplify the life of a system administrator.  Various remote control systems allow you to install the OS on a pristine-clean server and today this is not a problem at all.  Even the presence of a second hard drive makes the problem of reinstalling the operating system into a commonplace.  Therefore, in this article we will consider the most severe of cases: let there be only one completely broken hard drive on the server, and our task is to remotely reinstall the OS. <br><br>  Raise our eyebrows, marveling at how flexible our favorite OS is, roll up our sleeves and get down to business. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The basis of this method is the idea that we can use the SWAP-section to install a temporary operating system, and when it gets to its feet - to do the main one.  The main thing and the only thing we need is a swap of at least 420 MB in size (this is exactly how much lenny takes with everything needed). <br><br>  The following assumptions are used in the article: <br>  - you have debian, and you plan to install debian, <br>  - grub installed in the MBR is used. <br><br><h4>  A brief plan of our work will look like this: </h4><br><ol><li>  convert swap partition to ext3; </li><li>  install a clean OS on it; </li><li>  reboot into it; </li><li>  make the necessary changes on the main section; </li><li>  copy the clean OS from the temporary to the main section; </li><li>  boot from the main partition, turn on swap. </li></ol><br><br><h4>  Preparation section. </h4><br><br>  The first thing we will do is see if we have this swap section at all: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># free -m ... Swap: 470 0 470</span></span></code> </pre><br><br>  As you can see - there is, and the size (displayed in MB) fully meets the requirements.  It remains to find out how we have a disk: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># fdisk -l /dev/sda ... Device Boot Start End Blocks Id System /dev/sda1 * 1 462 3710983+ 83 Linux /dev/sda2 463 522 481950 5 Extended /dev/sda5 463 522 481918+ 82 Linux swap / Solaris</span></span></code> </pre><br><br>  It can be seen that on sda1 - the current OS, on sda5 - swap.  Confusing is difficult, but anything can happen. <br><br>  Turn off swap: <br><br><pre> <code class="hljs sql"><span class="hljs-comment"><span class="hljs-comment"># swapoff -a</span></span></code> </pre> <br><br>  You can make sure that we turned it off by doing the same free: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># free ... Swap: 0 0 0</span></span></code> </pre><br><br>  Update our partition table: <br><br><pre> <code class="hljs pgsql"># fdisk /dev/sda Command (m <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> help): t <span class="hljs-keyword"><span class="hljs-keyword">Partition</span></span> number (<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-number"><span class="hljs-number">-5</span></span>): <span class="hljs-number"><span class="hljs-number">5</span></span> Hex code (<span class="hljs-keyword"><span class="hljs-keyword">type</span></span> L <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> list codes): <span class="hljs-number"><span class="hljs-number">83</span></span> Changed <span class="hljs-keyword"><span class="hljs-keyword">system</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">83</span></span> (Linux) Command (m <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> help): w The <span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> has been altered! <span class="hljs-built_in"><span class="hljs-built_in">WARNING</span></span>: Re-reading the <span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> failed <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> error <span class="hljs-number"><span class="hljs-number">16</span></span>:    . The kernel still uses the <span class="hljs-built_in"><span class="hljs-built_in">old</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span>. The <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> will be used at the next reboot. Syncing disks.</code> </pre><br><br>  We were carefully told that the kernel will not see the changes before the reboot, but we don‚Äôt need it yet.  Now is the time to prepare the file system on our old new section.  For example, ext3: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># mke2fs -j /dev/sda5 Writing inode tables: done Creating journal (4096 blocks): done</span></span></code> </pre><br><br>  We will mount the section somewhere and on this its preparation will be completed. <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># mkdir /mnt/temp # mount /dev/sda5 /mnt/temp # df -h      %   /dev/sda1 3,5G 600M 2,8G 18% / ... /dev/sda5 456M 11M 422M 3% /mnt/temp</span></span></code> </pre><br><br><h4>  Installing a "temporary" OS. </h4><br><br>  It should be noted here that it is temporary only in its location.  In order not to chase away all the actions to build a clean system in the future, we simply copy it to the main section. <br><br>  We use a great tool for getting a minimal installation - debootstrap.  Hereinafter, we will assume that there are no problems with the Internet on the server (otherwise, what kind of server is it after this?), So we‚Äôll download everything from the repository. <br><br><pre> <code class="hljs css"># <span class="hljs-selector-tag"><span class="hljs-selector-tag">aptitude</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">install</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">debootstrap</span></span> ...   <span class="hljs-selector-tag"><span class="hljs-selector-tag">debootstrap</span></span> (1<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.10lenny1</span></span>) ...</code> </pre><br><br>  It is enough to transfer four parameters to this utility: the desired architecture, the release name, the installation directory and a link to the complete mirror.  The architecture can be identified by the output `uname -a`, the distribution kit is chosen to your taste, the directory in this case is where we mounted our section, and the link to the mirror can be found here: <a href="http://www.debian.org/mirror/list">http://www.debian.org/mirror/list</a> .  It turns out that the startup line looks like this: <br><br><pre> <code class="hljs 1c"><span class="hljs-meta"><span class="hljs-meta"># debootstrap --arch i386 lenny /mnt/temp http:</span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//ftp.ru.debian.org/debian/</span></span></span></span></code> </pre><br><br>  After pressing enter, the process of downloading and installing packages will begin, with a fairly average Internet connection (~ 10 Mbit) it takes about 5-10 minutes - I did not even have time to finish my tea.  At the end you will see a message that the system has been successfully installed: <br><br><pre> <code class="hljs pgsql">I: Base <span class="hljs-keyword"><span class="hljs-keyword">system</span></span> installed successfully.</code> </pre><br><br>  Now begins one of the most crucial procedures: we need to properly configure the new system.  Any sys-admin probably had nightmares about how he loses remote control over the machine, and in the end we started all this in order not to go to the data center.  Therefore, we postpone a cup of coffee and concentrate. <br><br>  First, copy all the important settings.  Probably everyone will find quite important files that are not where they should be.  I, for example, have a certain /etc/rc.routes with all non-standard routes.  The main thing is not to forget anything.  It seems to me that it‚Äôs absolutely pointless to give here a list, but for me it looks like this: <br><br><pre> <code class="hljs pgsql"># cp /etc/{resolv.conf,hosts,rc.<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>} /mnt/<span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>/etc # cp /etc/network/interfaces /mnt/<span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>/etc/network # cp /etc/your-stuff /mnt/<span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>/etc</code> </pre><br><br>  In fstab, we write the most necessary, proc and our root partition: <br><br><pre> <code class="hljs mel"># cat &gt; /mnt/temp/etc/fstab &lt;&lt; <span class="hljs-string"><span class="hljs-string">"#EOF"</span></span> &gt; <span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> <span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> defaults <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> &gt; /dev/sda5 / ext3 errors=remount-ro <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> &gt; #EOF</code> </pre><br><br>  Now we will mount the dev-environment, go to the front of our temporary system and immediately mount the proc: <br><br><pre> <code class="hljs mel"># mount --bind /dev /mnt/temp/dev # chroot /mnt/temp /bin/bash # mount -t <span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> <span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">proc</span></span></code> </pre><br><br>  Obviously, we will need a package manager, I think it‚Äôs not necessary to talk about setting it up separately. <br><br><pre> <code class="hljs pgsql"># wget http://debian.soar.name/sources.list -O /etc/apt/sources.list # aptitude <span class="hljs-keyword"><span class="hljs-keyword">update</span></span></code> </pre><br><br>  Set the time zone: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># dpkg-reconfigure tzdata</span></span></code> </pre><br><br>  We also need the following packages: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># aptitude install locales # dpkg-reconfigure locales # aptitude install console-data # aptitude install ssh # aptitude install sudo</span></span></code> </pre><br><br>  Immediately, in order not to forget, we will create a user and assign a password to it, otherwise we will not be allowed into ssh later: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># adduser --ingroup users soar # visudo</span></span></code> </pre><br><br>  Now reinstall the bootloader.  First you need to create all bootloader files on the new disk: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># aptitude install grub # grub-install /dev/sda</span></span></code> </pre><br><br>  After that, you need to initialize the MBR to boot from our new section.  To do this, everything is in the same place, in the thread, enter the hornbeam console and write the following: <br><br><pre> <code class="hljs pgsql"># grub grub&gt; root (hd0,&lt;TAB&gt; Possible partitions are: <span class="hljs-keyword"><span class="hljs-keyword">Partition</span></span> num: <span class="hljs-number"><span class="hljs-number">0</span></span>, Filesystem <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> ext2fs, <span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-number"><span class="hljs-number">0x83</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Partition</span></span> num: <span class="hljs-number"><span class="hljs-number">4</span></span>, Filesystem <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> ext2fs, <span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-number"><span class="hljs-number">0x83</span></span></code> </pre><br><br>  A peculiar autocomplete on taboo will tell us which sections are at our disposal.  As you can see everything is one less than the name in the system.  Initialize the download from our sda5: <br><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">grub</span></span>&gt; root (hd0,<span class="hljs-number"><span class="hljs-number">4</span></span>) <span class="hljs-type"><span class="hljs-type">Filesystem</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> is ext2fs, partition </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> 0x83 grub&gt; setup (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hd0</span></span></span><span class="hljs-class">) ... </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Done</span></span></span><span class="hljs-class">. grub&gt; quit</span></span></code> </pre><br><br>  The loader is installed where necessary.  Now select and install the appropriate kernel: <br><br><pre> <code class="hljs mel"># aptitude search linux-<span class="hljs-keyword"><span class="hljs-keyword">image</span></span> # aptitude install linux-<span class="hljs-keyword"><span class="hljs-keyword">image</span></span><span class="hljs-number"><span class="hljs-number">-2.6</span></span><span class="hljs-number"><span class="hljs-number">.26</span></span><span class="hljs-number"><span class="hljs-number">-2</span></span><span class="hljs-number"><span class="hljs-number">-686</span></span></code> </pre><br><br>  During the installation, we will be asked to "Create a symbolic link to the current kernel image?", To which we will answer in the affirmative.  They will also inform that we are installing a kernel that requires initrd support from the boot loader, and will clarify whether we have changed our mind. <br>  We answer "No" and the installation ends.  It remains to update the bootloader menu: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># update-grub Found kernel: /boot/vmlinuz-2.6.26-2-686 Updating /boot/grub/menu.lst ... done</span></span></code> </pre><br><br>  We leave the trunk, collect nerves in a fist and send the server to the first reboot: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># exit # reboot</span></span></code> </pre><br><br>  If everything was done correctly, the machine will reboot into our temporary system.  We can log into ssh as the user we just added. <br><br><h4>  Transferring the system to the main section. </h4><br><br>  Format and mount our old section: <br><br><pre> <code class="hljs pgsql"># mke2fs -j /dev/sda1 Writing inode <span class="hljs-keyword"><span class="hljs-keyword">tables</span></span>: done Creating journal (<span class="hljs-number"><span class="hljs-number">16384</span></span> blocks): done Writing superblocks <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> filesystem accounting information: done # mkdir /mnt/<span class="hljs-keyword"><span class="hljs-keyword">temp</span></span> # mount /dev/sda1 /mnt/<span class="hljs-keyword"><span class="hljs-keyword">temp</span></span></code> </pre><br><br>  By the way, at this stage you can also perform disk maintenance: for example, repartition the primary partition and check the file system. <br><br>  It remains to copy our clean OS to the main section: <br><br><pre> <code class="hljs sql"><span class="hljs-comment"><span class="hljs-comment"># cp -a -x / /mnt/temp/</span></span></code> </pre><br><br>  Update fstab.  This time let's get it right: <br><br><pre> <code class="hljs objectivec"><span class="hljs-meta"><span class="hljs-meta"># cat &gt; /mnt/temp/etc/fstab </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;&lt; "#EOF" &gt;</span></span></span><span class="hljs-meta"> # /etc/fstab: static file system information. &gt; # &gt; # </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;file system&gt;</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;mount point&gt;</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;type&gt;</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;options&gt;</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;dump&gt;</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;pass&gt;</span></span></span><span class="hljs-meta"> &gt; proc /proc proc defaults 0 0 &gt; /dev/sda1 / ext3 defaults,errors=remount-ro 0 0 &gt; #EOF</span></span></code> </pre><br><br>  Once again, you need to update the hornbeam.  This time - to download already from our main section: <br><br><pre> <code class="hljs mel"># mount --bind /dev /mnt/temp/dev # chroot /mnt/temp/ /bin/bash # grub-install /dev/sda # grub grub&gt; root (hd0,<span class="hljs-number"><span class="hljs-number">0</span></span>) Filesystem type is ext2fs, <span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> type <span class="hljs-number"><span class="hljs-number">0x83</span></span> grub&gt; setup (hd0) Checking <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"/boot/grub/stage1"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span>... yes Checking <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"/boot/grub/stage2"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span>... yes Checking <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"/boot/grub/e2fs_stage1_5"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span>... yes Running <span class="hljs-string"><span class="hljs-string">"embed /boot/grub/e2fs_stage1_5 (hd0)"</span></span>... <span class="hljs-number"><span class="hljs-number">17</span></span> sectors are embedded. succeeded Running <span class="hljs-string"><span class="hljs-string">"install /boot/grub/stage1 (hd0) (hd0)1+17 p (hd0,0)/boot/grub/stage2 /boot/grub/menu.lst"</span></span>... succeeded Done. grub&gt; <span class="hljs-keyword"><span class="hljs-keyword">quit</span></span> # update-grub Updating /boot/grub/<span class="hljs-keyword"><span class="hljs-keyword">menu</span></span>.lst ... done</code> </pre><br><br>  It is worth noting that in this place, unlike the first case, I refused to update menu.lst, and there were still links to sda5.  Why this is happening - I never figured it out, so I manually edited this file: <br><br><pre> <code class="hljs mel"># sed -i -e <span class="hljs-string"><span class="hljs-string">'s/sda5/sda1/g'</span></span> /boot/grub/<span class="hljs-keyword"><span class="hljs-keyword">menu</span></span>.lst # sed -i -e <span class="hljs-string"><span class="hljs-string">'s/(hd0,4)/(hd0,0)/g'</span></span> /boot/grub/<span class="hljs-keyword"><span class="hljs-keyword">menu</span></span>.lst</code> </pre><br><br>  Exit the thread and do the second reboot: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># exit # reboot</span></span></code> </pre><br><br>  After the reboot, you can make sure that we are again in our native main partition: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># df -h      %   /dev/sda1 3,5G 436M 2,9G 13% /</span></span></code> </pre><br><br>  It remains to create and enable swap: <br><br><pre> <code class="hljs vhdl"># fdisk /dev/sda Command (m <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> help): t Partition number (<span class="hljs-number"><span class="hljs-number">1</span></span>-<span class="hljs-number"><span class="hljs-number">5</span></span>): <span class="hljs-number"><span class="hljs-number">5</span></span> Hex code (<span class="hljs-keyword"><span class="hljs-keyword">type</span></span> L <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> list codes): <span class="hljs-number"><span class="hljs-number">82</span></span> Changed system <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> partition <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">82</span></span> (Linux swap / Solaris) ... The <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> table will be used at the <span class="hljs-keyword"><span class="hljs-keyword">next</span></span> reboot. Syncing disks. # cat &gt;&gt; /etc/fstab &lt;&lt; <span class="hljs-string"><span class="hljs-string">"#EOF"</span></span> &gt; /dev/sda5 none swap sw <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> &gt; #EOF # mkswap /dev/sda5 # swapon -a</code> </pre><br><br>  Make sure everything is fine: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># free -m Swap: 470 0 470</span></span></code> </pre><br><br>  Well, in the end, if you edited / boot / grub/menu.lst hand to hand - you should still run the script to update it again: <br><br><pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># update-grub Updating /boot/grub/menu.lst ... done</span></span></code> </pre><br><br><h4>  Summing up. </h4><br><br>  This method is certainly not the easiest way to reinstall the system, however, in many cases, it becomes the only possible one.  Moreover, the whole procedure takes about 25 minutes, so if your DC is not across the road, then in any case, you get quite a good time saving.  It turned out to be surprisingly many letters - I tried to paint in detail and clearly, but in fact the operation is simple and fast enough. </div><p>Source: <a href="https://habr.com/ru/post/101702/">https://habr.com/ru/post/101702/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../101691/index.html">"Website is not displayed"</a></li>
<li><a href="../101692/index.html">Login to the "face"</a></li>
<li><a href="../101695/index.html">Raise 100 dollars or pass by? Probability theory in everyday work</a></li>
<li><a href="../101697/index.html">Facebook will earn $ 1 billion in advertising in 2010</a></li>
<li><a href="../101698/index.html">What is Calculate Linux</a></li>
<li><a href="../101707/index.html">III International Conference "FOSS Sea 2010"</a></li>
<li><a href="../101709/index.html">Because of Android, Oracle sues Google</a></li>
<li><a href="../101711/index.html">Running programs in Yakuake when KDE starts</a></li>
<li><a href="../101712/index.html">The most popular clips about social networks</a></li>
<li><a href="../101719/index.html">Latest news from the world of one payment system</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>