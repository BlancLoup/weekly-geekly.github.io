<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Excel-calculator of complex wave resistance transformation on waveguide line segments</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In calculations in the high-frequency technique, two types of problems often arise: 


- calculate the effect of the transmission line, which is an in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Excel-calculator of complex wave resistance transformation on waveguide line segments</h1><div class="post__text post__text-html js-mediator-article"><p>  In calculations in the high-frequency technique, two types of problems often arise: </p><br><ul><li>  calculate the effect of the transmission line, which is an integral structural part of the microwave device (antenna, balancing-matching device, divider, electronic amplifier) ‚Äã‚Äãon the resulting complex characteristic impedance of the device </li><li>  specially calculate the length of the transmission line (adjust the length and intrinsic impedance) to transform the device‚Äôs own impedance into a more convenient one. </li></ul><br><p>  For an instant and convenient solution, with the presentation of the result in tabular and graphical form, we will create a tool. </p><a name="habracut"></a><br><p><img src="https://ic.pics.livejournal.com/ypylypenko/74196954/180532/180532_original.png" alt="image"></p><br><p>  In the diagram, Za is a source device that has known wave properties. <br>  Z0 - segment of the waveguide line of length L and wave impedance (characteristic impedance) Z0 (Ohm) </p><br><p>  For the particular case when Za is purely active (tuned to an antenna, or an electronic device whose reactivity is removed using all kinds of LC shunts), the resulting resistance Zin is calculated according to the well-known telegraph equation: <br><img src="https://ic.pics.livejournal.com/ypylypenko/74196954/179483/179483_original.png" alt="image"></p><br><p>  In the case when K is a multiple of ¬º Œª, such a segment does not add reactivity, but only transforms one real resistance into another.  If K is a multiple of ¬Ω Œª - the line does not make any changes at all, regardless of whether it is consistent or not. </p><br><p>  Such private properties are very widely known and very widely used: </p><br><ul><li>  to minimize the influence of the lines, whenever possible, they are attempted to be multiples of ¬Ω Œª </li><li>  Transformers on Œª segments are very widespread in microwave technology </li></ul><br><p>  Working with this formula has 2 practical limitations: </p><br><ul><li>  in a wide frequency band, a segment of fixed length L has a different length in Œª and, accordingly, the effect on the transformation will be different (up to the direction) </li><li>  devices at the input are not always tuned to resonance, and in a wide frequency band the device, by definition, has reactivity (imaginary part of the complex resistance) </li></ul><br><p>  Therefore, to work with complex resistance (with a source having reactivity), it is necessary to return to the less well-known initial formula: </p><br><p><img src="https://ic.pics.livejournal.com/ypylypenko/74196954/179235/179235_original.png" alt="image"></p><br><p>  For the particular case when the imaginary part ZL = 0, the previous formula with tangents was derived from it. </p><br><p>  The cosine and sine in this formula are hyperbolic. <br>  Cosine and sine are taken from the propagation constant (Œ≥), this is a complex number, the real part consists of the attenuation constant Œ± (in Napier per unit length, where Napier is an analog of decibels, only with a logarithm not on a decimal basis, but a natural number e) and phase constant √ü (the number of radians fitting in the wavelength). <br>  In the general case, for arbitrary long lines, calculating Œ≥ is not an easy task, it requires knowing all 4 <a href="https://en.wikipedia.org/wiki/Primary_line_constants">primary parameters of the transmission line</a> : R, L, C, and G. <br>  But in the particular case if the line is lossless, i.e.  The following conditions are met: </p><br><ul><li>  the line is very short (to Œª) </li><li>  a line of good thick conductor (copper, aluminum, zinc, etc.) </li><li>  non-ferromagnet skin layer (copper, aluminum, zinc, without iron / nickel and their alloys) </li><li>  air / vacuum dielectric and, accordingly, velocity factor = 1, the signal propagation speed is almost equal to the speed of light, the dielectric loss tangent is close to 0 (vacuum, air) <br>  then Œ≥ = 0 + j 2œÄ / Œª <br><img src="https://ic.pics.livejournal.com/ypylypenko/74196954/181858/181858_original.png" alt="image"></li></ul><br><p>  The dimension of the units L, Œ≥ and Œª is any (meters, feet, millimeters), the main thing is that all three units be in the same dimension.  In the calculator we will use millimeters. </p><br><p>  In the precomputer era, working with such a formula was almost impossible, so engineers used the Wolpert-Smith diagram </p><br><p><img src="https://ic.pics.livejournal.com/ypylypenko/74196954/180853/180853_original.png" alt="image"></p><br><p>  Working with it is very laborious, especially in a wide frequency band. </p><br><p>  Using the fact that MS Excel fully supports complex numbers and operations on them, we will create a calculator.  Since  Google Docs does not support the sine / cosine function from a complex number (IMCOSH, IMSINH, etc.); in the M | N columns, we replace these functions with their component parts.  In the offline version of Excel / OpenOffice, you can use the direct function. </p><br><p>  The quality of matching is usually evaluated by the resultant CWS, so we immediately add to the calculator its calculation through the reflection coefficient Œì (Greek gamma, you can often find a record through œÅ) </p><br><p><img src="https://ic.pics.livejournal.com/ypylypenko/74196954/180081/180081_original.png" alt="image"></p><br><p>  As a teaching example, let's take the popular Digital-9 patch antenna for receiving television broadcasting in the UHF range 470-800 MHz. </p><br><p>  Own characteristic impedance of the antenna, without a transforming segment, is shown on the graph: </p><br><p><img src="https://ic.pics.livejournal.com/ypylypenko/74196954/181382/181382_original.png" alt="image"></p><br><p>  In a wide frequency band, the antenna impedance varies within very wide limits: the reactivity is always positive (inductive) with a minimum near 530 MHz (almost resonance) and reaches 200-350 Ohm in the frequency band.  Radiation resistance ranges from 200 to 600 ohms. </p><br><h2 id="httpsgooglw8z9u2httpsgooglw8z9u2-google-docs">  <a href="https://goo.gl/w8z9U2">https://goo.gl/w8z9U2</a> (Google Docs) </h2><br><p>  So actually the calculator.  We enter the incoming data in the yellow cells, the values ‚Äã‚Äãthat need to be manually selected - in turquoise.  Green columns ‚Äî output impedance; lilac ‚Äî SWR values ‚Äã‚Äãfor reference. </p><br><p>  Selecting the length and resistance - we get an instant report on the CWS in the entire frequency band.  If desired, you can add a schedule of the CWS. </p><br><p>  For example, if the line has a length of 155 mm and Z0 = 170 Ohm, then we get the following curve of the CWS on the load of 75 Ohms: </p><br><p><img src="https://ic.pics.livejournal.com/ypylypenko/74196954/182345/182345_original.png" alt="image"></p><br><p>  Input data for yellow cells may be: </p><br><ul><li>  CAD simulation data (Ansys HFSS, CST Microwave, NEC2, MMANA) </li><li>  laboratory measurement data </li><li>  reference data (for electronic devices and circuits) </li></ul><br><p>  Using the calculator you can calculate multi-stage transformers from several segments connected in series.  To do this, it is necessary to create a duplicate of ‚ÄúSheet‚Äù in Excel, enter the links to the green cells from the previous sheet in the yellow column.  Or you can place the data on one "Sheet" - adding new lines in which to specify the links to the previous lines as incoming cells.  But in the latter case, it is necessary to create several Zo / L cells (for each cascade) and tweak in the formulas references to Zo / L for the desired cascade. </p><br><p>  If the data source is CAD-modeling, then the answer can be obtained simply by simulating a segment of the transformer in the model.  But the calculation of such models using the finite element method (HFSS, CST) takes a lot of time, especially in a wide frequency band.  Excel calculator gives an instant answer and allows you to see the trend and sensitivity, therefore, it is more convenient for a rough calculation. </p><br><p>  For cases where the line will be made of materials with attenuation: </p><br><ul><li>  coaxial or two-wire cables with non-air dielectric </li><li>  microstrip lines on printed circuit boards <br>  Using this calculator, you can calculate the vacuum / air equivalent of the line, and then multiply its length by the velocity factor using the cable's passport data or the microstrip line analysis - the calculation of the equivalent dielectric constant of the substrate taking into account the geometry of the bands: VF = 1 / sqrt ( Eeff) </li></ul><br><p>  To calculate the impedance in long lines with attenuation (coaxial cables, twisted pairs), you can use the Excel calculator: <a href="https://ac6la.com/tlmath.html">https://ac6la.com/tlmath.html</a> </p><br><h2 id="proverka-pravilnosti-modeli-i-kalkulyatora-na-oshibki">  Checking the correctness of the model and calculator for errors </h2><br><p> Since  The calculator model is comparatively complex, one can make a methodological error in it or in a formula ‚Äî it needs to be checked. <br>  Since we obtained the initial data for the training example from Ansys HFSS, we can draw the transformer calculated using Excel into the HFSS model and calculate the characteristic impedance at the end of the line using HFSS. <br>  For example, take the line length of 152 mm and Zo = 140 ohms. <br>  In the model, we used a tap from a patch of 4x0.5 mm. <br>  Using <a href="https://www.eeweb.com/tools/microstrip-impedance">well-known analytical equations, we</a> calculate that the distance between the 4x0.5 mm band and the endless earth screen should be 6.0 mm for Zo = 140 Œ©. <br>  Extend the existing strip to a length of 152 mm at a height of 6 mm from the reflector and assign a port to the end of the line. <br>  Compare the predicted Re / Im with the results of the HFSS simulation. <br><img src="https://ic.pics.livejournal.com/ypylypenko/74196954/182741/182741_original.png" alt="image"></p><br><p>  The values ‚Äã‚Äãand trends coincide quite accurately, so the calculator can be trusted. <br>  Minor discrepancies are explained by small changes in the geometry of the model - fitting the point of connecting the supply strip to the height of the installation of the transformer segment (measured at a height of 4.0 mm, and the transformer was chosen to a height of 6.0 mm), bending and connecting the port at the end of the transformer. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/352852/">https://habr.com/ru/post/352852/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../352842/index.html">Arrested the leader of the cyber group, who stole more than 1 billion euros from banks around the world</a></li>
<li><a href="../352844/index.html">We write a simple plugin for VirtualDub</a></li>
<li><a href="../352846/index.html">Distrust of authority and economy: main trends of millenial investment activity according to Robinhood service statistics</a></li>
<li><a href="../352848/index.html">Backend United # 1. The vinaigrette. Announcement</a></li>
<li><a href="../352850/index.html">We are preparing an iOS client for GraphQL</a></li>
<li><a href="../352854/index.html">We keep the design of the system under control using isolated unit testing</a></li>
<li><a href="../352856/index.html">AWS framework for serverless applications</a></li>
<li><a href="../352858/index.html">Tehnostrim. Learning to build the Internet</a></li>
<li><a href="../352860/index.html">DANOS: First Open Network Operating System Presented</a></li>
<li><a href="../352864/index.html">Simple, affordable and useful Wi-Fi lab. Do it yourself</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>