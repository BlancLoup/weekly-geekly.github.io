<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New critical vulnerabilities in Android: What is the problem, and how to protect</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Information security researchers have discovered a number of serious vulnerabilities in one of the components of the Android mobile OS kernel called S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New critical vulnerabilities in Android: What is the problem, and how to protect</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/pt/blog/263903/"><img src="https://habrastorage.org/files/4aa/1e4/e9d/4aa1e4e9d7bb490babcb48540f33ce1a.png"></a> <br><br>  Information security researchers have discovered a <a href="http://www.kb.cert.org/vuls/id/924951">number of serious vulnerabilities</a> in one of the components of the Android mobile OS kernel called Stagefright (a library for working with multimedia files, such as PDF).  The first about the problems in the component Stagefright said a researcher from the company Zimperium Labs Joshua Drake ( <a href="http://www.twitter.com/jduck">Joshua J. Drake</a> ).  In addition, TrendMicro <a href="http://blog.trendmicro.com/trendlabs-security-intelligence/trend-micro-discovers-vulnerability-that-renders-android-devices-silent/">announced the</a> discovery of a serious vulnerability in Android. <a name="habracut"></a><br><br><h4>  Stagefright </h4><br>  The researcher has published an exploit that demonstrates an attack using a malicious MMS message - in order to accomplish it, the attacker needs to know only the victim's phone number.  At the same time, the user does not even need to carry out any actions with the message (open the file, click on the links, etc.), the malicious code is executed automatically. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/dd0/317/7b5/dd03177b5139419d9635864e35a7d77a.png"><br><br>  As reported in a <a href="http://blog.zimperium.com/experts-found-a-unicorn-in-the-heart-of-android/">post</a> on the ZImperium blog, hackers can even delete the message itself before the user sees it (in this case, the smartphone will only show an incoming message alert). <br><br><img src="https://habrastorage.org/files/597/e2c/122/597e2c12270a4ad88916b3a3d1d07ebd.png"><br><br>  <i>List of vulnerable devices</i> <br><br>  According to Drake, despite the presence in Android of a special security sandbox, which blocks for most applications the ability to access user data from other programs, it is possible to create exploits that access the audio and video streams of the smartphone, as well as to the internal storage. <br><br>  Vulnerabilities are subject to phones running Android from version 2.2 to version 5.1 (according to media estimates, up to 950 million smartphones and tablets worldwide are vulnerable). <br><br>  According <a href="http://arstechnica.com/security/2015/07/950-million-android-phones-can-be-hijacked-by-malicious-text-messages/">to the</a> publication Ars Technica, the vulnerability of Stagefright also affects the Firefox browser on all platforms except Linux (including Firefox OS).  The editors contacted Joshua Drake, who confirmed that there were problems: <br><br>  <i>If you install Firefox 38, then you will no longer be able to attack you through Firefox.</i>  <i>However, if you upload a malicious video through a browser with the tag <code>video width="300" height="150"</code> , and will not play it, it will still download malicious Android code.</i> <br><br>  It is noteworthy that Drake was the first to report security problems at Stagefright (he plans to tell more about his findings at the DEFCON conference on August 7), but not the only one who discovered them.  According <a href="http://www.forbes.com/sites/thomasbrewster/2015/07/30/stagefright-vulnerabilties-ready-for-testing/">to</a> Forbes, a 36-year-old Moscow researcher Yevgeny Legerov also discovered two zero-day vulnerabilities in this component.  Google has released a series of patches for partners ( <a href="https://android.googlesource.com/platform/frameworks/av/%2B/0e4e5a8%255E!/">one</a> , <a href="https://android.googlesource.com/platform/frameworks/av/%2B/5c134e6%255E!/">two</a> , <a href="https://android.googlesource.com/platform/frameworks/av/%2B/030d8d0%255E!/">three</a> ) that fixes vulnerabilities found by Legerov. <br><br>  Joshua Drake gave information about the vulnerability to Google (along with possible patches), and the company paid him a reward of $ 1.337 (the alert was sent before the official launch of the bug bounty program for Android).  If the information about the vulnerability had been transferred to the exploit vendors, the researcher could have counted on a sum of about $ 100,000 - Zerodium, in its Twitter, said it was ready to pay for such vulnerabilities as much: <br><br><img src="https://habrastorage.org/files/df2/3d8/14a/df23d814a0a9439391ebc52cfc23cbe8.png"><br><br>  So far, patches have been received only by Silent Circle Blackphone and devices with Cyanogen firmware, vulnerabilities discovered by Evgeny Legerov were also added to the <a href="http://intevydis.com/vulndisco.shtml">VulnDisco</a> exploit <a href="http://intevydis.com/vulndisco.shtml">kit</a> (available to government and commercial organizations using the Canvas penetration testing tool).  Legerov told reporters that his team provides customers with exploits for internal testing, so their functionality is curtailed and does not allow for full-scale real attacks. <br><br>  Zimperium specialists also recommend that Android users update the OS to the latest version (although they point to the fact that it is unknown when the patch will appear and whether it will be for older devices ‚Äî it is recommended to install the Cyanogen firmware for them), disable the automatic downloading of MMS (for Hangouts and "default" application for SMS). <br><br><h4>  Attack to the media server </h4><br>  In addition to the Stagefright vulnerability, a serious security bug in Android (versions starting from 4.3 Jelly Bean up to 5.1.1 Lollipop, that is, more than half of all Android devices in the world), was <a href="http://blog.trendmicro.com/trendlabs-security-intelligence/trend-micro-discovers-vulnerability-that-renders-android-devices-silent/">announced</a> by TrendMicro.  The exploitation of this vulnerability is possible by installing a malicious application on the device (causing the operating system to crash) or by redirecting the user to the site prepared by the attackers. <br><br><img src="https://habrastorage.org/files/638/c9a/6b3/638c9a6b33cd43dda401e253852e0888.png"><br><br>  A vulnerability has been discovered in the media server service, which Android uses to index media files stored on the device.  The service cannot correctly process malicious video (usually with a .mkv extension) using the <a href="http://matroska.org/">Matroska container</a> , which causes the entire operating system to crash. TrendMicro has posted the code for the <code>frameworks/av/media/libstagefright/matroska/MatroskaExtractor.cpp</code> file on the blog showing <br><br><pre> <code class="cpp hljs"><span class="hljs-number"><span class="hljs-number">865</span></span> <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> offset = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-number"><span class="hljs-number">866</span></span> <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> len1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-number"><span class="hljs-number">867</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (offset &lt; codecPrivateSize &amp;&amp; codecPrivate[offset] == <span class="hljs-number"><span class="hljs-number">0xff</span></span>) {<span class="hljs-comment"><span class="hljs-comment">//codecPrivate is controlled by the mkv file 868 len1 += 0xff; 869 ++offset; 870 } 871 if (offset &gt;= codecPrivateSize) { 872 return ERROR_MALFORMED; 873 } 874 len1 += codecPrivate[offset++]; 875 876 size_t len2 = 0; 877 while (offset &lt; codecPrivateSize &amp;&amp; codecPrivate[offset] == 0xff) { 878 len2 += 0xff; 879 ++offset; 880 } 881 if (offset &gt;= codecPrivateSize) { 882 return ERROR_MALFORMED; 883 } 884 len2 += codecPrivate[offset++]; 885 886 if (codecPrivateSize &lt; offset + len1 + len2) {//len1 or len2 maybe 0xffffffff, then integer overflow happened 887 return ERROR_MALFORMED; 888 } 889 890 if (codecPrivate[offset] != 0x01) { 891 return ERROR_MALFORMED; 892 } 893 meta-&gt;setData(kKeyVorbisInfo, 0, &amp;codecPrivate[offset], len1);//crash in here</span></span></code> </pre><br>  TrendMicro employees created a special application that exploits this vulnerability.  The video below shows an attack on a smartphone with it: <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/gjn5QTaQ0fk%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgxW2EjGibuEukYJWFjDIgvPCSmxQ" frameborder="0" allowfullscreen=""></iframe><br>  They managed to reproduce and attack using the URL.  For this, a special website was created, the malicious video is embedded in the HTML code.  While the site was loading, Chrome browser had the same effect: <br><br><img src="https://habrastorage.org/files/365/c30/72b/365c3072b4ed416fbc7d7e18c7bf9960.png"><br><br>  Researchers say that you can protect against this vulnerability with the help of special protective applications for mobile devices. <br><br>  At conferences on information security, Positive Technologies researchers also demonstrated the results of a <a href="http://ptsecurity.ru/download/Hacking_USB_Modem_and_SIM_Card_via_SMS.pdf">study on the security of</a> 4G communications and SIM cards (they <a href="http://habrahabr.ru/company/pt/blog/243697/">can</a> also <a href="http://habrahabr.ru/company/pt/blog/243697/">be hacked</a> ). <br><br>  During the Positive Hack Days forum held in May in Moscow, a competition was also held on hacking MiTM Mobile mobile communications - we <a href="http://habrahabr.ru/company/pt/blog/261035/">published an</a> analysis of its tasks <a href="http://habrahabr.ru/company/pt/blog/261035/">in Habr√©</a> (some event attendees received reports about hacking their devices).  Here is <a href="https://my.webinar.ru/record/538727">a webinar entry</a> on this topic. </div><p>Source: <a href="https://habr.com/ru/post/263903/">https://habr.com/ru/post/263903/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../263893/index.html">Samsung solid-state drives are justified. The problem was in the Linux kernel</a></li>
<li><a href="../263895/index.html">Proper API design: what are ‚Äúone‚Äù, ‚Äúmany‚Äù, ‚Äúzero‚Äù and ‚Äúnothing‚Äù</a></li>
<li><a href="../263897/index.html">UI performance comparison in WPF, Qt, WinForms and FLTK</a></li>
<li><a href="../263899/index.html">In app purchase using Soomla. Fast and easy</a></li>
<li><a href="../263901/index.html">Webinar second. Bug work, work tools and customer relationship building methods</a></li>
<li><a href="../263905/index.html">‚ÄúSpeed ‚Äã‚Äãis such a feature that no one ever refuses‚Äù - an interview with Dmitry Zhemerov from JetBrains</a></li>
<li><a href="../263907/index.html">Correlation, covariance and deviation (part 3)</a></li>
<li><a href="../263909/index.html">Telerik's VirtualQueryableCollectionView weak spot</a></li>
<li><a href="../263913/index.html">Implementing a search engine with Python rankings (Part 2)</a></li>
<li><a href="../263915/index.html">Architectural solutions for the Bitrix24 telephony system</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>