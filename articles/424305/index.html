<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Uber Cross-Platform Mobile Architecture RIBs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="December 20, 2016, guys from Uber Engineering published an article about a new architecture (here is a translation of this article in Habr√©). I presen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Uber Cross-Platform Mobile Architecture RIBs</h1><div class="post__text post__text-html js-mediator-article">  December 20, 2016, guys from Uber Engineering published <a href="https://eng.uber.com/new-rider-app/">an article</a> about a new architecture (here is a <a href="https://habr.com/company/livetyping/blog/320452/">translation of</a> this article in Habr√©).  I present to your attention the translation of the main part of the documentation. <a name="habracut"></a><br><br><h2>  What is RIBs architecture all about? </h2><br>  RIBs is a cross-platform architectural framework from Uber.  It was designed for large mobile applications with a large number of nested states. <br><br>  When developing this structure, Uber engineers adhered to the following principles: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <b>Support for collaboration between people developing on different platforms: the</b> vast majority of complex parts of Uber applications are similar on iOS and Android.  RIBs provide common development patterns on Android and iOS.  When using RIBs, engineers on both iOS and Android can share one co-developed architecture for their functions. </li><li>  <b>Minimizing global states and solutions:</b> global state changes can lead to unpredictable behavior and can make it impossible to know what the changes in the code lead to.  The RIBs-based architecture encourages encapsulated states in the deep hierarchy of well-isolated RIBs, thus avoiding problems with global states. </li><li>  <b>Testability and isolation:</b> classes must be simple in order to write unit tests and have a reason to be isolated (refer to <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25B8%25D0%25BD%25D1%2586%25D0%25B8%25D0%25BF_%25D0%25B5%25D0%25B4%25D0%25B8%25D0%25BD%25D1%2581%25D1%2582%25D0%25B2%25D0%25B5%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25B9_%25D0%25BE%25D1%2582%25D0%25B2%25D0%25B5%25D1%2582%25D1%2581%25D1%2582%25D0%25B2%25D0%25B5%25D0%25BD%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D0%25B8">SRP</a> ).  Individual RIB classes have different responsibilities (for example, routing, business logic, presentation logic, creating other RIB classes).  In addition, the logic of the parent RIB is basically separated from the logic of the child RIB.  This makes it easy to test RIB classes and reduce dependency between system components. </li><li>  <b>Tools for productive development:</b> borrowing nontrivial architectural patterns can lead to problems with the growth of the application, if there are no reliable tools to support the architecture.  The RIBs architecture comes with IDE tools for code generation, static analysis, and runtime integration, which improves the productivity of developers in large and small teams. </li><li>  <b>The principle of open-closed:</b> developers, if possible, should add new features without changing the existing code.  When using RIBs, the implementation of this rule can be seen in a number of places.  For example, you can attach or create a complex child RIB that requires dependencies on its parent RIB, with little or no change in the parent RIB. </li><li>  <b>Structuring around business logic: the</b> structure of the business logic of the application should not strictly reflect the structure of the user interface.  For example, to facilitate the animation and performance of a view, the view hierarchy may be smaller than the RIB hierarchy.  Or, a single RIB function can control the appearance of three views that are displayed in different places in the user interface. </li><li>  <b>Exact Contracts:</b> Requirements must be announced using contracts that are checked at compile time.  A class should not compile if its own dependencies as well as guest dependencies are not satisfied.  The RIBs architecture uses <a href="http://reactivex.io/">ReactiveX</a> to represent guest dependencies, type-safe dependency injection ( <a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D0%25BD%25D0%25B5%25D0%25B4%25D1%2580%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25B7%25D0%25B0%25D0%25B2%25D0%25B8%25D1%2581%25D0%25B8%25D0%25BC%25D0%25BE%25D1%2581%25D1%2582%25D0%25B8">DI</a> ) systems to represent class dependencies, and many other DI features to help create data invariants. </li></ul><br><h2>  Constituent elements of RIBs </h2><br>  If you have previously worked with the <a href="https://mutualmobile.com/resources/meet-viper-fast-agile-non-lethal-ios-architecture-framework">VIPER</a> architecture, then the classes that are part of the RIB will look familiar to you.  RIBs typically consist of the following elements, each of which is implemented in its class: <br><br><img src="https://habrastorage.org/webt/y2/ty/pq/y2typqu-pshcmfbwtu5y6hqcxgs.png"><br><br><h4>  Interactor </h4><br>  Interactor contains business logic.  In this class, a subscription to Rx notifications occurs, decisions are made on state changes, data storage and attachment of child RIBs. <br><br>  All operations performed in Interactor should be limited to its life cycle.  Uber has created a toolkit to ensure that business logic is executed only with active interaction.  This prevents Interactors from being deactivated, but Rx subscriptions still work and cause unwanted updates to the business logic or state of the user interface. <br><br><h4>  Router </h4><br>  Router tracks events from Interactor and converts these events into attaching and detaching child RIBs.  Router exists for three simple reasons: <br><br><ul><li>  Router exists as a passive object, which simplifies testing complex Interactor logic without the need to create stubs for child Interactors or in any other way take care of their existence. </li><li>  Routers create an additional level of abstraction between parent and child Interactors.  This makes synchronous communication between Interactors a bit more complicated and encourages the use of Rx communication instead of direct communication between RIBs. </li><li>  Routers contain simple and repetitive routing logic that would otherwise be implemented in Interactors.  Transferring this template code to the Routers helps Interactors to be small and more focused on the core business logic of the RIB. </li></ul><br><h4>  Builder </h4><br>  Builder is needed to create instances for all classes included in the RIB, as well as create instances of Builders for child RIBs. <br><br>  Highlighting class creation logic in Builder adds support for stub creation in iOS and makes the rest of the RIB code insensitive to the details of the DI implementation.  Builder is the only part of the RIB that needs to be aware of the DI system used in the project.  By implementing another Builder, you can reuse the rest of the RIB code in a project using a different DI mechanism. <br><br><h4>  Presenter </h4><br>  Presenter is a stateless class that translates a business model into a presentation model and vice versa.  It can be used to facilitate the testing of view model transformations.  However, this translation is often so trivial that it does not justify the creation of a separate class Presenter.  If Presenter is not done, the translation of the view models becomes the responsibility of the View (Controller) or Interactor. <br><br><h4>  View (Controller) </h4><br>  View creates and updates the user interface.  It includes the creation and arrangement of interface components, the processing of user interaction, the filling of user interface components with data, and animation.  View is designed to be as ‚Äústupid‚Äù (passive) as possible.  They simply display information.  In general, they do not contain any code for which unit tests should be written. <br><br><h4>  Component </h4><br>  Component is used to manage RIB dependencies.  It helps Builder create instances of other classes that make up the RIB.  The component provides access to external dependencies required to create a RIB, as well as its own dependencies created by the RIB itself, and control access to them from other RIBs.  A parent RIB component is typically embedded in a child RIB Builder to give the child RIB access to the dependencies of the parent RIB. <br><br><h2>  State management </h2><br>  The state of the application is mainly controlled and presented by the RIBs that are currently connected to the RIB tree.  For example, as the user navigates through various states in a simplified application for collaborative travel, the application appends and separates the following RIBs: <br><br><img src="https://habrastorage.org/webt/cu/rb/qi/curbqinjkn7jtifrtfchuuicpcw.gif"><br><br>  RIBs only make state decisions within their competence.  For example, LoggedIn RIB only decides to transition between states such as Request and OnTrip.  It does not make any decisions about how the system should behave when we are on the OnTrip screen. <br><br>  Not all states can be saved by adding or removing RIBs.  For example, when user profile settings change, the RIB is not associated or disconnected.  As a rule, we save this state inside streams of immutable models that re-send values ‚Äã‚Äãwhen parts change.  For example, a user name can be stored in a ProfileDataStream file that is within the scope of LoggedIn.  Only network responses have write access to this stream.  We pass an interface that provides read access to these threads down the DI column. <br><br>  There is nothing in RIBs that is the ultimate truth for the state of RIB.  This contrasts with the fact that more masterful frameworks, such as React, are already provided out of the box.  In the context of each RIB, you can choose templates that facilitate a unidirectional data flow, or you can let the state of business logic and the state of the view temporarily deviate from the norm to take advantage of effective platform animation frameworks. <br><br><h2>  Interaction between RIBs </h2><br>  When Interactor makes a decision related to business logic, it may need to inform the other RIB about events, such as the completion and sending of data.  RIB framework does not include any single way to transfer data between RIBs.  However, this method was created in order to facilitate some common patterns. <br><br>  As a rule, if the link goes down to the child RIB, then we pass this information as events in the Rx stream.  Or, the data can be included as a parameter in the <i>build ()</i> method of the child RIB, in which case this parameter becomes an invariant for the lifetime of the child. <br><br><img src="https://habrastorage.org/webt/zm/nn/qx/zmnnqxbgmheebcy67ma8syhmrra.png"><br><br>  If the link goes up the RIB tree to the parent RIB Interactor, then this link is made through the listener interface, since the parent RIB can have a longer life cycle than the child RIB.  The parent RIB, or some object on its DI graph, implements the listener interface and places it on its DI graph, so that its child RIBs can call it.  Using this template to send data up instead of parent RIBs directly subscribing to their child RIBs Rx streams has several advantages.  It prevents memory leaks, allows you to write, test and maintain parent RIBs without knowing which child RIBs are attached to them, and also reduces the amount of fuss necessary to attach / detach a child RIB.  Rx streams or listeners do not need to unregister or re-register with this method of attaching a child RIB. <br><br><img src="https://habrastorage.org/webt/lr/vq/ub/lrvqub8q19lm_yjquiniht0owrm.png"><br><br><h2>  Rib toolkit </h2><br>  To ensure the smooth implementation of the RIB architecture in applications, Uber engineers have created tools to simplify the use of RIB and the use of invariants created by implementing the RIB architecture.  The source code of this toolkit was partially opened and is mentioned in the <a href="https://github.com/uber/RIBs/wiki">examples</a> (see the right part - comment. Per.). <br><br>  The toolkit, which is currently open source, includes: <br><br><ul><li> <b>Code Generator:</b> IDE plugins for creating new RIBs and related tests. <br><ul><li>  <a href="https://github.com/uber/RIBs/tree/master/ios/tooling">IOS Code Generation Templates for Xcode</a> </li><li>  <a href="https://github.com/uber/RIBs/tree/master/android/tooling/rib-intellij-plugin">Code Generation Plugin for Android</a> </li></ul><br></li><li>  <b>NPE Static Analyzer (Android):</b> <a href="https://github.com/uber/NullAway">NullAway</a> is a static analysis tool that allows you to forget about NullPointerExceptions. </li><li>  <b>Static auto-placement analyzer (Android):</b> prevents the most common memory leaks in the RIB. </li></ul><br>  Tools where Uber plans to open source code in the future: <br><br><ul><li>  Static analyzer to prevent various memory leaks in the RIB </li><li>  RIB integration with memory leak detection during program execution </li><li>  (Android) annotation processors to simplify testing </li><li>  (Android) Static analyzer RxJava, which provides RIBs with views that cannot be changed from the main stream (views) </li></ul><br><h2>  PS </h2><br>  We in <a href="http://sports.ru/">sports.ru</a> really liked the approach of Uber engineers, because  we have many times faced with all the architectural problems that the article described.  Despite the forethought, RIB has a number of drawbacks, for example, a rather high threshold for entering the architecture.  We will analyze in more detail the pros and cons of the architecture in the following articles; at least two of them are planned - for iOS and for Android.  For those who want to dive into the RIB right now, there is a column on the wiki page on which there are lessons in English.  From myself, I note that the architecture was clearly born in long technical discussions and gathered in itself the best practices of building architectures for mobile applications that are currently available.  And finally, a bit of PR - we also like technical discussions at <a href="http://sports.ru/">sports.ru</a> , often hold technical workshops for colleagues, regularly learn new technologies and in general we have a cool atmosphere.  So if you want to be part of our team - <a href="http://careers.tribuna.digital/">welcome</a> ! </div><p>Source: <a href="https://habr.com/ru/post/424305/">https://habr.com/ru/post/424305/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../424287/index.html">How we participated in InnovateFPGA 2018 and again did not win</a></li>
<li><a href="../424289/index.html">MIT course "Computer Systems Security". Lecture 9: "Web Application Security", part 1</a></li>
<li><a href="../424295/index.html">MIT course "Computer Systems Security". Lecture 9: "Web Application Security", part 2</a></li>
<li><a href="../424297/index.html">MIT course "Computer Systems Security". Lecture 9: "Web Application Security", part 3</a></li>
<li><a href="../424301/index.html">Adaptive Neural Network Image Filter Algorithm</a></li>
<li><a href="../424307/index.html">GitLab 11.3 Released with Maven and Secure environments Repository</a></li>
<li><a href="../424309/index.html">DevCore: DevBoy software part</a></li>
<li><a href="../424311/index.html">Asynchronous business logic today</a></li>
<li><a href="../424313/index.html">EveryLang is a program that can do almost anything.</a></li>
<li><a href="../424315/index.html">New round of import substitution. Where to run and what to do?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>