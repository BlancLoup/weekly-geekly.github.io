<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Reinforced.Typings - TypeScript Angular services directly from your MVC controllers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello 
 And here, another (and last) article is an example of my framework for generating a TypeScript glue code: Reinforced.Typings (before that ther...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Reinforced.Typings - TypeScript Angular services directly from your MVC controllers</h1><div class="post__text post__text-html js-mediator-article">  Hello <br>  And here, another (and last) article is an example of my framework for generating a TypeScript glue code: Reinforced.Typings (before that there was <a href="https://habrahabr.ru/post/267003">another one</a> and <a href="https://habrahabr.ru/post/266899">more</a> ).  Today, we learn how to automatically generate TypeScript wrappers for calls to MVC controller methods, provide them with documentation and lay them out in different files.  I hope you will appreciate how quickly and easily such problems are solved using RT.  As part of my tutorial, we implement the generation of a helper class for calling controller methods using jQuery and promises, as well as a service for angular.js, which is ready for embedding into your application and bringing transparent calls to server methods.  Next, we will include in the generated TypeScript documentation for this case (import from XMLDOC) and decompose it in files so that it does not mix.  Anyone interested and willing to have such a thing in their projects, welcome under cat. <br><a name="habracut"></a><br><h1>  Prologue </h1><br>  In short, RT uses the code generator system to generate the source TypeScript code.  Recently (version 1.2.0) I abandoned the practice of writing TypeScript code directly into an open text stream (which was inconvenient, but very quickly) and came to the practice of using a very simple <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25B1%25D1%2581%25D1%2582%25D1%2580%25D0%25B0%25D0%25BA%25D1%2582%25D0%25BD%25D0%25BE%25D0%25B5_%25D1%2581%25D0%25B8%25D0%25BD%25D1%2582%25D0%25B0%25D0%25BA%25D1%2581%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B5_%25D0%25B4%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B2%25D0%25BE">AST (Abstract Syntax Tree)</a> .  In fact, this tree is very basic, far from complete, and it is focused on TypeScript declaration elements.  Well, that is, without expressions, statements, switches, variable creatures, etc.  Only classes / interfaces, methods, fields, modules.  After the introduction of AST, I will not hide, it became easier.  Including formatting the displayed code, as opposed to the old solution, when the user had to take care of formatting on his own.  Yes, of course, in a certain sense, this is a compromise in usher of flexibility, but in terms of profitability and ease of use, but in general, it seems to me, the game is worth the candle.  In addition, in the main places no one restricts you in the type of tree nodes.  What does it mean?  And this means that you can insert an abusive commentary (even multi-line) into the middle of a class through AST.  Yes, yes, and he also correctly set the tab at the beginning of the line.  Well, let's get started. <br><h1>  Right off the bat </h1><br>  Let me explain with a simple example - generating jQuery wrappers with promises for controller calls.  Because the angular way may be alien to someone, but with jQuery, in general, everything is clear. <br><br>  So, this is given: a simple ASP.NET MVC application, jQuery, a controller with methods that you want to pull from the client's TypeScript, several View models and your itchy hands. <br>  Task: set the server API in the TypeScript class, so as not to be steamed with the constant $ .post / $. Load, or, well, $ .ajax. <br>  Decision: <br><br><h2>  Step 0. Infrastructure </h2><br>  I will mark here the test code that we have, so that it is something to make a start from. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Modelka: <br><blockquote><ol><li></li><li> <code><font color="black"><font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>class</b></font> SampleResponseModel <font color="#008000">{</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>string</b></font> Message <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>bool</b></font> Success <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>string</b></font> CurrentTime <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#008000">}</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>class</b></font> SampleResponseModel { <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>string</b></font> Message <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>bool</b></font> Success <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>string</b></font> CurrentTime <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#008000">}</font></font></font></code> </li> <li> <code><font color="black"><font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>class</b></font> SampleResponseModel <font color="#008000">{</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>string</b></font> Message <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>bool</b></font> Success <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>string</b></font> CurrentTime <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#008000">}</font></font></code> </li> <li> <code><font color="black"><font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>class</b></font> SampleResponseModel <font color="#008000">{</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>string</b></font> Message <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>bool</b></font> Success <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>string</b></font> CurrentTime <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#008000">}</font></font></code> </li> <li> <code><font color="black"><font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>class</b></font> SampleResponseModel <font color="#008000">{</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>string</b></font> Message <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>bool</b></font> Success <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>string</b></font> CurrentTime <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#008000">}</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>class</b></font> SampleResponseModel <font color="#008000">{</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>string</b></font> Message <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>bool</b></font> Success <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>string</b></font> CurrentTime <font color="#008000">{</font> <font color="#0600FF"><b>get</b></font> <font color="#008000">;</font> <font color="#0600FF"><b>set</b></font> <font color="#008000">;</font> <font color="#008000">}</font> }</font></font></code> </li> <li></li></ol></blockquote><br><br>  Controller: <br><br><blockquote><ol><li></li><li>  <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>class</b></font> JQueryController <font color="#008000">:</font> Controller </li><li>  <font color="#008000">{</font> </li><li>  <font color="#0600FF"><b>public</b></font> ActionResult SimpleIntMethod <font color="#008000">(</font> <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  <font color="#0600FF"><b>return</b></font> Json <font color="#008000">(</font> <font color="#008000">new</font> Random <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">.</font> <font color="#0000FF">Next</font> <font color="#008000">(</font> <font color="#FF0000">100</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li>  <font color="#008000">}</font> </li><li></li><li>  <font color="#0600FF"><b>public</b></font> ActionResult MethodWithParameters <font color="#008000">(</font> <font color="#6666cc"><b>int</b></font> num, <font color="#6666cc"><b>string</b></font> s, <font color="#6666cc"><b>bool</b></font> boolValue <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  <font color="#0600FF"><b>return</b></font> Json <font color="#008000">(</font> <font color="#6666cc"><b>string</b></font> <font color="#008000">.</font> <font color="#0000FF">Format</font> <font color="#008000">(</font> <font color="#666666">"{0} - {1} - {2}"</font> , num, s, boolValue <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li>  <font color="#008000">}</font> </li><li></li><li>  <font color="#0600FF"><b>public</b></font> ActionResult ReturningObject <font color="#008000">(</font> <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  <font color="#0600FF"><b>var</b></font> result <font color="#008000">=</font> <font color="#008000">new</font> SampleResponseModel <font color="#008000">(</font> <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  CurrentTime <font color="#008000">=</font> DateTime <font color="#008000">.</font>  <font color="#0000FF">Now</font> <font color="#008000">.</font>  <font color="#0000FF">ToLongTimeString</font> <font color="#008000">(</font> <font color="#008000">)</font> , </li><li>  Message <font color="#008000">=</font> <font color="#666666">"Hello!"</font>  , </li><li>  Success <font color="#008000">=</font> <font color="#0600FF"><b>true</b></font> </li><li>  <font color="#008000">}</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>return</b></font> Json <font color="#008000">(</font> result <font color="#008000">)</font> <font color="#008000">;</font> </li><li>  <font color="#008000">}</font> </li><li></li><li>  <font color="#0600FF"><b>public</b></font> ActionResult ReturningObjectWithParameters <font color="#008000">(</font> <font color="#6666cc"><b>string</b></font> echo <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  <font color="#0600FF"><b>var</b></font> result <font color="#008000">=</font> <font color="#008000">new</font> SampleResponseModel <font color="#008000">(</font> <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  CurrentTime <font color="#008000">=</font> DateTime <font color="#008000">.</font>  <font color="#0000FF">Now</font> <font color="#008000">.</font>  <font color="#0000FF">ToLongTimeString</font> <font color="#008000">(</font> <font color="#008000">)</font> , </li><li>  Message <font color="#008000">=</font> echo, </li><li>  Success <font color="#008000">=</font> <font color="#0600FF"><b>true</b></font> </li><li>  <font color="#008000">}</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>return</b></font> Json <font color="#008000">(</font> result <font color="#008000">)</font> <font color="#008000">;</font> </li><li>  <font color="#008000">}</font> </li><li></li><li>  <font color="#0600FF"><b>public</b></font> ActionResult VoidMethodWithParameters <font color="#008000">(</font> SampleResponseModel model <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  <font color="#0600FF"><b>return</b></font> <font color="#0600FF"><b>null</b></font> <font color="#008000">;</font> </li><li>  <font color="#008000">}</font> </li><li>  <font color="#008000">}</font> </li><li></li></ol></blockquote><br><br>  In addition, we will get a TypeScript file (which I have in /Scripts/IndexPage.ts) for testing.  Here is this (for example, MVVM followers forgive me, the material below will be for you): <br><br><blockquote><ol><li></li><li>  module Reinforced.  <font color="#660066">Typings</font> .  <font color="#660066">Samples</font> .  <font color="#660066">Difficult</font> .  <font color="#660066">CodeGenerators</font> .  <font color="#660066">Pages</font> <font color="#009900">{</font> </li><li>  <font color="#FF0000">export</font> <font color="#FF0000">class</font> IndexPage <font color="#009900">{</font> </li><li>  constructor <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  $ <font color="#009900">(</font> <font color="#3366CC">'#btnSimpleInt'</font> <font color="#009900">)</font> .  <font color="#660066">click</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> . <font color="#660066">btnSimpleIntClick</font> . <font color="#660066">bind</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  $ <font color="#009900">(</font> <font color="#3366CC">'#btnMethodWithParameters'</font> <font color="#009900">)</font> .  <font color="#660066">click</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> . <font color="#660066">btnMethodWithParametersClick</font> . <font color="#660066">bind</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  $ <font color="#009900">(</font> <font color="#3366CC">'#btnReturningObject'</font> <font color="#009900">)</font> .  <font color="#660066">click</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> . <font color="#660066">btnReturningObjectClick</font> . <font color="#660066">bind</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li></li><li>  private btnSimpleIntClick <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <font color="#009900">}</font> </li><li></li><li>  private btnMethodWithParametersClick <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <font color="#009900">}</font> </li><li></li><li>  private btnReturningObjectClick <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> </li><li></li></ol></blockquote><br><br>  <b>Important!</b>  Don't forget to set yourself the jQuery taypings from NuGet from DefinitelyTyped.  Otherwise, there will be problems with compiling TS. <br><br>  Well and a sin not to make test (it is supposed that jQuery at you is already connected).  Rewrite your Index.cshtml, for example, like this: <br><br><blockquote><ol><li></li><li>  <font color="#009900">&lt; <font color="#000000"><b>span</b></font> <font color="#000066">id</font> <font color="#66cc66">=</font> <font color="#ff0000">"loading"</font> &gt; &lt; <font color="#66cc66">/</font> <font color="#000000"><b>span</b></font> &gt;</font> </li><li>  Result: <font color="#009900">&lt; <font color="#000000"><b>strong</b></font> <font color="#000066">id</font> <font color="#66cc66">=</font> <font color="#ff0000">"result"</font> &gt; &lt; <font color="#66cc66">/</font> <font color="#000000"><b>strong</b></font> &gt;</font> </li><li>  <font color="#009900">&lt; <font color="#000000"><b>button</b></font> <font color="#000066">class</font> <font color="#66cc66">=</font> <font color="#ff0000">"btn btn-primary"</font> <font color="#000066">id</font> <font color="#66cc66">=</font> <font color="#ff0000">"btnSimpleInt"</font> &gt;</font> Tynts <font color="#009900">&lt; <font color="#66cc66">/</font> <font color="#000000"><b>button</b></font> &gt;</font> </li><li>  <font color="#009900">&lt; <font color="#000000"><b>button</b></font> <font color="#000066">class</font> <font color="#66cc66">=</font> <font color="#ff0000">"btn btn-default"</font> <font color="#000066">id</font> <font color="#66cc66">=</font> <font color="#ff0000">"btnMethodWithParameters"</font> &gt;</font> Klac <font color="#009900">&lt; <font color="#66cc66">/</font> <font color="#000000"><b>button</b></font> &gt;</font> </li><li>  <font color="#009900">&lt; <font color="#000000"><b>button</b></font> <font color="#000066">class</font> <font color="#66cc66">=</font> <font color="#ff0000">"btn btn-default"</font> <font color="#000066">id</font> <font color="#66cc66">=</font> <font color="#ff0000">"btnReturningObject"</font> &gt;</font> Bums <font color="#009900">&lt; <font color="#66cc66">/</font> <font color="#000000"><b>button</b></font> &gt;</font> </li><li>  <font color="#009900">&lt; <font color="#000000"><b>button</b></font> <font color="#000066">class</font> <font color="#66cc66">=</font> <font color="#ff0000">"btn btn-default"</font> <font color="#000066">id</font> <font color="#66cc66">=</font> <font color="#ff0000">"btnReturningObjectWithParameters"</font> &gt;</font> Bidd <font color="#009900">&lt; <font color="#66cc66">/</font> <font color="#000000"><b>button</b></font> &gt;</font> </li><li>  <font color="#009900">&lt; <font color="#000000"><b>button</b></font> <font color="#000066">class</font> <font color="#66cc66">=</font> <font color="#ff0000">"btn btn-default"</font> <font color="#000066">id</font> <font color="#66cc66">=</font> <font color="#ff0000">"btnVoidMethodWithParameters"</font> &gt;</font> Quack!  <font color="#009900">&lt; <font color="#66cc66">/</font> <font color="#000000"><b>button</b></font> &gt;</font> </li><li>  @section Scripts </li><li>  { </li><li>  <font color="#009900">&lt; <font color="#000000"><b>script</b></font> <font color="#000066">type</font> <font color="#66cc66">=</font> <font color="#ff0000">"text / javascript"</font> <font color="#000066">src</font> <font color="#66cc66">=</font> <font color="#ff0000">"/Scripts/IndexPage.js"</font> &gt; &lt; <font color="#66cc66">/</font> <font color="#000000"><b>script</b></font> &gt;</font> </li><li>  <font color="#009900">&lt; <font color="#000000"><b>script</b></font> <font color="#000066">type</font> <font color="#66cc66">=</font> <font color="#ff0000">"text / javascript"</font> <font color="#000066">src</font> <font color="#66cc66">=</font> <font color="#ff0000">"/Scripts/query.js"</font> &gt; &lt; <font color="#66cc66">/</font> <font color="#000000"><b>script</b></font> &gt;</font> </li><li>  <font color="#009900">&lt; <font color="#000000"><b>script</b></font> <font color="#000066">type</font> <font color="#66cc66">=</font> <font color="#ff0000">"text / javascript"</font> &gt;</font> </li><li>  $ (document) .ready (function () { </li><li>  var a = new Reinforced.Typings.Samples.Difficult.CodeGenerators.Pages.IndexPage (); </li><li>  }) </li><li>  <font color="#009900">&lt; <font color="#66cc66">/</font> <font color="#000000"><b>script</b></font> &gt;</font> </li><li>  } </li><li></li></ol></blockquote><br><br>  You must have noticed the inclusion of query.js in the document.  Do not worry - it is necessary, in the next section I will explain what's what. <br><br>  Everything, it was a footcloth test infrastructure.  It will be easier later. <br><br><h2>  Step 1. Requests </h2><br>  First of all, let's move only one method into a separate TypeScript class, which we will use to query the server.  Just jQuery in this regard is somewhat cumbersome and I would not like to repeat all this sample code in each method for the sake of readability.  So, a small class with a small method to make requests to the server: <br><br>  /Scripts/query.ts <br><br><blockquote><ol><li></li><li>  <font color="#FF0000">class</font> QueryController <font color="#009900">{</font> </li><li>  public <font color="#000066"><b>static</b></font> query <font color="#339933">&lt;</font> T <font color="#339933">&gt;</font> <font color="#009900">(</font> url <font color="#339933">:</font> string <font color="#339933">,</font> data <font color="#339933">:</font> any <font color="#339933">,</font> progressSelector <font color="#339933">:</font> string <font color="#339933">,</font> disableSelector <font color="#339933">:</font> string <font color="#339933">=</font> <font color="#3366CC">''</font> <font color="#009900">)</font> <font color="#339933">:</font> JQueryPromise <font color="#339933">&lt;</font> T <font color="#339933">&gt;</font> <font color="#009900">{</font> </li><li>  <font color="#000066"><b>var</b></font> promise <font color="#339933">=</font> jQuery.  <font color="#660066">Deferred</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#000066"><b>var</b></font> query <font color="#339933">=</font> <font color="#009900">{</font> </li><li>  data <font color="#339933">:</font> JSON.  <font color="#660066">stringify</font> <font color="#009900">(</font> data <font color="#009900">)</font> </li><li>  type <font color="#339933">:</font> <font color="#3366CC">'post'</font> <font color="#339933">,</font> </li><li>  dataType <font color="#339933">:</font> <font color="#3366CC">'json'</font> <font color="#339933">,</font> </li><li>  contentType <font color="#339933">:</font> <font color="#3366CC">'application / json'</font> <font color="#339933">,</font> </li><li>  timeout <font color="#339933">:</font> <font color="#CC0000">9000000</font> </li><li>  traditional <font color="#339933">:</font> <font color="#003366"><b>false</b></font> <font color="#339933">,</font> </li><li>  complete <font color="#339933">:</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">=&gt;</font> <font color="#009900">{</font> </li><li>  <font color="#000066"><b>if</b></font> <font color="#009900">(</font> progressSelector <font color="#339933">&amp;&amp;</font> progressSelector. <font color="#660066">length</font> <font color="#339933">&gt;</font> <font color="#CC0000">0</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  $ <font color="#009900">(</font> progressSelector <font color="#009900">)</font> .  <font color="#660066">find</font> <font color="#009900">(</font> <font color="#3366CC">'span [data-role = "progressContainer"]'</font> <font color="#009900">)</font> .  <font color="#660066">remove</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#000066"><b>if</b></font> <font color="#009900">(</font> disableSelector <font color="#339933">&amp;&amp;</font> disableSelector. <font color="#660066">length</font> <font color="#339933">&gt;</font> <font color="#CC0000">0</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  $ <font color="#009900">(</font> disableSelector <font color="#009900">)</font> .  <font color="#660066">prop</font> <font color="#009900">(</font> <font color="#3366CC">'disabled'</font> <font color="#339933">,</font> <font color="#003366"><b>false</b></font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> <font color="#339933">,</font> </li><li>  success <font color="#339933">:</font> <font color="#009900">(</font> response <font color="#339933">:</font> T <font color="#009900">)</font> <font color="#339933">=&gt;</font> <font color="#009900">{</font> </li><li>  promise.  <font color="#660066">resolve</font> <font color="#009900">(</font> response <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> <font color="#339933">,</font> </li><li>  error <font color="#339933">:</font> <font color="#009900">(</font> request <font color="#339933">,</font> status <font color="#339933">,</font> error <font color="#009900">)</font> <font color="#339933">=&gt;</font> <font color="#009900">{</font> </li><li>  promise.  <font color="#660066">reject</font> <font color="#009900">(</font> <font color="#009900">{</font> Success <font color="#339933">:</font> <font color="#003366"><b>false</b></font> <font color="#339933">,</font> Message <font color="#339933">:</font> error. <font color="#660066">toString</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">,</font> Data <font color="#339933">:</font> error <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> <font color="#339933">;</font> </li><li></li><li>  <font color="#000066"><b>if</b></font> <font color="#009900">(</font> progressSelector <font color="#339933">&amp;&amp;</font> progressSelector. <font color="#660066">length</font> <font color="#339933">&gt;</font> <font color="#CC0000">0</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  $ <font color="#009900">(</font> progressSelector <font color="#009900">)</font> .  <font color="#660066">append</font> <font color="#009900">(</font> <font color="#3366CC">'&lt;span data-role = "progressContainer"&gt; Loading ... &lt;/ span&gt;'</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li></li><li>  <font color="#000066"><b>if</b></font> <font color="#009900">(</font> disableSelector <font color="#339933">&amp;&amp;</font> disableSelector. <font color="#660066">length</font> <font color="#339933">&gt;</font> <font color="#CC0000">0</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  $ <font color="#009900">(</font> disableSelector <font color="#009900">)</font> .  <font color="#660066">prop</font> <font color="#009900">(</font> <font color="#3366CC">'disabled'</font> <font color="#339933">,</font> <font color="#003366"><b>true</b></font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li></li><li>  $.  <font color="#660066">ajax</font> <font color="#009900">(</font> url <font color="#339933">, &lt;</font> any <font color="#339933">&gt;</font> query <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#000066"><b>return</b></font> promise <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> </li><li></li></ol></blockquote><br><br>  As you can see, the method is extremely simple; it takes as input the URL for the request, the data (any JS object), and also to make it easier to use, I made two parameters: one to designate the selector of the HTML element that should be disabled at the time of the request, and one ... Well, about the same, only for the element to which the inscription "Loading ..." will be subscribed.  I suppose it is self-evident that the inscription ‚ÄúLoading ...‚Äù you can easily replace with your own.  Returns this jQuery-yevsky Promise method to which you can add .then / .fail / .end and others.  However, I believe that the target audience of this article and without me know how to work with promises. :) <br><br><h2>  Step 2. Attributes </h2><br>  Since through reflection it is impossible to determine what our controller methods return, we will make an attribute that will mark all methods of our JQueryController, for which we need to generate a wrapper.  It will look, for example, like this: <br><br><blockquote><ol><li></li><li>  <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>class</b></font> JQueryMethodAttribute <font color="#008000">:</font> TsFunctionAttribute </li><li>  <font color="#008000">{</font> </li><li>  <font color="#0600FF"><b>public</b></font> JQueryMethodAttribute <font color="#008000">(</font> Type returnType <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  StrongType <font color="#008000">=</font> returnType <font color="#008000">;</font> </li><li>  CodeGeneratorType <font color="#008000">=</font> <font color="#008000">typeof</font> <font color="#008000">(</font> JQueryActionCallGenerator <font color="#008000">)</font> <font color="#008000">;</font> </li><li>  <font color="#008000">}</font> </li><li>  <font color="#008000">}</font> </li><li></li></ol></blockquote><br><br>  Here we kill two birds with one stone and specify the CodeGeneratorType for this method.  Do not worry that it is not there yet - we will write it in the next section.  As for the rest, the existing attribute can be placed above our controller methods.  At the same time we will put [TsClass], without departing from the cash register: <br><br><blockquote><ol><li></li><li>  <font color="#008000">[</font> TsClass <font color="#008000">]</font> </li><li>  <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>class</b></font> JQueryController <font color="#008000">:</font> Controller </li><li>  <font color="#008000">{</font> </li><li>  <font color="#008000">[</font> JQueryMethod <font color="#008000">(</font> <font color="#008000">typeof</font> <font color="#008000">(</font> <font color="#6666cc"><b>int</b></font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">]</font> </li><li>  <font color="#0600FF"><b>public</b></font> ActionResult SimpleIntMethod <font color="#008000">(</font> <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  <font color="#008080"><i>// fold</i></font> </li><li>  <font color="#008000">}</font> </li><li></li><li>  <font color="#008000">[</font> JQueryMethod <font color="#008000">(</font> <font color="#008000">typeof</font> <font color="#008000">(</font> <font color="#6666cc"><b>string</b></font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">]</font> </li><li>  <font color="#0600FF"><b>public</b></font> ActionResult MethodWithParameters <font color="#008000">(</font> <font color="#6666cc"><b>int</b></font> num, <font color="#6666cc"><b>string</b></font> s, <font color="#6666cc"><b>bool</b></font> boolValue <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  <font color="#008080"><i>// fold</i></font> </li><li>  <font color="#008000">}</font> </li><li></li><li>  <font color="#008000">[</font> JQueryMethod <font color="#008000">(</font> <font color="#008000">typeof</font> <font color="#008000">(</font> SampleResponseModel <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">]</font> </li><li>  <font color="#0600FF"><b>public</b></font> ActionResult ReturningObject <font color="#008000">(</font> <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  <font color="#008080"><i>// fold</i></font> </li><li>  <font color="#008000">}</font> </li><li></li><li>  <font color="#008000">[</font> JQueryMethod <font color="#008000">(</font> <font color="#008000">typeof</font> <font color="#008000">(</font> SampleResponseModel <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">]</font> </li><li>  <font color="#0600FF"><b>public</b></font> ActionResult ReturningObjectWithParameters <font color="#008000">(</font> <font color="#6666cc"><b>string</b></font> echo <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  <font color="#008080"><i>// fold</i></font> </li><li>  <font color="#008000">}</font> </li><li></li><li>  <font color="#008000">[</font> JQueryMethod <font color="#008000">(</font> <font color="#008000">typeof</font> <font color="#008000">(</font> <font color="#6666cc"><b>void</b></font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">]</font> </li><li>  <font color="#0600FF"><b>public</b></font> ActionResult VoidMethodWithParameters <font color="#008000">(</font> SampleResponseModel model <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  <font color="#008080"><i>// fold</i></font> </li><li>  <font color="#008000">}</font> </li><li>  <font color="#008000">}</font> </li><li></li></ol></blockquote><br><br>  Just do not forget to put [TsInterface] on the model.  Otherwise, as Hmayak Hakobyan used to say, ‚Äúno miracle will happen‚Äù. <br><br><blockquote><ol><li></li><li>  <font color="#008000">[</font> TsInterface <font color="#008000">]</font> </li><li>  <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>class</b></font> SampleResponseModel </li><li>  <font color="#008000">{</font> </li><li>  <font color="#008080"><i>// fold</i></font> </li><li>  <font color="#008000">}</font> </li><li></li></ol></blockquote><br><br><h2>  Step 3. Code generator </h2><br>  The theory is relatively simple.  RT collects in a heap information about what you want to see from your C # types in the resulting TypeScript and in what form, then begins to go round this good in depth, starting with namespaces and going down to the members of the class and the parameters of the declared methods.  Upon encountering this or that entity, RT calls the corresponding code generator (it instantiates instances of code generators lazily, with ‚Äú1 instance for the whole export process‚Äù with flytime).  This process can be influenced by specifying which code generator you want to use.  This can be done using the attribute configuration (CodeGeneratorType field, which is in any RT attribute) - there is no ‚Äúfool protection‚Äù, but it is assumed that you specify the typeof of the heir from the Reinforced.Typings.Generators.ITsCodeGenerator interface with the correct T corresponding to the entity above which is the attribute.  You can also use the Fluent call .WithCodeGenerator.  There is already a "foolproof" and you will not be able to specify an unsuitable code generator. <br>  There are several built-in code generators available.  They are all located in the Reinforced.Typings.Generators namespace.  There are code generators for the interface, class, constructor, enumeration, field, property, method, and method parameter.  The easiest way to make your code generator is to inherit from the existing one.  Further (by increasing complexity) - inherit from TsCodeGeneratorBase &lt;T1, T2&gt;, where T1 is the type of input reflection-entity, and T2 is the type of result in the syntax tree (heir to RtNode).  Well, the difficult option is to implement the ITsCodeGenerator on-line independently, which in most cases is not recommended, because it requires knowledge of some subtleties and reading the source, and there is no need. <br>  We will make our JQueryActionCallGenerator simply inheriting from the built-in code generator for methods.  So, here is our code generator with detailed comments: <br><br><blockquote><ol><li></li><li>  <font color="#0600FF"><b>using</b></font> <font color="#008080">System</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>using</b></font> <font color="#008080">System.Linq</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>using</b></font> <font color="#008080">System.Reflection</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>using</b></font> <font color="#008080">Reinforced.Typings.Ast</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>using</b></font> <font color="#008080">Reinforced.Typings.Generators</font> <font color="#008000">;</font> </li><li></li><li></li><li>  <font color="#008080"><i>/// &lt;summary&gt;</i></font> </li><li>  <font color="#008080"><i>/// Our code generator for wrappers on calls to the controller method.</i></font> </li><li>  <font color="#008080"><i>/// It is sharpened to take MethodInfo as input and produce as output</i></font> </li><li>  <font color="#008080"><i>/// instance of RtFunction, which is a piece of the syntax tree</i></font> </li><li>  <font color="#008080"><i>/// with TypeScript.</i></font> </li><li>  <font color="#008080"><i>/// As mentioned above, we inherit from the built-in RT MethodCodeGenerator,</i></font> </li><li>  <font color="#008080"><i>/// which normally generates a method with a signature and an empty implementation</i></font> </li><li>  <font color="#008080"><i>/// &lt;/ summary&gt;</i></font> </li><li>  <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>class</b></font> JQueryActionCallGenerator <font color="#008000">:</font> MethodCodeGenerator </li><li>  <font color="#008000">{</font> </li><li>  <font color="#008080"><i>/// &lt;summary&gt;</i></font> </li><li>  <font color="#008080"><i>/// Naturally, we overload the GenerateNode method.</i></font>  <font color="#008080"><i>Actually, it is almost the only</i></font> </li><li>  <font color="#008080"><i>/// and the main method in the code generator.</i></font> </li><li>  <font color="#008080"><i>/// &lt;/ summary&gt;</i></font> </li><li>  <font color="#008080"><i>/// &lt;param name = "element"&gt; Method for which code will be generated as MethodInfo &lt;/ param&gt;</i></font> </li><li>  <font color="#008080"><i>/// &lt;param name = "result"&gt;</i></font> </li><li>  <font color="#008080"><i>/// Result AST-node (RtFunction).</i></font> </li><li>  <font color="#008080"><i>/// We do not create a node from scratch.</i></font>  <font color="#008080"><i>And to be honest, I forgot why I made such an architectural decision :)</i></font> </li><li>  <font color="#008080"><i>/// But we can still return null to exclude the node / method from the final TypeScript file</i></font> </li><li>  <font color="#008080"><i>/// &lt;/ param&gt;</i></font> </li><li>  <font color="#008080"><i>/// &lt;param name = "resolver"&gt;</i></font> </li><li>  <font color="#008080"><i>/// And this is an instance of TypeResolver.</i></font>  <font color="#008080"><i>This is a special class that we can use.</i></font> </li><li>  <font color="#008080"><i>/// to display types in the resulting TypeScript, so as not to do anything by hand.</i></font> </li><li>  <font color="#008080"><i>/// &lt;/ param&gt;</i></font> </li><li>  <font color="#008080"><i>/// &lt;returns&gt; RtFunction (also known as the syntax tree node, also known as the AST node) &lt;/ returns&gt;</i></font> </li><li>  <font color="#0600FF"><b>public</b></font> <font color="#0600FF"><b>override</b></font> RtFuncion GenerateNode <font color="#008000">(</font> MethodInfo element, RtFuncion result, TypeResolver resolver <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  <font color="#008080"><i>// First, generate the "as usual" method wrapper</i></font> </li><li>  <font color="#008080"><i>// Next, we will expand and complement it</i></font> </li><li>  result <font color="#008000">=</font> <font color="#0600FF"><b>base</b></font> <font color="#008000">.</font>  <font color="#0000FF">GenerateNode</font> <font color="#008000">(</font> element, result, resolver <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// If for some reason an empty node is generated, then it should be</i></font> </li><li>  <font color="#008080"><i>// we will not interfere in this process</i></font> </li><li>  <font color="#0600FF"><b>if</b></font> <font color="#008000">(</font> result <font color="#008000">==</font> <font color="#0600FF"><b>null</b></font> <font color="#008000">)</font> <font color="#0600FF"><b>return</b></font> <font color="#0600FF"><b>null</b></font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// Make our method static</i></font> </li><li>  result <font color="#008000">.</font>  <font color="#0000FF">IsStatic</font> <font color="#008000">=</font> <font color="#0600FF"><b>true</b></font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// And also add a couple of extra parameters to the method to specify</i></font> </li><li>  <font color="#008080"><i>// element that will be disabled while the server method is being called,</i></font> </li><li>  <font color="#008080"><i>// as well as the element to which the loading indicator should be added</i></font> </li><li>  result <font color="#008000">.</font>  <font color="#0000FF">Arguments</font> <font color="#008000">.</font>  <font color="#0600FF"><b>Add</b></font> <font color="#008000">(</font> </li><li>  <font color="#008000">new</font> RtArgument <font color="#008000">(</font> <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  Identifier <font color="#008000">=</font> <font color="#008000">new</font> RtIdentifier <font color="#008000">(</font> <font color="#666666">"loadingPlaceholderSelector"</font> <font color="#008000">)</font> , </li><li>  Type <font color="#008000">=</font> resolver <font color="#008000">.</font>  <font color="#0000FF">ResolveTypeName</font> <font color="#008000">(</font> <font color="#008000">typeof</font> <font color="#008000">(</font> <font color="#6666cc"><b>string</b></font> <font color="#008000">)</font> <font color="#008000">)</font> , </li><li>  DefaultValue <font color="#008000">=</font> <font color="#666666">"''"</font> </li><li>  <font color="#008000">}</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  result <font color="#008000">.</font>  <font color="#0000FF">Arguments</font> <font color="#008000">.</font>  <font color="#0600FF"><b>Add</b></font> <font color="#008000">(</font> </li><li>  <font color="#008000">new</font> RtArgument <font color="#008000">(</font> <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  Identifier <font color="#008000">=</font> <font color="#008000">new</font> RtIdentifier <font color="#008000">(</font> <font color="#666666">"disableElement"</font> <font color="#008000">)</font> , </li><li>  Type <font color="#008000">=</font> resolver <font color="#008000">.</font>  <font color="#0000FF">ResolveTypeName</font> <font color="#008000">(</font> <font color="#008000">typeof</font> <font color="#008000">(</font> <font color="#6666cc"><b>string</b></font> <font color="#008000">)</font> <font color="#008000">)</font> , </li><li>  DefaultValue <font color="#008000">=</font> <font color="#666666">"''"</font> </li><li>  <font color="#008000">}</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// Store the original method return value</i></font> </li><li>  <font color="#008080"><i>// for further we need to parameterize it with jQueryPromise</i></font> </li><li>  <font color="#0600FF"><b>var</b></font> retType <font color="#008000">=</font> result <font color="#008000">.</font>  <font color="#0000FF">ReturnType</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// ... and if the return type is void, we just leave JQueryPromise &lt;any&gt;</i></font> </li><li>  <font color="#6666cc"><b>bool</b></font> isVoid <font color="#008000">=</font> <font color="#008000">(</font> retType <font color="#008000">is</font> RtSimpleTypeName <font color="#008000">)</font> <font color="#008000">&amp;&amp;</font> <font color="#008000">(</font> <font color="#008000">(</font> <font color="#008000">(</font> RtSimpleTypeName <font color="#008000">)</font> retType <font color="#008000">)</font> <font color="#008000">.</font> <font color="#0000FF">TypeName</font> <font color="#008000">==</font> <font color="#666666">"void"</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// here I use TypeResolver to get an AST node for the name of the type "any"</i></font> </li><li>  <font color="#008080"><i>// just to demonstrate the use of TypeResolver</i></font> </li><li>  <font color="#008080"><i>// (well, also because I'm lazy enough to create with any hands)</i></font> </li><li>  <font color="#0600FF"><b>if</b></font> <font color="#008000">(</font> isVoid <font color="#008000">)</font> retType <font color="#008000">=</font> resolver <font color="#008000">.</font>  <font color="#0000FF">ResolveTypeName</font> <font color="#008000">(</font> <font color="#008000">typeof</font> <font color="#008000">(</font> <font color="#6666cc"><b>object</b></font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// OK, redefine the return value of our method, wrapping it</i></font> </li><li>  <font color="#008080"><i>// in jQueryPromise</i></font> </li><li>  <font color="#008080"><i>// We use the RtSimpleType class, passing generic arguments to it,</i></font> </li><li>  <font color="#008080"><i>// so as not to write angle brackets</i></font> </li><li>  result <font color="#008000">.</font>  <font color="#0000FF">ReturnType</font> <font color="#008000">=</font> <font color="#008000">new</font> RtSimpleTypeName <font color="#008000">(</font> <font color="#666666">"JQueryPromise"</font> , <font color="#008000">new</font> <font color="#008000">[</font> <font color="#008000">]</font> <font color="#008000">{</font> retType <font color="#008000">}</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// Now it's up to the parameters.</i></font>  <font color="#008080"><i>We get them through reflection.</i></font> </li><li>  <font color="#008080"><i>// Next, we use the extension. GetName () to get the name of the parameter</i></font> </li><li>  <font color="#008080"><i>// This extension comes with Reinforced.Typings and returns the name of the parameter.</i></font> </li><li>  <font color="#008080"><i>// method with all potential overloads via Fluent configuration or</i></font> </li><li>  <font color="#008080"><i>// attribute [TsParameter]</i></font> </li><li>  <font color="#0600FF"><b>var</b></font> p <font color="#008000">=</font> element <font color="#008000">.</font>  <font color="#0000FF">GetParameters</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">.</font>  <font color="#0600FF"><b>Select</b></font> <font color="#008000">(</font> c <font color="#008000">=&gt;</font> <font color="#6666cc"><b>string</b></font> <font color="#008000">.</font> <font color="#0000FF">Format</font> <font color="#008000">(</font> <font color="#666666">"'{0}': {0}"</font> , c <font color="#008000">.</font> <font color="#0000FF">GetName</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// Link parameters to generate method body code</i></font> </li><li>  <font color="#0600FF"><b>var</b></font> dataParameters <font color="#008000">=</font> <font color="#6666cc"><b>string</b></font> <font color="#008000">.</font>  <font color="#0600FF"><b>Join</b></font> <font color="#008000">(</font> <font color="#666666">","</font> , p <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// Get the path to the controller</i></font> </li><li>  <font color="#008080"><i>// Here we have a simple solution that requires having a MVC route on / {controller} / {action}</i></font> </li><li>  <font color="#008080"><i>// it is assumed that he is (although whom I cheat, he is in 90% of applications)</i></font> </li><li>  <font color="#6666cc"><b>string</b></font> controller <font color="#008000">=</font> element <font color="#008000">.</font>  <font color="#0000FF">DeclaringType</font> <font color="#008000">.</font>  <font color="#0000FF">Name</font> <font color="#008000">.</font>  <font color="#0000FF">Replace</font> <font color="#008000">(</font> <font color="#666666">"Controller"</font> , <font color="#6666cc"><b>String</b></font> <font color="#008000">.</font> <font color="#0000FF">Empty</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li>  <font color="#6666cc"><b>string</b></font> path <font color="#008000">=</font> <font color="#6666cc"><b>String</b></font> <font color="#008000">.</font>  <font color="#0000FF">Format</font> <font color="#008000">(</font> <font color="#666666">"/ {0} / {1}"</font> , controller, element <font color="#008000">.</font> <font color="#0000FF">Name</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// Now let's create a glue-code with a call to QueryController, which we defined in query.ts</i></font> </li><li>  <font color="#6666cc"><b>string</b></font> code <font color="#008000">=</font> <font color="#6666cc"><b>String</b></font> <font color="#008000">.</font>  <font color="#0000FF">Format</font> <font color="#008000">(</font> </li><li>  <font color="#666666">@ "return QueryController.query &lt;{2}&gt; (</font> </li><li>  <font color="#666666">'{0}',</font> </li><li>  <font color="#666666">{{ {one} }},</font> </li><li>  <font color="#666666">loadingPlaceholderSelector,</font> </li><li>  <font color="#666666">disableElement</font> </li><li>  <font color="#666666">); "</font> , </li><li>  path, dataParameters, retType <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// Wrap the code in RtRaw and stuff as the body into our result</i></font> </li><li>  result <font color="#008000">.</font>  <font color="#0000FF">Body</font> <font color="#008000">=</font> <font color="#008000">new</font> RtRaw <font color="#008000">(</font> code <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// Now let's add some JSDOC to make the results of our work more obvious.</i></font> </li><li>  result <font color="#008000">.</font>  <font color="#0000FF">Documentation</font> <font color="#008000">=</font> <font color="#008000">new</font> RtJsdocNode <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">{</font> Description <font color="#008000">=</font> <font color="#6666cc"><b>String</b></font> <font color="#008000">.</font>  <font color="#0000FF">Format</font> <font color="#008000">(</font> <font color="#666666">"Wrapper method for call {0} of {1}"</font> , element <font color="#008000">.</font> <font color="#0000FF">Name</font> , element <font color="#008000">.</font> <font color="#0000FF">DeclaringType</font> <font color="#008000">.</font> <font color="#0000FF">Name</font> <font color="#008000">)</font> <font color="#008000">}</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// Actually, that's all.</i></font>  <font color="#008080"><i>Return RtFunction</i></font> </li><li>  <font color="#008080"><i>// According to the default settings of the config, this good will be recorded in the project.ts</i></font> </li><li>  <font color="#0600FF"><b>return</b></font> result <font color="#008000">;</font> </li><li>  <font color="#008000">}</font> </li><li>  <font color="#008000">}</font> </li><li></li></ol></blockquote><br><br>  Kodogenerator ready.  It remains only to make our project Rebuild.  If you have any difficulties with debugging generators, then you can use the Context generator property of type ExportContext.  In addition, there is a property Warnings, which is a collection of RtWarning-s.  Add there your own - it will appear in the Warnings window in the studio during the build (this feature was added just recently, in version 1.2.2). <br><br>  For those who can not wait, here is the result of the work of the code generator: <br><blockquote><ol><li></li><li>  module Reinforced.  <font color="#660066">Typings</font> .  <font color="#660066">Samples</font> .  <font color="#660066">Difficult</font> .  <font color="#660066">CodeGenerators</font> .  <font color="#660066">Models</font> <font color="#009900">{</font> </li><li>  <font color="#FF0000">export</font> <font color="#FF0000">interface</font> ISampleResponseModel </li><li>  <font color="#009900">{</font> </li><li>  Message <font color="#339933">:</font> string <font color="#339933">;</font> </li><li>  Success <font color="#339933">:</font> <font color="#FF0000">boolean</font> <font color="#339933">;</font> </li><li>  CurrentTime <font color="#339933">:</font> string <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> </li><li>  module Reinforced.  <font color="#660066">Typings</font> .  <font color="#660066">Samples</font> .  <font color="#660066">Difficult</font> .  <font color="#660066">CodeGenerators</font> .  <font color="#660066">Controllers</font> <font color="#009900">{</font> </li><li>  <font color="#FF0000">export</font> <font color="#FF0000">class</font> jQueryController </li><li>  <font color="#009900">{</font> </li><li>  <font color="#006600"><i>/ ** Wrapper method for call SimpleIntMethod of JQueryController * /</i></font> </li><li>  public <font color="#000066"><b>static</b></font> SimpleIntMethod <font color="#009900">(</font> loadingPlaceholderSelector <font color="#339933">:</font> string <font color="#339933">=</font> <font color="#3366CC">''</font> <font color="#339933">,</font> disableElement <font color="#339933">:</font> string <font color="#339933">=</font> <font color="#3366CC">''</font> <font color="#009900">)</font> <font color="#339933">:</font> JQueryPromise <font color="#339933">&lt;</font> number <font color="#339933">&gt;</font> </li><li>  <font color="#009900">{</font> </li><li>  <font color="#000066"><b>return</b></font> QueryController.  <font color="#660066">query</font> <font color="#339933">&lt;</font> number <font color="#339933">&gt;</font> <font color="#009900">(</font> </li><li>  <font color="#3366CC">'/ JQuery / SimpleIntMethod'</font> <font color="#339933">,</font> </li><li>  <font color="#009900">{</font> <font color="#009900">}</font> </li><li>  loadingPlaceholderSelector <font color="#339933">,</font> </li><li>  disableElement </li><li>  <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#006600"><i>/ ** Wrapper method for call MethodWithParameters of JQueryController * /</i></font> </li><li>  public <font color="#000066"><b>static</b></font> MethodWithParameters <font color="#009900">(</font> num <font color="#339933">:</font> number <font color="#339933">,</font> s <font color="#339933">:</font> string <font color="#339933">,</font> boolValue <font color="#339933">:</font> <font color="#FF0000">boolean</font> <font color="#339933">,</font> loadingPlaceholder <font color="#339933">:</font> string <font color="#339933">:</font> string <font color="#339933">=</font> <font color="#3366CC">''</font> <font color="#339933">,</font> disableElement <font color="#339933">:</font> string <font color="#339933">=</font> <font color="#3366CC">''</font> <font color="#009900">)</font> <font color="#339933">:</font> JQueryPromise <font color="#339933">&lt;</font> string <font color="#339933">&gt;</font> </li><li>  <font color="#009900">{</font> </li><li>  <font color="#000066"><b>return</b></font> QueryController.  <font color="#660066">query</font> <font color="#339933">&lt;</font> string <font color="#339933">&gt;</font> <font color="#009900">(</font> </li><li>  <font color="#3366CC">'/ JQuery / MethodWithParameters'</font> <font color="#339933">,</font> </li><li>  <font color="#009900">{</font> <font color="#3366CC">'num'</font> <font color="#339933">:</font> num <font color="#339933">,</font> <font color="#3366CC">'s'</font> <font color="#339933">:</font> s <font color="#339933">,</font> <font color="#3366CC">'boolValue'</font> <font color="#339933">:</font> boolValue <font color="#009900">}</font> <font color="#339933">,</font> </li><li>  loadingPlaceholderSelector <font color="#339933">,</font> </li><li>  disableElement </li><li>  <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#006600"><i>/ ** Wrapper method for call ReturningObject of JQueryController * /</i></font> </li><li>  public <font color="#000066"><b>static</b></font> ReturningObject <font color="#009900">(</font> loadingPlaceholderSelector <font color="#339933">:</font> string <font color="#339933">=</font> <font color="#3366CC">''</font> <font color="#339933">,</font> disableElement <font color="#339933">:</font> string <font color="#339933">=</font> <font color="#3366CC">''</font> <font color="#009900">)</font> <font color="#339933">:</font> JQueryPromise <font color="#339933">&lt;</font> Reinforced.  <font color="#660066">Typings</font> .  <font color="#660066">Samples</font> .  <font color="#660066">Difficult</font> .  <font color="#660066">CodeGenerators</font> .  <font color="#660066">Models</font> .  <font color="#660066">ISampleResponseModel</font> <font color="#339933">&gt;</font> </li><li>  <font color="#009900">{</font> </li><li>  <font color="#000066"><b>return</b></font> QueryController.  <font color="#660066">query</font> <font color="#339933">&lt;</font> Reinforced.  <font color="#660066">Typings</font> .  <font color="#660066">Samples</font> .  <font color="#660066">Difficult</font> .  <font color="#660066">CodeGenerators</font> .  <font color="#660066">Models</font> .  <font color="#660066">ISampleResponseModel</font> <font color="#339933">&gt;</font> <font color="#009900">(</font> </li><li>  <font color="#3366CC">'/ JQuery / ReturningObject'</font> <font color="#339933">,</font> </li><li>  <font color="#009900">{</font> <font color="#009900">}</font> </li><li>  loadingPlaceholderSelector <font color="#339933">,</font> </li><li>  disableElement </li><li>  <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#006600"><i>/ ** Wrapper method for call ReturningObjectWithParameters of JQueryController * /</i></font> </li><li>  public <font color="#000066"><b>static</b></font> ReturningObjectWithParameters <font color="#009900">(</font> echo <font color="#339933">:</font> string <font color="#339933">,</font> loadingPlaceholderSelector <font color="#339933">:</font> string <font color="#339933">=</font> <font color="#3366CC">''</font> <font color="#339933">,</font> disableElement <font color="#339933">:</font> string <font color="#339933">=</font> <font color="#3366CC">''</font> <font color="#009900">)</font> <font color="#339933">:</font> JQueryPromise <font color="#339933">&lt;</font> Reinforced.  <font color="#660066">Typings</font> .  <font color="#660066">Samples</font> .  <font color="#660066">Difficult</font> .  <font color="#660066">CodeGenerators</font> .  <font color="#660066">Models</font> .  <font color="#660066">ISampleResponseModel</font> <font color="#339933">&gt;</font> </li><li>  <font color="#009900">{</font> </li><li>  <font color="#000066"><b>return</b></font> QueryController.  <font color="#660066">query</font> <font color="#339933">&lt;</font> Reinforced.  <font color="#660066">Typings</font> .  <font color="#660066">Samples</font> .  <font color="#660066">Difficult</font> .  <font color="#660066">CodeGenerators</font> .  <font color="#660066">Models</font> .  <font color="#660066">ISampleResponseModel</font> <font color="#339933">&gt;</font> <font color="#009900">(</font> </li><li>  <font color="#3366CC">'/ JQuery / ReturningObjectWithParameters'</font> <font color="#339933">,</font> </li><li>  <font color="#009900">{</font> <font color="#3366CC">'echo'</font> <font color="#339933">:</font> echo <font color="#009900">}</font> <font color="#339933">,</font> </li><li>  loadingPlaceholderSelector <font color="#339933">,</font> </li><li>  disableElement </li><li>  <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#006600"><i>/ ** Wrapper method for call VoidMethodWithParameters of JQueryController * /</i></font> </li><li>  public <font color="#000066"><b>static</b></font> VoidMethodWithParameters <font color="#009900">(</font> model <font color="#339933">:</font> Reinforced. <font color="#660066">Typings</font> . <font color="#660066">Samples</font> . <font color="#660066">Difficult</font> . <font color="#660066">CodeGenerators</font> . <font color="#660066">Models</font> . <font color="#660066">ISampleResponseModel</font> <font color="#339933">,</font> loadingPlaceholderSelector <font color="#339933">:</font> string <font color="#339933">=</font> <font color="#3366CC">''</font> <font color="#339933">,</font> disableElement <font color="#339933">:</font> string <font color="#339933">=</font> <font color="#3366CC">''</font> <font color="#009900">)</font> <font color="#339933">:</font> JQueryPromise <font color="#339933">&lt;</font> any <font color="#339933">&gt;</font> </li><li>  <font color="#009900">{</font> </li><li>  <font color="#000066"><b>return</b></font> QueryController.  <font color="#660066">query</font> <font color="#339933">&lt;</font> any <font color="#339933">&gt;</font> <font color="#009900">(</font> </li><li>  <font color="#3366CC">'/ JQuery / VoidMethodWithParameters'</font> <font color="#339933">,</font> </li><li>  <font color="#009900">{</font> <font color="#3366CC">'model'</font> <font color="#339933">:</font> model <font color="#009900">}</font> <font color="#339933">,</font> </li><li>  loadingPlaceholderSelector <font color="#339933">,</font> </li><li>  disableElement </li><li>  <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> </li><li></li></ol></blockquote><br><br>  It is also an important point - if your code generator worked incorrectly and produced an error that made your TypeScript uncollectible and now you have no solution to generate new taipings, go to Reinforced.Typings.settings.xml, which is at the root of your project and set there RtBypassTypeScriptCompilation to true.  This will shift the MSBuild task of building TypeScripts so that it is called after the project is built (and not before, as happens by default).  However, do not forget to return it later, because as being active during the execution of publishing tasks, this parameter can lead to the fact that the typing scripts will not be rebuilt before publishing.  And this is not really fun. <br><br><h2>  Step 4. Use </h2><br>  At this point, you can return to your IndexPage.ts and use static calls from the JQueryController class that we generated.  In general, everything is quite prosaic and monotonous, so I will recommend that you do it yourself and experience how IntelliSense works.  The code for the entire IndexPage.ts is shown below: <br><br><blockquote><ol><li></li><li>  module Reinforced.  <font color="#660066">Typings</font> .  <font color="#660066">Samples</font> .  <font color="#660066">Difficult</font> .  <font color="#660066">CodeGenerators</font> .  <font color="#660066">Pages</font> <font color="#009900">{</font> </li><li>  <font color="#FF0000">import</font> JQueryController <font color="#339933">=</font> Reinforced.  <font color="#660066">Typings</font> .  <font color="#660066">Samples</font> .  <font color="#660066">Difficult</font> .  <font color="#660066">CodeGenerators</font> .  <font color="#660066">Controllers</font> .  <font color="#660066">JQueryController</font> <font color="#339933">;</font> </li><li></li><li>  <font color="#FF0000">export</font> <font color="#FF0000">class</font> IndexPage <font color="#009900">{</font> </li><li>  constructor <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  $ <font color="#009900">(</font> <font color="#3366CC">'#btnSimpleInt'</font> <font color="#009900">)</font> .  <font color="#660066">click</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> . <font color="#660066">btnSimpleIntClick</font> . <font color="#660066">bind</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  $ <font color="#009900">(</font> <font color="#3366CC">'#btnMethodWithParameters'</font> <font color="#009900">)</font> .  <font color="#660066">click</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> . <font color="#660066">btnMethodWithParametersClick</font> . <font color="#660066">bind</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  $ <font color="#009900">(</font> <font color="#3366CC">'#btnReturningObject'</font> <font color="#009900">)</font> .  <font color="#660066">click</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> . <font color="#660066">btnReturningObjectClick</font> . <font color="#660066">bind</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  $ <font color="#009900">(</font> <font color="#3366CC">'#btnReturningObjectWithParameters'</font> <font color="#009900">)</font> .  <font color="#660066">click</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> . <font color="#660066">btnReturningObjectWithParametersClick</font> . <font color="#660066">bind</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  $ <font color="#009900">(</font> <font color="#3366CC">'#btnVoidMethodWithParameters'</font> <font color="#009900">)</font> .  <font color="#660066">click</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> . <font color="#660066">btnVoidMethodWithParametersClick</font> . <font color="#660066">bind</font> <font color="#009900">(</font> <font color="#000066"><b>this</b></font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li></li><li>  private btnSimpleIntClick <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  JQueryController.  <font color="#660066">SimpleIntMethod</font> <font color="#009900">(</font> <font color="#3366CC">'#loading'</font> <font color="#339933">,</font> <font color="#3366CC">'#btnSimpleInt'</font> <font color="#009900">)</font> </li><li>  .  <font color="#660066">then</font> <font color="#009900">(</font> r <font color="#339933">=&gt;</font> $ <font color="#009900">(</font> <font color="#3366CC">'#result'</font> <font color="#009900">)</font> . <font color="#660066">html</font> <font color="#009900">(</font> <font color="#3366CC">'Server tells us'</font> <font color="#339933">+</font> r <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li></li><li>  private btnMethodWithParametersClick <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  JQueryController.  <font color="#660066">MethodWithParameters</font> <font color="#009900">(</font> Math. <font color="#660066">Random</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">,</font> <font color="#3366CC">'string'</font> <font color="#339933">+</font> Math. <font color="#660066">Random</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">,</font> Math. <font color="#660066">Random</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">&gt;</font> <font color="#CC0000">0.5</font> <font color="#339933">,</font> <font color="#3366CC">'#loading'</font> <font color="#339933">,</font> <font color="#3366CC">'#btnMethodWithParameters'</font> <font color="#009900">)</font> </li><li>  .  <font color="#660066">then</font> <font color="#009900">(</font> r <font color="#339933">=&gt;</font> <font color="#009900">{</font> </li><li>  $ <font color="#009900">(</font> <font color="#3366CC">'#result'</font> <font color="#009900">)</font> .  <font color="#660066">html</font> <font color="#009900">(</font> r <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li></li><li>  private btnReturningObjectClick <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  JQueryController.  <font color="#660066">ReturningObject</font> <font color="#009900">(</font> <font color="#3366CC">'#loading'</font> <font color="#339933">,</font> <font color="#3366CC">'#btnReturningObject'</font> <font color="#009900">)</font> </li><li>  .  <font color="#660066">then</font> <font color="#009900">(</font> r <font color="#339933">=&gt;</font> <font color="#009900">{</font> </li><li>  <font color="#000066"><b>var</b></font> s <font color="#339933">=</font> <font color="#3366CC">"&lt;pre&gt; {&lt;br/&gt;"</font> <font color="#339933">;</font> </li><li>  <font color="#000066"><b>for</b></font> <font color="#009900">(</font> <font color="#000066"><b>var</b></font> key <font color="#000066"><b>in</b></font> r <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  s <font color="#339933">+ =</font> `$ <font color="#009900">{</font> key <font color="#009900">}</font> <font color="#339933">:</font> $ <font color="#009900">{</font> r <font color="#009900">[</font> key <font color="#009900">]</font> <font color="#009900">}</font> <font color="#339933">,</font> \ n` <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  s <font color="#339933">+ =</font> <font color="#3366CC">'} &lt;/ pre&gt;'</font> <font color="#339933">;</font> </li><li>  $ <font color="#009900">(</font> <font color="#3366CC">'#result'</font> <font color="#009900">)</font> .  <font color="#660066">html</font> <font color="#009900">(</font> s <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li></li><li>  private btnReturningObjectWithParametersClick <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  <font color="#000066"><b>var</b></font> str <font color="#339933">=</font> <font color="#3366CC">'Random number:'</font> <font color="#339933">+</font> Math.  <font color="#660066">random</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">*</font> <font color="#CC0000">100</font> <font color="#339933">;</font> </li><li>  JQueryController.  <font color="#660066">ReturningObjectWithParameters</font> <font color="#009900">(</font> str <font color="#339933">,</font> <font color="#3366CC">'#loading'</font> <font color="#339933">,</font> <font color="#3366CC">'#btnReturningObjectWithParameters'</font> <font color="#009900">)</font> </li><li>  .  <font color="#660066">then</font> <font color="#009900">(</font> r <font color="#339933">=&gt;</font> <font color="#009900">{</font> </li><li>  <font color="#000066"><b>var</b></font> s <font color="#339933">=</font> <font color="#3366CC">"&lt;pre&gt; {&lt;br/&gt;"</font> <font color="#339933">;</font> </li><li>  <font color="#000066"><b>for</b></font> <font color="#009900">(</font> <font color="#000066"><b>var</b></font> key <font color="#000066"><b>in</b></font> r <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  s <font color="#339933">+ =</font> `$ <font color="#009900">{</font> key <font color="#009900">}</font> <font color="#339933">:</font> $ <font color="#009900">{</font> r <font color="#009900">[</font> key <font color="#009900">]</font> <font color="#009900">}</font> <font color="#339933">,</font> \ n` <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  s <font color="#339933">+ =</font> <font color="#3366CC">'} &lt;/ pre&gt;'</font> <font color="#339933">;</font> </li><li>  $ <font color="#009900">(</font> <font color="#3366CC">'#result'</font> <font color="#009900">)</font> .  <font color="#660066">html</font> <font color="#009900">(</font> s <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li></li><li>  private btnVoidMethodWithParametersClick <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> </li><li>  JQueryController.  <font color="#660066">VoidMethodWithParameters</font> <font color="#009900">(</font> <font color="#009900">{</font> </li><li>  Message <font color="#339933">:</font> <font color="#3366CC">'Hello'</font> <font color="#339933">,</font> </li><li>  Success <font color="#339933">:</font> <font color="#003366"><b>true</b></font> </li><li>  CurrentTime <font color="#339933">:</font> <font color="#003366"><b>null</b></font> </li><li>  <font color="#009900">}</font> <font color="#339933">,</font> <font color="#3366CC">'#loading'</font> <font color="#339933">,</font> <font color="#3366CC">'#btnVoidMethodWithParameters'</font> <font color="#009900">)</font> </li><li>  .  <font color="#660066">then</font> <font color="#009900">(</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">=&gt;</font> <font color="#009900">{</font> </li><li>  $ <font color="#009900">(</font> <font color="#3366CC">'#result'</font> <font color="#009900">)</font> .  <font color="#660066">html</font> <font color="#009900">(</font> <font color="#3366CC">'not return result'</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> </li><li></li></ol></blockquote><br><br><h2>  For lovers of Angular </h2><br>  In principle, all the same.  However, in addition to the method generator, we will need a generator for the entire class, because, as in the best traditions of Angulyar, it would be nice to export our server controller to an angular service.  So, set DefinitelyTyped for angular.js, connect the angular itself via NuGet and let's look at the code of the method generator.  It is slightly different from jQuery-evskogo due to the fact that you need to use other promises, as well as use $ http.post instead of $ .ajax: <br><br><blockquote><ol><li></li><li>  <font color="#0600FF"><b>using</b></font> <font color="#008080">System</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>using</b></font> <font color="#008080">System.Linq</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>using</b></font> <font color="#008080">System.Reflection</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>using</b></font> <font color="#008080">Reinforced.Typings.Ast</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>using</b></font> <font color="#008080">Reinforced.Typings.Generators</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>/// &lt;summary&gt;</i></font> </li><li>  <font color="#008080"><i>/// Generator wrapper methods for angular.js</i></font> </li><li>  <font color="#008080"><i>/// &lt;/ summary&gt;</i></font> </li><li>  <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>class</b></font> AngularActionCallGenerator <font color="#008000">:</font> MethodCodeGenerator </li><li>  <font color="#008000">{</font> </li><li>  <font color="#0600FF"><b>public</b></font> <font color="#0600FF"><b>override</b></font> RtFuncion GenerateNode <font color="#008000">(</font> MethodInfo element, RtFuncion result, TypeResolver resolver <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  result <font color="#008000">=</font> <font color="#0600FF"><b>base</b></font> <font color="#008000">.</font>  <font color="#0000FF">GenerateNode</font> <font color="#008000">(</font> element, result, resolver <font color="#008000">)</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>if</b></font> <font color="#008000">(</font> result <font color="#008000">==</font> <font color="#0600FF"><b>null</b></font> <font color="#008000">)</font> <font color="#0600FF"><b>return</b></font> <font color="#0600FF"><b>null</b></font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// overload the type of method under our promise</i></font> </li><li>  <font color="#0600FF"><b>var</b></font> retType <font color="#008000">=</font> result <font color="#008000">.</font>  <font color="#0000FF">ReturnType</font> <font color="#008000">;</font> </li><li>  <font color="#6666cc"><b>bool</b></font> isVoid <font color="#008000">=</font> <font color="#008000">(</font> retType <font color="#008000">is</font> RtSimpleTypeName <font color="#008000">)</font> <font color="#008000">&amp;&amp;</font> <font color="#008000">(</font> <font color="#008000">(</font> <font color="#008000">(</font> RtSimpleTypeName <font color="#008000">)</font> retType <font color="#008000">)</font> <font color="#008000">.</font> <font color="#0000FF">TypeName</font> <font color="#008000">==</font> <font color="#666666">"void"</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// exactly the same trick with void methods</i></font> </li><li>  <font color="#0600FF"><b>if</b></font> <font color="#008000">(</font> isVoid <font color="#008000">)</font> retType <font color="#008000">=</font> resolver <font color="#008000">.</font>  <font color="#0000FF">ResolveTypeName</font> <font color="#008000">(</font> <font color="#008000">typeof</font> <font color="#008000">(</font> <font color="#6666cc"><b>object</b></font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// use angular.IPromise instead of jQueryPromise</i></font> </li><li>  result <font color="#008000">.</font>  <font color="#0000FF">ReturnType</font> <font color="#008000">=</font> <font color="#008000">new</font> RtSimpleTypeName <font color="#008000">(</font> <font color="#008000">new</font> <font color="#008000">[</font> <font color="#008000">]</font> <font color="#008000">{</font> retType <font color="#008000">}</font> , <font color="#666666">"angular"</font> , <font color="#666666">"IPromise"</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// method parameters - by the same principle</i></font> </li><li>  <font color="#0600FF"><b>var</b></font> p <font color="#008000">=</font> element <font color="#008000">.</font>  <font color="#0000FF">GetParameters</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">.</font>  <font color="#0600FF"><b>Select</b></font> <font color="#008000">(</font> c <font color="#008000">=&gt;</font> <font color="#6666cc"><b>string</b></font> <font color="#008000">.</font> <font color="#0000FF">Format</font> <font color="#008000">(</font> <font color="#666666">"'{0}': {0}"</font> , c <font color="#008000">.</font> <font color="#0000FF">GetName</font> <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>var</b></font> dataParameters <font color="#008000">=</font> <font color="#6666cc"><b>string</b></font> <font color="#008000">.</font>  <font color="#0600FF"><b>Join</b></font> <font color="#008000">(</font> <font color="#666666">","</font> , p <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// Get the path to the controller</i></font> </li><li>  <font color="#6666cc"><b>string</b></font> controller <font color="#008000">=</font> element <font color="#008000">.</font>  <font color="#0000FF">DeclaringType</font> <font color="#008000">.</font>  <font color="#0000FF">Name</font> <font color="#008000">.</font>  <font color="#0000FF">Replace</font> <font color="#008000">(</font> <font color="#666666">"Controller"</font> , <font color="#6666cc"><b>String</b></font> <font color="#008000">.</font> <font color="#0000FF">Empty</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li>  <font color="#6666cc"><b>string</b></font> path <font color="#008000">=</font> <font color="#6666cc"><b>String</b></font> <font color="#008000">.</font>  <font color="#0000FF">Format</font> <font color="#008000">(</font> <font color="#666666">"/ {0} / {1}"</font> , controller, element <font color="#008000">.</font> <font color="#0000FF">Name</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// Generate code via this.http.post</i></font> </li><li>  <font color="#0600FF"><b>const</b></font> <font color="#6666cc"><b>string</b></font> code <font color="#008000">=</font> <font color="#666666">@ "var params = {{{1}}};</font> </li><li>  <font color="#666666">return this.http.post ('{0}', params)</font> </li><li>  <font color="#666666">.then ((response) =&gt; {{return response.data;}}); "</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// also wrapped in RtRaw</i></font> </li><li>  RtRaw body <font color="#008000">=</font> <font color="#008000">new</font> RtRaw <font color="#008000">(</font> <font color="#6666cc"><b>String</b></font> <font color="#008000">.</font> <font color="#0000FF">Format</font> <font color="#008000">(</font> code, path, dataParameters <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li>  result <font color="#008000">.</font>  <font color="#0000FF">Body</font> <font color="#008000">=</font> body <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>return</b></font> result <font color="#008000">;</font> </li><li>  <font color="#008000">}</font> </li><li>  <font color="#008000">}</font> </li><li></li></ol></blockquote><br><br>  That's all the magic.  Do not forget to set this code generator for all angular-friendly controller methods via an attribute or through a Fluent configuration. <br><br>  And now let's make a code generator for the class that will contain these methods.  The specificity is that the methods are no longer static, we will need to make a private http field that will store the $ http service, a constructor that will inject this service, and also register our controller service in our application. <br>  Here I assume that you already have somewhere creating a module of your application by calling angular.module and the module itself is in the global variable app. <br><br><blockquote><ol><li></li><li>  <font color="#0600FF"><b>using</b></font> <font color="#008080">System</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>using</b></font> <font color="#008080">Reinforced.Typings.Ast</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>using</b></font> <font color="#008080">Reinforced.Typings.Generators</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>/// &lt;summary&gt;</i></font> </li><li>  <font color="#008080"><i>/// A generator that wraps our methods in an angular service.</i></font> </li><li>  <font color="#008080"><i>/// inherit from the standard class generator</i></font> </li><li>  <font color="#008080"><i>/// &lt;/ summary&gt;</i></font> </li><li>  <font color="#0600FF"><b>public</b></font> <font color="#6666cc"><b>class</b></font> AngularControllerGenerator <font color="#008000">:</font> ClassCodeGenerator </li><li>  <font color="#008000">{</font> </li><li>  <font color="#0600FF"><b>public</b></font> <font color="#0600FF"><b>override</b></font> RtClass GenerateNode <font color="#008000">(</font> Type element, RtClass result, TypeResolver resolver <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li>  <font color="#008080"><i>// Again, start with the "standard" class generated for the controller</i></font> </li><li>  result <font color="#008000">=</font> <font color="#0600FF"><b>base</b></font> <font color="#008000">.</font>  <font color="#0000FF">GenerateNode</font> <font color="#008000">(</font> element, result, resolver <font color="#008000">)</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF"><b>if</b></font> <font color="#008000">(</font> result <font color="#008000">==</font> <font color="#0600FF"><b>null</b></font> <font color="#008000">)</font> <font color="#0600FF"><b>return</b></font> <font color="#0600FF"><b>null</b></font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// Add some documentation</i></font> </li><li>  result <font color="#008000">.</font>  <font color="#0000FF">Documentation</font> <font color="#008000">=</font> <font color="#008000">new</font> RtJsdocNode <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">{</font> Description <font color="#008000">=</font> <font color="#666666">"Result of AngularControllerGenerator activity"</font> <font color="#008000">}</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// create the type name angular.IHttpService</i></font> </li><li>  <font color="#0600FF"><b>var</b></font> httpServiceType <font color="#008000">=</font> <font color="#008000">new</font> RtSimpleTypeName <font color="#008000">(</font> <font color="#666666">"IHttpService"</font> <font color="#008000">)</font> <font color="#008000">{</font> <font color="#0600FF"><b>Namespace</b></font> <font color="#008000">=</font> <font color="#666666">"angular"</font> <font color="#008000">}</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#008080"><i>// Add a constructor, ...</i></font> </li><li>  RtConstructor constructor <font color="#008000">=</font> <font color="#008000">new</font> RtConstructor <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li>  <font color="#008080"><i>// ... host $ http: angular.IHttpService</i></font> </li><li>  constructor <font color="#008000">.</font>  <font color="#0000FF">Arguments</font> <font color="#008000">.</font>  <font color="#0600FF"><b>Add</b></font> <font color="#008000">(</font> <font color="#008000">new</font> RtArgument <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">{</font> Type <font color="#008000">=</font> httpServiceType, Identifier <font color="#008000">=</font> <font color="#008000">new</font> RtIdentifier <font color="#008000">(</font> <font color="#666666">"$ http"</font> <font color="#008000">)</font> <font color="#008000">}</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li>  <font color="#008080"><i>// his body will contain a single line -</i></font> </li><li> <font color="#008080"><i>//  $http   </i></font> </li><li> constructor <font color="#008000">.</font> <font color="#0000FF">Body</font> <font color="#008000">=</font> <font color="#008000">new</font> RtRaw <font color="#008000">(</font> <font color="#666666">"this.http = $http;"</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li> <font color="#008080"><i>//  ,      $http</i></font> </li><li> RtField httpServiceField <font color="#008000">=</font> <font color="#008000">new</font> RtField <font color="#008000">(</font> <font color="#008000">)</font> </li><li>  <font color="#008000">{</font> </li><li> Type <font color="#008000">=</font> httpServiceType, </li><li> Identifier <font color="#008000">=</font> <font color="#008000">new</font> RtIdentifier <font color="#008000">(</font> <font color="#666666">"http"</font> <font color="#008000">)</font> , </li><li> AccessModifier <font color="#008000">=</font> AccessModifier <font color="#008000">.</font> <font color="#0600FF"><b>Private</b></font> , </li><li> Documentation <font color="#008000">=</font> <font color="#008000">new</font> RtJsdocNode <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">{</font> Description <font color="#008000">=</font> <font color="#666666">"  $http    "</font> <font color="#008000">}</font> </li><li> <font color="#008000">}</font> <font color="#008000">;</font> </li><li></li><li> <font color="#008080"><i>//       </i></font> </li><li> result <font color="#008000">.</font> <font color="#0000FF">Members</font> <font color="#008000">.</font> <font color="#0600FF"><b>Add</b></font> <font color="#008000">(</font> httpServiceField <font color="#008000">)</font> <font color="#008000">;</font> </li><li> result <font color="#008000">.</font> <font color="#0000FF">Members</font> <font color="#008000">.</font> <font color="#0600FF"><b>Add</b></font> <font color="#008000">(</font> constructor <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li> <font color="#008080"><i>//   ,          </i></font> </li><li> <font color="#008080"><i>//      Api.%Something%Controller</i></font> </li><li> <font color="#0600FF"><b>const</b></font> <font color="#6666cc"><b>string</b></font> initializerFormat <font color="#008000">=</font> </li><li> <font color="#666666">"if (window['app']) window['app'].factory('Api.{0}', ['$http', ($http: angular.IHttpService) =&gt; new {1}($http)]);"</font> <font color="#008000">;</font> </li><li></li><li> <font color="#008080"><i>//  </i></font> </li><li> RtRaw registration <font color="#008000">=</font> <font color="#008000">new</font> RtRaw <font color="#008000">(</font> <font color="#6666cc"><b>String</b></font> <font color="#008000">.</font> <font color="#0000FF">Format</font> <font color="#008000">(</font> initializerFormat,element <font color="#008000">.</font> <font color="#0000FF">Name</font> ,result <font color="#008000">.</font> <font color="#0000FF">Name</font> <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">;</font> </li><li></li><li> <font color="#008080"><i>//       (  Context),      </i></font> </li><li> <font color="#008080"><i>//    Context.Location.CurrentModule.CompilationUnits</i></font> </li><li> <font color="#008080"><i>//  CompilationUnits    RtNode,  </i></font> </li><li> <font color="#008080"><i>//     ,   RtRaw</i></font> </li><li> <font color="#008080"><i>//  ,      </i></font> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Context </font></font><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></font> <font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Location </font></font></font> <font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></font> <font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CurrentModule </font></font></font> <font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></font> <font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CompilationUnits </font></font></font> <font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></font> <font color="#0600FF"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Add</font></font></b></font> <font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> registration </font></font><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></font> <font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font></font> </li><li> <font color="#0600FF"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">return</font></font></b></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> result</font></font><font color="#008000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></font> </li><li>  <font color="#008000">}</font> </li><li>  <font color="#008000">}</font> </li><li></li></ol></blockquote><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attach this code generator to your controllers in any way (attribute or Fluent configuration). </font><font style="vertical-align: inherit;">After that, rebuild the project and safely inject the resulting service into your angular controllers. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Again, the result of this code generator for impatient:</font></font><br><br><blockquote><ol><li></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">module Reinforced. </font></font><font color="#660066"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typings</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><font color="#660066"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Samples</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><font color="#660066"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Difficult</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><font color="#660066"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CodeGenerators</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><font color="#660066"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controllers </font></font></font> <font color="#009900"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{</font></font></font> </li><li> <font color="#000066"><b>if</b></font> <font color="#009900">(</font> window <font color="#009900">[</font> <font color="#3366CC">'app'</font> <font color="#009900">]</font> <font color="#009900">)</font> window <font color="#009900">[</font> <font color="#3366CC">'app'</font> <font color="#009900">]</font> . <font color="#660066">factory</font> <font color="#009900">(</font> <font color="#3366CC">'Api.AngularController'</font> <font color="#339933">,</font> <font color="#009900">[</font> <font color="#3366CC">'$http'</font> <font color="#339933">,</font> <font color="#009900">(</font> $http <font color="#339933">:</font> ng. <font color="#660066">IHttpService</font> <font color="#009900">)</font> <font color="#339933">=&gt;</font> <font color="#000066"><b>new</b></font> AngularController <font color="#009900">(</font> $http <font color="#009900">)</font> <font color="#009900">]</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li> <font color="#006600"><i>/** Result of AngularControllerGenerator activity */</i></font> </li><li> <font color="#FF0000">export</font> <font color="#FF0000">class</font> AngularController </li><li>  <font color="#009900">{</font> </li><li> constructor <font color="#009900">(</font> $http <font color="#339933">:</font> ng. <font color="#660066">IHttpService</font> <font color="#009900">)</font> </li><li>  <font color="#009900">{</font> </li><li> <font color="#000066"><b>this</b></font> . <font color="#660066">http</font> <font color="#339933">=</font> $http <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li> public SimpleIntMethod <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">:</font> ng. <font color="#660066">IPromise</font> <font color="#339933">&lt;</font> number <font color="#339933">&gt;</font> </li><li>  <font color="#009900">{</font> </li><li> <font color="#000066"><b>var</b></font> params <font color="#339933">=</font> <font color="#009900">{</font> <font color="#009900">}</font> <font color="#339933">;</font> </li><li> <font color="#000066"><b>return</b></font> <font color="#000066"><b>this</b></font> . <font color="#660066">http</font> . <font color="#660066">post</font> <font color="#009900">(</font> <font color="#3366CC">'/Angular/SimpleIntMethod'</font> <font color="#339933">,</font> params <font color="#009900">)</font> </li><li>  . <font color="#660066">then</font> <font color="#009900">(</font> <font color="#009900">(</font> response <font color="#009900">)</font> <font color="#339933">=&gt;</font> <font color="#009900">{</font> response. <font color="#660066">data</font> <font color="#009900">[</font> <font color="#3366CC">'requestParams'</font> <font color="#009900">]</font> <font color="#339933">=</font> params <font color="#339933">;</font> <font color="#000066"><b>return</b></font> response. <font color="#660066">data</font> <font color="#339933">;</font> <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li> public MethodWithParameters <font color="#009900">(</font> num <font color="#339933">:</font> number <font color="#339933">,</font> s <font color="#339933">:</font> string <font color="#339933">,</font> boolValue <font color="#339933">:</font> <font color="#FF0000">boolean</font> <font color="#009900">)</font> <font color="#339933">:</font> ng. <font color="#660066">IPromise</font> <font color="#339933">&lt;</font> string <font color="#339933">&gt;</font> </li><li>  <font color="#009900">{</font> </li><li> <font color="#000066"><b>var</b></font> params <font color="#339933">=</font> <font color="#009900">{</font> <font color="#3366CC">'num'</font> <font color="#339933">:</font> num <font color="#339933">,</font> <font color="#3366CC">'s'</font> <font color="#339933">:</font> s <font color="#339933">,</font> <font color="#3366CC">'boolValue'</font> <font color="#339933">:</font> boolValue <font color="#009900">}</font> <font color="#339933">;</font> </li><li> <font color="#000066"><b>return</b></font> <font color="#000066"><b>this</b></font> . <font color="#660066">http</font> . <font color="#660066">post</font> <font color="#009900">(</font> <font color="#3366CC">'/Angular/MethodWithParameters'</font> <font color="#339933">,</font> params <font color="#009900">)</font> </li><li>  . <font color="#660066">then</font> <font color="#009900">(</font> <font color="#009900">(</font> response <font color="#009900">)</font> <font color="#339933">=&gt;</font> <font color="#009900">{</font> response. <font color="#660066">data</font> <font color="#009900">[</font> <font color="#3366CC">'requestParams'</font> <font color="#009900">]</font> <font color="#339933">=</font> params <font color="#339933">;</font> <font color="#000066"><b>return</b></font> response. <font color="#660066">data</font> <font color="#339933">;</font> <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li> public ReturningObject <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">:</font> ng. <font color="#660066">IPromise</font> <font color="#339933">&lt;</font> Reinforced. <font color="#660066">Typings</font> . <font color="#660066">Samples</font> . <font color="#660066">Difficult</font> . <font color="#660066">CodeGenerators</font> . <font color="#660066">Models</font> . <font color="#660066">ISampleResponseModel</font> <font color="#339933">&gt;</font> </li><li>  <font color="#009900">{</font> </li><li> <font color="#000066"><b>var</b></font> params <font color="#339933">=</font> <font color="#009900">{</font> <font color="#009900">}</font> <font color="#339933">;</font> </li><li> <font color="#000066"><b>return</b></font> <font color="#000066"><b>this</b></font> . <font color="#660066">http</font> . <font color="#660066">post</font> <font color="#009900">(</font> <font color="#3366CC">'/Angular/ReturningObject'</font> <font color="#339933">,</font> params <font color="#009900">)</font> </li><li>  . <font color="#660066">then</font> <font color="#009900">(</font> <font color="#009900">(</font> response <font color="#009900">)</font> <font color="#339933">=&gt;</font> <font color="#009900">{</font> response. <font color="#660066">data</font> <font color="#009900">[</font> <font color="#3366CC">'requestParams'</font> <font color="#009900">]</font> <font color="#339933">=</font> params <font color="#339933">;</font> <font color="#000066"><b>return</b></font> response. <font color="#660066">data</font> <font color="#339933">;</font> <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li> public ReturningObjectWithParameters <font color="#009900">(</font> echo <font color="#339933">:</font> string <font color="#009900">)</font> <font color="#339933">:</font> ng. <font color="#660066">IPromise</font> <font color="#339933">&lt;</font> Reinforced. <font color="#660066">Typings</font> . <font color="#660066">Samples</font> . <font color="#660066">Difficult</font> . <font color="#660066">CodeGenerators</font> . <font color="#660066">Models</font> . <font color="#660066">ISampleResponseModel</font> <font color="#339933">&gt;</font> </li><li>  <font color="#009900">{</font> </li><li> <font color="#000066"><b>var</b></font> params <font color="#339933">=</font> <font color="#009900">{</font> <font color="#3366CC">'echo'</font> <font color="#339933">:</font> echo <font color="#009900">}</font> <font color="#339933">;</font> </li><li> <font color="#000066"><b>return</b></font> <font color="#000066"><b>this</b></font> . <font color="#660066">http</font> . <font color="#660066">post</font> <font color="#009900">(</font> <font color="#3366CC">'/Angular/ReturningObjectWithParameters'</font> <font color="#339933">,</font> params <font color="#009900">)</font> </li><li>  . <font color="#660066">then</font> <font color="#009900">(</font> <font color="#009900">(</font> response <font color="#009900">)</font> <font color="#339933">=&gt;</font> <font color="#009900">{</font> response. <font color="#660066">data</font> <font color="#009900">[</font> <font color="#3366CC">'requestParams'</font> <font color="#009900">]</font> <font color="#339933">=</font> params <font color="#339933">;</font> <font color="#000066"><b>return</b></font> response. <font color="#660066">data</font> <font color="#339933">;</font> <font color="#009900">}</font> <font color="#009900">)</font> <font color="#339933">;</font> </li><li>  <font color="#009900">}</font> </li><li> public VoidMethodWithParameters <font color="#009900">(</font> model <font color="#339933">:</font> Reinforced. <font color="#660066">Typings</font> . <font color="#660066">Samples</font> . <font color="#660066">Difficult</font> . <font color="#660066">CodeGenerators</font> . <font color="#660066">Models</font> . <font color="#660066">ISampleResponseModel</font> <font color="#009900">)</font> <font color="#339933">:</font> ng. <font color="#660066">IPromise</font> <font color="#339933">&lt;</font> any <font color="#339933">&gt;</font> </li><li>  <font color="#009900">{</font> </li><li> <font color="#000066"><b>var</b></font> params <font color="#339933">=</font> <font color="#009900">{</font> <font color="#3366CC">'model'</font> <font color="#339933">:</font> model <font color="#009900">}</font> <font color="#339933">;</font> </li><li> <font color="#000066"><b>return</b></font> <font color="#000066"><b>this</b></font> . <font color="#660066">http</font> . <font color="#660066">post</font> <font color="#009900">(</font> <font color="#3366CC">'/Angular/VoidMethodWithParameters'</font> <font color="#339933">,</font> params <font color="#009900">)</font> </li><li>  . <font color="#660066"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">then </font></font></font> <font color="#009900"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></font> <font color="#009900"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> response </font></font><font color="#009900"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></font> <font color="#339933"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=&gt; </font></font></font> <font color="#009900"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> response. </font></font><font color="#660066"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">data </font></font></font> <font color="#009900"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></font> <font color="#3366CC"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'requestParams' </font></font></font> <font color="#009900"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">] </font></font></font> <font color="#339933"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> params </font></font><font color="#339933"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font></font></font> <font color="#000066"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">return</font></font></b></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> response. </font></font><font color="#660066"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">data </font></font></font> <font color="#339933"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; </font></font></font> <font color="#009900"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">} </font></font></font> <font color="#009900"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></font> <font color="#339933"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font></font> </li><li>  <font color="#009900">}</font> </li><li> <font color="#006600"><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ ** Keeps $ http instance received on construction * /</font></font></i></font> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">private http </font></font><font color="#339933"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ng. </font></font><font color="#660066"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IHttpService </font></font></font> <font color="#339933"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">;</font></font></font> </li><li>  <font color="#009900">}</font> </li><li>  <font color="#009900">}</font> </li><li></li></ol></blockquote><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By the way, the full version of the file from the example live is </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Add documentation </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Also in RT there is the ability to automatically import XMLDOC from the controller methods into the resulting TypeScript code. In addition to writing RtJsdocNode directly with your hands, the following approach is possible: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1) Go to Reinforced.Typings.settings.xml and set the RtGenerateDocumentation parameter to True </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2) Turn on the export of XMLDOC for your project. To do this, right-click on your .csproj-e, select Properties, go to the Build tab and tick the ‚ÄúXML Documentation File‚Äù in the Output section (see picture). Then save the project via Ctrl-S</font></font><br><img src="https://habrastorage.org/files/bba/006/6c9/bba0066c9df74de2a5f6f07736624394.png" alt="tick xmldoc"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3) Reassemble to see the changes. Here it is important to notice two features: firstly, by default, this tick is already in the Release-configuration. </font><font style="vertical-align: inherit;">Therefore, as an option, you can set the RtGenerateDocumentation parameter and switch the project build configuration to Release. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The second feature is that if you, by fate, export types with a fluent configuration from another assembly, then RT you need to explicitly indicate which documentation file to include (besides the main one). </font><font style="vertical-align: inherit;">This can be done with the help of the Fluent-call ConfigurationBuilder.TryLookupDocumentationForAssembly, to which the assembly from which the export and the full path to the XML-file with the documentation are transferred.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We decompose by different files. </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> To activate the layout mode for different files, you will need to enable another build setting. </font></font> so <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1) Go to Reinforced.Typings.settings.xml, set RtDivideTypesAmongFiles to true. Next, find the RtTargetDirectory parameter ‚Äî it specifies the target folder into which the generated typescript files are dumped. Correct this parameter if necessary </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2) Determine which code will fall into which files. This can be done using the [TsFile] attribute, or the Fluent call .ExportTo, available when using .ExportAsClass (es) /. ExportAsInterface (s) /. ExportAsEnum (s). The parameter takes the path to the file relative to the directory indicated in RtTargetDirectory. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3) Rebuild, add the resulting files to the project</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It would seem nothing complicated, but a difficult moment with the directive /// comes up. So - I hasten to please, no additional settings are required. RT is smart enough to place these directives correctly without your participation. However, if you need references to any other files, this is easily solved by the [TsAddTypeReference] attribute or the Fluent call .AdReReference, which is available approximately in the same place as .ExportTo. These methods allow you to add a reference to a file by your exported CLR type, or simply by a raw string. By the way, there is also the [assembly: TsReference] attribute, which will add the desired reference to all generated files. The fluent call to .AddReference does the same when applied to ConfigurationBuilder.</font></font><br><br><h2>  Conclusion </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The examples presented are available in the </font></font><a href="https://github.com/reinforced/Reinforced.Typings/tree/master/Samples"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reinforced.Typings</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> repository </font><font style="vertical-align: inherit;">. I am open to suggestions, questions and suggestions in the comments to this article, as well as in Issues to the RT repository. The project also has a great </font></font><a href="https://github.com/reinforced/Reinforced.Typings/wiki"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github-wiki</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in English, which I develop as there is free time. It was also (and is) a project with Russian documentation on RTFD, but it is now in suspension.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As for the articles and plans for the future, I see that this is the last article about RT, since RT itself is only a component of my other interesting project - Reinforced.Lattice, which I will post some time later, because as it is now passing through the run-in stage and testing on living people. </font><font style="vertical-align: inherit;">For some reason it seems to me that you will like it. </font><font style="vertical-align: inherit;">So, the next article from me will be about Lattice and, most likely, not soon.</font></font><br><br>  Thank you for reading to the end.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It helps me not to throw a project :) </font></font><br><br> <a href="https://github.com/reinforced/Reinforced.Typings"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reinforced.Typings on Github </font></font></a> <br> <a href="https://www.nuget.org/packages/Reinforced.Typings/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reinforced.Typings in NuGet</font></font></a> <br><br>  ______________________ <br><h6><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The text was prepared in the </font><font style="vertical-align: inherit;">Blog </font></font><a href="http://www.softcoder.ru/blogeditor/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Editor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from SoftCoder.ru</font></font></h6></div><p>Source: <a href="https://habr.com/ru/post/278961/">https://habr.com/ru/post/278961/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278951/index.html">We collect Electron.js rake or desktop JS-applications in practice</a></li>
<li><a href="../278953/index.html">Web merge sync on MS SQL</a></li>
<li><a href="../278955/index.html">An error in the AMD processor microcode allows virtual machine users to access the hypervisor host system</a></li>
<li><a href="../278957/index.html">ScribeJava - even your grandma can work with OAuth</a></li>
<li><a href="../278959/index.html">A fresh look at the Oracle VM VirtualBox code</a></li>
<li><a href="../278963/index.html">"Festive Chef" at FBD, step by step</a></li>
<li><a href="../278965/index.html">Announcement of Java-conference for students in Moscow: JPoint 2016 Student Day</a></li>
<li><a href="../278967/index.html">STM32 and LCD, fast screen fill</a></li>
<li><a href="../278969/index.html">What's new in Rails 5.0. You can plan a move</a></li>
<li><a href="../278971/index.html">All nil zero: almost all programming languages ‚Äã‚Äãdo it</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>