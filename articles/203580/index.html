<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cognitive PDF / A - the technology of digitizing text documents for publication on the Internet and long-term archiving</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi Habr! 
 We continue to publish about optical recognition technology (OCR, ICR) and understanding of documents developed by Cognitive Technologies. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cognitive PDF / A - the technology of digitizing text documents for publication on the Internet and long-term archiving</h1><div class="post__text post__text-html js-mediator-article"><h4>  Hi Habr! </h4><br>  We continue to publish about optical recognition technology (OCR, ICR) and understanding of documents developed by Cognitive Technologies.  Today, our story about the technology of digitizing text documents Cognitive PDF / A. <br><br>  In the business area, it is often necessary to scan paper documents for subsequent mailing or archival storage.  With high-quality scanning, the resulting image-images are often quite large.  For example, an A4-size document scanned in color at a resolution of 300 DPI has a size of about 25 MB.  The use of files of such large sizes is inefficient in electronic archives; therefore, compression technologies of the resulting electronic images are becoming more and more interesting.  Classical image compression technologies (JPEG, RLE, Deflate, etc.) are not applicable, as in the general case, documents can contain both monochrome text and full-color graphic areas.  Lossless image compression algorithms that are effective for monochrome texts are ineffective for full-color graphics, while lossy compression shows high rates for color images, but it distorts text information greatly (Fig. 1).  Therefore, it is usually for the compression of images of this type using a combined approach. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bd2/090/cb9/bd2090cb985751f4c12edbb4b1cfb3b6.jpg" alt="image"><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Structural compression of document images </h4><br>  We present the idea of ‚Äã‚Äãstructural compression using the example of a log page image (Fig. 2).  A classic magazine page can contain a background image, one or more text blocks, graphic elements (photographs, charts, tables, etc.) and some marks.  The main idea of ‚Äã‚Äãstructural compression of images of this kind is to select structural blocks, combine these blocks into layers (ie, ‚Äúsplitting‚Äù images into text, graphic, and other layers) and compressing each layer in the most appropriate way.  So the image of the magazine page in Fig.  2 is stratified into four layers: background, black text area, blue text area, and photo area.  To preserve maximum quality, text layers should be compressed with lossless compression algorithms (for example, CCITT Group 4), while for a photo it is acceptable to use lossy compression methods (JPEG).  The main place in the algorithms of structural compression is given to the methods of splitting the original image into text and graphic layers. <br>  This approach has received high popularity relatively recently.  One of the examples that implement the idea of ‚Äã‚Äãstructural compression, can rightly be considered the format of DjVu. <br>  To compress color images in DjVu, a special technology is used, dividing the original image into three layers: foreground, background, and black and white (single-bit) mask.  The mask is saved with the resolution of the source file;  it contains the image of the text and other clear details.  The resolution of the background, in which there are illustrations and texture of the page, is reduced to save space.  The foreground contains color information about parts that are not in the background;  its resolution goes down even more.  Then the background and foreground are compressed using the wavelet transform (using the IW44 algorithm), and the mask is compressed using the JB2 algorithm. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d32/c13/972/d32c13972b24af1acfe18fee56c91915.jpg" alt="image"><br><br>  Despite the high compression ratios of document images, DjVu has a significant drawback: today the format is not standardized, which makes it difficult to use it as a means for creating electronic archives.  In addition, the use of the same stratification scheme for all types of documents is not always justified, and even sometimes can lead to a significant distortion of the document.  Additionally, it is worth noting that the format completely lacks any means of ensuring the security and confidentiality of documents. <br><br><h4>  Cognitive PDF / A Technology </h4><br>  We describe the technology Cognitive PDF / A, designed to convert paper documents into electronic form, and the digitization process in accordance with the proposed technology (Fig. 3). <br>  The first stage of processing is the stratification of the original image.  As a result, two new images appear.  The first one contains the areas of the original image corresponding to the textual information (text layer), and the second - to graphic elements (graphic layer). <br>  In accordance with the architecture of the algorithm, the text layer should not contain any unnecessary areas other than text blocks.  Consequently, the image of the text layer can be easily recognized without any prior preparation using external OCR systems. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/831/bbe/752/831bbe7527393dd477c8665bfcfcce43.jpg" alt="image"><br><br>  The final step is to wrap the received layers and the recognized text in PDF / A.  The graphic and text layer is subjected to appropriate compression, and the recognized text is packed in such a way as to ensure maximum convenience of searching and copying information in the document. <br>  Thus, Cognitive PDF / A technology consists of three main parts: the separation of the original image, the recognition of a text layer using an OCR system, and the compact packaging of the resulting layers and recognized text in a PDF / A file.  Consider these parts in more detail. <br><br><h4>  Splitting algorithm </h4><br>  Different types of documents have different features.  For example, financial documents are characterized by the presence of stamps, signatures and stamps, journal articles can have a complex multicolored background, and books often include full-color graphic elements.  Therefore, Cognitive PDF / A technology provides unique layering for each type of document.  The choice of the best scheme can be carried out using pre-identification algorithms for the type of document.  Further, as examples, we consider layering schemes for two important types of documents: a book page and an office document. <br>  Usually the page of the book contains black text on a white background and, possibly, graphic elements: drawings, charts, graphs, etc. (Fig. 4) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/390/84b/b0b/39084bb0b963c4dec34b401bac5a5516.jpg" alt="image"><br><br>  Typically, in books, text areas and graphics do not overlap.  Another key feature of the layout of books is the use of fonts of similar linear sizes.  Based on these characteristics, we construct a diagram of the bundle image of the page of the book. <br>  Step 1. We binarize the original image, thereby transforming it into a monochrome form (Fig. 5a).  Since the image mainly contained black text on a white background, the binarization process should not have a strong impact on areas containing textual information. Step 2. With the help of morphological filtering, we merge the words into single connected components.  Denote by <i>w</i> and <i>h the</i> characteristic width and height of characters, respectively.  Note also that the distance between the letters in a word is comparable to the thickness of the character stroke, and the distance between words is close to the width of the character.  Therefore, we ‚Äúglue‚Äù each word into a separate connected component, completing the opening with a window (Fig. 5b). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6da/6b3/cee/6da6b3ceec2736956fd1e1bc5c626a77.jpg" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/581/014/6b5/5810146b5bee9f72ae0fccaf102cd6cb.jpg" alt="image"><br><br>  Step 3. Construct a histogram of heights of the connected components (Fig. 6).  Since all the text on the page is printed in approximately the same font size, the connectivity components corresponding to the words form one or several distinct maxima on the histogram.  Therefore, analyzing the histogram, you can calculate the characteristic font size <i>h <sub>font</sub></i> , which typed the text on the page, and, accordingly, select the area on the image corresponding to text information (areas corresponding to connectivity components with a height of about <i>h <sub>font</sub></i> ). <br>  Knowing the area of ‚Äã‚Äãthe text on the original location, we construct the mask of the bundle, after which we apply it to obtain graphic and text layers (Fig. 7). <br>  Since the fast morphological filtering algorithms with a rectangular window are used to select text blocks, it is very important that the text blocks are aligned with the image axes.  Therefore, the image is ‚Äúaligned‚Äù before morphology. <br>  For color images of financial documents (invoices, receipts, contracts, etc.), the above-mentioned features of the book page image are not typical, as graphic elements (stamps, signatures, handwritten notes) are often superimposed on text blocks (Fig. 8).  Therefore, it is unreasonable to use the above described algorithm for stratification.  We construct a stratification scheme based on the color characteristics of the image.  The color saturation of black text and white background is close to zero, while for blue seals and captions this value is large.  Taking this property into account, we construct the following bundle scheme. <br>  Step 1. Construct a histogram of color saturation (Fig. 9), i.e.  dependence <i>y = logN <sub>x</sub></i> , where <i>N <sub>x</sub></i> - the number of image pixels, the saturation of which is equal to <i>x</i> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/125/291/03e/12529103e737ab23688b27316deed046.jpg" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/9e4/978/e58/9e4978e5823ab573feffec05a0c897cc.jpg" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/5e9/048/f1f/5e9048f1f2881d2e8a7828ffbd5286fb.jpg" alt="image"><br><br>  Step 2. Note that two classes are clearly distinguished in the histogram: the first is formed by pixels with small values ‚Äã‚Äãof color saturation, the second - with large values.  Pixels from the first class make up the image areas corresponding to the background and black text, from the second - the graphic part of the image.  Let us find the threshold of separation of two classes <i>t *</i> using the Ots method. <br>  Step 3. We layer the original image as follows: the pixel of the similar image <i>(x, y)</i> belongs to the text layer (Fig. 10a), if its color saturation value is less than the threshold <i>s (x, y) &lt;t *</i> ;  otherwise, the pixel <i>(x, y)</i> belongs to the graphic layer (Fig. 10b). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/02a/9bd/45a/02a9bd45a60eda042db1aa903145c94b.jpg" alt="image"><br><br><h4>  Text layer recognition </h4><br>  As a result of the delamination, we have already received images of text layers that can be easily recognized without any prior preparation using external OCR systems. <br>  In the software implementation of Cognitive PDF / A technology, the open source OCR CuneiForm OCR system is used as an OCR module. <br><br><h4>  Compression and packaging in PDF / A </h4><br>  The resulting text and graphic layers as well as the recognized text are separated in PDF / A format.  This format is an ISO 19005-1: 2005 standard, based on the description of the standard PDF version 1.4 from Adobe Systems Inc.  and is designed specifically for long-term archival storage of electronic documents.  Despite the fact that PDF / A is a subset of the PDF format, there are a number of differences due to the requirements imposed on PDF / A as a long-term storage format for electronic documents.  For example, required for PDF / A is: <br><ul><li>  The introduction of all used fonts, including fonts from the list of "standard for PDF." </li><li>  If the PDF / A-file contains images, it is mandatory to embed a color profile ‚Äî a file that contains information about how the output device (monitor, printer, etc.) should convey the color.  Important is the fact that the included color profile must be device-independent. </li><li>  Mandatory availability of metadata indicating the version of the format used, the title of the document, the list of authors, a brief description, the date of creation and the last modification of the document file, as well as keywords for the search.  The PDF / A specification also specifies a metadata presentation format - the Adobe Extensible Metadata Platform (XMP). </li></ul><br><br>  To increase the compression ratio, the graphic and text layers are compressed in different ways.  Due to the specific content, the graphics layer is reduced to a resolution of 100 DPI and is encoded by the JPEG algorithm.  The text layer contains the basic information of the document, therefore, the text layer is retained in the original resolution, and CCITT Group 4 is used for encoding a lossless compression algorithm. <br><br><h4>  Experimental Results </h4><br>  Evaluating the effectiveness of the technology in an automatic mode is almost impossible - it‚Äôs not enough to compare only the size of the output quality, it is also necessary to compare the quality of the ‚Äúcompact electronic document‚Äù.  Therefore, the actual evaluation is done organoleptically (that is, ‚Äúby eye‚Äù). <br>  In Fig.  Figure 11 shows some test images that were compressed with JPEG algorithms (a compression level that keeps readability), DjVu, and Cognitive PDF / A.  According to the results of the comparison, you can see (see the Table) that the Cognitive PDF / A technology, by the degree of compression, bypasses JPEG by an order of magnitude, but loses DjVu.  Such a difference in size can be explained by the fact that, in addition to useful information (actually images and recognized text), the PDF / A file also contains auxiliary data necessary for long-term storage.  Despite the smaller size of DjVu files, the compression quality of office documents is lower, which is especially evident in the area of ‚Äã‚Äãseals and signatures. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2ba/0e5/fac/2ba0e5fac4781a1c8c8f9defc93231d7.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7d6/25c/417/7d625c417abbb81d8c7a8df110ca9e07.jpg" alt="image"><br><br>  The image and results presented in this table can be downloaded at: <a href="http://yadi.sk/d/7us8gghADHVrg">yadi.sk/d/7us8gghADHVrg</a> <br><br>  The full article is published: <br>  Usilin S.A., Nikolaev D.P., Postnikov V.V.  Cognitive PDF / A - technology of digitization of text documents for publication in the Internet and long-term archival storage // Proceedings of the Institute for System Analysis of the RAS.  Technologies of programming and data storage / ed.  Arlazarov V.L., Yemelyanov N.E.  M .: LENAND, 2009. T. 45. P. 159‚Äì173. <br><br><br><h5>  Recommended literature </h5><br><ol><li>  Vatolin D., Ratushnyak A., Smirnov M., Yukin V. Data Compression Methods.  Image compression algorithms.  - M .: Dialog-MEPI, 2002. - 99 p. </li><li>  Gonzalez R., Woods R. Digital Image Processing.  - M .: Technosphere, 2005. - 1072 p. </li><li>  Lizardtech DjVu Reference, <a href="http://www.lizardtech.com/">www.lizardtech.com</a> </li><li>  Kuroptev A.V., Nikolaev D.P., Postnikov V.V., Usilin S.A.  Selecting graphic primitives and text blocks on document images using morphological operations // Proceedings of the 51st scientific conference of MIPT.  Modern problems of fundamental and applied sciences.  Part 9. Innovation and high technology.  - M .: MIPT, 2008, p. 29 - 31. </li><li>  M. van Herk.  ASTRONOMETRIC MINIMUM FILTERS AND RESTRICULAR AND OCTAGONAL KERNELS // Pattern Recognition Letters.  - 1992. - p. 517 - 521. </li><li>  ISO 19005-1: 2005.  Document management - Electronic document file format for long-term preservation - Part 1: Use of PDF 1.4 (PDF / A-1). </li><li>  Adobe Systems Incorporated.  Extensible Metadata Platform (XMP) Specification, <a href="http://www.adobe.com/">www.adobe.com</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/203580/">https://habr.com/ru/post/203580/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../203568/index.html">My experience with Webrtc</a></li>
<li><a href="../203570/index.html">Selling design online store. Part 2. Interface elements</a></li>
<li><a href="../203574/index.html">What makes a good programmer good?</a></li>
<li><a href="../203576/index.html">Legendary cryptographer Diffie tried to stop the patent troll</a></li>
<li><a href="../203578/index.html">How to curb the gain recording in SSD?</a></li>
<li><a href="../203582/index.html">Contest: Telegram for Windows Phone - 3 million rubles in the first round</a></li>
<li><a href="../203584/index.html">SMM's rest, the programmer is working. Automatically Voyager VKontakte</a></li>
<li><a href="../203586/index.html">Monte Carlo simulation of the blogosphere</a></li>
<li><a href="../203592/index.html">Dynamic access control: what resources are</a></li>
<li><a href="../203594/index.html">Will lawyers replace the laptop on the tablet?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>