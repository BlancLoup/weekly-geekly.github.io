<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mini airship control system</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, dear reader, you are presented with a project to develop a touch control system for a mini-dirigible balloon. 
 The control task is to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mini airship control system</h1><div class="post__text post__text-html js-mediator-article">  Good afternoon, dear reader, you are presented with a project to develop a touch control system for a mini-dirigible balloon. <br>  The control task is to move the airship along the line.  A simple remote control system was also implemented. <br>  The object of control is a mini-airship developed at the Department of E &amp; M, TIT SFU. <br><br><img src="https://habrastorage.org/files/53e/cda/e2a/53ecdae2a6f14e74a3a4bf381b4d8bc0.jpg"><br>  Figure 1 - General view of the mini-airship. <br><br>  The project aims: development of a technical vision system for line detection (motion path);  development of the course regulator, taking into account the factors of the position of the line and the angle of inclination of the line relative to the airship;  development of height adjuster;  development of a remote control system. <br><a name="habracut"></a><br><h4>  1. Task analysis and problem statement </h4><br>  The development of a touch control system is based on a mini-airship designed at the E &amp; M department. <br>  The mini-airship includes a shell on commonly available components, namely a variety of foil balloons. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The hardware part of the mini-airship consists of <br><ul><li>  - raspberry pi single board computer; </li><li>  - Wide-angle Web Camera Genius WideCam 1050; </li><li>  - ultrasonic height sensor hc-sr05; </li><li>  - two electric motors; </li><li>  - servo drive deviation engines; </li><li>  - power subsystems. </li></ul><br>  Rotate the mini-airship around the vertical axis is raznotyagiem engines.  The height adjustment of the airship is carried out by the deviation of the thrust vector of the engines along the vertical axis. <br>  Airship engines have the ability to set the maximum speed to 3200 rpm.  / min  The operating voltage of the motors is 7.4 volts.  The engines are separated from the center of the airship by 25 cm, and are located at the lower point of the airship. <br><br><h4>  2. Vision system </h4><br><h5>  2.1.  Block diagram of the vision system </h5><br><img src="https://habrastorage.org/files/5ba/5b6/2b1/5ba5b62b196346648f3c41061c7629b1.jpg" alt="image"><br>  Figure 2 - Block diagram of the vision system of a mini-airship. <br><br>  The vision system consists of hardware and software parts.  The hardware is connected to the software by a wired connection, where the already generated MJPG format signal is transmitted. <br><br>  The hardware includes a webcam. <br><br>  The program part includes: <ul><li>  - a camera driver for receiving a video image of the MJPG format and specifying camera settings; </li><li>  - image processing module. </li></ul><br><h5>  2.2.  Development of the functional scheme </h5><br>  Taking into account the selected method of processing and the algorithm for determining the location of the line (which will be discussed in the next chapter), the following tasks were identified in the software implementation: <br><ul><li>  - configure the internal parameters of the camcorder; </li><li>  - get the image from the camera; </li><li>  - convert image from MJPG format to HSV color format; </li><li>  - organize the search for the area of ‚Äã‚Äãintersection by color matching; </li><li>  - implement an algorithm for determining the coordinates of the intersection point, </li><li>  - filtering is not a useful signal; </li><li>  - to implement the integration of the STZ block with the direction control block. </li></ul><br>  Getting the image from the camera and converting it to the HSV color format is entrusted to the opencv library. <br><br><h5>  2.3.  Algorithm </h5><br>  As is known, a straight line can be laid through any two points in space.  In this case, the vision system of the mini-airship is tasked with determining the laid line.  The first stage of image processing will be the search for these two points through which our line was laid. <br>  We define the zones of interest in our image to search for these points.  The optimal location of the zone of interest will be the intervals between 1/3 of the vertical part of the frame and 2/3.  as shown in Figure 4 by the blue lines. <br><br><img src="https://habrastorage.org/files/6e1/c1c/27a/6e1c1c27a1ba4142b4fbf056abc27803.jpg" alt="image"><br>  Figure 3 - The optimal location of the zone of interest. <br><br>  The criterion for the optimal location of the zone of interest is that the lower part of the zone of interest is perpendicular down from the mini-airship, and the upper part is not at the frame boundary, which minimizes distortion of the resulting image of the zone. <br>  The height of each zone is 10 pixels. <br>  The point of intersection with the line is determined by matching the pixels to the specified color.  The color space of the vision system HSV. <br>  2 stages of the algorithm with each zone of interest. <br><br>  1. The determination of compliance with a given color occurs in an array, the width of which is the width of the frame received from the camera.  Each element of the array is an average of 10 pixels in a column of interest.  Thus the color noise coming from the camera is averaged.  The array has 3 lines, each of which corresponds to HSV channels.  At the output, we get a one-dimensional array, in which the value ‚Äú1‚Äù denotes pixel addresses corresponding to the specified color, the value ‚Äú0‚Äù denotes pixel addresses that do not correspond to the specified color. <br><pre><code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">for</span></span>(x = <span class="hljs-number"><span class="hljs-number">0</span></span> ; x&lt;width ; x++) {offset = x * nchannels; for (y2=<span class="hljs-number"><span class="hljs-number">35</span></span>; y2&lt;<span class="hljs-number"><span class="hljs-number">46</span></span>; y2++ ) { uchar* <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> = (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">uchar</span></span></span><span class="hljs-class">*)(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hsv</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">imageData</span></span></span><span class="hljs-class"> + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y2</span></span></span><span class="hljs-class">*</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">step</span></span></span><span class="hljs-class">); r=</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">[offset + 2]; g=</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">[offset + 1]; b=</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">[offset]; h[y2-35]=b; s[y2-35]=g; v[y2-35]=r; } h[10]=(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h</span></span></span><span class="hljs-class">[0]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h</span></span></span><span class="hljs-class">[1]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h</span></span></span><span class="hljs-class">[2]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h</span></span></span><span class="hljs-class">[3]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h</span></span></span><span class="hljs-class">[4]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h</span></span></span><span class="hljs-class">[5]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h</span></span></span><span class="hljs-class">[6]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h</span></span></span><span class="hljs-class">[7]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h</span></span></span><span class="hljs-class">[8]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h</span></span></span><span class="hljs-class">[9])/10; s[10]=(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">[0]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">[1]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">[2]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">[3]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">[4]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">[5]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">[6]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">[7]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">[8]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">[9])/10; v[10]=(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">v</span></span></span><span class="hljs-class">[0]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">v</span></span></span><span class="hljs-class">[1]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">v</span></span></span><span class="hljs-class">[2]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">v</span></span></span><span class="hljs-class">[3]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">v</span></span></span><span class="hljs-class">[4]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">v</span></span></span><span class="hljs-class">[5]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">v</span></span></span><span class="hljs-class">[6]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">v</span></span></span><span class="hljs-class">[7]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">v</span></span></span><span class="hljs-class">[8]+</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">v</span></span></span><span class="hljs-class">[9])/10; if ((</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h</span></span></span><span class="hljs-class">[10]&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h1</span></span></span><span class="hljs-class">&amp;&amp;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h</span></span></span><span class="hljs-class">[10]&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">h2</span></span></span><span class="hljs-class">)&amp;&amp;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">v</span></span></span><span class="hljs-class">[10]&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ss</span></span></span><span class="hljs-class">)&amp;&amp;(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">s</span></span></span><span class="hljs-class">[10]&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">vv</span></span></span><span class="hljs-class">)) {</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">st</span></span></span><span class="hljs-class">[</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">]=1;} else {</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">st</span></span></span><span class="hljs-class">[</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">]=0;}</span></span></code> </pre> <br><br>  2. Determination of the left and right border of the intersection zone. <br>  On the input array two arrays of the same dimension are filled.  Let's call them st1 and st2.  The array filling algorithm is implemented by a cycle in which some variable increases linearly if the considered element of the input array is 1, and exponentially decreases if the element in question is 0, and is written to the next element of the array st1.  To form the st2 array, the input array is considered from the end.  As a result, arrays of st1 and st2 can be represented graphically as follows (Fig. 5) <br><img src="https://habrastorage.org/files/1db/920/563/1db9205630244cf49b7c5e907e50bdf5.jpg" alt="image"><br>  Figure 5 - Graphic representation of the st1 and st2 arrays. <br><br>  A useful signal is the widest color detection area.  Noise is a small false positives, which can be observed at figure 7. The coordinates x of the maximum element of the red graph (st1), is the right side of the line crossing the zone of interest.  The x coordinates of the maximum element of the blue graph (st2) is the left side of the line crossing the zone of interest. <br>  Listing <br><pre> <code class="hljs axapta"><span class="hljs-keyword"><span class="hljs-keyword">double</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> sum2=<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (x=<span class="hljs-number"><span class="hljs-number">0</span></span>; x&lt;width; x++ ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (st[x]==<span class="hljs-number"><span class="hljs-number">1</span></span>) {<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>;st1[x]=<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>/<span class="hljs-number"><span class="hljs-number">1.05</span></span>;st1[x]=<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (st[width-x]==<span class="hljs-number"><span class="hljs-number">1</span></span>) {sum2=sum2+<span class="hljs-number"><span class="hljs-number">1</span></span>;st2[width-x]=sum2;} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {sum2=sum2/<span class="hljs-number"><span class="hljs-number">1.005</span></span>;st2[width-x]=sum2}}</code> </pre> <br><br>  After the formation of the arrays st1 and st2, the maximum elements of the array are found, and the center of the intersection zone is calculated.  Applying all the described actions to the second intersection zone, at the exit we have the coordinates of the points through which the line passes. <br>  The application of the common method, determining the zone of confidence in the next frame, according to the state of the object in the previous one, was not used, since this method also showed acceptable results of noise in the output parameters.  Also, the application of this method would not reduce the processor load, since we are dealing only with repeated enumeration of two arrays with a width of 176 pixels, the resolution of the entire image is 176x144 pixels. <br><br><h4>  3. Direction control </h4><br><h5>  3.1.  The block diagram of the regulator in the part of the control system </h5><br><br><br>  Figure 4 - Block diagram of the directional controller. <br><br>  Software implementation consists of: <br><ul><li>  - fuzzy regulator; </li><li>  - a mathematical module for calculating the rotation of the line; </li><li>  - software shima. </li></ul><br>  The hardware part of the Raspberry pi consists of the bcm2835 processor, which connects the gpio conclusions on the results of the work of the program ShIM. <br><br>  Hardware implementation consists of: <br><ul><li>  - Driver L293DNE engine; </li><li>  - Left and right electric motor. </li></ul><br>  The block diagram of the directional regulator consists of the program part based on a fuzzy regulator.  The algorithm for dephasing is the Mamdani algorithm. <br>  The use of software PWM is caused by the absence of hardware PWM in the single-board computer Raspberry pi used. <br>  Motor driver is used to amplify the PWM signal. <br><br><h5>  3.2.  Designing a fuzzy controller. </h5><br><h6>  3.2.1.  Definition of inputs and outputs of the created system. </h6><br>  Since for accurate passage of a mini-airship along a line, it is necessary to take into account both the deviations of the line from the axis of the airship, and the rotation about the same axis, respectively, the variable parameters of the regulator (OFF) and turn (DOM) will be set by the controller input parameters.  The output variables of the controller will be the parameters of the output PWM signal as a percentage.  The output variable of the impact on the left engine is designated as (LEV), the right engine, respectively (RIGHT) <br><br><h6>  3.3.2.  Assignment for each of the input and output variables of the membership function with terms </h6><br>  The output terms of the left and right motor accessories would have to be set, would appear as non-linear parameters of the DC motor operation with respect to the PWM effect.  But since the airship speeds suggest a small linear deviation of the engines, the terms were set as for an ideal engine with an absolute linear characteristic. <br><br><br>  Figure 5 - Terms of output variables LEV and RIGHTS. <br><br>  The input variable deviations of the longitudinal axis of the airship from the line and the rotation of the line from the same axis are obtained as a result of the work of the vision system and the mathematical module for calculating the angle, the camera of which has distortion indices.  The camera distortion values ‚Äã‚Äãcan be set in the input terms OFF and STB.  Since there are no requirements for the positioning accuracy and the trajectory of the output to the line, distortion indicators can be ignored.  In this assignment, the therm tuned the distortion pictures of the camera and the terms on them were not tuned.  Terms were changed approximately, which was a sufficient condition for the functioning of the system. <br><br><br>  Figure 6 - Term OFF and Stand. <br><br><h6>  3.2.3.  Development of a rule base for the implemented fuzzy system </h6><br>  To develop a rule base, it is necessary to designate linguistic variables (terms) with easy-to-understand names. <br><br><br>  Figure 7 - Term designation. <br><br><table><tbody><tr><td>  OFF 1 - strongly left. <br>  OFF 2 - left. <br>  OFF 3 - center. <br>  OFF 4 - right. <br>  OFF 5 - strongly to the right. </td><td>  Stand 1 - strongly to the left. <br>  Stand 2 - left. <br>  Stand 3 - Center. <br>  POB 4 - right. <br>  Stand 5 - strongly to the right. </td><td>  LION 1 - very weak. <br>  LION 2 - weak. <br>  LION 3 - medium. <br>  LION 4 - strongly <br>  LION 5 - very much. </td><td>  RIGHTS 1 - very weak. <br>  RIGHT 2 - weak. <br>  RIGHT 3 - medium. <br>  RIGHT 4 - Strong <br>  RIGHTS 5 - very much </td></tr></tbody></table><br>  Accordingly, these names, given that the mini-airship is controlled by raznotyag on the engines we establish the connection term. <br>  rule block: <br><table><tbody><tr><td>  IF OFF VERY LEFT, THEN LEV IS VERY WEAK AND RIGHTS ARE VERY STRONG. <br>  IF OFF to the left, TO LEO is weak.  And right <br>  IF OFF center, then LEO is average.  And the rights are average. <br>  IF OFF to the right, THAT LION IS STRONGLY AND THE RIGHTS are weak. </td><td>  IF OFF VERY DIRECTLY, THEN LEV IS VERY STRONG.  And the rights are very weak. <br>  IF POV is strongly to the left, TO LEO is very weak.  And the rights are very strong. <br>  IF POV left, then LEV weak.  And right <br>  IF STAND to the right, then LEO strongly and RIGHTS weakly. <br>  IF POB strongly to the right, THAT LION is very strong.  And the rights are very weak </td></tr></tbody></table><br>  You may notice that for the input variable, there is no connectedness of averages.  This is due to the fact that with the correct orientation of the longitudinal axis of the airship relative to the line and deviations from it, the average term pulled the input values ‚Äã‚Äãof the motors to the middle, which is incorrect in this position of the airship. <br><br>  In this fuzzy system, the dephasing algorithm is the Mamdani algorithm. <br>  This algorithm describes several successive stages, with each subsequent stage receiving the values ‚Äã‚Äãobtained in the previous step as input. <br><br><h6>  3.2.4.  Analysis of the work process of a fuzzy system </h6><br><br>  To analyze the process of work.  Were built correlation portraits of the regulator.  In the figures below, the Y axis is the input variable DOM, the X axis is the input variable OFF.  The color of the pixel corresponds to the input variable of each engine, white is the minimum, and black is the maximum. <br><br><br>  Figure 8 - Correlation portraits of the output value of a fuzzy system for the left and right engines, the intersection of correlation portraits. <br><br>  In the last figure, we see the result of the intersection of two correlation portraits with the application of the selection pixel with the same color and location.  From the result of the intersection, it is possible to determine under what input conditions the same engine power values ‚Äã‚Äãwill be.  The characteristic black square areas at the edges give marginal terms with a truncated tip. <br>  Below are the results of emulation of a fuzzy regulator relative to the location of the line in the frame indicated in red.  On the right side of the video, you can observe the PWM signal levels for the left and right motor, respectively.  On the left side are the input and output terms of accessories. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/UAn7PgVYxqk%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700191,15700253&amp;usg=ALkJrhhtG1O8AvwGFrn6WaEWkFNa9aDKGQ" frameborder="0" allowfullscreen=""></iframe><br><br><h4>  4. Height adjustment </h4><br><h5>  4.1.  Structural diagram of the regulator </h5><br><br><br>  Figure 9 - Block diagram of the height regulator. <br><br>  Software implementation consists of: <ul><li>  PI controller on fuzzy logic; </li><li>  mathematical module for calculating the distance; </li><li>  software shima; </li></ul><br>  The hardware part of the Raspberry pi consists of a bcm2835 processor, connecting gpio conclusions on the results of software PWM. <br><br>  The hardware implementation consists of <ul><li>  Servo drive, changing thrust vector of engines; </li><li>  Ultrasonic Sensor HC-SR05. </li></ul><br><h5>  4.2.  Designing a fuzzy regulator </h5><br><h6>  4.2.1.  Definition of inputs and outputs of the created system </h6><br><br>  The input parameter of the fuzzy part of the regulator is the error from the desired height.  The output variable is the proportional part of the pi component of the hybrid controller. <br>  The integral component is the output of the entire system and is implemented simply as a cumulative variable responsible for the position of the servo drive. <br><br><h6>  4.2.2.  Assignment for each of the input and output variables of the membership function with terms </h6><br>  Let's set the output terms of belonging, guided by the uniform distribution of the term on the surface.  The nonlinearity of the output of a fuzzy system is given by the terms of the input variable. <br><br><br>  Figure 10 - Terms of the output variable OUTPUT <br><br>  The input terms of variable error from height are shown in the figure below. <br><br><br>  Figure 11 - Terms of the input variable HEIGHT <br><br><h6>  4.2.3.  Development of a rule base for the implemented fuzzy system </h6><br>  To develop a rule base, it is necessary to designate linguistic variables (terms) with easy-to-understand names. <br><br><br>  Figure 12 - Term Designation <br><br><table><tbody><tr><td>  Height 1 is a strong downward deviation. <br>  Height 2 - downward deviation. <br>  Height 3 - no deflection. <br>  Height 4 - upward deviation. <br>  Height 5 strong deflection top </td><td>  Output 1 - high positive <br>  Output 2 - positive <br>  Output 3 - zero <br>  Output 4 - negative <br>  Output 5 - high negative </td></tr></tbody></table><br><br>  Responsibly establish a direct connection term. <br>  rule block: <br>  IF Height: strong downward deviation, TO Exit: high positive <br>  IF Height: Down Deviation, TO Exit: Positive <br>  IF Height: no deflection, TO Exit: Zero <br>  IF Height: upward deviation, TO Exit: negative <br>  IF Height: strong top deflection, TO Exit: high negative <br><br><h4>  5. Remote control system </h4><br>  The remote control system is implemented in the management of the difference in traction moments on the engines.  The principle of implementation is borrowed from computer games, when pressing a button realizes a smooth deflection of the traction moments and releasing - a smooth return, so the difference in thrust of the engines can be maintained within certain limits. <br><br>  Keystroke signals are transmitted via the wi-fi wireless channel using the ssh protocol, in which keystrokes from the ground-based base station (PC) are transmitted to a remote computer. <br>  The video stream is transmitted in the same way due to the fact that the ssh protocol allows you to monitor the remote machine's screen. <br><br><h4>  6. Experimental study of the system </h4><br>  The designed system was investigated in the laboratory.  The vision system recognizes the position of the line and transmits the coordinates of the points of intersection to the directional control block. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/He_-iBLylqQ%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700191,15700253&amp;usg=ALkJrhjqFPAkcUZzQICV0lGDu10OZxDAcg" frameborder="0" allowfullscreen=""></iframe><br>  The work of the vision system <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/DuNb4dLrdHE%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700191,15700253&amp;usg=ALkJrhhn5oX3dyTmVImR4U7Bb-Vgga8TtA" frameborder="0" allowfullscreen=""></iframe><br>  Flying mini-airship <br><br>  The stability of the system for adjusting the direction and height turned out to be achieved by invoking the coefficient.  proportional to the increase in output of a fuzzy system. <br><br><br>  Figure 13 - Positions of thrust vector and airship height sensor.  The specified height is 80 cm. <br><br>  On the data obtained, we see a high noise signal from the sensor, an error in the design of the system was not using the filter signal.  The reason for not using the signal filter was the test of the sensor, which showed not much noise in the sensor signal.  The test was performed on a non-loaded system, which probably made it possible to accurately generate and track the signal from the sensor.  In the real system of operation, the computer system of the airship was fully loaded, which gave incorrect readings of the sensor readings.  The noise on the graph of the direction of the thrust vector can be ignored, since the servo drive would not have time to turn at a given angle instantly.  The servo managed to perform the rotation only on the average values ‚Äã‚Äãbetween the two turn signals.  The mean values ‚Äã‚Äãare easily visible on the graph. <br><br>  As for the height control system itself, it is obvious that it will pick up the advance of setting the values ‚Äã‚Äãof the thrust vector.  Correct the situation could be the second input variable ‚Äúerror rate‚Äù, which could predict and build control in advance, or simply use the proven PID controller. <br><br>  During the tests, all implemented control units were tested.  The work of the vision system was brought to a completely silent and unmistakable line recognition in the conditions of fluorescent lighting.  Some malfunctions in the settings of the value of the left motor were also detected, which did not properly allow us to adjust the fuzzy direction adjustment system, but even under such conditions, a straight line overflight was made.  Were identified deficiencies in the management, characterized by an acute reaction of the regulator with a close location of the line. <br><br>  The course of the tests was recorded on video, the system states log was also kept, which made it possible to draw the conclusions formulated above. </div><p>Source: <a href="https://habr.com/ru/post/234609/">https://habr.com/ru/post/234609/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../234597/index.html">28 mistakes of a startup in the eyes of an investor. Business angel experience</a></li>
<li><a href="../234599/index.html">Firefox OS smartphone went on sale for $ 33 (in India)</a></li>
<li><a href="../234601/index.html">7-inch TFT LCD backlight brightness control</a></li>
<li><a href="../234603/index.html">The story of the creation of iOS games about fast reaction and steel nerves</a></li>
<li><a href="../234607/index.html">How to enter the US magistracy?</a></li>
<li><a href="../234611/index.html">Setting up a time tracking system: try it out for yourself</a></li>
<li><a href="../234613/index.html">Flask Mega-Tutorial, Part 10: Full-Text Search</a></li>
<li><a href="../234615/index.html">The search engine in the NSA contains more than 850 billion records</a></li>
<li><a href="../234619/index.html">RenderDoc - a graphical debugger for DirectX11 from Crytek</a></li>
<li><a href="../234621/index.html">How we made the educational platform: the first application</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>