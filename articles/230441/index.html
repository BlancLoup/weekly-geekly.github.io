<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>JQuery Deferred - usage examples</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I will not talk about why in javascript you need promises, and in particular JQuery.Deferred. Also, I will not give background informa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>JQuery Deferred - usage examples</h1><div class="post__text post__text-html js-mediator-article">  In this article I will not talk about why in javascript you need promises, and in particular JQuery.Deferred.  Also, I will not give background information, it is enough on the Internet.  For example, <a href="http://api.jquery.com/category/deferred-object/">here</a> or <a href="http://habrahabr.ru/post/112960/">here</a> or <a href="https://www.google.ru/webhp%3Fsourceid%3Dchrome-instant%26ion%3D1%26espv%3D2%26ie%3DUTF-8">here</a> . <br>  This article is for techs who are already a little familiar with the Deferred object from the jQuery library, but have no experience writing complex chains (queues). <br><br><h5>  Training </h5><br>  All code examples discussed here use the asynchronous <b>$ .ajax ()</b> method, which returns the so-called jqXHR in which promis methods are implemented (done, fail, always, then).  We will only need them, so we assume that $ .ajax returns a promise. <br>  Some examples use the $ .map () and $ .each () methods that are part of the jQuery library. <br><br><h5>  Sequential execution </h5><br>  The simplest use of promises is the sequential execution of asynchronous operations.  That is, the next operation does not begin until the current one ends. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="javascript hljs">$.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/1'</span></span>) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(result)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/2'</span></span>) }).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(result)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/3'</span></span>) }).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(result)); });</code> </pre> <br>  A live example is <a href="http://jsfiddle.net/bankrot/qTtv8/2/">here</a> . <br><a name="habracut"></a><br><h5>  Parallel execution </h5><br>  Starts all asynchronous operations at the same time and proceeds to the next callback only when all parallel operations are completed. <br><br><pre> <code class="javascript hljs">$.when( $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/1'</span></span>), $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/2'</span></span>), $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/3'</span></span>) ).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result1, result2, result3</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(result1[<span class="hljs-number"><span class="hljs-number">0</span></span>])); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(result2[<span class="hljs-number"><span class="hljs-number">0</span></span>])); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(result3[<span class="hljs-number"><span class="hljs-number">0</span></span>])); })</code> </pre><br>  A live example is <a href="http://jsfiddle.net/bankrot/psx39/3/">here</a> . <br><br><h5>  Sequential parallel execution </h5><br>  Task: to execute one request, and after its completion, to start parallel execution of several more operations. <br><br><pre> <code class="javascript hljs">$.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/1'</span></span>) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result1</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(result1)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.when( $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/2'</span></span>), $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/3'</span></span>), $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/4'</span></span>) ) }).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result2, result3, result4</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(result2[<span class="hljs-number"><span class="hljs-number">0</span></span>])); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(result3[<span class="hljs-number"><span class="hljs-number">0</span></span>])); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(result4[<span class="hljs-number"><span class="hljs-number">0</span></span>])); })</code> </pre><br>  <a href="http://jsfiddle.net/bankrot/VX9Tr/2/">Living example</a> . <br><br><h5>  Parallel execution of an unknown number of asynchronous operations </h5><br>  Moving on to more difficult situations.  Suppose there is an array with links for each of which you need to make a parallel query.  The task is complicated by the fact that the number of links in the array is not known in advance. <br><br><pre> <code class="javascript hljs">array = [<span class="hljs-string"><span class="hljs-string">'/url1'</span></span>, <span class="hljs-string"><span class="hljs-string">'/url2'</span></span>, ‚Ä¶.. <span class="hljs-string"><span class="hljs-string">'/urlN'</span></span>]</code> </pre><br>  We already know that the $ .when method is used for parallel start as follows: <br><br><pre> <code class="javascript hljs">$.when(promise1, promise2, ‚Ä¶ promiseN)</code> </pre><br>  But, unfortunately, it is impossible to transfer an array of promises to this method.  Therefore, this code can be rewritten a little, and then it is suitable for our task: <br><br><pre> <code class="javascript hljs">$.when.apply(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, [promise1, promise2, ‚Ä¶ promiseN])</code> </pre><br>  But the complete solution of the problem: <br><br><pre> <code class="javascript hljs">urls = [<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/1'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/2'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/3'</span></span>] promises = $.map(urls, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.ajax(url).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(result)); }); }); $.when.apply(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, promises) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'done'</span></span>); });</code> </pre><br>  The same code on <a href="http://jsfiddle.net/bankrot/LGuaz/2/">jsfiddle</a> . <br><br><h5>  Sequential execution of an unknown number of asynchronous operations </h5><br>  The task is the same as in the previous example, but requests must be sent sequentially.  This approach will help if there are a lot of requests, and the server part of the web application is not designed for such loads. <br>  To solve this problem, we will ‚Äúbuild up‚Äù the chain of promises in the cycle. <br><br><pre> <code class="javascript hljs">urls = [<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/1'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/2'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/3'</span></span>] promise = $.when(); $.each(urls, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">index, url</span></span></span><span class="hljs-function">)</span></span>{ promise = promise.then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.ajax(url); }).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(result)); }); }); promise.then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'OK'</span></span>); });</code> </pre><br>  Here I applied a small trick: promise = $ .when ().  Running the $ .when method with no arguments will return a resolved promise that will be the first link in the chain. <br>  <a href="http://jsfiddle.net/bankrot/XVG5b/3/">View</a> code in action. <br><br><h5>  Simple error handling: one handler for all operations </h5><br>  For error handling, the .fail method is used.  In the example below, this method is located at the very end of the promis chain, and if an error occurs, all the completed callbacks are skipped. <br><br><pre> <code class="javascript hljs">$.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/1'</span></span>) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'OK 1'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/2'</span></span>); }).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'OK 2'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest_fail.com/id/3'</span></span>); }).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'OK 3'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/4'</span></span>); }).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'OK 4'</span></span>); }).fail(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'error'</span></span>); });</code> </pre><br>  <a href="http://jsfiddle.net/bankrot/rY8mq/2/">Run</a> this code. <br><br><h5>  Stopping chain execution after error handling </h5><br>  If several error handlers (rejected promises) are used in the chain, then if any errors occur, all subsequent fail callbacks will be called.  Example: <br><br><pre> <code class="javascript hljs">$.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/1'</span></span>) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'OK 1'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/2'</span></span>); }).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'OK 2'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest_fail.com/id/3'</span></span>); }).fail(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'error 1'</span></span>); }).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'OK 3'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/4'</span></span>); }).fail(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'error 2'</span></span>); }).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'OK 4'</span></span>); }).fail(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'error 3'</span></span>); });</code> </pre><br><br>  After executing this code, we will see the following in the console: <br><br><pre> <code class="javascript hljs">OK <span class="hljs-number"><span class="hljs-number">1</span></span> OK <span class="hljs-number"><span class="hljs-number">2</span></span> error <span class="hljs-number"><span class="hljs-number">1</span></span> error <span class="hljs-number"><span class="hljs-number">2</span></span> error <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre><br>  <a href="http://jsfiddle.net/bankrot/LDFTF/">Link</a> for those who do not believe. <br>  But most likely this behavior is not useful to us.  We will do this so that after processing the error, no subsequent callback will be called. <br><br><pre> <code class="javascript hljs">$.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest_fail.com/id/1'</span></span>) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'OK 1'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/2'</span></span>); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'error 1'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.Deferred(); }).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'OK 2'</span></span>); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'error 2'</span></span>); })</code> </pre><br>  Look at the <a href="http://jsfiddle.net/bankrot/m2YVX/1/">result</a> . <br>  In this example, two things should be noted.  First, error handlers are now specified by the second argument of the .then method.  Second, the error handler returns a Deferred object (promise) that is neither resolved nor rejected. <br><br><h5>  Continuing chain execution after error handling </h5><br>  Slightly changing the previous example can be done so that after processing the error the following done callback will be called. <br><br><pre> <code class="javascript hljs">$.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest_fail.com/id/1'</span></span>) .then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'OK 1'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.ajax(<span class="hljs-string"><span class="hljs-string">'http://echo.jsontest.com/id/2'</span></span>); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'error 1'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $.when(); }).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'OK 2'</span></span>); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'error 2'</span></span>); })</code> </pre><br>  <a href="http://jsfiddle.net/bankrot/eyGh7/2/">This</a> example differs from the previous one only in the seventh line. <br><br><h5>  Conclusion </h5><br>  The JQuery.Deferred component is not as complicated as it seems when you first meet it, but the other libraries that implement the functionality of promises are just as simple. <br><br><h5>  UPD </h5><br>  Thanks to <a href="http://habrahabr.ru/users/mayorovp/" class="user_link">mayorovp</a> for <a href="http://habrahabr.ru/company/bankrot-pro/blog/230441/">comment</a> </div><p>Source: <a href="https://habr.com/ru/post/230441/">https://habr.com/ru/post/230441/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../230425/index.html">Writing your autocompletions for Shell. Part 2: bash</a></li>
<li><a href="../230427/index.html">Indie games are like indie games only.</a></li>
<li><a href="../230431/index.html">Using elements as background images with -moz-element</a></li>
<li><a href="../230435/index.html">About QML and the new Yandex.Disk REST API</a></li>
<li><a href="../230439/index.html">How to create clear logical (L3) network diagrams</a></li>
<li><a href="../230443/index.html">Structuring, grouping and binding in SVG - elements <g>, <use>, <defs> and <symbol></a></li>
<li><a href="../230445/index.html">Comparison of first-generation manned spacecraft</a></li>
<li><a href="../230449/index.html">18 surprises when reading jQuery source code</a></li>
<li><a href="../230451/index.html">Change Java to Scala. Basic application</a></li>
<li><a href="../230455/index.html">Useful materials for mobile developer # 62 (July 14-20)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>