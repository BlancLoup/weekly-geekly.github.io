<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to make friends LO and MSO. Part 2: Automatic test generation for docx and odt</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, reader! As promised , I continue to test various document formats in MS Office 2010 and LibreOffice 3.5. During the writing of this post, I man...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to make friends LO and MSO. Part 2: Automatic test generation for docx and odt</h1><div class="post__text post__text-html js-mediator-article">  Hello, reader!  <a href="http://habrahabr.ru/post/214543/">As promised</a> , I continue to test various document formats in MS Office 2010 and LibreOffice 3.5.  During the writing of this post, I managed to check the odt and docx formats in my work - unfortunately, I was disappointed.  But let's not get ahead;  under the cut how these formats are processed in MSO and LO, as well as a small surprise for testers: how to automate the process of generating tests for such an unusual area as document formats. <br><a name="habracut"></a><br><h4>  Expectations </h4><br>  In the comments to the <a href="http://habrahabr.ru/post/214543/">previous post</a> , as elsewhere on the Internet, they talked a lot about the docx and odt formats as replacing the old and (as it turned out) not very good doc.  Talked a lot about the standard doc, remembered a lot about the quality of formulas in odt, it was a sin not to test these formats in action.  To be honest, I expected that odt would open here and there without any problems, docx will show results worse than odt, but much better than doc.  But dreams did not come true ... <br><br><h4>  Test Generator </h4><br>  I prepared the doc tests for about a day.  According to the logic, I needed as much for docx and another day for odt.  Three days to write the same tests, but in different formats!  What programmer can it do?  The basis of my idea is the following observation: if you save any components in odt under LO, they will not change when reopened in LO.  This means that all the tests initially needed to be written in the odt format, then they only needed to be re-saved in the doc and docx formats, which would give us three tests instead of one.  Fortunately, soffice has the --convert-to option, which I used for automation. <br><br>  So, how to automate the creation of tests: <br><ol><li>  We write all tests in odt </li><li>  We write a small sh to convert odt to any format. <br><div class="spoiler">  <b class="spoiler_title">converter.sh</b> <div class="spoiler_text"><pre><code class="bash hljs">soffice --headless --convert-to <span class="hljs-variable"><span class="hljs-variable">$2</span></span> <span class="hljs-variable"><span class="hljs-variable">$1</span></span></code> </pre> <br></div></div></li><li>  We write one more sh to automate the process of converting all available odt tests. <br><div class="spoiler">  <b class="spoiler_title">create.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> `seq 12`; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> <span class="hljs-variable"><span class="hljs-variable">$i</span></span>; ../converter.sh <span class="hljs-string"><span class="hljs-string">"*.odt"</span></span> doc; ../converter.sh <span class="hljs-string"><span class="hljs-string">"*.odt"</span></span> docx; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> .. <span class="hljs-keyword"><span class="hljs-keyword">done</span></span></code> </pre><br></div></div></li><li>  Just in case, we write sh to remove all doc and docx <br><div class="spoiler">  <b class="spoiler_title">clean.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> `seq 12`; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> rm <span class="hljs-variable"><span class="hljs-variable">$i</span></span>/*.doc* <span class="hljs-variable"><span class="hljs-variable">$i</span></span>/*/*.doc*; rm <span class="hljs-variable"><span class="hljs-variable">$i</span></span>/*.docx* <span class="hljs-variable"><span class="hljs-variable">$i</span></span>/*/*.docx*; <span class="hljs-keyword"><span class="hljs-keyword">done</span></span>;</code> </pre><br></div></div></li></ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a result, we get a test generator from odt to doc and docx + completely rewritten tests for all three formats in one day! <br><br><h4>  In addition to the formats </h4><br>  New formats are good, but I did not forget about the requests of readers and added formulas and footnotes to the tests.  As it turned out, things are not as bad as they said.  Most of the components are displayed <s>correctly</s> . <br><br>  Also slightly changed the log.  Added some statistics to find the most "good" format, which would be well displayed in most cases on both editors. <br><br><h4>  results </h4><br><h5>  Pages </h5><br>  All formats work correctly with page sizes, their orientation, margins and borders.  It is better not to use the background color of pages at all, as well as indents from borders (it is replaced by margins or indents of paragraphs). <br><br><h5>  Footers </h5><br>  If you need to specify the height of footers (in LO - interval) or add page numbers, then no problems in any of the formats will not arise.  But here borders and side margins are not very well processed, tables in footers in docx format are just as poorly processed, they are deleted in LO (oddly, but even deleted they are visible in MSO). <br><br><h5>  Columns </h5><br>  There are no problems anywhere. <br><br><h5>  Paragraph </h5><br>  Indents, spacing, and alignment in all formats and editors are displayed in the same way, as are colors with different selections.  Borders can also be used without fear, but you should forget about such exotic as vertical alignment relative to the baseline, MSO simply does not know about it.  The parameters "Do not break a paragraph" and "Do not tear off from the next" are also correctly displayed in all formats and editors. <br><br><h5>  Characters </h5><br>  There are no problems except for two: <br><ul><li>  You can forget about overwriting </li><li>  Hyperlinks are deleted when opening odt via MSO </li></ul><br><br><h5>  Lists </h5><br>  All is well in doc and docx too.  In odt offset lists are shifted. <br><br><h5>  Images </h5><br>  In short - use doc.  There will be no problems with the images in your documents. <br><br><h5>  Tables </h5><br>  Similar to the previous paragraph - doc showed itself here as well. <br><br><h5>  Review </h5><br>  If you love odt, you can forget about portability!  MSO removes all change data from a document without your consent. <br><br><h5>  Fields </h5><br>  It seems that everything is correct everywhere, but after long tests I came to the conclusion - do not use special fields in your documents (except for the number and number of pages, of course). <br><br><h5>  Formulas </h5><br>  Here docx out of competition.  Excellent display of formulas and the ability to edit (though with left-sided indices is not very - they simply do not exist). <br><br><h5>  Footnotes </h5><br>  All formats proved to be good, only docx decided to use numbers with letter numbering of footnotes, but this is not terrible, is it? <br><br><h4>  My verdict </h4><br>  If you need a contract, a letter and similar business documentation, use doc.  Both text formatting and various inserts (except for formulas) are perfectly handled. <br><br>  Need to write a report, thesis or coursework?  Use docx and you won't have any problems with formulas. <br><br>  Do you have red eyes of a linuksoid and you are moving the cursor to the side ‚ÄúDon't like it‚Äù with thoughts - ‚Äúodt forever !!!‚Äù?  It is not my fault that odt showed itself worse than others.  For some reason, all the odt files did not want to open normally in MSO and demanded "Recover Document".  What it can be connected with - I don‚Äôt know, I created the documents by the rules, I didn‚Äôt arrange any dances with a tambourine over the used LO.  Maybe it's in the version (I have LO 3.5)? </div><p>Source: <a href="https://habr.com/ru/post/215103/">https://habr.com/ru/post/215103/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../215089/index.html">Smartphone for $ 100</a></li>
<li><a href="../215091/index.html">Hal Finney: Bitcoin and Me</a></li>
<li><a href="../215095/index.html">Graphs of the contribution, taking into account time zones</a></li>
<li><a href="../215099/index.html">Using DSP SB Live! for the benefit of radio amateurs (KX Driver's) - Part [2/2]</a></li>
<li><a href="../215101/index.html">On the features of the implementation of prefix entropy coding for large alphabets</a></li>
<li><a href="../215105/index.html">Games with UEFI</a></li>
<li><a href="../215107/index.html">A plugin that adds tabs to QtCreator</a></li>
<li><a href="../215109/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ99 (March 2 - 8, 2014)</a></li>
<li><a href="../215111/index.html">Running SSH commands on hundreds of servers using Go</a></li>
<li><a href="../215115/index.html">The tale of the lost Moscow time, or what were the wrong guys from Microsoft</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>