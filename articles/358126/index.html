<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Briefly about Shadowsocks, or OpenVPN is not needed (in every home)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nowadays, when all sorts of bad elements and strive to get into your traffic and somehow there is a mess, it has become fashionable to encrypt traffic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Briefly about Shadowsocks, or OpenVPN is not needed (in every home)</h1><div class="post__text post__text-html js-mediator-article">  Nowadays, when all sorts of bad elements and strive to get into your traffic and somehow there is a mess, it has become fashionable to encrypt traffic.  Starting this good and useful, only do it often redundant.  If encrypting traffic to a trusted server, such as your VPS, is your only goal, then OpenVPN is too heaped up for such a purpose.  It is long to configure, easy to detect, and most importantly - there are pitfalls, without knowing which you can get such a situation that the VPN costs and traffic goes around.  All this because OpenVPN was conceived more as a means of accessing a small network via the Internet, and not to access the entire Internet. <br><a name="habracut"></a><br>  And here the fraternal people of China made a smart gift to us.  C 2012, they sawed free open-source project <i>Shadowsocks</i> .  This is a couple of programs for the server and the client, which work according to the following principle: the client pretends to be a SOCKS5 proxy server, receives incoming connections, encrypts them, transmits it to the server and releases it to the Internet.  That is, the principle of operation is similar to an SSH tunnel, but it has a lot of advantages and a couple of disadvantages compared to it. <br><br><h4>  Shadowsocks dignity </h4><br><ul><li>  Ease of server setup: below I will show that the standard config is just 5 lines, and you don‚Äôt need to mess around with certificates.  Well, really, it's not the banking network that we do. </li><li>  Easy to customize client.  <a href="https://www.shadowsocks.org/en/download/clients.html">Clients</a> have everything, not afraid of the big word.  Client config is the same 5 lines. </li><li>  The client does not need admin rights to work.  Moreover, it can be installed from pip.  That is, any programmer can connect from work. </li><li>  Easy to configure access at the level of individual programs.  In the browser, using add-ons like FoxyProxy / OmegaSwitchy is generally so at the level of individual addresses according to complex rules.  When using VPN, this can be achieved only by raising local proxies on each client. </li><li>  Unlike VPN, which on most systems is implemented through a virtual network card, the Shadowsocks client does not go anywhere with a connection break.  So your traffic will not go by itself unprotected way.  In addition, even if the Shadowsocks application itself crashes, programs will not contact directly unless they are configured to do so.  When using VPN, kill-switches have to be implemented, and these, especially under Windows, are unreliable and have side effects. </li><li>  Compared with SSH tunnel - large bandwidth, supports thousands of clients with a bunch of connections from each.  SSH tunnel under, for example, torrents, noticeably sad;  In addition, minor irregularities of the network significantly reduce its speed.  Shadowsocks don't care. </li><li>  Drives less technical information on the connections, which is favorable for the battery of mobile devices. </li><li>  There are exotic versions of servers, written in the form of libraries for different languages.  That is, you can add a server to your program to encrypt access to your clients. </li><li>  Graphic customization of customers.  You can make a QR code, when scanning which clients of mobile phones and Windows configure themselves.  One client under Windows was configured, the code was generated, it was scattered on 20 mobile phones in a minute.  You can put on the site, or hang on the wall. </li></ul><br><h4>  Disadvantages of Shadowsocks </h4><br><ul><li>  Unlike OpenVPN, did not pass official audit.  So a lot of people were looking at it, since the code is open and small, but officially it isn‚Äôt. </li><li>  Does not share users.  You can teach to listen <a href="https://github.com/shadowsocks/shadowsocks/wiki/Configure-Multiple-Users">on several ports</a> with different passwords, but on one port - one password.  The knowledge of the password does not allow (in theory) to listen to another subscriber of the same port. </li><li>  Can not forward the port in the opposite direction.  That is, all as for NAT sit.  You have to use SSH tunnel if you can. </li><li>  The client for Android holds as many as two (!) Non-selectable messages.  If you do not hide them, it is very disturbing. </li><li>  There are a couple of hard-nosed Windu programs that don‚Äôt crawl into the Shadowsocks like you don‚Äôt customize them.  Alas, the author of the program can write the opening of the connection so as to ignore the proxy settings, and this is how they sometimes do when they check licenses for software.  Below I will write a clever trick how to recognize these programs. </li><li>  Latency connections are higher than OpenVPN.  Not much, and din can be, but still. </li><li>  Cannot compress traffic by archiver.  In the HTTPS century, this is not important, but for, say, uncompressed text files and real Ubunt images - there is a difference. </li><li>  The documentation was written by the Chinese, in Chinese English, with a bunch of missing points and mutual contradictions. </li></ul><br><h5>  Shadowsocks server setup.  Method 1 </h5><br>  We write a config.  Here is an example of a complete working config. <br><br><pre><code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"server"</span></span>:<span class="hljs-string"><span class="hljs-string">"111.222.333.444"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"server_port"</span></span>:<span class="hljs-number"><span class="hljs-number">8390</span></span>, <span class="hljs-attr"><span class="hljs-attr">"local_port"</span></span>:<span class="hljs-number"><span class="hljs-number">1080</span></span>, <span class="hljs-attr"><span class="hljs-attr">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"buratino.ty.sam.sebe.vragg"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"timeout"</span></span>:<span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-attr"><span class="hljs-attr">"method"</span></span>:<span class="hljs-string"><span class="hljs-string">"aes-256-cfb"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fast_open"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre> <br>  This is a config for both server and client.  We have the address and port of the server in turn (at least the 80th is possible);  port from which the client will accept connections (it is better not to touch);  password in clear text;  and the time in seconds after which the server closes an unnecessary channel.  And about the last two in more detail. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Shadowsocks has a bunch of encryption methods to choose from, but only two are practically applicable.  <i>chacha20-ietf-poly1305</i> , an algorithm written by Daniel J. Bernstein, developed by Google for internal needs.  Good for devices that do not know how to hardware AES, and this is very cheap mobile phones and other smart irons;  and for paranoids who are afraid of bookmarks in the processor.  Everyone else use <i>aes-256-cfb</i> .  However, both ciphers are reliable and time-tested. <br><br>  Setting <i>fast_open</i> reduces connection latency, but requires a kernel of at least 3.7.  And even there it does not always work, in particular, it does not work if your virtual machine is made OpenVZ.  On the Scaleway ARMs, too, did not start.  In general, turn on if it works. <br><br>  Now that the config is ready, install the package.  Here it is necessary to clarify that there are two versions.  Just <i>shadowsocks</i> is a reference written in python, and <i>shadowsock-libev</i> is the same but rewritten in pure C for speed.  Here we set it up.  In the newest Linux, it is in the main turnip, and for older ones - <a href="https://github.com/shadowsocks/shadowsocks-libev">see here</a> . <br><br>  Well, run: ss-server -c config.conf.  Everything should work.  Do not forget the firewall and autorun.  I will not write here on Linux administration, so if something doesn't work, go to method 2. <br><br><h5>  Method 2 </h5><br>  Install docker and docker-compose. <br><br><pre> <code class="bash hljs">apt install docker docker-compose</code> </pre> <br>  Next, in the file, which must necessarily be called <code>docker-compose.yml</code> , we write the config like this: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-string"><span class="hljs-string">'3'</span></span> services: shadowsocks: image: shadowsocks/shadowsocks-libev:latest environment: - TZ=Europe/Moscow - <span class="hljs-keyword"><span class="hljs-keyword">PASSWORD</span></span>=buratino.ty.sam.sebe.vragg - <span class="hljs-keyword"><span class="hljs-keyword">METHOD</span></span>=aes<span class="hljs-number"><span class="hljs-number">-256</span></span>-cfb - ARGS=<span class="hljs-comment"><span class="hljs-comment">--fast-open ports: - "8390:8390" - "8390:8390/udp" restart: unless-stopped</span></span></code> </pre> <br>  Pay attention to the indents, they are important.  If you want, you can pick up several servers at different ports with different passwords, for this you just need to duplicate the whole block of shadowsocks: with different names.  When the config is ready, run it in the same folder <br><br><pre> <code class="bash hljs">docker-compose up -d</code> </pre> <br>  and everything will start.  Docker even for you, without demand, will drill a hole in the firewall for each port, such an infection. <br><br><h5>  Client configuration </h5><br>  It's all easier.  We go <a href="https://www.shadowsocks.org/en/download/clients.html">to the site</a> , download the desired client, set up in the interface.  For linuksoidov, of course, there is a console daemon, eating config from method 1. <br><br>  After setting up the client, a SOCKS5 proxy will be sitting on your system on port 1080, which by default is not accessible from the outside.  But you can open it if you are in a friendly locale.  It is important to understand that the programs themselves will not break there.  You need to configure the system proxy (if you want all the programs to go through Socks) or each program separately, and it‚Äôs better that and that doesn‚Äôt hurt.  On Windows 10 in the control panel there is the item Network &amp; Internet ‚Üí Proxy.  There you need to enter the proxy address 127.0.0.1, port as configured (1080) and ignore for: the local network (usually 192.168.0.1/24, although see for yourself) and, for the server's IP address itself.  If someone uses Linux Subsystem, then this configuration does not apply to it, it is necessary to declare the variable <i>socks5_proxy there</i> .  Full Linux usually have similar settings in the control panel.  For browsers, I recommend add-ons like FoxyProxy (FF) and SwitchyOmega (Chrome) for detailed settings, which site to go through a proxy, and which one directly.  In particular, direct access must be configured to the resources of your provider, and, possibly, to your bank.  I also recommend not to surprise Mosenergosbyt with invoices from abroad - they are there, and so are some kind of shy.  Paypal, oddly enough, to the bulb.  Do not forget to tick "DNS through proxy" or make sure that it is the default so. <br><br><h5>  Operation check </h5><br>  At this stage, everything should work.  Need to do 2 tests.  First, a browser, preferably a primitive ‚Äúout-of-the-box‚Äù, and not the main one, go to <a href="https://duckduckgo.com/">https://duckduckgo.com/</a> and enter <i>my ip</i> into the search.  The address must be server.  Then, in the client settings, enter the wrong password, and make sure that all the programs stopped working.  This is a check that no program is crawling around a proxy. <br><br><h5>  Additions </h5><br>  I'll tell you about some additions to Shadowsocks, but I will not delve into their settings.  Ask if that. <br><br>  <b>Polipo</b> .  Some ancient or up [er / oro] programs are not able to SOCKS5, but <i>HTTP_PROXY</i> are able.  In particular, the official Twitter client for Android still does not know how to use Shadowsocks if it is installed not on a mobile phone, but, say, on a router.  In this case, you can install the Polipo http_proxy server, and in its settings specify the redirect to Shadowsocks.  All http proxy programs are abandoned due to low need, but Polipo still works without problems. <br><br>  <b>Obfs-proxy</b> .  Allows you to wrap Shadowsocks traffic in clean, unremarkable SSL and so on port 443. This is if someone already has white lists of protocols. <br><br>  <b>KCPTUN</b> .  The KCP protocol is an add-on over UDP for working in very poor networks with large losses, such as a cellular modem on the verge of reception or a tropospheric radio-relay communication.  Using KCP will allow to communicate a little faster than pure UDP, and Shadowsocks is a very convenient way to wrap your traffic in KCP. <br><br>  <b>Fail2ban</b> would be nice to configure more to repel DDoS attempts to the server.  But if you do not offend schoolchildren, then who will dispose you?  Set a longer password, the benefit of it even once in mobile phones do not have to drive, and do not worry.  My real password is 40 random characters. <br><br>  Everything! </div><p>Source: <a href="https://habr.com/ru/post/358126/">https://habr.com/ru/post/358126/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../358116/index.html">Monitoring network traffic on servers in the cloud</a></li>
<li><a href="../358118/index.html">AI, practical course. Foreword</a></li>
<li><a href="../358120/index.html">Information exchange between working threads without pain? CSP channels to help us</a></li>
<li><a href="../358122/index.html">8088 MPH: we will break all your emulators</a></li>
<li><a href="../358124/index.html">How to make a configuration file of routes in React Router 4 (subtitles)</a></li>
<li><a href="../358128/index.html">Detection of criminal groups stealing from stores - Data Mining</a></li>
<li><a href="../358130/index.html">RKN unlocks 3.5 million Google IPs</a></li>
<li><a href="../358132/index.html">[Peter] JUG.ru meeting with Oleg Chirukhin - GraalVM Almighty</a></li>
<li><a href="../358134/index.html">Cross at EITest: how to eliminate the largest network for the spread of viruses</a></li>
<li><a href="../358136/index.html">Tomographic data segmentation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>