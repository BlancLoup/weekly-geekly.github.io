<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to integrate with Cisco security solutions? Overview of two dozen APIs available to all</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, the theme of SOC and SIEM has become very fashionable in Russia. All of them build and write. Did you know that Russia already has about a doze...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to integrate with Cisco security solutions? Overview of two dozen APIs available to all</h1><div class="post__text post__text-html js-mediator-article">  Today, the theme of SOC and SIEM has become very fashionable in Russia.  All of them build and write.  Did you know that Russia already has about a dozen of its own security event monitoring systems (SIEM)?  This number has exceeded the number of commercial SOCs offering their services to customers who fall under the requirements of 187-FZ on the safety of critical information infrastructure and will be forced to promptly give the data on incidents to GOSFNR.  But whatever goal the creators of SIEM and SOC pursue, and no matter what level of maturity they are in, they still face the basic task of collecting security events and logs from scattered information protection tools. <br><br>  According to the company Canalys (and it is the only one who continues to evaluate the Russian market of information security solutions), Cisco remains the leader in the domestic market.  Therefore, it is quite reasonable to assume that one of the first tasks that must confront the developers of SIEM / SOC is integration with the solutions of our company.  But around this integration there are many myths and misconceptions that can be described by the dialogue that I recently had with one of the domestic manufacturers of SIEM: <br><br>  - Why don't you integrate with Cisco solutions? <br>  - So you already have all the proprietary? <br>  - No, it is not so! <br>  - Yes?  And they told me that you have closed APIs and access to them costs money. <br>  - No, and it is not! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/59/ed/e9/59ede985089b2198220111.png" alt="image"><br><a name="habracut"></a><br>  Therefore, I decided today to briefly describe the APIs that exist for Cisco, and with which you can connect to its cybersecurity solutions.  They can be divided into several types: <br><br><ul><li>  APIs that allow access to security events, logs, and context, which are collected by Cisco solutions in a protected enterprise network. </li><li>  APIs that allow you to access Cisco cloud security services for checking suspicious files, domains, IP addresses, etc. </li><li>  APIs that allow you to manage Cisco solutions from external systems. </li><li>  APIs to enrich Cisco solutions with external threat data. </li></ul><br>  The first type of API includes: <br><br><ul><li>  <b>eStreamer API</b> .  An API that allows you to send security events from the multi-functional Firepower security platform to your SIEM. </li><li>  <b>Host Input API</b> .  An API that allows you to collect information about vulnerabilities and other information about nodes on the network.  It is the same that uses the same MaxPatrol from Positive Technologies to transfer Firepower information about vulnerabilities, operating systems and applications on scanned nodes, which is then correlated with threat data collected by the intrusion detection system NGIPS or the anti-malware AMP system on the Firepower platform. </li><li>  <b>JDBC Database Access API</b> .  An API that allows you to query Firepower database from various applications. </li><li>  <b>pxGrid</b> .  This is a whole framework that allows you to exchange security context (who, where, how, from where, with what got access) between the Cisco ISE network access control system and external solutions (SIEM, MDM, ITU, NAC, IRP, UEBA, CASB, IAM, VM and others.).  Using this API, you can receive information about user access events and devices directly from the Cisco network infrastructure (switches, routers, access points, etc.). </li><li>  <b>MDM API</b> .  Allows third-party MDM solutions (for example, Airwatch, MaaS360, Meraki, SAP, XenMobile, Symantec, MobileIron, Good, Intune, etc.) to obtain information about the status of a mobile device from ISE. </li><li>  <b>AnyConnect Network Visibility Module Collection</b> .  Using this API, the AnyConnect security client provides IPFIX data to correlate it with network traffic analysis tools (for example, Cisco Stealthwatch). </li><li>  <b>AMP for Endpoints API</b> .  An API that allows you to give out security events related to malicious code, Cisco AMP (Advance Malware Protection) security tools that are detected, third-party solutions, or other Cisco solutions (for example, Cisco Cognitive Threat Analytics).  Such events may include vulnerable computers, device trajectory (network activity), communication with internal or external nodes, infections, etc. </li><li>  <b>ESA REST API</b> .  Allows you to collect statistics for security events and E-mail Security Appliance. </li><li>  <b>Stealthwatch Data Exporter SDK</b> .  Allows you to collect network flow events from the Cisco Stealthwatch network traffic monitoring system and use them for your own purposes. </li></ul><br>  Let's look at an example of working with the <a href="https://api-docs.amp.cisco.com/">API for AMP for Endpoints</a> , a solution that is placed on personal and mobile devices running Windows, Linux, iOS, Android, MacOS, and which protects against a wide range of threats.  Suppose we want to receive security events that have occurred recently.  To do this, use the ‚ÄúGET / v1 / events‚Äù request, which has many additional options that allow you to make selections on a specific node or group of nodes, the hash of the file of interest, type of event, time, etc.  For example, we may be interested in events for a specific node and then the request through AMP for Endpoints API will look like this: <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> /v1/events?connector_guid[]=af73d9d5-ddc5<span class="hljs-number"><span class="hljs-number">-4</span></span>c93<span class="hljs-number"><span class="hljs-number">-9</span></span>c6d-d5e6b5c5eb01&amp;<span class="hljs-keyword"><span class="hljs-keyword">limit</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  The answer will be as follows: <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"v1.2.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"metadata"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"self"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://api.amp.cisco.com/v1/events?connector_guid[]=af73d9d5-ddc5-4c93-9c6d-d5e6b5c5eb01&amp;limit=1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"next"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://api.amp.cisco.com/v1/events?connector_guid%5B%5D=af73d9d5-ddc5-4c93-9c6d-d5e6b5c5eb01&amp;limit=1&amp;offset=1"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"results"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"total"</span></span>: <span class="hljs-number"><span class="hljs-number">41</span></span>, <span class="hljs-attr"><span class="hljs-attr">"current_item_count"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"index"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"items_per_page"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">6455442249407791000</span></span>, <span class="hljs-attr"><span class="hljs-attr">"timestamp"</span></span>: <span class="hljs-number"><span class="hljs-number">1503024774</span></span>, <span class="hljs-attr"><span class="hljs-attr">"timestamp_nanoseconds"</span></span>: <span class="hljs-number"><span class="hljs-number">98000000</span></span>, <span class="hljs-attr"><span class="hljs-attr">"date"</span></span>: <span class="hljs-string"><span class="hljs-string">"2017-08-18T02:52:54+00:00"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"event_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"Threat Detected"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"event_type_id"</span></span>: <span class="hljs-number"><span class="hljs-number">1090519054</span></span>, <span class="hljs-attr"><span class="hljs-attr">"detection"</span></span>: <span class="hljs-string"><span class="hljs-string">"benign_qa_testware7"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"detection_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"6455442249407791109"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"group_guids"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"b077d6bc-bbdf-42f7-8838-a06053fbd98a"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"computer"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"connector_guid"</span></span>: <span class="hljs-string"><span class="hljs-string">"af73d9d5-ddc5-4c93-9c6d-d5e6b5c5eb01"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hostname"</span></span>: <span class="hljs-string"><span class="hljs-string">"WIN-S1AC1PI6L5L"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"external_ip"</span></span>: <span class="hljs-string"><span class="hljs-string">"10.200.65.31"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"user"</span></span>: <span class="hljs-string"><span class="hljs-string">"johndoe@WIN-S1AC1PI6L5L"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"active"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"network_addresses"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"ip"</span></span>: <span class="hljs-string"><span class="hljs-string">"10.0.2.15"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mac"</span></span>: <span class="hljs-string"><span class="hljs-string">"08:00:27:85:28:61"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"computer"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://api.amp.cisco.com/v1/computers/af73d9d5-ddc5-4c93-9c6d-d5e6b5c5eb01"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"trajectory"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://api.amp.cisco.com/v1/computers/af73d9d5-ddc5-4c93-9c6d-d5e6b5c5eb01/trajectory"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"group"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://api.amp.cisco.com/v1/groups/b077d6bc-bbdf-42f7-8838-a06053fbd98a"</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"file"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"disposition"</span></span>: <span class="hljs-string"><span class="hljs-string">"Unknown"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"file_name"</span></span>: <span class="hljs-string"><span class="hljs-string">".zip"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"file_path"</span></span>: <span class="hljs-string"><span class="hljs-string">"\\\\?\\C:\\Users\\johndoe\\Downloads\\.zip"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"identity"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"sha256"</span></span>: <span class="hljs-string"><span class="hljs-string">"f8a6a244138cb1e2f044f63f3dc42beeb555da892bbd7a121274498cbdfc9ad5"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sha1"</span></span>: <span class="hljs-string"><span class="hljs-string">"20eeee16345e0c1283f7b500126350cb938b8570"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"md5"</span></span>: <span class="hljs-string"><span class="hljs-string">"6853839cde69359049ae6f7bd3ae86d7"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"archived_file"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"disposition"</span></span>: <span class="hljs-string"><span class="hljs-string">"Malicious"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"identity"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"sha256"</span></span>: <span class="hljs-string"><span class="hljs-string">"46679a50632d05b99683a14b91a69ce908de1673fbb71e9cd325e5685fcd7e49"</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"parent"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"process_id"</span></span>: <span class="hljs-number"><span class="hljs-number">3416</span></span>, <span class="hljs-attr"><span class="hljs-attr">"disposition"</span></span>: <span class="hljs-string"><span class="hljs-string">"Clean"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"file_name"</span></span>: <span class="hljs-string"><span class="hljs-string">"explorer.exe"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"identity"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"sha256"</span></span>: <span class="hljs-string"><span class="hljs-string">"80ef843fa78c33b511394a9c7535a9cbace1deb2270e86ee4ad2faffa5b1e7d2"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sha1"</span></span>: <span class="hljs-string"><span class="hljs-string">"ea97227d34b8526055a543ade7d18587a927f6a3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"md5"</span></span>: <span class="hljs-string"><span class="hljs-string">"15bc38a7492befe831966adb477cf76f"</span></span> } } } } ] }</code> </pre> <br>  The second type of API includes: <br><br><ul><li>  <b>Threat Grid API</b> .  Allows you to send suspicious files to the Threat Grid sandbox for analysis and get verdicts about their status (‚Äúclean‚Äù or malicious).  In conditions when antiviruses no longer effectively recognize modern threats, integration with the sandbox (and there are not so many of them in the world) becomes an essential element of the modern protection system.  By the way, one of the answers to the file received for the analysis is to obtain an automatically generated signature for Snort.  Considering that almost all domestic attack detection systems are basically built on Snort, this feature will be very useful for many applications. </li><li>  <b>OpenDNS Investigate API</b> .  Allows you to make requests to the cloud service OpenDNS during investigations, incl.  to analyze the harmfulness of domains. </li><li>  <b>OpenDNS Umbrella API</b> .  Allows you to implement custom policies for controlling access to the Internet, blocking specific domains that are missing in the base of OpenDNS. </li></ul><br>  As an example, the second type of API will look at how the <a href="https://panacea.threatgrid.com/doc/main/api.html">Threat Grid API is used</a> .  Suppose we want to check the status of a previously loaded file for analysis.  Such a request might look like this: <br><br><pre> <code class="hljs pgsql">https://panacea.threatgrid.com/api/v2/<span class="hljs-keyword"><span class="hljs-keyword">search</span></span>/submissions?q=<span class="hljs-number"><span class="hljs-number">23</span></span>aea7cf60fca3c6527c2b5255c6036f2dc414f8368196e198df091cf03dd95f&amp;api_key=llgtslnd5cvb14h4p8m6e6s27f&amp;<span class="hljs-keyword"><span class="hljs-keyword">before</span></span>=<span class="hljs-number"><span class="hljs-number">2017</span></span><span class="hljs-number"><span class="hljs-number">-02</span></span><span class="hljs-number"><span class="hljs-number">-28</span></span>&amp;<span class="hljs-keyword"><span class="hljs-keyword">limit</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  and the answer is: <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"api_version"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">7589645</span></span>, <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"index"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"total"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-attr"><span class="hljs-attr">"took"</span></span>: <span class="hljs-number"><span class="hljs-number">416</span></span>, <span class="hljs-attr"><span class="hljs-attr">"timed_out"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"items_per_page"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"current_item_count"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"item"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"properties"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"metadata"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"tags"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"Kovter"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"vm_runtime"</span></span>: <span class="hljs-number"><span class="hljs-number">300</span></span>, <span class="hljs-attr"><span class="hljs-attr">"md5"</span></span>: <span class="hljs-string"><span class="hljs-string">"f3247e81cc3474559d0e14e2f15837d0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"private"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"organization_id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"state"</span></span>: <span class="hljs-string"><span class="hljs-string">"succ"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"login"</span></span>: <span class="hljs-string"><span class="hljs-string">"adminharry"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sha1"</span></span>: <span class="hljs-string"><span class="hljs-string">"bfafd7f2cd9adff7782f4854bc712bf134ad56f6"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sample"</span></span>: <span class="hljs-string"><span class="hljs-string">"9b7ad0711262b31219ea1d41119868d8"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"filename"</span></span>: <span class="hljs-string"><span class="hljs-string">"23aea7cf60fca3c6527c2b5255c6036f2dc414f8368196e198df091cf03dd95f"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"analysis"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"metadata"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"malware_desc"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"sha1"</span></span>: <span class="hljs-string"><span class="hljs-string">"bfafd7f2cd9adff7782f4854bc712bf134ad56f6"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"magic"</span></span>: <span class="hljs-string"><span class="hljs-string">"PE32 executable (GUI) Intel 80386 (stripped to external PDB), for MS Windows"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"filename"</span></span>: <span class="hljs-string"><span class="hljs-string">"23aea7cf60fca3c6527c2b5255c6036f2dc414f8368196e198df091cf03dd95f.exe"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"size"</span></span>: <span class="hljs-number"><span class="hljs-number">369566</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sha256"</span></span>: <span class="hljs-string"><span class="hljs-string">"23aea7cf60fca3c6527c2b5255c6036f2dc414f8368196e198df091cf03dd95f"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"exe"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"md5"</span></span>: <span class="hljs-string"><span class="hljs-string">"f3247e81cc3474559d0e14e2f15837d0"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"sandcastle_env"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"controlsubject"</span></span>: <span class="hljs-string"><span class="hljs-string">"winxp-x86-intel-2017.01.17"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"vm"</span></span>: <span class="hljs-string"><span class="hljs-string">"winxp-x86"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"vm_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"9b7ad0711262b31219ea1d41119868d8"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sample_executed"</span></span>: <span class="hljs-number"><span class="hljs-number">1487231873</span></span>, <span class="hljs-attr"><span class="hljs-attr">"analysis_end"</span></span>: <span class="hljs-string"><span class="hljs-string">"2017-02-16T08:03:48Z"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"analysis_start"</span></span>: <span class="hljs-string"><span class="hljs-string">"2017-02-16T07:57:01Z"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"run_time"</span></span>: <span class="hljs-number"><span class="hljs-number">300</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sandcastle"</span></span>: <span class="hljs-string"><span class="hljs-string">"3.4.36.10823.577ea7a-1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"current_os"</span></span>: <span class="hljs-string"><span class="hljs-string">"2600.xpsp.080413-2111"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"general_details"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"report_created"</span></span>: <span class="hljs-string"><span class="hljs-string">"2017-02-16T08:03:57Z"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sandbox_version"</span></span>: <span class="hljs-string"><span class="hljs-string">"pilot-d"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sandbox_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"car-work-074"</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"behaviors"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"excessive-suspicious-activity"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">90</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"pe-encrypted-section"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">9</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"process-check-virtualbox"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">90</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"memory-execute-readwrite"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"registry-autorun-key-bat-file"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">95</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"ie-proxy-disabled"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">49</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"malware-kovter-registry"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">95</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"registry-large-data-entry"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">40</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"service-dll-registration"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"files-created-batch"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"file-handler-registration"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">85</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"antivirus-service-flagged-artifact"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">95</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"registry-detection-productid"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"registry-script-detected"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"registry-ie-zone-settings-modified"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">49</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"modified-file-in-user-dir"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">56</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"registry-modified-rootcerts"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">36</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"registry-detection-bios"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"mshta-in-registry"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">95</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"registry-autorun-key-modified"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"threat"</span></span>: <span class="hljs-number"><span class="hljs-number">48</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"threat_score"</span></span>: <span class="hljs-number"><span class="hljs-number">95</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"job_done"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"submitted_at"</span></span>: <span class="hljs-string"><span class="hljs-string">"2017-02-16T07:57:00Z"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sha256"</span></span>: <span class="hljs-string"><span class="hljs-string">"23aea7cf60fca3c6527c2b5255c6036f2dc414f8368196e198df091cf03dd95f"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"score"</span></span>: <span class="hljs-number"><span class="hljs-number">0.7660416</span></span>, <span class="hljs-attr"><span class="hljs-attr">"matches"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> } ] } }</code> </pre> <br>  We see that the Threat Grid API returns us the value of the threat level by a hundred point scale for different types of file behavior (Threat Grid can evaluate up to 800 different parameters depending on the loaded file).  The total value (threat_score) is 95, which means that the file being analyzed is malicious. <br><br>  We can give an example of working with another API that allows evaluating the security of domains, information about which we can receive from ITU, mail gateways, proxies, Internet access control tools, etc.  Using the OpenDNS Investigate API, we can formulate a request to verify the domain of interest to us: <br><br><pre> <code class="hljs ruby">curl --<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> \ --header <span class="hljs-string"><span class="hljs-string">"Authorization: Bearer %YourToken%"</span></span> \ <span class="hljs-symbol"><span class="hljs-symbol">https:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/investigate.api.opendns.com/security</span></span><span class="hljs-regexp"><span class="hljs-regexp">/name/</span></span>{name}.json</code> </pre> <br>  And in the answer we get the values ‚Äã‚Äãof various parameters by which OpenDNS evaluates the security of domains, IP addresses, autonomous systems, etc .: <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"dga_score"</span></span>: <span class="hljs-number"><span class="hljs-number">38.301771886101335</span></span>, <span class="hljs-attr"><span class="hljs-attr">"perplexity"</span></span>: <span class="hljs-number"><span class="hljs-number">0.4540313302593146</span></span>, <span class="hljs-attr"><span class="hljs-attr">"entropy"</span></span>: <span class="hljs-number"><span class="hljs-number">2.5216406363433186</span></span>, <span class="hljs-attr"><span class="hljs-attr">"securerank2"</span></span>: <span class="hljs-number"><span class="hljs-number">-1.3135141095601992</span></span>, <span class="hljs-attr"><span class="hljs-attr">"pagerank"</span></span>: <span class="hljs-number"><span class="hljs-number">0.0262532</span></span>, <span class="hljs-attr"><span class="hljs-attr">"asn_score"</span></span>: <span class="hljs-number"><span class="hljs-number">-29.75810625887133</span></span>, <span class="hljs-attr"><span class="hljs-attr">"prefix_score"</span></span>: <span class="hljs-number"><span class="hljs-number">-64.9070502788884</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rip_score"</span></span>: <span class="hljs-number"><span class="hljs-number">-75.64720536038982</span></span>, <span class="hljs-attr"><span class="hljs-attr">"popularity"</span></span>: <span class="hljs-number"><span class="hljs-number">25.335450495507196</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fastflux"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"geodiversity"</span></span>: [ [ <span class="hljs-string"><span class="hljs-string">"UA"</span></span>, <span class="hljs-number"><span class="hljs-number">0.24074075</span></span> ], [ <span class="hljs-string"><span class="hljs-string">"IN"</span></span>, <span class="hljs-number"><span class="hljs-number">0.018518519</span></span> ] ], <span class="hljs-attr"><span class="hljs-attr">"geodiversity_normalized"</span></span>: [ [ <span class="hljs-string"><span class="hljs-string">"AP"</span></span>, <span class="hljs-number"><span class="hljs-number">0.3761535390278368</span></span> ], [ <span class="hljs-string"><span class="hljs-string">"US"</span></span>, <span class="hljs-number"><span class="hljs-number">0.0005015965168831449</span></span> ] ], <span class="hljs-attr"><span class="hljs-attr">"tld_geodiversity"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"geoscore"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ks_test"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"found"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre> <br>  The third type of API includes: <br><br><ul><li>  <b>Remediation API</b> .  Allows third-party solutions to manage Cisco Firepower multi-functional security platform. </li><li>  <b>FirePOWER 9300 (SSP) REST API</b> .  Allows you to build configuration service chains. </li><li>  <b>Read / Write REST API for Firepower</b> .  Allows you to perform various operations on objects with which Firepower works. </li><li>  <b>Management API for ASA</b> .  Providing Cisco ASA management from third-party solutions, auditing information security policies, etc. </li><li>  <b>CloudLock Enterprise API</b> .  Allows you to manage the Cisco CloudLock cloud access control platform and report generation based on information received from CloudLock. </li><li>  <b>CloudLock Development API</b> .  Allows you to manage cloud micro-services. </li><li>  <b>pxGrid</b> .  An API that allows not only to give contextual information, but also to manage network access, blocking users and devices through Cisco ISE at the level of switches, routers, access points, etc. </li><li>  <b>AMP for Endpoints API</b> .  Allows you to manage black lists of applications on AMP for Endpoints, transfer computers from one group to another, etc. </li></ul><br><img src="https://habrastorage.org/webt/59/ed/e9/59ede984b26ff155445418.png" alt="image"><br><br>  The fourth type includes <br><br><ul><li>  <b>Threat Intelligence Director</b> .  A solution that enables Cisco Firepower Multi-Purpose Security Platform to receive and correlate Threat Intelligence data not only from Cisco Talos, but also from external TI platforms that support STIX and TAXII protocols and standards. </li><li>  <b>AMP Cloud-based API</b> .  An API that allows you not only to send security events related to malicious code, but also to access external Threat Intelligence services.  For example, Cisco AMP for Endpoint can not only send suspicious files to the cloud or local Cisco AMP Threat Grid sandbox, but also, for example, to Virus Total. </li></ul><br>  A natural question arises: how to get access to these APIs?  Everything is very simple.  Cisco has a special Cisco Security Technical Alliance Program, which consists of two large sections: <br><br><ul><li>  <b>DevNet</b> .  This is a two-part platform.  The sandbox ( <a href="">DevNet Sandbox</a> ) provides access to software and hardware, physical and virtual, for rapid development and testing of appropriate solutions.  Work with DevNet is free and provided from any device connected to the Internet.  The second component of DevNet is a learning lab ( <a href="https://learninglabs.cisco.com/">DevNet Learning Labs</a> ), which provides access to learning content, code examples, related to integration with Cisco solutions.  The training lab is also free and available to everyone.  Most of the APIs mentioned above are presented in DevNet, but there are also separate, more detailed sections on the Cisco website, immersing you with programming features for Cisco security solutions (to access some of them you need to have access to the corresponding products or services). <br><img src="https://habrastorage.org/webt/59/ed/e9/59ede98492101796344017.png" alt="image"><br></li><li>  <b>Cisco Solution Partner Program (SPP)</b> .  If DevNet is a self-service platform that you use to develop and test your integration solutions, then SPP is the next step, which implies a more formal relationship with Cisco.  We are talking about independent testing of the developed integration solution, obtaining the status of a technology partner and including its solutions in the corresponding <a href="https://marketplace.cisco.com/catalog">catalog</a> on the Cisco website, which millions of companies around the world have access to. </li></ul><br><img src="https://habrastorage.org/webt/59/ee/08/59ee08215ca95259208403.png" alt="image"><br><br>  In order to integrate your SIEMs and SOCs with Cisco solutions, it is enough just to register on DevNet and, having received code samples, modify your solutions by equipping them with the appropriate components and software calls through the API.  In principle, this is already enough to interact with Cisco security solutions.  This is completely free (excluding your programmers' salaries).  If your task is to enter the international market, to demonstrate your products to a wide audience, to prove serious intentions for integration with Cisco, which is the world leader in the cybersecurity market, then certain investments and SPP membership are necessary.  It is along this path that companies like Check Point, ThreatQuotient, Anomali, Symantec, etc. went. <br><br><img src="https://habrastorage.org/webt/59/ed/e9/59ede985743b2810737944.png" alt="image"><br><br>  I hope that after such a brief excursus, no one will have any doubt that Cisco solutions are open like no one to integrate with external security products and services.  In this direction, the company has been moving for several years, confirming the previously put forward slogan, which the Cisco Cybersecurity Division follows, - ‚ÄúOpen.  Simple  Automation (Openness. Simplicity. Automation). </div><p>Source: <a href="https://habr.com/ru/post/340788/">https://habr.com/ru/post/340788/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../340778/index.html">Method of formalized models as an alternative to neural networks</a></li>
<li><a href="../340780/index.html">Programming for 3CX in C #: use the 3CX Call Control API in the Call Flow Designer development environment</a></li>
<li><a href="../340782/index.html">Fake cryptocurrency trading applications from Google Play were stolen by data</a></li>
<li><a href="../340784/index.html">Yandex. Blitz. 12 algorithmic problems of the qualifying round and their analysis</a></li>
<li><a href="../340786/index.html">EdHack 2017 results - AR and VR in education</a></li>
<li><a href="../340792/index.html">A short course of machine learning or how to create a neural network to solve the scoring problem</a></li>
<li><a href="../340794/index.html">Workshops at FrontFest - cross-platform applications on Angular, 3D games on Canvas and backends on Node.js</a></li>
<li><a href="../340798/index.html">The best UX and web design by Behance users</a></li>
<li><a href="../340800/index.html">The release of OWASP Top 10 2017 RC 2</a></li>
<li><a href="../340806/index.html">‚ÄúThe main challenge is personnel shortage‚Äù is a panel discussion about the selection of data teams. Data Science Week 2017</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>