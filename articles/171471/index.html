<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Boost Signals - Signals and Slots for C ++</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What is this article about 
 Today I will talk about the Boost Signals library - about signals, slots, connections, and how to use them. 

 A signal i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Boost Signals - Signals and Slots for C ++</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/4b2/dcc/45a/4b2dcc45aff2a2e44386286d4010f05c.png" alt="image"><br><h4>  What is this article about </h4><br>  Today I will talk about the Boost Signals library - about signals, slots, connections, and how to use them. <br><br>  <i>A signal</i> is a data type that can store several callback functions in itself and call them. <br>  <i>The slot</i> is, accordingly, functions connected to the signal. <br>  As already mentioned, several functions can be connected to one signal, and when a signal is called, the connected functions are called in the order they are connected. <br>  A similar system is sometimes called event-based, then signals are events, and slots are handlers subscribed to certain events. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Simple example </h4><br>  Let's say we do a UI for the game.  We will have a lot of buttons in the game, and each button, when pressed, will perform certain actions.  And at the same time, I would like all the buttons to belong to the same type of Button - that is, it is necessary to separate the button from the code executed by clicking on it.  Just for this separation and need signals. <br><br>  Announcing the signal is very simple.  Declare it as a member of the class: <br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"boost/signals.hpp"</span></span></span><span class="hljs-meta"> class Button { public: boost::signal</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;void()&gt; OnPressed; // };</span></span></span></span></code> </pre> <br><br>  Here we create a signal that takes no parameters and does not return values. <br>  Now we can connect a slot to this signal.  The easiest way to use the function as a slot: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FunctionSlot</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span>&lt;&lt;<span class="hljs-string"><span class="hljs-string">"FunctionSlot called"</span></span>&lt;&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } ... Button mainButton; mainButton.OnPressed.connect(&amp;FunctionSlot); <span class="hljs-comment"><span class="hljs-comment">// </span></span></code> </pre><br><br>  In addition to the function, you can also connect a function object: <br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FunctionObjectSlot</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span>&lt;&lt;<span class="hljs-string"><span class="hljs-string">"FunctionObjectSlot called"</span></span>&lt;&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } }; ... <span class="hljs-comment"><span class="hljs-comment">//   mainButton.OnPressed.connect(FunctionObjectSlot());</span></span></code> </pre><br>  Sometimes, if the code is very small, it is more convenient to write an anonymous function and immediately connect it: <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   mainButton.OnPressed.connect([]() { std::cout&lt;&lt;"Anonymous function is called"&lt;&lt;std::endl; });</span></span></code> </pre><br><br>  If you need to call the object's method, you can also connect it using the syntax <i>boost :: bind</i> : <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"boost/bind.hpp"</span></span></span><span class="hljs-meta"> class MethodSlotClass { public: void MethodSlot() { std::cout&lt;&lt;</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"MethodSlot is called"</span></span></span><span class="hljs-meta">&lt;&lt;std::endl; } }; ... MethodSlotClass methodSlotObject; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//  mainButton.OnPressed.connect(boost::bind(&amp;MethodSlotClass::MethodSlot, &amp;methodSlotObject));</span></span></span></span></code> </pre><br><br>  About Boost Bind, I probably will write a separate article. <br>  Thus, we connected several slots to the signal at once.  In order to ‚Äúsend‚Äù a signal, you must call the parenthesis operator () for the signal: <br><pre> <code class="cpp hljs">mainButton.OnPressed();</code> </pre><br><br>  In this case the slots will be called in the order of their connection.  In our case, the output will be as follows: <br><blockquote>  FunctionSlot called <br>  FunctionObjectSlot called <br>  Anonymous function is called <br>  MethodSlot is called <br></blockquote><br><br><h4>  Signals with parameters </h4><br>  Signals may contain parameters.  Here is an example slot declaration that contains parameters: <br><pre> <code class="cpp hljs">boost::signal&lt;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)&gt; SelectCell;</code> </pre><br><br>  In this case, obviously, the functions must be with parameters: <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnPlayerSelectCell</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span>&lt;&lt;<span class="hljs-string"><span class="hljs-string">"Player selected cell: "</span></span>&lt;&lt;x&lt;&lt;<span class="hljs-string"><span class="hljs-string">", "</span></span>&lt;&lt;y&lt;&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } <span class="hljs-comment"><span class="hljs-comment">//   : SelectCell.connect(&amp;OnPlayerSelectCell); // : SelectCell.connect([](int x, int y) { std::cout&lt;&lt;"Player selected cell: "&lt;&lt;x&lt;&lt;", "&lt;&lt;y&lt;&lt;std::endl; }); //   : SelectCell(10, -10);</span></span></code> </pre><br><br><h4>  Signals returning objects </h4><br>  Signals can return objects.  One subtlety is connected with this - if several slots are caused, then in fact, several objects are returned, aren‚Äôt they?  But the signal, in turn, can return only one object.  By default, the signal returns the object that was received from the last slot.  However, we can transmit our own ‚Äúaggregator‚Äù to the signal, which will group the returned objects into one. <br><br>  I, of course, did not encounter a situation where I need to return values ‚Äã‚Äãfrom a signal, but oh well.  Suppose, in our case, the signal causes slots that return strings, and the signal must return a string glued from these strings. <br>  Such an aggregator is written simply - it is necessary to create a structure with template-based operator "brackets", which takes iterators as parameters: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sum</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> InputIterator&gt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(InputIterator first, InputIterator last)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  -   : if (first == last) { return std::string(); } // -   : std::string sum; while (first != last) { sum += *first; ++first; } return sum; } }; //  : auto f1 = []() -&gt; std::string { return "Hello "; }; auto f2 = []() -&gt; std::string { return "World!"; }; boost::signal&lt;std::string(), Sum&gt; signal; signal.connect(f1); signal.connect(f2); std::cout&lt;&lt;signal()&lt;&lt;std::endl; // "Hello World!"</span></span></code> </pre><br><br><h4>  Turn off signals </h4><br>  In order to disconnect all signals from the slot, you should call the disconnect_all_slots method. <br>  In order to manage a separate slot, you will have to create a separate object like boost :: connection when connecting a slot. <br>  Examples: <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   mainButton.OnPressed.disconnect_all_slots(); //    FunctionSlot boost::signals::connection con = mainButton.OnPressed.connect(&amp;FunctionSlot); //  if (con.connected()) { //FunctionSlot   . mainButton.OnPressed(); // "FunctionSlot called" } con.disconnect(); //   mainButton.OnPressed(); //  </span></span></code> </pre><br><br><h4>  Call signaling order </h4><br>  I do not know when this can be useful, but when connecting slots, you can specify the order of the call: <br><pre> <code class="cpp hljs">mainButton.OnPressed.connect(<span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;FunctionSlot); mainButton.OnPressed.connect(<span class="hljs-number"><span class="hljs-number">0</span></span>, FunctionObjectSlot()); mainButton.OnPressed(); <span class="hljs-comment"><span class="hljs-comment">//  "FunctionObjectSlot called",   "FunctionSlot called"</span></span></code> </pre><br><br><h4>  Conclusion </h4><br>  Signals and slots are very convenient in the case when you need to reduce the connectivity of various objects.  Earlier, in order to call some objects from others, I passed pointers to one objects to other objects, and this caused cyclic references and turned my code into a mess.  Now I use signals that allow us to stretch thin ‚Äúbridges‚Äù between independent objects, and this greatly reduced the connectivity of my code.  Use signals and slots for health! <br><br><h4>  References: </h4><br>  <a href="http://www.boost.org/doc/libs/1_53_0/doc/html/signals.html">www.boost.org/doc/libs/1_53_0/doc/html/signals.html</a> </div><p>Source: <a href="https://habr.com/ru/post/171471/">https://habr.com/ru/post/171471/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../171457/index.html">New builds of Ubuntu Touch are now laid out every day</a></li>
<li><a href="../171459/index.html">SublimeHaskell updated</a></li>
<li><a href="../171461/index.html">Chrome for Android plans to "speed up" by passing traffic through a remote server</a></li>
<li><a href="../171463/index.html">Why lay CloudFlare</a></li>
<li><a href="../171467/index.html">The second issue of the magazine TsODy.RF</a></li>
<li><a href="../171473/index.html">Qualcomm claims Snapdragon 800 beats Nvidia Tegra 4 easily</a></li>
<li><a href="../171475/index.html">Performance test: amazing and simple</a></li>
<li><a href="../171477/index.html">Webrtc, Peer Connection - creating a full-fledged video chat in the browser</a></li>
<li><a href="../171479/index.html">About modularity, good architecture, dependency injection in C / C ++ and multicolored circles</a></li>
<li><a href="../171481/index.html">Review NOOK Simple Touch with GlowLight</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>