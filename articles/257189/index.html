<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Imager on FLIR Lepton do it yourself</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Finally, we survived to the time when the thermal imaging technique, firstly, became available not only to military men and spies, and secondly, it mi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Imager on FLIR Lepton do it yourself</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/f15/f78/222/f15f78222ac943eeaf34d42278d0710d.jpg"><img src="https://habrastorage.org/files/a10/b84/c7d/a10b84c7dc4e474abb83c19f36d8ea47.png"><br><br>  Finally, we survived to the time when the thermal imaging technique, firstly, became available not only to military men and spies, and secondly, it miniaturized to the size of a handheld device.  And what's more, modules have appeared for assembling our own DIY thermal imagers.  But more about that later. <br><a name="habracut"></a><br><h1>  Some theory </h1><br>  Any heated bodies emit EMR.  Wien's law of displacement, which indicates how much wavelength will be the peak of the radiation of a heated absolute black body: <br><br><img src="https://habrastorage.org/files/945/7d4/287/9457d4287c214349b9785038d72ba908.png"><img src="https://habrastorage.org/files/9de/135/36e/9de13536ee724282b883f839b3aea325.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At room temperature, the peak is in the infrared range invisible to our eye.  If, for example, we forge iron, then when it is heated it will turn red, then white ... When cooled, the radiation wavelength will increase, shifting back to the IR range.  Thus, from the observed wavelength of thermal radiation, we can get the body temperature. <br><br>  But what about objects that have a sufficiently low temperature, for example, a room temperature?  They certainly do not glow in the visible range.  Here come to the aid of special devices - thermal imagers.  They are able to register the waves of the middle and long infrared range.  Such devices are used, for example, for monitoring equipment, when you need to find out which element or node is heated above an acceptable level.  Also, thermal imagers are used to check the insulation of houses, determining the location and intensity of heat leakage. <br><br><img src="https://habrastorage.org/files/5de/063/f3d/5de063f3d44046be9ebc3dfcd0fb54af.jpg"><img src="https://habrastorage.org/files/18b/f3d/dd7/18bf3ddd70044aa7ad144ef4cb936fe3.png"><br><br>  <sup><i>Example thermography (source: Internet)</i></sup> <br><br>  For example, when I made my thermal imager, I examined plastic windows with it and immediately found the place from where it blows, since there is a bad seal. <br><br>  Not so long ago, the FLIR infrared camera was at the center of a sports scandal: it showed that the bicycle frame of one of the participants of the bicycle race was suspiciously heated.  It turned out that the motor was hidden inside, which helped the athlete to pedal.  So this year, thermal imagers are used to detect such cases on the Tour de France. <br><br><img src="https://habrastorage.org/files/a39/385/dbd/a39385dbd3fe4c7dacea9ea04c6341e7.png"><br><br><h1>  What is FLIR Lepton? </h1><br>  In 2014, FLIR, a world leader in the development of thermal imaging technology, launched a miniature sensor, an LWIR sensor that can detect infrared waves in the range of 8-14 microns.  It is this range that accounts for the maximum radiation of bodies with temperatures from ‚Äì50 to +50 degrees Celsius.  (But this does not mean that hotter bodies, for example, a kettle, will not be visible in this thermal imager). <br><br><img src="https://habrastorage.org/files/30f/fa5/582/30ffa5582c0e4ca286e2df0cd15535d6.png"><br><br>  The sensor is miniature, provides a thermal resolution of 80 x 60 pixels with a refresh rate of 9 Hz.  The data acquisition interface is Video over SPI, and the controls are I2C.  Both interfaces are supported by the Raspberry Pi, so DIY enthusiasts immediately had an idea what could be done with a thermal imager from Lepton. <br>  In 2014, FLIR has not yet worked with the DIY community, so we gathered at <a href="https://store.groupgets.com/">groupgets.com</a> and <a href="https://geektimes.ru/post/255082/">ordered a</a> batch of 100 pieces in bulk.  It happened before the collapse of the ruble, so I got the sensor pretty cheap.  Unfortunately, the prices for such equipment are quite high.  The sensor itself was worth $ 250, at that time it is less than 10,000 rubles.  Now the thermal imager of the same resolution costs ~ 40,000 rubles in the store.  In addition, Lepton is in the Flir One module for smartphones (~ 25 000 rubles). <br><br><img src="https://habrastorage.org/files/0a1/e33/dba/0a1e33dbaa314bec9f2b48a85d0f1a1d.jpg"><br><br>  <sup><i>Heat trace on the table</i></sup> <br><br><img src="https://habrastorage.org/files/5ac/4d5/60b/5ac4d560bdf3441a8c0f8a1d39b1ab62.jpg"><br><br>  <sup><i>Lepton is able to catch radiation and distant objects from the street.</i></sup> <br><br><h1>  We collect the thermal imager </h1><br>  The guys from the company Pure Engineering made for FLIR Lepton <i>breakout board</i> , which is connected to Raspberry Pi, which works with it on I2C and SPI. <br><br><img src="https://habrastorage.org/files/a10/b84/c7d/a10b84c7dc4e474abb83c19f36d8ea47.png"><img src="https://habrastorage.org/files/e95/f7d/6ec/e95f7d6ec56e4755acfb626c7808917b.jpg"><br><br>  The image is displayed on a small LCD-monitor for the car through the RCA-connector. <br><br>  I also added a regular Raspberry Pi camera with a cut-down infrared filter (NoIR) to my device so that it could see in the dark. <br><br>  Thermal imaging equipment works in the infrared range, so it needs special optics.  For example, for our device it is desirable to buy a protective glass, but the usual will not work, because it is opaque to IR rays.  You need to buy special optics based on zinc selenide (ZnSe), germanium (Ge) or gallium arsenide (GaAs).  In addition, sell and focusing lenses. <br><br><img src="https://habrastorage.org/files/e5d/f47/648/e5df4764861541c9991801f27a3b99a8.png"><br><br><h1>  Enclosure and battery supply </h1><br>  All those who had to make portable devices, tormented by the question of manufacturing the case.  I had the alpha version in a cardboard box.  Very convenient: you can cut holes wherever you want.  Inside was a very big battery.  If you drop such a device on your leg, it will be very painful. <br><br><img src="https://habrastorage.org/files/e11/29a/1b3/e1129a1b347b4a0c939058243495b87d.png"><img src="https://habrastorage.org/files/efc/771/6c6/efc7716c6bad4cd180641ab78cab6ec0.png"><br><br>  The final version was conceived in a portable gun-type layout.  Since there are no such cases on sale, I asked a friend to make a model of a convenient pen, and a colleague printed it on a 3D printer.  I put a battery in the handle, and for electronics a ready-made plastic rectangular case was taken. <br><br><img src="https://habrastorage.org/files/8e1/f4b/cb9/8e1f4bcb9500463bb2502d6119d21ce5.png"><img src="https://habrastorage.org/files/43d/55e/bf3/43d55ebf37bc44f6a0a2758901b8f2ed.png"><br><br>  Model <a href="https://geektimes.ru/users/darktemplar/" class="user_link">DarkTemplar</a> , <a href="https://geektimes.ru/users/sunsai/" class="user_link">sunsai</a> print <br><br>  The battery was supposed to provide long-term operation, including in the winter outside.  And I wanted it to be convenient to charge - according to this criterion, lithium-polymer batteries are best, they are sold a lot of ready-made USB charging modules.  But for those Li-Po, which I saw on sale, the working temperature range is from 0 ¬∞ C, that is, they do not withstand severe frost. <br><br>  In addition to Li-Po, there are Pb, NiMh, NiCd and LiFePO <sub>4</sub> batteries.  I did not want to take the finger batteries, since this would complicate the handle design - I would have to make a compartment with removable batteries and a cap.  From the remaining options, I chose a small lead battery of 6 V. I had to add step-down converters to 5 V to it to power the Raspberry, and step-up converters up to 12 V to power the screen. <br><br><h1>  Shooting modes </h1><br>  Typical picture modes for thermal imagers: <br><br><ul><li>  common shades of gray: the lighter, the hotter; </li><li>  red and blue palette, where red is hot, blue is cold; <br><br><img src="https://habrastorage.org/files/01a/872/815/01a8728154d14e8aa426a7dcbb3b7f2b.png"><br><br>  <sup><i>Author with a mug of hot tea and a cold can of cola</i></sup> </li><li>  color mode of <i>steel tint</i> ; </li><li>  overlaying a conventional camera with a translucent image of a thermal imager.  Thus, it turns out like augmented reality - with the temperature of objects.  There is a ready code for OpenCV. </li></ul><br>  In addition, simultaneously with the display on the screen, we can save screenshots and videos. <br><br><img src="https://habrastorage.org/files/d5a/a87/dbf/d5aa87dbf1024645a8a31d60452a3557.gif"><br><br>  <sup><i>Kettle boils on the gas stove</i></sup> <br><br><h1>  Libraries </h1><br>  The community has already written libraries for various platforms, including STM32, Raspberry Pi, Arduino.  I started writing C code, but this is quite a hard task, so now I am switching to the Python library that uses OpenCV.  Everything is much simpler there, and there are already ready examples with the same overlay.  So I recommend exactly Python. <br><br>  So, our imager can shoot and save images to disk.  To download them, I installed hostapd, isc-dhcp-server and PureFTPd, turning this device into a Wi-Fi access point so that you can connect to it and download pictures. <br><br><h1>  Temperature measurement </h1><br>  In the screenshots from my imager there is no temperature scale.  Why?  The fact is that in the first version of Lepton there is a difficulty with the measurement mode (so-called radiometry) - you need to calibrate the sensor relative to a known temperature, which is done regularly by measuring the temperature of the special shutter before Lepton.  But in my (first) version of the module there is no such curtain.  (By the way, if you plan to buy Lepton, now it is logical to take it immediately <a href="https://store.groupgets.com/">with a curtain</a> ). <br><br>  In addition, in our technical barrel of honey there is a physical fly in the ointment.  The law of Stefan Boltzmann states that for an absolutely black body, the emissivity is proportional to the fourth power of its temperature.  However, ordinary objects are not completely black bodies, and for them the coefficient Œµ is introduced from 0 to 1. <br><br>  Q = ŒµœÉT <sup>4</sup> , where Œµ - emissivity, emissivity or blackness degree <br><br>  In other words, different materials of the same temperature can emit at different intensities.  For example, at the same temperature, a tree will radiate more powerfully than steel - due to the greater emissivity.  And on the screen of our thermal imager, the tree will be as if ‚Äúwarmer‚Äù.  In part, this can be compensated for by indicating to the instrument the emissivity coefficient, if known.  But for each object in the frame this is problematic. <br><br><img src="https://habrastorage.org/files/ec5/71c/b9f/ec571cb9f9e64638894dc9e7a51cbea9.png"><br><br>  <sup><i>An example from Wikipedia.</i></sup>  <sup><i>The painted side (Œµ‚âà0.45) of the aluminum cube looks warmer than polished (Œµ‚âà0.05) in the thermal image</i></sup> <br><br>  The same applies to infrared thermometers (pyrometers).  When you measure something with them, you need to set a correction factor to accurately estimate the temperature. <br><br>  In addition, the exact measurement is hampered by the dependence of the radiation intensity on the angle, the reflectivity of the material, and so on.  So such a thermal imager, unfortunately, does not show the exact temperature.  There are models with temperature display, but they also require entering emissivity coefficient. <br><br><h1>  Further development </h1><br>  The project with a thermal imager is far from complete.  As always, there are plenty of ideas: <br><br><ul><li> put on potentiometers trim.  There are no analog inputs in the Raspberry Pi, so you need to add an additional ADC.  Also with it I want to control the discharge of the battery; </li><li>  add a laser pointer; </li><li>  make IR illumination for a regular camera; </li><li>  Since I am now using OpenCV, I can use something from it, for example, add tracking of the contours of objects on the screen. </li></ul><br><h1>  Links </h1><br><ul><li>  <a href="https://groups.google.com/forum/">Google group FLIR Lepton</a> </li><li>  <a href="https://github.com/groupgets/LeptonModule">github.com/groupgets/LeptonModule</a> </li><li>  <a href="https://github.com/groupgets/pylepton">github.com/groupgets/pylepton</a> </li><li>  <a href="https://www.sparkfun.com/products/13233">Dev kit</a> </li><li>  <a href="https://www.tindie.com/products/PureEngineering/shuttered-flir-lepton-thermal-camera-and-breakout/">curtain version</a> </li></ul><br>  <b>The topic is <a href="https://geektimes.ru/company/mailru/blog/278452/">based on my report from the past</a> Mail.Ru <a href="https://geektimes.ru/company/mailru/blog/278452/">DIY-√®mit</a> in Mail.Ru Group.</b>  <b>Our next meeting will take place in 10 days - <a href="https://geektimes.ru/company/mailru/blog/281352/">hurry to sign up</a> !</b> </div><p>Source: <a href="https://habr.com/ru/post/257189/">https://habr.com/ru/post/257189/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../257165/index.html">Own browser - the way of the mouse: meeting with the Rat</a></li>
<li><a href="../257167/index.html">Mono 4.0 release with import code from referencesource.microsoft.com and corefx</a></li>
<li><a href="../257171/index.html">Application Development for Apple Watch (iPhone and iPad) using Wolfram Language (Mathematica)</a></li>
<li><a href="../257173/index.html">Microsoft Azure platform updates for April-May 2015. Special // Build Edition</a></li>
<li><a href="../257177/index.html">Webair data center NY1: one of the most reliable Tier III data centers in the United States (feature overview + photo)</a></li>
<li><a href="../257191/index.html">JavaScript and CSS Compilation</a></li>
<li><a href="../257197/index.html">What to do if Google authenticator always gives the wrong codes</a></li>
<li><a href="../257199/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ158 (April 27 - May 3, 2015)</a></li>
<li><a href="../257203/index.html">CLRium # 2. Grand Workshop on .NET in St. Petersburg</a></li>
<li><a href="../257207/index.html">Free SSL certificates - now for 3 years from WoSign</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>