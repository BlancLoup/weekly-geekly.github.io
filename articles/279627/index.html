<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Interrupts for the smallest</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we will talk about interruptions of x86 (-64) processors. More under the cut. 
 Interrupts are like a signal to the processor that it is necessa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Interrupts for the smallest</h1><div class="post__text post__text-html js-mediator-article">  Today we will talk about interruptions of x86 (-64) processors.  More under the cut. <a name="habracut"></a><br>  Interrupts are like a signal to the processor that it is necessary to interrupt the execution (they are therefore called interrupts) of the current code and urgently do what is indicated in the handler. <br><br><h1>  IDT </h1><br>  All interrupt handler addresses are stored in the <b>IDT</b> .  This is a table that stores 256 (more or less, but most of the values ‚Äã‚Äãare simply ignored) cells (interrupt vectors) with the type and attributes of the interrupt, one simply zero value, the address of the interrupt handler and the code selector in GDT or LDT, which will use this interrupt vector.  Now a little about the type and attributes. <br>  Interrupt type and attributes occupy 8 bits.  The first 4 bits are of the type: <br><ul><li>  0b0101: 32-bit gate of the task, when such an interrupt occurs, a hardware switch of the task occurs (yes, there is such a thing, but it has not been used for a long time) </li><li>  0b0110: 16-bit interrupt gate </li><li>  0b0111: trap'a 16-bit gate (I don‚Äôt know how to translate it into Russian, sorry) </li><li>  0b1110: 32-bit interrupt gate </li><li>  0b1111: 32-bit gate trap'a </li></ul><br>  Next are the attributes.  The first attribute is 1 bit, which is set to 0 for interrupt gates and 1 to the rest.  Next comes the descriptor privilege level - 2 bits, which sets the minimum privilege level for the interrupt call, and 1 bit, set to 0 for unused interrupts. <br>  Now how the processor causes handlers. <br>  Suppose that you called the instruction <code>int 0</code> in assembler.  This will signal the processor to cause an interrupt of 0, if possible.  Here is a sequence of actions that occur during this. <br><ol><li>  Search vector number 0 in IDT. </li><li>  Comparison of the level of privileges of the descriptor and the current level of privileges of the processor. </li><li>  If the current privilege level of the processor is lower than the privilege level of the descriptor, then simply cause a general protection error and not cause an interrupt. </li><li>  The return address, register (E) FLAGS and other information are saved. </li><li>  There is a transition to the address specified in the vector ‚Ññ0 IDT. </li><li>  After executing the handler, the <code>iret</code> instruction returns control to the interrupted code. </li></ol><br><br><h1>  Exceptions </h1><br>  There are also interrupts that are generated by the processor itself under certain circumstances - <b>exceptions</b> .  Here is a list of them with brief descriptions: <br><ul><li>  Division by zero.  It is generated when, in fact, division by zero. </li><li>  Debug exception  Cannot be generated by itself, it is used for debugging itself. </li><li>  Nonmaskable interrupt  It is generated when RAM errors and unrecoverable hardware errors.  They cannot be masked with the help of the PIC (Programmable Interrupt Controller - Programmable Interrupt Controller), since it goes directly to the processor, bypassing the PIC, but you can simply turn it off. </li><li>  Breakpoint.  It is also used for debugging, because its opcode occupies only 1 byte, unlike the rest of INT N. It was reassigned by DOS debuggers for its own purposes. </li><li>  Overflow.  Generated by an <code>INTO</code> instruction if the overflow bit is enabled in (E) FLAGS. </li><li>  Going beyond.  Generated upon error of the BOUND instruction. </li><li>  Invalid opcode.  Generated when attempting to execute an invalid opcode. </li><li>  Device unavailable.  Now not used, generated when trying to use floating point operations on processors without FPU. </li><li>  Double fault.  It is difficult to translate the name.  The error is unrecoverable, occurs when it is impossible to call an exception handler. </li><li>  Coprocessor segment overflow.  No longer used. </li><li>  Invalid TSS.  The task status segment is set incorrectly. </li><li>  The segment is missing.  Occurs when trying to load a segment with the Present bit == 0. </li><li>  Error stack segment.  Occurs when trying to load a segment with the Present == 0 bit or stack overflow. </li><li>  General error of protection.  It is generated in a very large number of cases, among them there is a segment error, an attempt to execute the instruction without the necessary rights, a record where it is not necessary, an attempt to access the zero GDT descriptor, and much more. </li><li>  Page error.  Occurs when reading or writing to a non-existent page of memory, trying to access data without the necessary permissions or another. </li><li>  Floating point error.  Occurs when the FWAIT or WAIT instruction is executed with bit No. 5 in CR0 == 0. </li><li>  Error checking for alignment.  Occurs only in the third processor privilege ring, if this error is, of course, enabled. </li><li>  Error while checking the machine.  Generated by the processor when detecting "iron" errors. </li><li>  SIMD floating point exception.  Generated on errors with 128-bit floating point numbers. </li><li>  Virtualization error. </li><li>  Security error </li><li>  Triple mistake.  In fact, the exception is not, it is not even an interruption.  Occurs when you cannot call Double Fault.  Causes the computer to immediately restart. </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  IRQ </h1><br>  There is a special type of interrupt - <b>IRQ (Interrupt ReQuest)</b> , or hardware interrupts, but for brevity I'll call them just IRQ.  Technically, they are almost the same as any other interrupts, but they are not generated by the processor or the code itself, but by devices connected to the computer.  For example, IRQ # 0 generates a PIT (timer with a programmable interval), IRQ 1 is generated when you press a key on the keyboard, and IRQ 12 - when operating with a PS / 2 mouse. <br><br><h1>  Software interrupts </h1><br>  There are also so-called <b>software interrupts</b> .  They, as the name implies, the program should call itself - no one calls them for it.  These are, for example, system calls in some systems.  In Linux, for example, they hang on the vector 0x80.  In many hobby OS, they also hang on the vector 0x80.  Now, a little ad-libbing - I think that syscalls are made as interrupts because 1) they are so very easy to call, 2) they can be called from any code running in the OS ‚Äî the IDT is one for the whole system. <br>  <i>Info taken from <a href="http://wiki.osdev.org/">OSDev Wiki</a> .</i> </div><p>Source: <a href="https://habr.com/ru/post/279627/">https://habr.com/ru/post/279627/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../279617/index.html">SoftMocks: our replacement runkit for PHP 7</a></li>
<li><a href="../279619/index.html">Non-technical program PHDays, or From hackers to artists one step</a></li>
<li><a href="../279621/index.html">Erlang in wargaming</a></li>
<li><a href="../279623/index.html">Remarkable zippers, or how I learned not to worry and fell in love with tree data structures</a></li>
<li><a href="../279625/index.html">Release CLion 2016.1: new tools and new languages</a></li>
<li><a href="../279629/index.html">Security Week 11: Trojans on iOS without jailbreak, leaked on American Express, stealing uchetok Steam</a></li>
<li><a href="../279633/index.html">Search for changes in two collections</a></li>
<li><a href="../279635/index.html">Today starts the official part of <hackathon_weekend /> in Stavropol</a></li>
<li><a href="../279637/index.html">March Releases of Official Yii 2.0 Extensions</a></li>
<li><a href="../279639/index.html">What can flog whips in the digital age? How does GitHub comply with DMCA, RFC 7725 and what is HTTP 451?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>