<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The path to the contactless lie detector, or How to arrange a hackathon at maximum speed</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once Steve Jobs and Steve Wozniak closed in the garage and rolled out the first Mac. It would be great if you could always close the programmers in th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The path to the contactless lie detector, or How to arrange a hackathon at maximum speed</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/gt/v2/i7/gtv2i7pf93xfdhqpe7cgdi0th1c.png" alt="image"></p><br><p>  Once Steve Jobs and Steve Wozniak closed in the garage and rolled out the first Mac.  It would be great if you could always close the programmers in the garage and get an MVP with great potential.  However, if you add a couple of people to programmers who are ready to evaluate user experience and look for something innovative, the chances of success are growing. </p><br><p>  Our team of 5 people had a certain idea, for which we decided slightly <del>  take over the world </del>  pokakatonit. </p><a name="habracut"></a><br><h3 id="opisanie-mvp">  MVP Description </h3><br><p>  Application for HR-managers, allowing to determine the applicant's psycho-type and behavior patterns. </p><br><p>  Required components: </p><br><ol><li>  Database of questions, types of reactions and the system of bringing these things to the psycho type </li><li>  The definition of human emotions, based on the manifestations of AU - certain movements of the facial muscles. </li><li>  Non-contact pulse detection </li><li>  Determining the direction of sight </li><li>  Determination of blink rate </li><li>  A system for aggregating the above-described retrieved data into a stress graph and other useful metadata. </li></ol><br><p>  MVP for us is an island of security between the very idea and the big Anne project, to which we are heading. </p><br><h3 id="kak-vsyo-bylo">  How was it </h3><br><p>  So that during development there would be no distractions, it was decided to rent an apartment in the nearest resort town with catering.  Arriving there on Sunday and arranging our jobs, we immediately sat down for discussion.  On the very first night, the bricks were identified, which should definitely be in the final MVP.  And while the guys were polishing the idea, they went to the city for consultations with HR managers, the developers (myself included) were already preparing the groundwork. </p><br><h3 id="tehnicheskaya-chast">  Technical part </h3><br><p>  It was decided to make the definition of emotions strictly through <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D1%2581%25D1%2582%25D0%25B5%25D0%25BC%25D0%25B0_%25D0%25BA%25D0%25BE%25D0%25B4%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25BB%25D0%25B8%25D1%2586%25D0%25B5%25D0%25B2%25D1%258B%25D1%2585_%25D0%25B4%25D0%25B2%25D0%25B8%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B9">FACS</a> , since this method has sufficient scientific validity compared to, for example, <a href="https://arxiv.org/pdf/1805.00326.pdf">such a</a> rough approach.  Accordingly, the task was broken into </p><br><ol><li>  Network training predicting 68 face marks </li><li>  Normalization / filtering of the face image </li><li>  Algorithm that detects facial movements in dynamics </li></ol><br><p>  The training, by the way, was done on the Radeon RX580 with the help of PlaidML, which I already mentioned in my previous <a href="https://habr.com/post/420989/">article</a> .  Thank you very much here you need to tell the <a href="https://imgaug.readthedocs.io/en/latest/">imgaug</a> library, which allows you to apply affine transformations simultaneously to images and points on it (in our case, to landmarks). </p><br><p>  Some Augmented Images: </p><br><p><img src="https://habrastorage.org/webt/qw/nu/q5/qwnuq55q4db-er1g8lsz4latjsw.png" alt="image"></p><br><p>  To determine the direction of the gaze, an algorithm was initially used on classical computer vision, searching for a pupil in the eye area on the HOGs.  But soon the understanding came that often the pupil is not visible and the direction of gaze can be described not only by him, but also by the location of the eyelids.  Due to these difficulties, the solution was transferred to the neural network approach.  We cut and dated Dataset ourselves, driving through the first algorithm, and then manually corrected the places of his mistakes. </p><br><p>  The first developments began in the summer and existed in a dirty Python script: </p><br><p><img src="https://habrastorage.org/webt/o_/wh/gh/o_whghmiqjbpjfrtrzckeoeprsy.png" alt="image"></p><br><p>  The determination of the blinking frequency resulted from the aggregation of the parts of the two algorithms described above - bringing the Landmarks of the eyelids closer and looking downward. </p><br><p>  The determination of the pulse from the video stream was based on the idea of ‚Äã‚Äãthe <a href="https://arxiv.org/pdf/1710.08369.pdf">absorption of the green component of light by blood particles</a> and was complemented by algorithms for tracking and extracting areas of interest (skin). </p><br><p>  Eerie mask goes, of course: </p><br><p><img src="https://habrastorage.org/webt/so/cq/hr/socqhrjmlucq85oztxdrblj4onc.png" alt="image"></p><br><p>  In fact, the creation of the above-described bricks has been reduced to the implementation of the State Of The Art algorithms with modifications that improve the accuracy in our particular case.  Fortunately, there is <a href="https://arxiv.org/">arxiv.org</a> . </p><br><p>  Difficulties have appeared in creating the logic of normalizing the face image and the algorithms for evaluating the obtained data.  For example, when recognizing faces, the <a href="https://habr.com/post/155759/">Active Appearance Model</a> is actively used ‚Äî the face, based on the points found, is stretched onto the overall texture of the face.  But it is important to us the mutual location of points!  As an option - to filter too turned faces, or to stretch on the texture only by ‚Äúanchors‚Äù, key points that do not reflect the movement of muscles (for example, a point on the nose bridge and the edge of the face).  This problem is now one of the main and does not allow to obtain reliable data if the face is too rotated (we can count the angle of rotation too!).  The permissible framework for today is + -20 ¬∞ along both axes.  Otherwise, the face is simply not processed. </p><br><p>  Of course, there are other problems: </p><br><ul><li>  Determination of landmarks if a person is wearing glasses </li><li>  Baseline extraction if the person is grimacing </li><li>  Pulse detection in highly flickering light </li></ul><br><p>  Oh yes, and what is the <a href="https://arxiv.org/pdf/1612.05038.pdf">"baseline"</a> ?  The fundamental concept in the processing of emotions by FACS methods.  The baseline extraction algorithm is probably one of the most important know-how for our hackathon. </p><br><p>  In addition to algorithms, there is another important point that we could not forget about - performance.  And the performance ceiling is not even a PC, but a regular laptop.  As a result, all the algorithms are as easy as possible, and the networks undergo iterative reduction in size while maintaining acceptable accuracy. </p><br><p>  The result is 30-40% on the Intel i5 at 15-20 fps.  It is clear that there is a certain margin that will disappear as additional modules are added. </p><br><p>  Plans to determine: </p><br><ul><li>  Sore throat </li><li>  Face color change </li><li>  Respiratory rate </li><li>  Intensity of body movements </li><li>  Human postures patterns </li><li>  Trembling voice </li></ul><br><h3 id="a-chto-my-umeem-esche">  What else can we do? </h3><br><p>  I, as a fan of computer vision and ML, told you a little about the algorithms used in our software.  But due to its incompleteness, for this application, the above possibilities are rather a pleasant addition.  The most important part is the developed system for determining the human psychotype.  What is the point?  Unfortunately, my colleagues (friends!) Were engaged in this and I would not be able to explain what was coming from.  But for a minimal understanding, you can consider how to work with the received software: </p><br><p>  HR sets the qualities that are especially needed for the job being considered: </p><br><p><img src="https://habrastorage.org/webt/h4/pb/9c/h4pb9cl8mb5vwjnccpeb9tixpke.png" alt="image"></p><br><p>  HR conducts an interview, asking some of the questions of the prepared database (during the interview HR has additional information about the emotions and level of stress) </p><br><p>  During or after the interview, HR fills in answers to questions and behavioral patterns: </p><br><p><img src="https://habrastorage.org/webt/vj/of/md/vjofmdb1wkm3k2ys15xjslcxiue.png" alt="image"></p><br><p>  Through the developed matrixes, the software builds an infographic displaying the coincidence of the specified and defined qualities: </p><br><p><img src="https://habrastorage.org/webt/uf/g1/_v/ufg1_vfhhus_uvbvs0wwnnjaqcg.png" alt="image"></p><br><p>  After the interview there is a record that allows you to return to the interview at any time and evaluate one or another moment. </p><br><h3 id="itogo">  Total </h3><br><p><img src="https://habrastorage.org/webt/nl/a5/_o/nla5_opcrpx6buwxchbnsvhqyzi.jpeg" alt="image"></p><br><p>  14 days x 12 hours + 3 developers + 2 specialists in the field of lie determination = ready MVP.  The immersion was maximum - up to the fact that at lunchtime we watched the TV series <a href="https://www.kinopoisk.ru/film/obmani-menya-2009-428930">Fool Me</a> - <a href="https://www.kinopoisk.ru/film/obmani-menya-2009-428930">I</a> strongly advise. </p><br><p>  Not to be unfounded, I attach <a href="https://www.youtube.com/watch%3Fv%3D9ye3RblDADE">an example</a> of how the application works now: </p><br><p>  As well as a <a href="https://www.youtube.com/watch%3Fv%3D5RoD8LLa3Co">promotional video of a</a> big solution "Anne", to which we step. </p><br><p><img src="https://habrastorage.org/webt/u3/t3/5g/u3t35g9kbvpzm8dopar2a_r0fye.jpeg" alt="image"></p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/432030/">https://habr.com/ru/post/432030/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../432014/index.html">Kali Linux for beginners</a></li>
<li><a href="../432016/index.html">How music and drawing taught me how to program</a></li>
<li><a href="../432020/index.html">Chain replication: building efficient KV storage (part 2/2)</a></li>
<li><a href="../432022/index.html">Fork it: 8 projects on Go, in the source code of which it is interesting to dig</a></li>
<li><a href="../432024/index.html">Gradle 5.0 - what's new</a></li>
<li><a href="../432032/index.html">We finish the nailed Google search box</a></li>
<li><a href="../432034/index.html">The book "Electricity step by step" by Rudolph Svoren</a></li>
<li><a href="../432036/index.html">Live: Frontend Infrastructure</a></li>
<li><a href="../432038/index.html">On-click fame, or how to excite the robot and ... the rest</a></li>
<li><a href="../432040/index.html">Validators + Aspects: customize validation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>