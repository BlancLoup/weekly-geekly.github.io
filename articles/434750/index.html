<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to take control of network infrastructure. Part two. Cleaning and documentation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Our goal at this stage is to establish order in the documentation and configuration. 
 At the output of this process, you must have the necessary set ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to take control of network infrastructure. Part two. Cleaning and documentation</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/7f5/0f3/579/7f50f35797d243e0a8563ba76f850724.jpg" alt="image"><br><br>  Our goal at this stage is to establish order in the documentation and configuration. <br>  At the output of this process, you must have the necessary set of documents and a network configured in accordance with them. <br><br>  Now we will not talk about security audit - the third part will be devoted to this. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The complexity of the task at this stage, of course, varies greatly from company to company. <br><br>  The ideal situation is when <br><br><ul><li>  Your network was created in accordance with the project and you have a complete set of documents. </li><li>  A <a href="https://habr.com/post/433614/">change management and change management process has</a> been implemented for your network. </li><li>  In accordance with this process, you have documents (including all the necessary schemes) providing complete information on the current state of affairs </li></ul><br>  In this case, your task is quite simple.  You must review the documents and review all the changes that have been made. <br><br>  In the worst case, you will have <br><br><ul><li>  a network created without a project, without a plan, without coordination, by engineers who do not have sufficient qualifications, </li><li>  with chaotic, undocumented changes, with a lot of "garbage" and non-optimal solutions </li></ul><br>  It is clear that your situation is somewhere in between, but, unfortunately, on this scale is better - worse, with a high probability, you will be closer to a worse end. <a name="habracut"></a><br><br>  In this case, you will be required to include the ability to read minds, because you will have to learn to understand what the ‚Äúdesigners‚Äù wanted to do, restore their logic, finish what was not finished and remove the ‚Äúgarbage‚Äù. <br>  And, of course, you will need to stop their mistakes, change (at this stage as little as possible) the design and change or re-create the scheme. <br><br>  This article in no way claims to be complete.  Here I will describe only the general principles and focus on some common problems that have to be addressed. <br><br><h2>  Set of documents </h2><br><blockquote>  Let's start with an example. <br><br>  Below are some of the documents that are usually created at Cisco Systems when designing. <br><br>  <b>CR</b> - ustomer Requirements, customer requirements (those. Task). <br>  It is created together with the customer and determines the network requirements. <br><br>  <b>HLD</b> - High Level Design, high-level design based on network requirements (CR).  The document explains and justifies the adopted architectural decisions (topology, protocols, equipment selection, ...).  HLD does not contain design details, for example, about the interfaces used and IP addresses.  Also, the specific hardware configuration is not discussed here.  This document is rather intended to explain the key design concepts to the technical management of the customer. <br><br>  <b>LLD</b> - Low Level Design, low level design based on high level (HLD). <br>  It should contain all the details necessary for the implementation of the project, such as information on how to connect and configure the equipment.  This is a complete guide to the implementation of the design.  This document should provide sufficient information for its implementation even by not very qualified personnel. <br><br>  Something, for example, IP addresses, AS numbers, the physical switching circuit (cabling), can be ‚Äúrendered‚Äù into separate documents, such as the <b>NIP</b> (Network Implementation Plan). <br><br>  The construction of the network begins after the creation of these documents and takes place in strict accordance with them and then is checked by the customer (tests) for compliance with the design. </blockquote><br>  Of course, different integrators, different customers, and different countries may have different requirements for project documentation.  But I would like to avoid formalities and consider the issue on the merits.  This stage is not about design, but about putting things in order, and we need a set of documents sufficient for our tasks (charts, tables, descriptions ...). <br><br>  And in my opinion, there is a certain absolute minimum, without which it is impossible to effectively control the network. <br><br>  These are the following documents: <br><br><ul><li>  physical switching circuit (log) (cabling) </li><li>  network diagram or diagrams with essential L2 / L3 information </li></ul><br><h2>  Physical switching circuit </h2><br>  In some small companies, work related to equipment installation and physical switching (cabling) is under the responsibility of network engineers. <br><br>  In this case, the problem is partially solved by the following approach. <br><br><ul><li>  use a description on the interface to describe what is connected to it. </li><li>  administratively shut down (shutdown) all unconnected network equipment ports </li></ul><br>  This will give you the opportunity, even in the event of a link problem (when cdp or lldp is not working on this interface), to quickly determine what is connected to this port. <br>  Also, you can easily see which ports you have are occupied and which ones are free, which is necessary for planning connections of new network equipment, servers or workstations. <br><br>  But it is clear that if you lose access to the equipment, you will lose access to this information.  Moreover, in this way you cannot record such important information as what the equipment is, with what power consumption, with how many ports, in which rack it is, what kind of patch panel is there and where (in which rack / patch panel) are they connected .  Therefore, additional documentation (not only on hardware descriptions) is very useful. <br><br>  The ideal option is to use applications created to work with this kind of information.  But you can restrict yourself to simple tables (for example, in Excel) or display information that you consider necessary in L1 / L2 diagrams. <br><blockquote>  Important! <br><br>  The network engineer, of course, can know quite well the subtleties and standards of SCS, types of racks, types of uninterruptible power supplies, what a cold and hot corridor is, make proper grounding ... just like in principle he can know particle physics or C ++.  But it is necessary to understand nevertheless that all this is not his field of knowledge. <br><br>  Therefore, it is a good practice to solve problems associated with the installation, connection, maintenance of equipment, as well as physical switching to have either dedicated departments or dedicated people.  Usually for data centers this is a data center engineers, and for an office it is a help-desk. <br><br>  If such units are provided for in your company, then the issues of physical switching logging are not your task, and you can restrict yourself to a description on the interface and administrative shutdown of unused ports. </blockquote><h2>  Network diagrams </h2><br>  There is no universal approach to drawing schemes. <br><br>  The most important thing is that the schemes should give an understanding of how traffic will go, through which logical and physical elements of your network. <br><br>  By physical elements we mean <br><br><ul><li>  active equipment </li><li>  interfaces / ports of active equipment </li></ul><br>  Under logical - <br><br><ul><li>  logical devices (N7K VDC, Palo Alto VSYS, ...) </li><li>  VRF </li><li>  wilan </li><li>  subinterfaces </li><li>  the tunnels </li><li>  zones </li><li>  ... </li></ul><br>  Also, if your network is not completely elementary, it will consist of different segments. <br>  for example <br><br><ul><li>  data center </li><li>  the Internet </li><li>  Wan </li><li>  remote access </li><li>  office LAN </li><li>  DMZ </li><li>  ... </li></ul><br>  It would be reasonable to have several schemes that give both a general picture (as traffic flows between all these segments) and a detailed explanation of each individual segment. <br><br>  Since in modern networks there can be many logical levels, it is possible that a good (but not obligatory) approach is to do different schemes for different levels, for example, in the case of an overlay approach, the following schemes could: <br><br><ul><li>  overlay </li><li>  L1 / L2 underlay </li><li>  L3 underlay </li></ul><br>  Of course, the most important scheme without which it is impossible to understand the idea of ‚Äã‚Äãyour design is the routing scheme. <br><br><h4>  Routing scheme </h4><br>  At least this diagram should be reflected <br><br><ul><li>  what routing protocols and where are used </li><li>  basic information about routing protocol settings (area / AS number / router-id / ...) </li><li>  What devices are redistributed </li><li>  where route filtering and aggregation occurs </li><li>  default route information </li></ul><br>  Also, the L2 scheme (OSI) is often useful. <br><br><h4>  L2 scheme (OSI) </h4><br>  This diagram may reflect the following information: <br><br><ul><li>  what vlan </li><li> which ports are trunk ports </li><li>  which ports are aggregated in the ether-channel (port channel), virtual port channel </li><li>  what STP protocols and what devices are used </li><li>  basic STP settings: root / root backup, STP cost, port priority </li><li>  additional STP settings: BPDU guard / filter, root guard ... </li></ul><br><h2>  Typical design errors </h2><br><blockquote>  An example of a bad approach to building a network. <br><br>  Let's take a simple example of building a simple office LAN. <br><br>  Having experience in teaching telecoms to students, I can say that by the middle of the second semester virtually every student has the necessary knowledge (as part of the course that I taught) in order to set up a simple office LAN. <br><br>  What is difficult to connect switches to each other, configure VLANs, SVI interfaces (in the case of L3 switches) and register static routing? <br><br>  Everything will work. <br><br>  But at the same time, issues related to <br><br><ul><li>  security </li><li>  by reservation </li><li>  network scaling </li><li>  performance </li><li>  bandwidth </li><li>  reliability </li><li>  ... </li></ul><br>  At times, I hear a statement that an office LAN is something very simple and I usually hear it from engineers (and managers) who do everything but not networks, and they say it so confidently that they don‚Äôt be surprised if LAN will be made by people with insufficient practice and knowledge and will be made approximately with the mistakes that I will describe below. </blockquote><br><h4>  Typical design level L1 errors (OSI) </h4><br><ul><li>  If, nevertheless, you are responsible, including for SCS, then one of the most unpleasant legacies that you can get is a careless and not thoughtful commutation. </li></ul><br>  I would also refer to type L1 errors related to the resources of the equipment used, for example, <br><br><ul><li>  insufficient bandwidth </li><li>  insufficient TCAM on equipment (or inefficient use of it) </li><li>  poor performance (often related to firewalls) </li></ul><br><h4>  Typical L2 design level errors (OSI) </h4><br>  Often, when there is no good understanding of how STP works, what potential problems it carries with it, the switches are connected randomly, with default settings, without additional tuning of STP. <br><br>  As a result, we often have the following <br><br><ul><li>  large network diameter STP, which can lead to broadband storms </li><li>  STP root will be determined randomly (based on mac addresses) and the traffic path will not be optimal. </li><li>  ports connected to hosts will not be configured as edge (portfast), which will result in STP recalculation when end stations are turned on / off </li><li>  the network will not be segmented at the L1 / L2 level, resulting in problems with any switch (for example, power overload) will result in STP recalculation of the topology and stopping traffic in all VLANs on all switches (including in the case of service segment) </li></ul><br><h4>  Examples of errors in L3 (OSI) design </h4><br>  A few characteristic mistakes novice networkers: <br><br><ul><li>  frequent use (or use only) of static routing </li><li>  use of routing protocols that are not optimal for this design </li><li>  nonoptimal logical network segmentation </li><li>  non-optimal use of the address space, which does not allow aggregation of routes </li><li>  no backup routes </li><li>  no reservation for default gateway </li><li>  asymmetric routing when rebuilding routes (may be critical in the case of NAT / PAT, statefull firewalls) </li><li>  MTU problems </li><li>  when rebuilding routes, traffic goes through other security zones or even other firewalls, which causes this traffic to drop </li><li>  poor topology scalability </li></ul><br><h2>  Criteria for assessing the quality of design </h2><br>  When we talk about optimality / non-optimality, we need to understand in terms of what criteria we can evaluate it.  Here, from my point of view, the most significant (but not all) criteria (and decoding applied to routing protocols): <br><br><ul><li>  scalability <br>  For example, you decide to add another data center.  How easy you can do it. </li><li>  managability <br>  How easy and safe are operational changes, such as announcing a new grid or filtering routes </li><li>  availability <br>  What percentage of the time does your system provide the required level of service? </li><li>  security <br>  How secure is the transmitted data? </li><li>  price </li></ul><br><h2>  Changes </h2><br>  The basic principle at this stage can be expressed by the formula "do no harm." <br>  Therefore, even if you do not fully agree with the design and the chosen implementation (configuration), it is not always advisable to make changes.  A reasonable approach is to rank all the identified problems by two parameters: <br><br><ul><li>  how easy this problem can be fixed </li><li>  how much risk does she bear </li></ul><br>  First of all, it is necessary to eliminate the fact that in real time it reduces the level of the provided service below permissible, for example, problems leading to packet loss.  Then eliminate what is easiest and safer to eliminate in order of decreasing severity of risk (from design or configuration problems that carry greater risks towards smaller ones). <br><br>  Perfectionism at this stage can be harmful.  Bring the design to a satisfactory state and synchronize the network configuration in accordance with it. </div><p>Source: <a href="https://habr.com/ru/post/434750/">https://habr.com/ru/post/434750/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../434740/index.html">The neural network was taught to detect solar panels on satellite images and predict their level of distribution.</a></li>
<li><a href="../434742/index.html">Part 2: Using Cypress UDB PSoC Controllers to Reduce the Number of Interrupts in a 3D Printer</a></li>
<li><a href="../434744/index.html">Samsung SSD 860 QVO 1 TB and 4 TB: the first consumer SATA QLC (part 2)</a></li>
<li><a href="../434746/index.html">BLE under the microscope 4</a></li>
<li><a href="../434748/index.html">Mail.ru plans to buy music licensing partner for $ 100 million</a></li>
<li><a href="../434752/index.html">Robomoroz: the future of the main character of the New Year</a></li>
<li><a href="../434756/index.html">The future of Kubernetes is behind virtual machines</a></li>
<li><a href="../434758/index.html">Facebook Moderator's Guide: Over 1,400 pages of controversial slides</a></li>
<li><a href="../434760/index.html">Digest news from the world of PostgreSQL. New Year's Eve (shortened) issue ‚Ññ13</a></li>
<li><a href="../434762/index.html">Notes phytochemist. Green Banana, or Do not forget to feed the microbiota</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>