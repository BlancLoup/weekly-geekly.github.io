<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Reactive Extensions: client for conditional api with Cache-Aside & Refresh-Ahead strategy</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 In this article I want to consider the development of the client library to the conditional api service. As such a service, I will use ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Reactive Extensions: client for conditional api with Cache-Aside & Refresh-Ahead strategy</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/10d/179/999/10d1799991fc4facbc4dbb4ab9fff156.png" alt="rx-logo"><br><h4>  Introduction </h4><br>  In this article I want to consider the development of the client library to the conditional api service.  As such a service, I will use Habrahabr‚Äôs imaginary Rest-api. <br><br>  To make such a routine task a bit more interesting, we will complicate the requirements by adding caching and tweak it all with the <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">Reactive Extensions</a> library. <br><br>  I invite everyone who is interested. <br><a name="habracut"></a><br>  Imagine that we have a <a href="http://nonexisting-api.habrahabr.ru/v1/karma/user_name">nonexisting-api.habrahabr.ru/v1/karma/user_name</a> url, which returns the following json: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"userName"</span></span> : <span class="hljs-string"><span class="hljs-string">"requested user name"</span></span>, <span class="hljs-string"><span class="hljs-string">"karma"</span></span> : <span class="hljs-number"><span class="hljs-number">123</span></span>, <span class="hljs-string"><span class="hljs-string">"lastModified"</span></span> : <span class="hljs-string"><span class="hljs-string">"2014-09-01"</span></span> }</code> </pre> <br><br>  Appealing to such a service, deserializing the response and displaying the results to the user are all quite trivial.  Perhaps a naive implementation could look like this: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">NonReactiveHabraClient</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IHttpClient HttpClient { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NonReactiveHabraClient</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IHttpClient httpClient</span></span></span><span class="hljs-function">)</span></span> { HttpClient = httpClient; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;KarmaModel&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetKarmaForUser</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> userName</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> karmaResponse = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> HttpClient.Get(userName); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!karmaResponse.IsSuccessful) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> karmaResponse.Exception; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> karmaResponse.Data; } }</code> </pre><br><br><h4>  Add caching </h4><br><br>  Working with a mobile application is very different from working with a desktop or web application.  The mobile application is used "on the run", with one hand, often in conditions of poor communication.  Of course, the user expects the fastest possible display of information of interest.  Obviously, there is a need to cache data. <br><br>  The key feature of our application is rarely updated data, low criticality of freshness and relevance of data.  That is, we can afford to show information from the previous launch.  Many weather applications, twitter clients and others have this property. <br><br>  In applications like ours, the following logic is quite common: <br><ol><li>  the application should start quickly; </li><li>  show cached data; </li><li>  try to get fresh data from the back end; </li><li>  if successful, save the data to the cache; </li><li>  display new data to the user or report an error. </li></ol><br><br>  Or the same, but in the form of a diagram (I hope I didn‚Äôt completely forget how to draw sequence diagrams). <br><br><img src="https://habrastorage.org/files/077/5e8/891/0775e8891ab04cfba94ace68e06caaf6.PNG" alt="image"><br><br>  There are several basic strategies for working with the application's local cache.  I will not consider them all, in this article we are interested in the approach (or pattern) of Cache-Aside. <br><br>  The basic idea of ‚Äã‚Äãthe pattern is that the cache is only a passive data repository.  Thus, the task of updating data falls on the shoulders of the code that uses the cache.  For such a cache, you can define a fairly simple interface. <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">ICache</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HasCached</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> userName</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-function">KarmaModel </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCachedItem</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> userName</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Put</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">KarmaModel updatedKarma</span></span></span><span class="hljs-function">)</span></span>; }</code> </pre><br><br>  The cache that implements this interface sufficiently meets the requirements of 2 and 4 from the previous list.  Items 2, 3 and 4 together are some version of the approach called <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">Refresh-Ahead Caching</a> . <br><br>  I want to note that the above approach is not a classic implementation of both patterns, but only a combination of basic ideas.  However, templates exist for this. <br><br>  I hope that the standard iterative implementation of this approach will not cause difficulties for the reader, so I will go straight to the variant using Reactive Extensions.  In addition, I hope that the reader is already familiar with Rx, at least at the level of general presentation.  If you are not familiar with Rx or want to refresh your memory, then I advise you to familiarize yourself with the article from <a href="https://habrahabr.ru/users/sergeyt/" class="user_link">SergeyT</a> <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">‚ÄúReactive extensions‚Äù and asynchronous operations</a> . <br><br><h4>  Implementation </h4><br><br>  And so, for a start we will create the project in the Visual Studio, we will specify project type as Class Library.  We will need a Rx-Main NuGet package: <br><br><pre> <code class="bash hljs">Install-Package Rx-Main</code> </pre><br><br>  Define an abstraction over an http client: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">IHttpClient</span></span> { <span class="hljs-function"><span class="hljs-function">Task&lt;KarmaResponse&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Get</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> userName</span></span></span><span class="hljs-function">)</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">KarmaResponse</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsSuccessful { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> KarmaModel Data { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Exception Exception { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">KarmaModel</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> UserName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Karma { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DateTime LastModified { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre><br><br>  The specific implementation of the execution of http requests, parsing and deserialization of the response, error handling is not important to us. <br><br>  Define the interface of our api-client: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">IHabraClient</span></span> { <span class="hljs-function"><span class="hljs-function">IObservable&lt;KarmaModel&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetKarmaForUser</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> userName</span></span></span><span class="hljs-function">)</span></span>; }</code> </pre><br><br>  The key point here: we return <a href="http://msdn.microsoft.com/en-us/library/dd990377(v%3Dvs.110).aspx">IObservable &lt;T&gt;</a> , that is, the ‚Äústream‚Äù of events to which you can subscribe. <br><br>  Finally, let's define the implementation of our HabraClient: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ReactiveHabraClient</span></span> : <span class="hljs-title"><span class="hljs-title">IHabraClient</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ICache Cache { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IHttpClient HttpClient { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IScheduler Scheduler { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReactiveHabraClient</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ICache cache, IHttpClient httpClient, IScheduler scheduler</span></span></span><span class="hljs-function">)</span></span> { Cache = cache; HttpClient = httpClient; Scheduler = scheduler; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IObservable&lt;KarmaModel&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetKarmaForUser</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> userName</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Observable.Create&lt;KarmaModel&gt;(observer =&gt; Scheduler.Schedule(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { KarmaModel karma = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Cache.HasCached(userName)) { karma = Cache.GetCachedItem(userName); observer.OnNext(karma); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> karmaResponse = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> HttpClient.Get(userName); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!karmaResponse.IsSuccessful) { observer.OnError(karmaResponse.Exception); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> updatedKarma = karmaResponse.Data; Cache.Put(updatedKarma); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (karma == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || updatedKarma.LastModified &gt; karma.LastModified) { observer.OnNext(updatedKarma); } observer.OnCompleted(); })); } }</code> </pre><br><br>  The code is fairly straightforward: we create and return a new <code>Observable</code> object, which immediately returns the cached data (if any) and then quietly asynchronously requests the updated values.  If the data is updated (the <code>LastModified</code> field has changed) we notify the subscribers again, save the data to the cache and end the sequence. <br><br>  Thus, the code of the View model using our ReactiveHabraClient will be compact and declarative: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MainViewModel</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IHabraClient HabraClient { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IHabraClient habraClient, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> userName</span></span></span><span class="hljs-function">)</span></span> { HabraClient = habraClient; Initialize(userName); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> userName</span></span></span><span class="hljs-function">)</span></span> { IsLoading = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; HabraClient.GetKarmaForUser(userName) .Subscribe(onNext: HandleData, onError: HandleException, onCompleted: () =&gt; IsLoading = <span class="hljs-literal"><span class="hljs-literal">false</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HandleException</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Exception exception</span></span></span><span class="hljs-function">)</span></span> { ErrorMessage = exception.Message; IsLoading = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HandleData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">KarmaModel data</span></span></span><span class="hljs-function">)</span></span> { Karma = data.Karma; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsLoading { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>? Karma { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> ErrorMessage { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre><br><br>  Of course, the attentive reader has already noticed that there is no implementation of <a href="http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged(v%3Dvs.110).aspx">INotifyPropertyChanged</a> and dispatching ( <code>OnNext</code> , <code>OnError</code> and <code>OnCompleted</code> are not executed in the UI stream).  Imagine that your favorite MVVM framework took over these tasks. <br><br>  Perhaps this article could have been completed, but we didn‚Äôt open up the question of testing at all.  Indeed, writing unit tests to asynchronous code is often not very convenient.  What can we say about asynchronous code using Rx? <br><br><h4>  Testing </h4><br><br>  Let's try to write a few unit tests for our ReactiveHabraClient and MainViewModel. <br><br>  To do this, we will create a new project of the Class Library type, add a link to the main project and install several NuGet packages. <br>  Namely: <a href="https://www.nuget.org/packages/Rx-Main/">Rx-Main</a> , <a href="https://www.nuget.org/packages/Rx-Testing/">Rx-Testing</a> , <a href="https://www.nuget.org/packages/nunit/">Nunit</a> and <a href="https://www.nuget.org/packages/moq/">Moq</a> . <br><br><pre> <code class="bash hljs">Install-Package Rx-Main Install-Package Rx-Testing Install-Package NUnit Install-Package Moq</code> </pre><br><br>  Create a <code>ReactiveHabraClientTest</code> class inherited from <a href="http://msdn.microsoft.com/en-us/library/microsoft.reactive.testing.reactivetest(v%3Dvs.103).aspx">ReactiveTest</a> . <br>  <code>ReactiveTest</code> is the base class that comes with the Rx-Testing package.  It defines several methods that will be useful to us when writing tests. <br><br>  I will not litter the article with large listings, and here I will cite only one test for each of the classes.  The rest of the tests will be available on GitHub.  The link to the repository is at the end of the article. <br><br>  Let's test the following scenario: With an empty cache, HabraClient should download the data, put it into the cache, call <code>OnNext</code> and <code>OnCompleted</code> . <br><br>  For this we need a mock-and on <code>IHttpClient</code> , <code>ICache</code> .  We also need the <a href="http://msdn.microsoft.com/en-us/library/microsoft.reactive.testing.testscheduler(v%3Dvs.103).aspx">TestScheduler</a> class from the Rx-Test package. <br>  <code>TestScheduler</code> implements the <a href="http://msdn.microsoft.com/en-us/library/system.reactive.concurrency.ischeduler(v%3Dvs.103).aspx">IScheduler</a> interface and can be substituted for the platform-specific implementation of the scheduler.  The class allows us to literally manage time and execute the asynchronous code step by step.  For those who wish, I highly recommend the excellent article <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">Testing Rx Queries using Virtual Time Scheduling</a> . <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">SetUp</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetUp</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> KarmaModel {Karma = <span class="hljs-number"><span class="hljs-number">10</span></span>, LastModified = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DateTime(<span class="hljs-number"><span class="hljs-number">2014</span></span>, <span class="hljs-number"><span class="hljs-number">09</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), UserName = USER_NAME}; Cache = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mock&lt;ICache&gt;(); Scheduler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TestScheduler(); HttpClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mock&lt;IHttpClient&gt;(); }</code> </pre><br><br>  And let's start writing the test itself. <br><h5>  <b>Arrange</b> </h5><br>  Adjust Mock behavior: the cache will be empty, the data will be loaded successfully. <br><pre> <code class="cs hljs"> Cache.Setup(c =&gt; c.HasCached(It.IsAny&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;())).Returns(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); HttpClient.Setup(http =&gt; http.Get(USER_NAME)).ReturnsAsync(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> KarmaResponse { Data = Model, IsSuccessful = <span class="hljs-literal"><span class="hljs-literal">true</span></span> }); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> client = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ReactiveHabraClient(Cache.Object, HttpClient.Object, Scheduler);</code> </pre><br><br>  In the test case, we expect a sequence of one OnNext call and one OnCompleted call. <br>  Create the following sequence: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> expected = Scheduler.CreateHotObservable(OnNext(<span class="hljs-number"><span class="hljs-number">2</span></span>, Model), OnCompleted&lt;KarmaModel&gt;(<span class="hljs-number"><span class="hljs-number">2</span></span>));</code> </pre><br>  This will require clarification.  The <code>OnNext(2, Model)</code> method is a method defined in <code>ReactiveTest</code> . <br>  His signature is as follows: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Recorded&lt;Notification&lt;T&gt;&gt; OnNext&lt;T&gt;(<span class="hljs-keyword"><span class="hljs-keyword">long</span></span> ticks, T <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>)</code> </pre><br><br>  In essence, it creates a record that the OnNext method was called with the Model parameter.  The magic number 2 is the time in ticks for our <code>TestScheduler</code> .  Not a very beautiful solution, but quite understandable.  In the ‚Äútick‚Äù number zero we create <code>TestScheduler</code> , in the ‚Äútick‚Äù number one we subscribe to events, and in the ‚Äútick‚Äù number two the sequence of messages should go. <br><br><h5>  <b>Act</b> </h5><br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> results = Scheduler.Start(() =&gt; client.GetKarmaForUser(USER_NAME), <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>);</code> </pre><br><br>  Here we run <code>TestScheduler</code> , which creates a zero tick, and subscribes to <code>client.GetKarmaForUser(USER_NAME)</code> in the first "tick".  The last parameter is a ‚Äútick‚Äù on which Dispose will be called, but in this case this value is not important to us. <br><br>  Finally, the last step. <br><br><h5>  <b>Assert</b> </h5><br><br><pre> <code class="cs hljs"> ReactiveAssert.AreElementsEqual(expected.Messages, results.Messages); Cache.Verify(cache =&gt; cache.Put(Model), Times.Once);</code> </pre><br><br>  We are convinced that the sequence of messages that we received coincides with the intended sequence.  And also check that the updated model is stored in the cache. <br><br>  Ideally, such a test would be worth breaking into two, but I would like to demonstrate that the techniques we are accustomed to continue to work in the rx-world. <br><br>  The test for <code>MainViewModel</code> will be slightly different. <br><br>  Create a Mock for the <code>IHabraClient</code> and declare a <code>KarmaStream</code> type <pre> <code class="hljs cs"><code class="cs"> Subject: <br> [SetUp] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetUp</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Client = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mock&lt;IHabraClient&gt;(); KarmaStream = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       <span class="hljs-string"><span class="hljs-string">""</span></span> c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">KarmaValueSetToPropertyWhenOnNextCalled</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> viewModel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> KarmaModel {Karma = <span class="hljs-number"><span class="hljs-number">10</span></span>}); Assert.AreEqual(<span class="hljs-number"><span class="hljs-number">10</span></span>, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net <span class="hljs-number"><span class="hljs-number">4.5</span></span>.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http:<span class="hljs-comment"><span class="hljs-comment">//reactivex.io/</span></span></a><span class="hljs-comment"><span class="hljs-comment"> The Reactive Extensions (Rx)... </span></span><a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx"><span class="hljs-comment"><span class="hljs-comment">EN</span></span></a><span class="hljs-comment"><span class="hljs-comment"> " "    </span></span><a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html"><span class="hljs-comment"><span class="hljs-comment">RU</span></span></a><span class="hljs-comment"><span class="hljs-comment"> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching </span></span><a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm"><span class="hljs-comment"><span class="hljs-comment">EN</span></span></a><span class="hljs-comment"><span class="hljs-comment"> Cache-Aside Pattern </span></span><a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx"><span class="hljs-comment"><span class="hljs-comment">EN</span></span></a><span class="hljs-comment"><span class="hljs-comment"> Testing Rx </span></span><a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html"><span class="hljs-comment"><span class="hljs-comment">EN</span></span></a><span class="hljs-comment"><span class="hljs-comment"> Testing Rx Queries using Virtual Time Scheduling </span></span><a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx"><span class="hljs-comment"><span class="hljs-comment">EN</span></span></a><span class="hljs-comment"><span class="hljs-comment"> Testing and Debugging Observable Sequences </span></span><a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx"><span class="hljs-comment"><span class="hljs-comment">EN</span></span></a><span class="hljs-comment"><span class="hljs-comment"> UDP  C# Reactive Extensions </span></span><a href="http://habrahabr.ru/post/238445/"><span class="hljs-comment"><span class="hljs-comment">RU</span></span></a><span class="hljs-comment"><span class="hljs-comment"> </span></span><a href="https://www.websequencediagrams.com/"><span class="hljs-comment"><span class="hljs-comment">https://www.websequencediagrams.com/</span></span></a></code> </pre> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> <pre> <code class="hljs cs"><code class="cs"> Subject: <br> [SetUp] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetUp</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Client = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mock&lt;IHabraClient&gt;(); KarmaStream = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       <span class="hljs-string"><span class="hljs-string">""</span></span> c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">KarmaValueSetToPropertyWhenOnNextCalled</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> viewModel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> KarmaModel {Karma = <span class="hljs-number"><span class="hljs-number">10</span></span>}); Assert.AreEqual(<span class="hljs-number"><span class="hljs-number">10</span></span>, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net <span class="hljs-number"><span class="hljs-number">4.5</span></span>.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http:<span class="hljs-comment"><span class="hljs-comment">//reactivex.io/</span></span></a><span class="hljs-comment"><span class="hljs-comment"> The Reactive Extensions (Rx)... </span></span><a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx"><span class="hljs-comment"><span class="hljs-comment">EN</span></span></a><span class="hljs-comment"><span class="hljs-comment"> " "    </span></span><a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html"><span class="hljs-comment"><span class="hljs-comment">RU</span></span></a><span class="hljs-comment"><span class="hljs-comment"> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching </span></span><a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm"><span class="hljs-comment"><span class="hljs-comment">EN</span></span></a><span class="hljs-comment"><span class="hljs-comment"> Cache-Aside Pattern </span></span><a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx"><span class="hljs-comment"><span class="hljs-comment">EN</span></span></a><span class="hljs-comment"><span class="hljs-comment"> Testing Rx </span></span><a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html"><span class="hljs-comment"><span class="hljs-comment">EN</span></span></a><span class="hljs-comment"><span class="hljs-comment"> Testing Rx Queries using Virtual Time Scheduling </span></span><a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx"><span class="hljs-comment"><span class="hljs-comment">EN</span></span></a><span class="hljs-comment"><span class="hljs-comment"> Testing and Debugging Observable Sequences </span></span><a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx"><span class="hljs-comment"><span class="hljs-comment">EN</span></span></a><span class="hljs-comment"><span class="hljs-comment"> UDP  C# Reactive Extensions </span></span><a href="http://habrahabr.ru/post/238445/"><span class="hljs-comment"><span class="hljs-comment">RU</span></span></a><span class="hljs-comment"><span class="hljs-comment"> </span></span><a href="https://www.websequencediagrams.com/"><span class="hljs-comment"><span class="hljs-comment">https://www.websequencediagrams.com/</span></span></a></code> </pre> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> <h4> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> </h4> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> <h4> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> </h4> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> <h4> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> </h4> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> <ul><li> <code><a href="http://reactivex.io/"><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  </a><a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> http://reactivex.io/ The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> </li> <li> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> </li> <li> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> </li> <li> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> </li> <li> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> </li> <li> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> </li> <li> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> </li> <li> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> </li> <li> <code><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  <a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> <a href="https://www.websequencediagrams.com/">https://www.websequencediagrams.com/</a></code> </li> <li> <code><a href="https://www.websequencediagrams.com/"><code class="cs"> Subject: <br> [SetUp] public void SetUp() { Client = new Mock&lt;IHabraClient&gt;(); KarmaStream = new Subject&lt;KarmaModel&gt;(); }</code> <br> <br>  </a><a href="http://msdn.microsoft.com/en-us/library/hh229173(v%3Dvs.103).aspx">Subject&lt;T&gt;</a>    <code>IObservable</code>  <code>IObserver</code> .    <code>KarmaStream</code>   <code>GetKarmaForUser</code>       <code>OnNext</code> , <code>OnCompleted</code>  <code>OnError</code> .       "" c <code>TestScheduler</code> . <br> <br>    : <br> <code class="cs">[Test] public void KarmaValueSetToPropertyWhenOnNextCalled() { Client.Setup(client =&gt; client.GetKarmaForUser(USER_NAME)).Returns(KarmaStream); var viewModel = new MainViewModel(Client.Object, USER_NAME); KarmaStream.OnNext(new KarmaModel {Karma = 10}); Assert.AreEqual(10, viewModel.Karma); }</code> <br> <br>   <br> <br> ,       <a href="https://github.com/asizikov/habra-demo">GitHub</a> . <br> <br>       Windows Phone,      .Net 4.5.      ,        WP SDK       . ,       Class Library  WP8     .  , Rx    PCL-. <br> <br>  <br> <br>               .            .      ,                 Windows Phone. <br> <br>             . <br> <br>  <br> <br>        : <br> <a href="http://reactivex.io/">http://reactivex.io/</a> The Reactive Extensions (Rx)... <a href="http://msdn.microsoft.com/en-us/data/gg577609.aspx">EN</a> " "    <a href="http://sergeyteplyakov.blogspot.nl/2010/11/blog-post.html">RU</a> Read-Through, Write-Through, Write-Behind, and Refresh-Ahead Caching <a href="http://docs.oracle.com/cd/E15357_01/coh.360/e15723/cache_rtwtwbra.htm">EN</a> Cache-Aside Pattern <a href="http://msdn.microsoft.com/en-us/library/dn589799.aspx">EN</a> Testing Rx <a href="http://www.introtorx.com/content/v1.0.10621.0/16_TestingRx.html">EN</a> Testing Rx Queries using Virtual Time Scheduling <a href="http://blogs.msdn.com/b/rxteam/archive/2012/06/14/testing-rx-queries-using-virtual-time-scheduling.aspx">EN</a> Testing and Debugging Observable Sequences <a href="http://msdn.microsoft.com/en-us/library/hh242967(v%3Dvs.103).aspx">EN</a> UDP  C# Reactive Extensions <a href="http://habrahabr.ru/post/238445/">RU</a> https://www.websequencediagrams.com/</code> </li> </ul></div><p>Source: <a href="https://habr.com/ru/post/237559/">https://habr.com/ru/post/237559/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../237543/index.html">Three-channel UART ADC on ATtiny13</a></li>
<li><a href="../237545/index.html">Swiss physicists turned Nokia N9 into a quantum random number generator</a></li>
<li><a href="../237549/index.html">Elon Musk: before the advent of robots cars on the roads another 5-6 years</a></li>
<li><a href="../237551/index.html">Ice Bucket Challenge as the atonement of sins</a></li>
<li><a href="../237553/index.html">We manage the outlet by SMS</a></li>
<li><a href="../237561/index.html">Startup Guide, Part 2: When a Venture Investor Says No</a></li>
<li><a href="../237563/index.html">Supermassive black hole in the center of a small galaxy</a></li>
<li><a href="../237565/index.html">A gift from VmWare or how to block your server on hosting</a></li>
<li><a href="../237569/index.html">Cross-browser beautiful input type = "number"</a></li>
<li><a href="../237571/index.html">Choosing a name for a new Russian operating system</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>