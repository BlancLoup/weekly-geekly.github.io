<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sausage.js - a library for turning any code into a call chain</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I think everyone who at least once came across a Canvas met one not extremely convenient thing on their way. When working with Canvas to change any pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sausage.js - a library for turning any code into a call chain</h1><div class="post__text post__text-html js-mediator-article">  I think everyone who at least once came across a Canvas met one not extremely convenient thing on their way.  When working with Canvas to change any parameter of the context or method call, you have to refer first to the context, and then to the method / property - this is very annoying. <br><br>  You always want this code: <br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ctx = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'canvas'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>].getContext(<span class="hljs-string"><span class="hljs-string">'2d'</span></span>); ctx.fillStyle = <span class="hljs-string"><span class="hljs-string">'#eee'</span></span>; ctx.strokeStyle = <span class="hljs-string"><span class="hljs-string">'blue'</span></span>; ctx.beginPath(); ctx.moveTo(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) ctx.lineTo(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) ctx.lineTo(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) ctx.lineTo(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) ctx.lineTo(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) ctx.closePath() ctx.stroke() ctx.fill();</code> </pre> <br>  Turn into a chain: <br><pre> <code class="javascript hljs">ctx .fillStyle(<span class="hljs-string"><span class="hljs-string">'#eee'</span></span>) .strokeStyle(<span class="hljs-string"><span class="hljs-string">'blue'</span></span>) .beginPath() .moveTo(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) .lineTo(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) .lineTo(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) .lineTo(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) .lineTo(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) .closePath() .stroke() .fill();</code> </pre><br>  Sausage.js - 1268 bytes (soon there will be less kilobytes) solving your problems. <br>  ‚ÄúLuke, use __noSuchMethod__‚Äù - and you‚Äôll say everything.  But what about support for prehistoric browsers? <br>  Anyone who is not indifferent to the Canvas, call chains and Lisp ask under the cat <br><a name="habracut"></a><br><br><h4>  Why Sausage and what has lisp? </h4><br>  This code (cross-browser, does the same thing as the first block) can be used by applying Sausage.js. <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//     (function(getContext, querySelectorAll, fillStyle, strokeStyle, beginPath, moveTo, lineTo, closePath, stroke, fill){ var canvasContext = $$(document)(querySelectorAll, 'canvas')(0)(getContext, '2d')(); $$(canvasContext, {fixedContext: true}) (fillStyle, '#eee') (strokeStyle, 'blue') (beginPath) (moveTo, 10, 10) (lineTo, 100, 10) (lineTo, 100, 100) (lineTo, 10, 100) (lineTo, 10, 10) (closePath) (stroke) (fill) (); }('getContext', 'querySelectorAll', 'fillStyle', 'strokeStyle', 'beginPath', 'moveTo', 'lineTo', 'closePath', 'stroke', 'fill'));</span></span></code> </pre><br>  Such chains are like sausages - that's why he called Sausage.js, the participation of a lisp here is of course none, just fans will appreciate the large number of parentheses :) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Why not emulate __noSuchMethod__? </h4><br>  With each change of context, I would have to run around all the methods and properties of the context and create a function for each - a long time and expensive, so I refused (I will do it later), but led to a similar view using function chains. <br><br>  Initially, I didn‚Äôt plan to add __noSuchMethod__ at all, but then I decided that it would be right.  And the name of the library Sausage now partially lost its meaning. <br><br>  Browsers that support __noSuchMethod__ can work with Sausage in any convenient form: <br><pre> <code class="javascript hljs">$$(canvasContext, {<span class="hljs-attr"><span class="hljs-attr">fixedContext</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}) (fillStyle, <span class="hljs-string"><span class="hljs-string">'#eee'</span></span>) (strokeStyle, <span class="hljs-string"><span class="hljs-string">'blue'</span></span>) .beginPath() (moveTo, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) (lineTo, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) .lineTo(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) (lineTo, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) (lineTo, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) (closePath) .stroke() .fill() ();</code> </pre><br><br><h4>  Sausage.js usage examples </h4><br><h5>  Example 1. Context switch </h5><br><pre> <code class="javascript hljs">context = {<span class="hljs-string"><span class="hljs-string">'foo'</span></span>: {<span class="hljs-string"><span class="hljs-string">'bar'</span></span>: <span class="hljs-string"><span class="hljs-string">'100500'</span></span>}, <span class="hljs-string"><span class="hljs-string">'bar'</span></span>: <span class="hljs-string"><span class="hljs-string">'888'</span></span>, <span class="hljs-string"><span class="hljs-string">'zoo'</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/./</span></span>}; <span class="hljs-comment"><span class="hljs-comment">//     {'foo': {'bar': '100500'}, 'bar': '888', 'zoo': /./} result = $$(context) ('foo') //     {'bar': '100500'} ('bar', -1) //   ('zoo') //    zoo (); //    - undefined ..   foo  / zoo</span></span></code> </pre><br><br><h5>  Example 2. Fixed context </h5><br><pre> <code class="javascript hljs">context = {<span class="hljs-string"><span class="hljs-string">'foo'</span></span>: {<span class="hljs-string"><span class="hljs-string">'bar'</span></span>: <span class="hljs-string"><span class="hljs-string">'100500'</span></span>}, <span class="hljs-string"><span class="hljs-string">'bar'</span></span>: <span class="hljs-string"><span class="hljs-string">'888'</span></span>, <span class="hljs-string"><span class="hljs-string">'zoo'</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/./</span></span>}; <span class="hljs-comment"><span class="hljs-comment">//     {'foo': {'bar': '100500'}, 'bar': '888', 'zoo': /./} result = $$(context, {fixedContext: true}) ('foo') //     {'bar': '100500'} ('bar', -1) //   ('zoo') //    zoo (); //    - /./</span></span></code> </pre><br><br><h5>  Example 3. Function call - change context value </h5><br><pre> <code class="javascript hljs">context = {<span class="hljs-string"><span class="hljs-string">'foo'</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>}; <span class="hljs-comment"><span class="hljs-comment">//     {'foo': 1} result = $$(context) ('foo', 1000) //     (function (context) { //      return '' + context.foo / 2; //    -  '500' }) ('length') //      (function (context) { return typeof context; //    -  'number' }) (); //    number</span></span></code> </pre><br><br><h5>  Example 4. DOM wrapper </h5><br><pre> <code class="javascript hljs">result = $$(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>) (<span class="hljs-string"><span class="hljs-string">'getElementById'</span></span>, <span class="hljs-string"><span class="hljs-string">'div1'</span></span>) (<span class="hljs-string"><span class="hljs-string">'style'</span></span>) (<span class="hljs-string"><span class="hljs-string">'width'</span></span>, <span class="hljs-string"><span class="hljs-string">'100px'</span></span>) <span class="hljs-comment"><span class="hljs-comment">//   ({ //     /    height: '100px', color: 'red', border: 'solid 1px blue' }) (); // CSSStyleDeclaration Object</span></span></code> </pre><br><br><h5>  Example 5. jQuery wrapper </h5><br><pre> <code class="javascript hljs">result = $$(jQuery) ([<span class="hljs-string"><span class="hljs-string">'#div2'</span></span>]) <span class="hljs-comment"><span class="hljs-comment">//       - ,        ('css', {width: '100px', height:'100px', color: 'red', border: 'solid 1px blue'}) ('animate', {width: '200px', height:'200px'}) (); // jQuery</span></span></code> </pre><br><br><h4>  Profiling </h4><br>  To start profiling, you need to connect a version with the profiler enabled and start profiling. <br><pre> <code class="javascript hljs">$$.profile(); <span class="hljs-comment"><span class="hljs-comment">//    console &amp;&amp; console.dir($$.profileEnd());</span></span></code> </pre><br>  As a result, we get <br><pre> <code class="hljs pgsql">[anonymous <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span> { calls=<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>} [context <span class="hljs-keyword"><span class="hljs-keyword">call</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span> { calls=<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>} [switching context] <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span> { calls=<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>} animate <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span> { calls=<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">5</span></span>} bar <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span> { calls=<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>} width <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span> { calls=<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>}</code> </pre> <br><br><h4>  Minuses </h4><br>  - For convenience, it is necessary to collect a dictionary of methods / properties (if you use sausage notation) <br>  - Farewell autocomplete (if you use sausage notation) <br>  - Challenges a bit slower <br>  - In dotted notation, it is impossible to call the meotds / properties that the functions (length, call, apply, ...) functions cannot - <code>$$([1,2,3]).length()();</code>  can be - <code>$$([1,2,3])('length')();</code> <br><br><h4>  pros </h4><br>  - Due to the dictionary, the lack of a point and the use of chains - a <b>significant reduction</b> in the amount of code after compression <br>  - Ability to cross-profile profile calls and count the number of calls <br>  - Processing "Bundle" <br><br><h4>  Links </h4><br>  Live example <a href="http://jsfiddle.net/azproduction/LUXwY/">jsfiddle.net/azproduction/LUXwY</a> <br>  Not packed version with comments (9168 bytes) <a href="">sausage-js.googlecode.com/svn/trunk/Sausage.js</a> <br>  Packed version (1268 bytes) <a href="">sausage-js.googlecode.com/svn/trunk/Sausage.min.js</a> <br>  Version with profiler <a href="">sausage-js.googlecode.com/svn/trunk/Sausage-profile.js</a> <br><br>  Criticism, suggestions and suggestions are welcome. <br><br>  <b>UPD</b> Added profiling description </div><p>Source: <a href="https://habr.com/ru/post/115357/">https://habr.com/ru/post/115357/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../115349/index.html">Erase can not be restored</a></li>
<li><a href="../115351/index.html">Art directorate and design</a></li>
<li><a href="../115353/index.html">As thanks to hc.ru, I realized that backups should be done by myself</a></li>
<li><a href="../115354/index.html">Broadcasting from open competitions of St. Petersburg in robotics</a></li>
<li><a href="../115356/index.html">Panasonic engineers presented a charging table with solar panels</a></li>
<li><a href="../115361/index.html">GTD and eGroupWare</a></li>
<li><a href="../115362/index.html">CMS Diem Introductory Overview</a></li>
<li><a href="../115365/index.html">What are you missing to complete the transition from windows to linux?</a></li>
<li><a href="../115367/index.html">How often when voting for a topic, do you plus or minus it without reading to the end</a></li>
<li><a href="../115368/index.html">Journalist Programmer 1 year!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>