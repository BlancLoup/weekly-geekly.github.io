<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We write cross-browser UserJS. Example # 1: we change the Yandex logo</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Firefox, Opera, Safari and Chrome support UserJS. All in different ways. I plan to write a series of articles about how to write scripts for these bro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We write cross-browser UserJS. Example # 1: we change the Yandex logo</h1><div class="post__text post__text-html js-mediator-article">  Firefox, Opera, Safari and Chrome support UserJS.  All in different ways.  I plan to write a series of articles about how to write scripts for these browsers.  On the day one by one. <br><br>  Today we will change the Yandex logo to Google.  Such a useless script. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8d1/599/5d9/8d15995d9a4798b41fae1b46c7eba0e8.png" alt="Yandex with Google logo">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="">yandex-with-google-logo.user.js</a> : <br><br><pre>  // == UserScript ==
 // @name Google logo on yandex.ru
 // @include http://www.yandex.ru/*
 // == / UserScript ==

 var logo = document.querySelector ("img [src $ = 'logo.png']");
 if (logo) {
   logo.src = 'http://www.google.com/intl/en_ALL/images/logo.gif';
   logo.removeAttribute ('height');
 }
</pre><br><br><a name="habracut"></a><br>  This UserJS works in the latest versions of Firefox, Opera, Safari and Chrome.  But in Opera there is a nuance: the logo variable has become available from the web page. <br><br><table><tbody><tr><td><img src="https://habrastorage.org/getpro/habr/post_images/1f8/33d/03b/1f833d03b6593e14d0b3eb34b6aa5a89.png" alt="logo // [object HTMLImageElement]"></td><td><img src="https://habrastorage.org/getpro/habr/post_images/d42/361/81b/d4236181b1bc5901591450d8a1c0b96e.png" alt="logo // undefined"></td></tr></tbody></table><br><br>  If the logo variable had already been defined on the page, then our script would redefine it.  This can be avoided by wrapping the code in an anonymous function.  <a href="">yandex-with-google-logo2.user.js</a> : <br><br><pre>  // == Userscript ==
 // @name Google logo on yandex.ru
 // @include http://www.yandex.ru/*
 // == / Userscript ==
</pre><br><pre>  (function () { </pre><pre>  var logo = document.querySelector ("img [src $ = 'logo.png']");
   if (logo) {
     logo.src = 'http://www.google.com/intl/en_ALL/images/logo.gif';
     logo.removeAttribute ('height');
   } </pre><pre>  }) (); </pre><br><br>  Why only in Opera the variable became global?  In Opera, the window in the UserJS == window page. <br><br>  In Greasemonkey, the window is an <a href="http://wiki.github.com/greasemonkey/greasemonkey/xpcnativewrapper">XPCNativeWrapper</a> .  This object is, as it were, outside the window of the web page and the web page scripts do not have access to it.  The access to the window of the web page is done through window.wrappedJSObject (aka <a href="http://wiki.github.com/greasemonkey/greasemonkey/unsafewindow">unsafeWindow</a> ). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d72/740/bef/d72740befaad5ee5013fdd560296e22b.png" alt="window"><br><br>  In Safari Greasekit, the window UserJS == window window, as well as in Opera.  However, the variables remain local, as if the script is already wrapped in an anonymous function. <br><br>  Continued: <a href="http://habrahabr.ru/blogs/GreaseMonkey/73928/">Example number 2: override alert ()</a> <habracut></habracut></div><p>Source: <a href="https://habr.com/ru/post/73901/">https://habr.com/ru/post/73901/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../73894/index.html">GIS technology to the masses</a></li>
<li><a href="../73895/index.html">Creating a home theater</a></li>
<li><a href="../73897/index.html">Evaluation of coursework in IT disciplines</a></li>
<li><a href="../73898/index.html">Unpacking the Call Of Duty: Modern Warfare 2 Pre-Order Kit</a></li>
<li><a href="../73899/index.html">ScribbleBot</a></li>
<li><a href="../73902/index.html">Application to old laptops</a></li>
<li><a href="../73904/index.html">PHP-AMQP What's New in Friends?</a></li>
<li><a href="../73906/index.html">Zotac MAG: nVidia Ion nettop</a></li>
<li><a href="../73907/index.html">Emotion Markup Language (EmotionML) 1.0</a></li>
<li><a href="../73908/index.html">Solving the problem with creating a new script</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>