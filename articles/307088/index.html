<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Interception of functions .NET / CLR</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sometimes, when developing software, it is required to build additional functionality into already existing applications without modifying the source ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Interception of functions .NET / CLR</h1><div class="post__text post__text-html js-mediator-article">  Sometimes, when developing software, it is required to build additional functionality into already existing applications without modifying the source code of the applications.  Moreover, the applications themselves often exist only in compiled binary form without source code.  A well-known way to solve this problem is so-called.  ‚ÄúSplicing‚Äù is a method of intercepting functions by changing the code of the objective function.  Usually, when splicing, the first bytes of the target function are moved to other addresses, and an unconditional branch command (jmp) is written to their original place on the replacement function.  Since splicing requires low-level memory operations, it is performed using assembly language and C / C ++, which also imposes certain restrictions on the implementation of replacement functions - they are usually also implemented in C / C ++ (less often in assembler). <br><br>  The splicing method for intercepting API functions in Windows is widely described on the Internet and in various literary sources.  The simplicity of this interception is determined by the following factors: <br><ol><li>  the target function is static - it is immediately present in the memory of the loaded module; <br></li><li>  the address of the objective function is easy to determine (via the module export table or the <i>GetProcAddress</i> function). <br></li></ol><br>  Implementing replacement functions in C / C ++ when intercepting API functions is the best option, since Windows API is implemented, as is well known, in C, and replacement functions can operate with the same concepts as the replaced ones. <br><a name="habracut"></a><br>  With the advent of the .NET technology, the situation has radically changed.  Dynamic link libraries created for .NET no longer contain static functions (functions are generated dynamically based on IL intermediate language commands).  As a consequence of this, it is difficult to predict the memory address by which functions will be placed after dynamic compilation (JIT compilation), as well as to track the very moment of JIT compilation.  In addition, without additional efforts, it is impossible to use the .NET function as a replacement function, since it itself is not static and is not implemented in C / C ++. <br><br>  In this article, an algorithm will be described, the use of which allows replacing .NET functions with functions that are also being developed in the .NET environment.  To understand the algorithm we are going to have, we will have to delve into the implementation of the CLR (common language runtime) .NET.  When describing the implementation of the CLR, we will simplify some of the details in order to avoid complicating the understanding of the general essence. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  1. Method of calling methods in the CLR </h2><br>  In the CLR, each function (method) is a set of IL commands and all information about it is stored in the module's metadata.  When loading a module for each of its classes, the CLR system creates a <i>MethodTable</i> table containing information about the class methods.  Each class method is described by a <i>MethodDesc</i> structure, one of the fields of which contains the address of the compiled method in memory (when the method is JIT compiled), and the other contains an index in the <i>MethodTable</i> table that contains the address of the adapter (thunk), the contents of which change during execution depending on whether the method is compiled or not. <br><br><img src="https://habrastorage.org/files/e47/571/add/e47571add96e4ed1b61fc922a2c2c873.jpg"><br><br>  Initially (before JIT compilation), one of four so-called acts as an adapter.  CLR precode adapters: <i>StubPrecode</i> , <i>FixupPrecode</i> , <i>RemotingPrecode,</i> or <i>NDirectImportPrecode</i> .  Since the last adapter is used only to call Windows API functions that can be intercepted directly, we will not consider it. <br><br>  The main task of each of the precode adapters is to transmit the address of the <i>MethodDesc</i> structure, <br>  the method used to determine the internal function of <i>ThePreStub</i> ( <i>ThePreStubAMD64</i> for the x64 platform, marked as Stub in the figure), which performs the following tasks: <br><ol><li>  JIT compilation of the method identified by the MethodDesc structure; </li><li>  setting a pointer in the MethodDesc structure to the generated native code; </li><li>  rewriting the adapter so that it performs an unconditional jump (jmp) to the generated native code; <br></li><li>  Execution of generated native code. </li></ol><br>  Thus, as a result of the initial call of the target method, not only will the method code be generated and executed, but the contents of the adapter will change, which will lead to a direct call of the generated native code on subsequent method calls. <br><br>  Any .NET method called from the CLR passes through the address in the <i>MethodTable</i> table of the class methods.  However, the CLR provides the ability to call a method from an unmanaged C / C ++ environment.  The following functions are <i>used</i> for this: <i>GetFunctionPointer of the RuntimeMethodHandle</i> class and <i>GetFunctionPointerForDelegate</i> of the <i>Marshal</i> class.  The addresses returned by the specified functions are also addresses of adapters, among which may be the already mentioned <i>StubPrecode</i> , <i>FixupPrecode</i> and <i>RemotingPrecode</i> .  As a result of the initial method call, it is compiled and executed; on a subsequent call, a direct transition to the generated code.  At the same time, it is important for us that for an uncompiled method, when calling it both through the method table and through the pointers returned by the mentioned functions, the internal function <i>ThePreStub is called</i> . <br><br><h2>  2. CLR Precode Adapters </h2><br>  Consider now separately the CLR precode adapter and specify how, knowing only the binary code of the adapter itself, during execution you can determine the address of the <i>MethodDesc</i> structure associated with this adapter, as well as the address of the internal function <i>ThePreStub</i> (it will be useful later).  In addition, we specify how in the specified adapter to determine the address of the generated code after performing JIT compilation. <br><ol><li>  <b><i>StubPrecode</i></b> .  At the time of its creation, the value of the address of the <i>MethodDesc</i> structure <i>is</i> embedded into the specified adapter directly by the CLR system (as an immediate value in the assembler command).  The adapter code depends only on the hardware platform and does not depend on the CLR version.  For various hardware platforms, it looks like this: <br><pre><code class="hljs">x86: mov eax, pMethodDesc mov ebp, ebp jmp ThePreStub x64: mov r10, pMethodDesc jmp ThePreStub</code> </pre> <br>  Thus, the address of the <i>MethodDesc</i> structure <i>is</i> passed to <i>ThePreStub</i> function in the eax register (for x86) or r10 (for x64).  During the execution of the memory analysis, the specified address can be clearly read at offset 1 (for x86) or 2 (for x64) adapters, taking into account the processor bitness.  The address of the <i>ThePreStub</i> function can be calculated by adding the relative offset embedded in the last jmp command with the end address of the specified command. <br><br>  After performing JIT compilation, the transition address is replaced with the address of the <i>ThePreStub</i> function <i>with</i> the address of the generated code and the contents of the adapter become as follows: <br><pre> <code class="hljs">x86: mov eax, pMethodDesc mov ebp, ebp jmp NativeCode x64: mov r10, pMethodDesc jmp NativeCode</code> </pre><br>  The method for determining the address of the generated code after JIT compilation is the same as the method for determining the address of <i>ThePreStub</i> function before performing JIT compilation. <br><br></li><li>  <b><i>FixupPrecode</i></b> .  The specified adapter was designed to optimize memory usage.  It occupies 8 bytes on all hardware platforms, which is smaller than the size of the <i>StubPrecode</i> adapter (12 bytes for x86 and 16 bytes for x64).  The adapter code for all hardware platforms and CLR versions is as follows: <br><br><pre> <code class="hljs pgsql"> <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> PrecodeFixupThunk db <span class="hljs-number"><span class="hljs-number">0x5E</span></span> db MethodDescChunkIndex db PrecodeChunkIndex  <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> PrecodeFixupThunk db <span class="hljs-number"><span class="hljs-number">0</span></span>x db MethodDescChunkIndex db PrecodeChunkIndex</code> </pre><br>  When using <i>FixupPrecode Adapters, the</i> CLR complies with the following two requirements: <br><br><ol><li>  <i>MethodDesc</i> structures for adapters <i>are</i> combined in <i>MethodDescChunk</i> contiguous memory <i>blocks</i> : <br><img src="https://habrastorage.org/files/678/bd2/64d/678bd264d98d47c1a5891038df6534b0.jpg"><br></li><li>  <i>FixupPrecode adapters are</i> also merged into a continuous memory block, with the base address of the <i>pDMethodDescChunkBase MethodDesc</i> structures in the <i>MethodDescChunk</i> memory block embedded in the specified block after the CLR <i>adapters</i> : <br><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">call</span></span> PrecodeFixupThunk db ? db MethodDescChunkIndex db PrecodeChunkIndex ... <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> PrecodeFixupThunk db ? db MethodDescChunkIndex db <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> PrecodeFixupThunk db ? db MethodDescChunkIndex db <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> PrecodeFixupThunk db ? db MethodDescChunkIndex db <span class="hljs-number"><span class="hljs-number">0</span></span> dd pMethodDescChunkBase (x86) dq pMethodDescChunkBase (x64)</code> </pre><br></li></ol><br>  With such a memory organization, the address of the <i>MethodDesc</i> structure for a specific adapter <i>FixupPrecode</i> is given by the following formula: <br><br>  Address <i>MethodDesc</i> = <i>pMethodDescChunkBase</i> + <i>MethodDescChunkIndex</i> * sizeof (void *), <br><br>  where the base offset ( <i>pMethodDescChunkBase</i> ) is retrieved at the following address: <br><br>  address <i>pMethodDescChunkBase</i> = address <i>FixupPrecode</i> + 8 + <i>PrecodeChunkIndex</i> * 8, <br><br>  <i>MethodDescChunkIndex</i> and <i>PrecodeChunkIndex</i> are byte values ‚Äã‚Äãembedded in <i>PrecodeFixupThunk</i> . <br><br>  The value of the Address of the <i>MethodDesc</i> structure is <i>calculated by</i> the CLR inside the additional adapter <i>PrecodeFixupThunk</i> , which exists in the memory in the singular and is intended only for calculating and transmitting the specified address of <i>ThePreStub</i> function in the eax register (for x86) or r10 (for x64).  We give the code for the <i>PrecodeFixupThunk</i> adapter for various hardware platforms. <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">x86</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">esi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">edi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movzx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">esi</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">byte</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[eax + 0x2]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movzx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">edi</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">byte</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[eax + 0x1]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">dword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[eax + esi * 8 + 0x3]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">lea</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">eax</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[eax + edi * 4]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">edi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">esi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">jmp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">dword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[g_dwPreStubAddr]</span></span> ( <span class="hljs-selector-tag"><span class="hljs-selector-tag">CLR</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span>) <span class="hljs-selector-tag"><span class="hljs-selector-tag">jmp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ThePreStub</span></span> ( <span class="hljs-selector-tag"><span class="hljs-selector-tag">CLR</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span>  ) <span class="hljs-selector-tag"><span class="hljs-selector-tag">x64</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rax</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movzx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r10</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">byte</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rax + 0x2]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movzx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r11</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">byte</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rax + 0x1]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rax + r10 * 8 + 0x3]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">lea</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r10</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rax + r11 * 8]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">jmp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ThePreStub</span></span></code> </pre><br>  The address of the internal function of <i>ThePreStub</i> using the <i>FixupPrecode</i> adapter can be calculated in two steps: <br><br><ol><li>  calculate the address of the <i>PrecodeFixupThunk</i> adapter by adding the relative offset embedded in the first command of the <i>Fix FixPrecode</i> adapter of the adapter with the end address of the specified command; <br></li><li>  for all platforms except CLR 2.0 x86, calculate <i>ThePreStub</i> address by adding the relative offset embedded in the last jmp command of the <i>PrecodeFixupThunk</i> adapter, with the end address of the specified command; <br></li><li>  for the CLR 2.0 x86 platform, extract the <i>ThePreStub</i> address to the address that is embedded in the last jmp command (indirect addressing via the <i>g_dwPreStubAddr</i> internal variable). <br></li></ol><br><br>  After JIT compilation in the <i>FixupPrecode</i> adapter <i>, the</i> first call command is replaced with the jmp command, replacing the transition address from the address of the <i>PrecodeFixupThunk</i> adapter <i>with</i> the address of the generated code.  In addition, if the first command is followed by byte 0x5E, then it is replaced by byte 0x5F (the indicated bytes are an indicator of the presence or absence of JIT compilation, byte 0xCC means no information).  Thus, after replacing the contents of the adapter is the following: <br><br><pre> <code class="hljs nginx"> <span class="hljs-attribute"><span class="hljs-attribute">jmp</span></span> NativeCode db 0x5E db MethodDescChunkIndex db PrecodeChunkIndex  jmp NativeCode db 0x db MethodDescChunkIndex db PrecodeChunkIndex</code> </pre><br>  The address of the generated code after JIT compilation is calculated by adding the relative offset embedded in the first jmp command with the address of the completion of the specified command. <br><br></li><li>  <b><i>RemotingPrecode</i></b> .  The specified adapter is used when calling methods of objects that may exist in another application domain.  The adapter code is as follows: <br><pre> <code class="hljs sql">x86: mov eax, pMethodDesc nop <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> PrecodeRemotingThunk jmp ThePreStub x64: <span class="hljs-keyword"><span class="hljs-keyword">test</span></span> rcx,rcx je <span class="hljs-keyword"><span class="hljs-keyword">Local</span></span> mov rax, qword ptr [rcx] mov r10, ProxyAddress cmp rax, r10 je Remote <span class="hljs-keyword"><span class="hljs-keyword">Local</span></span>: mov rax, ThePreStub jmp rax Remote: mov r10, pMethodDesc mov rax, RemotingCheck jmp rax</code> </pre><br>  As in the case of the <i>StubPrecode</i> adapter, in <i>RemotingPrecode</i> at the time of its creation, the value of the address of the <i>MethodDesc</i> structure <i>is</i> embedded by the CLR system directly (as an immediate value in the assembler command).  The specified value can be retrieved at offset 1 (for x86) and 37 (for x64).  The address of the <i>ThePreStub</i> function is the result of adding the relative offset embedded in the last jmp command with the address of the completion of the specified command (for x86) or the immediate value at offset 25 (for x64). <br><br>  For objects that do not belong to other domains, after performing JIT compilation, the transition address is changed from the address of the <i>ThePreStub</i> function to the address of the generated code, so the method for determining the address of the generated code after performing JIT compilation is the same as the method of determining the address of ThePreStub function before performing JIT compilation.  For objects belonging to other domains, after JIT compilation, the body of the adapter <i>RemotingPrecode</i> does not change.  For simplicity, we do not consider the use of <i>RemotingPrecode</i> for objects that do not belong to the application domain. <br></li></ol><br><h2>  3. <i>ThePreStub</i> Function </h2><br>  As already mentioned, the internal function of <i>ThePreStub</i> performs the following actions: <br><ol><li>  JIT compilation of the method identified by the MethodDesc structure; </li><li>  setting a pointer in the MethodDesc structure to the generated native code; </li><li>  rewriting the adapter so that it performs an unconditional jump (jmp) to the generated native code; </li><li>  Execution of generated native code. </li></ol><br>  In all versions of the CLR and hardware platforms, the <i>ThePreStub</i> function <i>is</i> implemented in the CLR at the hardware level by calling the internal function <i>PreStubWorker</i> followed by transferring control (via the jmp command) to the address returned by the specified function.  For completeness, here‚Äôs the code for the <i>ThePreStub</i> function for various platforms. <br><br><div class="spoiler">  <b class="spoiler_title">ThePreStub function code (x64)</b> <div class="spoiler_text"><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">CLR</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.6</span></span>  : <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r15</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r14</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r13</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r12</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rbp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rbx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rsi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sub</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rsp</span></span>,68<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+0B0h]</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">rcx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+0B8h]</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">rdx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+0C0h]</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">r8</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+0C8h]</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">r9</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+ 20h]</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+ 30h]</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+ 40h]</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm2</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+ 50h]</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm3</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">lea</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rcx</span></span>,<span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+68h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdx</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">r10</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">call</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">PreStubWorker</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+20h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+ 30h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm2</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+ 40h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm3</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+ 50h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rcx</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+0B0h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdx</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+0B8h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r8</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+0C0h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r9</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp+0C8h]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">add</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rsp</span></span>,68<span class="hljs-selector-tag"><span class="hljs-selector-tag">h</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rsi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rbx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rbp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r12</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r13</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r14</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r15</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">jmp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rax</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">CLR</span></span> 4<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">lea</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rax</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x08]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r10</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r15</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r14</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r13</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r12</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rbp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rbx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rsi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rax</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sub</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rsp</span></span>, 0<span class="hljs-selector-tag"><span class="hljs-selector-tag">x78</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xD0]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">rcx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xD8]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xE0]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">r8</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xE8]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">r9</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x20]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x30]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x40]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm2</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x50]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm3</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">lea</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rcx</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x68]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">call</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">PreStubWorker</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x20]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x30]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm2</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x40]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm3</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x50]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rcx</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xD0]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdx</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xD8]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r8</span></span> , <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xE0]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r9</span></span> , <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xE8]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">nop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">add</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rsp</span></span>, 0<span class="hljs-selector-tag"><span class="hljs-selector-tag">x80</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rsi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rbx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rbp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r12</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r13</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r14</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r15</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r10</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">jmp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rax</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">CLR</span></span> 2<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">lea</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rax</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x08]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r10</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r15</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r14</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r13</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r12</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rbp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rbx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rsi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">push</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rax</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sub</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rsp</span></span>, 0<span class="hljs-selector-tag"><span class="hljs-selector-tag">x78</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xD0]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">rcx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xD8]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xE0]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">r8</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xE8]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">r9</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x20]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x30]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x40]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm2</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x50]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm3</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">call</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">PrestubMethodFrame</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">::GetMethodFrameVPtr</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x68]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">rax</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rax</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[s_gsCookie]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x60]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">rax</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">call</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">GetThread</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r12</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">rax</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdx</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r12 + 0x10]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x70]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">lea</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rcx</span></span>, <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x68]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r12 + 0x10]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">rcx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">call</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">PreStubWorker</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rcx</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r12 + 0x10]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdx</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rcx + 0x08]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[r12 + 0x10]</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm0</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x20]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm1</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x30]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm2</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x40]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">movdqa</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmm3</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">xmmword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0x50]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rcx</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xD0]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdx</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xD8]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r8</span></span> , <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xE0]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mov</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r9</span></span> , <span class="hljs-selector-tag"><span class="hljs-selector-tag">qword</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ptr</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[rsp + 0xE8]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">nop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">add</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rsp</span></span>, 0<span class="hljs-selector-tag"><span class="hljs-selector-tag">x80</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rdi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rsi</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rbx</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rbp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r12</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r13</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r14</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r15</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pop</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">r10</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">jmp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">rax</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">ThePreStub function code (x86)</b> <div class="spoiler_text"><pre> <code class="hljs perl">CLR <span class="hljs-number"><span class="hljs-number">4.6</span></span>  : <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ebp mov ebp,esp <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ebx <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> esi <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> edi <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ecx <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> edx mov esi,esp <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> eax <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> esi call PreStubWorker <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> edx <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> ecx <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> edi <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> esi <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> ebx <span class="hljs-keyword"><span class="hljs-keyword">pop</span></span> ebp jmp eax CLR <span class="hljs-number"><span class="hljs-number">4.0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ebp mov ebp, esp <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ebx <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> esi <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> edi <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ecx <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> edx <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> eax <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esp</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x0C</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lea</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esi</span></span></span><span class="hljs-function">, [</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esp</span></span></span><span class="hljs-function"> + 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x04</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esi</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PreStubWorker</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esp</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x10</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">edx</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ecx</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">edi</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esi</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ebx</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ebp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jmp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CLR</span></span></span><span class="hljs-function"> 2.0: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">edx</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PrestubMethodFrame</span></span></span><span class="hljs-function">::'</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vftable</span></span></span><span class="hljs-function">' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ebp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ebx</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esi</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">edi</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lea</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esi</span></span></span><span class="hljs-function">, [</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esp</span></span></span><span class="hljs-function"> + 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x10</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> [</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esi</span></span></span><span class="hljs-function"> + 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x0C</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ebp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ebp</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ecx</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">edx</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ebx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fs</span></span></span><span class="hljs-function">:0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x0E34</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">edi</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dworp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> [</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ebx</span></span></span><span class="hljs-function"> + 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x0C</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> [</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esi</span></span></span><span class="hljs-function"> + 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x04</span></span></span><span class="hljs-function">], </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">edi</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> [</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ebx</span></span></span><span class="hljs-function"> + 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x0C</span></span></span><span class="hljs-function">], </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esi</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cookie</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esi</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PreStubWorker</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> [</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ebx</span></span></span><span class="hljs-function"> + 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x0C</span></span></span><span class="hljs-function">], </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">edi</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ecx</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> [</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esi</span></span></span><span class="hljs-function"> + 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x08</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dword</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ptr</span></span></span><span class="hljs-function"> [</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esi</span></span></span><span class="hljs-function"> + 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x08</span></span></span><span class="hljs-function">], </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eax</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eax</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ecx</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esp</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x04</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">edx</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ecx</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mov</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esp</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ebp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ebp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esp</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x04</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">edi</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esi</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ebx</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ebp</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">esp</span></span></span><span class="hljs-function">, 0</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x08</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ret</span></span></span></span></code> </pre><br></div></div><br>  Knowing the binary structure of the precode adapters, the address of the <i>ThePreStub</i> function can be determined as follows: <br><ol><li>  Define an arbitrary static CLR method (you can even make it empty) by disallowing inline embedding and precompiling: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EmptyDelegate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; [MethodImplAttribute( MethodImplOptions.NoInlining | MethodImplOptions.NoOptimization)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Empty</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {}</code> </pre><br></li><li>  Create and block the delegate of the method in memory and determine the address returned by the <i>RuntimeMethodHandle.GetFunctionPointer</i> function: <br><br><pre> <code class="cs hljs">EmptyDelegate function = Empty; GCHandle gc = GCHandle.Alloc(function); IntPtr methodPtr = function.Method.MethodHandle.GetFunctionPointer();</code> </pre><br></li><li>  If the commands at <i>methodPtr</i> match the <i>StubPrecode</i> adapter <i>sample</i> , you should use the method for calculating the <i>ThePreStub</i> function <i>address</i> from section 1, section 2. If the commands at the received address match the <i>FixupPrecode</i> adapter <i>sample</i> , you should use the method for calculating the address of <i>ThePreStub</i> function from section 2, section 2 . <br><br></li><li>  To unlock the memory of the delegate method: <br><br><pre> <code class="cs hljs">gc.Free();</code> </pre><br></li></ol><br><br><h2>  4. <i>PreStubWorker</i> function </h2><br>  The <i>PreStubWorker</i> function performs the following actions: <br><ol><li>  JIT compilation of the method identified by the MethodDesc structure; </li><li>  setting a pointer in the MethodDesc structure to the generated native code; </li><li>  rewriting the adapter so that it performs an unconditional jump (jmp) to the generated native code; </li><li>  return function <i>ThePreStub</i> address of the modified adapter. </li></ol><br>  The <i>PreStubWorker</i> function has the following C declaration (according to the CLR source code): <br><br><pre> <code class="cpp hljs"> CLR <span class="hljs-number"><span class="hljs-number">4.6</span></span>  : <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* __<span class="hljs-function"><span class="hljs-function">stdcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PreStubWorker</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TransitionBlock* pTransitionBlock, MethodDesc* pMD)</span></span></span></span>;  CLR  <span class="hljs-number"><span class="hljs-number">4.6</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>* __<span class="hljs-function"><span class="hljs-function">stdcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PreStubWorker</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PrestubMethodFrame *pPFrame)</span></span></span></span>;</code> </pre><br>  Using this fact, the listings of the <i>ThePreStub</i> function <i>code</i> , and the fact that the <i>ThePreStub</i> functions in the eax (for x86) and r10 (for x64) <i>registers are</i> passed the value of the <i>MethodDesc</i> address, you can determine how the <i>PreStubWorker</i> function internally accesses the <i>MethodDesc</i> value: <br><ol><li>  for CLR 4.6 (and higher), the specified value is retrieved from the second passed parameter function; <br></li><li>  for CLR below 4.6 of the x86 platform, the value is at the 8 offset of the structure addressed by the <i>pPFrame</i> parameter; <br></li><li>  for CLR below 4.6 platform x64 value is the address, 16 bytes less than the value of the address located at offset 16 of the structure addressed by the <i>pPFrame</i> parameter. <br></li></ol><br>  Knowing the address of the internal function of <i>ThePreStub</i> and based on the listed listings of its code, you can specify the algorithm for calculating the address of the internal function of <i>PreStubWorker</i> without using fixed offsets within the function of <i>ThePreStub</i> (which, as you can see, change with each new CLR version): <br><ol><li>  for x86 and x64 platforms (except CLR 2.0), the specified address will be the result of adding the relative offset embedded in the call command, the only command in <i>ThePreStub</i> function, with the address of the completion of the specified command; <br></li><li>  for CLR 2.0 x64 platforms, the specified address will be the result of the addition of the relative offset embedded in the call command, preceded by the lea command, with the end address of the call command. <br></li></ol><br>  You can find the required call commands during execution if you have a built-in disassembler that can determine the codes and sizes of commands in the run mode. <br><br><h2>  5. Interception Algorithm </h2><br>  Summarizing all the above, we can suggest the following method of intercepting .NET functions: <br><ol><li>  get the address of the replacement method using the <i>RuntimeMethodHandle.GetFunctionPointer</i> call; <br></li><li>  if the replacement method is already JIT-compiled, then find the address in the memory of the generated native code and intercept the specified address to perform the replacement method; <br></li><li>  if the replacement method is not yet JIT compiled, then <br><ol><li>  calculate the address of its structure <i>MethodDesc</i> ; <br></li><li>  calculate the address and intercept the <i>PreStubWorker</i> function so that the original implementation is called in the replacement <i>PreStubWorker</i> method; <br></li><li>  add additional logic to the replacement <i>PreStubWorker</i> function for the case when the function <i>uses MethodD</i> address that matches the required address.  In this case, after calling the original implementation, obtain the address of the generated native method and intercept the obtained address to perform the replacement method. <br></li></ol><br></li></ol><br>  After all of the above, the above points of the algorithm do not require detailed explanations, except for paragraphs 2 and 3.1. <br><br>  In paragraph 2, the definition of the address of the real generated native-code (without any adapters).  The algorithm below is based on knowledge of the binary structure of the adapters generated by the CLR, and calculates the specified address (or returns NULL in the absence of JIT compilation). <br><ol><li>  Get the address of the .NET method via a call to <i>RuntimeMethodHandle.GetFunctionPointer</i> . <br></li><li>  If the commands at the received address match the sample adapter <i>StubPrecode</i> or <i>RemotingPrecode</i> , then extract the address of the compiled code, as described in paragraph 1 and paragraph 3 of section 2. If the specified address matches the address of the <i>ThePreStub</i> function, then the JIT compilation of the method was not performed and follows return null.  Otherwise, return the address of the compiled code. <br></li><li>  Until the current address matches the address of <i>ThePreStub</i> function <i>,</i> do the following: <br><ol><li>  if the current address indicates a jmp command, then go to the destination for the jmp command; <br></li><li>  otherwise, if the current address indicates a call command, then check the destination address of the call command.  If it is equal to the <i>PrecodeFixupThunk</i> adapter (a case of a <i>FixupPrecode</i> adapter before the JIT compilation), then return NULL.  Otherwise, return the address where the call command is located (or the destination address for the call command); <br></li><li>  otherwise, return the current address. <br></li></ol><br></li><li>  Return NULL, because the address of <i>ThePreStub</i> function has been <i>reached</i> . <br></li></ol><br>  Clause 3.1 refers to determining the address of the <i>MethodDesc</i> structure for an <i>uncompiled</i> method.  The algorithm below is based on knowledge of the binary structure of adapters generated by the CLR, and calculates the specified address (or NULL in some cases with JIT compilation). <br><ol><li>  Get the address of the .NET method via a call to <i>RuntimeMethodHandle.GetFunctionPointer</i> . <br></li><li>  If the commands at the received address match the sample adapter <i>StubPrecode</i> or <i>RemotingPrecode</i> , then calculate the address of the <i>MethodDesc</i> structure, as described in paragraph 1 and paragraph 3 of section 2. <br></li><li>  Until the current address matches the address of <i>ThePreStub</i> function <i>,</i> do the following: <br><ol><li>  if the current address points to the jmp command, then check the byte immediately after the jmp command.  If it is 0x5F (the case of <i>FixupPrecode</i> after performing JIT compilation), then calculate the address of the <i>MethodDesc</i> structure, as described in Section 2, paragraph 2. Otherwise, go to the address for the jmp command; <br></li><li>  otherwise, if the current address indicates a call command, then check the destination address of the call command.  If it is equal to the <i>PrecodeFixupThunk</i> adapter (a case of a <i>FixupPrecode</i> adapter prior to JIT compilation), then calculate the address of the <i>MethodDesc</i> structure, as described in paragraph 2 of section 2. Otherwise, return NULL; <br></li><li>  otherwise, return NULL. <br></li></ol><br></li><li>  Return NULL (the specified item must be unreachable). <br></li></ol><br><h2>  6. Conclusion </h2><br>  The efficiency of the above algorithm has been repeatedly tested in practice (including industrial developments) on various versions of .NET and hardware platforms.  Based on it, the .NET library was developed, using which the interception of .NET functions becomes quite easy to use.  Let us give an example of the use of interception using the developed library. <br><br>  Suppose you want to hook the <i>Open</i> function of the <i>SqlConnection</i> class.  Then the interception code using the developed library may look like in C # as follows: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HookedConnection</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> RTX.NET.HookHandle OpenHandle; [MethodImplAttribute(MethodImplOptions.NoInlining)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Open</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SqlConnection connection</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//    Console.WriteLine(connection.ConnectionString); //    OpenHandle.Call(connection); } }</span></span></code> </pre><br>  Here, the <i>OpenHandle</i> variable contains a handle that can be used to invoke the implementation of the function being replaced and which is initialized as a result of the interception assignment: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (ConnectionEntry entry = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConnectionEntry()) { Test(); }</code> </pre><br>  where the <i>ConnectionEntry</i> class is so called.  ‚ÄúInterception manager‚Äù: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ConnectionEntry</span></span> : <span class="hljs-title"><span class="hljs-title">RTX</span></span>.<span class="hljs-title"><span class="hljs-title">NET</span></span>.<span class="hljs-title"><span class="hljs-title">HookDispatcher</span></span>, <span class="hljs-title"><span class="hljs-title">RTX</span></span>.<span class="hljs-title"><span class="hljs-title">NET</span></span>.<span class="hljs-title"><span class="hljs-title">IHookLoadHandler</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   public virtual string[] GetTypes() { //      return new string[] { "System.Data.SqlClient.SqlConnection"}; } //    public virtual void OnLoad(RTX.NET.HookDispatcher dispatcher, Type type) { //   HookedConnection.OpenHandle = HookOpen(dispatcher, type); } private RTX.NET.HookHandle HookOpen( RTX.NET.HookDispatcher dispatcher, Type targetType) { //       string name = "Open"; Type[] types = Type.EmptyTypes; //    BindingFlags flags = BindingFlags.Public | BindingFlags.Instance | BindingFlags.InvokeMethod; //   return dispatcher.Install(targetType, name, typeof(HookedConnection), name, flags, types ); } }</span></span></code> </pre><br>  Then when you run the <i>Test</i> function <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Test</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { SqlConnection connection = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SqlConnection(); connection.ConnectionString = <span class="hljs-string"><span class="hljs-string">@"Server=(localdb)\v11.0;"</span></span> + <span class="hljs-string"><span class="hljs-string">@"AttachDbFileName=C:\MyFolder\MyData.mdf;Integrated Security=true;"</span></span>; connection.Open (); connection.Close(); }</code> </pre><br>  the console will display the following message: <br><br><pre> <code class="bash hljs">Server=(localdb)\v11.0;AttachDbFileName=C:\MyFolder\MyData.mdf;Integrated Security=<span class="hljs-literal"><span class="hljs-literal">true</span></span>;</code> </pre></div><p>Source: <a href="https://habr.com/ru/post/307088/">https://habr.com/ru/post/307088/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../307076/index.html">Digest of grocery design, July 2016</a></li>
<li><a href="../307078/index.html">Kaggle - our excursion to the kingdom of overfit</a></li>
<li><a href="../307082/index.html">X86 Economy with new Oracle SPARC S7 servers</a></li>
<li><a href="../307084/index.html">Why, oh why, these #? @! assholes use vi?</a></li>
<li><a href="../307086/index.html">How do Fault Tolerant servers differ from ‚Äúconsumer‚Äù consumer goods in a specific example?</a></li>
<li><a href="../307090/index.html">State machines in the SimInTech dynamic simulation environment</a></li>
<li><a href="../307092/index.html">Variant of working with the cache without access to the backend using the example of Yii2</a></li>
<li><a href="../307094/index.html">Another way to load CSS via RequireJS</a></li>
<li><a href="../307096/index.html">Why use RxJava in Android - a brief introduction to RxJava</a></li>
<li><a href="../307098/index.html">Started selling tickets for the conference Droidcon Moscow 2016</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>