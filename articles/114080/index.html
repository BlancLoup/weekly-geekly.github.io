<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Canvas Indicator - Alternative for AjaxLoad.gif</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many probably use process indicators , for example, when transmitting / receiving any data via AJAX. 

 Once I was puzzled that when I clicked on the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Canvas Indicator - Alternative for AjaxLoad.gif</h1><div class="post__text post__text-html js-mediator-article">  Many probably use <a href="http://ajaxload.info/">process indicators</a> , for example, when transmitting / receiving any data via AJAX. <br><br>  Once I was puzzled that when I clicked on the button that sends the form data to the server, this same indicator will appear inside it.  Initially, the background was monophonic, but at any moment designers could replace it with another one, or even make a gradient. <br><br>  Making a special GIF for every situation is pretty stupid.  Therefore, the right solution is to use Canvas. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br>  In the very first minutes, I came across <a href="http://jamund.com/canvas-loader/no.jquery.html">this JavaScript module</a> , with the help of which you can at least be generated with similar indicators: <br><img src="https://habrastorage.org/getpro/habr/post_images/15d/e03/c9c/15de03c9cf66c7adf7205dc5ee4fe463.gif"><br><br>  But this did not solve the problem, not from the technical side of course, but from the design side.  The person dealing with these issues insisted that not circles, but sticks, run in a circle like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/033/19d/410/03319d410668766850d481484e834b09.gif"><br><br>  Initially, I stumbled upon <a href="http://www.netzgesta.de/busy/">this library</a> , but it implemented many functions that I did not even plan to use.  The search had to continue. <br><br>  In the end, I came across <a href="http://starkravingcoder.blogspot.com/2007/09/canvas-loading-indicator.html">one record</a> that almost solved my problem. <br><br>  Removing too much, adding the necessary, I will be happy to share the decision with you. <br><br>  An example of use.  In the right place, put the canvas tag: <br><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">canvas</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"loader"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">canvas</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  And create an instance of the CanvasIndicator class: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CanvasIndicator(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"loader"</span></span>),{ <span class="hljs-attr"><span class="hljs-attr">bars</span></span>:<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-attr"><span class="hljs-attr">innerRadius</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">size</span></span>:[<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>], <span class="hljs-attr"><span class="hljs-attr">rgb</span></span>:[<span class="hljs-number"><span class="hljs-number">255</span></span>,<span class="hljs-number"><span class="hljs-number">255</span></span>,<span class="hljs-number"><span class="hljs-number">255</span></span>], <span class="hljs-attr"><span class="hljs-attr">fps</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span> });</code> </pre> <br><br>  As you can see, the CanvasIndicator constructor takes two parameters: the first is necessarily the canvas, where the action will take place.  The second parameter is optional - this is an object whose properties are the configuration of the indicator. <br><br>  Read more about the properties: <br><br>  <b>bars</b> - the number of blocks <br>  <b>innerRadius</b> - inner radius <br>  <b>size</b> is an array, where the first element is the width of the block, and the second is its height <br>  <b>rgb</b> - indicator color, specified by an array of three elements, where Red, Green, Blue - respectively <br>  <b>fps</b> - the number of frames per second, the larger the value, the faster the indicator is spinning <br><br>  Well, directly the code of the library CanvasIndicator.js <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CanvasIndicator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">el, opt</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctx = el.getContext(<span class="hljs-string"><span class="hljs-string">"2d"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.currentOffset = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> defaults = { <span class="hljs-attr"><span class="hljs-attr">bars</span></span>: <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-attr"><span class="hljs-attr">innerRadius</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">size</span></span>: [<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>], <span class="hljs-attr"><span class="hljs-attr">rgb</span></span>: [<span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>], <span class="hljs-attr"><span class="hljs-attr">fps</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(opt) == <span class="hljs-string"><span class="hljs-string">'object'</span></span>) { defaults.bars = opt.bars ? opt.bars : defaults.bars; defaults.innerRadius = opt.innerRadius ? opt.innerRadius : defaults.innerRadius; defaults.size = opt.size ? opt.size : defaults.size; defaults.rgb = opt.rgb ? opt.rgb : defaults.rgb; defaults.fps = opt.fps ? opt.fps : defaults.fps; } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt = defaults; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.w = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt.size[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt.innerRadius; el.setAttribute(<span class="hljs-string"><span class="hljs-string">"width"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.w * <span class="hljs-number"><span class="hljs-number">2</span></span>); el.setAttribute(<span class="hljs-string"><span class="hljs-string">"height"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.w * <span class="hljs-number"><span class="hljs-number">2</span></span>); (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nextAnimation</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">obj</span></span></span><span class="hljs-function">) </span></span>{ obj.currentOffset = (obj.currentOffset + <span class="hljs-number"><span class="hljs-number">1</span></span>) % obj.opt.bars; obj.draw(obj.currentOffset); setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ nextAnimation(obj); }, <span class="hljs-number"><span class="hljs-number">1000</span></span> / obj.opt.fps); })(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } CanvasIndicator.prototype.makeRGBA = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"rgba("</span></span> + [].slice.call(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>).join(<span class="hljs-string"><span class="hljs-string">","</span></span>) + <span class="hljs-string"><span class="hljs-string">")"</span></span>; } CanvasIndicator.prototype.drawBlock = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">barNo</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctx.fillStyle = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.makeRGBA(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt.rgb[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt.rgb[<span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt.rgb[<span class="hljs-number"><span class="hljs-number">2</span></span>], (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt.bars + <span class="hljs-number"><span class="hljs-number">1</span></span> - barNo) / (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt.bars + <span class="hljs-number"><span class="hljs-number">1</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctx.fillRect(-<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt.size[<span class="hljs-number"><span class="hljs-number">0</span></span>] / <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt.size[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt.size[<span class="hljs-number"><span class="hljs-number">1</span></span>]); } CanvasIndicator.prototype.calculatePosition = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">barNo</span></span></span><span class="hljs-function">) </span></span>{ angle = <span class="hljs-number"><span class="hljs-number">2</span></span> * barNo * <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.PI / <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt.bars; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">y</span></span>: (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt.innerRadius * <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.cos(-angle)), <span class="hljs-attr"><span class="hljs-attr">x</span></span>: (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt.innerRadius * <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sin(-angle)), <span class="hljs-attr"><span class="hljs-attr">angle</span></span>: angle }; } CanvasIndicator.prototype.draw = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">offset</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.clearFrame(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctx.save(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctx.translate(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.w, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.w); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt.bars; i++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> curbar = (offset + i) % <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.opt.bars, pos = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.calculatePosition(curbar); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctx.save(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctx.translate(pos.x, pos.y); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctx.rotate(pos.angle); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.drawBlock(i); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctx.restore(); } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctx.restore(); } CanvasIndicator.prototype.clearFrame = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctx.clearRect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctx.canvas.clientWidth, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctx.canvas.clientHeight); }</code> </pre> <br><br>  See an example <a href="http://toydestroyer.com/standalone/canvasindicator/">here</a> . <br>  Download the library <a href="">here</a> </div><p>Source: <a href="https://habr.com/ru/post/114080/">https://habr.com/ru/post/114080/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../114071/index.html">We create the structure of personal documents of users in the enterprise in Samba</a></li>
<li><a href="../114073/index.html">Clodo Downtime and Strange Support</a></li>
<li><a href="../114075/index.html">New types of files in Google Docs</a></li>
<li><a href="../114078/index.html">Collect data or teach Doctrine to do multiple insert</a></li>
<li><a href="../114079/index.html">How I implemented Zimbra</a></li>
<li><a href="../114082/index.html">TOP'i here</a></li>
<li><a href="../114084/index.html">Experience GTD practice on Win / iOS / Android simultaneously</a></li>
<li><a href="../114085/index.html">Google introduced the importer of bookmarks from Delicious</a></li>
<li><a href="../114086/index.html">Ubuntu 10.04.2 released</a></li>
<li><a href="../114089/index.html">The highlighted widget in Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>