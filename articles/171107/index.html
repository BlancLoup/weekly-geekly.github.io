<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Internet TV - the most underrated development segment</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Disclamer 

 Hello! At JetStyle, there is a development department for Smart TV. We want to talk about technology Smart TV, which, as it seems to us, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Internet TV - the most underrated development segment</h1><div class="post__text post__text-html js-mediator-article"><h6>  Disclamer </h6><br><img src="https://habrastorage.org/getpro/habr/post_images/f41/f1f/c5d/f41f1fc5d2d6f22d5418381fa022ad16.png" alt="image"><br>  Hello!  At JetStyle, there is a development department for Smart TV.  We want to talk about technology Smart TV, which, as it seems to us, is very undervalued in the field of development. <br><br>  We have been closely involved in this topic for several years - a lot of things have accumulated, I want to share, and perhaps make life easier for other developers. <br>  For convenience, we have divided the story into 2 blocks.  In the first we will talk about what it is all about, and in the second we will talk about the features of design and development for Smart TV and, of course, about a bunch of problems that we faced in the process. <br><a name="habracut"></a><br><h5>  About terminology </h5><br>  So, what do we mean by smart TV? <br>  In general, Smart TV is the Internet on TV.  It can be either a modern TV with a built-in Smart TV, or any TV receiver that has access to the Internet and is connected to a TV. <br>  Smart TV is built on interactive services and the most diverse multimedia content.  It is interactive services, widgets and applications, sharpened for working with the remote control instead of the mouse, that distinguish Smart TV from the usual Internet browser on a computer. <br><br>  From a technical point of view, Smart TV is a mobile operating system, tailored specifically for televisions.  Representing the software, Smart TV can be embedded in a variety of devices: from the TVs themselves to blu-ray players and game consoles. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  What is the joy? <br></h5><br>  Why is Smart TV promising, fashionable and youthful? <br><ul><li>  browser, and almost the same as on a desktop PC.  Why ‚Äúpractically‚Äù, we will tell a bit later; </li><li>  quick access to informational content.  For example, weather, traffic jams, quotes, news, etc .; </li><li>  Online video is one of the great advantages of Smart TV.  At the moment there is a fairly large number of libraries of free content (ivi, tvigle, tvzavr, etc.) and good paid services that provide fresh films in excellent quality; </li><li>  the ability to play games that will soon come close to the console, such as the Nintendo Wii; </li><li>  the ability to communicate on social networks, like cats, etc.) </li><li>  Well, finally, we can easily order a pizza or any other food without leaving the couch. </li></ul><br><br><h5>  Market dynamics </h5><br> <a href="http://www.google.com/trends/explore"><img src="https://habrastorage.org/getpro/habr/post_images/3bc/834/b92/3bc834b9242b4541796e75e0327d6ece.png" alt="image"><br></a> <br>  What is the situation with the Smart TV market? <br>  In general, any noticeable, Smart TV technology began to penetrate the market in 2010.  Then there were very few smart TVs, and they were quite expensive, there were almost no widgets, and for the most part they were designed in-house.  All this happiness worked rather slowly due to the fact that the iron on the TV was still quite weak.  However, it is worth noting that in 2010, Samsung introduces the first paid services for the United States and Korea. <br><br>  In 2011, the market share of smart TVs is growing and accounts for about 10% of total sales.  Third-party developers are actively connected, there are really good and convenient services, for example, youtube, ivi and other online cinemas.  In general, it is worth noting that the emergence of free legal online video services had a beneficial effect on the Smart TV market. <br><br>  For 2012, unfortunately, we did not manage to find any special statistics, but providers are becoming noticeably interested in the interactive.  There are more and more applications in the market, new video services are being added.  Iron TVs are becoming ‚Äúfaster.‚Äù <br><br>  At the moment, we can simply estimate the total number of smart TVs on the market.  For example, on the LG site at the moment, out of 145 TVs 55 with the Smart TV function, this is about 35%, and Samsung has 60% of all TVs on the site with Smart TV.  Having played with the filters on the Yandex.market and <a href="">choosing</a> Samsung, LG, Sony, Philips from the popular brands of TVs, we get that about 50% of all the TVs presented come with a Smart TV.  And if we consider that for the rest of the TVs that do not have such a function, we can pick up a digital receiver with an interactive system built into it, then we can assume that soon Smart TV, without exaggeration, will be in every home. <br><br><h5>  Not so simple </h5><br>  What hinders the rapid growth of smart TV at the moment? <br>  Smart TV is still quite a new trend, the technology is still at the initial stage of development.  As a result, we get low awareness of potential buyers about the benefits associated with the use of this technology. <br>  Many people, for example, still think that they will use the Smart TV function mainly for searching the Internet.  Consultants in consumer electronics stores are also far from always able to clearly say why to take TV with smart TV.  But people who bought Smart TV quickly understand the obvious benefits: you can watch movies, TV shows, cartoons, etc.  on the big screen and in high quality, without involving any other equipment like a personal computer, laptop, etc. <br>  Another deterrent that still affects the choice of Smart TV is the price.  A year ago, the price of such a TV was not commensurate with an ordinary TV, but now the differences in prices for TVs without and with Smart TV are quite small. <br><br>  Telecommunications operators in Russia also have a restrained interest.  A limited number of companies, such as Beeline, MTS, Tricolor TV and Dom.ru, have their own prefixes with interactive services. <br>  Obviously, they all understand the promise of the venture, but the level of implementation for the majority is at the initial stage (there are few services, monetization schemes are also not completely clear).  From the aforementioned, only <a href="http://ekat.domru.ru/domru-tv/services">Dom.ru has</a> distinguished itself, which has noticeably more services than the others at the moment. <br><br>  Anyway, over time, the players in this market will become more and more, and then the winner will be the one who is already actively engaged in this issue. <br><br><h5>  Platforms </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/169/53d/091/16953d09121e1e4506d533a36370cf95.png" alt="image"><br>  For creation of Smart TV portals, software shells are used - platforms on which design, styles are already bolted, widgets are developed, etc. <br><br>  Among the most widely used platforms, there are two mastodons - <b>Samsung Smart Hub</b> and <b>LG NetCast Platform</b> , on which Smart TVs are built from the respective manufacturers.  In Russia, and in the world, probably, these platforms are the most popular and developed now for a number of reasons, including the popularity of televisions themselves, a huge amount of documentation for developers for these platforms, a significant community, etc.  Many applications support the Russian language. <br>  These platforms are used exclusively on Samsung and LG TVs, and they cannot be transferred to set-top boxes or any other players. <br><br>  <b>Opera TV</b> is a cross-platform solution for smart TVs, i.e.  You can flash the platform on any set-top box, player or directly to the TV, and everything will work regardless of the manufacturer.  The platform also has its own portal. <br>  Opera tv store, which, unlike LG and Samsung, is located directly on Opera servers, and not on the user's end device.  Thus, the user has only an interface, and applications load dynamically.  This allows developers to change, supplement, correct their applications, and for the user this process will be completely invisible (unless we ourselves go to notify the user that the application has been updated).  In Russia, this platform is not yet very common, and appeared only on blu-ray and Sony TVs produced in 2012, has not yet turned in its hands, but the scale is impressive, and in this direction Opera will take its place under the sun. <br><br>  <b>Google TV</b> is a platform on Android. <br>  At the moment, as far as we know, the platform is represented by a <a href="http://en.m.wikipedia.org/wiki/Google_TV">dozen devices</a> about one of them from Sony can be read <a href="http://habrahabr.ru/post/146511/">here</a> .  Within the framework of the platform, the ability to open android-applications is implemented, the board carries a fairly large set of various applications.  There is a fairly extensive documentation on the platform, community, blogs, various documentation about everything in the world, a guide to adapting existing applications on android on the TV.  The only big minus for us - at the moment we have not noticed any signs that the platform is being distributed in Russia (http://www.google.com/tv/get.html) <br><br>  <b>Microsoft mediaroom</b> - the platform, as already understood, from Microsoft.  It is cross-platform, it can work on a personal computer, on a TV, on a set-top box and a phone.  In their development, the guys from Redmond rely on maximum scaling in order for the platform to work on the maximum number of devices, for example, you can even connect the portal to xbox360.  For application developers, there is a package of tools included in the Microsoft Mediaroom Application Development Kit, which is an open platform.  Applications for Microsoft mediaroom are ASP.NET applications. <br>  In the Russian market, Microsoft mediaroom is noticeably used by Beeline in their STB. <br><br><h5>  Design features </h5><br><h6>  It is the same, but square and different. </h6><br>  TV is not a computer, so the design and development for it is quite different. <br>  Even if we have a ready site for HTMLl + CSS + javascript, we cannot simply transfer it to the TV and use it as usual. <br>  Why not?  After all, there seems to be like a normal browser? <br>  First, we do not have a mouse, but there is a remote control with buttons, no keyboard, but there is a virtual keyboard, there is no monitor in front of our eyes, but there is a big screen at a distance of 2-3 meters. <br>  Let's understand in order. <br><br><h5>  No mouse </h5><br>  No mouse - <s>no cartoons</s> - this is one of the main differences in the design and design for the TV.  We can not look in any place in our application, but instead we can visually show the hover on the active elements. <br>  A mouse click replaces the ‚Äúok‚Äù button, the movement of the mouse over the elements is emulated by a four-way joystick programmed to jump across the blocks in the corresponding directions. <br>  It is worth noting that different manufacturers try to somehow solve the input problem and offer alternative input methods that make life easier for the user. <br>  However, so far all these methods are only of an additional character, and we cannot rely on them completely, happily forgetting the hateful console.  <b>For a very long time, we will be required to support the console as the main input method during development.</b> <br><br><h5>  No keyboard </h5><br>  This is also one of the important problems in televisions.  Instead of a keyboard, we have an on-screen keyboard.  It can do almost everything the same as a regular keyboard, and you can cram it into as many characters as you like, so it will turn out even more than a regular keyboard, but the more buttons we wind up on such a keyboard, the longer we have to work with a joystick to positioned on a specific character.  In the hardware sense, the keyboard is the same story as the remote control - manufacturers understand everything, struggle, offer solutions of varying degrees of convenience, but we still have a very long time to live with the on-screen keyboard as the main source of text input. <br><br><h5>  How can we make life easier for users? </h5><br>  The first thing that comes to mind: if the keyboard allows customization, we can display the keyboard with the necessary set of buttons for each specific case.  For example, to enter a pin-code or a phone, we can only show a numeric keypad; to enter an e-mail, we need only the English keyboard layout and a small set of characters.  By the way, to enter the phone or any other information consisting solely of numbers, we may not output the keyboard at all, but suggest the user, using the number pad on the keyboard, type these numbers, and we will process the keystrokes without resorting to the on-screen keyboard.  True, this can be done only as an additional bonus, and not as the main or the only input method (why so - the answer is below). <br><br><h5>  Display </h5><br>  Next on the list we have a monitor, or rather a fairly healthy screen compared to a monitor, but at the same time we are sitting a few meters away from it.  There are serious limitations on design, we will not go into them, because  This is a separate interesting topic (if interested - you can give a separate post about it), it‚Äôs worth saying only that we should use fonts of at least 18px, take into account the so-called ‚Äúsafe zone‚Äù of TVs, which should not have interactive elements and navigation (here there can only be background and fullscreen video). <br><br><h5>  Subtotals </h5><br>  TV development is structurally similar to mobile application development. <br>  We can not just give a link to the site, for example, yandex, 2gis, facebook, but we can offer the functionality of the same sites as an application. <br>  In the application, we have already taken into account the specifics of management, adapted fonts, made large and clear reference blocks, etc. <br>  Well, it is clear that the application, in comparison with the web service, is much easier to start from the console. <br><br>  Let us turn to the features of development for Smart TV. <br>  Let's take the most popular Samsung and LG platforms now, and using their example we will see what problems and peculiarities we encountered while developing for TV. <br><br><h4>  Development problems </h4><br><h5>  Layout </h5><br>  In principle, you can make up almost like in the web, using the available standards, but there are a few very important points: <br><ul><li>  Be sure to try to do as little as possible the nesting of tags in HTML, while respecting the balance of readability: suddenly you will return to this project in a year.  It is important for us, first of all, because of the speed of access to the element from javascript, secondly, you need to remember about the small memory of the device and not the fastest page rendering speed; </li><li>  preferably, if possible, the use of pure javascript, although, of course, this is far from always due to different very necessary plug-ins on the same jquery.  Jquery, in fact, normally works on all platforms on which we developed, but only if we use fairly simple selectors, and the DOM tree does not have the size of a skyscraper. </li><li>  It is advisable to use as few elements as possible, whose position on the page depends on other elements.  For example, for the list of posters in the films we used first inline-blocks, and the speed of moving the focus on them was far from ideal, then we tried to remake them to float: left, the speed increased, but not critical.  After it was decided to make the blocks absolute positioning, and only then achieved the desired effect.  The method, frankly, is not the most beautiful, we have to give each block top and left, but when everything else does not help, we have to sacrifice something, otherwise users will not forgive us the brakes; </li><li>  even with the support of CSS3, do not need to use it everywhere. </li></ul><br>  When developing for one STB, we are faced with the fact that we have almost full CSS3, transition, rotation, HTML5, etc.  Our eyes were burning, and our hearts beat faster, but everything fell into place when we came to the design implementation in the layout. <br>  Then we descended to our sinful land and began to look for a balance between using box-shadows, crossfades, slide effects and other eye-friendly imaging, without jerking images, etc.  Despite the draconian restrictions imposed by ourselves on ourselves, we can, in principle, fasten any effects and animations later, if the operator‚Äôs prefix suddenly upgrades and the iron becomes faster. <br><br><h5>  Software versioning </h5><br>  This is another sadness.  As you know, Smart TV just recently started appearing on TVs and, at the very beginning, had rather weak application software.  For example, in 2010-2011, Samsung Smart TV had a <b>Maple</b> browser. <br>  Here is its specification: <br>  <i>HTML4.01, XHTML1.0, XML1.0 Markup language specifications</i> <i><br></i>  <i>HTTP1.0 / 1.1</i> <i><br></i>  <i>CSS1, CSS2, CSS TV Profile 1.0</i> <i><br></i>  <i>DOM1, DOM2</i> <i><br></i>  <i>Javascript 1.6</i> <br>  There may be confusing, probably, CSS TV Profile 1.0.  In fact, this is a specification for TV devices, based on CSS2 and several parameters from CSS3, on w3c there is a comparison table of supported parameters and their values ‚Äã‚Äãin comparison with CSS2.  The specification is currently outdated (and now, at least in recent televisions, is not used), but an inquisitive reader can read the porosity here: <a href="http://www.w3.org/TR/css-tv">www.w3.org/TR/css-tv</a> . <br><br>  LG modestly calls its browser <b>LG browser</b> , it was created on the Webkit engine.  In the early stages, it already supports CSS3, works with flash, we can develop widgets for HD quality (or rather, we can‚Äôt even, but should - such a documentation requirement), support for HTML5, canvas, etc., though they came out later on Samsung later: the first The SDK was released in 2011 and has already supported <a href="http://developer.lgappstv.com/TV_HELP/index.jsp%3Ftopic%3D%252Flge.tvsdk.developing.book%252Fhtml%252FDeveloping%2BWeb%2BApp%252FDeveloping%2BWeb%2BApp%252FSupported%2BHTML5%2BCSS3%2BStandard%2Bfor%2Bthe%2BNetCast%2BPlatform%2Band%2BEmulator.htm">CSS3 and HTML5</a> . <br><br>  In 2012, a miracle happened, and this year‚Äôs TVs feature Webkit browsers with support for 2d / 3d transform, CSS3 selectors.  HTML5 support for video, audio, canvas tags has been added. <br>  LG devotes a lot of time to the emulator, which acquires new features, introduces WYSIWYG application design editor, various code validators, etc. <br><br>  In addition to the different specifications, the new versions naturally reward us with a new affordable resolution for widgets. <br>  At the moment it is 1280x960 (previous resolution is 960x540). <br>  What does this mean for us? <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">First, applications developed for 1280 resolution will not go on old TVs at a resolution of 960px, which translates either in support of a deliberately lower resolution of 960 and stretching it on a 1280 TV, or developing a rubber application, or developing two independent applications. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anyway, Samsung does not allow us to roll out one application, which will be both 960 and 1280, depending on the platform. To do this, we will have to do two applications anyway, since The resolution is set in applications fixed in the config.xml file, and we cannot dynamically edit it. Samsung has a </font></font><a href="http://www.samsungdforum.com/Devtools/SdkReleaseNote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">list of changes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , so, always keeping track of this information, we should not face problems.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition, new software versions invariably affect the support of various native methods. True, these changes are quite small, and most often, if we develop an application initially with the support of a weaker hardware, then it will work the same way on modern hardware, or we simply make two applications for different devices.</font></font><br><br><h5>  Speed ‚Äã‚Äãperformance </h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Maple browser on Samsung‚Äôs TV is distinguished by poorly optimized javascript, memory leaks due to minor bugs in the code (which you don‚Äôt have to think about on the web), poor image handling, lack of CSS3 parameters (but we get text-overflow from the manor‚Äôs shoulder: ellipse , quite often used and the desired parameter, thanks, already at least something). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You have to constantly monitor the number of elements in the DOM at the moment. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is necessary to balance between the desire to show the user the maximum of information on one screen without podzagruzok, trobbers, etc. and the fact that it is very difficult for a television to manipulate a large number of DOM elements and a large nesting of tags.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In order not to slander on the browser for nothing, it‚Äôs worth noting that 50% of the application‚Äôs speed is still provided by the TV‚Äôs hardware, so the speed is determined not only by the software, but also by the hardware. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suggestions for optimizing javascript for widgets in 2011: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- if in an application we frequently change the DOM structure, using for example innerHTML and create XMLHTTPRequest objects time after time, then the TV's memory will end very quickly, and then the application may behave unpredictably. </font><font style="vertical-align: inherit;">At this, Samsung gives us enough scant information for reflection:</font></font><br>  - <pre><script type="text/javascript">function gtElInit() {var lib = new google.translate.TranslateService();lib.translatePage('ru', 'en', function () {});}</script><script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=gtElInit&amp;client=wt"></script><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.XHRObj != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.XHRObj.destroy(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.XHRObj = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XMLHttpRequest();</code> </pre> <br><br>  - if xmlhttprequest is called again, delete the past from memory.  In one of our applications, for example, there was a need to use about 6 different feed uploads to display only one screen. <br><br>  - let's say we replace html content with innerHTML.  Replacing the content consists of two steps: removing the corresponding node from the DOM tree, and creating and connecting to the tree a new node.  So the node that we delete is stored in memory, and if we frequently replace content in this way, sooner or later the TV‚Äôs memory will overflow and our application may freeze, crash, until the TV itself reboots (checked on our own experience). <br>  Therefore, there is a native method putInnerHTML, which allows you to avoid such a memory leak.  It is used a little differently than innerHTML: <br><pre> <code class="javascript hljs">putInnerHtml(<span class="hljs-string"><span class="hljs-string">'&lt;h1&gt;&lt;/h1&gt;'</span></span>,<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'title'</span></span>));</code> </pre><br><br>  Samsung found a problem with a large number of images.  If there are more than 100 img tags in the DOM, then memory filling is guaranteed, and in the best case, in the pictures over 100 we will just see an empty space, at worst - we will get unpredictable application behavior.  It is decided elementary: do not use more than 100 images, but generally try to use a maximum of 50 images in order not to approach this terrible limit (as the doctor said ‚Äúdo not do this‚Äù). <br><br>  Following example <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Image(); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"foo"</span></span>).appendChild(a); }</code> </pre><br>  will lead to memory leaks, since  The new constructor is not cleared from memory unless we delete it via delete or set it to null.  Therefore, we can create an image as follows: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">"img"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"foo"</span></span>).appendChild(a); }</code> </pre><br>  In this case, this problem does not arise. <br><br>  A similar problem occurs with removeChild. <br>  What's wrong with this code? <br><pre> <code class="javascript hljs">element.removeChild(element.firstChild);</code> </pre><br>  That removeChild returns us value, and since  we do not assign this value to anything, then an exception occurs and the memory will not be freed. <br>  We are presented with 2 solutions to this: <br>  - we can simply substitute the variable to the left <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = element.removeChild(element.firstChild);</code> </pre><br>  - but we can use Samsung's native <b>deleteChild</b> method, which does not need a variable: <br><pre> <code class="javascript hljs">element.deleteChild(element.firstChild);</code> </pre><br><br>  Ways to optimize applications for LG in general are similar to Samsung. <br>  Limited use of transparency with CSS, because  These operations significantly affect the speed of displaying content and are quite heavy for a TV. <br><br>  Tracking errors in CSS and HTML using the <a href="http://validator.w3.org/">w3c validator</a> will also be a very useful operation: the less we strain the interpreter, the faster we get the image of the application. <br><br>  LG advises to carry large functionality on multiple screens and not try to show all the possibilities on one screen. <br>  In principle, all the rules listed for Samsung are also suitable for LG. <br>  If we use a lot of content on the same page, even if the content is hidden, then all this significantly affects performance. <br>  To load the main page, it is recommended to use a minimum of javascript code, and then go on to the necessary sections and load the content dynamically. <br>  There are nuances concerning images, for example, we should not use for displaying images that are larger than the screen resolution, the rule of not using a large number of images on one page also applies, as is the case with Samsung. <br><br>  For all platforms, the speed of rendering images can be enhanced in two ways: <b>preloading images</b> into javascript, described above, and <b>specifying image sizes</b> , if we know them, of course. <br><br><h5>  Data storage </h5><br>  Very quickly in application development, we come to the fact that you need to save data somewhere.  It can be as application settings that we need to store the entire life of the application on the TV, and data caching. <br>  There are several options here. <br>  In the case of Samsung, released in 2010, we have nothing but storing data in a local file on the TV: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fileSystemObj = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileSystem(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fileObj = fileSystemObj.openCommonFile(curWidget.id + <span class="hljs-string"><span class="hljs-string">'/testFile.data'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>); fileObj.writeLine(<span class="hljs-string"><span class="hljs-string">'something to write.'</span></span>); fileSystemObj.closeCommonFile(fileObj);</code> </pre><br>  Reading data from a file is as easy as writing: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fileSystemObj = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileSystem(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fileObj = fileSystemObj.openCommonFile(curWidget.id + <span class="hljs-string"><span class="hljs-string">'/testFile.data'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> strResult = fileObj.readAll();</code> </pre><br>  For recording, use the directory with the ID of our application in the title. <br>  This method works fast enough, and there are no problems with it. <br>  In 2011, the opportunity to work with cookies. <br><br>  LG until 2012 allowed to work with cookies, since 2012 we can use HTML5 sessionStorage and localStorage.  This is quite enough to save the user settings. <br><br><h5>  Screen keyboard. </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/002/bbd/e40/002bbde40dac2c0f940625cc0ece4634.png" alt="image"><br>  This is a separate song for the developer. <br>  For example, when developing for one STB, we got a completely native keyboard, so to speak, without the ability to make changes to the design, to its code, at least to something.  The keyboard worked by flipping focus () to input.  In any cases, when we want to call the keyboard, there are no other ways except the focus on the input, but all because we can get the value entered using it only by checking the input state on onchange ().  Ie, when we closed the keyboard, the onchange event occurred on the input, and we could take this value.  In addition, we are faced with another problem: input (like some other elements, such as a textarea button iframe) supports focus (), and if we, while on a website, start clicking the ‚Äútab‚Äù button, for example, focus will move through these elements.  In the console, the hover moves in this way when you press any button of the four-way joystick (due to the fact that there was an Opera engine).  Therefore, if we have input on the page, we move in blocks (the visual hover is on the blocks), but the real focus is on input, and when we click ‚Äúok‚Äù, expecting to follow the link on the block, we open the keyboard.  We decided this by adding the disable property to each input, and when we need to, we remove this parameter and focus () on the input (such tricks with input were due to the design in the metro style). <br><br>  <b>The Samsung keyboard is</b> different because we can call it programmatically without any input. <br><img src="https://habrastorage.org/getpro/habr/post_images/8cd/45a/e09/8cd45ae09fe63397f38e93333970d7c9.png" alt="image"><br>  We can intercept the input data at any time.  In addition, the keyboard has a good old good T9. <br><img src="https://habrastorage.org/getpro/habr/post_images/241/8fb/f91/2418fbf91b8d1e067267f88068df0bd8.png" alt="image"><br>  With proper skill, the necessary characters are entered 2 times faster than full qwerty keyboards.  We can also switch the keyboard to qwerty mode.  We can add a window with input, and with any description to it.  We can manage the coordinates of all windows keyboard.  We fastened autocompletion to it on the choice of the city, the keyboard did not resist.  The only thing that can not be - to change the design of the keyboard, there is no access to it (the <a href="http://www.samsungdforum.com/Guide/tut00118/index.html">keyboard</a> ). <br><br>  <b>The LG keyboard is</b> not as advanced as Samsung, but it has its advantages. <br><img src="https://habrastorage.org/getpro/habr/post_images/652/108/645/6521086459cdd2055f34bda4d0d6f596.png" alt="image"><br>  The keyboard is represented by a separate js-library, and it can be connected or not connected to our application, this means that we can change the general appearance of the keyboard, the design of the buttons, put our icons on the buttons. <br>  However, the manual on the use of this keyboard prohibits us to make changes to js-files.  The sadness in this case is that we have a strictly limited structure of buttons, and we cannot change it, unless we repaint.  This is due to the fact that if we change the CSS, and rearrange or remove some buttons, then it will work incorrectly. <br><br><h5>  Debag and testing </h5><br>  One of the most important tasks is, of course, application debugging. <br>  Here Samsung has an <a href="http://www.samsungdforum.com/Guide/art00096/index.html">excellent solution embedded in the SDK</a> . <br>  With the help of <b>alert (),</b> we can display the values ‚Äã‚Äãof the variables we need (in the TV, alert () does not cause any pop-up messages, but it is intended for debug).  The console itself displays detailed information about what is happening with our application.  The only thing debug didn‚Äôt swear at, but was just silent - this is memory overflow, here you had to look for errors yourself.  Samsung‚Äôs SDK also contains an emulator for all versions of the platform.  Emulators are 95% true.  In different emulators for various kinds of data such as memory leaks or some CSS parameters, you can see significant differences.  For example, we were faced with the fact that in one of the versions the missing line-height was equated to some fixed value, about 10 pixels. <br><br>  LG has a similar Samsung debug, but instead of alert, messages can be output in a more familiar way via console.log.  Logging can be maintained in a separate file.  Unlike Samsung, the logger does not provide us with complete information about the widget's work, but only errors and messages that we generate ourselves.  Since 2012, there is a monitor resource, although we can only monitor the emulator while monitoring the TV downloads for the future.  In 2013, there was a voice input, testing voice commands, you can also change the font in the emulator (mega useful feature), take screenshots. <br><br>  Under STB there is often no debug.  No  Totally.  There was a case when javascript debugged by placing an opaque layer on a third of the screen and outputting the values ‚Äã‚Äãof the desired variables in this layer.  When working with the native methods of the console, we did not find other outputs. <br><br><h5>  Authorization </h5><br>  For devices that do not have a mouse or a wheelbarrow, there is a significant problem of authorization, for example, in the social.  networks.  Take for example facebook.  We can place the login through facebook on our website, for this we can use oauth2.0, the facebook window opens in the iframe with a suggestion to enter a login / password, and here we are logged in.  If we try to do it also on the TV, then we will face an obvious problem: how do we enter our data in the iframe window of facebook?  The fact is that the security policy does not allow us to have access to the iframe window if its content is not on our domain.  Accordingly, we cannot register in this window the processing of clicks of the buttons of the console, and as a result we are completely helpless in our attempts to enter our data - He sees an eye, but it hurts the eye. <br>  This problem is solved with the help of <a href="http://oauth-device-demo.appspot.com/">pin codes</a> . <br>  On our computer on Facebook, we register our application, we get app_id.  In the application using this app_id we make a request for receiving the code <code><a href="https://graph.facebook.com/oauth/device%3Ftype%3Ddevice_code%26client_id%3D150792241632891"></a> graph.facebook.com/oauth/device?type=device_code&amp;client_id=150792241632891</code>  <code><a href="https://graph.facebook.com/oauth/device%3Ftype%3Ddevice_code%26client_id%3D150792241632891"></a> graph.facebook.com/oauth/device?type=device_code&amp;client_id=150792241632891</code> , then go to the computer, enter the code on the proposed facebook.com/device/ page and confirm access to our account.  After that on the TV we can make a request for a token <br> <code><a href="https://graph.facebook.com/oauth/device%3Ftype%3Ddevice_token%26client_id%3D150792241632891%26code%3D123456"></a> graph.facebook.com/oauth/device?type=device_token&amp;client_id=150792241632891&amp;code=123456</code>  <code><a href="https://graph.facebook.com/oauth/device%3Ftype%3Ddevice_token%26client_id%3D150792241632891%26code%3D123456"></a> graph.facebook.com/oauth/device?type=device_token&amp;client_id=150792241632891&amp;code=123456</code> .  Further, using this token can request information from facebook. <br>  Authorization also works on youtube.  The method was not invented by us, youtube or facebook applications under xbox will also be authorized. <br><br><h5>  TV testing </h5><br>  Samsung, in addition to a good test on the emulator, has a fairly simple way of testing directly on the TV.  To do this, the SDK provides the ability to pack the application in a format understandable to the TV. <br>  After that we place the resulting widget.xml and the folder with the application in the root of our local server. <br>  On the TV, we have to login under the developer and in the settings, specifying the IP address of our server, download the package to the TV.  The application will appear in the list of applications. <br>  What is important: running this application on a TV, we can monitor the status of our application in the SDK console in the same way as if we were running the application in the emulator. <br><br>  Testing on LG TV is different from Samsung and resembles completing a quest in some RPG. <br><ul><li>  First, we register an account on LG Apps TV. </li><li>  Then, using the SDK, we package our application in a zip archive. </li><li>  After that, we can upload this archive to the LG Developer website, and after that we can download the DRM package from our application from the site. </li><li>  Then we unpack the DRM package with a regular archiver. </li><li>  We see a folder with a numeric value - this is the ID of our application. </li><li>  Next, we create the lgapps folder in the root of the flash drive, in it the installed folder and in it we place our folder with the ID. </li><li>  We insert the USB flash drive into the TV. </li><li>  The sub-quest is still going on: if suddenly our country isn‚Äôt in the regional settings (how it defines it, we don‚Äôt know), then we will not be able to test our application. </li><li>  And only if everything is OK, we click on the button ‚Äúmy apps‚Äù, we waste all the applications that are there until the end, and ... hallelujah, here it is our application! </li></ul><br>  If we consider that in early 2012, when we made a widget under LG, we tried to test it on TV, we went through 9 circles of hell, and in the end it turned out that my apps are not working, because  LG has not yet connected to the tests of Russia.  You can imagine how much joy it was. <br><br><h5>  Rollout in production </h5><br>  <b>For Samsung</b> : register product information in the Seller office, get the application ID and title. <br>  Seller office is a place where we see information on our application, from here we can transfer the application for placement in the Samsung Smart TV App Store.  Also used to monitor the download of our application, history, status of the application, etc. <br>  After registering in the sales office, we can download our application.  After placing the application, we expect the application to be reviewed by Samsung. <br>  As soon as Samsung tests the application and confirms our application, the application is placed in the Smart TV App Store.  A detailed description of all stages is on the Samsung developer site. <br><br>  <b>For LG</b> : check in to the Seller Lounge.  We read the application submission guide.  Actually, we add our application.  In the same seller lounge, we can track the status of our application.  We are waiting for the approval of our application.  Checking the application is based on previously known documented criteria available to developers.  After approval of the application, we can see it in the LG Apps tv. <br><br><h4>  Intermission </h4><br>  We can tell a lot on this topic, since the experience is vast.  I want to understand how interesting the topic is and what else would I like to hear about? <br><br>  In general, we are looking forward to your feedback. </div><p>Source: <a href="https://habr.com/ru/post/171107/">https://habr.com/ru/post/171107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../171091/index.html">IDC counted the smartphone market in Russia</a></li>
<li><a href="../171093/index.html">[Disproved] We do not give away parcels without a middle name, or about new rules for Russian post</a></li>
<li><a href="../171095/index.html">Mathematical model of the malefactor and protection of physical objects</a></li>
<li><a href="../171103/index.html">How Samsung ate the smartphone industry - and now Google threatens</a></li>
<li><a href="../171105/index.html">VK.Ratsiya: voice messages VKontakte</a></li>
<li><a href="../171113/index.html">All the best with MWC 2013</a></li>
<li><a href="../171115/index.html">Evernote Business is now available to companies in Russia</a></li>
<li><a href="../171117/index.html">Where is the iPhone buried or how accurate is the GPS?</a></li>
<li><a href="../171119/index.html">Little printer or February offer</a></li>
<li><a href="../171131/index.html">IBM Watson supercomputer could be your next chef or doctor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>