<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MNP: How it all works *</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="* How everything is arranged nobody knows ... 

 Passions for the introduction of mobile number portability services have subsided a bit and now it is...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MNP: How it all works *</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/7ba/725/fdf/7ba725fdfffb8131656aa53b5efae329.jpg" alt="image"><br><br><h6>  <i>* How everything is arranged nobody knows ...</i> </h6><br><br>  Passions for the introduction of mobile number portability services have subsided a bit and now it is time to figure out what was done and how, what is the logic of the work and look at some technical aspects.  I want to ask all telecom gurus in advance to forgive me for intentional simplifications and ignore irrelevant details. <br><a name="habracut"></a><br>  One of the main tasks solved by networks that support MNP is to establish the subscriber‚Äôs belonging to any operator.  It is necessary to correctly send a voice call or SMS, and for payment systems - to whom to transfer money.  To solve this problem, a centralized database is used - the central database of the transferred numbers. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Everyone remembers that the federal state unitary enterprise ZNIIS was assigned as an operator of the TsDDPN, whose task was to deploy the said base, with which all players should be connected.  Of course, ZNIIS did not have any own developments, and there was an offer to buy a ready-made Numlex solution from the Lithuanian company Mediaphone.  Actually, that's what happened.  The money for the purchase in the amount of 70 million rubles was allocated by the Ministry of Communications, which made it possible to launch the TsDPN in record time.  By the way, on the site of the ZNIIS itself there is an opportunity to check the number belonging to the operator: <a href="http://www.zniis.ru/bdpn/check">www.zniis.ru/bdpn/check</a> <br><br>  The ZNIIS constantly lays out the meager statistics on the number of successful transitions, from which, unfortunately, the main thing cannot be understood: who has won what share from whom.  But you can see the dynamics of demand services.  If it goes on like this, I think the predictions that MNP is in demand only for 1-2% will be wrong <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1a3/83e/c7b/1a383ec7ba1c5af28cdc94fd0ecce90d.png" alt="image"><br><br>  We will consider MNP in two planes: <br><br><ul><li>  the transfer procedure itself, during which the subscriber migrates from one operator to another, and the TSPDB database is updated with routing information, the main of which is the routing number RN; </li><li>  The work of the main services of the operator with the new features. </li></ul><br>  It would also be interesting to look at payment systems.  But, alas, I don‚Äôt own this issue at all, so I have to leave it to more competent authors.  Get connected, tell. <br><br>  Looking ahead, I‚Äôll say that the cornerstone of all call processing logic is the routing number RN, which has the following format: <br><br>  <b>DXXYY</b> , where: <br><br>  D - always the symbol "D" <br>  XX - region code according to the <a href="http://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25B5%25D0%25B4%25D0%25B5%25D1%2580%25D0%25B0%25D1%2582%25D0%25B8%25D0%25B2%25D0%25BD%25D0%25BE%25D0%25B5_%25D1%2583%25D1%2581%25D1%2582%25D1%2580%25D0%25BE%25D0%25B9%25D1%2581%25D1%2582%25D0%25B2%25D0%25BE_%25D0%25A0%25D0%25BE%25D1%2581%25D1%2581%25D0%25B8%25D0%25B8">Constitution</a> .  It looks like a traffic police code, but for many regions it does not match.  For example, for RN code 55 - refers to the Novgorod region, although the traffic police in Novgorod code 53. <br>  YY - operator code.  For MTS-01, for MegaFon - 02, for Beeline - 99, for Tele2 - 20 <br><br><h4>  PORTING SUBSCRIBER </h4><br>  In the documents of the <a href="http://www.zniis.ru/bdpn/documents/documents-bdpn">ZNIIS</a> you can find a lot of colorful process diagrams and a fairly detailed description of the commands, completion codes and all necessary procedures.  We will consider a typical transfer scenario in which the subscriber of the donor operator goes to the recipient operator.  In a word, this is called Portation. <br><br>  <i>Figure 1 is a diagram of the porting process.</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f92/1e4/31d/f921e431dd5f782b9e35d489ca50404e.png" alt="image"><br><br>  Consider the main stages of the process <br><ol><li>  The subscriber comes to the office of the new operator (recipient) and writes a statement about the transition. </li><li>  The recipient operator sends a request to the central processing unit, where the application is registered and the porting process starts. </li><li>  The donor operator receives the application and performs a number of checks - the subscriber‚Äôs membership is no debt, no transfer ban for 6 months.  from the date of connection, etc. </li><li>  If all checks are successful, the donor sends the estimated date of commencement of the transfer.  Usually this date is selected after 7 full days from the current moment.  As practice shows, during this period, the donor operator begins to process the subscriber, trying to find out from him the reasons for his departure and suggests how to think.  Not sure about the effectiveness of such a policy;  It seems to me that the subscriber, if he has already thought up and walked to the office with his feet, to write a statement, nothing will stop him. </li><li>  On the appointed day and time, the <i>small portions</i> stage begins, when the main participants of the process make changes in their systems and after that the new SIM card of the subscriber can work in the new network.  The first to start is the donor, who deactivates the subscriber in his systems - HLR and billing. </li><li>  Then the recipient activates his new subscriber in his.  According to the regulations, all these manipulations are given half an hour.  It is during this period that the subscriber remains completely without communication.  It must be said, usually, all fit in a few minutes.  And after that, the subscriber can register in the new network and even use many services. </li><li>  Further, the donor makes changes to his SFR so that calls from his network to his ‚Äúformer‚Äù subscriber are correctly sent to his new home network.  This ends the stage of a small port and our subscriber, exhausted but happy, begins to get used to the new operator. </li><li>  TSBDPN spreads in its database incremental data about the new RN of the ported subscriber, and all connected operators collect this information every 2 hours and update their SRF </li></ol><br>  <b>Everything!</b>  <b>Now all operators know that our client has moved to a new network.</b> <br><br>  And here it remains to add that most operations are performed automatically.  Exceptions are, of course, interaction with the subscriber and the handling of various errors and special situations.  For example, the subscriber could change his mind to change the network - in this case there are some typical scenarios. <br><br><h4>  WORK OF MAIN SERVICES </h4><br>  Since this whole story is about a phone number, voice calls and SMS are of primary interest.  As I already wrote, the main task for call service is to establish the location of the called subscriber.  In a classical mobile network, its switch, called GMSC, solves, and the STP signaling gateway, which describes static routes for sending requests to HLRs based on the number of the subscriber, is helping.  If you are poorly familiar with the principles of mobile networks, I will explain that the HLR is a database that stores information not only about the technical parameters of subscribers, but also about the current serving switch of each of them.  And to find the called party, the network makes a request to the HLR. <br><br>  With the advent of MNP, static signaling routing based on MSISDN no longer allows us to find the desired HLR, and therefore the operator has a new node called the SRF.  The main task of the SRF is to store, update and provide information on the belonging of any number to the region and the operator.  The sign of belonging is the routing number RN, which is used further, in conjunction with the MSISDN number, for routing MAP and ISUP traffic by GMSC / MSS switches. <br><br>  Now let's analyze the voice call script to the subscriber ported to the new network.  For example, subscriber A from the Tele2 network calls subscriber B, who has switched to MTS **.  From where he came from now it doesn‚Äôt matter, because his past statement is no longer involved in the procedures.  Internal algorithms for working with SRF operators may be different.  But, we will look at the scheme in general terms, keeping in mind that this can only be one of the options. <br><br><h6>  <i>** operators are chosen arbitrarily.</i> </h6><br><br>  <i>Figure 2 - Call to the ported subscriber</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/080/34e/5b6/08034e5b638a7bec3d03a683071c99e0.png" alt="image"><br><ol><li>  The number dialed subscriber A, from the home network T2.  The MSC switch servicing it transfers the call to the gateway GMSC, whose task will be the further organization of the call. </li><li>  The gateway GMSC makes a request to the SRF, where there is information about the routing number of the RN with the region and operator codes (for example, D5501 - MTS Novgorod) </li><li>  The SRF node returns a response to the SRI to the GMSC, where a bunch of RN + MSISDN appears as the temporary number </li><li>  GMSC, based on the received RN + MSISDN, routes the call to the MTS operator. </li><li>  Well, then - the standard procedure for finding a subscriber within the network - a request to the HLR-B, obtaining a temporary number and GT VLR, establishing a voice connection to the final MSC of subscriber B. </li></ol><br>  For ease of understanding, the verification stage of subscriber B‚Äôs belonging on the side of the receiving operator (MTS) is omitted.  It is also performed through the SRF and is necessary in case other operators send calls to the wrong address, i.e.  in our case - to numbers that do not belong to MTS.  Such calls MTS will send to where the called subscriber is now actually registered and will take for it his own penny for transit. <br><br>  I repeat that the details of the internal decisions of different operators may differ.  But, in general, the principle is the same in one thing: to find the routing path, the network uses its own SRF node, which ‚Äúknows‚Äù which subscriber has been ported and where and which not. <br><br>  Considering in detail the same scenario for sending SMS, it does not make much sense.  Let me just say that in order to search for the recipient subscriber, the SMSC initiates the standard SRI_for_SM request, which should get into the recipient's HLR.  Along the way, this request is intercepted by the SRF, which helps to find the real receiving operator.  In response, the SMSC will receive the GT VLR where the recipient and the IMSI are located to send the message to the serving switch.  How exactly this information will be obtained by SRF is a matter of particular concern in the routing of the operator‚Äôs signal network and the add-on used.  functionality on STP nodes. <br><br><h4>  PROBLEMS </h4><br>  At the initial stage of the implementation of MNP, it was often the case that some single operators did not always have time to make changes in call routing and signalization.  Because of this, some ranges of numbers could be worked out according to the previous scheme, without the participation of the SRF.  Now this is extremely rare. <br><br>  Some problems arise in connection with the untimely update of local databases of operators.  The fact is that each major player has several SFR nodes and they are synchronized not directly with the TsBDPN, but through the local BDPN of the operator.  These processes somewhat reduce the efficiency of the porting procedure.  For the subscriber, this may look like the absence of incoming calls from some operators. <br><br>  If the main services are already more or less tested and cleared of bugs, then the mass of exotic, ‚Äúsmart‚Äù services built on IN platforms - various types of call forwarding, SMS, short numbers, mobile numbers in city ABC format, and so on. all this has yet to be rechecked.  I do not claim that everything is bad here.  But, you need to understand that the more crutches and the less demanded functionality, the greater the likelihood that some mechanisms have forgotten to adjust under the MNP. <br><br><h4>  CONCLUSION </h4><br>  When in the autumn of 2013 all market participants criticized the organization of the MNP project, they were right.  On the part of the Ministry of Communications, the intelligible rules were announced very late.  But, it was possible to implement the project due to the fact that our country was not a pioneer in this area.  There were ready-made solutions on the market - both for the TsDDPN, and for each operator and vendor of its equipment.  So the abolition of mobile slavery, in general, went quietly, without hysteria.  And, although the roughness still remained, in general, telecom operators, contrary to the prevailing stereotype, worked very quickly and consistently. </div><p>Source: <a href="https://habr.com/ru/post/216537/">https://habr.com/ru/post/216537/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../216523/index.html">What every participant of a large MMO project should know</a></li>
<li><a href="../216525/index.html">On the crest of technology: a meeting in joy - does it happen?</a></li>
<li><a href="../216527/index.html">Dictionary of words</a></li>
<li><a href="../216533/index.html">Hosting provider vs. DDoS attack. REG.RU Solution - Professional Outsourcing</a></li>
<li><a href="../216535/index.html">Reporter reputation management, or Who is to blame and what to do if your newsletter gets into spam?</a></li>
<li><a href="../216539/index.html">Creating your WebRTC application on the 1C-Bitrix platform</a></li>
<li><a href="../216543/index.html">Is it easy to become an analyst?</a></li>
<li><a href="../216545/index.html">Intel INDE Media Pack</a></li>
<li><a href="../216547/index.html">E-commerce trends: Foreign players come to Russia</a></li>
<li><a href="../216549/index.html">We collect the best in the collection and share with others.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>