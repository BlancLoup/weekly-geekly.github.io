<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Machine learning is easy</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article focuses on machine learning in general and interaction with datasets. If you are a beginner, you do not know where to start studying and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Machine learning is easy</h1><div class="post__text post__text-html js-mediator-article">  This article focuses on machine learning in general and interaction with datasets.  If you are a beginner, you do not know where to start studying and you are interested in knowing what dataset is, and also why Machine Learning is needed at all, and why it has been gaining increasing popularity lately, I ask for cat.  We will use Python 3, as it is a fairly simple tool for learning machine learning. <br><a name="habracut"></a><br><h2>  Who is this article for? </h2><br>  Anyone who would be interested then to delve into the history of searching for new facts, or anyone who wondered at least once the question ‚Äúhow does all this, machine learning, work,‚Äù will find here the answer to his question.  Most likely, an experienced reader will not find anything interesting for himself here, since the software part <s>leaves much to be desired is</s> somewhat simplified for beginners, however, inquiring about the origin of machine learning and its development in general will not prevent anyone. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/14b/771/410/14b7714106e0f85ff894f05dd0ec3a5b.jpg" alt="image" align="right"><h2>  In numbers </h2><br>  Every year there is a growing need for exploring big data, both for companies and for active enthusiasts.  In large companies such as Yandex or Google, data tools such as the R programming language or libraries for Python are increasingly used (in this article I cite examples written under Python 3).  According <a href="https://ru.wikipedia.org/wiki/%25D0%2597%25D0%25B0%25D0%25BA%25D0%25BE%25D0%25BD_%25D0%259C%25D1%2583%25D1%2580%25D0%25B0">to Moore's Law</a> (and in the picture, he himself), the number of transistors on an integrated circuit doubles every 24 months.  This means that every year the productivity of our computers grows, which means that the previously inaccessible boundaries of knowledge are again ‚Äúshifted to the right‚Äù - there is open space for studying big data, which is primarily connected with the creation of a ‚Äúscience of big data‚Äù, which Mostly it became possible due to the application of the previously described machine learning algorithms, which could only be verified after half a century.  Who knows, maybe in a few years we will be able to describe in absolute accuracy various forms of fluid movement, for example. <br><br><h2>  Is data analysis easy? </h2><br>  Yes.  And just as interesting.  Along with the special importance for all of humanity to study big data, there is a relative simplicity in studying them independently and applying the received ‚Äúanswer‚Äù (from an enthusiast to enthusiasts).  To solve the problem of classification today there is a huge amount of resources;  omitting most of them, you can use the tools library Scikit-learn (SKlearn).  Create your first training machine: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="python hljs">clf = RandomForestClassifier() clf.fit(X, y)</code> </pre> <br>  So we created a simple machine that can predict (or classify) the values ‚Äã‚Äãof arguments by their attributes. <br><br>  <b>- If everything is so simple, why still not everyone predicts, for example, currency prices?</b> <br><br>  With these words, it would be possible to finish the article, but <s>I certainly will not do this</s> (of course, I will, but later) there are certain nuances to the accuracy of predictions for the tasks set.  Not every task is solved so easily (what you can read more about <a href="http://rb.ru/story/ai-ml-cases/">here</a> ) <br><br><h2>  Closer to the point </h2><br>  <b>- It turns out, I cannot earn this business right away?</b> <br><br>  Yes, we are still far away from solving problems for prizes of $ 100,000, but everyone started with something simple. <br><br>  So today we will need: <br><br><ul><li>  Python 3 (with pip3 installed) </li><li>  Jupyter </li><li>  SKlearn, NumPy and matplotlib </li></ul><br><div class="spoiler">  <b class="spoiler_title">If something is not: we put everything in 5 minutes</b> <div class="spoiler_text">  First of all, <a href="https://www.python.org/downloads/">download</a> and install Python 3 (during installation, do not forget to install pip and add it to PATH if you downloaded the Windows installer).  Then, for convenience, the Anaconda package was taken and used, <a href="https://docs.continuum.io/anaconda/pkg-docs">which includes</a> more than 150 libraries for Python (download <a href="https://www.continuum.io/downloads">link</a> ).  It is convenient for use by Jupyter, the numpy, scikit-learn, matplotlib libraries, and also simplifies the installation of all.  After installation, launch Jupyter Notebook via the Anaconda control panel, or via the command line (terminal): ‚Äújupyter notebook‚Äù. <br></div></div><br>  Further use requires some knowledge of the Python syntax and its capabilities from the reader (at the end of the article there will be links to useful resources, among them ‚Äúthe basics of Python 3‚Äù). <br><br>  As usual, we import the necessary libraries for work: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> read_csv <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> read</code> </pre> <br>  <b>- Ok, with Numpy everything is clear.</b>  <b>But why do we need Pandas, and also read_csv?</b> <br><br>  Sometimes it is convenient to ‚Äúvisualize‚Äù existing data, then it becomes easier to work with them.  Moreover, most datasets from the popular Kaggle service are collected by users in CSV format. <br><br><div class="spoiler">  <b class="spoiler_title">This is how it is rendered by pandas</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/3f6/b84/3ea/3f6b843ea18e41b6bddf266e0f75c934.png" alt="image"><br>  Here the Activity column shows whether the reaction is going on or not (1 for a positive, 0 for a negative).  And the remaining columns - sets of signs and the corresponding values ‚Äã‚Äã(different percentages of substances in the reaction, their state of aggregation, etc.) <br></div></div><br>  <b>- I remember you used the word "dataset".</b>  <b>So what is it?</b> <br><br>  Dataset is a sample of data, usually in the format of ‚Äúa set of signs‚Äù ‚Üí ‚Äúsome values‚Äù (which may be, for example, housing prices, or the sequence number of a set of some classes), where <i>X</i> is a set of signs, and <i>y</i> are some values.  For example, determining the correct indices for a set of classes is the task of <i>classification</i> , and finding target values ‚Äã‚Äã(such as price, or distances to objects) is the task of <i>ranking</i> .  More information about the types of machine learning can be found in articles and publications, links to which, as promised, will be at the end of the article. <br><br><h2>  We get acquainted with the data </h2><br>  The proposed dataset can be downloaded <a href="">here</a> .  Reference to the source data and description of the signs will be at the end of the article.  According to the presented parameters, we are invited to determine what kind of wine this or that wine belongs to.  Now we can figure out what is happening there: <br><br><pre> <code class="python hljs">path = <span class="hljs-string"><span class="hljs-string">"%  %/wine.csv"</span></span> data = read(path, delimiter=<span class="hljs-string"><span class="hljs-string">","</span></span>) data.head()</code> </pre> <br>  Working in Jupyter notebook, we get this answer: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/37b/308/107/37b308107987453db847a10773927184.png" alt="image"></div><br>  This means that now we have data available for analysis.  In the first column, the Grade values ‚Äã‚Äãshow which wine belongs to, and the remaining columns are indications by which they can be distinguished.  Try <i>typing</i> <i>data</i> instead of <i>data.head ()</i> - now you can see not only the ‚Äúupper part‚Äù of the dataset. <br><br><h2>  Simple implementation of the classification task </h2><br>  We turn to the main part of the article - we solve the problem of classification.  All in order: <br><br><ul><li>  create a training set </li><li>  we try to train the car on randomly selected parameters and classes corresponding to them </li><li>  calculate the quality of the sold machine </li></ul><br>  Let's look at the implementation (each excerpt from the code is a separate Cell in the notebook): <br><br><pre> <code class="python hljs">X = data.values[::, <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">14</span></span>] y = data.values[::, <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.cross_validation <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> train X_train, X_test, y_train, y_test = train(X, y, test_size=<span class="hljs-number"><span class="hljs-number">0.6</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.ensemble <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RandomForestClassifier clf = RandomForestClassifier(n_estimators=<span class="hljs-number"><span class="hljs-number">100</span></span>, n_jobs=<span class="hljs-number"><span class="hljs-number">-1</span></span>) clf.fit(X_train, y_train) clf.score(X_test, y_test)</code> </pre> <br>  We create arrays, where <b>X</b> - signs (1 to 13 columns), <b>y</b> - classes (0th column).  Then, to build a test and training sample from the source data, we use the convenient cross-validation <i>function train_test_split</i> , implemented in scikit-learn.  We work further with ready samples - import the <i>RandomForestClassifier</i> from ensemble into sklearn.  This class contains all the methods and functions necessary for learning and testing the machine.  <i>We assign the RandomForestClassifier</i> class to the <i>clf</i> (classifier) ‚Äã‚Äãvariable, then we train the machine from the clf class by calling the <i>fit ()</i> function, where <i>X_train</i> are signs of the <i>y_train</i> categories.  You can now use the built-in <i>score</i> metric in the class to determine the accuracy of the categories predicted for <i>X_test</i> from the true values ‚Äã‚Äãof these categories <i>y_test</i> .  When using this metric, the accuracy value is displayed from 0 to 1, where 1 &lt;=&gt; 100% Done! <br><br><div class="spoiler">  <b class="spoiler_title">About RandomForestClassifier and cross-validation method train_test_split</b> <div class="spoiler_text">  During clf initialization for RandomForestClassifier, we set the values <i>n_estimators = 100, n_jobs = -1</i> , where the first is responsible for the number of trees in the forest and the second for the number of processor cores involved (with all cores involved, the default is 1).  Since we are working with this dataset and we have nowhere to take a test sample, we use <i>train_test_split</i> to ‚Äú <i>cleverly</i> ‚Äù split the data into a training sample and test.  <b>You can learn more about them by highlighting the class or method you are interested in and pressing Shift + Tab in the Jupyter environment.</b> <br></div></div><br>  <b>- Quite good accuracy.</b>  <b>Does that always happen?</b> <br><br>  For solving classification problems, an important factor is the selection of the best parameters for a training sample of categories.  The bigger, the better.  But not always (you can also read about this in more detail on the Internet, however, most likely, I will write about this one more article designed for beginners). <br><br>  <b>- Too easy.</b>  <b>More meat!</b> <br><br>  For a visual viewing of the learning result on this dataset, you can give an example: leaving only two parameters to set them in two-dimensional space, we construct a graph of the trained sample (we get something like this, it depends on the learning): <br><div style="text-align:center;"><img src="https://habrastorage.org/files/673/bb7/443/673bb74435c2403f8dabe184ffeacfb8.png" alt="image"></div><br>  Yes, with a decrease in the number of signs, the accuracy of recognition also decreases.  And the graph turned out to be not particularly beautiful, but it is not decisive in a simple analysis: it is quite clearly seen how the machine selected the training sample (points) and compared it with the predicted (fill) values. <br><br><div class="spoiler">  <b class="spoiler_title">Implementation here</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.preprocessing <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scale X_train_draw = scale(X_train[::, <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>]) X_test_draw = scale(X_test[::, <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>]) clf = RandomForestClassifier(n_estimators=<span class="hljs-number"><span class="hljs-number">100</span></span>, n_jobs=<span class="hljs-number"><span class="hljs-number">-1</span></span>) clf.fit(X_train_draw, y_train) x_min, x_max = X_train_draw[:, <span class="hljs-number"><span class="hljs-number">0</span></span>].min() - <span class="hljs-number"><span class="hljs-number">1</span></span>, X_train_draw[:, <span class="hljs-number"><span class="hljs-number">0</span></span>].max() + <span class="hljs-number"><span class="hljs-number">1</span></span> y_min, y_max = X_train_draw[:, <span class="hljs-number"><span class="hljs-number">1</span></span>].min() - <span class="hljs-number"><span class="hljs-number">1</span></span>, X_train_draw[:, <span class="hljs-number"><span class="hljs-number">1</span></span>].max() + <span class="hljs-number"><span class="hljs-number">1</span></span> h = <span class="hljs-number"><span class="hljs-number">0.02</span></span> xx, yy = np.meshgrid(np.arange(x_min, x_max, h), np.arange(y_min, y_max, h)) pred = clf.predict(np.c_[xx.ravel(), yy.ravel()]) pred = pred.reshape(xx.shape) <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> matplotlib.colors <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ListedColormap cmap_light = ListedColormap([<span class="hljs-string"><span class="hljs-string">'#FFAAAA'</span></span>, <span class="hljs-string"><span class="hljs-string">'#AAFFAA'</span></span>, <span class="hljs-string"><span class="hljs-string">'#AAAAFF'</span></span>]) cmap_bold = ListedColormap([<span class="hljs-string"><span class="hljs-string">'#FF0000'</span></span>, <span class="hljs-string"><span class="hljs-string">'#00FF00'</span></span>, <span class="hljs-string"><span class="hljs-string">'#0000FF'</span></span>]) plt.figure() plt.pcolormesh(xx, yy, pred, cmap=cmap_light) plt.scatter(X_train_draw[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], X_train_draw[:, <span class="hljs-number"><span class="hljs-number">1</span></span>], c=y_train, cmap=cmap_bold) plt.xlim(xx.min(), xx.max()) plt.ylim(yy.min(), yy.max()) plt.title(<span class="hljs-string"><span class="hljs-string">"Score: %.0f percents"</span></span> % (clf.score(X_test_draw, y_test) * <span class="hljs-number"><span class="hljs-number">100</span></span>)) plt.show()</code> </pre> <br></div></div><br>  I suggest the reader to find out for himself why and how he works. <br><br><h2>  The last word </h2><br>  I hope this article has helped you get a little comfortable in developing simple machine learning in Python.  This knowledge will be enough to continue an intensive course on further studying BigData + Machine Learning.  The main thing is to move from simple to in-depth gradually.  But useful resources and articles, as promised: <br><br><h2>  Materials that inspired the author to create this article </h2><br>  Historical essays: <br><br><ul><li>  <a href="http://www.computerworld.ru/articles/Istoriya-glubinnogo-mashinnogo-obucheniya">An article about why machine learning is needed today, and what led to this</a> </li><li>  <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B0%25D1%2588%25D0%25B8%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25BE%25D0%25B1%25D1%2583%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">Oddly enough, rather intricate article from Wikipedia about machine learning in general</a> </li></ul><br>  More about machine learning: <br><br><ul><li>  <a href="https://events.yandex.ru/lib/talks/3256/">Pro machine learning and data science</a> </li><li>  <a href="https://events.yandex.ru/lib/talks/1423/">Another interesting lecture from the same host</a> </li></ul><br>  We study python, or <b>to work</b> with data: <br><br><ul><li>  <a href="https://stepik.org/course/%25D0%259F%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5-%25D0%25BD%25D0%25B0-Python-67">Very useful course from talented teachers from ITMO and SPbAU</a> </li><li>  <a href="https://pythonworld.ru/">An excellent Russian-language resource for learners of Python, but poorly oriented to English-speaking resources.</a> </li></ul><br>  However, knowledge of English will be useful for the best mastering of the sklearn library: <a href="http://scikit-learn.org/stable/modules/classes.html">this source</a> contains all the necessary knowledge (since this is API reference). <br><br>  A more in-depth study of the use of machine learning with Python has become possible, and simpler thanks to teachers from Yandex - <a href="https://www.coursera.org/learn/vvedenie-mashinnoe-obuchenie/">this course</a> has all the necessary means of explaining how the whole system works, describes more about the types of machine learning, and so on. <br>  The file of today's dataset was taken <a href="https://archive.ics.uci.edu/ml/machine-learning-databases/wine/">from here</a> and somewhat modified. <br><br>  Where to get data, or "dataset storage" - <a href="https://www.kaggle.com/datasets">here a</a> huge amount of data from a variety of sources <a href="https://www.kaggle.com/datasets">is</a> collected.  It is very useful to train on real data. <br><br>  I would be grateful for the support to improve this article, as well as I am ready for any kind of constructive criticism. </div><p>Source: <a href="https://habr.com/ru/post/319288/">https://habr.com/ru/post/319288/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../319278/index.html">2016: a year of radical change for the CUBA platform</a></li>
<li><a href="../319280/index.html">Layout online store: list of goods</a></li>
<li><a href="../319282/index.html">Tail recursion optimization in Java</a></li>
<li><a href="../319284/index.html">How to attract a million users to the Bitcoin marketplace</a></li>
<li><a href="../319286/index.html">Virtualization with Ubuntu Server 16.04 and pHpVirtualBox 5.0.5</a></li>
<li><a href="../319290/index.html">The introduction of social services in non-game application</a></li>
<li><a href="../319294/index.html">Why did Tesla lure away the Swift language creator from Apple</a></li>
<li><a href="../319296/index.html">The structure of the project folder designer</a></li>
<li><a href="../319298/index.html">Draw commits on Github</a></li>
<li><a href="../319300/index.html">Economy of ideas. Composable infrastructure. HPE Synergy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>