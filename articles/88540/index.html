<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SSH authentication using eToken Pro USB dongle</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this post I will tell you how to configure SSH authentication using the eToken USB key. 



 For this we need: 

 - Actually USB key eToken Pro (in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SSH authentication using eToken Pro USB dongle</h1><div class="post__text post__text-html js-mediator-article"> In this post I will tell you how to configure SSH authentication using the eToken USB key. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/738/f3a/958/738f3a9587037b31936b1795bba784ef.jpg" alt="image"><br><a name="habracut"></a><br>  For this we need: <br><br>  - Actually USB key eToken Pro (in my case, this eToken Pro 64k) <br>  - Windows operating system with <a href="http://www.aladdin.ru/support/download/category177">eToken PKI Client</a> drivers installed <br>  - Mozilla Firefox with the <a href="https://addons.mozilla.org/ru/firefox/addon/4471">Key Manager</a> plugin installed <br>  - SSH client with smart card support.  I personally like <a href="http://www.joebar.ch/puttysc/">PuTTY SC</a> - a modified version of PuTTY. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It is assumed that you already have an initialized USB key with a pin code installed, it is connected to the computer and is ready for operation. <br><br>  <b>Create public / private key.</b> <br><br>  1) Launch Firefox and open Key Manager (Tools -&gt; Key Manager Tool Box -&gt; Key Manager) <br><br><img src="https://habrastorage.org/storage/habraeffect/92/41/92410ec45c32653e3598f9f5bedd4b85.jpg" alt="image"><br><br>  2) Enter the user password for eToken <br><br><img src="https://habrastorage.org/storage/habraeffect/52/68/526838522e0ce377b6fe4e3f1e4d06cb.jpg" alt="image"><br><br>  3) In the main Key Manager menu, select ‚ÄúGenerate Self-Signed Cert‚Äù <br><br><img src="https://habrastorage.org/storage/habraeffect/0c/b5/0cb5135919f4bb2ff56390e19d165d66.jpg" alt="image"><br><br>  4) Fill in the fields as shown in the picture and click on ‚ÄúGenerate Self-Signed Cert‚Äù.  Naturally, you need to enter your data, such as city, country, and fqdn server.  Optionally, you can specify additional properties of the certificate - expiration date, etc. <br><br><img src="https://habrastorage.org/storage/habraeffect/85/3f/853f66573ce0759e066fcfadb23ba5fc.jpg" alt="image"><br><br>  5) Select the desired token from the list and click "OK".  Please note that if you generate a certificate immediately on a token, then it will be impossible to export the <b>private</b> key. <br><br><img src="https://habrastorage.org/storage/habraeffect/b4/70/b4706091e1bbe8da47f8022cf4f3caad.jpg" alt="image"><br><br>  6) In the Key Manager main menu, highlight the newly created certificate, and click the ‚ÄúExport‚Äù button <br><br><img src="https://habrastorage.org/storage/habraeffect/59/79/59793274deb27fc4c458840bc6c040e9.jpg" alt="image"><br><br>  7) In the window that appears, select the format "OpenSSH Pubkey" and click "OK" <br><br><img src="https://habrastorage.org/storage/habraeffect/b6/2b/b62b75dc4ab7c06bca1a11c7a68f979d.jpg" alt="image"><br><br>  As a result, we get a line like the one below.  This is our public key - save it, we will need it in the next step. <br><br> <code>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAgQDL9ViU3+/80xZka0G91eoDyNuPT4eb1/8ro0iZEBnRI7+B+LwJbWrvqfJxNQluMiGPhftBCao4VjCcby21g0q+1sp42MR1bPD8BgA42ZDuum/sq5gFEM16n+g8+bXxtoZ/kF2bPJ4fGsowmdQCc8I7xECcYazz2AG8oZqU9l0anw== <br></code> <br><br>  <b>Setting up key authentication on the server.</b> <br><br>  In my case, the server with the installed Debian Lenny acts as a server. <br><br>  You need to make sure that the <b>sshd</b> configuration allows authentication using public keys.  To do this, in the file <b>‚Äússhd_config‚Äù</b> specify the value of the <b>‚ÄúPubkeyAuthentication‚Äù</b> parameter in <b>‚Äúyes‚Äù</b> . <br><br>  Then in the file <b>"~ / .ssh / authorized_keys" we</b> add our public key obtained earlier (in one line).  Please note that the <b>".ssh / authorized_keys"</b> file is located in the home directory of the user who will then log in using the public key. <br><br>  <b>Configure PuTTY SC SSH Client to use smart cards.</b> <br><br>  PuTTY SC is a modified version of PuTTY.  The only significant difference from the original version is support for smart cards. <br><br>  The setting in this case is almost the same as normal connections - you need to specify the server address, connection type, keyboard type, encoding. <br><br>  To use authentication with a smart card, go to the <b>"Connection -&gt; SSH -&gt; Pkcs11" section</b> , tick the <b>"Attempt PKCS # 11 smartcard auth (SSH-2)"</b> checkbox, specify the path to the eToken library - <b>"C: \ Windows \ System32 \ eToken.dll ‚Äù</b> , select from the list the name of the token and the private key that we created earlier. <br><br><img src="https://habrastorage.org/storage/habraeffect/b3/30/b330b114935d0d655757a70c6674349a.jpg" alt="image"><br><br>  When connected, you will be asked to enter a custom pin code to the USB key. <br><br><img src="https://habrastorage.org/storage/habraeffect/e1/97/e197e83aa9f6fbaf131eed84d18c04f2.jpg" alt="image"><br><br>  Congratulations, you can now use SSH authentication with eToken Pro! <br><br>  <i>Note: undoubtedly, you can generate keys in various ways using different software and different operating systems.</i>  <i>A bunch of Windows + Firefox was chosen as the most simple and clear.</i> <br><br>  <i>Another note: to taste, you can disable other authentication methods on the server, leaving only the authentication by key.</i> </div><p>Source: <a href="https://habr.com/ru/post/88540/">https://habr.com/ru/post/88540/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../88531/index.html">Google stopped filtering Chinese search results</a></li>
<li><a href="../88533/index.html">Hello, Umbraco!</a></li>
<li><a href="../88535/index.html">Results TopCoder High School 2010</a></li>
<li><a href="../88536/index.html">Which Java application servers do you use in your projects?</a></li>
<li><a href="../88537/index.html">Why take loans profitable?</a></li>
<li><a href="../88541/index.html">How to screw a light bulb?</a></li>
<li><a href="../88543/index.html">Masterpieces of domestic modding</a></li>
<li><a href="../88544/index.html">Microsoft vs. Apple - it all started much earlier ...</a></li>
<li><a href="../88545/index.html">Xname.org vulnerability</a></li>
<li><a href="../88547/index.html">FunkyPost.com: Social Mail</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>