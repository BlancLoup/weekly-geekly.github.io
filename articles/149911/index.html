<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Optimization of the algorithm for checking the Delaunay condition through the equation of the circumscribed circle and its application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I'll tell you a secret about how quickly to check the fulfillment of the Delone condition for two triangles. 
 Actually, the optimization itself is de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Optimization of the algorithm for checking the Delaunay condition through the equation of the circumscribed circle and its application</h1><div class="post__text post__text-html js-mediator-article">  I'll tell you a secret about how quickly to check the fulfillment of the Delone condition for two triangles. <br>  Actually, the optimization itself is described a little lower (see ‚ÄúOptimization of the algorithm for checking the Delaunay condition through the equation of the circumcircle‚Äù), but I will tell everything in order. <br><br>  In my case, triangulation is used in image tracing, to split a plane into primitive sectors (triangles).  As you know, it is also divided into several stages: adjustment, identification of boundaries, detouring of borders, sweeping of contours.  This is in its most general form.  I would like to stop, I think, at the most difficult stage: sweeping up the plane. <br><a name="habracut"></a><br><h5>  At the entrance </h5><br>  After detecting and traversing the boundaries at the exit, I got a lot of external contours.  Each contacting contours have different colors.  Inside each such circuit there is also a known number of internal circuits. <br>  Thus, from the point of view of ‚Äúsweeping up the plane,‚Äù if we consider the outer contours separately, we have a set of points, each of which has one neighbor on the right and left.  Those.  all points are closed in a chain, there is not a single ‚Äúhanging‚Äù point, and there are at least 3 points in each chain (Figure 1). <br><br><img src="https://habrastorage.org/storage2/bcb/f21/897/bcbf2189784d2ea1f4a07fed7f4f9aa5.png"><br>  <b>Picture 1</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  What need to do </h5><br>  It is necessary to sweep the shape of triangles. <br><br><h5>  Search </h5><br>  After reading the book [1], I did not find a single (at least one) method of constructing the Delaunay triangulation at least in any way suitable to my case.  Search for other books did not.  Yes, and this was enough, she brought the thoughts of my head in order.  As a result, invented his "bicycle". <br><br><h5>  Algorithm </h5><br>  <b>1)</b> Suppose, to begin with, that in the figure under consideration there is only one sequence.  Then it all comes down to the consistent picking up of triangles.  Take any point and try to build a triangle with adjacent points.  If the triangle cannot be built (the line connecting these two points intersects with the already constructed ones or the line passes in the exclusion zone (Figure 2), move to the next point, let's say to the right. When the next triangle is found, put it in the list (Figure 3), the point from which it was built is deleted (Figure 4). <br><br><img src="https://habrastorage.org/storage2/5e2/220/57f/5e222057f2bd916dda1564bf385ed269.png"><br>  <b>Figure 2</b> <br><img src="https://habrastorage.org/storage2/1b3/943/ec5/1b3943ec564c4fc956a0b56187ce55d0.png"><br>  <b>Figure 3</b> <br><img src="https://habrastorage.org/storage2/633/789/688/6337896882b5ed23cd5c3793c16a1ad2.png"><br>  <b>Figure 4</b> <br><br>  One more thing: when saving the next triangle, it is necessary to record vertices in a roundabout in a clockwise direction (in the right coordinate system).  This is useful later to reduce computational resources. <br><br>  <b>2)</b> Repeat step 1 until we sweep the entire plane. <br><br>  <b>3)</b> If there are several sequences, i.e.  one, and inside it one more or more internal contours (Figure 1).  Here it is necessary to consider each sequence separately.  Take the next inner contour.  From one external and one internal we will make two single contours.  To do this, you need to find two "ports" from one circuit to another.  The condition for ‚Äúports‚Äù: they should not intersect each other (they should not even touch the ends), they should not intersect with the contour lines (Figure 5). <br><br><img src="https://habrastorage.org/storage2/5e2/220/57f/5e222057f2bd916dda1564bf385ed269.png"><br>  <b>Figure 5</b> <br><img src="https://habrastorage.org/storage2/96a/120/8f9/96a1208f99dc2a136a2ddf625be6251b.png"><br>  <b>Figure 6</b> <br>  <b>4)</b> Next, you should enter in turn all the internal sequences into already formed, separated from each other (paragraph 3) sequences.  You need to merge with the one that contains the new one.  By definition, no internal sequence touches or intersects with others (both external and all possible internal), so that everything goes smoothly. <br>  Having found the ports (Figure 6) it is easy to build new sequences and bypass them in points 1 and 2 of the current algorithm (Figure 7). <br><img src="https://habrastorage.org/storage2/fd8/a3d/a7c/fd8a3da7c23b43b067aac9e3bb59e48f.png"><br>  <b>Figure 7</b> <br><br>  <b>5)</b> After the 4th stage, we have a list of triangles (Figure 8).  As if the task had already been done, it remains to make the picture beautiful: check that the Delone condition is met (Figure 9). <br><img src="https://habrastorage.org/storage2/fca/166/41e/fca16641e31211a4281938d3acee49a8.png"><br>  <b>Figure 8</b> <br><img src="https://habrastorage.org/storage2/25b/71d/891/25b71d891538511a6c8c510a5aa0e366.png"><br>  <b>Figure 9</b> <br><br>  <b>6)</b> Looking ahead, I will tell you about the sixth paragraph.  It consists in a sequential run through the list of triangles obtained by item No. 5.  First we mark all triangles as ‚Äúdirty‚Äù.  In each cycle, we check for each triangle Delone condition.  If the condition is not met, then we do the rebuilding and mark the neighbors and the current triangle as ‚Äúdirty‚Äù.  If the condition is satisfied, then mark it clean.  In my implementation of the algorithm, each triangle has a link to its neighbors.  In this case, the 6th item is the fastest. <br><br><h5>  More on the fifth stage </h5><br>  Now, as far as I know, there are two possible ways to determine whether the triangles satisfy the Delone condition or not: 1) Check the sum of opposite corners.  It should be less than 180. 2) Calculate the center of the circumscribed circle and calculate the distance to the 4th point.  Everyone knows the Delone condition is satisfied if the point is outside the circumscribed circle. <br><br>  <b>Computational power number 1: 10 multiplication / division operations and 13 addition / subtraction operations.</b> <br>  <b>Computational power number 2: 29 multiplication / division operations and 24 addition / subtraction operations.</b> <br><br>  From the point of view of computing power, which is calculated for example in the book [1], option No. 1 is more advantageous.  I realized it if it were not for ... (Figure 10).  As it turned out after putting this method on the ‚Äúconveyor‚Äù, there was an uncertainty.  This is an option when the angle A itself is more than 180 degrees.  It is considered in the book [1] as one of the individual particular methods.  And with it all its elegance, transparency and performance disappears.  As well, it later turned out that method No. 2 can be very significantly optimized. <br><br><img src="https://habrastorage.org/storage2/7ed/cf5/941/7edcf594188d25d923df23e290fe6355.png"><br>  <b>Figure 10</b> <br><br><h4>  Optimization of the algorithm for checking the Delaunay condition through the equation of the circumscribed circle </h4><br>  Further pure mathematics. <br><br>  So we have: <br>  Checking the condition for the point M (X, Y) by the equation of a circle passing through the points A (x1, y1), B (x2, y2), C (x3, y3) can be written in the form: <br><br>  (a ‚ãÖ (X ^ 2 + Y ^ 2) - b ‚ãÖ X + c Y - d) ‚ãÖ sign a ‚â• 0 <br><br>  Details can be found in the magnificent book [1].  (No, I'm not its author) <br>  So, sign a is a sign of the direction of the walk, from the very beginning I built triangles clockwise, so it can be omitted (it is equal to one). <br><br>  Next, moving the center of coordinates to the point M, we get (Figure 11): <br><br>  A (x1 - X, y1 - Y), B (x2 - X, y2 - Y), B (x3 - X, y3 - Y); <br><br>  -d&gt; = 0 <br><img src="https://habrastorage.org/storage2/ba5/31d/8d3/ba531d8d3edc48ff864ac2d13c3ce19b.png"><br>  <b>Figure 11</b> <br><br>  Just isn't it? <br><br>  d &lt;= 0 <br><br>  According to the book, again, [1] <br><br><pre><code class="vala hljs">(x1^<span class="hljs-number"><span class="hljs-number">2</span></span> + y1^<span class="hljs-number"><span class="hljs-number">2</span></span>)*(y2*x3 - x2*y3) + (x2^<span class="hljs-number"><span class="hljs-number">2</span></span> + y2^<span class="hljs-number"><span class="hljs-number">2</span></span>)*(x1*y3 - y1*x3) + (x3^<span class="hljs-number"><span class="hljs-number">2</span></span> + y3^<span class="hljs-number"><span class="hljs-number">2</span></span>)*(y1*x2 - x1*y2) &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br><br>  <b>We have: 15 multiplication / division operations and 14 addition / subtraction operations.</b> <br><br>  Thanks for attention.  Waiting for critics. <br><br><h5>  Bibliography </h5><br>  1. Skvortsov A.V.  Delaunay triangulation and its application.  - Tomsk: Publishing house Tom.  University, 2002. - 128 p.  ISBN 5-7511-1501-5 </div><p>Source: <a href="https://habr.com/ru/post/149911/">https://habr.com/ru/post/149911/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../149904/index.html">The solution to the Friday issue</a></li>
<li><a href="../149905/index.html">Oracle tightens the screws</a></li>
<li><a href="../149907/index.html">Overview of MyDLP Open Data Control System</a></li>
<li><a href="../149908/index.html">Smartphones with Intel processors will appear in Russia soon</a></li>
<li><a href="../149909/index.html">Stream animation rendering in Qt Quick 2.0</a></li>
<li><a href="../149912/index.html">Auto dependency injection in javascript</a></li>
<li><a href="../149913/index.html">Maemo-MeeGo story</a></li>
<li><a href="../149914/index.html">Turn the Raspberry Pi into a retro gaming console</a></li>
<li><a href="../149915/index.html">State services. Registration of SP or all is not so transparent</a></li>
<li><a href="../149916/index.html">How to make Time Machine back up to a network drive</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>