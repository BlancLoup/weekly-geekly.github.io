<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Practical training in pentest laboratories. Part 5</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúCorporate laboratories‚Äù is a training program in the field of information security, consisting of theoretical (webinar courses) and practical trainin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Practical training in pentest laboratories. Part 5</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/7f6/76d/c60/7f676dc601544bdca2476be7cfe69888.png"><br><br>  <a href="https://www.pentestit.ru/labs/corp-lab">‚ÄúCorporate laboratories‚Äù</a> is a training program in the field of information security, consisting of theoretical (webinar courses) and practical training (work in pentest laboratories).  This article will consider the content of the practical base, which constitutes about 80% of the total training program.  The article contains a brief analysis of one of the tasks of practical training. <a name="habracut"></a><br><br>  Ideal impenetrable protection is almost impossible to build, so you need to be prepared for the fact that in theory a compromise can occur.  At the same time, with a correctly constructed scheme and worked-out response processes, it is often possible to minimize damage. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To ensure an adequate level of security infrastructure requires constant monitoring of its components.  For these purposes, it is necessary to conduct an audit of system security, study logs and event logs, and obtain data from other monitoring sources. <br><br>  Such information allows you to improve protection and upgrade response processes, using data from the incident that occurred.  System security audit allows you to: <br><br><ul><li>  Find out who committed a specific action in the system, identify the possible person involved; </li><li>  Set the date of the action; </li><li>  Identify the resources affected during the compromise process; </li><li>  Find out whether there is a fault of a particular person, or it is a system (software) error; </li><li>  To develop measures for the recovery and prevention of the incident in the future; </li><li>  Assess the risks. </li></ul><cut><br><h2>  Event logging </h2><br>  First of all, it is necessary to use the standard means of the system;  security log.  The security log contains events such as successful and unsuccessful login attempts, as well as events related to the use of resources, such as the creation, opening, and deletion of files and other objects.  Administrators can select events to be logged in the security log.  For example, if logon auditing is enabled, all logon attempts are recorded in the security log. <br><br><img src="https://habrastorage.org/files/1fa/390/897/1fa39089727a47bca900c4023f966f76.PNG"><br><br>  The main parameters of the records: <br><ul><li>  Audit logins; </li><li>  Audit changes to important system objects: files, folders; </li><li>  Audit of the use of administrator rights on the machine. </li></ul><br>  These values ‚Äã‚Äãare configured in local group policies, in the configuration of the advanced audit policy.  It should be noted the important fact that by default these policies are turned off.  This is due to some factors: <br><ul><li>  There is a huge number of events (difficult to process and analyze); </li><li>  Difficult separation of user actions from system actions and programs. </li><li>  The default log size is insufficient (20 MB). </li></ul><br>  In * nix systems there is a utility <a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security_Guide/chap-system_auditing.html">auditd</a> . <br><br><img src="https://habrastorage.org/files/ef5/8ad/677/ef58ad6775e54fd3b074f228dbcc9827.PNG"><br><br>  Starting with version 2.6, the Linux kernel includes a subsystem specifically designed for auditing, allowing you to track system events such as: <br><ul><li>  Starting and shutting down the system (reboot, stop); </li><li>  Reading / writing or changing file permissions; </li><li>  Initiate a network connection or change network settings; </li><li>  Changing information about a user or group; </li><li>  Change date and time; </li><li>  Start and stop applications; </li><li>  Make system calls. </li></ul><br><h2>  How it works </h2><br>  No event in any operating system can occur without the use of kernel system calls.  Starting a new process, opening files and working with them, requesting a time or type of OS, accessing equipment, creating a network connection, displaying information on the screen - all these operations are performed using access to the functions of the operating system kernel for brevity called system calls.  If an application does not resort to kernel calls in its work, it turns out to be closed in itself and is simply not capable of any interaction with its environment, let alone a user.  Consequently, in order to track any system event, it is sufficient to simply intercept all calls to system calls. <br><br>  This is exactly what the audit subsystem does.  It sets the ‚Äúbefore‚Äù and ‚Äúafter‚Äù triggers of all functions responsible for handling system calls, and waits.  When a system call occurs, the trigger fires, the audit subsystem receives all the information about the call and its context, passes it to the auditd daemon and gives further control to the function that processes the system call.  After its completion, the "output" trigger is triggered, and all information about the system call is returned to the audit subsystem and the auditd daemon. <br><br>  Naturally, keeping all these triggers active for the entire operating time of the OS is expensive and too redundant (only during the start, the application can make several thousand system calls and it will take a lot of time to fully analyze the audit log).  Therefore, by default, triggers are disabled and can be selectively activated using rules that specify the name of the system call, the status of the run, the user on whose behalf the call occurred, etc. <br><br><h2>  Log analysis </h2><br>  The logical development of journaling systems are IDS (intrusion detection system), IPS (intrusion prevention system), SIEM (security infromation and event management) systems.  They allow in a more convenient way to interpret events in the system and reduce the burden on IT staff.  They contain certain sets of patterns of system behavior and components for detecting attacks.  Those.  in essence, they collect a certain range of events by which they can judge the presence of a particular type of attack / incident.  They can provide information both in real time and by analyzing some events (in this case, the reaction to the anomaly may be delayed).  These systems collect data from several sources, which are divided into the following types: <br><ul><li>  Network; </li><li>  Protocol based; </li><li>  Based on application protocol; </li><li>  Nodal; </li><li>  Hybrid. </li></ul><br>  These systems can contain collection agents, as well as modules for working with various protocols and devices.  In today's reality, a bundle of several systems is usually used to increase the level of protection and prompt response to incidents: <a href="https://defcon.ru/network-security/484/">securing the network perimeter using Snort, OSSEC and Prelude SIEM</a> . <br><br><h2>  Integrity </h2><br>  The issue of trust coming from data audit logs or from specialized systems is particularly high in those systems that have been compromised.  Many people forget about the fact that the log files are not protected.  They can easily be changed, changed or destroyed by gaining access to the machine on which they are located.  In theory, after the system has been compromised, the data on it, including the log files, cannot be trusted.  There is no guarantee that they are not intentionally altered by attackers. <br><br>  To have reliable data for analysis, you can use a centralized event log storage scheme.  It is desirable for a centralized repository to have a separate server on which nothing but the event reception service will be installed and running.  Such a service should only be able to receive events, and its functionality should not initially contain functions for changing and deleting data. <br><br>  After receiving events in the repository, you can take an additional step - backup.  You can also think about assigning checksums to backup files and storing them in a different place (or sending them immediately to a special mailbox).  There are many options for such a scheme; its use significantly increases the degree of confidence in the event logs. <br><br>  Using incident logging and response systems gives IT staff the opportunity to prevent most modern infrastructure attacks and protect the critical data of their systems. <br><br><hr><br>  <a href="http://habrahabr.ru/company/pentestit/blog/266349/">Practical training in pentest laboratories.</a>  <a href="http://habrahabr.ru/company/pentestit/blog/266349/">Part 1</a> <br>  <a href="http://habrahabr.ru/company/pentestit/blog/266945/">Practical training in pentest laboratories.</a>  <a href="http://habrahabr.ru/company/pentestit/blog/266945/">Part 2</a> <br>  <a href="http://habrahabr.ru/company/pentestit/blog/267423/">Practical training in pentest laboratories.</a>  <a href="http://habrahabr.ru/company/pentestit/blog/267423/">Part 3</a> <br>  <a href="http://habrahabr.ru/company/pentestit/blog/267949/">Practical training in pentest laboratories.</a>  <a href="http://habrahabr.ru/company/pentestit/blog/267949/">Part 4</a> </cut></div><p>Source: <a href="https://habr.com/ru/post/268843/">https://habr.com/ru/post/268843/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../268829/index.html">Microsoft fixed Windows kernel vulnerabilities</a></li>
<li><a href="../26883/index.html">"Domain Wars." Episode Two.</a></li>
<li><a href="../268833/index.html">Restoring the window size upon restart, a lot of fixes in Vivaldi 1.0.298.15. Plus movie</a></li>
<li><a href="../268837/index.html">Visual Studio Code - the evolution of the cross-platform code editor on the example of the version for OS X</a></li>
<li><a href="../268841/index.html">The mystery of the finalizers in Go</a></li>
<li><a href="../268845/index.html">Why do I need a free code and how to earn on it</a></li>
<li><a href="../268847/index.html">‚ÄúTo become a good systems analyst, you need 5‚Äì10 years of experience‚Äù - an interview with Alexey Shipilev from the Java Performance Team</a></li>
<li><a href="../268849/index.html">Rust hit the TIOBE index</a></li>
<li><a href="../268851/index.html">Using readable and writable images in OpenCL 2.0</a></li>
<li><a href="../268853/index.html">Office as Platform Release 7 - Manage Office 365 and SharePoint Online via PowerShell</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>