<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Classic cryptanalysis</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For centuries, people invented ingenious ways of hiding information - ciphers, while other people came up with even more ingenious ways of opening inf...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Classic cryptanalysis</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/874/297/837/874297837e136c27d2d8455ef7dbb59c.jpg" alt="image"></div><br>  For centuries, people invented ingenious ways of hiding information - ciphers, while other people came up with even more ingenious ways of opening information - methods of hacking. <br><br>  In this topic, I want to briefly go through the most well-known classical encryption methods and describe the hacking technique of each of them. <br><a name="habracut"></a><br><h4>  Caesar cipher </h4><br>  The easiest and one of the most famous classical ciphers - Caesar's cipher is perfect for the role of an aperitif. <br>  The Caesar cipher refers to the group of the so-called one-alphabetic substitution ciphers.  When using ciphers of this group, ‚Äúeach character of the plaintext is replaced with some symbol of the same alphabet, fixed with this key‚Äù <a href="https://ru.wikipedia.org/wiki/%25D0%25A8%25D0%25B8%25D1%2584%25D1%2580_%25D0%25BF%25D0%25BE%25D0%25B4%25D1%2581%25D1%2582%25D0%25B0%25D0%25BD%25D0%25BE%25D0%25B2%25D0%25BA%25D0%25B8">wiki</a> . <br><br>  Ways to select keys may be different.  In Caesar's cipher, the key is an arbitrary number k, selected in the range from 1 to 25. Each letter of the plaintext is replaced by a letter standing k characters farther than it in the alphabet.  For example, let the key be the number 3. Then the letter A of the English alphabet will be replaced with the letter D, the letter B with the letter E and so on. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For clarity, we encrypt the word HABRAHABR with the Caesar cipher with the key k = 7.  Build a lookup table: <br><table><tbody><tr><td>  a </td><td>  b </td><td>  c </td><td>  d </td><td>  e </td><td>  f </td><td>  g </td><td>  h </td><td>  i </td><td>  j </td><td>  k </td><td>  l </td><td>  m </td><td>  n </td><td>  o </td><td>  p </td><td>  q </td><td>  r </td><td>  s </td><td>  t </td><td>  u </td><td>  v </td><td>  w </td><td>  x </td><td>  y </td><td>  z </td></tr><tr><td>  h </td><td>  i </td><td>  j </td><td>  k </td><td>  l </td><td>  m </td><td>  n </td><td>  o </td><td>  p </td><td>  q </td><td>  r </td><td>  s </td><td>  t </td><td>  u </td><td>  v </td><td>  w </td><td>  x </td><td>  y </td><td>  z </td><td>  a </td><td>  b </td><td>  c </td><td>  d </td><td>  e </td><td>  f </td><td>  g </td></tr></tbody></table><br>  And replacing each letter in the text we get: C ('HABRAHABR', 7) = 'OHIYHOHIY'. <br><br>  When deciphering each letter is replaced by a letter, standing in the alphabet for k characters earlier: D ('OHIYHOHIY', 7) = 'HABRAHABR'. <br><br>  <b>Caesar's Crypt Analysis Cipher</b> <br><br>  The small space of keys (only 25 options) makes brute-force the most effective and simple attack option. <br>  For opening it is necessary to replace each letter of the ciphertext with a letter standing one character to the left in the alphabet.  If, as a result, it was not possible to get a readable message, then it is necessary to repeat the action, but already shifting the letters two characters to the left.  And so on, until the result is readable text. <br><br><h4>  Affiliate Cipher </h4><br>  Consider a slightly more interesting one-alphabetic substitution cipher called an affine cipher.  It also implements a simple substitution, but provides a slightly larger key space compared to Caesar‚Äôs cipher.  In the affine cipher, each letter of the alphabet of size <i>m</i> is assigned a number from the range 0 ... <i>m</i> -1.  Then, using a special formula, a new number is calculated, which will replace the old one in the ciphertext. <br><br>  The encryption process can be described by the following formula: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e8c/2f0/ba9/e8c2f0ba9267e12c8430912fb03e7c28.png" alt="image">  , <br><br>  where <i>x</i> is the number of the letter to be encrypted in the alphabet;  <i>m</i> is the size of the alphabet;  <i>a, b</i> - encryption key. <br><br>  For decryption, another function is calculated: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ff6/f8e/4b6/ff6f8e4b6d42d33c160d1850836b2013.png" alt="image">  , <br><br>  where <i>a <sup>-1</sup></i> is the reciprocal of <i>a</i> modulo <i>m</i> .  This means that for correct decryption, the number <i>a</i> must be mutually simple with <i>m</i> . <br><br>  Given this limitation, we calculate the key space of an affine cipher using the example of the English alphabet.  Since the English alphabet contains 26 letters, then as <i>a</i> can only be chosen to be mutually prime with 26 number.  There are only twelve such numbers: 1, 3, 5, 7, 9, 11, 15, 17, 19, 21, 23 and 25. The number <i>b,</i> in turn, can take any value in the range from 0 to 25, which ultimately gives us 12 * 26 = 312 variants of possible keys. <br><br>  <b>Cryptanalysis affine cipher</b> <br><br>  Obviously, in the case of an affine cipher, the easiest way to break is to iterate over all possible keys.  But as a result of the search, there will be 312 different texts.  It is possible to analyze such a number of messages manually, but it is better to automate this process using such a characteristic as the <b>frequency of the appearance of letters</b> . <br><br>  It has long been known that letters in natural languages ‚Äã‚Äãare not evenly distributed.  For example, the frequency of occurrence of letters of the English language in the texts have the following meanings: <br><br> <a href=""><img src="https://habrastorage.org/files/653/308/bb9/653308bb9f8e4438a51491af40878890.PNG"></a> <br><br>  Those.  in the English text, the most common letters are E, T, A. While the rarest letters are J, Q, Z. Therefore, considering the frequency of each letter in the text, we can determine how much the frequency response of the text corresponds to English. <br><br>  To do this, calculate the value: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/938/a68/9bc/938a689bc7e25f7ef54120837687daa4.png" alt="image">  , <br><br>  where <i>n <sub>i</sub></i> is the frequency of the <i>i-</i> th letter of the alphabet in natural language.  And <i>f <sub>i</sub></i> - the frequency of the <i>i-</i> th letter in the ciphertext. <br><br>  The greater the value of œá, the greater the likelihood that the text is written in natural language. <br><br>  Thus, to break an affine cipher, it suffices to iterate over 312 possible keys and calculate the value of œá for the resulting text decryption.  The text for which the value of œá will be the maximum, with a high degree of probability, is an encrypted message. <br><br>  Of course, it should be borne in mind that the method does not always work with short messages, in which the frequency characteristics can be very different from the characteristics of a natural language. <br><br><h4>  Simple replacement cipher </h4><br>  The next cipher belonging to the group of single-alphabet substitution ciphers.  The cipher key is an arbitrarily mixed alphabet.  For example, the key may be the following sequence of letters: XFQABOLYWJGPMRVIHUSDZKNTEC. <br><br>  When encrypting each letter in the text is replaced by the following rule.  The first letter of the alphabet is replaced by the first letter of the key, the second letter of the alphabet is replaced by the second letter of the key, and so on.  In our example, the letter A will be replaced by X, the letter B by F. <br><br>  When decrypting, the letter is first searched for in the key and then replaced with the letter in the alphabet in the same position. <br><br>  <b>Simple replacement cryptanalysis</b> <br><br>  The simple replacement cipher key space is huge and equal to the number of permutations of the alphabet used.  So for the English language this number is 26!  = 2 <sup>88</sup> .  Of course, a naive enumeration of all possible keys is hopeless and a more sophisticated technique is needed for hacking, such as <b>searching for a climb to the top</b> : <br><br><ol><li>  A random sequence of letters is selected ‚Äî the primary key.  The ciphertext is decrypted using the primary key.  For the resulting text is calculated coefficient characterizing the probability of belonging to a natural language. </li><li>  The primary key undergoes slight changes (permutation of two randomly selected letters).  The decoding is performed and the coefficient of the received text is calculated. </li><li>  If the coefficient is higher than the stored value, then the primary key is replaced with the modified version. </li><li>  Steps 2-3 are repeated until the coefficient becomes constant. </li></ol><br>  To calculate the coefficient, one more characteristic of the natural language is used - the <b>frequency of occurrence of trigrams.</b> <br>  The closer the text to the English language, the more often it will meet such trigrams as THE, AND, ING.  Summarizing the frequency of occurrence in the natural language of all trigrams encountered in the text, we obtain the coefficient that most likely will determine the text written in natural language. <br><br><h4>  Polybius code </h4><br>  Another substitution cipher.  The cipher key is a 5 * 5 square (for English) containing all letters of the alphabet except J. <br><br><img src="https://habrastorage.org/files/33e/8c3/24a/33e8c324a5de4a018b7ab78245a5d86e.png"><br><br>  When encrypting, each letter of the source text is replaced by a pair of characters representing the line number and the column number in which the letter to be replaced is located.  The letter a will be substituted in the ciphertext with the pair BB, the letter b - with the pair EB and so on.  Since the key does not contain the letter J, before encrypting it in the source text, J should be replaced by I. <br><br>  For example, encrypt the word HABRAHABR.  C ('HABRAHABR') = 'AB BB EB DA BB AB BB EB DA'. <br><br>  <b>Cryptanalysis of Polybius cipher</b> <br><br>  The cipher has a large key space (25! = 2 <sup>83</sup> for English).  However, the only difference between the Polybius square and the previous cipher is that the letter of the source text is replaced by two characters. <br><br>  Therefore, for the attack, you can use the technique used when hacking a simple replacement cipher - search by climbing to the top. <br>  As the main key, a random square of 5 * 5 is selected.  During each iteration, the key is subject to minor changes and it is checked whether the distribution of trigrams in the text obtained as a result of the decryption corresponds to the distribution in natural language. <br><br><h4>  Swap cipher </h4><br>  In addition to substitution ciphers, permutation ciphers are also widely used.  As an example, we will describe the <b>vertical permutation cipher</b> . <br><br>  The encryption process records the message as a table.  The number of columns of the table is determined by the size of the key.  For example, encrypt the message WE ARE DISCOVERED.  FLEE AT ONCE using the key 632415. <br><br>  Since the key contains 6 digits, add the message to the length of a multiple of 6 randomly selected letters QKJEU and write the message in a table containing 6 columns, from left to right: <br><br><img src="https://habrastorage.org/files/f48/63d/46e/f4863d46ee69498eafb21e71a3635903.PNG"><br><br>  To obtain the ciphertext, we will write out each column from the table in the order determined by the key: EVLNE ACDTK ESEAQ ROFOJ DEECU WIREE. <br><br>  When decrypted, the text is written to the table in columns from top to bottom in the order determined by the key. <br><br>  <b>Cryptanalysis Permutation Cipher</b> <br><br>  The best way to attack a vertical permutation cipher will be a complete enumeration of all possible keys of small length (up to 9 inclusive - about 400,000 variants).  If the search did not give the desired results, you can use the search to climb to the top. <br><br>  For each possible length, a search for the most plausible key is performed.  To assess the likelihood, it is better to use the frequency of the appearance of trigrams.  As a result, a key is returned that provides the text of the decrypted message that is closest to the natural language. <br><br><h4>  Code Player </h4><br>  The Player's cipher is a wildcard cipher that implements the replacement of digrams.  For encryption, a key is needed, which is a table of letters 5 * 5 in size (without the letter J). <br><br>  The encryption process is reduced to finding the digram in the table and replacing it with a couple of letters that form a rectangle with the original digram. <br>  Consider, as an example, the following table forming the Playfer cipher key: <br><br><img src="https://habrastorage.org/files/aa0/efd/4a8/aa0efd4a8a2d49dc89741bce43c6dd18.PNG"><br><br>  Encrypt the pair 'wn'.  The letter W is located in the first row and first column.  And the letter N is in the second line and third column.  These letters form a rectangle with corners WESN.  Therefore, when encrypting, the WN digram is converted to the ES digram. <br>  In case letters are located in one line or column, the result of encryption is a digram located one position to the right / below.  For example, the NG bigram is converted to the GP digram. <br><br>  <b>Cryptanalysis of the Playfer cipher</b> <br><br>  Since the Player's cipher key is a table containing 25 letters of the English alphabet, it can be mistakenly assumed that the search method to climb to the top is the best way to break this cipher.  Unfortunately, this method will not work.  Reaching a certain level of text matching, the algorithm will get stuck at a local maximum point and will not be able to continue the search. <br>  To successfully crack the Playfer cipher, it is better to use <b>the annealing simulation algorithm</b> . <br><br>  The difference between the annealing imitation algorithm and the climb-to-top search lies in the fact that the latter, on the way to the correct solution, never accepts weaker options as a possible solution.  While the simulated annealing algorithm periodically rolls back to less likely solutions, which increases the chances of ultimate success. <br><br>  The essence of the algorithm is reduced to the following actions: <br><br><ol><li>  A random sequence of letters is chosen ‚Äî primary-key.  The ciphertext is decrypted using the primary key.  For the resulting text is calculated coefficient characterizing the probability of belonging to a natural language. </li><li>  The primary key undergoes minor changes (permutation of two randomly selected letters, permutation of columns or rows).  The decoding is performed and the coefficient of the received text is calculated. </li><li>  If the coefficient is higher than the stored value, then the primary key is replaced with the modified version. </li><li>  Otherwise, the replacement of the primary key with the modified one occurs with a probability that is directly dependent on the difference in the coefficients of the primary and modified keys. </li><li>  Steps 2-4 are repeated about 50,000 times. </li></ol><br>  The algorithm periodically replaces the main key, the key with the worst characteristics.  Moreover, the probability of replacement depends on the difference in characteristics, which prevents the algorithm from accepting bad options too often. <br><br>  To calculate the coefficients that determine the text to belong to the natural language, it is best to use the frequency of the appearance of trigrams. <br><br><h4>  Vigenera cipher </h4><br>  Vigenera cipher belongs to the group of poly-alphabetic substitution ciphers.  This means that, depending on the key, the same letter of the plaintext can be encrypted into different characters.  This encryption technique hides all the frequency characteristics of the text and makes it difficult to cryptanalysis. <br><br>  The Vigenere cipher is a sequence of several Caesar ciphers with different keys. <br><br>  Let us demonstrate, as an example, the encryption of the word HABRAHABR using the key 123. We write down the key under the source text, repeating it the required number of times: <br><br><img src="https://habrastorage.org/files/f06/9b2/688/f069b2688155421ea10b501e920f6df8.PNG"><br><br>  Key numbers determine how many positions you need to move a letter in the alphabet to get a ciphertext.  The letter H must be shifted by one position - the result is the letter I, the letter A by 2 positions - the letter C, and so on.  Having made all the substitutions, we get the result of the ciphertext: ICESCKBDU. <br><br>  <b>Cryptanalysis of the Vigenere cipher</b> <br><br>  The first task in cryptoanalysis of Vigener's cipher is to find the length used for encryption, the key. <br><br>  To do this, you can use the <b>index of matches.</b> <br><br>  The coincidence index is a number characterizing the probability that two arbitrarily selected letters from the text will be the same. <br>  For any text, the coincidence index is calculated by the formula: <br><br><img src="https://habrastorage.org/files/9c4/bbf/4d2/9c4bbf4d288c41efa0a1ca1bc3aebe67.PNG">  , <br><br>  where <i>f <sub>i</sub></i> is the number of occurrences of the i-th letter of the alphabet in the text, and <i>n</i> is the number of letters in the text. <br><br>  For English, the coincidence index is 0.0667, while for a random set of letters, this figure is 0.038. <br>  Moreover, for a text encrypted using a single alphabetic substitution, the coincidence index is also equal to 0.0667.  This is explained by the fact that the number of different letters in the text remains unchanged. <br><br>  This property is used to find the length of the Vigenere cipher key.  From the ciphertext, every second letter is selected in turn, and the index of matches is considered for the received text.  If the result roughly corresponds to the coincidence index of a natural language, then the key length is equal to two.  Otherwise, every third letter is selected from the ciphertext and again the coincidence index is considered.  The process is repeated until the high value of the index of matches indicates the key length. <br><br>  The success of the method is explained by the fact that if the key length is guessed correctly, the selected letters form a ciphertext encrypted with a simple Caesar cipher.  And the index of matches should be approximately the same as the index of matches of a natural language. <br>  After the key length is found, the hack comes down to opening several Caesar ciphers.  To do this, you can use the method described in the first section of this topic. <br><br><h4>  PS </h4><br>  The sources of all the above ciphers and attacks on them can be viewed on <a href="https://github.com/NeverWalkAloner/Classical-Cryptanalysis">GitHub</a> . <br><br><h4>  Links </h4><br>  1. Cryptanalysis of classical ciphers at <a href="http://practicalcryptography.com/cryptanalysis/">practicalcryptography.com</a> . <br>  2. Frequency characteristics of English on the website <a href="http://practicalcryptography.com/cryptanalysis/letter-frequencies-various-languages/english-letter-frequencies/">practicalcryptography.com</a> <br>  3. Description of the algorithm for simulating annealing on <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25BB%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D1%2582%25D0%25BC_%25D0%25B8%25D0%25BC%25D0%25B8%25D1%2582%25D0%25B0%25D1%2586%25D0%25B8%25D0%25B8_%25D0%25BE%25D1%2582%25D0%25B6%25D0%25B8%25D0%25B3%25D0%25B0">wikipedia</a> <br>  4. Description of the search by climbing to the top on <a href="https://en.wikipedia.org/wiki/Hill_climbing">wikipedia</a> </div><p>Source: <a href="https://habr.com/ru/post/271257/">https://habr.com/ru/post/271257/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../271241/index.html">Forecasting in the gaming industry. Part 3: Forecasts for the forecast industry</a></li>
<li><a href="../271243/index.html">ActiveRecord-based Ruby REST API for accessing tables in a database</a></li>
<li><a href="../271245/index.html">Risks and problems of password hashing</a></li>
<li><a href="../271249/index.html">Modular ASP.NET 5 Application</a></li>
<li><a href="../271255/index.html">Objective-C: how blocks work</a></li>
<li><a href="../271259/index.html">Two-factor authentication of Cisco AnyConnect clients. FreeRadius and Google Authenticator</a></li>
<li><a href="../271261/index.html">PBX in your pocket: set up IP telephony for remote work</a></li>
<li><a href="../271265/index.html">swirl: the rapid immersion in R (learning by doing)</a></li>
<li><a href="../271269/index.html">Gradle: 5 Utility for the Developer</a></li>
<li><a href="../271271/index.html">What else affects the infrastructure: How to ensure the quality of equipment installation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>