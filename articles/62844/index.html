<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Web Tricks: Forced Static Refresh</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Given 

 There is a website you manage and you have full access to its file structure. For some reason, this site is not indifferent to you: perhaps i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Web Tricks: Forced Static Refresh</h1><div class="post__text post__text-html js-mediator-article"> <b>Given</b> <br><br>  There is a website you manage and you have full access to its file structure.  For some reason, this site is not indifferent to you: perhaps it is a reflection of your alter ego, or serves as a platform for political statements, or just stupidly generates you money for beer.  Anyway, from time to time you feel the need to sit at the computer and bring another improvement to the work of the site, be it a convenient widget, a set of cool icons or a useful plugin. <br><br>  <b>Situation</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      You have just radically reworked the page template (aligned jigsaws, changed colors, registered background images).  It turned out really cool!  It's time to upload changes to the server.  You launch an FTP client, drag gifs and css from the left panel to the right and, all so pleased, open the website in your favorite browser ... <br><br><a name="habracut"></a><br>  "MOTHER!  Mother!  mother! ‚Äùecho echoed out of habit. <br><br>  What na?  Where did it all go?  Why are blocks stacked on top of one another?  Where does this blue strip come from?  What a stupid font? <br><br>  A thought explodes in my head: ‚ÄúBlah, this is the damning thing that the whole world now sees!  Well, not all, but at least that part of it that goes to my site!  What to do, your mother, what to do? ‚Äù. <br><br>  Chill out!  Do not panic.  Nothing bad happened.  Everything is good. <br><br>  Get out of zagashnik any stale browser that you have not used for a hundred years.  What have you got, Netscaf?  Simanki?  Eighth Opera?  It doesn't matter, it will go.  Open the website.  Well, relieved?  Everything looks as it should be?  Right.  This is how all new visitors see your site now.  A mess in your favorite browser - due to the fact that the old contents of the CSS file is preserved in the browser cache, and all those styles that you have been rubbing over the last two days have not yet reached your computer.  By the way, to correct this matter of treating a lung is as simple as pressing Ctrl + F5. <br><br>  Another thing is that not all visitors are so advanced, and it is likely that some of them will be forced to contemplate the picture that has moved for a long time.  Just write a hint: ‚ÄúCitizens, from whom the site looks crooked, press Ctrl + F5‚Äù. <br><br>  Or maybe there is a better way?  Is it possible to somehow force the browser to forcibly refresh the cache? <br><br>  Looking ahead, I can make you happy: there is such a way!  Moreover, the way to the disgrace simple, one hundred percent valid and completely trouble-free.  However, first things first.  Seriously, it will be more useful. <br><br>  <b>Analysis</b> <br><br>  So, the browser and its cache.  What determines whether the browser will go for new content or get an old copy?  From many factors, in fact.  From browser type.  From the version.  From the platform.  From user settings.  From with what HTTP headers from the server static is given.  From the presence of proxies on the path between the web server and your computer.  In short, a lot of what.  Is there any control over this whole economy?  Is it possible to give them all the team to score on the cache and in a friendly way rush over the new content? <br><br>  The short answer is no.  But there are options.  Which we now consider. <br><br>  <b>1. HTTP Cache-Control Header</b> <br><br>  Theoretically, it would be possible to accompany static resources returned from the server with the following header: <br><br> <code>Cache-Control: no-cache</code> <br> <br>  This would ensure that the client uses the actual contents of the server files.  Unfortunately, this method has a significant drawback: it creates an excessive (and unnecessary) load on the network and other resources: after all, every time you request a page, the browser will have to reload the accompanying statics: style files, JavaScript scripts and graphics.  In addition, not everyone can and does not always have the ability to manage HTTP headers. <br><br>  You can also specify a different header value, for example: <br><br> <code>Cache-Control: max-age=86400</code> <br> <br>  This, as you understand, the directive to keep a copy in the cache for a day, but this does not solve the problem: if the user went to the site (the static was in the cache), and you changed the file after that, until tomorrow this will not know, and will be forced to admire the inappropriately moved layout. <br><br>  <b>2. HTTP Last-Modified Header</b> <br><br>  In principle, most servers automatically prescribe this header when returning static resources.  This allows the browser to upload new content only if the file has actually been modified.  To do this, along with the GET request, the browser sends the header: <br><br> <code>If-Modified-Since: Tue, 23 Jun 2009 19:12:47 GMT</code> <br> <br>  And then the server looks at the date of the change of the corresponding file, and if nothing has changed, it answers with the status code 304. Such an interaction scheme somewhat reduces the load on the network, but, unfortunately, does not give any guarantee that the browser will decide to inquire about this file. <br><br>  So how do you get him the desired behavior?  For this there is a radical means, namely: <br><br>  <b>3. Rename file</b> <br><br>  In fact, if we in the body of an HTML document refer to our style file by a new name, for example style1.css instead of style.css, then for the browser it will definitely be another resource that he will have to go and pick up directly from the server. <br><br>  Hooray!  Problem solved! <br><br>  However, do not rush to rejoice.  Renaming a file removes one problem, but generates a lot of other equally unpleasant ones.  Even from purely practical considerations, it is very inconvenient to have such a ‚Äústray‚Äù file in the project, but it‚Äôs not the only one!  After all, we have a development environment set up, there is a version control system - and they are not really designed to work with constantly renamed files. <br><br>  But wait, but what if ... What if you change not the file, but ... But of course!  Eureka! <br><br>  <b>4. Rename URL</b> <br><br>  Recall that the URL may contain, in addition to the file name, a bunch of different components.  For example, the Query String is the part that comes after the question mark.  Thought it was good only for forum engines: /index.php?showthread=1234?  But they did not guess.  Who wants, he will take advantage.  For example, we are for our style file.  How about registering such a line: <br><br> <code>&lt;link rel="stylesheet" href="/style.css?ver=123" type="text/css" /&gt;</code> <br> <br>  Handsomely?  And then!  See what happens.  The browser downloads the HTML code for the page.  See pointer to style sheet.  Looks at the URL: /style.css?ver=123.  Checks in the cache and finds the old version: /style.css?ver=122.  For the browser, these are two completely different addresses, so he did not hesitate to issue a GET request to receive a new CSS file. <br><br>  Now comes the web server.  He analyzes the server address of the resource and determines that a static style.css file is requested, and if so, the tail part of the URL is sent to it on the drum.  Therefore, he takes and with a clear conscience gives the client the contents of the specified file - the one that you just changed. <br><br>  Telemarket! <br><br>  In fact, this approach can be diversified with many modifications - for example, use an even simpler address like /style.css?123, or use server code that will automatically convert the date of file change to a string and substitute it as a tail.  But this is all the details.  The main thing is that you now know how to ensure adequate page display after changing styles. <br><br>  Good luck in site building! <br><br>  <b>Update</b> <br><br>  During the discussion of the article, some ideas were expressed that deserve a separate mention.  In particular: <br><br>  <b>1. Some browsers (primarily IE 6+) do not cache pages with URLs in their URLs.</b> <br><br>  Not true.  Quite a cache.  Kilometers of logs were viewed on various sites with different configurations, and I can responsibly state that there is no notice that there is no browser that basically does not cache pages with a shank in the address.  Further examination of the issue in the internet showed that for confidence, it is desirable to give statics with explicitly written Cache-Control caching directives, and then the question is almost completely removed. <br><br>  <b>2. It is better to modify not the variable, but the constant part of the URL address, and use mod_rewrite to redirect to a permanent file.</b> <br><br>  What can be said about this: an absolutely working solution that removes all issues with caching on the client.  It is strongly recommended to anyone who has access to the mod-rewrite configuration.  However, in situations where access to the files of the website is all that you have available, you are completely satisfied with the way the variables in the URL are set out in the note. <br><br>  <b>3. To do all the renaming in the framework of the process of automatic assembly and deployment of the project.</b> <br><br>  Comrades!  This note is least of all addressed to people involved in the streaming development of web software.  If everything is so complete with you that the site is depressed at the touch of a button, such things as renaming statics should be known to you a hundred pounds. <br><br>  Note: ‚ÄúWeb Tricks‚Äù is a mini-series in which I share bits and pieces of the webmaster's experience, acquired over a more than five-year history of maintenance and development of the author‚Äôs project <a href="http://real-english.ru/">English without fools</a> . </div><p>Source: <a href="https://habr.com/ru/post/62844/">https://habr.com/ru/post/62844/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../62834/index.html">What is the reason for the family on Facebook</a></li>
<li><a href="../62835/index.html">Conference PM-Labs 2009. July 25, Kiev</a></li>
<li><a href="../62838/index.html">Android received Flash support</a></li>
<li><a href="../62839/index.html">Pieces of video SPIC</a></li>
<li><a href="../62841/index.html">looking for a simple version control, so to speak</a></li>
<li><a href="../62845/index.html">MooTools - AJAX + document.write</a></li>
<li><a href="../62849/index.html">Startup plan</a></li>
<li><a href="../62853/index.html">The choice of birthdays on MySQL + trivia</a></li>
<li><a href="../62854/index.html">The speed of work with the latest communicators</a></li>
<li><a href="../62856/index.html">Simple Ruby Translator</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>