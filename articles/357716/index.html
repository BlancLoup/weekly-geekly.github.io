<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Delphi: the fastest DataSet (TJvMemoryData, TMemTableEh, TdxMemData, TkbmMemTable)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, I will conduct a comparative analysis of DataSet'ov, which keep the data in memory. 

 List of DataSets 


1. TJvMemoryData Developer...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Delphi: the fastest DataSet (TJvMemoryData, TMemTableEh, TdxMemData, TkbmMemTable)</h1><div class="post__text post__text-html js-mediator-article">  In this article, I will conduct a comparative analysis of DataSet'ov, which keep the data in memory. <br><br><h2>  List of DataSets </h2><br><ol><li>  <b>TJvMemoryData</b> <br>  Developer: JEDI Visual Component Library (JCL + JVCL) Community <br>  JCL (version 2.8) <br>  JVCL (version 3.50) <br>  ‚Üí <a href="http://jvcl.delphi-jedi.org/">Official website</a> </li><li>  <b>TMemTableEh</b> <br>  Developer: EhLib <br>  Version: 9.0.040 <br>  ‚Üí <a href="http://www.ehlib.com/">Official website</a> </li><li>  <b>TdxMemData</b> <br>  Developer: DevExpress <br>  Version: 15.2.2 <br>  ‚Üí <a href="https://www.devexpress.com/">Official website</a> </li><li>  <b>TkbmMemTable</b> <br>  Developers: Components4Developers <br>  Version: 7.74.00 Professional Edition <br>  ‚Üí <a href="http://www.components4developers.com/">Official website</a> </li></ol><br><h2>  DataSet comparison options </h2><br><ol><li>  Insert records </li><li>  Sort records </li></ol><br><h2>  Environment </h2><table><tbody><tr><td>  Delphi </td><td>  10.2 Tokyo Starter </td></tr><tr><td>  operating system </td><td>  Windows 7 SP1 Ultimate x64 </td></tr><tr><td>  CPU </td><td>  Intel Core i5 </td></tr><tr><td>  Ram </td><td>  8 GB </td></tr></tbody></table><h2>  Test data </h2><br>  DataSets will be tested on data obtained from the Firebird database.  For comparative analysis, I created 100,000 records in the database with different data types: <br><br>  ‚Ä¢ whole numbers; <br>  ‚Ä¢ real numbers; <br>  ‚Ä¢ dates; <br>  ‚Ä¢ lines; <br>  ‚Ä¢ Images. <br><a name="habracut"></a><br><h2>  Comparison </h2><br><ol><li>  Data loading <br><table><tbody><tr><th>  Dataset </th><th>  LoadFromDataSet </th><th>  Manual </th><th>  The average </th></tr><tr><td>  TJvMemoryData </td><td>  7.7846 sec </td><td>  <b><i>5,7500 seconds</i></b> </td><td>  6.7673 sec </td></tr><tr><td>  TMemTableEh </td><td>  <b><i>4,5114 sec</i></b> </td><td>  7.2978 sec </td><td>  5.9046 sec </td></tr><tr><td>  TdxMemData </td><td>  6.3804 sec </td><td>  6.5082 sec </td><td>  6.4443 sec </td></tr><tr><td>  TkbmMemTable </td><td>  5.4474 sec </td><td>  6.0562 sec </td><td>  <b><i>5.7518 sec</i></b> </td></tr></tbody></table>  The loads for each DataSet were performed 5 times, the arithmetic average was calculated from the obtained values.  The average value is the arithmetic average of the load values ‚Äã‚Äãusing the LoadFromDataSet method and the manual load value. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Results: <br><br>  <b>TMemTableEh</b> - the fastest data load using the LoadFromDataSet method <br>  <b>TJvMemoryData</b> - the fastest manual data download <br>  <b>TkbmMemTable</b> - the fastest average data load <br><br><div class="spoiler">  <b class="spoiler_title">Time measurement source code</b> <div class="spoiler_text"><pre><code class="hljs go"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> start_time, end_time, total_time: double; start_time := GetTickCount; ... end_time := GetTickCount; total_time := (end_time - start_time) / <span class="hljs-number"><span class="hljs-number">1000</span></span>;</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Load data source code LoadFromDataSet</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">//TJvMemoryData //<span class="hljs-keyword"><span class="hljs-keyword">function</span></span> LoadFromDataSet(Source: TDataSet; RecordCount: <span class="hljs-type"><span class="hljs-type">Integer</span></span>; Mode: TLoadMode; DisableAllControls: <span class="hljs-type"><span class="hljs-type">Boolean</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-type"><span class="hljs-type">Integer</span></span>; JvMemoryData.LoadFromDataSet(FIBDataSet, <span class="hljs-number"><span class="hljs-number">-1</span></span>, lmCopy); //TMemTableEh //<span class="hljs-keyword"><span class="hljs-keyword">function</span></span> LoadFromDataSet(Source: TDataSet; RecordCount: <span class="hljs-type"><span class="hljs-type">Integer</span></span>; Mode: TLoadMode; UseCachedUpdates: <span class="hljs-type"><span class="hljs-type">Boolean</span></span>): <span class="hljs-type"><span class="hljs-type">Integer</span></span>; MemTableEh.LoadFromDataSet(FIBDataSet, <span class="hljs-number"><span class="hljs-number">-1</span></span>, lmCopy, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); //TdxMemData //<span class="hljs-keyword"><span class="hljs-keyword">procedure</span></span> LoadFromDataSet(DataSet : TDataSet); dxMemData.LoadFromDataSet(FIBDataSet); //TkbmMemTable //<span class="hljs-keyword"><span class="hljs-keyword">procedure</span></span> TkbmCustomMemTable.LoadFromDataSet(Source:TDataSet; CopyOptions:TkbmMemTableCopyTableOptions; <span class="hljs-keyword"><span class="hljs-keyword">Mapping</span></span>:string=<span class="hljs-string"><span class="hljs-string">''</span></span>); kbmMemTable.LoadFromDataSet(FIBDataSet, [mtcpoAppend]);</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Manual source code</b> <div class="spoiler_text"><pre> <code class="hljs lua"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> FIBDataSet.Eof <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> begin <span class="hljs-built_in"><span class="hljs-built_in">table</span></span>.Append; <span class="hljs-built_in"><span class="hljs-built_in">table</span></span>.FieldByName(<span class="hljs-string"><span class="hljs-string">'ID'</span></span>).AsInteger := FIBDataSet.FieldByName(<span class="hljs-string"><span class="hljs-string">'ID'</span></span>).AsInteger; <span class="hljs-built_in"><span class="hljs-built_in">table</span></span>.FieldByName(<span class="hljs-string"><span class="hljs-string">'SUMM'</span></span>).AsFloat := FIBDataSet.FieldByName(<span class="hljs-string"><span class="hljs-string">'SUMM'</span></span>).AsFloat; <span class="hljs-built_in"><span class="hljs-built_in">table</span></span>.FieldByName(<span class="hljs-string"><span class="hljs-string">'COMMENT'</span></span>).AsString := FIBDataSet.FieldByName(<span class="hljs-string"><span class="hljs-string">'COMMENT'</span></span>).AsString; ... <span class="hljs-built_in"><span class="hljs-built_in">table</span></span>.Post; FIBDataSet.Next; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">table</span></span>.First;</code> </pre> </div></div><br>  TJvMemoryData is the only DataSet whose manual loading of data turned out to be faster than loading using the LoadFromDataSet method. <br><br>  TdxMemData is the only DataSet that, after loading data using the LoadFromDataSet method, does not return a position in the DataSet to the first record. </li><li>  Sorting <br><table><tbody><tr><th>  Dataset </th><th>  Integer </th><th>  Real number </th><th>  Line </th><th>  The average </th></tr><tr><td>  TJvMemoryData </td><td>  0.3492 sec </td><td>  0.8330 sec </td><td>  1,9938 sec </td><td>  1,0587 sec </td></tr><tr><td>  TMemTableEh </td><td>  0.9014 sec </td><td>  0.8642 sec </td><td>  3.6876 sec </td><td>  1.8177 sec </td></tr><tr><td>  TdxMemData </td><td>  0,3616 s </td><td>  0.3650 sec </td><td>  0.9134 sec </td><td>  0.5467 sec </td></tr><tr><td>  TkbmMemTable </td><td>  <b><i>0.1996 sec</i></b> </td><td>  <b><i>0.2186 sec</i></b> </td><td>  <b><i>0.7550 sec</i></b> </td><td>  <b><i>0.3897 sec</i></b> </td></tr></tbody></table>  Sorting for each DataSet'a was performed 5 times, the arithmetic average was calculated from the obtained values.  The average value is the arithmetic average of the sort values. <br><br>  Results: <br><br>  <b>TkbmMemTable</b> - the fastest sorting of integers <br>  <b>TkbmMemTable</b> - the fastest sorting of real numbers <br>  <b>TkbmMemTable</b> - the fastest sorting of lines <br>  <b>TkbmMemTable</b> - the fastest average sorting <br><br><div class="spoiler">  <b class="spoiler_title">Time measurement source code</b> <div class="spoiler_text"><pre> <code class="hljs go"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> start_time, end_time, total_time: double; start_time := GetTickCount; ... end_time := GetTickCount; total_time := (end_time - start_time) / <span class="hljs-number"><span class="hljs-number">1000</span></span>;</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Source code for sorting data</b> <div class="spoiler_text"><pre> <code class="hljs vhdl">//TJvMemoryData //<span class="hljs-keyword"><span class="hljs-keyword">procedure</span></span> SortOnFields(const FieldNames: <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> = ''; CaseInsensitive: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> = <span class="hljs-literal"><span class="hljs-literal">True</span></span>; Descending: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> = <span class="hljs-literal"><span class="hljs-literal">False</span></span>); JvMemoryData.SortOnFields(fields, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); //TMemTableEh //<span class="hljs-keyword"><span class="hljs-keyword">procedure</span></span> SortByFields(const SortByStr: <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>); MemTableEh.SortByFields(fields); //TdxMemData dxMemData.SortedField := fields; //TkbmMemTable //<span class="hljs-keyword"><span class="hljs-keyword">procedure</span></span> SortOn(const FieldNames:<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>; Options:TkbmMemTableCompareOptions); kbmMemTable.SortOn(fields, []);</code> </pre> </div></div><br></li></ol><br>  I note that only for the TMemTableEh DataSet when sorting by several fields you can set a different sorting direction for each field (ascending / descending). <br><br><h2>  Conclusion </h2><br>  The undisputed leader was the DataSet <b><i>TkbmMemTable</i></b> , but all the other DataSets showed good results.  But you can use TkbmMemTable only with Delphi XE2. <br><br>  Of course, it is unlikely that you need to load 100,000 records on real data for display to the user.  Also, when choosing a DataSet, it is necessary to take into account that on a different data set (for example, in the absence of downloading images or for an x64 application), the results of the speed of work may be different.  In addition, many DataSets have additional functionality for working with a grid from their library. <br><br><h2>  More about TMemTableEh </h2><br>  The TMemTableEh component appeared in EhLib 4.0.  All library components, including TMemTableEh, have been running since Delphi 7. <br><br>  The advantages of using MemTableEh compared to other DataSets are the following: <br><br><ol><li>  It supports a special interface that allows the DBGridEh component to view all data without moving the active record. </li><li>  Allows you to upload data from a TDataDriverEh object (DataDriver property). </li><li>  Allows you to upload changes back to DataDriver, promptly or deferred (depending on the properties of CachedUpdates). </li><li>  Allows you to create a master / client relationship on the client (by filtering records) or on an external source (by updating the [Params] parameters and re-querying the details with DetailDataDriver). </li><li>  Allows you to sort data, including Calculated and Lookup fields. </li><li>  Allows you to create and fill in data in design-time and save the data in a dfm-file form. </li><li>  Allows you to store records in the form of a tree.  Each record can have node / branch records and itself be a node of another parent record.  The TDBGridEh component supports the display functionality of the tree structure of these records. </li><li>  Allows you to connect to the internal array of another TMemTableEh component (ExternalMemData property) and work with its data: sort, filter, edit. </li><li>  It has an interface for getting a list of all column values, ignoring the local DataSet filter.  TDBGridEh uses this property to automatically generate a list in the dropdown dropdown filter. </li></ol><br><h2>  About TRxMemoryData </h2><br>  Development: RxLib <br>  The TRxMemoryData component appeared in version RxLib 2.60. <br><br>  The DataSet TRxMemoryData does not participate in the comparison, because in 2002 the RxLib library was officially incorporated into the JVCL.  JVCL has a utility for quickly replacing all Rx components, functions and units on the JVCL version. <br><br>  Why go to JVCL: <br><br>  Unlike RxLib, JVCL is evolving.  Errors are corrected.  Regularly released version with support for new versions of Delphi.  JVCL components support newer versions of Windows and Windows styles. <br><br><h2>  How do I use DataSets in my practice? </h2><br><ol><li>  TRxMemoryData </li><li>  TMemTableEh </li><li>  TRxMemoryData </li><li>  TJvMemoryData </li><li>  TkbmMemTable </li></ol></div><p>Source: <a href="https://habr.com/ru/post/357716/">https://habr.com/ru/post/357716/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../357704/index.html">How not to work with time zones or Aeroflot-Fail</a></li>
<li><a href="../357706/index.html">Haskell - knight's move 3. Conclusion</a></li>
<li><a href="../357710/index.html">The fate of the open source project after the death of the programmer</a></li>
<li><a href="../357712/index.html">Detective story with CMake 3.10 and Android Studio</a></li>
<li><a href="../357714/index.html">Semaphores, races, critical sections and Scratch. Plants vs. Zombies</a></li>
<li><a href="../357718/index.html">Implementing FizzBuzz on FPGA</a></li>
<li><a href="../357720/index.html">Web development - where to start?</a></li>
<li><a href="../357724/index.html">Gmail is not working</a></li>
<li><a href="../357726/index.html">Dropbox Practical magic lessons</a></li>
<li><a href="../357750/index.html">Survey: Google Reader after a while</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>