<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Magento, additional content on the Checkout page</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="You need to add two pictures to the checkout page, as in this picture: 

 It was not as easy as it seemed. 

 To begin with we will make a small templ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Magento, additional content on the Checkout page</h1><div class="post__text post__text-html js-mediator-article"> You need to add two pictures to the checkout page, as in this picture: <br><img src="http://pic.ipicture.ru/uploads/091015/ekQVLKSy2E.png" alt="checkout.png"><br>  It was not as easy as it seemed. <br><a name="habracut"></a><br>  To begin with we will make a small template file with the necessary pictures.  This is the <code>app/design/frontend/default/sunnyD/template/callouts/checkout.phtml</code> file: <br><br><pre>  &lt;div class = "box"&gt;
     &lt;script src = "https://siteseal.thawte.com/cgi/server/thawte_seal_generator.exe"&gt; &lt;/ script&gt;
 &lt;/ div&gt;

 &lt;div class = "box"&gt;
     &lt;img src = "&lt;? php echo $ this-&gt; getSkinUrl ('images / free-shipping.gif')?&gt;" alt = "&lt;? php echo __ ('Free Shipping')?&gt;" /&gt;
 &lt;/ div&gt; </pre><br><br>  The first image is loaded dynamically, for which Javascript is used. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  First try </h2><br>  Why not just add a new block to checkout.xml?  To do this, you can use the built-in <code>core/template</code> .  It is very convenient for displaying simple templates without logic, it needs to pass only one parameter - the template that needs to be output.  And, because  A simple checkout template consists of content and a right block ( <code>2columns-right.phtml</code> ), add our new block to the right side of the page, something like this: <br><pre>  &lt;code&gt; &lt;checkout_onepage_index&gt;
     ...
     &lt;reference name = "right"&gt;
         ...
         &lt;block type = "core / template" name = "images" template = "callouts / checkout.phtml" /&gt;
         ... </pre><br>  It even works, and at first glance we have exactly what we need - our pictures from the <code>checkout.phtml</code> template appear on the right. <br><br>  But at a second glance, when you click the Continue button to go to the next step of the checkout, the right side of the page completely reloads.  The html for the right page comes in an Ajax request.  This html no longer contains our images. <br><h2>  Second try </h2><br>  Okay, so you need to fix the returned html, so that it contains our pictures. <br><br>  For this you need to fix <code>checkout.xml</code> , section <code>checkout_onepage_progress</code> .  We need to add our block, as we did in the <code>checkout_onepage_index</code> section.  But what is it?  Our pictures anyway, no! <br><br>  In general, it turned out in the end that you need to add the <code>output</code> parameter to the block and assign the value <code>toHtml</code> : <br><pre>  &lt;checkout_onepage_progress&gt;
     ...
     &lt;block type = "core / template" name = "images" output = "toHtml" template = "callouts / checkout.phtml" /&gt;
     ... </pre><br><br>  What is it?  Now, after the Continue button, only one image is visible, which is loaded via the <code>img</code> tag.  The second image loaded via Javascript is not visible.  Moreover, although the js code came in response from the server, it disappeared from the DOM tree.  Any filter? <br><br>  In general, attempt number two also failed. <br><h2>  Success </h2><br>  Well, if you can‚Äôt show both images by modifying the code for the right-hand side returned by an Ajax request, we‚Äôll try to make the template remain unchanged throughout all steps of the checkout. <br><br>  Javascript working with the checkout page is in the <code>opcheckout.js</code> file.  It seems that the code that updates the right side of the page looks like this: <br><pre>  ...
 reloadProgressBlock: function () {
     var updater = new Ajax.Updater ($$ ('. col-right') [0], this.progressUrl, {method: 'get', onFailure: this.ajaxFailure.bind (this)});
 },
 ... </pre><br>  Those.  he takes the first element with the class <code>col-right</code> and installs to it the new html received from the server. <br><br>  And here is where the element with this class is declared - the file <code>template/page/2columns-right.phtml</code> : <br><pre>  ...
 &lt;! - start right -&gt;
 &lt;div class = "col-right side-col"&gt;
     &lt;? php echo $ this-&gt; getChildHtml ('right')?&gt; &amp; nbsp;
 &lt;/ div&gt;
 &lt;! - end right -&gt;
 ... </pre><br>  Not very good ... No matter what we put on the right side of the page using xml and the <code>reference name="right"</code> , or directly into this template, everything will be inside the diva with the class <code>col-right</code> and, as a result, will be erased in the next steps checkout <br><br>  So, the only way out is to make your template based on <code>2columns-right.phtml</code> .  And in this template somehow put our template with pictures "outside" the right side, so that it would not be erased with new data. <br><br>  So, first create a new template <code>2columns-right-checkout.phtml</code> , and specify in <code>checkout.xml</code> what you need to use it. <br><br>  It was: <br><pre>  &lt;checkout_onepage_index&gt;
     ...
     &lt;reference name = "root"&gt;
         &lt;action method = "setTemplate"&gt; &lt;template&gt; page / 2columns-right.phtml &lt;/ template&gt; &lt;/ action&gt; </pre><br>  It became: <br><pre>  &lt;checkout_onepage_index&gt;
     ...
     &lt;reference name = "root"&gt;
         &lt;action method = "setTemplate"&gt; &lt;template&gt; page / 2columns-right-checkout.phtml &lt;/ template&gt; &lt;/ action&gt; </pre><br>  Next, we modify the new template <code>2columns-right.checkout.phtml</code> in the output part of the right side: <br><pre>  &lt;! - start right -&gt;
 &lt;div class = "side-col" style = "float: right;"&gt;
     &lt;div class = "col-right side-col" &lt;? php echo $ this-&gt; getChildHtml ('right')?&gt; &lt;/ div&gt;

     &lt;div class = "col-right side-col"&gt;
         &lt;? php echo $ this-&gt; getChildHtml ('images')?&gt;
     &lt;/ div&gt;
 &lt;/ div&gt;
 &lt;! - end right -&gt; </pre><br>  The meaning of this.  Create a new wrapper div that will contain the right column.  We cannot assign him the class <code>col-right</code> , because then the content of this diva will be lost.  But we can leave it with a <code>side-col</code> class (which simply sets the width of the column, now 195px).  And we add the <code>float: right</code> property so that our div-wrapper is located on the right. <br><br>  Then we add inside the wrapper diva first the initial right part of <code>getChildHtml('right')</code> , then our template with pictures <code>getChildHtml('images')</code> . <br><br>  Now both divas can have the original <code>side-col</code> and <code>col-right</code> classes.  During the transition between steps, the contents of the first block with the class <code>col-right</code> will be updated, and the second block with our pictures will remain intact throughout the checkout.  As required. <br><br>  And also - to get the code <code>getChildHtml('images')</code> work out and display our <code>core/template</code> block with a template with images, you need to add it to <code>checkout.xml</code> inside the <code>reference name="root"</code> .  And add the property <code>as</code> , equal to <code>images</code> .  This <code>images</code> is the name by which <code>getChildHtml()</code> will find our block.  We get: <br><pre>  &lt;checkout_onepage_index&gt;
     ...
     &lt;reference name = "root"&gt;
         ...
         &lt;block type = "core / template" name = "images" as = "images" template = "callouts / checkout.phtml" /&gt;
         ... </pre><br>  Here, just a few hours of work and the checkout page contains our additional template.  All within the framework of decency, core files are not modified, all changes are only in the folder with the user theme ... </div><p>Source: <a href="https://habr.com/ru/post/72493/">https://habr.com/ru/post/72493/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../72482/index.html">Scanned the brain of a Quake mouse</a></li>
<li><a href="../72485/index.html">Volery - Service for creating an installation package with free / partly free software.</a></li>
<li><a href="../72486/index.html">3D fingerprints</a></li>
<li><a href="../72491/index.html">Big Brother in Linux or do it yourself video surveillance</a></li>
<li><a href="../72492/index.html">How to win "Cannot boot from CD - Code 5" when installing Windows 7</a></li>
<li><a href="../72495/index.html">Twitter will not sell wine ahead of time</a></li>
<li><a href="../72498/index.html">‚ÄúLife is a search‚Äù</a></li>
<li><a href="../72500/index.html">A building that produces more electricity than it consumes</a></li>
<li><a href="../72501/index.html">How to go to the service center</a></li>
<li><a href="../72502/index.html">Teeworlds mods overview</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>