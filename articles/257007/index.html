<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Developing a simple plugin for JIRA to work with the database: we give our plugin a normal appearance</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the first part, we made a simple plugin for JIRA for working with a database. Now we give our plugin a ‚Äústandard‚Äù look and feel of JIRA. 



 First...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Developing a simple plugin for JIRA to work with the database: we give our plugin a normal appearance</h1><div class="post__text post__text-html js-mediator-article">  In the <a href="http://habrahabr.ru/post/256789/">first part,</a> we made a simple plugin for JIRA for working with a database.  Now we give our plugin a ‚Äústandard‚Äù look and feel of JIRA. <br><br><img src="https://habrastorage.org/files/286/0b6/368/2860b63683894a8e85be3c4ac9b6079a.png"><br><br>  First, let's add some functionality to our plugin.  Let now for each project there will be a list of students, i.e.  the student will be tied to a strictly one project, and we will add students the names just in case.  Accordingly, we will have to redo the extradition of students.  Now we will issue only students who are tied to a specific project.  To do this, we will have to rewrite the class Students, adding there are necessary student attributes;  Add a new method to the StudentDAO interface (and, of course, the StudentDAOImpl class) to get a list of students for the project;  and rewrite the execute () and doAdd () methods in the MyAction class according to the new changes. <br><a name="habracut"></a><br>  Actually, now you can go to the main content. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      After thinking about the appearance of our tab, we will work with images.  Let the images be in the images folder.  Then in the atlassian-plugin.xml file in the &lt;atlassian-plugin&gt; tag add the line <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resource</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"download"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"images/"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">location</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"images/"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br>  We will describe the styles for the logos on the page in icon.css and add these styles in atlassian-plugin.xml to the &lt;web-resource key = "my-resources"&gt; tag <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resource</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"download"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"icon.css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">location</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myaction/css/icon.css"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br>  In icon.css, we already use image paths according to the path we specified in the name property when we added images to the project.  For example, <br><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.project-config-icon48-students</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: transparent <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(images/student-48px.png) no-repeat <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre><br>  Actually, we rule our success.vm for using the REST-API by changing the tag as follows: <br><br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"project-config-panel-students"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"project-config-panel"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"project-config-panel-header project-config-icon48-students"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>Students<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Students description.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"project-config-students"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"loading"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"aui"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"project-config-students-table"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-comment"><span class="hljs-comment">&lt;!--icon--&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>name<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>surname<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>created<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-comment"><span class="hljs-comment">&lt;!--buttons--&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-comment"><span class="hljs-comment">&lt;!--throbber--&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jira-restfultable-init"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jira-restfultable-throbber"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jira-restfultable-loading"</span></span></span><span class="hljs-tag">&gt;</span></span>Loading<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Here you need to display the download, and in the tag <pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre>  students will be displayed.  A page without a REST API looks like this: <br><br><img src="//habrastorage.org/files/bb7/7c4/cba/bb77c4cba0db474c8fb8181e10906df5.png"><br><br>  Add an entry point to our REST-API.  To do this in the file atlassian-plugin.xml in the tag &lt;atlassian-plugin&gt; we write <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pluginRESTpoints"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/simple-api"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  We will add 3 classes to the resource.XML package for our API to work: XmlStudent.java - the student‚Äôs view on request and XmlStudents.java - the list of students.  And Mapper.java is a general class with static methods for converting different types to XML.  Details about the used annotations can be found <a href="http://www.vogella.com/tutorials/JAXB/article.html">here</a> . <br><br>  Well, add the API itself.  Add the StudentResource class to the resource package.  This class must be inherited from the AbstractResource class.  Specify for this class the <code>@Path("project/{pid}/students")</code> annotation <code>@Path("project/{pid}/students")</code> , responsible for the way in which we will access this class via the REST-API, and the <code>@Produces({"application/json"})</code> annotation <code>@Produces({"application/json"})</code> , responsible for the type of data transmitted.  In the class, create a method getStudents, which will issue a list of students.  We <code>@GET</code> for it the <code>@GET</code> annotation corresponding to the request method.  The parameters of the method will be: <code>@PathParam("pid") String pid</code> - is responsible for the project id and is taken from the path, <code>@QueryParam("id") String id</code> - is responsible for the student id and is taken from the query.  Details about annotations can be found <a href="http://www.vogella.com/tutorials/REST/article.html">here</a> . <br><br>  Actually, a simple API for JIRA is ready, now if, for example, in the browser I‚Äôll go to: <br><br>  <a href="http://localhost/">localhost</a> : 8080 / rest / simple-api / 1.0 / project / 10002 / students <br><br>  then I will get an answer: <br><br>  {"Pid": 10002, "count": 2, "students": [{"id": 4, "name": "Vasya", "surname": "Pupkin", "pid": 10002, "created" : "2014-05-07 14: 48: 15.83"}, {"id": 5, "name": "Igor", "surname": "Petrov", "pid": 10002, "created": "2014 -05-07 17: 47: 58.5 "}]} <br><br><br>  Now you need to write js, which will produce data from the API in our workpiece.  Since  we will give the data about students to the table, then we will use the standard <a href="https://docs.atlassian.com/aui/latest/docs/restfulTable.html">JIRARestfultable</a> functionality.  The problem with writing a plugin was to find documentation for version 4.4.  Therefore, I will stop here in more detail. <br><br>  First, create a template for displaying information in the table - student.soy: <br><br><pre> <code class="javascript hljs">{namespace JIRA.Templates.Student} <span class="hljs-comment"><span class="hljs-comment">/** * @param student */</span></span> {template .studentRow} &lt;td <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"jira-restfultable-icon project-config-student-icon"</span></span>&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"project-config-icon project-config-icon-student"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/td&gt; &lt;td class="project-config-student-name"&gt; {$student.name} &lt;/</span></span>td&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"project-config-student-surname"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> {$student.surname} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;td <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"project-config-student-created"</span></span>&gt; {$student.created} &lt;<span class="hljs-regexp"><span class="hljs-regexp">/td&gt; &lt;td class="jira-restfultable-operations"&gt;&lt;/</span></span>td&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"project-config-throbber"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">td</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> {/template}</code> </pre><br>  The student input parameter is a JSON object containing information about the student.  From this template, the js-code will be automatically created, which then will draw a row in the table. <br><br>  To transform this template into js code, you need to add jiraSoyTransformer to the same tag - an element that will make the js script from the * .soy template. <br><br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">transformation</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">extension</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"soy"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">transformer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jiraSoyTransformer"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">transformation</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  In order for JIRARestfultable to work correctly, you need to add the following element for the work of the internationalization mechanism to the same tag: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">transformation</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">extension</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"js"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">transformer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jsI18n"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">transformation</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Add a StudentRow.js script that creates rows from templates.  The scripts are generic in general, so I will not dwell on them. <br><br><pre> <code class="javascript hljs">jQuery.namespace(<span class="hljs-string"><span class="hljs-string">"JIRA.Admin.Student.StudentRow"</span></span>); JIRA.Admin.Student.StudentRow = JIRA.RestfulTable.Row.extend({ <span class="hljs-attr"><span class="hljs-attr">initialize</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ JIRA.RestfulTable.Row.prototype.initialize.apply(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); }, <span class="hljs-attr"><span class="hljs-attr">render</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.model.toJSON(), id = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.model.get(<span class="hljs-string"><span class="hljs-string">"id"</span></span>), $el = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$el; $el.attr(<span class="hljs-string"><span class="hljs-string">"id"</span></span>, <span class="hljs-string"><span class="hljs-string">"student-"</span></span> + id + <span class="hljs-string"><span class="hljs-string">"-row"</span></span>).attr(<span class="hljs-string"><span class="hljs-string">"data-id"</span></span>, id); $el.html(JIRA.Templates.Student.studentRow({ <span class="hljs-attr"><span class="hljs-attr">student</span></span>: data })); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } });</code> </pre><br>  Now create a script to initialize our student-init.js table: <br><br><pre> <code class="javascript hljs">jQuery(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $table = AJS.$(<span class="hljs-string"><span class="hljs-string">"#project-config-students-table"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $project = AJS.$(<span class="hljs-string"><span class="hljs-string">"meta[name=projectId]"</span></span>).attr(<span class="hljs-string"><span class="hljs-string">"content"</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getResourceURL</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> contextPath + <span class="hljs-string"><span class="hljs-string">"/rest/simple-api/1.0/project/"</span></span> + $project + <span class="hljs-string"><span class="hljs-string">"/students"</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getStudent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">callback</span></span></span><span class="hljs-function">) </span></span>{ JIRA.SmartAjax.makeRequest({ <span class="hljs-attr"><span class="hljs-attr">url</span></span>: getResourceURL(), <span class="hljs-attr"><span class="hljs-attr">complete</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">xhr, status, response</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.successful) { callback(response.data.students); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $table.trigger(<span class="hljs-string"><span class="hljs-string">"serverError"</span></span>, [JIRA.SmartAjax.buildSimpleErrorContent(response)]); } } }); } getStudent(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">students</span></span></span><span class="hljs-function">) </span></span>{ JIRA.Admin.StudentTable = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JIRA.RestfulTable({ <span class="hljs-attr"><span class="hljs-attr">el</span></span>: $table, <span class="hljs-attr"><span class="hljs-attr">url</span></span>: getResourceURL(), <span class="hljs-attr"><span class="hljs-attr">entries</span></span>: students, <span class="hljs-attr"><span class="hljs-attr">noEntriesMsg</span></span>: <span class="hljs-string"><span class="hljs-string">'There are currently no students for this project.'</span></span>, <span class="hljs-attr"><span class="hljs-attr">views</span></span>: { <span class="hljs-attr"><span class="hljs-attr">row</span></span>: JIRA.Admin.Student.StudentRow } }); jQuery(<span class="hljs-string"><span class="hljs-string">".jira-restfultable-init"</span></span>).remove(); JIRA.userhover($table); }); });</code> </pre><br><br>  It is necessary to add all the specified files to the &lt;my-resources&gt; tag. Actually, nothing complicated: <br><br><img src="//habrastorage.org/files/e89/195/699/e891956995f444aaafd5ed3a10943544.png"><br><br>  Now we implement the removal, editing and adding students. <br><br>  To begin, we will do everything in appearance, and then we will do REST Api for it. <br>  Let's alter student.soy a bit by adding the JIRA.Templates.Student.editStudentRow template to edit and add students.  In the JIRA.Templates.Student.studentRow template, we add the appearance of the standard JIRA backlight for editable fields and the delete button.  Let's write the EditStudentRow.js script to create a row for editing from the JIRA.Templates.Student.editStudentRow template.  And add the ability to edit in student-init.js.  In StudentRow.js.  In the getStudent function, we add the handling of pressing the delete button. <br>  It remains to add the new EditStudentRow.js file in atlassian-plugin.xml to the my-resources tag.  And we got: <br><br><img src="//habrastorage.org/files/b2b/8bf/d64/b2b8bfd645b14e52949c578354f6818a.png"><br><br>  With the look we are done.  Let's figure out what requests are being poisoned when you click on each button: <br><br>  addition: <br><br><pre> <code class="html hljs xml">url: http://localhost:8080/rest/simple-api/1.0/project/10000/students method: POST request: {"name":"","surname":""}</code> </pre><br><br>  deletion: <br><br><pre> <code class="html hljs xml">url: http://localhost:8080/rest/simple-api/1.0/project/10000/students/10?[  request] method: DELETE 1. request: id=10&amp;name=&amp;surname=&amp;pid=10000&amp;created=2014-05-13 15:54:12.803</code> </pre><br><br>  change: <br><br><pre> <code class="html hljs xml">url: http://server/rest/simple-api/1.0/project/10000/students/10 method: PUT request: {"id":10,"name":"","surname":""}</code> </pre><br><br>  In url: 10000 is the project id, 10 is the id of the line to be changed, the changed values ‚Äã‚Äãare sent to request, i.e.  if we didn‚Äôt change the surname, the request would be: <br><br><pre> <code class="html hljs xml">{"id":10,"name":""}</code> </pre><br><br>  Before writing the processing of these requests, we supplement our StudentDAO.java with the necessary add and remove methods. <br>  And it remains to add request processing to StudentResource.java. <br><br>  Actually, that's all.  You can, of course, continue to write about MultiSelect and SingleSelect for Jira and how to use them (your own UserPicker, ProjectPicker, RolePicker, etc.), how to move the rows inside the table and many other trivialities that can be easily implemented using restfultable and REST Api . <br><br>  Plugin code on <a href="https://github.com/edsd/jira-simple-plugin">github</a> . <br><br>  <b><a href="http://habrahabr.ru/post/256789/">The first part</a> .</b> <br><br>  More projects: <br>  <a href="https://habrahabr.ru/company/edison/blog/273295/">How to create software for a microtomograph for 5233 man-hours</a> <br>  <a href="https://habrahabr.ru/company/edison/blog/232033/">Control access to electronic documents.</a>  <a href="https://habrahabr.ru/company/edison/blog/232033/">From DefView to Vivaldi</a> <br>  <a href="https://habrahabr.ru/company/edison/blog/256789/">Developing a simple plugin for JIRA to work with a database</a> <br>  <a href="https://habrahabr.ru/company/edison/blog/257007/">Developing a simple plugin for JIRA to work with the database: we give our plugin a normal appearance</a> <br>  <a href="https://habrahabr.ru/company/edison/blog/270777/">Windows Service Auto Update for Poor AWS</a> </div><p>Source: <a href="https://habr.com/ru/post/257007/">https://habr.com/ru/post/257007/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../256997/index.html">The history of the development of iOS-application. Basically about the rake</a></li>
<li><a href="../256999/index.html">Detailed analysis of Habrahabr using the Wolfram Language (Mathematica)</a></li>
<li><a href="../257001/index.html">Unnamed book</a></li>
<li><a href="../257003/index.html">Low-cost, low-bandwidth multi-zone amplifier</a></li>
<li><a href="../257005/index.html">ES6 in details: introduction</a></li>
<li><a href="../257011/index.html">Microsoft announced a cross-platform editor for Windows, OS X and Linux</a></li>
<li><a href="../257015/index.html">Introduction to the Ethernet Fast Path software on the P1020RDB debug board</a></li>
<li><a href="../257017/index.html">HL7 CDA R2 Development Tools Testing</a></li>
<li><a href="../257019/index.html">Ten of the best engines to create your own games</a></li>
<li><a href="../257021/index.html">Transliteration in Perl6</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>