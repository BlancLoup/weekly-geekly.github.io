<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Fractal Flame - Build Algorithm</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Fractal flame (or fractal sparks, English. Fractal flame) - an algorithm proposed by Scott Draves (Scott Draves) and using a system of iterated functi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Fractal Flame - Build Algorithm</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/7b0/4ac/6a8/7b04ac6a87c841398f5e6f1bfb1293e3.png"><br><br>  Fractal flame (or fractal sparks, English. Fractal flame) - an algorithm proposed by Scott Draves (Scott Draves) and using a system of iterated functions (CIF) for imaging.  Due to the different values ‚Äã‚Äãof the seed for the pseudo-random number generator, you can get a variety of different "pictures".  Although the fractality in them is far from always visible, the results are very interesting. <br><br>  Under the cut - a brief description of the main points of the implementation of the algorithm. <br><a name="habracut"></a><br>  To begin with, as in conventional CIFs, we will need to know the coefficients for each affine transformation of the plane (there may be several; each next will make its own ‚Äústrokes‚Äù on the picture, as well as change the contribution of the previous ones).  In matrix form, this transformation is as follows: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/a6a/30d/99b/a6a30d99bfe143428ac419c2171655fc.gif"><br><br>  It is necessary to choose such coefficients so that the resulting transformation is compressive, that is, such that its scaling factor is less than one.  There should be several of these transformations, and if you randomly choose one of them, in order to calculate the new coordinates of the point and display it on the screen, we will get an attractor - a set of points that the image will consist of. <br><br>  Using a pseudo-random number sensor, it‚Äôs easy to get these coefficients.  At the same time, it is necessary to check 3 conditions: <br><br><img src="https://habrastorage.org/files/32a/954/0c7/32a9540c7eae472aad79623806006c62.gif"><br><img src="https://habrastorage.org/files/78d/898/1a4/78d8981a4f814f838c82e9b1c7f6cf1e.gif"><br><img src="https://habrastorage.org/files/0a3/f9d/cf6/0a3f9dcf67a348e3900a4f5d6c2336c1.gif"><br><br>  All this refers to the coefficients that define the linear transformation.  The remaining two <img src="https://habrastorage.org/files/466/be3/8f4/466be38f400348adaf58450344726a6a.gif">  and <img src="https://habrastorage.org/files/2be/c16/22a/2bec1622a29549f7848bd142880bf544.gif">  , perform translation - moving a point some distance.  It is desirable that <img src="https://habrastorage.org/files/6da/18d/e75/6da18de753ce4e2cb6240474c568d72c.gif">  , <img src="https://habrastorage.org/files/689/67a/db5/68967adb55484926a0baa4235f81008b.gif">  , <img src="https://habrastorage.org/files/7d2/267/110/7d22671101214e35886f49e4c6f3f0fe.gif">  and <img src="https://habrastorage.org/files/ce9/9c0/021/ce99c0021628462caec8c946ede58d23.gif">  were on the segment <img src="https://habrastorage.org/files/b36/ebf/582/b36ebf5827d943fc8cdb02084ba306d5.gif">  or <img src="https://habrastorage.org/files/9cc/1f6/c72/9cc1f6c723c04e9887d5ccf6dd34adec.gif">  .  For <img src="https://habrastorage.org/files/466/be3/8f4/466be38f400348adaf58450344726a6a.gif">  and <img src="https://habrastorage.org/files/2be/c16/22a/2bec1622a29549f7848bd142880bf544.gif">  This is not necessary, but you should not set a too large segment, otherwise the image will be sparse. <br><br>  In addition, along with each set of coefficients, you need to save the starting values ‚Äã‚Äãof the three color components of the RGB model, which will be assigned to the pixel that was hit for the first time.  This is also done using a random number sensor and does not pose any special difficulties. <br><br>  Now you need to decide what image of resolution you want to receive and prepare an array of pixels, each element of which will store: <br><br><ul><li>  x and y coordinates; </li><li>  R, G and B values; </li><li>  number of hits. </li></ul><br>  The following are some non-linear transformations that will be performed on the x and y values ‚Äã‚Äãobtained after performing one of the affine transformations: <br><br><ol><li>  Sinusoidal: <img src="https://habrastorage.org/files/57d/968/b0f/57d968b0fbf34857893976ff088bbdbf.gif">  , <img src="https://habrastorage.org/files/4e6/c91/0b9/4e6c910b985a4484aaedbae4384cddca.gif">  ; </li><li>  Spherical: <img src="https://habrastorage.org/files/79b/e94/63b/79be9463be864f52b959e5fa36ae50aa.gif">  , <img src="https://habrastorage.org/files/654/d76/f71/654d76f7136d4a0b90694e73ef3d3e6b.gif">  ; </li><li>  Polar: <img src="https://habrastorage.org/files/61b/07e/48c/61b07e48c682496aa1f16d7e755118db.gif">  , <img src="https://habrastorage.org/files/38c/92c/c1b/38c92cc1bebf43db85b18e2db878349f.gif">  ; </li><li>  A heart: <img src="https://habrastorage.org/files/be6/f0a/290/be6f0a2909134c65851b95c69d7a7e87.gif">  , <img src="https://habrastorage.org/files/747/7e9/69c/7477e969c04f4fa5af80c59d8e273288.gif">  ; </li><li>  Disk: <img src="https://habrastorage.org/files/54f/8de/d86/54f8ded867174338ba56d632e2085188.gif">  , <img src="https://habrastorage.org/files/04e/9ae/121/04e9ae1216494c9eb2ba0784eb507dec.gif">  ; </li></ol><br>  At the end of the article - examples of images obtained using these and some other transformations, and further - pseudo-code rendering procedure: <br><br><pre><code class="hljs markdown">void render(int n, int eqCount, int it, int xRes, int yRes) {  eqCount     ; for(int num=0; num<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">n;</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">num</span></span></span></span><span class="xml"><span class="hljs-tag">++) { //   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1920</span></span></span></span><span class="xml"><span class="hljs-tag"></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">1080</span></span></span></span><span class="xml"><span class="hljs-tag">  // </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">XMIN</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">-1.777,XMAX</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1.777,YMIN</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">-1,YMAX</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1</span></span></span></span><span class="xml"><span class="hljs-tag"> //              </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">newX</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">Rand(XMIN,XMAX);</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">newY</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">Rand(YMIN,YMAX);</span></span></span></span><span class="xml"><span class="hljs-tag"> // </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">20</span></span></span></span><span class="xml"><span class="hljs-tag">    , </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.</span></span></span></span><span class="xml"><span class="hljs-tag"></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.</span></span></span></span><span class="xml"><span class="hljs-tag">     </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">int</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">step</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">-20;</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">step</span></span></span></span><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">it</span></span></span></span><span class="xml"><span class="hljs-tag">; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">step</span></span></span></span><span class="xml"><span class="hljs-tag">++) { //     </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">Rand(0,eqCount);</span></span></span></span><span class="xml"><span class="hljs-tag"> //   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">coeff[i].a*newX+coeff[i].b*newY+coeff[i].c;</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">coeff[i].d*newX+coeff[i].e*newY+coeff[i].f;</span></span></span></span><span class="xml"><span class="hljs-tag">   ; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">step</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>=0 &amp;&amp; newX‚àà[<span class="hljs-string"><span class="hljs-string">XMIN,XMAX</span></span>] &amp;&amp; newY‚àà[<span class="hljs-string"><span class="hljs-string">YMIN,YMAX</span></span>]) { //  ,     x1=xRes-Trunc(((XMAX-newX)/(XMAX-XMIN))<span class="hljs-emphasis"><span class="hljs-emphasis">*xRes); y1=yRes-Trunc(((YMAX-newY)/(YMAX-YMIN))*</span></span>yRes); //      if(x1<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">xRes</span></span></span></span><span class="xml"><span class="hljs-tag"> &amp;&amp; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y1</span></span></span></span><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">yRes</span></span></span></span><span class="xml"><span class="hljs-tag">) { // ,       </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pixels</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x1</span></span></span></span><span class="xml"><span class="hljs-tag">][</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y1</span></span></span></span><span class="xml"><span class="hljs-tag">]</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.counter</span></span></span></span><span class="xml"><span class="hljs-tag">==</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">0)</span></span></span></span><span class="xml"><span class="hljs-tag"> { //   ,        </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pixels</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x1</span></span></span></span><span class="xml"><span class="hljs-tag">][</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y1</span></span></span></span><span class="xml"><span class="hljs-tag">]</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.red</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">coeff[i].red;</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pixels</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x1</span></span></span></span><span class="xml"><span class="hljs-tag">][</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y1</span></span></span></span><span class="xml"><span class="hljs-tag">]</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.green</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">coeff[i].green;</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pixels</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x1</span></span></span></span><span class="xml"><span class="hljs-tag">][</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y1</span></span></span></span><span class="xml"><span class="hljs-tag">]</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.blue</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">coeffs[i].blue;</span></span></span></span><span class="xml"><span class="hljs-tag"> } </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">else</span></span></span></span><span class="xml"><span class="hljs-tag"> { //    ,  </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pixels</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x1</span></span></span></span><span class="xml"><span class="hljs-tag">][</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y1</span></span></span></span><span class="xml"><span class="hljs-tag">]</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.red</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">(pixels[x1][y1].red+coeff[i].red)/2;</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pixels</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x1</span></span></span></span><span class="xml"><span class="hljs-tag">][</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y1</span></span></span></span><span class="xml"><span class="hljs-tag">]</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.green</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">(pixels[x1][y1].green+coeff[i].green)/2;</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pixels</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x1</span></span></span></span><span class="xml"><span class="hljs-tag">][</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y1</span></span></span></span><span class="xml"><span class="hljs-tag">]</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.blue</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">(pixels[x1][y1].blue+coeff[i].blue)/2;</span></span></span></span><span class="xml"><span class="hljs-tag"> } //     </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pixels</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x1</span></span></span></span><span class="xml"><span class="hljs-tag">][</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">y1</span></span></span></span><span class="xml"><span class="hljs-tag">]</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.counter</span></span></span></span><span class="xml"><span class="hljs-tag">++; } } } } }</span></span></span></span></code> </pre> <br>  So, now you can display our image, but the result in this case will be too noisy, since the brightness of all pixels is the same.  To fix this, it is necessary to conduct a logarithmic and gamma correction, reflecting the number of hits at each point with the help of brightness.  Below is the code that performs the correction: <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">void</span></span> correction(<span class="hljs-type"><span class="hljs-type">int</span></span> xRes, <span class="hljs-type"><span class="hljs-type">int</span></span> yRes) { max=<span class="hljs-number"><span class="hljs-number">0.0</span></span>; gamma=<span class="hljs-number"><span class="hljs-number">2.2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>&lt;xRes; <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> col=<span class="hljs-number"><span class="hljs-number">0</span></span>; col&lt;yRes; col++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pixels[<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>][col].counter != <span class="hljs-number"><span class="hljs-number">0</span></span>) { pixels[<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>][col].normal=log10(pixels[<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>][col].counter); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pixels[<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>][col].normal&gt;max) max = pixels[<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>][col].normal; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>&lt;xRes; <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> col=<span class="hljs-number"><span class="hljs-number">0</span></span>; col&lt;yRes; col++) { pixels[<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>][col].normal/=max; pixels[<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>][col].red =pixels[<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>][col].red*pow(pixels[<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>][col].normal,(<span class="hljs-number"><span class="hljs-number">1.0</span></span> / gamma)); pixels[<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>][col].green =pixels[<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>][col].green*pow(pixels[<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>][col].normal,(<span class="hljs-number"><span class="hljs-number">1.0</span></span> / gamma)); pixels[<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>][col].blue =pixels[<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>][col].blue*pow(pixels[<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>][col].normal,(<span class="hljs-number"><span class="hljs-number">1.0</span></span> / gamma)); } }</code> </pre><br><div class="spoiler">  <b class="spoiler_title">The difference between the image without correction (above) and with correction (below)</b> <div class="spoiler_text"><img src="//habrastorage.org/files/ba2/8d4/cb4/ba28d4cb4d6e45a4983135bdc2b54d5c.png"><br><br><img src="//habrastorage.org/files/b4f/a90/834/b4fa908348414161825b1c6b97b9d0f1.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Well, now the promised images with various non-linear transformations</b> <div class="spoiler_text">  <i>Sinusoidal</i> <br><br><img src="//habrastorage.org/files/4f3/102/2d9/4f31022d9ea347f4a74e134e56c07dc9.png"><br><br>  <i>Spherical</i> <br><br><img src="//habrastorage.org/files/416/14c/64a/41614c64a2bc4fefb8a1ba5ef9486798.png"><br><br>  <i>Polar</i> <br><br><img src="//habrastorage.org/files/bb4/334/3d7/bb43343d757d43b9ac745fe951452d05.png"><br><br>  <i>A heart</i> <br><br><img src="//habrastorage.org/files/ab2/648/fa4/ab2648fa496d4875b10d39da02503016.png"><br><br>  <i>Disk</i> <br><br><img src="//habrastorage.org/files/b05/b62/155/b05b621551fc41e5aae6407c63494cb9.png"><br><br>  <i>"Shell"</i> <br><br><img src="//habrastorage.org/files/f82/d59/6dc/f82d596dc3794da99662e148c3c0a933.png"><br><br>  <i>Hyperbolic</i> <br><br><img src="//habrastorage.org/files/c91/b8b/fca/c91b8bfca2884d2ea8bbd3874b090530.png"><br><br>  <i>Whirlpool</i> <br><br><img src="//habrastorage.org/files/5f3/057/45b/5f305745bc034a279bdff932e850b05d.png"><br><br>  <i>Waves</i> <br><br><img src="//habrastorage.org/files/fd6/c5b/08f/fd6c5b08f20549ee913640091574cafb.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">And what if we apply not the same nonlinear transformation, but randomly choose from several?</b> <div class="spoiler_text"><img src="//habrastorage.org/files/539/8f2/d88/5398f2d88f64468faaf8e143d574ce98.png"><br><br><img src="//habrastorage.org/files/25d/625/d99/25d625d9947b42e19d2ad91b8f32cc96.png"><br><br><img src="//habrastorage.org/files/034/758/83d/03475883d42344d7bd4e66d2565a3534.png"><br><br><img src="//habrastorage.org/files/635/c83/a4a/635c83a4ad004409b39322269527b869.png"><br><br><img src="//habrastorage.org/files/e39/272/c35/e39272c3592a42a2ab9d0556c617faeb.png"><br></div></div><br><h3>  Source </h3><br>  The implementation of the algorithm from James McCarthy in the C language is <a href="https://github.com/jameswmccarty/Fractal-Flame-Algorithm-in-C">here</a> , and the article by Scott Draves on the basis of which the algorithm was created is <a href="http://flam3.com/flame.pdf">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/251537/">https://habr.com/ru/post/251537/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../251525/index.html">How we "married" cloud PBX, GSM and realtors (part 2)</a></li>
<li><a href="../251529/index.html">Vagrant for kids, or as on Windows it is easy to get a customized server for developing web applications</a></li>
<li><a href="../251531/index.html">Formatting Python Code</a></li>
<li><a href="../251533/index.html">Market growth, games from The Sun, Angry Birds in Chinese - and other news of the week for a mobile developer</a></li>
<li><a href="../251535/index.html">How to create 40% more sales in the online store using cashback services</a></li>
<li><a href="../251539/index.html">Another thermostat on Arduino, but with OpenTherm</a></li>
<li><a href="../251541/index.html">Merge Proxmox nodes into a cluster using OpenVPN</a></li>
<li><a href="../251543/index.html">We add MVP to games on Unity3D</a></li>
<li><a href="../251545/index.html">Creating a system for blogging and working with documentation: The experience of the Kato messenger team</a></li>
<li><a href="../251547/index.html">Secure cisco</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>