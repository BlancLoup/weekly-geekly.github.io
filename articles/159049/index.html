<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Shamoon - what was it?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Computer systems of the oil company Saudi Aramco on August 15, 2012 were attacked, its details were not disclosed. It was reported that the company re...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Shamoon - what was it?</h1><div class="post__text post__text-html js-mediator-article">  Computer systems of the oil company Saudi Aramco on August 15, 2012 were attacked, its details were not disclosed.  It was reported that the company returned to normal operation after 10 days.  On October 11, 2012, US Defense Secretary Leon Panetta, speaking at a conference on cyber security in New York, <a href="http://www.reuters.com/article/2012/10/12/usa-cyber-pentagon-shimoon-idAFL1E8LBKY020121012">reported</a> that the computers of Saudi Aramco and the Qatar gas production company RasGas had been attacked by the Shamoon malware.  Some senior US officials claim that Shamoon is of Iranian origin, but they have no direct evidence of this.  The Iranian government, in turn, insists on conducting an official international investigation into the Shamoon attack.  Akhavan Bahabadi (Mahdi Akhavan Bahabadi) - Secretary of the National Center, which deals with the cyberspace of Iran, confirmed that, in their opinion, this kind of statements of Americans are connected with political motives, more precisely with the upcoming elections for the presidency of the United States. <br><br>  Responsibility for the attack on Saudi Aramco claimed the hacking group The Cutting Sword of Justice (Hacker), motivating its act for political reasons, accusing Saudi Arabia of organizing unrest in Syria and Bahrain.  According to unverified information posted allegedly by the initiators of the attack on <a href="http://pastebin.com/tztnRLQG">pastedbin.com</a> , more than 30,000 computers were infected in Saudi Aramco. <br><br>  Shamoon samples were analyzed in detail by Kaspersky Lab employees, the first <a href="http://www.securelist.com/ru/blog%3Fprint_mode%3D1%26amp%3Bweblogid%3D207764145">article</a> was published on August 21.  The experts concluded that the attack was a point character, the samples were not recorded in the KSN (Kaspersky Security Network).  VPO contains several modules.  Inside one of them there is a line: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      'C: \ Shamoon \ ArabianGulf \ wiper \ release \ wiper.pdb'.  The main functionality of the program is destructive.  Many online media publish incorrect information that Shamoon collects information and sends it to a remote server. <br><a name="habracut"></a><br>  Shamoon can take 2 teams from the command center: <br>  1. run the file downloaded from the server; <br>  2. Set the time to 'destroy' files. <br><br>  The address of the command center is either the symbolic name 'home' or the IP address 10.1.252.19.  It is noteworthy that this is the so-called internal address, belonging to a special range 10.0.0.0/8, not used on the Internet.  The full URL for communication with the command center looks like this: <em><a href="">&lt;</a> management <a href="">server</a> &gt; /ajax_modal/modal/data.asp?mydata = &lt;_ iteration&gt; &amp; uid = &lt;local IP&gt; &amp; state = &lt;random number&gt;</em> .  This may indicate that the server should be deployed based on the Internet Information Service. <br><br>  Due to the author's error, the launch function of the downloaded file does not work, because the name of the local file is incorrectly generated when it is saved. <br><br>  VPO periodically checks whether a specific date has arrived.  The date can be specified via the command center, otherwise the date specified inside the code, August 15th, 2012 at 08:08 UTC, is used.  It should be noted that the author also made an error in the implementation of the time check function, which, however, does not interfere with the planned actions - the destruction of information at a specified time.  The list of files for destruction is preliminarily formed on the basis of specified templates, for example, files in user profiles or files with ini or sys extensions are searched.  As a result, two files 'f1.inf' and 'f2.inf' are created in the% WINDIR% \ System32 directory.  They contain full paths to files that are filled with garbage for the impossibility of recovery.  Garbage is a fragment (192 Kbytes) of JPEG images of a burning USA star-flag that can be easily found via Google.  Apparently, it was conceived by the author and may indicate some "political background" of the attack.  The last is erased MBR.  This requires direct disk access, blocked in Windows Vista and higher.  To provide it, Shamoon uses the legal signed driver from Eldos's RawDisk software, the approach described in the <a href="http://www.insidepro.com/kk/270/270r.shtml">article</a> on insidepro.com.  The driver requires an authorization key to work.  The key used in Shamoon is a trial one, so every time the driver functions are called, the current system time is translated to a random date from August 1st to August 20th, 2012.  These errors and implementation features allow us to conclude that Shamoon is not a highly qualified programmer. <br><br>  For self-replication, Shamoon tries to copy itself into the administrative resources created by the Windows operating system by default - ADMIN $, C $, D $, E $.  In case of success, the task is created using the NetScheduleJobAdd function, which allows subsequent autorun on the remote computer.  Naturally, these actions require domain administrator rights.  The list of IP addresses is taken either from the command line parameters, or formed from the current IP address, setting the values ‚Äã‚Äãof the last octet in the 1-254 range (brute force). <br><br>  In September 2012, Symantec published <a href="http://www.symantec.com/connect/blogs/shamoon-attacks-continue">information</a> about the discovery of a new version of Shamoon, modifications are cosmetic.  So, some lines are replaced, for example file lists are called 'data.dat' and 's_data.dat' instead of 'f1.inf' and 'f2.inf'.  The remote launch method via NetScheduleJobAdd has been replaced by the use of psexec.exe, garbage for recording is generated randomly instead of using a part of the image, according to <a href="http://home.mcafee.com/virusinfo/virusprofile.aspx%3Fkey%3D1504902">information</a> from McAfee. <br><br>  We can assume the following version: the attackers gained control over one of the domain controllers inside the organization's network perimeter, studied the network topology and obtained a list of IP addresses (Shamoon provides for the transfer of a list of IP addresses via command line parameters).  The script for managing the time of destruction was placed on one of the internal servers and its address (10.1.252.19) was encoded inside the malware.  The presence of domain administrator rights allowed to solve the problem of mass distribution of malware through administrative resources.  There are no reliable data that Saudi Aramco hit Shamoon and more than 30,000 computers were infected (for example, the address 10.1.252.19 is not in the lists posted on pastedbin.com), however, this explains how Shamoon could infect such a large number of computers without no means of exploiting network service vulnerabilities.  In addition, there was no need to program the information collection function, since this could be done by standard OS tools, having the appropriate rights.  So, on the one hand, this is the APT attack, on the other hand, the level of its preparation is not high enough. </div><p>Source: <a href="https://habr.com/ru/post/159049/">https://habr.com/ru/post/159049/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../159027/index.html">CSS sprites: basic techniques and useful tools</a></li>
<li><a href="../159029/index.html">The easiest way to use Hulu, Pandora, etc. without any VPN</a></li>
<li><a href="../159041/index.html">Google and Apple are going to put up</a></li>
<li><a href="../159045/index.html">We transfer ORG.UA to the registrar for free</a></li>
<li><a href="../159047/index.html">A 60-day trial version of Microsoft Office 2013 has become available.</a></li>
<li><a href="../159053/index.html">And again about Stuxnet</a></li>
<li><a href="../159055/index.html">What do you know about Sality?</a></li>
<li><a href="../159057/index.html">Layout like Metro UI</a></li>
<li><a href="../159059/index.html">Wave closings provider DC ++</a></li>
<li><a href="../159071/index.html">JavaScript SIP library from the authors of the standard</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>