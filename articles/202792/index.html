<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Data copying of Web and Firewall databases of MS TMG proxy server into MySQL database</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 
 It is convenient to watch the reports through the browser, the user does not need to install any programs. 
 For more convenient work with th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Data copying of Web and Firewall databases of MS TMG proxy server into MySQL database</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br>  It is convenient to watch the reports through the browser, the user does not need to install any programs. <br>  For more convenient work with the data of the Internet usage log (WEB) and the firewall log (FWS) of MS TMG server, you can upload them to the MySQL database.  You can write as many reports on this data.  To access the reports using a web interface. <br>  An example implementation under the cut. <br><a name="habracut"></a><br>  But, for a start, you need to copy the data itself from the SQL Server Express Edition server (the database is used by MS TMG server) to the MySQL database.  To do this, perform a bat file every night.  File contents: <br><pre><code class="dos hljs">cscript "<span class="hljs-built_in"><span class="hljs-built_in">start</span></span>.vbs" %<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  Contents of the start.vbs file: <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">On</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Resume</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> gsHelpFile = <span class="hljs-string"><span class="hljs-string">"c:\script\TMG\help.txt"</span></span> <span class="hljs-comment"><span class="hljs-comment">' &lt;--   help.txt      . 'const gbDebugModeON = false dim gsRunCmd gsNormalDate = fuNormalizeSystemDate(cStr(DateAdd("d", -1, Date))) ' &lt;--      ( ) if Wscript.Arguments.Count &gt;= 1 then if fuNeedHelp(lCase(Wscript.Arguments(0))) then fuTypeTextfile(gsHelpFile) WScript.Quit 0 else gsNormalDate = Wscript.Arguments(0) end if end if wscript.echo gsNormalDate Set WshShell = CreateObject("WScript.Shell") gsRunCmd = "get-TMGReports.bat " &amp; gsNormalDate wscript.echo gsRunCmd WshShell.Run gsRunCmd '   function fuNormalizeSystemDate(lsDate) 'wscript.echo "Function get: " &amp; lsDate lsNormalizeDate = lsDate if InStr(lsDate, ".") then lArrDate = Split(lsDate, ".") lsNormalizeDate = lArrDate(2) &amp; lArrDate(1) &amp; lArrDate(0) elseif InStr(lsDate, "/") then lArrDate = Split(lsDate, "/") lsNormalizeDate = fuCheckDatePart(lArrDate(2)) &amp; fuCheckDatePart(lArrDate(0)) &amp; fuCheckDatePart(lArrDate(1)) elseif InStr(lsDate, "\") then lArrDate = Split(lsDate, "\") lsNormalizeDate = fuCheckDatePart(lArrDate(2)) &amp; fuCheckDatePart(lArrDate(0)) &amp; fuCheckDatePart(lArrDate(1)) end if fuNormalizeSystemDate = lsNormalizeDate end function function fuNeedHelp(lsPar) lbFoo = false if InStr(lsPar, "-h") or InStr(lsPar, "help") or InStr(lsPar, "/h") or InStr(lsPar, "?") then lbFoo = true end if fuNeedHelp = lbFoo end function function fuTypeTextfile(lsTextfile) Set objFSO = CreateObject("Scripting.FileSystemObject") Set objTextFileShowHelp = objFSO.OpenTextFile(lsTextfile, 1) Do Until objTextFileShowHelp.AtEndOfStream wscript.echo objTextFileShowHelp.Readline Loop objTextFileShowHelp.Close end function function fuCheckDatePart(lsDate) lsNormalizeDate = lsDate if len(lsDate) &lt;= 1 then lsNormalizeDate = "0" &amp; lsDate end if fuCheckDatePart = lsNormalizeDate end function</span></span></code> </pre><br>  Contents of the get-TMGReports.bat file: <br><pre> <code class="dos hljs">bcp.exe "SELECT DISTINCT UrlDestHost,ClientUserName,SUM(processingtime) as processingtime,SUM(bytesrecvd) as bytesrecvd,SUM(bytessent) as bytessent,ClientIP FROM [ISALOG_%<span class="hljs-number"><span class="hljs-number">1</span></span>_WEB_000].[dbo].[WebProxyLog] where resultcode <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-number"><span class="hljs-number">12202</span></span>,<span class="hljs-number"><span class="hljs-number">12302</span></span>) GROUP BY ClientUserName,UrlDestHost,ClientIP" queryout "ISALOG_%<span class="hljs-number"><span class="hljs-number">1</span></span>_WEB_000.xls" -c -T -S TMG-SERVER\MSFW <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> ISALOG_%<span class="hljs-number"><span class="hljs-number">1</span></span>_WEB_000.xls \\WEB-SERVER\c$\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">1</span></span>\ISALOG_%<span class="hljs-number"><span class="hljs-number">1</span></span>_WEB_000_01.xls bcp.exe "SELECT DISTINCT UrlDestHost,ClientUserName,SUM(processingtime) as processingtime,SUM(bytesrecvd) as bytesrecvd,SUM(bytessent) as bytessent,ClientIP,<span class="hljs-built_in"><span class="hljs-built_in">convert</span></span>(varchar, logTime, <span class="hljs-number"><span class="hljs-number">108</span></span>),uri FROM [ISALOG_%<span class="hljs-number"><span class="hljs-number">1</span></span>_WEB_000].[dbo].[WebProxyLog] where resultcode <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-number"><span class="hljs-number">12202</span></span>,<span class="hljs-number"><span class="hljs-number">12302</span></span>) GROUP BY ClientUserName,UrlDestHost,ClientIP,<span class="hljs-built_in"><span class="hljs-built_in">convert</span></span>(varchar, logTime, <span class="hljs-number"><span class="hljs-number">108</span></span>),uri" queryout "ISALOG_%<span class="hljs-number"><span class="hljs-number">1</span></span>_WEB_000_FULL.xls" -c -T -S TMG-SERVER\MSFW <span class="hljs-built_in"><span class="hljs-built_in">move</span></span> ISALOG_%<span class="hljs-number"><span class="hljs-number">1</span></span>_WEB_000_FULL.xls \\WEB-SERVER\c$\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">2</span></span>\ISALOG_%<span class="hljs-number"><span class="hljs-number">1</span></span>_WEB_000_FULL_01.xls bcp.exe "SELECT [servername],[ClientUserName],[logTime],[Action],[resultcode],[rule],[protocol],[SourceIP],[SourcePort],[DestinationIP],[DestinationPort],[OriginalClientIP],[SourceNetwork],[DestinationNetwork],[ApplicationProtocol],[bytessent],[bytessentDelta],[bytesrecvd],[bytesrecvdDelta],[connectiontime],[connectiontimeDelta],[DestinationName],[ClientAgent],[sessionid],[connectionid],[InternalServiceInfo] FROM [ISALOG_%<span class="hljs-number"><span class="hljs-number">1</span></span>_FWS_000].[dbo].[FirewallLog] WHERE [ClientUserName] &lt;&gt; '-' AND [protocol] = 'TCP'" queryout "ISALOG_%<span class="hljs-number"><span class="hljs-number">1</span></span>_FWS_000.xls" -c -T -S TMG-SERVER\MSFW <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> ISALOG_%<span class="hljs-number"><span class="hljs-number">1</span></span>_FWS_000.xls \\WEB-SERVER\c$\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\fws\ISALOG_%<span class="hljs-number"><span class="hljs-number">1</span></span>_FWS_000_01.xls</code> </pre><br>  Scripts to create the necessary tables in the MySQL database: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXISTS</span></span> ISALOG_WEB_000 ( dt <span class="hljs-built_in"><span class="hljs-built_in">date</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, UrlDestHost <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">2048</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, ClientUserName <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">1024</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, processingtime <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, bytesrecvd <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, bytessent <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, ClientIP <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">64</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> ClientUserName (ClientUserName(<span class="hljs-number"><span class="hljs-number">1000</span></span>)), <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> UrlDestHost (UrlDestHost(<span class="hljs-number"><span class="hljs-number">1000</span></span>)), <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> dt (dt) ) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span>=MyISAM <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CHARSET</span></span>=cp1251 <span class="hljs-keyword"><span class="hljs-keyword">COMMENT</span></span>=<span class="hljs-string"><span class="hljs-string">'  01.01.2013'</span></span> <span class="hljs-comment"><span class="hljs-comment">/*!50100 PARTITION BY RANGE ( TO_DAYS(dt)) (PARTITION p2013_01 VALUES LESS THAN (735265) ENGINE = MyISAM, PARTITION p2013_02 VALUES LESS THAN (735293) ENGINE = MyISAM, PARTITION p2013_03 VALUES LESS THAN (735324) ENGINE = MyISAM, PARTITION p2013_04 VALUES LESS THAN (735354) ENGINE = MyISAM, PARTITION p2013_05 VALUES LESS THAN (735385) ENGINE = MyISAM, PARTITION p2013_06 VALUES LESS THAN (735415) ENGINE = MyISAM, PARTITION p2013_07 VALUES LESS THAN (735446) ENGINE = MyISAM, PARTITION p2013_08 VALUES LESS THAN (735477) ENGINE = MyISAM, PARTITION p2013_09 VALUES LESS THAN (735507) ENGINE = MyISAM, PARTITION p2013_10 VALUES LESS THAN (735538) ENGINE = MyISAM, PARTITION p2013_11 VALUES LESS THAN (735568) ENGINE = MyISAM, PARTITION p2013_12 VALUES LESS THAN (735599) ENGINE = MyISAM, PARTITION p2014_01 VALUES LESS THAN (735630) ENGINE = MyISAM, PARTITION p2014_02 VALUES LESS THAN (735658) ENGINE = MyISAM, PARTITION p2014_03 VALUES LESS THAN (735689) ENGINE = MyISAM, PARTITION p2014_04 VALUES LESS THAN (735719) ENGINE = MyISAM, PARTITION p2014_05 VALUES LESS THAN (735750) ENGINE = MyISAM, PARTITION p2014_06 VALUES LESS THAN (735780) ENGINE = MyISAM, PARTITION p2014_07 VALUES LESS THAN (735811) ENGINE = MyISAM, PARTITION p2014_08 VALUES LESS THAN (735842) ENGINE = MyISAM, PARTITION p2014_09 VALUES LESS THAN (735872) ENGINE = MyISAM, PARTITION p2014_10 VALUES LESS THAN (735903) ENGINE = MyISAM, PARTITION p2014_11 VALUES LESS THAN (735933) ENGINE = MyISAM, PARTITION p2014_12 VALUES LESS THAN (735964) ENGINE = MyISAM, PARTITION p2015_01 VALUES LESS THAN (735995) ENGINE = MyISAM, PARTITION p2015_02 VALUES LESS THAN (736023) ENGINE = MyISAM, PARTITION p2015_03 VALUES LESS THAN (736054) ENGINE = MyISAM, PARTITION p2015_04 VALUES LESS THAN (736084) ENGINE = MyISAM, PARTITION p2015_05 VALUES LESS THAN (736115) ENGINE = MyISAM, PARTITION p2015_06 VALUES LESS THAN (736145) ENGINE = MyISAM, PARTITION p2015_07 VALUES LESS THAN (736176) ENGINE = MyISAM, PARTITION p2015_08 VALUES LESS THAN (736207) ENGINE = MyISAM, PARTITION p2015_09 VALUES LESS THAN (736237) ENGINE = MyISAM, PARTITION p2015_10 VALUES LESS THAN (736268) ENGINE = MyISAM, PARTITION p2015_11 VALUES LESS THAN (736298) ENGINE = MyISAM, PARTITION p2015_12 VALUES LESS THAN (736329) ENGINE = MyISAM, PARTITION p2016_01 VALUES LESS THAN (736360) ENGINE = MyISAM, PARTITION p2016_02 VALUES LESS THAN (736389) ENGINE = MyISAM, PARTITION p2016_03 VALUES LESS THAN (736420) ENGINE = MyISAM, PARTITION p2016_04 VALUES LESS THAN (736450) ENGINE = MyISAM, PARTITION p2016_05 VALUES LESS THAN (736481) ENGINE = MyISAM, PARTITION p2016_06 VALUES LESS THAN (736511) ENGINE = MyISAM, PARTITION p2016_07 VALUES LESS THAN (736542) ENGINE = MyISAM, PARTITION p2016_08 VALUES LESS THAN (736573) ENGINE = MyISAM, PARTITION p2016_09 VALUES LESS THAN (736603) ENGINE = MyISAM, PARTITION p2016_10 VALUES LESS THAN (736634) ENGINE = MyISAM, PARTITION p2016_11 VALUES LESS THAN (736664) ENGINE = MyISAM, PARTITION p2016_12 VALUES LESS THAN (736695) ENGINE = MyISAM, PARTITION p2017 VALUES LESS THAN MAXVALUE ENGINE = MyISAM) */</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXISTS</span></span> ISALOG_WEB_000_FULL ( dt <span class="hljs-built_in"><span class="hljs-built_in">date</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, UrlDestHost <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">2048</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, ClientUserName <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">1024</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, processingtime <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, bytesrecvd <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, bytessent <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, ClientIP <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">64</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, tm <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, uri <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">2048</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> ClientUserName (ClientUserName(<span class="hljs-number"><span class="hljs-number">1000</span></span>)), <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> UrlDestHost (UrlDestHost(<span class="hljs-number"><span class="hljs-number">1000</span></span>)), <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> dt (dt) ) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span>=MyISAM <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CHARSET</span></span>=cp1251 <span class="hljs-keyword"><span class="hljs-keyword">COMMENT</span></span>=<span class="hljs-string"><span class="hljs-string">'  19.07.2013'</span></span> <span class="hljs-comment"><span class="hljs-comment">/*!50100 PARTITION BY RANGE ( TO_DAYS(dt)) (PARTITION p2013_01 VALUES LESS THAN (735265) ENGINE = MyISAM, PARTITION p2013_02 VALUES LESS THAN (735293) ENGINE = MyISAM, PARTITION p2013_03 VALUES LESS THAN (735324) ENGINE = MyISAM, PARTITION p2013_04 VALUES LESS THAN (735354) ENGINE = MyISAM, PARTITION p2013_05 VALUES LESS THAN (735385) ENGINE = MyISAM, PARTITION p2013_06 VALUES LESS THAN (735415) ENGINE = MyISAM, PARTITION p2013_07 VALUES LESS THAN (735446) ENGINE = MyISAM, PARTITION p2013_08 VALUES LESS THAN (735477) ENGINE = MyISAM, PARTITION p2013_09 VALUES LESS THAN (735507) ENGINE = MyISAM, PARTITION p2013_10 VALUES LESS THAN (735538) ENGINE = MyISAM, PARTITION p2013_11 VALUES LESS THAN (735568) ENGINE = MyISAM, PARTITION p2013_12 VALUES LESS THAN (735599) ENGINE = MyISAM, PARTITION p2014_01 VALUES LESS THAN (735630) ENGINE = MyISAM, PARTITION p2014_02 VALUES LESS THAN (735658) ENGINE = MyISAM, PARTITION p2014_03 VALUES LESS THAN (735689) ENGINE = MyISAM, PARTITION p2014_04 VALUES LESS THAN (735719) ENGINE = MyISAM, PARTITION p2014_05 VALUES LESS THAN (735750) ENGINE = MyISAM, PARTITION p2014_06 VALUES LESS THAN (735780) ENGINE = MyISAM, PARTITION p2014_07 VALUES LESS THAN (735811) ENGINE = MyISAM, PARTITION p2014_08 VALUES LESS THAN (735842) ENGINE = MyISAM, PARTITION p2014_09 VALUES LESS THAN (735872) ENGINE = MyISAM, PARTITION p2014_10 VALUES LESS THAN (735903) ENGINE = MyISAM, PARTITION p2014_11 VALUES LESS THAN (735933) ENGINE = MyISAM, PARTITION p2014_12 VALUES LESS THAN (735964) ENGINE = MyISAM, PARTITION p2015_01 VALUES LESS THAN (735995) ENGINE = MyISAM, PARTITION p2015_02 VALUES LESS THAN (736023) ENGINE = MyISAM, PARTITION p2015_03 VALUES LESS THAN (736054) ENGINE = MyISAM, PARTITION p2015_04 VALUES LESS THAN (736084) ENGINE = MyISAM, PARTITION p2015_05 VALUES LESS THAN (736115) ENGINE = MyISAM, PARTITION p2015_06 VALUES LESS THAN (736145) ENGINE = MyISAM, PARTITION p2015_07 VALUES LESS THAN (736176) ENGINE = MyISAM, PARTITION p2015_08 VALUES LESS THAN (736207) ENGINE = MyISAM, PARTITION p2015_09 VALUES LESS THAN (736237) ENGINE = MyISAM, PARTITION p2015_10 VALUES LESS THAN (736268) ENGINE = MyISAM, PARTITION p2015_11 VALUES LESS THAN (736298) ENGINE = MyISAM, PARTITION p2015_12 VALUES LESS THAN (736329) ENGINE = MyISAM, PARTITION p2016_01 VALUES LESS THAN (736360) ENGINE = MyISAM, PARTITION p2016_02 VALUES LESS THAN (736389) ENGINE = MyISAM, PARTITION p2016_03 VALUES LESS THAN (736420) ENGINE = MyISAM, PARTITION p2016_04 VALUES LESS THAN (736450) ENGINE = MyISAM, PARTITION p2016_05 VALUES LESS THAN (736481) ENGINE = MyISAM, PARTITION p2016_06 VALUES LESS THAN (736511) ENGINE = MyISAM, PARTITION p2016_07 VALUES LESS THAN (736542) ENGINE = MyISAM, PARTITION p2016_08 VALUES LESS THAN (736573) ENGINE = MyISAM, PARTITION p2016_09 VALUES LESS THAN (736603) ENGINE = MyISAM, PARTITION p2016_10 VALUES LESS THAN (736634) ENGINE = MyISAM, PARTITION p2016_11 VALUES LESS THAN (736664) ENGINE = MyISAM, PARTITION p2016_12 VALUES LESS THAN (736695) ENGINE = MyISAM, PARTITION p2017 VALUES LESS THAN MAXVALUE ENGINE = MyISAM) */</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXISTS</span></span> ISALOG_FWS_000 ( dt <span class="hljs-built_in"><span class="hljs-built_in">date</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, tm <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, servername <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">128</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, ClientUserName <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">514</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-string"><span class="hljs-string">`Action`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, resultcode <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, rule <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">128</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, protocol <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">32</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, SourceIP <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">64</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, SourcePort <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">6</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, DestinationIP <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">64</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, DestinationPort <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">6</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, OriginalClientIP <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">64</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, SourceNetwork <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">128</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, DestinationNetwork <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">128</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, ApplicationProtocol <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">128</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, bytessent <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, bytessentDelta <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, bytesrecvd <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, bytesrecvdDelta <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, connectiontime <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, connectiontimeDelta <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, DestinationName <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, ClientAgent <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, sessionid <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, connectionid <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, InternalServiceInfo <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">6</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> ClientUserName (ClientUserName), <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> dt (dt) ) <span class="hljs-keyword"><span class="hljs-keyword">ENGINE</span></span>=MyISAM <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CHARSET</span></span>=cp1251 <span class="hljs-comment"><span class="hljs-comment">/*!50100 PARTITION BY RANGE ( TO_DAYS(dt)) (PARTITION p2013_01 VALUES LESS THAN (735265) ENGINE = MyISAM, PARTITION p2013_02 VALUES LESS THAN (735293) ENGINE = MyISAM, PARTITION p2013_03 VALUES LESS THAN (735324) ENGINE = MyISAM, PARTITION p2013_04 VALUES LESS THAN (735354) ENGINE = MyISAM, PARTITION p2013_05 VALUES LESS THAN (735385) ENGINE = MyISAM, PARTITION p2013_06 VALUES LESS THAN (735415) ENGINE = MyISAM, PARTITION p2013_07 VALUES LESS THAN (735446) ENGINE = MyISAM, PARTITION p2013_08 VALUES LESS THAN (735477) ENGINE = MyISAM, PARTITION p2013_09 VALUES LESS THAN (735507) ENGINE = MyISAM, PARTITION p2013_10 VALUES LESS THAN (735538) ENGINE = MyISAM, PARTITION p2013_11 VALUES LESS THAN (735568) ENGINE = MyISAM, PARTITION p2013_12 VALUES LESS THAN (735599) ENGINE = MyISAM, PARTITION p2014_01 VALUES LESS THAN (735630) ENGINE = MyISAM, PARTITION p2014_02 VALUES LESS THAN (735658) ENGINE = MyISAM, PARTITION p2014_03 VALUES LESS THAN (735689) ENGINE = MyISAM, PARTITION p2014_04 VALUES LESS THAN (735719) ENGINE = MyISAM, PARTITION p2014_05 VALUES LESS THAN (735750) ENGINE = MyISAM, PARTITION p2014_06 VALUES LESS THAN (735780) ENGINE = MyISAM, PARTITION p2014_07 VALUES LESS THAN (735811) ENGINE = MyISAM, PARTITION p2014_08 VALUES LESS THAN (735842) ENGINE = MyISAM, PARTITION p2014_09 VALUES LESS THAN (735872) ENGINE = MyISAM, PARTITION p2014_10 VALUES LESS THAN (735903) ENGINE = MyISAM, PARTITION p2014_11 VALUES LESS THAN (735933) ENGINE = MyISAM, PARTITION p2014_12 VALUES LESS THAN (735964) ENGINE = MyISAM, PARTITION p2015_01 VALUES LESS THAN (735995) ENGINE = MyISAM, PARTITION p2015_02 VALUES LESS THAN (736023) ENGINE = MyISAM, PARTITION p2015_03 VALUES LESS THAN (736054) ENGINE = MyISAM, PARTITION p2015_04 VALUES LESS THAN (736084) ENGINE = MyISAM, PARTITION p2015_05 VALUES LESS THAN (736115) ENGINE = MyISAM, PARTITION p2015_06 VALUES LESS THAN (736145) ENGINE = MyISAM, PARTITION p2015_07 VALUES LESS THAN (736176) ENGINE = MyISAM, PARTITION p2015_08 VALUES LESS THAN (736207) ENGINE = MyISAM, PARTITION p2015_09 VALUES LESS THAN (736237) ENGINE = MyISAM, PARTITION p2015_10 VALUES LESS THAN (736268) ENGINE = MyISAM, PARTITION p2015_11 VALUES LESS THAN (736298) ENGINE = MyISAM, PARTITION p2015_12 VALUES LESS THAN (736329) ENGINE = MyISAM, PARTITION p2016_01 VALUES LESS THAN (736360) ENGINE = MyISAM, PARTITION p2016_02 VALUES LESS THAN (736389) ENGINE = MyISAM, PARTITION p2016_03 VALUES LESS THAN (736420) ENGINE = MyISAM, PARTITION p2016_04 VALUES LESS THAN (736450) ENGINE = MyISAM, PARTITION p2016_05 VALUES LESS THAN (736481) ENGINE = MyISAM, PARTITION p2016_06 VALUES LESS THAN (736511) ENGINE = MyISAM, PARTITION p2016_07 VALUES LESS THAN (736542) ENGINE = MyISAM, PARTITION p2016_08 VALUES LESS THAN (736573) ENGINE = MyISAM, PARTITION p2016_09 VALUES LESS THAN (736603) ENGINE = MyISAM, PARTITION p2016_10 VALUES LESS THAN (736634) ENGINE = MyISAM, PARTITION p2016_11 VALUES LESS THAN (736664) ENGINE = MyISAM, PARTITION p2016_12 VALUES LESS THAN (736695) ENGINE = MyISAM, PARTITION p2017 VALUES LESS THAN MAXVALUE ENGINE = MyISAM) */</span></span>;</code> </pre>  I made the tables partitioned by months.  Made indexes by user and date. <br><br>  On the web server, you need to install <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D24659">logparser</a> . <br>  The script on the web server copies the data to the MySQL database. <br>  Contents of the bat file: <br><pre> <code class="dos hljs">logparser "select * into c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">1</span></span>\<span class="hljs-number"><span class="hljs-number">2012</span></span>.xls from c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">1</span></span>\ISALOG_201*.xls" -i:csv -headerRow:OFF -o:tsv -oSeparator:tab cscript //nologo "c:\script\TMG\Scripts\make-reportFile.vbs" c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">1</span></span>\<span class="hljs-number"><span class="hljs-number">2012</span></span>.xls c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">1</span></span>\ISALOG_WEB_000.csv logparser "select * into c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">2</span></span>\<span class="hljs-number"><span class="hljs-number">2012</span></span>.xls from c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">2</span></span>\ISALOG_201*.xls" -i:csv -headerRow:OFF -o:tsv -oSeparator:tab cscript //nologo "c:\script\TMG\Scripts\make-reportFile-full.vbs" c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">2</span></span>\<span class="hljs-number"><span class="hljs-number">2012</span></span>.xls c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">2</span></span>\ISALOG_WEB_000_FULL.csv logparser "select * into c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\fws\<span class="hljs-number"><span class="hljs-number">2012</span></span>.xls from c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\fws\ISALOG_201*.xls" -i:csv -headerRow:OFF -o:tsv -oSeparator:tab cscript //nologo "c:\script\TMG\Scripts\make-reportFile-fws.vbs" c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\fws\<span class="hljs-number"><span class="hljs-number">2012</span></span>.xls c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\fws\ISALOG_FWS_000.csv <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">1</span></span>\<span class="hljs-number"><span class="hljs-number">2012</span></span>.xls <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">2</span></span>\<span class="hljs-number"><span class="hljs-number">2012</span></span>.xls <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\fws\<span class="hljs-number"><span class="hljs-number">2012</span></span>.xls <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span>\ <span class="hljs-built_in"><span class="hljs-built_in">subst</span></span> Z: e:\WebServers Z: <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span>\ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> usr\local\mysql-<span class="hljs-number"><span class="hljs-number">5</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>\bin\ mysqlimport.exe -u username -p12345678 --fields-terminated-by=\t --fields-enclosed-by="" --fields-escaped-by=\ --lines-terminated-by=\n --local my_base c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">1</span></span>\ISALOG_WEB_000.csv mysqlimport.exe -u username -p12345678 --fields-terminated-by=\t --fields-enclosed-by="" --fields-escaped-by=\ --lines-terminated-by=\n --local my_base c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">2</span></span>\ISALOG_WEB_000_FULL.csv mysqlimport.exe -u username -p12345678 --fields-terminated-by=\t --fields-enclosed-by="" --fields-escaped-by=\ --lines-terminated-by=\n --local my_base c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\fws\ISALOG_FWS_000.csv <span class="hljs-built_in"><span class="hljs-built_in">move</span></span> c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">1</span></span>\ISALOG_201*.xls e:\Export\<span class="hljs-number"><span class="hljs-number">2013</span></span> <span class="hljs-built_in"><span class="hljs-built_in">move</span></span> c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">2</span></span>\ISALOG_201*.xls e:\Export\<span class="hljs-number"><span class="hljs-number">2013</span></span> <span class="hljs-built_in"><span class="hljs-built_in">move</span></span> c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\fws\ISALOG_201*.xls e:\Export\<span class="hljs-number"><span class="hljs-number">2013</span></span> <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">1</span></span>\ISALOG_WEB_000.csv <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\<span class="hljs-number"><span class="hljs-number">2</span></span>\ISALOG_WEB_000_FULL.csv <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> c:\script\TMG\Export\<span class="hljs-number"><span class="hljs-number">2012</span></span>\fws\ISALOG_FWS_000.csv</code> </pre><br>  The contents of the auxiliary files. <br>  make-reportFile.vbs: <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">dim</span></span> gsDevider <span class="hljs-keyword"><span class="hljs-keyword">dim</span></span> record <span class="hljs-keyword"><span class="hljs-keyword">dim</span></span> recordResult <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Wscript.Arguments.Count = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> sgFilename = Wscript.Arguments(<span class="hljs-number"><span class="hljs-number">0</span></span>) sgFilenameResult = Wscript.Arguments(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> Wscript.Arguments.Count = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> sgFilename = Wscript.Arguments(<span class="hljs-number"><span class="hljs-number">0</span></span>) sgFilenameResult = <span class="hljs-string"><span class="hljs-string">"c:\script\TMG\Export\2012\1\ISALOG_WEB_000.csv"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> sgFilename = <span class="hljs-built_in"><span class="hljs-built_in">InputBox</span></span>(<span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) sgFilenameResult = <span class="hljs-built_in"><span class="hljs-built_in">InputBox</span></span>(<span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> gsDevider = VBTab record = <span class="hljs-string"><span class="hljs-string">""</span></span> recordResult = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objFSO = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"Scripting.FileSystemObject"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objTextFileOpen = objFSO.OpenTextFile(sgFilename, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objTextFileWrite = objFSO.CreateTextFile(sgFilenameResult, <span class="hljs-literal"><span class="hljs-literal">True</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Do</span></span> Until objTextFileOpen.AtEndOfStream record = <span class="hljs-built_in"><span class="hljs-built_in">trim</span></span>(objTextFileOpen.Readline) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">InStr</span></span>(record, <span class="hljs-string"><span class="hljs-string">"Filename RowNumber Field1"</span></span>) = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">inStr</span></span>(record, gsDevider) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> lArr = <span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(record, gsDevider) recordResult = fuNormalyzeDate(lArr(<span class="hljs-number"><span class="hljs-number">0</span></span>)) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">2</span></span>) &amp; gsDevider &amp; _ fuNormalyzeAccount(lArr(<span class="hljs-number"><span class="hljs-number">3</span></span>)) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">4</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">5</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">6</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">7</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> objTextFileWrite.WriteLine recordResult <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Loop</span></span> objTextFileWrite.Close objTextFileOpen.Close WScript.Echo <span class="hljs-string"><span class="hljs-string">"*   ."</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> fuRemoveExtention(lsFilename) lRes = lsFilename <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">InStr</span></span>(lsFilename, <span class="hljs-string"><span class="hljs-string">"."</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> lRes = <span class="hljs-built_in"><span class="hljs-built_in">Left</span></span>(lsFilename, <span class="hljs-built_in"><span class="hljs-built_in">Len</span></span>(lsFilename)<span class="hljs-number"><span class="hljs-number">-4</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> fuRemoveExtention = lRes <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> fuNormalyzeDate(lsDate) lRes = lsDate <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">InStr</span></span>(lsDate, <span class="hljs-string"><span class="hljs-string">"\"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> lArrDate = <span class="hljs-built_in"><span class="hljs-built_in">Split</span></span>(lsDate, <span class="hljs-string"><span class="hljs-string">"\"</span></span>) lRes = lArrDate(<span class="hljs-built_in"><span class="hljs-built_in">uBound</span></span>(lArrDate)) lArrDate = <span class="hljs-built_in"><span class="hljs-built_in">Split</span></span>(lRes, <span class="hljs-string"><span class="hljs-string">"_"</span></span>) lRes = lArrDate(<span class="hljs-number"><span class="hljs-number">1</span></span>) lRes = <span class="hljs-built_in"><span class="hljs-built_in">Left</span></span>(lRes, <span class="hljs-number"><span class="hljs-number">4</span></span>) &amp; <span class="hljs-string"><span class="hljs-string">"-"</span></span> &amp; <span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>(lRes, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) &amp; <span class="hljs-string"><span class="hljs-string">"-"</span></span> &amp; <span class="hljs-built_in"><span class="hljs-built_in">Right</span></span>(lRes, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> fuNormalyzeDate = lRes <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> fuNormalyzeAccount(lsAccount) lRes = lsAccount lRes = <span class="hljs-built_in"><span class="hljs-built_in">Replace</span></span>(lRes, <span class="hljs-string"><span class="hljs-string">"DOMAIN\"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) fuNormalyzeAccount = lRes <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span></code> </pre><br>  make-reportFile-full.vbs <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">dim</span></span> gsDevider <span class="hljs-keyword"><span class="hljs-keyword">dim</span></span> record <span class="hljs-keyword"><span class="hljs-keyword">dim</span></span> recordResult <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Wscript.Arguments.Count = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> sgFilename = Wscript.Arguments(<span class="hljs-number"><span class="hljs-number">0</span></span>) sgFilenameResult = Wscript.Arguments(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> Wscript.Arguments.Count = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> sgFilename = Wscript.Arguments(<span class="hljs-number"><span class="hljs-number">0</span></span>) sgFilenameResult = <span class="hljs-string"><span class="hljs-string">"c:\script\TMG\Export\2012\1\ISALOG_WEB_000.csv"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> sgFilename = <span class="hljs-built_in"><span class="hljs-built_in">InputBox</span></span>(<span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) sgFilenameResult = <span class="hljs-built_in"><span class="hljs-built_in">InputBox</span></span>(<span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> gsDevider = VBTab record = <span class="hljs-string"><span class="hljs-string">""</span></span> recordResult = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objFSO = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"Scripting.FileSystemObject"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objTextFileOpen = objFSO.OpenTextFile(sgFilename, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objTextFileWrite = objFSO.CreateTextFile(sgFilenameResult, <span class="hljs-literal"><span class="hljs-literal">True</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Do</span></span> Until objTextFileOpen.AtEndOfStream record = <span class="hljs-built_in"><span class="hljs-built_in">trim</span></span>(objTextFileOpen.Readline) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">InStr</span></span>(record, <span class="hljs-string"><span class="hljs-string">"Filename RowNumber Field1"</span></span>) = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">inStr</span></span>(record, gsDevider) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> lArr = <span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(record, gsDevider) recordResult = fuNormalyzeDate(lArr(<span class="hljs-number"><span class="hljs-number">0</span></span>)) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">2</span></span>) &amp; gsDevider &amp; _ fuNormalyzeAccount(lArr(<span class="hljs-number"><span class="hljs-number">3</span></span>)) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">4</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">5</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">6</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">7</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">8</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">9</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> objTextFileWrite.WriteLine recordResult <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Loop</span></span> objTextFileWrite.Close objTextFileOpen.Close WScript.Echo <span class="hljs-string"><span class="hljs-string">"*   ."</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> fuRemoveExtention(lsFilename) lRes = lsFilename <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">InStr</span></span>(lsFilename, <span class="hljs-string"><span class="hljs-string">"."</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> lRes = <span class="hljs-built_in"><span class="hljs-built_in">Left</span></span>(lsFilename, <span class="hljs-built_in"><span class="hljs-built_in">Len</span></span>(lsFilename)<span class="hljs-number"><span class="hljs-number">-4</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> fuRemoveExtention = lRes <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> fuNormalyzeDate(lsDate) lRes = lsDate <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">InStr</span></span>(lsDate, <span class="hljs-string"><span class="hljs-string">"\"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> lArrDate = <span class="hljs-built_in"><span class="hljs-built_in">Split</span></span>(lsDate, <span class="hljs-string"><span class="hljs-string">"\"</span></span>) lRes = lArrDate(<span class="hljs-built_in"><span class="hljs-built_in">uBound</span></span>(lArrDate)) lArrDate = <span class="hljs-built_in"><span class="hljs-built_in">Split</span></span>(lRes, <span class="hljs-string"><span class="hljs-string">"_"</span></span>) lRes = lArrDate(<span class="hljs-number"><span class="hljs-number">1</span></span>) lRes = <span class="hljs-built_in"><span class="hljs-built_in">Left</span></span>(lRes, <span class="hljs-number"><span class="hljs-number">4</span></span>) &amp; <span class="hljs-string"><span class="hljs-string">"-"</span></span> &amp; <span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>(lRes, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) &amp; <span class="hljs-string"><span class="hljs-string">"-"</span></span> &amp; <span class="hljs-built_in"><span class="hljs-built_in">Right</span></span>(lRes, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> fuNormalyzeDate = lRes <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> fuNormalyzeAccount(lsAccount) lRes = lsAccount lRes = <span class="hljs-built_in"><span class="hljs-built_in">Replace</span></span>(lRes, <span class="hljs-string"><span class="hljs-string">"DOMAIN\"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) fuNormalyzeAccount = lRes <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span></code> </pre><br>  make-reportFile-fws.vbs <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">dim</span></span> gsDevider <span class="hljs-keyword"><span class="hljs-keyword">dim</span></span> record <span class="hljs-keyword"><span class="hljs-keyword">dim</span></span> recordResult <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Wscript.Arguments.Count = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> sgFilename = Wscript.Arguments(<span class="hljs-number"><span class="hljs-number">0</span></span>) sgFilenameResult = Wscript.Arguments(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> Wscript.Arguments.Count = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> sgFilename = Wscript.Arguments(<span class="hljs-number"><span class="hljs-number">0</span></span>) sgFilenameResult = <span class="hljs-string"><span class="hljs-string">"c:\script\TMG\Export\2012\fws\ISALOG_FWS_000.csv"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> sgFilename = <span class="hljs-built_in"><span class="hljs-built_in">InputBox</span></span>(<span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) sgFilenameResult = <span class="hljs-built_in"><span class="hljs-built_in">InputBox</span></span>(<span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> gsDevider = VBTab record = <span class="hljs-string"><span class="hljs-string">""</span></span> recordResult = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objFSO = <span class="hljs-built_in"><span class="hljs-built_in">CreateObject</span></span>(<span class="hljs-string"><span class="hljs-string">"Scripting.FileSystemObject"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objTextFileOpen = objFSO.OpenTextFile(sgFilename, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> objTextFileWrite = objFSO.CreateTextFile(sgFilenameResult, <span class="hljs-literal"><span class="hljs-literal">True</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Do</span></span> Until objTextFileOpen.AtEndOfStream record = <span class="hljs-built_in"><span class="hljs-built_in">trim</span></span>(objTextFileOpen.Readline) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">InStr</span></span>(record, <span class="hljs-string"><span class="hljs-string">"Filename RowNumber Field1"</span></span>) = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">inStr</span></span>(record, gsDevider) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> lArr = <span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(record, gsDevider) recordResult = fuNormalyzeDateTime(lArr(<span class="hljs-number"><span class="hljs-number">4</span></span>),<span class="hljs-number"><span class="hljs-number">0</span></span>) &amp; gsDevider &amp; _ fuNormalyzeDateTime(lArr(<span class="hljs-number"><span class="hljs-number">4</span></span>),<span class="hljs-number"><span class="hljs-number">1</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">2</span></span>) &amp; gsDevider &amp; _ fuNormalyzeAccount(lArr(<span class="hljs-number"><span class="hljs-number">3</span></span>)) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">5</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">6</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">7</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">8</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">10</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">11</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">12</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">13</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">14</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">15</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">16</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">17</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">18</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">19</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">20</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">21</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">22</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">23</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">24</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">25</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">26</span></span>) &amp; gsDevider &amp; _ lArr(<span class="hljs-number"><span class="hljs-number">27</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> objTextFileWrite.WriteLine recordResult <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Loop</span></span> objTextFileWrite.Close objTextFileOpen.Close WScript.Echo <span class="hljs-string"><span class="hljs-string">"*   ."</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> fuRemoveExtention(lsFilename) lRes = lsFilename <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">InStr</span></span>(lsFilename, <span class="hljs-string"><span class="hljs-string">"."</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> lRes = <span class="hljs-built_in"><span class="hljs-built_in">Left</span></span>(lsFilename, <span class="hljs-built_in"><span class="hljs-built_in">Len</span></span>(lsFilename)<span class="hljs-number"><span class="hljs-number">-4</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> fuRemoveExtention = lRes <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> fuNormalyzeDate(lsDate) lRes = lsDate <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">InStr</span></span>(lsDate, <span class="hljs-string"><span class="hljs-string">"\"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> lArrDate = <span class="hljs-built_in"><span class="hljs-built_in">Split</span></span>(lsDate, <span class="hljs-string"><span class="hljs-string">"\"</span></span>) lRes = lArrDate(<span class="hljs-built_in"><span class="hljs-built_in">uBound</span></span>(lArrDate)) lArrDate = <span class="hljs-built_in"><span class="hljs-built_in">Split</span></span>(lRes, <span class="hljs-string"><span class="hljs-string">"_"</span></span>) lRes = lArrDate(<span class="hljs-number"><span class="hljs-number">1</span></span>) lRes = <span class="hljs-built_in"><span class="hljs-built_in">Left</span></span>(lRes, <span class="hljs-number"><span class="hljs-number">4</span></span>) &amp; <span class="hljs-string"><span class="hljs-string">"-"</span></span> &amp; <span class="hljs-built_in"><span class="hljs-built_in">Mid</span></span>(lRes, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) &amp; <span class="hljs-string"><span class="hljs-string">"-"</span></span> &amp; <span class="hljs-built_in"><span class="hljs-built_in">Right</span></span>(lRes, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> fuNormalyzeDate = lRes <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> fuNormalyzeDateTime(lsDateTime, liFlag) lRes = lsDateTime <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">InStr</span></span>(lsDateTime, <span class="hljs-string"><span class="hljs-string">" "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> lArrDate = <span class="hljs-built_in"><span class="hljs-built_in">Split</span></span>(lsDateTime, <span class="hljs-string"><span class="hljs-string">" "</span></span>) lRes = lArrDate(liFlag) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> liFlag = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> lArrTime = <span class="hljs-built_in"><span class="hljs-built_in">Split</span></span>(lRes, <span class="hljs-string"><span class="hljs-string">"."</span></span>) lRes = lArrTime(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> fuNormalyzeDateTime = lRes <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> fuNormalyzeAccount(lsAccount) lRes = lsAccount lRes = <span class="hljs-built_in"><span class="hljs-built_in">Replace</span></span>(lRes, <span class="hljs-string"><span class="hljs-string">"DOMAIN\"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>) fuNormalyzeAccount = lRes <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span></code> </pre><br>  Data is loaded into MySQL database.  You can make a variety of reports and a web interface to them. <br>  I screwed the authorization on the account and password (published, by the way, on Habr√©) and 14 reports. <br>  This is how my main report creation screen looks like: <br><img src="http://habrastorage.org/storage3/2b2/b9f/8ee/2b2b9f8ee13cfbdf1f7077e9224c7c24.png"><br><br>  Examples of reports. <br><img src="http://habrastorage.org/storage3/66c/636/dca/66c636dca0dd2385cdd460086689db82.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="http://habrastorage.org/storage3/359/bcc/30f/359bcc30fd868a62171efedfee947594.png"><br><br><img src="http://habrastorage.org/storage3/1ef/a32/305/1efa323059f900b2d16ef766c96a4cce.png"><br><br><img src="http://habrastorage.org/storage3/dbe/c7f/25e/dbec7f25e43ab7cbde6fe2a55d8fba79.png"></div><p>Source: <a href="https://habr.com/ru/post/202792/">https://habr.com/ru/post/202792/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../202780/index.html">We make a prefix - Geiger counter to the iPhone in 2 hours</a></li>
<li><a href="../202782/index.html">Integrating wysiwyg editor with Django. Overview</a></li>
<li><a href="../202784/index.html">XSS'im iOS devices on the example of software from Facebook, Google, VKontakte</a></li>
<li><a href="../202786/index.html">My.com. Take off? Will not take off?</a></li>
<li><a href="../202788/index.html">Should a programmer be a bit of a ‚Äúproduct manager‚Äù?</a></li>
<li><a href="../202796/index.html">Vulnerability in nginx - nginx security advisory (CVE-2013-4547)</a></li>
<li><a href="../202798/index.html">Affiliate program for VDS!</a></li>
<li><a href="../202800/index.html">UFO has flown and published itself in the browser</a></li>
<li><a href="../202804/index.html">What is silent Joker. The story-story about the conference</a></li>
<li><a href="../202806/index.html">FOSS Sea Conference Program</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>