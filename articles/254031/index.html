<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Three user states (web development)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We reduce the number of calculations and extend the life of a mobile device. Suppose a user has a page of the site on which the video is playing, musi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Three user states (web development)</h1><div class="post__text post__text-html js-mediator-article">  We reduce the number of calculations and extend the life of a mobile device.  Suppose a user has a page of the site on which the video is playing, music is playing, the application is running with 3d graphics, but at the moment it‚Äôs <del>  doesn't look at her </del>  uses another application, browses another tab in the browser, or is distracted by a telephone conversation, etc., the developer‚Äôs duty is to improve the UX and / or extend the life of the user's mobile device. <br><a name="habracut"></a><br><hr><br><h2>  We determine the status of the user </h2><br><del>  Solid, liquid, gaseous </del><br><ul><li>  In the network (online); </li><li>  Offline (offline); </li><li>  Away (away). </li></ul><br><br>  All three states can be used both for displaying user status in a multiplayer application, chat, forum, etc., and for organizing / optimizing internal (calculations, data exchange) and external (UI, graphics) application processes. <br>  The code examples below are written in coffeescript and oriented to work within the Meteor application, but, nevertheless, this is still JavaScript and can be used in any other environment. <br><br>  Consider the events that indicate that the user is currently active: <br><pre><code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># #@ = window @addEventListener "mousemove", _.throttle(goActive, 777), false @addEventListener "mousedown", _.throttle(goActive, 777), false @addEventListener "keypress", _.throttle(goActive, 777), false @addEventListener "DOMMouseScroll", _.throttle(goActive, 777), false @addEventListener "mouse wheel", _.throttle(goActive, 777), false @addEventListener "touchmove", _.throttle(goActive, 777), false @addEventListener "MSPointerMove", _.throttle(goActive, 777), false</span></span></code> </pre> <br>  P.S.  <code>throttle</code> built-in underscore function reduces the number of calls to the <code>goActive</code> function, the function will be called no more than once per <del>  happy </del>  777 milliseconds. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Determine whether the tab is active web applications: <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># setVisibilitychange = -&gt; if document.hidden #    "" goInactive() else #    " " goActive() document.addEventListener "visibilitychange", setVisibilitychange, false</span></span></code> </pre><br>  If the tab / window is open and active, the user is logged in and not active - in a minute, change its state to inactive: <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># Meteor.setTimeout goInactive, 60000</span></span></code> </pre><br><br>  I note that the <code>goInactive</code> function sets the user status "Away". <br>  To get the status "Offline", the user needs to exit the application (logout) or close / terminate the DDP connection. <br><br><hr><br><h3>  Below is the code for Meteor only. </h3><br>  We set the status "Offline" by breaking the DDP connection: <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># Meteor.onConnection (connection) -&gt; connectionId = connection.id connection.onClose () -&gt; Meteor.users.update connection: connectionId , '$set': 'profile.online': false 'profile.idle': false</span></span></code> </pre><br>  When a user logs in, you must save the <code>connectionId</code> used above: <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment"># Accounts.validateLoginAttempt (attempt) -&gt; if !attempt.error and attempt.user Meteor.users.update _id: attempt.user._id , '$set': connection: attempt.connection.id 'profile.online': true 'profile.idle': false 'profile.location.ip': attempt.connection.clientAddress 'profile.lastLogin': new Date() return if !attempt.error and attempt.user then true else false</span></span></code> </pre><br>  More complete code with cross-browser support can be found <a href="https://github.com/VeliovGroup/Meteor-user-status">here.</a> <br><br><hr><br><h2>  User friendly application </h2><br>  Many web applications require immediate user attention.  In the state of "Away" (away) I suggest: <br><br><ul><li>  Disable CSS animations; </li><li>  Disable 3D animation; </li><li>  Reduce the frequency of calls to the server (for realtime applications); </li><li>  Pause video / audio playback; </li><li>  Play notification sounds, or play them louder; </li><li>  Pause the game for a single player mode. </li></ul><br>  Simply put, the developer should take care of the user and his personal device, improving the UX (quality of use), reducing the number of calculations, extending the life of the device, especially when powered by battery. </div><p>Source: <a href="https://habr.com/ru/post/254031/">https://habr.com/ru/post/254031/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254021/index.html">Turn your Android phone into a network SQL database (MyMobileSQLServer - Utesov)</a></li>
<li><a href="../254023/index.html">Planets and the fourth dimension</a></li>
<li><a href="../254025/index.html">Microsoft is going to strike! Details about our participation in the conference</a></li>
<li><a href="../254027/index.html">Assembler for simulation tasks. Part 2: core simulation</a></li>
<li><a href="../254029/index.html">Perl 6 and smart match</a></li>
<li><a href="../254035/index.html">Protection of devices against incorrect polarity supply</a></li>
<li><a href="../254037/index.html">Antifraud. Service Architecture (Part 3)</a></li>
<li><a href="../254041/index.html">Project Spartan is almost here.</a></li>
<li><a href="../254043/index.html">Green power for base stations and just up to 2 KW - three years of experience with wind turbines, solar generation + geo-probe</a></li>
<li><a href="../254045/index.html">Rock Sanitize - simple and flexible sanitizer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>