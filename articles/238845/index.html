<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Party hard programmatically, or as we wrote ClojureCup 2014</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last weekend, the Clojure-community was experiencing ... Oh, so last year's post began with a report on the past ClojureCup 2013. 

 ClojureCup is a 4...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Party hard programmatically, or as we wrote ClojureCup 2014</h1><div class="post__text post__text-html js-mediator-article">  Last weekend, the Clojure-community was experiencing ... Oh, so <a href="http://habrahabr.ru/post/196116/">last year's post</a> began with a report on the past ClojureCup 2013. <br><br>  ClojureCup is a 48-hour online hackathon, which is required to write applications in Clojure / ClojureScript languages.  This year, <a href="https://clojurecup.com/">about 50 teams</a> participated in the hackathon (1-4 people each), which made many <a href="https://clojurecup.com/">cool applications</a> . <br><br>  Applications are evaluated by both the jury (people known in the Clojure-community) and regular users: you can go on twitter and vote for the applications you like on the applications page. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And you can try what we <a href="http://rockets.clojurecup.com/">have here</a> . <br><br><img src="https://habrastorage.org/files/a95/148/2cb/a951482cb82d4cceb244b124735d66df.png"><br><br>  Caution: under the cut a lot of pictures. <br><a name="habracut"></a><br><br><h3>  Idea </h3><br>  The idea to participate in ClojureCup came to me quite a long time ago, but laziness did its job, and I realized it was only three days before the hackathon began to gather (it turned out that two days before the hackathon needed to form teams).  However, this world was not without programmers who want to lose their weekend, in order to write something in a strange language with brackets.  Here it is necessary to additionally mention that none of us have ever written anything seriously on lojure, and two have not written at all.  And yes, all four were programmers. <br><br>  Initially, as a project, there was a desire to do strange things for static sites (one of the teams did something a bit similar in the end), but there were big questions about the usefulness of the result. <br><br>  As a result, we formed the criteria for choosing an idea: something clear at once for a simple user. <br>  From such criteria, we quickly came up with the idea of ‚Äã‚Äãmaking some kind of toy.  And then I remembered the wonderful <a href="http://en.wikipedia.org/wiki/Puzzle_Bobble">Puzzle Bobble</a> : <br><img src="https://habrastorage.org/files/2db/356/e0f/2db356e0f0094b4c924fc366c23a0ae8.png"><br><br>  This is a puzzle with a very mischievous P2P mode: the larger the piece of balls you knock off with a group, the more of these balls will come to the enemy.  So we focused on finding a game to which it would be possible to fasten the mechanic ‚Äúto make the enemy unpleasant‚Äù. <br><br>  They thought about Tetris and 2048, but then they remembered <a href="http://en.wikipedia.org/wiki/Rocket_Mania!">Rocket Mania!</a> <br><img src="https://habrastorage.org/files/c8c/f3f/de1/c8cf3fde185b473faab88e11c47cbfd1.jpg"><br><br>  So, at night, two days before the start, the idea of ‚Äã‚Äãthe application was born: two players will play a simplified version of Rocket Mania !, but the number of missiles will be limited and they will fly away to the enemy, and for the game to just end, they will have fuel , which decreases with each flight, and at the end of the rocket will fly into space for eternity. <br>  At that time, the game should have been with cool graphics and the ability to play over the network, but when we started working on the idea on Friday night, two changes were made: we decided to throw the game over the network and only support the hotseat mode (remember, this was in the heroes when player at one computer), and also use flat design, because it's easier, and among us there are only programmers =) <br>  These were very <b>correct decisions</b> : you need to choose goals for what you can really achieve.  Simplify, simplify, simplify. <br><img src="https://habrastorage.org/files/a1a/f62/292/a1af62292eb24824b17c3e7fd3356d96.jpg" alt="image"><br><br>  Like Clojure, we didn‚Äôt have experience in the functional programming style.  But here we decided to take the functional paradigm in full: <a href="http://www.infoq.com/presentations/Are-We-There-Yet-Rich-Hickey">every observation of the world is immutable</a> , the functions are clean, etc.  etc.  As a result, in our architecture there was one ‚Äúatom of the world‚Äù, the state of which unequivocally set what was on the screen, and the change of which the world changed.  We also decided to use <a href="http://facebook.github.io/react/">react.js</a> (it was a very correct decision) and a <a href="https://github.com/levand/quiescent">quiescent</a> wrapper over it (which is wrong, but tolerable).  Now it seems to me that it was necessary to look at the <a href="http://phaser.io/">phaser</a> , but then such a thought did not arise.  By the way, at the phaser the other team made a <a href="https://clojurecup.com/">funny game with the cats</a> ! <br><br>  Meanwhile, time came to 4 in the morning, ClojureCup started, and we went to bed.  One of the team members (who lives in another time zone) at this time raised the server and launched the stub with the Elon Musk rocket there: <br><img src="https://habrastorage.org/files/ba8/068/6a6/ba80686a6bfa4755aa873f8924e2f8ec.png" alt="image"><br><br><h3>  Implementation </h3><br>  The application is very well divided into parts: someone sawed a purely game logic, someone displayed the playing field, someone was engaged in processing the keyboard.  For some reason, we didn‚Äôt have any active use of the terminal REPL, but <a href="https://github.com/bhauman/lein-figwheel">figwheel</a> , the solution for automatically recompiling ClojureScript code from hot reload code in the browser, was very useful and made our lives very, very simple.  There is another interesting point to note here: the state of the world was stored in a non-reloading atom, so even after recompiling, the application remained in the same state as it was before.  Of the minuses it can be noted that the incremental compilation flew from time to time, we had to do a full rebuild. <br><br>  Initially, we stored the generated code in the repository, so we got <a href="https://github.com/clojurecup2014/rockets/graphs/contributors">magic numbers of tens of thousands of modified lines of code</a> , with a total size of the order of 1K lines of code. <br><br>  Of the unpleasant zapar we have two: <br><ul><li>  <a href="https://github.com/clojurecup2014/rockets/commit/67a91b05221beaf27ae317996cd4d835f898c4b6">The first one</a> was related to the fact that quiescent very strangely decided which parts of the page needed to be updated and which did not;  at that moment I learned how to insert debug output into the generated JS code, and even understand what's up there, </li><li>  <a href="https://github.com/clojurecup2014/rockets/commit/a292a199b6b8f2a5ac700c3e7bd4a673388ce232">the second</a> was apparently a bug of the ClojureScript compiler: the correct code was compiled, but then it did not work. </li></ul><br><br>  During the implementation of the game logic, we were faced with the task of a large-scale deep change in the immutable state of the world.  As a result, a solution was invented, as it turned out, <a href="https://github.com/clojurecup2014/rockets/commit/3f6db3f2854d50bf5a388de4c7232240314cc33e">up to a signature that matches the solution from the standard library</a> =) <b>Moral</b> : study at least a little of the tools that you will use.  And before you do something your own, look: hasn't someone else done it? <br><br>  And we didn‚Äôt know how to make a changeable state in Clojure (functionally unwillingly), this gave rise to the following monologue: <br><blockquote>  the klozhur terribly enrages me, so that I once again code on it;  why do we need this language if it is impossible to read it, but in order to write something normal, you still have to go out of the concepts of the language. </blockquote><br>  As a result, we have not learned to use the changeable state, but have used the loop. <br><br>  At the end of the first day, we already had something showing the version of the application, and 3 hours before the end of the hackathon was a more or less full-fledged working version of the game.  In the last 3 hours, we added sounds to the game (here we had to give up the functional paradigm and methods like play appeared!) And polished the UI very much. <br><br>  In 2 hours before the end, the server fell down, and it turned out that the game was distributed by the built-in python server out of the box.  Quickly picked up nginx and were happy. <br>  Half an hour before the end, I opened the application in Safari, and it turned out that it was not working there at all (the turn of the blocks did not work). <br>  15 minutes before the end, we didn‚Äôt want to work the sound for the victory (apparently, there was again a problem with the ClojureScript compiler), this all added adrenaline noticeably. <br><br>  So even having a more or less working version in 3 hours, we spent the last minutes in steaming. <br><br>  And this is the very moment when we started the release version and got three green check marks, which means that we did everything necessary =) <br><img src="https://habrastorage.org/files/f67/3f5/d10/f673f5d103c44c3db074a8721b291f80.png" alt="image"><br><br><h3>  Instead of conclusion </h3><br><img src="https://habrastorage.org/files/827/c1e/919/827c1e9192104b528d057516eaec0701.jpg" alt="image"><br>  We succeeded, I would like to believe, a <a href="http://rockets.clojurecup.com/">fun game for two</a> .  And even if it did not work out - we got a huge amount of fun and no less amount of experience.  Here you can watch the source of the project, and <a href="https://clojurecup.com/">then</a> if you want to vote. <br><br>  A list of projects sorted by current position in public voting can be found <a href="http://acha.clojurecup.com/ladder.html">here</a> and <a href="http://voting.playthehat.com/">here</a> .  I advise you to look at these lists: among the projects there are very, very decent, funny and useful. <br><br>  For this year, you can already read the reports of <a href="http://solovyov.net/blog/2014/clojurecup2014/">Alexander Solovyov</a> (you may know him from this <a href="http://habrahabr.ru/post/193950/">wonderful presentation</a> about FRP and Clojure), the team of the <a href="http://mishadoff.com/blog/clojurecup-2014-impressions/">Funstructor</a> project, as well as <a href="http://clojure.tn/2014/09/30/milestones-clojure-cup2014.html">Milestones</a> . <br><br>  Separately, I want to say thanks to Alexander Solovyov <a href="https://habrahabr.ru/users/ingspree/" class="user_link">ingspree</a> and Nikita Prokopov <a href="https://habrahabr.ru/users/tonsky/" class="user_link">tonsky</a> for maintaining interest in Clojure at a high level, as well as to Dmitry Groshev <a href="https://habrahabr.ru/users/si14/" class="user_link">si14</a> , <a href="https://twitter.com/niquola">Nikolai Ryzhikov</a> and <a href="https://github.com/mlapshin">Mikhail Lapshin</a> for the workshop on clojure at <a href="http://habrahabr.ru/company/JetBrains/">JetBrains</a> . <br><br>  Also <a href="https://habrahabr.ru/users/juliette/" class="user_link">many</a> thanks to Julia Belyaeva <a href="https://habrahabr.ru/users/juliette/" class="user_link">juliette</a> , Seryozha Serebryakov, <a href="https://habrahabr.ru/users/megaserg/" class="user_link">megaserg</a> and Andrey Siunov <a href="https://habrahabr.ru/users/fandes/" class="user_link">fandes</a> for the excellent company on this hackathon.  Hackaton in a beautiful company - great! </div><p>Source: <a href="https://habr.com/ru/post/238845/">https://habr.com/ru/post/238845/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../238829/index.html">Modular smartphone ‚ÄúProject Ara‚Äù: new details from Google</a></li>
<li><a href="../238831/index.html">Transferring files to an isolated DOS-based virtual machine using the ... keyboard</a></li>
<li><a href="../238835/index.html">Wi-Fi on the passport will be only for paid access points</a></li>
<li><a href="../238837/index.html">Catch up and overtake Moore! Competition of innovative hardware IT projects "More than Moore"</a></li>
<li><a href="../238839/index.html">Back to the Future: Testing a Trading Robot with Historical Data</a></li>
<li><a href="../238847/index.html">Guided tour of the data centers of Scandinavia, 12-15 November</a></li>
<li><a href="../238849/index.html">Microsoft and IIDF invite to a series of student hackathons Imagine Cup</a></li>
<li><a href="../238853/index.html">English words with pictures and pronunciation from a native speaker</a></li>
<li><a href="../238855/index.html">Autothysis128t: SSD with a very serious information protection system</a></li>
<li><a href="../238857/index.html">FUJITSU against all or Japanese killer RISC servers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>