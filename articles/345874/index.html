<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Publish the application in the AppStore. A play without dialogue in several acts</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Actors: Artist (we), Customer, AppReview specialists. 

 Act 1 
 Actors: Contractor (we), Customer. 

 As part of the project, we developed a mobile a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Publish the application in the AppStore. A play without dialogue in several acts</h1><div class="post__text post__text-html js-mediator-article">  <i>Actors: Artist (we), Customer, AppReview specialists.</i> <br><br><h3>  Act 1 </h3><br>  <i>Actors: Contractor (we), Customer.</i> <br><br>  As part of the project, we developed a mobile application that works with the Customer‚Äôs server software (based on Microsoft‚Äôs OS) sold to the Customer‚Äôs customers. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Unlike many mobile applications, this application should not work with a single server accessible to all users of the application.  The server acting as a backend of the application is installed on the territory and in the local network of each client of the Customer, the server address is specified in the application settings. <br><a name="habracut"></a><br>  Customer software is developed on the basis of the .Net framework.  Taking into account the wishes of the Customer about the possibility of studying the mobile application code by its developers, the Xamarin framework, namely <a href="https://developer.xamarin.com/guides/android/">Xamarin.Android</a> and <a href="https://developer.xamarin.com/guides/ios/">Xamarin.iOS,</a> was chosen to develop the application. <br><br>  The mobile application communicates with the server via the <a href="https://ru.wikipedia.org/wiki/Windows_Communication_Foundation">WCF</a> framework, the end point on the server side is a permanently available service hosted in IIS.  Application Layer Protocol - HTTPS. <br><br>  The specifics of implementing WCF in the Xamarin framework and the improvements needed are beyond the scope of the events described. <br><br><h3>  Act 2 </h3><br>  <i>Characters: Customer, AppReview Specialists.</i> <br><br>  The customer made a decision to self-register Google and Apple Developer accounts, the publication of applications was also carried out by the Customer‚Äôs specialists. <br><br>  As expected, there were no difficulties with publishing on Google Play. <br>  As expected, the passage of AppReview was delayed.  This process and subsequent acts narrates about this process. <br><br>  The first complaint of AppReview experts was the lack of a demo server, in which Apple could test the application. <br><br><img src="https://habrastorage.org/webt/tz/ig/ju/tzigjueagncv3w5ss0acmcmd85k.png" alt="Request a demo account, in our case it will be more accurate to say - a demo server."><br>  <i>Request a demo account, in our case it will be more accurate to say - a demo server.</i> <br><br>  The customer bought VDS at the site of one of the famous hosters.  For some reason, a foreign hoster was chosen, which in the context of our history is remarkable only by the fact that for its servers it provided not only an external IPv4 address, but also an IPv6 subnet with the / 64 prefix.  Note that, unlike IPv4, this IPv6 hoster requires a separate, albeit not complex, configuration by means of the server OS.  In this regard, the server's IPv4 address was sent to AppReview (along with the login and password for accessing the server-side data of the application). <br><br><h3>  Act 3 </h3><br>  <i>Characters: the same.</i> <br><br>  The application was sent for re-verification, the AppReview specialists were provided with information on access to the demo server. <br><br>  Again, the application failed validation.  AppReview experts reported that the application issued a message that it could not receive data from the server.  The test was conducted from a network that uses only IPv6. <br><br><img src="https://habrastorage.org/webt/qu/kc/6t/qukc6tioqderohzotxbyhtzyhhs.png" alt="The result of the first test of the application with the demo server and the error generated by the application."><br><img src="https://habrastorage.org/webt/st/vp/fc/stvpfcvmbgpwmtoiru13icjqpmm.png" alt="The result of the first test of the application with the demo server and the error generated by the application."><br>  <i>The result of the first test of the application with the demo server and the error generated by the application.</i> <br><br>  This response was also expected, since from <a href="https://developer.apple.com/support/ipv6/">June 1, 2016,</a> all applications sent to the AppStore should support work in networks that use only IPv6 (without IPv4). <br><br>  The customer set up the IPv6 address provided by the hoster on the demo server, passed it to the AppReview specialists. <br><br>  And again denied verification, for the same reason.  We start to understand. <br><br><h3>  Act 4 </h3><br>  <i>Actors: the same, the Contractor (we).</i> <br><br>  The customer is not able to test work with IPv6 from its network.  We have this opportunity, the provider provides a subnet with the / 64 prefix on IPv6, from which we allocate IPv6 addresses to servers, workstations and other devices. <br><br>  We test the application on different iOS devices with different versions of iOS.  All are connected to a WiFi network, get an IPv4 and IPv6 address.  We get fully correct work with the Customer‚Äôs demo server, which is IPv4, and IPv6. <br><br>  We inform AppReview specialists about this, their answer does not change.  Then there are several attempts to get tested again after providing AppReview specialists with a video demonstrating the correct operation, several requests to check the availability of the server from their network (ping, telnet, ...), changes to the firewall settings, unscrewing the IIS logs to the maximum (in the hope that they will help identify cause of the problem).  Also asked about the transition to communication in Russian to discuss technical details, completely ignored. <br><br>  The answers of the specialists each time were identical to the previous one, and did not contain any technical details. <br><br><img src="https://habrastorage.org/webt/yv/4z/to/yv4ztokroj4qdomvyzxucynayme.png" alt="This is the answer we received several times in a row."><br>  <i>This is the answer we received several times in a row.</i> <br><br>  There was also an Internet server located on our local network, used for developing a mobile application.  Its address was given to AppReview specialists, the result of the check has not changed.  The application could not retrieve data from the server, in the IIS logs we did not even see the request attempts. <br><br>  It should be noted that, unlike the Customer‚Äôs server, we created DNS records for our server.  With different domain names for IPv4 (A record) and IPv6 (AAAA record) addresses, to continue to check the work separately on IPv4 and IPv6. <div class="spoiler">  <b class="spoiler_title">Attention, spoiler!</b> <div class="spoiler_text">  This decision led to additional time costs, and to a more complete understanding of the process of checking the application in the depths of Apple. <br></div></div><br><br><img src="https://habrastorage.org/webt/e-/wr/pu/e-wrpuq3exfzhv9uqvdwvaguszk.png" alt="DNS record for IPv4 address"><br>  <i>DNS record for IPv4 address</i> <br><br><img src="https://habrastorage.org/webt/ms/w6/re/msw6reox4-_adpax_pvcnwad8pg.png" alt="DNS record for IPv6 address"><br>  <i>DNS record for IPv6 address</i> <br><br><h3>  Act 5, interchange </h3><br>  <i>Characters: the same.</i> <br><br>  It was decided to provide AppReview specialists with a report showing that the application completely and successfully passes all points of Apple‚Äôs <a href="https://developer.apple.com/library/content/technotes/tn2431/_index.html">mobile application testing instruction</a> .  We expected that after this we would be provided with at least some technical details about passing the test. <br><br>  The application has been successfully tested on all items except one. <br>  Needless to say, we stalled on checking the operation of the application in a pure IPv6 network (section ‚ÄúTest in IPv6-only networks‚Äù from the above instructions).  Since  Since our local network uses both IPv4 and IPv6, the test result in it cannot be used as a test in a pure IPv6 network. <br><br>  System administrators were puzzled by the organization of a WiFi subnet using only IPv6.  In parallel with this, we launched a check through the scheme offered by the <a href="https://developer.apple.com/library/content/documentation/NetworkingInternetWeb/Conceptual/NetworkingOverview/UnderstandingandPreparingfortheIPv6Transition/UnderstandingandPreparingfortheIPv6Transition.html">instruction on supporting DNS64 / NAT64 networks</a> .  The essence of the scheme is to create a pure IPv6 WiFi network on a MacOS computer (in our case, the Mac Mini), which provides general access to the Internet through another network interface. <br><br><img src="https://habrastorage.org/webt/ly/j-/p1/lyj-p16lqdux2jmjywuu4zcq8u0.png" alt="The proposed scheme from Apple. Our demo server is located before the router, in the IPv4 + IPv6 local network."><br>  <i>The proposed scheme from Apple.</i>  <i>Our demo server is located before the router, in the IPv4 + IPv6 local network.</i> <br><br>  The application really could not get data from the server.  When specifying an IPv4 address (and the corresponding domain name), an error was reported that the network was unavailable (logical, because the network is purely IPv6), and if the IPv6 address (and corresponding domain name) was specified, the requests were timed out. <br><br>  A study of network traffic between the device and the Mac Mini, and between the Mac Mini and the local network, showed that application requests for an IPv6 address reach the Mac Mini, but do not go to the local network. <br><br>  To check the performance of this system as a whole, they launched a browser, and by traffic they saw that <br><br><ul><li>  requests from the device to the Mac Mini go over IPv6, which is logical; </li><li>  requests from the Mac Mini go over IPv4 regardless of whether there is IPv6 on the Mac Mini itself. </li></ul><br>  It became clear that for the application to work in this scheme it is required that: <br><br><ol><li>  The server was specified through a domain name; </li><li>  the device correctly determined the IPv6 address for this domain name; </li><li>  The Mac Mini correctly identified the IPv4 address for this domain name; </li><li>  The server was accessible simultaneously to these IPv4 and IPv6 addresses. </li></ol><br><img src="https://habrastorage.org/webt/km/mp/fn/kmmpfnaqxrn-pannpx91hh5aer0.png" alt="DNS record with IPv4 and IPv6 addresses"><br>  <i>DNS record with IPv4 and IPv6 addresses</i> <br><br>  By creating A and AAAA records with one domain name and specifying it in the application, we obtained data from the server. <br><br>  We transferred a single domain name to AppReview specialists (without providing a new application build), within an hour the application passed the test and was published in the AppStore. <br><br>  Happy End! </div><p>Source: <a href="https://habr.com/ru/post/345874/">https://habr.com/ru/post/345874/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345856/index.html">Optimize the initialization stage of Django</a></li>
<li><a href="../345858/index.html">Russian AI Cup 2017 - the story of second place</a></li>
<li><a href="../345860/index.html">Where it is more profitable to buy currency: banks vs exchange</a></li>
<li><a href="../345864/index.html">Import and convert LinguaLeo vocabulary to Anki flashcards</a></li>
<li><a href="../345870/index.html">Translation of the article by the founder of Debian, Jan Murdoch, ‚ÄúHow I Found myself in Linux‚Äù</a></li>
<li><a href="../345876/index.html">Hack Hill's cipher? Easy</a></li>
<li><a href="../345880/index.html">IT history lawyer. Life is business outsourcing. Part 1</a></li>
<li><a href="../345882/index.html">Exhaustive javascript reference for your next job interview. Part 1</a></li>
<li><a href="../345884/index.html">Don't you program yourself a burnout?</a></li>
<li><a href="../345886/index.html">Why programmers need restrictions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>