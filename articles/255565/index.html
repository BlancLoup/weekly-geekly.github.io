<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ASN1js and PKIjs - a year after creation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Almost a year ago I talked about the new PKIjs and ASN1js libraries . It's time to talk about the development of these libraries. For ASN1js, mostly c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ASN1js and PKIjs - a year after creation</h1><div class="post__text post__text-html js-mediator-article">  Almost a year ago I <a href="http://habrahabr.ru/post/221857/">talked</a> about the new <a href="">PKIjs</a> and <a href="">ASN1js libraries</a> .  It's time to talk about the development of these libraries.  For ASN1js, mostly cosmetic changes were made during this time.  Of the significant changes, only the possibility of converting any ASN.1 objects into the JSON format can be noticed.  But with PKIjs there have been more significant changes. <br><br>  So, the current main features of PKIjs: <br><ul><li>  Full <a href="http://www.w3.org/TR/WebCryptoAPI/">Web Cryptography API</a> support; </li><li>  Limited use in the iPhone (through the use of Safari), and in Android applications (Google Chrome); </li><li>  The <a href="https://github.com/GlobalSign/PKI.js/tree/master/examples">number of examples has</a> expanded.  In particular, examples of using PKIjs for checking signatures in PDF files and for checking signatures in S / MIME have been added; </li><li>  Use of all signature algorithms from the Web Cryptography API: <ul><li>  RSASSA-PKCS1-v1_5 (PKCS # 1 v1.5); </li><li>  RSA-PSS (PKCS # 1 v2); </li><li>  ECDSA (signature on ECC, Elliptic Curve Cryptography); </li></ul></li><li>  The first implementation of the "certificate chain verification engine" in pure JavaScript and passing the main NIST tests; </li><li>  The first and so far the only implementation of <a href="https://www.nsa.gov/ia/programs/suiteb_cryptography/">"Suite B"</a> for signing and encrypting data as a CMS (Cryptographic Message Syntax) in "open-source" in pure JavaScript; <ul><li>  Signed CMS using ECDSA; </li><li>  Encryption using ephemeral-static ECDH; </li><li>  Using AES-CBC and AES-GCM; </li><li>  Using an extended list of hashing algorithms: from SHA-1 to SHA-512; </li><li>  The ability to create encrypted messages based on the use of a password using the AES series of algorithms; </li></ul></li></ul><br><a name="habracut"></a><br>  To begin with about the implementation of signatures.  I have already listed all the algorithms used, but it should be noted that PKIjs allows you to create various types of cryptographic objects that will use all of these algorithms: <br><ul><li>  X.509 certificates; </li><li>  X.509 CRL (Certificate Revocation List); </li><li>  Requests to create certificates of the PKCS # 10 format; </li><li>  OCSP requests; </li><li>  OCSP responses; </li><li>  TSP requests; </li><li>  TSP replies; </li><li>  CMS Signed Data; </li></ul><br>  For all these types of cryptographic objects, there are convenient ‚Äúhelpers‚Äù (helpers) that allow you to obtain the internal structure of previously encoded objects, create a new structure of objects or sign internal data, as well as verify the existing signature.  Also for each type there is a separate example of its use with the use of all possible signature algorithms. <br><br>  We now turn to the description of the implementation of work with encryption.  The creators of the Web Cryptography API based the standard on the latest information on cryptographic algorithms.  Given this, we can say that the Web Cryptography API has tried to cut off all the outdated cryptography world.  Since PKIjs is based solely on the Web Cryptography API, therefore, PKIjs had to implement the latest encrypted data generation algorithms (CMS Enveloped Data) and cut off the old, already familiar to everyone, algorithms. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      PKIjs implements the ability to work with all types of recipients of encrypted CMS messages: <br><ul><li>  KeyTransRecipientInfo (encryption of the session key by an asymmetric algorithm); </li><li>  KeyAgreeRecipientInfo (encrypting a session key based on a ‚Äúshared secret‚Äù); </li><li>  KEKRecipientInfo (encryption of the session key based on the previously known value of "key encryption key"); </li><li>  PasswordRecipientInfo (encryption of the session key based on data derived from the specified password); </li></ul><br>  Common to all types of recipients of encrypted CMS messages: in PKIjs, it is possible to use two algorithms as the main data encryption algorithm - AES-CBC and AES-GCM.  Technically, it is also possible to use AES-CTR, however, for this algorithm there are no generally accepted OIDs and algorithm parameters that can be used in CMS messages. <br><br>  First, I‚Äôll talk about the main types of recipients of encrypted messages - ‚ÄúKeyTransRecipientInfo‚Äù and ‚ÄúKeyAgreeRecipientInfo‚Äù.  The type ‚ÄúKeyTransRecipientInfo‚Äù is currently only possible for recipients for whom there are X.509 certificates signed with RSA algorithms (RSASSA-PKCS1-v1_5 and RSA-PSS).  When implementing encryption for the recipient with the ‚ÄúKeyTransRecipientInfo‚Äù type, the RSA-OAEP asymmetric encryption algorithm (RSASSA-OAEP) is used.  For RSA-OAEP, only MGF1 is strictly applied, however, it is possible to specify a hash algorithm from SHA-1 to SHA-512.  For recipients whose certificates contain signatures on ECC (Elliptic Curve Cryptography), only the ‚ÄúKeyAgreeRecipientInfo‚Äù recipient type is available.  This type uses a more sophisticated KEK (key encryption key) generation scheme: an ephemeral key is generated on the ECDH algorithm, and then a special ‚Äúkey derivation function‚Äù (KDF) is performed, based on the use of hashing algorithms.  Here, the user can specify both the type of elliptic curve used (secp256r1, secp384r1 or secp521r1), as well as the type of hashing algorithm used in KDF. <br><br>  With the ‚ÄúKEKRecipientInfo‚Äù type, everything is quite simple: the user sends the selected session key encryption algorithm to the function, as well as the buffer with the saved key for this algorithm.  PKIjs in the future it remains only to use the previously transmitted data.  The work with the ‚ÄúPasswordRecipientInfo‚Äù recipient type is slightly more complicated: the ‚Äúkey encryption key‚Äù is formed as a result of the PBKDF2 algorithm, and the session key is already encrypted with this data.  Also, it is technically possible to use the HKDF algorithm, however, there is the same problem as with AES-CTR: there are no generally accepted OIDs for use in CMS Enveloped Data. <br><br>  I will also say that at present PKIjs can generate types of cryptographic messages that are not supported, for example, in the latest releases of OpenSSL, as well as in Microsoft CryptoAPI (and CNG).  For example, in OpenSSL there is no possibility (through a standard console application) to decrypt data using PBKDF2 + AES-KW, and in Microsoft CryptoAPI there is no support for the ‚ÄúdhSinglePass-stdDH-sha1kdf-scheme‚Äù and ‚ÄúdhSinglePass-stdDH-sha512kdf-scheme‚Äù schemes , as well as the recipient types KEKRecipientInfo and PasswordRecipientInfo. <br><br>  A more detailed description of the encryption capabilities is provided in the README file located in the directories of encryption examples <a href="https://github.com/GlobalSign/PKI.js/tree/master/examples/How%2520To%2520Encrypt%2520CMS%2520via%2520certificate">using a certificate</a> , as well as <a href="https://github.com/GlobalSign/PKI.js/tree/master/examples/How%2520To%2520Encrypt%2520CMS%2520via%2520password">using a password</a> . <br><br>  In conclusion, I will say that this library continues to grow, but with the help of <a href="http://peculiarventures.com/">Peculiar Ventures</a> .  Library features will only expand, stay tuned.  I would be grateful for the constructive comments, as well as the description of projects implemented using PKIjs.  For advice on working with the library you can contact me, its author directly. </div><p>Source: <a href="https://habr.com/ru/post/255565/">https://habr.com/ru/post/255565/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../255549/index.html">Remember watched videos on youtube</a></li>
<li><a href="../255551/index.html">Scaling operations in the Intel Media SDK</a></li>
<li><a href="../255557/index.html">Sunday tale of the importance of updating, even if you are a botnet operator</a></li>
<li><a href="../255559/index.html">The digest of interesting materials for the mobile # 98 developer (April 6-12)</a></li>
<li><a href="../255561/index.html">Techniques for designing game architecture</a></li>
<li><a href="../255569/index.html">SSO on FreeIPA + Apache + Flask-Login + JWT</a></li>
<li><a href="../255571/index.html">Preview version of WinJS 4.0 announced: universal UX, integration with AngularJS, updated ListView</a></li>
<li><a href="../255573/index.html">qt-items - a new framework, or an attempt to find a theory of everything</a></li>
<li><a href="../255579/index.html">Stephen Wolfram: Frontiers of Computational Thinking (SXSW Festival Report)</a></li>
<li><a href="../255583/index.html">Principles of Web Animation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>