<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Create a video surveillance system using motion</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I want to talk about setting up and using a home tracking system. You can do any area within your webcam‚Äôs view, send yourself a messa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Create a video surveillance system using motion</h1><div class="post__text post__text-html js-mediator-article"> In this article I want to talk about setting up and using a home tracking system.  You can do any area within your webcam‚Äôs view, send yourself a message when activity in this area is detected, take pictures, broadcast the image over the network (you can use authorization to access video from your webcam and watch remotely if you have a static ip) whatever you want - complete control and freedom of choice, which is generally characteristic of gnu / linux and similar systems (in the future we‚Äôll talk about linux). <br><a name="habracut"></a><br>  So, I present to your attention a wonderful utility - <a href="http://www.lavrsen.dk/foswiki/bin/view/Motion/WebHome">Motion</a> , distributed under the GPL license.  Most likely it is already in the repository of your distribution, if not (although I doubt it) - you can download deb, rpm or source code from the download page on the off site.  I used the tools of my package manager. <br><br> <a href="http://itmages.ru/image/view/242888/50573a91"><img src="https://habrastorage.org/getpro/habr/post_images/5b0/353/f46/5b0353f46b8e8c0cc68caf78de20cc53.png"></a> <br><br>  You can run, but it is better to first customize it for yourself.  The configuration file is stored in / etc / motion (it is better to copy it to the user's home directory, you can specify the path to the config with the -c option).  Edit it with vim /etc/motion/motion.conf 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This file is well commented out, and if you have no problems with English, then understanding the options for yourself is not difficult. <br><br>  First option: <br>  <code>daemon (on/off)</code> - whether motion will start in daemon mode (in background).  You can also specify the -n option at startup, then the program will run as usual. <br><br>  Further: <br>  <code>videodevice /dev/video0</code> - we specify our video device.  I have this / dev / video0. <br><br>  <code>rotate (0,90,180,270)</code> - rotate the image by a specified number of degrees (if the camera is attached at an angle) <br> <code>width 320 <br> height 240</code> <br>  - width and height of the image in pixels, respectively <br><br>  <code>framerate (2-100)</code> - the number of frames captured per second.  Naturally, the greater the value, the greater the consumption of computer resources.  Choose the optimal value. <br>  <code>minimum_frame_time 0</code> - after the previous option - allows you to set the minimum time between capturing two frames.  You can, for example, capture a frame every 5 seconds. <br><br>  <code>netcam_url value</code> - use if access to your camera is via a network.  instead of value, specify the path to the video stream.  By default, this option is not used. <br> <code>auto_brightness off <br> brightness 0 <br> contrast 0 <br> saturation 0 <br> hue 0</code> <br>  - brightness, contrast, saturation, etc. <br><br>  The next important section for us: <br>  # Motion Detection Settings: <br>  <code>threshold 1500</code> - can be described as sensitivity to determine movement.  The smaller the value, the more sensitive the detector. <br>  <code>noise_level 32</code> - noise level.  Allows you to ignore the noise created by the camera.  Set the optimum value for your camera. <br><br>  <code>area_detect (1-9)</code> Allows you to <code>area_detect (1-9)</code> only a specific area.  1 - upper left corner, 2 - upper middle part, ... 5 - center, ... 9 - lower right corner. <br><br>  <code>mask_file value</code> - Specify the path to the pgm file with a motion mask that does not need to be fixed.  Allows you to ignore the rocking branches of trees, etc. For more information about the pgm files here <a href="http://netpbm.sourceforge.net/doc/pgm.html">netpbm.sourceforge.net/doc/pgm.html</a> <br><br>  Next come a few more options for defining the motion and encoding options for the image and video.  I will omit their description. <br><br>  <code>snapshot_interval N</code> - Creates snapshots every N seconds. <br>  <code>locate (on/off)</code> - draw a frame around a moving object. <br><br>  <code>target_dir /usr/local/apache2/htdocs/cam</code> - The folder where the images will be saved.  I set this value ~ / motionshots <br><br> <code>snapshot_filename %v-%Y%m%d%H%M%S-snapshot <br> jpeg_filename %v-%Y%m%d%H%M%S-%q <br> movie_filename %v-%Y%m%d%H%M%S</code> <br>  - Customize file names. <br><br> <code>on_event_start value <br> on_event_end value <br> on_picture_save value <br> on_motion_detected value <br> on_area_detected value <br> on_movie_start value <br> on_movie_end value <br> on_camera_lost value</code> <br>  - Performs a specific action upon the occurrence of certain events.  As value, you can specify a script, for example, sending you a message.  Or, for example, to include music when someone is found.  Everything is limited by your imagination and depends on your goal. <br><br>  Now you can run <br>  <code>motion [-c ///]</code> .  You can also add to the list of daemons of your system (rc-update add motion default for ghetts, for archa - add to DAEMONS = () in /etc/rc.conf, for other distributions I don‚Äôt know for sure, but this is not more difficult) <br><br>  Now, when detecting activity in the monitored area, the program saves snapshots to the specified directory and executes your script (there are many articles about writing scripts to send messages, so I will not cover this topic in this article). <br><br>  And finally, some screenshots with an example of use.  As you can see, when motion is detected, motion in non-daemon mode displays lines like <code>[1] File of type 1 saved to: /home/vladimir/motionshots/01-20110727140020-00.jpg</code> <br><br> <a href="http://itmages.ru/image/view/242886/87d275b7"><img src="https://habrastorage.org/getpro/habr/post_images/78e/b7b/c60/78eb7bc606126958766a0e68ae0afd15.png"></a> <br><br> <a href="http://itmages.ru/image/view/242887/35e784cb"><img src="https://habrastorage.org/getpro/habr/post_images/424/d17/32c/424d1732ceefd0c1eedd0a133d7c300e.png"></a> <br><br>  <b>UPD:</b> Thank you for the invite!  Topic moved to Linux for all </div><p>Source: <a href="https://habr.com/ru/post/125216/">https://habr.com/ru/post/125216/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../125207/index.html">Special 4 Habrahabr: QIWI Wallet Company Development Report in Q2 2011</a></li>
<li><a href="../125208/index.html">House of Talents goes to the CIS</a></li>
<li><a href="../125210/index.html">Working with Java on the command line</a></li>
<li><a href="../125212/index.html">Isostick: a flash drive that impersonates an optical drive</a></li>
<li><a href="../125214/index.html">Bluetooth module HC-04 on CSR chip BC417143B</a></li>
<li><a href="../125217/index.html">IT Operations: the beginning</a></li>
<li><a href="../125218/index.html">Development of its first USB device. A small step forward</a></li>
<li><a href="../125219/index.html">Apple's financial reserves exceeded US government operating reserves</a></li>
<li><a href="../125220/index.html">Startup Poster Updated</a></li>
<li><a href="../125222/index.html">Secure password storage</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>