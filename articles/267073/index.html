<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vector Drawable API. Application possibilities</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="2014 was a special year for those involved in Android development - it brought one of the most significant Android updates in its history, Android 5.0...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vector Drawable API. Application possibilities</h1><div class="post__text post__text-html js-mediator-article">  2014 was a special year for those involved in Android development - it brought one of the most significant Android updates in its history, Android 5.0 version.  With this update we received a new visual language, detailed guidelines, many new APIs and tools.  And, as always in the case of such massive updates, not all innovations immediately make their way into real projects.  Somewhere the inertia of thinking of developers who are used to solving certain tasks in a certain way, somewhere - the lack of documentation on the new API, somewhere - the lack of support for new features on older versions of the platform.  But time does not stand still and thanks to the work of the Android team, as well as independent developers, such APIs are gradually gaining backward support.  And today I want to talk about the Android Vector Graphics API, which can seriously ease the life of a developer, but is still not popular. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/be0/6a3/bad/be06a3bad9de40df9769f981da4e0110.png" alt="vector android"></div><br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Little materiel</b> <div class="spoiler_text">  Computer graphics operates with two types of files - raster and vector.  Raster files are a set of matrices, each cell in which describes one section of the image, one of its pixels.  Vector files contain a set of primitive figures and commands that allow one or another form to be constructed according to given coordinates.  Differences in the internal structure of raster and vector graphics files are reflected in the behavior of various types of computer graphics under different usage scenarios.  So raster files are very poorly scaled, especially in a big way - in the source file there is simply no information to fill the image of a larger area.  Also, in raster formats there is a direct relationship between the physical size of the image and the size of the file on disk.  In turn, an object in a vector format file can have only one fill, so in order to create a photorealistic image, you need to create many objects to display highlights, shadows, textures, which, firstly, takes great pains to the illustrator, and secondly, it puts a load on the device rendering. <br>  It is not surprising that in the 30 years of the existence of desktop publishing systems, a kind of ‚Äúdivision of labor‚Äù has arisen, when raster formats are used for photo images, and vector ones for simple graphics, fonts, logos. <br></div></div><br><br><h3>  Material Design and Vector Graphics </h3><br>  How can we use the support of vector graphics, which appeared with the release of Android 5.0?  To answer this question, it is necessary to consider Material Design not just as a new Android design style, but as part of a more general trend in interface design, which began with the release of the Metro interface in Windows 8. Then there was Flat Design in iOS 7 and Material Design in Android  The key characteristics of this style, the origins of which can be found in the works of representatives of the <a href="https://ru.wikipedia.org/wiki/%25D0%2591%25D0%25B0%25D1%2583%25D1%2585%25D0%25B0%25D1%2583%25D0%25B7">Bauhaus</a> school, as well as in the direction of the so-called.  <a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D0%25BD%25D1%2582%25D0%25B5%25D1%2580%25D0%25BD%25D0%25B0%25D1%2586%25D0%25B8%25D0%25BE%25D0%25BD%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D1%258B%25D0%25B9_%25D1%2582%25D0%25B8%25D0%25BF%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D1%2584%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D1%2581%25D1%2582%25D0%25B8%25D0%25BB%25D1%258C">the Swiss school of typography</a> are the abandonment of skephomorphism, the use of simple and expressive colors, a clear structure layout. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/385/9b3/b2c/3859b3b2c9cb461297e7508d3f249e35.png" alt="icon comparison" width="400"></div><br><br>  This allows you to get rid of the use of a huge number of photographic textures, to switch to using simple vector graphics in the interface.  Just look at the Material Design iconography to make sure that in the icons there is no place for photo-realistic three-dimensionality, glare and gradients, the icon in Material Design is an expressive figure with clear borders and a flat fill.  Thanks to this, we can use vector graphics for icons. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/684/86e/2d1/68486e2d1cb5a28520edfe4fe20eb029.png" alt="material icons"><br><br>  Switching to the vector image format gives us a number of advantages: we don‚Äôt need to cut a set of icons for all screen resolutions, don‚Äôt need to cut it again in case of any changes, we also need to note the reduction in the size of the installation package with the application, as well as the decrease in the load on the RAM required to download textures and icons in png.  Some time ago, an article appeared in the technical blog Instagram where service engineers described the process of redesigning an application on Material Design guides.  <a href="http://instagram-engineering.tumblr.com/post/97740520316/betterandroid">According to their data, the</a> transition to Material Design and the accompanying ‚Äúflattening of the interface‚Äù made it possible to reduce the launch time of the application by 120 ms. <br>  Hopefully, after such arguments, you wanted to use vector graphics and now I will move on to a detailed analysis of the API structure and methods of working with it. <br><br><h3>  VectorDrawable class </h3><br><h5>  Vector tag </h5><br>  The basis of the vector graphics API in Android is the <a href="https://developer.android.com/reference/android/graphics/drawable/VectorDrawable.html"><code>VectorDrawable</code></a> class.  Objects of this class are resources and are described using the XML language, they are placed in the <code>res/drawable</code> our project.  The root element of the class is the <code>vector</code> tag.  The <code>vector</code> tag has several attributes, two groups of attributes are required, which determine the size of our <code>drawable</code> .  I'm talking about the <code>width</code> and <code>height</code> attributes ‚Äî they are specified using some units of measurement (their standard set for Android is <code>dp</code> , <code>sp</code> and <code>px</code> ), as well as <code>viewportWidth</code> and <code>viewportHeight</code> ‚Äî they are specified without units.  With the help of <code>width</code> and <code>height</code> we can specify the physical size that our <code>drawable</code> will take on the screen, and the <code>viewport</code> can be compared with the window through which we look at our image.  <code>viewport</code> sizes can be the same or different from the image size.  At the same time, by changing the size of the <code>viewport</code> , we can change the area occupied by the figure inside the <code>drawable</code> . <br><br><img src="https://habrastorage.org/files/963/593/965/963593965ebd4cb3908ca0be351d6309.png" alt="viewport comparison"><br><br>  It is worth noting that <code>viewport</code> does not have the ability to set <code>pivotPoint</code> coordinates and resizing the <code>viewport</code> will be counted from the upper left corner.  Also, the <code>vector</code> element has a number of other attributes, the meaning of which is clear from the name. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vector</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:tint</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:tintMode</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:autoMirrored</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:alpha</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vector</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br><br><h5>  Path element </h5><br>  The main thing that no VectorDrawable file can do without is the <code>Path</code> tag.  The most important attribute for the <code>Path</code> element is the <code>pathData</code> attribute.  Its value is a string of characters separated by commas.  These characters are nothing but SVG format commands. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">path</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:pathData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"M141.4,188.2H51V329c0,15.4,16.4,15.5,16.4, 15.5l20.8,0v19.7h0c0,0.3,0,0.5,0,0.8c0,11,8.9,19.9,19.9,19.9c11, 0,19.9-8.9,19.9-19.9c0-0.3,0-0.5,0-0.8h0v-19.7l13.4,0l13.4,0v19.7h0c0, 0.3,0,0.5,0,0.8c0,11,8.9,19.9,19.9,19.9c11,0,19.9-8.9,19.9-19.9c0-0.3, 0-0.5,0-0.8h0v-19.7l20.8,0c0,0,16.4,0,16.4-15.5V188.2H141.4z"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br><br>  <a href="https://ru.wikipedia.org/wiki/SVG">SVG</a> is a vector graphics format designed specifically for the Internet, and it is supported by all modern browsers, and export to SVG is available from most graphic editors.  SVG supports a set of primitive shapes, such as an oval, rectangle, spiral, etc., as well as arbitrary shapes.  Arbitrary shapes are described using a set of commands that represent the coordinates of points and straight lines, Bezier curves and arcs connecting them.  Having executed these commands successively, it is possible to build the figure we need. <br>  Since XML is also used to describe SVG files, we can open it in a text editor and find the <code>Path</code> object.  This object will have an attribute <code>d</code> , the value of which will be a string with commands identical to those that we can find as the value of the <code>pathData</code> attribute of the <code>pathData</code> object in the VectorDrawable resource.  This circumstance allows us to easily create VectorDrawable resources ‚Äî to do this, simply copy the command set from an SVG file to our VectorDrawable resource. <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">path</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"shapePath1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">d</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"M229.1,174.2 C226.2,165.5 222.1,157.5 216.9,150.3 C208.4,138.3 197.6,129.5 184.7,123.6 L202.4,98.5 C202.6,98.2 202.7,98 202.7,97.5 C202.7,96.8 202.3,96.2 201.4,95.7 C200.6,95.1 199.8,94.9 199.2,95.1 L198.4,95.6 L180.1,121.7 C168.8,117.5 156,115.2 141.6,115.2 C127.4,115.2 114.7,117.2 103.6,121.4 L85.5,95.5 L84.7,95 C84.1,94.9 83.3,95 82.5,95.6 C81.6,96.1 81.2,96.7 81.2,97.4 C81.2,97.9 81.3,98.1 81.5,98.4 L98.9,123 C85.8,128.7 74.8,137.7 66.2,149.8 C60.9,157 56.8,165 53.8,173.7 C52.5,177.5 51.7,180.8 51.2,183.5 L231.9,183.5 C231.3,181 230.4,177.9 229.1,174.2 Z"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br><br>  In order for us to see our shape, we need to assign a fill to it and, optionally, a stroke.  This is done using the attributes fillColor, strokeColor, strokeWidth.  It should be noted that, unlike SVG, a figure in VectorDrawable cannot have a gradient fill - only a certain color. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">path</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:pathData</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:fillColor</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:fillAlpha</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:strokeColor</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:strokeWidth</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:strokeAlpha</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:trimPathStart</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:trimPathEnd</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:trimPathOffset</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:strokeLineCap</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:strokeLineJoin</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:strokeMiterLimit</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br><br><h5>  Group element </h5><br>  The simplest vector file contains only one shape, but in complex images the number of such shapes can amount to dozens.  For convenience of working with them, individual figures can be grouped together using the <code>Group</code> element.  The ability to combine several Path objects into a group allows not only to organize the structure of our drawable-resource, but also gives the opportunity to apply group settings to a set of objects, but most importantly, the group can be used for animation, which will be discussed later. <br>  Thus, in one VectorDrawable resource, we can create complex graphics using various <code>Path</code> objects, which can be used to define our own color, transparency, stroke, and indicate the position on the screen.  <code>Path</code> objects can be combined into groups, for which, again, you can specify a number of group attributes.  The most interesting is that all attributes can be zanimirovat, while to apply one animation to a set of <code>Path</code> objects, it is convenient to combine these objects into a group. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">group</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:rotation</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:pivotX</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pivotY</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:scaleX</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">scaleY</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:translateX</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">translateY</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">group</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br><br><h3>  Class AnimatedVectorDrawable </h3><br>  The second part of the vector graphics API, which appeared in Android Lollipop, is the <a href="https://developer.android.com/reference/android/graphics/drawable/AnimatedVectorDrawable.html"><code>AnimatedVectorDrawable</code></a> class, which allows you to create animations for the VectorDrawable classes.  AnimatedVectorDrawable is a PropertyAnimation extension that allows us to create animations based on changing the values ‚Äã‚Äãof any object attributes.  AnimatedVectorDrawable files also belong to application resources and are created using XML.  The root element of a vector animation resource is the <code>animated</code> - vector tag.  This tag has only one <code>drawable</code> attribute in which we specify the name of the VectorDrawable resource for which we want to create an animation.  Inside the <code>animated-vector</code> element are <code>target</code> objects that are targets for animations.  The most remarkable is that the <code>animated-vector</code> can contain more than one <code>target</code> .  This fact makes it possible to create complex animations, allowing you to animate different parts of the image with different animations, creating complex animations. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">animated-vector</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:drawable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/vector_drawable"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"head"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:animation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@anim/headAnimation"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:animation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@anim/eyes_anim"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"eyes"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">animated-vector</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  In particular, the famous hamburger-to-arrow animation, which so fascinated everyone at the time of the announcement of Android 5.0, is easily created using vector animation: the upper and lower bars of the hamburger move towards the middle, at the same time the whole group rotates 180 ¬∞ - here we specify three <code>target</code> and create three animations for them. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/387/81c/9fc/38781c9fc2fa46db9c320c89c341cc68.gif" alt="animation examples"></div><br><br>  The <code>target</code> element has two main attributes ‚Äî <code>name</code> , in which we specify the name of the <code>Path</code> object or the <code>Group</code> object to be animated, and <code>animation</code> , where we send a link to the animation resource located in the <code>res/anim</code> folder. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">set</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">objectAnimator</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:duration</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"400"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:propertyName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pathData"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:valueType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pathType"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:valueFrom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/pathFrom"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:valueTo</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/pathTo"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">set</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  An animation resource is a standard <code>animator-set</code> , with an <code>objectAnimator</code> object inside.  As the value of the <code>propertyName</code> attribute, we can specify any attribute of the <code>Path</code> or <code>Group</code> object from VectorDrawable.  Depending on the attribute type, we must specify the corresponding value type in the <code>valueType</code> attribute. <br>  Android Lollipop with the advent of a new type of graphics brought a new type of <code>property</code> , for which you can create an animation - an animation of the value of the <code>pathData</code> attribute of the <code>Path</code> object.  To do this, a new <code>pathData</code> value appeared in the <code>propertyName</code> field and the corresponding <code>valueType</code> value, <code>valueType</code> , <code>pathType</code> .  In this case, the old fields <code>valueFrom</code> and <code>valueTo</code> take as arguments two strings with sets of commands describing the initial and final shape of the figure, respectively.  Thanks to this new type of animations, you can create complex animations that transform the shape of a shape that was previously unavailable in Android ‚Äî for example, morphing animations, which transform the Play button into the Pause button.  Google itself recommends saving data with path commands in string resources. <br>  It is worth noting that in order for an animation to work successfully, the number of commands and the type of commands in the source and destination path must be the same.  Otherwise, you will get a runtime exception.  This severe condition at one time took me a lot of time, but recently the <a href="https://github.com/bonnyfone/vectalign">VectAlign</a> tool <a href="https://github.com/bonnyfone/vectalign">appeared</a> , allowing you to automatically align two lines with paths according to the number and type of commands. <br><br><h3>  Running animation </h3><br>  Vector animation files implement the <a href="https://developer.android.com/reference/android/graphics/drawable/Animatable.html"><code>Animatable</code></a> interface and to start the animation, we request the <code>Drawable</code> , bring it to the <code>Animatable</code> and call the <code>start()</code> method. <br><br><pre> <code class="java hljs">((Animatable) imageView.getBackground()).start();</code> </pre><br>  <code>Animatable</code> interface <code>Animatable</code> extremely simple - there are only three methods: <code>isRunning()</code> , <code>start()</code> , <code>stop()</code> .  Thus, there is no possibility of setting the <a href="https://developer.android.com/reference/android/view/animation/Animation.AnimationListener.html"><code>AnimationListener</code></a> .  Also there is no possibility to transfer our vector animation to <a href="https://developer.android.com/reference/android/view/animation/AnimationSet.html"><code>AnimatorSet</code> .</a>  Therefore, the direct ability to create a choreography of animations, or run some actions to complete the animation is missing.  More precisely, it was absent - in version 23 of the Android SDK, the <code>Animatable</code> interface was expanded with the new <a href="https://developer.android.com/reference/android/graphics/drawable/Animatable2.html"><code>Animatable2</code></a> interface, which allows AnimationCallback to be recorded for our vector animation. <br>  For versions up to 23 for choreography, you can use the delayed launch feature, for example, using the <code>Handler.postDelayed()</code> method. <br><br><h3>  Back support </h3><br>  Returning to what I started with, I want to remind you that the introduction of vector graphics in projects so far has been hampered by the lack of reverse support for this functionality on Android versions &lt;5.0.  However, time does not stand still and, although there is no official support for vector formats on older versions of the platform, thanks to independent developers, libraries appear that allow using VectorDrawable on devices with API&gt; = 14. And I‚Äôm talking about <a href="https://github.com/wnafee/vector-compat">VectorCompat</a> and <a href="https://github.com/a-student/BetterVectorDrawable">BetterVectorDrawable libraries</a> .  I myself have experience only with the VectorCompat library, so I will only talk about it.  Those interested in the intricacies of working with BetterVectorDrawable refer to a series of <a href="https://habrahabr.ru/users/astudent/" class="user_link">astudent</a> articles: <a href="http://habrahabr.ru/post/265601/">part 1</a> , <a href="http://habrahabr.ru/post/265603/">part 2</a> ; <br>  In order for resources with vector graphics to work through the backward-compatible library, we need to fulfill a number of conditions.  First, in the XML resources that describe our VectorDrawable and animations for them, you must duplicate a number of attributes, such as <code>viewportHeight, viewportWidth, fillColor, pathData, valueType</code> with the namespace of the VectorCompat library. <br>  Another limitation is expressed in the fact that we cannot VectorDrawable directly specify how the background for the view in the XML resource layout.  To use VectorDrawable, we need to load it from the XML resource in the java-code and already there indicate it as a background for the ImageView. <br>  The library offers three methods for loading VectorDrawable from XML: <code>VectorDrawable.getDrawable(), AnimatedVectorDrawable.getDrawable()</code> and <code>ResourcesCompat.getDrawable()</code> .  The third method is preferable for two reasons: firstly, when using it, there is no difference which class object we are trying to load - VectorDrawable or AnimatedVectorDrawable, and secondly, on devices with Lollipop and higher, it will automatically use the native method from the Android SDK. <br>  Otherwise, there are no other features of using vector animation using the VectorCompat library. <br><br><h3>  Preparation of vector files </h3><br>  In conclusion, it is necessary to discuss the theme of preparing vector graphics files for Android.  Exporting to SVG is supported by most vector editors, including Corel Draw, Adobe Illustrator, and Sketch.  However, when using Adobe Illustrator, there is a problem with positioning the image relative to the <code>viewPort</code> - despite the fact that when viewed in Illustrator, the image is centered relative to the <code>viewPort</code> , when you open the exported SVG file, for example, in the browser, it is shifted to the side.  Therefore, to use SVG files from Illustrator, they must first be saved in another program, for example, free <a href="https://inkscape.org/en/">Inkscape</a> . <br>  At the same time, you shouldn‚Äôt forget that of the entire SVG set, Android only supports <code>Path</code> objects.  Therefore, primitive figures, it is necessary to transform on the way.  In Sketch, this is done with the command Layer&gt; Paths&gt; Vectorize stroke, and in Illustrator&gt; Object&gt; Expand. <br>  Having the SVG file available, we can open it in a text editor and find the tag <code><code>.     ,  d ‚Äî      .   ,              <code>pathData</code>   VectorDrawable. <br>  ,  Android Studio        ,        .    1.4    Vector Asset Studio ‚Äî    SVG   Vector Drawable   SVG   .        <code>res/drawable</code>      File &gt; New &gt; Vector Asset. <br> <br> <img src="https://habrastorage.org/files/7ff/d12/b29/7ffd12b29d0e44ae887d6777fddef4d4.png" alt="vector asset studio"> <br> <br>    1.4    Preview         SVG   Illustrator.         (    )   21.        Material Design.            SVG ,     ,       .    1,4 Android   Gradle      png-      . <br>   SVG ,          Android         .              png        ,       apk-.  vector! <br> <br>          <a href="http://habrahabr.ru/company/rambler-co/blog/265867/">Rambler.Android</a> ,  10 . <br>      <a href="http://www.slideshare.net/olegosipenko/android-vector-drawable-52671249"></a>  <a href="https://www.youtube.com/watch%3Fv%3DZWwTfoDUIBA"></a> ,     <a href="https://github.com/olegosipenko/AnimationExample">  </a> ,    <br> <br> <img src="https://habrastorage.org/getpro/habr/post_images/a7e/59b/48e/a7e59b48e22a92dcf5703e6b7d0bf4c9.gif" alt="animated droid"></code></code> <code><code>.     ,  d</code> ‚Äî      .   ,              <code>pathData</code>   VectorDrawable. <br>  ,  Android Studio        ,        .    1.4    Vector Asset Studio ‚Äî    SVG   Vector Drawable   SVG   .        <code>res/drawable</code>      File &gt; New &gt; Vector Asset. <br> <br> <img src="https://habrastorage.org/files/7ff/d12/b29/7ffd12b29d0e44ae887d6777fddef4d4.png" alt="vector asset studio"> <br> <br>    1.4    Preview         SVG   Illustrator.         (    )   21.        Material Design.            SVG ,     ,       .    1,4 Android   Gradle      png-      . <br>   SVG ,          Android         .              png        ,       apk-.  vector! <br> <br>          <a href="http://habrahabr.ru/company/rambler-co/blog/265867/">Rambler.Android</a> ,  10 . <br>      <a href="http://www.slideshare.net/olegosipenko/android-vector-drawable-52671249"></a>  <a href="https://www.youtube.com/watch%3Fv%3DZWwTfoDUIBA"></a> ,     <a href="https://github.com/olegosipenko/AnimationExample">  </a> ,    <br> <br> <img src="https://habrastorage.org/getpro/habr/post_images/a7e/59b/48e/a7e59b48e22a92dcf5703e6b7d0bf4c9.gif" alt="animated droid"></code> <div style="text-align:center;"> <code><code>.     ,  d</code> ‚Äî      .   ,              <code>pathData</code>   VectorDrawable. <br>  ,  Android Studio        ,        .    1.4    Vector Asset Studio ‚Äî    SVG   Vector Drawable   SVG   .        <code>res/drawable</code>      File &gt; New &gt; Vector Asset. <br> <br> <img src="https://habrastorage.org/files/7ff/d12/b29/7ffd12b29d0e44ae887d6777fddef4d4.png" alt="vector asset studio"> <br> <br>    1.4    Preview         SVG   Illustrator.         (    )   21.        Material Design.            SVG ,     ,       .    1,4 Android   Gradle      png-      . <br>   SVG ,          Android         .              png        ,       apk-.  vector! <br> <br>          <a href="http://habrahabr.ru/company/rambler-co/blog/265867/">Rambler.Android</a> ,  10 . <br>      <a href="http://www.slideshare.net/olegosipenko/android-vector-drawable-52671249"></a>  <a href="https://www.youtube.com/watch%3Fv%3DZWwTfoDUIBA"></a> ,     <a href="https://github.com/olegosipenko/AnimationExample">  </a> ,    <br> <br> <img src="https://habrastorage.org/getpro/habr/post_images/a7e/59b/48e/a7e59b48e22a92dcf5703e6b7d0bf4c9.gif" alt="animated droid"></code> </div> <code><code>.     ,  d</code> ‚Äî      .   ,              <code>pathData</code>   VectorDrawable. <br>  ,  Android Studio        ,        .    1.4    Vector Asset Studio ‚Äî    SVG   Vector Drawable   SVG   .        <code>res/drawable</code>      File &gt; New &gt; Vector Asset. <br> <br> <img src="https://habrastorage.org/files/7ff/d12/b29/7ffd12b29d0e44ae887d6777fddef4d4.png" alt="vector asset studio"> <br> <br>    1.4    Preview         SVG   Illustrator.         (    )   21.        Material Design.            SVG ,     ,       .    1,4 Android   Gradle      png-      . <br>   SVG ,          Android         .              png        ,       apk-.  vector! <br> <br>          <a href="http://habrahabr.ru/company/rambler-co/blog/265867/">Rambler.Android</a> ,  10 . <br>      <a href="http://www.slideshare.net/olegosipenko/android-vector-drawable-52671249"></a>  <a href="https://www.youtube.com/watch%3Fv%3DZWwTfoDUIBA"></a> ,     <a href="https://github.com/olegosipenko/AnimationExample">  </a> ,    <br> <br> <img src="https://habrastorage.org/getpro/habr/post_images/a7e/59b/48e/a7e59b48e22a92dcf5703e6b7d0bf4c9.gif" alt="animated droid"></code> <div style="text-align:center;"> <code><code>.     ,  d</code> ‚Äî      .   ,              <code>pathData</code>   VectorDrawable. <br>  ,  Android Studio        ,        .    1.4    Vector Asset Studio ‚Äî    SVG   Vector Drawable   SVG   .        <code>res/drawable</code>      File &gt; New &gt; Vector Asset. <br> <br> <img src="https://habrastorage.org/files/7ff/d12/b29/7ffd12b29d0e44ae887d6777fddef4d4.png" alt="vector asset studio"> <br> <br>    1.4    Preview         SVG   Illustrator.         (    )   21.        Material Design.            SVG ,     ,       .    1,4 Android   Gradle      png-      . <br>   SVG ,          Android         .              png        ,       apk-.  vector! <br> <br>          <a href="http://habrahabr.ru/company/rambler-co/blog/265867/">Rambler.Android</a> ,  10 . <br>      <a href="http://www.slideshare.net/olegosipenko/android-vector-drawable-52671249"></a>  <a href="https://www.youtube.com/watch%3Fv%3DZWwTfoDUIBA"></a> ,     <a href="https://github.com/olegosipenko/AnimationExample">  </a> ,    <br> <br> <img src="https://habrastorage.org/getpro/habr/post_images/a7e/59b/48e/a7e59b48e22a92dcf5703e6b7d0bf4c9.gif" alt="animated droid"></code> </div></div><p>Source: <a href="https://habr.com/ru/post/267073/">https://habr.com/ru/post/267073/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267061/index.html">Card game: we realize attack and we will find application of ShadowDOM</a></li>
<li><a href="../267063/index.html">Functional C #: Non-nullable reference types (non-zero reference types)</a></li>
<li><a href="../267067/index.html">The story of the damn doubles</a></li>
<li><a href="../267069/index.html">A new way of MITM-attack on the TLS protocol makes the attacker invisible</a></li>
<li><a href="../267071/index.html">Already a year we create an operator together</a></li>
<li><a href="../267075/index.html">Parsing the Digit Recognizer Challenge Kaggle Competitions</a></li>
<li><a href="../267079/index.html">Isn't it time for relational databases to fall into the dustbin of history?</a></li>
<li><a href="../267081/index.html">The results of the contest for the design of Mail.Ru mailing app on Dribbble</a></li>
<li><a href="../267083/index.html">How to improve resiliency of billing: The experience of "Hydra"</a></li>
<li><a href="../267085/index.html">How to optimize the online store. Part 1. Automatic calling of incoming leads</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>