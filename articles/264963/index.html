<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Object language restrictions (and a little about the meta model)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In our opinion, the object language of restrictions (Object Constraint Language, OCL) should be known to everyone who is engaged in modeling or who is...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Object language restrictions (and a little about the meta model)</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/a06/13d/f5f/a0613df5fd094c5ca6c4e1e8d2637882.jpg" alt="image"><br><br>  In our opinion, the object language of restrictions (Object Constraint Language, OCL) should be known to everyone who is engaged in modeling or who is interested in model-oriented development.  However, he is unfairly deprived of attention in the network in general, and, indeed, in the Russian-speaking segment of information is just a miser.  What kind of language it is and why it is needed is described in this article.  The article does not claim to be fundamental, complete coverage, accuracy of definitions, etc.  Its task is: 1) to acquaint OCL with those who have never heard of this language with simple examples, 2) and for those who have heard of it, it is possible to discover new ways of using it. <br><a name="habracut"></a><br><h4>  <font color="#902213"><b>Structural and additional restrictions</b></font> </h4><br>  Let's start right away with an example.  Suppose we are developing a program like Jira to account for projects, tasks, to distribute these tasks among employees.  The data model for such a program can be very simplistic. <br><br><img src="https://habrastorage.org/files/87a/17e/c44/87a17ec44f3946d59fec48e18afbdd97.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Having drawn such a diagram, we put restrictions on our subject area: we fixed that only employees, tasks and projects can exist in it, that they have such attributes that they can be connected by just such connections.  For example, in our subject area, an employee must have a full name and date of birth.  A task or project cannot have such attributes.  Or a task can only be performed by an employee, but another task or project cannot be an executor.  These are obvious things, but it is important to understand that when creating such a model, we formulate the restrictions.  Such constraints are sometimes referred to as structural constraints. <br><br>  However, often structural constraints in domain modeling are not enough.  For example, we may need a restriction that the project manager cannot be a project participant at the same time.  Now from this chart, such a restriction does not follow.  Let's give other examples (with a trick ;-)) additional (not structural) restrictions: <br><ol><li>  Trainee cannot lead projects </li><li>  A programmer can manage one project, but cannot participate in other projects. </li><li>  Lead programmer can manage no more than two projects at the same time </li><li>  A project must have only one manager. </li><li>  Full namesakes cannot participate in one project. </li><li>  A closed project cannot have open tasks (a task is considered closed if it has actual execution time) </li><li>  Before assigning an executor for a task, the planned execution time must be defined. </li><li>  Before closing, the task must be determined by the planned execution time </li><li>  An employee in one project can have only one open task and no more than 5 tasks for all projects. </li><li>  Employee must be adults </li><li>  The employee‚Äôs full name must consist of three parts (last name, first name and middle name), separated by spaces (spaces cannot be double, triple, etc.) </li><li>  Lead programmer can not call Sigmund </li><li>  The actual time of work on the task can not exceed the planned more than twice </li><li>  A task cannot be its subtask </li><li>  The planned time of the task should not be less than the time scheduled for subtasks </li><li>  ... invent yourself some limitations ... </li></ol><br><blockquote>  <b>Summary</b> <br><br>  Various modeling languages ‚Äã‚Äãallow you to describe the structural constraints imposed on the subject area: <br><ul><li>  on types of objects: an object can only be an instance of the corresponding class (an employee cannot have project properties, a task cannot be saved to a table with employees, etc.); </li><li>  permissible properties and associations; </li><li>  on types: properties can take values ‚Äã‚Äãonly of a certain type; </li><li>  on multiplicity: the values ‚Äã‚Äãof the required properties / associations must be specified, for the properties / associations with the multiplicity "1" several values ‚Äã‚Äãcannot be indicated, etc. </li></ul><br>  Additional restrictions can be described using additional languages ‚Äã‚Äãsuch as OCL. </blockquote><br><h4>  <font color="#902213"><b>Eclipse setup</b></font> </h4><br>  If you want to try all this in practice, you will need Eclipse.  If not, proceed to the next section. <br><ol><li>  Download and unzip <a href="https://eclipse.org/downloads/">Eclipse</a> , preferably Eclipse Modeling Tools.  If you are already using Rational Software Architect 9.0 (which is based on Eclipse), you can use it. </li><li>  Install the necessary libraries: <br><ul><li>  For Eclipse.  Choose Help -&gt; Install Modeling Components from the menu.  In the window that appears, select: "Graphical Modeling Framework Tooling", "OCL Tools" and do not interfere with "Ecore Tools". </li><li>  For RSA 9.0.  Copy the files <a href="https://github.com/AresEkb/mda_course/tree/master/plugins">org.eclipse.gmf.tooling.runtime _ *. Jar and org.eclipse.ocl.examples.interpreter _ *. Jar</a> into the folder ‚ÄúC: \ Program Files \ IBM \ SDP \ plugins \‚Äù (depending on the specific installation folder maybe a little different). </li></ul></li><li>  Install <a href="https://github.com/AresEkb/mda_course/tree/master/plugins">pm * .jar</a> plugins with a test metamodel: <br><ul><li>  For Eclipse.  Copy these files to the $ ECLIPSE_HOME / dropins folder </li><li>  For RSA 9.0.  Copy these files to the folder ‚ÄúC: \ Program Files \ IBM \ SDP \ plugins \‚Äù (depending on the installation, the folder may be slightly different).  The dropins folder is not recommended because of some bugs. </li></ul></li><li>  Restart Eclipse.  From the menu choose File -&gt; New -&gt; Other ... In the search bar type ‚Äúpm‚Äù.  A ‚ÄúPm Model‚Äù and a ‚ÄúPm Diagram‚Äù should appear. </li><li>  You can either create a test model yourself, or take a <a href="https://github.com/AresEkb/mda_course/tree/master/pm_model">ready-made</a> </li><li> Open the console: Window -&gt; Show View -&gt; Other ... Find the Console in the list. </li><li>  In the console window, open the ‚ÄúOpen Console‚Äù drop-down list and select ‚ÄúInteractive OCL‚Äù in it (see figure below). </li><li>  Select any object on the diagram and write ‚Äúself‚Äù at the bottom of the console, press ‚ÄúEnter‚Äù.  If everything is set up correctly, you will see something like this: </li></ol><br><img src="https://habrastorage.org/files/a09/f3d/bcf/a09f3dbcf0804880b5b7c46840c8963c.png"><br><br>  If the plugin with the metamodel does not work for you, you can build it yourself from the <a href="https://github.com/AresEkb/mda_course">source codes</a> .  It uses a relatively old version of GMF, so that it works in RSA 9.0. <br><br><h4>  <font color="#902213"><b>Example No. 1. The planned time for completing the task should not be less than the time planned for subtasks</b></font> </h4><br>  The first thing you need to know about OCL is that the restriction always applies to a particular class of objects.  Before writing the OCL rules, we need to select this class.  Sometimes this choice is not very obvious, but now everything is simple: the rule refers to the task.  We can access a specific task instance using the self variable.  If it is necessary to obtain the value of some task property, then after the variable name we write a period and then the name of this property.  Similarly, you can specify the name of the association.  Try this in Eclipse. <br><br><blockquote>  <b>Note</b> <br><br>  To avoid unnecessary problems, in the model all classes, properties, etc.  Named with the use of Latin characters.  You can find out exactly how this or that property is called using auto-completion (called by pressing Ctrl + SPACE). </blockquote><br>  The final control rule is shown in the figure. <br><br><img src="https://habrastorage.org/files/7ae/2cd/0b1/7ae2cd0b100b49e4a372d603637562b5.png"><br><br>  Not a very trivial thing for newcomers to OCL is the difference between the characters "." And "-&gt;". <br>  What comes after the point applies to each element in the collection of values ‚Äã‚Äãor objects. <br>  What comes after the arrow applies to the entire collection of values ‚Äã‚Äãor objects. <br>  The table shows some examples of point and arrow usage. <br><table><tbody><tr><th>  OCL expression </th><th>  Interpreting OCL expressions </th></tr><tr><td>  <nobr>self.plan_time</nobr> </td><td>  Get the value of the Plan_time property </td></tr><tr><td>  <nobr>self.Podzadachi</nobr> </td><td>  Get many subtasks </td></tr><tr><td>  <nobr>self.Subtasks.Plan_time</nobr> </td><td>  For each subtask in the set, get the value of the property "Plan_time" and eventually get a set of such values </td></tr><tr><td>  <nobr>self.Subtasks.plan_time-&gt; sum ()</nobr> </td><td>  Count the sum over the whole set of values </td></tr><tr><td>  <nobr>self.plan_time-&gt; sum ()</nobr> </td><td>  Although the task can have a maximum of one value for the property "Plan_time", this value is implicitly converted to a set (with a single element).  The operation sum () is applied to the resulting set. </td></tr></tbody></table><blockquote>  <b>Note</b> <br><br>  See <a href="http://www.omg.org/spec/OCL/">the OCL specification for a</a> description of the collect () and oclAsSet () operations. </blockquote><br><h4>  <font color="#902213"><b>Example No. 2. The project manager should not be a participant in the project.</b></font> </h4><br>  The figure shows several equivalent formulations of this rule: we obtain a list of project participants and make sure that there is no leader in it. <br><br><img src="https://habrastorage.org/files/ea7/eaa/2e6/ea7eaa2e66454e6fbf3235d1f022af94.png"><br><br>  The self variable can be omitted; it is implicitly implied.  However, it is important to note that some operations (select, exists, forAll, ...) create a new scope with additional implicit variables (iterators).  In this case, it is rather difficult to understand to which implicit variable the chain of properties belongs.  In such situations, it is highly desirable to explicitly specify all variables (or all but one). <br><br><h4>  <font color="#902213"><b>Example No. 3. The lead programmer can manage no more than two projects at the same time.</b></font> </h4><br>  Novices when writing such rules are usually asked first if there is an OCL if-then-else.  Yes, it is, but in most rules, it is better to use implication instead. <br><br><img src="https://habrastorage.org/files/43e/ebc/ce1/43eebcce192746c78fa56fedafbcd4df.png"><br><br>  If the premise of the implication is false, then we don‚Äôt even try to check the other conditions.  And if true, then we get a list of projects that the employee manages, exclude from them closed projects, and if the number of such projects is no more than two, we consider that the condition is fulfilled. <br><br><h4>  <font color="#902213"><b>Example No. 4. Full namesake cannot participate in one project.</b></font> </h4><br>  Here, perhaps, the first non-trivial rule.  You can try to formulate it from the employee as well as from the project.  It is important to start with the correct class :-) If you are not aware of the existence of the isUnique () operation, then you can start building enough monstrous constructions, like me, when I first encountered this task. <br><br><img src="https://habrastorage.org/files/528/6fc/fee/5286fcfeebb94688b92854ec9d3fac50.png"><br><br>  Remove from the rule an explicit iterator declaration (the variable "y"), and try to interpret the rule.  Personally, I do not remember exactly what will happen.  Maybe there will be an error that it is impossible to unambiguously determine which name you are talking about.  Or maybe the iterator takes precedence over self.  Need to see the specification.  In any case, it is desirable to avoid such situations, and specify the variables explicitly. <br><br><blockquote>  <b>Note</b> <br><br>  Iterators can be more than one.  Look at <a href="http://www.omg.org/spec/OCL/">the OCL specification</a> , experiment in the OCL console.  See how the specification defines an isUnique () operation. </blockquote><br><h4>  <font color="#902213"><b>Example No. 5. An employee in one project can have only one open task and no more than 5 tasks for all projects.</b></font> </h4><br>  In this rule, we first declare a variable with a list of open tasks.  Then we check two conditions for them.  We assume that the task is considered open if the actual execution time is not specified for it. <br><br><img src="https://habrastorage.org/files/799/057/f19/799057f1998b4c3d90333e2b90d0b337.png"><br><br>  In your opinion, for which class is it better to define this rule?  For an employee or task? <br><br><h4>  <font color="#902213"><b>Example number 6. The task can not be its subtask</b></font> </h4><br>  If you did not immediately understand the essence of the rules depicted in the figure, then this is quite natural.  On the one hand, there is the ‚ÄúTask‚Äù object class, on the other hand, the task has the ‚ÄúTask‚Äù association, which indicates the parent task.  It is desirable to name the classes and properties / associations differently, this improves the quality of the model and simplifies the understanding of OCL rules. <br><br><img src="https://habrastorage.org/files/4cc/cb9/d56/4cccb9d563f24a1883afb790ecae92fb.png"><br><br>  Let's start with the implementation of the rule "head on."  Let us check if the ‚ÄúTask‚Äù association of a certain task indicates the task itself: ‚Äúself. Task &lt;&gt; self‚Äù.  In the figure we removed the explicit reference to the self variable.  It would seem that there is nothing fatal in this, however, in OCL expressions we can refer not only to properties or associations, but also to classes.  For example, using this expression, we can get a list of all tasks: ‚ÄúTask.allInstances ()‚Äù.  In this example, the OCL interpreter is likely to decide that this is a ‚ÄúTask‚Äù association, and not a class.  However, I repeat, it is desirable to avoid such ambiguities. <br><br>  The second disadvantage of this rule is that it does not take into account that subtasks can have their own subtasks.  The task can easily be a subtask of its subtasks.  To make sure that this is not the case, we might need loops or recursive functions.  But there are no cycles in OCL, and with functions everything is not very simple.  But there is a wonderful operation closure ().  This operation is defined for collections, so it is necessary to put an arrow in front of it, not a full stop.  For each element of the collection, the operation closure () evaluates the expression specified as its argument, then combines the obtained values ‚Äã‚Äãinto a collection, for each element of which it again calculates this expression, adds the obtained values ‚Äã‚Äãto the resulting collection, and so on: <br><br><pre><code class="javascript hljs">self.-&gt;union(self..)-&gt;union(self...)-&gt;union(...)</code> </pre> <br>  The figure shows two variants of the rule, based on recursion on parental tasks and subtasks, respectively.  Which option do you think is better (trick question)? <br><br><blockquote>  <b>Note</b> <br><br>  Surely, sooner or later you will need cycles.  In most cases, you can use the operations defined for collections (select, exists, ...) instead. <br><br>  If you still need a cycle, you can try something like this: <br><br><pre> <code class="javascript hljs">Sequence{<span class="hljs-number"><span class="hljs-number">1.</span></span><span class="hljs-number"><span class="hljs-number">.10</span></span>}-&gt;collect(...)</code> </pre><br>  Also note the iterate () operation. <br></blockquote><br><h4>  <font color="#902213"><b>Example No. 7. An employee‚Äôs full name must consist of three parts (last name, first name and middle name), separated by spaces (spaces cannot be double, triple, etc.)</b></font> </h4><br>  Obviously, such a rule would be easiest to implement using regular expressions.  However, <a href="http://www.omg.org/spec/OCL/">the OCL specification</a> does not have operations to work with them.  In the figure you can see examples of the implementation of such a rule without using regular expressions.  The good news is that the standard OCL library is extensible, and in some implementations the matches () operation is still there, or you can implement it yourself. <br><br><img src="https://habrastorage.org/files/cab/129/5b8/cab1295b8ce7421fb7f223a30d1fe9ab.png"><br><br><h4>  <font color="#902213"><b>OCL constructs</b></font> </h4><br>  All the OCL expressions that we have examined are written in Basic OCL (Essential OCL).  (By the way, how do you think, how do they differ?) We list the main constructions we used: <br><ul><li>  The variable self - the expression is always bound to a specific class of objects. </li><li>  Appeal to properties (and associations) by name: <br><ul><li>  self.Polnitel.Zadachi.Proekt.Manager.Zadachi ... </li></ul></li><li>  Arithmetic and logical operations </li><li>  Function call: <br><ul><li>  FIO.substring (1, 5) </li><li>  FIO.size () = string length </li></ul></li><li>  Work with collections: <br><ul><li>  FIO-&gt; size () = 1, since  the employee must have a single name </li><li>  Tasks-&gt; forAll (task | task.plan_time&gt; 10) </li></ul></li><li>  Variable declaration: <br><ul><li>  let s1: Integer = FIO.indexOf ('') in </li></ul></li><li>  Conditional statement (if-then-else) </li></ul><br>  There are some additional constructions in Complete OCL that we will not discuss in detail, you can get to know them yourself by reading the specification: <br><ul><li>  Messages, states </li><li>  Packages, context, expression assignment (package, context, inv, pre, post, body, init, derive) </li></ul><br><h4>  <font color="#902213"><b>Homework</b></font> </h4><br>  See <a href="http://www.omg.org/spec/OCL/">the OCL specification</a> . <br><br>  Understand primitive data types, types of collections (set, sequence, etc.).  Why do you think there are no primitive types in OCL for working with date and time?  What if they are still needed? <br><br>  Understand the differences between Basic OCL, Essential OCL, Complete OCL. <br><br>  Implement other OCL rules yourself, check them in Eclipse. <br><br>  All OCL-expressions that are given in the article can take only true or false value.  (By the way, do you agree with this statement?) Do you think OCL-expressions can have a numeric range of values, return rows, sets of values ‚Äã‚Äãor objects?  How could such non-boolean OCL expressions be used? <br><br>  Do you think that the result of evaluating an OCL expression could be another OCL expression? <br><br><h4>  <font color="#902213"><b>Bonus</b></font>  <font color="#902213"><b>A bit about metamodels</b></font> </h4><br>  All that we have done before is described the limitations of our model and tested these limitations on specific employees, tasks, projects.  For example, we described the rule that a project manager cannot be a project participant at the same time.  Moreover, we have described this rule for all projects and employees in general.  And then checked it for specific projects and employees. <br><br><h5>  <font color="#902213">Example No. 1. Employee-Task-Group metamodel</font> </h5><br>  Now let's go up a level.  For example, we want to develop another application - for the taxi service.  There will be a similar data model.  Instead of employees, let there be drivers, instead of tasks, orders, and instead of projects, cities.  Of course, this is a very conditional example, but it is needed only to demonstrate an idea.  Or, let's say, we need to develop an application to make an appointment with a doctor.  There will be doctors, offices and receptions. <br><br>  We can look at all these models and see general patterns in them.  A programmer, a driver and a doctor are essentially the same thing - just an employee.  Order, reception - if you summarize, then just a task.  Well, we generalize the city, department, project.  Let's call them just a group.  The link between the employee and the task is called execution.  The link between the employee and the group is called participation. <br><br><img src="https://habrastorage.org/files/f72/563/347/f72563347d5e483888fdb941a887de91.png"><br><br>  Having drawn such a picture, we have risen to a new level of awareness of the subject area ‚Äî we developed a meta model, a language in which we can describe any similar models. <br><br>  Let me remind you that the model that we built in the first part of the article imposed some structural and non-structural restrictions on information about objects in our subject area. <br><br>  Similarly, the metamodel imposes structural and non-structural constraints on the models, which are built in accordance with this metamodel.  For example, in any model that corresponds to a given metamodel, there can only be elements that are based on metaclasses marked in red in the figure.  In the model, for example, the class ‚ÄúBuilding‚Äù, ‚ÄúRoad‚Äù or something like that which is not an employee, a task, etc. cannot appear. <br><br><blockquote>  <b>Note</b> <br><br>  By the way, metamodels are built on the basis of metametamodels (for example, MOF, Ecore).  If you're interested, read <a href="http://www.omg.org/spec/MOF/">the OMG MOF specification</a> .  In general, there can be an arbitrary number of modeling levels, but usually 2-3 is enough. <br><br>  By the way, what do you think on the basis of which metametametamodel is MOF itself built? <br><br>  If you are not afraid of dislocation of the brain, then read the article by <a href="http://www.jot.fm/issues/issue_2006_11/article4/">Dragan Djuric, Dragan Ga≈°evic and Vladan Deved≈æic "The Tao of Modeling Spaces"</a> (I personally have a dislocation of the brain from their surnames).  By and large, when developing software, everything is a model (from a mental image in the mind of a developer to source code, documentation, test scripts, etc.), and the development process is the transformation of some models into others.  We will try to cover the topic of model conversion in subsequent articles. </blockquote><br>  What do you think, is the model shown in the picture above (green rectangles, blue lines), metamodels (red rectangles)? <br><br>  Obviously, in addition to structural constraints, the metamodel may contain non-structural constraints.  The latter can be described again in the OCL language.  Examples of such rules are shown in the figure. <br><br><img src="https://habrastorage.org/files/e19/8a3/550/e198a3550ed149169528d777d0fe19ca.png"><br><br><blockquote>  <b>Note</b> <br><br>  In fact, this picture is not very correct.  Instead of a full-fledged metamodel, the UML profile is used here, which, strictly speaking, is the usual UML model built on the basis of the UML metamodel (which, in turn, is built on the basis of the MOF metametamodel).  However, in fact, metamodels are often not built from scratch, but in the form of a UML profile.  For example, in the <a href="http://www.iso20022.org/">ISO 20022 standard, the</a> metamodel is implemented in two equivalent versions: 1) a full-fledged metamodel based on Ecore, and 2) a UML profile.  From the point of view of the objectives of this article, these nuances are not very significant, so we will consider the UML profile a ‚Äúmetamodel‚Äù. </blockquote><br><h5>  <font color="#902213">Example No. 2. Entity-Attribute-Communication metamodel</font> </h5><br>  The above described meta model looks a bit artificial and useless.  Let's try to build a more adequate metamodel.  Suppose we need to develop a language that allows us to describe the data structure in a relational database.  In this case, the difference between the participants, tasks, projects, etc.  not so important.  These are all entities that may have attributes, and which are connected by connections.  In our example, there are two kinds of links: one-to-many, many-to-many.  The metaclasses of this metamodel are described in the figure by red rectangles.  What do you think, is the model shown in the picture (green rectangles, blue lines) consistent with the metamodel?  Is every element of this model attributed to one of the metaclasses? <br><br><img src="https://habrastorage.org/files/94c/bf5/3d9/94cbf53d93c941029e0c51e57a3c71ea.png"><br><br>  We now turn, finally, to practice.  For this, I will use Rational Software Architect, you can use any sane UML editor.  One could show everything with the example of free and ideologically correct Papyrus, but, unfortunately, it is not very convenient. <br><br>  So, create a new empty project in the UML editor.  Create a UML profile in it with the following stereotypes. <br><br><img src="https://habrastorage.org/files/c36/3da/e6d/c363dae6d2bb4b65952d9582bbfba40e.png"><br><br><blockquote>  <b>Note</b> <br><br>  Pay attention to the properties of the stereotype "Attribute".  This is a list of properties that any attribute in our model can have. </blockquote><br>  Then create the following UML model, apply the newly created profile to it, apply the necessary stereotypes.  If you are too lazy to create all this, you can take the <a href="https://github.com/AresEkb/mda_course/tree/master/er_model">finished project</a> . <br><br><img src="https://habrastorage.org/files/462/bff/e9f/462bffe9f88344ea8b32b3d1eb89555e.png"><br><br>  Roughly speaking, we built a model in accordance with our ‚Äúmeta model‚Äù.  Each element of our model is an ‚Äúinstance‚Äù of a metaclass from a ‚Äúmetamodel.‚Äù <br><br><blockquote>  <b>Note</b> <br><br>  Once again, strictly speaking, this is not so.  And the profile, and the stereotypes, and the model, and all the elements of the model - all that we have created - are instances of metaclasses from the UML metamodel.  Those.  both the profile and the model that uses it are on the same modeling level.  But from a practical point of view, we can consider this profile a ‚Äúmetamodel‚Äù according to which our model is created.  If you understand what it is about, then before understanding what a metamodel is, you need one more step - to understand what the rectangles and lines on the diagrams are, and to understand what the xmi file is from the point of view of modeling.  This <a href="http://www.jot.fm/issues/issue_2006_11/article4/">article</a> will help you, which was mentioned above. </blockquote><br>  Now we will describe some additional limitations of our metamodel in the OCL language.  For example, attributes must belong to entities.  If we created a metamodel in the form of a full-fledged metamodel, and not a profile, then such a rule would look very simple: <br><br><pre> <code class="javascript hljs">owner.oclIsKindOf(Entity)</code> </pre><br>  Moreover, we would not even have to describe such a rule.  We would simply create an owner association between Attribute and Entity, which in principle cannot link elements of other kinds. <br><br>  However, our metamodel is created as a UML profile, so the rule is necessary and, at first glance, it does not look very trivial: <br><br><pre> <code class="javascript hljs">base_Property.class.getAppliedStereotype(<span class="hljs-string"><span class="hljs-string">'PMProfile::Entity'</span></span>) &lt;&gt; <span class="hljs-literal"><span class="hljs-literal">null</span></span></code> </pre><br>  This rule refers to the stereotype "Attribute", which extends the UML metaclass "Property".  This means that in the model we can attach an instance of the Attrbiute stereotype to a certain property (an instance of the UML metaclass ‚ÄúProperty‚Äù).  In the latter, we can specify certain values ‚Äã‚Äãof minLength, maxLength and pattern.  The OCL rule we wrote above will check this instance of the Attribute stereotype. <br><br>  Through the base_Property property, we move from a stereotype instance to a property.  Then, through the class association, go to the class to which the property belongs.  And finally, we check whether the ‚ÄúEntity‚Äù stereotype is applied to this class. <br><br><blockquote>  <b>Note</b> <br><br>  I do not know how much this corresponds to the specification, but sometimes the association between the stereotype instance and the UML metaclass instance (in this case, base_Property) can be omitted, it will be implicitly implied in the same way as self. </blockquote><br><blockquote>  <b>Note</b> <br><br>  If you have a question, how did I know that you need to use the class association, then there are two ways: 1) autocompletion in Eclipse (Ctrl + SPACE) and 2) <a href="http://www.omg.org/spec/UML/">OMG UML specification</a> . </blockquote><br>  The rule above uses a standard technique for Eclipse-based UML editors.  However, the operation getAppliedStereotype () is a non-standard OCL extension, it may not be supported in other tools.  The same rule can be written as follows: <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extension_Entity</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">notEmpty</span></span></span><span class="hljs-class">()</span></span></code> </pre><br>  We check if the class that owns the property has a connection (via the extension_Entity association) with an extension based on the ‚ÄúEntity‚Äù stereotype. <br><br><blockquote>  <b>Note</b> <br><br>  The 2nd option theoretically looks more consistent with the standard.  However, in older versions of Eclipse there may be problems with it, it is recommended to use the first version for them. </blockquote><br><img src="https://habrastorage.org/files/efd/bf9/35a/efdbf935ac004780b2b900ae53eb10f7.png"><br><br><blockquote>  <b>Note</b> <br><br>  Try to find the base_Property, extension_Entity and class associations in the profile. </blockquote><br>  The figure shows three more rules. <br><ol><li>  The attribute must have a type. </li><li>  In a one-to-many relationship, the multiplicity at one end should be no more than 1, and at the other end - more than 1. </li><li>  All properties belonging to an entity must be either regular attributes or relationship roles. </li></ol><br>  Do you think that these rules could be replaced with normal structural constraints if we created the model not in the form of a UML profile, but in the form of a meta model based on MOF? <br><br>  MOF and Ecore are very similar to each other.  Can you imagine some fundamentally different metametamodel? <br><br><h5>  <font color="#902213">Examples of constraints at the metamodel level</font> </h5><br>  Below are examples of the simplest and most complex rules from one real metamodel that we created.  On the one hand, this is certainly an example of a terrible code, but on the other - a demonstration of some OCL constructions :-) <br><br>  The maximum repeatability of the ADT component must be greater than 0: <br><br><pre> <code class="javascript hljs">upper &gt; <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br>  The ADT component that is inherited through the ‚Äúconstraint‚Äù relationship must be in the same position as the corresponding component of the parent type: <br><br><pre> <code class="javascript hljs">datatype.generalization-&gt;exists( getAppliedStereotype(<span class="hljs-string"><span class="hljs-string">'SomeProfile::restriction'</span></span>) &lt;&gt; <span class="hljs-literal"><span class="hljs-literal">null</span></span>) implies ( <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> parent : DataType = datatype.general-&gt;any(<span class="hljs-literal"><span class="hljs-literal">true</span></span>).oclAsType(DataType) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> props : OrderedSet(Property) = parent.ownedAttribute-&gt; select(getAppliedStereotype(<span class="hljs-string"><span class="hljs-string">'SomeProfile::Component'</span></span>) &lt;&gt; <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cur : Property = props-&gt;select(x|x.type=self.type)-&gt;any(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> cur &lt;&gt; <span class="hljs-literal"><span class="hljs-literal">null</span></span> implies ( <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> prevEnd : Integer = props-&gt;indexOf(cur) - <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> prevEnd = <span class="hljs-number"><span class="hljs-number">0</span></span> or ( <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> allPrev : OrderedSet(Property) = props-&gt;subOrderedSet(<span class="hljs-number"><span class="hljs-number">1</span></span>, prevEnd) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> requiredPrev : OrderedSet(Property) = allPrev-&gt;select(lower &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> requiredPrev-&gt;isEmpty() or ( <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> prevStart : Integer = allPrev-&gt;indexOf(requiredPrev-&gt;last()) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> allowedPrev : OrderedSet(Property) = allPrev-&gt; subOrderedSet(prevStart, allPrev-&gt;size()) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> index : Integer = datatype.ownedAttribute-&gt; indexOf(self.oclAsType(Property)) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> index &gt; <span class="hljs-number"><span class="hljs-number">1</span></span> and ( <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> selfAllPrev : OrderedSet(Property) = datatype.ownedAttribute-&gt; subOrderedSet(<span class="hljs-number"><span class="hljs-number">1</span></span>, index - <span class="hljs-number"><span class="hljs-number">1</span></span>)-&gt; select(getAppliedStereotype(<span class="hljs-string"><span class="hljs-string">'SomeProfile::Component'</span></span>) &lt;&gt; <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> selfAllPrev-&gt;isEmpty() or ( <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> prevType : Type = selfAllPrev-&gt;last().type <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> allowedPrev-&gt;exists(x|x.type=prevType)))))))</code> </pre><br><h4>  <font color="#902213"><b>Why do I need OCL</b></font> </h4><br>  Rules of control in a profile or metamodel - you already know everything about this. <br><br>  Rules of control in the model - and about that too. <br><br>  Specification of operations and calculated properties - you can get acquainted with this yourself by reading <a href="http://www.omg.org/spec/OCL/">the OCL specification</a> . <br><br>  Conversion of models ( <a href="http://www.omg.org/spec/QVT/">QVT</a> , <a href="http://www.omg.org/spec/MOFM2T/">MOF M2T</a> ) - we will tell about this in the following articles. <br><br>  Knowledge of the meaning of life - for this, meditate on the first picture.  Where would you draw Jesus?  And the Matrix? </div><p>Source: <a href="https://habr.com/ru/post/264963/">https://habr.com/ru/post/264963/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264947/index.html">Breaking down resource compression in Might and Magic III</a></li>
<li><a href="../264949/index.html">SMS from Bash or teach Zabbix new tricks</a></li>
<li><a href="../264953/index.html">New WiFi equipment from Ruckus Wireless. New: access points, controllers and functionality</a></li>
<li><a href="../264955/index.html">Joker 2015: News 1-18 August 2015 - new speakers and reports</a></li>
<li><a href="../264961/index.html">Part 2. Creating classes, mappings and filling database</a></li>
<li><a href="../264965/index.html">The right bonus for your new server - Part 2</a></li>
<li><a href="../264967/index.html">How-to: Techniques for creating interactive emails using CSS</a></li>
<li><a href="../264969/index.html">My view on yii 2 configuration files</a></li>
<li><a href="../264973/index.html">A look at Angry Birds 2, Niki Minaj and Jason Statham as new stars of Glu, the rise in price of a loyal user - and other news of the week for a mobile developer</a></li>
<li><a href="../264975/index.html">Intervals in C ++, part 3: we represent incrementors (Iterable)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>