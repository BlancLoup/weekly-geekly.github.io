<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Russian-speaking chat bot Boltoon: create a virtual companion</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A few years ago an interview was published in which they talk about artificial intelligence and, in particular, about chat bots. The respondent emphas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Russian-speaking chat bot Boltoon: create a virtual companion</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/59/e3/71/59e3710d10f61056511023.png"><br><br>  A few years ago an <a href="https://www.kommersant.ru/doc/1618530">interview</a> was published in which they talk about artificial intelligence and, in particular, about chat bots.  The respondent emphasizes that chat bots do not communicate, but imitate communication. <blockquote>  They contain the core of reasonable microdialogues of a completely human level and a communicative algorithm is built for keeping the conversation to this core.  That‚Äôs all. </blockquote>  In my opinion, there is something in it ... <br><br>  However, chat bots are talked about a lot on Habr√©.  They can be very different.  Popular bots based on neural network prediction, which generate the answer word for word.  This is very interesting, but expensive in terms of implementation, especially for the Russian language due to the large number of word forms.  I have chosen a different approach to implement the Boltoon chat bot. <br><a name="habracut"></a><br>  Boltoon works on the principle of selecting the most semantically close response from the proposed database with subsequent processing.  This approach has several advantages: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Speed ‚Äã‚Äãof work; </li><li>  Chat bot can be used for different tasks, for this you need to download a new database; </li><li>  The bot does not need additional training after updating the database. </li></ul><br><h1>  How it works? </h1><br>  There is a database with questions and answers to them. <br><br><img src="https://habrastorage.org/webt/59/e3/72/59e3721f17c95518451906.png"><br><br>  It is necessary that the bot is well aware of the meaning of the entered phrases and found similar in the database.  For example, ‚Äúhow are you?‚Äù, ‚ÄúHow are you?‚Äù, ‚ÄúHow are you?‚Äù Mean the same thing.  Since  the computer works well with numbers, not letters, the search for matches between the entered phrase and the existing ones should be reduced to a comparison of numbers.  It is required to transfer the entire column with questions from the database into numbers, or rather, into vectors of N real numbers.  So all documents will receive coordinates in N-dimensional space.  It is difficult to present it, but you can reduce the dimension of space to 2 for clarity. <br><br><img src="https://habrastorage.org/webt/59/e3/72/59e372932eba6706983908.png"><br><br>  In the same space, we find the coordinate of the phrase entered by the user, compare it with those available by the cosine metric and find the closest one.  Boltoon is based on such a simple idea. <br><br><img src="https://habrastorage.org/webt/59/e3/72/59e372d3308bd216980466.png"><br><br>  Now about everything in order and more formal language.  Introduce the concept of "vector representation of the text" (word embeddings) - display <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.18ex" height="2.419ex" viewBox="0 -780.1 9119.1 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-77" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6F" x="716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-72" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-64" x="1653" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-52" x="2427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-69" x="3186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-67" x="3532" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-68" x="4012" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-74" x="4589" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-61" x="4950" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-72" x="5480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-72" x="5931" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6F" x="6383" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-77" x="6868" y="0"></use><g transform="translate(7835,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6E" x="1074" y="513"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-1"> {word \ Rightarrow \ {R ^ n}} </script>  words from a natural language to a vector of fixed length (usually from 100 to 500 measurements, the higher this value, the more accurate the representation, but it is more difficult to calculate it). <br><br>  For example, the words "science", "book" can have the following idea: <br><br>  <em>v ("science") = [0.956, -1.987 ...]</em> <em><br></em>  <em>v (‚Äúbook‚Äù) = [0.894, 0.234 ...]</em> <br><br>  On Habr√© already wrote about this (you can read in detail <a href="https://habrahabr.ru/company/ods/blog/329410/">here</a> ).  The <em>distributed</em> text presentation <em>model</em> is most suitable for this task.  Imagine that there is a certain ‚Äúspace of meanings‚Äù - the N-dimensional sphere, in which each word, sentence or paragraph will be a point.  The question is how to build it? <br><br>  In 2013, an article appeared <a href="">‚ÄúEfficient Estimation of Word Representations in Vector Space‚Äù</a> by Thomas Mikolov, in which he speaks about <em>word2vec</em> .  This is a set of algorithms for finding a distributed representation of words.  Thus, each word is translated to a point in a certain semantic space, and algebraic operations in this space correspond to operations on the meaning of words (therefore, the word semantic is used). <br><br>  The picture shows this very important property of the space on the example of the vector of "femininity".  If we subtract the vector of the word "man" from the vector of the word "king" and add the vector of the word "woman", we get the "queen".  You can find more examples in <a href="https://youtu.be/U0LOSHY7U5Q">Yandex lectures</a> , also there is an explanation of the word2vec work ‚Äúfor people‚Äù, without any special mathematics. <br><br><img src="https://habrastorage.org/webt/59/e3/72/59e372fe7b521015732866.png"><br><br>  In Python, it looks like this (you need to install the gensim package). <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> gensim w2v_fpath = <span class="hljs-string"><span class="hljs-string">"all.norm-sz100-w10-cb0-it1-min100.w2v"</span></span> w2v = gensim.models.KeyedVectors.load_word2vec_format(w2v_fpath, binary=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, unicode_errors=<span class="hljs-string"><span class="hljs-string">'ignore'</span></span>) w2v.init_sims(replace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> word, score <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> w2v.most_similar(positive=[<span class="hljs-string"><span class="hljs-string">u""</span></span>, <span class="hljs-string"><span class="hljs-string">u""</span></span>], negative=[<span class="hljs-string"><span class="hljs-string">u""</span></span>]): print(word, score)</code> </pre> <br>  Here, the already built word2vec model is used by the <a href="https://nlpub.ru/Russian_Distributional_Thesaurus">Russian Distributional Thesaurus</a> project. <br><br>  We get: <br><br><pre> <code class="python hljs"> <span class="hljs-number"><span class="hljs-number">0.856020450592041</span></span>  <span class="hljs-number"><span class="hljs-number">0.8100876212120056</span></span>  <span class="hljs-number"><span class="hljs-number">0.8040660619735718</span></span>  <span class="hljs-number"><span class="hljs-number">0.7984248995780945</span></span>  <span class="hljs-number"><span class="hljs-number">0.7981560826301575</span></span>  <span class="hljs-number"><span class="hljs-number">0.7949156165122986</span></span>  <span class="hljs-number"><span class="hljs-number">0.7862951159477234</span></span>  <span class="hljs-number"><span class="hljs-number">0.7808529138565063</span></span>  <span class="hljs-number"><span class="hljs-number">0.7741949558258057</span></span>  <span class="hljs-number"><span class="hljs-number">0.7644592523574829</span></span></code> </pre><br>  Consider the words nearest to the ‚Äúking‚Äù in more detail.  There is a <a href="http://www.serelex.org/">resource</a> for searching for semantically related words, the result is displayed in the form of an ego network.  Below are the 20 closest neighbors for the word "king." <br><br><img src="https://habrastorage.org/webt/59/e3/8b/59e38b864daab713066886.png"><br><br>  The model suggested by Mikolov is very simple - it is assumed that words in similar contexts can mean the same thing.  Consider the neural network architecture. <br><br><img src="https://habrastorage.org/webt/59/e3/a5/59e3a5fca07e0607085428.png"><br><br>  Word2vec uses one hidden layer.  In the input layer there are as many neurons as there are words in the dictionary.  The size of the hidden layer is the dimension of the space.  The size of the output layer is the same as the input.  Thus, assuming that the vocabulary for learning consists of V words and N is the dimension of the word vectors, the weights between the input and the hidden layer form a SY √ó N0 V √ó N matrix.  It represents the following. <br><br><img src="https://habrastorage.org/webt/59/e3/73/59e3737a55bb9954925352.png"><br><br>  Each of the V lines is a vector N-dimensional representation of the word. <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.655ex" height="2.539ex" viewBox="0 -987.6 5879.2 1093.4" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-68" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-3D" x="854" y="0"></use><g transform="translate(1910,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-59" x="645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-4E" x="1409" y="0"></use><g transform="translate(2297,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-54" x="707" y="583"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-78" x="5306" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> {h = {SYN0 ^ T} x} </script></p><br>  Similarly, the weights between the hidden and output layers form an N √ó V matrix SYN1.  Then at the input of the output layer will be: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.286ex" height="3.262ex" viewBox="0 -935.7 7011.9 1404.6" role="img" focusable="false" style="vertical-align: -1.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-76" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-61" x="485" y="0"></use><g transform="translate(1015,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6A" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-3D" x="1982" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-53" x="3039" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-59" x="3684" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-4E" x="4448" y="0"></use><g transform="translate(5336,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-54" x="707" y="557"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6A" x="707" y="-361"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-68" x="6435" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> {val_j = SYN1_j ^ T h} </script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.408ex" height="2.66ex" viewBox="0 -780.1 3189.7 1145.2" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-59" x="645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-4E" x="1409" y="0"></use><g transform="translate(2297,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6A" x="707" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-4"> SYN1_j </script>  - j-th column of the matrix SYN1. <br><br>  Scalar product is the cosine of the angle between two points in the n-dimensional space.  And this formula shows how close the word vectors are.  If the words are opposite, then this value is -1.  Then use softmax, the ‚Äúsoft maximum function,‚Äù to get the word distribution. <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="45.212ex" height="3.142ex" viewBox="0 -987.6 19466.1 1352.7" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6A" x="693" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-3D" x="1159" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-66" x="2466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-72" x="3016" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-61" x="3468" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-63" x="3997" y="0"></use><g transform="translate(4431,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-65" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-78" x="466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-70" x="1039" y="0"></use><g transform="translate(1542,0)"><g transform="translate(0,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-61" x="485" y="0"></use><g transform="translate(717,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6A" x="422" y="-213"></use></g></g></g></g><g transform="translate(7279,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-69" x="875" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6E" x="1220" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-56" x="1821" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-65" x="4102" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-78" x="4568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-70" x="5141" y="0"></use><g transform="translate(5644,0)"><g transform="translate(0,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-61" x="485" y="0"></use><g transform="translate(717,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6B" x="422" y="-213"></use></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-3D" x="14562" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-73" x="15618" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6F" x="16088" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-66" x="16573" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-74" x="17124" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6D" x="17485" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-61" x="18364" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-78" x="18893" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> y_j = \ frac {exp‚Å° ^ {val_j}} {\ sum_ {k \ in V} exp‚Å° ^ {val_k}} = softmax </script></p><br>  Using softmax, word2vec maximizes the cosine measure between vectors of words that occur side by side and minimizes if they do not.  This is the output of the neural network. <br><br>  To better understand how the algorithm works, consider the building for learning, consisting of the following sentences: <br><br>  <em>"The cat saw the dog,"</em> <em><br></em>  <em>"The cat chased the dog",</em> <em><br></em>  <em>"White cat climbed a tree."</em> <br>  The corpus dictionary contains eight words: ["white", "climbed", "tree", "cat", "on", "pursued", "dog", "saw"] <br><br>  After sorting alphabetically, each word can be referenced by its index in the dictionary.  In this example, the neural network will have eight input and output neurons.  Let there be three neurons in the hidden layer.  This means that SYN0 and SYN1 are respectively 8 √ó 3 and 3 √ó 8 matrices.  Before learning, these matrices are initialized with small random values, as is usually the case when learning.  Let SYN0 and SYN1 be initialized as follows: <br><br><img src="https://habrastorage.org/webt/59/e3/80/59e38083afd97541231885.png"><br><br>  Suppose a neural network must find the relationship between the words "climbed" and "cat."  That is, the network should show a high probability of the word "cat" when "climbed" is fed to the input of the network.  In the terminology of computational linguistics, the word "cat" is called central, and the word "climbed" is contextual. <br><br><img src="https://habrastorage.org/webt/59/e3/9f/59e39f4eb52a9495088241.png"><br><br>  In this case, the input vector X will be <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.983ex" height="2.901ex" viewBox="0 -935.7 5159.2 1249" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="3281" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="3782" y="0"></use><g transform="translate(4282,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-5D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-54" x="393" y="513"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-6"> [0 1 0 0 0 0 0 0] ^ T </script>  (because "climbed" is second in the dictionary).  Vector of the word "cat" - <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.983ex" height="2.901ex" viewBox="0 -935.7 5159.2 1249" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="3281" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="3782" y="0"></use><g transform="translate(4282,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-5D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-54" x="393" y="513"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-7"> [0 0 0 1 0 0 0 0] ^ T </script>  . <br><br>  When applying to the network a vector representing "climbed", the output on the neurons of the hidden layer can be calculated as follows: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="52.904ex" height="3.021ex" viewBox="0 -987.6 22778.2 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-48" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-54" x="1280" y="583"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-3D" x="1781" y="0"></use><g transform="translate(2837,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-54" x="1215" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-53" x="4295" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-59" x="4941" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-4E" x="5704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="6593" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-3D" x="7371" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-5B" x="8427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2212" x="8706" y="0"></use><g transform="translate(9484,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-34" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-39" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-37" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-39" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-36" x="3281" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2C" x="13266" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2212" x="13711" y="0"></use><g transform="translate(14490,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-32" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-32" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-39" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-39" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-33" x="3281" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2C" x="18272" y="0"></use><g transform="translate(18717,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-36" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-35" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-34" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-36" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="3281" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-5D" x="22499" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-8"> H ^ T = X ^ T SYN0 = [- 0.490796, -0.229903, 0.065460] </script></p><br>  Note that the H vector of the hidden layer is equal to the second row of the SYN0 matrix.  Thus, the activation function for the hidden layer is to copy the vector of the input word into the hidden layer. <br><br>  Similarly for the output layer: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="6.395ex" viewBox="0 -987.6 40358 2753.3" role="img" focusable="false" style="vertical-align: -4.101ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(2176,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-67" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-69" x="1626" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6E" x="1972" y="0"></use><g transform="translate(2572,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-65" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-71" x="466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6E" x="927" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-61" x="1527" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-72" x="2057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-72" x="2508" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-61" x="2960" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-79" x="3489" y="0"></use></g><g transform="translate(6559,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-48" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-54" x="1280" y="583"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-53" x="1503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-59" x="2149" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-4E" x="2912" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="3801" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-3D" x="4579" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-5B" x="5635" y="0"></use><g transform="translate(5914,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-39" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-33" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-34" x="3281" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2212" x="9918" y="0"></use><g transform="translate(10919,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-33" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-39" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-33" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-33" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="3281" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2212" x="14923" y="0"></use><g transform="translate(15924,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-32" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-32" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-33" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-36" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="3281" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2212" x="19928" y="0"></use><g transform="translate(20929,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-35" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-33" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-39" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-39" x="3281" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6E" x="31520" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6F" x="32121" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6E" x="32606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-75" x="33207" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6D" x="33779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-62" x="34658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-65" x="35087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-72" x="35554" y="0"></use></g><g transform="translate(8339,-1433)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-34" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-33" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-34" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-36" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-33" x="3281" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2212" x="4004" y="0"></use><g transform="translate(5004,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-35" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-32" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-36" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-32" x="3281" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2212" x="9009" y="0"></use><g transform="translate(10009,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-37" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-39" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-36" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-38" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-36" x="3281" y="0"></use></g><g transform="translate(13791,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-32" x="1780" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-39" x="2280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-32" x="2781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-38" x="3281" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-5D" x="17573" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-65" x="18102" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6E" x="18568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-64" x="19169" y="0"></use><g transform="translate(19692,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-65" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-71" x="466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6E" x="927" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-61" x="1527" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-72" x="2057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-72" x="2508" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-61" x="2960" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-79" x="3489" y="0"></use></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-9"> \ begin {eqnarray} {H ^ T SYN1 = [0.100934 -0.309331 -0.122361 -0.151399} \ nonumber \\ 0.143463 -0.051262 -0.079686 0.112928] \ end {eqnarray} </script></p><br>  We need to get the probabilities of words on the output layer, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.185ex" height="2.78ex" viewBox="0 -832 8690.6 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-77" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6F" x="1857" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-72" x="2343" y="0"></use><g transform="translate(2794,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-64" x="0" y="0"></use><g transform="translate(520,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-63" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6F" x="433" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6E" x="919" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-74" x="1519" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-65" x="1881" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-78" x="2347" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-74" x="2920" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-77" x="5735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6F" x="6451" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-72" x="6937" y="0"></use><g transform="translate(7388,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6A" x="736" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-29" x="8301" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> P (word_ {context} word_j) </script>  for <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.235ex" height="2.419ex" viewBox="0 -780.1 7420.7 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-3D" x="799" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6F" x="2105" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-76" x="2591" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-65" x="3076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-72" x="3543" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6C" x="3994" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-69" x="4293" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-6E" x="4638" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-65" x="5239" y="0"></use><g transform="translate(5705,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMAIN-2C" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/340190/&amp;xid=17259,1500004,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgfLSl5akd1L80nPvchX2afQFhU4g#MJMATHI-56" x="945" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-11"> k = \ overline {1, V} </script>  which reflect the relation of the central word with the contextual input.  To display a vector in probability, use softmax.  The output of the jth neuron is calculated by the following expression: <p><math> </math> $$ display $$ y_j = P (word_ {context} ‚îÇword_j) = \ frac {exp‚Å° ^ {val_j √ó val_ {context}}} {\ sum_ {k \ in V} exp‚Å° ^ {val_j √ó val_k}} = softmax $$ display $$ </p><br>  Thus, the probabilities for eight words in a corpus are: [0.143073 0.094925 0.114441 <em>0.111166</em> 0.14492 0.122874 0.119431 0.1448800], the "cat" probability is 0.111166 (by index in the dictionary ). <br><br>  So we compared each word with a vector.  But we need to work not with words, but with phrases or with whole sentences, because  people communicate that way.  For this, there is <a href="https://radimrehurek.com/gensim/models/doc2vec.html">Doc2vec</a> (originally Paragraph Vector) - an algorithm that gets a distributed representation for parts of texts based on word2vec.  Texts can be of any length: from a phrase to paragraphs.  And it is very important that at the output we get a vector of fixed length. <br><br>  Based on this technology Boltoon.  First, we build a 300-dimensional semantic space (as mentioned above, choose the dimension from 100 to 500) based on the Russian-language Wikipedia (link to <a href="https://dumps.wikimedia.org/ruwiki/latest/">dump</a> ). <br><br>  A little more python. <br><br><pre> <code class="python hljs">model = Doc2Vec(min_count=<span class="hljs-number"><span class="hljs-number">1</span></span>, window=<span class="hljs-number"><span class="hljs-number">10</span></span>, size=<span class="hljs-number"><span class="hljs-number">100</span></span>, sample=<span class="hljs-number"><span class="hljs-number">1e-4</span></span>, workers=<span class="hljs-number"><span class="hljs-number">8</span></span>)</code> </pre> <br>  We create an instance of the class for further training with the following parameters: <br><br><ul><li>  min_count: the minimum frequency of occurrence of a word, if the frequency is lower than the specified one - ignore </li><li>  window: "window" in which the context is considered </li><li>  size: the dimension of the vector (space) </li><li>  sample: maximum frequency of occurrence of a word, if the frequency is higher than the specified one - ignore </li><li>  workers: number of threads </li></ul><br><pre> <code class="python hljs">model.build_vocab(documents)</code> </pre> <br>  We build a table of dictionaries.  Documents - Wikipedia dump. <br><br><pre> <code class="python hljs">model.train(documents, total_examples=model.corpus_count, epochs=<span class="hljs-number"><span class="hljs-number">20</span></span>)</code> </pre> <br>  Training.  total_examples - the number of documents to enter.  Training takes place once.  This is a resource-intensive process, building a model of 50 MB of Wikipedia dump (my laptop with 8 GB of RAM no longer pulled).  Next, save the trained model, getting these files. <br><br><img src="https://habrastorage.org/webt/59/e3/87/59e38716d239e706585223.png"><br><br>  As mentioned above, SYN0 and SYN1 are weights matrices formed during training.  These objects are saved to separate files using pickle.  Their size is proportional to N √ó V √ó W, where N is the dimension of the vector, V is the number of words in the dictionary, W is the weight of one character.  This resulted in such a large file size. <br><br>  We return to the database with questions and answers.  Find the coordinates of all the phrases in the newly constructed space.  It turns out that with the expansion of the database you will not have to retrain the system, it is enough to take into account the added phrases and find their coordinates in the same space.  This is the main advantage of Boltoon - quick adaptation to update data. <br><br>  Now let's talk about user feedback.  Find the coordinate of the question in space and the closest to it phrase that is available in the database.  But here the problem arises of finding the nearest point to a given one in N-dimensional space.  I propose to use KD-Tree (read more about it <a href="https://habrahabr.ru/post/312882/">here</a> ). <br><br>  KD-Tree (K-dimensional tree) - a data structure that allows you to split the K-dimensional space into spaces of lower dimension by cutting off the hyperplanes. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.spatial <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> KDTree <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build_tree</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, ethalon)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> KDTree(list(ethalon.values()))</code> </pre><br>  But it has a significant drawback: when you add an item, rebuilding the tree is done in O (NlogN) on average, which is long.  Therefore, Boltoon uses a ‚Äúlazy‚Äù update ‚Äî rebuilds the tree every M phrase additions to the database.  Search takes place in O (logN). <br><br>  For the further training of Boltoon, the following functionality was introduced: after receiving the question, an answer is sent with two buttons to assess the quality. <br><br><img src="https://habrastorage.org/webt/59/e3/88/59e388649f635915050018.png"><br><br>  In case of a negative answer, the user is asked to correct it, and the corrected result is entered into the database. <br><br><img src="https://habrastorage.org/webt/59/e3/88/59e3888a71700524933428.png"><br><br>  An example of a dialogue with Boltoon using phrases that are not in the database. <br><br><img src="https://habrastorage.org/webt/59/e3/88/59e388b4cc6b5030615141.png"><br><br>  Of course, it is difficult to call it ‚Äúmind,‚Äù Boltoon does not possess any mind.  He is far from top bots like Siri or recent Alice, but this does not make him useless and uninteresting, after all, this is a student project as part of a summer practice created by one person.  In the future, I plan to screw up the processing of responses (coordination with the interlocutor's floor, for example), memorizing the context of the conversation (within the framework of several previous messages) and processing typos.  Hopefully it will turn out more reasonable Boltoon 2.0.  But this is a conversation for the next article. <br>  <b>PS</b> You can test Boltoon in a telegram via the @boltoon_bot link, just do not forget to evaluate each response received, otherwise your subsequent messages will be ignored.  And I see all the logs, who wrote what, so let's observe the limits of decency. <br>  <b>PPS</b> I want to thank my teachers <a href="https://habrahabr.ru/users/pavelmstu/" class="user_link">PavelMSTU</a> and <a href="https://habrahabr.ru/users/ov7a/" class="user_link">ov7a</a> for the advice and constructive criticism of this article. </div><p>Source: <a href="https://habr.com/ru/post/340190/">https://habr.com/ru/post/340190/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../340180/index.html">Wi-Fi security is compromised due to multiple vulnerabilities found in WPA2</a></li>
<li><a href="../340182/index.html">Critical vulnerabilities detected in WPA2 - Key Reinstallation Attacks (KRACK)</a></li>
<li><a href="../340184/index.html">Introduction to Neural Network Architectures</a></li>
<li><a href="../340186/index.html">How to create a competitive advantage and value of a technological product</a></li>
<li><a href="../340188/index.html">Our cloud-based JS is now ES2017, and this reduces the code by several times.</a></li>
<li><a href="../340192/index.html">Key QA Process Indicators</a></li>
<li><a href="../340194/index.html">A tricky javascript question asked at Google and Amazon interviews</a></li>
<li><a href="../340196/index.html">ScadaPy application modbus protocol</a></li>
<li><a href="../340198/index.html">Kali Linux: security test questions</a></li>
<li><a href="../340200/index.html">Steve Wozniak opened an online university Woz U</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>