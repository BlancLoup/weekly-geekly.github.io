<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to independently serve 2500 accounting bases</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, the Button will honestly tell about the pitfalls of administering accounting tools and will give practical advice with useful links. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to independently serve 2500 accounting bases</h1><div class="post__text post__text-html js-mediator-article">  In this article, the Button will honestly tell about the pitfalls of administering accounting tools and will give practical advice with useful links. <br><br><img src="https://habrastorage.org/files/d48/296/f07/d48296f071ca45da85877167895e3e6f.png"><br><a name="habracut"></a><br><h3>  How to choose the main tool for an accountant </h3><br>  If your company is engaged in accounting outsourcing, first of all you need to decide on the program in which the accountant will work.  Offers on the market are diverse, we used the following criteria: <br><br><ul><li>  The solution must be scalable.  There is a ‚ÄúDo more with less‚Äù value in the Button.  This means that the growth of the server infrastructure should not be directly proportional to the growth of the client base.  Adopting a new system administrator for new 100 customers is uneconomical. </li><li>  The solution should have an intuitive interface and be popular with accountants. </li><li>  One should not forget about integration with various business solutions and Button applications.  The client can keep operational records in various configurations of 1C (for example, Trade Management, Retail, Small Company Management), use online trading platforms, for example, My warehouse, or various solutions for catering establishments (Iiko, StoreHouse and so on.), And also open your website.  In any case, the data must be promptly transferred to the accounting system automatically in order not to do double work. </li><li>  At any time, it should be possible to promptly transfer the accounting base to the client, so that the new accountant can continue to keep records in it. </li></ul><br>  Our selection list includes Kontur. Elba, 1C Enterprise Accounting 3.0 and Xero.  The decision was made to use 1C Enterprise Accounting 3.0, because Elba is only suitable for small companies, Xero is comfortable and technologically advanced, but still English, it is impossible to set up accounting and tax accounting according to Russian standards. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The advantage of 1C products is that at the moment it is the most popular accounting software product in our country.  It is difficult to find an accountant who has never worked in this program.  Since the Button does not specialize in servicing customers of a particular industry, it is important that the program is suitable for individual entrepreneurs and limited liability companies with any taxation system, and 1C allows it. <br><br>  Over time, we abandoned the use of file databases and deployed our cloud using 1C Fresh technology, but we will not get ahead of ourselves. <br><br><h3>  How to reduce the number of bases served </h3><br>  The first customers came to Button in 2013, for each they created a file base BP 3.0.  When the number of bases approached a hundred, hell came for the system administrator.  It took several days, sometimes nights, to add a new user to all databases or install an update.  I had to invent software solutions, inventing updates and processing to add users.  It was all too slow and hopeless. <br><br>  An alternative to file bases was the use of the data sharing mechanism ( <a href="http://v8.1c.ru/overview/Term_000000788.htm">Multitenancy</a> ) of the 1C platform.  Its essence lies in the fact that one information base 1C is divided into independent areas with the help of separators.  The split mode is enabled with the ‚ÄúSplit Enabled‚Äù constant.  By the number of the separator the user connects to a separate area.  Within one such information database, data can be unseparated, that is, common to all areas, for example, a classifier of banks or units of measurement, and separated, unique, existing within one area, for example, counterparties and documents. <br><br>  It is much easier to administer one database instead of hundreds.  The cloud service 1cfresh.com works on this principle, and the technology of publishing solutions for 1C Fresh can be purchased from 1C partners. <br><br>  Delivery 1C Fresh includes two specialized configurations for information database management. <br><br><ul><li>  Service Manager.  This is the control center of data areas, through it all the standard admin works are performed.  You can load data into a new area (a standard mechanism from the file base forms a dump from files in xml format, which is then loaded into the area), give rights to a list of users, schedule an update, control data synchronization between applications.  It is possible to add external reports and processing to specific areas.  Also, the so-called ‚ÄúSupplied Data‚Äù is updated from the service manager (exchange rates, FIAS, banks classifier). <br></li><li>  Service agent  Service configuration designed to run scripts (both predefined and added by the administrator without the need to edit the configuration). <br></li></ul><br>  More information about the composition of the delivery of 1C Fresh, we wrote in the article on <a href="http://infostart.ru/public/502732/">Infostarte</a> . <br><br>  When the application service was installed and the first databases were published, the speed of the ‚Äúcloud accounting‚Äù work compared to the file one was about 10 times higher.  For the first time in a long time, quarterly reporting was quite easy, since 1C worked without freezing and reloading. <br><br><h3>  How not to do, or learn from the mistakes of others </h3><br>  A few months later, our Fresh began to work unstably.  The reason: mass connection of clients.  We had published two accounting bases and two ZUP 3.0 bases, the number of areas in each of which exceeded 300 pieces.  The situation was aggravated by the fact that the Fresh cluster was not split up into nodes, all databases were spinning on the same database server.  Our hardware could not cope with the load and, as a result, the service manager lost contact with the regions.  As the saying goes, neither download currency rates nor synchronize databases.  It is good that our colleagues from 1C supported us, penetrated into our specifics and found errors in administration, helped to correctly build the logic of using the cloud. <br><br>  We advise everyone, before deploying your service, to get systematized knowledge on the course ‚Äú <a href="https://1c.ru/rus/partners/training/uc1/course.jsp%3Fid%3D459">Operation of large systems</a> ‚Äù at the 1C training center. <br><br>  The number of areas in one database is a compromise, which is due to many factors, it can be very different, we chose 200 for ourselves. The cluster itself should consist of a service manager, service agent and nodes (database servers, application servers, web services), when the number of regions becomes more than two hundred, the next node unfolds. <br><br>  When setting up a PostgreSQL server, you should definitely read the 1C recommendations (information is available on <a href="http://kb.1c.ru/">kb.1c.ru</a> ) and use for example such a service <a href="http://pgtune.leopard.in.ua/">pgtune.leopard.in.ua</a> .  And yes, for PostgreSQL, the most delicious thing is memory! <br><br><h3>  How we all arranged </h3><br>  Now the architecture of our Fresh-cloud includes 7 nodes, 7 bases 1C BP 3.0, 2 bases 1C UNF and three bases ZUP 3.0 are published.  The service is accompanied by five system administrators and two 1C programmers.  Such a team is more than enough, with such a composition it is possible to maintain a base of 2000+ clients. <br><br>  The configurations of our machines are different and change periodically, in response to changing conditions.  The application server typically has 4-6 processors (cores) and 16GB of memory, using PostgreSQL 9.4.2-1.1C as the database server, located on Linux machines.  Resources for these machines are allocated depending on the size of the bases, the average number of connections and peak loads.  If the application server hosts several large databases, resources can reach 6-8 cores and 30 GB of memory. <br><br>  With the help of Zabbix monitoring, we control the availability of information databases, the load on nodes and 1C servers.  There is a TV in the office, and when everything is bad we immediately see it: <br><br><img src="https://habrastorage.org/files/e5b/82b/99d/e5b82b99df134986bd93224238572c89.png"><br><br>  Every day, 95 accountants are actively working in the bases.  Clients Buttons that want to self-record documents in 1C get access to their database via the Internet.  It is possible to connect to the web-client shopping equipment (CMC, barcode scanner).  For a thin client, an optional document scanner connection is available.  It is very convenient to scan and attach files to documents directly from 1C. <br><br>  All reporting from us is sent from 1C, through the Kaluga Astral certification center, we use CryptoPro keys.  We are actively implementing Dyadok electronic document management, this functionality is also available in the service model. <br><br><h3>  How to exchange data in the "clouds" </h3><br>  There are several options for data exchange: <br><br><ul><li>  between applications in the service; </li><li>  with an external base 1C in the service model; </li><li>  with a website or other program for business. </li></ul><br>  Information base published in a web-service is called an application.  For the new client, an area is created in BP 3.0, ZUP 3.0 and, if necessary, the UNF.  At the moment, synchronization of data between applications occurs every 10 minutes.  Synchronization between applications in the service can be controlled using the service manager, but we brought the data to monitor.  The system administrator sees online in which areas the data exchange is stable, in which it does not, and errors need to be corrected. <br><br>  Many customers of Buttons use 1C solutions for wholesale or retail trade (1C ‚ÄúTrade Management‚Äù 10.3 or 11.X, 1C ‚ÄùRetail‚Äù), which they store on their servers and independently administer.  In this case, it is also possible to set up data exchange with accounting in our cloud.  Such synchronization is called ‚ÄúData exchange in the service model‚Äù.  It is configured automatically according to the schedule, but it often ‚Äúbreaks‚Äù after the update due to the fact that the client on his side does not update the configuration on time.  We control on monitoring, if the exchange has not passed more than two weeks, contact the client. <br><br>  Now online stores and various online trading platforms are becoming more popular.  For the exchange of data from 1C, <a href="http://v8.1c.ru/edi/edi_app/130/">the</a> CommercelML 2 exchange <a href="http://v8.1c.ru/edi/edi_app/130/">protocol is</a> used. The 1C website has a list of online store platforms with which it is possible to configure automatic synchronization.  Recently there was a download from the site in BP 3.0, but a more detailed setting of the download is implemented in 1C UNF. <br><br><h3>  Integration with internal services </h3><br>  To integrate with button services, we do not change existing configurations, but use COM (external connection) technology and external processing.  Since the COM-connection technology is outdated and available only on the Windows platform, it plans to redo the integration using the OData mechanism.  In detail about the integration methods we recommend to look <a href="https://habrahabr.ru/company/1c/blog/308420/">here</a> . <br><br>  The developers have made several dozen robots that help to enter documents and control errors, without changing the configuration.  Read more in our <a href="http://knopka.com/blog/157/">blog</a> .  Written external processing, with which you can quickly handle large retail databases, download data from electronic wallets, write off materials into production and many other interesting things. <br><br><h3>  Conclusion </h3><br>  Total, we have gone from the use of file databases 1C, to a full-fledged cloud service.  1C Fresh gave us the opportunity to promptly administer about 2500 databases, manage the access of employees and customers, and integrate with external and internal services.  Perhaps, the 1C Fresh technology was conceived by the developers for several other uses than in the Button, but after three years, we believe that this is one of the most important tools for our company. </div><p>Source: <a href="https://habr.com/ru/post/324662/">https://habr.com/ru/post/324662/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../324648/index.html">How I started programming better</a></li>
<li><a href="../324650/index.html">Count to three: two</a></li>
<li><a href="../324654/index.html">Infrastructure migration to the ‚Äúcloud‚Äù in steps: what difficulties arise and where</a></li>
<li><a href="../324658/index.html">Launching the project Otus.ru</a></li>
<li><a href="../324660/index.html">Manage domain permissions using PowerShell and the ADSI API</a></li>
<li><a href="../324664/index.html">10 main difficulties on the way to adaptation DevOps</a></li>
<li><a href="../324666/index.html">How to develop a product, if there is one developer and two customers in a team?</a></li>
<li><a href="../324668/index.html">JBreak 2017 Java Conference, or Why Charles Nutter Goes to Novosibirsk from Minneapolis</a></li>
<li><a href="../324670/index.html">TOP 10 mistakes in organizing blockchain projects from Gartner Inc</a></li>
<li><a href="../324674/index.html">Intel SGX Extensions Tutorial. Preface and full course content</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>