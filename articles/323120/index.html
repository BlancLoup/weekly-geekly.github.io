<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Rust game development. My history</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi Habr! I am developing a game on Rust. This time I want to show some gifs and show the whole history of the game from idea to page to the incentive....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Rust game development. My history</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/da4/7ac/992/da47ac9928ba3476853deeecda65ea22.png" alt="image"><br><br>  Hi Habr!  I am developing a game on Rust.  This time I want to show some gifs and show the whole history of the game from idea to page to the incentive. <br><br>  Why rast can be read at the beginning of the <a href="https://habrahabr.ru/post/303976/">last</a> post.  But why such a strange gameplay?  I hate football and everything connected with it! <br><a name="habracut"></a><br>  The idea was simple - I read the <a href="http://gafferongames.com/networked-physics/introduction-to-networked-physics/">article</a> and noticed that there is only one game using synchronous network physics as the basis of the gameplay. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To realize the idea of ‚Äã‚Äãsuch physics, we need animations and a bit of logic.  At least that's what I thought. <br><br>  If we need animations, we have to do it!  And I started with the implementation of skeletal animation on the CPU. <br><br>  As a data format, I took <a href="https://developer.valvesoftware.com/w/index.php%3Ftitle%3DSMD_file_format%26redirect%3Dno">smd</a> - Valve will not advise the bad!  Really very simple and convenient format.  The specification, unlike even the .obj, is extremely simple, besides supporting bones and skinning.  What you need! <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/9eb/170/f49/9eb170f49efef2d76c0d8f123e61069c.gif" alt="image"></div></div><br>  Here it is - for the first time something is moving on the screen.  A few days ago, this gif was exactly one year old! <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/8dc/f0c/c77/8dcf0cc7781ad4847df8c335a32ecab2.gif" alt="image"></div></div><br>  I add skinning and lighting - and that's it, the game, you can say, is ready!  It seems that I somehow thought so. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/5f4/dc9/f18/5f4dc9f18d56fcbc15d514bfaddebdfe.gif" alt="image"></div></div><br>  Once the animations are ready, you need to somehow organize the code and write the game logic.  After all, to draw not one, but as many as four characters, you need some kind of game entities! <br><br>  I turn to the book about <a href="http://gameprogrammingpatterns.com/contents.html">patterns</a> , I do not find an answer there.  The answer is, at that time, just beginning, <a href="https://github.com/amethyst/amethyst">amethyst</a> .  <a href="https://github.com/amethyst/amethyst/issues/10">This</a> thread is very interesting and constructively discussed ECS - I recommend, there are many interesting links!  But at that time <a href="https://github.com/slide-rs/specs">specs</a> have not yet done.  Therefore, I write my <a href="https://github.com/not-fl3/tinyecs">bicycle</a> .  It allows you to display four people walking.  Already very close to the game! <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><div class="oembed"><div><div style="left: 0px; width: 100%; height: 0px; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0px; left: 0px; width: 100%; height: 100%; position: absolute;">  Your browser does not support HTML5 video. <source src="http://sharonos.com/gifs/1.mp4" type="video/mp4"></video></div></div></div></div></div><br>  More men!  I watch how fast the skinning works on the CPU.  It seems to be applicable.  Leave so. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><div class="oembed"><div><div style="left: 0px; width: 100%; height: 0px; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0px; left: 0px; width: 100%; height: 100%; position: absolute;">  Your browser does not support HTML5 video. <source src="http://sharonos.com/gifs/2.mp4" type="video/mp4"></video></div></div></div></div></div><br>  The next problem - you need to somehow edit the scene!  I am writing the first exporter from blender.  It is extremely simple - all modelki will export to the familiar .smd, and describes the scene as a simple text file.  Simple - but it works! <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><div class="oembed"><div><div style="left: 0px; width: 100%; height: 0px; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0px; left: 0px; width: 100%; height: 100%; position: absolute;">  Your browser does not support HTML5 video. <source src="http://sharonos.com/gifs/3.mp4" type="video/mp4"></video></div></div></div></div></div><br>  A game about physics, integrating <a href="https://github.com/sebcrozet/nphysics">nphysics</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><div class="oembed"><div><div style="left: 0px; width: 100%; height: 0px; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0px; left: 0px; width: 100%; height: 100%; position: absolute;">  Your browser does not support HTML5 video. <source src="http://sharonos.com/gifs/4.mp4" type="video/mp4"></video></div></div></div></div></div><br>  Simple direct lighting was not enough, I realize in deferred lighting.  Essentially just adapting <a href="">an example</a> from glium.  But it works, it's beautiful! <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/a5f/223/630/a5f223630484e55dd4473125faf9f47f.jpg" alt="image"></div></div><br>  Probably, such graphics could come in as a Directx6 demo, success can already be said! <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/TIhHwlutGHI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br>  And then the gameplay idea was born - to make a CTF shooter in collapsing scenery.  Khm  Yes, the video is exactly that! <br><br>  At the moment when the game reached a state on the video, there was a turning point in the whole story - with my graphics I was able to impress a real modeler, and now we worked on the game together! <br><br>  The concept of the game was born - we decided to test technology, engine, network and release the first game with the simplest mechanics - the one that already exists.  That is - CTF and physics synchronization.  And after we make a complete game that people can play, start using physics synchronization on a larger scale and make a more sophisticated project. <br><br>  The plan was simple, and therefore beautiful - it's time to finish the owl. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/xds-atuONP4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br>  The first network version.  It's already quite exciting to play, I realized somewhere here that it all really works!  The game has animations, you can play it together - what else do you need? <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/003/161/b95/003161b95ea83bb74897f86ef78a3801.png" alt="image"></div></div><br>  Began to increase the location.  It turned out that the finish was slightly further than planned - with an increase in the number of objects from ~ 20 to ~ thousand, a whole bunch of problems appeared that need to be solved.  We had to do more multithreading - the longest processes - physics and animation left in separate streams.  Since everything is moving, you cannot make static geometry batting.  We noticed that we have a lot of identical cubes - and began to deduce them by instaging.  FPS returned to normal, the game continued to play on the big map. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/390/75f/eeb/39075feeb7eb10827383b97d9282b898.png" alt="image"></div></div><br>  Now we are also a 2D specialist!  At the same time I had to invent a way to display gui.  Before that, all the gui were on dies with text, or on <a href="https://github.com/Gekkio/imgui-rs">imgui</a> .  Neither is suitable for beautiful windows.  I have compiled a long list of all existing gui approaches in all engines - and I chose the most, in my opinion, convenient and simple - web gui.  I made a small <a href="https://github.com/not-fl3/awesomium-rs">wrapper</a> over the <a href="http://www.awesomium.com/">avsium</a> , I learned how to draw a WebView on top of the screen, on dies - in general everywhere.  It turned out conveniently! <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/671/92c/4fa/67192c4fa480f9066e8a610f49864699.png" alt="image"></div></div><br>  That's actually the web dab over the character. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/40DGf1eKb_Y" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br>  With gui, the productive (rather) engine and network, the game already began to look like a game (in my opinion).  At this point, we tried to prove it to someone else and find money for development.  For some reason, no one believes that the video game of 2016.  We do not despair and continue. <br><br>  But this video was an important moment in our history.  After it was decided to change the style to a lighter one.  And it was decided to spend the time, enough to remove all the inconvenient things associated with our engine.  The first one is animation.  We did not have the concept of "graph animations", and the skinning on the CPU also took away a lot of performance.  I studied the <a href="https://github.com/PistonDevelopers/skeletal_animation">old abandoned rast project</a> .  In it, I didn‚Äôt like the logic of the graph, but in general it worked perfectly, gpu skinning worked quickly! <br><br>  Then the story will be more confused - the work has become more, and the results have become less noticeable. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/a0c/a10/82b/a0ca1082b9c548b33cf09d3ad6b6bba1.png" alt="image"></div></div><br>  I redid the logic of the graph and wrote the editor of the animation graph.  Now you can set up animated events right in the blender, include them on the graph and all that - life has become much better. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><div class="oembed"><div><div style="left: 0px; width: 100%; height: 0px; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0px; left: 0px; width: 100%; height: 100%; position: absolute;">  Your browser does not support HTML5 video. <source src="http://sharonos.com/gifs/5.mp4" type="video/mp4"></video></div></div></div></div></div><br>  Testing performance.  I did not compare it with other people's decisions, but for us - speed is now more than enough! <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/fae/42f/9cd/fae42f9cd2d033b2c81c8f30ab585c20.png" alt="image"></div></div><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/7f2/dfd/614/7f2dfd614614b3a3143dc9581fe476a3.png" alt="image"></div></div><br>  The next problematic thing was - it was inconvenient to change materials and it was inconvenient to look at colliders.  They made the very first editor - right in the game, you can click a button, switch the camera to free mode and poke it with objects with the mouse - see colliders, change the shader and all that.  At the same time we made the material system itself - now the materials are configured in the blender exactly as materials. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: absolute; visibility: hidden; display: block; transform: rotate(0deg); width: 500px; margin: 10px auto; max-width: 100%; min-width: 220px;"></twitter-widget><blockquote class="twitter-tweet" align="center" data-twitter-extracted-i1552896646580957616="true"><p lang="en" dir="ltr">  The entire process - move / change / create objects in game mode, review them, send and blender and continue playing!  <a href="https://twitter.com/hashtag/rustlang%3Fsrc%3Dhash">#rustlang</a> <a href="https://twitter.com/hashtag/indiedev%3Fsrc%3Dhash">#indiedev</a> <a href="https://twitter.com/hashtag/gamedev%3Fsrc%3Dhash">#gamedev</a> <a href="https://t.co/KrpwqB5bvh">pic.twitter.com/KrpwqB5bvh</a> </p>  - SHAR (@BringerShar) <a href="https://twitter.com/BringerShar/status/828092467752861696">February 5, 2017</a> </blockquote><script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script></div></div></div><br>  The editor was developing - as a result, a system of "patches" appeared.  You can form a ‚Äúpatch‚Äù on the blender scene right in the game and apply it in a blender.  This is mainly used for particle lamps and - so far there is not even a turn.  But it became much more convenient! <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/be5/32a/b70/be532ab7072b5e6ba27937693e711a62.png" alt="image"></div></div><br>  For such a historical note, this screenshot is too fresh :) But we started the particle editor just after the first public video.  It had lasers shooting with a very funny sound - and without an editor it was too inconvenient to redo them.  For the sake of this editor, another programmer joined us - and now we have a real team of 4 people!  Since then, we have made a large and fairly functional editor of particles - now the shots will be much more interesting. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/Ft5cbz9sp14" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br>  This jerky video - the first entry of a real network game with a full cycle mechanic - you can go into battle and even win it! <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/3d1/aeb/49a/3d1aeb49a013a5f030e0adad06e5acb0.gif" alt="image"></div></div><br>  A little more about gui.  Web gui fully justified itself.  But awesomium is not ideal.  It is not very fast (up to 20% of the frame is spent on it) and there are many unpleasant restrictions.  I really want to use <a href="https://servo.org/">servo</a> as a gui engine and I hope some day we will do it. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/OVYQs3KY2EE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Now we are working on the possibilities to use the destruction of the environment as an important part of the gameplay, our next goal is a playable demo.  We hope to launch the closed and then open series of alpha-beta tests soon.  Stay tuned! </div><p>Source: <a href="https://habr.com/ru/post/323120/">https://habr.com/ru/post/323120/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../323110/index.html">Protect a remote terminal server or two-factor authentication of RDG clients using Azure MFA</a></li>
<li><a href="../323112/index.html">OSSEC note on configuring parsers (decoders)</a></li>
<li><a href="../323114/index.html">Quadstor - a virtual SAN for state employees</a></li>
<li><a href="../323116/index.html">Solving Winter CrackMe Problems</a></li>
<li><a href="../323118/index.html">We put networks - we catch robots</a></li>
<li><a href="../323122/index.html">"The Cure for the Disease": automatic programming</a></li>
<li><a href="../323124/index.html">We make internal development as a software asset in five steps</a></li>
<li><a href="../323128/index.html">Explanation of the blockchain for web developers</a></li>
<li><a href="../323130/index.html">How IT professionals work. Ilya Vislotsky, Director of Client Solutions Architecture Center, Stack Group</a></li>
<li><a href="../323134/index.html">Tips, books, blogs and tools for mobile traffic arbitration</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>