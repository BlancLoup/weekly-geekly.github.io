<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MVVM: Complete Understanding (+ WPF) Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article involved my experience of bringing a certain number of students to a complete and final understanding of the MVVM pattern and its impleme...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MVVM: Complete Understanding (+ WPF) Part 1</h1><div class="post__text post__text-html js-mediator-article">  This article involved my experience of bringing a certain number of students to a complete and final understanding of the <b>MVVM</b> pattern and its implementation in <b>WPF</b> .  The pattern is described with examples of increasing complexity.  First, the theoretical part, which can be used regardless of a specific language, then the practical part, which shows several options for implementing communication between layers using WPF and, a little bit, Prism. <br><br>  <b>Why do I need to use the MVVM pattern?</b>  <b>This is an extra code!</b>  <b>Write the same can be much clearer and more straightforward.</b> <br><br>  The answer is: in small projects, the rectilinear approach works.  But as soon as it becomes a bit more, the program's logic is smeared in the interface so that the whole project turns into a monolithic tangle, which is easier to rewrite again than trying to unravel.  For clarity, you can look at two pictures: <br><a name="habracut"></a><br><img src="https://habrastorage.org/web/d0c/959/3c0/d0c9593c00f14d7a9ec0852cd06fa56e.jpg"><br>  <i>Image 1: code without MVVM.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/web/63e/b2e/786/63eb2e786eb941b1b0feadaac16e410f.jpg"><br>  <i>Image 2: MVVM code.</i> <br><br>  In the first case, the programmer, with the words ‚ÄúI just need to connect this port and this one, why do I need all these clamps and labels?‚Äù Simply connects a couple of slots with a patchcord.  In the second case, it uses some kind of template approach. <br><br><h2>  Consideration of the pattern on example No. 1: Addition of two numbers with the result output </h2><br>  Method: <br><br>  The method of writing a program using the approach "ModelFirst". <br><br><ul><li>  1. Develop a program model. </li><li>  2. Draw the program interface. </li><li>  3. Connect the interface and model with a VM layer. </li></ul><br>  So, our task is to write a program to add two numbers with the result output.  We carry out the first point: we write model.  A model is a place in a program that may require some creative effort or the backing of its creative abilities. <br><br>  However, creativity is a rather resource-consuming thought process, and excessive use of it should be avoided.  Firstly - in order not to overstrain.  Secondly - so that your programming fellow (and you yourself, in a couple of weeks), looking into your code, would not be forced to, at times too exciting, to follow the creative flight of thought.  All the places where you suddenly managed to apply creativity, you need to provide a detailed commentary.  By the way, there are numerous programming patterns that help you with this very work ‚Äî not to apply. <br><br>  So, the model in our problem will be the addition of numbers with the return of the result.  The model, in principle, may not store any state.  Those.  it may well be implemented by a static method of a static class.  Like that: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MathFuncs</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetSumOf</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b</span></span></span><span class="hljs-function">)</span></span> =&gt; a + b; }</code> </pre> <br>  The next step - (see the ‚ÄúModelFirst‚Äù methodology) - create a View or, more simply, draw an interface.  This is also a part that may contain creativity.  But, again, do not be worth it to overdo it.  The user should not be shocked by the unexpected interface.  The interface should be intuitive.  Our View will contain three text fields that can be labeled: number one, number two, sum. <br><br>  The final step is to connect the View and the model through the VM.  VM is a place that should not contain a creative element at all.  Those.  This part of the pattern is iron driven by the View and should not contain ANY "business logic".  What does conditionality from View mean?  This means that if we have three text fields in View, or three places that must enter / output data - therefore in the VM (a kind of substrate) there must be at least three properties that these data accept / provide. <br><br>  Therefore, two properties take from the View number one and two, and the third property calls our model to execute the business logic of our program.  In no case does the VM perform the addition of numbers on its own; it only causes the model for this action!  This is the function of the VM - to connect View (which is also nothing other than receiving input from the user and providing output to it) and the Model, in which the entire calculation takes place.  If you draw a picture of our problem, you get something like this: <br><br><img src="https://habrastorage.org/web/f15/969/b38/f15969b38cad4ec0acf5a46005aeed4a.png"><br>  <i>Image 3: Diagram of Example # 1</i> <br><br>  Green is a View, the three green dots in which are our three text fields.  Blue is VM, to which these three green points are nailed (pribindeny), well, a red cloud is a model that is engaged in the calculation. <br><br><h2>  Implementing Example 1 in WPF </h2><br>  Specifically, in WPF implemented "hardware support" of the MVVM pattern.  View is implemented in XAML.  Those.  the green layer (View) will be written in XAML.  Green dots are text fields.  And green lines connecting with blue will be implemented through the Binding mechanism.  The green dashed line - the connection of the entire View and VM is performed when we create a VM object and assign it to the DataContext View property. <br><br>  Draw View: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Window</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">....</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:local</span></span></span><span class="hljs-tag"> "</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">clr-namespace:</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">MyNamespace</span></span></span><span class="hljs-tag">"&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      VM --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Window.DataContext</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">local:MainVM</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   VM     View --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Window.DataContext</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--Binding, ,       VM --&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--UpdateSourceTrigger,   ,     VM    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"30"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Number1, UpdateSourceTrigger=PropertyChanged}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"30"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Number2, UpdateSourceTrigger=PropertyChanged}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--Mode=OneWay        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"30"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Number3, Mode=OneWay}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">IsReadOnly</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"True"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Now we execute the last item of the methodology - we implement the VM.  In order for our VM to "automatically" update the View, you need to implement the INotifyPropertyChange interface.  It is through it that View receives notifications that something has changed in the VM and that data needs to be updated. <br><br>  This is done as follows: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MainVM</span></span> : <span class="hljs-title"><span class="hljs-title">INotifyPropertyChange</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">event</span></span> PropertyChangedEventHandler PropertyChanged; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnPropertyChanged</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> propertyName</span></span></span><span class="hljs-function">)</span></span> { PropertyChanged?.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PropertyChangedEventArgs(propertyName)); } }</code> </pre> <br>  Now we will supply the VM with three necessary properties.  (The requirements for establishing a VM and View connection are such that they must be public properties) <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _number1; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Number1 { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> {<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _number1;} <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { _number1 = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; OnPropertyChanged(<span class="hljs-string"><span class="hljs-string">"Number3"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  View  ,    } } private int _number2; public int Number2 { get {return _number2;} set { _number1 = value; OnPropertyChanged("Number3"); } }</span></span></code> </pre> <br>  The last property is the dashed blue line of the VM and model link: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//   ,   View  ,   Number1  Number2 public int Number3 { get; } =&gt; MathFuncs.GetSumOf(Number1, Number2);</span></span></code> </pre> <br>  We implemented a full-fledged application using the MVVM pattern. <br><br>  <b>Consideration of the pattern on the example number 2:</b> <br><br>  Now we complicate our task.  The program will have a text box for entering the number.  There will be a listbox with a collection of values.  The ‚ÄúAdd‚Äù button, by clicking on which a number in the text field will be added to the collection of values.  The delete button, by clicking on which the selected number in the ListBox will be removed from the collection.  And a text box with the sum of all values ‚Äã‚Äãin the collection. <br><br><img src="https://habrastorage.org/web/caa/2d6/2ad/caa2d62adfe94e7198a74982b880ffea.PNG"><br>  <i>Image 4: Interface for Example 2</i> <br><br>  According to the method - you must first develop a model.  Now the model can not be stateless and must keep state.  So the model will be a collection of elements.  This time.  Then - the operation of adding a certain number to the collection is the responsibility of the model.  VM cannot climb into the interior of the model and independently add a number to the model collection, it must ask the model to do it.  Otherwise, it will be a violation of the principle of encapsulation.  It is as if the driver did not, as it should be, poured fuel into the gas tank, etc.  - and would climb under the hood and inject fuel directly into the cylinder.  That is, there will be a ‚Äúadd number to collection‚Äù method.  These are two.  And third: the model will provide the sum of the values ‚Äã‚Äãof the collection and also notify about its changes through the <b>INotifyPropertyChanged</b> interface.  We will not raise disputes about the purity of the model, but will simply use the notification. <br><br>  Let's immediately implement the model: <br><br>  A collection of items should notify subscribers of their change.  And it should be read-only so that no one except the model can change it in any way.  Access restriction is the fulfillment of the principle of encapsulation, it must be strictly observed to: a) not accidentally create a situation of an elusive debug, b) instill confidence that the field does not change from the outside - again, in order to facilitate debugging. <br><br>  In addition, since we continue to connect Prism for <b>DelegateCommand</b> anyway, then let's immediately use BindableBase instead of the self-implementation of INotifyPropertyChange.  For this you need to connect via Prism.Wpf NuGet libraries (at the time of writing 6.3.0).  Accordingly, OnPropertyChanged () change to RaisePropertyChanged (). <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MyMathModel</span></span> : <span class="hljs-title"><span class="hljs-title">BindableBase</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> ObservableCollection&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; _myValues = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ObservableCollection&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> ReadOnlyObservableCollection&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; MyPublicValues; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyMathModel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { MyPublicValues = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ReadOnlyObservableCollection&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(_myValues); } <span class="hljs-comment"><span class="hljs-comment">//         public void AddValue(int value) { _myValues.Add(value); RaisePropertyChanged("Sum"); } //  ,         public void RemoveValue(int index) { //      -   if (index &gt;= 0 &amp;&amp; index &lt; _myValues.Count) _myValues.RemoveAt(index); RaisePropertyChanged("Sum"); } public int Sum =&gt; MyPublicValues.Sum(); // }</span></span></code> </pre> <br>  According to the method - draw a View.  Before this, a few necessary explanations.  In order to create a button and VM connection, you need to use DelegateCommand.  The use for this event and the form code, for pure MVVM is not allowed.  Used events must be framed into commands.  But in the case of a button such a frame is not required, because  there is its special property Command. <br><br>  In addition, the number that we will add using DelegateCommand, we will not bind to the VM, but will be passed as a parameter to this DelegateCommand, in order not to clutter the VM and avoid desynchronization by directly invoking the command and using the parameter.  Pay attention to the resulting scheme and, especially, to the place circled in red. <br><br><img src="https://habrastorage.org/web/a93/bbf/2d0/a93bbf2d076e4222a7400f623f0ca649.png"><br>  <i>Image 5: Diagram for Example 2</i> <br><br>  Here, the binding on the View does not occur in the View &lt;=&gt; ViewModel, but in the View &lt;=&gt; View.  In order to achieve this, a second type of binding is used, where the name of the element and its properties are indicated, to which the binding is performed - "{Binding ElementName = TheNumber, Path = Text}". <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Window</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Window.DataContext</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">local:MainVM</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  DataContext --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Window.DataContext</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DockPanel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DockPanel.Dock</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Top"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Horizontal"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TheNumber"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"50"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"5"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Add"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"5"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Command</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding AddCommand}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">CommandParameter</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding ElementName=TheNumber, Path=Text}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">StackPanel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DockPanel.Dock</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Bottom"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Sum, Mode=OneWay}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"5"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DockPanel.Dock</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Right"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">VerticalAlignment</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Top"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Remove"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"130"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"5"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Command</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding RemoveCommand}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">CommandParameter</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding ElementName=TheListBox, Path=SelectedIndex}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TheListBox"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ItemsSource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding MyValues}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DockPanel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Window</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Now we implement the ViewModel: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MainVM</span></span> : <span class="hljs-title"><span class="hljs-title">BindableBase</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> MyMathModel _model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyMathModel(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MainVM</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//         View _model.PropertyChanged += (s, e) =&gt; { RaisePropertyChanged(e.PropertyName); }; AddCommand = new DelegateCommand&lt;string&gt;(str =&gt; { //    -  VM int ival; if (int.TryParse(str, out ival)) _model.AddValue(ival); }); RemoveCommand = new DelegateCommand&lt;int?&gt;(i =&gt; { if(i.HasValue) _model.RemoveValue(i.Value); }); } public DelegateCommand&lt;string&gt; AddCommand { get; } public DelegateCommand&lt;int?&gt; RemoveCommand { get; } public int Sum =&gt; _model.Sum; public ReadOnlyObservableCollection&lt;int&gt; MyValues =&gt; _model.MyPublicValues; }</span></span></code> </pre> <br>  <b>Attention is important!</b>  Concerning forwarding notifications from the model.  The VM cannot independently notify about the change in the amount.  she should not know what exactly to change in the model, after calling her methods and whether to change at all.  The VM model must be a black box.  Those.  it should transfer user input and actions to the model and if something has changed in the model (what the model itself should notify about it), then only then notify further View. <br><br>  We implemented the second full-fledged application using the MVVM pattern, got acquainted with the ObservableCollection, DelegateCommand, binding the View &lt;=&gt; View and forwarding notifications to the View. </div><p>Source: <a href="https://habr.com/ru/post/338518/">https://habr.com/ru/post/338518/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../338498/index.html">Using Zabbix to monitor MS SQL Server database</a></li>
<li><a href="../338502/index.html">Full-stack-developers. New trend or real need of companies?</a></li>
<li><a href="../338506/index.html">23,000 people wrote online dictation on April 8, 2017. How did this happen?</a></li>
<li><a href="../338512/index.html">Evolution: from interns to interns</a></li>
<li><a href="../338514/index.html">And the skies will tremble ... Diablo: looking back</a></li>
<li><a href="../338520/index.html">Security Week 38: Security cameras pass over the IR, the neural network quickly selects passwords, hackers scout through Word</a></li>
<li><a href="../338522/index.html">What did the UFO see when they arrived at RIT ++ 2017</a></li>
<li><a href="../338524/index.html">Accelerate development with interactive blockhams</a></li>
<li><a href="../338526/index.html">Broadcast from the gamedev conference 4C in St. Petersburg. Second day</a></li>
<li><a href="../338528/index.html">What conferences work and how to go there</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>