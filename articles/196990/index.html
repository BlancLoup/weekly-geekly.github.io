<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Open the doors remotely</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In our office, some important doors open with "cards" - contactless RFID keys. The whole SKD business is called and is based on Orion software from Bo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Open the doors remotely</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage3/29c/f63/7bd/29cf637bd38fe1ace73d6a9bb44976af.jpg" alt="image"><br>  In our office, some important doors open with "cards" - contactless RFID keys.  The whole SKD business is called and is based on Orion software from Bolid.  Once I thought: ‚ÄúIt would be great to open the doors from a smartphone!‚Äù.  Challenge accepted! <br><br><a name="habracut"></a><br><br>  <b>Step 1.</b> <br>  A quick inspection of the ‚ÄúOperational Task‚Äù and the ‚ÄúDatabase Administrator‚Äù (Orion software components) showed that non-human intervention in the operation of the system is not possible.  At least in open sources about this says nothing.  But there is the possibility of adding Management Scripts. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage3/601/eea/64a/601eea64a37efb21170e22e95ccf2909.jpg" alt="image"><br><br>  This allows us to perform some sequence of actions by pressing a key (or a combination of them).  Already something.  We add the script, assign it to the keys (Shift + W in my case), check (do not forget to do ‚ÄúUpdate DB in the Operational Task‚Äù in the Tools menu item) - it works! <br><br>  <b>Step 2.</b> <br>  The first step did not bring us much benefit.  You can open the door only by pressing the desired key combination in the Operational Task.  It remains only to go to the forehead: to emulate the pressing of buttons.  Since the programmer from me is not very good, and I didn‚Äôt want to spend a lot of time on this, the choice of means for implementing this perversion fell on Processing.  Write the code: <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> processing.net.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.awt.AWTException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.awt.Robot; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.awt.event.InputEvent; Robot robot; String HTTP_GET_REQUEST = <span class="hljs-string"><span class="hljs-string">"GET /"</span></span>; String HTTP_HEADER = <span class="hljs-string"><span class="hljs-string">"HTTP/1.0 200 OK\r\nContent-Type: text/html\r\n\r\n"</span></span>; Server s; Client c; String input; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> keycode; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ s = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Server(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-number"><span class="hljs-number">8080</span></span>); <span class="hljs-comment"><span class="hljs-comment">// start server on http-alt try { robot = new Robot(); } catch (AWTException e) { e.printStackTrace(); } } void draw() { //     c = s.available(); if (c != null) { input = c.readString(); input = input.substring(0, input.indexOf("\n")); //     if (input.indexOf(HTTP_GET_REQUEST) == 0) { c.write(HTTP_HEADER); input = input.substring(4,7); //       if(input.indexOf('q') &gt; 0) keycode=KeyEvent.VK_Q; if(input.indexOf('w') &gt; 0) keycode=KeyEvent.VK_W; if(input.indexOf('e') &gt; 0) keycode=KeyEvent.VK_E; //   robot.keyPress(KeyEvent.VK_SHIFT); robot.keyPress(keycode); //   robot.keyRelease(keycode); robot.keyRelease(KeyEvent.VK_SHIFT); c.stop(); //   } } }</span></span></code> </pre> <br><br>  To be honest, I took the code from examples.  I think everyone will understand what is happening there. <br>  Whoever does not understand, I explain: we are listening to port 8080, we receive a request, we pull out the necessary parameter from it, we react adequately to it. <br>  It turned out such a mini-server on the knee.  You need to run it on the ACS server and it will do what it needs. <br><br>  <b>Step 3.</b> <br>  We already can not just open the door, but remotely.  It remains to write a web-muzzle. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?PHP</span></span> header(<span class="hljs-string"><span class="hljs-string">"Content-Type: text/html; charset=windows-1251"</span></span>); $act = $_REQUEST[<span class="hljs-string"><span class="hljs-string">'act'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!$act) buttons(); <span class="hljs-comment"><span class="hljs-comment">//   if($act=='push') push(); //   function push(){ $btn = $_REQUEST['btn']; if($btn!='') { //    $fp = fopen("http://___:8080/".$btn, "r"); fclose($fp); } } function buttons() { //        JavaScript </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span><span class="hljs-comment"> &lt;!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"&gt;&lt;html&gt;&lt;head&gt; &lt;script type="text/javascript"&gt; function getXmlHttp(){ var xmlhttp; try { xmlhttp = new ActiveXObject("Msxml2.XMLHTTP"); } catch (e) { try { xmlhttp = new ActiveXObject("Microsoft.XMLHTTP"); } catch (E) { xmlhttp = false; } } if (!xmlhttp &amp;&amp; typeof XMLHttpRequest!='undefined') { xmlhttp = new XMLHttpRequest(); } return xmlhttp; } function btnClick(i) { //alert(i); var req = getXmlHttp(); req.open('GET', 'index.php?act=push&amp;btn='+i, true); req.send(null); } &lt;/script&gt; &lt;button style="width: 100%; height: 50px;" onclick='btnClick("q")'&gt;&lt;/button&gt;&lt;br&gt;&lt;br&gt; &lt;button style="width: 100%; height: 50px;" onclick='btnClick("w")'&gt;2 &lt;/button&gt;&lt;br&gt;&lt;br&gt; &lt;button style="width: 100%; height: 50px;" onclick='btnClick("e")'&gt;&lt;/button&gt;&lt;br&gt;&lt;br&gt; &lt;/head&gt;&lt;/html&gt; </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?PHP</span></span></span><span class="hljs-comment"> } </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br><br>  VEB performance is chosen for greater versatility: you can run on any platform.  Although you can write on the same processing and run on Android. <br><br>  <b>Summary.</b> <br>  Of course, this is a crutch.  The system has many critical flaws.  Doors are opened by the System Administrator, and not by an employee, which makes it impossible to keep track of working time and tracking an employee‚Äôs movement around the office.  The keystroke emulator does not work while the user of the system under which it is running is not active.  Of course, you can use it, but it was done in an hour. <br>  If you have any suggestions for improving this project, I will be glad to hear. <br><br>  <b>Plans</b> <br>  Of course, first of all I would like to do without emulating keystrokes.  I'll try to contact the Orion software developers, maybe they will go to the meeting. <br>  Next, you can make authorization on the user's domain credentials to differentiate access rights, i.e.  give everyone the opportunity to open only those doors that are supposed to be. </div><p>Source: <a href="https://habr.com/ru/post/196990/">https://habr.com/ru/post/196990/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../196980/index.html">Introduction to data analysis with Pandas</a></li>
<li><a href="../196982/index.html">Tizen - a view from the inside</a></li>
<li><a href="../196984/index.html">Pictures from external resources - good or evil?</a></li>
<li><a href="../196986/index.html">About domain and FSKN</a></li>
<li><a href="../196988/index.html">Mobile Technology Section at Russian Internet Week 2013</a></li>
<li><a href="../196992/index.html">Monitoring code coverage during unit testing in Windows Phone</a></li>
<li><a href="../196998/index.html">Facebook, Steve Ballmer and Al Gore - everyone tried to buy Twitter</a></li>
<li><a href="../197008/index.html">Storage of service bases Team Foundation Server 2013 RC on SQL Server 2014 PAGE1</a></li>
<li><a href="../197010/index.html">Electronic services in Russia will be reduced</a></li>
<li><a href="../197014/index.html">Simple image and content slider on AngularJS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>