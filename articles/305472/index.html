<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We attack SS7: security analysis of cellular operators in 2015</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Interception of mobile phone conversations is considered to be a difficult task. However, not only the special services own this art: a middle level h...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We attack SS7: security analysis of cellular operators in 2015</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/pt/blog/305472/"><img src="https://habrastorage.org/files/c35/ce8/6c9/c35ce86c949f4746b3ddbd6bde409bbc.png"></a> <br><br>  Interception of mobile phone conversations is considered to be a difficult task.  However, not only the special services own this art: a middle level hacker can attack subscribers if he is familiar with the structure of signaling networks.  The good old SS7 vulnerabilities allow you to eavesdrop on phone conversations, locate callers, intercept SMS, and disconnect your phone from the network. <br><br>  In 2015, Positive Technologies experts carried out 16 projects to analyze the security of SS7 networks of leading mobile operators in the EMEA and APAC regions.  The results of the eight most informative projects fell into our statistics.  In this article, we will look at the level of security of subscribers of cellular networks, as well as all industrial and IoT devices, from ATMs to GSM pressure monitoring systems on a gas pipeline, which are also subscribers of cellular networks.  The report describes the main problems detected and their solutions. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Preamble: Hello from the 70s </h4><br>  Developed forty years ago, the SS7 system (SS-7) has certain disadvantages in terms of security (for example, there is no encryption and authentication of service messages).  For a long time, this posed no danger to either the subscribers or the operator: the SS7 network was a closed system in which only fixed-line operators were connected.  However, as time goes on, the network has evolved to support the needs of mobile communications and the provision of additional services.  In the early 2000s, the SIGTRAN specification was proposed, allowing SS7 service information to be transmitted over IP networks.  Signal network has ceased to be isolated. <br><br>  Of course, it‚Äôs impossible to get directly into the signaling network; you will need an SS7 gateway.  But to ensure access to it is not so difficult.  You can get a carrier license in a country where it is overlooked, or you can get access on the black market from the current operator.  There are ways to get into the network through hacked camera equipment, GGSN or femtocell.  If there is a technical company operator among the members of the hacker group, he can perform a series of attacks using a set of legitimate commands or connect his equipment to SS7. <br><br>  Attacks via SS7 can be carried out from anywhere on the planet, which makes this method one of the most promising for an intruder.  The attacker does not need to physically be close to the subscriber, as is the case with a fake base station, so it is almost impossible to calculate it.  High qualification is also not required: many ready-made applications for working with SS7 are available on the network.  At the same time, operators cannot block commands from individual nodes, since this has a negative impact on the entire service and violates the principles of roaming. <br><br>  For the first time, SS7 vulnerabilities were publicly demonstrated in 2008: a German researcher Tobias Engel showed the technique of spying on subscribers of mobile networks.  In 2014, experts from Positive Technologies made a presentation on ‚ÄúHow to eavesdrop on a person on the other side of the globe‚Äù and presented a detailed report ‚ÄúVulnerabilities of mobile communication networks based on SS7‚Äù.  In 2015, SR Labs on the Australian program ‚Äú60 minutes‚Äù, being in Germany, intercepted the SMS correspondence of the Australian senator Nick Xenophon and the British journalist, and then watched the movements of the senator on a business trip to Tokyo. <br><br><h4>  Overall results </h4><br>  For reasons of confidentiality, we do not disclose the names of the companies that participated in our research.  We only note that half of the SS7 networks studied belong to the largest mobile operators with more than 40 million subscribers. <br><br><img src="https://habrastorage.org/files/762/5a1/165/7625a1165ba04970bbce81dc83e882b2.png"><br><br>  <i>Volume of subscriber base of operators</i> <br><br>  The final security level of the SS7 networks of all the studied mobile operators was extremely low.  In 2015, attacks related to data leakage of subscribers (77% of successful attempts), network disruptions (80%) and fraudulent activities (67%) could have been implemented against telecom operators and their SS7 networks. <br><br>  Incoming SMS messages could be intercepted in the networks of all study participants.  Nine out of ten attacks (89%) reached the goal, and this is a very bad result.  Judge for yourself: SMS messages are often used in two-factor authentication systems and for recovering passwords from various Internet services.  Interception of messages was performed by the UpdateLocation method.  The attacker registers the victim's subscriber in the fake network, after which all incoming SMS messages arrive at the address specified by him. <br><br><img src="https://habrastorage.org/files/1b4/be8/731/1b4be873158a4938aaed7a3da4dfd5ec.png"><br><br>  <i>The proportion of successful attacks in order to obtain sensitive information</i> <br><br>  Unauthorized balance inquiry was also possible almost everywhere (92% of attacks).  For this attack, the ProcessUnstructuredSS-Request message is used, in the body of which the corresponding USSD command is transmitted. <br><br>  Voice calls were protected a little better: only half of the attacks with the aim of listening to incoming and outgoing calls were crowned with success.  But this is a huge risk for subscribers.  To intercept incoming calls, a roaming number substitution technique was used.  Listening of outgoing calls was carried out by the InsertSubscriberData method.  Then, in either case, traffic was redirected to another switch. <br><br><img src="https://habrastorage.org/files/e30/781/032/e3078103218e4800be59bd8bc6ed0ef2.png"><br><br>  <i>Subscriber location methods (share of successful attacks)</i> <br><br>  Determine the physical location of the subscriber happened in all networks except one.  The main methods are SendRoutingInfo and ProvideSubscriberInfo, the latter giving the result with every second attack (53%). <br><br>  The most valuable subscriber information is IMSI.  This identifier is needed for most attacks.  The easiest way was to get it using the SendRoutingInfo method. <br><br><img src="https://habrastorage.org/files/007/3fa/763/0073fa7638fe4eb58bc1662e70dfef09.png"><br><br>  <i>Methods of stealing subscriber information (share of successful attacks)</i> <br><br>  Another method of determining IMSI - SendRoutingInfoForSM - was effective in 70% of cases.  This message is used in the incoming SMS message to request route information and localize the recipient subscriber.  It was possible to find out the subscriber ID using the SendIMSI command, but with a lower probability (25%). <br><br><h4>  Fraud </h4><br>  In each of the systems were identified deficiencies that allow to implement any fraudulent actions by an external offender.  Examples of such actions include call forwarding, transfer of funds from the subscriber‚Äôs account, changing the subscriber‚Äôs profile. <br><br><img src="https://habrastorage.org/files/b40/c84/408/b40c844084ca4d7e84b9fbe5e91a9847.png"><br><br>  <i>Fraud: the proportion of successful attacks</i> <br><br>  Most of the attacks to redirect incoming calls were successful (94%).  This confirms the existence of significant problems in SS7 networks related to the architecture of protocols and systems. <br><br>  The outgoing call was redirected only in 45% of cases.  For redirection, the InsertSubscriberData method was used. <br><br>  Attacks to redirect incoming calls were carried out using two techniques - roaming number substitution and call forwarding manipulation.  The roaming number is changed at the moment of an incoming call to the attacked subscriber, who must be registered in the fake network.  In response to the roaming number request, the attacker sends the number to redirect the call.  The fee for the established connection will fall on the operator. <br><br>  Manipulation with redirection - unauthorized installation of unconditional redirection.  All incoming calls for the subscriber will be redirected to the specified number.  You have to pay for calls to the subscriber. <br><br><img src="https://habrastorage.org/files/ee8/375/fa2/ee8375fa29184cf6972bee9484cb08af.png"><br><br>  <i>Incoming call redirection methods (shares of successful attacks)</i> <br><br>  Subscriber profile change was possible in every second attack carried out by the InsertSubscriberData method (54%).  The attacker has the ability to change the subscriber profile in such a way that outgoing calls will be bypassed by the charging system.  This attack can be used in fraud schemes for generating traffic to paid numbers and expensive destinations at the expense of the operator. <br><br><h4>  DoS attack on the subscriber </h4><br>  To make the subscriber equipment (phone, modem, GSM alarm or sensor) inaccessible for incoming transactions, an attacker can carry out targeted attacks on subscribers of the mobile network.  Most of the SS7 networks we studied are vulnerable to DoS attacks (80% were successful). <br><br>  In all cases, the UpdateLocation method was used;  to attack you need to know the subscriber's IMSI.  An UpdateLocation message is sent to the operator‚Äôs network informing the HLR that the subscriber has registered (on a fake network).  After that, incoming calls to the subscriber are routed to the address specified during the attack. <br><br><h4>  Causes of problems </h4><br>  Most attacks on SS7 networks were possible due to the lack of verification of the real location of the subscriber.  On the second and third places in the list of reasons - the inability to verify the identity of the network subscriber and the lack of filtering unused signal messages.  Fourth position - SMS Home Routing configuration errors. <br><br><img src="https://habrastorage.org/files/6e6/124/9ef/6e61249efc764515a871be5d32c8a8cb.png"><br><br>  <i>Average number of successful attacks on a single SS7 network (depending on the deficiency)</i> <br><br><h4>  What can be done </h4><br>  Most of the flaws that determine the location of the subscriber and steal data can be eliminated by changing the configuration of network equipment.  At a minimum, it is necessary to prohibit the processing of AnyTimeInterrogation and SendIMSI messages on the HLR. <br><br>  Architectural problems of protocols and systems are solved by blocking unwanted messages.  First of all, you should pay attention to SendRoutingInfoForSM, SendIMSI, SendRoutungInfoForLCS, SendRoutingInfo.  Filtering will help avoid risks associated with denial of service, intercepting SMS messages, forwarding calls, listening to calls, changing the subscriber profile. <br><br>  However, not all specified SS7 network messages can be dangerous.  It is necessary to implement filtering in such a way that only unwanted messages used in attacks are cut off.  To this end, it is recommended to introduce additional means of protection, for example, intrusion detection systems.  Such systems do not affect network traffic, but they allow identifying the actions of the offender and determining the necessary settings for filtering messages. <br><br>  The full version of the study: <a href="http://www.ptsecurity.ru/research/analytics">www.ptsecurity.ru/research/analytics</a> . <br><br>  <b>Authors</b> : Dmitry Kurbatov, Sergey Puzankov, Telecommunication Systems Security Department, Positive Technologies </div><p>Source: <a href="https://habr.com/ru/post/305472/">https://habr.com/ru/post/305472/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../305452/index.html">Smart tape VK - the killer of your conversions, but telegrams are not the way out</a></li>
<li><a href="../305462/index.html">Bot as a task manager?</a></li>
<li><a href="../305464/index.html">Cryptocurrency Dash: Symbiosis of Man and Code</a></li>
<li><a href="../305466/index.html">Compiling and connecting dynamic nginx modules</a></li>
<li><a href="../305470/index.html">Microsoft Edge and RTC: pain history</a></li>
<li><a href="../305474/index.html">Starbucks Mobile Payment Success Secrets</a></li>
<li><a href="../305476/index.html">The book "100 NEW Main Design Principles"</a></li>
<li><a href="../305478/index.html">Use RxJava and Retrofit on Android, given the screen rotation</a></li>
<li><a href="../305482/index.html">Announcement Rambler.iOS # 7</a></li>
<li><a href="../305484/index.html">URL history: domain, protocol and port</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>