<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PIN code when paying by card - dots above i</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day to all! 

 After reading a few articles on Habr√© about plastic cards, POS terminals and related things, it seemed to me that this topic is qu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PIN code when paying by card - dots above i</h1><div class="post__text post__text-html js-mediator-article">  Good day to all! <br><br>  After reading a few articles on Habr√© about plastic cards, POS terminals and related things, it seemed to me that this topic is quite interesting to the community.  In this small publication, I want to finally understand the topic of entering a PIN-code on POS terminals and finally answer, to the best of my knowledge, the question: why is it necessary to enter a PIN in some cases and not in others? <br><a name="habracut"></a><br>  If the topic is just as interesting to the community, then in the future you will see several more articles about the principles of operation of <s>this entire kitchen</s> , everything related to the POS terminal, processing centers and plastic cards. <br><br>  But for a start foreword. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It just so happened that I work in one of the banks of our country.  I am actually engaged in setting up POS terminals from scratch to, in fact, commissioning. <br><br>  This is my first article, so I apologize in advance for some confusion, as well as for the fact that maybe I will miss something, because it is impossible to fit all the details into the framework of the article. <br><br>  First of all, you will need to mention the <b>TMS</b> (Terminal Management Server \ Station).  In short, it is a computer on which a program runs - the configuration center for all POS terminals.  It is there that the so-called ‚Äúapplication configuration files‚Äù are created, that is, what is poured into the POS and characterizes its operation. <br><br>  In TMS, all POS parameters are set, both very significant (for example, the list of payment systems with which POS works, the settings of these systems, CVM sheets, terminal action codes) and minor ones (such as the order of the menu items on the screen terminal, or design checks). <br><br>  At the output, a specially packed file appears that ‚Äúunderstands‚Äù the terminal.  This file is uploaded to the terminal. <br><br>  Now about the point: <b>ask or not ask for a PIN (in the case of an EMV card):</b> <br><br>  On the card's EMV chip, at the stage of loading the application, a so-called <b>CVM-sheet</b> (CVM - Cardholder Verification Method) is poured.  It can also be changed during a transaction with a special issuing script sent from the processing center, but I will allow myself to release these subtleties. <br><br>  Each issuing bank selects a CVM list based on its requirements.  Here is an example of a classic CVM list: <br><br>  <b>4403410342031E031F02</b> <br><br>  Decryption looks like this: <br><br><img src="https://habrastorage.org/files/5db/63e/94d/5db63e94db7242ac934b80e0f9529316.png"><br><br>  And it is read from left to right (I apologize in advance for the clumsy scheme from the master paint minus 92 leveled): <br><br><img src="https://habrastorage.org/files/0fa/e6f/c67/0fae6fc6740a4992be48f7834e5fe4bb.png"><br><br>  The terminal itself also has its own terminal CVM list.  It is set in TMS at the stage of creating configuration files that are uploaded to the POS.  It is set up by the acquiring bank, again, according to its requests. <br><br>  Everything works very simply: during a transaction, two CVM lists (cards and terminals) are compared.  Only those verification methods that match in both sheets work (in fact, the intersection of CVM sheets is checked).  Remaining methods are discarded! <br><br>  That is, in this example, the algorithm is as follows: <br><br>  <i>Ask the encrypted PIN (after checking if there is such a method in the terminal's CVM list), if the user refuses (this is the very pressing of the red button on the PIN keyboard), request an offline open PIN (and he has the right to refuse - see the picture), if it refuses again - request an online PIN (it is checked not by a card, but by the host), if it refuses again - you can not request a signature (you can‚Äôt refuse it - see the picture again).</i>  <i>If there is no signature verification in the terminal's CVM list, the method is skipped (this is NOT equal to failure!) And the ‚ÄúNo CVM‚Äù method is used with the ‚ÄúIf not unattended cash and not purchase cash‚Äù condition (but usually in few used).</i>  <i>If there is no such method in the CVM list of the terminal either, then the check fails and the transaction is rejected.</i> <br><br>  Naturally, the number of different variations of the CVM-sheets of cards and terminals - and even more so their combinations - is very large.  So now, I think, it has become clearer to everyone why the card in the device requests a PIN, and in the other device the same card asks for a signature.  And why does another card work properly with a PIN request in the same device, and a card that works in the third one - here it refuses to work at all.  I also hope that after reading this article, the topic of requesting PIN codes when paying with a card has become clearer and more transparent and will not have to be surprised in stores about this. <br><br>  Thank you all for your attention! </div><p>Source: <a href="https://habr.com/ru/post/244107/">https://habr.com/ru/post/244107/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244097/index.html">Miranda NG Project Receives Wild Signs Award (Part One)</a></li>
<li><a href="../244099/index.html">Byrobot: quadrocopter for Chuck Norris and 6d thinking</a></li>
<li><a href="../244101/index.html">WUD 2014 - World Usability Day</a></li>
<li><a href="../244103/index.html">A revolution in computer simulation of the human body in motion</a></li>
<li><a href="../244105/index.html">DD-WRT and SSL certificates</a></li>
<li><a href="../244109/index.html">A few thoughts about analyzing other people's opinions</a></li>
<li><a href="../244111/index.html">Setting up a server with Chef (Quick and easy)</a></li>
<li><a href="../244113/index.html">PHPixie Amalgama - Internationalization in PHPixie</a></li>
<li><a href="../244115/index.html">Attackers use CVE-2014-6332</a></li>
<li><a href="../244117/index.html">Multiple PHP Versions Under One Apache on Windows</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>