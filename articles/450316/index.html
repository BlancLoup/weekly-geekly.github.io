<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>TDD: development methodology that changed my life</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At 7:15 in the morning. Our tech support is inundated with work. About us just told in the transfer of "Good Morning America" ‚Äã‚Äãand many of those who ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>TDD: development methodology that changed my life</h1><div class="post__text post__text-html js-mediator-article">  At 7:15 in the morning.  Our tech support is inundated with work.  About us just told in the transfer of "Good Morning America" ‚Äã‚Äãand many of those who first visits our site, faced with errors. <br><br>  We have a real breakthrough.  We, right now, before we lose the opportunity to turn visitors to a resource into new users, we are going to roll out a patch pack.  One of the developers has prepared something.  He thinks it will help deal with the problem.  We place a link to the updated version of the program, which has not yet gone into production, in the chat company, and we ask everyone to test it.  Works! <br><br>  Our heroic engineers run scripts to deploy systems and in a few minutes the update goes into battle.  Suddenly, the number of calls to tech support doubles.  Our urgent fix something broke, the developers grab the git blame, and the engineers at this time roll back the system to the previous state. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href="https://habr.com/ru/company/ruvds/blog/450316/"><img src="https://habrastorage.org/getpro/habr/post_images/715/f8a/020/715f8a020e1adfe61cb65c6b6bccb191.jpg" alt="image"></a> <br><br>  The author of the material, the translation of which we are publishing today, believes that all this could have been avoided thanks to TDD. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Why do I use TDD?</font> </h2><br>  I have not been in such situations for a long time.  And it's not that the developers have stopped making mistakes.  The fact is that for many years in each team, which I led and on which I influenced, the TDD methodology has been applied.  Errors, of course, still happen, but the penetration into the production of problems that could bring the project down has dropped to almost zero, even though the software update frequency and the number of tasks that need to be solved during the update process have increased exponentially since when something happened that I told at the beginning. <br><br>  When someone asks me why he should contact TDD, I tell him this story, and I can remember about a dozen other similar cases.  One of the most important reasons why I switched to TDD is that this methodology allows us to <a href="https://ieeexplore.ieee.org/abstract/document/4343755">improve the</a> coverage of the code with tests, which leads to the fact that production gets <a href="https://www.researchgate.net/publication/3249271_Guest_Editors%2527_Introduction_TDD--The_Art_of_Fearless_Programming">40-80% less errors</a> .  This is what I like most about TDD.  This removes a whole mountain of problems from the developer‚Äôs shoulders. <br><br>  In addition, it is worth noting that TDD relieves developers from the fear of making changes to the code. <br><br>  In projects in which I participate, sets of automatic modular and functional tests almost daily prevent production of a code that could seriously disrupt these projects.  For example, now I‚Äôm looking at 10 library automatic updates made last week, such that before releasing them without using TDD, I would be afraid that they might spoil something. <br><br>  All of these updates have been automatically integrated into the code, and they are already used in production.  I didn‚Äôt check any of them manually, and didn‚Äôt worry at all that they might have a bad effect on the project.  At the same time, I did not have to think long to give this example.  I just opened GitHub, looked at recent mergers, and saw what I was talking about.  The task that was previously solved manually (or, even worse, the task that was ignored) is now an automated background process.  You can try to do something similar without good code coverage with tests, but I would not recommend doing so. <br><br><h2>  <font color="#3AC1EF">What is TDD?</font> </h2><br>  TDD stands for Test Driven Development.  The process implemented during the application of this methodology is very simple: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b6e/b62/856/b6eb62856a3b14b0c661e94ed12cc6b8.png"></div><br>  <i><font color="#999999">Tests detect errors, tests complete, refactoring</font></i> <br><br>  Here are the basic principles for using TDD: <br><br><ol><li>  Before writing the implementation code of a certain opportunity, they write a test that allows you to check whether this future implementation code is working or not.  Before proceeding to the next step, the test is run and made sure that it gives an error.  Because of this, you can be sure that the test does not produce false-positive results, this is a kind of testing of the tests themselves. </li><li>  Create an implementation opportunity and ensure that it is successfully tested. </li><li>  Perform, if necessary, refactoring of the code.  Refactoring, if there is a test that is able to indicate to the developer whether the system works correctly or incorrectly, gives the developer confidence in his actions. </li></ol><br><h2>  <font color="#3AC1EF">How can TDD help save program development time?</font> </h2><br>  At first glance it may seem that writing tests means a significant increase in the amount of project code, and the fact that all this takes developers a lot of extra time.  In my case, at first, everything was like that, and I tried to understand how, in principle, you could write test code, and how to add tests to code that was already written. <br><br>  TDD is characterized by a certain learning curve, and as long as a beginner climbs this curve, the time required for development can increase by <a href="https://www.infoq.com/news/2009/03/TDD-Improves-Quality">15-35%</a> .  Often this is exactly what happens.  But about 2 years after using TDD, something incredible starts to happen.  Namely, I, for example, began, with preliminary writing unit tests, to program faster than before, when TDD was not used. <br><br>  A few years ago I was implementing, in the client system, the ability to work with fragments of a video clip.  Namely, it was a question of allowing the user to indicate the beginning and end of a fragment of a recording, and receive a link to it, which would make it possible to refer to a specific place in the clip, and not to the entire clip. <br><br>  I did not have a job.  The player reached the end of the fragment and continued to reproduce it, but I had no idea why this was so. <br><br>  I figured the problem was incorrectly connecting event listeners.  My code looked like this: <br><br><pre><code class="plaintext hljs">video.addEventListener('timeupdate', () =&gt; {  if (video.currentTime &gt;= clip.stopTime) {    video.pause();  } });</code> </pre> <br>  The process of finding a problem looked like this: making changes, compiling, reloading, clicking, waiting ... This sequence of actions was repeated again and again. <br><br>  In order to check each of the changes made to the project, it was necessary to spend almost a minute, and I experienced an incredibly many solutions to the problem (most of them 2-3 times). <br><br>  Maybe I made a mistake in the <code>timeupdate</code> keyword?  Did I understand the specifics of working with the API?  Does the <code>video.pause()</code> call <code>video.pause()</code> ?  I made changes to the code, added <code>console.log()</code> , went back to the browser, clicked on the <code></code> button, clicked on the position at the end of the selected fragment, and then waited patiently until the clip was completely played.  Logging inside the <code>if</code> construct didn‚Äôt lead to anything.  It looked like a hint about a possible problem.  I copied the word <code>timeupdate</code> from the API documentation to be absolutely sure that I didn‚Äôt make a mistake when entering it.  I refresh the page again, click again, wait again.  And again the program refuses to work properly. <br><br>  I finally put <code>console.log()</code> outside the <code>if</code> block.  "It will not help," I thought.  In the end, the <code>if</code> expression was so simple that I just didn‚Äôt imagine how to write it wrong.  But logging in this case worked.  I choked on coffee.  ‚ÄúWhat is this !?‚Äù - I thought. <br><blockquote>  Murphy's debugging law.  The place of the program that you have never tested, since you firmly believed that it could not contain errors, will be exactly the place where you will find an error after, completely exhausted, you make changes to this place only because of the fact that they have already tried everything they could think of. </blockquote><br>  I set a breakpoint in the program to figure out what was going on.  I researched the value of <code>clip.stopTime</code> .  To my surprise, it was <code>undefined</code> .  Why?  I looked at the code again.  When the user selects the end time of the fragment, the program places the end of fragment marker in the right place, but does not set the value of <code>clip.stopTime</code> .  "I am an incredible idiot," I thought, "I cannot be allowed on computers until the end of my life." <br><br>  I did not forget about it even years later.  And all - thanks to the feeling that experienced, yet finding a mistake.  You probably know what I'm talking about.  With all this happened.  And, perhaps, everyone can recognize himself in this meme. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/703/e2d/01c/703e2d01c140fba62e25914e340bad97.png"></div><br>  <i><font color="#999999">This is how I look when I program</font></i> <br><br>  If I wrote that program today, I would start working on it like this: <br><br><pre> <code class="plaintext hljs">describe('clipReducer/setClipStopTime', async assert =&gt; { const stopTime = 5; const clipState = {   startTime: 2,   stopTime: Infinity }; assert({   given: 'clip stop time',   should: 'set clip stop time in state',   actual: clipReducer(clipState, setClipStopTime(stopTime)),   expected: { ...clipState, stopTime } }); });</code> </pre> <br>  There is a feeling that there is much more code here than in this line: <br><br><pre> <code class="plaintext hljs">clip.stopTime = video.currentTime</code> </pre> <br>  But that's the point.  This code acts as a specification.  This is both documentation and evidence that the code works as required by this documentation.  And, since this documentation exists, if I change the order of working with the fragment end time marker, I will not have to worry about whether I violated the correctness of work with the end time of the clip as I made these changes. <br><br>  <a href="https://medium.com/javascript-scene/rethinking-unit-test-assertions-55f59358253f">Here</a> , by the way, is useful material on writing unit tests, such as the one we just looked at. <br><br>  The meaning is not how long it takes to enter this code.  The point is how much time it takes to debug if something goes wrong.  If the code is incorrect, the test will give an excellent error report.  I will immediately know that the problem is not the event handler.  I will know that it is either in <code>setClipStopTime()</code> or in <code>clipReducer()</code> , where the state change is implemented.  Thanks to the test, I would know what functions the code performs, what it actually outputs, and what is expected of it.  And, more importantly, the same knowledge will be with my colleague, who, six months after I wrote the code, will introduce new features into it. <br><br>  Starting a new project, I, as one of the first things, perform setting up an <a href="https://medium.com/javascript-scene/streamline-code-reviews-with-eslint-prettier-6fb817a6b51d">observer script</a> that automatically runs unit tests each time a file changes.  I often program using two monitors.  On one of them, the developer console is open, in which the results of executing such a script are displayed, on the other, the interface of the environment in which I write code is displayed.  When I make a change to the code, I usually, within 3 seconds, find out whether the change turned out to be a worker or not. <br><br>  For me, TDD is much more than just insurance.  This is the ability to constantly and quickly, in real time, obtain information about the status of my code.  Instant reward in the form of passed tests, or instant error reporting in the event that I did something wrong. <br><br><h2>  <font color="#3AC1EF">How did the TDD methodology teach me to write better code?</font> </h2><br>  I would like to make one confession, although it is embarrassing to admit it: I didn‚Äôt imagine how to build applications before I learned TDD and unit testing.  I have no idea how I was taken to work at all, but after I interviewed many hundreds of developers, I can say with certainty that there are many programmers in a similar situation.  TDD has taught me almost everything I know about effective decomposition and composition of software components (I mean modules, functions, objects, user interface components, and the like). <br><br>  The reason for this is that unit tests force the programmer to test components in isolation from each other and from I / O subsystems.  If the module is provided with some input data - it must provide some, previously known, output data.  If he does not do this, the test fails.  If it does, the test completes successfully.  The point here is that the module should work independently of the rest of the application.  If you are testing the logic of a state, you should be able to do this without displaying anything on the screen or saving something to the database.  If you are testing the formation of a user interface, then you should be able to test it without having to load the page into a browser or access network resources. <br><br>  Among other things, the TDD methodology has taught me that life becomes much simpler if, when developing user interface components, strive towards minimalism.  In addition, business logic and side effects should be isolated from the user interface.  From a practical point of view, this means that if you are using a UI framework based on components like <a href="https://medium.com/javascript-scene/unit-testing-react-components-aeda9a44aae2">React</a> or Angular, it may be advisable to create presentation components responsible for displaying something on the screen and container components that are not are mixed up. <br><br>  A presentation component that receives certain properties always produces the same result.  Similar components can be easily tested using unit tests.  This allows you to find out whether the component is working correctly with properties, and whether the conditional logic used to form the interface is correct.  For example, it is possible that the component forming the list should not display anything but an invitation to add a new item to the list if the list is empty. <br><br>  I knew about the principle of sharing responsibility long before I mastered TDD, but I didn‚Äôt know how to divide responsibility between different entities. <br><br>  Unit testing allowed me to learn how to use mocks to test something, and then I learned that mocking is a sign that <a href="https://medium.com/javascript-scene/mocking-is-a-code-smell-944a70c90a6a">something might be wrong with the code</a> .  This stunned me and completely changed my approach to software composition. <br><br>  All software development is composition: the process of breaking big problems into many small, easily solvable problems, and then creating solutions for these problems, which form the application.  The locking performed for the sake of unit tests indicates that the atomic units of the composition are not atomic, in fact.  Learning how to get rid of mocks without degrading the code coverage with tests allowed me to learn how to identify countless hidden reasons for strong connectedness of entities. <br><br>  This allowed me, as a developer, to grow professionally.  It taught me how to write much simpler code that is easier to expand, maintain, scale.  This applies to the complexity of the code itself, and to the organization of its work in large distributed systems like cloud infrastructures. <br><br><h2>  <font color="#3AC1EF">How does TDD help save teams time?</font> </h2><br>  I have already said that TDD, in the first place, leads to an <a href="https://ieeexplore.ieee.org/abstract/document/4343755">improvement in the</a> code coverage of tests.  The reason for this is that we do not begin to write the code to implement some possibility until we write a test that checks the correctness of the work of this future code.  First we write a test.  Then we allow it to complete with an error.  Then we write an implementation feature code.  We test the code, we receive an error message, we achieve the correct passing of tests, we perform refactoring and repeat this process. <br><br>  This process allows you to create a ‚Äúbarrier‚Äù through which only very few errors are able to ‚Äúskip‚Äù.  This error protection has a surprising effect on the entire development team.  It eliminates the fear of the merge command. <br><br>  The high level of code coverage by tests allows the team to get rid of the desire to manually control any, even a small change in the code base.  Code changes are becoming a natural part of the workflow. <br><br>  Freedom from the fear of making changes to the code resembles the blurring of a certain machine.  If this is not done, the machine will eventually stop - until it is lubricated and restarted. <br><br>  Without this fear, the process of working on programs turns out to be much calmer than before.  Pull requests do not delay to the last.  The CI / CD system will run the tests, and, if the tests fail, will stop the process of making changes to the project code.  In this case, error messages and information about exactly where they occurred, it will be very difficult not to notice. <br><br>  That's the whole point. <br><br>  <b>Dear readers!</b>  Do you use TDD techniques when working on your projects? <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div><p>Source: <a href="https://habr.com/ru/post/450316/">https://habr.com/ru/post/450316/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../450304/index.html">Spider-man riding an ant: 100 million years of myrmecophilia</a></li>
<li><a href="../450308/index.html">GPU Ray Tracing in Unity - Part 3</a></li>
<li><a href="../450310/index.html">How does the Philips VideoWRITER. First pictures of iron, then a bit of bore</a></li>
<li><a href="../450312/index.html">Beginner Compose Docker Tutorial</a></li>
<li><a href="../450314/index.html">TensorFlow for beginners. Part 1: general information, library installation</a></li>
<li><a href="../450318/index.html">Design patterns in modern JavaScript development</a></li>
<li><a href="../450320/index.html">Simple quantum games reveal the ultimate complexity of the universe.</a></li>
<li><a href="../450322/index.html">Why do we need so many messengers?</a></li>
<li><a href="../450324/index.html">How a performance monitoring system automatically dismisses Amazon employees</a></li>
<li><a href="../45033/index.html">CMF BORS ¬©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>