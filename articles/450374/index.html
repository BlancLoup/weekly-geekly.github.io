<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>RAM Expansion Board for Apple IIgs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The proposed RAM expansion card for the Apple IIgs computer is made on NEC uPD424400-70 microcircuits from several 1-MB SIMM-modules. Each of these mi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>RAM Expansion Board for Apple IIgs</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/qg/gt/r-/qggtr-xjimoqujhkhfesueiplry.jpeg"></div><br>  The proposed RAM expansion card for the Apple IIgs computer is made on NEC uPD424400-70 microcircuits from several 1-MB SIMM-modules.  Each of these microcircuits stores 1 M nibbytes and is located in a 26-pin SOJ package. <br><br>  The Apple IIgs computer is made on a 65C816 processor - 16-bit, but with an 8-bit data bus.  Expansion card contains 4 MB of RAM.  The memory is divided into four lines, 1 MB each.  The line consists of two 1 M nibble microcircuits, thus, all it took was eight microcircuits. <a name="habracut"></a><br><br>  The slot for the expansion card of the RAM at the computer already is.  All the necessary signals are displayed on it, the computer also takes over the regeneration of the dynamic RAM.  Therefore, the expansion card turned out quite simple.  The author decided to make the board small-sized, since the cost of its manufacture depends on it, and also to place all the logic in the FPGA GAL22V10. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The following signals are present on the RAM expansion slot: <br><br>  FRA0-FRA9 - 10-bit multiplexed cell address, fed directly to the address inputs of dynamic RAM chips <br>  CROW0, 1 - two bits to select one of four lines <br>  / CRAS - dynamic RAM address line gating signal <br>  / CCAS - dynamic RAM column address gating signal <br>  FR / W - write resolution in RAM, this signal requires additional processing, see below. <br>  D0-D7 - data bus, connects directly to the I / O lines of RAM chips <br>  / CSEL - a logical unit appears on this line when reading from RAM, it must be inverted and fed to the inputs / OE of RAM microcircuits <br>  MSIZE - informs the computer of the line size: unit - 256 kB, zero - 1 MB, here this line is connected to the common wire <br>  14M, PH2CLK, A10-A15 - are not involved in the proposed board <br><br>  The signals / CRAS and / CCAS need to be demultiplexed to get separate signals / RAS and / CAS for each of the lines.  For this, the 74F139 chip is suitable (hereinafter it is assumed that there will be no separate chips on the board, instead of them there will be one common FPGA). <br><br><img src="https://habrastorage.org/webt/z_/cg/c1/z_cgc1yw8z7f6ygnnlzukz9v0xe.png"><br><br>  The FR / W signal cannot be fed directly to the / WE input of the dynamic RAM chips, and here's why.  With a normal read-write operation, the / RAS line first becomes active (which corresponds to a logical zero), then the / CAS line becomes active.  During the cycle of regeneration of dynamic RAM, on the contrary, the / CAS line, then / RAS line becomes active first.  But the applied chips require that a unit appear on the / WE line before the / RAS line becomes active.  And the FR / W signal from Apple IIgs does not comply with this requirement.  The state of FR / W during the regeneration cycle is undefined.  Therefore, a circuit is required that detects the regeneration cycle and feeds the unit to / WE. <br><br>  The first step is to identify the regeneration cycle.  Below is a timeline: <br><br><img src="https://habrastorage.org/webt/eq/yw/po/eqywpoq6_ezdbhqb28niczkzw70.png"><br><br>  The idea of ‚Äã‚Äãthe author is to use a "transparent" latch.  The signal / CRAS for it is the input, / CCAS - the click signal.  When the unit is on the / CCAS unit, the device passes through the input signal through: the state of the output changes after the state of the input.  At the moment of transition / CCAS from one to zero, the latch remembers the signal at the input, and now it does not change at the output.  In a typical read / write operation on / CRAS, there is zero at the time of switching / CCAS from one to zero.  And during the regeneration cycle on / CRAS, there is a unit also at the moment of switching / CCAS to zero.  Then, when / CCAS switches back to one, the latch again becomes ‚Äútransparent‚Äù.  It resembles a fantastic flower from the "Secrets of the Third Planet", which can be both a "mirror" and a "camera". <br><br><img src="https://habrastorage.org/webt/3t/ps/tv/3tpstvrdzon1qm2gzilamm5u5uk.png"><br><br>  At the beginning, the author made the following scheme: <br><br><img src="https://habrastorage.org/webt/jr/lx/ce/jrlxce2yczuoia0qii6pegosh3y.png"><br><br>  But for its transfer to the FPGA GAL22V10 will require two output output.  Therefore, the scheme had to be simplified.  In normal operation, the FR / W signal takes on the desired value before it clicks, so this is also possible. <br><br><img src="https://habrastorage.org/webt/6i/wm/du/6iwmdul32mhqhjwlapehow3tjwk.png"><br><br>  A ‚Äútransparent‚Äù latch can be made from a multiplexer, and it, in turn, from logical elements.  The scheme becomes: <br><br><img src="https://habrastorage.org/webt/ra/2a/lf/ra2alfwaffbwoins2ofvui37q8q.png"><br><br>  And after simplification - this: <br><br><img src="https://habrastorage.org/webt/nr/qy/ms/nrqymsbmty8bmz0nzbwsyuctgfo.png"><br><br>  This option is transferred to the FPGA.  To compile the author applied WinCUPL.  This program is on the Atmel website.  She is raw and constantly crashes, but coped with the task perfectly.  Programmer - Genius G540. <br><br>  The jumper SJ1 on the board operates as follows.  If pins 1 and 2 are connected, the / OE signal passes through the FPGA.  If pins 2 and 3 are connected, it is connected to the common wire.  The author was not sure that the scheme for detecting the regeneration cycle will work.  Therefore, he added this jumper in case the FPGA configuration has to be redone. <br><br>  Since it turned out that everything works, no need to solder the pins, just connect pins 1 and 2 with a drop of solder. <br><br>  To reduce the size of the board, the author applied one power capacitor for every four RAM chips, and the chips themselves placed on both sides of the board. <br><br>  Chips in SOJ packages are difficult to solder, and especially - to solder with a soldering iron.  The author recommends using a hair dryer. <br><br>  Correctly deploy ICs.  On the bottom line, they are inverted.  Pin 1 looks down. <br><br>  Some through holes are too close to the pads.  Do not solder them together. <br><br>  And pads 1 and 2 for the jumper, on the contrary, close. <br><br>  C1 - C3 capacitors have a capacitance of 0.1 microfarad, C4 - 10 microfarad. <br><br>  The author ordered the fees on OSH Park.  Applied coating ENIG - gold, but very thin.  For game cartridges is not good - quickly erased.  And here the board was placed in the slot once and is not removed from there anymore. <br><br>  The author thanks <a href="https://gglabs.us/node/166">GGLabs</a> for the scheme of a similar board, it really helped, thanks! <br><br>  The finished scheme turned out like this: <br><br><img src="https://habrastorage.org/webt/vq/u2/-p/vqu2-pyrg9o9etemhajwkkkrdp8.jpeg"><br><br>  Files: <br><br>  <a href="">Firmware FPGA GAL22V10</a> , applied program WinCUPL version 5.30.4 <br><br>  <a href="">Board</a> , applied program Eagle version 7.1 <br><br>  <a href="https://cdn.hackaday.io/files/272311165051104/schematic.pdf">Scheme in PDF</a> <br><br>  Earned! <br><br><img src="https://habrastorage.org/webt/ii/nj/g0/iinjg0a7ipaglxqrvwiljlxk2nw.jpeg"></div><p>Source: <a href="https://habr.com/ru/post/450374/">https://habr.com/ru/post/450374/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../450354/index.html">Announced Windows Vision Skills (Preview)</a></li>
<li><a href="../450360/index.html">The architecture of the SPA-application exchange in 2019</a></li>
<li><a href="../450362/index.html">Consider agents "Auditor"</a></li>
<li><a href="../450368/index.html">We get the absolute exchange rates from the paired cross-exchange rates</a></li>
<li><a href="../450372/index.html">How Amazon's algorithms determine who should fire</a></li>
<li><a href="../45038/index.html">Test regular expressions in OnLine</a></li>
<li><a href="../450384/index.html">History of a little study of legacy code</a></li>
<li><a href="../450386/index.html">Interfaces as abstract data types in Go</a></li>
<li><a href="../450394/index.html">Investigation into one unknown archive</a></li>
<li><a href="../450398/index.html">The most fearless poisons</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>