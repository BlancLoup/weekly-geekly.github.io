<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Prototype voice shopping list for WP8, Win8, Android with a backend in Azure in 2.5 hours</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From November 9 to 11, Windows 8 Hackaton RUWOWZAPP took place, where I first registered as a participant, and then was honored to attend the event as...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Prototype voice shopping list for WP8, Win8, Android with a backend in Azure in 2.5 hours</h1><div class="post__text post__text-html js-mediator-article">  From November 9 to 11, Windows 8 Hackaton RUWOWZAPP took place, where I first registered as a participant, and then was honored to attend the event as an expert.  As an expert, I get to know a lot of great people and their projects.  It was so interesting that he continued to advise even at night, and 4-5 hours remained to sleep.  I was so infected with the positive and the energy and the desire of people to create, which also could not resist creating my own small prototype of the application - Shopping List with voice recognition support. <br>  For a couple of hours I managed to make a functional prototype, demonstrating the idea of ‚Äã‚Äãthe application, with clients for WP, Win8, Android <br><br>  I did not want to participate in the competition of applications with such a raw prototype, but I really wanted to show what I did in a couple of hours, and at the last moment, before the performance of the last participant, got in line for the performance, and the moderator allowed me to demonstrate my crafts: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/CBpdluzUpAg%3Ffeature%3Doembed&amp;xid=25657,15700019,15700186,15700190,15700253,15700255,15700259&amp;usg=ALkJrhhbirRdBQfst9hRkUmUkVcUVsSApg" frameborder="0" allowfullscreen=""></iframe>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The application has aroused great interest among the hackathon members and in fact this is the promised article with all the answers to questions for which I did not have enough time. <br><br>  For those who want to see the code right away, the source code can be downloaded <a href="">here.</a> <br>  And the rest I ask for cat. <br><a name="habracut"></a><br>  In contrast to this video, during a speech, I was in a hurry and did not have time to launch the android version.  I expected that the main interest would be to exactly how voice recognition takes place, but I did not expect so much interest to everything else and for the next half hour a couple of dozen people asked a variety of questions about the project, such as: exactly how synchronization takes place, how does parsing commands, how to write for android, what is the server part done, etc.  I apologize that at that time I did not have the opportunity to show everyone the source code of the project and this article promised there, in fact, answers to all the questions that were asked of me. <br><br><h4>  The idea of ‚Äã‚Äãthe application. </h4><br>  In fact, initially, I wanted to finally try to recognize voice recognition in WP8, which became available to developers.  And I wanted to make a decision that would be friends with the Russian language. <br>  I stopped at the following set of commands: <br><br>  <b>Buy [product]</b> - add products to the list <br>  <b>Bought [product]</b> - setting checkbox "bought" <br>  <b>Remove [product]</b> - remove a product from the list <br>  <b>Delete list</b> - clear the list <br>  <b>Price [product] [price]</b> - setting price <br>  <b>[product] in the store [store]</b> - an indication of the store where you can buy a product <br><br>  I figured that I could make such an application for three platforms in 6 hours, looking ahead and say that I had less time than I expected and managed only the first 4 teams. <br><br><h4>  Voice recognition  - 1 hour. </h4><br>  WP8 works very well with English and recognizes well even for my accent.  But it turned out that the possibility of recognition in Russian is much limited.  For the Russian language WP8 only recognize a predefined dictionary.  Killed it for about half an hour. <br>  I really wanted to do exactly the Russian language, and since I already had experience with voice recognition services, I decided to fasten some commercial voice recognition engine for a while.  However, since I worked with them the last time, nothing has changed and in fact no one has had an automated trial or paid period.  And since with all the services it was necessary to communicate with the managers, I decided to screw in for the demo voice recognition from Google.  I specifically looked for the conditions for using the Google voice recognition engine and could not find it, but remembered that I had seen somewhere that I couldn‚Äôt use it for commercial purposes (although I might be mistaken).  Thank you so much <a href="https://habrahabr.ru/users/yakhnev/" class="user_link">Yakhnev</a> for the excellent <a href="http://habrahabr.ru/post/117234/">article</a> on C # sources.  It took only 10 minutes to make a web project from its desktop project, with an API for voice recognition.  But since the application did not have the ability to save the file to disk, and there was no time to redo the recognition in memory, we had to abandon the free Web Role in Azure.  Fortunately, I already had a couple of virtual machines deployed in Azure, and there was no problem modifying and uploading the project to the server.  As a result, I picked up the recognition service with an access point <a href="http://voice.akhmed.ru/recognize.ashx">voice.akhmed.ru/recognize.ashx</a> - where to POST I upload the WAV file to the request and get the text at the output. <br><br><h4>  WP7 app - 30 minutes </h4><br>  Most of the time it took for the application on WP7.  But only because this platform was a test site and during development it constantly changed the code. <br><br>  After I raised the voice recognition service there was a question about voice recognition on the device. <br>  Since it was a functional prototype, I decided to throw out all unnecessary, user authorization, handling button presses, loading indicator, resubmitting, error handling (therefore, the application may fall periodically), saving to the database, saving wav files, etc. <br>  Since the application had to be ported to android too, I decided to make a prototype without MVVM, so I had a terrible mess of code. <br><br>  Since, now we didn‚Äôt have to make an application just under WP8, I decided to make a version on WP7, which gave an additional advantage - the prototype works on any WP device.  Recording a microphone is quite a non-trivial task on WP7, but I already had my <a href="http://wpextensions.codeplex.com/">WPExtensions</a> library which made it easy to record a voice in a WAV file.  In AppBar, I added one fictitious add button to the list of records with my hands and added a button with a microphone, which started recording at the first click, and when pressed again, sent a recording to the server and processed the result: <br><br><pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> isRecording = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> MicrophoneWrapper microphone = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MicrophoneWrapper(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ApplicationBarRecordIconButton_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, System.EventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!isRecording) { microphone.Record(); PageTitle.Text= <span class="hljs-string"><span class="hljs-string">"..."</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isRecording) { microphone.Stop(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> wav = microphone.GetWavContent(); Send(wav); PageTitle.Text = defaultHeader; } isRecording = !isRecording; }</code> </pre> <br><br>  The sending method is also quite trivial, in it I send the answer to the server and process the received answer. <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Send</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] wav</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> client = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpWebClient(); client.Post(<span class="hljs-string"><span class="hljs-string">"http://voice.akhmed.ru/recognize.ashx"</span></span>, wav, (result) =&gt; Dispatcher.BeginInvoke(() =&gt; ParseString(result))); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ParseString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> result</span></span></span><span class="hljs-function">)</span></span> { logicLayer.Parse(result); RefreshView(); }</code> </pre><br><br>  There were a lot of questions about how teams are being analyzed, what kind of library I use for text analysis, how superfluous words like ‚Äúbuy‚Äù or ‚Äúi‚Äù are filtered.  Of course, in the release, you need to make a much more competent solution with morphological and syntactic analysis, but now the code is outrageously simple.  I just use the first word as a command and filter all words up to two letters. <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Parse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> voiceText</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> words = voiceText.Split(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[]{<span class="hljs-string"><span class="hljs-string">' '</span></span>}, StringSplitOptions.RemoveEmptyEntries); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(words.Length&gt;<span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> command = words.First(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(command.Equals(<span class="hljs-string"><span class="hljs-string">""</span></span>)) { Add(words.Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>)); IncrementUpdate(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(command.StartsWith(<span class="hljs-string"><span class="hljs-string">""</span></span>)) { SetBoughtStatusTrue(words.Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>)); IncrementUpdate(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (command.Equals(<span class="hljs-string"><span class="hljs-string">""</span></span>) || command.Equals(<span class="hljs-string"><span class="hljs-string">""</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (words[<span class="hljs-number"><span class="hljs-number">1</span></span>].Equals(<span class="hljs-string"><span class="hljs-string">""</span></span>)) { shopList.ShopItems.Clear(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { RemoveShopListItems(words.Skip(<span class="hljs-number"><span class="hljs-number">1</span></span>)); } IncrementUpdate(); } } }</code> </pre><br><br><h4>  Application backend - 20 minutes </h4><br>  In order to ensure synchronization with other devices, it was necessary to make the server part.  Of course, such a backend is an ideal candidate for hosting in Azure as a web role, but for the prototype it could be placed on the same virtual machine in Azure as voice recognition.  Since we have time is very limited, it makes sense to make a SOAP service, as the studio is able to generate a proxy quickly on the client. <br>  Service too simple to ugliness.  I have one shopping list that I transferred from client to server (for the client it will be generated in a proxy). <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ShopList</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ShopList</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { ShopItems=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;ShopItem&gt;(); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> List&lt;ShopItem&gt; ShopItems { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Version { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ShopItem</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">decimal</span></span> Price { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> Valute { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsBought { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre><br><br>  Honestly, the two fields Price and Valute are superfluous, since I did not have time to use them, but I quote the code ‚Äúas it is‚Äù. <br>  Saving and retrieving a list is also implemented very simply. <br><br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GroceryService</span></span></span><span class="hljs-class"> :</span></span> System.Web.Services.WebService { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> LogicLayer logicLayer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LogicLayer(); [WebMethod] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ShopList </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetVersion</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> logicLayer.GetShopList(); } [WebMethod] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UploadVersion</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ShopList request)</span></span></span><span class="hljs-function"> </span></span>{ logicLayer.Update(request); } }</code> </pre><br><br>  Of course, the release should not be a complete update of the list as it is, but a partial update of the changed data, but for the prototype, it will do as well. <br>  The logic is also made very simple to disgrace, since this is a prototype, without a database, while maintaining the current value in the database.  Honestly, there was no sense in such logic, but I bring it ‚Äúas it is‚Äù.  The names of the methods failed but did not change. <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">LogicLayer</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ShopList shopList = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ShopList(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ShopList </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetShopList</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> shopList; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ShopList newshopList</span></span></span><span class="hljs-function">)</span></span> { shopList = newshopList; } }</code> </pre><br>  In the end, he raised this service to <a href="">voicegrocery.akhmed.ru/GroceryService.asmx</a> <br>  Now the question is how to deliver updates to customers?  Of course, on PushNotification.  But its implementation could take a lot of time, which was tight and I made a request from the client in 5 seconds. <br><br><pre> <code class="hljs pgsql">DispatcherTimer dispathcerTimer = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> DispatcherTimer(); dispathcerTimer.Interval = TimeSpan.FromSeconds(<span class="hljs-number"><span class="hljs-number">5</span></span>); dispathcerTimer.Tick += dispathcerTimer_Tick; dispathcerTimer.<span class="hljs-keyword"><span class="hljs-keyword">Start</span></span>();</code> </pre><br><br>  The logic of updating to / from the client is very simple. <br>  1. If the current version is less than received from the server, the current list is replaced by the server one. <br>  2. If a change occurs on the client, the version is incremented by 1 and sent to the server. <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dispathcerTimer_Tick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, System.EventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> client = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ServiceReference1.GroceryServiceSoapClient(); client.GetVersionCompleted += client_GetVersionCompleted; client.GetVersionAsync(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">client_GetVersionCompleted</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, ServiceReference1.GetVersionCompletedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.Result.Version &gt; logicLayer.GetVersion()) { logicLayer.UpdateShopList(e.Result); RefreshView(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IncrementUpdate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shopListItem = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ShopList() { Version = shopList.Version + <span class="hljs-number"><span class="hljs-number">1</span></span>, ShopItems = shopList.ShopItems }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> client = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ServiceReference1.GroceryServiceSoapClient(); client.UploadVersionAsync(shopListItem); }</code> </pre><br><br><h4>  Porting to Windows 8 - 10 minutes. </h4><br>  Porting the application to Win8 was very easy.  I did not implement voice recognition on the client and it turned out one-way synchronization.  XAML was copied almost unchanged, a little bit had to correct the code sent to the server.  It became a little easier - in one method <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dispathcerTimer_Tick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> client = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ServiceReference1.GroceryServiceSoapClient(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> client.GetVersionAsync(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.Body.GetVersionResult.Version &gt; logicLayer.GetVersion()) { logicLayer.UpdateShopList(result.Body.GetVersionResult); RefreshView(); } }</code> </pre><br><br><h4>  Porting the application to Android - 15 minutes. </h4><br><br>  I love the mono platform.  The code remained almost unchanged, it remains to correct the UI.  Since the presentation is much more difficult for Android, I did not spend a lot of time creating a custom adapter and after 5 minutes I rolled back and made a simple text list with textual cross-stitches in brackets: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">client_GetVersionCompleted</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, ru.akhmed.voicegrocery.GetVersionCompletedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { list.Clear(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = e.Result.ShopItems; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> result) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> checkBox = item.IsBought ? <span class="hljs-string"><span class="hljs-string">"( X ) "</span></span> : <span class="hljs-string"><span class="hljs-string">"( ) "</span></span>; list.Add(checkBox + item.Name); } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.RunOnUiThread(() =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ListAdapter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayAdapter&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, Resource.Layout.ListItem, list); ((BaseAdapter)<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ListAdapter).NotifyDataSetChanged(); }); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception) { } }</code> </pre><br><br><h4>  Porting on iOS - not available </h4><br>  Of course, I was thinking about porting to iOS, but since I didn‚Äôt have i-devices <s>but hackintoshs, which I use in home development to show at such events incorrectly</s> and there was very little time to put off this idea.  <s>Especially on the laptop with me I did not have a hackintosh</s> <br><br><h4>  Results </h4><br>  If you do not take into account the 40 minutes that were spent on researching the capabilities of the WP8 platform, then in less than 2 hours, taking into account the cost of uploading to the server and minor bug fixes, a full-fledged prototype was implemented, which shows the main idea of ‚Äã‚Äãthe application and does not mind throwing it away . <br>  Of course, the code was very dirty, sub-optimal, with a bunch of flaws and unfinished features.  But functional prototypes are just needed for what would be on the ‚Äúpaper sketch‚Äù - on the draft to show the customer / superiors the product that will turn out. </div><p>Source: <a href="https://habr.com/ru/post/158481/">https://habr.com/ru/post/158481/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../158467/index.html">Starts sales of Samsung Galaxy Camera in USA and UK</a></li>
<li><a href="../158469/index.html">Monitoring the activity of VK groups. We process data on VKScript</a></li>
<li><a href="../158471/index.html">Hacking bezdny.net</a></li>
<li><a href="../158473/index.html">Opera extension: search open site 1.1</a></li>
<li><a href="../158479/index.html">Simple chroma RGB color component</a></li>
<li><a href="../158483/index.html">We draw a clear icon of the house in 32x32 (ala FatCow)</a></li>
<li><a href="../158487/index.html">"Yandex" closes the "Bar"</a></li>
<li><a href="../158493/index.html">Radio Wave Theory: Analog Modulation</a></li>
<li><a href="../158495/index.html">HTML5 Canvas: rotate and translate by example</a></li>
<li><a href="../158497/index.html">Should I use freemium model? Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>