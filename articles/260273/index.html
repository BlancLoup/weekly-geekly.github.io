<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Challenge the tradition of hi-fi. Digital potentiometers in detail. Part two</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It came as a surprise to me that the most heated debates in the discussion of my previous article related primarily to the possibility of using digita...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Challenge the tradition of hi-fi. Digital potentiometers in detail. Part two</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/45b/f22/17b/45bf2217be6e45909489a188adc97aa7.jpg"><br><br>  It came as a surprise to me that the most heated debates in the discussion of <a href="http://habrahabr.ru/post/260233/">my previous article</a> related primarily to the possibility of using digital impedances as an audio volume control in HiFi equipment.  In order to clarify this issue, I decided to devote a separate article to a detailed analysis of high-quality volume control circuitry with a switching impulse noise suppression circuits based on the VDAC AD9252.  In addition to circuitry, you will also be able to get acquainted with the characteristics achieved under the cut. <br><br>  For those who have not read my yesterday's article, which dealt with general issues relating to digital resistances, I strongly recommend that you <a href="http://habrahabr.ru/post/260233/">first read it here</a> .  Firstly, you better understand what is actually being discussed below, and secondly, if you are interested in today's topic, then you will find interesting material in it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In order to bring the promised examples of real-world circuits of software-controlled value converters, tunable filters, and other electronic nodes, the parameters of which can be changed using digital resistance will have to write a third article.  I will try to do this in the near future, but for now I propose to investigate whether the volume control assembled on the basis of the top device from ADI draws on HiFi equipment, or <s>at least the lowest price segment</s> . <br><a name="habracut"></a><br>  I present an attempt to create a volume control based on one of the top chips of ADI digital controllers, claiming to be Hi-Fi. <br><br>  To begin with, I will give general characteristics that we managed to squeeze.  Low harmonic distortion.  Normalized transfer characteristic.  The dynamic range of volume control is 46 dB.  In addition, there is the possibility of a MUTE function with a signal attenuation of 130 dB.  The regulator enters this mode after the AD5292 regulator enters the shutdown mode, by issuing a special command.  And of course there is a special scheme to reduce the effect of the occurrence of hearing impulse noise at the moment of switching the volume level.  This effect is most pronounced in logarithmic amplifiers, because their volume can change abruptly in a very wide range.  To reduce the noise when switching the volume level to the minimum, this switch must be made when the signal passes through zero. <br><br>  The regulator can operate with an input signal level up to ¬± 14 volts (10 V RMS), which provides good noise performance.  The maximum load current at the output of 20 mA.  Management by SPI interface.  The interface for connecting the microcircuit to the control microcontroller is not shown, since it is standard. <br><br><h4>  The scheme and principle of its work </h4><br><img src="https://habrastorage.org/files/102/3be/045/1023be0453584fc4bc000d70d093fb98.png"><br><br>  The signal from the input repeater is fed to the AD5292 level regulator with a logarithmic characteristic.  A part of the signal is branched off from the ground using a voltage divider on resistors R4 and R5, loaded on an AD8541 op amp, which acts as a dynamic load forming an artificial earth at 1.81 V. The signal goes to the U3 and U4 comparators, which form a window at 13 millivolts in the area where the signal passes through zero.  At the time the signal passes through zero, the logic element U5A forms a low level. <br><br>  In order to switch the volume level, it is necessary to write new data to the buffer register and apply a negative front to the input of the SYNC U6.  When, after writing the code, we feed a low level to the lower input of the U5B, it is transmitted to the switching level of the digital impedance value only at the moment the audio signal passes through the ‚Äúwindow‚Äù of the comparators.  Please note that to improve the accuracy of the entire circuit only works on DC. <br><br>  To obtain the most comfortable for the ear volume control characteristics, the average output of the digital resistance is shunted by the resistor R8.  As a result, we obtain the normalized characteristic of signal transmission, shown in the figure below. <br><br><img src="https://habrastorage.org/files/0bf/16a/8c2/0bf16a8c239d46e09b37e3f1ed3a41dc.png"><br><br><h4>  Illustration of the operation of the impulse noise reduction circuit </h4><br>  Let's first see what happens when switching the resistance level in the disconnected impulse noise suppression circuit. <br><br>  This is what the transient process looks like at the moment of switching on the sound that occurred at the time marked with zero. <br><br><img src="https://habrastorage.org/files/785/2e3/487/7852e34873314ebfbd53381dc7504c82.png"><br><br>  For the case of switching the sound from one value to another, everything may look even worse. <br><br><img src="https://habrastorage.org/files/052/49c/7b2/05249c7b2cc741e287215a8a3339ca31.png"><br><br>  The following picture shows the result of the operation of our jamming circuit during the transition from higher volume to lower volume. <br><br><img src="https://habrastorage.org/files/606/8da/4e3/6068da4e399544f7b79267e900cbd8e2.png"><br><br><h4>  Regulator Characteristics </h4><br>  Now let's look at the other characteristics that have been achieved in our controller. <br><br>  As rightly pointed out by the respected <a href="https://habr.com/users/alex013/" class="user_link">Alex013</a> in the comments to my previous article, the sound quality depends quite strongly on the level of odd harmonics of the signal in the amplifier path.  In order to show how they are affected by our digital controller, let's consider the result of FFT conversions of a 1 KHz signal passing through the circuit with a ‚Äúpotentiometer slider‚Äù set to the most accurate position ‚Äî that is, the transfer coefficient is equal to one. <br><br><img src="https://habrastorage.org/files/a25/4a5/6cf/a254a56cfd4b42848b6bf16619da922c.png"><br><br>  In my opinion, the characteristics are very decent, the level of the third harmonic went below -100 dB, the fifth one is not visible at all with the naked eye.  I wonder what our sound experts will say. <br><br>  I give the following chart specifically for the barabanus <a href="https://habr.com/users/barabanus/" class="user_link">habourer. I</a> <s>apologize for the expression of the brain that has passed through my mind in the comments to the previous article</s> .  I hope now we will agree with me, dear, that the resistance of not only 10, but even 20 kilohm resistors does not change to values ‚Äã‚Äãof the order of ten percent at frequencies from zero to 20 KHz at any resistance set!  The phase of the signal changes, but in my opinion very slightly. <br><br><img src="https://habrastorage.org/files/0ac/afa/b20/0acafab2087e47ad9f3306ce43b3b8d8.png"><br><br>  At a frequency of 1 kHz, our circuit provides a total level of signal distortion at -93 dB.  The dependence of the circuit's own noise level and non-linear distortions on the signal frequency at the amplifier transmission ratio equal to one is shown in the graph below. <br><br><img src="https://habrastorage.org/files/560/23c/b57/56023cb57d04405caef10985a91f9ba9.png"><br><br><h4>  Option schemes for lovers of compromise. </h4><br>  We‚Äôll finish our study with this scheme, and as a bonus I offer its simplified version, with somewhat worse characteristics, but with a more accessible element base. <br><br><img src="https://habrastorage.org/files/da9/a96/712/da9a96712471448a8f99664ba77cda77.png"><br><br>  But the oscillogram of the process of switching the volume level at a very high frequency.  As you can see, nonlinear distortions at the moment of switching were not cost, but there are no emissions that can be cut ear! <br><br><img src="https://habrastorage.org/files/788/b80/266/788b80266ac146c5aa677bebba285af9.png"><br><br>  Thanks to read to the end.  I will try to test your patience a little longer.  Since I am not an expert in the field of "pure transparent sound" and it is difficult for me to assess the quality of the described device, I ask you to express your opinion in the form of an answer to a question or in comments. <br><br>  Link to the previous article in the series: <a href="http://habrahabr.ru/post/260233/">‚ÄúWhen the DAC does not help.</a>  <a href="http://habrahabr.ru/post/260233/">Digital potentiometers in detail.</a>  <a href="http://habrahabr.ru/post/260233/">Part one"</a> <br><br>  The article uses a fragment of the photo of the user's tube amplifier <a href="https://habr.com/users/eta4ever/" class="user_link">eta4ever</a> . </div><p>Source: <a href="https://habr.com/ru/post/260273/">https://habr.com/ru/post/260273/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../260255/index.html">"Big battalions" in continuous time (battle simulation)</a></li>
<li><a href="../260257/index.html">PHP Digest 64 - interesting news, materials and tools (June 1 - 14, 2015)</a></li>
<li><a href="../260259/index.html">Ingredients of IoT Fast Food Delicacies: Intel Edison + Intel XDK + JavaScript + Grove Kit</a></li>
<li><a href="../260269/index.html">Antivirus Self-Defense</a></li>
<li><a href="../260271/index.html">Salad "Microsoft Guide for SymbolTable with a delicate aftertaste Antlr4"</a></li>
<li><a href="../260275/index.html">How we made the best release tracker tracker</a></li>
<li><a href="../260277/index.html">That the site did not fall: an economical method</a></li>
<li><a href="../260279/index.html">Do we really need start-ups for large corporations</a></li>
<li><a href="../260285/index.html">Analysis of the tasks of the qualifying round of RCC 2015</a></li>
<li><a href="../260287/index.html">Are you ready to complain?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>