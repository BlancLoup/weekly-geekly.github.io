<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Guide to animated display of views in a table on Swift</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The standard UITableView is a powerful yet flexible way to present data in your applications; chances are that most of the applications you create wil...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Guide to animated display of views in a table on Swift</h1><div class="post__text post__text-html js-mediator-article">  The standard UITableView is a powerful yet flexible way to present data in your applications;  chances are that most of the applications you create will use the table view in one form or another.  However, there is a drawback that without some level of customization, applications will look pale and blend in with thousands of similar ones.  In order to avoid ‚Äúboring‚Äù tables, you can add a few suitable animated images that ‚Äúanimate‚Äù the application.  You may have seen this in the Google+ app, where cells in the table literally fly around the screen along with cool animation.  If you did not pay attention to it, you can download it <a href="https://itunes.apple.com/ua/app/google%2B/id447119634%3Fmt%3D8">here</a> (for free)!  It may also be useful and interesting to get acquainted with the <a href="http://www.google.com/design/">design guidelines</a> ( <a href="http://www.google.com/design/">design guidelines</a> ), which Google released at the 2014 I / O conference.  It contains many tips and examples on how to effectively and correctly use animation in your applications. <br><br><a name="habracut"></a><br>  In this article, the Swift programming language for improvement will be used for an existing application, while scrolling the table cells and moving the image vertically.  It also describes how to convert to UIKit, and their convenient use in order to avoid overloading too many actions that occur simultaneously on the screen.  You will receive tips on how to organize the program code so that tasks are simple and straightforward, and your main controller simple. <br><br>  First, you should familiarize yourself with how to work with UITableView and with the basic elements in Swift.  If you need to familiarize yourself with this, then you can start familiarizing yourself with the <a href="http://www.raywenderlich.com/74438/swift-tutorial-a-quick-start">Swift Tutorial</a> series, which will teach you the basics of working in the Swift language regarding applications on a table view. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Let's start.</b> <br><br>  Download the <a href="">starter project</a> and open it in Xcode 6. You will see a simple project description (UITableViewController) subclass (MainViewController) and setting UITableViewCell (CardTableViewCell) to display developers.  You will also find an example of the Member class, which describes all the information about a team member and knows how to extract this information from the JSON file that is located inside our application. <br><br>  Compile and run the project.  You will see the following: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f3/b00/c4a/5f3b00c4a208b00dbdfa991ddb00a193.png" alt="image" width="281" height="500"><br><br>  <i>Excellent design, ready to give it a special color and improvement</i> <br><br>  The application is ready to use, but it could contain a little more individualism, so to say have its own "flavor".  This is your job;  Use some Core Animation tricks to liven up the data cell. <br><br>  <b>Determine the easiest possible way to animate.</b> <br><br>  To get the basic structure of the application, start by creating a simple helper class.  Navigate to File \ New \ File ... and select the iOS \ Source \ Swift File type for an empty Swift file.  Click Next, name the file TipInCellAnimator.swift and then click Create. <br><br>  Replace the contents of the file with the following code: <br><br><pre><code class="objectivec hljs">import <span class="hljs-built_in"><span class="hljs-built_in">UIKit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> TipInCellAnimator { <span class="hljs-comment"><span class="hljs-comment">// placeholder for things to come -- only fades in for now class func animate(cell:UITableViewCell) { if let view = cell.contentView { view.layer.opacity = 0.1 UIView.animateWithDuration(1.4) { view.layer.opacity = 1 } } } }</span></span></code> </pre> <br><br>  This simple class contains an algorithm that takes a cell with data, accesses its content (contentView), and sets the initial transparency of the layer to 0.1.  Then, after 1.4 seconds, the program code in the closing expression converts the layer's transparency back to 1.0. <br><br>  <i><b>Note: an</b> expression in Swift is simply a block of code that can also span external variables.</i>  <i>For example, {} is a simple expression.</i>  <i>Functions denoted as func are examples of named expressions.</i>  <i>In Swift, you can open functions within other functions.</i> <i><br><br></i>  <i>If you pass an expression as the last argument to a function, you can use the special syntax trailing closure (final expression) and move the expression out of the function call.</i> <i><br><br></i>  <i>Read more about expressions in the Swift Programming Language book or read the article about the history of expressions (rich history of closures) in Wikipedia.</i> <br><br>  When the animation code is ready, you need to configure the table so that you can start a new animation when a cell with data appears. <br><br>  <b>Running animation</b> <br><br>  To start the animation, open the MainViewController.swift file and add the following method: <br><br><pre> <code class="objectivec hljs">override func tableView(tableView: <span class="hljs-built_in"><span class="hljs-built_in">UITableView</span></span>!, willDisplayCell cell: <span class="hljs-built_in"><span class="hljs-built_in">UITableViewCell</span></span>!, forRowAtIndexPath indexPath: <span class="hljs-built_in"><span class="hljs-built_in">NSIndexPath</span></span>!) { TipInCellAnimator.animate(cell) }</code> </pre><br><br>  This algorithm is indicated in the UITableViewDelegate protocol and is called before the cell appears on the screen.  Then the algorithm of the class TipInCellAnimator is called for each cell in order to start the animation. <br><br>  Compile and run the application.  Scroll through the table with information and see how the cell slowly disappears: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/caa/e59/c08/caae59c08c984ef645e869e53faa2f9a.png" alt="image" width="281" height="500"><br><br>  <b>Rotation effect</b> <br><br>  Let's make our application even more attractive, add rotation.  This works in the same way as a pop-up animation, however you indicate both the beginning and the end of the transformations. <br><br>  Open the TipInCellAnimator.swift file and replace the content with the following: <br><br><pre> <code class="objectivec hljs">import <span class="hljs-built_in"><span class="hljs-built_in">UIKit</span></span> import QuartzCore <span class="hljs-comment"><span class="hljs-comment">// 1 class TipInCellAnimator { class func animate(cell:UITableViewCell) { if let view = cell.contentView { let rotationDegrees: CGFloat = -15.0 let rotationRadians: CGFloat = rotationDegrees * (CGFloat(M_PI)/180.0) let offset = CGPointMake(-20, -20) var startTransform = CATransform3DIdentity // 2 startTransform = CATransform3DRotate(CATransform3DIdentity, rotationRadians, 0.0, 0.0, 1.0) // 3 startTransform = CATransform3DTranslate(startTransform, offset.x, offset.y, 0.0) // 4 // 5 view.layer.transform = startTransform view.layer.opacity = 0.8 // 6 UIView.animateWithDuration(0.4) { view.layer.transform = CATransform3DIdentity view.layer.opacity = 1 } } } }</span></span></code> </pre><br><br>  This time the movement will be faster (0.4 seconds), floating more convenient and you get an interesting rotation effect.  The key to the above animation determines the startTransform matrix, which brings the cell back to its original position.  Let's figure out how this happens: <br><br>  1. This class requires that QuartzCore be imported, as it uses key animated transformations. <br>  2. Start by recognizing a transform, which is an arithmetic expression for a ‚Äúdummy operation.‚Äù  This is the default image conversion. <br>  3. Go to CATransform3DRotate to get a rotation of 15 degrees, where a negative sign indicates counterclockwise rotation.  The movement is carried out around the axes 0.0, 0.0, 1.0 and represents the vertical axis z, where x = 0, y = 0 and z = 1. <br>  4. The use of rotation alone is insufficient, as the table / graph rotates relative to its center.  In order to make a flip effect from an angle, add a shift or offset, where negative values ‚Äã‚Äãindicate moving up and to the left. <br>  5. Set the conversion result as the original view. <br>  6. Move the image and return the original values. <br><br>  Please note that you can create a final transformation, as shown in the image below: <br><img src="https://habrastorage.org/getpro/habr/post_images/165/d65/492/165d654926d38151f424b62a83cf4237.png" alt="image" width="600" height="300"><br><br>  <i><b>Note: An</b> arbitrary chain of transformations may ultimately be represented by a single matrix.</i>  <i>If you studied matrix algebra in school, then remember the effect of multiplication of matrices.</i>  <i>Each step multiplies the new change until you reach the final matrix.</i> <br><br>  You will also notice that the ‚Äúchildish‚Äù type of the cell changes, so to speak, and not the cell itself.  Rotation of the entire cell will cause the part above and below to be inaccessible for viewing, and we will get strange visual effects, such as vibrations and clipping the cell.  ContentView cell contains all the component parts. <br><br>  Not all properties support animation.  <a href="https://developer.apple.com/library/ios/DOCUMENTATION/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html">Core Animation Programming Guide</a> ( <a href="https://developer.apple.com/library/ios/DOCUMENTATION/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html">Core Animation Programming Guide</a> ) provides a list ( <a href="https://developer.apple.com/library/ios/DOCUMENTATION/Cocoa/Conceptual/CoreAnimation_guide/AnimatableProperties/AnimatableProperties.html">list of animatable properties</a> ) for clarification. <br><br>  Compile and run the application.  See how data cells incline: <br><img src="https://habrastorage.org/getpro/habr/post_images/41a/8bb/505/41a8bb50585756afc9b6f12a9bfd2478.png" alt="image" width="650" height="385"><br><br>  <b>Swift Refactoring</b> <br><br>  The original version of Objective-C provides a one-time definition of the start of a transformation.  In the above version of the source code, it is calculated each time by animate () in a new way.  How to do it in Swift? <br><br>  One way is to use immutable storage, which is determined by the transition to the expression.  Replace the contents of the TipInCellAnimator.swift file with: <br><br><pre> <code class="objectivec hljs">import <span class="hljs-built_in"><span class="hljs-built_in">UIKit</span></span> import QuartzCore let TipInCellAnimatorStartTransform:<span class="hljs-built_in"><span class="hljs-built_in">CATransform3D</span></span> = { let rotationDegrees: <span class="hljs-built_in"><span class="hljs-built_in">CGFloat</span></span> = <span class="hljs-number"><span class="hljs-number">-15.0</span></span> let rotationRadians: <span class="hljs-built_in"><span class="hljs-built_in">CGFloat</span></span> = rotationDegrees * (<span class="hljs-built_in"><span class="hljs-built_in">CGFloat</span></span>(M_PI)/<span class="hljs-number"><span class="hljs-number">180.0</span></span>) let offset = <span class="hljs-built_in"><span class="hljs-built_in">CGPointMake</span></span>(<span class="hljs-number"><span class="hljs-number">-20</span></span>, <span class="hljs-number"><span class="hljs-number">-20</span></span>) var startTransform = <span class="hljs-built_in"><span class="hljs-built_in">CATransform3DIdentity</span></span> startTransform = <span class="hljs-built_in"><span class="hljs-built_in">CATransform3DRotate</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">CATransform3DIdentity</span></span>, rotationRadians, <span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>) startTransform = <span class="hljs-built_in"><span class="hljs-built_in">CATransform3DTranslate</span></span>(startTransform, offset.x, offset.y, <span class="hljs-number"><span class="hljs-number">0.0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> startTransform }() <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> TipInCellAnimator { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> func animate(cell:<span class="hljs-built_in"><span class="hljs-built_in">UITableViewCell</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> let view = cell.contentView { view.layer.transform = TipInCellAnimatorStartTransform view.layer.opacity = <span class="hljs-number"><span class="hljs-number">0.8</span></span> <span class="hljs-built_in"><span class="hljs-built_in">UIView</span></span>.animateWithDuration(<span class="hljs-number"><span class="hljs-number">0.4</span></span>) { view.layer.transform = <span class="hljs-built_in"><span class="hljs-built_in">CATransform3DIdentity</span></span> view.layer.opacity = <span class="hljs-number"><span class="hljs-number">1</span></span> } } } }</code> </pre><br><br>  Notice the program code that generates the startTransform;  now it's like a property of the TipIn CellAnimatorStartTransform class.  Instead of defining the property of the creation method and the changes with each query, set the default transformation property by assigning an expression to it and assigning a pair of empty brackets.  The brackets allow you to immediately call the expression and assign the return value to the property.  This initialization idiom is discussed in Apple's Swift book in the initialization section.  For more information, see ‚ÄúSetting the default value property of an expression or function‚Äù. <br><br>  <i><b>Note:</b> it would be nice to do the TipInCellAnimator property in the TipInCellAnimatStartTransform class, but at the time of this writing, the class properties are not yet implemented in Swift.</i> <br><br>  <b>Adding constraints to transformations</b> <br><br>  Although the animation effect is quite concise, use it with caution.  If you have ever experienced discomfort when viewing a presentation due to the abuse of sound effects or animation effects, then you have an idea of ‚Äã‚Äãwhat glut or abuse is.  In your projects, try to have the animation present only when the cell first appears - when it scrolls upwards.  When scrolling back up, the cells should be without animation. <br><br>  It is necessary to develop such a method in order to avoid re-animation of the cells shown earlier.  For this, you will see the Swift Dictionary (Dictionary), which provides a quick search by key. <br><br>  <i><b>Note: The</b> instruction set is an unordered collection of unique records that do not have duplicates, and an array is an ordered set that allows duplicates.</i>  <i>The Swift Library (The Swift Standard Library) does not include a set of instructions, but it can be easily reproduced by Dictionary of Bools.</i> <i><br><br></i>  <i>Penalties for using the Dictionary (Dictionary), therefore, are small, so perhaps the Swift team has removed them from the first release.</i>  <i>A common disadvantage of a set of instructions or dictionary keys is that they do not guarantee consistency; however, the ordering of your cells is done by the data generator, so this is not a problem.</i> <br><br>  Open MainViewController.swift and add the following class property: <br><br><pre> <code class="objectivec hljs">var didAnimateCell:[<span class="hljs-built_in"><span class="hljs-built_in">NSIndexPath</span></span>: Bool] = [:]</code> </pre><br><br>  Here we create an empty dictionary (dictionary) that recognizes NSIndexPath as a key and Bools as properties.  Then replace the tableView method (tableView :, willDisplayCell :, forRowAtIndexPath :) with the following: <br><br><pre> <code class="objectivec hljs">override func tableView(tableView: <span class="hljs-built_in"><span class="hljs-built_in">UITableView</span></span>!, willDisplayCell cell: <span class="hljs-built_in"><span class="hljs-built_in">UITableViewCell</span></span>!, forRowAtIndexPath indexPath: <span class="hljs-built_in"><span class="hljs-built_in">NSIndexPath</span></span>!) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> didAnimateCell[indexPath] == <span class="hljs-literal"><span class="hljs-literal">nil</span></span> || didAnimateCell[indexPath]! == <span class="hljs-literal"><span class="hljs-literal">false</span></span> { didAnimateCell[indexPath] = <span class="hljs-literal"><span class="hljs-literal">true</span></span> TipInCellAnimator.animate(cell) } }</code> </pre><br><br>  Instead of animating the cell each time it appears when scrolling up or down the table, make sure that the cell's indexPath is stored in the dictionary.  If this is not the case, then the cell was shown for the first time, so you should start the animation and add indexPath to your instruction set.  If it is already in the set, you should not do anything. <br><br>  Compile and run your project;  swipe up and down the tableview and you will only see the cells that were animated when they first appeared on the screen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/502/7ff/a13/5027ffa1394febe759d278eee5aa8a59.png" alt="image" width="563" height="500"><br><br>  <b>What to do next?</b> <br><br>  In this tutorial, you have added animation to standard visualization control methods.  The implementation details of the animation were not recorded in the MainViewController class;  on the contrary, they were moved to the auxiliary class.  Maintaining class responsibilities in the active state, in particular for display controllers, is one of the main challenges for the development of IOS.  You can <a href="">download the finished project.</a> <br><br>  Now that you have learned the basics of adding animation to cells, try changing the values ‚Äã‚Äãof your transformation to see what other effects you can create.  Some ideas: <br><br>  1. Faster or slower animation. <br>  2. Greater tilt angle. <br>  3. Different offsets: if you change the angle of rotation, you will most likely need to change the offset so that the picture looks straight.  What will the image look like if you completely lower the offset and use the parameter value (0, 0)? <br>  4. Be creative and create original images. <br>  5. For advanced users: can you get the effect of turning the table on a horizontal or vertical axis?  Can you make it seem like a complete coup? <br>  6. For advanced users: add the else (other) clause to the tableView (tableView :, willDisplayCell :, forRowAtIndexPath :) and get different animation effects when the data cells are displayed a second time. <br><img src="https://habrastorage.org/getpro/habr/post_images/58c/c83/823/58cc8382324cff1fe37fa12b45157e47.png" alt="image" width="650" height="355"><br>  <i>Crazy turns that you can apply to data cells.</i> <br><br>  Even after studying a simple animation guide from this article, you can create an infinite number of variations based on this information.  Animation can be a great addition to user actions, such as turning a cell around in a circle, fading out, or appearing when presenting or deleting a cell. <br><br>  ps Translation does not claim to be the most correct and the best translation in Habr√©, if you have any comments, write in a personal, I will rule.  Thank you for understanding. </div><p>Source: <a href="https://habr.com/ru/post/234853/">https://habr.com/ru/post/234853/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../234841/index.html">Hibernate and PostgreSQL JSON Type</a></li>
<li><a href="../234845/index.html">Study: PHP sites turned out to be the most vulnerable for hackers</a></li>
<li><a href="../234847/index.html">How Wikipedia works (part 3)</a></li>
<li><a href="../234849/index.html">Welcome to CocoaHeads August 29</a></li>
<li><a href="../234851/index.html">Innovative technologies in localization</a></li>
<li><a href="../234855/index.html">Growth Hacking: how to make money on the service before it starts?</a></li>
<li><a href="../234857/index.html">What's inside the reader for two-factor authentication?</a></li>
<li><a href="../234859/index.html">Samsung is launching the mass release of the industry's first DDR4 memory modules based on 3D TSV technology.</a></li>
<li><a href="../234861/index.html">Developing your Django billing system</a></li>
<li><a href="../234863/index.html">Twitter has opened analytics for all users.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>