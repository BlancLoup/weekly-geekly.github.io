<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Results of 2013: threats and exploitation of Windows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The global threat landscape is becoming richer and more active every year, every day there are many modifications of various existing malware, as well...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Results of 2013: threats and exploitation of Windows</h1><div class="post__text post__text-html js-mediator-article">  The global threat landscape is becoming richer and more active every year, every day there are many modifications of various existing malware, as well as new malware and other tools used by attackers.  The past year has only consolidated the main trend of separating malware or using them into two types: used by hackers to extract personal material gains and used by attackers for targeted attacks, watering hole to compromise a certain company, industry or region of the globe. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9c5/000/acd/9c5000acdfd92c894657cb409ef4381f.png"><br><br>  Despite the fact that Remote Code Execution vulnerabilities in popular software (browsers) play a significant role in the remote delivery of malicious content that attackers are interested in (the main drive-by trend), they often resort to much simpler methods of installing malicious objects into the system using human factor.  The use of double extensions in files, a convincing phishing message, targeting certain people (including intelligence), fake file icons, documents with convincing content, all this makes up the arsenal of attackers who are interested in installing malicious code into the system of the alleged victim. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><img src="https://habrastorage.org/getpro/habr/post_images/9b0/288/76b/9b028876bed0ef814cc4f7c49d7a5fa0.png"><br>  Fig.  A typical example of using a double extension in a file name with an MS Word document icon inserted into an executable file.  A reliable way to mislead the victim, because in the default settings, Windows Explorer hides the extension of files known to it. <br><br>  As the experience of attackers from the APT1 group and <a href="http://habrahabr.ru/company/eset/blog/205044/">other</a> attacking <a href="http://habrahabr.ru/company/eset/blog/205044/">groups</a> who were engaged in industrial espionage showed, it is initially necessary to conduct minimal intelligence to identify the alleged victim and obtain information about her, for example.  e-mail address.  In the future, a convincing phishing message will be sent to this address. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/556/d23/a25/556d23a25766054cf252c238368844ab.png"><br>  Fig.  An example of a phishing message that can be sent to the user's corporate mailbox, in order to compromise corporate information.  The first thing that catches your eye is the use of a gmail mail account instead of a corporate one by a company manager. <br><br>  This type of attack can be used not only for industrial espionage, but also in more local attacks against a specific company, for example, in order to obtain important information from competitors using malicious code. <br><br>  <b>Windows threats</b> <br><br>  This is not to say that the past year brought something fundamentally new for Windows.  Turning on a computer in a botnet, stealing account data and online banking data, getting remote access to a computer (backdoor), blocking a computer for ransom (extortioner) are the main goals of cybercriminals who are interested in gaining material gain from compromised users.  Below we provide statistics on some families of malicious code that were active in the past year. <br><br>  File viruses are still quite active.  This year, the three <b>Win32 / Sality</b> , <b>Win32 / Ramnit</b> and <b>Win32 / Virut families</b> steadily fell into the top ten world threats according to statistics from our ESET Live Grid telemetry system.  Viruses compromise executable files on a user's computer and violate their integrity, and can also threaten the entire enterprise network if one of the computers contains at least one malicious file, because they can infect network drives of other computers on the network. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9d9/020/3c6/9d90203c6aa7ba19de35b703f2c1b348.png"><br><br>  For Russia, the most topical malware is <b>Win32 / Qhost</b> , besides that it is in itself, first of all, targeted at Russian users (see the geography of distribution below), which clearly hints at its domestic roots.  The Qhost code itself is quite simple and modifies the system hosts file to redirect the user to the phishing, advertising and malicious resources needed by attackers.  Such redirects (clicks) are later monetized and bring actual profits to the attackers. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/455/98a/2b2/45598a2b234ab1eb9595f3d2f64c49c4.png"><br><br>  Generic <b>HTML / IFrame</b> detection is used to identify malicious elements of web pages.  Often malicious iframes are used to redirect a user from a legitimate web page to malicious content or a set of exploits. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8fe/741/8d1/8fe7418d15b3e007ea7601ec47af8c73.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4f2/2c7/9e8/4f22c79e829c131afbda1c441e93bb6a.png"><br>  Fig.  The geography of distribution of Qhost.  Russia is the most affected region. <br><br>  As can be seen in the diagram above, in Russia (and in the world) there is still a high activity of malicious programs that use .inf files to ensure their launch both from removable media and locally in the system.  ESET antivirus products detect these malicious files under the general <a href="http://virusradar.com/en/INF_Autorun/detail">INF / Autorun</a> family.  Such an autorun mechanism is especially relevant for legacy OSs, since they have an autorun autorun mechanism enabled by default through Autorun files.  For more information about disabling autorun using Autorun files on such OS see <a href="https://support.microsoft.com/kb/967715">KB967715</a> . <br><br>  The table below lists the vulnerabilities (0day at the time of operation), with which the attackers delivered malicious code.  The past year 2013 can rightly be called the year of targeted attacks and watering hole attacks, for many of them the attackers specifically searched for a particular vulnerability and used it exclusively to attack a specific region or particular company.  In particular, watering hole was used to compromise websites that were actively visited by alleged victims in different regions of the world.  We believe that in 2014 this trend will become even more widespread. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bb4/b70/abf/bb4b70abf2777b1da277db44cedcab91.png"><br><br>  This year, we repeatedly wrote about attacks on popular instant messengers such as Skype and Gtalk, as well as social networks, such as Facebook or Vkontakte.  We will not repeat, but just note that attackers take advantage of persuasive phishing messages, supposedly trusted domains, in which there is a slip of the letter and a few link shortening services to lure users to follow a malicious link.  To organize a large-scale spam mailing, attackers need to create auxiliary fake accounts in a particular service, use user accounts with reduced security settings, and also malicious code with the ability to inject their code into messengers ( <b>Win32 / Rodpicom.C</b> ) to <b>send messages</b> .  Since the number of users of all these services is only increasing, we believe that we can expect this kind of attack in the next year. <br><br>  <b>Trends for Windows</b> <br><br><ul><li>  Attackers are increasingly resorting to using the capabilities of the Tor anonymous network to work with remote C &amp; C servers.  This year there are several new threats with such capabilities.  For example, <b>Win32 / Atrax.A</b> , <b>Win32 / Agent.PTA</b> , <b>Win32 / Napolar</b> .  Using Tor allows an attacker to be more invisible because it allows you to hide C &amp; C information (IP address or domain).  This is especially useful for hiding information from traffic analysis systems that collect information about incoming / outgoing traffic on the network of an enterprise.  Through such logs, the security service can quickly detect the true malicious URL. </li><li>  The use of a distributed architecture in extortionists-cryptographers.  On the example of Cryptolocker ( <b>Win32 / Filecoder.BQ</b> ), it became obvious that if you use the RSA-type public-key encryption algorithm for files (to encrypt the key of the symmetric algorithm that files are encrypted with), then the user will not have another opportunity to pay attackers for or lose your files.  In December, we reported on the discovery of its new modification, which is called Cryptolocker 2.0 ( <b>MSIL / Filecoder.D</b> , <b>MSIL / Filecoder.E</b> ), see the table below.  In addition, at the beginning of this year, information appeared about the new coder who uses a similar approach called the Prison Locker (Power Locker), a malware blog was reported on. </li><li>  The most popular malicious code from cybercriminals are tools that are used to steal various confidential information from online service accounts, as well as online banking information.  We call these types of malware tools, since they contain several components, for example, mobile, which is used to bypass two-factor authentication in the form of SMS confirmation codes (mTAN).  Such tools are a professional means of stealing money from users.  These include, for example, <b>Win32 / Qadars</b> and <b>Win32 / Spy.Hesperbot</b> . </li><li>  Complicated malware as a way to extract large profits.  An example of the infamous ZeroAccess family ( <b>Win32 / Sirefef</b> , <b>Win64 / Sirefef</b> ) shows that hiding its code deep in the system, using non-standard approaches to infecting files and targeting the x64 platform, which is increasingly replacing x32, allows you to achieve the maximum possible material benefit for intruders.  According to estimates by Microsoft Digital Crimes Unit, which were involved in gaining control over this botnet, ZeroAccess infected about 2 million computers with an estimated monthly profit of $ 2.7 million. </li><li>  64-bit threats.  This year, a modification of the widely known file virus Expiro, which can infect 64-bit files ( <b>Win64 / Expiro.A</b> and <b>Win64 / Expiro.B</b> ), was discovered.  Win64 / Expiro has a portable cross-platform body (x32-x64) and can infect both 32-bit and 64-bit files.  In addition, many malware already have a 64-bit payload.  It is obvious that cybercriminals are guided by very practical goals, as 64-bit operating systems in the world are becoming more and more. </li></ul><br>  More detailed information about the detected Cryptolocker modifications is given in the table below. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7b2/01c/1bb/7b201c1bb17e8d4b07584658a48c94d1.png"><br><br>  <b>Mobile threats - the main trend of the year</b> <br><br>  In our last year's report, which was called ‚ÄúOverview of the main threats and trends in 2012‚Äù, we pointed to the rapid spread of malware for Android.  For example, in 2012 compared to 2011, the number of malicious objects we detected increased 17 times. <br><br>  We also predicted the rapid growth of new threats in 2013. Such a prediction really came true and this year we recorded the appearance of a large number of malicious programs for this platform. <br><br>  It's no secret that Android is the most common platform for mobile devices.  The statistics provided by Gartner for the second quarter of 2013 shows that Android has further strengthened its position in the mobile device market almost reaching 80%. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/035/950/f1b/035950f1b953483e6e2457c7fe2e0486.jpg"><br>  Fig.  The percentage of mobile operating systems sold with corresponding devices in the second quarter of 2011, 2012 and 2013.  (Gartner data). <br><br>  Regarding Microsoft‚Äôs new mobile platforms - Windows RT (based on Windows 8, for example, Surface 2) and Windows Phone 8 (based on Windows NT / Windows 8, for example, Nokia Lumia), which are used on a number of smartphones and their the Surface's flagship tablet, then attackers, perhaps, it makes no sense to create such a highly specialized malicious code, despite the fact that the market for devices running these operating systems is very small (compared to Android).  The same applies to iOS, but in this case, attackers are much more difficult to distribute malware, due to the limitations imposed by the App Store for iOS digital distribution center.  No application can be downloaded to the App Store without a strict preliminary check. <br><br>  Microsoft uses the Windows Store and Windows Phone Store approaches similar to Apple security of digital content.  Windows Store is used as a platform for digital distribution of applications for Windows 8 / 8.1, and Windows Phone Store for Windows Phone 7 and 8. Applications hosted there must comply with certain security rules and be pre-tested.  Thus, users of these platforms are more secure due to its novelty and safety rules. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f83/ce7/2b2/f83ce72b2b564f39313998482c41d738.png"><br><br>  According to the data in the diagram above, this year, the ESET Antivirus Lab detected a significant increase in the Android malware families, reaching 79 families.  The malware family is a combination of various malware modifications that can be correlated into one group for some common features of the code base and behavior.  We also recorded that the countries with the highest growth of threats are Iran, China and Russia. <br><br>  It should be noted that for Android, the percentage of so-called potentially unwanted software (PUA or greyware) is large.  And the absolute majority of these applications are located in third-party application stores.  Such software is not possible to strictly classify as malware, rather, it simply exposes the user to a certain degree of risk, since it contains questionable functions, for example, is adware or spyware.  Android application stores are trying to protect users from malicious applications by implementing special rules and filtering or removing such applications for incoming complaints.  However, some malware can avoid such checks and ensure its presence in the lists of applications of a store. <br><br>  Last year marked the emergence of new types of malware for Android.  Previously, such threats were typical for personal computers, but now we are seeing them on mobile devices.  Some of them were found before, but did not show high activity as this year. <br><br><ul><li>  Downloader (downloader): tries to download other malware files from the Internet and install them on the device. </li><li>  Dropper: installs other threats to the device when it starts, threats are in the file of the dropper itself. </li><li>  Clicker: designed to generate traffic to sites through an artificial increase in the number of clicks received on infected devices. </li><li>  Banking malware: specializes in stealing user confidential information that is used to conduct online banking transactions. </li></ul><br>  We expect an increase in the number of threat modifications for each of these types in the future.  This is especially true of banking malware, which has become increasingly active because of the possibilities for the user to conduct financial transactions directly through the device using special applications for working with the online banking system.  Users can perform similar operations through a browser that may be compromised by malicious code.  As a result, attackers may have access to the data entered in the forms. <br><br>  This year, we observed the emergence of the Hesperbot banking Trojan program, which uses the compromise of the user's mobile device in order to gain access to SMS confirmations (mTAN), which are a two-factor authentication mechanism for user operations.  Hesperbot infects the user's computer, but if two-factor authentication is present when working with the online banking system, its methods of obtaining funds will be useless.  Therefore, cybercriminals use a mobile component for this purpose. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e7b/627/545/e7b62754524cc7437e32f8cab1b6b0d4.png"><br>  Fig.  Through a web injection in a browser on a compromised system, attackers convince the user to install a mobile application that will allow them to bypass the two-factor mTAN authentication during the transaction.  [The message is translated from English, used in <a href="http://habrahabr.ru/company/eset/blog/205700/">Win32 / Hesperbot</a> ]. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ec/03b/f39/7ec03bf39a24484eddbc36ceb2556d82.png"><br><br>  Above, the graph shows statistics on the growth in the number of versions or modifications of common malware families for Android.  Still the most relevant family is the Trojan program SMS.Agent, attackers use it to covertly send paid SMS-messages and to sign the user to paid services.  In 2013, this family underwent a significant increase in versions, with a total of 324 versions recorded.  For comparison, in 2012, 214 versions of it were discovered.  The dominant family of new versions is also the Steek family. <br><br>  <b>Remote code execution as the most effective method of malware delivery.</b> <br><br>  Last year, Microsoft fixed a large number of vulnerabilities for Windows and its components, as well as for Office.  Some of these vulnerabilities were used by hackers to deliver malicious code before the fix was released.  As a rule, most of them were focused on certain flaws in Internet Explorer. <br><br>  The outgoing year was marked by the appearance of 0day vulnerabilities, which, first of all, were used in targeted attacks.  This is a kind of trend of the past year, the attackers carry out the development of exploits not for the spontaneous spread of malicious code, but use them in attacks on specific users, while pursuing certain goals. <br><br>  The following statistics show Microsoft patched vulnerabilities in patch tuesday for this year. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b9b/de1/6d7/b9bde16d7ec70439da55a5da1c1e5693.png"><br><br>  Vulnerabilities exploited at the time of closure are marked in red. <br><br>  The table below provides more detailed information on vulnerabilities that were in-the-wild exploited in the past year (until the release of the corresponding patch, 0day). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/408/196/355/4081963554cbc31b833e8fbc94341c31.png"><br><br>  As we see, attackers can use some system libraries compiled without ASLR support to build stable ROP gadgets and bypass ASLR.  One such example is the Office 2007-2010 hxds.dll library, which is compiled without ASLR support.  As part of the December patch tuesday, the company closed this mistake (called Security Feature Bypass) using <a href="https://technet.microsoft.com/en-us/security/bulletin/ms13-106">MS13-106</a> , providing Windows users who work with this version of Office with the proper level of protection. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/79f/829/971/79f8299719249aefe752bc6fab84cd3d.png"><br><br>  A list of Security Advisory issued last year. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/93c/e40/11b/93ce4011b6f2228515c2ac37c51c4539.png"><br><br>  Below is the rating of the most fixable components in Windows for 2013. Note that the currently supported MS versions of the OS are Windows from XP SP3 / x64 XP SP2 to Windows 8.1 / RT 8.1. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/945/e14/64c/945e1464c59b028193a795f349dbf2b2.png"><br><br>  The same in comparison with Office (2003 - 2013 for Windows). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/60d/00a/72c/60d00a72cb2eb3dcedf7df6b3e30a806.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/8f7/a35/bea/8f7a35bea4db7d063c312c5c0b3fa993.png"><br><br>  <b>Drive-by download</b> is the main method of stealthily delivering malicious code by redirecting the user to the pages of exploit kits. <br><br>  <b>Local Privelege Escalation (LPE, Elevation of Privelege)</b> is a method of obtaining maximum system privileges, usually associated with running the kernel mode code bypassing the OS restrictions imposed on user-mode restriction. <br><br>  <b>Remote Code Execution (RCE)</b> - remote code execution, used, for example, in drive-by, but in this case can be activated not only through a web page. <br><br>  The trend by released updates shows that products such as the Internet Explorer browser, .NET components and the Silverlight browser plugin are used by attackers for remote code execution, and in most cases this can happen through the browser.  The attackers use a specially prepared web page with malicious content to install this or that malicious code on the user's computer.  In this scenario of using Internet Explorer, the use of the "Protected mode" technology of the browser, as well as the sandboxing technology "Advanced Protected Mode" is an important condition for ensuring your security for networking. <br><br>  We note that the <a href="http://habrahabr.ru/company/eset/blog/200156/">use</a> of sandboxing <a href="http://habrahabr.ru/company/eset/blog/200156/">technologies</a> for browsers has long been a requirement for ensuring an appropriate level of security for users.  It is extremely difficult to circumvent such a mode of operation of the browser and forces the attackers to use other methods to enhance their rights in the system.  Other methods are the development of LPE-exploits that will work in conjunction with an exploit that causes remote code execution.  Such an approach is necessary for attackers, since having entered the browser through the RCE vulnerability, the shell code remains powerless in performing any system operations, since the browser process runs at low Integrity Level and with many prohibited privileges.  A good example of this practice is the demonstrated method of exploiting Google Chrome by MWR Labs on <a href="http://habrahabr.ru/company/eset/blog/193064/">Pwn2Own 2013</a> , bypassing the restrictions of the sandbox mode through a vulnerability in win32k.sys. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9f1/e7c/8cc/9f1e7c8cc2258e46e95b217801498d6d.png"><br>  Fig.  Internet Explorer 11 with sandboxing mode settings (optimal use on Windows 8 / 8.1 x64). <br><br>  Vulnerabilities in Office suite applications can also be used by attackers to remotely install malicious code.  From the updates for Office released this year, it is clear that most of them were aimed at eliminating vulnerabilities such as Remote Code Execution.  In this scenario, the attackers form a specially prepared Office file, for example, a .doc Word file and send it with a phishing email to the victim's address.  The message must be convincing for the user to read it and go to the attachment and open it.  After opening such a file, malware will be installed on the vulnerable version of Office. <br><br>  Note that the latest version of Word 2013, as well as Outlook 2013, when working with Word (opening attachments), use persistent sandboxing mechanisms that prevent the application from performing potentially unsafe functions.  For example, Outlook <a href="http://habrahabr.ru/company/eset/blog/201304/">starts</a> the Word process at low Integrity Level and with privileges disabled, which allows you to limit potential shellcode from performing system operations. <br><br>  OS components that work in kernel mode: the Windows subsystem driver - win32k.sys, system drivers (KM drivers) and the ntoskrnl kernel (NTOS), are used by attackers to raise their privileges in the system, i.e., to execute code in the kernel mode bypassing the limitations of the OS.  This year the win32k.sys driver was especially notable, in which more than fifty vulnerabilities were closed. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/086/e5e/795/086e5e7958182ba0aae995e18182d9d2.png"><br><br>  It is obvious that in 2013 the company closed many more vulnerabilities than in 2012. This trend is most clearly evident for the Windows subsystem driver Win32k.sys and Internet Explorer.  In October, the company released a new Windows 8.1 operating system, as well as Internet Explorer 11. <br><br>  <b>OS Prevention</b> <br><br>  Last year showed that Microsoft paid attention to security technologies to counter the exploit.  Three major innovations were aimed at protecting against memory allocation on a zero page, deleting pointers to different ntdll functions from PEB (ASLR bypass mitigation), and prohibiting the provision of information about kernel pointers for untrusted applications on Windows 8.1 (KASLR bypass mitigations). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2d3/fa4/909/2d3fa490951c80f070e34433a76286ee.png"><br><br>  Allocating memory on a zero page (using <i>ZwAllocateVirtualMemory</i> ) made life easier for attackers, including if they are interested in increasing their privileges in the system.  After allocating such a section of memory, you need a vulnerable driver that, when passing certain parameters to it, will be able to execute code at this address (bug). <br><br>  The following features are available in Internet Explorer as protection against exploitation.  The last point is the fact that all the system files compiled by MS for Windows 8 support the resistant <a href="http://habrahabr.ru/company/eset/blog/206244/">HEASLR</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d7a/371/2ae/d7a3712ae9aae2a816601f15e6800965.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5cd/7b8/7c3/5cd7b87c3d558d9062ec8f0601a7ef56.png"><br>  Fig.  System files on Windows 8 x64 + are compiled with support for enhanced ASLR - High Entropy ASLR, to minimize the likelihood of its bypass. <br><br>  <b>Windows XP - the last chord</b> <br><br>  Last year was the last year in which Microsoft supported the latest editions of Windows XP SP3 and Windows XP x64 SP2.  Despite the recommendations of Microsoft and various security specialists, who called on users to abandon this outdated and extremely insecure OS for a long time, today a large number of users still use it.  According to Net Applications, Windows XP is used by almost 30% of computers. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/39d/066/f31/39d066f313304549d0eb866bfa8b5680.png"><br>  Fig.  Statistics of OS usage on computers according to <a href="http://en.wikipedia.org/wiki/Net_Applications">Net Applications</a> . <br><br>  In April 2014, the company will abandon support for Windows XP SP3 and Windows XP x64 SP2 (support for Windows XP &amp; SP1 &amp; SP2, Windows XP x64 &amp; SP1 has already been completed) and thus completely closes the cycle of supporting the code base and OS products that are based on Windows XP.  For users, in the first place, this will mean the fact that they will lose security and other updates that Microsoft is guaranteed to issue every second Tuesday of the month (so-called patch tuesday) or unscheduled, as well as instructions in the Security Advisory (SA) or workaround in case of detection of exploited vulnerabilities in the OS (the company reserves the right to publish or not this information). <br><br>  A good example of such a vulnerability for Windows XP, the fix of which the company postponed for 2014, is CVE-2013-5065.  Due to the support of Windows XP until April, Microsoft fixes it in the January update set as the Important update MS14-002 (later, after April, such vulnerabilities will not be fixed). <br><br>  CVE-2013-5065 became known at the end of November from <a href="http://technet.microsoft.com/en-us/security/advisory/2914486">SA 2914486</a> .  The vulnerability is present in the version of the ndproxy.sys driver that comes with Windows XP and Windows Server 2003, it allows attackers to elevate their privileges to the system level and, through circumvention of user mode restrictions, execute their code in kernel mode (Local Privilege Escalation, LPE) through sending a specially crafted request (IOCTL) to the ndproxy.sys driver. <br><br>  In order to protect users who still continue to use Windows XP SP3, Microsoft releases the free tool EMET (v 4.1 current version).  EMET helps the user to protect the OS from various actions of exploits through which attackers try to compromise the system and run malicious code there.  With reference to Windows XP SP3, EMET will help introduce the following features, which will greatly enhance the immunity of the system. <br><br><ul><li>  Enable <a href="http://habrahabr.ru/company/eset/blog/206244/">ASLR</a> . </li><li>  Force DEP on for the entire system. </li><li>  Enable the ability to protect against rewriting pointers in SEH at the OS level - SEHOP. </li><li>  Use <a href="http://habrahabr.ru/company/eset/blog/184428/">standard EMET features</a> to protect against exploits. </li></ul><br><br>  EMET mechanisms are applied to processes, so the user is free to select specific processes in the list in order to apply security features to them.  By default, it protects the following processes that are critical to remote operation: <br><br><ul><li>  Adobe Reader (from PDF operation); </li><li>  MS Office (including Excel, Word, Access, Outlook and others from exploitation through email attachments); </li><li>  Java (from exploitation through the browser); </li><li>  Internet Explorer Browser. </li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/40e/957/a38/40e957a38f0370b402740b30a62752a7.png"><br>  Fig.  EMET main window with maximum settings, in the process list, Google Chrome browser as protected. <br><br>  SA recommendations often contain a reference to EMET and its options for quickly remedying the situation and protecting against a particular vulnerability even before the official update.  Most of these settings are available from the user interface of the tool, but there are also those that are not there.  For example, exploits often use heap spraying as a means of bypassing ASLR.  In this scenario, the attackers know what value a particular register can take in an erroneous situation in the execution of a code (bug).  Then they can only reserve a certain number of memory blocks that are adjacent to this address (spraying).  Later, when provoking a situation of exploitation, the erroneous code will transfer control to one of the addresses that the attacker needs.  The list of such addresses is listed in the registry key HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ EMET \ _settings _ \ {GUID}.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This list is updated according to the recommendations of the SA (eg, see </font></font><a href="http://technet.microsoft.com/en-us/security/advisory/2887505"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SA 2887505</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br><br>  <b>Conclusion</b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The past year has shown a high activity of various malicious code and intruders who use it. </font><font style="vertical-align: inherit;">As we mentioned above, the number of targeted attacks this year has only increased, and a similar way of spreading malicious code is becoming more and more important among intruders. </font><font style="vertical-align: inherit;">Remote code execution through exploits specifically detected for a particular attack is also a significant trend of the past year.</font></font></div><p>Source: <a href="https://habr.com/ru/post/209694/">https://habr.com/ru/post/209694/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../209680/index.html">Videophone D900 based on Android 4.2</a></li>
<li><a href="../209682/index.html">PHP LINQ similarity for EAV data storage model</a></li>
<li><a href="../209684/index.html">Network Virtualization in Hyper-V. What's new in Windows Server 2012 R2?</a></li>
<li><a href="../209686/index.html">How to fly to Hong Kong to the exhibition (part 1)</a></li>
<li><a href="../209690/index.html">Initial setup and capabilities of FortiGate UTM devices for small businesses</a></li>
<li><a href="../209696/index.html">Dart 1.1 is 25% faster, caught up with idiomatic JavaScript and is now suitable for servers</a></li>
<li><a href="../209698/index.html">Day-to-Day Maintenance Plan - Part 1: Automatic Index Defragmentation</a></li>
<li><a href="../209704/index.html">Botnet detected, consisting of "smart" TVs, media centers, PC and ... refrigerator</a></li>
<li><a href="../209706/index.html">System Update - ImageCMS 4.5.2</a></li>
<li><a href="../209714/index.html">Out-of-box intrusion prevention systems. Test Drive</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>