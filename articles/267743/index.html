<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Planning resources for Veeam Backup & Replication 8.0: calculating the required place in the repository</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="So that when planning resources for Veeam Backup & Replication, people could figure out how much space is needed in the repository for backup of the v...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Planning resources for Veeam Backup & Replication 8.0: calculating the required place in the repository</h1><div class="post__text post__text-html js-mediator-article">  So that when planning resources for Veeam Backup &amp; Replication, people could figure out how much space is needed in the repository for backup of the virtual machine, a <a href="http://vee.am/rps">Restore Point Simulator (RPS)</a> calculator-simulator of recovery points was created in due time. <br><br><img src="https://habrastorage.org/files/d21/82a/ec0/d2182aec0d72469aa396b3a8e29b7cbf.png" alt="image"><br><br>  But since from time to time we hear from users ‚ÄúWhy \ why is this value here?‚Äù, Today I will give a few explanations about the input parameters and tell you where the default values ‚Äã‚Äãcome from. <br>  For details, welcome under cat. <br><a name="habracut"></a><br><h1>  Calculation formula on paper and in calculator </h1><br>  The formula that is used to calculate the size of the backup that is obtained in one pass of the backup task is: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Backup Size (Backup Size)</b> = <b>C <i>x</i> (F <i>x</i> Data + R <i>x</i> D <i>x</i> Data)</b> <br><br>  Here: <br><br><ul><li>  <b>Data</b> - the total size of all virtual machines processed by a specific backup task (the actual space occupied, but not allocated) </li><li>  <b>C</b> - the average compression ratio \ deduplication (actually depends on a number of factors, it can be very high, but we take the minimum - 50%; for details later) </li><li>  <b>F</b> - the number of full backups (VBK) in the chain, according to the storage policy (take 1, unless you are using the mode with the periodic creation of full backups, about which I will also tell) </li><li>  <b>R</b> - the number of incremental backups (VRB or VIB) in the chain, according to the retention policy (14 by default) </li><li>  <b>D (delta)</b> - the average number of VM disk changes in the interval from one pass of a backup job to another (in the current version of the calculator, this value is 10%, but perhaps in the future it will change by 5% according to the feedback from users ... actually for The main mass of VMs is 1-2%, but for Exchange and SQL the value reaches 10-20% due to the large number of transactions and, accordingly, log entries, so 5% will be quite reasonable). </li></ul><br>  The parameters of this formula and the RPS calculator are related as follows: <br><ol><li>  <b>Data</b> is what you need to enter in the <b>Used Size GB</b> field of the calculator. <br>  This is the size of the actual space used, i.e.  if you have a VM with one VMDK, then this value is equal to the number of blocks that were written to.  For example, if it was a ‚Äúthick‚Äù (thick provisioned) disk at 50GB, and you used 20GB for a guest, then in the <b>Used Size GB</b> field, you need to enter a value close to 20GB.  You can say, <b>Used Size GB</b> is a place that a VM would really occupy, if it had a ‚Äúthin‚Äù disk (thin provisioned), because since Veeam copies data at the block level, then it‚Äôs a ‚Äúthin‚Äù disk (i.e. . Actually occupied space) would correspond to the amount of data that must be processed when creating a full backup (well, plus some metadata). </li><li>  <b>D</b> , or delta is the size of the data that varies between runs of the backup job.  In the calculator, this is the <b>Change rate</b> field.  The choice of its value is influenced by two things: how often the task is started (usually this is once a day) and which application runs on the VM. <br>  To underestimate this value is not recommended.  Again, Veeam copies the data at the block level, and a tiny change can cause a larger scale change at the block and disk level ‚Äî more than what you put in the calculator.  If writing to disk goes sequentially, as in the case of, for example, a file server, then this is most likely not so noticeable, because 10 consecutive changes may well fall into one block.  But if the application makes a lot of even very small random changes in different places, the value can quickly grow.  From what I've observed, the value of 5% is a rather optimistic estimate, and 10% is a rather conservative one. <br><br>  <i>Useful:</i> If you have a deployed Veeam ONE solution, then to assess changes in% specifically for your infrastructure, you can generate a <b>VM Change Rate Estimation</b> report from the <b>Infrastructure Assessment</b> report set. <br></li><li>  <b>C</b> , it is compression (compression) - in the calculator this field is <b>Data left after reduction</b> .  There are different opinions about his interpretation among the audience, but I propose to look at our formula, which can be written like this: <br><br>  <i><b>Backup Size</b> = <b>C</b> x <b>(Total Data In)</b></i> <br><br>  That is, speaking in Russian: <br><br>  <i><b>Backup size</b> = <b></b> x <b>(total input data)</b></i> <br><br>  It shows that when multiplied by <b>C, the</b> value of <b>Total Data In</b> changes proportionally, giving us <b>Backup Size</b> .  This means that the compression ratio <b>C</b> shows how much (in%) the volume of incoming data has decreased, more precisely, how much of the original volume remains after compression.  So, for example, if you set it to 40% (40/100) and take the volume of incoming data for 100 units, then the size of the backup will obviously be <i>(40/100) * 100 = 40</i> units.  If you set it to 60%, then it turns out that you expect a smaller effect from compression, because according to the formula, it turns out that the backup size will be <i>(60/100) * 100 = 60 units</i> .  The bottom line: the smaller the compression ratio, the better the compression. <br><br>  To some, this will seem intuitive, and to someone it‚Äôs more familiar to see the compression ratio "2 times" or "3 times."  This is easy to convert - you get <b>1 / N</b> x <b>100%</b> , that is, for "twice" will be <i>1/2 x 100% = 50%</i> . <br><br>  Substitute this value into our formula and get: <i>50 backup size = 50% x (100 total data in)</i> <br><br>  That's right, the incoming data volume has shrunk by half.  Similarly, for compression "3 times": <b>1/3 x 100% = 33%</b> . <br><br>  <i>Note:</i> If you plan to disable data compression altogether, set this factor to 100%. <br></li></ol><br><h1>  Pro recovery points and retention policy </h1><br>  We still have two parameters from the formula - <b>F</b> and <b>R.</b>  These values ‚Äã‚Äãindicate how much you want to have full backups (Fulls) or incremental backups (incRements).  With the <i>Reverse incremental / Forever incremental</i> modes, everything is obvious - for them there will be: <br>  <b>F = 1</b> <br>  and <br>  <b>R = rps (total number of recovery points) - F</b> <br><br>  And if you need weekly synthetics or active fulls?  It all becomes a bit more complicated, because you need to take into account the storage policy settings.  For example, if you need to build an incremental chain of forward incremental, doing weekly full on top of that, and the policy prescribes to store 2 restore points, then you may have 9 points at some point - and all for dependencies between increments and full backups.  The term ‚Äúrecovery point‚Äù should be interpreted literally (as Veeam Backup &amp; Replication does) - this is the point from which you can recover.  If there is no full backup - the ‚Äúfoundation‚Äù from which the chain of increments, ‚Äúfloors‚Äù is built, then it will be impossible to restore the car (‚Äúhouse‚Äù) from any increment ‚Äúfloor‚Äù. <br><br>  The simulator calculator also illustrates this dependence: after you select a mode, enter the number of points prescribed by the policy in the <b>Retention points</b> field and specify other parameters, and then click <b>Simulate</b> , in the results section in the <b>Retention</b> column you will see a pair of numbers N1 (N2) .  This means that the recovery point number N1 will be stored (will not be deleted), because  another point (N2) depends on it. <br><br><img src="https://habrastorage.org/files/3b2/70e/78f/3b270e78f5a442009089f6748fd83e31.png" alt="image"><br><br>  If you count on a piece of paper or on a regular calculator, the formula will look like this: <br>  <i><b>F = (number of weeks) + 1</b></i> <br>  <i><b>R = (F x 7 x number of daily backups - F)</b></i> <br><br>  For example, if you need to store 14 points, and run the backup daily, you get: <br>  <i>F = 2 + 1 = 3</i> <br>  <i>R = 3 x 7 x 1 - 3 = 21 - 3 = 18</i> <br><br>  Another subtlety is in understanding how much space a weekly backup will take, and how much monthly.  Remember that a monthly backup can have a chain of 30 points.  If you set up the weekly full week, the chain will be a maximum of 7 days, i.e.  less storage space is needed.  However, if you set up a policy for storing, say, 60 points, then monthly monthly full may be more profitable than weekly. <br><br><h1>  The prologue is over, go to the input </h1><br>  As you have already noticed, some of the calculator fields correspond to the fields of the Veeam Backup &amp; Replication 8 interface;  the pictures show both UIs - for clarity and more convincing. <br><br>  So, we are determined with the policy of storing recovery points.  If you need to keep daily backups (one per day) in the amount of 14 pieces, then enter <i>14</i> in the <b>Retention points</b> field, and <i>Daily</i> in the <b>Interval</b> field. <br><br>  <i>Important!</i>  Remember that at certain points in time there will be more stored points than you specified - since not only the value you set is taken into account, but also the dependencies between increments and full backups.  Therefore, do not rush to edit these values ‚Äã‚Äãonly because it seems to you to be surplus - or rather, carefully reread the previous section about F and R again. <br><br>  The number of parameters to be set depends also on what is called <b>Style</b> in our calculator (the style, or the method of creating a restore point, for which you need to perform estimation calculations).  It's all the same as the Veeam Backup &amp; Replication console.  For example, let's take the <i>Backup Copy Job</i> ‚Äústyle‚Äù - obviously, if you want to do the calculation for this option, the same settings will be used that you set when configuring Backup Copy Job in the Veeam console: <br><br><img src="https://habrastorage.org/files/890/5f6/343/8905f6343ca24c5aa8dc8ae60fe8f1b3.png" alt="image"><br><br>  For other ‚Äústyles‚Äù named <i>Incremental</i> and <i>Reverse</i> , the calculation parameters will correspond to the Backup Job backup job settings (with the exception of <b>Retention Points</b> ): <br><br><img src="https://habrastorage.org/files/edb/6dc/074/edb6dc0742f5498098c2b1e6102288e7.png" alt="image"><br><br>  <i>Note:</i> If you select <i>Incremental</i> at all without full backups (active fulls or synthetic fulls), you will get an infinite chain of increments. <br><br>  I draw your attention to the differences in the UI: <br><br><ul><li>  In the Veeam interface, the corresponding settings are opened by clicking the <b>Advanced</b> button in the <b>Storage</b> step (of course) of the backup job wizard.  The schedule settings for which a full backup should be created are opened in <b>Advanced Settings</b> by clicking the <b>Days</b> and <b>Months</b> buttons. </li><li>  You will not see the checkbox ‚ÄúEnable Active‚Äù or ‚ÄúEnable Synthetic‚Äù in the calculator itself, but locking in any daw in the <b>Incremental Specific</b> section will result in choosing Active Full or Synthetic Full. </li><li>  Well, in addition to the <b>Monthly</b> option in the calculator, the priority is over the <b>Weekly</b> option - in the Veeam GUI you can select only one of them, and here at least both, but if <b>Monthly</b> is selected, then <b>Weekly</b> will be ignored. </li></ul><br><img src="https://habrastorage.org/files/439/0cc/d73/4390ccd732da402ba3d37f8736a2485c.png" alt="image"><br><br><h2>  Example ‚Ññ1: incremental backup with weekly synthetic full </h2><br>  In this case, the settings should be similar to those in this picture (on the left, what you would have indicated in the Veeam console, on the right, what needs to be indicated in the calculator): <br><br><img src="https://habrastorage.org/files/b70/729/196/b70729196a96409a9c9e3302c25d3b74.png" alt="image"><br><br>  <i>Note: The</i> calculator does not reproduce the ‚ÄúTransform‚Äù option for one simple reason - so far nobody has asked the author about it :). <br><br><h2>  Example number 2: incremental backup with monthly active full </h2><br>  To calculate the scenario with monthly active full, the settings should be the same as in this picture: <br><br><img src="https://habrastorage.org/files/648/4f7/f38/6484f7f3858845da950a5e07bb545eac.png" alt="image"><br><br>  <i>Important!</i>  Remember that for Backup Backup job there is no GFS storage scheme - this scheme can be specified only in Backup Copy Job transfer jobs.  (One user tried to check in the backup task only January, because he dreamed of "having an annual backup for the archive" - ‚Äã‚Äãnaturally, he was quite surprised to see what happened as a result of his settings. Of course, the calculation was made for a whole year long chain, creating the next full backup in January). <br><br><h2>  Example 3: reverse incremental backup </h2><br>  To calculate the same for <i>Reverse, incremental</i> settings should be as follows: <br><br><img src="https://habrastorage.org/files/28a/033/b97/28a033b979d741f0b71eb59318f6460c.png" alt="image"><br><br><h1>  Do you make long-term forecasts? </h1><br>  It remains to explain only one <strike>owl</strike> one option - the simulation of the growing amount of data of the <b>Time Growth Simulator</b> .  This is a recent and, in my opinion, quite useful invention.  Its essence is that if you want, say, to make a calculation of the increase in the amount of data 3 years ahead, and you know that the amount of input data is growing by 10% per year, then you just need to check the checkbox next to <b>Time Growth Simulator</b> and specify this period and these% by selecting the desired values ‚Äã‚Äãfrom the drop-down lists. <br><br>  The calculator takes the value of <b>Used Size GB</b> (it was mentioned above) and calculates the daily increase in the amount of data using the formula: <br><br>  <b>Future Used Data = Used Size x (1 + 10%) ^ (Day N / 365)</b> <br><br>  Thus, on the last calculated day (in 3 years) it will turn out: <br>  <i>Future Used Data = Used Size x (1 + 10%) ^ (1095/365)</i> <br><h2>  Example 4 </h2><br>  Suppose that you chose the Reverse incremental backup method, you want to calculate the required volume for 3 years ahead, taking into account the annual growth of data volume by 10%, and the initial Used Size you have is 1000GB (for simplicity, the compression ratio will not be taken into account). <br>  Calculate using the formula Future Used Data after 3 years: <br><br>  <i>Future Used Data = 1000 x (1 + 10%) ^ (1095/365) = 1000 x (110%) ^ 3 = 1000 x (1.10) ^ 3 = 1000 x 1.10 x 1.10 x 1, 10 = 1331</i> <br><br>  Let's check our calculation using a calculator simulator: <br><br><img src="https://habrastorage.org/files/dbb/969/24c/dbb96924c5174a7eba62cbee42023b06.png" alt="image"><br><br>  By the way, note that an incremental backup, which represents a recovery point created 2 days before the expiration of the 3-year period, will have a smaller Future Used Data size - according to the same formula: <br>  <i>Future Used Data = 1000 x (1 + 10%) ^ (1093/365) = ~ 1330.30</i> <br><br>  For standard backup tasks, the difference is not very large, but if you do calculations, for example, for a Backup Copy Job job with a GFS storage policy, you can see a more significant increase. <br><br><img src="https://habrastorage.org/files/816/f36/f4e/816f36f4e0624e3981cd375bae354dd3.png" alt="image"><br><br>  Well, in conclusion, a few words about <b>Quick Presets</b> are typical scenarios that are most often taken for calculation.  For example, the script <i>Incremental Monthly Active Full will</i> calculate everything for you exactly the same as if you selected <i>Incremental</i> in the <b>Style</b> list and checked all 12 months in <b>Active Full Monthly</b> .  That's all. <br><br><img src="https://habrastorage.org/files/9af/c9c/441/9afc9c4417394389832903eddbefe920.png" alt="image"><br><br>  Thanks for attention! <br><br><h1>  PS: What else to read </h1><br>  <a href="http://habrahabr.ru/company/veeam/blog/242983/">Article on Habr√© about backup methods</a> <br>  <a href="http://habrahabr.ru/company/veeam/blog/261595/">Article on Habr√© about testing the performance of storage systems for backups</a> </div><p>Source: <a href="https://habr.com/ru/post/267743/">https://habr.com/ru/post/267743/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267729/index.html">Game client download tracking system. Part 2</a></li>
<li><a href="../267731/index.html">13 basic principles of game design. Direction and behavior</a></li>
<li><a href="../267733/index.html">Greenplum db</a></li>
<li><a href="../267735/index.html">Android Data Binding in RecyclerView</a></li>
<li><a href="../267737/index.html">ICQuery is a fictional program that communicates with the user and performs tasks described in the natural language of communication.</a></li>
<li><a href="../267745/index.html">Facebook introduces encryption for Internet.org</a></li>
<li><a href="../267747/index.html">What we should build a plant: EMC solutions for industrial facilities</a></li>
<li><a href="../267749/index.html">Transformation approach Zachman</a></li>
<li><a href="../267751/index.html">Life hacking for web developer</a></li>
<li><a href="../267761/index.html">Victory Roll Girl tutorial</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>