<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dremel. How does Google think in real-time?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dremel is a scalable system for processing requests in near-real-time mode , designed to analyze immutable data [4]. 

 The authors of research paper ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dremel. How does Google think in real-time?</h1><div class="post__text post__text-html js-mediator-article">  <strong>Dremel</strong> is a <em>scalable system for processing requests in</em> near-real-time <em>mode</em> , designed to analyze immutable data [4]. <br><br>  The authors of research paper [4] (among which, apparently, and our compatriots - Sergey Melnik and Andrei Gubarev), which describes the basic principles and architecture of Dremel, declare that the system is capable of: <br><ul><li>  perform aggregate queries on more than one <em>trillion lines</em> in seconds; <br></li><li>  scales to <em>thousands of CPUs</em> ; <br></li><li>  designed to work with <em>petabytes of data</em> ; <br></li><li>  has <em>thousands of users</em> inside Google (literally "at Google" [4]). <br></li></ul><br>  <b>UPD1:</b> Below is a picture of <s>deja</s> for attentive readers. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f4f/e81/90c/f4fe8190c9f81b893d6de2b5930ea512.jpg"><br><a name="habracut"></a>  Dremel is Google's proprietary product, in operation since 2006, officially presented to the community at the <em>Very Large Data Base (VLDB) Endowment</em> conference in 2010. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Dremel is used in the tasks of analyzing documents collected by a search robot, tracking application installation data in the Android Market, Google Books services and spam analysis. <br><br>  In 2012, Google opened access to Dremel for developers through the <em>Google BigQuery</em> service [14]. <br><br><h2>  Data model </h2><br>  Like many systems of this class, Dremel has the ability to <em>scale to several thousand nodes</em> , runs on the <em>commodity-equipment</em> , provides <em>reliable data storage</em> , <em>fault tolerance</em> and <em>replication</em> , works with <em>immutable data</em> and has its own <em>SQL-like query language</em> . <br><br>  Dremel uses the <a href="http://0xcode.in/gfs">Google File System</a> distributed file system for data storage, and <em>tablet</em> is the storage unit. <br><br>  But, without a doubt, the key innovation of Google Dremel is <em>the data model</em> , which in [4] sounds like ‚Äú <em>nested columnar storage</em> ‚Äù, or, in translation, a <em>column storage of nested data</em> . <br><br>  Basic principles of nested columnar storage: <em>data whose schema is explicitly defined is stored in a column-striped storage repository along with its associated data.</em> <br><br>  Let us examine the advantages and disadvantages of such a choice. <br><br>  <em>Column storage</em> allows you to read large amounts of data as well as efficiently compress (since data of the same type is stored in one place) compared with the storage oriented to line-by-line data storage.  On the other hand, writing to column stores is more expensive than row-striped storages, and supporting transactional changes is not a trivial task. <br><br>  <em>Storing data together with associated (including nested) data</em> as well as the column storage scheme allows you to increase the speed of reading data.  At the same time, this storage method implies some data redundancy and, as a result, the need to solve the problem of consistency between different copies of this data. <br><br>  Google engineers solved this problem as follows: Dremel works with immutable data, and the redundancy problem is solved by introducing two additional levels for each column: the <em>definition level</em> and the <em>repetition level</em> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/96f/0ce/2da/96f0ce2daac5422108c4874fa7ffe528.png"><br>  Source of illustration [4, Figure 2] <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f37/719/471/f3771947106921110e2078604db2d6f2.png"><br>  Source of illustration [4, Figure 3] <br><br>  Each column contains a set of blocks.  In turn, each block represents <em>compressed data</em> and <em>integer values ‚Äã‚Äãof the definition level and the repetition level</em> .  Thus, Dremel, knowing everything about the structure and location of the data that is necessary to fulfill the request, can obtain the necessary information ‚Äú <em>on the spot</em> ‚Äù (in the terminology [4] - ‚Äúin situ‚Äù). <br><br>  The coding of each column block using the &lt;value, repetition_level, definition_level&gt; scheme leads to the fact that <em>the storage structure already contains an assembly algorithm, which is a finite state machine,</em> where: <br><ul><li>  <em>the set of states</em> - the set of columns into which the document is divided; <br></li><li>  <em>transitions</em> are repetition levels. <br></li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/ffd/4eb/712/ffd4eb712d474a312b075a30c6469dec.png"><br>  Source of illustration [4, Figure 4] <br><br><h2>  Execution of requests </h2><br>  To execute requests, Dremel uses a multi-level serving tree architecture: the root server receives a request from the client for execution, reads the required tablet metadata and sends (route) requests to the next levels of the tree.  And so on until the request reaches the leaves of the service tree.  <em>The leaves of the tree</em> interact directly with GFS to obtain the necessary data. <br><br>  So different requests for Dremel are executed at the same time, <em>Query dispatcher</em> is engaged in scheduling requests based on their priority and the best load balancing.  Query dispatcher is also responsible for handling failures at the tablet level, which became unavailable during the execution of the query and the ‚Äúmeleen‚Äù tablets. <br><br>  An interesting solution is also the fact that the <em>result of the query will not be returned after 100% of the records have been processed,</em> but earlier - in [4] the figure is 98%, as the most typical.  On the one hand, this saves Dremel from waiting for the completion of the ‚Äúslow‚Äù leaves of the query tree;  on the other hand, it leads to some error in the final result, which is quite acceptable for OLAP-systems and hardly acceptable in OLTP-systems. <br><br><h2>  Experimental results </h2><br>  As a result of experiments, the initial data of which is <em>3K computational nodes, 85 billion lines</em> - Dremel fulfills requests for orders faster than MapReduce algorithms running on both record-oriented repositories and columnar-oriented repositories. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/39e/441/e3d/39e441e3dd50ff5557b4716d5a0c0607.png"><br>  Source of illustration [4] <br><br>  In addition, in [4] it is stated that during the experiments, some <em>table scanning speed</em> on some queries directly approached <em>100 billion records per second</em> . <br><br><h2>  Impact on Open Source </h2><br>  The Open Source analogues of Dremel include <em>Cloudera Impala</em> , <em>Apache Drill</em> , <em>Parquet</em> (Twitter). <br><br><h2>  List of sources* </h2><br>  [4] Sergey Melnik, Andrey Gubarev, Jing Jing Long, Geoffrey Romer, et al.  <a href="http://static.googleusercontent.com/media/research.google.com/ru//pubs/archive/36632.pdf">Dremel: Interactive Analysis of Web-Scale Datasets</a> .  Proceedings of the VLDB Endowment, 2010. <br>  [14] <a href="https://developers.google.com/bigquery/">Google BigQuery</a> - Google Developers. <br>  * <a href="https://habr.com/post/206972/">A complete list of sources</a> used to prepare the cycle. <br><br>  Dmitry Petukhov <br>  MCP, <s>PhD Student</s> , IT Zombies, <br>  caffeinated man instead of red blood cells. </div><p>Source: <a href="https://habr.com/ru/post/207234/">https://habr.com/ru/post/207234/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../207220/index.html">December distribution of servers: voting</a></li>
<li><a href="../207224/index.html">Is it possible to centrally manage language settings?</a></li>
<li><a href="../207228/index.html">How to raise the average check?</a></li>
<li><a href="../207230/index.html">Android 4.3 for Z series devices</a></li>
<li><a href="../207232/index.html">Cards for all, for nothing</a></li>
<li><a href="../207236/index.html">Launch of the project GeeksLab and the announcement of the conference ‚ÄúHappu New Front-End! On the frontend in a new way! "January 18 in Odessa</a></li>
<li><a href="../207238/index.html">Download Reveal SDK with any applications.</a></li>
<li><a href="../207242/index.html">Ultra-high-frequency power supplies for laptops: 4 times smaller and 6 times lighter than usual</a></li>
<li><a href="../207250/index.html">Escalation alerts. Typical scenarios</a></li>
<li><a href="../207252/index.html">Hooray, Alan Turing amnestied by the Queen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>