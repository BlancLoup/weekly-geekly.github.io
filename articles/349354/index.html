<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Develop isomorphic RealWorld applications with SSR and Progressive Enhancement. Part 2 - Hello World</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous part of the tutorial, we learned what a RealWorld project is, defined the objectives of the tutorial, chose a technology stack and wro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Develop isomorphic RealWorld applications with SSR and Progressive Enhancement. Part 2 - Hello World</h1><div class="post__text post__text-html js-mediator-article">  In the <a href="https://habrahabr.ru/post/348964/">previous part of the</a> tutorial, we learned what a <b>RealWorld</b> project is, defined the objectives of the tutorial, chose a technology stack and wrote a simple <b>Express</b> web server as the basis for an isomorphic frontend. <br><br>  In this part, we will finish the server part and write an isomorphic ‚ÄúHello World‚Äù in <b>Ractive</b> , as well as collect all this using a <b>Webpack</b> . <br><br><img src="https://habrastorage.org/webt/ts/sa/tr/tssatr_ci6h_kkxhoxc-_vvqtrm.png"><br><a name="habracut"></a><br>  Thanks in advance to all those who continue to read this tutorial!  If you are really seriously interested in the topic of universal web applications, then you should also familiarize yourself with the series of articles on the same topic <a href="https://habrahabr.ru/post/349136/">‚ÄúUniversal React + Express Applications‚Äù</a> .  This will be especially interesting for those who like to write a lot of code (I do not). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Disclaimer</b> <div class="spoiler_text">  This tutorial is intended primarily for frontend-developers of the middle and higher levels.  Who are familiar with modern development tools and know what SPA and isomorphism are. <br><br>  As part of the tutorial, questions of installing npm-modules, introductory acquaintance with webpack, working with the command line or other basic things for today will NOT be revealed.  I presume that for most readers routine operations for setting up the environment and working with development tools, etc.  already familiar and debugged. <br></div></div><br><h2>  We finish the server </h2><br><img src="https://habrastorage.org/webt/nv/lx/-y/nvlx-ybseaay9388mcnufmzwfly.jpeg"><br><br><h3>  Proxy requests </h3><br>  So, based on the selected ‚Äúhigh-level‚Äù architecture described in the first part, it is necessary to organize the proxying of requests to the backend server through the front-end. <br><br><div class="spoiler">  <b class="spoiler_title">Why so</b> <div class="spoiler_text">  In the comments to the first part of the tutorial, a reasonable question was asked - why proxy requests to the backend?  From the point of view of the isomorphic approach, this is not necessarily the case.  Especially if you like difficulties and solving nonstandard problems, in non-obvious ways. <br><br>  However, practice shows that this method is the fastest, most convenient and painless solution of a number of issues and problems of isomorphism, which will be discussed further. <br><br>  In addition, proxying opens up some additional features: <br><br><ul><li>  Interception of client attacks, such as XSS / CSRF / etc .; </li><li>  Hiding the backend of the server + there is no need to enable CORS on the backend; </li><li>  Isomorphic caching capabilities for data and queries; </li><li>  More secure work with sessions / tokens / so forth; </li><li>  Interception of requests / responses and making point changes; </li><li>  API point adaptation for client's needs; </li><li>  Change of authorization methods; </li><li>  Simplified implementation of asynchronous ‚Äústateful‚Äù functionality over synchronous ‚Äústateless‚Äù backends; </li><li>  Work on top of several backends (or microservices); </li></ul><br>  Etc.  etc. <br></div></div><br>  To do this, first examine the <a href="https://github.com/gothinkster/realworld/tree/master/api">specification for the REST API</a> project <b>RealWorld</b> .  The API itself is located at: <b><a href="https://conduit.productionready.io/api">conduit.productionready.io/api</a></b> <br><br>  Since I don‚Äôt like to write extra code, I won‚Äôt reinvent the wheel and use the <a href="http-proxy">express-http-proxy</a> module.  This module is able not only to proxy http-requests, but also provides a number of ‚Äúhooks‚Äù for different stages of this process, which, obviously, we still need. <br><br>  First, we will write a simple json-config for our API, where we will define the URL where to proxy, as well as some additional settings. <br><br>  <b>./config/api.json</b> <br><br><pre><code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"backendURL"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://conduit.productionready.io"</span></span>, <span class="hljs-string"><span class="hljs-string">"timeout"</span></span>: <span class="hljs-number"><span class="hljs-number">3000</span></span>, <span class="hljs-string"><span class="hljs-string">"https"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre> <br>  <b>‚ÄúHttps‚Äù: true</b> means that even if the original request was made via http, it should be proxied to https.  Convenient when working with localhost. <br><br>  In the first part I prepared a special <b>‚Äúapi middleware‚Äù</b> for proxying requests.  It's time to write it: <br><br>  <b>./middleware/api.js</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> proxy = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express-http-proxy'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> config = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../config/api.json'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> (req, res, next) =&gt; { proxy(config.backendURL, { <span class="hljs-attr"><span class="hljs-attr">https</span></span>: config.https, <span class="hljs-attr"><span class="hljs-attr">timeout</span></span>: config.timeout })(req, res, next); };</code> </pre><br>  Perhaps this is enough for now.  Already, all requests for <b>/ api / *</b> frontend will be proxied to the backend server.  In other words, if you request <b>GET / api / articles</b> from the front-end server, the answer will be JSON of the form: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"articles"</span></span>:[...], <span class="hljs-string"><span class="hljs-string">"articlesCount"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span> }</code> </pre><br>  Since we plan to work not only with GET requests, but also with all possible REST verbs (POST / PUT / DELETE), as well as execute requests without JS on the client (i.e. by means of html forms), Make a couple of changes to the main web server file from the first part: <br><br>  <b>./server.js</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> methodOverride = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'method-override'</span></span>);</code> </pre><br><pre> <code class="javascript hljs">server.use(express.json()); server.use(express.urlencoded({ <span class="hljs-attr"><span class="hljs-attr">extended</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> })); server.use(methodOverride(<span class="hljs-string"><span class="hljs-string">'_method'</span></span>));</code> </pre><br>  Please note that we will parse the request body both in <b>json</b> (via ajax) and <b>urlencoded</b> (submit forms).  The <b>method-override</b> module will overwrite the http request method with the one specified in the special URL Query parameter <b>_method</b> .  This is due to the fact that html forms only support the GET and POST methods.  It will work like this: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/something?_method=PUT"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"POST"</span></span></span><span class="hljs-tag">&gt;</span></span> ..... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  If JS is disabled on the client and the form has been accepted, this module will automatically replace the original POST for us with PUT and the proxy will receive a valid REST verb for further proxying.  Simply and without straining. <br><br><div class="spoiler">  <b class="spoiler_title">About rewriting the http method</b> <div class="spoiler_text">  An interesting fact is that some ‚Äúgurus‚Äù of RESTful services <a href="https://www.slideshare.net/apigee/restful-api-design-second-edition/87">suggest</a> using a similar query parameter when designing REST API on backends.  Well, like, we want to think about those clients of our API that support only a limited list of HTTP methods. <br><br>  However, in fact, this is relevant only for browser html forms.  In this case, it is not very reasonable to support such a narrow case on the backend, which is used by various types of clients.  Most of which do not need this feature.  At the same time, the use of this technology within the framework of the frontend-north is quite justified for itself, and most importantly does not affect the interests of other types of clients.  This is how it is. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Full server.js code</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>), helmet = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'helmet'</span></span>), compress = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'compression'</span></span>), cons = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'consolidate'</span></span>), methodOverride = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'method-override'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> app = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./middleware/app'</span></span>), api = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./middleware/api'</span></span>), req = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./middleware/req'</span></span>), err = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./middleware/err'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> config = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./config/common'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> server = express(); server.engine(<span class="hljs-string"><span class="hljs-string">'html'</span></span>, cons.mustache); server.set(<span class="hljs-string"><span class="hljs-string">'view engine'</span></span>, <span class="hljs-string"><span class="hljs-string">'html'</span></span>); server.use(helmet()); server.use(express.json()); server.use(express.urlencoded({ <span class="hljs-attr"><span class="hljs-attr">extended</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> })); server.use(methodOverride(<span class="hljs-string"><span class="hljs-string">'_method'</span></span>)); server.use(compress({ <span class="hljs-attr"><span class="hljs-attr">threshold</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> })); server.use(express.static(<span class="hljs-string"><span class="hljs-string">'dist'</span></span>)); server.use(req()); server.all(<span class="hljs-string"><span class="hljs-string">'/api/*'</span></span>, api()); server.use(app()); server.use(err()); server.listen(config.port);</code> </pre><br></div></div><br>  As a result, we have a full-fledged proxy requests for the backend, as well as support for requests from html-forms. <br><br><img src="https://habrastorage.org/webt/ad/k6/8f/adk68fjrn-cqxxio6kk2tujv0ci.jpeg"><br><br><h3>  Initial state problem </h3><br>  At once I want to make a reservation, here by ‚Äúinitial state‚Äù I mean not the initial state of the application data, but the set of input parameters with which the application should run.  For each specific project, a similar set of parameters will be different, or it may be absent altogether.  Base case - the presence or absence of authorization. <br><br>  Most likely, the initial state was set by your user during the previous session (for example, logged into the account) and after the user returned, he expects to see the application with this initial state (logged in). <br><br>  The standard SPA is first loaded onto the page, the scripts are launched, and then requests for data are made.  At this point, the script can get the initial state parameters based on the browser data or something else, and only then make requests to the API. <br><br>  Unlike SPA, an isomorphic application has no, relatively speaking, a ‚Äúloader‚Äù.  Isomorphic application in this part looks more like an ordinary website.  In other words, the initial state must be received at the time of the first synchronous request so that the page rendered on the server fully corresponds to the state that the user expects.  Of course, there are cases when developers are lazy and then we see the server rendering a page with some default state, then scripts are run on the client and the client does all the work again.  This is not the right approach, and the manifesto of this project is clearly written - no crutches (Section 7)! <br><br>  This question is being solved, perhaps, by the only available method at the moment - with the help of cookies (I think many immediately guessed when they saw the poster).  Yes, indeed, cookies are actually the only official way to transfer the initial state between several synchronous requests to the server.  Of course, if we are talking about the browser. <br><br>  Well, since we are well aware that in terms of the storage of cookies, it‚Äôs not very suitable (only 4Kb), and most importantly, we don‚Äôt understand exactly which parameters of the initial state we will eventually have to use, and the hand stretches to the sessions!  Thus, ordinary sessions, when a session_id (sid) is recorded in a cookie, and a whole pile of data associated with this identifier is stored on the server. <br><br>  I think in general terms it is clear why we need it and, again, I will not invent anything here.  I will take the classic <a href="https://www.npmjs.com/package/express-session">express-session</a> , nadpiguyu little of its parameters and we get quite a working mechanism without any difficulties. <br><br>  In the main config, add the ‚Äúsession‚Äù object with the settings for the module. <br><br>  <b>./config/common.json</b> <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"port"</span></span>: <span class="hljs-number"><span class="hljs-number">8080</span></span>, <span class="hljs-string"><span class="hljs-string">"session"</span></span>: { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"_sid"</span></span>, <span class="hljs-string"><span class="hljs-string">"secret"</span></span>: <span class="hljs-string"><span class="hljs-string">"ntVA^CUnyb=6w3HAgUEh+!ur4gC-ubW%7^e=xf$_G#wVD53Cgp%7Gp$zrt!vp8SP"</span></span>, <span class="hljs-string"><span class="hljs-string">"resave"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"rolling"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"saveUninitialized"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"cookie"</span></span>: { <span class="hljs-string"><span class="hljs-string">"httpOnly"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"secure"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"sameSite"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } } }</code> </pre><br>  Several key settings for our cookies - you should always set <b>httpOnly</b> and <b>sameSite</b> .  When switching to SSL, it will be possible to activate also <b>secure</b> (the cookie will be sent only when working via https). <br><br>  Add this module to the web server file: <br><br>  <b>./server.js</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> session = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express-session'</span></span>);</code> </pre><br><pre> <code class="javascript hljs">server.use(session(config.session));</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Full server.js code</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>), helmet = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'helmet'</span></span>), compress = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'compression'</span></span>), cons = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'consolidate'</span></span>), methodOverride = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'method-override'</span></span>), session = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express-session'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> app = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./middleware/app'</span></span>), api = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./middleware/api'</span></span>), req = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./middleware/req'</span></span>), err = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./middleware/err'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> config = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./config/common'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> server = express(); server.engine(<span class="hljs-string"><span class="hljs-string">'html'</span></span>, cons.mustache); server.set(<span class="hljs-string"><span class="hljs-string">'view engine'</span></span>, <span class="hljs-string"><span class="hljs-string">'html'</span></span>); server.use(helmet()); server.use(session(config.session)); server.use(express.json()); server.use(express.urlencoded({ <span class="hljs-attr"><span class="hljs-attr">extended</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> })); server.use(methodOverride(<span class="hljs-string"><span class="hljs-string">'_method'</span></span>)); server.use(compress({ <span class="hljs-attr"><span class="hljs-attr">threshold</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> })); server.use(express.static(<span class="hljs-string"><span class="hljs-string">'dist'</span></span>)); server.use(req()); server.all(<span class="hljs-string"><span class="hljs-string">'/api/*'</span></span>, api()); server.use(app()); server.use(err()); server.listen(config.port);</code> </pre><br></div></div><br>  Now, among other things, we have a mechanism for storing and transferring the initial state of the application between several synchronous requests.  Since this task is entirely due to the peculiarities of working with the browser, the front-end server is the best place for such things.  If we did such things on the backend, it could affect other types of clients (for example, mobile), for which there is no need for such tricks.  This is another advantage of universal web applications - we get a secure environment (front-end server) in which we can perform front-dependent tasks without sacrificing security and unnecessarily ‚Äúclog up‚Äù the backend with such things.  This is especially true when the backend works with many types of clients. <br><br><h2>  Hello world </h2><br><img src="https://habrastorage.org/webt/9o/ag/h3/9oagh3esvv-bkj9mv3auduu55de.jpeg"><br><br>  Well, as long as it looks pretty simple, but what the hell do you say, where is isomorphism?  Everything will be, but for a start, let's deal with such a part of it as <b>Server-side rendering (SSR)</b> . <br><br>  To begin, write a simple isomorphic ‚Äúhello world‚Äù using <a href="https://ractive.js.org/">RactiveJS</a> . <br><br>  <b>./src/app.js</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Ractive = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'ractive'</span></span>); Ractive.DEBUG = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">process.env.NODE_ENV === </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'development'</span></span></span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Ractive</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DEBUG_PROMISES</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Ractive</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DEBUG</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Ractive</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">defaults</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">enhance</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">true</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Ractive</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">defaults</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">lazy</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">true</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Ractive</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">defaults</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sanitize</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">true</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">options</span></span></span><span class="hljs-function"> = { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">el</span></span></span><span class="hljs-function">: '#</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">app</span></span></span><span class="hljs-function">', </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">template</span></span></span><span class="hljs-function">: `&lt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">div</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function">="</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">msg</span></span></span><span class="hljs-function">"&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Static</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">text</span></span></span><span class="hljs-function">! + {{</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">message</span></span></span><span class="hljs-function">}} + {{</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fullName</span></span></span><span class="hljs-function">}}&lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">div</span></span></span><span class="hljs-function">&gt;`, </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">: { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">message</span></span></span><span class="hljs-function">: '</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Hello</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">world</span></span></span><span class="hljs-function">', </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">firstName</span></span></span><span class="hljs-function">: '</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Habr</span></span></span><span class="hljs-function">', </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">lastName</span></span></span><span class="hljs-function">: '</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">User</span></span></span><span class="hljs-function">' }, </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">computed</span></span></span><span class="hljs-function">: { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fullName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">return</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">this</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">get</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'firstName'</span></span></span></span></span><span class="hljs-function">) + ' ' + </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">this</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">get</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'lastName'</span></span></span></span></span><span class="hljs-function">); } } }; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">module</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">exports</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Ractive(options);</code> </pre><br>  This file is the entry point of our isomorphic application.  Let's take a closer look at it. <br><br>  <b>RactiveJS</b> exports the constructor of the same name with which you can create Ractive-instances, as well as Ractive-components (more on this in the following sections).  To many, this approach may remind <a href="https://vuejs.org/v2/guide/instance.html">VueJS</a> and this is no <a href="https://vuejs.org/v2/guide/instance.html">accident</a> .  In fact, <b>Ractive</b> is one of the prototypes for <b>Vue</b> and their api are still very similar. <br><br>  But let‚Äôs go back to the code and first find out exactly which <a href="https://ractive.js.org/api/">static properties of the</a> constructor I set for this application.  First, it is <b>Ractive.DEBUG</b> and <b>Ractive.DEBUG_PROMISES</b> with which we <b>enable</b> or <b>disable</b> informational error messages depending on the current environment. <br><br>  Next comes the <b>Ractive.defaults.enhance</b> flag, which activates one of the key aspects of isomorphism ‚Äî reuse of markup resulting from <b>SSR</b> on the client side.  This is what is often called the incomprehensible term <b>hydrate</b> . <br><br><div class="spoiler">  <b class="spoiler_title">Theory of hydrate</b> <div class="spoiler_text">  In simple terms, the trick is that after the application is initialized on the client, it may ‚Äúwant‚Äù to re-render all the markup instead of the markup that came from the server (SSR).  Not that this is super bad for isomorphism - we still get SEO support and many other goodies.  However, in any case, this is highly irrational. <br><br>  Therefore, it is important not only to be able to do <b>SSR</b> (many people can do this now).  It‚Äôs good when your framework can do this ‚Äúhydration‚Äù, i.e.  can analyze the current markup and data in order to understand that the result of repeated rendering of the application or its individual components will be the same markup, which means that it is not necessary (or necessary, but partially).  Next, simply ‚Äúliven up‚Äù the existing markup, i.e.  ‚ÄúHang‚Äù all the necessary event-licensers, handlers or whatever else he needs. <br><br>  All this is relatively recent with all the representatives of the ‚Äúbig three‚Äù.  <b>Ractive</b> learned this even earlier, which is why he uses his own term <b>‚Äúenhance‚Äù</b> , instead of the one entered with the <b>‚Äúhydrate‚Äù</b> reaction.  Just then there was still no such term))) <br></div></div><br><pre> <code class="javascript hljs">Ractive.defaults.enhance = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;</code> </pre><br>  By default, this flag is set to <b>false</b> and this line of code activates this option for all <b>Ractive</b> components at <b>once</b> .  In other words, with a single line of code, you can make your application on <b>Ractive</b> re-use markup from the server.  At the same time, if a separate component does not suddenly require "hydration", it can be turned off locally through its <a href="https://ractive.js.org/api/">options</a> . <br><br>  Finally, two more flags that I always put on: <br><br><ul><li>  <b>Ractive.defaults.sanitize</b> allows you to cut <a href="https://ractive.js.org/api/">unsafe html tags</a> during template parsing. </li><li>  <b>Ractive.defaults.lazy</b> tells the framework to use late DOM events (change, blur) instead of immediately executed (keyup, keydown) for <b>two-way bindings</b> (yes, double-binding taxis). </li></ul><br><div class="spoiler">  <b class="spoiler_title">About the two-way bindings</b> <div class="spoiler_text">  All the "two-way bindings" of the haters and the "one-way data flow" users will ask to refrain from holivar in the comments.  It is not a question of religion.  If you think that double-binding of data for you personally is a threat, then do not use it and you will be right.  You never have to put yourself in danger in vain. <br><br>  In my applications, I, as a rule, actively use double binding where necessary and convenient, and so far I have not experienced any serious problems with it.  Fortunately, <b>Ractive is</b> not a very religious framework and does not enter into the developer any of its own moral and ethical principles.  The approach that Ractive uses is perfectly described on the main page of his site: <br><blockquote>  Unlike other frameworks, <b>Ractive works for you</b> , not the other way around.  It doesn‚Äôt want you to use it.  It also adapts to the approach.  You're not locked in a framework-specific way of thinking.  If you‚Äôre on your own, you‚Äôll be able to find out about <br></blockquote>  If you hate or are afraid of double binding, this problem is solved in <b>Ractive in</b> one line: <br><br><pre> <code class="javascript hljs">Ractive.defaults.twoway = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;</code> </pre><br>  After that, all your components will lose the possibility of double binding, unless of course you want to enable it for a particular component ( <b>twoway: true</b> in the options) or even a specific input field (twoway <b>directive = ‚Äútrue‚Äù</b> ).  As a rule, it is convenient. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">An interesting case with lazy</b> <div class="spoiler_text">  Could not resist.  The fact is that <b>lazy</b> can be used not only globally and locally for each component, but also pointwise as a <a href="https://ractive.js.org/api/">directive</a> input field.  In addition, <b>lazy</b> can accept not only Boolean, but also a number - the number of milliseconds for the delay. <br><br>  Using this remarkable property, you can, for example, very quickly and succinctly solve one of the frequently encountered tasks of web development - the search query string: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{q}}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lazy</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1000"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br>  <a href="https://ractive.js.org/playground/">Working example</a> <br></div></div><br>  As a result, I create an object with options for the application instance.  Where I inform in what existing DOM element to render the application ( <b>el</b> ), I define some kind of test pattern ( <b>template</b> ), while in the form of a string.  I define an object with data ( <b>data</b> ) and a single calculated property ( <b>fullName</b> ). <br><br>  It looks pretty stupid, because for now we are writing only ‚ÄúHello world‚Äù and its goal is to test <b>SSR</b> and ‚Äúhydration‚Äù on the client.  Later I will tell you how we can check it. <br><br>  Now we will write the server <b>‚Äúapp middleware‚Äù</b> , into which all requests that do not fall into the proxy fall. <br><br>  <b>./middleware/app.js</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> run = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../src/app'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> (req, res, next) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> app = run(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> meta = { <span class="hljs-attr"><span class="hljs-attr">title</span></span>: <span class="hljs-string"><span class="hljs-string">'Hello world'</span></span>, <span class="hljs-attr"><span class="hljs-attr">description</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">keywords</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span> }, content = app.toHTML(), styles = app.toCSS(); app.teardown(); res.render(<span class="hljs-string"><span class="hljs-string">'index'</span></span>, { meta, content, styles }); };</code> </pre><br>  Everything is straightforward.  If you noticed, the main application file (./src/app.js) exports a function that returns a new Ractive instance, i.e.  essentially a new application object.  This is not very important when the code is executed on the client - we will most likely not create more than one instance of the application within the tab.  However, to execute code on the stateful nodejs server, it is extremely important to be able to create a new application object for each synchronous request.  I think this is obvious. <br><br>  So, at the time of the request, we are creating a new application object.  Create an object with meta tags (statically so far), and then 2 lines of code with the most notorious <b>SSR</b> : <br><br><ul><li>  <b>app.toHTML ()</b> - renders the current state of the application in a string; </li><li>  <b>app.toCSS ()</b> - collects all the ‚Äúcomponent specific‚Äù styles already broken by namespaces and also returns them as a string. </li></ul><br>  Just like that, it works in <b>Ractive</b> .  And yes, the functionality of <a href="https://ractive.js.org/api/">component</a> <a href="https://ractive.js.org/api/">styles is</a> already available from the box. <br><br>  Next, I destroy the current application instance by calling the <b>teardown ()</b> method and rendering the <b>"./views/index.html"</b> server template with the received values ‚Äã‚Äãwhile sending a response.  That's the whole great and terrible <b>SSR</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hu/gx/bf/hugxbfemncqsmmc0d3wyifzdqgm.jpeg"></div><br><h3>  Server Templates </h3><br>  Now a little "whiskers."  So, we have a daddy <b>"./views"</b> where the server templates will lie and we expect it to have the very ‚Äúsingle-page‚Äù <b>index.html</b> in which we will render our wonderful isomorphic application.  However, we will not write <b>index.html</b> . <br><br>  That's because the final client bundles generated by the <b>Webpack</b> must be written at build time with its help.  So you have to create a <i>template for the template</i> !  ;-) <br><br>  <b>./views/_index.html</b> <br><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!doctype html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dir</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ltr"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"X-UA-Compatible"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"IE=edge"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"description"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ meta.description }}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"keywords"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ meta.keywords }}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewport"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width=device-width, initial-scale=1.0, minimum-scale=1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>{{ meta.title }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"//code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"//fonts.googleapis.com/css?family=Titillium+Web:700|Source+Serif+Pro:400,700|Merriweather+Sans:400,700|Source+Sans+Pro:400,300,600,700,300italic,400italic,600italic,700italic"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"//demo.productionready.io/main.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"shortcut icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image/x-icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/favicon.ico"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image/png"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/img/favicon.png"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"apple-touch-icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/img/favicon.png"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"manifest"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/manifest.json"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"><span class="undefined"> {{&amp; styles }} </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"app"</span></span></span><span class="hljs-tag">&gt;</span></span> {{&amp; content }} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.msgEl = </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.getElementById(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'msg'</span></span></span><span class="javascript">); </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  There is also nothing special here, just a full-fledged HTML file, with a doctype, all sorts of meta tags, links to style files and fonts that <b>RealWorld</b> provides, and so on.  Here we see how the meta tags for <b>title</b> , <b>description</b> and <b>keywords</b> will be templated.  Also note that component styles are simply placed on the page in a style tag.  And of course, our rendered application is placed in the element with the corresponding identifier.  It is in this html element that the application will search and ‚Äúhydrogenate‚Äù the markup on the client (the same <b>#app</b> tag, which is usually empty at the classic SPA approach) <br><br>  After building the client code, <b>Webpack</b> will register all the bundle files in the connection sequence and with the names provided by the project and its config at the end of this file (immediately before the closing <b>body</b> tag), and also generate the final <b>index.html</b> (in the next section). ).  This is how it is. <br><br><img src="https://habrastorage.org/webt/v2/e3/cy/v2e3cywx7i3h9q4bg0gtjfrrmww.jpeg"><br><br><h3>  Webpack </h3><br>  I promised that I would not use any specific tools for writing an isomorphic application.  The same applies to <b>Webpack</b> and its configs. <br><br>  Therefore, I will simply take the existing webpack configuration that I used for the previous demo project (in more detail in the first part) and will use it in this form as it is.  Moreover, this config file also got into that demo project from some other project and was practically not finalized.  There even remained rudiments, which are essentially not needed in these projects, but they do not interfere and I am too lazy to cut them out.  It works and fine. <br><br>  Unlike the absolute majority of tutorials and starters-whales on an isomorphic topic, I will not write separate webpack-configs for the client and server.  Moreover, I won‚Äôt build bundles for the server at all.  All application files on the server will work without any manipulations with them. <br><br><div class="spoiler">  <b class="spoiler_title">Why is that</b> <div class="spoiler_text">  The short answer is: for the server, the build has no practical meaning. <br><br>  More specifically: I often have to work with many different environments, and the only one that is completely under my control is the front-end server.  Therefore, I used to write my code based on the capabilities of the environment controlled by me and on the server I do not need all kinds of transpilers, minification of the code, and especially assembly of the code in bundles.  However, all this is necessary for an indefinite list of uncontrolled environments, so the client code is collected by the webpack with all the frills. <br></div></div><br>  As I said, learning how to work with <b>Webpack</b> is beyond the scope of this tutorial.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">My task is to show that you can write universal web applications without any specific configs. </font><font style="vertical-align: inherit;">And yet I will pay attention to some key points. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The entry point is with us </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">./src/app.js</font></font></b> <br><br><pre> <code class="javascript hljs"> entry: { <span class="hljs-attr"><span class="hljs-attr">app</span></span>: [ path.resolve(__dirname, <span class="hljs-string"><span class="hljs-string">'src/app'</span></span>), ] },</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bundles are generated in the folder </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">./dist</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and referred to the following rules:</font></font><br><br><pre> <code class="javascript hljs"> output: { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: path.resolve(__dirname, <span class="hljs-string"><span class="hljs-string">'dist'</span></span>), <span class="hljs-attr"><span class="hljs-attr">publicPath</span></span>: <span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-attr"><span class="hljs-attr">filename</span></span>: <span class="hljs-string"><span class="hljs-string">`[name]-</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${ VERSION }</span></span></span><span class="hljs-string">.bundle.[hash].js`</span></span>, <span class="hljs-attr"><span class="hljs-attr">chunkFilename</span></span>: <span class="hljs-string"><span class="hljs-string">`[name]-</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${ VERSION }</span></span></span><span class="hljs-string">.bundle.[chunkhash].js`</span></span>, },</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> All code, except the 3rd-party modules, is passed through Babel: </font></font><br><br><pre> <code class="javascript hljs"> { <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.(js)$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">exclude</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/(node_modules|bower_components)/</span></span>, <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-string"><span class="hljs-string">'babel-loader'</span></span>, },</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The most ambiguous piece of the config: </font></font><br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WrapperPlugin({ <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\app(.*).js$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">header</span></span>: <span class="hljs-string"><span class="hljs-string">'(function(){"use strict";\nreturn\t'</span></span>, <span class="hljs-attr"><span class="hljs-attr">footer</span></span>: <span class="hljs-string"><span class="hljs-string">'\n})()();'</span></span> }),</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I used to use </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WrapperPlugin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> purely in order to apply a strict mode at once for the entire app bundle. </font><font style="vertical-align: inherit;">However, for universal web applications, I also use it to export an application as </font></font><a href="https://developer.mozilla.org/ru/docs/%25D0%25A1%25D0%25BB%25D0%25BE%25D0%25B2%25D0%25B0%25D1%2580%25D1%258C/IIFE"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IIFE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , i.e. </font><font style="vertical-align: inherit;">Immediately start the application as soon as the bundle is downloaded. </font><font style="vertical-align: inherit;">Unfortunately, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Webpack</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> does not support IIFE as a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libraryTarget</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Perhaps this is the only piece of the config that I added for the isomorphic project. </font><font style="vertical-align: inherit;">Although even he has no direct relation to it, because I could call the function manually. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next, I bring all 3rd-party modules into a separate bundle:</font></font><br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> webpack.optimize.CommonsChunkPlugin({ <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'vendor'</span></span>, <span class="hljs-attr"><span class="hljs-attr">minChunks</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ resource }</span></span></span><span class="hljs-function">) =&gt;</span></span> ( resource !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span> &amp;&amp; resource.indexOf(<span class="hljs-string"><span class="hljs-string">'node_modules'</span></span>) !== <span class="hljs-number"><span class="hljs-number">-1</span></span> ) }),</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As promised, I add bundles to the end of my </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">template for the template</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and generate </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">index.html</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HtmlWebpackPlugin({ <span class="hljs-attr"><span class="hljs-attr">template</span></span>: <span class="hljs-string"><span class="hljs-string">'./views/_index.html'</span></span>, <span class="hljs-attr"><span class="hljs-attr">filename</span></span>: <span class="hljs-string"><span class="hljs-string">'../views/index.html'</span></span>, <span class="hljs-attr"><span class="hljs-attr">minify</span></span>: { <span class="hljs-attr"><span class="hljs-attr">html5</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">hash</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">cache</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">showErrors</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, }),</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I clean the output directory and copy the static assets there: </font></font><br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CleanWebpackPlugin([<span class="hljs-string"><span class="hljs-string">'dist'</span></span>]), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CopyWebpackPlugin([{ <span class="hljs-attr"><span class="hljs-attr">from</span></span>: <span class="hljs-string"><span class="hljs-string">'assets'</span></span>, <span class="hljs-attr"><span class="hljs-attr">force</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }]),</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The remaining parts of the config are not of interest in the context of the project. </font><font style="vertical-align: inherit;">There are all sorts of </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UglifyJSPlugin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BundleAnalyzerPlugin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and other useful and not very things.</font></font><br><br><img src="https://habrastorage.org/webt/t3/1d/co/t31dcocmp76if6jwqtau49uzgee.jpeg"><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A little more server </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The two files announced in the first part of the tutorial were left without implementation: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äúreq middleware‚Äù</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äúerr middleware‚Äù</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The latest file is the usual </font></font><a href="http://expressjs.com/en/guide/error-handling.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Error-handling middleware</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> express. </font><font style="vertical-align: inherit;">With it, we will give a special page (./views/error.html) with purely server errors, or json, if a server error occurred during an ajax request. </font><font style="vertical-align: inherit;">While it will look something like this:</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> (err, req, res, next) =&gt; { res.status(<span class="hljs-number"><span class="hljs-number">500</span></span>); (req.accepts([<span class="hljs-string"><span class="hljs-string">'html'</span></span>, <span class="hljs-string"><span class="hljs-string">'json'</span></span>]) === <span class="hljs-string"><span class="hljs-string">'json'</span></span>) ? res.json({ <span class="hljs-attr"><span class="hljs-attr">errors</span></span>: { [err.name]: [err.message] } }) : res.render(<span class="hljs-string"><span class="hljs-string">'error'</span></span>, { err }); };</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The slightly strange format of the json-response is due to the fact that I immediately mimic </font></font><a href="https://github.com/gothinkster/realworld/tree/master/api"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the error format</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adopted in the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RealWorld</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> specification </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">For unification, so to speak. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The second </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äúreq middleware‚Äù</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will be left idle for now, but I'm sure it will come in handy.</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> (req, res, next) =&gt; next();</code> </pre><br><img src="https://habrastorage.org/webt/lq/ze/6l/lqze6loppwarqp-slssy7lkbbli.jpeg"><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Testing SSR and hydrate </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I‚Äôm sure that everything, so I‚Äôm aware of how to check the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSR</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> operation </font><font style="vertical-align: inherit;">- just open the " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">View page code</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " and see that the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#app</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tag </font><b><font style="vertical-align: inherit;">is</font></b><font style="vertical-align: inherit;"> not empty (as is usually the case in SPA), but contains the markup of our application. </font><font style="vertical-align: inherit;">Cool, with </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hydrate a</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> little more difficult. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The attentive eye could notice this incomprehensible piece of code, which, as it were, ‚Äúneither to the village nor the city‚Äù is present in our </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">index.html</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> server template </font><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.msgEl = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'msg'</span></span>);</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is with his help that we can check whether our ‚Äúhydration‚Äù is working or not. </font><font style="vertical-align: inherit;">Open the console and enter:</font></font><br><br><pre> <code class="javascript hljs">msgEl === <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'msg'</span></span>);</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then the item was not redrawn by client code. You can also experiment and set the value </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ractive.defaults.enhance = false;</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , rebuild and restart the application and make sure that in this case this check returns </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">false</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Which means the client code redrawn the markup. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Thus, both </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSR</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and ‚Äúhydration‚Äù work fine with both static and dynamic, as well as very dynamic values ‚Äã‚Äã(calculated properties). What was required to check. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font><a href="https://github.com/PaulMaly/realworld-starter-kit"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repository</font></font></b></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font><a href="https://ractive-realworld-example-app-dcardmtaqx.now.sh/"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demo</font></font></b></a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In the next part of this tutorial, we will solve two more key problems of isomorphic web applications:</font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isomorphic routing and navigation</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and</font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> repeated fetching and initial data state</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Despite the fact that I am going to devote a separate article to these issues, the solution itself will take us literally 5 lines of application code. </font><font style="vertical-align: inherit;">Do not switch!</font></font><br><br>  Thanks for attention!<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you like it, stay tuned! </font><font style="vertical-align: inherit;">All involved in the holiday and good luck! </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD: </font></font></b> <a href="https://habrahabr.ru/post/350428/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Developing an isomorphic RealWorld application with SSR and Progressive Enhancement. </font><font style="vertical-align: inherit;">Part 3 - Routing &amp; Fetching</font></font></a> </div><p>Source: <a href="https://habr.com/ru/post/349354/">https://habr.com/ru/post/349354/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../349340/index.html">Study history without studying books</a></li>
<li><a href="../349342/index.html">Instructor's Manual for the book ‚ÄúProgramming: Principles and Practice Using C ++‚Äù</a></li>
<li><a href="../349344/index.html">FastTrack Training. "Network Basics". Understanding Cisco Architecture. Eddie Martin December 2012</a></li>
<li><a href="../349348/index.html">The way to manage color schemes "Swift" "iOS" applications</a></li>
<li><a href="../349350/index.html">Setting up the development environment: coffee grounds (Part 2)</a></li>
<li><a href="../349356/index.html">Sum of iconCaption points in the cluster LoadingObjectManager</a></li>
<li><a href="../349358/index.html">Apache Ignite - database cache</a></li>
<li><a href="../349360/index.html">Bitcoin will not be a new digital money: about the drug business, transaction costs and gold</a></li>
<li><a href="../349362/index.html">SVG masks and wow effects: magic with simple words</a></li>
<li><a href="../349364/index.html">OOP without "O"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>