<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Adapting RoboVM for compiling for iOS from Windows / Linux</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It has been a year and a half since Microsoft closed the accidentally caught in a basket with Xamarin-th RoboVM. Already the official robovm.com has s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Adapting RoboVM for compiling for iOS from Windows / Linux</h1><div class="post__text post__text-html js-mediator-article"><p>  It has been a year and a half since Microsoft closed the accidentally caught in a basket with Xamarin-th RoboVM.  Already the official robovm.com has sunk into oblivion.  The last opensource version 1.8 has been forked by the MobiVM group and is supported <del>  on artificial respiration </del>  in working condition and now. </p><br><p>  RoboVM itself (I will call MobiVM fork here and hereafter) is closely intertwined with MacOSX and in its original form, being launched in Windows / Linux, it encounters a message that you can not write code, you cannot compile.  Meeting in the cmake files / network mention of Windows, took the challenge and decided to bring the matter to any result. </p><br><p>  It will take: </p><a name="habracut"></a><br><ul><li>  linux / windows version of the library llvm; </li><li>  linux / windows libimobiledevice version; </li><li>  linker; </li><li>  iOS sdk; </li><li>  codesign; </li><li>  surrogate set of utilities identical to that of Xcode; </li></ul><br><p>  With the first four points there were no special questions: </p><br><ul><li>  the llvm and libimobiledevice builds were already present in the RoboVM repository, and after the cmake files were adapted, the working libraries were obtained; </li><li> The linker was taken in the <a href="https://github.com/tpoechtrager/cctools-port">tpoechtrager / cctools-port</a> project and was initially operational.  However, it was only going to <code>cygwin</code> ; </li><li>  iOS sdk for academic purposes was obtained by the Xcode folder <code>backup</code> method from MacOSX; </li></ul><br><p>  For the proof of concept (or the quickest break-in), the source code was roughly chopped, everything was crossed on the knee, and the first executable file from Windows was linked back in August.  With the signing of the code is not so fun.  Attempting to sign everything with ambulance using <a href="https://github.com/saucelabs/isign">saucelabs / isign</a> did not lead to success: the utility could re-sign only already signed applications (with a dedicated LC_CODE_SIGNATURE), dragged in openssl dependencies and was generally written in the best python traditions.  It is worth noting that Apple‚Äôs codesign source code is not closed, but building it not under the Mac platform is complicated and full of unresolved dependencies. <br>  The solution to the problem came by itself: it was written own <del>  bicycle </del>  Java <a href="https://github.com/dkimitsa/robovm/tree/linuxwindows/compiler/codesign">codesign</a> .  Based on isign.  For a better understanding, a signature verifier was written first, and then, turning it 180 degrees, a signer was obtained. </p><br><p>  First success!  A simple application that does not require utilities from Xcode (also all the interfering parts of the code were mercilessly cut) was launched on the device.  October ended. </p><br><p>  Then the routine began: bringing the source code to life, carrying out platform-dependent code from the facade, forming a surrogate set of utilities (similar to Xcode), pain and tears of cross-compilation, and long assembly hours.  Diluted the routine in a peculiar way: ported the linker from <code>cygwin</code> to an assembly under <code>MinGW</code> well-known method - replacing the <code>posix</code> functionality with an accessible surrogate, which added new side effects, for example, dragged a path limit of 260 characters.  But now the whole bestiary was gathering in one place, from under Linux. </p><br><p>  The result is the following set: </p><br><ul><li>  <code>actool</code> from <a href="https://github.com/facebook/xcbuild">facebook / xcbuild</a> </li><li>  <code>plutil</code> from <a href="https://github.com/facebook/xcbuild">facebook / xcbuild</a> </li><li>  <code>xib2nib</code> (similar to <code>ibtool</code> ) with a big creak from a non-working <a href="https://github.com/dkimitsa/WinObjC/tree/xib2nib">Microsoft / WinObjC</a> (probably, it will not work in most cases) </li><li>  <code>codesign_allocate</code> , <code>lipo</code> , <code>nm</code> , <code>otool</code> , <code>strip</code> from the <a href="https://github.com/dkimitsa/cctools-port/tree/mingw">tpoechtrager / cctools-port</a> linker project </li><li>  <code>dsymutil</code> from LLVM5, had to be collected separately, because  <code>dsymutil</code> compiled by dsymutil for RoboVM turned out to be outdated and incompatible (v3.6) </li><li>  <code>file</code> utility for Windows.  The code RoboVM is used to determine the type of libraries.  It turned out to be easier to build under Windows than to change the logic. </li></ul><br><p>  The result was a fun project, currently limited to a license to use the iOS SDK outside of Apple hardware.  But you can also put Windows on the poppy and fully cross-compile from under it! </p><br><p>  References: </p><br><ul><li>  <a href="https://github.com/dkimitsa/robovm/tree/linuxwindows">RoboVM source code</a> </li><li>  <a href="https://github.com/dkimitsa/robovm-toolchain">toolchain collector</a> </li><li>  <a href="https://github.com/dkimitsa/cctools-port/tree/mingw">linker for assembly (mingw)</a> </li><li>  <a href="https://dkimitsa.github.io/2017/12/12/robovm-now-linux-windows/">compiled binaries and installation instructions</a> </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/345348/">https://habr.com/ru/post/345348/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345336/index.html">We spread the application in the App Store. Even if you are not a developer</a></li>
<li><a href="../345340/index.html">A story about how to create a repository and understand Redux</a></li>
<li><a href="../345342/index.html">What are dangerous social networks on your PC?</a></li>
<li><a href="../345344/index.html">Sending a request to the specified MS SQL Server databases of all the specified servers using available tools</a></li>
<li><a href="../345346/index.html">Nebraska problem</a></li>
<li><a href="../345350/index.html">Adding 3D objects to video</a></li>
<li><a href="../345356/index.html">Universal Dumper / Injector Unity3D (Mono, Android)</a></li>
<li><a href="../345358/index.html">Creating a Christmas animation with Wolfram Language</a></li>
<li><a href="../345362/index.html">Monte Carlo option premium calculation vs Black-Scholes formula</a></li>
<li><a href="../345364/index.html">We include support for TLS v1.3 in Nginx using the example of Debian 9</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>