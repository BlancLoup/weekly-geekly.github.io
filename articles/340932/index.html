<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>REST in the real world and the practice of hypermedia</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="How to build the architecture of the application, taking into account the specifics of REST? Was it with you that the word "REST" called any HTTP API ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>REST in the real world and the practice of hypermedia</h1><div class="post__text post__text-html js-mediator-article">  How to build the architecture of the application, taking into account the specifics of REST?  Was it with you that the word "REST" called any HTTP API indiscriminately - and how to convey the true meaning of this term?  How to show that the advantages of REST manifest themselves in large long-term projects, but for a small utility it is better to take something simpler?  These and other burning issues are covered by Dylan Beattie in the report ‚ÄúReal world REST and Hands-On Hypermedia‚Äù. <br><br>  Dylan is a systems architect and developer who has managed to participate in many projects in his life, from small websites to huge distributed systems;  from Legacy with a twenty-year history to the latest developments.  He now works as an architect in <a href="https://www.spotlight.com/">Spotlight</a> and is engaged in solving complex problems in modern distributed systems.  Creating the right, beautiful, and efficient HTTP API is part of his job, and he really knows a lot about them. <br><br>  You will be able to meet with Dylan live at the <a href="https://dotnext-moscow.ru/">DotNext Moscow 2017</a> conference, where he will arrive with a new report <a href="https://dotnext-moscow.ru/2017/msk/talks/4ptxeq6flmeeqekygw4iws/%2522">"Life, liberty and the pursuit of APIness: the secret to happy code</a> . <a href="https://dotnext-moscow.ru/2017/msk/talks/4ptxeq6flmeeqekygw4iws/%2522">"</a>  We remind you that you can <a href="https://dotnext-moscow.ru/tickets/">buy tickets at a tasty price</a> until October 31 inclusive. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This article can either be read in the text interpretation (click the button "read more" ‚á©), or see the full video of the report.  All the images you need to understand, slides and diagrams are present both in the video and in the text decoding, so you won't lose anything. <br><br>  Comments on the article are welcome and really important - we will try to ask your best questions directly to Dylan on <a href="https://dotnext-moscow.ru/">DotNext Moscow 2017</a> . <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/kPrTMj-BK14" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><a name="habracut"></a><br><br>  Today we will talk about the ideology of REST in the real world and the practical embodiment of hypermedia. <br><br>  But first, a little about me. <br><br>  My name is Dylan Beattie.  The best way to ask any questions about the report is to find me on twitter (@dylanbeattie).  I have a VK page, but I don‚Äôt speak Russian, so I don‚Äôt have friends on this social network. <br><br>  For a long time I have been creating websites.  I created my first web page back in 1992, when the World Wide Web was one year old.  In addition, I develop web applications. <br><br>  Currently, I am a systems architect at Spotlight in London, which is working on various projects in the film industry - a very interesting direction. <br><br>  My website: <a href="http://www.dylanbeattie.net/">dylanbeattie.net</a> .  There I publish my notes on software architecture, REST and other such things.  I also want to mention that the code from all the slides is on GitHub: <a href="http://github.com/dylanbeattie/dotnext/">github.com/dylanbeattie/dotnext/</a> .  You can download it from there and test it yourself. <br><br>  But let's talk about REST. <br><br>  REST is a fairly well-known concept.  Many have heard about it, many work with it.  However, there is still a lot of confusion about what REST is, why this concept is important and how you can use it to solve your problems.  Today we will look at the answers to some of these questions.  But first of all, I will try to form a clear idea of ‚Äã‚Äãwhich systems correspond to REST.  Therefore, we start from the beginning - refer to the source. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9cc/809/e58/9cc809e58ac19d6cd84b380a38f9d88f.png"><br><br>  This is Roy Fielding.  Roy invented REST and determined what it is.  There are many materials devoted to software and computing, which explains how everything works.  The words used have different meanings for different people.  But REST has a very clear definition, which we will discuss first. <br><br>  Roy is now a senior research scientist at Adobe.  He previously worked on Apache.  In fact, he is one of the founders of the Apache web server project, and he was also one of the authors of HTTP, the underlying protocol that binds the World Wide Web together.  In 2000, Roy published his thesis "Architectural styles and design of network software architectures."  In this paper, he describes the styles of scalable software architecture on the web. <br><br>  This is the very first point that needs to be understood.  REST is not a framework or a library;  it cannot be simply downloaded or installed.  REST is a set of rules, restrictions, and guidelines for how you should solve the problems you encounter in your applications. <br><br>  Abstracts Roy is very popular.  They are worth seeing if you are interested in looking at the basics.  In his work, I want to highlight a few maxims. <br><br>  The first is a <i><b>related set of architectural constraints; having a name, it becomes an architectural style</b></i> .  In his opinion, this question was influenced by architecture (in the context of construction), he thought a lot, including about architectural styles.  Buildings are not distinguished from each other by a project, not by design - but by style: a set of individual peculiarities and limitations.  And REST is like him.  This is a set of patterns that you can apply to your systems. <br><br>  I also find it very important that ‚Äú <i><b>REST in software development has existed for decades.</b></i>  <i><b>Every detail ensures the durability and independent evolution of software</b></i> . ‚Äù  REST is designed to create systems that will work for years and maybe decades.  If next month you are expecting the end of financing, you probably should not create a system that complies with the REST postulates, because many of the limitations presented in this concept are directly opposed to short-term effectiveness. <br><br>  It often happens that in a project you are working on there are two or more ways to solve a problem.  And the path that leads to REST often takes more time.  Along the way, you should think about a lot of things that may not be a problem for you and your company.  So be very careful.  Think about what exactly you are trying to achieve.  If you are lucky to work on a system that will function for many years, in the framework of this article you will find many ideas that I hope will be useful to you. <br><br>  If you build a prototype, conduct a lot of experiments to see if something will work, the situation is ambiguous.  REST doesn't hurt - but some requirements may slow you down. <br><br><h2>  REST definition </h2><br>  Roy Fielding proposed the definition of REST - this is a coordinated set of architectural constraints. <br><br><h3>  Client server </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/26a/9a5/bd5/26a9a5bd5f104101ade77198a5374177.png"></div><br>  First of all, according to him, the software system should be built to work on the client and on the server.  I hope this doesn‚Äôt surprise anyone.  Most of us, I think, have already created client-server applications - websites, email systems, FTP.  Now it is very common. <br><br>  I will not describe the details.  Your server is somehow shared between clients, providing data storage, basic functions, and security ‚Äî those things that you want to manage centrally. <br><br>  One of the nice things about customers is that each one comes from a computer.  Therefore, if you have calculations that you need to perform, you can distribute them to a large number of clients.  In this way, customers provide data processing, presentation and user interaction. <br><br>  The server serves several clients.  And this is a big advantage.  You can serve many thousands of users with the help of one server, if, of course, correctly design your system. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4a4/725/203/4a472520345ae3ecff690d481971acde.png"><br><br><h3>  Do not store state </h3><br>  The second limitation relates to the rejection of state storage.  In ASP.NET, PHP, ColdFusion, or classic ASP, you are confronted with the idea of ‚Äã‚Äãa session.  So you have a session cookie.  But this idea no longer works.  When you had something like ASP.NET and you ran one web server, it started to slow down a bit.  Then you installed another web server, and in the end everything ceased to work due to the fact that each time a request was sent to the server, some storage space was allocated only for that client.  Like that: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/00f/6e3/f59/00f6e3f598c6d1952394e4f6fcc4ab70.png"><br><br>  The server kept its status.  At the same time comes the next person, who also has some kind of condition. <br><br>  What happens when the server fills up and then one of the clients leaves?  We do not know whether he will return, so we have to keep the state for a period of time.  But what should be the session timeout?  5 minutes, 10 minutes, 24 hours?  It is very difficult to determine.  But the biggest problem is that if you run another server, which gives you even more options, and then one of the clients tries to switch from one server to another, the connection is interrupted, because the session information is stored in a different place. <br><br>  Therefore, by avoiding state storage, you get more flexibility regarding how many clients you can service and how you can scale the system. <br><br><h3>  Caching </h3><br>  The third constraint that Roy defines is caching. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cb7/6d6/382/cb76d63820d9205b93f326e6fccd7211.png"><br><br>  Suppose there is some resource on the server.  The client requests it.  If the same resource is required by the client again, he will not have to re-request it.  He should be able to use what is already there. <br><br>  When you perform a task on a server, you spend resources.  You may be processing a video or photo.  And all that costs resources, you need to reuse.  This is the best you can do.  You need to save the processing result so that anyone who ever returns and asks for the same data again can simply get the same resource. <br><br><h3>  Multi-level system </h3><br>  The following limitation is directly related to the idea of ‚Äã‚Äãcaching.  This is the idea of ‚Äã‚Äãmulti-level systems.  My favorite example of this idea is a caching proxy server between clients and the server. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/555/66c/6f8/55566c6f884dfd9837d401e56d328277.png"><br><br>  Clients in this diagram on the left.  Suppose these are different variants of smartphones - iPhone, Samsung, Android - anything.  Proxy server - in the middle of the chain.  Suppose it is managed by a certain large telecommunications company.  As the owner of the server, you pay for the work of what is to the right of the proxy.  After all, when a request comes from the client, the server performs some calculations.  And it costs money - electricity, equipment depreciation, etc. <br><br>  If the telecommunications company saves a copy of the results, the next time someone requests information, he will receive a proxy copy.  You will not need to spend money on the execution of the request.  Thus, the idea of ‚Äã‚Äãcaching on a proxy is incredibly good, because it allows other people to pay to make your software faster without additional investments. <br><br>  Even in the framework of the idea of ‚Äã‚Äãa multi-level system, you can add more intermediate levels.  In multi-tier systems, servers and clients do not care about what levels the request passes through. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b25/3a6/954/b253a69545ec62d0a072ab2cf1757eff.png"><br><br>  In this example, the clients interact with the proxy server.  The proxy thinks that it interacts with the server, but in fact it sends requests for a security level (for example, a firewall).  That, in turn, believes that it communicates with the server, it actually sends requests to the load balancer. <br><br>  The load balancer believes that it interacts with the server, but in fact it is about five servers.  We can deploy new ones, close old ones, and thanks to the load balancer, this does not affect other levels. <br><br>  The concept of multi-level systems gives you tremendous flexibility when planning applications. <br><br><h3>  Single interface </h3><br>  <b>Resource identification</b> <br><br>  Before the advent of HTTP and REST, if you wanted to get some information from the server, you had to choose one of several dozen protocols - Gopher, FTP, Telnet, etc.  All these were different systems, and each meant its own way of interacting with remote information and remote services. <br><br>  HTTP and REST have standardized this.  First of all, the identification of resources was standardized - a URL appeared (it‚Äôs funny to think that someone came up with a URL).  One part of the address defines the protocol (HTTP), the other the path to the resource, and the third part defines the port.  Everything on the Internet that is available for network requests can be identified using one of these URLs. <br><br>  <b>Manipulations with views</b> <br><br>  By manipulating representations means that you can request data in different formats.  If you need a piece of data, you can get it as a CSV table, Excel file, text document, jpeg.  These are all real representations of some basic results. <br><br>  <b>Self-descriptive messages</b> <br><br>  You should be able to understand what is happening on the network.  HTTP has GET, PUT, POST, DELETE requests.  They are descriptive: GET is an English word that means you want to get something.  PUT means to put something, DELETE - to delete.  You can view the network traffic in some intelligent debugging tool and see which requests were actually sent. <br><br>  <b>Hypermedia as a mechanism for managing application state</b> <br><br>  About this we talk more. <br><br><h3>  Encoding on request </h3><br>  The last constraint Roy defined was the idea of ‚Äã‚Äãcreating code that would be provided to clients on demand.  It implies that your server must be able to send data that includes code.  The client can extract this code, disconnect from the server and run it later. <br><br>  I have never seen the API that does it.  I have seen many web applications: Google Docs Offline, Gmail, and many other single-page applications.  I do not support the idea of ‚Äã‚Äãgetting run code from someone else's API for later launch on my system.  But it's nice to know that there is the possibility of such a launch of operations on clients. <br><br>  I came to the industry when the first web browsers that were not email clients were created.  Then someone decided that you can run javascript, and now we can create a mail client in javascript and send it to the client so that it can run it in the browser. <br><br><h3>  Binding constraints </h3><br>  The important thing is that Roy Fielding says bluntly: there are 6 limitations, and only one of them is optional. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/64b/6e4/eaf/64b6e4eaf100439c8643e7d7cf6acbed.png"><br><br>  If you build the system and solve the problems as described, the system will be RESTful.  If you solve them differently - the system will not be RESTful.  This does not mean that it is good or bad.  The definition above says nothing about the quality of the system.  However, it is very important that we agree on what constitutes a RESTful API by definition (according to the original source). <br><br>  Let's see how these restrictions will look in real life, or rather, in the life of comic book characters.  Let's try to write a social network code for superheroes in accordance with REST.  It will be fun. <br><br><h2>  REST in practice </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/b2b/204/f52/b2b204f52fbac285cd3ccc1850a57b08.png"><br><br>  Here are some really interesting characters from comics (and movies from comics).  Let's try to create a social network for them.  But we don‚Äôt want to get bogged down in UI development, just as we don‚Äôt want to test JavaScript.  So let's just create an API. <br><br>  Here is our entry point: <br><br><pre><code class="javascript hljs">GET / HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span></code> </pre> <br>  in response, we get: <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">200</span></span> OK Content-Type: application/json { <span class="hljs-string"><span class="hljs-string">"message"</span></span>: <span class="hljs-string"><span class="hljs-string">"Welcome to Herobook!"</span></span> }</code> </pre> <br>  Let's create an endpoint called here "/ profiles", which will have two methods: <br><br><pre> <code class="javascript hljs">GET /profiles HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span></code> </pre> <br>  The method returns an array of JavaScript - JSON from the profiles of all superheroes who have joined the social network: <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">200</span></span> OK Content -Type: application/json [ { <span class="hljs-string"><span class="hljs-string">"username"</span></span>: <span class="hljs-string"><span class="hljs-string">"ironman"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tony Stark"</span></span>, } ]</code> </pre><br>  At the moment we are not worried about security, this question is beyond the scope of our conversation. <br><br>  The second method is POST.  By sending POST to / profiles, you give the payload as JSON. <br><br><pre> <code class="javascript hljs">POST /profiles HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> { <span class="hljs-string"><span class="hljs-string">"username"</span></span> : <span class="hljs-string"><span class="hljs-string">"blackwidow"</span></span> <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, }</code> </pre><br>  Answer - a message about the successful creation of the profile and its address: <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">201</span></span> Created Location: http:<span class="hljs-comment"><span class="hljs-comment">//api.herobook.local/profiles/blackwidow { "username": "blackwidow", "name": " " }</span></span></code> </pre><br>  Let's place the description of the service and its API anywhere on the Internet, so that everyone knows how to use our system: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/587/9b3/628/5879b362823aa3db0a17819c3cc79ddd.png"><br><br>  ... and go for the weekend. <br><br>  Returning on Monday, we find that the information about our service was sold online: someone put it on Reddit, tweeted it on Twitter, and we had two million users.  Wow! <br><br><pre> <code class="javascript hljs">GET /profiles HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK { <span class="hljs-string"><span class="hljs-string">"_links"</span></span> : { ‚Ä¶ }, <span class="hljs-string"><span class="hljs-string">"items"</span></span> : { { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ironman"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Tony Stark"</span></span> } { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"blackwidow"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">" "</span></span> }, { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"spidey"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Peter Parker"</span></span> }, { <span class="hljs-comment"><span class="hljs-comment">/* +2 million users! Wow! */</span></span> }, { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ducky"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Howard the Duck"</span></span> } } ]</code> </pre> <br>  And suddenly the phone rings.  We pick up the phone, and on the other end of the line, someone says: ‚ÄúYour API scored our entire channel!‚Äù.  And then another call: "Your idiotic API overloads our database." <br><br>  What is the problem here?  What happened?  Why are we all unhappy?  Because in response to a request we send two million records.  We have only one endpoint - / profiles.  The only thing you can do with the API is to get or publish the data.  And if you try to do this, you will receive 2 million records each time.  Thus, every time someone tries to use our API, it gets megabytes of data.  The network crashes, so does the database.  The whole system does not scale. <br><br>  What can we do about it?  Let's take the end point and split it: <br><br><pre> <code class="javascript hljs">GET /profiles&lt;b&gt;?page=<span class="hljs-number"><span class="hljs-number">1</span></span>&lt;<span class="hljs-regexp"><span class="hljs-regexp">/b&gt; HTTP/</span></span><span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK { <span class="hljs-string"><span class="hljs-string">"_links"</span></span> : { ‚Ä¶ }, <span class="hljs-string"><span class="hljs-string">"items"</span></span> : [ { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ironman"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Tony Stark"</span></span> } { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"spidey"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Peter Parker"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"blackwidow"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span> }, { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"cap"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Steve Rogers"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"storm"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Ororo Munroe"</span></span> } ] }</code> </pre><br>  Next we can request page 2: <br><br><pre> <code class="javascript hljs">GET /profiles&lt;b&gt;?page=<span class="hljs-number"><span class="hljs-number">2</span></span>&lt;<span class="hljs-regexp"><span class="hljs-regexp">/b&gt; HTTP/</span></span><span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK</code> </pre><br>  then page 3: <br><br><pre> <code class="javascript hljs">GET /profiles&lt;b&gt;?page=<span class="hljs-number"><span class="hljs-number">3</span></span>&lt;<span class="hljs-regexp"><span class="hljs-regexp">/b&gt; HTTP/</span></span><span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK</code> </pre><br>  and so on: <br><br><pre> <code class="javascript hljs">GET /profiles?page=<span class="hljs-number"><span class="hljs-number">4</span></span> HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK</code> </pre><br><pre> <code class="javascript hljs">GET /profiles?page=<span class="hljs-number"><span class="hljs-number">5</span></span> HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">204</span></span> No Content</code> </pre><br>  It's very simple, and it works.  I‚Äôm sure most of us can create a system that does this.  And when we get ‚ÄúNo Content‚Äù, it means that you have all the profiles of the system. <br><br>  However, this is not REST.  And the reason is that the API does not use hypermedia as an application state engine.  When we get the first page, theoretically we can go from there to pages 2, 3. But there is nothing in the server‚Äôs response that tells us about this possibility. <br><br>  What are we going to do about it? <br><br>  Before giving the answer, let me remind you of one series of books from childhood. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/118/3c2/edc/1183c2edcc14d989513ea1df049f47f4.png"><br><br>  These are the books in the Choose Your Adventure series.  They existed before we learned what even an 8-bit computer is.  The first page shows a part of the story, and at the end - the choice of what you want to do next. <br><br>  As an example, I created a special text for our situation: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ba/4f0/598/3ba4f05984c57d16c7ca99a7c0253fcb.png"><br><br>  This is ‚ÄúChoose Your Adventure‚Äù especially for DOTNEXT in St. Petersburg. <br><br>  <i>‚ÄúYou had an AWESOME first day on DotNext in St. Petersburg.</i>  <i>Now you are at the conference after the party.</i>  <i>It was a busy day;</i>  <i>maybe you should go to your room and sleep?</i>  <i>But some people are going to order sushi.</i>  <i>Or can you stay at the party and see how Eugene sings karaoke? ‚Äù</i> <br><br>  This content is the beginning of the story.  And then we have hypermedia operations embedded in the results view: <br><br>  <i>‚ÄúTo go to your room and sleep, go to page 23,</i> <i><br></i>  <i>To eat sushi, go to page 41,</i> <i><br></i>  <i>To stay at the party and watch karaoke, go to page 52. "</i> <br><br>  This is hypermedia.  Our result contains a hypermedia annotation describing how we can interact with the system. <br><br>  Let's see how it actually looks in code.  We will use the hal + json format for this.  This is json with extra bits for hypermedia replication language.  The reason I use it is because the format is rather short, so it‚Äôs easy to place on PowerPoint slides. <br><br>  So instead of just returning an array, we're going to create a collection of items.  We will return the payload (our content) inside the collection, as well as complement the results with links to other places where we can go (available state transitions implemented via hypermedia). <br><br>  Enter the variable index - this is the page where you are.  Total - the total number of entries in the collection. <br><br><pre> <code class="javascript hljs">GET /profiles HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK Content -Type: application/hal+json { <span class="hljs-string"><span class="hljs-string">"_links"</span></span> : { <span class="hljs-string"><span class="hljs-string">"self"</span></span> : { <span class="hljs-string"><span class="hljs-string">"href"</span></span> : <span class="hljs-string"><span class="hljs-string">"http://herobook/profiles?index=0"</span></span> }, <span class="hljs-string"><span class="hljs-string">"next"</span></span> : { <span class="hljs-string"><span class="hljs-string">"href"</span></span> : <span class="hljs-string"><span class="hljs-string">"http://herobook/profiles?index=5"</span></span> }, <span class="hljs-string"><span class="hljs-string">"last"</span></span> : { <span class="hljs-string"><span class="hljs-string">"href"</span></span> : <span class="hljs-string"><span class="hljs-string">"http://herobook/profiles?index=220"</span></span> } }, <span class="hljs-string"><span class="hljs-string">"count"</span></span> :<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-string"><span class="hljs-string">"index"</span></span> :<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"total"</span></span> : <span class="hljs-number"><span class="hljs-number">223</span></span>, <span class="hljs-string"><span class="hljs-string">"items:"</span></span> [ { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"ironman"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Tony Stark"</span></span> } { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"spidey"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Peter Parker"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"blackwidow"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"ÃÅ "</span></span> }, { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"pepper"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Pepper Potts"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"storm"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Ororo Munroe"</span></span> } ] }</code> </pre> <br>  Let's look at the code. <br><br>  But first I want to warn you: you may notice some strange characters here.  This is C #.  I use <a href="https://github.com/tonsky/FiraCode">FiraCode</a> , which stands for the following: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bd6/252/138/bd62521388cf1d839e7bab3f4f3ba991.png"><br><br>  Don't worry when you meet them.  These are not funny little runes, these are mathematical symbols.  I like them.  FiraCode is an open source project.  You can download it <a href="https://github.com/tonsky/FiraCode">here</a> . <br><br>  For the demonstration, I will use a tool that I created to work with such things.  It can be found in my GitHub repository (link at the beginning of the article). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e51/334/1ad/e513341ada96e1243a42f23157d86d5e.png"><br><br>  This is just an explorer API tool running inside the browser.  On the one hand, you have web browsers that do an excellent job with browsing, buying things on Amazon and Ebay.  They all work very well with the API.  On the other hand, we have tools, such as Callcommandline, or special ones, like Postman.  They are well suited for performing a single request.  But when you want to navigate the hypermedia system, you should not use them.  My tool is somewhere between these two extremes: it works in a browser (it all works in JavaScript) and understands hypermedia. <br><br>  We are going to use our API.  Enter / profiles and click go. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1dc/4b6/4b5/1dc4b64b55cc44f50eb252013d738d2f.png"><br><br>  In response, we receive a message about successful execution - 200 OK - and two million records (many thanks to the Internet who took each comic superhero and put it in a large spreadsheet; I just had to copy and upload it all for demonstration). <br><br>  Let's see the code that provided such an answer. <br><br><h3>  Web API </h3><br>  The first demo is the asp.net Web API.  I think that on DotNext most people are familiar with .NET and ASP.NET.  And this is just a Web API, no big deal. <br>  The code looks like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5d9/889/af2/5d9889af2bad85ad706aa1bb5e50aecb.png"><br><br>  We have ProfilesController (which inherits ApiController).  There is a database DemoDatabase (), as well as a public object Get (), which returns db.ListProfiles (). <br><br>  How can we adapt this code to meet the requirement for hypermedia?  Break the result into pages and give a link from one page to another. <br><br>  The first thing we need to do is wrap our array into something.  We cannot simply return data.  One of the things in .NET that works well for this is the ability to create anonymous types.  Subsequently, you can serialize them to get almost the same thing that they put.  I think this is a really powerful tool.  Anonymous types solve many problems if you try to transfer them between modules of the .NET code.  But if you are just making a website, turn it straight into Json, serialize it, and then discard the unnecessary. <br><br><pre> <code class="javascript hljs">public object Get() { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> profiles = db.ListProfiles(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { items = profiles }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre><br>  Here is what we get: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f7f/aac/219/f7faac219d1e62d8dc18ca8e3287e04d.png"><br><br>  We still have two million entries, but now the array is located inside the JSON objects of JavaScript.  This means that we have a place where we can integrate more functions. <br><br>  The first thing we want to do is cut the output.  Simply enter a constant denoting the number of results per page.  It will be 10. And then we go to the database and say: <br><br><pre> <code class="javascript hljs"> profiles = db.ListProfiles().Take(REULTS_PER_PAGE)</code> </pre> <br>  Now, when we turn to the database, it will give us only 10 profiles.  Here is the full get () code: <br><br><pre> <code class="javascript hljs">&lt;code&gt;public object Get() { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> RESULTS_PER_PAGE = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> profiles = db.ListProfiles().Take(RESULTS_PER_PAGE) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { items = profiles }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br>  We return to our tool and update the page.  Instead of 2 million, we get 10 entries (this can be seen from the scroll bar). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/89f/f43/e43/89ff43e437f12210be85f674fd5c9771.png"><br><br>  We solved the problem.  Now the query / profiles will no longer cause the internet connection to fail. <br><br>  The next thing we want to do is the links for the page request.  Our API is smart enough to produce the right page. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a34/781/046/a347810468244ba1844530f28eb70bf0.png"><br><br>  However, the user is not aware of this possibility, so for now this system does not comply with REST. <br><br>  We need to go back to the code and fix something. <br><br>  We have a result that is an anonymous type.  Therefore, we can add to it everything that we like.  In particular, links.  Here we will use interpolation of C # strings: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { _links = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { next = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { href = $<span class="hljs-string"><span class="hljs-string">"/profiles?index={index+RESULTS_PER_PAGE}"</span></span> } }, items = profiles }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result;</code> </pre> <br>  Now, requesting profiles, we get not only the data itself, but also a collection of links. <br><br>  Let's return to our API Explorer.  Let's see what happens: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7b2/2f4/e21/7b22f4e21402b048f393419b5e6f1fd7.png"><br><br>  So we took the first steps towards what is called an hypermedia-enabled API. <br><br>  We have page 0, and you can navigate through the pages. <br><br>  But there are still some problems with the API.  We need navigation: we must be able to move back and forth through the pages, and also move to the beginning or end of the list.  While the API does not support this.  In addition, when we reach the end of the collection, the system will begin returning empty arrays to us. <br><br>  In order for the API to fully comply with the REST concept, we need to add a bit of logic to calculate where we can go from the current page. <br><br>  For this, I use a small helper class. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/568/d02/c28/568d02c28adbb16bff5416cb641f9682.png"><br><br>  Here the static method returns a dynamic object.  What is he doing?  We give him the index of the current page, the number of elements on each page, as well as the total number of elements, and perform some calculations - we get the numbers of the first and last page.  The first one will always be zero, the last one will always contain the profile with the maximum index in the collection.  Further, for an index greater than zero, we can go back.  However, we cannot go back, and if index - count is less than the minimum index;  we can also go forward, but we cannot pass by the end. <br><br>  The method returns links.  Now back to our code, rewriting it as follows: <br><br><pre> <code class="javascript hljs">public object Get(index = <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> RESULTS_PER_PAGE = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> profiles = db.ListProfiles() .Skip(index) .Take(RESULTS_PER_PAGE); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> total = db.CountProfiles(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { _links = Hal.Paginate(<span class="hljs-string"><span class="hljs-string">"/profiles"</span></span>, index, RESULTS_PER_PAGE, total), items = profiles }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br>  Run it: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ec9/0e1/76f/ec90e176ff2db5c7859d792c992dae29.png"><br><br>  Now we have links to the first, last, next and previous pages.  We can go forward or backward;  The links available for the transition take into account whether you have reached the first or last page (you cannot go back from the first page, but go forward with the last page) <br><br>  So we had 2 million social network posts.  We broke the data into separate pages and then used hypermedia so that anyone who accesses the resource knows how it can navigate through the collection. <br><br><h3>  Deploying resources </h3><br>  In social networks, people share information with their friends.  They establish friendly relationships, and then publish updates: ‚ÄúHey, look what I did this morning;  look where I am. ‚Äù <br><br>  Suppose we have Iron Man - Tony Stark on the net.  And he has Hulk, Spider-Man, Natasha Romanova as a friend. <br><br>  Tony updates the status. <br><br><pre> <code class="javascript hljs">GET /profiles/ironman HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK Content-Type: application/json { <span class="hljs-string"><span class="hljs-string">"username"</span></span>: <span class="hljs-string"><span class="hljs-string">"ironman"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tony Stark"</span></span>, <span class="hljs-string"><span class="hljs-string">"friends"</span></span> : [ { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"hulk"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Bruce Banner"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"spidey"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Peter Parker"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"blackwidow"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"ÃÅ "</span></span> }, <span class="hljs-comment"><span class="hljs-comment">/* another 500 friends here... */</span></span> ] <span class="hljs-string"><span class="hljs-string">"updates"</span></span> : [ { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : <span class="hljs-number"><span class="hljs-number">1234</span></span>, <span class="hljs-string"><span class="hljs-string">"update"</span></span> : <span class="hljs-string"><span class="hljs-string">"Working a new Iron Man suit!"</span></span>, <span class="hljs-string"><span class="hljs-string">"posted"</span></span> : <span class="hljs-string"><span class="hljs-string">"2016-02-23T18:25:43.511Z"</span></span>}, { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : <span class="hljs-number"><span class="hljs-number">1543</span></span>, <span class="hljs-string"><span class="hljs-string">"update"</span></span> : <span class="hljs-string"><span class="hljs-string">"New suit's gonna have a selfie stick! Oh yeah!"</span></span>, <span class="hljs-string"><span class="hljs-string">"posted"</span></span> : <span class="hljs-string"><span class="hljs-string">"2016-04-16T18:25:43.511Z"</span></span>}, { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : <span class="hljs-number"><span class="hljs-number">1782</span></span>, <span class="hljs-string"><span class="hljs-string">"update"</span></span> : <span class="hljs-string"><span class="hljs-string">"Selfie stick broke. Oh well. Back to the drawing board"</span></span>, <span class="hljs-string"><span class="hljs-string">"posted"</span></span> : <span class="hljs-string"><span class="hljs-string">"2016-04-17T08:26:13.511Z"</span></span>} ] }</code> </pre><br>  His first update: ‚ÄúHey, I'm building a new suit of Iron Man,‚Äù the next is ‚ÄúI'm going to put a selfie stick on him, because the egoists are awesome, oh yeah.‚Äù  And then he publishes another update: ‚ÄúThe selfie stick broke.  Returning to the drawing board, back to my lab. ‚Äù <br><br>  Of course, his friends also have profiles.  Therefore, each of these updates has a list of friends, and each of these friends has its own updates. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/58f/994/e68/58f994e68019e164a1dd62ed6d850ce7.png"><br><br>  But friends have friends, and those have their own updates, etc. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ff0/aa5/b6c/ff0aa5b6c35800f9195fbd194fe2fc43.png"><br><br>  So we come to what is called Big Data. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b4/087/418/2b40874185091b547589ea2f60ace09f.png"><br><br>  Because Big Data is something too big for JSON to put this data on a PowerPoint slide.  Let it be my definition. <br><br>  We have implemented support for statuses and their updates.  And then the phone rings: "Your API scored our entire channel ... again!", "Your API is overloading the database.  Again! .. I said we needed to use PHP ... (you have never heard of such problems in PHP before, right?) " <br><br>  How do we fix this?  What will we do to solve this problem?  We will again share our data.  Instead of returning the entire graph associated with a particular entry, we will offer links.  We have already discussed how to use links to move forward / backward.  Now expand this idea. <br><br><pre> <code class="javascript hljs">GET /profiles/ironman HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK Content-Type: application/hal+json { <span class="hljs-string"><span class="hljs-string">"_links"</span></span>: { <span class="hljs-string"><span class="hljs-string">"self"</span></span>: { <span class="hljs-string"><span class="hljs-string">"href"</span></span> <span class="hljs-string"><span class="hljs-string">"/profiles/ironman"</span></span> }, <span class="hljs-string"><span class="hljs-string">"friends"</span></span>: { <span class="hljs-string"><span class="hljs-string">"href"</span></span> : <span class="hljs-string"><span class="hljs-string">"/profiles/ironman/friends"</span></span> }, <span class="hljs-string"><span class="hljs-string">"photos"</span></span>: { <span class="hljs-string"><span class="hljs-string">"href"</span></span> : <span class="hljs-string"><span class="hljs-string">"/profiles/ironman/photos"</span></span> }, <span class="hljs-string"><span class="hljs-string">"updates"</span></span>: { <span class="hljs-string"><span class="hljs-string">"href"</span></span> : <span class="hljs-string"><span class="hljs-string">"/profiles/ironman/updates"</span></span> } }, <span class="hljs-string"><span class="hljs-string">"username"</span></span> : <span class="hljs-string"><span class="hljs-string">"ironman"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span> : <span class="hljs-string"><span class="hljs-string">"Tony Stark"</span></span> }</code> </pre> <br>  self - points to the profile that you are looking at, because you can walk away from it along different routes and would like to be able to quickly return back (this is a common practice for such systems).  You can also quickly access your friends, photos and updates - friends, photos and updates. <br><br><pre> <code class="javascript hljs">GET /profiles/ironman HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK</code> </pre> <br>  or <br><br><pre> <code class="javascript hljs">GET /profiles/ironman/friends HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK GET /profiles/ironman/updates HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK GET /profiles/ironman/photos HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK</code> </pre> <br>  Let's also try to request a photo: <br><br><pre> <code class="javascript hljs">GET /profiles/ironman/photos/<span class="hljs-number"><span class="hljs-number">1234</span></span> HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK</code> </pre> <br>  Someone left comments for this photo: <br><br><pre> <code class="javascript hljs">GET /profiles/ironman/photos/<span class="hljs-number"><span class="hljs-number">1234</span></span>/comments HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK</code> </pre> <br>  Let's request photo 1345: <br><br><pre> <code class="javascript hljs">GET /profiles/ironman/photos/<span class="hljs-number"><span class="hljs-number">1345</span></span> HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK</code> </pre><br>  And here, too, have someone's comments: <br><br><pre> <code class="javascript hljs">GET /profiles/ironman/photos/<span class="hljs-number"><span class="hljs-number">1345</span></span>/comments HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK GET /profiles/ironman/photos/<span class="hljs-number"><span class="hljs-number">1456</span></span> HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK GET /profiles/ironman/photos/<span class="hljs-number"><span class="hljs-number">1456</span></span>/comments HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK</code> </pre> <br>  And the phone rings again: ‚ÄúI have to make 50 API calls just to issue 1 page ?? !!!‚Äù.  ‚ÄúOur web server crashed due to the fact that IIS logs filled the C: drive (we never had such problems with PHP)‚Äù - indeed, this is one of the most common reasons for the drop in services. <br><br>  What do we do? <br><br>  We took a lot of data that caused problems, and we shared it.  And now small data already causes other problems. <br><br>  The so-called deployment of resources will help us in solving these problems.  If you are familiar with something like ORM, then you know that during the loading process you can request a specific object and include another object there. <br><br>  Deploying resources is a similar idea for hypermedia API.  Thus, we can request the profile of Iron Man and deploy his updates. <br><br><pre> <code class="javascript hljs">GET /profiles/ironman?expand=updates HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK Content-Type: application/json { <span class="hljs-string"><span class="hljs-string">"_links"</span></span>: { <span class="hljs-string"><span class="hljs-string">"self"</span></span> : { <span class="hljs-string"><span class="hljs-string">"href"</span></span>: <span class="hljs-string"><span class="hljs-string">"/profiles/ironman"</span></span> }, <span class="hljs-string"><span class="hljs-string">"friends"</span></span> : { <span class="hljs-string"><span class="hljs-string">"href"</span></span>: <span class="hljs-string"><span class="hljs-string">"/profiles/ironman/friends"</span></span> }, <span class="hljs-string"><span class="hljs-string">"photos"</span></span> : { <span class="hljs-string"><span class="hljs-string">"href"</span></span>: <span class="hljs-string"><span class="hljs-string">"/profiles/ironman/photos"</span></span> }, <span class="hljs-string"><span class="hljs-string">"updates"</span></span> : { <span class="hljs-string"><span class="hljs-string">"href"</span></span>: <span class="hljs-string"><span class="hljs-string">"/profiles/ironman/updates"</span></span> } }, <span class="hljs-string"><span class="hljs-string">"username"</span></span> : <span class="hljs-string"><span class="hljs-string">"ironman"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span> : <span class="hljs-string"><span class="hljs-string">"Tony Stark"</span></span> <span class="hljs-string"><span class="hljs-string">"_embedded"</span></span> : { <span class="hljs-string"><span class="hljs-string">"updates"</span></span> : [ { <span class="hljs-string"><span class="hljs-string">"update"</span></span> : <span class="hljs-string"><span class="hljs-string">"Working a new Iron Man suit ‚Äì with a built-in selfie stick!"</span></span>, <span class="hljs-string"><span class="hljs-string">"posted"</span></span> : <span class="hljs-string"><span class="hljs-string">"2016-02-23T18:25:43.511Z"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"update"</span></span> : <span class="hljs-string"><span class="hljs-string">"Selfie stick broke. Oh well. Back to the drawing board"</span></span>, <span class="hljs-string"><span class="hljs-string">"posted"</span></span> : <span class="hljs-string"><span class="hljs-string">"2016-04-17T08:26:13.511Z"</span></span> } ] } }</code> </pre> <br>  I again want to make a demo version of the code showing how to implement this.  For the second demo, we will actually use another server - Nancy. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3dd/d3a/203/3ddd3a203a754a7f7d3ae9350089e7a2.png"><br><br>  The code that does this is the Nancy module: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fa9/0ad/ddd/fa90addddb710a7bc0f5687dbd47f80d.png"><br><br>  We go to ProfileModules in our application.  For those of you who have not worked with Nancy, I note that there is a great function here ‚Äî a dictionary for each of the HTTP methods ‚Äî GET, PUT, POST, DELETE. <br><br>  We get an object with a dynamic argument that will include everything that matches the pattern of the route.  Next is the method we need to call. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/075/872/6f2/0758726f2de66222ad1843e157b5455c.png"><br><br>  It takes the username, goes to db.loadProfile and returns the profile. <br><br>  What do we want to do to add hypermedia?  Add a selection of links here.  But we cannot, because db.loadProfile pulls us back - we cannot add links to it for various corporate reasons.  So we want to add links without changing the database. <br><br>  I present the coolest piece of code I've ever received from Stackoverflow.  Our problem will be solved by calling the ToDynamic method: <br><br><pre> <code class="javascript hljs">using System.Collections.Generic; using System.ComponentModel; using System.Dynamic; using System.Linq; namespace RealWorldRest.NancyFX.Modules { public <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ObjectExtensions</span></span></span><span class="hljs-class"> </span></span>{ public <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> dynamic ToDynamic(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> object value) { IDictionary&lt;string, object&gt; expando = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ExpandoObject(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> properties = TypeDescriptor.GetProperties(value.GetType()); foreach (PropertyDescriptor property <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> properties) { expando.Add(property.Name, property.GetValue(value)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (ExpandoObject)expando; } public <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> IDictionary&lt;string, object&gt; ToDictionary(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> object d) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> d.GetType().GetProperties() .ToDictionary(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function"> =&gt;</span></span> x.Name, x =&gt; x.GetValue(d, <span class="hljs-literal"><span class="hljs-literal">null</span></span>)); } } }</code> </pre> <br>  This is an extension method built into C #.  It takes an object and then uses reflex.  It wraps it in an Expandable object, which is the underlying dynamic type in C #.  Next, we use reflection to get all the properties of the original object.  For each of these properties, we go to the dictionary and add the name and value of the property to it.  And then we return the extended object (dynamic). <br><br>  Why do we need it?  Take everything that we pulled out of the database and call ToDynamic on it.  Now these objects are open because they are dynamic.  We can use any additional classes and methods.  All this will be allowed in runtime.  We can put self, photos, updates. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f25/0cc/d37/f250ccd377da53649fb32cc398005ade.png"><br><br>  Again, we are approaching the strongly typed development of corporate C # software from the other end, turning it into JSON.  This is a very good example of using two different paradigms for modeling software systems. <br><br>  So, what we get: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/239/bc1/280/239bc1280932394d5ca7d0356fe8fb4c.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/6bf/3ab/c1b/6bf3abc1bbd2e8500200aaabe615a88f.png"><br><br>  This is the first step: we have created this tool for hypermedia navigation.  You can see Iron Man's best friend.  But we did not implement the deployment. <br><br>  We have come to the moment when the process of creating a REST system suddenly went beyond the specification.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is not a single RFC or other document that says how to implement resource deployment. There are many different approaches. But the problematic itself is important, not the actual code. Therefore, in our example, we will do the simplest thing that will work. I'm going to parse the incoming request string. Since we use Nancy, everything is dynamic until you wish otherwise. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We translate it into a string (since string is unnullable, it is safe). Next, I'm going to say: ‚ÄúIf the string is not empty and contains friends, then we include more things in the dynamic profile‚Äù. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/adf/a94/fa7/adfa94fa7f0739b8a91664a60a7b31df.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And now, switching back to the API Explorer, we see the results of the deployment: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/22e/033/e2c/22e033e2ce3451cd34a16f3d421ebebd.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and when we add expand = friends, the list of friends will be expanded.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f75/988/688/f75988688c55cf7fbea7b9a2c43f03de.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Having such tasks, it is very easy to decide that you need to write a whole series of .NET base classes, C #, etc. </font><font style="vertical-align: inherit;">But I want to point out that you don‚Äôt need to do so much. </font><font style="vertical-align: inherit;">JavaScript is a dynamic language, and JSON is a dynamic data structure type. </font><font style="vertical-align: inherit;">You can do a lot of things with them. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We now have an Iron Man profile. </font><font style="vertical-align: inherit;">We have his friends, photos, updates. </font><font style="vertical-align: inherit;">But we need to make some money.</font></font><br><br><pre> <code class="javascript hljs">GET /profiles/ironman HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK Content-Type: application/json { <span class="hljs-string"><span class="hljs-string">"_links"</span></span>: { <span class="hljs-string"><span class="hljs-string">"self"</span></span> : { <span class="hljs-string"><span class="hljs-string">"href"</span></span>: <span class="hljs-string"><span class="hljs-string">"/profiles/ironman"</span></span> }, <span class="hljs-string"><span class="hljs-string">"friends"</span></span> : { <span class="hljs-string"><span class="hljs-string">"href"</span></span>: <span class="hljs-string"><span class="hljs-string">"/profiles/ironman/friends"</span></span> }, <span class="hljs-string"><span class="hljs-string">"photos"</span></span> : { <span class="hljs-string"><span class="hljs-string">"href"</span></span>: <span class="hljs-string"><span class="hljs-string">"/profiles/ironman/photos"</span></span> }, <span class="hljs-string"><span class="hljs-string">"updates"</span></span> : { <span class="hljs-string"><span class="hljs-string">"href"</span></span>: <span class="hljs-string"><span class="hljs-string">"/profiles/ironman/updates"</span></span> } }, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tony Stark"</span></span>, <span class="hljs-string"><span class="hljs-string">"username"</span></span>: <span class="hljs-string"><span class="hljs-string">"ironman"</span></span>,</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To make money, we have to sell the data of our clients to large evil corporations, because social networks make it this way. </font><font style="vertical-align: inherit;">But we are not doing this at the moment, because we do not have the data they need. </font><font style="vertical-align: inherit;">We can add them. </font><font style="vertical-align: inherit;">Ask:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">how much do you weigh? </font><font style="vertical-align: inherit;">- We will try to sell you diet programs;</font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Where are you? </font><font style="vertical-align: inherit;">where do you live? </font><font style="vertical-align: inherit;">What is your location right now?</font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> what are you doing? </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> What is your status? </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where are you from? </font><font style="vertical-align: inherit;">What is your hometown?</font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> What's your e-mail address? </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Do you have a website? </font></font><br></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In addition, you need to save the date of the last changes in order to have an idea about who is actually an active new user in our system and who is not. </font></font><br><br><pre> <code class="javascript hljs">GET /profiles/ironman HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK Content-Type: application/json { <span class="hljs-string"><span class="hljs-string">"_links"</span></span>: { <span class="hljs-string"><span class="hljs-string">"self"</span></span> : { <span class="hljs-string"><span class="hljs-string">"href"</span></span>: <span class="hljs-string"><span class="hljs-string">"/profiles/ironman"</span></span> }, <span class="hljs-string"><span class="hljs-string">"friends"</span></span> : { <span class="hljs-string"><span class="hljs-string">"href"</span></span>: <span class="hljs-string"><span class="hljs-string">"/profiles/ironman/friends"</span></span> }, <span class="hljs-string"><span class="hljs-string">"photos"</span></span> : { <span class="hljs-string"><span class="hljs-string">"href"</span></span>: <span class="hljs-string"><span class="hljs-string">"/profiles/ironman/photos"</span></span> }, <span class="hljs-string"><span class="hljs-string">"updates"</span></span> : { <span class="hljs-string"><span class="hljs-string">"href"</span></span>: <span class="hljs-string"><span class="hljs-string">"/profiles/ironman/updates"</span></span> } }, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tony Stark"</span></span>, <span class="hljs-string"><span class="hljs-string">"username"</span></span>: <span class="hljs-string"><span class="hljs-string">"ironman"</span></span>, <span class="hljs-string"><span class="hljs-string">"height"</span></span>: <span class="hljs-number"><span class="hljs-number">192</span></span>, <span class="hljs-string"><span class="hljs-string">"weight"</span></span>: <span class="hljs-number"><span class="hljs-number">85</span></span>, <span class="hljs-string"><span class="hljs-string">"location"</span></span>: { <span class="hljs-string"><span class="hljs-string">"latitude"</span></span>: <span class="hljs-number"><span class="hljs-number">59.93</span></span>, <span class="hljs-string"><span class="hljs-string">"longitude"</span></span>: <span class="hljs-number"><span class="hljs-number">30.33</span></span> }, <span class="hljs-string"><span class="hljs-string">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"Out saving the world. Again."</span></span>, <span class="hljs-string"><span class="hljs-string">"hometown"</span></span>: <span class="hljs-string"><span class="hljs-string">"Malibu, USA"</span></span> <span class="hljs-string"><span class="hljs-string">"email"</span></span>: <span class="hljs-string"><span class="hljs-string">"tony@stark.com"</span></span>, <span class="hljs-string"><span class="hljs-string">"website"</span></span>: <span class="hljs-string"><span class="hljs-string">"//w.ironman.com"</span></span>, <span class="hljs-string"><span class="hljs-string">"last_modified"</span></span> : <span class="hljs-string"><span class="hljs-string">"2015-08-12T19:45:43.511Z"</span></span> }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We run the code in production, and the phone rings again: ‚ÄúThe attempt to update the status of Tony Stark caused a conflict‚Äù: </font></font><br><br><pre> <code class="javascript hljs">PUT /profiles/ironman HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Content-Type: application/json { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tony Stark"</span></span>, <span class="hljs-string"><span class="hljs-string">"username"</span></span>: <span class="hljs-string"><span class="hljs-string">"ironman"</span></span>, <span class="hljs-string"><span class="hljs-string">"height"</span></span>: <span class="hljs-number"><span class="hljs-number">192</span></span>, <span class="hljs-string"><span class="hljs-string">"weight"</span></span>: <span class="hljs-number"><span class="hljs-number">85</span></span>, <span class="hljs-string"><span class="hljs-string">"location"</span></span>: { <span class="hljs-string"><span class="hljs-string">"lat"</span></span>: <span class="hljs-number"><span class="hljs-number">34.02</span></span>, <span class="hljs-string"><span class="hljs-string">"lon"</span></span>: <span class="hljs-number"><span class="hljs-number">-118.77</span></span> }, <span class="hljs-string"><span class="hljs-string">"status"</span></span> : <span class="hljs-string"><span class="hljs-string">"Just got back from saving the world. Again."</span></span>, <span class="hljs-string"><span class="hljs-string">"hometown"</span></span>: <span class="hljs-string"><span class="hljs-string">"Malibu, USA"</span></span> <span class="hljs-string"><span class="hljs-string">"email"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;a href="</span></span>mailto:tony@stark.com<span class="hljs-string"><span class="hljs-string">"&gt;tony@stark.com&lt;/a&gt;"</span></span>, <span class="hljs-string"><span class="hljs-string">"website"</span></span>: <span class="hljs-string"><span class="hljs-string">"//w.ironman.com"</span></span>, <span class="hljs-string"><span class="hljs-string">"birthdate"</span></span>: <span class="hljs-string"><span class="hljs-string">"1972-01-24"</span></span> } <span class="hljs-number"><span class="hljs-number">409</span></span> Conflict</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is because Tony Stark flies in his suit, and he has his Apple watch with GPS, so his latitude and longitude are constantly updated. And by the time you update the status, the data is outdated. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is logical that you are unhappy: why do you have to push the entire profile into PUT, only to update the coordinates? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I used to mention that this happens when development goes beyond the specification. There are several different ways we can solve this problem. One of them is the implementation of the rule: if there is a PUT that contains only one filled element, you do not need to delete everything else. In this case, you can simply update one field:</font></font><br><br><pre> <code class="javascript hljs">PUT /profiles/ironman HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Content-Type: application/json { <span class="hljs-string"><span class="hljs-string">"status"</span></span> : <span class="hljs-string"><span class="hljs-string">"Thinking about a disco Iron Man suit."</span></span> <span class="hljs-comment"><span class="hljs-comment">/*  : JSON     // }</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It works. </font><font style="vertical-align: inherit;">But the problem is that in this way it is very easy to destroy the rest of the data. </font><font style="vertical-align: inherit;">And there is no way to set the difference between this PUT and PUT, which removes all other fields.</font></font><br>  As a result: <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">204</span></span> No Content</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Another approach that we can use is that we can make status an independent endpoint. </font></font><br><br><pre> <code class="javascript hljs">PUT /profiles/ironman/status HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-string"><span class="hljs-string">"Finished saving the world. I need a drink."</span></span> <span class="hljs-number"><span class="hljs-number">204</span></span> No Content</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, with this approach you will get a massive API. </font><font style="vertical-align: inherit;">You will have a lot of end points. </font><font style="vertical-align: inherit;">This means that you need a lot of hypermedia to explain to people which endpoints are available. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is an alternative - the HTTP PATCH method. </font><font style="vertical-align: inherit;">He is very cool and powerful, but poorly documented. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The PATCH method requests that the set of changes described in the request itself be applied to a resource identified as a Request URI. </font><font style="vertical-align: inherit;">The change set is presented in a format called ‚Äúpatch document‚Äù (identified as a media type).</font></font><br><br>  Those.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if you want to change an object on the server, you can send a PATCH request. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to describe the necessary changes? The documentation (here: ‚ÄúPATCH Method for HTTP‚Äù - </font></font><a href="http://tools.ietf.org/html/rfc5789"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://tools.ietf.org/html/rfc5789</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) says that you should send a description of the changes.</font></font> How to implement it?  It depends on you. <br><br><pre> <code class="javascript hljs">PATCH /file.txt HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: <span class="hljs-comment"><span class="hljs-comment">//w.example.com Content-Type: application/example If-Match: "e0023aa4e" Content-Length: 100 [description of changes]</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And again the specification ends here. </font><font style="vertical-align: inherit;">You are on your own. </font><font style="vertical-align: inherit;">Therefore, you can offer your own agreements on how you make PATCH, and all of them will comply with the specification. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is one way to do this. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We are on a Linux workstation. </font><font style="vertical-align: inherit;">We download, run it to get the patch file, and then download the raw patch. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here we will use an alternative Content-type (x in this case means that this is an extended type). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is understood by our server and our client. </font><font style="vertical-align: inherit;">We can download JSON, determine the difference before and after, and send the delta.</font></font><br><br><pre> <code class="javascript hljs">PATCH /profiles/ironman HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Content-Type: application/x-unix-diff <span class="hljs-number"><span class="hljs-number">11</span></span>c11 &lt; <span class="hljs-string"><span class="hljs-string">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"Just got home from saving the world."</span></span>, --- &gt; <span class="hljs-string"><span class="hljs-string">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"World saved. I need a drink."</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span> OK</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are amazing libraries that give you a much greater degree of control, for example, Json-patch. </font><font style="vertical-align: inherit;">It allows you to describe a set of operations that will be applied to a particular resource.</font></font><br><br><pre> <code class="javascript hljs">PATCH /profiles/ironman HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Content-Type: application/json-patch+json If-Match: <span class="hljs-string"><span class="hljs-string">"abc123"</span></span> [ { <span class="hljs-string"><span class="hljs-string">"op"</span></span>: <span class="hljs-string"><span class="hljs-string">"replace"</span></span>, <span class="hljs-string"><span class="hljs-string">"path"</span></span>: <span class="hljs-string"><span class="hljs-string">"/status"</span></span>, <span class="hljs-string"><span class="hljs-string">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">"Finished saving the world. I need a drink."</span></span> }, { <span class="hljs-string"><span class="hljs-string">"op"</span></span>: <span class="hljs-string"><span class="hljs-string">"move"</span></span>, <span class="hljs-string"><span class="hljs-string">"from"</span></span>: <span class="hljs-string"><span class="hljs-string">"/friends/hulk"</span></span>, <span class="hljs-string"><span class="hljs-string">"path"</span></span>: <span class="hljs-string"><span class="hljs-string">"/friends[0]"</span></span> } ] <span class="hljs-number"><span class="hljs-number">200</span></span> OK</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Thus, we could implement, for example, such scenarios: replace status, then add a new user as a friend and move a new friend up the list. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The last thing we‚Äôll look at today is our own variation on how to make an HTTP patch. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We are going to fix conferences / dotnext /</font></font><br><br><pre> <code class="javascript hljs">PATCH /conferences/dotnext HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Content-Type: image/epic.selfie+png</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We use an alternative Content-Type - epic.selfie + png. </font><font style="vertical-align: inherit;">In accordance with the standard, everything we do is describe the changes. </font><font style="vertical-align: inherit;">We are going to make this photo and then describe the changes. </font><font style="vertical-align: inherit;">And we will send it to the server, and the server will respond ‚Äú202 accepted‚Äù. </font><font style="vertical-align: inherit;">I think this answer should be replaced with a ‚Äúchallenge accepted‚Äù, because, in my opinion, DOTNEXT has really cool support.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ae5/201/70d/ae520170d9204679927d2413121d30eb.png"><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you liked this material from Dylan, at our November DotNext 2017 Moscow conference, he will touch on another interesting topic - </font></font><a href="https://dotnext-moscow.ru/2017/msk/talks/4ptxeq6flmeeqekygw4iws/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Life, liberty and the pursuit of APIness</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In this new report, he will tell you how to make your code leave smiles on users' faces. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of course, Dylan will not be the only speaker. </font><font style="vertical-align: inherit;">You will also be interested in:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hardcore </font></font><a href="https://dotnext-moscow.ru/2017/msk/talks/2dfoltply8kscqeoa6444g/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debugging and Profiling</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Report by </font><a href="https://dotnext-moscow.ru/2017/msk/talks/2dfoltply8kscqeoa6444g/"><font style="vertical-align: inherit;">.NET Core Apps on Linux</font></a><font style="vertical-align: inherit;"> by Sasha Goldstein;</font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">an easy, but no less interesting story about </font></font><a href="https://dotnext-moscow.ru/2017/msk/talks/3emvrfszfcuieigqe0cimq/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artificial Intelligence and neural networks for .NET developers</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from Dmitry Soshnikov;</font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">practical and technical immersion in metrics </font></font><a href="https://dotnext-moscow.ru/2017/msk/talks/2wij6mss4oea0mqi2g0ewk/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Metrix has you ...</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> by Anatoly Kulakov.</font></font><br></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A full list of speakers and a brief overview of their speeches are </font></font><a href="https://dotnext-moscow.ru/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on our website</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div><p>Source: <a href="https://habr.com/ru/post/340932/">https://habr.com/ru/post/340932/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../340920/index.html">Automation of work with current customers. Account Management. Choose a CRM system. Part 3</a></li>
<li><a href="../340922/index.html">We explain the modern JavaScript dinosaur</a></li>
<li><a href="../340924/index.html">Using the neural network to build a model for assessing borrowers in the field of online microfinance</a></li>
<li><a href="../340926/index.html">Web application on Node and Vue, part 2: components, forms, routes</a></li>
<li><a href="../340928/index.html">Under the hood Ethereum Virtual Machine. Part 1 - Solidity basics</a></li>
<li><a href="../340934/index.html">Autumn changes on Habr√© and Geektimes</a></li>
<li><a href="../340936/index.html">Agile in Russia - 82.9% of companies report that they use at least something from Agile. First poll results</a></li>
<li><a href="../340938/index.html">New virus Reaper infected 2 million IoT devices</a></li>
<li><a href="../340940/index.html">Windows Defender removes the bootloader from DiskCryptor</a></li>
<li><a href="../340942/index.html">Big migration</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>