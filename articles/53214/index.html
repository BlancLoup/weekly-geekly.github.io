<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Ruby familiarity with Thread</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lyrical digression 
 For example, we are writing a server. The embodiment of the server is a looping, a constant survey of something. All small discre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Ruby familiarity with Thread</h1><div class="post__text post__text-html js-mediator-article"><h2>  Lyrical digression </h2><br>  For example, we are writing a server.  The embodiment of the server is a looping, a constant survey of something.  All small discrete is considered to be considered constant, and that is how a permanent connection is obtained. <br><h2>  Realities </h2><br>  Ruby has an infinite loop. <br><blockquote><code><a href="http://s-c.me/1045/s"></a> <a href="http://s-c.me/1045/h"></a> <font color="black">Copy Source | Copy HTML <font color="#0000ff">loop</font> { <font color="#0000ff">puts</font> <font color="#008000">"   ."</font> } <font color="#696969">#    .</font> <font color="#0000ff">puts</font> <font color="#008000">"  ,      ."</font></font></code> <ol> <li> <code><font color="black"><a href="http://s-c.me/1045/s"></a> <a href="http://s-c.me/1045/h"></a> Copy Source | Copy HTML <font color="#0000ff">loop</font> { <font color="#0000ff">puts</font> <font color="#008000">"   ."</font> } <font color="#696969">#    .</font> <font color="#0000ff">puts</font> <font color="#008000">"  ,      ."</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/1045/s"></a> <a href="http://s-c.me/1045/h"></a> Copy Source | Copy HTML <font color="#0000ff">loop</font> { <font color="#0000ff">puts</font> <font color="#008000">"   ."</font> } <font color="#696969">#    .</font> <font color="#0000ff">puts</font> <font color="#008000">"  ,      ."</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/1045/s"></a> <a href="http://s-c.me/1045/h"></a> Copy Source | Copy HTML <font color="#0000ff">loop</font> { <font color="#0000ff">puts</font> <font color="#008000">"   ."</font> } <font color="#696969">#    .</font> <font color="#0000ff">puts</font> <font color="#008000">"  ,      ."</font></font></code> </li> <li> <code><font color="black"><font color="#696969"><a href="http://s-c.me/1045/s"></a> <a href="http://s-c.me/1045/h"></a> Copy Source | Copy HTML <font color="#0000ff">loop</font> { <font color="#0000ff">puts</font> <font color="#008000">"   ."</font> } #    . <font color="#0000ff">puts</font> <font color="#008000">"  ,      ."</font></font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/1045/s"></a> <a href="http://s-c.me/1045/h"></a> Copy Source | Copy HTML <font color="#0000ff">loop</font> { <font color="#0000ff">puts</font> <font color="#008000">"   ."</font> } <font color="#696969">#    .</font> <font color="#0000ff">puts</font> <font color="#008000">"  ,      ."</font></font></code> </li> </ol></blockquote><br>  Those.  you have to do everything before we started looping. <br>  In addition, this operation is very sensitive for the processor.  If we do not need a very frequent repetition, then the cycle can be put to sleep for a while. <br><blockquote> <code><a href="http://s-c.me/1046/s"></a> <a href="http://s-c.me/1046/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  <font color="#0000ff">loop</font> { </li><li>  <font color="#0000ff">puts</font> <font color="#008000">"Nothing will stop me."</font> </li><li>  <font color="#0000ff">sleep</font> ( <font color="#008000">1</font> ) <font color="#696969"># one second sleep</font> </li><li>  } </li></ol></blockquote><br>  And if you need to perform operations with different frequencies, then within one cycle it is problematic. <br><h2>  Thread </h2><br>  To solve these problems, there are threads. <br><a name="habracut"></a>  Typical flow <br><blockquote> <code><a href="http://s-c.me/1047/s"></a> <a href="http://s-c.me/1047/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  <font color="#cc6633">Thread</font> .new { </li><li>  <font color="#0000ff">loop</font> { </li><li>  <font color="#0000ff">puts</font> <font color="#008000">"I thread"</font> </li><li>  } </li><li>  } </li></ol></blockquote><br><h2>  First experience </h2><br>  Now I will show how I began to investigate Thread and what came as a surprise to me. <br>  The first program with threads looked like I wrote above.  When I launched it, nothing happened.  The first thought that came to mind (and erroneous) was that the <s>stream needed to be launched</s> , and I got into the dock in search of the ‚Äústarting‚Äù method. <br>  It turned out with the help of join <br>  Without reading the description, I decided that <s>this is how the threads run</s> .  Further, for my own amusement, I made a watch: <br><blockquote> <code><a href="http://s-c.me/1048/s"></a> <a href="http://s-c.me/1048/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  thr_1 = <font color="#cc6633">Thread</font> .new { </li><li>  <font color="#0000ff">loop</font> { </li><li>  <font color="#0000ff">sleep</font> ( <font color="#008000">5</font> ) </li><li>  <font color="#0000ff">puts</font> <font color="#008000">"Five"</font> </li><li>  } </li><li>  } </li><li>  thr_2 = <font color="#cc6633">Thread</font> .new { </li><li>  <font color="#0000ff">loop</font> { </li><li>  <font color="#0000ff">sleep</font> ( <font color="#008000">10</font> ) </li><li>  <font color="#0000ff">puts</font> <font color="#008000">"TEN"</font> </li><li>  } </li><li>  } </li><li>  thr_3 = <font color="#cc6633">Thread</font> .new { </li><li>  <font color="#0000ff">loop</font> { </li><li>  <font color="#0000ff">sleep</font> ( <font color="#008000">1</font> ) </li><li>  <font color="#0000ff">puts</font> <font color="#008000">"tick"</font> </li><li>  } </li><li>  } </li></ol></blockquote><br>  Those.  a program in which operations in cycles are performed with a different frequency (I wrote about it above), and literally accidentally discovered that thr_1.join (for example) ‚Äústarts‚Äù all threads, and not just itself. <br>  And then it was even stranger when I started trying to write in threads not eternal loops, but methods.  They could be executed, partially executed, or not executed at all.  The clouds were gathering, but through the pile of test programs I got to the truth, and here it is: <br><h2>  join is not a start! </h2><br>  As soon as we run our application, we get into Thread.main <br>  If all operations in it end, the application closes.  If there are other threads, the application closes, regardless of them. <br>  For example, if, in addition to creating threads, there is nothing more to be done at all, then the program will terminate immediately, without executing, the code in the threads created - what happened to me at the beginning. <br>  join makes a thread from which it is called asleep, until the end of the thread to which it is called. <br>  Those.  At the beginning, I made a sleeping Thread.main until the completion of thr_1.  Thread.main became inactive, but did not end, waiting for the completion of the thr_1 thread, so the application did not end either, and the other threads happily continued to work. <br><h2>  Run threads with the sleep team! </h2><br>  The easiest way to extend Thread.main is to put it to sleep. <br><blockquote> <code><a href="http://s-c.me/1049/s"></a> <a href="http://s-c.me/1049/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  <font color="#cc6633">Thread</font> .new { </li><li>  <font color="#0000ff">puts</font> <font color="#008000">"Finally"</font> </li><li>  } </li><li>  <font color="#cc6633">Thread</font> .new { </li><li>  <font color="#0000ff">puts</font> <font color="#008000">"we run!"</font> </li><li>  } </li><li>  <font color="#0000ff">sleep</font> <font color="#008000">5</font> <font color="#696969"># put to sleep</font> </li><li>  <font color="#0000ff">sleep</font> # or forever </li></ol></blockquote><br><h2>  run </h2><br>  Sleeping streams, incl.  Thread.main, you can run again with the run <br>  And stop using sleep or Thread.stop methods. <br><blockquote> <code><a href="http://s-c.me/1050/s"></a> <a href="http://s-c.me/1050/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  thr = <font color="#cc6633">Thread</font> .new { </li><li>  <font color="#0000ff">sleep</font> <font color="#696969">#z z Z</font> </li><li>  <font color="#0000ff">puts</font> <font color="#008000">"..not sleep .."</font> </li><li>  <font color="#0000ff">puts</font> <font color="#008000">"and you don't sleep"</font> </li><li>  <font color="#cc6633">Thread</font> .main.run </li><li>  } </li><li>  <font color="#cc6633">Thread</font> .new { </li><li>  <font color="#0000ff">sleep</font> <font color="#008000">1</font> </li><li>  <font color="#0000ff">puts</font> <font color="#008000">"Wake up!"</font> </li><li>  thr.run </li><li>  } </li><li>  <font color="#cc6633">Thread</font> .stop </li></ol></blockquote><br><br>  All for today with threads.  This is my first article (in general).  I will listen to the reviews and, perhaps, continue the story :) </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/53214/">https://habr.com/ru/post/53214/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../53206/index.html">FastCGI application in Perl. Part two.</a></li>
<li><a href="../53209/index.html">usb + usb. link laptops</a></li>
<li><a href="../53210/index.html">PHP - getting the amount in words</a></li>
<li><a href="../53211/index.html">sidboxes</a></li>
<li><a href="../53212/index.html">Soul is burning, I can not hold on anymore</a></li>
<li><a href="../53215/index.html">Testing Drive</a></li>
<li><a href="../53217/index.html">Compressing files in a multi-core era</a></li>
<li><a href="../53218/index.html">QuickTime native support appears in Windows 7</a></li>
<li><a href="../53219/index.html">How to install Debian Linux with USB flash</a></li>
<li><a href="../53220/index.html">Comment rating</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>