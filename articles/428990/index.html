<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Configuration examples for UIViewControllers using RouteComposer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous article, I talked about the approach that we use to implement composition and navigation between view controllers in several applicati...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Configuration examples for UIViewControllers using RouteComposer</h1><div class="post__text post__text-html js-mediator-article"><p>  In the previous <a href="https://habr.com/post/421097/">article,</a> I talked about the approach that we use to implement composition and navigation between view controllers in several applications that I work on, which ultimately resulted in a separate library <a href="https://github.com/saksdirect/route-composer">RouteComposer</a> .  I received a weighty amount of pleasant responses to the previous article and some practical advice that prompted me to write one more, which would explain a little more how the library was configured.  Under the cut, I will try to make out a few of the most frequent configurations. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/d7f/4aa/20b/d7f4aa20b4b089f9de5a0f13600f9a1f.jpg"></p><a name="habracut"></a><br><h3 id="kak-router-razbiraet-konfiguraciyu">  How the router parses the configuration </h3><br><p>  To begin, consider how the router parses the configuration you wrote.  Take the example from the previous article: </p><br><pre><code class="hljs pgsql">let productScreen = StepAssembly(finder: ClassFinder(<span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: [.<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>, .visible]), factory: ProductViewControllerFactory()) .<span class="hljs-keyword"><span class="hljs-keyword">using</span></span>(UINavigationController.pushToNavigation()) .<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>(SingleContainerStep(finder: NilFinder(), factory: NavigationControllerFactory())) .<span class="hljs-keyword"><span class="hljs-keyword">using</span></span>(GeneralAction.presentModally()) .<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>(GeneralStep.<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>()) .assemble()</code> </pre> <br><p>  The router will go through the chain of steps starting from the very first, until one of the steps (using the provided <code>Finder</code> ) ‚Äúinforms‚Äù that the desired <code>UIViewController</code> already on the stack.  <em>(So, for example, <code>GeneralStep.current()</code> guaranteed to be present on the stack with a view of controllers)</em> Then the router starts moving back through the chain of steps creating the required <code>UIViewController</code> using the provided <code>UIViewController</code> and integrating them using the specified <code>UIViewController</code> .  Thanks to type checking at compile time, most often, you cannot use <code>UITabBarController.addTab</code> that are incompatible with the provided <code>Fabric</code> (that is, you cannot use <code>UITabBarController.addTab</code> as a controller built by <code>NavigationControllerFactory</code> ). </p><br><p>  If we present the configuration described above, then if you just have a non- <code>ProductViewController</code> on the screen, the following steps will be performed: </p><br><ol><li>  <code>ClassFinder</code> will not find the <code>ProductViewController</code> and the router will move on. </li><li>  <code>NilFinder</code> will never find anything and the router will move on </li><li>  <code>GeneralStep.current</code> will always return the topmost <code>UIViewController</code> in the stack. </li><li>  Starting <code>UIViewController</code> found, the router will turn back </li><li>  Build <code>UINavigationController</code> using `NavigationControllerFactory </li><li>  Will show it modally using <code>GeneralAction.presentModally</code> </li><li>  <code>ProductViewController</code> create a <code>ProductViewController</code> using the <code>ProductViewControllerFactory</code> </li><li>  Integrates the created <code>ProductViewController</code> into the previous <code>UINavigationController</code> using <code>UINavigationController.pushToNavigation</code> </li><li>  Finish the navigation </li></ol><br><p>  <strong>NB:</strong> <em>It should be understood that in reality it is impossible to show the modal <code>UINavigationController</code> without some <code>UIViewController</code> inside it.</em>  <em>Therefore, steps 5-8 will be executed by the router in a slightly different order.</em>  <em>But this should not be thought of.</em>  <em>The configuration is described sequentially.</em> </p><br><p>  A good practice when writing a configuration is the assumption that the user can currently be anywhere in your application, and, suddenly, receives a push message demanding to get to the screen you are describing and try to answer the question - "How should an application behave? ? "," How will Finders behave in the configuration that I describe? ".  If all these questions are taken into account - you get a configuration that is guaranteed to show the user the desired screen wherever he is.  And this is the main requirement for modern applications from the teams involved in marketing and engaging <em>(engaging)</em> users. </p><br><h3 id="stackiteratingfinder-i-ego-opcii">  <code>StackIteratingFinder</code> and its options: </h3><br><p>  You can implement the <code>Finder</code> concept in any way that you consider most appropriate.  However, the easiest is to iterate over the graph of view controllers on the screen.  To simplify this goal, the library provides <code>StackIteratingFinder</code> and various implementations that will take on this task.  You will only have to answer the question - is this the <code>UIViewController</code> that you are expecting. </p><br><p>  In order to influence the behavior of <code>StackIteratingFinder</code> and tell it in which parts of the graph (stack) I twist the controllers you want what it would look for, when creating it you can specify the <code>SearchOptions</code> combination.  And they should be discussed in more detail: </p><br><ul><li>  <code>current</code> : The topmost view controller in the stack.  (The one that is the <code>rootViewController</code> the <code>UIWindow</code> or the one that is shown modally at the very top) </li><li>  <code>visible</code> : In the event that the <code>UIViewController</code> is a container ‚Äî look for its visible <code>UIViewController</code> ah (For example: the <code>UINavigationController</code> always has one visible <code>UIViewController</code> , the <code>UISplitController</code> can have one or two depending on how it is presented.) </li><li>  <code>contained</code> : In the event that the <code>UIViewController</code> is a container - look in all its nested <code>UIViewController</code> ah (For example: Go through all twist <code>UINavigationController</code> controllers including the visible one) </li><li>  <code>presenting</code> : Search also in all <code>UIViewController</code> ah under the <code>UIViewController</code> (if there are of course) </li><li>  <em><code>presented</code></em> : Look in <code>UIViewController</code> ah above the provided one (for <code>StackIteratingFinder</code> this option does not make sense, as it always starts from the top) </li></ul><br><p>  The following figure may make the explanation above more visual: <br><img src="https://habrastorage.org/webt/4j/pn/p5/4jpnp5peadzdj-cbk0tlfusbwxe.png"></p><br><p>  I would recommend to familiarize with the concept of containers in the previous article. </p><br><p>  <em>Example</em> If you want your <code>Finder</code> look for an <code>AccountViewController</code> in the entire stack, but only among the visible <code>UIViewController</code> then this should be written like this: </p><br><pre> <code class="hljs pgsql">ClassFinder&lt;AccountViewController, <span class="hljs-keyword"><span class="hljs-keyword">Any</span></span>?&gt;(<span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: [.<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>, .visible, .presenting])</code> </pre> <br><p>  <strong>NB</strong> <em>If for some reason the settings provided are few, you can always easily write your own implementation of <code>Finder</code> a.</em>  <em>One example will be in this article.</em> </p><br><p>  Let us proceed, in fact, to examples. </p><br><h3 id="primery-konfiguraciy-s-poyasneniyami">  Examples of configurations with explanations </h3><br><h4 id="u-menya-est-nekiy-uiviewcontroller-kotoryy-yavlyaetsya-rootviewcontrollerom-uiwindow-i-ya-hochu-chtoby-po-okonchanii-navigacii-on-zamenilsya-na-nekiy-homeviewcontroller">  I have a certain <code>UIViewController</code> , which is the <code>rootViewController</code> the <code>UIWindow</code> , and I want it to be replaced with a <code>HomeViewController</code> after the end of the navigation: </h4><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> screen = StepAssembly( finder: ClassFinder&lt;HomeViewController, Any?&gt;(), factory: XibFactory()) .<span class="hljs-keyword"><span class="hljs-keyword">using</span></span>(GeneralAction.replaceRoot()) .<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>(GeneralStep.root()) .assemble()</code> </pre><br><p>  <em><code>XibFactory</code> load the <code>HomeViewController</code> from the xib file of the <code>HomeViewController.xib</code></em> </p><br><p>  <em>Do not forget that if you use the abstract implementations of <code>Finder</code> and <code>Factory</code> in combination, you must specify the <code>UIViewController</code> type and context in at least one of the entities - <code>ClassFinder&lt;HomeViewController, Any?&gt;</code></em> </p><br><h4 id="chto-proizoydet-esli-v-primere-vyshe-ya-zamenyu-generalsteproot-na-generalstepcurrent">  What happens if, in the example above, I replace <code>GeneralStep.root</code> with <code>GeneralStep.current</code> ? </h4><br><p>  The configuration will work until it is called at the moment when there is any modal <code>UIViewController</code> on the screen.  In this case, <code>GeneralAction.replaceRoot</code> will not be able to replace the root controller, since there is a modal controller above it, and the router will report an error.  If you want this configuration to work in any case, then you need to explain to the router that you want <code>GeneralAction.replaceRoot</code> be applied specifically to the root <code>UIViewController</code> .  Then the router will remove all <code>UIViewController</code> and the configuration will work in any case. </p><br><h4 id="ya-hochu-pokazat-nekiy-accountviewcontroller-v-sluchae-esli-on-esche-nu-pokazan-vnutri-lyubogo-uinavigationcontrollera-kotoryy-v-dannyy-moment-est-gde-libo-na-ekrane-dazhe-esli-etot-uinavigationcontroller-pod-nekim-modalnym-uiviewcontrollerom">  I want to show a certain <code>AccountViewController</code> , in case it is still well shown, inside any <code>UINavigationController</code> and which is currently on the screen somewhere (even if this <code>UINavigationController</code> under a certain modal <code>UIViewController</code> ): </h4><br><pre> <code class="hljs pgsql">let screen = StepAssembly( finder: ClassFinder&lt;AccountViewController, <span class="hljs-keyword"><span class="hljs-keyword">Any</span></span>?&gt;(), factory: XibFactory()) .<span class="hljs-keyword"><span class="hljs-keyword">using</span></span>(UINavigationController.pushToNavigation()) .<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>(SingleStep(ClassFinder&lt;UINavigationController, <span class="hljs-keyword"><span class="hljs-keyword">Any</span></span>?&gt;(), NilFactory())) .<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>(GeneralStep.<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>()) .assemble()</code> </pre><br><p>  What does <code>NilFactory</code> mean in this configuration?  By doing so, you tell the router that if he could not find a single <code>UINavigationController</code> on the screen, you do not want him to create it and that he simply did not do anything in this case.  By the way, since this is <code>NilFactory</code> , you cannot use <code>Action</code> after it. </p><br><h4 id="ya-hochu-pokazat-nekiy-accountviewcontroller-v-sluchae-esli-on-esche-ne-pokazan-vnutri-lyubogo-uinavigationcontrollera-kotoryy-v-dannyy-moment-est-gde-libo-na-ekrane-a-esli-takovogo-uinavigationcontrollera-ne-okazhetsya---sozdat-ego-i-pokazat-modalno">  I want to show a certain <code>AccountViewController</code> , in case it is not yet shown, inside any <code>UINavigationController</code> and which currently is somewhere on the screen, and if there is no <code>UINavigationController</code> , create it and show it modally: </h4><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">let</span></span> screen = <span class="hljs-type"><span class="hljs-type">StepAssembly</span></span>( finder: <span class="hljs-type"><span class="hljs-type">ClassFinder</span></span>&lt;<span class="hljs-type"><span class="hljs-type">AccountViewController</span></span>, <span class="hljs-type"><span class="hljs-type">Any</span></span>?&gt;(), factory: <span class="hljs-type"><span class="hljs-type">XibFactory</span></span>()) .using(<span class="hljs-type"><span class="hljs-type">UINavigationController</span></span>.<span class="hljs-type"><span class="hljs-type">PushToNavigation</span></span>()) .from(<span class="hljs-type"><span class="hljs-type">SwitchAssembly</span></span>&lt;<span class="hljs-type"><span class="hljs-type">UINavigationController</span></span>, <span class="hljs-type"><span class="hljs-type">Any</span></span>?&gt;() .addCase(expecting: <span class="hljs-type"><span class="hljs-type">ClassFinder</span></span>&lt;<span class="hljs-type"><span class="hljs-type">UINavigationController</span></span>, <span class="hljs-type"><span class="hljs-type">Any</span></span>?&gt;(options: .visible)) //   -    .assemble(<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: { //      return <span class="hljs-type"><span class="hljs-type">ChainAssembly</span></span>() .from(<span class="hljs-type"><span class="hljs-type">SingleContainerStep</span></span>(<span class="hljs-title"><span class="hljs-title">finder</span></span>: <span class="hljs-type"><span class="hljs-type">NilFinder</span></span>(), factory: <span class="hljs-type"><span class="hljs-type">NavigationControllerFactory</span></span>())) .using(<span class="hljs-type"><span class="hljs-type">GeneralAction</span></span>.<span class="hljs-title"><span class="hljs-title">presentModally</span></span>()) .from(<span class="hljs-type"><span class="hljs-type">GeneralStep</span></span>.<span class="hljs-title"><span class="hljs-title">current</span></span>()) .assemble() }) ).assemble()</code> </pre> <br><h4 id="ya-hochu-pokazat-uitabbarcontroller-s-tabami-soderzhaschimi-homeviewcontroller-i-accountviewcontroller-zameniv-im-tekuschiy-rut">  I want to show <code>UITabBarController</code> with <code>UITabBarController</code> containing <code>HomeViewController</code> and <code>AccountViewController</code> replacing the current <code>UITabBarController</code> with it: </h4><br><pre> <code class="hljs pgsql">let tabScreen = SingleContainerStep( finder: ClassFinder(), factory: CompleteFactoryAssembly(factory: TabBarControllerFactory()) .<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>(XibFactory&lt;HomeViewController, <span class="hljs-keyword"><span class="hljs-keyword">Any</span></span>?&gt;(), <span class="hljs-keyword"><span class="hljs-keyword">using</span></span>: UITabBarController.addTab()) .<span class="hljs-keyword"><span class="hljs-keyword">with</span></span>(XibFactory&lt;AccountViewController, <span class="hljs-keyword"><span class="hljs-keyword">Any</span></span>?&gt;(), <span class="hljs-keyword"><span class="hljs-keyword">using</span></span>: UITabBarController.addTab()) .assemble()) .<span class="hljs-keyword"><span class="hljs-keyword">using</span></span>(GeneralAction.replaceRoot()) .<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>(GeneralStep.root()) .assemble()</code> </pre> <br><h4 id="mogu-li-ya-ispolzovat-kastomnyy-uiviewcontrollertransitioningdelegate-s-ekshenom-generalactionpresentmodally">  Can I use a custom <code>UIViewControllerTransitioningDelegate</code> with a <code>GeneralAction.presentModally</code> action: </h4><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> transitionController = <span class="hljs-type"><span class="hljs-type">CustomViewControllerTransitioningDelegate</span></span>() <span class="hljs-comment"><span class="hljs-comment">//     .using(GeneralAction.PresentModally(transitioningDelegate: transitionController))</span></span></code> </pre> <br><h4 id="ya-hochu-pereyti-v-accountviewcontroller-gde-by-polzovatel-ne-nahodilsya-v-drugom-tabe-ili-dazhe-v-kakom-to-modalnom-okne">  I want to go to <code>AccountViewController</code> , wherever the user is, in another tab or even in some modal window: </h4><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> screen = <span class="hljs-type"><span class="hljs-type">StepAssembly</span></span>( finder: <span class="hljs-type"><span class="hljs-type">ClassFinder</span></span>&lt;<span class="hljs-type"><span class="hljs-type">AccountViewController</span></span>, <span class="hljs-type"><span class="hljs-type">Any?</span></span>&gt;(), factory: <span class="hljs-type"><span class="hljs-type">NilFactory</span></span>()) .from(tabScreen) .assemble()</code> </pre> <br><p>  <em>Why do we use <code>NilFactory</code> ?</em>  <em>We do not need to build an <code>AccountViewController</code> in case it is not found.</em>  <em>It will be built in a <code>tabScreen</code> configuration.</em>  <em>See her above.</em> </p><br><h4 id="ya-hochu-pokazat-modalno-forgotpasswordviewcontroller-no-obyazatelno-posle-loginviewcontrollera-vnutri-uinavigationcontrollera">  I want to show the modal <code>ForgotPasswordViewController</code> , but, of <code>LoginViewController</code> , after <code>LoginViewController</code> and inside <code>UINavigationController</code> but: </h4><br><pre> <code class="hljs pgsql">let loginScreen = StepAssembly( finder: ClassFinder&lt;LoginViewController, <span class="hljs-keyword"><span class="hljs-keyword">Any</span></span>?&gt;(), factory: XibFactory()) .<span class="hljs-keyword"><span class="hljs-keyword">using</span></span>(UINavigationController.pushToNavigation()) .<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>(NavigationControllerStep()) .<span class="hljs-keyword"><span class="hljs-keyword">using</span></span>(GeneralAction.presentModally()) .<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>(GeneralStep.<span class="hljs-keyword"><span class="hljs-keyword">current</span></span>()) .assemble() let forgotPasswordScreen = StepAssembly( finder: ClassFinder&lt;ForgotPasswordViewController, <span class="hljs-keyword"><span class="hljs-keyword">Any</span></span>?&gt;(), factory: XibFactory()) .<span class="hljs-keyword"><span class="hljs-keyword">using</span></span>(UINavigationController.pushToNavigation()) .<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>(loginScreen.expectingContainer()) .assemble()</code> </pre> <br><p>  <em>You can use the configuration in the example for navigation and in <code>ForgotPasswordViewController</code> and in <code>LoginViewController</code></em> </p><br><h4 id="dlya-chego-expectingcontainer-v-primere-vyshe">  What is the <code>expectingContainer</code> in the example above? </h4><br><p>  Since the <code>pushToNavigation</code> action requires the presence of a <code>UINavigationController</code> and in the configuration after it, the <code>expectingContainer</code> method allows us to avoid compilation errors, ensuring that we take care that when the router reaches the <code>loginScreen</code> in <code>loginScreen</code> , there will be a <code>UINavigationController</code> . </p><br><h4 id="chto-proizoydet-esli-v-konfiguracii-vyshe-ya-zamenyu-generalstepcurrent-na-generalsteproot">  What happens if in the configuration above I replace <code>GeneralStep.current</code> with <code>GeneralStep.root</code> ? </h4><br><p>  It will work, but since you tell the router that you want it to start building a chain from the root <code>UIViewController</code> , then if any modal <code>UIViewController</code> are opened over it, the router will hide them before starting to build the chain. </p><br><h4 id="v-moem-prilozhenii-est-uitabbarcontroller-soderzhaschiy-homeviewcontroller-i-bagviewcontroller-v-kachestve-tabov-ya-hochu-chtoby-polzovatel-mog-mezhdu-nimi-pereklyuchatsya-ispolzuya-ikonki-na-tabah-kak-obychno-no-esli-ya-vyzovu-konfiguraciya-programmno-naprimer-polzovatel-nazhmet-go-to-bag-vnutri-homeviewcontroller-prilozhenie-dolzhno-ne-pereklyuchit-tab-a-pokazat-bagviewcontroller-modalno">  In my application, there is a <code>UITabBarController</code> containing <code>HomeViewController</code> and <code>BagViewController</code> as tabs.  I want the user to switch between them using the icons on the tabs as usual.  But if I call the configuration programmatically (for example, the user clicks "Go to Bag" inside <code>HomeViewController</code> ), the application should not switch the tab, but show <code>BagViewController</code> modally. </h4><br><p>  There are 3 ways to achieve this in the configuration: </p><br><ol><li>  Nastrit <code>StackIteratingFinder</code> search only visible using [.current, .visible] </li><li>  Use <code>NilFinder</code> which will mean that the router will never find the BagViewController in <code>BagViewController</code> and will always create it.  However, this approach has a side effect - if, say, a user is already in <code>BagViewController</code> in a modal view, and, for example, clicks on a universal link that should show him <code>BagViewController</code> , then the router will not find it and create another instance and show it over it modally  This may not be what you want. </li><li>  Modify a bit <code>ClassFinder</code> so that it only <code>BagViewController</code> shown modally and ignores the rest, and already use it in the configuration. </li></ol><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ModalBagFinder</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StackIteratingFinder</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isTarget</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> viewController: BagViewController, with context: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> viewController.presentingViewController != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> screen = <span class="hljs-type"><span class="hljs-type">StepAssembly</span></span>( finder: <span class="hljs-type"><span class="hljs-type">ModalBagFinder</span></span>(), factory: <span class="hljs-type"><span class="hljs-type">XibFactory</span></span>()) .using(<span class="hljs-type"><span class="hljs-type">UINavigationController</span></span>.pushToNavigation()) .from(<span class="hljs-type"><span class="hljs-type">NavigationControllerStep</span></span>()) .using(<span class="hljs-type"><span class="hljs-type">GeneralAction</span></span>.presentModally()) .from(<span class="hljs-type"><span class="hljs-type">GeneralStep</span></span>.current()) .assemble()</code> </pre> <br><h3 id="vmesto-zaklyucheniya">  Instead of conclusion </h3><br><p>  I hope the ways to configure the router have become somewhat clearer.  As I said, we use this approach in 3 applications and have not yet encountered a situation where it would not be flexible enough.  The library, as well as the implementation of the router provided to it, does not use any tricks with objective runtime and fully follows all Cocoa Touch concepts, only helping to break the composition process into steps and performs them in a given sequence and tested with iOS versions 9 to 12. In addition This approach fits into all architectural patterns that imply working with the <code>UIViewController</code> stack (MVC, MVVM, VIP, RIB, VIPER, etc.) </p><br><p>  I will be glad to your comments and suggestions.  Especially if you think that some aspects should be discussed in more detail.  Perhaps the concept of contexts requires clarification. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/428990/">https://habr.com/ru/post/428990/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../428980/index.html">Offline JavaScript Broker</a></li>
<li><a href="../428982/index.html">How to write on D under ARM</a></li>
<li><a href="../428984/index.html">Julia and phase portraits of dynamic systems</a></li>
<li><a href="../428986/index.html">Conference ThinkJava # 8 in Kharkov</a></li>
<li><a href="../428988/index.html">Nature Tips - Cloudy Night Light</a></li>
<li><a href="../428992/index.html">Selective bypass blocking on routers with Padavan and Keenetic OS firmware</a></li>
<li><a href="../428994/index.html">Networking on Android using Corutin and Retrofit</a></li>
<li><a href="../428996/index.html">Club of anonymous Santa Clauses 2018-2019 in Habrahabr</a></li>
<li><a href="../428998/index.html">How to use the new experimental Profiler feature in React</a></li>
<li><a href="../429000/index.html">Why did Bill Gates invent a $ 233 billion toilet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>