<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Remote debugging javascript with VS2015. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I propose a translation of the article ‚ÄúVS2015 Remote Debugging Javascript‚Äù . 

 VS2015 provides a first-class debugging experience for JavaScript cod...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Remote debugging javascript with VS2015. Part 1</h1><div class="post__text post__text-html js-mediator-article">  <i>I propose a translation of the article <a href="http://blogs.msdn.com/b/prakashpatel/archive/2015/10/23/vs2015-remote-debugging-javascript.aspx">‚ÄúVS2015 Remote Debugging Javascript‚Äù</a> .</i> <br><br>  VS2015 provides a first-class debugging experience for JavaScript code.  You can use remote debugging functions to debug JavaScript code on a remote machine.  The process being debugged can be an IE, a Windows Store app, or even a .NET application that uses a control for an embedded browser!  Almost everything that you can debug locally is also available for remote debugging.  This gives us great opportunities, for example, now you can debug your JavaScript code working in the QA or Production environment directly.  To get started, you can use the following steps. <br><a name="habracut"></a><br>  <strong>Install Visual Studio 2015 on the development machine</strong> .  Most developers are aware of how to do this, so we will not dwell on it in detail. <br><br>  <strong>Install VS 2015 Remote Debugger on target machine:</strong> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  Visit <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D48155%26NavToggle%3DTrue">www.microsoft.com/en-us/download/details.aspx?id=48155&amp;NavToggle=True</a> and download the version corresponding to the bitness of the target system.  You can also install a remote debugger on Windows with an ARM processor. <br><br></li><li>  Double-click on rttols_setup_x64.exe launch the installer: <br><br><img src="https://habrastorage.org/files/04e/986/305/04e986305166435297e6dc20c195157a.png" alt="image"><br><br></li><li>  After clicking on Install, a UAC (User Account Control) confirmation window will appear.  Administrator rights are required to install remote debugging tools.  Click Yes to continue the installation: <br><br><img src="https://habrastorage.org/files/40d/43a/b7c/40d43ab7c5d648648a6d4b886825057d.png"><br><br></li><li>  The program installs the necessary files: <br><br><img src="https://habrastorage.org/files/1da/c59/e0c/1dac59e0c0da4ad79034794b0a6f6b20.png"><br><br></li><li>  Click Close and the installation is complete: <br><br><img src="https://habrastorage.org/files/a5b/53f/37a/a5b53f37ac404da181e4981aa7c0b86b.png"><br><br></li><li>  After successful installation on the target machine, we will be able to discover the new Remote Debugger application: <br><br><img src="https://habrastorage.org/files/fa2/f07/a00/fa2f07a00df54e7993333c1270fb01a5.png"><br></li></ol><br>  <strong>VS 2015 Remote Debugger configuration on target machine.</strong> <br><br><ol><li>  Click on the VS2015 Remote Debugger Configuration Wizard.  The system will ask you to enter the credentials of the system administrator, or will offer to launch with elevated privileges, after providing which, in fact, the wizard will start.  Click Next to continue: <br><br><img src="https://habrastorage.org/files/5af/0cd/193/5af0cd1936fd4b0f9c7c80f273c0b5af.png"><br><br></li><li>  Select Run the Visual Studio 2015 Remote Debugger service and click Next.  You do not need to enter a password for the LocalSystem account.  Also, for the service to work, you can enter / provide other credentials with administrative rights on the target machine: <br><br><img src="https://habrastorage.org/files/9ae/5e9/545/9ae5e954555d4480a0f15aad87531f17.png"><br><br></li><li>  On the next screen, you may want to deselect the third option if the machine is inside the corporate domain and if you connect to the machine directly using an Ethernet cable.  Click to continue Next: <br><br><img src="https://habrastorage.org/files/306/db9/7a4/306db97a4663453f84d43f0aa7730318.png"><br><br></li><li>  Click Finish to complete the configuration: <br><br><img src="https://habrastorage.org/files/935/988/7e0/9359887e099d4e7999202de28a6b1402.png"><br><br></li><li>  Now open the task manager and make sure that the remote debugger is running and ready for use.  On a 64-bit system, we see two instances of the debugger: 32-bit and 64-bit. <br><br><img src="https://habrastorage.org/files/fd3/346/409/fd33464095dd45e796bff07134091714.png"><br><br></li></ol><br>  <strong>Connect VS2015 to VS2015 Remote Debugger on the target machine.</strong> <br><br><ol><li>  Run Internet Explorer <strong>on the target machine</strong> where the VS2015 Remote Debugger has just been installed.  Let's open in it any site for debugging, for example, msn.com. <br><br></li><li>  On the developer's machine, open VS2015.  Click <strong>Debug -&gt; Attach to Process ...</strong> <br><br><img src="https://habrastorage.org/files/041/c38/10d/041c3810d1e44102a1e5da13229b1a31.png"><br><br></li><li>  In the <strong>Attach to Process</strong> window, specify the target machine in the <strong>Qualifier</strong> field.  Or press the <strong>Find</strong> button to search for the machine in the domain.  In the example, the target machine is named <em>ContosoDev2</em> : <br><br><img src="https://habrastorage.org/files/599/cf1/6bd/599cf16bd3aa454fa68496a63d42dc74.png"><br><br></li><li>  By default, the list will not be updated, so click on the <strong>Refresh</strong> button to display a list of running processes.  You can also select the <strong>Show processes from all users</strong> option if you want to debug a process started by another user.  Select our target process <em>iexplore.exe</em> and click the <strong>Attach</strong> button: <br><br><img src="https://habrastorage.org/files/ad9/451/b32/ad9451b32aa144e5bde9285e80f9a4ff.png"><br><br><img src="https://habrastorage.org/files/4cf/105/33f/4cf10533f54949059523739aa7ec39e5.png"><br><br>  Notes: <br><br><ul><li>  If the remote debugger has been configured to run under the <strong>LocalSystem account</strong> , then you will need to select the <strong>Show processes from all users</strong> option to see your processes.  Otherwise, only the <strong>SYSTEM</strong> account processes will be listed. </li><li>  A qualifier ( <strong>Qualifier</strong> field) can change from <em>ContosoDev2</em> to <em>ContosoDev2: 4020</em> </li><li>  Make sure that the <strong>Script code is</strong> selected in the <strong>Attach to</strong> field (as in the screenshot) </li></ul><br></li><li>  Visual Studio will warn you about possible security issues when connecting to a remote process.  If you know the remote process and the site opened in it, click Attach to continue: <br><br><img src="https://habrastorage.org/files/6b7/4f2/95c/6b74f295c82240a08dd5081f75f6c152.png"><br><br></li><li>  After a successful connection, you should see the JavaScript files in the Solution Explorer.  The DOM Explorer will also display the structure of the running site: <br><br><img src="https://habrastorage.org/files/273/a05/dff/273a05dffce74bcaa7a605d82cbdea28.png"><br><br><img src="https://habrastorage.org/files/a9b/f6f/bb1/a9bf6fbb15b8403b92a151149757edb1.png"><br><br></li><li>  And so, now we can debug our miracle site, opened on a remote machine, as usual: <br><br><img src="https://habrastorage.org/files/b84/c2a/a02/b84c2aa027634d8cbbf0ee258ebf42f4.png"><br><br></li></ol><br>  <strong>Debugging JS code in the Web browser control (WebOC).</strong>  You can debug not only IE, but also the application (.NET / C ++ | managed / native), which is the host for WebOC or Web Browser Control.  To do this, simply run the application on the target machine.  In our example, the name of the .NET application with WebOC will be PCOETest.exe.  Open VS2015 and, following the process already described to connect to a remote process, connect to your application instead of IE. <br><br><img src="https://habrastorage.org/files/c56/49e/852/c5649e852ad84371a5f47d9c94e2b951.png"><br><br>  You can debug as if it were a local managed application that hosts the web browser control. <br><br><img src="https://habrastorage.org/files/9d0/ff0/af1/9d0ff0af15dd4e23abcb6485b4dcbae7.png"><br><br><img src="https://habrastorage.org/files/1cb/225/535/1cb2255352e4463991ad464eb5d33933.png"><br><br>  <strong>Frequently asked questions about debugging and fixing problems (FAQ).</strong> <br><br><ol><li>  <em><strong>I can not find a computer</strong></em> .  Make sure that the firewall does not block connections.  You can use a utility like <a href="https://technet.microsoft.com/en-us/library/bb897437.aspx">TCPView</a> to see if the port is open.  You can also refer to the <strong>Firewall Configuration</strong> section or the remote debugger help file on the target machine for additional information. <br><br>  Behind the scenes, the VS 2015 Remote Debugger installation process configures firewall rules to enable remote debugging.  The default remote debugger uses TCP port 4020. You can use another port if necessary.  Make sure that <strong>msvsmon.exe</strong> on port 4020 (or on your selected port) is a firewall or other security software.  For x86 process on 64-bit OS, check also that port 4021 is open. <br><br></li><li>  <strong><em>I don't see threads in the VS2015 Threads window when debugging the IE process.</em></strong>  <strong><em>Or I can not debug IE / target process.</em></strong> <br><br>  Make sure that you are connecting to the correct instance of IE.  IE starts two processes on initial loading - the frame process and the tab process.  You must connect the debugger to the tabs process, not the frames.  Additional Information: <a href="http://blogs.msdn.com/b/ie/archive/2008/03/11/ie8-and-loosely-coupled-ie-lcie.aspx">LCIE</a> <br><br></li><li> <strong><em>I still don‚Äôt see any threads in the VS2015 Threads window when connecting to the IE tabs (IE Tab Process) process.</em></strong> <br><br>  Check out the Visual Studio JavaScript Console window.  Do you see errors like this? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b11/98b/8bf/b1198b8bf6454451e1b1acbdc9fb8876.png" width="539" height="103"><br><br>  If yes, then you need to configure IE on the target machine to enable script debugging.  So: <br><br><ul><li>  Open the Internet Explorer process on the target machine. </li><li>  Click <strong>Tools -&gt; Internet Options</strong> , select the <strong>Advanced</strong> tab </li><li>  On the Advanced tab, deselect the following two items: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1b4/a91/c96/1b4a91c96990ef1a580c4fa077bd8e91.png" width="280" height="358"><br><br></li><li>  Click OK or Apply to apply the changes. </li><li>  Turn off the debugger \ stop debugging and try to connect the debugger again </li></ul><br><br></li><li>  <strong><em>I still do not see the threads when connecting to the desired IE process (even after removing these two options).</em></strong> <br>  Make sure that you have restarted the IE process or launched a new one.  Connect the VS debugger to this new process. <br><br></li><li>  <strong><em>Can I run multiple instances of the remote debugger?</em></strong>  <strong><em>Say one for each user?</em></strong> <br>  Multiple instances of the remote debugger can be run on one computer.  This is necessary if we have one server that is common to many users and each user wants to have their own instance of a remote debugger to debug their own processes. <br><br>  Each instance should work on its own TCP / IP port.  This can be set using the Tools -&gt; Options menu of the remote debugger or the command line key: <br><br>  / port: &lt;value&gt; <br><br>  To connect to a specific instance of the remote debugger, simply enter the computer name and, using a colon, the port number in the process connection window (for example, MyServer: 1234). <br><br></li><li>  <strong><em>Can I debug a remote service, say, a web service running on IIS?</em></strong> <br><br>  Yes.  You can start the remote debugger either as a Windows service or as a Windows application.  Running as a service makes it easy to debug server applications like ASP.NET without logging in to a remote machine. <br><br>  Running the debugger as a service causes it to always start and listen to the network.  It is not recommended to use the remote debugger running as a service to debug client applications. <br><br>  Using the Visual Studio 2015 Remote Debug Configuration Wizard, you can control the username and password of the account under which the remote debugger runs.  When the remote debugger is running as a service, the following requirements must be met in order to be able to debug the code remotely: <br><br><ul><li>  The user must be a member of the Computer Administrators group to be able to debug any process. </li><li>  The user should be granted the 'Log on as a service' right, which can be done using the 'Local Security Policy' administration utility. </li></ul><br>  The default user is ‚ÄúLocalSystem‚Äù. <br><br>  Service name: "Visual Studio 2015 Remote Debugger".  It is recommended to manage the service only using the Visual Studio 2015 Remote Debugger Configuration wizard.  If necessary, you can also use the administrative utility to manage a computer or command line: "net stop msvsmon140" or "net start msvsmon140". </li><li>  <strong><em>Can I debug code other than JS, such as .NET or T-SQL?</em></strong> <br><br>  Yes, you can debug any code that VS 2015 supports debugging: managed code, unmanaged, GPU, PowerShell, Script, T-SQL, Workflow ... <br><br><img src="https://habrastorage.org/files/cf2/69c/246/cf269c24603941d1b64868ae930e48c0.png"><br><br></li><li>  <strong><em>Is it necessary to install something on the target machine?</em></strong> </li><li>  <strong><em>What is needed to install VS2015 Remote Debugger?</em></strong> </li><li>  <strong><em>What does VS2015 Remote Debugger use within itself?</em></strong> <br><br>  Remote debugging is implemented using the Windows Web Services API.  The Windows Web Services API is a building block through which applications, such as the remote debugger, can communicate with each other over a network.  This API is already included in Windows 7, Windows Server 2008 R2 and later OS.  On Windows Server 2008 (before R2), the Visual Studio Remote Tools installer will automatically install the API. <br><br></li><li>  <strong><em>Can I start / stop the remote debugger using the command line?</em></strong> <br>  Yes, refer to the reference material for details. <br><br></li><li>  <strong><em>Can I run the process under debugging?</em></strong> <br><br>  Configure Visual Studio to connect to the remote debugger: <br><br><ul><li>  If you want to run a C # / VB project: open the project properties, go to the Debug tab, check the option to use the remote machine </li><li>  If you want to run a C ++ project: open the project properties, in the debugging options, change the Launch value to the Remote Windows Debugger and set the Remote Command property to the path that the remote computer should use </li><li>  To connect to an already running process: using the Attach to Process dialog (from the Tools or Debug menu items), enter the name of the remote computer in the Qualifier field, select the required process </li><li>  To debug a web site: open the web site from a remote computer (File Share) and then configure the Custom Web Server property to the URL value of the web server (eg <a href="http://myserver/">http: // myserver</a> ) </li><li>  To run an executable file without a project: create a debugging project by opening the executable file as a project (File-&gt; Open Project) and enter the path to the executable file (eg, \\ MyTestComputer \ c $ \ MyTest.exe).  Then open the project properties and change the Connection value.  Also correct the Executable property for the path that the remote machine should use. </li></ul><br></li></ol><br>  <strong>Firewall configuration:</strong> <br><br><ul><li>  The interaction between the VS2015 debugger and the target machine is always authenticated and subsequent calls are always encrypted </li><li>  To enable remote debugging, any firewalls between a computer with Visual Studio and a remote debugger must be configured so that the remote debugger (msvsmon.exe) can receive data sent from Visual Studio </li><li>  The remote debugger will automatically configure the firewall in most cases. <br><ul><li>  However, if not, open port 4020 (for 64-bit processes on x64 OS and 32-bit processes on x86 OS) and port 4021 (for 32-bit processes on x64 OS) </li><li>  The Remote Debugger Configuration dialog can be used for the Windows Firewall rule to apply to all network profiles (Domain, Private and Informal / Public).  Use Informal / Public when connecting the VS debugger directly to the target device using an Ethernet cable </li></ul><br></li></ul></div><p>Source: <a href="https://habr.com/ru/post/275473/">https://habr.com/ru/post/275473/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../275455/index.html">Parallel algorithms for processing BigData: pitfalls and difficult decisions</a></li>
<li><a href="../275459/index.html">Measurement of ore weight by stator current. Practice. Part 1. Signal processing algorithm in MK</a></li>
<li><a href="../275463/index.html">Using Chakra and JavaScript in Azure DocumentDB</a></li>
<li><a href="../275469/index.html">The most "New Year" messenger for Yota users is WhatsApp</a></li>
<li><a href="../275471/index.html">Eleven important ONLYOFFICE features that are not found in MS Office Online or in Google Docs</a></li>
<li><a href="../275475/index.html">Azure Machine Learning: Developing machine learning services and using them in a mobile application</a></li>
<li><a href="../275477/index.html">Javapocalypse in a single system</a></li>
<li><a href="../275479/index.html">Advanced Yandex (and Google) search using the installed script or in the interface</a></li>
<li><a href="../275481/index.html">Cloud Experience: How We Translated the KPI Suite to the Azure Platform</a></li>
<li><a href="../275483/index.html">The first game for iOS and the first difficulties. How not to give up and bring it to release</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>