<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>12 commandments about backup for which I almost paid a finger</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The last time I told you, I will not be afraid of this word, bloody history, as we urgently saved the installation first, and then the data. And such ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>12 commandments about backup for which I almost paid a finger</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/b84/c76/f37/b84c76f37f9c83b5547b68bd88021751.jpg"><br><br>  The last time I told you, I will not be afraid of this word, bloody history, as we urgently saved the installation first, and then the data.  And such stories once again make it clear the importance of having a backup and the correctness of its settings.  Today I want to summarize my thoughts accumulated over the past 10 years of experience in system integrator. <br><br>  <b>1. Backup should always be.</b> <br>  No matter how developed the technology is, a good old backup will never lose its value, saving us nerves, work, bonuses, and also sedatives in a difficult moment.  She, in case of anything, allows us not to panic, act weighed, allowing a reasonable risk. <br>  Even if in your server all components are duplicated, and the data lies on an expensive array with redundancy, drive away from you a false sense of security.  No one is immune from logical errors and the human factor. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i><b>An example from life.</b></i>  <i>For a short time, one of our customers worked as a comrade who, although he was not yet old, behaved like Leonid Ilyich at the dawn of paralytic ailments.</i>  <i>He walked around, leisurely and with pleasure talking, continually smacking his lips.</i>  <i>Any detail for a long time occupied his attention.</i>  <i>Once he typed in the unix console the rm -rf command, and before he was distracted by the conversation, he managed to add a slash, and then switched to the interlocutor.</i>  <i>When the conversation was over, the comrade turned to the monitor, frowned, trying to remember what he had been doing before, and decisively drove the damned screensaver by pressing Enter.</i>  <i>Needless to say, at that moment, the information, which was merrily rustling with the hard drives, was deleted from all copies of the RAID and even from the remote replicas of the array.</i>  <i>By the way, after this incident, I always return the computer from sleep mode with the Alt key - it's safer.</i> <i><br></i> <br><br>  <b>2. Backup should be automatic.</b> <br>  Only an automated backup that runs on a schedule allows us to recover relatively relevant data - for example, from yesterday, and not from March.  Backup must also be done before any potentially dangerous operations, be it equipment upgrades, microcode updates, patching, data migration.  We, for example, can even refuse to the customer in similar works if the backup copy is not made the day before. <br><br>  <b>3. Recovery from backup is an extreme measure.</b> <br>  It is necessary to resort to recovery when there are no other chances anymore.  Because it is always slow and it is always haste and stress.  There have been cases in our practice where the admins of customers rolled the wrong backup on the wrong system, only aggravating the situation. <br>  Therefore, it is better to recover not to the original disk space, so as not to overwrite the original data, but somewhere in the neighborhood, so that you can check that you have finally recovered. <br><br>  <b>4. Backup should be stored separately from the data and at least 2 weeks.</b> <br>  This is the recommended period for even a slow-moving accountant to come to his senses that something has gone missing or deteriorated.  But you can store longer, if space permits. <br><br>  Traditionally, magnetic tape is used to store backups due to its low cost. <br>  And it is also convenient to decorate with it the New Year's server room, compositions with orange optics look especially good. <br><br>  <i>Streamers and tape libraries are designed to work with tape.</i>  <i>A person loads a tape into a tape drive, and a robot in a tape library.</i>  <i>Therefore, the library is preferable, since</i>  <i>allows you to automate backup completely.</i> <i><br><br></i>  <i>Disk storages are even more preferable, as production becomes cheaper, it is no longer a luxury.</i>  <i>Storage systems differ in speed and reliability, of course, provided that RAID is used.</i>  <i>There are so-called virtual libraries - VTL - which can pretend to be a tape library, but the data is written to disks.</i> <br><br>  <b>5. Backup should be checked regularly.</b> <br>  The main drawbacks of the tape are consistent access to information and relatively low storage reliability.  There is no way to know if the backup from the tape will be restored without errors until you check it in practice.  Disk storages, unlike tapes, are protected from degaussing and, in general, are more predictable.  Nevertheless, regular testing of any backup allows you to sleep more easily. <br><br>  <b>6. It is useful to duplicate the backup to a remote site.</b> <br>  Man-made disasters, power outages in the whole city, the onslaught of zombies and other misfortunes await business at every corner.  Especially little studied are zombies.  Therefore, it is good practice to have a remote site, where, one way or another, backup copies fall. <br><br>  <i><b>How can this be organized?</b></i>  <i>In the simple case, the tapes are removed from the library, and their driver Uncle Vasya takes them somewhere to Khimki.</i>  <i>It is clear that Uncle Vasya also participates in the restoration, so he is the slowest stage in the whole chain.</i>  <i>Well, for those who have managed to build or use a full-fledged backup data center with a good channel for outsourcing, backup copies can be automatically duplicated using modern backup tools.</i>  <i>For example, having a Symantec NetBackup Appliance at each site for the APC, you can get a full-fledged DR site, where backups from the main site are obtained using Automatic Image Replication (AIR) technology.</i> <br><br>  <b>7. Backup is the load on a running system.</b> <br>  During copying, there may be a strong subsidence on the performance of the main system.  Therefore, backup copies are always planned for a period of minimal activity.  However, a growing number of systems that serve requests around the clock.  Therefore, to minimize the load appeared advanced technology, which are discussed further. <br><br>  <i>In ancient times, at night, all users were asleep, and the backup window could last, for example, from 11 pm to 7 am.</i>  <i>During this time, all the data had time to copy.</i>  <i>When the number of systems that serve customer requests began to grow at night, the speed of creating backup copies became more important.</i>  <i>Now you need to keep within a couple of hours, and for systems running 24x7, in minutes.</i>  <i>That is why the market of backup systems continues to grow rapidly, inventing new approaches.</i> <br><br>  <b>8. Data can be copied over SAN, not over LAN.</b> <br>  A large flow of copied data loads the network.  There is a technique called LAN-free backup.  If data storage and libraries are connected to the SAN (storage area network), then it is quite reasonable to transfer data between the storage system and the library directly over the SAN, while excluding the loading of the local network.  This is often faster, because the local network is far from being built on 10G, and the usual 1GB ethernet is much inferior in terms of throughput to even the most modern SAN. <br><br>  <b>9. Applications can be backed up on the go ...</b> <br>  It is impossible to create a consistent copy of data, for example, Oracle or MS Exchange DBMS: the information is constantly changing, some of it is in buffers, in RAM.  Serious industrial-grade products, such as Symantec NetBackup, EMC Networker, CommVault Simpana, and others, have a wide range of agents for working with various business applications.  These agents are able to transfer the application to the mode when the buffer is flushed to disk, and the data files temporarily stop changing. <br><br>  <b>10. ... and minimize the load on the main system.</b> <br>  In order not to keep the application for a long time in this mode of operation, this technique can be combined with creating snapshots ‚Äî snapshots of data.  Snapshot is created quickly, after which the application can be ‚Äúreleased‚Äù, and you can copy consistent data from snapshot.  To create snapshots, they use their own agents, which can also be included in the backup software. <br><br>  <i>If you create not just a snapshot of data, but a clone, you can detach it from the original data disk and transfer it via SAN to another host.</i>  <i>And already on another host, the backup program will see this data and transfer it to the backup storage.</i>  <i>This technique is called Offhost backup.</i> <br><br>  <b>11. Virtual machines need to try to back up the means of the hypervisor.</b> <br>  Modern hypervisors, such as VMware ESXi, provide tools for creating images of virtual machines on the fly, without stopping their work.  In fact - the same snapshots.  This virtual image is backed up as a file, but the top functionality of the backup tools is the ability to restore any object from this image granularly, for example, a single email if the mail server was working inside the virtual machine.  The most advanced features here, in my opinion, are products from Symantec. <br><br>  <b>12. Need to get rid of duplicates.</b> <br>  For example, each virtual machine has operating system components that are the same for all virtual machines, file dumps contain many copies of the same, mailing lists can duplicate the same letters and attachments in different mailboxes.  Deduplication allows you to back up only unique pieces of data and, moreover, once.  The degree of deduplication is often quite impressive, the numbers reach 90-98%.  This is worth thinking about. <br><br>  <i><b>Deduplication on the client.</b></i>  <i>If at first deduplication was performed only at the server or storage level (for example, DataDomain is a hardware deduplication solution), now some manufacturers have implemented deduplication already at the backup client level.</i>  <i>This allows not only to reduce the amount of stored information, but also the amount of information transmitted from the client.</i>  <i>In this case, the volume between the client and server consists primarily of a checksum flow.</i> <br><br>  There are many other nuances, it is impossible to cover everything with one article.  The main commandment is to give backup enough attention without delaying later.  And try not to bring it to be needed once.  And take care of your fingers) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f20/897/c35/f20897c3590693787944c8d1538016cc.jpg"><br><br>  I was given such a hand under insurance in exchange for chopped.  The fingers are plump, but overall fine.  They hold a cleaning cassette for a tape library. </div><p>Source: <a href="https://habr.com/ru/post/230153/">https://habr.com/ru/post/230153/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../230135/index.html">History of Audio-Technica</a></li>
<li><a href="../230137/index.html">Ordered a rare phone in a foreign online store? Get a subpoena</a></li>
<li><a href="../230141/index.html">BlackBerry has got its own Siri: BlackBerry Assistant</a></li>
<li><a href="../230143/index.html">vPath or how to create a service chain in a virtualization environment</a></li>
<li><a href="../230149/index.html">OpenVPN Access Server Desktop Client is vulnerable</a></li>
<li><a href="../230155/index.html">We write a simple system of recommendations on the example of Habr</a></li>
<li><a href="../230157/index.html">Apple and IBM became allies in conquering the corporate market.</a></li>
<li><a href="../230161/index.html">Who needs this HTML: ‚ÄúHow I wrote down a payment service in 2 months - and sent it to a landfill‚Äù</a></li>
<li><a href="../230163/index.html">How Sony makes high definition sound mainstream</a></li>
<li><a href="../230165/index.html">Kindle Unlimited: $ 9.99 monthly subscription to books from Amazon</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>