<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Search engine indexing in Evernote</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The index system in Evernote is designed to expand the search capabilities of Evernote and provide search through media files. Its task is to examine ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Search engine indexing in Evernote</h1><div class="post__text post__text-html js-mediator-article">  The index system in Evernote is designed to expand the search capabilities of Evernote and provide search through media files.  Its task is to examine the contents of these files and make any textual information found in them available for search.  It currently processes images and PDF files, as well as ‚Äúdigital ink‚Äù (digital ink), but we have plans to support indexing and other types of media files.  The resulting index is displayed in the form of an XML or PDF document and contains recognized words, alternative recognition options, as well as the coordinates of the found words in the document (for subsequent highlighting). <a name="habracut"></a><br><br>  The indexing system is implemented as a farm of dedicated Debian64 servers, each of which runs the management service AMP (Asynchronous Media Processor) and several ENRS processes (Evernote Recognition Server) - usually based on the total number of processor cores.  ENRS is implemented as a set of native libraries packaged in a Java6 web server application.  Now it includes two components under the code names AIR and ANR.  The first handles various types of images and PDF, and the second is designed for indexing ‚Äúdigital ink‚Äù.  AMP communicates with servers through the HTTP REST API, which allows flexible system configuration while maintaining high bandwidth when transferring large files. <br><br>  AMP receives source resources from cluster servers (shards) that store user data, and returns created indexes.  They will be included in the search index of the Evernote web service and will be synchronized to Evernote clients for computers and mobile devices to simplify local search in media files.  In order to minimize additional traffic to shards, AMP handlers already engaged in processing user requests in turn broadcast information to each other.  Thus, a single distributed media content handler is generated, optimized for current load priorities and service processes.  The Evernote indexing system turns out to be quite stable and will work even if only one component of each type remains in the system (currently the system includes 37 AMP handlers and over 500 ENRS server processes that deal with approximately 2 million media files per day). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/00d/2de/7a7/00d2de7a7bd4db9eec890079b13235a4.png" alt="image"><br><br>  Let's take a closer look at the AIR component in the ENRS server.  Ideologically, AIR recognition differs from traditional OCR systems, since its goal is to create not a complete readable text, but a full search index.  This means that we strive to find in the images the maximum number of words with any minimum acceptable quality, including alternative readings for incomplete, fuzzy and out-of-focus word images. <br><br>  When recognizing images from the real world, the AIR server processes them in several approaches, each time making different assumptions.  The image can be huge, but contain only a few words.  It may also contain words scattered in a picture and differently oriented in space.  Fonts can be both very small and large enough in the same area.  The text can alternate: black on a white background and immediately white on black.  It can be a mixture of different languages ‚Äã‚Äãand alphabets.  In the case of Asian languages, horizontal and vertical text lines can be represented in one area.  Font colors with the same intensity can merge into a single gray level during standard OCR processing.  Printed text may include handwritten comments.  Promotional material may contain text that is distorted, slanted or resized on the go.  And these are just a few of the problems that AIR servers now face about 2 million times a day. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f93/cb6/650/f93cb6650f5d003ba553939fb009d1c9.png" alt="image"><br><br>  Below is a diagram of a single ‚Äúpassage‚Äù of an AIR server.  Depending on the call parameters, such a pass will specialize in individual types of processing (size, orientation, etc.), but the basic scheme remains the same.  It begins with the preparation of a set of images for processing - scaling, translation in shades of gray, binarization.  Then pictures, tables, markup, and other non-text artifacts must be cleaned up to the maximum, so that the system can focus on specific words.  After the intended words are defined, they are assembled into text lines and blocks. <br><br>  Each row of each block will then be processed by several recognition mechanisms - among them are those that were developed within the company and licensed from other manufacturers.  The use of several mechanisms is important not only because they specialize in different types of text and languages, but also because they allow for the implementation of ‚Äúvoting‚Äù.  This implies the analysis of word recognition alternatives, which are the results of different processing mechanisms, which makes it possible to better cut off false recognitions and provides a higher-quality result due to the large number of proposed options.  These approved answers will form the basis from which the text string will be recreated at the final stage.  Re-use of solutions for text lines, segmentation of words and clearing away from the most questionable options will reduce the number of false positives during the search. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a86/4d6/e70/a864d6e7016a9a27377cb94fc97bfa0c.png" alt="image"><br><br>  The number of passes required to obtain the result is determined at the initial stage by the rendering and image analysis module, but as the recognition progress is made, this number can be increased or decreased.  In the case of a conventional clear scanned document, you can restrict yourself to the standard OCR recognition process.  A photograph of a complex scene taken by a phone camera under poor lighting may require in-depth analysis with a full set of passes to extract most text data.  The presence of a plurality of colored words on a heterogeneous background may require additional approaches specifically designed to separate the color.  The presence of a small blurred text will require the use of an expensive way of reversing digital filtering, which allows you to recover the text before recognizing. <br><br>  When all the passes are complete, it is time for another important part of the AIR process ‚Äî the final assembly of the results.  In complex images, different approaches can create completely different interpretations for the same areas.  All these conflicts should be resolved, the best interpretations should be chosen, most of the incorrect alternatives should be rejected and eventually the final blocks and lines of text should be built. <br><br>  After the internal structure of the document is created, the last step remains to form the necessary output format.  For PDF documents, this is still the same PDF, where the images are replaced by text blocks of recognized words.  For other incoming documents, this is an XML index that contains a list of recognized words and indications of their location or lists of strokes (for ‚Äúdigital ink‚Äù).  This location information will highlight the found word in the source image when the user searches for a document that contains the word. </div><p>Source: <a href="https://habr.com/ru/post/139857/">https://habr.com/ru/post/139857/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../139849/index.html">IIS 8: Dynamic IP Access Restriction</a></li>
<li><a href="../139850/index.html">Automation: quick start or ‚ÄúCome on, Excel, write for me!‚Äù</a></li>
<li><a href="../139852/index.html">Meet Parallels Automation for Cloud Infrastructure</a></li>
<li><a href="../139853/index.html">Attacks by anonymous hacker groups have practical financial implications.</a></li>
<li><a href="../139854/index.html">"Yandex" introduced the navigation service</a></li>
<li><a href="../139858/index.html">Asterisker's Notes - Asterisk based PBX</a></li>
<li><a href="../139860/index.html">DevBar - a pub for employees of the IT-industry and not only (St. Petersburg)</a></li>
<li><a href="../139862/index.html">Amazon Web Services + Ubuntu Server Cloud Guest</a></li>
<li><a href="../139863/index.html">Recommender systems: SVD Part I</a></li>
<li><a href="../139867/index.html">Microscopic 3D printing at 5 meters per second</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>