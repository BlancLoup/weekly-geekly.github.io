<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>About one mistake</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Maybe I'm wrong, but I firmly hold the opinion that some errors are no less interesting than the projects in which they occurred. I want to tell about...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>About one mistake</h1><div class="post__text post__text-html js-mediator-article">  Maybe I'm wrong, but I firmly hold the opinion that some errors are no less interesting than the projects in which they occurred.  I want to tell about one project in which I took part for a long time.  About how it would seem the correct use of cryptographic tools, led to the emergence of vulnerability, depriving the rest of the cryptography of any meaning. <br><br>  I will say right away that I do not consider myself a qualified specialist in the field of cryptography.  I dealt with cryptographic algorithms when the situation left me no other choice.  Of course, it would be better if someone who was more knowledgeable in the matter would be engaged in these works, but it turned out that I had to deal with them.  In any case, I hope that my story will be interesting. <br><a name="habracut"></a><br>  This story took place in the mid-90s.  I studied at the 4th year at <a href="http://www.kai.ru/">KAI</a> , while at the same time working as part of the <a href="http://www.kai.ru/univer/k4/pmi.phtml">PM</a> department.  I remember that I wrote something on FoxBase for one of the local "candle factories", together with several employees of the institute.  The work at the department itself contributed to the fact that I was constantly in sight and, at one fine moment, I was offered to participate in a new project related to the development of a hardware tool for cryptography.  Of course, I agreed. <br><br><div class="spoiler">  <b class="spoiler_title">Of course, it was not so easy</b> <div class="spoiler_text">  I was given a task.  They told in detail about the developed Device and asked to prepare its description for the impending exhibition.  For one night I worked at the institute (I didn‚Äôt have a computer at home then), on Turbo Pascal with assembler inserts I prepared a ‚Äúpresentation‚Äù with <a href="http://ru.wikipedia.org/wiki/EGA">EGA-</a> video effects, a bunch of text and pictures painted by Line and Fill ami  Potential employer slightly ofigel from the diligence shown by me and the question of my employment was resolved positively. <br></div></div><br>  Our group consisted of a pair of well-qualified cryptologists, electronics engineers and programmers.  I, as a young specialist, was engaged in <a href="http://ru.wikipedia.org/wiki/Hardware_abstraction_layer">HAL</a> th.  Nothing special, C ++ and some x86 assembler.  Subsequently, we, with the whole group, were very successfully employed in the RCI <a href="http://www.vep.ru/bbl/history/cbr-176.html">NB RT</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Here is what one of our products looked like ( <a href="http://ru.wikipedia.org/wiki/ISA">ISA</a> card with a removable key): <br><br><img src="https://habrastorage.org/storage2/228/c94/7b2/228c947b277cbb25fb5bab1a7176302f.jpg"><br><br>  In addition to the main purpose - streaming encryption by <a href="http://ru.wikipedia.org/wiki/%25D0%2593%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5">gamming</a> , it could also be used as a qualitative pseudo-random number generator.  The main feature of this device was the impossibility of intercepting key data using software bookmarks. <br><br>  Everything was connected as follows: <br><br><img src="https://habrastorage.org/storage2/5ab/d12/11e/5abd1211e292f18ff1fc48358fc8c217.jpg"><br><br>  Inside the key was a regular <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D1%2581%25D1%2582%25D0%25BE%25D1%258F%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25B7%25D0%25B0%25D0%25BF%25D0%25BE%25D0%25BC%25D0%25B8%25D0%25BD%25D0%25B0%25D1%258E%25D1%2589%25D0%25B5%25D0%25B5_%25D1%2583%25D1%2581%25D1%2582%25D1%2580%25D0%25BE%25D0%25B9%25D1%2581%25D1%2582%25D0%25B2%25D0%25BE">ROM-</a> card: <br><br><img src="https://habrastorage.org/storage2/abe/316/42e/abe31642e723346006831656e8c8610e.jpg"><br><br>  When encryption was performed, 16 bytes of the key (in a row) were read from the ROM at the specified address in the Device, after which, based on this key and random synchronization, the gamma used for encryption was generated.  The key itself on the PC has never been transmitted. <br><br>  I don‚Äôt remember who had the idea (perhaps it was me) that if you choose a key from ROM not in a row, but byte-by-by (controlling the sampling of each byte), then with the help of various permutations, you can get much more keys.  It was a really awful idea.  Quietly and imperceptibly, a hole was formed in the architecture of the hardware-software complex, which allows software to read the contents of the entire ROM of the key. <br><br><div class="spoiler">  <b class="spoiler_title">Details</b> <div class="spoiler_text">  Retrieving the contents of the ROM with the availability of byte-key loading is really easy.  For example, to determine the value of any byte of the address space of a key, it is sufficient to form a key consisting of 16 bytes loaded from the same address.  Then, on this key, you need to encrypt any preselected sequence (for example, a sequence of zeros). <br><br>  Since, with this method of loading a key, there are only 256 possible options, a table of encryption results can be built in advance.  From this table, you can easily determine which byte the key consists of.  In the same way, slowly but surely, you can read all the remaining contents of the hardware key. <br></div></div><br>  Fortunately, this vulnerability was noticed and fixed in time, but several devices had to be redone. <br><br>  With this small article I want to warn the Reader against the frivolous attitude to issues related to cryptography.  Cryptography is insidious and vulnerabilities can easily arise where you least expect them.  However, I do not call ‚Äúnon-professionals‚Äù to abandon the use of cryptography, just as is done in this <a href="http://habrahabr.ru/post/181372/">article</a> . <br><br>  Only experience and maximum attention to the task can help in detecting errors like the one described above.  And if in this direction does not work, then the experience will come from nowhere. <br></div><p>Source: <a href="https://habr.com/ru/post/181954/">https://habr.com/ru/post/181954/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../181940/index.html">Disappeared icons from the OS X taskbar.</a></li>
<li><a href="../181942/index.html">AWS Route53: DNS Failover Now Supports Elastic Load Balancer</a></li>
<li><a href="../181944/index.html">Nokia: design history</a></li>
<li><a href="../181948/index.html">Big Russian Google Glass Review</a></li>
<li><a href="../181950/index.html">What skills do technical support staff need in 2013?</a></li>
<li><a href="../181956/index.html">Fault tolerance of systems based on HP Storageworks P4xxx without a third data center</a></li>
<li><a href="../181960/index.html">Spintires - (Mud simulator on Kickstarter) - "the taiga, which needs your wings"</a></li>
<li><a href="../181968/index.html">Video Recorder for IPTV version ++</a></li>
<li><a href="../181970/index.html">Dell XPS 13 Developer Edition, or Ubuntu comes on ultrabooks</a></li>
<li><a href="../181974/index.html">About popular games in the Apple AppStore and Google Play</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>