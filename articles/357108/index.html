<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why two-factor authentication in Telegram does not work</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After the recent high-profile hacking of Telegram accounts in Russia, the founder of the service, Pavel Durov, said that two-factor authorization "all...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why two-factor authentication in Telegram does not work</h1><div class="post__text post__text-html js-mediator-article">  After the <a href="http://mts-slil.info/">recent high-profile hacking of</a> Telegram accounts in Russia, the founder of the service, Pavel Durov, <a href="http://echo.msk.ru/blog/echomsk/1758308-echo/">said</a> that two-factor authorization "allows you to protect important information." <br><br>  Yes, if the two-factor authentication in Telegram is enabled, then the attacker who hijacked your account will not receive the history of your correspondence - but this two-factor does not protect against theft, although it seems like it should. <br>  That is, if an attacker can receive your SMS with a login code, then he is guaranteed to hijack your account, regardless of whether you have two-factor authentication enabled or not. <br><br>  By ‚Äúhijack‚Äù I understand ‚Äúcan enter the Telegram application under your phone number‚Äù and write messages on your behalf to your contacts. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It happens as follows: <a name="habracut"></a><br><br>  1. The attacker in his application indicates the phone number of the victim and tries to enter the account.  Here he sees a message that the code was sent not by SMS, but to the application registered to this number on another device: <br><br><img src="https://habrastorage.org/files/878/3dc/e2f/8783dce2f4cb4e5792a48eefffb92ef0.png" alt="image"><br><br>  2. At this point, the victim receives a system notification in his application (or applications) Telegram: <br><br><img src="https://habrastorage.org/files/43f/30e/505/43f30e5050ff4b77bd689c2eb3fd8628.png" alt="image"><br><br>  3. The attacker clicks "Didn't get the code?" And Telegram sends the code via SMS: <br><br><img src="https://habrastorage.org/files/357/a98/521/357a98521fe4455894250527727e4bf8.png" alt="image"><br><br>  4. Here the attacker enters the code from the SMS and finds out that two-factor authorization is enabled in the account settings and that he needs to enter a password (in this case, ‚Äú10‚Äù is a hint for the password chosen when the two-factor was turned on): <br><br><img src="https://habrastorage.org/files/df2/b8b/27d/df2b8b27d85545998b000edeb8592dc7.png"><br><br>  5. Next, the attacker pretends that he forgot the password - ‚ÄúForgot password?‚Äù.  Here the attacker is informed that the recovery code has been sent by e-mail (if the victim specified the e-mail address when the two-factor authentication was enabled).  The attacker does not see the email address - he sees only that after the "dog": <br><br><img src="https://habrastorage.org/files/301/1c8/d11/3011c8d11e714adca98ab979e8282045.png"><br><br>  6. At this point, the victim receives a code to reset the password to an email address (if she specified an email address when enabling two-factor authentication): <br><br><img src="https://habrastorage.org/files/053/d7b/24b/053d7b24bc3a4570ad720d28c2b9b2be.png"><br><br>  7. The attacker clicks "ok" and sees a window where you need to enter the code to reset the password that was sent to the email.  Here the attacker says that he has problems with access to his mail - ‚ÄúHaving trouble accessing your e-mail?‚Äù.  Then Telegram offers ‚Äúreset your account‚Äù: <br><br><img src="https://habrastorage.org/files/d27/aea/26a/d27aea26a6a24cc086baf1b3ae4fc6d8.png"><br><br>  8. The attacker clicks "ok" and sees two options - either enter a password, or press "RESET MY ACCOUNT".  Telegram explains that when you ‚Äúreinstall‚Äù your account, all correspondence and files from all chats will be lost: <br><br><img src="https://habrastorage.org/files/ba6/13b/6b6/ba613b6b6a4f442a8c3219a1c5e39315.png"><br><br>  9. The attacker presses "RESET MY ACCOUNT" and sees a warning that this action cannot be undone and that all messages and chats will be deleted: <br><br><img src="https://habrastorage.org/files/783/ba4/8ac/783ba48acf644bb9bef62c56823d8792.png"><br><br>  10. The attacker clicks "RESET" and Telegram asks for a name for the "reinstalled" account: <br><br><img src="https://habrastorage.org/files/9f3/efe/751/9f3efe7516d94cf89ba28aef068b137a.png"><br><br>  11. Actually, everything, the attacker successfully hijacked the account: he entered under the victim's phone number and can write messages on her behalf: <br><br><img src="https://habrastorage.org/files/7c4/7ad/489/7c47ad489f7b4a1297786e093abb6ab2.png"><br><br>  12. The victim sees the application as it was immediately after installation.  The welcome screen tells about Telegram and offers to register or enter an existing account: <br><br><img src="https://habrastorage.org/files/591/312/c0c/591312c0ce1146f5a1db8edfda33288d.png"><br><br>  13. When an attacker writes on behalf of a victim to someone from the victim's contacts, this contact sees that the victim has just joined Telegram (which is suspicious), as well as a new message (or messages) in the new chat from the victim.  After 12‚Äì16 hours, the contact will also see that in the old chat rooms the victim‚Äôs name is ‚ÄúDeleted Account‚Äù: <br><br><img src="https://habrastorage.org/files/0d9/c64/664/0d9c646641874b08b1fd9c71c5802b46.png"><br><br>  If the victim is able to receive SMS on this phone number, she can enter the Telegram application on her device.  If an attacker on a hijacked account has not enabled two-factor authentication, the victim can enter the Settings =&gt; Privacy and Security =&gt; Active Sessions menu and terminate all other sessions (that is, the attacker's session): <br><br><img src="https://habrastorage.org/files/6cc/e7f/fa8/6cce7ffa80f14eb986319c3f053d8764.png"><br><br>  If an attacker on a hijacked account has enabled two-factor authentication, the victim, in turn, in the same way can ‚Äúhijack back‚Äù his account. <br><br>  It turns out that the only benefit from two-factor authentication in Telegram is that the attacker does not receive correspondence from the usual non-secret chat rooms (if you steal an account without the two-factor account enabled, then the attacker will receive the entire history of correspondence from unclassified chat rooms, from the secret chat rooms he will not receive anything ).  That is, a Telegram with enabled two-factor authentication gives approximately the same thing as Signal and WhatsApp do so without any two-factor authentication. <br><br>  In other words, two-factor authorization in Telegram is not quite real, Telegram still allows you to log in using only one factor - the code from the SMS. <br><br>  The situation is somewhat anecdotal: here you are, users, two-factor authorization.  The first factor is the code from the SMS (which I have), the second factor is the password (which I know).  It sounds great, but when the user says - but I forgot the password, Telegram says - well, nothing happens, log in without a password and use your health :) <br><br>  This was found experimentally through a slightly larger study on Telegram, WhatsApp and Signal - ‚Äú <a href="https://medium.com/digital-security-panda/%25D0%25BA%25D0%25B0%25D0%25BA-%25D0%25B7%25D0%25B0%25D1%2589%25D0%25B8%25D1%2589%25D1%2591%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B5-%25D0%25BC%25D0%25B5%25D1%2581%25D1%2581%25D0%25B5%25D0%25BD%25D0%25B4%25D0%25B6%25D0%25B5%25D1%2580%25D1%258B-%25D0%25B7%25D0%25B0%25D1%2589%25D0%25B8%25D1%2589%25D0%25B5%25D0%25BD%25D1%258B-%25D0%25BE%25D1%2582-%25D0%25BA%25D1%2580%25D0%25B0%25D0%25B6%25D0%25B8-sms-2f7883d9166f">How‚Äú protected ‚Äùmessengers are protected from SMS theft</a> ‚Äù </div><p>Source: <a href="https://habr.com/ru/post/357108/">https://habr.com/ru/post/357108/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../357098/index.html">The data flowed car owners of Russia</a></li>
<li><a href="../357100/index.html">How to open sites blocked by the provider and hidden onion-services in the main browser (Firefox)</a></li>
<li><a href="../357102/index.html">A student reported a vulnerability in a police communications protocol. Received 15 months conditionally</a></li>
<li><a href="../357104/index.html">In Japan, two hours from ATMs across the country stole $ 12.7 million</a></li>
<li><a href="../357106/index.html">The state will collect personal data of Russians wherever possible, and will store centrally</a></li>
<li><a href="../357110/index.html">Runet launches automatic phishing search engine</a></li>
<li><a href="../357112/index.html">British banks will disconnect customers with outdated versions of browsers from online services</a></li>
<li><a href="../357114/index.html">The wisdom of years: the older user - harder passwords</a></li>
<li><a href="../357116/index.html">Three operator will block mobile advertising for 30 million subscribers for 24 hours</a></li>
<li><a href="../357118/index.html">Iran gives 1 year to foreign messengers to transfer servers to the country</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>