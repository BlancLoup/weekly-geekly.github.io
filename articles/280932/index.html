<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>QtWebApp is a step-by-step chewed example with detailed comments.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the process of developing an application on Qt, you may need to add a web interface to this application, which may be especially relevant when deve...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>QtWebApp is a step-by-step chewed example with detailed comments.</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/c17/418/3b1/c174183b14b6469c9f96dfe446cf2540.jpg"><br><br>  In the process of developing an application on Qt, you may need to add a <a href="http://www.edsd.ru/ru/proekty/sozdaniye_saytov">web interface</a> to this application, which may be especially relevant when developing embedded systems using Qt.  To solve this problem, you can either write your own solution, or use ready-made solutions.  For example, the QtWebApp library, which provides the necessary functionality for creating a web interface. <br><br>  The advantages of this library include: <br><ol><li>  formation of pages with dynamic content for templates; </li><li>  the formation of fully dynamic pages; </li><li>  working with a cookie that will allow you to add authorization on the application; </li><li>  work with static files, for example, style.css or images; </li><li>  implementation of file uploads. </li></ol><br>  I propose to consider in detail one of the options for running a small application on Qt, which will have several web pages that use the QtWebApp library. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At the time of this writing, the QtWebApp 1.6.3 and Qt 5.6 library was originally used.  The project was successfully launched with MSVC2013 and MinGW build kits.  During the debugging process, a bug was noticed in the Template class of the QtWebApp library.  After fixing the bug and communication with the developer, the library version was upgraded to 1.6.4.  Based on this, it is also possible to note, plus the libraries, that the developer responded to the information about the bug within 24 hours, and on the same day the library version was upgraded.  The final version of the sample application was prepared on version 1.6.4. <a name="habracut"></a><br><br>  In this project, it is proposed to create an application that has three pages, a menu for selecting these pages, and three static files.  One of the files is style.css, and the other two are images. <br><br><h4>  Project structure </h4><br><br><img src="https://habrastorage.org/files/53b/f53/a8e/53bf53a8e71e4892a3e56f685853fc11.png" align="left">  The project will be formed as a Subdirs project, which will consist of the main project and the QtWebApp library project. <br>  Project structure: <br><br>  <b>QtWebAppExample.pro</b> - the main project profile <br>  <b>common</b> - custom web server project <br><br><ul><li>  o common.pro - profile of the application project with a web server </li><li>  o httpsettings.hpp - application settings file, in which the class inherited from QSettings </li><li>  o webconfigurator.h - the header file of the web-configurator class; it is responsible for creating the base of all the web pages of the application </li><li>  o webconfigurator.cpp - web configurator source code file </li><li>  o webconfiguratorpage.h - header file for all classes of Qt application web pages </li><li>  o webconfiguratorpage.cpp - web page source file </li><li>  o resources.qrc - a resource file containing web page templates and their component parts </li><li>  o html-static - folder containing static files that will not be dynamically changed during the operation of the application </li></ul><br>  <b>QtWebApp</b> - library project <br><ul><li>  o QtWebApp.pro - library project profile </li><li>  o httpserver - a subproject that implements the work of the web server itself </li><li>  o logging - a subproject that implements web server logging </li><li>  o qtservice - a subproject that allows you to implement the launch of the application as a service </li><li>  o templateengine ‚Äìa sub-project that implements page templates, as well as substitution of data into pages when querying the server. </li></ul><br><br><h4>  QtWebAppExample.pro </h4><br>  The general profile of the project is the subdirs template with the main project connected and the QtWebApp library.  The sequence of connecting projects in the file is important.  The QtWebApp library should be written first, otherwise, when building the project, errors will occur: <br>  if at the time of building the main project, which depends on QtWebApp, the collected library files (.dll or .so) are not available, the project will not be built. <br><pre><code class="hljs lua">TEMPLATE = subdirs SUBDIRS += \ QtWebApp \ common CONFIG += ordered common.files = common/html-static/* CONFIG(<span class="hljs-built_in"><span class="hljs-built_in">debug</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">debug</span></span>|release) { common.<span class="hljs-built_in"><span class="hljs-built_in">path</span></span> = $$OUT_PWD/../HttpServiceDebug/html-static } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { common.<span class="hljs-built_in"><span class="hljs-built_in">path</span></span> = $$OUT_PWD/../HttpService/html-static } INSTALLS += common</code> </pre> <br><br><h4>  common.pro </h4><br>  If the library profile is not fundamentally corrected in this example, then setting the profile of the main project of the web server can deliver some inconvenience to the novice user.  As can be seen from the following script, the application responsible for graphic libraries is disabled in the application as unnecessary, but the network library is enabled for processing requests to the http-server. <br><br>  In addition, it is necessary to correctly link the header files and source files, as well as the output folders for building the library, so that the assembled project can follow the correct path to the library files. <br><br><pre> <code class="hljs pgsql">QT += core network QT -= gui TARGET = common CONFIG += console CONFIG -= app_bundle CONFIG += c++<span class="hljs-number"><span class="hljs-number">11</span></span> TEMPLATE = app SOURCES += main.cpp \ webconfigurator.cpp \ webconfiguratorpage.cpp HEADERS += \ webconfigurator.h \ webconfiguratorpage.h \ httpsettings.hpp RESOURCES += \ resources.qrc CONFIG(<span class="hljs-keyword"><span class="hljs-keyword">debug</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span>|<span class="hljs-keyword"><span class="hljs-keyword">release</span></span>) { DESTDIR = $$<span class="ruby"><span class="ruby">OUT_PWD/../../HttpServiceDebug } </span><span class="hljs-keyword"><span class="ruby"><span class="hljs-keyword">else</span></span></span><span class="ruby"> { DESTDIR = $$</span></span>OUT_PWD/../../HttpService } win32:CONFIG(<span class="hljs-keyword"><span class="hljs-keyword">release</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span>|<span class="hljs-keyword"><span class="hljs-keyword">release</span></span>): LIBS += -L$$<span class="pgsql"><span class="pgsql">OUT_PWD/../QtWebApp/</span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">release</span></span></span><span class="pgsql">/ -lQtWebApp </span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">else</span></span></span><span class="pgsql">:win32:CONFIG(</span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">debug</span></span></span><span class="pgsql">, </span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">debug</span></span></span><span class="pgsql">|</span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">release</span></span></span><span class="pgsql">): LIBS += -L$$</span><span class="undefined"></span></span><span class="pgsql"><span class="undefined"></span></span>OUT_PWD/../QtWebApp/<span class="hljs-keyword"><span class="hljs-keyword">debug</span></span>/ -lQtWebApp <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:unix: LIBS += -L$$<span class="ruby"><span class="ruby">OUT_PWD/../QtWebApp/ -lQtWebApp INCLUDEPATH += $$</span></span>PWD/../QtWebApp/httpserver DEPENDPATH += $$<span class="ruby"><span class="ruby">PWD/../QtWebApp/httpserver INCLUDEPATH += $$</span></span>PWD/../QtWebApp/templateengine DEPENDPATH += $$<span class="ruby"><span class="ruby">PWD/../QtWebApp/templateengine INCLUDEPATH += $$</span></span>PWD/../QtWebApp/qtservice DEPENDPATH += $$<span class="pgsql"><span class="pgsql">PWD/../QtWebApp/qtservice win32-g++:CONFIG(</span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">release</span></span></span><span class="pgsql">, </span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">debug</span></span></span><span class="pgsql">|</span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">release</span></span></span><span class="pgsql">): PRE_TARGETDEPS += $$</span><span class="undefined"></span></span><span class="pgsql"><span class="undefined"></span></span>OUT_PWD/../QtWebApp/<span class="hljs-keyword"><span class="hljs-keyword">release</span></span>/libQtWebApp.a <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:win32-g++:CONFIG(<span class="hljs-keyword"><span class="hljs-keyword">debug</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span>|<span class="hljs-keyword"><span class="hljs-keyword">release</span></span>): PRE_TARGETDEPS += $$<span class="pgsql"><span class="pgsql">OUT_PWD/../QtWebApp/</span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">debug</span></span></span><span class="pgsql">/libQtWebApp.a </span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">else</span></span></span><span class="pgsql">:win32:!win32-g++:CONFIG(</span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">release</span></span></span><span class="pgsql">, </span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">debug</span></span></span><span class="pgsql">|</span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">release</span></span></span><span class="pgsql">): PRE_TARGETDEPS += $$</span><span class="undefined"></span></span><span class="pgsql"><span class="undefined"></span></span>OUT_PWD/../QtWebApp/<span class="hljs-keyword"><span class="hljs-keyword">release</span></span>/QtWebApp.lib <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:win32:!win32-g++:CONFIG(<span class="hljs-keyword"><span class="hljs-keyword">debug</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span>|<span class="hljs-keyword"><span class="hljs-keyword">release</span></span>): PRE_TARGETDEPS += $$<span class="pgsql"><span class="pgsql">OUT_PWD/../QtWebApp/</span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">debug</span></span></span><span class="pgsql">/QtWebApp.lib </span><span class="hljs-keyword"><span class="pgsql"><span class="hljs-keyword">else</span></span></span><span class="pgsql">:unix: PRE_TARGETDEPS += $$</span><span class="undefined"></span></span><span class="pgsql"><span class="undefined"></span></span>OUT_PWD/../QtWebApp/libQtWebApp.a DISTFILES += \ html-static/style.css \ html-static/favicon<span class="hljs-number"><span class="hljs-number">-32</span></span>x32.png \ html-static/favicon.png</code> </pre> <br><br><h4>  QtWebApp.pro </h4><br>  The library project's default profile is shown below.  The only change in the project was the presence of additional assembly settings as a static library. <br><pre> <code class="hljs lisp"># Build this project to generate a shared library (<span class="hljs-name"><span class="hljs-name">*</span></span>.dll or *.so). TARGET = QtWebApp TEMPLATE = lib QT -= gui CONFIG += staticlib VERSION = 1.6.4 mac { QMAKE_MAC_SDK = macosx10.10 QMAKE_CXXFLAGS += -std=c++11 CONFIG += c++11 QMAKE_LFLAGS_SONAME = -Wl,-install_name,/usr/local/lib/ } win32 { DEFINES += QTWEBAPPLIB_EXPORT } # Windows and Unix get the suffix "d" to indicate a debug version of the library. # Mac OS gets the suffix "_debug". CONFIG(debug, debug|release) { win32: TARGET = $$join(TARGET,,,d) mac: TARGET = $$join(TARGET,,,_debug) unix:!mac: TARGET = $$join(TARGET,,,d) } DISTFILES += doc/* mainpage.dox Doxyfile OTHER_FILES += ../readme.txt include(<span class="hljs-name"><span class="hljs-name">qtservice/qtservice</span></span>.pri) include(<span class="hljs-name"><span class="hljs-name">logging/logging</span></span>.pri) include(<span class="hljs-name"><span class="hljs-name">httpserver/httpserver</span></span>.pri) include(<span class="hljs-name"><span class="hljs-name">templateengine/templateengine</span></span>.pri)</code> </pre> <br><br><h4>  main.cpp </h4><br>  And now let's go through all the files in the common project in order to figure out how to run a Qt application with a web interface.  Let's start with the start file of the application and with the function main, with which the application is launched. <br><br>  There is getting the path to the settings file, which stores the settings of the web server, TCP / IP port, etc. <br>  It also creates an object of the WebConfigurator class, which is responsible for processing requests and issuing, on request, the corresponding pages of the web server. <br><pre> <code class="hljs mel">#include &lt;QCoreApplication&gt; #include &lt;QDir&gt; #include &lt;webconfigurator.h&gt; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> main(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> argc, char *argv[]) { QCoreApplication a(argc, argv); a.setApplicationName(<span class="hljs-string"><span class="hljs-string">"QtWebAppExample"</span></span>); QString configPath = QDir::currentPath() + <span class="hljs-string"><span class="hljs-string">"/"</span></span> + QCoreApplication::<span class="hljs-keyword"><span class="hljs-keyword">applicationName</span></span>() + <span class="hljs-string"><span class="hljs-string">".ini"</span></span>; new WebConfigurator(configPath); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a.<span class="hljs-keyword"><span class="hljs-keyword">exec</span></span>(); }</code> </pre><br><h4>  HttpSettings.hpp </h4><br>  It actually contains an auxiliary class that does not carry more than necessary information, but initialization of the settings file is included in it for convenience, and in the case of a more global project, this class will be conveniently extended.  In this embodiment, of course, more like a matter of taste. <br><br>  All parameters relate to the configuration of the connection port, the number of simultaneous sessions, the duration of the request. <br><br>  The application settings will also contain the parameters of the static file controller, in particular, the path to the folder where the static files of the web server will be searched.  In this application, this is the html-static folder, which will be located in the same folder as the executable file of the application. <br><br><pre> <code class="hljs smalltalk"><span class="hljs-symbol"><span class="hljs-symbol">#ifndef</span></span> <span class="hljs-type"><span class="hljs-type">HTTPSETTINGS_H</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">HTTPSETTINGS_H</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;<span class="hljs-type"><span class="hljs-type">QSettings</span></span>&gt; class <span class="hljs-type"><span class="hljs-type">HttpSettings</span></span> : public <span class="hljs-type"><span class="hljs-type">QSettings</span></span> { public: explicit <span class="hljs-type"><span class="hljs-type">HttpSettings</span></span>(const <span class="hljs-type"><span class="hljs-type">QString</span></span>&amp; fileName, <span class="hljs-type"><span class="hljs-type">QObject</span></span>* parent = nullptr) : <span class="hljs-type"><span class="hljs-type">QSettings</span></span>(fileName,<span class="hljs-type"><span class="hljs-type">QSettings</span></span>::<span class="hljs-type"><span class="hljs-type">IniFormat</span></span>,parent) { //  - setValue(<span class="hljs-comment"><span class="hljs-comment">"port"</span></span>, value(<span class="hljs-comment"><span class="hljs-comment">"port"</span></span>, <span class="hljs-number"><span class="hljs-number">8080</span></span>)); setValue(<span class="hljs-comment"><span class="hljs-comment">"minThreads"</span></span>, value(<span class="hljs-comment"><span class="hljs-comment">"minThreads"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)); setValue(<span class="hljs-comment"><span class="hljs-comment">"maxThreads"</span></span>, value(<span class="hljs-comment"><span class="hljs-comment">"maxThreads"</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>)); setValue(<span class="hljs-comment"><span class="hljs-comment">"cleanupInterval"</span></span>, value(<span class="hljs-comment"><span class="hljs-comment">"cleanupInterval"</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>)); setValue(<span class="hljs-comment"><span class="hljs-comment">"readTimeout"</span></span>, value(<span class="hljs-comment"><span class="hljs-comment">"readTimeout"</span></span>, <span class="hljs-number"><span class="hljs-number">60000</span></span>)); setValue(<span class="hljs-comment"><span class="hljs-comment">"maxRequestSize"</span></span>, value(<span class="hljs-comment"><span class="hljs-comment">"maxRequestSize"</span></span>, <span class="hljs-number"><span class="hljs-number">16000</span></span>)); setValue(<span class="hljs-comment"><span class="hljs-comment">"maxMultiPartSize"</span></span>, value(<span class="hljs-comment"><span class="hljs-comment">"maxMultiPartSize"</span></span>, <span class="hljs-number"><span class="hljs-number">10000000</span></span>)); //     setValue(<span class="hljs-comment"><span class="hljs-comment">"html-static/path"</span></span>, value(<span class="hljs-comment"><span class="hljs-comment">"html-static/path"</span></span>, <span class="hljs-comment"><span class="hljs-comment">"html-static"</span></span>)); setValue(<span class="hljs-comment"><span class="hljs-comment">"html-static/encoding"</span></span>, value(<span class="hljs-comment"><span class="hljs-comment">"html-static/encoding"</span></span>, <span class="hljs-comment"><span class="hljs-comment">"UTF-8"</span></span>)); setValue(<span class="hljs-comment"><span class="hljs-comment">"html-static/maxAge"</span></span>, value(<span class="hljs-comment"><span class="hljs-comment">"html-static/maxAge"</span></span>, <span class="hljs-number"><span class="hljs-number">60000</span></span>)); setValue(<span class="hljs-comment"><span class="hljs-comment">"html-static/cacheTime"</span></span>, value(<span class="hljs-comment"><span class="hljs-comment">"html-static/cacheTime"</span></span>, <span class="hljs-number"><span class="hljs-number">60000</span></span>)); setValue(<span class="hljs-comment"><span class="hljs-comment">"html-static/cacheSize"</span></span>, value(<span class="hljs-comment"><span class="hljs-comment">"html-static/cacheSize"</span></span>, <span class="hljs-number"><span class="hljs-number">1000000</span></span>)); setValue(<span class="hljs-comment"><span class="hljs-comment">"html-static/maxCachedFileSize"</span></span>, value(<span class="hljs-comment"><span class="hljs-comment">"html-static/maxCachedFileSize"</span></span>, <span class="hljs-number"><span class="hljs-number">65536</span></span>)); } }; <span class="hljs-symbol"><span class="hljs-symbol">#endif</span></span> // <span class="hljs-type"><span class="hljs-type">HTTPSETTINGS_H</span></span></code> </pre><br><h4>  WebConfigurator.h </h4><br>  And now we‚Äôll take a close look at the contents of the WebConfigurator class, which is directly responsible for determining the pages to be sent from outside to a request. <br><br>  The pages are defined using the QHash class object, which contains pointers to all web page objects and their corresponding key values ‚Äã‚Äãthat correspond to URL addresses of requests.  But QHash is used only for dynamic pages, and for static pages, an object of class StaticFileController is used. <br><br><pre> <code class="hljs smalltalk"><span class="hljs-symbol"><span class="hljs-symbol">#ifndef</span></span> <span class="hljs-type"><span class="hljs-type">WEBCONFIGURATOR_H</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">WEBCONFIGURATOR_H</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;httprequesthandler.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;httplistener.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;webconfiguratorpage.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;httpsettings.hpp&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;staticfilecontroller.h&gt; class <span class="hljs-type"><span class="hljs-type">WebConfigurator</span></span> : public <span class="hljs-type"><span class="hljs-type">HttpRequestHandler</span></span> { <span class="hljs-type"><span class="hljs-type">Q_OBJECT</span></span> <span class="hljs-type"><span class="hljs-type">Q_DISABLE_COPY</span></span>(<span class="hljs-type"><span class="hljs-type">WebConfigurator</span></span>) public: <span class="hljs-type"><span class="hljs-type">WebConfigurator</span></span>(<span class="hljs-type"><span class="hljs-type">QString</span></span> &amp;configPath); virtual ~<span class="hljs-type"><span class="hljs-type">WebConfigurator</span></span>(); virtual void service(<span class="hljs-type"><span class="hljs-type">HttpRequest</span></span>&amp; request, <span class="hljs-type"><span class="hljs-type">HttpResponse</span></span>&amp; response) override; private: <span class="hljs-type"><span class="hljs-type">QString</span></span> m_configPath; <span class="hljs-type"><span class="hljs-type">HttpSettings</span></span> m_config; <span class="hljs-type"><span class="hljs-type">HttpListener</span></span> m_httpListener; <span class="hljs-type"><span class="hljs-type">QHash</span></span>&lt;<span class="hljs-type"><span class="hljs-type">QString</span></span>,<span class="hljs-type"><span class="hljs-type">WebConfiguratorPage</span></span>*&gt; m_pages; <span class="hljs-type"><span class="hljs-type">StaticFileController</span></span> *m_staticFileController; }; <span class="hljs-symbol"><span class="hljs-symbol">#endif</span></span> // <span class="hljs-type"><span class="hljs-type">WEBCONFIGURATOR_H</span></span></code> </pre><br><h4>  Webconfigurator.cpp </h4><br>  The configurator is responsible for redirecting requests to relevant pages and images and is a repository of page data and images.  If the page or image does not exist, then a 404 error is returned. <br>  #include "webconfigurator.h" <br><pre> <code class="hljs pgsql">WebConfigurator::WebConfigurator(QString &amp;configPath) : m_configPath(configPath), m_config(m_configPath), m_httpListener(&amp;m_config, this) { <span class="hljs-comment"><span class="hljs-comment">/*   QHash    , *      - * */</span></span> m_pages.<span class="hljs-keyword"><span class="hljs-keyword">insert</span></span>("/index.html", <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> IndexPage()); m_pages.<span class="hljs-keyword"><span class="hljs-keyword">insert</span></span>("/second.html", <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> SecondPage()); m_pages.<span class="hljs-keyword"><span class="hljs-keyword">insert</span></span>("/first.html", <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> FirstPage()); <span class="hljs-comment"><span class="hljs-comment">/*      *     ,    *        *    ,    *     * */</span></span> m_config.beginGroup("html-static"); m_staticFileController = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> StaticFileController(&amp;m_config); m_config.endGroup(); } WebConfigurator::~WebConfigurator() { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>(WebConfiguratorPage* page, m_pages) { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> page; } <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> m_staticFileController; } <span class="hljs-type"><span class="hljs-type">void</span></span> WebConfigurator::service(HttpRequest &amp;request, HttpResponse &amp;response) { <span class="hljs-comment"><span class="hljs-comment">/*        *    . *   ,   ,   *          . *      404 * */</span></span> QByteArray <span class="hljs-type"><span class="hljs-type">path</span></span> = request.getPath(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(auto i = m_pages.<span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>(); i != m_pages.<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>(); ++i) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-type"><span class="hljs-type">path</span></span>.startsWith(i.key().toLatin1())) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> i.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>()-&gt;handleRequest(request,response); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-type"><span class="hljs-type">path</span></span>=="/") { response.redirect("/index.html"); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-type"><span class="hljs-type">path</span></span>.startsWith("/style.css") || <span class="hljs-type"><span class="hljs-type">path</span></span>.startsWith("/favicon-32x32.png") || <span class="hljs-type"><span class="hljs-type">path</span></span>.startsWith("/favicon.png")){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> m_staticFileController-&gt;service(request, response); } response.setStatus(<span class="hljs-number"><span class="hljs-number">404</span></span>,"Not found"); }</code> </pre><br><h4>  WebConfiguratorPage.h </h4><br>  This header file contains the declaration of the main class responsible for the formation of pages and three classes of pages inherited from it for the project: index.html, first.html, second.html. <br><pre> <code class="hljs kotlin">#ifndef WEBCONFIGURATORPAGE_H #define WEBCONFIGURATORPAGE_H #include &lt;QObject&gt; #include &lt;httprequesthandler.h&gt; #include &lt;httplistener.h&gt; #include &lt;template.h&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebConfiguratorPage</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">public QObject { Q_OBJECT public: WebConfiguratorPage</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> QString&amp; title); virtual void handleRequest(HttpRequest&amp;, HttpResponse&amp;) {} virtual ~WebConfiguratorPage() {} <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: Template commonTemplate() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: QString m_title; }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IndexPage</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">public WebConfiguratorPage { Q_OBJECT public: IndexPage</span></span></span></span>() : WebConfiguratorPage(<span class="hljs-string"><span class="hljs-string">"EDISON"</span></span>) {} virtual ~IndexPage() {} <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: virtual void handleRequest(HttpRequest &amp;request, HttpResponse &amp;response) <span class="hljs-keyword"><span class="hljs-keyword">override</span></span>; }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FirstPage</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">public WebConfiguratorPage { Q_OBJECT public: FirstPage</span></span></span></span>() : WebConfiguratorPage(<span class="hljs-string"><span class="hljs-string">"First Page"</span></span>) {} virtual ~FirstPage() {} <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: virtual void handleRequest(HttpRequest &amp;request, HttpResponse &amp;response) <span class="hljs-keyword"><span class="hljs-keyword">override</span></span>; }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SecondPage</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">public WebConfiguratorPage { Q_OBJECT public: SecondPage</span></span></span></span>() : WebConfiguratorPage(<span class="hljs-string"><span class="hljs-string">"Second Page"</span></span>) {} virtual ~SecondPage() {} <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: virtual void handleRequest(HttpRequest &amp;request, HttpResponse &amp;response) <span class="hljs-keyword"><span class="hljs-keyword">override</span></span>; }; #endif <span class="hljs-comment"><span class="hljs-comment">// WEBCONFIGURATORPAGE_H</span></span></code> </pre><br><br><h4>  WebConfiguratorPage.cpp </h4><br><pre> <code class="hljs lua">#include <span class="hljs-string"><span class="hljs-string">"webconfiguratorpage.h"</span></span> #include &lt;QFile&gt; #include &lt;QDebug&gt; WebConfiguratorPage::WebConfiguratorPage(const QString &amp;title) : m_title(title) { } Template WebConfiguratorPage::commonTemplate() const { /*       common.htm. *      ... * */ QFile file(<span class="hljs-string"><span class="hljs-string">":/html/common.htm"</span></span>); Template common(file, QTextCodec::codecForName(<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>)); common.setVariable(<span class="hljs-string"><span class="hljs-string">"Title"</span></span>, m_title); /*    . *        , *        . *        ,  *     . *       common.htm,  *      <span class="hljs-string"><span class="hljs-string">"Navigation"</span></span> * */ bool navigation = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; common.setCondition(<span class="hljs-string"><span class="hljs-string">"Navigation"</span></span>, navigation); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(navigation) { /*          * ,        common.htm * */ common.loop(<span class="hljs-string"><span class="hljs-string">"Items"</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>); common.setVariable(<span class="hljs-string"><span class="hljs-string">"Items0.href"</span></span>, <span class="hljs-string"><span class="hljs-string">"/index.html"</span></span>); common.setVariable(<span class="hljs-string"><span class="hljs-string">"Items0.name"</span></span>, <span class="hljs-string"><span class="hljs-string">"Main page"</span></span>); common.setVariable(<span class="hljs-string"><span class="hljs-string">"Items1.href"</span></span>, <span class="hljs-string"><span class="hljs-string">"/first.html"</span></span>); common.setVariable(<span class="hljs-string"><span class="hljs-string">"Items1.name"</span></span>, <span class="hljs-string"><span class="hljs-string">"First page"</span></span>); common.setVariable(<span class="hljs-string"><span class="hljs-string">"Items2.href"</span></span>, <span class="hljs-string"><span class="hljs-string">"/second.html"</span></span>); common.setVariable(<span class="hljs-string"><span class="hljs-string">"Items2.name"</span></span>, <span class="hljs-string"><span class="hljs-string">"Second page"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> common; } /*         . *      ,     *        * */ void IndexPage::handleRequest(HttpRequest &amp;request, HttpResponse &amp;response) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (request.getMethod() == <span class="hljs-string"><span class="hljs-string">"GET"</span></span>) { //     Template common = commonTemplate(); QFile file(<span class="hljs-string"><span class="hljs-string">":/html/index.htm"</span></span>); Template contents(file, QTextCodec::codecForName(<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>)); /*           *       ,      *      {Content} * */ common.setVariable(<span class="hljs-string"><span class="hljs-string">"Content"</span></span>, contents); response.setHeader(<span class="hljs-string"><span class="hljs-string">"Content-Type"</span></span>, <span class="hljs-string"><span class="hljs-string">"text/html; charset=ISO-8859-1"</span></span>); response.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(common.toUtf8()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } void FirstPage::handleRequest(HttpRequest &amp;request, HttpResponse &amp;response) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (request.getMethod() == <span class="hljs-string"><span class="hljs-string">"GET"</span></span>) { Template common = commonTemplate(); QFile file(<span class="hljs-string"><span class="hljs-string">":/html/first.htm"</span></span>); Template contents(file, QTextCodec::codecForName(<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>)); common.setVariable(<span class="hljs-string"><span class="hljs-string">"Content"</span></span>, contents); response.setHeader(<span class="hljs-string"><span class="hljs-string">"Content-Type"</span></span>, <span class="hljs-string"><span class="hljs-string">"text/html; charset=ISO-8859-1"</span></span>); response.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(common.toUtf8()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } void SecondPage::handleRequest(HttpRequest &amp;request, HttpResponse &amp;response) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (request.getMethod() == <span class="hljs-string"><span class="hljs-string">"GET"</span></span>) { Template common = commonTemplate(); QFile file(<span class="hljs-string"><span class="hljs-string">":/html/second.htm"</span></span>); Template contents(file, QTextCodec::codecForName(<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>)); common.setVariable(<span class="hljs-string"><span class="hljs-string">"Content"</span></span>, contents); response.setHeader(<span class="hljs-string"><span class="hljs-string">"Content-Type"</span></span>, <span class="hljs-string"><span class="hljs-string">"text/html; charset=ISO-8859-1"</span></span>); response.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(common.toUtf8()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; }</code> </pre><br><h4>  Common.htm </h4><br><br>  Toward the curtain, consider the contents of the templates. <br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>{Title}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewport"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width=device-width, initial-scale=1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"style.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image/png"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"favicon-32x32.png"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sizes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"32x32"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"content"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://edsd.ru"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"logo"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>{Title}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> {if Navigation} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"menu"</span></span></span><span class="hljs-tag">&gt;</span></span> {loop Items} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"menuitem"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{Items.href}</span></span></span><span class="hljs-tag">&gt;</span></span>{Items.name}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> {end Items} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> {end Navigation} {Content} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h4>  index.htm </h4><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>EDISON<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h4>  Result </h4><br>  As a result, we get a working application with a web server, which is perfect for embedded systems. <br><br>  And this application will generate the next web page. <br><img src="https://habrastorage.org/files/608/9cd/091/6089cd091a5645cea64be07978029c6f.png"><br><h4>  Note </h4><br>  The draft application can be downloaded from the link: <a href="https://github.com/edsd/QtWebAppExample">download</a> . <br>  When building a project, be sure to install the install stage so that the necessary static files are installed in the appropriate folder for the executable file. <br><br><h4>  Little bit about the bug </h4><br>  Add a few words about the bug, which in itself was more like the result of unsuccessful code refactoring, or rather, the developer was simply tired at some point.  The fact is that in earlier versions of QtWebApp, namely in version 1.5.10, the code was correct and looked like this. <br><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.<span class="hljs-keyword"><span class="hljs-keyword">size</span></span>()==<span class="hljs-number"><span class="hljs-number">0</span></span> || <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">error</span></span>())   {       qCritical(<span class="hljs-string"><span class="hljs-string">"Template: cannot read from %s, %s"</span></span>,qPrintable(sourceName),qPrintable(<span class="hljs-keyword"><span class="hljs-keyword">file</span></span>.errorString()));   } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {        append(textCodec-&gt;toUnicode(data));   }</code> </pre> <br><br>  Whereas in version 1.6.3 one single line was omitted. <br><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.<span class="hljs-keyword"><span class="hljs-keyword">size</span></span>()==<span class="hljs-number"><span class="hljs-number">0</span></span> || <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">error</span></span>())   {       qCritical(<span class="hljs-string"><span class="hljs-string">"Template: cannot read from %s, %s"</span></span>,qPrintable(sourceName),qPrintable(<span class="hljs-keyword"><span class="hljs-keyword">file</span></span>.errorString()));       append(textCodec-&gt;toUnicode(data));   }</code> </pre> <br><br>  As a result, no data was added to the page template, and the user received a blank page.  According to Stefan Frings, the developer of QtWebApp, he usually uses a different approach to the formation of a web interface than we do, so he simply did not notice this problem. </div><p>Source: <a href="https://habr.com/ru/post/280932/">https://habr.com/ru/post/280932/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../280912/index.html">PostgreSQL useful tricks</a></li>
<li><a href="../280914/index.html">Sandbox for programmers</a></li>
<li><a href="../280922/index.html">Konami code or read between the lines</a></li>
<li><a href="../280928/index.html">Easy insertion of multiline pattern literals into JavaScript code</a></li>
<li><a href="../280930/index.html">Palantir: how to detect a botnet</a></li>
<li><a href="../280938/index.html">Features and differences of the MSH programming language from MUMPS</a></li>
<li><a href="../280940/index.html">Disabled Cache Zone Module</a></li>
<li><a href="../280942/index.html">Announcement of the fourth meeting of the Java User Group Sevastopol</a></li>
<li><a href="../280944/index.html">PHP recursion - algorithm, application</a></li>
<li><a href="../280948/index.html">Summer is the time to study at Intel. We invite you to summer school 0x7E0</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>