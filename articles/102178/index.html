<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Debugging Tips in Visual Studio 2010</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the twenty-sixth publication in the VS 2010 and .NET 4 series of publications . 

 Today's publication discusses some useful debugging tips th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Debugging Tips in Visual Studio 2010</h1><div class="post__text post__text-html js-mediator-article"> This is the twenty-sixth publication <a href="http://weblogs.asp.net/scottgu/archive/2009/08/25/vs-2010-and-net-4-series.aspx">in the</a> VS 2010 and .NET 4 <a href="http://weblogs.asp.net/scottgu/archive/2009/08/25/vs-2010-and-net-4-series.aspx">series of publications</a> . <br><br>  Today's publication discusses some useful debugging tips that you can use in Visual Studio.  My friend Scott Cate (who <a href="http://scottcate.com/Tricks/">blogged a</a> dozen great tips and tricks on VS) recently drew my attention to some good tips that many developers using Visual Studio don't know (even though many of them work with it). long ago from earlier versions). <br><a name="habracut"></a><br>  Hopefully this post will help you learn about them, if you do not already know about them.  All of them are easy to learn, and can save you a lot of time. <br><br>  <u><b>Run to Cursor (Ctrl + F10) (Run to cursor)</b></u> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Often, I see people debugging applications as follows: they set a breakpoint a lot earlier than the place they are interested in, and then they constantly use F10 / F11 to go through the code until the place they actually want to explore is reached.  In some cases, they carefully inspect every expression they pass through (in such cases, using F10 / F11 makes sense).  However, more often, people just try to quickly go to the line of code that actually interests them - in such cases, using F10 / F11 is not the best way to achieve such a goal. <br>  Instead, you can use the ‚Äúrun to cursor‚Äù function which is supported by the debugger.  Just place the cursor on the line of code to which you want to run the application, and then press Ctrl + F10 together.  This will lead to the execution of the application up to this line and switch to debug mode, saving the time that could be spent on multiple presses of F10 / F11 in order to get here.  This works even in cases where the code you want to get into is in a separate method or class in relation to the place you are currently debugging. <br><br>  <u><b>Conditional Breakpoints</b></u> <br><br>  Another common situation that we often see is when developers set breakpoints, execute an application, check a specific input, hit a breakpoint, and then manually check if the condition is true before deciding whether to proceed to further debugging.  If the script does not match what they are doing next, they will press F5 to continue execution of the application, check some other input and repeat the process manually. <br><br>  Visual Studio's ability to set conditional breakpoints provides a much, much easier way to achieve this.  Conditional breakpoints allow you to switch to debug mode only if any particular condition that was set has been reached.  Conditional breakpoints help you avoid manual study of the code with its further execution, and can also make the whole debugging process not requiring your manual intervention and relieve you from boring work. <br><br>  <u>How to enable Conditional Breakpoint (conditional breakpoint)</u> <br><br>  Setting conditional breakpoints in reality is simple.  Press F9 in the code to set a point on a certain line ( <i>note, you can also set a breakpoint by clicking the mouse on the left edge of the editor window exactly at the line level where you need to set a breakpoint</i> ): <br><br><img src="http://weblogs.asp.net/blogs/scottgu/image_thumb_5973592C.png" alt="image"><br><br>  Then right-click on the red circle of the breakpoint to the left of the editor window and select the context menu ‚ÄúCondition ...‚Äù: <br><br><img src="http://weblogs.asp.net/blogs/scottgu/image_thumb_57C28D58.png" alt="image"><br><br>  This will bring up a dialog box that allows you to specify that the breakpoint should only work if a certain condition is true.  For example, we can specify that we do not need to go to debugging if the size of the local paginatedDinners list is less than 10, by typing the following expression below: <br><br><img src="http://weblogs.asp.net/blogs/scottgu/image_thumb_15DBA80A.png" alt="image"><br><br>  Now, when I restart the application and perform a search, the debugger will be enabled only if I perform a search that returns less than 10 dinners.  If there are more than 10 dinners, then the breakpoint will not be reached. <br><br>  <u>Hit Count function</u> <br><br>  Sometimes you need to stop the debugger only if the condition is true N-times. <br>  For example, to stop only if the search has already returned less than 10 dinners 5 times. <br><br>  You can enable this behavior by right-clicking on the breakpoint and selecting the menu item ‚ÄúHit count ...‚Äù (‚ÄúNumber of hits ...‚Äù). <br><br><img src="http://weblogs.asp.net/blogs/scottgu/image_thumb_26077003.png" alt="image"><br><br>  This will bring up a dialog box that allows you to specify that the breakpoint should be reached only N-times when the condition is reached either every N-times when it is reached, or every time after N occurrences: <br><br><img src="http://weblogs.asp.net/blogs/scottgu/image_thumb_23EA713A.png" alt="image"><br><br>  <u>Filtering by Machine / Thread / Process (Machine Name / Thread / Process)</u> <br>  You can also right-click on a breakpoint and select the ‚ÄúFilter ...‚Äù item from the context menu to indicate that the breakpoint should be reached if the debugging process occurs on a specific machine or in a specific process or in a specific thread. <br><br>  <b><u>Tracepoints - custom events when they hit a breakpoint</u></b> <br><br>  The debugger feature many people don‚Äôt know is the ability to use <a href="http://msdn.microsoft.com/en-us/library/232dxah7(v%3DVS.80).aspx">TracePoints</a> .  A trace point is a breakpoint at which a user event is triggered.  This functionality is especially useful when you need to track the behavior in your application without stopping in debugging. <br><br>  I use a simple console application to demonstrate how we could use Trace Points.  The following is a recursive implementation <a href="http://www.hanselman.com/blog/TheWeeklySourceCode13FibonacciEdition.aspx">of the Fibonacci series</a> : <br><br><img src="http://weblogs.asp.net/blogs/scottgu/image_thumb_5EA1F443.png" alt="image"><br><br>  In the application above, we use Console.WriteLine () to output the final value of a series for a specific range value.  What if we wanted to track the recursive sequence of the Fibonacci series in action while debugging ‚Äî without actually stopping or suspending it?  Trace points can help us do this easily. <br><br>  <u>Set Trace Point (TracePoint)</u> <br><br>  You can turn on trace points by using the F9 key to set a breakpoint in the code line and then right-click on the breakpoint and select the "When Hit ..." option from the context menu: <br><br><img src="http://weblogs.asp.net/blogs/scottgu/image_thumb_0ADE7B28.png" alt="image"><br><br>  This will bring up a dialog box that allows you to specify what should happen when a breakpoint is reached: <br><br><img src="http://weblogs.asp.net/blogs/scottgu/image_thumb_48F795D9.png" alt="image"><br><br>  Above, we indicated that we want to output a trace message every time a breakpoint condition is reached.  Notice that we have indicated that we want to output the value of the local variable ‚Äúx‚Äù as part of the message.  Local variables can be referenced using the {variableName} syntax.  There are also built-in commands (such as $ CALLER, $ CALLSTACK, $ FUNCTION, etc.) that can be used to display common values ‚Äã‚Äãin your trace messages. <br><br>  Above, we also checked the ‚Äúcontinue execution‚Äù checkbox below, which indicates that we do not need the application to stop in the debugger.  On the contrary, it will continue to be executed only with the difference that our custom trace message will be displayed every time the breakpoint conditions are reached. <br><br>  And now, when we run the application, we will see that our custom trace message is automatically displayed in the Visual Studio ‚Äúoutput‚Äù window, allowing us to monitor the recursive behavior of the application: <br><br><img src="http://weblogs.asp.net/blogs/scottgu/image_thumb_721F2E17.png" alt="image"><br><br>  As an alternative to the method described above, you can create a custom trace listener for your application; in this case, the messages generated at the trace points will be redirected to it instead of the VS. output window. <br><br>  <b><u>Trace Points (TracePoints) - Custom Macro Execution</u></b> <br><br>  In the conversation that I had last week in London, someone in the audience asked if it was possible to automatically output local variables when the Breakpoint was reached (TracePoint). <br><br>  This feature is not built into Visual Studio, but can be enabled using a custom macro and then setting up a trace point to invoke the macro when that point is reached.  To do this, open the integrated environment for macros inside Visual Studio (Tools-&gt; Macros-&gt; Macros IDE menu command).  Next, under the MyMacros node in the project browser, select a module or create a new one (for example: with the name ‚ÄúUsefulThings‚Äù).  After that, paste the following macro code on VB into the module and save it: <br><br>  <b>Vb:</b> <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">Sub</font> DumpLocals() <br> <br> <font color="#0000ff">Dim</font> outputWindow <font color="#0000ff">As</font> EnvDTE.OutputWindow <br> <br> outputWindow = DTE.Windows.Item(EnvDTE.Constants.vsWindowKindOutput). <font color="#0000ff">Object</font> <br> <br> <font color="#0000ff">Dim</font> currentStackFrame <font color="#0000ff">As</font> EnvDTE.StackFrame <br> <br> currentStackFrame = DTE.Debugger.CurrentStackFrame <br> <br> outputWindow.ActivePane.OutputString( <font color="#A31515">"*Dumping Local Variables*"</font> + vbCrLf) <br> <br> <font color="#0000ff">For</font> <font color="#0000ff">Each</font> exp <font color="#0000ff">As</font> EnvDTE.Expression <font color="#0000ff">In</font> currentStackFrame.Locals <br> <br> outputWindow.ActivePane.OutputString(exp.Name + <font color="#A31515">" = "</font> + exp.Value.ToString() + vbCrLf) <br> <br> <font color="#0000ff">Next</font> <br> <br> <font color="#0000ff">End</font> Sub</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">Sub</font> DumpLocals() <br> <br> <font color="#0000ff">Dim</font> outputWindow <font color="#0000ff">As</font> EnvDTE.OutputWindow <br> <br> outputWindow = DTE.Windows.Item(EnvDTE.Constants.vsWindowKindOutput). <font color="#0000ff">Object</font> <br> <br> <font color="#0000ff">Dim</font> currentStackFrame <font color="#0000ff">As</font> EnvDTE.StackFrame <br> <br> currentStackFrame = DTE.Debugger.CurrentStackFrame <br> <br> outputWindow.ActivePane.OutputString( <font color="#A31515">"*Dumping Local Variables*"</font> + vbCrLf) <br> <br> <font color="#0000ff">For</font> <font color="#0000ff">Each</font> exp <font color="#0000ff">As</font> EnvDTE.Expression <font color="#0000ff">In</font> currentStackFrame.Locals <br> <br> outputWindow.ActivePane.OutputString(exp.Name + <font color="#A31515">" = "</font> + exp.Value.ToString() + vbCrLf) <br> <br> <font color="#0000ff">Next</font> <br> <br> <font color="#0000ff">End</font> Sub</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">Sub</font> DumpLocals() <br> <br> <font color="#0000ff">Dim</font> outputWindow <font color="#0000ff">As</font> EnvDTE.OutputWindow <br> <br> outputWindow = DTE.Windows.Item(EnvDTE.Constants.vsWindowKindOutput). <font color="#0000ff">Object</font> <br> <br> <font color="#0000ff">Dim</font> currentStackFrame <font color="#0000ff">As</font> EnvDTE.StackFrame <br> <br> currentStackFrame = DTE.Debugger.CurrentStackFrame <br> <br> outputWindow.ActivePane.OutputString( <font color="#A31515">"*Dumping Local Variables*"</font> + vbCrLf) <br> <br> <font color="#0000ff">For</font> <font color="#0000ff">Each</font> exp <font color="#0000ff">As</font> EnvDTE.Expression <font color="#0000ff">In</font> currentStackFrame.Locals <br> <br> outputWindow.ActivePane.OutputString(exp.Name + <font color="#A31515">" = "</font> + exp.Value.ToString() + vbCrLf) <br> <br> <font color="#0000ff">Next</font> <br> <br> <font color="#0000ff">End</font> Sub</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <br><br>  <b>C #</b> <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">void</font> DumpLocals() { <br> EnvDTE.OutputWindow outputWindow; <br> outputWindow = DTE.Windows.Item[EnvDTE.Constants.vsWindowKindOutput].Object; <br> EnvDTE.StackFrame currentStackFrame; <br> currentStackFrame = DTE.Debugger.CurrentStackFrame; <br> outputWindow.ActivePane.OutputString(( <font color="#A31515">"*Dumping Local Variables*"</font> + <font color="#A31515">"\r\n"</font> )); <br> <font color="#0000ff">foreach</font> (EnvDTE.Expression exp <font color="#0000ff">in</font> currentStackFrame.Locals) { <br> outputWindow.ActivePane.OutputString((exp.Name + ( <font color="#A31515">" = "</font> <br> + (exp.Value.ToString() + <font color="#A31515">"\r\n"</font> )))); <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">void</font> DumpLocals() { <br> EnvDTE.OutputWindow outputWindow; <br> outputWindow = DTE.Windows.Item[EnvDTE.Constants.vsWindowKindOutput].Object; <br> EnvDTE.StackFrame currentStackFrame; <br> currentStackFrame = DTE.Debugger.CurrentStackFrame; <br> outputWindow.ActivePane.OutputString(( <font color="#A31515">"*Dumping Local Variables*"</font> + <font color="#A31515">"\r\n"</font> )); <br> <font color="#0000ff">foreach</font> (EnvDTE.Expression exp <font color="#0000ff">in</font> currentStackFrame.Locals) { <br> outputWindow.ActivePane.OutputString((exp.Name + ( <font color="#A31515">" = "</font> <br> + (exp.Value.ToString() + <font color="#A31515">"\r\n"</font> )))); <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">void</font> DumpLocals() { <br> EnvDTE.OutputWindow outputWindow; <br> outputWindow = DTE.Windows.Item[EnvDTE.Constants.vsWindowKindOutput].Object; <br> EnvDTE.StackFrame currentStackFrame; <br> currentStackFrame = DTE.Debugger.CurrentStackFrame; <br> outputWindow.ActivePane.OutputString(( <font color="#A31515">"*Dumping Local Variables*"</font> + <font color="#A31515">"\r\n"</font> )); <br> <font color="#0000ff">foreach</font> (EnvDTE.Expression exp <font color="#0000ff">in</font> currentStackFrame.Locals) { <br> outputWindow.ActivePane.OutputString((exp.Name + ( <font color="#A31515">" = "</font> <br> + (exp.Value.ToString() + <font color="#A31515">"\r\n"</font> )))); <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <br><br>  The macro code given above cycles through the current stack and outputs all variables to the output window. <br><br>  <u>Using our custom DumpLocals macro</u> <br><br>  Then we can use our custom macro ‚ÄúDumpLocals‚Äù a simple additional application, which is shown below: <br><br><img src="http://weblogs.asp.net/blogs/scottgu/image_thumb_2C6A7E2C.png" alt="image"><br><br>  We will use the F9 key to set a breakpoint on the return expression in our method. <br>  ‚ÄúAdd‚Äù above.  Then right-click on the breakpoint and select the ‚ÄúWhen hit‚Äù command from the context menu: <br><br><img src="http://weblogs.asp.net/blogs/scottgu/image_thumb_26AF6486.png" alt="image"><br><br>  This will bring up the following dialog box.  Unlike the previous code, where we used the ‚ÄúPrint a message‚Äù checkbox and manually defined the variables we want to output, this time we will select the Run a macro checkbox instead. and specify the macro UsefulThings.DumpLocals which we created above: <br><br><img src="http://weblogs.asp.net/blogs/scottgu/image_thumb_36DB2C7F.png" alt="image"><br><br>  We will leave the ‚Äúcontinue execution‚Äù flag so that the program continues to run even after reaching the Trace Point. <br><br>  <u>Application launch</u> <br><br>  And now, when we press the F5 key and run the application, we will see the following output in the ‚Äúoutput‚Äù window of Visual Studio when our Add method is launched.  Notice how the macro automatically lists in the list the name and value of each variable when the Trace Point is reached: <br><br><img src="http://weblogs.asp.net/blogs/scottgu/image_thumb_1AE9F787.png" alt="image"><br><br>  <b><u>Total</u></b> <br><br>  The Visual Studio debugger is incredibly rich in functions.  I strongly recommend taking some time to really explore all its possibilities.  The tips and tricks described above represent only a small fraction of its capabilities that people are not really aware of. <br><br>  Last time I wrote a blog about other improvements in the VS 2010 debugger (including displaying a data type prompt (DataTip), Import / Export breakpoints, Saving the latest values ‚Äã‚Äãof variables, and much more).  I will continue to write in the blog about the new features of VS 2010: Intellitrace, as well as support for debugging the dump file.  Publications will describe a bunch of additional cool new features that can make debugging applications even easier. <br><br>  Also, do not forget to watch the excellent series of Scott Kate Visual Studio 2010 Tips and Tricks to learn how best to use Visual Studio.  He has an unparalleled set of free videos and blog posts. <br><br>  Hope this helps, <br><br>  Scott <br><br>  PS In addition to blog posts, I also now use twitter for quick updates and link exchange.  Follow me: twitter.com/scottgu </div><p>Source: <a href="https://habr.com/ru/post/102178/">https://habr.com/ru/post/102178/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../102172/index.html">Video Stream: Acer's Android flagship</a></li>
<li><a href="../102173/index.html">Error messages + templates: some simple tips</a></li>
<li><a href="../102174/index.html">New information about Diablo3</a></li>
<li><a href="../102175/index.html">Torrent client BitTorrent - updated to version 7</a></li>
<li><a href="../102177/index.html">Creating documentation in .NET</a></li>
<li><a href="../102179/index.html">64-bit Windows is very simple</a></li>
<li><a href="../102180/index.html">Report from the Moscow demonstration of the VisLab Intercontinental Autonomous Challenge or Italian automatic wonder-machines in action</a></li>
<li><a href="../102181/index.html">Maven - reflections after two years of use</a></li>
<li><a href="../102184/index.html">OMF - microformat for email. Experience using chat services</a></li>
<li><a href="../102189/index.html">Smarty vs xslt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>