<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Draw Elliptic Curves with SQL</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The advantage of the approach based on elliptic curves in comparison with the problem of factoring the number used in RSA, or the problem of integer l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Draw Elliptic Curves with SQL</h1><div class="post__text post__text-html js-mediator-article">  The advantage of the approach based on elliptic curves in comparison with the problem of factoring the number used in RSA, or the problem of integer logarithmization used in the Diffie-Hellman algorithm and in DSS, is that in this case equivalent protection is provided with a smaller key length. <br><br>  In the general case, the equation of an elliptic curve E in the field of real numbers R has the form: <br><br>  - y ^ 2 + a1 * x * y + a3 * y = x ^ 3 + a2 * x ^ 2 + a4 * x + a6 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      or in the case of a finite residue ring Z | n: <br><br>  - y ^ 2 + a1 * x * y + a3 * y = x ^ 3 + a2 * x ^ 2 + a4 * x + a6 mod N <br><br>  We set ourselves the task of <b>visualizing an</b> elliptic curve. <br><br><h2>  Elliptic curve E in the field of real numbers R </h2><br>  If the elliptic curve E is considered in the field of real numbers R, then the construction of the graph can be described using only the knowledge of algebra and geometry of the upper classes <br><br>  arguments n a1 a2 a3 a4 a6 xmin xmax <br><ol><li>  Select the range [xmin - xmax] of the argument x </li><li>  We mark on the selected range of the argument x the necessary number of values ‚Äã‚Äãx1, ..., xN </li><li>  Each of the values ‚Äã‚Äãof x1, ..., xN is substituted into the equation y ^ 2 + a1 * x * y + a3 * y = x ^ 3 + a2 * x ^ 2 + a4 * x + a6 and we get the usual quadratic equation of the argument y </li><li>  Find the roots of the quadratic equation of the argument y </li><li>  If the quadratic equation of the argument y has solutions, then we add two points to the graph </li><li>  We connect with lines all the ‚Äúupper‚Äù points on the graph and all the ‚Äúlower‚Äù points on the graph. </li></ol><br><a name="habracut"></a><br>  - a = a (x) = 1 <br>  - b = b (x) = a1 * x + a3 <br>  - c = c (x) = - (x ^ 3 + a2 * x ^ 2 + a4 * x + a6) <br><br>  - ayy + by + c = 0 <br>  - D = bb-4ac <br>  - y1 = (- b-sqrt (D)) / (2a) <br>  - y2 = (- b + sqrt (D)) / (2a) <br><br><h3>  Implementation </h3><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">button1_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, EventArgs e</span></span></span><span class="hljs-function">)</span></span> { LockForm(); <span class="hljs-comment"><span class="hljs-comment">//    double a1 = GetA1(); double a2 = GetA2(); double a3 = GetA3(); double a4 = GetA4(); double a6 = GetA6(); //    X    double xmin = GetXmin(); double xmax = GetXmax(); ulong n = GetN(); // http://stackoverflow.com/questions/10622674/chart-creating-dynamically-in-net-c-sharp var series1 = new Series { Name = "Series1", Color = Color.Black, IsVisibleInLegend = false, IsXValueIndexed = true, ChartType = SeriesChartType.Line }; var series2 = new Series { Name = "Series2", Color = Color.Black, IsVisibleInLegend = false, IsXValueIndexed = true, ChartType = SeriesChartType.Line }; var sb = new StringBuilder(); var sb1 = new StringBuilder(); sb.AppendLine("y^2+a1*x*y+a3*y = x^3+a2*x^2+a4*x+a6"); sb.AppendLine("a1=" + a1); sb.AppendLine("a2=" + a2); sb.AppendLine("a3=" + a3); sb.AppendLine("a4=" + a4); sb.AppendLine("a6=" + a6); sb.AppendLine(); sb.AppendLine("# X Y1 Y2"); sb1.AppendLine("# X Y1 Y2"); for (ulong i = 0; i &lt;= n; i++) { double x = (xmin*(n - i) + xmax*i)/n; //       X const double a = 1; double b = a1*x + a3; double c = -(x*x*x + a2*x*x + a4*x + a6); //            double d = b*b - 4*a*c; if (d &lt; 0) continue; double y1 = (-b - Math.Sqrt(d))/(2*a); double y2 = (-b + Math.Sqrt(d))/(2*a); series1.Points.AddXY(x, y1); series2.Points.AddXY(x, y2); sb.AppendLine(x + " " + y1 + " " + y2); sb1.AppendLine(x + " " + y1 + " " + y2); } //      SetChart(series1, series2); SetReport(sb.ToString()); SetReport1(sb1.ToString()); UnlockForm(); ActivatePage(2); }</span></span></code> </pre> <br><h3>  Result </h3><br><img src="https://raw.githubusercontent.com/dprotopopov/mssove3/master/EllipticR.jpg" alt="Elliptic curve E in the field of real numbers R"><br><br><h2>  Elliptic curve E in the residue ring Z | n </h2><br>  If an elliptic curve E is considered for a finite residue ring Z | n, then the task of visualizing an elliptic curve is more difficult. <br>  In this case, we can propose a standard, easily programmable algorithm for rendezvous connecting the values ‚Äã‚Äãof the left and right sides of the equation of an elliptic curve E: <br><br>  - arguments N a1 a2 a3 a4 a6 <br><br><ol><li>  caching in tables the values ‚Äã‚Äãof the left and right sides of the equation </li><li>  build indexes for table columns </li><li>  make join tables by calculated values </li><li>  the resulting points after combining the tables depict in the graph. </li></ol><br><br>  To work with the cached values ‚Äã‚Äãof the left and right sides of the equation of the elliptic curve E, we will use DBMS, which will allow us to perform the work on indexing the columns of the tables and combining these tables in the most optimal way. <br><br>  t1 <br>  x key1 = x ^ 3 + a2 * x ^ 2 + a4 * x + a6 mod N <br>  one‚Ä¶ <br>  2 ... <br>  3 ... <br>  ... <br>  N rN <br><br>  t2 <br>  y key2 = y ^ 2 + a3 * y mod N <br>  one‚Ä¶ <br>  2 ... <br>  3 ... <br>  ... <br>  N lN <br><br>  t3 <br>  xy key3 = a1 * x * y mod N <br>  eleven‚Ä¶ <br>  12‚Ä¶ <br>  ... <br>  NN ... <br><br>  if (a1! = 0 mod N) select t1.x, t2.y from t1, t2, t3 where (key1 = key2 + key3 or key1 + N = key2 + key3) and t1.x = t3.x and t2. y = t3.y <br>  if (a1 == 0 mod N) select t1.x, t2.y from t1, t2 where key1 = key2 <br><br><h3>  Implementation </h3><br>  - DBMS - SQLite <br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">button1_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, EventArgs e</span></span></span><span class="hljs-function">)</span></span> { LockForm(); <span class="hljs-comment"><span class="hljs-comment">//    Z|n var n = GetN(); //    var a1 = GetA1(); var a2 = GetA2(); var a3 = GetA3(); var a4 = GetA4(); var a6 = GetA6(); // http://stackoverflow.com/questions/9173485/how-can-i-create-an-in-memory-sqlite-database var connection = new SQLiteConnection("Data Source=:memory:"); connection.Open(); //   string[] sqls1 = { "CREATE TABLE t1 (x INTEGER , key1 INTEGER )", "CREATE TABLE t2 (y INTEGER , key2 INTEGER )", "CREATE TABLE t3 (x INTEGER , y INTEGER , key3 INTEGER )" }; foreach (var sql in sqls1) new SQLiteCommand(sql, connection).ExecuteNonQuery(); //     for (ulong x = 0; x &lt; n; x++) { var x2 = (x*x)%n; var x3 = (x2*x)%n; var a2X2 = (a2*x2)%n; var a4X = (a4*x)%n; var key1 = (x3 + a2X2 + a4X + a6)%n; var sql = string.Format("INSERT INTO t1 (x, key1) VALUES ({0},{1})", x, key1); new SQLiteCommand(sql, connection).ExecuteNonQuery(); } for (ulong y = 0; y &lt; n; y++) { var y2 = y*y%n; var a3Y = (a3*y)%n; var key2 = (y2 + a3Y)%n; var sql = string.Format("INSERT INTO t2 (y, key2) VALUES ({0},{1})", y, key2); new SQLiteCommand(sql, connection).ExecuteNonQuery(); } if ((a1%n) != 0) for (ulong x = 0; x &lt; n; x++) { var a1X = (a1*x)%n; for (ulong y = 0; y &lt; n; y++) { var key3 = (a1X*y)%n; var sql = string.Format("INSERT INTO t3 (x, y, key3) VALUES ({0},{1},{2})", x, y, key3); new SQLiteCommand(sql, connection).ExecuteNonQuery(); } } //     string[] sqls2 = { "CREATE INDEX t1key1 ON t1 (key1)", "CREATE INDEX t2key2 ON t2 (key2)", "CREATE INDEX t3key3 ON t3 (key3)", "CREATE UNIQUE INDEX t1x ON t1 (x)", "CREATE UNIQUE INDEX t2y ON t2 (y)", "CREATE INDEX t3x ON t3 (x)", "CREATE INDEX t3y ON t3 (y)" }; foreach (var sql in sqls2) new SQLiteCommand(sql, connection).ExecuteNonQuery(); // http://stackoverflow.com/questions/10622674/chart-creating-dynamically-in-net-c-sharp var series1 = new Series { Name = "Series1", Color = Color.Black, IsVisibleInLegend = false, IsXValueIndexed = true, ChartType = SeriesChartType.Point }; //  JOIN     //   DBMS         var select = ((a1%n) == 0) ? "SELECT t1.x,t2.y FROM t1, t2 WHERE key1=key2" : "SELECT t1.x,t2.y FROM t1, t2, t3 WHERE (key1=key2+key3 or key1+" + n + "=key2+key3) AND t1.x=t3.x AND t2.y=t3.y"; var reader = new SQLiteCommand(select, connection).ExecuteReader(); var sb = new StringBuilder(); var sb1 = new StringBuilder(); sb.AppendLine("y^2+a1*x*y+a3*y = x^3+a2*x^2+a4*x+a6 mod n"); sb.AppendLine("n=" + n); sb.AppendLine("a1=" + a1); sb.AppendLine("a2=" + a2); sb.AppendLine("a3=" + a3); sb.AppendLine("a4=" + a4); sb.AppendLine("a6=" + a6); sb.AppendLine(); sb.AppendLine("# X Y"); sb1.AppendLine("# X Y"); while (reader.Read()) { var x = Convert.ToInt32(reader[0]); var y = Convert.ToInt32(reader[1]); series1.Points.AddXY(x, y); sb.AppendLine(x + " " + y); sb1.AppendLine(x + " " + y); } //      SetChart(series1); SetReport(sb.ToString()); SetReport1(sb1.ToString()); connection.Close(); UnlockForm(); ActivatePage(2); }</span></span></code> </pre><br><h3>  Result </h3><br><img src="https://raw.githubusercontent.com/dprotopopov/mssove3/master/EllipticZn.jpg" alt="Elliptic curve E in the residue ring Z | n"><br><br>  <b>Q.E.D</b> <br><br>  Source codes of programs are available at <a href="https://github.com/dprotopopov/mssove3">https://github.com/dprotopopov/mssove3</a> </div><p>Source: <a href="https://habr.com/ru/post/274473/">https://habr.com/ru/post/274473/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../274457/index.html">Defending Revel from CSRF attacks</a></li>
<li><a href="../274461/index.html">The tale of the compressor, which can be called, but I do not remember how</a></li>
<li><a href="../274463/index.html">We write DXE-driver for taking screenshots from BIOS Setup and other UEFI-applications</a></li>
<li><a href="../274469/index.html">BlackEnergy Trojan is used in cyber attacks on media and industrial facilities in Ukraine</a></li>
<li><a href="../274471/index.html">Multiplication tables ... kind of</a></li>
<li><a href="../274475/index.html">Rip network dictionaries using Node.js, part 1: static pages; CLI; DSL -> TXT, PDF, DjVu; related tasks</a></li>
<li><a href="../274477/index.html">Localization of WPF applications and instant culture change</a></li>
<li><a href="../274479/index.html">Yii2 bad behaviors</a></li>
<li><a href="../274481/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ192 (December 28, 2015 - January 3, 2016)</a></li>
<li><a href="../274483/index.html">Creating game levels: tips and tricks (part 1)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>