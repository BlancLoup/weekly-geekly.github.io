<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Localization of Android applications using Google Sheets</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! 

 In this article, I would like to share my little experience of using Google Tables when localizing an Android application. Initially, it ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Localization of Android applications using Google Sheets</h1><div class="post__text post__text-html js-mediator-article">  Good day! <br><br>  In this article, I would like to share my little experience of using Google Tables when localizing an Android application.  Initially, it was required to translate the developed application only into the language of the customer, i.e.  Norwegian.  At this time, IntelliJ Idea did not have a Translations Editor, and Android Studio was preparing to exit beta. <br><br>  The main non-negotiable requirement of the customer was that the translator should spend as little time as possible on the translation.  So, the translator needs to provide a table with strings for translation, he translates everything he needs, and then do whatever you want with it.  No additional software could be put to him, let alone SCM. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>TL; DR</b> <a href="https://docs.google.com/spreadsheets/d/11GOLgXLleRWXJKPNi-NGy-Uo5FqHU-i8HFWb3u_zFqs/edit%3Fusp%3Dsharing">finished document</a> .  To get the strings.xml files, click Export Files -&gt; Export sheets to strings.xml.  The Google Drive application, which should be installed on your machine, will download the result. <br><a name="habracut"></a><br>  At the very beginning, we used a simple Excel document for translation and email ping pong with a translator to communicate with it.  After manually transferring ~ 100 strings from strings.xml to the table, the desire to continue this shameful occupation disappeared.  It was implemented to import from xml into a table <a href="https://support.office.com/en-us/article/Import-XML-data-6eca3906-d6c9-4f0d-b911-c736da817fa4">using</a> Excel.  In the future, this document has become logical: various conditional formatting for visualizing newly added lines, support for the situation when the key of the line has been renamed. <br><br>  However, this whole structure had one big drawback - the lack of versioning.  Our translator received a new translation file containing already translated strings, as well as empty cells, where this translation had to be entered.  Everything was covered with a copper basin, when another 2 languages ‚Äã‚Äãwere added: Swedish and Danish.  Once, when merging 3 documents from 3 translators, the columns went to me, because of this, the wrong translations almost went into release. <br><br>  As a result, a new requirement was received from the customer, as well as a new requirement: no complicated logic in the table, only 4 columns - a key, English source code, Norwegian, Swedish and Danish translations.  To avoid problems with multiple copies of the document from each of the translators, I persuaded the customer to use Google Sheets.  I was no longer going to export the translations to strings.xml in any manual way - I was more than a little staring for inconsistencies in the strings after the ill-fated merging of different copies of the translation, when sweating on the forehead appeared in the monitor.  Then it turned out that for Google services you can very easily write extensions in a JS-like language - Google Script. <br><br>  Naturally, I was looking for ready-made services that solve this problem.  The first 3 links in Google and the response to <a href="http://stackoverflow.com/questions/2520891/any-collaborative-tool-website-to-localize-an-android-app">SO</a> did not give satisfactory results.  By the way, by the time of moving to Google Sheets, a new version of Idea was released, where Translations Editor appeared, which made life a little easier. <br><br>  So, a table was created in Google documents with 5 columns - key, English, Norwegian, Swedish, Danish and comments, as well as access rights were distributed.  To put data into a table from a project, you need to select everything in the Translation Editor and insert it into any table editor, delete extra columns (Untranslatable - we don‚Äôt use it) and insert the result into a Google document.  It is also necessary to mention that our project consists of several modules with their own translations; therefore, there are 2 tabs in the document, and the described operations should be performed once for each project. <br><br>  The result is a table with strings for translation, which translators can easily edit together.  When the translation is completed, you need to transfer the result back to your project.  I began to think about how I would get everything at once.  The maximum effort I was willing to make was 1 copy.  The only solution that came to my mind was to export the results to Google Drive, from where the desktop application would pull me to my PC.  If the correct folder hierarchy was previously created, then I can copy and overwrite the strings.xml files into 1 action.  Here, without writing a small script is not enough. <br><br>  Click Tools-&gt; Script Editor and get into an almost full-fledged IDE with auto-completion and debug directly in the browser!  Also created a small piece of code that creates an additional menu, you Google tables UI.  Clicking on this item will be the entry point. <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onOpen</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> spreadsheet = SpreadsheetApp.getActiveSpreadsheet(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> entries = [{ <span class="hljs-attr"><span class="hljs-attr">name</span></span> : <span class="hljs-string"><span class="hljs-string">"Export Sheets To strings.xml"</span></span>, <span class="hljs-attr"><span class="hljs-attr">functionName</span></span> : <span class="hljs-string"><span class="hljs-string">"readAndExport"</span></span> }]; spreadsheet.addMenu(<span class="hljs-string"><span class="hljs-string">"Export Files"</span></span>, entries); };</code> </pre> <br><br>  Next, a simple code goes through the sheets (tabs), reads the column headings, compiles an xml string from the values ‚Äã‚Äãin the cells and writes it to the strings.xml file on your Google disk in the trunk / [sheet_name] / res / values- [column_name] / strings directory .xml.  The source itself can be viewed directly in the submitted file.  From the unusual one can mention that in Google drive the name of a directory or file is not unique, i.e.  You can create 2 files or directories with the same name.  For everything to work properly, you need to use something like this code: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOrCreate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">root, name</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> iterator = root.getFoldersByName(name); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(iterator.hasNext()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> iterator.next(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> root.createFolder(name); } }</code> </pre><br><br><h4>  Conclusion </h4><br>  Google Apps have a truly simple yet powerful API.  Another advantage is the fact that right out of the box there is access to the API of any Google application: calendar, disk, mail, etc.  I quickly managed to create a simple and convenient tool for localizing our application.  Of course, there are still places in it that I would like to improve, however, I got rid of the main problem: copying and editing multiple files with the same structure and names.  This inevitably led to errors caused by inattention. </div><p>Source: <a href="https://habr.com/ru/post/251943/">https://habr.com/ru/post/251943/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../251933/index.html">The magic of one div. Masterclass from the creator of a.singlediv.com</a></li>
<li><a href="../251935/index.html">Ciklum Dnepropetrovsk C ++ Saturday: The first subbotnik of the year for C ++ fans is happy to meet everyone</a></li>
<li><a href="../251937/index.html">Reading GATT-characteristics of a Bluetooth device</a></li>
<li><a href="../251939/index.html">We use web application downtime for background tasks.</a></li>
<li><a href="../251941/index.html">If Seagate was dusty ...</a></li>
<li><a href="../251945/index.html">Combat use of the C # compiler for WEB Forms</a></li>
<li><a href="../251947/index.html">Introducing a series of technical webinars</a></li>
<li><a href="../251949/index.html">Dell PowerEdge Solutions for Movie Content Provider</a></li>
<li><a href="../251951/index.html">Weekly assembly Vivaldi 1.0.118.2</a></li>
<li><a href="../251955/index.html">Telephone Directory</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>