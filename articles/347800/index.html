<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>VoiceAttack Security Study</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Which eventually threw a few pleasant surprises. Carefully, under the cut there are a lot of screenshots in the highres and not the highres, which are...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>VoiceAttack Security Study</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/j0/j3/9d/j0j39dklli68enonvxtuvftnugc.png"><br><br>  Which eventually threw a few pleasant surprises.  Carefully, under the cut there are a lot of screenshots in the highres and not the highres, which are not removed under the spoiler due to their incredible importance.  Oh, and there is also a joke about centaur genitals, but it is also included solely for the context. <br><a name="habracut"></a><br>  VoiceAttack is known in game lovers like Star Citizen and Elite: Dangerous, and is a fairly simple tool for associating keystrokes with voice commands.  With a great desire, it can be used to control the PC, but it is fully revealed after putting on the head of VR-glasses <br><br><div class="spoiler">  <b class="spoiler_title">break for a joke about VR</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/3aa/bc9/b59/3aabc9b59827c70e352b6263821fc71e.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </div></div><br>  ... and launch any of the above games. <br><br>  My first acquaintance with VoiceAttack took place while watching a <a href="https://www.youtube.com/watch%3Fv%3Ds4QkltClArw">wonderfully delivered video</a> from Mr. Rimas, during which I involuntarily began to respect the Windows speech recognizer, who somehow understood such a terrible accent. <br><br>  Since I didn't have a VR helmet (as, incidentally, no money for it), I decided to play around with the recently shared with me through Steam Elite: Dangerous, driving a standard ship with a voice.  Running to VoiceAttack, I marveled at the developers appetites (10 bucks for the wrapper of the built-in speech recognizer), and immediately decided for myself that I would use the maximum demo version of the program.  However, when I tried to download the downloaded profile, I found another gift from the developers - the demo version of the program fails to save more than 20 commands at the same time, which, of course, complicates communication with the ship somewhat - the number of controls in E: D is clearly more than twenty. <br><br><h3>  The quest for pill greed </h3><br><img src="https://habrastorage.org/webt/h9/1y/8u/h91y8uutkbouabw2-eqe_ifzduc.jpeg"><br><br>  Being a proud pirate who did not want to pay 500 rubles for a license, I climbed into the Internet for a crack.  I was disappointed in the form of a heap of broken links, ransomware, and other dregs offered by the Network in the absence of the necessary data.  The only piece of information was <a href="https://forum.exetools.com/showthread.php%3Ft%3D18102">found</a> on the exetools forum, but described the old version of the program.  We had to do something, or spit and do nothing already. <br><br><h3>  Research work </h3><br>  So, for starters, just run VoiceAttack.  After the certificate, as expected, you will be asked to register the key: <br><br><img src="https://habrastorage.org/webt/ea/05/_h/ea05_hequrtsgtqcbnbqr4cwh64.png"><br><br>  Referring to the online help, we learn that the key is sixteen-digit, and consists of both numbers and letters: <br><br><img src="https://habrastorage.org/webt/dj/ku/a8/djkua8ffydzvwb0y7tp4u_joh0q.png"><br><br>  After trying to fill the fields with garbage, it became clear that there are checks on the validity of the key: <br><br><img src="https://habrastorage.org/webt/ja/u7/qo/jau7qo4_v6kuzxx0kuo2k5onrly.png"><br><br><img src="https://habrastorage.org/webt/j7/cg/bf/j7cgbfakzzrishp2gknjmpbupzs.png"><br><br>  We enter everybody's favorite test@example.com, 16 digits, and admire checking the key on the server, and the error message: <br><br><img src="https://habrastorage.org/webt/j8/sq/qe/j8sqqevqhnek53gwi0uilujgesg.png"><br><br><img src="https://habrastorage.org/webt/qf/fj/ls/qffjls7yctrxj4t-jiozabjcrhc.png"><br><br>  Actually, the exploration on this can be completed.  The principle of registration is quite simple - the program explicitly communicates with the remote server, transmits our registration data, and analyzes the answer.  Such a method is corrected either by a program patch so that it does not climb into the network and immediately considers the key to be correct, or, in order to satisfy Monsieur‚Äôs interests, the registration server emulator is written.  And this will do. <br><br><h3>  Analysis and Deobfuscation </h3><br>  For analyzing executables, I like to use exeinfope - cheap and cheerful (and there is a line of information for lamers!) <br><br>  Open VoiceAttack.exe in exeinfope: <br><br><img src="https://habrastorage.org/webt/zb/81/nb/zb81nbhikpfrg79jtevyscbcosw.png"><br><br>  Great, we were lucky - .NET + SmartAssembly is akin to a jackpot - whether the program was written in C ++ (and God forbid just under x64), or obfuscated with something more interesting, you would have to poke around in a spaghetti crookedly disassembled output.  And so we can easily do with the dnSpy decompiler and de4dot deobfuscator. <br><br>  Copy the program files to a separate folder and deobfustsiruem: <br><br><img src="https://habrastorage.org/webt/uy/ny/id/uynyidnwpx6mgfmwpgpqx-ydqjq.png"><br><br>  We are ready for debug and code analysis. <br><br><h3>  Analysis of network activity registration </h3><br>  First, let's launch VoiceAttack, and enter our invalid registration data.  Click OK, and quickly stop the program in the debugger.  We see the following: <br><br><img src="https://habrastorage.org/webt/_2/3f/uy/_23fuybmb_nbsokl1l6snbtdgdq.png"><br><br>  As we thought, during registration, the program knocks on the voiceattack.com server and sends registration data there.  We take out the request string: <br><br><pre><code class="hljs objectivec">http:<span class="hljs-comment"><span class="hljs-comment">//voiceattack.com/Validate.aspx?pv=JcArVyeUmUOZfJVj6utdKw==&amp;em=iEm1cpNSBqMsA06LJExtLntuDo0yvQwPzKuIJhhbLt8=&amp;vk=A1Zkz8zPx2VUdM1oi+mKHHtuDo0yvQwPzKuIJhhbLt8=&amp;sg=OBaQB9KBl8iHF1miBzpp/Q==&amp;nn=gXWP+H1uDbYW+crJfgFNs8gexDihTyvNmjpBzp/I0//f3IvaGDFmFz+ll1WxqPdu6iC0SAGY1eJBMRvl2GIr2A==&amp;pr=0+jAkAfwc3I1ZMHk2zdDz3tuDo0yvQwPzKuIJhhbLt8=</span></span></code> </pre> <br>  A new problem is immediately visible - obviously more parameters are being transmitted to the server than we set, and also in base64.  We try to decode base64: <br><br><img src="https://habrastorage.org/webt/z0/jz/fo/z0jzfogwa85dnroj-fpvyhuglyi.png"><br><br>  Not bad, the data is also encrypted.  Need to understand further. <br><br><h3>  Encryption analysis and hacking </h3><br>  Find in dnSpy registration form.  After a brief search, we find the appropriate form frmRegister and climb into the event code btnOk_Click: <br><br><img src="https://habrastorage.org/webt/0g/hr/uk/0ghruk7q9uuynn4lirvx0edgggm.png"><br><br>  It seems, that is necessary.  Visible texts already familiar to us errors.  Let's rewind the code to the moment of connection with the server we need: <br><br><img src="https://habrastorage.org/webt/di/h0/fv/dih0fvatewbqhrrwomwoazlhbuw.png"><br><br>  The HTTP response is written to the response variable.  Find where the encrypted response body is written: <br><br><img src="https://habrastorage.org/webt/fb/h8/im/fbh8imf0jmuazrqjnirljb1tcxa.png"><br><br>  We turn the code further, looking for the mention of the text8 variable and stumble upon its rewriting with the help of a certain function: <br><br><img src="https://habrastorage.org/webt/8k/p6/jg/8kp6jgxzwwnpwtltjjvxkvrerrw.png"><br><br>  Go to the function and see what hit the mark: <br><br><img src="https://habrastorage.org/webt/1f/kn/8_/1fkn8_jsan9llrdcrhp5-8dab68.png"><br><br>  Obviously, the function implements AES-decryption of the input string, and returns the decrypted result.  Now all that remains is to catch the key contained in the variable this.byte_0.  Set breakpoint and run the program.  At the time of reaching breakpoint, we climb into the values ‚Äã‚Äãof variables: <br><br><img src="https://habrastorage.org/webt/0u/sr/3b/0usr3bd3iiqq_rskyvvfynexedg.png"><br><br>  Now we have all the turnout and passwords.  You can begin work on the registration server emulation. <br><br><h3>  Registration server </h3><br>  To begin with, we will write an encryption and decryption tool based on the found key: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Security.Cryptography; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">enc</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> text</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> result; Rijndael rijndael = Rijndael.Create(); rijndael.Mode = CipherMode.ECB; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] bytes = Encoding.ASCII.GetBytes(text); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] key = {<span class="hljs-number"><span class="hljs-number">0x74</span></span>,<span class="hljs-number"><span class="hljs-number">0x72</span></span>,<span class="hljs-number"><span class="hljs-number">0x75</span></span>,<span class="hljs-number"><span class="hljs-number">0x65</span></span>,<span class="hljs-number"><span class="hljs-number">0x47</span></span>,<span class="hljs-number"><span class="hljs-number">0x52</span></span>,<span class="hljs-number"><span class="hljs-number">0x49</span></span>,<span class="hljs-number"><span class="hljs-number">0x54</span></span>}; <span class="hljs-comment"><span class="hljs-comment">//  result = Convert.ToBase64String(rijndael.CreateEncryptor(key, null).TransformFinalBlock(bytes, 0, bytes.Length)); Console.WriteLine(result); } public static void dec(string text) { string result; Rijndael rijndael = Rijndael.Create(); rijndael.Mode = CipherMode.ECB; byte[] key = {0x74,0x72,0x75,0x65,0x47,0x52,0x49,0x54}; byte[] bytes = Convert.FromBase64String(text); result = Encoding.ASCII.GetString(rijndael.CreateDecryptor(key, null).TransformFinalBlock(bytes, 0, bytes.Length)); Console.WriteLine(result); } public static void Main(string[] args) { if(args[0]=="enc") { enc(args[1]); } else if (args[0]=="dec") { dec(args[1]); } } }</span></span></code> </pre><br>  Let's try to decrypt the parameters transmitted to the server: <br><br><img src="https://habrastorage.org/webt/dm/3q/ee/dm3qeenpwobbjsbps0vj8milniq.png"><br><br>  Fine.  Now we can see what the program sends to the server after all.  We will request the result yourself on the url already familiar to us and decrypt it: <br><br><img src="https://habrastorage.org/webt/jb/lt/7l/jblt7l6fjvpdpfv8a3krtpvjvnk.png"><br><br>  It seems that the server sends the answer in the form of%. The result is validation% _% Information%.  Turn again to the code and find out what answer means success: <br><br><img src="https://habrastorage.org/webt/go/tg/yf/gotgyfnas6njbmhltctjf74kmoa.png"><br><br>  Quickly run to bring <a href="http://www.voiceattack.com/">www.voiceattack.com</a> to hosts, encrypt the string "Validation Success_some useless info" by our program, host the page, register the program ... <br><br>  And we receive in response a whole cookie in butter - when opening the program again offers to register.  This behavior means only one thing - a license check has been implemented at startup. <br><br><h3>  We finalize the server </h3><br>  Again we climb into the decompiled code.  We find the method of loading the main form frmMain_Load and after a brief search we see the code for invoking the form to register: <br><br><img src="https://habrastorage.org/webt/td/0v/ki/td0vkiat6bzkhn_xglii_nf2xgm.png"><br><br>  Pay attention to the condition of the transition to the form load branch - some variable is checked this.bool_89.  Let's wind off the code a little higher and see how its value is formed: <br><br><img src="https://habrastorage.org/webt/n6/t_/fg/n6t_fgbbyfeb41tb3olehpiwep4.png"><br><br>  There is a check of compliance of one line with another.  On the right is a ValidationKey, on the left is the application of the method on a list of strings.  What method do you think is alternately applied to all these lines? <br><br>  We set breakpoint on the comparison string to find out the values ‚Äã‚Äãof the string_ and text strings.  We get: <br><br><img src="https://habrastorage.org/webt/5h/e5/-l/5he5-l65tkcg5y7wn5iw5p0swfk.png"><br><br>  What values ‚Äã‚Äãare substituted into the registrationEmail and registrationKey strings, I think that's understandable. <br><br>  We are finalizing the server for parsing a GET request and generating a suitable response: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> SimpleHTTPServer <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> BaseHTTPServer <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SocketServer <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> subprocess <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> urlparse <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> urlparse <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> urllib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> unquote <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ctypes, sys, os PORT = <span class="hljs-number"><span class="hljs-number">80</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">aes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(action, text)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> subprocess.Popen([<span class="hljs-string"><span class="hljs-string">"VoiceAttackCipher.exe"</span></span>, action, text], stdout=subprocess.PIPE).communicate()[<span class="hljs-number"><span class="hljs-number">0</span></span>][:<span class="hljs-number"><span class="hljs-number">-2</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">patch_hosts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">"C:\WINDOWS\System32\drivers\etc\hosts"</span></span>, <span class="hljs-string"><span class="hljs-string">"a"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> hosts_file: hosts_file.write(<span class="hljs-string"><span class="hljs-string">"\n127.0.0.1 www.voiceattack.com"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unpatch_hosts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">"C:\WINDOWS\System32\drivers\etc\hosts"</span></span>, <span class="hljs-string"><span class="hljs-string">"r"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> hosts_file: hosts_lines = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> hosts_file: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> line != <span class="hljs-string"><span class="hljs-string">"127.0.0.1 www.voiceattack.com"</span></span>: hosts_lines.append(line) hosts_lines[<span class="hljs-number"><span class="hljs-number">-1</span></span>] = hosts_lines[<span class="hljs-number"><span class="hljs-number">-1</span></span>].strip(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">"C:\WINDOWS\System32\drivers\etc\hosts"</span></span>, <span class="hljs-string"><span class="hljs-string">"w"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> hosts_file: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> hosts_lines: hosts_file.write(line) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyHandler</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(BaseHTTPServer.BaseHTTPRequestHandler)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do_HEAD</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s)</span></span></span><span class="hljs-function">:</span></span> s.send_response(<span class="hljs-number"><span class="hljs-number">200</span></span>) s.send_header(<span class="hljs-string"><span class="hljs-string">"Content-type"</span></span>, <span class="hljs-string"><span class="hljs-string">"text/html"</span></span>) s.end_headers() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do_GET</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""Respond to a GET request."""</span></span> query = urlparse(s.path).query query_components = dict(qc.split(<span class="hljs-string"><span class="hljs-string">"="</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> qc <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> query.split(<span class="hljs-string"><span class="hljs-string">"&amp;"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Got registration request! Processing..."</span></span> key = aes(<span class="hljs-string"><span class="hljs-string">"dec"</span></span>, unquote(query_components[<span class="hljs-string"><span class="hljs-string">"vk"</span></span>])) mail = aes(<span class="hljs-string"><span class="hljs-string">"dec"</span></span>, unquote(query_components[<span class="hljs-string"><span class="hljs-string">"em"</span></span>])) magic_1 = aes(<span class="hljs-string"><span class="hljs-string">"dec"</span></span>, unquote(query_components[<span class="hljs-string"><span class="hljs-string">"pv"</span></span>])) magic_2 = aes(<span class="hljs-string"><span class="hljs-string">"dec"</span></span>, unquote(query_components[<span class="hljs-string"><span class="hljs-string">"sg"</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Key:"</span></span>, key <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"E-Mail:"</span></span>, mail <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Magic number #1:"</span></span>, magic_1 <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Magic number #2:"</span></span>, magic_2 <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Creating validation key..."</span></span> validation_key = aes(<span class="hljs-string"><span class="hljs-string">"enc"</span></span>, <span class="hljs-string"><span class="hljs-string">"{}{}{}{}"</span></span>.format(magic_1, mail, key, magic_2)) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Validation key:"</span></span>, validation_key <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Creating response..."</span></span> response = aes(<span class="hljs-string"><span class="hljs-string">"enc"</span></span>, <span class="hljs-string"><span class="hljs-string">"Validation Success_{}"</span></span>.format(validation_key)) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Response:"</span></span>, response s.send_response(<span class="hljs-number"><span class="hljs-number">200</span></span>) s.send_header(<span class="hljs-string"><span class="hljs-string">"Content-type"</span></span>, <span class="hljs-string"><span class="hljs-string">"text/html"</span></span>) s.end_headers() <span class="hljs-comment"><span class="hljs-comment">#   "Validation Success_{}".format(enc(dec(pv)+dec(em)+dec(vk)+dec(sg))) s.wfile.write(response) print "Done! Your program should be registered now!" if __name__ == "__main__": print "Starting VoiceAttack Activation Server..." print "Checking privileges..." is_admin = ctypes.windll.shell32.IsUserAnAdmin() != 0 if not is_admin: print "Error: please run this program with admin rights." os.system("pause") sys.exit() print "All good." print "Patching hosts..." patch_hosts() print "VoiceAttack Server Started!" print "You can try to register VoiceAttack." print "Press [Ctrl+C] after successful registration." try: httpd = SocketServer.TCPServer(("", PORT), MyHandler, bind_and_activate=False) httpd.allow_reuse_address = True httpd.server_bind() httpd.server_activate() httpd.serve_forever() except KeyboardInterrupt: httpd.server_close() except Exception as e: print e finally: print "Voice Attack Server is shutting down..." #print "Un-patching hosts..." #unpatch_hosts() #    ,        print "Bye-bye." os.system("pause")</span></span></code> </pre><br><h3>  Instead of conclusion </h3><br>  All of the above was done solely out of sports interest, and even more from happiness that with the next attempt to unzip the program, I will not have to spit on Ida's listings.  I wanted to give birth to my first post for a long time, and here I was also invited by a UFO - so I urge you to write in the comment if something is wrong or somehow not very. </div><p>Source: <a href="https://habr.com/ru/post/347800/">https://habr.com/ru/post/347800/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../347786/index.html">Cast. Visual contrast static_cast from dynamic_cast</a></li>
<li><a href="../347788/index.html">5 innovative ways to use machine learning</a></li>
<li><a href="../347790/index.html">Winter open lectures on the gaming industry</a></li>
<li><a href="../347794/index.html">We make our firmware for an IP camera on Rust and fight fraud</a></li>
<li><a href="../347798/index.html">Lectures Technopolis. Design of high-load systems (fall 2017)</a></li>
<li><a href="../347802/index.html">I hated javascript. And now I like him</a></li>
<li><a href="../347804/index.html">WebAssembly and DOM manipulations</a></li>
<li><a href="../347806/index.html">20+ resources to start freelancing</a></li>
<li><a href="../347808/index.html">fx - jq alternative for command line JSON processing</a></li>
<li><a href="../347810/index.html">Learning to reliably manage Kubernetes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>