<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google Drive. Report with data from the table. Creating a simple database. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I think everyone knows about Google Drive (Google Docs), and many probably know about Google Apps Script , if anyone does not know, you can read , in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google Drive. Report with data from the table. Creating a simple database. Part 1</h1><div class="post__text post__text-html js-mediator-article">  I think everyone knows about Google Drive (Google Docs), and many probably know about <a href="https://developers.google.com/apps-script/%3Fhl%3Dru-RU">Google Apps Script</a> , if anyone does not know, you can <a href="https://developers.google.com/apps-script/%3Fhl%3Dru-RU">read</a> , in short, this is the API for Google documents.  I present another way to use Google Spreadsheet (Tables) and Google Doc (Document), to generate documents with data from the table. <br><a name="habracut"></a><br>  For those who first learned about GAS (Google Apps Script) I advise you to read <a href="https://developers.google.com/apps-script/guide_getting_started%3Fhl%3Dru-RU">Getting Started with Google Apps Script</a> <br><br>  Task: Automate the process of creating documents. <br>  Decision: <br><br>  1. Open the database, find the necessary data; <br>  2. Create a copy of the template; <br>  3. Fill in the copied template; 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For data storage we will use Tables, for storage of a template we will use Document. <br>  Document - contains the formatted text of the document for issuing to the client, in which the client data is stored in variables (in my case such variables were used:). <br><br>  In the tables we will store the data itself in this structure: <br><img src="https://habrastorage.org/storage2/b95/624/211/b95624211fc419a26bb59a6f85fb267d.png"><br><br>  For an example of a template, take the text: <br><img src="https://habrastorage.org/storage2/7c1/20a/370/7c120a370d04ab8bf4b1cb9bebb3dd5f.png"><br><br>  A few words about the ID, in the Disk each object has its own ID and you can get it by looking at the browser line when the object is open (Document, Table, Folder): <br><img src="https://habrastorage.org/storage2/670/83a/7e2/67083a7e2714dfe290d57dcfd6a83a0c.png"><br><br>  Below is the code, I think it is quite commented, please forgive my <s>French</s> English.  Entry point of the doAction () script: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">function</font> doAction() { <br> <br> <font color="#0000ff">var</font> result = ReadBaseData( <font color="#A31515">"31-05-2012"</font> ); <br> <font color="#008000">//If found data for this date...</font> <br> <font color="#0000ff">if</font> (result != <font color="#0000ff">null</font> ) { <br> <font color="#0000ff">var</font> doc = CreateNewDoc( <font color="#A31515">"Act from "</font> + result[0][0]); <br> FillTemplate(doc, result); <br> } <br> } <br> <font color="#008000">//inDoc - its a empty template, inData - data for filling template</font> <br> <font color="#0000ff">function</font> FillTemplate(inDoc, inData) { <br> <font color="#008000">//Getting count of files in folder</font> <br> <font color="#0000ff">var</font> NUM = DocsList.getFolderById(FOLDER_ID).getFiles().length; <br> <br> <font color="#008000">//Replace masks (Don't work [NUM] or $NUM or something else)</font> <br> inDoc.replaceText( <font color="#A31515">"&lt;NUM&gt;"</font> , NUM + 1); <br> inDoc.replaceText( <font color="#A31515">"&lt;DATE&gt;"</font> , Utilities.formatDate(inData[0][0], <font color="#A31515">"GMT"</font> , <font color="#A31515">"dd.MM.yyyy"</font> )); <br> <br> <font color="#008000">//get first table in document</font> <br> <font color="#0000ff">var</font> table = curDoc.getTables()[0]; <br> <font color="#0000ff">for</font> (i=0; i&lt; inData.length; i++) { <br> <font color="#0000ff">var</font> row = table.appendTableRow(); <br> row.appendTableCell(inData[i][1]); <br> row.appendTableCell(inData[i][2]); <br> } <br> curDoc.saveAndClose(); <br> <br> } <br> <font color="#0000ff">function</font> CreateNewDoc(docName) { <br> <font color="#008000">//Making copy of blank file</font> <br> <font color="#0000ff">var</font> blankDoc = DocsList.getFileById(BLANK_DOC_ID).makeCopy(docName); <br> blankDoc.addToFolder(DocsList.getFolderById(FOLDER_ID)); <br> <br> <font color="#008000">//return working doc and table base</font> <br> <font color="#0000ff">return</font> curDoc = DocumentApp.openById(blankDoc.getId()); <br> } <br> <font color="#008000">//get range and sort only for day from parameter</font> <br> <font color="#0000ff">function</font> ReadBaseData(inDate) { <br> <font color="#0000ff">var</font> ssDoc = SpreadsheetApp.openById(BASE_TABLE_ID).getActiveSheet(); <br> <br> <font color="#008000">//get filled range</font> <br> <font color="#0000ff">var</font> data = ssDoc.getDataRange().getValues(); <br> <br> <font color="#008000">//create new array with data to inDate,</font> <br> <font color="#008000">//for start from 1 because first row is text column headers</font> <br> <font color="#0000ff">var</font> filteredData = <font color="#0000ff">new</font> Array( <font color="#0000ff">new</font> Array() ); <br> <font color="#0000ff">for</font> (i=1; i&lt; data.length; i++) { <br> data[i][0] = convertDate(data[i][0]); <br> <font color="#0000ff">if</font> (data[i][0] == inDate &amp;&amp; data[i][3] == 1) { <br> filteredData[i-1] = data[i]; <br> } <br> } <br> <font color="#0000ff">return</font> filteredData; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  At the end we get a new document in the folder with the Acts. <br><img src="https://habrastorage.org/storage2/539/b73/a75/539b73a75bef6a7e0da5e911a7156fce.png"><br>  and filled with data from the table <br><img src="https://habrastorage.org/storage2/bcc/edf/80e/bccedf80ee13f00dd386689ff1b2d281.png"><br>  Thus it is possible to automate the simple issuance of invoices or acts in a small office, without installing application software. <br><br>  If it is interesting, I can continue in the next article on GUI. <br><br>  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/145416/">https://habr.com/ru/post/145416/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../145409/index.html">Automation of IT processes in conditions of low motivation and / or qualifications of performers</a></li>
<li><a href="../145410/index.html">Effective web development with Visual Studio 2012: innovations in packaging and minification of scripts and styles</a></li>
<li><a href="../145411/index.html">How we did the map services</a></li>
<li><a href="../145412/index.html">Get rid of worthlessness</a></li>
<li><a href="../145415/index.html">All information technologies in summary</a></li>
<li><a href="../145417/index.html">Getting free EDS keys in Ukraine</a></li>
<li><a href="../145418/index.html">WWDC banners over the past 5 years</a></li>
<li><a href="../145419/index.html">Meet the free and free font Underdog</a></li>
<li><a href="../145421/index.html">How many habrazhiteli served in the army?</a></li>
<li><a href="../145422/index.html">New versions of Windows Azure tools released, Python support added</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>