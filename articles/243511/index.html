<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>IOS Masque Vulnerability Check</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently published article related to the so-called. "Masque" vulnerabilities in iOS. Excerpt from the article: 
 ‚ÄúVulnerability allows you to install...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>IOS Masque Vulnerability Check</h1><div class="post__text post__text-html js-mediator-article">  Recently published <a href="http://habrahabr.ru/company/eset/blog/243279/">article</a> related to the so-called.  "Masque" vulnerabilities in iOS.  Excerpt from the article: <br><blockquote>  ‚ÄúVulnerability allows you to install a malicious application on top of an existing one, and this new application will get access to all files of the previous one.  This is assuming that the application being installed will have the same ‚Äúbundle identifier‚Äù, which iOS &amp; OS X use to identify applications at the OS level, for example, when delivering updates to them.  All versions of iOS since 7.1.1 are affected, including the latest iOS 8.1.1 beta. ‚Äù <br></blockquote><br>  I, as a person who has first-hand knowledge of Enterprise certificates, wanted to certainly deny / prove the real fact. <br><br>  So, what is known about the Enterprise license: <br><a name="habracut"></a><br>  1. Issued exclusively to companies (not individuals, <a href="https://developer.apple.com/programs/start/enterprise/">detailed information</a> ); <br>  2. To obtain an Enterprise license, you must provide Apple with a very serious set of documents.  So it‚Äôs impossible to specify a non-existent company; <br>  3. Enterprise licenses are issued <b>solely</b> for internal use.  The fact that some applications are distributed in this way is the risk of the company being excluded from the iOS Developer Enterprise Program; <br>  4. Installing the application from the site is possible through the manifest file and only through HTTPS; <br>  5. When installing an application signed by the Enterprise license, the user displays the message ‚ÄúDo you really want to install the application‚Äú App_Name ‚Äù, signed with the certificate‚Äú Company_Name ‚Äù?‚Äù, While Company_Name is taken from the certificate. <br><br>  In order to check the presence of a vulnerability, try to pass the path of the attacker. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To sign an application, you need to create Provisioning Profiles: <br><br><div class="spoiler">  <b class="spoiler_title">Creating Provisioning Profiles</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/572/072/0cf/5720720cfd36467cb5f6ce6454287efa.png" alt="image"></div></div><br><br>  The next step is specifying the App ID: <br><br><div class="spoiler">  <b class="spoiler_title">Choose App ID</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/4e8/d27/89a/4e8d2789a8cc44d79392972ac725d7bf.png" alt="image"></div></div><br><br>  But, in order to specify it, you need to create this App ID: <br><br><div class="spoiler">  <b class="spoiler_title">Create App ID</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/8ae/b92/c1c/8aeb92c1c52849a1a6ce711a414924c3.png"></div></div><br><br>  The image shows that when creating an App ID with an <a href="https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/AppDistributionGuide/ConfiguringYourApp/ConfiguringYourApp.html">identifier</a> ‚Äúbundle identifier‚Äù similar to another application, an error is caused. <br><br>  Total: <br>  Provisioning Profiles can only be obtained with an App ID, which in turn cannot be created with an already registered ‚Äúbundle identifier‚Äù.  And without Provisioning Profiles, we will not be able to sign the application. <br><br>  <b>Step 2</b> <br><br>  There is another way to create an App ID "Wildcard App ID".  The company's website says: <blockquote>  This allows you to match multiple apps.  To create a wildcard App ID, enter an asterisk (*) as the last digit in the Bundle ID field. </blockquote><br><br><div class="spoiler">  <b class="spoiler_title">Creating Wildcard App ID</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/a10/020/6b4/a100206b471b4f09a46b18b57f3d8875.png"></div></div><br><br>  Create your own wildcard App ID, exactly the same as the application that you want to replace.  In the last part of the App ID (usually the name of the application) we write (*). <br><br><div class="spoiler">  <b class="spoiler_title">Created Wildcard App ID</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/bcc/5d1/023/bcc5d10233154d628de461ef4681f536.png"></div></div><br><br>  Next, create a profile for our new App ID. <br><br><div class="spoiler">  <b class="spoiler_title">Creating In-House Provisioning Profiles</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/5b8/3d0/6a9/5b83d06a96734fb1816e2f4910399f71.png"></div></div><br><br>  Thus, we received App ID, created Distribution Provisioning Profiles for it, and we can safely sign our application to them. <br><br>  So, create a project in Xcode and specify the following parameters for it: <br><br><div class="spoiler">  <b class="spoiler_title">Create a project in Xcode</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/22b/e63/210/22be632104794a519867c5d0af148b63.png"></div></div><br><br>  The project is an empty application "Single View Application". <br><br>  So, the installed program on the phone is on the desktop: <br><br><div class="spoiler">  <b class="spoiler_title">The desktop with the application that we plan to replace</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/ebf/09f/c7d/ebf09fc7d84749e4962a4514a6e14d67.PNG"></div></div><br><br>  We connect the phone and collect our application.  Let me remind you that our application has exactly the same App ID as the application that we want to replace.  After building the application, we get the following desktop: <br><br><div class="spoiler">  <b class="spoiler_title">Desktop, our application successfully replaces Target</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/75e/ab7/f05/75eab7f05b704bb9a41bfca05bb36bf0.PNG"></div></div><br><br>  The application is really "lost".  Vulnerability begins to be confirmed.  Now it is interesting, but what about the data? <br>  Open the famous application iTools.  Pay attention to the version of the application - it has changed, but the build has remained the same (in Xcode, it is build == 1): <br><br><div class="spoiler">  <b class="spoiler_title">This is what our iTools app looks like.</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/5c7/bf4/805/5c7bf48053d448ba800649a099d77c7e.png"></div></div><br><br>  Copy the contents and open the application archiver. <br><br>  And we observe: everything that was before the reinstallation remained in place! <br><br>  <b>TO</b> : <br><br><div class="spoiler">  <b class="spoiler_title">The folder structure of the original application</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/34c/204/5aa/34c2045aa44741d9bc32ef0374318384.png"></div></div><br><br>  <b>AFTER</b> : <br><br><div class="spoiler">  <b class="spoiler_title">Folder structure after application substitution</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/d9f/48c/ad2/d9f48cad2d464c8dacef0b5fcac7b109.png"></div></div><br><br>  As a result, we received an App ID, created Distribution Provisioning Profiles for it.  Created a simple (empty) application and installed it on the phone.  All data that was stored in the application, now in the hands of our application! <br><br>  If we collect the archive and sign it with the created profile, it will be possible to distribute the application through, for example, the site or in the mailing list.  The user will see the message ‚ÄúDo you really want to install the application‚Äú App_Name ‚Äù, signed with the certificate‚Äú Company_Name ‚Äù?‚Äù, While Company_Name is taken from the certificate.  If the user is not embarrassed by the fact that the well-known application that he installed from the AppStore, is trying to update in such a strange way, and even signed by a certificate from some unknown company, such user will install this application and give it to third parties. <br><br>  PS What exactly can I get from the application in this way?  The same as when viewing the same iTools, for example, but already remotely. <br><br>  In the comments to the article I expect tips on encrypting important information stored on the phone (in the sandbox of the application), ways to protect against such "penetration" into their applications. </div><p>Source: <a href="https://habr.com/ru/post/243511/">https://habr.com/ru/post/243511/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../243499/index.html">Electronic Cake in your pocket: development diary</a></li>
<li><a href="../243501/index.html">Repair of a loop of LEGO NXT</a></li>
<li><a href="../243503/index.html">Express Course "Project Planning"</a></li>
<li><a href="../243505/index.html">Calendar of birthdays and anniversaries of Outlook contacts</a></li>
<li><a href="../243509/index.html">Add self-registration by users in ownCloud 6</a></li>
<li><a href="../243513/index.html">Examination of the task on the example of the task of checking the analyzer RBNF declarations</a></li>
<li><a href="../243515/index.html">Learning Swift is now easier.</a></li>
<li><a href="../243517/index.html">Prototype data center on methane</a></li>
<li><a href="../243519/index.html">How I learned from my mistakes or how to make the second game better.</a></li>
<li><a href="../243521/index.html">Innovations in ecommerce that can change online shopping</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>