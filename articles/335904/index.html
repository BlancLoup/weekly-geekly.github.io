<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A bit of the history of cryptography CCPP: M-105, codenamed Agat</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The history of cryptography is rooted in the time of Ivan the Terrible. The first cryptographers used simple replacement ciphers, and later, under Pet...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A bit of the history of cryptography CCPP: M-105, codenamed Agat</h1><div class="post__text post__text-html js-mediator-article">  The history of cryptography is rooted in the time of Ivan the Terrible.  The first cryptographers used simple replacement ciphers, and later, under Peter the Great, professional services involved in the encryption business began to appear.  In the middle of 1700, so-called ‚Äúblack cabinets‚Äù appeared - secret rooms in post offices, where envelopes with letters were opened safely (sometimes not very well).  There was a concept - "perusal". <br><br><img src="https://habrastorage.org/web/37b/3d3/15d/37b3d315d27049b9b66f5c116fba6bc2.png"><br>  <i>Cabinet perusal at the post office in the Russian Empire</i> <br><br>  In the history of the national cryptography of the times of the USSR many gaps were formed, since the information was under seven locks, strictly kept secret. <a name="habracut"></a>  Some moments are covered in the article the <a href="https://geektimes.ru/company/ua-hosting/blog/264004/">treasury of national cryptography</a> , it also mentioned the most famous Soviet cryptomachines. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  M-105: Codenamed Agat </h3><br>  M-105 (code name: Agat) is a Russian, autonomous encryption machine that was developed and created in the USSR in the late 1960s.  The predecessor of this cryptomachine was almost identical to M-104 (Amethyst and Amethyst-2).  Such machines were used by all the Warsaw Pact countries (GDR, Czechoslovakia, Hungary, Romania, Yugoslavia), they were text-based electromechanical encoders with paper tape recording: SM-1 Cornflower, SM-2, M-104 Amethyst, M-105 Agat , <a href="https://habrahabr.ru/company/ua-hosting/blog/267705/">M-125 Violet</a> , M-130 Coral. <br><br><img src="https://habrastorage.org/web/dea/6fc/6d3/dea6fc6d3113458fa1dbefddf21740d2.png"><br>  <i>SM-1 Cornflower</i> <br><br><img src="https://habrastorage.org/web/59f/f93/338/59ff933384de4a2296257dc0566a50e7.png"><br>  <i>M-104 Amethyst</i> <br><br><img src="https://habrastorage.org/web/a3b/243/abb/a3b243abbb014377a1417421feda5293.png"><br>  <i>M-105 Agate</i> <br><br><img src="https://habrastorage.org/web/fc1/216/fb4/fc1216fb4942484d80af61c8c5c38053.png"><br>  <i>M-125 Violet</i> <br><br><img src="https://habrastorage.org/web/396/61f/74a/39661f74ae9e4b6b8705ef1db1d6c9a6.png"><br>  <i>M-130 Coral</i> <br><br>  M-105 Agate is a cryptomachine in which OTT was used - One-Time-Tape encryption, the essence of such encryption is simple: the key used is one-time and is equal in length to the transmitted data, the text is encrypted and no one can decrypt it. <br><br>  Unlike Violets, in which 10 encryption wheels (rotors) were used to generate the key, the M-105 has a built-in mechanical key generator that outputs random keys to an 11-layer punched tape.  It is located at the top of the machine. <br><br><img src="https://habrastorage.org/web/70f/c69/89d/70fc6989d77240778ca86c783e3b0a8c.png"><br><br>  At first glance, the car is somewhat reminiscent of M-125 Violet.  The electric car, almost the same size, is painted in silver gray with a keyboard in Latin / Cyrillic.  But this is where the similarities end. <br><br>  M-105 printed the results directly onto a piece of paper that was in the carriage at the back.  The advanced matrix printhead allows you to print any of the 30 characters (5 x 6).  Depending on the language used for printing, some characters or numbers could be missing. <br><br>  There was a device for inserting punched tape and key entry (standard 5-level punched tape) on the right to the right, although the Bodo code was not used. <br><blockquote>  The Bodo code is a uniform 5-bit telegraph code using two different electrical signals. <br></blockquote><br>  Instead, the same coding scheme was used as in Violet.  In front of the M-105 was a paper punched tape reader.  The punched tape was guided through a ruler, which ran across the entire width of the machine.  To start and stop - two keys (Start, Stop), located on the front right. <br><br><img src="https://habrastorage.org/web/a26/d79/555/a26d7955504a4581a3512cba4bff6a34.png"><br><br>  The image below shows the location of the full keyboard: on each key there is a Cyrillic and Latin letter.  30 keys, a black one-step key at the bottom left and a black control character for the return of the CR / LF cutter at the bottom right, there is a space (at the bottom). <br><br><img src="https://habrastorage.org/web/8da/3b7/654/8da3b765423b4f3394ecee1e5ff91800.png"><br><br>  In encryption mode, a space was used when entering text, and the H2 key was locked.  In decryption mode, the opposite is true: the space bar is locked, the H2 key is available.  When the device was used in plain text mode (MODE is set to ‚ÄúO‚Äù), it was possible to use either the space bar or the Y2 key.  Two black keys (‚Äústep‚Äù and CR / LF) are not encrypted.  They only worked in text mode to format the output.  The missing ‚ÄúY‚Äù can be easily replaced by ‚ÄúI‚Äù.  Identical to Violet, on the M-105 keyboard there are only 30 most used letters. <br><br>  Punctuation marks - except for the SPACE symbol using the ‚Äú‚Äù key in the upper left corner ‚Äî no.  Switching between Latin and Cyrillic alphabet meant replacing the print head. <br><br>  The punched tape could be used for encryption only once, therefore, when switching modes of operation, a Control Hole was punched through.  Decryption-only punched tapes had Check Hole so that they were not randomly used as an encryption key. <br><br><img src="https://habrastorage.org/web/99d/352/eda/99d352eda8994d65b177662d9ab74bbb.png"><br><br><h3>  Switching modes </h3><br>  There is a black rotary knob on the front left, just above the keyboard. With it, you can select the desired mode of operation: ‚ÄúO‚Äù for typing (Clear text), ‚Äú3‚Äù for encryption (encrypt) and ‚ÄúP‚Äù for decryption (decrypt). <br><br><img src="https://habrastorage.org/web/f1b/8b4/587/f1b8b4587dfa4d74b6619c45c5d9d12e.png"><br><br>  In text mode, the M-105 functioned like a regular typewriter or teleprinter and was used to print text, create 5-level punched tapes (5 holes per line).  All keys were available, including the space bar, CARE STEP and CR / LF. <br><br>  When setting encryption modes (3) or decryption (P), a number of mechanical changes took place inside the device.  As it was written earlier, in the encryption mode the X2 key is locked, a space is available, in the decryption mode - the opposite is true. <br><br>  The abbreviations used for different modes are identical for all machines (M-125 or M-130), as shown below. <br><br><img src="https://habrastorage.org/web/ae5/c24/13d/ae5c2413d6ef4141a1f0aee1e12a6bb5.png"><br><br><img src="https://habrastorage.org/web/cf6/5c4/2ce/cf65c42cec0b46cebfc2d3054caf8dd8.png"><br><br>  On the front of the 11-level key reader is a lever with three possible settings: P, PC, and K. It was used to select the recipient (punch, printer, punch and printer) of encoded, decoded, or plain text output. <br><br><h3>  Power Supply </h3><br><img src="https://habrastorage.org/web/28d/a4a/dca/28da4adca9094d66b7ab97949c11939c.png"><br><br>  There were several versions of the M-105, the most common - the device was powered from a 24 V direct current source. <br><br><img src="https://habrastorage.org/web/e4b/78f/a7e/e4b78fa7e1354e2bac3862c130f87f7c.png"><br><br>  Specially, for connection to the 110 V DC network, a different version of the AGAT was available. <br><br><img src="https://habrastorage.org/web/902/337/19c/90233719ce9d4e08808a557521a66694.png"><br><br><img src="https://habrastorage.org/web/123/b35/cbc/123b35cbc1f74b4ea831566e7000dc47.png"><br><br><img src="https://habrastorage.org/web/76f/f5c/93a/76ff5c93a2f7471b97b7b3b905939574.png"><br><br>  The standard power supply, which was used in the M-105, was suitable for networks of any voltage level (as a rule, in the voltage range 110 - 220 V), could be used almost anywhere in the world.  The same power supply was used with the M-125 Violet in most Warsaw Pact countries. <br><br><img src="https://habrastorage.org/web/9d1/cb8/6ea/9d1cb86ea14349edad4670fbaae03923.png"><br><br>  The lever performed several functions.  With it, you can work with the machine manually in case of power failure.  Since the encryption process was purely mechanical, the machine could read 5-level punched tapes, ribbons with keys, print on paper and without electricity.  The lever was also used to ‚Äúreset‚Äù the mechanism if it was jammed. <br><br><img src="https://habrastorage.org/web/ec3/65b/187/ec365b187c3240b4aee4cbeb2ecdd24f.png"><br>  <i>Lever arm</i> <br><br>  In M-105, a 5 x 6 matrix (5 rows, 6 columns) was used to address 30 characters.  Each 5-bit character was translated into a string (6 bits) and a column (5 bits), as a result, 11 internal ‚Äúbits‚Äù were obtained, therefore the key punched tape is an 11-level one. <br><br><img src="https://habrastorage.org/web/d46/a88/a39/d46a88a397834046aa51be41080a75e8.png"><br><br>  The 11-bit code from the key punched tape was added to the 11-bit data stream, the result was later converted back to a 5-digit digital code (displayed on five-level punched cards). <br><br><img src="https://habrastorage.org/web/9ea/c63/6d5/9eac636d541e4d04bcf95b4595ec8f33.png"><br><br>  In East Germany (DDR), the M-105 was commissioned in 1968 and used to communicate with partner countries of the Warsaw Pact, as well as the leadership of the GDR, to exchange messages at the highest level of government. <br><br>  In 1986, the M-105 became a fully electronic M-205 D machine, but many M-105 remained in operation until the German reunion.  M-105 was replaced by T-353 (Dudek) in 1987 for communication of the GDR with Hungary. <br><br><img src="https://habrastorage.org/web/a58/47e/778/a5847e7784ad46b8aa85ede06caed912.png"><br>  <i>T-353 (Dudek)</i> <br><br>  It is extremely difficult to find materials about this cryptomachine on the Runet‚Äôs open spaces, because the information was taken here: <a href="http://www.cryptomuseum.com/crypto/ussr/m105/index.htm">Crypto museum</a> and <a href="http://scz.bplaced.net/m105.html">bplaced.net</a> .  Most likely, such scant public coverage of advances in the field of cryptography of the USSR times is due to a number of reasons: only partial declassification, underfunding and other problems.  Let's hope that soon the domestic scientific achievements and outstanding cryptographers of the country will come out from under the neck ‚Äútop secret‚Äù. <br><br>  <b>As advertising.</b>  Stock!  Only now get <b><a href="https://ua-hosting.company/vpsnl">up to 4 months of free use of VPS (KVM) with dedicated drives in the Netherlands and the USA</a> (configurations from VPS (KVM) - E5-2650v4 (6 Cores) / 10GB DDR4 / 240GB SSD or 4TB HDD / 1Gbps 10TB - $ 29 / month and above, options with RAID1 and RAID10 are available)</b> , a full-fledged analogue of dedicated servers, when ordering for a period of 1-12 months, the <a href="http://searchengines.guru/showthread.php%3Ft%3D964358">conditions of the promotion are here,</a> existing subscribers can receive a 2-month bonus! <br><br>  <a href="https://habrahabr.ru/company/ua-hosting/blog/329618/">How to build the infrastructure of the building.</a>  <a href="https://habrahabr.ru/company/ua-hosting/blog/329618/">class c using servers Dell R730xd E5-2650 v4 worth 9000 euros for a penny?</a> </div><p>Source: <a href="https://habr.com/ru/post/335904/">https://habr.com/ru/post/335904/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../335892/index.html">Show your passport. Part 1</a></li>
<li><a href="../335896/index.html">Avito Office: work hard, play hard</a></li>
<li><a href="../335898/index.html">Linux History (1993‚Äì2003): Testing Distributions</a></li>
<li><a href="../335900/index.html">Mountebank: flexible mocking web API</a></li>
<li><a href="../335902/index.html">Virtualization operation: comparison of virtual server and shared-hosting</a></li>
<li><a href="../335906/index.html">Available on cryptography on elliptic curves</a></li>
<li><a href="../335908/index.html">Using MVP + TDD in the development of iOS applications</a></li>
<li><a href="../335910/index.html">Own bike for JSON API</a></li>
<li><a href="../335916/index.html">Improvised barcode reader for 1C via Telegram on Go</a></li>
<li><a href="../335920/index.html">Description of sorting algorithms and comparison of their performance</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>