<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating a RESTful API in Google App Engine based on Flask</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Gomez Julio Marillo de Servante is a well-known international drug lord who is concerned about the quality of the services provided by his organizatio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating a RESTful API in Google App Engine based on Flask</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/87d/a59/093/87da59093784a8ff729f655b746146e3.jpg"><br>  Gomez Julio Marillo de Servante is a well-known international drug lord who is concerned about the quality of the services provided by his organization.  That's why he, Gomez, decided to develop a system of online orders for his partners. <br><br>  Gomez's partners are located all over the world, they highly appreciate mobility (such is the specifics of business) and prefer to use mobile clients.  Therefore, it was decided to develop a universal and simple API, to which each of the partners could access using any independently written solutions. <br><a name="habracut"></a><br>  Requirements for the functionality of this <a href="http://ru.wikipedia.org/wiki/%25D0%2598%25D0%25BD%25D1%2582%25D0%25B5%25D1%2580%25D1%2584%25D0%25B5%25D0%25B9%25D1%2581_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25BF%25D1%2580%25D0%25B8%25D0%25BB%25D0%25BE%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B9">API are</a> absolutely insignificant.  Just something to take orders.  Therefore, it was decided to use the <a href="http://ru.wikipedia.org/wiki/REST">REST</a> approach. <br>  The http protocol, in addition to the well-known GET and POST methods, is able to use several other methods, such as PUT and DELETE. <br><br>  When creating RESTful, we will adopt the following agreement regarding the methods: <br>  POST - to create new entries. <br>  GET - for recording information. <br>  PUT - to make changes to the record. <br>  DELETE - to delete records. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Gomez Julie Marillo is a very economical and technologically advanced person who knows the value of money, is not ready to pay for services more than it should be and is familiar with the concept of cloud technologies.  On this choice immediately fell on <a href="https://developers.google.com/appengine/">Google App Engine</a> . <br><br>  But his subordinate developers (ie, we) are very lazy and do not want to do extra work.  At the same time, they understand that there can be so much traffic, that using bulky solutions is simply not economical.  They immediately adopted the <a href="http://flask.pocoo.org/">Flask</a> . <br>  We were lucky, because Flask to work with <a href="http://en.wikipedia.org/wiki/Web_Server_Gateway_Interface">WSGI</a> uses <a href="http://werkzeug.pocoo.org/">Werkzeug</a> , which is perfectly able to handle not only GET and POST, but also PUT and DELETE. <br><br>  Your applaimer on the basis of the <a href="https://github.com/kamalgill/flask-appengine-template">flask-skeleton for the app engine</a> created <a href="https://github.com/SkyFox/flask-appengine-restful-api-template">your skeleton to create an API without blackjack and women</a> . <br><br>  Having made fork of the project we will start its modification. <br>  First we need to develop an order model.  Order is characterized by its <b>unique number (it will be created by default), product name, weight and access key for modification</b> .  Open the application / models.py file and delete all its contents and write down: <br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> google.appengine.ext <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> db <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Order</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(db.Model)</span></span></span><span class="hljs-class">:</span></span> title = db.StringProperty() weight = db.FloatProperty() token = db.StringProperty()</code> </pre> <br>  Now let's work with urls.py.  We need to add 3 handlers.  For adding an order, obtaining information about the order and giving the order.  Immediately after the line: <br> <code>app.add_url_rule('/', view_func=views.home, methods=['GET',]) # Main page</code> <br> <br>  Add the lines: <br><pre> <code class="python hljs">app.add_url_rule(<span class="hljs-string"><span class="hljs-string">'/drug/orders/'</span></span>, view_func=views.add_order, methods=[<span class="hljs-string"><span class="hljs-string">'POST'</span></span>,]) app.add_url_rule(<span class="hljs-string"><span class="hljs-string">'/drug/orders/'</span></span>, view_func=views.get_order, methods=[<span class="hljs-string"><span class="hljs-string">'GET'</span></span>,]) app.add_url_rule(<span class="hljs-string"><span class="hljs-string">'/drug/orders/'</span></span>, view_func=views.delete_order, methods=[<span class="hljs-string"><span class="hljs-string">'DELETE'</span></span>,])</code> </pre><br><br>  I will not give a description of the process of creating a form.  It is quite travial. <br>  It remains to create 3 corresponding functions in views.py.  Let's start by adding an order: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_order</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> form = NewOrderForm() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> form.title.data != <span class="hljs-string"><span class="hljs-string">""</span></span>: drug_title = form.title.data <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json_response({<span class="hljs-string"><span class="hljs-string">'error'</span></span>: <span class="hljs-string"><span class="hljs-string">'Drug title is empty'</span></span>}) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> form.weight.data != <span class="hljs-string"><span class="hljs-string">""</span></span>: drug_weight = form.weight.data <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json_response({<span class="hljs-string"><span class="hljs-string">'error'</span></span>: <span class="hljs-string"><span class="hljs-string">'Drug weight is empty'</span></span>}) token = str(uuid.uuid4()) order = Order(title = drug_title, weight = float(drug_weight), token = token) order.put() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json_response({ <span class="hljs-string"><span class="hljs-string">'id'</span></span>: int(order.key().id()), <span class="hljs-string"><span class="hljs-string">'token'</span></span>: token, <span class="hljs-string"><span class="hljs-string">'success'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> })</code> </pre> <br>  Start the development server from the console (go to the project directory): <br> <code>dev_appserver.py project_src/</code> <br>  Check the functionality of this function: <br> <code><a href="http://localhost/"></a> curl -d "title=drug1&amp;weight=10" localhost:8080/drug/orders/</code> <br>  Result: <br> <code>{"token": "2eac6ef6-198b-45a4-bab5-dd2c56d9fb0a", "id": 171, "success": true}</code> <br>  Wonderful.  We proceed to the creation of a function that will provide us with order information: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_order</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> token = request.args.get(<span class="hljs-string"><span class="hljs-string">'token'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> token <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json_response({<span class="hljs-string"><span class="hljs-string">'error'</span></span>: <span class="hljs-string"><span class="hljs-string">'Token is empty'</span></span>}) order = Order.all().filter(<span class="hljs-string"><span class="hljs-string">'token = '</span></span>, token).fetch(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(order) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json_response(order[<span class="hljs-number"><span class="hljs-number">0</span></span>]._entity) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json_response({<span class="hljs-string"><span class="hljs-string">'error'</span></span>: <span class="hljs-string"><span class="hljs-string">'Access denied'</span></span>})</code> </pre> <br>  Checking: <br> <code><a href="http://localhost/"></a> curl -v -X GET localhost:8080/drug/orders/?token=2eac6ef6-198b-45a4-bab5-dd2c56d9fb0a</code> <br>  Result: <br> <code>{"token": "2eac6ef6-198b-45a4-bab5-dd2c56d9fb0a", "weight": 10.0, "title": "value1"}</code> <br>  Finishing touch.  Deleting an order: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">delete_order</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> token = request.args.get(<span class="hljs-string"><span class="hljs-string">'token'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> token <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json_response({<span class="hljs-string"><span class="hljs-string">'error'</span></span>: <span class="hljs-string"><span class="hljs-string">'Token is empty'</span></span>}) order = Order.all().filter(<span class="hljs-string"><span class="hljs-string">'token = '</span></span>, token).fetch(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(order) <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: order = order[<span class="hljs-number"><span class="hljs-number">0</span></span>] order.delete() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json_response({<span class="hljs-string"><span class="hljs-string">'success'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>}) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json_response({<span class="hljs-string"><span class="hljs-string">'error'</span></span>: <span class="hljs-string"><span class="hljs-string">'Access denied'</span></span>})</code> </pre> <br>  Checking: <br> <code><a href="http://localhost/"></a> curl -v -X DELETE localhost:8080/drug/orders/?token=2eac6ef6-198b-45a4-bab5-dd2c56d9fb0a</code> <br>  Result: <br> <code>{"success": true}</code> <br> <br>  Just in case, look at the database: <br><img src="https://habrastorage.org/storage2/d23/917/9f9/d239179f930f691eba923a6f0f61a5de.jpg"><br><br>  Once again the link to the <a href="https://github.com/SkyFox/drugdealer-restful-api">source code of the project</a> . <br><br>  Comment. <br>  Although this set of scripts is presented in a comic form, it can be expanded to almost any size of the API.  I hope that I managed to write not a lot of letters, but at the same time giving you,% username%, an idea of ‚Äã‚Äãthe process of creating a RESTful API in the cloud. <br><br>  PS <br>  To simplify the presentation and reduce the amount of code, we have slightly violated the REST principles.  In particular, the ‚Äúunambiguous identification of any resource‚Äù. </div><p>Source: <a href="https://habr.com/ru/post/141747/">https://habr.com/ru/post/141747/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141742/index.html">Startup WebcamTelecom. A look at the communications of the future</a></li>
<li><a href="../141743/index.html">Creating a state machine for parsing an HTTP request</a></li>
<li><a href="../141744/index.html">Cross-platform multithreaded applications</a></li>
<li><a href="../141745/index.html">fc.tape - js-library for simple animation of sprites</a></li>
<li><a href="../141746/index.html">Assignments in conditions</a></li>
<li><a href="../141748/index.html">Toshiba Portege Z830 Ultrabook Video Review</a></li>
<li><a href="../141749/index.html">100% Virus Free Podcast # 39: Title Security SAP and ERP</a></li>
<li><a href="../141750/index.html">Cisco CLI in BASH</a></li>
<li><a href="../141751/index.html">The most popular games and applications for Ubuntu for March 2012 (repository UALinux)</a></li>
<li><a href="../141753/index.html">Invitation to get acquainted with IBM's smart cloud</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>