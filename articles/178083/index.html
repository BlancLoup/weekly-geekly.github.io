<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Crashes caused by exceptions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last week, along with several of my colleagues, I participated in a loud talk about the fact that Go handles errors in expected scenarios by returning...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Crashes caused by exceptions</h1><div class="post__text post__text-html js-mediator-article">  Last week, along with several of my colleagues, I participated in a loud talk about the fact that Go handles errors in expected scenarios by returning an error code instead of using exceptions or another similar mechanism.  This is a rather controversial topic, because people are used to avoiding error with exceptions, and Go returns <a href="http://golang.org/doc/articles/error_handling.html">an improved version of a</a> well-known model that was previously adopted in several languages ‚Äã‚Äã‚Äî including C ‚Äî in which errors are transmitted via return values.  This means that errors loom before the eyes of the programmer and force them to deal with them <i>all the time</i> .  In addition, the dispute turns into the direction of the fact that, in languages ‚Äã‚Äãwith exceptions, each error, without any additional actions, carries with it complete information about what happened where, and this may be useful in some cases. <a name="habracut"></a><br><br>  However, all these amenities have a cost that is easy to articulate: <br>  <i><b>Exceptions teach developers not to care about errors.</b></i> <br><br>  The sad consequence is that this is relevant, even if you are a brilliant developer, because you are influenced by the world around us, which is condescending to mistakes.  The problem will manifest itself in the libraries that you import, in the applications installed on your computer, as well as <i>on the servers that store your data</i> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Raymond Chen described this problem <a href="http://blogs.msdn.com/b/oldnewthing/archive/2004/04/22/118161.aspx">in 2004</a> : <br><br><blockquote>  Writing the correct code in a model with throwing exceptions is in some sense more difficult than in a model with returning an error code, since anything can fail and you should be prepared for this.  In the model with the return of the error code, the moment when you have to check for errors is obvious: as soon as you received the error code.  In the model with exceptions, you just need to know that errors can occur anywhere. <br><br>  In other words, in the model with the return of the error code, when someone skips error handling this happens explicitly: they do not check the error code.  At the same time, in the model with throwing exceptions when considering the code in which someone handles the error, everything is not so clear, since the error is not explicitly indicated. <br>  (...) <br>  When you write code, do you think about what the consequences of each exception may be to each line of code?  You should do this if you are going to write the correct code. </blockquote><br><br>  This is absolutely true.  Each line that can cause an exception carries a hidden ‚Äúelse‚Äù branch for an erroneous script that is very easy to forget.  Even if the introduction of code for error handling seems meaningless repetition, writing it makes developers remember the alternative scenario, and quite often this code is not empty. <br><br>  This is not the first time I've been writing about this and, given the controversy surrounding this statement, so I found a couple of examples that confirm the problem.  The best example I could find today is in the <a href="http://docs.python.org/3/library/pty.html">pty</a> module of the standard Python 3.3 library: <br><br><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">spawn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(argv, master_read=_read, stdin_read=_read)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""Create a spawned process."""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> type(argv) == type(<span class="hljs-string"><span class="hljs-string">''</span></span>): argv = (argv,) pid, master_fd = fork() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> pid == CHILD: os.execlp(argv[<span class="hljs-number"><span class="hljs-number">0</span></span>], *argv) (...)</code> </pre> <br><br>  Every time someone calls this code with the wrong executable file name in argv, an unused process that is not subject to garbage collection and is unknown to the Python application is spawned because execlp fails and the forked process is ignored.  And whether the client of this module will catch an exception or not does not matter.  Local commitment was not met.  Of course, the error can be corrected trivially by adding try / except inside the spawn function itself.  However, the problem is that <i>this logic seemed normal to everyone who has ever seen this function since <a href="http://hg.python.org/cpython/rev/8c9cc054c5ed">1994</a> , when Guido van Rossum first committed it</i> . <br><br>  Here is another interesting example: <br><br><pre> <code class="bash hljs">$ make clean Sorry, <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>-not-found has crashed! Please file a bug report at: https://bugs.launchpad.net/<span class="hljs-built_in"><span class="hljs-built_in">command</span></span>-not-found/+filebug Please include the following information with the report: <span class="hljs-built_in"><span class="hljs-built_in">command</span></span>-not-found version: 0.3 Python version: 3.2.3 final 0 Distributor ID: Ubuntu Description: Ubuntu 13.04 Release: 13.04 Codename: raring Exception information: unsupported locale setting Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"/.../CommandNotFound/util.py"</span></span>, line 24, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> crash_guard callback() File <span class="hljs-string"><span class="hljs-string">"/usr/lib/command-not-found"</span></span>, line 69, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> main enable_i18n() File <span class="hljs-string"><span class="hljs-string">"/usr/lib/command-not-found"</span></span>, line 40, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enable_i18n locale.setlocale(locale.LC_ALL, <span class="hljs-string"><span class="hljs-string">''</span></span>) File <span class="hljs-string"><span class="hljs-string">"/usr/lib/python3.2/locale.py"</span></span>, line 541, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> setlocale <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> _setlocale(category, locale) locale.Error: unsupported locale setting</code> </pre><br><br>  This is quite a serious crash due to the lack of data about the locale in the system application, which, ironically, should inform users which packages need to be installed if the command is missing.  Notice that on top of the grid is a link to <i>crash_guard</i> .  This feature is designed to intercept all exceptions at the edge of the stack and display detailed system information and tracebacks to help solve the problem. <br><br>  Such ‚Äúparachute interception‚Äù is quite common in exception-oriented programming, and this approach, as a rule, gives developers a false sense of good error handling in an application.  Instead of real <i>protection of the</i> application, it becomes just a convenient way to crash.  In this case, it would be more correct to display a warning, if necessary, and to allow the program to work as usual.  This could be done by simply wrapping this line around: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: locale.setlocale(locale.LC_ALL, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e: print(<span class="hljs-string"><span class="hljs-string">"Cannot change locale:"</span></span>, e)</code> </pre><br><br>  Obviously, this is easy to do.  But, again, the problem is that it was natural not to do it right away.  In fact, this is more than natural: indeed, <i>it seems better</i> not to consider the wrong way.  In this case, the code will be reduced, it will be more straightforward, and as a result only the one that leads to the desired result will remain. <br><br>  As a result, unfortunately, we plunge into the world of fragile software and pink elephants.  Although a more expressive style of returning errors builds the right mindset: will the function or method return an error in the result?  How will it be processed?  Does the function interacting with the system not return an error?  How to solve the problem, which probably can occur? <br><br>  An amazing amount of cracks and just unpredictable behavior is the result of such involuntary negligence. <br><br>  <a href="http://blog.labix.org/2013/04/23/exceptional-crashes">Original</a> </div><p>Source: <a href="https://habr.com/ru/post/178083/">https://habr.com/ru/post/178083/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../178067/index.html">Git FTP example on Windows</a></li>
<li><a href="../178069/index.html">Changing the coding of the git repository</a></li>
<li><a href="../178071/index.html">Designing your own computer. Part 1</a></li>
<li><a href="../178073/index.html">Two-factor SMS authorization in Redmine</a></li>
<li><a href="../178081/index.html">WebMarkupMin HTML Minifier - a modern HTML minimizer for the .NET platform</a></li>
<li><a href="../178085/index.html">Scrum implementation notes - which will necessarily lead to iteration failure if nothing is done</a></li>
<li><a href="../178087/index.html">Bread crumbs (breadcrumbs) in asp.net MVC3</a></li>
<li><a href="../178089/index.html">From Excel to MySQL. Small PHP function (fixed)</a></li>
<li><a href="../178091/index.html">AWS AMAZON - how do you optimize resources</a></li>
<li><a href="../178095/index.html">What is ASO and why it is urgently needed by today's developers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>