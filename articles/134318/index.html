<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we developed the integration of an online store with 1C: Enterprise and why it became popular. Part 3</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the final part of the story about our implementation of the integration of the 1C: Bitrix online store with the 1C: Trade management system, I woul...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we developed the integration of an online store with 1C: Enterprise and why it became popular. Part 3</h1><div class="post__text post__text-html js-mediator-article">  In the final part of the story about our implementation of the integration of the 1C: Bitrix online store with the 1C: Trade management system, I would like to talk about solving a business problem of exchanging data on customer orders. <br><br><img src="https://habrastorage.org/storage1/55ec91a5/c650199f/08e55a21/5987f99c.png" alt="image"><br><a name="habracut"></a><br>  Let me remind the essence of the previous topics on this topic: <br><br>  In the <a href="http://habrahabr.ru/company/bitrix/blog/129156/">first post,</a> we talked about how the tasks faced by the owners of online stores were analyzed, the concept of data exchange was chosen and the protocol of exchange between 1C and the online store was developed. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The <a href="http://habrahabr.ru/company/bitrix/blog/131344/">second</a> demonstrated a specific solution to the business problem of uploading to the site a database of goods from 1C, including the choice of nomenclature for uploading, data processing settings on the site side, as well as some technical solutions to ensure the stability of upload operation on large data volumes. <br><br>  Well, now in our online store we have a catalog of goods, unloaded from 1C, and now the goods need to be sold to the client from the point of view of the order processing process itself. <br><br>  After adding the product to the cart, the customer went to the order form to fill out the details. <br><br><img src="https://habrastorage.org/storage1/0b7a813d/bfec64a4/9a182157/2a4a1afe.png"><br><br>  Specified contact information, payment method and chose the delivery option.  The order is assigned a specific number, it is saved in the system, a personal account is available to the client to view the order history. <br><br><img src="https://habrastorage.org/storage1/28a60c2a/b61a6426/0d8218c9/d00b2f6e.png"><br><br>  What to do now?  Of course, "process the order."  But where to process it - on the website or in 1C?  After all, we have integration.  <b>You must select a business model for processing orders, and there are generally three such models:</b> <br><br><h5>  Order processing directly on the site </h5><br>  The capabilities of the administrative part of the CMS for order management are used.  Objectively speaking, such opportunities in the 1C-Bitrix system: Site management is very wide and sufficient for most stores: <br>  - search for orders by filter <br>  - view order data, <br>  - order editing (contact details, order composition,), <br>  - unlimited number of order statuses and different user permissions to work with each of the statuses <br>  - printing documents and much more <br><br><img src="https://habrastorage.org/storage1/10f23da1/971abae3/57c6319a/8734b944.png"><br><br>  Usually such a model is chosen by those for whom the store is the only or almost the main source of sales.  All at once in one system, customers immediately see changes in their orders, receive notifications. <br><br>  If there is 1C, then <b>when the order is already processed, the money is received, the order is delivered - they want to unload the order in 1C, for reporting.</b> <br><br><h5>  Order processing in 1C </h5><br>  Some clients, even after seeing an abundance of possibilities for processing orders in the admin panel of the site, insist that <b>all processing be carried out in the 1C system</b> .  In other words, customers want the order created on the site to <b>immediately appear in 1C</b> for further processing. <br><br>  Usually these are companies for which an online store is just one of the sales channels, along with, for example, retail, or dealer sales.  In this case, such a model is solely due to the need to ensure all processing in a single place, in a single order processing center. <br><br>  In this case, all processing is carried out in a single system, which stores the nomenclature, inventory, reserves, and so on.  This is definitely also very convenient. <br><br>  For such a business model, the key requirement for the integration of 1C with an online store is the <b>efficiency and completeness of obtaining data on the order from the site</b> .  Additional complexity is here: in order for clients to track the order execution process in their personal account, it is necessary for 1C to inform the site about the changes in orders that occur in it during work. <br><br><h5>  Mixed model </h5><br>  Sometimes it is required to organize various combined schemes, when part of operations are performed on the site, and part in 1C.  You can perform partial processing of orders on the site (for example, receiving an order and clarifying it with the buyer), and when the order goes into the specified status, transfer it to 1C. <br><br><h5>  Implementation of business models in the integration of 1C and 1C-Bitrix </h5><br>  As you can see, the business task of integrating orders at first glance is simple, but it has a number of nuances.  Now let's take a look at our integration implementation functionality. <br><br><h5>  Settings on the site side </h5><br>  According to <a href="http://habrahabr.ru/company/bitrix/blog/129156/">the exchange protocol</a> , 1C regularly sends requests to the site and receives the resulting response in CommerceML format.  In the administrative part of the 1C-Bitrix system there is a set of settings that affect the process of forming this answer. <br><br>  The first part of the integration settings for orders is located in the general settings for integration with 1C, on the Orders tab (the Catalog tab was covered in the previous section, it concerned the import of goods). <br><br><img src="https://habrastorage.org/storage1/b6ffd8ca/0ec40c3c/9da140f2/496fda1b.png"><br><br>  Here are indicated: <br><ul><li>  The site, orders from which are unloaded in 1C.  On one engine there can be several shops and you need to clarify, from which to give orders on request 1C </li><li>  Groups of users who are allowed to download - user rights under which 1C will take orders </li><li>  Using zip compression, as well as in the transfer of goods, allows you to reduce the amount of transmitted traffic, although for a list of orders this gives not so much unloading </li></ul>  further parameters affecting the business process: <br><ul><li>  Upload only paid orders </li><li>  Upload only orders with shipment allowed </li><li>  Upload orders starting from status </li></ul>  In essence, with these three parameters, the customer chooses the model of the shop.  Or orders, immediately from the first status fall into 1C, and then all their processing is done in 1C.  Or all processing is done in the store, and the unloading takes place on the final status.  Or some mixed option is chosen. <br>  Unloading only paid or only orders with permitted shipment - severely restricts the unloading of orders under the flags "paid" and "shipped", regardless of status.  After all, statuses are a custom thing, and they may not be associated with these flags. <br><br><h5>  Settings on the side of 1C </h5><br>  The site prepared a CommerceML file with data on the order, including data of the counterparty, a list of commodity items and service information, and gave 1C in response to the request.  Now you need to configure how this order will now be processed and saved in 1C. <br><br>  The process of saving an order includes several steps: <br><ul><li>  Counterparty identification (search among existing ones or creation of a new one) </li><li>  Identification of the ordered positions (search in the reference book of the nomenclature or creation of new ones) </li><li>  Creation and carrying out the document "Sales Order" </li><li>  Identification of the status of the order and setting the status of the document "Sales Order" </li></ul>  In order to enable order integration, you need to tick the ‚ÄúBasic Settings‚Äù tab and a specialized settings tab will appear. <br><br><img src="https://habrastorage.org/storage1/6bc4dab9/c0a626e6/ac797328/b5b45d9d.png"><br><br>  Let me remind you that on the tab ‚ÄúBasic Settings‚Äù you can configure the 1C access interval to the site.  For example, orders can be taken every 5 minutes. <br><br>  On the tab exchange orders are configured: <br><br><img src="https://habrastorage.org/storage1/6621ad3e/5eb4902e/e5478927/9d916d7c.png"><br><br>  <b>1) A way to identify counterparties.</b> <br><br>  This setting controls the search engine counterparty from the site among the existing counterparties in 1C.  Today, there are 2 ways of identification to choose from - by name (usually for individuals) and by combination of INN + KPP for legal entities.  In the near future, we plan to add another identification option - by the site user ID (the name for large stores can still be repeated). <br>  If the counterparty could not be found, a new one is created. <br><br>  <b>2) Parameters for creating new items of the ‚ÄúNomenclature‚Äù reference book</b> <br><br>  This setting is needed for cases when the product is in the order, but it is not in 1C.  Or can not find.  In this case, to ensure the logical integrity of the data in 1C, it is necessary that the goods exist - and in this case, 1C simply imports it into its nomenclature directory. <br><br>  On the tab "Advanced" specify the parameters of the documents in 1C, including the cancellation of orders, and the important setting - "Compliance with the status of orders": <br><br><img src="https://habrastorage.org/storage1/749b7f77/42cd7bdc/20116590/5ad20aa2.png"><br><br>  As well as on the site side, 1C can also set the status of the ‚ÄúCustomer Order‚Äù document according to the order status on the site.  For example, if the order on the site is confirmed, then in 1C it automatically receives the status ‚ÄúAgreed‚Äù.  It's comfortable. <br><br><h5>  Export orders from 1C to the site </h5><br>  The exchange of orders in contrast to the exchange of goods in the integration scheme is <b>two-way</b> .  Not only the site gives 1C data on incoming orders, but 1C also informs the site about those orders that were previously unloaded and were changed in 1C.  This is usually an example of an order processing model in 1C, when payment and shipping are not performed on the site. <br><br>  The manager in 1C can call the client and during the communication change the list of positions, price, make a discount, change the parameters of delivery or payment.  If the site is not informed about these changes, then the client will have outdated information on his orders in his personal account. <br><br>  The scheme of work 1C such.  If the orders downloaded from the site have been changed, then the 1C exchange session will upload these changes to the site (also in CommerceML format), and the site will accept them and update the order information. <br><br>  Another case of changing an order in 1C is a change in its status.  The accountant received payment and formed a payment order, the order has now become paid and we also need to change the status on the site.  In the settings of the online store module there are 2 more parameters on the site: <br><br><img src="https://habrastorage.org/storage1/8c5ed62b/ed776933/f43b39f9/42bd75d6.png"><br><br>  that is, the site automatically changes the status of the order when receiving data from 1C on payment and (or) shipment.  And to change the status, you can ‚Äúhang up‚Äù the handler, send a message to the client (by email or sms). <br><br>  <b>Total: integration of the task of informing the buyer, despite the fact that order processing occurs outside the site.</b> <br><br><h4>  Additional integration options </h4><br><br>  All the integration settings with 1C from the site on 1C-Bitrix, which we have considered, are only the default default settings that relate to the default integration script <b>http: // &lt;your_site&gt; /bitrix/admin/1c_exchange.php.</b> <br><br>  But from a technical point of view, the entire integration interface from the site consists of two components of the 1C-Bitrix system, which the developer can use to create his own arbitrary interaction interface with 1C, to refine and extend the existing functionality. <br><br>  These are the components ‚Äúbitrix: catalog.import.1c‚Äù and ‚Äúbitrix: sale.export.1c‚Äù.  They are available directly in the visual editor.  You can create your own integration script with individual settings.  Everything is done elementary: <br><br>  1) Create a page on the site, you can directly in the visual editor (you can make a single URL for products and orders, as in the default interface, but you can also have different ones) <br>  2) Place on the page the components of the exchange with 1C to configure the necessary parameters <br><br><img src="https://habrastorage.org/storage1/01832575/40efce49/a43aff41/ff336f7f.png"><br><br>  In principle, using steps 1 and 2, you can configure an individual exchange interface for each 1C, which integrates with the site.  For example, you have several online stores on the same engine, and each of them has its own 1C exchange.  Or you have one online store, but several suppliers, each of which has one 1C.  It is more logical and more correct to make for each 1C its own interface for importing goods. <br><br>  But that's not all. <br><br>  The components ‚Äúcatalog.import.1c‚Äù and ‚Äúsale.export.1c‚Äù are common components of the 2.0 platform 1C-Bitrix.  They can be customized using standard techniques, or they can even be taken out into their namespace and arbitrarily change their source code. <br><br>  For example, you can do additional data processing before writing to the site database, bind data with other site entities, and so on. <br><br>  In a word, we give the opportunity not only to create your own interface settings, different from the default ones, but also to change your interface in general. <br><br>  Using this feature, you can implement the exchange with other 1C products (of course, if there is an integration mechanism on that side), or with products of other vendors. <br><br><h4>  General conclusions on integration: </h4><br>  Let's sum up the three posts on this topic. <br><ol><li>  Implemented a ready-made integration mechanism between 1C and an online store, which allows out of the box to solve a large number of typical customer tasks for uploading a catalog and exchanging orders </li><li>  There is a possibility of flexible integration settings both from 1C-Bitrik: Site management, and from 1C: Trade management, to adapt to the specifics of the client‚Äôs business </li><li>  Opportunities for customization and refinement of the integration functionality </li><li>  Data is exchanged using the open XML standard CommerceML. </li><li> The data exchange protocol is simplified as much as possible, uses HTTP (S) and takes into account typical hosters' restrictions on the operation of site scripts </li><li>  The integration architecture maximally protects 1C: Enterprise from threats from the Internet, the initiator of the exchange is always 1C, and the site only responds to requests </li></ol>  In general, we believe that we have achieved the goals that were set before us at the very beginning. <br><br>  Yes, not everything was possible to make as convenient as possible, but work on improving integration has been going on continuously for several years and will continue. <br><br>  We have very strong feedback from customers and partners.  As part of the support service, there are technical experts on 1C products, which, together with the 1C-Bitrix developers, allows us to solve complex issues that are often at the junction of systems.  All wishes are recorded and reasonable suggestions are surely realized. <br><br>  Together with 1C, we didn‚Äôt create any kind of closed integration and data exchange architecture, but on the contrary, we tried to make it usable, open for modifications and modifications, and the prevalence of such integration among modern CMS for online stores confirms that this goal was reached! <br><br>  And to read the following entries in your feed, click "Like" in <a href="http://habrahabr.ru/company/bitrix/">the</a> company <a href="http://habrahabr.ru/company/bitrix/">profile</a> , and check your <a href="http://habrahabr.ru/%3Ffl%3Dhl">tape</a> setup. </div><p>Source: <a href="https://habr.com/ru/post/134318/">https://habr.com/ru/post/134318/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../134312/index.html">LocalHero for Android</a></li>
<li><a href="../134313/index.html">HP will sell Touchpad at $ 99 December 11 on eBay</a></li>
<li><a href="../134315/index.html">11.11.11 11:11:11 @ Twitter</a></li>
<li><a href="../134316/index.html">VirusTotal for "their"</a></li>
<li><a href="../134317/index.html">The charms of outsourcing or the horrors of the Yota service</a></li>
<li><a href="../134319/index.html">The company that created STALKER, ceased to exist</a></li>
<li><a href="../134324/index.html">One of the patents in the Oracle v. Android lawsuit was rejected</a></li>
<li><a href="../134326/index.html">Validating CSS in Visual Studio 2010 using the CSSCop extension</a></li>
<li><a href="../134327/index.html">MongodbLogger - add logs of your Rails 3 application to MongoDB</a></li>
<li><a href="../134329/index.html">WebOS will become open source</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>