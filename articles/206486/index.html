<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Homemade build-traffic light in the office</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prehistory 
 In connection with the planned transition to continious integration and reading a couple of articles on traffic lights in the office, I a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Homemade build-traffic light in the office</h1><div class="post__text post__text-html js-mediator-article"><h4>  Prehistory </h4><br>  In connection with the planned transition to continious integration and reading a couple of articles on traffic lights in the office, I also wanted to have such a warm lamp device.  As a result, it turned out not at all warm and not lamp, but more on that later. <br><br>  Who was interested in this topic, already knows that the price of a new traffic light hovers around $ 500.  Attempts to find a second-hand decommissioned device have not been successful.  Both options could not please the budget and the soul of two enthusiasts from the office, so it was decided to make the traffic light myself. <a name="habracut"></a><br><br><h4>  Idea </h4><br>  In principle, there is nothing difficult in the construction of a traffic light, but no layout was made.  So it was easier to imagine what you need to cut and how best to do it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/20a/4a6/b47/20a4a6b473f81281e8058401fdf2e30d.jpg" alt="image"><br><br>  Before doing the layout on one of the sites with ads, we were lucky to find glass from the Soviet traffic light.  This was a great relief, as the original glass as nothing better than give the design authenticity.  Accordingly, the size of the case was dictated by the size of the glass, as well as the size of the internal components such as power supplies, wiring, etc. <br><br>  The main ‚Äúbrain‚Äù was designated raspberry pi for several reasons.  The first is its presence after previous experiments with the ‚Äúraspberry‚Äù, the second is the simplicity of implementing the control of the traffic light from the outside, installing various kinds of software, wifi, etc. <br><br><h4>  Housing </h4><br>  It all began of course with the case.  For its manufacture was used PVC plastic which is used for the manufacture of outdoor advertising.  It is very easy to handle and, in combination with a super glue on the exit, gives a fairly solid construction.  Plastic with cutting of appropriate sizes was ordered at an advertising agency.  The cutting accuracy was a little worse than expected, so after gluing the body, we had to work fairly with plastic putty and emery.  The result was such a body. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6e5/3a3/b47/6e53a3b47191939dbae26cd73e10522b.jpg" alt="image"><br><br>  Plastic was so pliable that it was easier to make visors than anyone could have imagined.  The cut parts of the visors were thrown into boiling water, and then bent about a two-liter jar before cooling.  Yes, yes, the diameter of a two-liter cans was the same as the glass.  That was the unification in the USSR! <br><br>  For the time being, simply by attaching the glass one could already clearly see the future traffic light, although even at the stage of the hull it seemed that nothing good could come of this idea. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/366/03f/5e8/36603f5e8c9d73f1b4a1dea1075d7da4.jpg" alt="image"><br><br>  After painting in black "traffic light" color, everything began to look even more wonderful.  Also masking cords were glued to cover the fasteners of the glasses and make the structure more complete. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6a3/348/35b/6a334835b6a520bcd8369adb8c20807d.jpg" alt="image"><br><br><h4>  Electronics </h4><br>  For the sake of safety, reducing energy consumption and a number of other reasons, LEDs were chosen as the light source.  Only 27 pieces, 9 per color.  For them, 27 holes were drilled in the housing, respectively. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/613/122/088/613122088e5fe2085b16b2bdf2bb0034.jpg" alt="image"><br><br>  For the convenience of repair and installation of LEDs, they were placed on plastic matrices with placement coinciding with the holes in the housing. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/58d/652/38d/58d65238de0afe9038c29ccf26f4c698.jpg" alt="image"><br><br>  They are easily installed and removed in case one of the LEDs burns out.  To control the logic, GPIO pins on raspberry pi are used, respectively, as a control logic, a board was made with three 3V controlled relays and 12V switching voltages, which are fed to LED arrays. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e53/8eb/bf5/e538ebbf5e4f32b5344789bfabcb0ab5.jpg" alt="image"><br><br>  At the testing stage before the final build, everything looked like this. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f9/e1a/0b7/3f9e1a0b7b59d4558c81e98bea491641.jpg" alt="image"><br><br>  Everything is ‚Äúabandoned‚Äù in the case and attached a temporary power cord for 220V since there was not a sufficiently long cord at hand at the time of assembly.  Inside there are also two power supplies.  One 12V for power LEDs, the second unit with a USB port for raspberry pi. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e55/af4/b21/e55af4b21c1b924947a969f92541f3d6.jpg" alt="image"><br><br><h4>  Software </h4><br>  For ease of control from the outside, a lighttpd server was installed with mod_fcgi for python.  Thus, the mode can be controlled simply from the browser.  So it was convenient to indulge yourself.  Later for Jenkins was written code that polls it and accordingly changes the status of the traffic light.  Python, on the other hand, was not chosen by chance, it is quite easy to cope with managing GPIO pins on raspberry using the <a href="http://wiringpi.com/">wiringpi.com</a> library <a href="http://wiringpi.com/">set</a> . <br><br>  Simple web script code for management, which was later replaced with the one described above. <br><br><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/pythonRoot # Bring in the libraries import RPi.GPIO as G from flup.server.fcgi import WSGIServer import sys, urlparse, time # GPIO lights map light_r = 4 light_y = 17 light_g = 22 # Set up our GPIO pins G.setmode(G.BCM) G.setup(light_r, G.OUT) G.setup(light_y, G.OUT) G.setup(light_g, G.OUT) # Offs all lights def offLights(): G.output(light_r, False) G.output(light_y, False) G.output(light_g, False) # Function which is called for each http request we receive def app(environ, start_response): # start our http response start_response("200 OK", [("Content-Type", "text/html")]) # look for inputs on the URL i = urlparse.parse_qs(environ["QUERY_STRING"]) yield (' ') # flup expects a string to be returned from this function # if there's a url variable named 'q' if "mode" in i: if i["mode"][0] == "red": offLights() G.output(light_r, True) elif i["mode"][0] == "yellow": offLights() G.output(light_y, True) elif i["mode"][0] == "green": offLights() G.output(light_g, True) elif i["mode"][0] == "off": offLights() #Run app WSGIServer(app).run()</span></span></code> </pre> <br><br><h4>  Expenses </h4><br>  About a week of work of two people went to everything, an hour a day after work.  For the money: <br><table><tbody><tr><td>  Raspberry Pi model B </td><td>  $ 50 </td></tr><tr><td>  PVC plastic for housing with cutting </td><td>  $ 15 </td></tr><tr><td>  Matt black paint </td><td>  $ 10 </td></tr><tr><td>  Power supplies </td><td>  $ 10 </td></tr><tr><td>  Relays, LEDs and other trifles </td><td>  $ 10 </td></tr><tr><td>  Wifi whistle for raspberry </td><td>  $ 10 </td></tr><tr><td>  Glasses </td><td>  $ 7 </td></tr><tr><td>  Putty </td><td>  $ 5 </td></tr><tr><td></td><td>  Total: $ 117 </td></tr></tbody></table><br><h4>  Conclusion </h4><br>  Let's start with the video work in demo mode. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/bH9ei2fSSWM%3Ffeature%3Doembed&amp;xid=17259,1500004,15700023,15700186,15700190,15700253&amp;usg=ALkJrhgqLM4p5k4PBv24ecK_IeASIs1enA" frameborder="0" allowfullscreen=""></iframe><br><br>  As can be seen from the video, the cold glow of the LEDs in combination with our glass gave a bluish tint.  Now we are considering options for correction, the benefit of maintainability was incorporated into our design. <br>  Agree to the difference in the budget is enormous, the enthusiasm is satisfied and the result is more than satisfactory.  As a result, though not a warm lamp, but a cold LED, but still a traffic light, which in the near future I hope will fulfill its purpose.  The transition to continious integration is not yet complete. <br><br>  Good luck to everyone, and fewer red on the build-traffic lights! </div><p>Source: <a href="https://habr.com/ru/post/206486/">https://habr.com/ru/post/206486/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../206472/index.html">Recover deleted contacts with Apple iPhone. 9 easy steps</a></li>
<li><a href="../206478/index.html">Preparing for the CCIE labe at home</a></li>
<li><a href="../206480/index.html">Disable ctrl-alt-delete, alt-tab, Start, and other combinations</a></li>
<li><a href="../206482/index.html">Why do we not have scientific crowdfunding?</a></li>
<li><a href="../206484/index.html">Develop a template for the site on Squarespace 6</a></li>
<li><a href="../206488/index.html">WordPress site hack, who needs all this and tips on how to avoid it</a></li>
<li><a href="../206494/index.html">Methods for calculating statistics of visiting pages on the site "on the fly"</a></li>
<li><a href="../206498/index.html">Boom charitable startups in Russia?</a></li>
<li><a href="../206500/index.html">Hackathon Apps4all: scandals, intrigues, investigations</a></li>
<li><a href="../206502/index.html">Is it easy to teach a robot to pass a test for programmers?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>