<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How a month to get a lot of pumping in Data Science</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! 



 My name is Gleb , I have been working in retail analytics for a long time and now I am engaged in using machine learning in this field....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How a month to get a lot of pumping in Data Science</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr! <br><br><img src="https://habrastorage.org/files/a21/8b8/fa4/a218b8fa47f94a2cb189b1f559558d91.png"><br><br>  My name is <a href="https://ru.linkedin.com/in/morozovgleb">Gleb</a> , I have been working in retail analytics for a long time and now I am engaged in using machine learning in this field.  Not long ago, I met the guys from <a href="http://dscourse.mlclass.ru/">MLClass.ru</a> , who in a very short time rather strongly pumped me into the field of <b>Data Science</b> .  Thanks to them, literally in a month I began actively submitting to kaggle.  Therefore, this series of publications will describe my experience in studying Data Science: all the mistakes that were made, as well as valuable advice that the guys gave me.  Today I will talk about the experience of participating in <a href="https://inclass.kaggle.com/c/15-071x-the-analytics-edge-summer-2015">The Analytics Edge (Spring 2015)</a> .  This is my first article - do not judge strictly. <br><a name="habracut"></a><br>  The described competition was held as part of the <b>‚ÄúThe Analytics Edge‚Äù</b> course <b>from the ‚ÄúMassachusetts Institute of Technology‚Äù</b> .  Below I will provide the code in the <b>R</b> language, which can be found entirely <a href="">here</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Task Description </h3><br>  Any seller would like to know what characteristics of the product increase the likelihood of the sale of goods.  In this competition, it was proposed to investigate models that would predict the likelihood of selling an <b>Apple iPad</b> on a database obtained from the <b>eBay</b> website. <br><br><h3>  Data </h3><br>  The data proposed for study consisted of two files: <br><ul><li>  <b>eBayiPadTrain.csv</b> - a data set for creating a model.  Contains <b>1861</b> products. </li><li>  <b>eBayiPadTest.csv</b> - data for model evaluation </li></ul><br>  To begin with we will connect the libraries applied in work. <br><br><pre><code class="hljs 1c">library(dplyr) <span class="hljs-meta"><span class="hljs-meta"># </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword"></span></span></span><span class="hljs-meta">     library(readr) # </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword"></span></span></span><span class="hljs-meta">     </span></span></code> </pre> <br>  Now load the data. <br><br><pre> <code class="hljs lisp">eBayTrain &lt;- read_csv(<span class="hljs-string"><span class="hljs-string">"eBayiPadTrain.csv"</span></span>) eBayTest &lt;- read_csv(<span class="hljs-string"><span class="hljs-string">"eBayiPadTest.csv"</span></span>)</code> </pre><br>  Let's look at the data structure. <br><pre> <code class="hljs mel">summary(eBayTrain) ## description biddable startprice <span class="hljs-keyword"><span class="hljs-keyword">condition</span></span> ## Length:<span class="hljs-number"><span class="hljs-number">1861</span></span> Min. :<span class="hljs-number"><span class="hljs-number">0.0000</span></span> Min. : <span class="hljs-number"><span class="hljs-number">0.01</span></span> Length:<span class="hljs-number"><span class="hljs-number">1861</span></span> ## Class :<span class="hljs-keyword"><span class="hljs-keyword">character</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>st Qu.:<span class="hljs-number"><span class="hljs-number">0.0000</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>st Qu.: <span class="hljs-number"><span class="hljs-number">80.00</span></span> Class :<span class="hljs-keyword"><span class="hljs-keyword">character</span></span> ## Mode :<span class="hljs-keyword"><span class="hljs-keyword">character</span></span> Median :<span class="hljs-number"><span class="hljs-number">0.0000</span></span> Median :<span class="hljs-number"><span class="hljs-number">179.99</span></span> Mode :<span class="hljs-keyword"><span class="hljs-keyword">character</span></span> ## Mean :<span class="hljs-number"><span class="hljs-number">0.4498</span></span> Mean :<span class="hljs-number"><span class="hljs-number">211.18</span></span> ## <span class="hljs-number"><span class="hljs-number">3</span></span>rd Qu.:<span class="hljs-number"><span class="hljs-number">1.0000</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>rd Qu.:<span class="hljs-number"><span class="hljs-number">300.00</span></span> ## Max. :<span class="hljs-number"><span class="hljs-number">1.0000</span></span> Max. :<span class="hljs-number"><span class="hljs-number">999.00</span></span> ## cellular carrier <span class="hljs-keyword"><span class="hljs-keyword">color</span></span> ## Length:<span class="hljs-number"><span class="hljs-number">1861</span></span> Length:<span class="hljs-number"><span class="hljs-number">1861</span></span> Length:<span class="hljs-number"><span class="hljs-number">1861</span></span> ## Class :<span class="hljs-keyword"><span class="hljs-keyword">character</span></span> Class :<span class="hljs-keyword"><span class="hljs-keyword">character</span></span> Class :<span class="hljs-keyword"><span class="hljs-keyword">character</span></span> ## Mode :<span class="hljs-keyword"><span class="hljs-keyword">character</span></span> Mode :<span class="hljs-keyword"><span class="hljs-keyword">character</span></span> Mode :<span class="hljs-keyword"><span class="hljs-keyword">character</span></span> ## ## ## ## storage productline sold UniqueID ## Length:<span class="hljs-number"><span class="hljs-number">1861</span></span> Length:<span class="hljs-number"><span class="hljs-number">1861</span></span> Min. :<span class="hljs-number"><span class="hljs-number">0.0000</span></span> Min. :<span class="hljs-number"><span class="hljs-number">10001</span></span> ## Class :<span class="hljs-keyword"><span class="hljs-keyword">character</span></span> Class :<span class="hljs-keyword"><span class="hljs-keyword">character</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>st Qu.:<span class="hljs-number"><span class="hljs-number">0.0000</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>st Qu.:<span class="hljs-number"><span class="hljs-number">10466</span></span> ## Mode :<span class="hljs-keyword"><span class="hljs-keyword">character</span></span> Mode :<span class="hljs-keyword"><span class="hljs-keyword">character</span></span> Median :<span class="hljs-number"><span class="hljs-number">0.0000</span></span> Median :<span class="hljs-number"><span class="hljs-number">10931</span></span> ## Mean :<span class="hljs-number"><span class="hljs-number">0.4621</span></span> Mean :<span class="hljs-number"><span class="hljs-number">10931</span></span> ## <span class="hljs-number"><span class="hljs-number">3</span></span>rd Qu.:<span class="hljs-number"><span class="hljs-number">1.0000</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>rd Qu.:<span class="hljs-number"><span class="hljs-number">11396</span></span> ## Max. :<span class="hljs-number"><span class="hljs-number">1.0000</span></span> Max. :<span class="hljs-number"><span class="hljs-number">11861</span></span> str(eBayTrain) ## Classes <span class="hljs-string"><span class="hljs-string">'tbl_df'</span></span>, <span class="hljs-string"><span class="hljs-string">'tbl'</span></span> and <span class="hljs-string"><span class="hljs-string">'data.frame'</span></span>: <span class="hljs-number"><span class="hljs-number">1861</span></span> obs. of <span class="hljs-number"><span class="hljs-number">11</span></span> variables: ## $ description: chr <span class="hljs-string"><span class="hljs-string">"iPad is in 8.5+ out of 10 cosmetic condition!"</span></span> <span class="hljs-string"><span class="hljs-string">"Previously used, please read description. May show signs of use such as scratches to the screen and "</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> ... ## $ biddable : <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> ... ## $ startprice : num <span class="hljs-number"><span class="hljs-number">159.99</span></span> <span class="hljs-number"><span class="hljs-number">0.99</span></span> <span class="hljs-number"><span class="hljs-number">199.99</span></span> <span class="hljs-number"><span class="hljs-number">235</span></span> <span class="hljs-number"><span class="hljs-number">199.99</span></span> ... ## $ <span class="hljs-keyword"><span class="hljs-keyword">condition</span></span> : chr <span class="hljs-string"><span class="hljs-string">"Used"</span></span> <span class="hljs-string"><span class="hljs-string">"Used"</span></span> <span class="hljs-string"><span class="hljs-string">"Used"</span></span> <span class="hljs-string"><span class="hljs-string">"New other (see details)"</span></span> ... ## $ cellular : chr <span class="hljs-string"><span class="hljs-string">"0"</span></span> <span class="hljs-string"><span class="hljs-string">"1"</span></span> <span class="hljs-string"><span class="hljs-string">"0"</span></span> <span class="hljs-string"><span class="hljs-string">"0"</span></span> ... ## $ carrier : chr <span class="hljs-string"><span class="hljs-string">"None"</span></span> <span class="hljs-string"><span class="hljs-string">"Verizon"</span></span> <span class="hljs-string"><span class="hljs-string">"None"</span></span> <span class="hljs-string"><span class="hljs-string">"None"</span></span> ... ## $ <span class="hljs-keyword"><span class="hljs-keyword">color</span></span> : chr <span class="hljs-string"><span class="hljs-string">"Black"</span></span> <span class="hljs-string"><span class="hljs-string">"Unknown"</span></span> <span class="hljs-string"><span class="hljs-string">"White"</span></span> <span class="hljs-string"><span class="hljs-string">"Unknown"</span></span> ... ## $ storage : chr <span class="hljs-string"><span class="hljs-string">"16"</span></span> <span class="hljs-string"><span class="hljs-string">"16"</span></span> <span class="hljs-string"><span class="hljs-string">"16"</span></span> <span class="hljs-string"><span class="hljs-string">"16"</span></span> ... ## $ productline: chr <span class="hljs-string"><span class="hljs-string">"iPad 2"</span></span> <span class="hljs-string"><span class="hljs-string">"iPad 2"</span></span> <span class="hljs-string"><span class="hljs-string">"iPad 4"</span></span> <span class="hljs-string"><span class="hljs-string">"iPad mini 2"</span></span> ... ## $ sold : <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> ... ## $ UniqueID : <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-number"><span class="hljs-number">10001</span></span> <span class="hljs-number"><span class="hljs-number">10002</span></span> <span class="hljs-number"><span class="hljs-number">10003</span></span> <span class="hljs-number"><span class="hljs-number">10004</span></span> <span class="hljs-number"><span class="hljs-number">10005</span></span> <span class="hljs-number"><span class="hljs-number">10006</span></span> <span class="hljs-number"><span class="hljs-number">10007</span></span> <span class="hljs-number"><span class="hljs-number">10008</span></span> <span class="hljs-number"><span class="hljs-number">10009</span></span> <span class="hljs-number"><span class="hljs-number">10010</span></span> ...</code> </pre><br>  The data set consists of <b>11</b> variables: <br><br><ul><li>  <b>description</b> - text description of the product provided by the seller </li><li>  <b>biddable</b> - the item has been auctioned (= 1) or at a fixed price (= 0) </li><li>  <b>startprice</b> - starting price for the auction (if <b>biddable</b> = 1) or selling price (if <b>biddable</b> = 0) </li><li>  <b>condition</b> - the condition of the goods (new, used, etc.) </li><li>  <b>cellular</b> - a product with a mobile connection (= 1) or not (= 0) </li><li>  <b>carrier</b> - carrier (if <b>cellular</b> = 1) </li><li>  <b>color</b> - color </li><li>  <b>storage</b> - memory size </li><li>  <b>productline</b> - product model name </li><li>  <b>sold</b> - whether the item was sold (= 1) or not (= 0).  This will be the dependent variable. </li><li>  <b>UniqueID</b> - unique sequence number </li></ul><br><br>  Thus, we have three types of variables: textual <b>description</b> , numerical <b>startprice,</b> and all the others are factorial. <br><br><h3>  Creating additional variables </h3><br>  Let's see which part of the goods has a description <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">table</span></span>(eBayTrain$description == "") ## ## <span class="hljs-keyword"><span class="hljs-keyword">FALSE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRUE</span></span> ## <span class="hljs-number"><span class="hljs-number">790</span></span> <span class="hljs-number"><span class="hljs-number">1071</span></span></code> </pre><br>  Since not all products have a description, I assumed that this parameter may affect the probability of sale.  To take this into account, we will create a variable that will take the value <b>1</b> , if the description is, and <b>0</b> , in the opposite case. <br><br><pre> <code class="hljs pgsql">eBayTrain$is_descr = <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.factor(eBayTrain$description == "") <span class="hljs-keyword"><span class="hljs-keyword">table</span></span>(eBayTrain$description == "", eBayTrain$is_descr) ## ## <span class="hljs-keyword"><span class="hljs-keyword">FALSE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRUE</span></span> ## <span class="hljs-keyword"><span class="hljs-keyword">FALSE</span></span> <span class="hljs-number"><span class="hljs-number">790</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ## <span class="hljs-keyword"><span class="hljs-keyword">TRUE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1071</span></span></code> </pre><br><h3>  Creating variables for a model from a text description </h3><br>  Based on the text description, we will create variables for the model by highlighting common words.  For this we use the <b>tm</b> library. <br><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">library</span></span>(tm) ##   ## <span class="hljs-type"><span class="hljs-type">Loading</span></span> required package: <span class="hljs-type"><span class="hljs-type">NLP</span></span> ##    ,     <span class="hljs-type"><span class="hljs-type">CorpusDescription</span></span> &lt;- <span class="hljs-type"><span class="hljs-type">Corpus</span></span>(<span class="hljs-type"><span class="hljs-type">VectorSource</span></span>(c(eBayTrain$description, eBayTest$description))) ##      <span class="hljs-type"><span class="hljs-type">CorpusDescription</span></span> &lt;- tm_map(<span class="hljs-type"><span class="hljs-type">CorpusDescription</span></span>, content_transformer(tolower)) <span class="hljs-type"><span class="hljs-type">CorpusDescription</span></span> &lt;- tm_map(<span class="hljs-type"><span class="hljs-type">CorpusDescription</span></span>, <span class="hljs-type"><span class="hljs-type">PlainTextDocument</span></span>) ##    <span class="hljs-type"><span class="hljs-type">CorpusDescription</span></span> &lt;- tm_map(<span class="hljs-type"><span class="hljs-type">CorpusDescription</span></span>, removePunctuation) ##    -, .. ,     <span class="hljs-type"><span class="hljs-type">CorpusDescription</span></span> &lt;- tm_map(<span class="hljs-type"><span class="hljs-type">CorpusDescription</span></span>, removeWords, stopwords(<span class="hljs-string"><span class="hljs-string">"english"</span></span>)) ##  , ..      <span class="hljs-type"><span class="hljs-type">CorpusDescription</span></span> &lt;- tm_map(<span class="hljs-type"><span class="hljs-type">CorpusDescription</span></span>, stemDocument) ##    dtm &lt;- <span class="hljs-type"><span class="hljs-type">DocumentTermMatrix</span></span>(<span class="hljs-type"><span class="hljs-type">CorpusDescription</span></span>) ##    sparse &lt;- removeSparseTerms(dtm, <span class="hljs-number"><span class="hljs-number">0.97</span></span>) ##     <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">.frame       </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DescriptionWords</span></span></span><span class="hljs-class"> = as.</span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">.frame(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">as</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">matrix</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sparse</span></span></span><span class="hljs-class">)) colnames(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DescriptionWords</span></span></span><span class="hljs-class">) = make.names(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">colnames</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DescriptionWords</span></span></span><span class="hljs-class">)) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DescriptionWordsTrain</span></span></span><span class="hljs-class"> = head(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DescriptionWords</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nrow</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eBayTrain</span></span></span><span class="hljs-class">)) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DescriptionWordsTest</span></span></span><span class="hljs-class"> = tail(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DescriptionWords</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nrow</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eBayTest</span></span></span><span class="hljs-class">))</span></span></code> </pre><br>  Now we will bring the remaining text variables to the data type <b>factor</b> to prevent them from being treated as text by the model.  And combine them with the variables derived from the product description.  For this we use a very convenient library <b>magnittr</b> <br><br><pre> <code class="hljs pgsql">library(magrittr) eBayTrain %&lt;&gt;% mutate(condition = <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.factor(condition), cellular = <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.factor(cellular), carrier = <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.factor(carrier), color = <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.factor(color), storage = <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.factor(<span class="hljs-keyword"><span class="hljs-keyword">storage</span></span>), productline = <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.factor(productline), sold = <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.factor(sold)) %&gt;% <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>(-description, -UniqueID ) %&gt;% cbind(., DescriptionWordsTrain)</code> </pre><br>  Let's look at the resulting set of variables. <br><br><pre> <code class="hljs smalltalk">str(eBayTrain) ## <span class="hljs-string"><span class="hljs-string">'data.frame'</span></span>: <span class="hljs-number"><span class="hljs-number">1861</span></span> obs. of <span class="hljs-number"><span class="hljs-number">30</span></span> variables: ## <span class="hljs-string"><span class="hljs-string">$ </span></span>biddable : int <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>startprice : num <span class="hljs-number"><span class="hljs-number">159.99</span></span> <span class="hljs-number"><span class="hljs-number">0.99</span></span> <span class="hljs-number"><span class="hljs-number">199.99</span></span> <span class="hljs-number"><span class="hljs-number">235</span></span> <span class="hljs-number"><span class="hljs-number">199.99</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>condition : <span class="hljs-type"><span class="hljs-type">Factor</span></span> w/ <span class="hljs-number"><span class="hljs-number">6</span></span> levels <span class="hljs-comment"><span class="hljs-comment">"For parts or not working"</span></span>,..: <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>cellular : <span class="hljs-type"><span class="hljs-type">Factor</span></span> w/ <span class="hljs-number"><span class="hljs-number">3</span></span> levels <span class="hljs-comment"><span class="hljs-comment">"0"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"1"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"Unknown"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>carrier : <span class="hljs-type"><span class="hljs-type">Factor</span></span> w/ <span class="hljs-number"><span class="hljs-number">7</span></span> levels <span class="hljs-comment"><span class="hljs-comment">"AT&amp;T"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"None"</span></span>,..: <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>color : <span class="hljs-type"><span class="hljs-type">Factor</span></span> w/ <span class="hljs-number"><span class="hljs-number">5</span></span> levels <span class="hljs-comment"><span class="hljs-comment">"Black"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"Gold"</span></span>,..: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>storage : <span class="hljs-type"><span class="hljs-type">Factor</span></span> w/ <span class="hljs-number"><span class="hljs-number">5</span></span> levels <span class="hljs-comment"><span class="hljs-comment">"128"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"16"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"32"</span></span>,..: <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>productline: <span class="hljs-type"><span class="hljs-type">Factor</span></span> w/ <span class="hljs-number"><span class="hljs-number">12</span></span> levels <span class="hljs-comment"><span class="hljs-comment">"iPad 1"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"iPad 2"</span></span>,..: <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>sold : <span class="hljs-type"><span class="hljs-type">Factor</span></span> w/ <span class="hljs-number"><span class="hljs-number">2</span></span> levels <span class="hljs-comment"><span class="hljs-comment">"0"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"1"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>is_descr : <span class="hljs-type"><span class="hljs-type">Factor</span></span> w/ <span class="hljs-number"><span class="hljs-number">2</span></span> levels <span class="hljs-comment"><span class="hljs-comment">"FALSE"</span></span>,<span class="hljs-comment"><span class="hljs-comment">"TRUE"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>box : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>condit : num <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>cosmet : num <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>devic : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>excel : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>fulli : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>function. : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>good : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>great : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>includ : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>ipad : num <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>item : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>light : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>minor : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>new : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>scratch : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>screen : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>use : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>wear : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ... ## <span class="hljs-string"><span class="hljs-string">$ </span></span>work : num <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ...</code> </pre><br>  <b>Perform the</b> normalization of the <b>startprice</b> variable so that this variable does not exert undue influence on the model results, due to its much wider range compared to other variables. <br><br><pre> <code class="hljs perl">eBayTrain$startprice &lt;- (eBayTrain$startprice - mean(eBayTrain$startprice))/sd(eBayTrain$startprice)</code> </pre><br><br><h3>  Models </h3><br>  With the obtained data set we will create models.  To assess the accuracy of the assessment of models, we will apply the same assessment that was chosen in the competition.  This is <b>AUC</b> .  This parameter is often used to evaluate classification models.  It reflects the probability with which the model will correctly determine the dependent variable from a random data set.  An ideal model will show an <b>AUC</b> value of 1.0, and a model with an equally probable random guessing - <b>0.5</b> . <br><br>  Since the format of the competition involves a limited number of times per day, which can be verified by the resulting model by uploading the results to the site, then to evaluate the models, we will separate our own test sample from the training data set.  To obtain a balanced sample, use the <b>caTools</b> library. <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span>.seed(<span class="hljs-number"><span class="hljs-number">1000</span></span>) ##    library(caTools) <span class="hljs-built_in"><span class="hljs-built_in">split</span></span> &lt;- sample.<span class="hljs-built_in"><span class="hljs-built_in">split</span></span>(eBayTrain$sold, <span class="hljs-type"><span class="hljs-type">SplitRatio</span></span> = <span class="hljs-number"><span class="hljs-number">0.7</span></span>) train &lt;- <span class="hljs-built_in"><span class="hljs-built_in">filter</span></span>(eBayTrain, <span class="hljs-built_in"><span class="hljs-built_in">split</span></span> == <span class="hljs-type"><span class="hljs-type">T</span></span>) test &lt;- <span class="hljs-built_in"><span class="hljs-built_in">filter</span></span>(eBayTrain, <span class="hljs-built_in"><span class="hljs-built_in">split</span></span> == <span class="hljs-type"><span class="hljs-type">F</span></span>)</code> </pre><br><h3>  Logistic classification </h3><br>  Create a logistic regression model <br><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">model_glm1</span></span> &lt;- glm(sold ~ ., <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> = train, </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">family</span></span></span><span class="hljs-class"> = binomial)</span></span></code> </pre><br>  Let's look at the significance of variables for the model. <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>(model_glm1) ## ## <span class="hljs-keyword"><span class="hljs-keyword">Call</span></span>: ## glm(formula = sold ~ ., <span class="hljs-keyword"><span class="hljs-keyword">family</span></span> = binomial, data = train) ## ## Deviance Residuals: ## Min <span class="hljs-number"><span class="hljs-number">1</span></span>Q Median <span class="hljs-number"><span class="hljs-number">3</span></span>Q Max ## <span class="hljs-number"><span class="hljs-number">-2.6620</span></span> <span class="hljs-number"><span class="hljs-number">-0.7308</span></span> <span class="hljs-number"><span class="hljs-number">-0.2450</span></span> <span class="hljs-number"><span class="hljs-number">0.6229</span></span> <span class="hljs-number"><span class="hljs-number">3.5600</span></span> ## ## Coefficients: ## Estimate Std. Error z <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> Pr(&gt;|z|) ## (Intercept) <span class="hljs-number"><span class="hljs-number">11.91318</span></span> <span class="hljs-number"><span class="hljs-number">619.41930</span></span> <span class="hljs-number"><span class="hljs-number">0.019</span></span> <span class="hljs-number"><span class="hljs-number">0.984655</span></span> ## biddable <span class="hljs-number"><span class="hljs-number">1.52257</span></span> <span class="hljs-number"><span class="hljs-number">0.16942</span></span> <span class="hljs-number"><span class="hljs-number">8.987</span></span> &lt; <span class="hljs-number"><span class="hljs-number">2e-16</span></span> ## startprice <span class="hljs-number"><span class="hljs-number">-1.96460</span></span> <span class="hljs-number"><span class="hljs-number">0.19122</span></span> <span class="hljs-number"><span class="hljs-number">-10.274</span></span> &lt; <span class="hljs-number"><span class="hljs-number">2e-16</span></span> ## conditionManufacturer refurbished <span class="hljs-number"><span class="hljs-number">0.92765</span></span> <span class="hljs-number"><span class="hljs-number">0.59405</span></span> <span class="hljs-number"><span class="hljs-number">1.562</span></span> <span class="hljs-number"><span class="hljs-number">0.118394</span></span> ## conditionNew <span class="hljs-number"><span class="hljs-number">0.64792</span></span> <span class="hljs-number"><span class="hljs-number">0.38449</span></span> <span class="hljs-number"><span class="hljs-number">1.685</span></span> <span class="hljs-number"><span class="hljs-number">0.091964</span></span> ## conditionNew other (see details) <span class="hljs-number"><span class="hljs-number">0.98380</span></span> <span class="hljs-number"><span class="hljs-number">0.50308</span></span> <span class="hljs-number"><span class="hljs-number">1.956</span></span> <span class="hljs-number"><span class="hljs-number">0.050517</span></span> ## conditionSeller refurbished <span class="hljs-number"><span class="hljs-number">-0.03144</span></span> <span class="hljs-number"><span class="hljs-number">0.40675</span></span> <span class="hljs-number"><span class="hljs-number">-0.077</span></span> <span class="hljs-number"><span class="hljs-number">0.938388</span></span> ## conditionUsed <span class="hljs-number"><span class="hljs-number">0.43817</span></span> <span class="hljs-number"><span class="hljs-number">0.27167</span></span> <span class="hljs-number"><span class="hljs-number">1.613</span></span> <span class="hljs-number"><span class="hljs-number">0.106767</span></span> ## cellular1 <span class="hljs-number"><span class="hljs-number">-13.13755</span></span> <span class="hljs-number"><span class="hljs-number">619.41893</span></span> <span class="hljs-number"><span class="hljs-number">-0.021</span></span> <span class="hljs-number"><span class="hljs-number">0.983079</span></span> ## cellularUnknown <span class="hljs-number"><span class="hljs-number">-13.50679</span></span> <span class="hljs-number"><span class="hljs-number">619.41886</span></span> <span class="hljs-number"><span class="hljs-number">-0.022</span></span> <span class="hljs-number"><span class="hljs-number">0.982603</span></span> ## carrierNone <span class="hljs-number"><span class="hljs-number">-13.25989</span></span> <span class="hljs-number"><span class="hljs-number">619.41897</span></span> <span class="hljs-number"><span class="hljs-number">-0.021</span></span> <span class="hljs-number"><span class="hljs-number">0.982921</span></span> ## carrierOther <span class="hljs-number"><span class="hljs-number">12.51777</span></span> <span class="hljs-number"><span class="hljs-number">622.28887</span></span> <span class="hljs-number"><span class="hljs-number">0.020</span></span> <span class="hljs-number"><span class="hljs-number">0.983951</span></span> ## carrierSprint <span class="hljs-number"><span class="hljs-number">0.88998</span></span> <span class="hljs-number"><span class="hljs-number">0.69925</span></span> <span class="hljs-number"><span class="hljs-number">1.273</span></span> <span class="hljs-number"><span class="hljs-number">0.203098</span></span> ## carrierT-Mobile <span class="hljs-number"><span class="hljs-number">0.02578</span></span> <span class="hljs-number"><span class="hljs-number">0.89321</span></span> <span class="hljs-number"><span class="hljs-number">0.029</span></span> <span class="hljs-number"><span class="hljs-number">0.976973</span></span> ## carrierUnknown <span class="hljs-number"><span class="hljs-number">-0.43898</span></span> <span class="hljs-number"><span class="hljs-number">0.41684</span></span> <span class="hljs-number"><span class="hljs-number">-1.053</span></span> <span class="hljs-number"><span class="hljs-number">0.292296</span></span> ## carrierVerizon <span class="hljs-number"><span class="hljs-number">0.15653</span></span> <span class="hljs-number"><span class="hljs-number">0.36337</span></span> <span class="hljs-number"><span class="hljs-number">0.431</span></span> <span class="hljs-number"><span class="hljs-number">0.666625</span></span> ## colorGold <span class="hljs-number"><span class="hljs-number">0.10763</span></span> <span class="hljs-number"><span class="hljs-number">0.53565</span></span> <span class="hljs-number"><span class="hljs-number">0.201</span></span> <span class="hljs-number"><span class="hljs-number">0.840755</span></span> ## colorSpace Gray <span class="hljs-number"><span class="hljs-number">-0.13043</span></span> <span class="hljs-number"><span class="hljs-number">0.30662</span></span> <span class="hljs-number"><span class="hljs-number">-0.425</span></span> <span class="hljs-number"><span class="hljs-number">0.670564</span></span> ## colorUnknown <span class="hljs-number"><span class="hljs-number">-0.14471</span></span> <span class="hljs-number"><span class="hljs-number">0.20833</span></span> <span class="hljs-number"><span class="hljs-number">-0.695</span></span> <span class="hljs-number"><span class="hljs-number">0.487307</span></span> ## colorWhite <span class="hljs-number"><span class="hljs-number">-0.03924</span></span> <span class="hljs-number"><span class="hljs-number">0.22997</span></span> <span class="hljs-number"><span class="hljs-number">-0.171</span></span> <span class="hljs-number"><span class="hljs-number">0.864523</span></span> ## storage16 <span class="hljs-number"><span class="hljs-number">-1.09720</span></span> <span class="hljs-number"><span class="hljs-number">0.50539</span></span> <span class="hljs-number"><span class="hljs-number">-2.171</span></span> <span class="hljs-number"><span class="hljs-number">0.029933</span></span> ## storage32 <span class="hljs-number"><span class="hljs-number">-1.14454</span></span> <span class="hljs-number"><span class="hljs-number">0.51860</span></span> <span class="hljs-number"><span class="hljs-number">-2.207</span></span> <span class="hljs-number"><span class="hljs-number">0.027315</span></span> ## storage64 <span class="hljs-number"><span class="hljs-number">-0.50647</span></span> <span class="hljs-number"><span class="hljs-number">0.50351</span></span> <span class="hljs-number"><span class="hljs-number">-1.006</span></span> <span class="hljs-number"><span class="hljs-number">0.314474</span></span> ## storageUnknown <span class="hljs-number"><span class="hljs-number">-0.29305</span></span> <span class="hljs-number"><span class="hljs-number">0.63389</span></span> <span class="hljs-number"><span class="hljs-number">-0.462</span></span> <span class="hljs-number"><span class="hljs-number">0.643867</span></span> ## productlineiPad <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0.33364</span></span> <span class="hljs-number"><span class="hljs-number">0.28457</span></span> <span class="hljs-number"><span class="hljs-number">1.172</span></span> <span class="hljs-number"><span class="hljs-number">0.241026</span></span> ## productlineiPad <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">0.71895</span></span> <span class="hljs-number"><span class="hljs-number">0.34595</span></span> <span class="hljs-number"><span class="hljs-number">2.078</span></span> <span class="hljs-number"><span class="hljs-number">0.037694</span></span> ## productlineiPad <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">0.81952</span></span> <span class="hljs-number"><span class="hljs-number">0.36513</span></span> <span class="hljs-number"><span class="hljs-number">2.244</span></span> <span class="hljs-number"><span class="hljs-number">0.024801</span></span> ## productlineiPad <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">2.89336</span></span> <span class="hljs-number"><span class="hljs-number">1080.03688</span></span> <span class="hljs-number"><span class="hljs-number">0.003</span></span> <span class="hljs-number"><span class="hljs-number">0.997863</span></span> ## productlineiPad Air <span class="hljs-number"><span class="hljs-number">2.15206</span></span> <span class="hljs-number"><span class="hljs-number">0.40290</span></span> <span class="hljs-number"><span class="hljs-number">5.341</span></span> <span class="hljs-number"><span class="hljs-number">9.22e-08</span></span> ## productlineiPad Air <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3.05284</span></span> <span class="hljs-number"><span class="hljs-number">0.50834</span></span> <span class="hljs-number"><span class="hljs-number">6.005</span></span> <span class="hljs-number"><span class="hljs-number">1.91e-09</span></span> ## productlineiPad mini <span class="hljs-number"><span class="hljs-number">0.40681</span></span> <span class="hljs-number"><span class="hljs-number">0.30583</span></span> <span class="hljs-number"><span class="hljs-number">1.330</span></span> <span class="hljs-number"><span class="hljs-number">0.183456</span></span> ## productlineiPad mini <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1.59080</span></span> <span class="hljs-number"><span class="hljs-number">0.41737</span></span> <span class="hljs-number"><span class="hljs-number">3.811</span></span> <span class="hljs-number"><span class="hljs-number">0.000138</span></span> ## productlineiPad mini <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">2.19095</span></span> <span class="hljs-number"><span class="hljs-number">0.53456</span></span> <span class="hljs-number"><span class="hljs-number">4.099</span></span> <span class="hljs-number"><span class="hljs-number">4.16e-05</span></span> ## productlineiPad mini Retina <span class="hljs-number"><span class="hljs-number">3.22474</span></span> <span class="hljs-number"><span class="hljs-number">1.12022</span></span> <span class="hljs-number"><span class="hljs-number">2.879</span></span> <span class="hljs-number"><span class="hljs-number">0.003993</span></span> ## productlineUnknown <span class="hljs-number"><span class="hljs-number">0.38217</span></span> <span class="hljs-number"><span class="hljs-number">0.39224</span></span> <span class="hljs-number"><span class="hljs-number">0.974</span></span> <span class="hljs-number"><span class="hljs-number">0.329891</span></span> ## is_descrTRUE <span class="hljs-number"><span class="hljs-number">0.17209</span></span> <span class="hljs-number"><span class="hljs-number">0.25616</span></span> <span class="hljs-number"><span class="hljs-number">0.672</span></span> <span class="hljs-number"><span class="hljs-number">0.501722</span></span> ## <span class="hljs-type"><span class="hljs-type">box</span></span> <span class="hljs-number"><span class="hljs-number">-0.78668</span></span> <span class="hljs-number"><span class="hljs-number">0.48127</span></span> <span class="hljs-number"><span class="hljs-number">-1.635</span></span> <span class="hljs-number"><span class="hljs-number">0.102134</span></span> ## condit <span class="hljs-number"><span class="hljs-number">-0.48478</span></span> <span class="hljs-number"><span class="hljs-number">0.29141</span></span> <span class="hljs-number"><span class="hljs-number">-1.664</span></span> <span class="hljs-number"><span class="hljs-number">0.096198</span></span> ## cosmet <span class="hljs-number"><span class="hljs-number">0.14377</span></span> <span class="hljs-number"><span class="hljs-number">0.44095</span></span> <span class="hljs-number"><span class="hljs-number">0.326</span></span> <span class="hljs-number"><span class="hljs-number">0.744385</span></span> ## devic <span class="hljs-number"><span class="hljs-number">-0.24391</span></span> <span class="hljs-number"><span class="hljs-number">0.41011</span></span> <span class="hljs-number"><span class="hljs-number">-0.595</span></span> <span class="hljs-number"><span class="hljs-number">0.552027</span></span> ## excel <span class="hljs-number"><span class="hljs-number">0.83784</span></span> <span class="hljs-number"><span class="hljs-number">0.47101</span></span> <span class="hljs-number"><span class="hljs-number">1.779</span></span> <span class="hljs-number"><span class="hljs-number">0.075268</span></span> ## fulli <span class="hljs-number"><span class="hljs-number">-0.58407</span></span> <span class="hljs-number"><span class="hljs-number">0.66039</span></span> <span class="hljs-number"><span class="hljs-number">-0.884</span></span> <span class="hljs-number"><span class="hljs-number">0.376464</span></span> ## <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>. <span class="hljs-number"><span class="hljs-number">-0.30290</span></span> <span class="hljs-number"><span class="hljs-number">0.59145</span></span> <span class="hljs-number"><span class="hljs-number">-0.512</span></span> <span class="hljs-number"><span class="hljs-number">0.608555</span></span> ## good <span class="hljs-number"><span class="hljs-number">0.78695</span></span> <span class="hljs-number"><span class="hljs-number">0.33903</span></span> <span class="hljs-number"><span class="hljs-number">2.321</span></span> <span class="hljs-number"><span class="hljs-number">0.020275</span></span> ## great <span class="hljs-number"><span class="hljs-number">0.46251</span></span> <span class="hljs-number"><span class="hljs-number">0.38946</span></span> <span class="hljs-number"><span class="hljs-number">1.188</span></span> <span class="hljs-number"><span class="hljs-number">0.235003</span></span> ## includ <span class="hljs-number"><span class="hljs-number">0.41626</span></span> <span class="hljs-number"><span class="hljs-number">0.42947</span></span> <span class="hljs-number"><span class="hljs-number">0.969</span></span> <span class="hljs-number"><span class="hljs-number">0.332421</span></span> ## ipad <span class="hljs-number"><span class="hljs-number">-0.31983</span></span> <span class="hljs-number"><span class="hljs-number">0.24420</span></span> <span class="hljs-number"><span class="hljs-number">-1.310</span></span> <span class="hljs-number"><span class="hljs-number">0.190295</span></span> ## item <span class="hljs-number"><span class="hljs-number">-0.08037</span></span> <span class="hljs-number"><span class="hljs-number">0.35025</span></span> <span class="hljs-number"><span class="hljs-number">-0.229</span></span> <span class="hljs-number"><span class="hljs-number">0.818501</span></span> ## light <span class="hljs-number"><span class="hljs-number">0.32901</span></span> <span class="hljs-number"><span class="hljs-number">0.40187</span></span> <span class="hljs-number"><span class="hljs-number">0.819</span></span> <span class="hljs-number"><span class="hljs-number">0.412963</span></span> ## minor <span class="hljs-number"><span class="hljs-number">-0.27938</span></span> <span class="hljs-number"><span class="hljs-number">0.37600</span></span> <span class="hljs-number"><span class="hljs-number">-0.743</span></span> <span class="hljs-number"><span class="hljs-number">0.457462</span></span> ## <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-number"><span class="hljs-number">0.08576</span></span> <span class="hljs-number"><span class="hljs-number">0.38444</span></span> <span class="hljs-number"><span class="hljs-number">0.223</span></span> <span class="hljs-number"><span class="hljs-number">0.823479</span></span> ## scratch <span class="hljs-number"><span class="hljs-number">0.02037</span></span> <span class="hljs-number"><span class="hljs-number">0.26487</span></span> <span class="hljs-number"><span class="hljs-number">0.077</span></span> <span class="hljs-number"><span class="hljs-number">0.938712</span></span> ## screen <span class="hljs-number"><span class="hljs-number">0.14372</span></span> <span class="hljs-number"><span class="hljs-number">0.28159</span></span> <span class="hljs-number"><span class="hljs-number">0.510</span></span> <span class="hljs-number"><span class="hljs-number">0.609773</span></span> ## use <span class="hljs-number"><span class="hljs-number">0.14769</span></span> <span class="hljs-number"><span class="hljs-number">0.21807</span></span> <span class="hljs-number"><span class="hljs-number">0.677</span></span> <span class="hljs-number"><span class="hljs-number">0.498243</span></span> ## wear <span class="hljs-number"><span class="hljs-number">-0.05187</span></span> <span class="hljs-number"><span class="hljs-number">0.40931</span></span> <span class="hljs-number"><span class="hljs-number">-0.127</span></span> <span class="hljs-number"><span class="hljs-number">0.899154</span></span> ## <span class="hljs-keyword"><span class="hljs-keyword">work</span></span> <span class="hljs-number"><span class="hljs-number">-0.25657</span></span> <span class="hljs-number"><span class="hljs-number">0.29441</span></span> <span class="hljs-number"><span class="hljs-number">-0.871</span></span> <span class="hljs-number"><span class="hljs-number">0.383509</span></span> ## ## (Intercept) ## biddable *** ## startprice *** ## conditionManufacturer refurbished ## conditionNew . ## conditionNew other (see details) . ## conditionSeller refurbished ## conditionUsed ## cellular1 ## cellularUnknown ## carrierNone ## carrierOther ## carrierSprint ## carrierT-Mobile ## carrierUnknown ## carrierVerizon ## colorGold ## colorSpace Gray ## colorUnknown ## colorWhite ## storage16 * ## storage32 * ## storage64 ## storageUnknown ## productlineiPad <span class="hljs-number"><span class="hljs-number">2</span></span> ## productlineiPad <span class="hljs-number"><span class="hljs-number">3</span></span> * ## productlineiPad <span class="hljs-number"><span class="hljs-number">4</span></span> * ## productlineiPad <span class="hljs-number"><span class="hljs-number">5</span></span> ## productlineiPad Air *** ## productlineiPad Air <span class="hljs-number"><span class="hljs-number">2</span></span> *** ## productlineiPad mini ## productlineiPad mini <span class="hljs-number"><span class="hljs-number">2</span></span> *** ## productlineiPad mini <span class="hljs-number"><span class="hljs-number">3</span></span> *** ## productlineiPad mini Retina ** ## productlineUnknown ## is_descrTRUE ## <span class="hljs-type"><span class="hljs-type">box</span></span> ## condit . ## cosmet ## devic ## excel . ## fulli ## <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>. ## good * ## great ## includ ## ipad ## item ## light ## minor ## <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ## scratch ## screen ## use ## wear ## <span class="hljs-keyword"><span class="hljs-keyword">work</span></span> ## <span class="hljs-comment"><span class="hljs-comment">--- ## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 1798.8 on 1302 degrees of freedom ## Residual deviance: 1168.8 on 1247 degrees of freedom ## AIC: 1280.8 ## ## Number of Fisher Scoring iterations: 13</span></span></code> </pre><br>  It can be seen that for a simple logistic model there are few significant variables in the data <br><br>  We estimate the <b>AUC</b> on the test data.  For this we use the library <b>ROCR</b> <br><br><pre> <code class="hljs pgsql">library(ROCR) ## Loading required package: gplots ## ## Attaching package: <span class="hljs-string"><span class="hljs-string">'gplots'</span></span> ## ## The <span class="hljs-keyword"><span class="hljs-keyword">following</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> masked <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'package:stats'</span></span>: ## ## lowess predict_glm &lt;- predict(model_glm1, newdata = test, <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> = "response" ) ROCRpred = prediction(predict_glm, test$sold) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.numeric(performance(ROCRpred, "auc")@y.<span class="hljs-keyword"><span class="hljs-keyword">values</span></span>) ## [<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-number"><span class="hljs-number">0.8592183</span></span></code> </pre><br>  The result obtained using this model is already very good, but it is necessary to compare it with the estimates of other models. <br><br><h3>  Classification trees (CART model) </h3><br>  Now look at the results obtained using the <b>CART</b> model. <br><pre> <code class="hljs lisp">library(<span class="hljs-name"><span class="hljs-name">rpart</span></span>) library(<span class="hljs-name"><span class="hljs-name">rpart</span></span>.plot) model_cart1 &lt;- rpart(<span class="hljs-name"><span class="hljs-name">sold</span></span> ~ ., data = train, method = <span class="hljs-string"><span class="hljs-string">"class"</span></span>) prp(<span class="hljs-name"><span class="hljs-name">model_cart1</span></span>)</code> </pre><br><img src="https://habrastorage.org/files/f03/dbe/2e4/f03dbe2e4c98450ebc57d82a827aa069.png"><br><br><pre> <code class="hljs bash">predict_cart &lt;- predict(model_cart1, newdata = <span class="hljs-built_in"><span class="hljs-built_in">test</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> = <span class="hljs-string"><span class="hljs-string">"prob"</span></span>)[,2] ROCRpred = prediction(predict_cart, <span class="hljs-built_in"><span class="hljs-built_in">test</span></span><span class="hljs-variable"><span class="hljs-variable">$sold</span></span>) as.numeric(performance(ROCRpred, <span class="hljs-string"><span class="hljs-string">"auc"</span></span>)@y.values) <span class="hljs-comment"><span class="hljs-comment">## [1] 0.8222028</span></span></code> </pre><br>  The model makes the assessment worse than the previous one.  Let's try to improve the results using the selection of parameters by <b>cross-validation</b> .  We will select the parameter <b>cp</b> , which determines the complexity of the model <br><br><pre> <code class="hljs vhdl"><span class="hljs-keyword"><span class="hljs-keyword">library</span></span>(caret) ## Loading required <span class="hljs-keyword"><span class="hljs-keyword">package</span></span>: lattice ## Loading required <span class="hljs-keyword"><span class="hljs-keyword">package</span></span>: ggplot2 ## ## Attaching <span class="hljs-keyword"><span class="hljs-keyword">package</span></span>: <span class="hljs-symbol"><span class="hljs-symbol">'ggplot2</span></span>' ## ## The following object <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> masked from <span class="hljs-symbol"><span class="hljs-symbol">'package</span></span>:NLP': ## ## annotate <span class="hljs-keyword"><span class="hljs-keyword">library</span></span>(e1071) tr.control = trainControl(method = <span class="hljs-string"><span class="hljs-string">"cv"</span></span>, number = <span class="hljs-number"><span class="hljs-number">10</span></span>) cpGrid = expand.grid( .cp = seq(<span class="hljs-number"><span class="hljs-number">0.0001</span></span>,<span class="hljs-number"><span class="hljs-number">0.01</span></span>,<span class="hljs-number"><span class="hljs-number">0.001</span></span>)) train(sold ~ ., data = train, method = <span class="hljs-string"><span class="hljs-string">"rpart"</span></span>, trControl = tr.control, tuneGrid = cpGrid ) ## CART ## ## <span class="hljs-number"><span class="hljs-number">1303</span></span> samples ## <span class="hljs-number"><span class="hljs-number">29</span></span> predictor ## <span class="hljs-number"><span class="hljs-number">2</span></span> classes: <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span> ## ## No pre-processing ## Resampling: Cross-Validated (<span class="hljs-number"><span class="hljs-number">10</span></span> fold) ## ## Summary <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> sample sizes: <span class="hljs-number"><span class="hljs-number">1173</span></span>, <span class="hljs-number"><span class="hljs-number">1172</span></span>, <span class="hljs-number"><span class="hljs-number">1172</span></span>, <span class="hljs-number"><span class="hljs-number">1173</span></span>, <span class="hljs-number"><span class="hljs-number">1173</span></span>, <span class="hljs-number"><span class="hljs-number">1173</span></span>, ... ## ## Resampling results across tuning parameters: ## ## cp Accuracy Kappa Accuracy SD Kappa SD ## <span class="hljs-number"><span class="hljs-number">0.0001</span></span> <span class="hljs-number"><span class="hljs-number">0.7674163</span></span> <span class="hljs-number"><span class="hljs-number">0.5293876</span></span> <span class="hljs-number"><span class="hljs-number">0.02132149</span></span> <span class="hljs-number"><span class="hljs-number">0.04497423</span></span> ## <span class="hljs-number"><span class="hljs-number">0.0011</span></span> <span class="hljs-number"><span class="hljs-number">0.7743335</span></span> <span class="hljs-number"><span class="hljs-number">0.5430455</span></span> <span class="hljs-number"><span class="hljs-number">0.01594698</span></span> <span class="hljs-number"><span class="hljs-number">0.03388680</span></span> ## <span class="hljs-number"><span class="hljs-number">0.0021</span></span> <span class="hljs-number"><span class="hljs-number">0.7896359</span></span> <span class="hljs-number"><span class="hljs-number">0.5714294</span></span> <span class="hljs-number"><span class="hljs-number">0.03938328</span></span> <span class="hljs-number"><span class="hljs-number">0.08143665</span></span> ## <span class="hljs-number"><span class="hljs-number">0.0031</span></span> <span class="hljs-number"><span class="hljs-number">0.7957780</span></span> <span class="hljs-number"><span class="hljs-number">0.5831451</span></span> <span class="hljs-number"><span class="hljs-number">0.04394428</span></span> <span class="hljs-number"><span class="hljs-number">0.09055433</span></span> ## <span class="hljs-number"><span class="hljs-number">0.0041</span></span> <span class="hljs-number"><span class="hljs-number">0.7919612</span></span> <span class="hljs-number"><span class="hljs-number">0.5748735</span></span> <span class="hljs-number"><span class="hljs-number">0.03867687</span></span> <span class="hljs-number"><span class="hljs-number">0.07958997</span></span> ## <span class="hljs-number"><span class="hljs-number">0.0051</span></span> <span class="hljs-number"><span class="hljs-number">0.7934997</span></span> <span class="hljs-number"><span class="hljs-number">0.5775611</span></span> <span class="hljs-number"><span class="hljs-number">0.03727279</span></span> <span class="hljs-number"><span class="hljs-number">0.07705049</span></span> ## <span class="hljs-number"><span class="hljs-number">0.0061</span></span> <span class="hljs-number"><span class="hljs-number">0.7888843</span></span> <span class="hljs-number"><span class="hljs-number">0.5678360</span></span> <span class="hljs-number"><span class="hljs-number">0.03868024</span></span> <span class="hljs-number"><span class="hljs-number">0.08040614</span></span> ## <span class="hljs-number"><span class="hljs-number">0.0071</span></span> <span class="hljs-number"><span class="hljs-number">0.7881210</span></span> <span class="hljs-number"><span class="hljs-number">0.5662543</span></span> <span class="hljs-number"><span class="hljs-number">0.03710725</span></span> <span class="hljs-number"><span class="hljs-number">0.07714919</span></span> ## <span class="hljs-number"><span class="hljs-number">0.0081</span></span> <span class="hljs-number"><span class="hljs-number">0.7888902</span></span> <span class="hljs-number"><span class="hljs-number">0.5678010</span></span> <span class="hljs-number"><span class="hljs-number">0.03657083</span></span> <span class="hljs-number"><span class="hljs-number">0.07592070</span></span> ## <span class="hljs-number"><span class="hljs-number">0.0091</span></span> <span class="hljs-number"><span class="hljs-number">0.7888902</span></span> <span class="hljs-number"><span class="hljs-number">0.5678010</span></span> <span class="hljs-number"><span class="hljs-number">0.03657083</span></span> <span class="hljs-number"><span class="hljs-number">0.07592070</span></span> ## ## Accuracy was used <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> the optimal model using the largest value. ## The final value used <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the model was cp = <span class="hljs-number"><span class="hljs-number">0.0031</span></span>.</code> </pre><br>  Insert the proposed value and evaluate the resulting model. <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">bestcp</span></span> &lt;- train(sold <span class="hljs-regexp"><span class="hljs-regexp">~ .,</span></span> data = train, method = <span class="hljs-string"><span class="hljs-string">"rpart"</span></span>, trControl = tr.control, tuneGrid = cpGrid )<span class="hljs-variable"><span class="hljs-variable">$bestTune</span></span> model_cart2 &lt;- rpart(sold <span class="hljs-regexp"><span class="hljs-regexp">~ .,</span></span> data = train, method = <span class="hljs-string"><span class="hljs-string">"class"</span></span>, cp = bestcp) predict_cart &lt;- predict(model_cart2, newdata = test, type = <span class="hljs-string"><span class="hljs-string">"prob"</span></span>)[,<span class="hljs-number"><span class="hljs-number">2</span></span>] ROCRpred = prediction(predict_cart, test<span class="hljs-variable"><span class="hljs-variable">$sold</span></span>) as.numeric(performance(ROCRpred, <span class="hljs-string"><span class="hljs-string">"auc"</span></span>)<span class="hljs-variable"><span class="hljs-variable">@y</span></span>.values) <span class="hljs-comment"><span class="hljs-comment">## [1] 0.8021447</span></span></code> </pre><br><h3>  Random forest </h3><br>  Let's look at the results of the most difficult model in theory, but very simple to use - <b>Random Forest</b> <br><br><pre> <code class="hljs pgsql">library(randomForest) ## randomForest <span class="hljs-number"><span class="hljs-number">4.6</span></span><span class="hljs-number"><span class="hljs-number">-10</span></span> ## <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> rfNews() <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> see <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> features/changes/bug fixes. ## ## Attaching package: <span class="hljs-string"><span class="hljs-string">'randomForest'</span></span> ## ## The <span class="hljs-keyword"><span class="hljs-keyword">following</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> masked <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'package:dplyr'</span></span>: ## ## combine <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>.seed(<span class="hljs-number"><span class="hljs-number">1000</span></span>) model_rf &lt;- randomForest(sold ~ ., data = train, importance = T) predict_rf &lt;- predict(model_rf, newdata = test, <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> = "prob")[,<span class="hljs-number"><span class="hljs-number">2</span></span>] ROCRpred = prediction(predict_rf, test$sold) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.numeric(performance(ROCRpred, "auc")@y.<span class="hljs-keyword"><span class="hljs-keyword">values</span></span>) ## [<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-number"><span class="hljs-number">0.8576486</span></span></code> </pre><br>  As you can see, the model already shows the best results of all used.  Let's try to improve it by eliminating unnecessary variables.  The presence of a built-in assessment of the importance of variables in the model will help us. <br><br><pre> <code class="hljs lisp">varImpPlot(<span class="hljs-name"><span class="hljs-name">model_rf</span></span>)</code> </pre><br><img src="https://habrastorage.org/files/770/47d/20e/77047d20e717424090d369134b33372d.png"><br><br>  On the left graph, we see that there is a feature that does not improve the quality of the model.  Remove it and evaluate the resulting model. <br><br><pre> <code class="hljs sql">set.seed(<span class="hljs-number"><span class="hljs-number">1000</span></span>) model_rf2 &lt;- randomForest(sold ~ .-excel, <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> = train, importance = T) predict_rf &lt;- predict(model_rf2, newdata = <span class="hljs-keyword"><span class="hljs-keyword">test</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> = <span class="hljs-string"><span class="hljs-string">"prob"</span></span>)[,<span class="hljs-number"><span class="hljs-number">2</span></span>] ROCRpred = <span class="hljs-keyword"><span class="hljs-keyword">prediction</span></span>(predict_rf, <span class="hljs-keyword"><span class="hljs-keyword">test</span></span>$sold) as.numeric(<span class="hljs-keyword"><span class="hljs-keyword">performance</span></span>(ROCRpred, <span class="hljs-string"><span class="hljs-string">"auc"</span></span>)@y.values) <span class="hljs-comment"><span class="hljs-comment">## [1] 0.8566796</span></span></code> </pre><br>  The assessment showed that there was no improvement in the model, but, based on common sense, I believe that having the word <b>excel</b> in the product description is unlikely to affect sales, and simplifying the model (without significant damage to quality) improves its interpretation. <br><br>  Thus, the best results from all the models studied were logistic regression.  As a result, on the Public Board (50% estimate of all available test data), the model with a score of 0.84724 ranked 211 out of 1884, but dropped to 1291 in the final protocol. <br><br>  Next time I plan to talk about how the quality of the model is influenced by the size of the training sample using the example of the <a href="https://www.kaggle.com/c/digit-recognizer">Digit Recognizer</a> task, and the application of the principal component method in the same task.  Then I will talk about the experience of participating in the <a href="https://www.kaggle.com/c/word2vec-nlp-tutorial">Bag of Words Meets Bags of Popcorn</a> competition, as well as a long study in the well-known task <a href="https://www.kaggle.com/c/titanic">Titanic: Machine Learning from Disaster</a> , in which I will tell you about how knowledge about Titanic and the catastrophe help solve the problem. <br><br>  And finally, I recommend to sign up for the guys on the <a href="http://dscourse.mlclass.ru/">course on data analysis</a> .  In my experience: <br><br><ul><li>  Only useful practical methods are given. </li><li>  The emphasis is on the result to be achieved in the tasks, and not just the solution </li><li>  Really motivates and makes a lot of work </li></ul><br><br>  See you! </div><p>Source: <a href="https://habr.com/ru/post/266421/">https://habr.com/ru/post/266421/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../266411/index.html">Using the Java native library on application servers</a></li>
<li><a href="../266413/index.html">Microsoft Useful Resources for IT Professionals</a></li>
<li><a href="../266415/index.html">Protection of corporate applications: how to become a developer of PT Application Firewall</a></li>
<li><a href="../266417/index.html">Release it! Software design and design for those who care</a></li>
<li><a href="../266419/index.html">Organization of monitoring the work of employees in a small office</a></li>
<li><a href="../266425/index.html">Magnetic core memory module in an IBM 1401 vintage mainframe</a></li>
<li><a href="../266427/index.html">Implementation of multi-threaded game engine architecture</a></li>
<li><a href="../266429/index.html">Joint editing. Part 2</a></li>
<li><a href="../266431/index.html">Extortionist Android / Lockerpin.A attacks US users</a></li>
<li><a href="../266433/index.html">Developing a metamodel using the Eclipse Modeling Framework (and a little about data modeling)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>