<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How much information can be transmitted through the CPU fan</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="15 bits per minute 


 Removal of information from an isolated computer that is not connected to the network (air-gapped) is a difficult but interesti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How much information can be transmitted through the CPU fan</h1><div class="post__text post__text-html js-mediator-article"><h3>  15 bits per minute </h3><br><img src="https://habrastorage.org/files/3fe/31b/acf/3fe31bacf7824310af34edfb6c5cd6d9.jpg"><br><br>  Removal of information from an isolated computer that is not connected to the network (air-gapped) is a difficult but interesting task.  Over the past ten years, several methods have been developed for such data exfiltration: for example, recording electromagnetic radiation from a video card and various components on the motherboard <a name="1_1"></a>  <a href="https://habr.com/ru/post/395417/">[1]</a> , <a name="2_2"></a>  <a href="https://habr.com/ru/post/395417/">[2]</a> <a name="3_3"></a>  <a href="https://habr.com/ru/post/395417/">[3]</a> , <a name="4_4"></a>  <a href="https://habr.com/ru/post/395417/">[4]</a> , recognition of keystrokes by sound, shooting information on the optical <a name="5_5"></a>  <a href="https://habr.com/ru/post/395417/">[5]</a> and thermal <a name="6_6"></a>  <a href="https://habr.com/ru/post/395417/">[6]</a> channels, audio transmission through speakers in audible and inaudible frequency ranges <a name="7_7"></a>  <a href="https://habr.com/ru/post/395417/">[7]</a> , <a name="8_8"></a>  <a href="https://habr.com/ru/post/395417/">[8]</a> <a name="9_9"></a>  <a href="https://habr.com/ru/post/395417/">[9]</a> , radio transmission from monitor to AM radio receiver <a name="10_10"></a>  <a href="https://habr.com/ru/post/395417/">[10]</a> and others. <br><br>  But it never occurred to anyone to transmit the flow of information by <a href="https://arxiv.org/ftp/arxiv/papers/1606/1606.05915.pdf">changing the speed of the fan</a> .  But this seems like a trivial idea. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A malicious software system called <a href="https://arxiv.org/ftp/arxiv/papers/1606/1606.05915.pdf">Fansmitter was</a> developed by Andrei Daidakulov, Iosef Solevich, Yuval Elovichi and Mordechai Guri from the Research Center for Computer Security at <a href="http://in.bgu.ac.il/en/Pages/default.aspx">Ben Gurion University</a> . <br><a name="habracut"></a><br>  Removing information through a computer fan has one main advantage - there is such a fan in every desktop computer.  True, it is absent in some modern notebook models, but such gadgets are still rare at nuclear facilities and other protected facilities in Russia and abroad.  There are usually installed the most simple and reliable personal computers with a standard system unit. <br><br><img src="https://habrastorage.org/files/52b/ec6/75c/52bec675c1bf4a3383d57fc1b947b8b4.jpg"><br><br>  Thus, the Fansmitter malware will work on virtually any PC, even if it does not have speakers and a microphone (audio-gap).  In addition, the sound system can be turned off at the BIOS level to prevent accidental or intentional connection of external speakers to the audio jack.  Turning off the audio system is very effective against conventional acoustic data exfiltration.  But not against the Fansmitter.  In this case, acoustic exfiltration does not involve the computer‚Äôs sound subsystem. <br><br>  Signal transmission occurs through a change in the rotational speed of the fans on the processor.  With a change in the speed of rotation, the sound characteristics also change.  Information is recorded by a remote microphone at a distance of several meters, for example, a regular telephone. <br><br><img src="https://habrastorage.org/files/195/2b9/2de/1952b92de62a4b59b019008c9d33132d.jpg"><br><br>  If we classify various methods of exfiltration of data from an isolated computer, then Fansmitter is the fifth class of such methods, along with electromagnetic radiation, optical pickup (on LEDs), thermal and acoustic. <br><br>  For a successful attack, Fansmitter needs to infect the victim‚Äôs computer and mobile phone directly.  If there are no problems with the phone, then installing a malicious program on an isolated PC is the most difficult part of a hypothetical attack.  Of course, the researchers do not pay attention to practical methods of installing malware on an isolated PC, but only talk about the technical part of the task, that is, directly about the methods of encoding digital data decoding through fan noise. <br><br>  On modern computers, the CPU and system unit fans are usually controlled via a four-pin cable.  The purpose of each contact is shown in the table. <br><br><table><tbody><tr><th>  Contact </th><th>  Designation </th><th>  Function </th></tr><tr><td>  1 (red) </td><td>  GROUND </td><td>  Land </td></tr><tr><td>  2 (black) </td><td>  12 v </td><td>  Power 12 volts </td></tr><tr><td>  3 (black) </td><td>  FAN_TACH </td><td>  Outgoing fan speed signal </td></tr><tr><td>  4 (yellow) </td><td>  FAN_CONTROL </td><td>  Input signal to indicate fan speed </td></tr></tbody></table><br>  As you can see, the third cable constantly transmits a signal to the motherboard about the fan speed.  The fourth cable transmits instructions to change the rotation speed using the pulse-width modulation signal (PWM) <a name="11_11"></a>  <a href="https://habr.com/ru/post/395417/">[11]</a> .  In older computers, the fourth cable is missing and the fan speed is not adjustable. <br><br>  Changing the fan speed is carried out automatically or manually.  In the latter case, this is done through the BIOS or by means of the operating system.  There are several proprietary and open source programs for controlling and measuring the fan speed on various motherboards for Windows, Linux and macOS <a name="12_12"></a>  <a href="https://habr.com/ru/post/395417/">[12]</a> <a name="13_13"></a>  <a href="https://habr.com/ru/post/395417/">[13]</a> <a name="14_14"></a>  <a href="https://habr.com/ru/post/395417/">[14]</a> . <br><br>  It is known that with increasing fan speed increases its volume (acoustic noise).  The diagram shows the graph of the perceived volume of the processor fan when the rotational speed changes from 1000 to 4500 RPM and back, from a distance of 1 meter (top) and 4 meters (bottom).  In both cases, the sound is recorded by a mobile phone microphone. <br><br><img src="https://habrastorage.org/files/c47/61e/6cf/c4761e6cf7284e44b7580b9163cfa091.png"><br><br>  The volume may vary for different fan models, but the basic trend remains the same: the faster the fan rotates, the greater the noise. <br><br>  In addition, with a change in the rotational speed, the pitch also changes - Blade pass frequency (BPF). <br><br>  BPF (in Hertz) is measured by multiplying the number of blades ( <i>n</i> ) by the rotation speed <i>R</i> in revolutions per minute (RPM), so that <br><br>  <i>BPF = n * R / 60</i> <br><br>  The graph shows a typical fan noise spectrum of about 1000 RPM. <br><br><img src="https://habrastorage.org/files/fb8/490/efc/fb8490efcc234d87ab6e5ea57dcfb2ea.png"><br><br>  To analyze the audio signal, the sampling rate for simplicity was reduced from 44.1 kHz to 2 kHz and the signal was filtered in the necessary BPF bands.  Thus, it turned out to make a table of which rotational speed corresponds to which BPF, for example, for a seven blade fan (in the table). <br><br><table><tbody><tr><th>  R (RPM) </th><th>  BPF (Hz) </th></tr><tr><td>  1000-1600 </td><td>  116-187 </td></tr><tr><td>  1600-3000 </td><td>  187-350 </td></tr><tr><td>  2000-2500 </td><td>  233-292 </td></tr><tr><td>  4000-4500 </td><td>  466-525 </td></tr></tbody></table><br>  Unfortunately, frequencies in areas of 100-600 Hz are distinguishable by the human ear, so that the victim of an attack can catch the change in frequency by ear.  The authors of the scientific work recommend using several methods to conceal an attack: 1) to conduct it at a time when the probability of the presence of a person is minimal;  2) use the lowest possible frequency of 140-170 Hz;  3) use close frequency ranges, with a difference of no more than 100 Hz between 0 and 1. <br><br>  To modulate the signal, the researchers used two methods: amplitude modulation (Amplitude Shift Keying, ASK) and frequency modulation Frequency Shift Keying (FSK).  The first method is more versatile and fits almost all fans, while the second method is more resistant to ambient noise.  In both cases, the values ‚Äã‚Äã0 and 1 are transmitted by changing the fan rotation speed, but the variable parameter of the carrier signal is in the first case its amplitude, and in the second case the frequency of the carrier oscillation. <br><br>  The diagrams below show the difference in the recorded signal, which is transmitted by the method of amplitude modulation (above) and frequency modulation (below).  In both cases, the signal 101010 is transmitted with a time frame of 5 seconds when the fan speed changes between 1000 RPM and 1600 RPM.  In the first case, the transfer was carried out within 60 seconds, in the second case - 150 seconds. <br><br><img src="https://habrastorage.org/files/f38/dfb/893/f38dfb8934c84e06828d7a5dbd9dcf13.png"><br>  <i>Amplitude modulation</i> <br><br><img src="https://habrastorage.org/files/55c/903/113/55c9031134944a8a961ded2663569198.png"><br>  <i>Frequency modulation</i> <br><br>  The researchers propose to use the method of dynamic synchronization during data transmission to eliminate errors when the receiver and transmitter change their location relative to each other during transmission.  With dynamic synchronization, a 4-bit control frame is transmitted before each 12-bit frame of payload. <br><br>  The researchers developed a data exfiltration method on a Dell OptiPlex 9020 computer with an Intel Core i7-4790 motherboard and an Intel Q87 (Lynx Point) chipset.  As already mentioned, the method is universal and can be used with computers of different models. <br><br>  The Samsung Galaxy S4 (I9500) mobile phone was used as a signal receiver. <br><br>  The experiment was conducted in a laboratory with a standard level of ambient noise, where several other computers and air conditioning systems operated. <br><br>  The experiment showed that the speed of data transmission through the fan strongly depends on the signal-to-noise ratio (SNR).  The stronger the ambient noise in relation to the useful signal - the lower the transmission rate. <br><br>  This is how payload transmission looks like a sequence of bits 01010101 with different transmission parameters and at different distances between the receiver and transmitter. <br><br>  <b>Distance of 1 meter, fan rotation speed 1000-1600 RPM, B-FSK modulation method.</b>  <b>The effective transfer rate is 3 bits per minute.</b> <br><img src="https://habrastorage.org/files/6ed/859/d6e/6ed859d6e2d04752a5b75e1309495857.png"><br><br>  <b>Distance 1 meter, fan speed 4000-4250 RPM, modulation method B-FSK.</b>  <b>The effective transfer rate is 15 bits per minute.</b> <br><img src="https://habrastorage.org/files/cc7/f25/a56/cc7f25a563a1409580924d312dc86565.png"><br><br>  <b>4 meters distance, fan rotation speed 2000-2500 RPM, B-FSK modulation method.</b>  <b>The effective transfer rate is 10 bits per minute.</b> <br><img src="https://habrastorage.org/files/f4f/661/856/f4f66185644e46a9b659a1ef73f79515.png"><br><br>  In the experiment, we managed to record and decode the signal from a mobile phone at a distance of up to 8 meters.  Of course, the SNR level will be much higher if you use directional microphones and other specialized equipment. <br><br><h3>  Literature </h3><br> <sup><a name="1"></a></sup>  <sup>[1] MG Kuhn and RJ Anderson, "Soft Tempest: Hidden data transmission using electromagnetic emanations," <i>Information hiding</i> , Springer-Verlag, 1998, pp.</sup>  <sup>124-142.</sup>  <sup><a href="https://habr.com/ru/post/395417/" title="back to article">Back to article</a></sup> <sup><br><br><a name="2"></a></sup>  <sup>[2] MG Kuhn, ‚ÄúCompromising emanations: Escaping risks for computer displays‚Äù, University of Cambridge, Computer Laboratory, 2003. <a href="https://habr.com/ru/post/395417/" title="back to article">Return to article</a></sup> <sup><br><br><a name="3"></a></sup>  <sup>[3] M. Vuagnoux and S. Pasini, "Compromising Electromagnetic Wiring and Wireless Keyboards" <i>USENIX security symposium</i> , 2009. <a href="https://habr.com/ru/post/395417/" title="back to article">Return to article</a></sup> <sup><br><br><a name="4"></a></sup>  <sup>[4] M. Guri, A. Kachlon, O. Hasson, G. Kedma, Y. Mirsky and Y. Elovici, "GSMem: Data Exfiltration from Air-Gapped Computers over GSM Frequencies," Washington, DC, 2015. <a href="https://habr.com/ru/post/395417/" title="back to article">Back to article</a></sup> <sup><br><br><a name="5"></a></sup>  <sup>[5] J. Loughry and AD Umphress, ‚ÄúInformation leakage from optical emanations,‚Äù <i>ACM Transactions</i> , vol.</sup>  <sup>5, no.</sup>  <sup>3, pp.</sup>  <sup>262-289, 2002. <a href="https://habr.com/ru/post/395417/" title="back to article">Back to article</a></sup> <sup><br><br><a name="6"></a></sup>  <sup>[6] M. Guri, M. Monitz, Y. Mirski and Y. Elovici, ‚ÄúBitWhisper: Covert Signing Channels between Air-Gapped Computers using Thermal Manipulations,‚Äù in <i>Computer Security Foundations Symposium (CSF), IEEE</i> 2015. <a href="https://habr.com/ru/post/395417/" title="back to article">Back to article</a></sup> <sup><br><br><a name="7"></a></sup>  <sup>[7] VTM t.</sup>  <sup>CA-GS f.</sup>  <sup>PN Attack, ‚ÄúEunchong Lee;</sup>  <sup>Hyunsoo Kim;</sup>  <sup>Ji Won Yoon, <i>Information Security Applications</i> , vol.</sup>  <sup>9503, pp.</sup>  <sup>187-199, 2015. <a href="https://habr.com/ru/post/395417/" title="back to article">Return to article</a></sup> <sup><br><br><a name="8"></a></sup>  <sup>[8] M. Hanspach and M. Goetz, ‚ÄúOn Covert Acoustical Mesh Networks in Air‚Äù, <i>Journal of Communications</i> , vol.</sup>  <sup>8, 2013. <a href="https://habr.com/ru/post/395417/" title="back to article">Return to article</a></sup> <sup><br><br><a name="9"></a></sup>  <sup>[9] A. Madhavapeddy, R. Sharp, D. Scott and A. Tse, ‚ÄúAudio networking: the forgotten wireless technology‚Äù, <i>Pervasive Computing, IEEE</i> , vol.</sup>  <sup>4, no.</sup>  <sup>3, 2008. <a href="https://habr.com/ru/post/395417/" title="back to article">Return to article</a></sup> <sup><br><br><a name="10"></a></sup>  <sup>[10] E. Thiele, Tempest for Eliza, 2001. [Online].</sup>  <sup>Available:</sup> <sup><br></sup>  <sup><a href="http://www.erikyyy.de/tempest/">www.erikyyy.de/tempest</a> .</sup>  <sup>[Accessed 4 10 2013].</sup>  <sup><a href="https://habr.com/ru/post/395417/" title="back to article">Back to article</a></sup> <sup><br><br><a name="11"></a></sup>  <sup>[11] Alfredo Milani Comparetti, ‚ÄúWhat is the PWM and what is the difference between Analog and Digital?‚Äù, 2004. [Online].</sup>  <sup>Available: <a href="http://www.almico.com/sfarticle.php%3Fid%3D1">www.almico.com/sfarticle.php?id=1</a> .</sup>  <sup><a href="https://habr.com/ru/post/395417/" title="back to article">Back to article</a></sup> <sup><br><br><a name="12"></a></sup>  <sup>[12] SpeedFan, [Online].</sup>  <sup>Available: <a href="http://www.almico.com/sfdownload.php">www.almico.com/sfdownload.php</a> .</sup>  <sup><a href="https://habr.com/ru/post/395417/" title="back to article">Back to article</a></sup> <sup><br><br><a name="13"></a></sup>  <sup>[13] Mac / SMC Fan Control for Windows (+ Temp), [Online].</sup>  <sup>Available: <a href="https://sourceforge.net/projects/macfan/">sourceforge.net/projects/macfan</a> .</sup>  <sup><a href="https://habr.com/ru/post/395417/" title="back to article">Back to article</a></sup> <sup><br><br><a name="14"></a></sup>  <sup>[14] "fanCON - Fan control for Linux systems", [Online].</sup>  <sup>Available: <a href="https://sourceforge.net/projects/fancon/">sourceforge.net/projects/fancon</a> .</sup>  <sup><a href="https://habr.com/ru/post/395417/" title="back to article">Back to article</a></sup> </div><p>Source: <a href="https://habr.com/ru/post/395417/">https://habr.com/ru/post/395417/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../395407/index.html">"Roscosmos" ordered the creation of a nuclear power plant for interplanetary flights</a></li>
<li><a href="../395409/index.html">New Shepard spacecraft successfully launched and landed for the fourth time.</a></li>
<li><a href="../395411/index.html">No one clicked on 6 out of 10 links on Twitter (they are retweeted instead)</a></li>
<li><a href="../395413/index.html">Oculus Rift developers without preliminary announcements removed DRM protection</a></li>
<li><a href="../395415/index.html">The 3DO Company and 3DO Interactive Multiplayer (Panasonic and not only)</a></li>
<li><a href="../395419/index.html">Ask Ethan # 61: how far does gravity go?</a></li>
<li><a href="../395421/index.html">Interrogation of counters technical accounting for GSM channel</a></li>
<li><a href="../395423/index.html">Hedgehog - a talking bird [if with an MP3 player]</a></li>
<li><a href="../395425/index.html">NASA Announces X-57 Maxwell Electric Aircraft</a></li>
<li><a href="../395427/index.html">The fall of Ethereum cryptocurrency and the dubious future of decentralized organizations</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>