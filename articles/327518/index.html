<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Let's talk about Teams</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A small interesting story about how the guys from Wrike integrated Microsoft Teams into their service and what it led to, as well as a big technical p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Let's talk about Teams</h1><div class="post__text post__text-html js-mediator-article">  A small interesting story about how the guys from Wrike integrated Microsoft Teams into their service and what it led to, as well as a big technical part about the integration process itself.  By the way, they were one of the first in the world to do this on the day of the release of the chat. <br><br><img src="https://habrastorage.org/files/0fb/453/c8d/0fb453c8d6be453589419c4dfc17d610.jpg"><br><a name="habracut"></a><br><h2>  1 + 1 = 3 </h2><br>  In our experience at <a href="https://wrike.com/ru/">Wrike</a> , potential buyers, choosing a project management system, are increasingly interested in available integrations.  In fact, from a pleasant bonus, the adaptation of the product to the existing ecosystem has become a factor that determines the choice of the client. <br><br>  Of course, it is important for developers to focus on the most common tools for corporate users, and here Microsoft products are inevitable priority.  However, it is even more important not to do integration for the sake of integration.  1 + 1 should give 3, in the sense that a bundle of solutions should create additional value for the client. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Therefore, we have consistently added integration with Azure Active Directory, OneDrive and Office 365 to our service. The ultimate goal of these steps is to create a seamless workspace where the user will not switch between applications and copy-paste information from one window to another every few minutes. tools and services for teamwork will not lie the abyss. <br><br>  MS Teams has become a logical new step.  53% of companies employing 500+ employees use corporate instant messengers ( <a href="https://community.spiceworks.com/research/business-chat-apps">SpiceWorks</a> data).  We thought that it would be convenient for users discussing the work to immediately implement the results of the discussion.  Therefore, together with Microsoft, the team selected the most appropriate service functions in such a situation and thought through their organic implementation in the Teams interface. <br><br>  As a result, Wrike users can now create projects and tasks directly from the messenger, and any project can now be added to Teams as a new tab.  Integration also supports making changes to the task (status, performer, deadline, comments) in parallel with the discussion. <br><br><img src="https://habrastorage.org/files/7a8/823/9bf/7a88239bf4424225b4eb06f522b65186.png"><br><br>  The discussions of the project have become more substantive and accurate, due to the possibility to show a Gantt chart with deadlines inside the messenger, so it is in front of the eyes of the participants in the discussion. <br><br><img src="https://habrastorage.org/files/062/230/3d2/0622303d2eb14197874df08bf04e64ef.png"><br><br>  And of course, an obvious opportunity was added - notifications for your tasks can now be received not only by email, but also by messages in Teams. <br><br>  The development of this functionality took 2 months.  During this time, the team has gained an interesting experience that may be useful for you. <br><br><h2>  On the technical side </h2><br>  Any tab application for Microsoft Teams consists of: <br><br><ul><li>  an archive with a manifest in which the manifest.json file and resource files are located; </li><li>  external HTTP service that processes requests for pages: configuration, tab main page, deletion. </li></ul><br>  All pages are rendered inside the Microsoft Teams iframe.  Examples of a manifest for a tab application are <a href="https://msdn.microsoft.com/en-us/microsoft-teams/tabs">described in MSDN</a> .  There you can also find <a href="https://msdn.microsoft.com/en-us/microsoft-teams/schema">a manifest scheme</a> .  At the time of this writing, the actual version of the scheme was 0.4. <br><br>  The main fields of the manifesto: <br><br><ul><li>  <code>Id</code> - GUID, must be unique for different applications or different environments. </li><li>  <code>Icons</code> - 44x44 and 88x88 resolution icons, each not more than 1.5 Kb. </li><li>  <code>configUrl</code> - the URL that users will see first.  It will start the application configuration. </li><li>  <code>canUpdateConfig</code> is a sign of whether users can change the configuration of an already added application. </li><li>  <code>needsIdentity</code> - allows you to get user information through Teams JS API. </li><li>  <code>validDomains</code> - an array of trusted domains, which should be our domain.  Wildcards are allowed. </li></ul><br>  After preparing the manifest and resources, the resulting archive can be <a href="https://msdn.microsoft.com/en-us/microsoft-teams/sideload">uploaded to Microsoft Teams</a> . <br><br>  Interaction with the infrastructure of Microsoft Teams is provided by the <a href="https://msdn.microsoft.com/en-us/microsoft-teams/jslibrary">Microsoft Teams JS API library</a> .  The library allows you to: <br><br><ul><li>  run authorization flow through Azure Oauth2 or any other Oauth2 provider; </li><li>  Get current user information, channel identifiers, teams and groups in terms of the Azure Active Directory; </li><li>  get and save tab settings; </li><li>  set event handlers for events: saving settings, changing the theme, deleting a tab; </li><li>  create and copy to the clipboard the link to the object selected in the tab. </li></ul><br>  To use the library, it is necessary to connect it and initialize it on each page of the application: <br><br><pre> <code class="javascript hljs">&lt;script src=<span class="hljs-string"><span class="hljs-string">"https://statics.teams.microsoft.com/sdk/v0.4/js/MicrosoftTeams.min.js"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ... &lt;script type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span>&gt; microsoftTeams.initialize(); <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Consider an example application for MsTeams with a multi-page configuration and linking Azure AD and <a href="https://wrike.com/ru/">Wrike</a> accounts. <br><br>  The specifics of the application in several iframes (configuration, tab) and with Oauth2 redirects require a sophisticated but typed flow for both the configuration and for displaying the application in a previously added tab. <br><br>  Main processes: <br><br><ol><li>  The user adds a new tab in Microsoft Teams. </li><li>  Unauthorized user comes to the previously added tab. </li><li>  An authorized user comes to the previously added tab. </li></ol><br>  The process of adding a tab is shown in the figure below.  Microsoft Teams pages are marked in blue, pages of our application are in green, code and request processing actions are shown in white. <br><br><img src="https://habrastorage.org/files/6d1/f6b/631/6d1f6b6317bc466ebd9cb9c2135432ba.png"><br><br>  The ‚ÄúWelcome page‚Äù page displays basic information about our application and the ‚ÄúConnect‚Äù button, which starts the authorization flow in Azure AD. <br><br>  Callback URL handler must: <br><br><ul><li>  Request user information in Azure AD (for example, through the <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-graph-api">Microsoft Azure AD Graph API</a> ). </li><li>  Decide what to do with the received information: create a new account in our system or use an existing one. </li><li>  "Log in" the user to our system, for example, issuing a session cookie. </li><li>  In case of successful authorization, the Callback URL page should simply close, since authorization starts in a new window, and Callback is the end point of authorization. </li><li>  In case of unsuccessful authorization, the Callback URL page can show the user the reason for the failure, for example, the user‚Äôs refusal to provide access, the lack of access to an Azure application, and so on. </li></ul><br>  The ‚ÄúSetup page‚Äù page is a settings page.  It is requested when adding a tab and through the ‚ÄúConfiguration‚Äù option in the menu of a previously added tab (if the manifest was set to <code>canUpdateConfig</code> ). <br><br>  Sample code to run Oauth2 authentication through a multi-tenant application in Azure AD (that is, the sample code for the Welcome page) looks like this: <br><br><pre> <code class="javascript hljs">&lt;script src=<span class="hljs-string"><span class="hljs-string">"https://statics.teams.microsoft.com/sdk/v0.4/js/MicrosoftTeams.min.js"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;input type=<span class="hljs-string"><span class="hljs-string">"button"</span></span> onclick=<span class="hljs-string"><span class="hljs-string">"startAuth()"</span></span> value=<span class="hljs-string"><span class="hljs-string">"..."</span></span>/&gt; &lt;script type="text/javascript"&gt; microsoftTeams.initialize(); var startAuth = function() { microsoftTeams.authentication.authenticate({ url: 'https://login.windows.net/common/oauth2/authorize' + '?response_type=code%20id_token' + '&amp;scope=openid' + '&amp;response_mode=' + form_post + '&amp;client_id=' + &lt;YOUR_AZURE_APP_CLIENT_ID&gt; + '&amp;resource=https%3a%2f%2fgraph.windows.net' + '&amp;nonce=' + &lt;MS_NONCE&gt; + '&amp;state=' + &lt;OAUTH2_STATE&gt; + '&amp;redirect_uri=' + encodeURIComponent('http://localhost/callback'), width: 700, height: 500, successCallback: onAuthSuccess, failureCallback: onAuthFailure }); }; var onAuthSuccess = function() { console.log('Auth success'); document.location.href='http://localhost/setup'; }; var onAuthFailure = function() { console.log('Auth failed'); microsoftTeams.settings.setValidityState(false); }; &lt;/script&gt;</code> </pre><br>  Options: <br><br><ul><li>  <code>redirect_uri</code> - URL of the callback handler, in which GET request idToken will be passed.  On it you will be able to get access token, refresh token and user information for linking an account from Azure AD to an account in our system. </li><li>  <code>YOUR_AZURE_APP_CLIENT_ID</code> - application identifier. </li><li>  <code>MS_NONCE</code> - randomly generated nonce, analogue of state for Azure Oauth2. </li><li>  <code>OAUTH2_STATE</code> - Oauth2 state, which needs to be checked in the callback handler. </li></ul><br>  The launch of flow-authorization is provided by the <code>microsoftTeams.authenticate</code> method from Teams JS API.  You do not need to explicitly call <code>window.open</code> .  The <code>onAuthSuccess</code> , <code>onAuthFailure</code> are called in the context of the source page, from where the login window was opened. <br><br>  A safer and more reliable timeout method to start <code>Oauth2 flow</code> involves a request to our handler, which will generate <code>OAUTH2_STATE</code> and redirect the user to <a href="https://login.windows.net/">login.windows.net</a> . <br><br>  Detailed information on creating and configuring applications for Azure AD can be read <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-integrating-applications">here</a> . <br><br>  An example of a code page ‚ÄúSetup page‚Äù for saving settings is shown below. <br><br><pre> <code class="javascript hljs">&lt;script src=<span class="hljs-string"><span class="hljs-string">"https://statics.teams.microsoft.com/sdk/v0.4/js/MicrosoftTeams.min.js"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;input id=<span class="hljs-string"><span class="hljs-string">"name"</span></span> type=<span class="hljs-string"><span class="hljs-string">"text"</span></span> placeholder=<span class="hljs-string"><span class="hljs-string">"Enter your name"</span></span> onkeyup=<span class="hljs-string"><span class="hljs-string">"validate()"</span></span>/&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="actionscript"><span class="xml"><span class="actionscript"> microsoftTeams.initialize(); </span></span><span class="hljs-keyword"><span class="xml"><span class="actionscript"><span class="hljs-keyword">var</span></span></span></span><span class="xml"><span class="actionscript"> isNameValid = </span></span><span class="hljs-function"><span class="hljs-keyword"><span class="xml"><span class="actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span></span><span class="hljs-params"><span class="xml"><span class="actionscript"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span></span><span class="xml"><span class="actionscript"><span class="hljs-function"> </span></span></span></span><span class="xml"><span class="actionscript">{ </span></span><span class="hljs-keyword"><span class="xml"><span class="actionscript"><span class="hljs-keyword">return</span></span></span></span><span class="xml"><span class="actionscript"> jQuery(</span></span><span class="hljs-string"><span class="xml"><span class="actionscript"><span class="hljs-string">'#name'</span></span></span></span><span class="xml"><span class="actionscript">).val().trim().length &gt; </span></span><span class="hljs-number"><span class="xml"><span class="actionscript"><span class="hljs-number">0</span></span></span></span><span class="xml"><span class="actionscript">; } </span></span><span class="hljs-keyword"><span class="xml"><span class="actionscript"><span class="hljs-keyword">var</span></span></span></span><span class="xml"><span class="actionscript"> validate = </span></span><span class="hljs-function"><span class="hljs-keyword"><span class="xml"><span class="actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span></span><span class="hljs-params"><span class="xml"><span class="actionscript"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span></span><span class="xml"><span class="actionscript"><span class="hljs-function"> </span></span></span></span><span class="xml"><span class="actionscript">{ </span></span><span class="hljs-comment"><span class="xml"><span class="actionscript"><span class="hljs-comment">//    Save microsoftTeams.settings.setValidityState(isNameValid()); }; microsoftTeams.settings.registerOnSaveHandler(function (saveEvent) { if (!isNameValid()) { saveEvent.notifyFailure("We couldn't save your tab settings. Please enter your name."); return; } microsoftTeams.settings.setSettings({ contentUrl: 'http://localhost/tabContent', suggestedDisplayName: "Your Tab Name", websiteUrl: "http://localhost" }); saveEvent.notifySuccess(); }); </span></span></span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Options: <br><br><ul><li>  <code>contentUrl</code> - the address of the page that will be shown when the tab is opened; </li><li>  <code>suggestedDisplayName</code> - tab name; </li><li>  <code>websiteUrl</code> - the link opens from the Microsoft Teams menu. </li></ul><br>  The following code uses the following Teams JS API methods: <br><br><ul><li>  <code>microsoftTeams.settings.setValidityState</code> - enable or disable the "Save" button; </li><li>  <code>microsoftTeams.settings.registerOnSaveHandler</code> - event handler for saving settings; </li><li>  <code>saveEvent.notifyFailure</code> , <code>notifySuccess</code> - informs the Teams infrastructure about success or failure when saving settings; </li><li>  <code>microsoftTeams.settings.setSettings</code> - saves tab settings. </li></ul><br>  Consider the process of user login to the previously added tab.  Here are the following options: <br><br><ol><li>  The user is new, not associated with our system. </li><li>  User known to our system, but not authorized. </li><li>  Authorized user. </li></ol><br>  We have ‚Äúseamless‚Äù authorization, so we‚Äôll just add a new user to our account in our system after logging in to Azure AD.  This is the login process to the previously added tab. <br><br><img src="https://habrastorage.org/files/88f/33c/39b/88f33c39bcae45c9ada6ce50d0a89a09.png"><br><br>  Recall that the organizational structure inside Microsoft Teams is as follows: <br><br><ul><li>  There can be many teams in a Teams account; </li><li>  there can be many channels in a command; </li><li>  There may be a lot of our tabs in the channel. </li></ul><br>  Tab settings and user information are available through <code>context</code> and <code>settings</code> (from Microsoft Teams JS API): <br><br><ul><li>  <code><a href="https://msdn.microsoft.com/en-us/microsoft-teams/jslibrary">microsoftTeams.getContext</a></code> - available on the configuration pages and on the pages inside the tab; </li><li>  <code><a href="https://msdn.microsoft.com/en-us/microsoft-teams/jslibrary">microsoftTeams.settings.getSettings</a></code> - available only on configuration pages. </li></ul><br><h2>  Challenges and Solutions </h2><br>  What difficulties can arise with such a structure? <br><br>  The Wrike team decided that users will be authorized in Azure AD.  User data: <code>upn</code> (user principal name or email), <code>teamId</code> , <code>channelId</code> are available through the JS API, but this data cannot be validated on the side on the backend side - only if the application in Azure AD requests rights that require admin permission.  This is due to the feature of the Azure Graph API, according to which information about the structure of the organization is available only after the consent of the administrator.  This approach is inconvenient because only a Azure AD admin can add a tab to a channel. <br><br>  We do not know which tab the user opens, if there are several of them in the channel (we do not have a <code>tabId</code> , although we can generate it, but more on that below).  Storage of custom settings is available only in <code>settings.customSetting</code> s, but access to <code>settings</code> not available from the tab pages, only from the configuration pages. <br><br>  How to solve these problems?  The collection of data on <code>teamId</code> , <code>channelId</code> , <code>tabId</code> can be organized during user authorization and stored on the side of our application.  Requests from the user inside the tab can be validated based on data from the current context ( <code>microsoftTeams.getContext</code> ). <br><br>  The tab identifier can be generated when adding, on the configuration page, for example, like this: <br><br><pre> <code class="javascript hljs"> microsoftTeams.settings.registerOnSaveHandler(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">saveEvent</span></span></span><span class="hljs-function">) </span></span>{ microsoftTeams.settings.getSettings(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">settings</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tabId = generateOrGetTabId(settings); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> customSettings = { <span class="hljs-attr"><span class="hljs-attr">tabId</span></span>: tabId }; microsoftTeams.settings.setSettings({ <span class="hljs-attr"><span class="hljs-attr">contentUrl</span></span>: <span class="hljs-string"><span class="hljs-string">'http://localhost/tabContent?tabId='</span></span> + tabId, ... customSettings: <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(customSettings) }); saveEvent.notifySuccess(); }) });</code> </pre> <br>  There is no access to the <code>settings</code> tab in the code page, so we pass the parameters to the <code>query string</code> for <code>contentUrl</code> in the <code>query string</code> .  <code>tabId</code> will <code>tabId</code> only when you first add a tab.  When reconfiguring we will use the previously specified.  It is responsible for <code>generateOrGetTabId</code> .  The <code>settings.customSettings</code> field allows you to store the generated <code>tabId</code> both as a string and as a serialized JSON object. <br><br>  In conclusion, I would like to tell you about <code>deepLinks</code> - a way to generate a link to a tab or to specific content within a tab. <br><br>  At the time of this writing, there are two ways to generate links: <br><br><ol><li>  Interactive - using <code>microsoftTeams.shareDeepLink</code> .  The user is prompted for a name and the link is copied to the clipboard.  Such links are recognized in the chat, rendered as text entered by the user, and lead to a tab with the specified <code>entityId</code> and <code>subEntityId</code> .  A detailed description is <a href="https://msdn.microsoft.com/en-us/microsoft-teams/jslibrary">here</a> . </li><li>  Non-interactive ‚Äî by forming a link based on the application id (from the manifest), the context of the tab, and other parameters: <code>entityId</code> , <code>subEntityId</code> and so on.  Such links can be used for various notifications, for example, in email or messages from bots. </li></ol><br>  Description of how to form <code>deepLinks</code> is in <a href="https://msdn.microsoft.com/en-us/microsoft-teams/deeplinks">MSDN</a> .  Additionally, I would like to note that both methods work in the tabs page code, since they do not require the use of <code>microsoftTeams.settings</code> . <br><br>  Teams JS API is actively developing, and in the development process, the version changed from 0.2 to 0.4.  In addition, the manifest for bots and tabs has become common. <br><br>  The Azure AD Graph API and the Microsoft Graph API were also used to integrate with Wrike.  During the process and after the release, we had close communication with colleagues from Microsoft, and our feedback was taken into account. <br><br><div class="spoiler">  <b class="spoiler_title">Part of the wishes that the guys from Wrike voiced in the process of communication.</b> <div class="spoiler_text"><ul><li>  Team information must be available in the Teams JS API and / or in the Graph API. </li><li>  Access to the microsoftTeams.settings settings is needed in the tab, and not only on the settings page. </li><li>  There is a lack of tabId, although two types of Deep Links partially compensate for the lack of tabId. </li><li>  You need a more flexible scopes system for Graph Oauth2 authorization, which is necessary to get the list of members of the current team (team) without involving the Azure AD Tenant admin to customize the tab. </li><li>  More flexible configuration page settings for customizing styles, accessing native Microsoft Teams styles, and changing standard controls.  Such settings will give more freedom to create Configuration Wizards. </li></ul><br></div></div><br>  Issues of access to the composition of the team are already solved in the <a href="https://docs.botframework.com/en-us/restapi/connector/">Bot API</a> .  Part of the functionality for Deep Links was published shortly before the release of Teams.  Perhaps Teams support at the REST API level will be implemented in the Microsoft Graph API, as this API is being actively developed and involves interaction with various components of Office 365. <br><br>  By the way, the form for sending a new application for review can be found <a href="https://dev.office.com/microsoft-teams/gallery-submission">here</a> .  We hope that the Wrike experience will be useful to you, and Microsoft Teams users will be able to get even more useful tools for teamwork. <br><br><h2>  About the authors </h2><br><img src="https://habrastorage.org/files/fa9/d8d/9c5/fa9d8d9c5ebd497bab8787633d404751.jpg" align="left" width="120">  <b>Alexander Belyaev</b> , product manager.  Responsible for the elaboration of Job stories (within the framework of the Jobs to be Done concept) for the Wrike audience and, accordingly, for the functions that users use within the framework of typical scenarios of their work.  It also develops the Wrike API and is responsible for integration with strategic partners.  Loves cats and zen. <br><br><img src="https://habrastorage.org/files/981/679/65e/98167965e3fc4b0bbf3a6e86d81f65bc.jpg" align="left" width="120">  <b>Oleg Vashenkov</b> , backend developer.  In the context of integration with Microsoft Teams, it is responsible for authorization, creation and integration of accounts, support and extension of the API for working within Teams.  Loves mini hackathons - to implement ideas for new platforms and devices and try their solutions for work and life, as well as cars, including training, tuning and competitions. <br><br>  <i>We remind you that you can try Microsoft Azure for free <a href="https://azure.microsoft.com/ru-ru/free/%3Fwt.mc_id%3DAID570629_QSG_BLOG_139069">here</a> .</i> </div><p>Source: <a href="https://habr.com/ru/post/327518/">https://habr.com/ru/post/327518/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../327506/index.html">Updated PhpStorm Yii2support plugin</a></li>
<li><a href="../327508/index.html">Install NativeScript on Mac OS</a></li>
<li><a href="../327510/index.html">How to run servlets from Eclipse on the SAP Cloud Platform</a></li>
<li><a href="../327514/index.html">DevConf 2017 will be held in Moscow on June 17</a></li>
<li><a href="../327516/index.html">"Now there is a shortage of" native "developers": Mikhail Samarin on mobile development in a European company</a></li>
<li><a href="../327520/index.html">UE4 for Unity developers</a></li>
<li><a href="../327522/index.html">Functional JavaScript programming with practical examples</a></li>
<li><a href="../327524/index.html">Troubleshooting using WinDbg, Sos and Sosex</a></li>
<li><a href="../327526/index.html">‚ÄúCubes‚Äù for stores: why hyper-convergence is really needed, and why it is not just a buzzword</a></li>
<li><a href="../327528/index.html">School data: is it possible to influence the election with the help of Big Data</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>