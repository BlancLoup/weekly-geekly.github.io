<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Layered Event Processing Model</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="An event in object-oriented programming (OOP) is a message that occurs at various points in the executable code when certain conditions are met. These...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Layered Event Processing Model</h1><div class="post__text post__text-html js-mediator-article">  An event in object-oriented programming (OOP) is a message that occurs at various points in the executable code when certain conditions are met.  These messages are sent to processors (listeners), which allows you to react in a timely manner to the changed state of the system. <br><br>  Event-oriented programming is very popular.  This programming paradigm says that program execution is determined by events ‚Äî user actions (keyboard, mouse), messages from other programs and threads, operating system events, etc. <a name="habracut"></a><br>  The advantages and scope of the event model are extremely wide: <br><ul><li>  when associating objects with events, objects do not need to ‚Äúknow‚Äù about each other; </li><li>  this mechanism fits neatly into the concept of OOP; </li><li>  This mechanism makes it easy to implement user interfaces, where every user action is an event, it is enough to ‚Äúhang‚Äù on these events handlers; </li><li>  when implementing server applications, the event model allows one to get rid of the generation of a multitude of serving processes; </li><li>  The event model is also often used when programming games in which a variety of objects are managed. </li></ul><br>  There are design patterns that are somehow related to event handling: Observer, Team, Chain of Responsibilities, and many others.  These templates are used in many event handling models.  However, various implementations of the event model impose a number of restrictions on the possibilities of developing programs: <br><ul><li>  when processing the event, it is impossible to select the main handler, all handlers are equal to each other; </li><li>  when processing the event, handlers do not know anything about each other and about the current situation, which does not allow the programmer to fully realize the intended functionality; </li><li>  it is necessary to add additional functionality if you need to select the resulting handler. </li></ul><br>  The list of listed restrictions is not complete, but these restrictions are the most significant.  This article proposes the implementation of a more complex event model, which will remove all of these restrictions. <br>  When developing software using this event-handling model, the sequence of processing steps is as follows: <br><ol><li>  Necessary listeners are connected to handle their events. </li><li>  In the program code, an event is triggered. </li><li>  The ‚Äúfirst round‚Äù of processing is performed, all listeners who are connected to the processing of this event are given the time for initial processing, during which each listener can get their own data, data from the event initiator, and also set any data to be transmitted to the ‚Äúsecond circle‚Äù and apply for handling the event in the "second round". </li><li>  Among all the listeners of this event, the listener who submitted the application with the highest processing priority is selected; he is given the right to handle the event in the ‚Äúsecond round‚Äù.  In the course of this processing, it can receive data from the initiator, its own data, data from its own ‚Äúfirst round‚Äù handler.  After processing is complete, it can return the data directly to the event initiator. </li></ol><br>  Consider the advantages of this model: <br><ul><li>  It is possible to ‚Äúhang‚Äù the same handler on different events or even on the same thing, but with different own data. </li><li>  It is possible to handle the widest range of events.  For example, adding a new user, displaying a site page design, etc.  In this case, the event of adding a new user can be processed using only the ‚Äúfirst circle‚Äù, and the output event of the site page design should be processed into ‚Äútwo circles‚Äù. </li><li>  Only one handler of the ‚Äúsecond circle‚Äù is executed (Consider the site design output event: on the first circle, the processors push the priorities of the event processing and, on the second circle, one of them generates the design of the site page). </li></ul><br><img src="https://habrastorage.org/storage2/805/722/d1a/805722d1a0a0779b5fe8dafd6ee08846.png"><br>  The picture shows the implementation scheme of this model.  This implementation is initially based on work using a call chain.  Below is an example of implementing the model in PHP. <br><ul><li>  <b>Events</b> is the main class.  Only its user object can create itself.  This class provides the ability to trigger events and "hang" event handlers. <br><ul><li>  <b>newListener</b> - allows you to add a new listener and immediately ‚Äúconfigure‚Äù it (adding occurs via the adapter for Events_Listener - Events_Listener_adapterSET). </li><li>  <b>newEvent</b> - allows you to configure a new event, and then initiate it (this action takes place through an adapter for Events_Fire - Events_Fire_adapterSET). </li></ul><br>  Other classes are also transparently connected to the work process: <br><ul><li>  <b>Events_Fire</b> - provides a general interface for working with an event that adapters limit; </li><li>  <b>Events_Fire1</b> - when calling the first round of processing.  This class allows you to get all the available data of the current state, add a second-round handler, and also set its priority (via the Events_Fire2_adapterSET adapter); </li><li>  <b>Events_Fire2</b> - when calling the result handler (‚Äúsecond round‚Äù).  This class allows you to get all the available data, including data from the "first round" processor; </li><li>  <b>Events_Listener</b> - provides a general interface for working with an event handler.  Methods of this class also use adapters Events_Fire1, Events_Fire2; </li><li>  <b>Events_Data</b> - class for storing and transferring data within the event model. </li></ul><br></li></ul><br>  Consider an example of the work of this model: <br><pre><code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SampleListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Fire1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Event_fire1 $EF1)</span></span></span><span class="hljs-function"> </span></span>{ $EF1-&gt;setFinal(<span class="hljs-keyword"><span class="hljs-keyword">Array</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>,‚ÄùFire2‚Äù), $EF1-&gt;getListenerData()-&gt;sort); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Fire2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Event_fire2 $EF2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ($EF2-&gt;getListenerData()-&gt;sort() + $EF2-&gt;getFireData()-&gt;sort()); } } $listener = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SampleListener(); $data1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Events_Data(); $data1-&gt;sort = <span class="hljs-number"><span class="hljs-number">10</span></span>; Events::newListener(<span class="hljs-string"><span class="hljs-string">"sampleModul"</span></span>, <span class="hljs-string"><span class="hljs-string">"sampleEvent"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span>($listener, <span class="hljs-string"><span class="hljs-string">'Fire1'</span></span>))-&gt;setData($data1); $data2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Events_Data(); $data2-&gt;sort = <span class="hljs-number"><span class="hljs-number">20</span></span>; Events::newListener(<span class="hljs-string"><span class="hljs-string">"sampleModul"</span></span>, <span class="hljs-string"><span class="hljs-string">"sampleEvent"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span>($listener, <span class="hljs-string"><span class="hljs-string">'Fire1'</span></span>))-&gt;setData($data2); $data3 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Events_Data(); $data3-&gt;sort = <span class="hljs-number"><span class="hljs-number">30</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">Echo</span></span> Events::newEvent(<span class="hljs-string"><span class="hljs-string">"sampleModul"</span></span>, <span class="hljs-string"><span class="hljs-string">"sampleEvent"</span></span>)-&gt;setData($data3)-&gt;fire();</code> </pre> <br>  After the <b>sampleEvent</b> event is <b>initialized, the</b> Fire1 method of the listener $ listener with the first data <i>(sort = 10, this is the priority that it will put to final processing) is</i> called, and then the same method is called with other data <i>(sort = 20, 20&gt; 10, therefore the listener with these data and get the right to final processing of the event)</i> .  Finally, the Fire2 method will be <b>called</b> <i>(the handler is the same, but the data is $ data2)</i> .  The data from the event <i>(sort = 30) is</i> added to the data from the listener <i>(sort = 20)</i> .  As a result, the event in response will return us the number 50, which will be displayed on the screen. <br><br>  This example shows that the same handler can respond differently to an event depending on the data of the listener.  It also demonstrates the processing of the event, including the resultant, only call to <b>Fire2</b> <i>(Imagine that it is in this method, for example, that the design of the site page is generated, and the data is the external context of the event handling)</i> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      By implementing this event-handling model, we managed to remove all the above limitations.  Currently, the model is focused on a specific product (there are parasitic methods necessary only in this product), but if there is interest, then you can prepare the code for the public version. <br><br>  You can also implement this model in other programming languages.  In cpp, you can pass a pointer as data, and in processing methods you can use reinterpret_cast or use templates. <br><br>  The implementation in each specific situation may differ slightly, but the main point is precisely in the implementation of two or more levels. </div><p>Source: <a href="https://habr.com/ru/post/142980/">https://habr.com/ru/post/142980/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../142973/index.html">Prototype Yandex.Disk client for Linux and opening API</a></li>
<li><a href="../142974/index.html">The simplest modeler for zenoss or the dirty path to a brighter future</a></li>
<li><a href="../142975/index.html">Profiling PHP scripts on a live server</a></li>
<li><a href="../142976/index.html">Translation of tutorials on libGDX - part 1 (setting up a project in Eclipse)</a></li>
<li><a href="../142978/index.html">Kickstarter is a way to avoid financial risks and not give a share in your project.</a></li>
<li><a href="../142982/index.html">Acceler8 2011 - Accelerate 2012 - and so on</a></li>
<li><a href="../142983/index.html">Beta Firefox 13 available</a></li>
<li><a href="../142984/index.html">‚ÄúRunet today‚Äù, April 28, 2012. Experts of the issue: Pavel Vlasov-Mrdulyash, Kirill Grodinsky</a></li>
<li><a href="../142985/index.html">Lenovo IdeaPad U300s, or the Ultrabook Adventure</a></li>
<li><a href="../142986/index.html">Nintendo will offer their games (3DS and Wii U) for download</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>