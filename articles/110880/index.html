<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Holidays in calendars or who works the most</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="New Year holidays are coming ... and it's time to talk about holidays. When developing an application with the support of holiday dates, a number of q...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Holidays in calendars or who works the most</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/habraeffect/bc/fa/bcfad5b1805747be9b036cb08feebd78.png" align="left"><br>  New Year holidays are coming ... and it's time to talk about holidays.  When developing an application with the support of holiday dates, a number of questions arise: how can such data be obtained and from where, how to use and process it? <br><br><br>  In this article I want to talk about the resources associated with the holidays, and to share personal experience of their use in popular services and programs.  I will consider options for working with these services using the example of our <a href="http://www.devexpress.com/xtrascheduler">XtraScheduler scheduler</a> .  And at the end of the article I will give some statistics on holidays for different countries of the world. <br><br><a name="habracut"></a><br><h4>  Online resources </h4><br>  There are information and reference resources with a variety of calendars - solar, lunar, calendars with various types of holidays, schedules of sporting events, etc. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In Runet, one such resource is the <b>Calendar of Events</b> ( <a href="http://www.calend.ru/">http://www.calend.ru/</a> ), where you can find information about state, professional, religious, and other holidays, divided into categories.  All of them are presented in the form of ics-files of <a href="http://en.wikipedia.org/wiki/ICalendar">iCalendar</a> format, which can be used in your applications. <br><img src="https://habrastorage.org/storage/habraeffect/28/1b/281b453e8c8468f2d013610492d82a7d.png"><br><br>  As other examples, I‚Äôll give you the resources that <b>Yandex Calendar</b> <a href="http://www.apple.com/downloads/macosx/calendars/">presents</a> : <a href="http://www.apple.com/downloads/macosx/calendars/">Apple.com</a> , <a href="http://www.mozilla.org/projects/calendar/holidays.html">Mozilla.org</a> , <a href="http://www.icalshare.com/">iCalShare.com</a> .  They also contain collections of publicly available ics files. <br><br>  Our XtraScheduler scheduler can import data from the iCalendar format, so you can use any of the resources listed above.  To do this, we use the <i>iCalendarImporter</i> class from the separate assembly <i>DevExpress.XtraScheduler.v10.2.iCalendarExchange.dll</i> .  It implements all the necessary functionality of loading from the ics-file and creating calendar objects. <br><br><h4>  Preset Holidays </h4><br>  In addition to the resources offered, the <b>Yandex Calendar</b> also contains predefined holiday dates.  On the date navigator and in various views, they are marked in red and have a hint with a description.  I am glad that there are postponements of working days - even though the color of the date in the navigator does not always correspond to the color of the date in the calendar itself. <br><img src="https://habrastorage.org/storage/habraeffect/12/75/1275b2f91c008afa767551258f8b910f.png"><br><br>  Since XtraScheduler is a component, it‚Äôs not necessary to store the preset date set in it.  This is due to the fact that the situation with the holidays varies from year to year and the requirements imposed by users may differ depending on the country or usage scenario.  Therefore, instead of introducing a fixed set of holidays, we provided the user with a collection property for this set of dates and made it possible to determine the list of working days, holidays, and ‚Äúworking‚Äù weekends. <br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> WorkDaysCollection WorkDays { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> {... } }</code> </pre> <br>  Below is the next set of element classes in this collection, which ‚Äúoverlaps‚Äù all options for using weekends. <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">WorkDay</span></span> : <span class="hljs-title"><span class="hljs-title">ICloneable</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsWorkDay</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DateTime date</span></span></span><span class="hljs-function">)</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">WeekDaysWorkDay</span></span> : <span class="hljs-title"><span class="hljs-title">WorkDay</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> WeekDays WeekDays {<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { ...} } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">KnownDateDay</span></span> : <span class="hljs-title"><span class="hljs-title">WorkDay</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> DisplayName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { ... } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { ... } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DateTime Date { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { ... } } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Holiday</span></span> : <span class="hljs-title"><span class="hljs-title">KnownDateDay</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Location { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { ...} <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { ... } } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ExactWorkDay</span></span> : <span class="hljs-title"><span class="hljs-title">KnownDateDay</span></span> { }</code> </pre><br><h4>  Holidays as calendar events </h4><br>  This option implies that an event in the calendar is directly created for each holiday. <br><br>  Let's return to the <b>Yandex calendar</b> .  On first consideration, I did not find how to add holidays to the calendar, although I expected to see the mention of holidays somewhere near the Playbill and the TV program.  But I found a universal way to add any events (including holidays), using import from the ics-file.  The resulting list can be imported either in a new or in an existing calendar. <br><br>  I tried to import the list of ‚ÄúInternational holidays‚Äù ( <a href="">http://www.calend.ru/img/export/ical-wholeworld.ics</a> ) from the resource described above. <br>  Unfortunately, Yandex could not manage to import the selected calendar (although, to put it mildly, the format of the proposed file is not perfect).  But the import from the resources proposed by Yandex itself works perfectly. <br><br>  In the <b>Google Calendar,</b> the situation is somewhat different.  Along with importing calendars from a file, importing via the link indicated, importing from another account, there is one more option. <br><br><img src="https://habrastorage.org/storage/habraeffect/25/0f/250fd6276b6f86ebf83664ed603f5146.png"><br><br>  We immediately see the ‚ÄúOther calendars‚Äù list and open the ‚ÄúView interesting calendars‚Äù menu item (by the way, the menu name is interesting) we will get into a whole collection of various calendar events, including sports, moon phases, etc.  One of them is a list of pre-installed holidays - approximately 30 countries. <br><br><img src="https://habrastorage.org/storage/habraeffect/38/12/3812c69740f7328cc6a0380eaf6deff8.png"><br><br>  Just select the one you need and click ‚Äúsubscribe‚Äù - and the list of calendar events will be added as a separate calendar.  The event for the day will be added and, as a result, the corresponding date will appear in bold on the date navigator. <br><br>  By the way, Google successfully coped with the task of importing our International Holidays file. <br><br>  XtraScheduler when importing holidays from the ics-file also creates separate events for the whole day.  How can I use it?  It is enough to enable the option that prohibits having time-overlapping events: <br><pre> <code class="cs hljs">schedulerControl1.OptionsCustomization.AllowAppointmentConflicts = AppointmentConflictsMode.Forbidden;</code> </pre><br>  and on this holiday it will be impossible to create any other event. <br><br><h4>  Holidays in desktop applications </h4><br>  In addition to ics-files, there is another way to get a list of official public holidays by country. <br><br>  One of the sources, if you have installed <b>Microsoft Office</b> , is the <i>outlook.hol</i> file, which is located in the subfolders of the installed product, for example, here: <i>C: \ Program Files \ Microsoft Office \ Office12 \ 1049 \ outlook.hol</i> " <br><br>  The data in this file is divided into sections-countries and contains a fixed list of strings representing holidays for several years ago and forward. <br><br><pre> <code class="xml hljs">... [] 84  ,2006/1/1  ,2007/1/1  ,2008/1/1  ,2009/1/1  ,2010/1/1  ,2011/1/1  ,2012/1/1 ...</code> </pre><br>  In the version of office 2010, data on holidays is presented from 2009 to 2028 <br><br>  This data is used in the Outlook Calendar.  In the calendar settings, you can add holidays for the specified country.  Holidays will also be added as physical calendar events. <br><br><img src="https://habrastorage.org/storage/habraeffect/4c/2d/4c2d036c03cf94bd028d010da31db00b.png"><br><br>  Let us consider how the holiday string is defined in this file.  The line storing information about the holiday consists of its name, date and calendar identifier.  Note that for a number of countries where dates are represented not only in the Gregorian calendar, it is necessary to perform date conversions. <br><pre> <code class="xml hljs">... [] 42 ...    ,1424/3/12,6 ...</code> </pre><br><br>  Such date conversions are easy to do with built-in tools if you use .NET. <br><br>  When implementing the functional holidays in XtraScheduler in order to make life easier for users, we have provided the ability to download this file, although we ourselves do not use it.  We have created a separate class that loads this data and does the necessary operations with dates.  At the same time, all the necessary date conversions between different calendars will be performed by us and do not require writing additional code. <br><br>  The number of supported calendars for conversions can be seen from the code below. <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">OutlookHolidaysLoader</span></span> { <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">region</span></span></span><span class="hljs-meta"> CalendarTypes consts internal const int CAL_GREGORIAN = 1; internal const int CAL_GREGORIAN_ARABIC = 10; internal const int CAL_GREGORIAN_ME_FRENCH = 9; internal const int CAL_GREGORIAN_US = 2; internal const int CAL_GREGORIAN_XLIT_ENGLISH = 11; internal const int CAL_GREGORIAN_XLIT_FRENCH = 12; internal const int CAL_HEBREW = 8; internal const int CAL_HIJRI = 6; internal const int CAL_JAPAN = 3; internal const int CAL_JULIAN = 13; internal const int CAL_KOREA = 5; internal const int CAL_TAIWAN = 4; internal const int CAL_THAI = 7; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endregion</span></span></span><span class="hljs-meta"> internal const int DefaultCalendarType = CAL_GREGORIAN; public string[] ExtractLocations(string fileName) { } public string[] ExtractLocations(Stream stream) { } public HolidayBaseCollection FromFile(string fileName) { } public HolidayBaseCollection FromFile(string fileName, string[] locations) { } public HolidayBaseCollection FromFile(string fileName, Encoding encoding, string[] locations) { } public HolidayBaseCollection FromStream(Stream stream) { } public HolidayBaseCollection FromStream(Stream stream, string[] locations) { } public HolidayBaseCollection FromStream(Stream stream, Encoding encoding, string[]) { } }</span></span></code> </pre><br>  Such functions as <a href="http://www.devexpress.com/aspxscheduler">ASPxScheduler</a> and <a href="http://www.devexpress.com/Products/NET/Controls/WPF/Scheduler">DXScheduler for WPF</a> received similar holiday functionality. <br>  How it works in ASPxScheduler, you can see in our <a href="http://demos.devexpress.com/ASPxSchedulerDemos/Miscellaneous/Holidays.aspx">online demo</a> . <br><br>  In addition to downloading from <i>iCalendar</i> and <i>outlook.hol,</i> our scheduler can load and save a collection of holidays in <i>XML format</i> . <br><pre> <code class="cs hljs"> <span class="hljs-comment"><span class="hljs-comment">//... HolidayBaseCollection holidays = HolidayCollectionXmlPersistenceHelper.ObjectFromXml(string xml); //.... new HolidayCollectionXmlPersistenceHelper(holidays).ToXml();</span></span></code> </pre><br><br>  Where else would you need support for holidays in applications?  One of the possible scenarios is filtering of unnecessary days when showing a large list of time data.  As an example, I will cite the product <a href="http://www.devexpress.com/xtracharts">XtraCharts</a> , which, following our planners, implemented the support of weekends and holidays to throw out unnecessary dates in the series. <br><br><h4>  Some analytics </h4><br>  As a bonus, I will cite a few statistical data obtained from the Outlook file.  I downloaded the <i>outlook.hol</i> file with the holidays, filtered the dates to 2010, and visualized the results, while calculating their number per year for different countries. <br><br>  The following diagram shows the distribution of the number of public holidays by country in 2010: <br><img src="https://habrastorage.org/storage/habraeffect/ef/15/ef15db2e65e2da75f50560575575ffbb.png"><br><br>  A complete list of the number of holidays by country is reflected in the legend below: <br><img src="https://habrastorage.org/storage/habraeffect/38/33/3833b7f79a9f12d280ecd372ab4d9f22.png"><br><br>  If you do not take into account the religious holidays, it is not difficult to notice that the leading position in the number of holidays is occupied by such countries as <br>  <b>China</b> , <b>Canada</b> and the <b>United States</b> . <br><br>  The minimum number of holidays in the <b>European Union</b> , <b>Libya</b> , <b>India</b> , <b>Malaysia</b> . <br><br>  <b>Russia</b> occupies the middle position with a value of 12. <br><br>  Of course, we must understand that these figures show only official holidays and do not reflect the real picture of the total number of days off.  So, to draw any conclusions (for example, who is the ‚Äúmost celebrating‚Äù country, and who is a ‚Äúcountry of a workaholic‚Äù) I will give you ... :-) <br><br>  HAPPY NEW YEAR, EVERYONE!!! </div><p>Source: <a href="https://habr.com/ru/post/110880/">https://habr.com/ru/post/110880/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../110869/index.html">Draw a button in SVG</a></li>
<li><a href="../110870/index.html">Robot teachers tested in South Korea</a></li>
<li><a href="../110871/index.html">McAfee experts have identified the main goals of hackers in 2011</a></li>
<li><a href="../110873/index.html">A laptop is not for everyone, but for everyone</a></li>
<li><a href="../110876/index.html">SEO spam on –†–µ–π—Ç–∏–Ω–≥@Mail.ru!</a></li>
<li><a href="../110881/index.html">New life of old Wi-Fi module</a></li>
<li><a href="../110884/index.html">PhpBB 3 and Kohana 3 integration</a></li>
<li><a href="../110886/index.html">App Engine API under the hood</a></li>
<li><a href="../110888/index.html">Since January 1! Happy Public Domain Day!</a></li>
<li><a href="../110890/index.html">Life after copyright</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>