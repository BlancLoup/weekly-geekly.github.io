<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dagger 2. Part Three. New facets of the possible</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! Finally came the third part of a series of articles on Dagger 2! 


 Before further reading, I strongly recommend that you familiarize yourself...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dagger 2. Part Three. New facets of the possible</h1><div class="post__text post__text-html js-mediator-article"><p>  Hello!  Finally came the third part of a series of articles on Dagger 2! </p><br><p>  Before further reading, I strongly recommend that you familiarize yourself with the <a href="https://habrahabr.ru/post/279125/">first</a> and <a href="https://habrahabr.ru/post/279641/">second</a> parts. </p><br><p>  Many thanks for the feedback and comments.  I am very pleased that my articles really help developers plunge into the world of Dagger.  This is what gives you the power to create for you further. <br>  In the third part, we will consider various interesting and important features of the library, which may be very useful to you. </p><br><p>  In general, the library already exists a decent time, but the documentation is still extremely disgusting.  To the developer, who is just beginning his acquaintance with Dagger, I would even advise not to look at the official documentation at the beginning, so as not to be disappointed in this tough and unjust world. </p><br><p>  There are, of course, moments that are painted more or less.  But here all sorts of new features are described in such a way that I had to try and error, crawling into the generated code, to figure out how it all works.  Fortunately, good people write good articles, but even sometimes they do not give a clear and precise answer right away. </p><br><p>  So stop talking and move on to new knowledge! </p><a name="habracut"></a><br><h2 id="qualifier-annotation">  Qualifier annotation </h2><br><p>  In the last <a href="https://habrahabr.ru/post/279641/">article</a> in the comments asked to highlight this issue.  We will not be shelved. </p><br><p> It often happens that we need to provide several objects of the same type.  For example, we want to have two <code>Executor</code> on the system: one-threaded, the other with <code>CachedThreadPool</code> .  In this case, qualifier annotation comes to the rescue.  This is a custom annotation that has the <code>@Qualifier</code> annotation.  It sounds a bit like butter, but the example is much simpler. </p><br><p>  In general, Dagger2 provides us with one ready-made "qualifier annotation", which, perhaps, is quite enough in everyday life: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Qualifier</span></span> <span class="hljs-meta"><span class="hljs-meta">@Documented</span></span> <span class="hljs-meta"><span class="hljs-meta">@Retention</span></span>(RUNTIME) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-meta"><span class="hljs-meta">@interface</span></span> Named { <span class="hljs-comment"><span class="hljs-comment">/** The name. */</span></span> <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">value</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">default</span></span></span><span class="hljs-function"> ""</span></span>; }</code> </pre> <br><p>  And now let's see how it all looks in battle: </p><br><div class="spoiler">  <b class="spoiler_title">Qualifier annotation example</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-meta"><span class="hljs-meta">@Singleton</span></span> <span class="hljs-meta"><span class="hljs-meta">@Named</span></span>(<span class="hljs-string"><span class="hljs-string">"SingleThread"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Executor </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideSingleThreadExecutor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Executors.newSingleThreadExecutor(); } <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-meta"><span class="hljs-meta">@Singleton</span></span> <span class="hljs-meta"><span class="hljs-meta">@Named</span></span>(<span class="hljs-string"><span class="hljs-string">"MultiThread"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Executor </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideMultiThreadExecutor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Executors.newCachedThreadPool(); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-meta"><span class="hljs-meta">@Named</span></span>(<span class="hljs-string"><span class="hljs-string">"SingleThread"</span></span>) Executor singleExecutor; <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-meta"><span class="hljs-meta">@Named</span></span>(<span class="hljs-string"><span class="hljs-string">"MultiThread"</span></span>) Executor multiExecutor; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); MyApplication.getInstance().getAppComponent().inject(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); setContentView(R.layout.activity_main); } }</code> </pre> </div></div><br><p>  As a result, we have two different instances ( <code>singleExecutor</code> , <code>multiExecutor</code> ) of the same class ( <code>Executor</code> ).  What we need!  I note that objects of the same class annotated with <code>@Named</code> can be <code>@Named</code> also from completely different and independent components as well as from each other. </p><br><h2 id="otlozhennaya-inicializaciya">  Delayed initialization </h2><br><p>  One of our common development problems is the long start of the application.  Usually the reason is one thing - we will load and initialize too much at startup.  In addition, Dagger2 builds a dependency graph in the main thread.  And often, not all objects constructed by Dagger are needed right away.  Therefore, the library allows us to delay the initialization of the object until the first call using the <code>Provider&lt;&gt;</code> and <code>Lazy&lt;&gt;</code> interfaces. </p><br><p>  Immediately turn our gaze to an example: </p><br><div class="spoiler">  <b class="spoiler_title">Delayed Initialization Example</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-meta"><span class="hljs-meta">@Named</span></span>(<span class="hljs-string"><span class="hljs-string">"SingleThread"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Executor </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideSingleThreadExecutor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Executors.newSingleThreadExecutor(); } <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-meta"><span class="hljs-meta">@Named</span></span>(<span class="hljs-string"><span class="hljs-string">"MultiThread"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Executor </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideMultiThreadExecutor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Executors.newCachedThreadPool(); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-meta"><span class="hljs-meta">@Named</span></span>(<span class="hljs-string"><span class="hljs-string">"SingleThread"</span></span>) Provider&lt;Executor&gt; singleExecutorProvider; <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-meta"><span class="hljs-meta">@Named</span></span>(<span class="hljs-string"><span class="hljs-string">"MultiThread"</span></span>) Lazy&lt;Executor&gt; multiExecutorLazy; <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-meta"><span class="hljs-meta">@Named</span></span>(<span class="hljs-string"><span class="hljs-string">"MultiThread"</span></span>) Lazy&lt;Executor&gt; multiExecutorLazyCopy; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); MyApplication.getInstance().getAppComponent().inject(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); setContentView(R.layout.activity_main); <span class="hljs-comment"><span class="hljs-comment">// Executor singleExecutor = singleExecutorProvider.get(); Executor singleExecutor2 = singleExecutorProvider.get(); // Executor multiExecutor = multiExecutorLazy.get(); Executor multiExecutor2 = multiExecutorLazy.get(); Executor multiExecutor3 = multiExecutorLazyCopy.get(); } }</span></span></code> </pre> </div></div><br><p>  Let's start with the <code>Provider&lt;Executor&gt; singleExecutorProvider</code> .  Until the <strong>first</strong> call to <code>singleExecutorProvider.get()</code> Dagger does not initialize the corresponding <code>Executor</code> .  But <strong>each subsequent</strong> <code>singleExecutorProvider.get()</code> <strong>call</strong> will create a new instance.  Thus, <code>singleExecutor</code> and <code>singleExecutor2</code> are two different objects.  This behavior is essentially identical to the behavior of an <strong>unscoped</strong> object. </p><br><p>  In what situations is <code>Provider</code> appropriate?  It comes in handy when we provide some kind of mutable relationship that changes its state over time, and with each call we need to get the current state.  "What a curve architecture?"  - say you, and I agree with you.  But when working with legacy code, you will not see that. </p><br><p>  I note that the authors of the library also do not advise abusing the <code>Provider</code> interface in places where it is enough to get by with the usual <strong>unscope</strong> , as this is fraught with "curved architecture", as mentioned above, and difficult to catch bugs. </p><br><p>  Now <code>Lazy&lt;Executor&gt; multiExecutorLazy</code> and <code>Lazy&lt;Executor&gt; multiExecutorLazyCopy</code> .  Dagger2 initializes the corresponding <code>Executor</code> only when it is <strong>first</strong> called <code>multiExecutorLazy.get()</code> and <code>multiExecutorLazyCopy.get()</code> .  Next, Dagger caches initialized values ‚Äã‚Äãfor <strong>each</strong> <code>Lazy&lt;&gt;</code> and on the second call, <code>multiExecutorLazy.get()</code> and <code>multiExecutorLazyCopy.get()</code> cached objects. </p><br><p>  Thus, <code>multiExecutor</code> and <code>multiExecutor2</code> refer to one object, and <code>multiExecutor3</code> to the second object. </p><br><p>  But, if we add the <code>@Singleton</code> annotation to the <code>provideMultiThreadExecutor()</code> method in the <code>provideMultiThreadExecutor()</code> , then the object will be cached for the entire dependency tree, and <code>multiExecutor</code> , <code>multiExecutor2</code> , <code>multiExecutor3</code> will refer to <strong>one</strong> object. </p><br><p>  Be careful. </p><br><h2 id="asinhronnaya-zagruzka">  Asynchronous loading </h2><br><p>  We have come up with a very nontrivial task.  But what if we want the construction of a dependency graph to take place in the background?  It sounds promising?  Yes, yes, I'm about <strong>Producers</strong> . </p><br><p>  Honestly, this topic deserves a separate review.  There are many features and nuances.  For her enough good stuff.  Now I will touch only on the pros and cons of <strong>Producers</strong> . </p><br><p>  Pros.  Well, the most important advantage is the loading in the background and the ability to manage this loading process. </p><br><p>  Minuses.  <strong>Producers are</strong> ‚Äúdragging‚Äù Guava behind them, and that‚Äôs plus 15 thousand methods for the apk.  But the worst thing is that the application of <strong>Producers</strong> "spoils" the overall architecture a bit and makes the code more confusing.  If you already had a Dagger, and then you decided to move the initialization of objects to the background, you will have to try hard. </p><br><p>  In the official documentation, this topic is highlighted in a <a href="https://google.github.io/dagger/producers.html">special section</a> .  But I highly recommend the <a href="https://medium.com/%40froger_mcs">Miroslaw Stanek articles</a> .  He generally has a very good blog, and there are many articles about Dagger2.  Actually, I even borrowed some models of pictures from past articles from him. <br>  About <strong>Producers</strong> he writes in <a href="http://frogermcs.github.io/dependency-injection-with-dagger-2-producers/">this article</a> . </p><br><p>  But the <a href="http://frogermcs.github.io/async-injection-in-dagger-2-with-rxjava/">next one</a> offers a very interesting alternative for loading the dependency tree in the background.  Native RxJava comes to the rescue.  I really like his solution, since it is completely free from the drawbacks of using <strong>Producers</strong> , but it also solves the issue of asynchronous loading. </p><br><p>  Only one minus: Miroslav does not quite correctly apply <code>Observable.create(...)</code> .  But I wrote about this in the <a href="http://frogermcs.github.io/async-injection-in-dagger-2-with-rxjava/">comments on the article</a> , so pay attention necessarily. </p><br><p>  And now let's see how the code for the <strong>scope of the</strong> object will look like (with the ‚Äúcorrect‚Äù RxJava): </p><br><div class="spoiler">  <b class="spoiler_title">Example with scope</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-meta"><span class="hljs-meta">@Singleton</span></span> <span class="hljs-comment"><span class="hljs-comment">// or custom scope for "local" singletons HeavyExternalLibrary provideHeavyExternalLibrary() { HeavyExternalLibrary heavyExternalLibrary = new HeavyExternalLibrary(); heavyExternalLibrary.init(); //This method takes about 500ms return heavyExternalLibrary; } @Provides @Singleton // or custom scope for "local" singletons Observable&lt;HeavyExternalLibrary&gt; provideHeavyExternalLibraryObservable( final Lazy&lt;HeavyExternalLibrary&gt; heavyExternalLibraryLazy) { return Observable.fromCallable(heavyExternalLibraryLazy::get) .subscribeOn(Schedulers.io()) .observeOn(AndroidSchedulers.mainThread()); } } public class MainActivity extends AppCompatActivity { @Inject Observable&lt;HeavyExternalLibrary&gt; heavyExternalLibraryObservable; //This will be injected asynchronously HeavyExternalLibrary heavyExternalLibrary; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); MyApplication.getInstance().getAppComponent().inject(this); setContentView(R.layout.activity_main); // init HeavyExternalLibrary in background thread! heavyExternalLibraryObservable.subscribe( heavyExternalLibrary1 -&gt; heavyExternalLibrary = heavyExternalLibrary1, throwable -&gt; {} ); } }</span></span></code> </pre> </div></div><br><p>  Notice the <code>@Singleton</code> and <code>Lazy</code> interface in the <code>AppModule</code> .  <code>Lazy</code> just guarantees that the heavy object will be initialized when we request, and then cached. </p><br><p>  And how should we be if we want to receive a new copy of this "heavy" object every time?  Then it is worth changing <code>AppModule</code> : </p><br><div class="spoiler">  <b class="spoiler_title">Unscope example</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-comment"><span class="hljs-comment">// No scope! HeavyExternalLibrary provideHeavyExternalLibrary() { HeavyExternalLibrary heavyExternalLibrary = new HeavyExternalLibrary(); heavyExternalLibrary.init(); //This method takes about 500ms return heavyExternalLibrary; } @Provides @Singleton // or custom scope for "local" singletons Observable&lt;HeavyExternalLibrary&gt; provideHeavyExternalLibraryObservable( final Provider&lt;HeavyExternalLibrary&gt; heavyExternalLibraryLazy) { return Observable.fromCallable(heavyExternalLibraryLazy::get) .subscribeOn(Schedulers.io()) .observeOn(AndroidSchedulers.mainThread()); } } public class MainActivity extends AppCompatActivity { @Inject Observable&lt;HeavyExternalLibrary&gt; heavyExternalLibraryObservable; //This will be injected asynchronously HeavyExternalLibrary heavyExternalLibrary; HeavyExternalLibrary heavyExternalLibraryCopy; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); MyApplication.getInstance().getAppComponent().inject(this); setContentView(R.layout.activity_main); // init HeavyExternalLibrary and heavyExternalLibraryCopy in background thread! heavyExternalLibraryObservable.subscribe( heavyExternalLibrary1 -&gt; heavyExternalLibrary = heavyExternalLibrary1, throwable -&gt; {} ); heavyExternalLibraryObservable.subscribe( heavyExternalLibrary1 -&gt; heavyExternalLibraryCopy = heavyExternalLibrary1, throwable -&gt; {} ); } }</span></span></code> </pre> </div></div><br><p>  For the <code>provideHeavyExternalLibrary()</code> method, we have removed the <strong>scope</strong> , and in the <code>provideHeavyExternalLibraryObservable(final Provider&lt;HeavyExternalLibrary&gt; heavyExternalLibraryLazy)</code> use the <code>Provider</code> instead of <code>Lazy</code> .  Thus, the <code>heavyExternalLibrary</code> and <code>heavyExternalLibraryCopy</code> in <code>MainActivity</code> are different objects. </p><br><p>  And you can even make the whole process of initializing the dependency tree to the background.  You ask how?  Very easy.  First, look at how it was: </p><br><div class="spoiler">  <b class="spoiler_title">SplashActivity from the article of Miroslav</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SplashActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseActivity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> SplashActivityPresenter presenter; <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> AnalyticsManager analyticsManager; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setupActivityComponent(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupActivityComponent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> SplashActivityComponent splashActivityComponent = GithubClientApplication.get(SplashActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) .getAppComponent() .plus(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SplashActivityModule(SplashActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); splashActivityComponent.inject(SplashActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } }</code> </pre> </div></div><br><p>  And now let's take a look at the updated <code>void setupActivityComponent()</code> method (with my RxJava edits): </p><br><div class="spoiler">  <b class="spoiler_title">void setupActivityComponent ()</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupActivityComponent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Completable.fromAction(() -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> SplashActivityComponent splashActivityComponent = GithubClientApplication.get(SplashActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) .getAppComponent() .plus(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SplashActivityModule(SplashActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); splashActivityComponent.inject(SplashActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); }) .doOnCompleted(() -&gt; { <span class="hljs-comment"><span class="hljs-comment">//Here is the moment when injection is done. analyticsManager.logScreenView(getClass().getName()); presenter.callAnyMethod(); }) .subscribeOn(Schedulers.io()) .observeOn(AndroidSchedulers.mainThread()) .subscribe(() -&gt; {}, throwable -&gt; {}); }</span></span></code> </pre> </div></div><br><h2 id="zamery">  Measurements </h2><br><p>  In the last section, we talked about performance at the start of the application.  However, we know that if the question concerns performance and speed, we must measure!  To rely on intuition and the feeling "it seems to have become faster" is impossible.  And with this Miroslav will help us again in <a href="http://frogermcs.github.io/dagger-graph-creation-performance/">this</a> and <a href="http://frogermcs.github.io/dagger2metrics-measure-performance-of-graph-initialization/">this</a> articles.  So that we can do everything without him, I have no idea at all. </p><br><h2 id="novye-interesnye-vozmozhnosti">  New interesting features </h2><br><p>  Dagger has new interesting features that promise us to make life easier.  But understanding how everything works and what gives us all this was not an easy task.  Well, let's start! </p><br><h3 id="reusable-scope">  @Reusable scope </h3><br><p>  An interesting annotation.  It allows you to save memory, but at the same time it is in fact not limited to any <code>scope</code> , which makes it very convenient to reuse dependencies in any components.  That is, it is something between the <code>scope</code> and <code>unscope</code> . </p><br><p>  At the docks they write a very important point, which somehow doesn‚Äôt strike the eye from the first time: " <strong>For each component that uses the <code>@Reusable</code> dependency, this dependency is cached separately</strong> ."  And my addition: " <strong>Unlike <code>scope</code> annotations, where the object is cached at creation and its instance is used by child and dependent components</strong> ." </p><br><p>  And now just an example to understand everything: </p><br><div class="spoiler">  <b class="spoiler_title">Long clarification example</b> <div class="spoiler_text"><p>  Our main ingredient. </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Component</span></span>(modules = {AppModule.class, UtilsModule.class}) <span class="hljs-meta"><span class="hljs-meta">@Singleton</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppComponent</span></span></span><span class="hljs-class"> </span></span>{ FirstComponent.<span class="hljs-function"><span class="hljs-function">Builder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">firstComponentBuilder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; SecondComponent.<span class="hljs-function"><span class="hljs-function">Builder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">secondComponentBuilder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre> <br><p>  <code>AppComponent</code> has two <code>Subcomponent</code> .  Drew attention to this design - <code>FirstComponent.Builder</code> ?  About her, we will later. <br>  Now look at the <code>UtilsModule</code> . </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UtilsModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-meta"><span class="hljs-meta">@NonNull</span></span> <span class="hljs-meta"><span class="hljs-meta">@Reusable</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> NumberUtils </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideNumberUtils</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NumberUtils(); } <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-meta"><span class="hljs-meta">@NonNull</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> StringUtils </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideStringUtils</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringUtils(); } }</code> </pre> <br><p>  <code>NumberUtils</code> with <code>@Reusable</code> , and <code>StringUtils</code> left <code>unscoped</code> . <br>  Next we have two <code>Subcomponents</code> . </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@FirstScope</span></span> <span class="hljs-meta"><span class="hljs-meta">@Subcomponent</span></span>(modules = FirstModule.class) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FirstComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Subcomponent</span></span>.Builder <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Builder</span></span></span><span class="hljs-class"> </span></span>{ FirstComponent.<span class="hljs-function"><span class="hljs-function">Builder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">firstModule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FirstModule firstModule)</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">FirstComponent </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MainActivity mainActivity)</span></span></span></span>; } <span class="hljs-meta"><span class="hljs-meta">@SecondScope</span></span> <span class="hljs-meta"><span class="hljs-meta">@Subcomponent</span></span>(modules = {SecondModule.class}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SecondComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Subcomponent</span></span>.Builder <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Builder</span></span></span><span class="hljs-class"> </span></span>{ SecondComponent.<span class="hljs-function"><span class="hljs-function">Builder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">secondModule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SecondModule secondModule)</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">SecondComponent </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SecondActivity secondActivity)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ThirdActivity thirdActivity)</span></span></span></span>; }</code> </pre> <br><p>  As we can see, <code>FirstComponent</code> injects only into <code>MainActivity</code> , and <code>SecondComponent</code> into <code>SecondActivity</code> and <code>ThirdActivity</code> . <br>  Let's see the code. </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> NumberUtils numberUtils; <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> StringUtils stringUtils; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); MyApplication.getInstance().getFirstComponent() .inject(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-comment"><span class="hljs-comment">// other... } } public class SecondActivity extends AppCompatActivity { @Inject NumberUtils numberUtils; @Inject StringUtils stringUtils; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_second); MyApplication.getInstance().getSecondComponent() .inject(this); // other... } } public class ThirdActivity extends AppCompatActivity { @Inject NumberUtils numberUtils; @Inject StringUtils stringUtils; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_third); MyApplication.getInstance().getSecondComponent() .inject(this); // other... } }</span></span></code> </pre> </div></div><br><p>  Briefly about navigation.  From <code>MainActivity</code> we get to <code>SecondActivity</code> , and then to <code>ThirdActivity</code> .  And now the question.  When we will be on the third screen, how many <code>NumberUtils</code> and <code>StringUtils</code> will be created? </p><br><p>  Since <code>StringUtils</code> is <code>unscoped</code> , three instances will be created, that is, with each injection, a new object is created.  This we know. </p><br><p>  But <code>NumberUtils</code> objects will be two - one for <code>FirstComponent</code> , and the other for <code>SecondComponent</code> .  And here I will again bring the main idea about <code>@Reusable</code> from the documentation: " <strong>For each component that uses the <code>@Reusable</code> dependency, this dependency is cached separately!</strong> ", Unlike the <code>scope</code> annotation, where the object is cached at creation and <strong>its instance is used by child and dependent components</strong> . </p><br><p>  But Google users themselves warn that if you need a unique object, which can also be mutable, then use only <code>scoped</code> annotations. </p><br><p>  I will also give a <a href="http://stackoverflow.com/questions/39136042/dagger-reusable-scope-vs-singleton">link</a> to the question about comparing <code>@Singleton</code> and <code>@Reusable</code> with SO. </p><br><h3 id="subcomponentbuilder">  @ Subcomponent.Builder </h3><br><p>  A feature that makes the code more beautiful.  Previously, to create <code>@Subcomponent</code> we had to write something like this: </p><br><div class="spoiler">  <b class="spoiler_title">As it was</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Component</span></span>(modules = {AppModule.class, UtilsModule.class}) <span class="hljs-meta"><span class="hljs-meta">@Singleton</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">FirstComponent </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plusFirstComponent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FirstModule firstModule, SpecialModule specialModule)</span></span></span></span>; } <span class="hljs-meta"><span class="hljs-meta">@FirstScope</span></span> <span class="hljs-meta"><span class="hljs-meta">@Subcomponent</span></span>(modules = {FirstModule.class, SpecialModule.class}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FirstComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MainActivity mainActivity)</span></span></span></span>; }</code> </pre> <br><p>  Creating <code>FirstComponent</code> : </p><br><pre> <code class="java hljs">appComponent .plusFirstComponent(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FirstModule(), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpecialModule());</code> </pre> </div></div><br><p>  I did not like in this approach that the parent component was loaded with unnecessary knowledge about the modules that the child subcomponents use.  Well, plus the transfer of a large number of arguments does not look very nice, because for this there is a <strong>Builder</strong> pattern.  Now it has become more beautiful: </p><br><div class="spoiler">  <b class="spoiler_title">As it became</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Component</span></span>(modules = {AppModule.class, UtilsModule.class}) <span class="hljs-meta"><span class="hljs-meta">@Singleton</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppComponent</span></span></span><span class="hljs-class"> </span></span>{ FirstComponent.<span class="hljs-function"><span class="hljs-function">Builder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">firstComponentBuilder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; } <span class="hljs-meta"><span class="hljs-meta">@FirstScope</span></span> <span class="hljs-meta"><span class="hljs-meta">@Subcomponent</span></span>(modules = {FirstModule.class, SpecialModule.class}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FirstComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Subcomponent</span></span>.Builder <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Builder</span></span></span><span class="hljs-class"> </span></span>{ FirstComponent.<span class="hljs-function"><span class="hljs-function">Builder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">firstModule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FirstModule firstModule)</span></span></span></span>; FirstComponent.<span class="hljs-function"><span class="hljs-function">Builder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">specialModule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SpecialModule specialModule)</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">FirstComponent </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MainActivity mainActivity)</span></span></span></span>; }</code> </pre> <br><p>  Creating a <code>FirstComponent</code> now looks like this: </p><br><pre> <code class="java hljs">appComponent .firstComponentBuilder() .firstModule(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FirstModule()) .specialModule(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpecialModule()) .build();</code> </pre> </div></div><br><p>  Another thing =) </p><br><h3 id="static">  static </h3><br><p>  Now we have the opportunity to do this: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">currentUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AuthManager authManager)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> authManager.currentUser(); }</code> </pre> <br><p>  That is, we can make the methods responsible for providing dependencies in the modules static.  At first I didn‚Äôt quite understand, but why is it really necessary?  And it turns out, the request for such a feature existed for a long time, and there are situations when it is profitable. </p><br><p>  SO asked a <a href="http://stackoverflow.com/questions/38933560/different-singleton-static-provides-in-dagger2">good question</a> on this topic, they say, and what is the difference <code>@Singleton</code> and <code>@Provide static</code> .  To understand this difference well, you need to read the answer to the question, experimenting in parallel and looking at the generated code. </p><br><p>  So, we have an introductory.  We have three variants of the same method in the module: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-function"><span class="hljs-function">User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">currentUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AuthManager authManager)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> authManager.currentUser(); } <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-meta"><span class="hljs-meta">@Singleton</span></span> <span class="hljs-function"><span class="hljs-function">User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">currentUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AuthManager authManager)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> authManager.currentUser(); } <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">currentUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AuthManager authManager)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> authManager.currentUser(); }</code> </pre> <br><p>  In this case, <code>authManager.currentUser()</code> at different points in time can give different instances. <br>  The logical question is: how do these methods differ? </p><br><p>  In the first case, we have a classic <code>unscope</code> .  Each request will be given a new instance of <code>authManager.currentUser()</code> (more precisely, a new reference to <code>currentUser</code> ). </p><br><p>  In the second case, the first request will be cached with a link to <code>currentUser</code> , and with each new request this link will be given.  That is, if the <code>currentUser</code> changed in <code>AuthManager</code> , then the old reference to the invalid instance will be given. </p><br><p>  The third case is more interesting.  This method is similar in behavior to <code>unscope</code> , that is, each request will be given a new link.  This is the first difference from <code>@Singleton</code> , which caches objects.  Thus, placing the object's initialization in the <code>@Provide static</code> method is not entirely appropriate. </p><br><p>  But then <code>@Provide static</code> different from <code>unscope</code> ?  Suppose we have such a module: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-function"><span class="hljs-function">User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">currentUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AuthManager authManager)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> authManager.currentUser(); } }</code> </pre> <br><p>  <code>AuthManager</code> comes from another module as a <code>Singleton</code> .  Now let's quickly take a look at the generated <code>AuthModule_CurrentUserFactory</code> code (in the studio, just put the cursor on <code>currentUser</code> and press Ctrl + B): </p><br><div class="spoiler">  <b class="spoiler_title">Unscope</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Generated</span></span>( value = <span class="hljs-string"><span class="hljs-string">"dagger.internal.codegen.ComponentProcessor"</span></span>, comments = <span class="hljs-string"><span class="hljs-string">"https://google.github.io/dagger"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthModule_CurrentUserFactory</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Factory</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> AuthModule <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Provider&lt;AuthManager&gt; authManagerProvider; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AuthModule_CurrentUserFactory</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( AuthModule </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">module</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Provider&lt;AuthManager&gt; authManagerProvider)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span> != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">module</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> authManagerProvider != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.authManagerProvider = authManagerProvider; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Preconditions.checkNotNull( <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>.currentUser(authManagerProvider.get()), <span class="hljs-string"><span class="hljs-string">"Cannot return null from a non-@Nullable @Provides method"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Factory&lt;User&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AuthModule </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">module</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Provider&lt;AuthManager&gt; authManagerProvider)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AuthModule_CurrentUserFactory(<span class="hljs-keyword"><span class="hljs-keyword">module</span></span>, authManagerProvider); } <span class="hljs-comment"><span class="hljs-comment">/** Proxies {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@link</span></span></span><span class="hljs-comment"> AuthModule#currentUser(AuthManager)}. */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">proxyCurrentUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AuthModule instance, AuthManager authManager)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> instance.currentUser(authManager); } }</code> </pre> </div></div><br><p>  And if you add static to <code>currentUser</code> : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">currentUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AuthManager authManager)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> authManager.currentUser(); } }</code> </pre> <br><p>  Then we get: </p><br><div class="spoiler">  <b class="spoiler_title">static</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Generated</span></span>( value = <span class="hljs-string"><span class="hljs-string">"dagger.internal.codegen.ComponentProcessor"</span></span>, comments = <span class="hljs-string"><span class="hljs-string">"https://google.github.io/dagger"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthModule_CurrentUserFactory</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Factory</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Provider&lt;AuthManager&gt; authManagerProvider; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AuthModule_CurrentUserFactory</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Provider&lt;AuthManager&gt; authManagerProvider)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> authManagerProvider != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.authManagerProvider = authManagerProvider; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Preconditions.checkNotNull( AuthModule.currentUser(authManagerProvider.get()), <span class="hljs-string"><span class="hljs-string">"Cannot return null from a non-@Nullable @Provides method"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Factory&lt;User&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Provider&lt;AuthManager&gt; authManagerProvider)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AuthModule_CurrentUserFactory(authManagerProvider); } <span class="hljs-comment"><span class="hljs-comment">/** Proxies {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@link</span></span></span><span class="hljs-comment"> AuthModule#currentUser(AuthManager)}. */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> User </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">proxyCurrentUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AuthManager authManager)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> AuthModule.currentUser(authManager); } }</code> </pre> </div></div><br><p>  Note that in the <code>static</code> version there is no <code>AuthModule</code> .  Thus, the static method is jerked by the component <strong>directly, bypassing the module</strong> .  And if there is only one static method in the module, the module instance is not even created. </p><br><p>  Savings and minus unnecessary challenges.  Actually we have a performance gain.  They also write that calling a static method is 15-20% faster than calling a similar non-static method.  If I'm wrong, <a href="https://habr.com/users/iamironz/" class="user_link">iamironz will</a> correct me.  Oh, he knows for sure, and if necessary, he will. </p><br><h3 id="binds--inject-konstruktora">  @Binds + <a href="https://habr.com/users/inject/" class="user_link">inject</a> constructor </h3><br><p>  Mega-convenient bundle, which significantly reduces the boilerplate-code.  At the dawn of studying Dagger, I did not understand why we needed designer injections.  What and where it comes from.  And then @Binds appeared.  But everything is actually quite simple.  Thank you for helping <strong>Vladimir Tagakov</strong> and this <a href="https://android.jlelse.eu/inject-interfaces-without-providing-in-dagger-2-618cce9b1e29">article</a> . </p><br><p>  Consider a typical situation.  There is a Presenter interface and its implementation: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IFirstPresenter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FirstPresenter</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IFirstPresenter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FirstPresenter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{} <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{} }</code> </pre> <br><p>  We, as white people, will provide the whole thing in the module and inject the Presenter interface into activations: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FirstModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-meta"><span class="hljs-meta">@FirstScope</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IFirstPresenter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideFirstPresenter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FirstPresenter(); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> IFirstPresenter firstPresenter; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); MyApplication.getInstance().getFirstComponent() .inject(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-comment"><span class="hljs-comment">// others } }</span></span></code> </pre> <br><p>  Suppose that our <code>FirstPresenter</code> needs helpers to whom it delegates some of the work.  To do this, you need to create two more methods in the module, which will provide new classes, then change the <code>FirstPresenter</code> constructor, and <code>FirstPresenter</code> update the corresponding method in the module. </p><br><p>  The module will be: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FirstModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-meta"><span class="hljs-meta">@FirstScope</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> HelperClass1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideHelperClass1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HelperClass1(); } <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-meta"><span class="hljs-meta">@FirstScope</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> HelperClass2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideHelperClass2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HelperClass2(); } <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-meta"><span class="hljs-meta">@FirstScope</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IFirstPresenter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideFirstPresenter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( HelperClass1 helperClass1, HelperClass2 helperClass2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FirstPresenter(helperClass1, helperClass2); } }</code> </pre> <br><p>  And so every time, if you need to add some class and "share" it with others.  ""  .  -   ,  ?   ,    . </p><br><p> -,         ,    ( <code>HelperClass1</code>  <code>HelperClass2</code> ),      .     : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@FirstScope</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HelperClass1</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HelperClass1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } } <span class="hljs-meta"><span class="hljs-meta">@FirstScope</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HelperClass2</span></span></span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HelperClass2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } }</code> </pre> <br><p>  ,       <code>@FirstScope</code> ,    ,       . </p><br><p>         <code>HelperClass1</code>  <code>HelperClass2</code> : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FirstModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-meta"><span class="hljs-meta">@FirstScope</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IFirstPresenter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideFirstPresenter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( HelperClass1 helperClass1, HelperClass2 helperClass2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FirstPresenter(helperClass1, helperClass2); } }</code> </pre> <br><p>       ?    <code>@Binds</code> : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FirstModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@FirstScope</span></span> <span class="hljs-meta"><span class="hljs-meta">@Binds</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> IFirstPresenter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideFirstPresenter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FirstPresenter firstPresenter)</span></span></span></span>; }</code> </pre> <br><p>   <code>FirstPresenter</code>   : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@FirstScope</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FirstPresenter</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IFirstPresenter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> HelperClass1 helperClass1; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> HelperClass2 helperClass2; <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FirstPresenter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HelperClass1 helperClass1, HelperClass2 helperClass2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.helperClass1 = helperClass1; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.helperClass2 = helperClass2; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{} }</code> </pre> <br><p>   ? <code>FirstModule</code>    ,    <code>provideFirstPresenter</code> .  <code>provideFirstPresenter</code>   <code>@Provide</code> ,   <code>@Binds</code> .       ,  <strong> </strong> ! <br>  <code>FirstPresenter</code>  <code>scope</code>  ‚Äî <code>@FirstScope</code> ,    ,    .      <code>@Inject</code> .   ,       ! </p><br><p>        <a href="https://habr.com/users/mujahit/" class="user_link">Mujahit</a> . <br>  ,  <code>FirstModule</code>   <code>FirstComponent</code> ,        <code>AppComponent</code> .    <code>FirstComponent</code>    : </p><br><pre> <code class="java hljs">appComponent .firstComponentBuilder() .firstModule(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FirstModule()) .specialModule(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpecialModule()) .build();</code> </pre> <br><p>       <code>FirstModule</code> ,    ?     ,         ,      ,         : </p><br><pre> <code class="java hljs">appComponent .firstComponentBuilder() .build();</code> </pre> <br><p>        ,             . </p><br><p>  ,       ,      : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FirstModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@FirstScope</span></span> <span class="hljs-meta"><span class="hljs-meta">@Binds</span></span> <span class="hljs-function"><span class="hljs-function">IFirstPresenter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideFirstPresenter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FirstPresenter firstPresenter)</span></span></span></span>; }</code> </pre> <br><p>            . ""    : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FirstModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@FirstScope</span></span> <span class="hljs-meta"><span class="hljs-meta">@Binds</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> IFirstPresenter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideFirstPresenter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FirstPresenter firstPresenter)</span></span></span></span>; <span class="hljs-meta"><span class="hljs-meta">@FirstScope</span></span> <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> HelperClass3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideHelperClass3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// &lt;- Incorrect! return new HelperClass3(); } @FirstScope @Provides public static HelperClass3 provideHelperClass3() { // &lt;- Ok! return new HelperClass3(); } }</span></span></code> </pre> <br><h2 id="o-chem-esche-ne-skazano">      </h2><br><p>              : </p><br><ol><li><p> <strong>Muitibindings</strong> .  ""    ( <code>Set</code>  <code>Map</code> ).      ("plugin architecture").     <a href="https://medium.com/%40hamidgh/dagger-multibinding-sets-and-maps-713254b7f734">    </a> .     <strong>Muitibindings</strong>      <a href="http://frogermcs.github.io/inject-everything-viewholder-and-dagger-2-example/"></a>  <a href="http://frogermcs.github.io/activities-multibinding-in-dagger-2/"></a> .     <a href="https://google.github.io/dagger/multibindings.html">   </a> .         . </p><br></li><li><p> <strong>Releasable references</strong> .      .       ,      .    . <br>  <a href="https://google.github.io/dagger/users-guide.html"></a> ( <em>Releasable references</em> )    ,   . </p><br></li><li><p> <strong></strong> .  ,  Unit-   .    ,   UI       .      <a href="https://habr.com/users/artem_zin/" class="user_link">Artem_zin</a>   <a href="https://artemzin.com/blog/android-development-culture-the-document-qualitymatters/"></a>  <a href="https://github.com/artem-zinnatullin/qualitymatters"></a> .    <a href="https://google.github.io/dagger/testing.html">   </a> .  -     ,    .        .    ( )   <a href=""> </a> . ,  ,             ,        <code>Application</code> .   ? </p><br></li><li><p> <strong>@BindsOptionalOf</strong> .    <code>Optional</code>  Java 8  Guava,        .  ,   <a href="https://google.github.io/dagger/users-guide.html"></a>   . </p><br></li><li> <strong>@BindsInstance</strong> .  ,  dagger 2.8     .     ,    -    .   ,    <code>AppComponent</code>   <code>Context</code> .          .   <a href="https://google.github.io/dagger/users-guide.html"></a>  . </li></ol><br><p>  Well that's all!     .  -    , !  Fix it.   <a href="https://t.me/dagger_2">  Dagger2  </a> ,       . </p><br><p>  ,        .     <a href="https://t.me/Android_Architecture">  </a> .  ,   <a href="http://androiddev.apptractor.ru/">AndroidDevPodcast</a>  ,  .  Follow the news! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/320676/">https://habr.com/ru/post/320676/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../320666/index.html">Netbeans tricks and tricks on live examples</a></li>
<li><a href="../320668/index.html">And if without JavaScript?</a></li>
<li><a href="../320670/index.html">PHP 7.1.1 FPM vs Node.js 7.4.0 as a web backend server</a></li>
<li><a href="../320672/index.html">Intellectual system ELIS</a></li>
<li><a href="../320674/index.html">Automatic visualization of the python code. Part Two: Implementation</a></li>
<li><a href="../320678/index.html">Correct problem detection with Zabbix</a></li>
<li><a href="../320682/index.html">Nested logical expressions</a></li>
<li><a href="../320684/index.html">A little about Swift runtime or where NSObject disappeared</a></li>
<li><a href="../320686/index.html">The practice of metaprogramming in C ++: binary search tree at compile time</a></li>
<li><a href="../320690/index.html">Notify at any cost about the fall of the site. Practical advice</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>