<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Palantir: how to detect a botnet</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In 2009, Chinese cyber prospecting experienced the power of the all-seeing eye of Palantir. Information Warfare Monitor analysts have uncovered major ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Palantir: how to detect a botnet</h1><div class="post__text post__text-html js-mediator-article">  In 2009, Chinese cyber prospecting experienced the power of the all-seeing eye of Palantir.  <a href="https://en.wikipedia.org/wiki/Information_Warfare_Monitor">Information Warfare Monitor</a> analysts have uncovered major Chinese intelligence operations ‚Äî <a href="https://en.wikipedia.org/wiki/GhostNet">Ghostnet</a> and the <a href="https://en.wikipedia.org/wiki/Shadow_Network">Shadow Network</a> .  ( <a href="https://www.palantir.com/wp-assets/wp-content/uploads/2012/08/ImpactStudy_GhostNet.pdf">report</a> ) <br><br>  Together with <a href="http://www.edsd.ru/ru/uslugi/avtomatizaciya-biznesprocessov">Edison, we</a> continue to investigate the capabilities of the Palantir system. <br><img src="https://habrastorage.org/files/be4/56c/33a/be456c33a5324e2ab7ba30e6b57903eb.jpg"><br><br>  <i>‚ÄúI hope there are not many years left before the human brain and computers will be closely connected, and the resulting partnership will think like the human brain can never, and process the data in ways that are not available to the machines we know.‚Äù</i> <a href="https://habrahabr.ru/company/edison/blog/277903/">Said Joseph Liklider 56 years ago</a> , he started the department of information technology in leading universities in America and began to build ARPANET.  <i>‚ÄúPeople will set goals, formulate hypotheses, define criteria, and carry out assessment.</i>  <i>Computers will do routine work to clear the way for technical and scientific discoveries. ‚Äù</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>‚ÄúThe complementarity of a person and a computer is not only a global fact.</i>  <i>It is also the way to build a successful business.</i>  <i>I realized this from my own experience with PayPal.</i>  <i>In the mid-2000s, our company, having survived the collapse of the dot-com bubble, quickly grew, but we were disturbed by one serious problem: due to credit card fraud, we lost more than $ 10 million monthly.</i>  <i>Performing hundreds and even thousands of translations per minute, we could not physically track each of them - no team of controllers could work at this speed.</i>  <i>We did what any team of engineers would do in our place: we tried to find an automated solution. ‚Äù</i> <br>  Peter Thiel said and founded Palantir. <br><br>  Under the kat case about how using a tool for financial analytics, you can open a botnet. <br>  The case is ‚Äúfictional,‚Äù but the screenshots show 2009 data. <br><br>  <i>(For help with the translation, thanks to Vorsin Alexey)</i> <br><a name="habracut"></a><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/P8zFX8yGPbo%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjxrWZ2tmFXKejrrH3yGzhh9_pdOA" frameborder="0" allowfullscreen=""></iframe><br><br>  0:00 This video will show how using Palantir for financial analytics, we can explore non-financial data structured over time. <br>  0:09 To be precise, we‚Äôll show a revelation of a possible botnet attack made on the basis of analyzing a certain number of cyberdata using Palantir Finance and Palantir Goverment. <br>  0:16 All information about connections rejected by a router in four days will be given. <br>  0:22 We‚Äôll see how the analyst will examine the data and investigate what looks suspicious. <br>  0:28 We will start at a very general level, over the entire set of objects and we will add filters one by one, thus going down, step by step. <br>  0:35 The field below will show the filtered objects. <br>  0:41 To get started, we will distribute the data on rejected connections to the ports to which they are directed.  We do this using a filter. <br>  0:48 There are many types of filters for researching data. <br><br><img src="https://habrastorage.org/files/503/409/c19/503409c193994cf6845debd6335bb5a0.jpg"><br><br>  0:51 We can filter by data properties, and for this we use filters on the left, at the top of the screen. <br>  0:54 By numeric values ‚Äã‚Äãusing a histogram and other filters. <br>  0:58 By time-based properties using timeline filters. <br>  1:01 We want to find out how many connections were rejected on all ports of destination, so we will add a filter ‚Äúby port destination‚Äù. <br>  1:10 The histogram filter shows us the distribution of destination ports. <br><br><img src="https://habrastorage.org/files/afb/af2/b7f/afbaf2b7fcc843d0a8c6be76bf637dd4.jpg"><br><br>  1:14 Along the X axis there are different groups of ports, along the Y axis we see how many connections are fixed in the port bucket. <br><br><img src="https://habrastorage.org/files/dc4/817/8b5/dc48178b59ea48428681e9bbac9f4189.jpg"><br><br>  1:21 The histogram shows us several different things: first, we see that almost all the ports were involved. <br>  1:27 The highest concentration of activity is noticeable in ports up to 5000, which makes sense, since this segment includes the most frequently used ports, for example, the AD port for HTTP or port 23 for Telnet. <br><br><img src="https://habrastorage.org/files/3e3/329/90b/3e332990b7fa4c039d860f69de5b9ea5.jpg"><br><br>  1:37 Let's look at the largest column. <br>  1:41 Looking at the field below, we see that this column refers to port 1434, which is significant, as this port is used for MS SQL, and it is often the target of a SQL slammer worm. <br><br><img src="https://habrastorage.org/files/bc3/74b/676/bc374b67618e4f0c81b49d3f09432ce0.jpg"><br><br>  1:51 Ports with higher numbering are less commonly used for legitimate purposes, so we examine one of these port segments. <br>  1:56 We can click on the port segment to filter the results by objects from this segment. <br>  2:00 This segment may contain several ports, but we are only interested in one, the most frequently involved. <br>  2:07 We can use ‚Äúzoom‚Äù (Zoom) - one of the selection functions in the histogram. <br>  2:09 Increasing, we see that port 18100 is responsible for almost all connections. <br><br><img src="https://habrastorage.org/files/0ed/ce5/49c/0edce549c19f4094950b82be4da5c774.jpg"><br><br>  2:15 We will allocate this port to investigate connections addressed to it. <br>  2:20 Let's see how these connections are distributed by IP address. <br>  2:25 We can add a category filter to see all the IP addresses that are targeted for this segment (ports). <br>  2:30 We see that almost all connections are addressed to the same IP. <br><br><img src="https://habrastorage.org/files/6a2/3d0/7c3/6a23d07c30da4255bfb2fdce6264d00e.jpg"><br><br>  2:33 We‚Äôll highlight this address to see only connections connected to it. <br>  2:37 Now we examine these connections by the time they appear. <br>  2:41 We‚Äôll do this by adding a ‚Äúconnection time‚Äù filter. <br><br><img src="https://habrastorage.org/files/f9f/f26/c9f/f9ff26c9f3394a00a3f923b9039a0412.jpg"><br><br>  2:45 We can see that the entire mass of connections occurred within ten hours, and the number of connections grew, reached a peak, and eventually disappeared. <br><br>  2:53 This is an interesting example, we will come back to it later. <br>  2:56 To get a better idea of ‚Äã‚Äãthe data, let's explore the sources of these connections.  Especially, we want to see such connection characteristics as the IP address and source port by connection time. <br>  3:07 We can investigate this with the scatterplot filter. <br>  3:12 For the X axis, we take time; for the Y axis, the port of the connection source. <br>  3:20 We can use colors as the third axis, the value is the IP address of the source of the connection. <br>  3:31 This means that the same source IP addresses will be the same color. <br>  3:37 We can see something interesting here: some ports were targeted only for a small number of IP addresses, which we can see at points of similar color and located only horizontally. <br><br><img src="https://habrastorage.org/files/22c/8d3/156/22c8d315602b45258f1c46688a086374.jpg"><br><br>  3:47 A number of other ports seem to be the target for all the multiple IP addresses. <br>  3:52 We can also see several diagonal orange stripes, let's examine them in more detail. <br>  4:00 The fact that the lanes are diagonal means that the port number of the connection source has increased steadily. <br><br><img src="https://habrastorage.org/files/112/8e9/05e/1128e905e23f47459f0579cfba65b3ee.jpg"><br><br>  4:06 The fact that the bands are close in color means that the connection came from similar IP addresses. <br>  4:09 Let's see if we can concentrate on them. <br>  4:13 To begin, pick a strip.  Once we have selected several numbers from the band, we can add a filter by IP address of the connection source. <br><br><img src="https://habrastorage.org/files/702/130/387/7021303876e645ae93492811a479b790.jpg"><br><br>  4:23 And we see that all these connections came from the same IP, which I expected in color. <br><br><img src="https://habrastorage.org/files/325/99a/a90/32599aa901e74a1f997643d46bbfc1ad.jpg"><br><br>  4:29 We can isolate this IP and put this filter on top of another to refine the scatterplot results. <br>  4:35 We can minimize the filter by category and see the scatter diagram only at this IP address. <br><br><img src="https://habrastorage.org/files/30f/a0b/921/30fa0b921dc94250ba071e5355329653.jpg"><br><br>  4:41 We see that this IP address is undoubtedly being redirected to different sending ports, over time.  This is a classic port scanning behavior. <br>  4:50 This work revealed suspicious activity: many different IPs cyclically and through many ports were aimed at connecting to one IP and one port in a short period of time. <br>  5:02 Now we use the Palantir Goverment to analyze this data over time and by geography. <br><br><img src="https://habrastorage.org/files/dd1/b31/2e9/dd1b312e968e4d96b6fa1118dd66452b.jpg"><br><br>  5:06 We created a filter to compact a subset of the data that we found interesting with Palantir Finance.  The filter parameters are objects ‚Äúconnection‚Äù, aimed at the IP address 25.134.141.209 and port 18100. <br><br><img src="https://habrastorage.org/files/cca/dd7/b52/ccadd7b52cc64d57900064ca506b06d6.jpg"><br><br>  5:20 Filter results appeared on the graph. <br><br><img src="https://habrastorage.org/files/b68/759/664/b687596642e64c438e52304000cfe29f.jpg"><br><br>  5:25 We can open the timeline and see that it is similar to the one we saw in Palantir Finance. <br>  5:30 Now we drag these objects onto the map to see the location of the IP addresses of these connections. <br><br><img src="https://habrastorage.org/files/801/137/5ff/8011375ffeee47999988f67f7d18001f.jpg"><br><br>  5:37 A heat map using color helps to see the density of connections. <br><br><img src="https://habrastorage.org/files/ab9/f8d/dc4/ab9f8ddc45434d3b915f7ba400948e8a.jpg"><br><br>  5:42 We see the highest density in China. <br>  5:47 With the help of the time line, we can see how events have developed. <br>  5:51 We create a time window and move it to see how the heat map reacts. <br><br><img src="https://habrastorage.org/files/09f/bb8/83c/09fbb883c5a94488922f8f278bb6699b.jpg"><br><br>  5:57 We see connections started in China, then spread to Japan and Indonesia, then we see areas in South America, Europe, and Australia. <br>  6:11 Finally, when the connection speed is over, they are concentrated again in China and Indonesia. <br>  6:23 This timeline and activation scheme clearly indicates a botnet attack.  When an attack begins, and an increasing number of computers are drawn into it, the number of connections rises to a peak, then gradually decreases as each computer tries to make a different number of connections or connects at a different speed. <br>  6:40 During this work session, we used Palantir Finance to explore a large amount of data, and successfully reduced it to a subset of data using filters. <br>  6:49 We were able to see several characteristics of the data and found suspicious activity. <br>  6:56 The results of our work at Palantir Finance were opened in Palantir Goverment, which made it possible to carry out a geographical and temporal analysis, which made it possible to visualize how events developed. <br>  7:05 Ultimately, our analysis ended with the disclosure of activity, which is most likely a botnet attack. <br>  7:11 The same techniques that we used in disclosing characteristic features of a botnet attack from a large amount of connection data can be used to detect other malicious activity on the network, including narrow-non-disassemble-what, data extraction, attacks using methods social engineering, and more. <br>  7:26 All of this: Palantir Cyber ‚Äã‚Äãcombined offer, is a turnkey solution for dealing with the most burdensome network tasks faced by government and commercial institutions. <br><br><img src="https://habrastorage.org/files/ed4/08c/081/ed408c081007483d8d27ea689e64e96e.jpg"><br><br>  <b>More about Palantir:</b> <br><ul><li>  <a href="https://habrahabr.ru/company/edison/blog/280434/">Palantir and money laundering</a> </li><li>  <a href="https://habrahabr.ru/company/edison/blog/280444/">Palantir: arms trade and the spread of the pandemic</a> </li><li>  <a href="https://habrahabr.ru/post/262837/">Palantir, PayPal Mafia, special services, world government</a> </li><li>  <a href="https://habrahabr.ru/post/271883/">Palantir 101. What is allowed to ordinary mortals to know about the second most abrupt private company in Silicon Valley</a> </li></ul><br><br><hr><br><br>  Together with the company <a href="http://www.edsd.ru/ru/uslugi/razrabotka_po">Edison we</a> continue the spring marathon of publications. <br><br>  I will try to get to the primary sources of IT-technologies, to understand how they thought and what concepts were in the minds of the pioneers, what they dreamed about, how they saw the world of the future.  Why did you think ‚Äúcomputer‚Äù, ‚Äúnetwork‚Äù, ‚Äúhypertext‚Äù, ‚Äúintelligence amplifiers‚Äù, ‚Äúcollective problem solving system‚Äù, what meaning did they put into these concepts, what tools they wanted to achieve a result. <br><br>  I hope that these materials will serve as an inspiration for those who are wondering how to go <a href="https://megamozg.ru/post/2408/">‚Äúfrom Zero to Unit‚Äù</a> (to create something that had never happened before).  I would like IT and ‚Äúprogramming‚Äù to stop being just ‚Äúcoding for the sake of dough‚Äù, and recall that they were conceived as a lever to change the <s>methods of warfare,</s> education, a way of working together, thinking and communication, as an attempt to solve world problems and answer facing humanity.  Something like this. <br><br>  0 March.  <a href="https://habrahabr.ru/company/edison/blog/277799/">Seymour papert</a> <br>  March 1.  <a href="https://habrahabr.ru/company/edison/blog/277803/">Xerox alto</a> <br>  March 2, <a href="https://habrahabr.ru/post/277913/">"Call Jake."</a>  <a href="https://habrahabr.ru/post/277913/">NIC and RFC history</a> <br>  March 3, <a href="https://habrahabr.ru/post/278399/">Grace "Grandma COBOL" Hopper</a> <br>  March 4 <a href="https://habrahabr.ru/company/edison/blog/278585/">Margaret Hamilton: "Guys, I'll send you to the moon"</a> <br>  March 5, <a href="https://habrahabr.ru/company/edison/blog/278653/">Hedy Lamarr.</a>  <a href="https://habrahabr.ru/company/edison/blog/278653/">And in the movie naked to play and torpedo the bullet into the enemy</a> <br>  March 7 <a href="https://habrahabr.ru/company/edison/blog/278741/">Gorgeous Six: girls who had a thermonuclear explosion calculated</a> <br>  March 8, <a href="https://habrahabr.ru/company/edison/blog/278447/">"Video Games, I'm your father!"</a> <br>  March 9th <a href="https://habrahabr.ru/company/edison/blog/278669/">Happy Birthday to Jeff Raskin</a> <br>  March 14 <a href="https://habrahabr.ru/company/edison/blog/277903/">Joseph "Lick" Liclider: "Intergalactic computer network" and "Symbiosis of man and computer"</a> <br>  March 15 <a href="https://habrahabr.ru/company/edison/blog/279241/">Vanivar Bush: ‚ÄúHow We Can Think‚Äù (As We May Think)</a> <br>  March 16th <a href="https://habrahabr.ru/company/edison/blog/279451/">Happy birthday, Richard Stallman</a> <br>  March 21 <a href="https://habrahabr.ru/company/edison/blog/279809/">Douglas Engelbart: "The Mother of All Demos".</a>  <a href="https://habrahabr.ru/company/edison/blog/279809/">Part 1</a> </div><p>Source: <a href="https://habr.com/ru/post/280930/">https://habr.com/ru/post/280930/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../280910/index.html">Vulnerabilities in MyChat by NetworkSoftwareSolutions (fixed and none)</a></li>
<li><a href="../280912/index.html">PostgreSQL useful tricks</a></li>
<li><a href="../280914/index.html">Sandbox for programmers</a></li>
<li><a href="../280922/index.html">Konami code or read between the lines</a></li>
<li><a href="../280928/index.html">Easy insertion of multiline pattern literals into JavaScript code</a></li>
<li><a href="../280932/index.html">QtWebApp is a step-by-step chewed example with detailed comments.</a></li>
<li><a href="../280938/index.html">Features and differences of the MSH programming language from MUMPS</a></li>
<li><a href="../280940/index.html">Disabled Cache Zone Module</a></li>
<li><a href="../280942/index.html">Announcement of the fourth meeting of the Java User Group Sevastopol</a></li>
<li><a href="../280944/index.html">PHP recursion - algorithm, application</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>