<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Solution of the problem "Performance Evaluation" mlbootcamp.ru</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Less than three days left before the end of the "Performance Evaluation" competition. Perhaps this article will help someone to improve their decision...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Solution of the problem "Performance Evaluation" mlbootcamp.ru</h1><div class="post__text post__text-html js-mediator-article">  Less than three days left before the end of the <a href="http://mlbootcamp.ru/championship/7/">"Performance Evaluation"</a> competition.  Perhaps this article will help someone to improve their decision.  The essence of the task is to predict the time of multiplication of two matrices on different computing systems.  As an estimate of the quality of the prediction, the smallest average relative error of <a href="https://en.wikipedia.org/wiki/Mean_absolute_percentage_error">MAPE is taken</a> . <br><br>  At the moment, the first place - 4.68%.  Below I want to describe my way to 6.69% (and this is already 70+ place). <br><a name="habracut"></a><br>  So, we have data for training in the form of a table with column 951.  Such a huge number of signs do not even make sense to begin to analyze "manually."  Therefore, we will try to apply some standard algorithm ‚Äúwithout looking‚Äù, but with a little data preparation: <br><br><h4>  Attempt # 1 </h4><br><ul><li>  There are gaps only in memFreq, about 11%.  Replace gaps with a mean; </li><li>  Delete non-informative columns (in which one value of the feature); </li><li>  Apply ExtraTreesRegressor. </li></ul><br>  These manipulations give mape = 11.22%.  And this is 154 out of 362 place.  Those.  better than half the participants. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Attempt # 2 </h4><br>  To apply linear algorithms, it is necessary to scale the attributes.  In addition, sometimes it helps to add new features based on existing ones.  For example, using <a href="http://scikit-learn.org/stable/modules/preprocessing.html">PolynomialFeatures</a> .  Since calculating the polynomial for all 951 signs is extremely resource-intensive, we divide all the signs into two parts: <br><ul><li>  performance related; </li><li>  associated with the matrix itself (mkn); </li></ul><br>  And we will calculate the polynomial only on matrix signs.  In addition, the response vector (y) is prioritized before learning, and when calculating the answers we will return the previous scale. <br><br>  A couple of simple manipulations are already given mape = 6.91% (ranked 80 out of 362).  It is worth paying attention that the RidgeCV () model is called with standard parameters.  In theory, it can still be tuned. <br><br><h4>  Attempt number 3 </h4><br>  The best result mape = 6.69% (72/362) gave a ‚Äúmanual‚Äù addition of signs.  Added three signs m * n, m * k, k * n. <br>  This also added the ratio of the maximum dimension of the matrix to the minimum dimension for both matrices. <br><br><div class="spoiler">  <b class="spoiler_title">Code to reproduce the result</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> linear_model <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write_answer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, str_add=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">"answer"</span></span>+str(str_add)+<span class="hljs-string"><span class="hljs-string">".txt"</span></span>, <span class="hljs-string"><span class="hljs-string">"w"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> fout: fout.write(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>.join(map(str, data))) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convert_cat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inf,inf_data)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> inf_data[inf_data == inf].index[<span class="hljs-number"><span class="hljs-number">0</span></span>] X = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'x_train.csv'</span></span>) y = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'y_train.csv'</span></span>) X_check = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'x_test.csv'</span></span>) <span class="hljs-comment"><span class="hljs-comment"># memFreq  .     X.memFreq = pd.to_numeric(X.memFreq, errors = 'coerce') mean_memFreq = 525.576 X.fillna(value = mean_memFreq, inplace=True) X_check.memFreq = pd.to_numeric(X_check.memFreq, errors = 'coerce') X_check.fillna(value = mean_memFreq, inplace=True) #    for c in X.columns: if len(np.unique(X_check[c])) == 1: X.drop(c, axis=1, inplace=True) X_check.drop(c, axis=1, inplace=True) #    cpuArch_ = pd.Series(np.unique(X.cpuArch)) X.cpuArch = X.cpuArch.apply(lambda x: convert_cat(x,cpuArch_)) X_check.cpuArch = X_check.cpuArch.apply(lambda x: convert_cat(x,cpuArch_)) memType_ = pd.Series(np.unique(X.memType)) X.memType = X.memType.apply(lambda x: convert_cat(x,memType_)) X_check.memType = X_check.memType.apply(lambda x: convert_cat(x,memType_)) memtRFC_ = pd.Series(np.unique(X.memtRFC)) X.memtRFC = X.memtRFC.apply(lambda x: convert_cat(x,memtRFC_)) X_check.memtRFC = X_check.memtRFC.apply(lambda x: convert_cat(x,memtRFC_)) os_ = pd.Series(np.unique(X.os)) X.os = X.os.apply(lambda x: convert_cat(x,os_)) X_check.os = X_check.os.apply(lambda x: convert_cat(x,os_)) cpuFull_ = pd.Series(np.unique(X.cpuFull)) X.cpuFull = X.cpuFull.apply(lambda x: convert_cat(x,cpuFull_)) X_check.cpuFull = X_check.cpuFull.apply(lambda x: convert_cat(x,cpuFull_)) #     perf_features = X.columns[3:] #   X['log_mn'] = np.log(Xm * Xn) X['log_mk'] = np.log(np.int64(Xm*Xk)) X['log_kn'] = np.log(np.int64(Xk*Xn)) X['min_max_a'] = np.float64(X.loc[:, ['m', 'k']].max(axis=1)) / X.loc[:, ['m', 'k']].min(axis=1) X['min_max_b'] = np.float64(X.loc[:, ['n', 'k']].max(axis=1)) / X.loc[:, ['n', 'k']].min(axis=1) X_check['log_mn'] = np.log(X_check.m * X_check.n) X_check['log_mk'] = np.log(np.int64(X_check.m*X_check.k)) X_check['log_kn'] = np.log(np.int64(X_check.k*X_check.n)) X_check['min_max_a'] = np.float64(X_check.loc[:, ['m', 'k']].max(axis=1)) / X_check.loc[:, ['m', 'k']].min(axis=1) X_check['min_max_b'] = np.float64(X_check.loc[:, ['n', 'k']].max(axis=1)) / X_check.loc[:, ['n', 'k']].min(axis=1) model = linear_model.RidgeCV(cv=5) model.fit(X, np.log(y)) y_answer = np.exp(model.predict(X_check)) write_answer(y_answer.reshape(4947), '_habr_RidgeCV')</span></span></code> </pre> <br></div></div><br><br><h4>  Afterword </h4><br>  I admit that I can only multiply matrices using Wikipedia.  And the methods of Strassen and the algorithms of Vinogradov, indicated in the description of the assignment, for me are something unreal to master.  For me, this is the first participation in a machine learning competition.  And a sense of personal pride enhances the fact that the result obtained looks good against the background of the work referenced by the authors of the competition - A. A. Sidneva, V. P. Gergel <a href="http://num-meth.srcc.msu.ru/zhurnal/tom_2014/pdf/v15r150.pdf">‚ÄúAutomatic selection of the most efficient implementations of algorithms‚Äù</a> . </div><p>Source: <a href="https://habr.com/ru/post/305872/">https://habr.com/ru/post/305872/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../305862/index.html">QA MeetUp Report from June 17th</a></li>
<li><a href="../305864/index.html">Freelance: reboot</a></li>
<li><a href="../305866/index.html">List of useful resources on Microsoft SQL Server</a></li>
<li><a href="../305868/index.html">Speech synthesizer "for robots" from scratch</a></li>
<li><a href="../305870/index.html">How Linus Torvalds made software development freer</a></li>
<li><a href="../305876/index.html">Restrictions on the use of smart LEDs WS2812, WS2801 and similar in modern projects of decorative lighting</a></li>
<li><a href="../305878/index.html">How to choose a server for 1C, SQL and terminals</a></li>
<li><a href="../305880/index.html">What's new is expected in v4.8-rc1 core for Intel Edison. Digest</a></li>
<li><a href="../305882/index.html">Pass a technical interview (Level 4)</a></li>
<li><a href="../305886/index.html">VShBI Lectures: Game Design and Game Operations</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>