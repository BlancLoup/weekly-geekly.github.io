<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Manage homemade iron over the air using Open Sound Control</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I will try to tell you how you can remotely control your self-made device connected to the network from a phone or tablet on iOS and A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Manage homemade iron over the air using Open Sound Control</h1><div class="post__text post__text-html js-mediator-article">  In this article I will try to tell you how you can remotely control your self-made device connected to the network from a phone or tablet on iOS and Android.  Anyone familiar with the topic at this point has already decided that it will be about the next web interface to your Arduino and mbedas - if I hurry to interrupt your thoughts, it will not.  The way that I want to talk about is quick, cheap, has ready feedback, convenient controls and has visibility, which will be envied by the most polished web interface. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/FfoujE4zGkU%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700190,15700253,15700255,15700259&amp;usg=ALkJrhggUNvUyhbHdLRuxm_TG01fYWiSXw" frameborder="0" allowfullscreen=""></iframe><br><br>  So that the material does not seem to be cut off from real life, I will show how we did this trick 4 months ago with our Lightpack.  This situation is slightly different from the spherical scenario of using the Open Sound Control protocol (further OSC) in a vacuum, but nevertheless is a good example of how it can be effectively used in rapid prototyping. <br><a name="habracut"></a><br><h4>  Task </h4><br>  We had an <a href="http://code.google.com/p/lightpack/">open-source USB backlight device</a> , which is controlled by cross-platform software and has an API for managing from external programs or plug-ins on the side of this software.  We wanted to control this device over the network from our tablets and smartphones.  Turn it on and off, change settings profiles, control brightness, adjust the backlight for each individual channel, and maybe even launch other plug-ins. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In your case, the situation may be different, not complicated by an intermediary in the form of a full-fledged PC and some kind of API.  For example, a device on the ARM / AVR periodically connecting to the network, or at least an Arduino with an ethernet shield that 24/7 logs for you the power consumption behind the dashboard at the entrance and sends the data straight to the Google document. <br><br>  The first thing that comes to mind to solve this problem is the web interface.  It would seem universal: you can access from any platform.  But we did not want to force the web server to constantly spin, no matter how microscopic it might be.  Yes, we didn‚Äôt find good web-interface designers that would have suitable controls, we didn‚Äôt want to draw our own and understood that the result can only work seriously on the desktop and ordinary MK will not master it if in the future we have to manage standalone -device. <br><br>  However, if you can connect to the device via the network (in our case, you can send commands to the API directly via Telnet) you could write a full-fledged application for the mobile platform that would just send message packets, and the server parsed them and thus control the device .  Despite the fact that in the evening we collected a <a href="http://www.youtube.com/watch%3Fv%3DEnvXaZcgNvA">small prototype for Android</a> , which exploited this method, it still remained ‚Äúexpensive‚Äù even in comparison with the web interface. <br><br>  As time went on, the task was recorded somewhere on the subcortex and didn‚Äôt get out until I accidentally stumbled upon the TouchOSC mobile app, which (almost) works equally well on iOS and Android. <br><br><img src="https://habrastorage.org/storage2/c39/b6b/e29/c39b6be290e6854a0757bf9813801821.png"><br><br>  After the demo videos and screenshots, it was simply impossible to pass by without trying.) <br><br><h4>  Idea </h4><br>  In short, the <a href="http://hexler.net/software/touchosc">TouchOSC</a> application ( <a href="http://itunes.apple.com/ru/app/touchosc/id288120394%3Fmt%3D8">AppStore</a> , <a href="https://play.google.com/store/apps/details%3Fid%3Dnet.hexler.touchosc%26feature%3Dsearch_result">Google Play</a> ) implements the OSC and MIDI protocol interfaces on your mobile devices, which all specialized synthesizers, sound editors, DJ programs, recording studios, etc., are used to working with. TouchOSC makes it possible not to use Only the predefined layouts for the controls (layouts) of the slider-tab buttons, but also very simple and fast to draw your own in a special editor.  All this stuff works through wi-fi, but it can also work by wire if there are special adapters. <br><br>  A typical layout from the preset looks like this.  Level of difficulty: "Koreans", which, however, does not prevent you from repeating it in the layout editor. <br><br><img src="https://habrastorage.org/storage2/b90/11f/bf2/b9011fbf2baeeda0c056f67e2ada9662.jpg"><br><br>  Surface analysis showed that this application is not the only one and, if desired, for iOS you can use iOSC, OSCemote, Mrmr OSC controller, Remokon for OSC (for Android, I will not even list them - there are even more).  The same analysis showed that the protocol itself is used in a large number of programs and devices, and the most important thing for us is that libraries and wrappers with its implementation exist for many programming languages ‚Äã‚Äãand platforms (for example, options for <a href="http://blog.makezine.com/2009/03/23/osc-library-for-arduino/">Arduino</a> and <a href="http://mbed.org/users/tobyspark/code/mbedOSC__spk/">mbed</a> ).  <a href="http://opensoundcontrol.org/implementations">An incomplete list</a> is on the official site. <br><br>  We have an opportunity to apply the new, interesting, at first glance, toolkit in an atypical way.  Ahead was a free day off, so with the words ‚Äúcall priyant‚Äù <a href="https://habrahabr.ru/users/timsat/" class="user_link">timsat</a> unfolded Google on one half of the monitor and Notepad ++ on the second. <br><br><h4>  Protocol </h4><br>  Open Sound Control is a batch protocol for transferring data between multimedia devices (primarily electronic musical instruments / synthesizers and PCs), which has recently been increasingly used as a substitute for MIDI.  The main features of the protocol work remains through the network, but <a href="http://archive.cnmat.berkeley.edu/OpenSoundControl/">there are other features</a> .  The latest version of the specification <a href="http://cnmat.berkeley.edu/publication/features_and_future_open_sound_control_version_1_1_nime">is available</a> on the website of the Center for Audio Technology at Berkeley University (CNMAT). <br><br>  As I already mentioned, today the typical use of the protocol is to provide an interface between input devices (synthesizers, tablets, game controllers, etc.) and specialized programs such as Super Collider, Traktor, REAPER, etc. OSC out of the box is supported by stunning devices like <a href="http://www.jazzmutant.com/lemur_overview.php">Lemur</a> and <a href="http://monome.org/">Monome</a> . <br><br>  Working over the network, the protocol allows data exchange in both directions, which allows for feedback from the device.  If you take a closer look at the screenshots, then some of the control buttons have an additional indicator that can be lit after the command sent earlier was executed by the server in reality.  Those.  Your tablet can reflect the real state of the device you are controlling (target).  If you get the hang of it, you can even draw graphics, but this is for men who know a lot about perversions. <br><br>  Here is an example of messages exchanged between the OSC server and the client: <br><br><pre><code class="hljs">/1/fader2 0.497120916843 /1/fader2 /z /1/rotary1 0.579584240913 /1/rotary1 0.605171322823 /1/rotary1 /z</code> </pre> <br>  In this case, we have the exact control ID and <i><b>/ 1 / fader2 0.497120916843</b></i> means that the second tab on the first tab (yes, there you can use several tabs within the same layout), the value 0.49 came to the server, etc.  The Z-message from this example can be enabled at will and I will tell about it later. <br><br>  In the example with Lightpack, it was convenient for us to send profile names to the tablet and switch between them.  In addition, when starting a session, the positions of all controls on the tablet are automatically aligned with the actual settings of the target device. <br><br><h4>  Implementation </h4><br>  To work with the Lightpack API, we use <a href="https://code.google.com/p/lightpack/wiki/pyLightpack">our own wrapper</a> written in Python.  Therefore, and also because the <a href="http://www.ixi-audio.net/content/body_backyard_python.html">OSC-library</a> satisfying us existed for Python, we decided to write a small script engine, which was a connector between the API and the network device that sent the OSC message.  The main requirements for such an implementation: <br><br><ul><li>  Availability of client / server ports (you can customize your own in TouchOSC) </li><li>  Client and server must be on the same network. </li></ul><br>  Although, if you dig deeper with the tunnels on your router, then the second restriction can be bypassed and managed to drink for your hamster from the office at the other end of the city. <br><br>  For those who, like me, prefer pictures, I‚Äôve got an interaction scheme: <br><br><img src="https://habrastorage.org/storage2/dee/1d2/bd6/dee1d2bd6af6912a5e76695715189b3f.jpg"><br><br>  In our case, the exchange between the connector and the API is implemented via sockets (this is a feature of the API itself), while, as seen in the demo, everything works pretty quickly.  Of course, in the equation with the hamster on Arduino, right behind the router will be the device itself with the center of logic in the form of a microcontroller with firmware which already includes libraries for working with the network and OSC. <br><br>  In fact, for implementation, we had to deal only with the process of initialization of the exchange, feedback and conversion of the received / transmitted values.  The lion's share of the code is taken by a simple mapping.  Those.  after you draw the layout you will have on your hands a list of addresses of controls (buttons, sliders, shortcuts, etc.), each of which must be compared with the API function.  Everything. <br><br><img src="https://habrastorage.org/storage2/357/179/30a/35717930a1a62250a7dd857011a0fd68.jpg" align="left"><br>  Honestly, I do not know what you can write more about.  In terms of programming, the task is primitive.  The source code of this ‚Äúconnector‚Äù as usual, <a href="http://code.google.com/p/lightpack/source/browse/Software/apiexamples/liOSC/LiOSC.py">lies in our repository</a> and is accessible to all. <br><br>  By the way, some pretty convenient additional features are implemented in TouchOSC: First, it is possible to use the <i><b>/ ping</b></i> message that the client and server exchange to maintain the connection even when the data itself does not run.  Secondly, the so-called <b>z-message</b> is supported - a special message that tells the server that the user at the client has finally finished lifting his finger on the screen (the moment the input is finished).  We did not use this feature, but I do not exclude that there are situations in which it will be extremely useful.  Thirdly, like most similar applications, TouchOSC can send data to the server from the <b>accelerometer</b> built into the mobile device.  Those.  You can use your smartphone or tablet as a tricky input device for your network homemade products (twist the camera on servos, etc.). <br><br><h4>  Underwater rocks </h4><br>  Everything about the interaction with the application TouchOSC runs smoothly.  Even the loading of own layouts is carried out ‚Äúthrough the air‚Äù with the push of a single button.  The only noticeable drawback so far is the impossibility of loading your own layout for the Android version.  In a correspondence with the author, he managed to convince me that ‚Äúalready about to prepare a release‚Äù. <br><br>  The library for Python was not well documented, so we initialized the data exchange process longer than actually programmed the layout behavior. <br><br>  In general, the process of creating such a machine is extremely intuitive and will not take much time.  That is why I would advise using OSC for rapid prototyping instead of full-fledged client-server stacks with web interfaces.  Especially if you are going to present this prototype at an event, or, say, to a customer, a more vivid implementation variant accompanied by wow! -How-you-is-missed-in-eppstor I simply don‚Äôt know. <br><br>  <i><b>So again: If you need to quickly and cheaply implement an easy way to visually control a homemade network device with feedback, then the OSC protocol is an interesting choice.</b></i> </div><p>Source: <a href="https://habr.com/ru/post/149838/">https://habr.com/ru/post/149838/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../149830/index.html">Review and refinement of the backlight for the e-book Hama 54308</a></li>
<li><a href="../149831/index.html">Curiosity ready to budge, laser tested tonight</a></li>
<li><a href="../149833/index.html">Experts called "endangered" professions in the world</a></li>
<li><a href="../149835/index.html">Simplify registration and work with DependencyProperty</a></li>
<li><a href="../149836/index.html">Energy-saving background location + sending data to the server from the background</a></li>
<li><a href="../149839/index.html">Google refuses the legendary button ‚ÄúI'm Feeling Lucky‚Äù</a></li>
<li><a href="../149844/index.html">Yii 1.1.12</a></li>
<li><a href="../149847/index.html">Do you use SIM card PIN protection?</a></li>
<li><a href="../149848/index.html">Is OnLive service shutting down?</a></li>
<li><a href="../149849/index.html">We investigate iOS SDK and we use undocumented API</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>