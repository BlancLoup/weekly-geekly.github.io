<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>You know what transducers are.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Transducers were announced back in 2014, since then a considerable number of articles have been written ( one , two ), but after one article I could n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>You know what transducers are.</h1><div class="post__text post__text-html js-mediator-article"><p>  Transducers were announced back in 2014, since then a considerable number of articles have been written ( <a href="https://habrahabr.ru/post/237613/">one</a> , <a href="https://habrahabr.ru/post/247889/">two</a> ), but after one article I could not say that I understand transducers are crystal clear.  After each article, I had a feeling that I understood something complicated, but it still remained difficult.  And then once in my head something clicked: "I already saw this pattern, only it was called differently!" </p><a name="habracut"></a><br><h3 id="zadacha">  Task: </h3><br><p>  There is an array of scores containing the results of my soccer games as an object with fields: </p><br><ul><li>  gameID - the number of the game; </li><li>  my - the number of points I have; </li><li>  others - the number of points from my opponent. </li></ul><br><p>  It is necessary to find the numbers of the first two games I won. </p><br><p>  The initial data for the task (the answer for such data is [1, 3]): </p><br><pre><code class="hljs perl">const scores = [ { gameID: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, others: <span class="hljs-number"><span class="hljs-number">2</span></span> }, { gameID: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, others: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { gameID: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, others: <span class="hljs-number"><span class="hljs-number">3</span></span> }, { gameID: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, others: <span class="hljs-number"><span class="hljs-number">2</span></span> }, { gameID: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, others: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { gameID: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, others: <span class="hljs-number"><span class="hljs-number">0</span></span> }, { gameID: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, others: <span class="hljs-number"><span class="hljs-number">1</span></span> }, ]</code> </pre> <br><h3 id="reshenie-1-imperativnyy-cikl">  Decision number 1.  Imperative cycle </h3><br><p>  Let's start from afar, return to those distant days when we wrote the usual imperative cycles and suffered from a changeable state (I agree that in this example it does not cause any problems): </p><br><pre> <code class="hljs perl">const result = [] //    ,      . <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (let i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; scores.length &amp;&amp; result.length &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>; i++) { const { gameID, <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>, others } = scores[i] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">my</span></span> &gt; others) { result.push(gameID) } }</code> </pre> <br><p>  It's all pretty simple, nice and fast, but imperative and mutable.  It is important to note that unnecessary iterations are not performed, the loop ends immediately after the array with the results receives the required number of elements. </p><br><h3 id="reshenie-2-arraymap-i-arrayfilter">  Decision number 2.  Array # map and Array # filter </h3><br><p>  This solution is already immutable, more expressive, "modern". </p><br><pre> <code class="hljs coffeescript">const result = scores .filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">({ my, others })</span></span></span><span class="hljs-function"> =&gt;</span></span> my &gt; others) <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   .map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">({ gameID })</span></span></span><span class="hljs-function"> =&gt;</span></span> gameID) <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    .slice(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   </code> </pre> <br><p>  This is exactly what most js developers would decide these days, I guess.  But this decision has one important problem: if in the previous decision we did only one pass, and that was not the end, now we already have two full passes.  If our scores contained a million elements, the predicate in the filter would be called a million times, the function in the map would apply a smaller, but still a large number of times, and in the end we still take only the first two elements.  Of course, premature optimization is evil, but this is not at any gate. </p><br><h3 id="reshenie-3-svertka">  Decision number 3.  Convolution </h3><br><p>  Convolutions can define [almost] any operation on arrays.  We have only one pass in this solution: </p><br><pre> <code class="hljs coffeescript">const result = scores.reduce(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(result, { my, others, gameID })</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>        , <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     . <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (my &gt; others &amp;&amp; result.length &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result.concat([gameID]) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result }, [])</code> </pre> <br><p>  This is somewhat similar to a solution with cycles, but here we are passing the intermediate state explicitly and immiablely.  But the problem remained - instead of two passes, we now have one, but it is still full, that is, with a million elements we will go through the entire million, even if we already received the required number of results, because the standard reduce cannot exit the loop through break.  Let's then write our reduce, which can be quit if the reduced value is returned (the idea was borrowed from clojure). </p><br><pre> <code class="hljs perl">// -    . class Reduced { constructor(value) { this.value = value } } const isReduced = <span class="hljs-string"><span class="hljs-string">value =&gt;</span></span> value instanceof Reduced const reduced = <span class="hljs-string"><span class="hljs-string">value =&gt;</span></span> isReduced(value) ? value : new Reduced(value) //   reduce     reduced-. const reduce = (reducer, <span class="hljs-keyword"><span class="hljs-keyword">state</span></span>, array) =&gt; { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   - reduced-  , <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     ,  . <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isReduced(<span class="hljs-keyword"><span class="hljs-keyword">state</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state.value } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (array.length === <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">state</span></span> } //   reduce   , <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     . const [<span class="hljs-keyword"><span class="hljs-keyword">x</span></span>, ...xs] = array <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> reduce(reducer, reducer(<span class="hljs-keyword"><span class="hljs-keyword">state</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">x</span></span>), xs) } const result = reduce((result, { <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>, others, }) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">my</span></span> &gt; others) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.length &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { result = result.concat(gameID) } //  ,     . <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.length &gt;= <span class="hljs-number"><span class="hljs-number">2</span></span>) { result = reduced(result) } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result }, [], scores)</code> </pre> <br><p>  Wow, now we have everything quickly (one pass and exactly until we get the right amount of elements), but is it beautiful?  I believe that the code above is scary: there is too much code in it that is not relevant to the task. </p><br><h3 id="reshenie-4-dekompoziciya-redyusera-transdyusery">  Decision number 4.  Reducer decomposition, transducer </h3><br><p>  The reducer above can be divided into 4 small functions that will be called in a chain, where one function calls the next. </p><br><ol><li>  <code>filterWins</code> filters games by status, i.e., only <code>filterWins</code> games through the chain. </li><li>  <code>mapGameID</code> gets its number from the game. </li><li>  <code>firstTwo</code> checks the number of results obtained.  If there are fewer than two, then it calls the following function, gets new results, and then ends the cycle if the required number is recruited. </li><li>  <code>appendToResult</code> adds the game number to the results array and returns it. </li></ol><br><pre> <code class="hljs lua">// <span class="hljs-built_in"><span class="hljs-built_in">next</span></span> -     const filterWins = <span class="hljs-built_in"><span class="hljs-built_in">next</span></span> =&gt; (result, score) =&gt; //   ,       score.my &gt; score.others ? <span class="hljs-built_in"><span class="hljs-built_in">next</span></span>(result, score) : result const mapGameID = <span class="hljs-built_in"><span class="hljs-built_in">next</span></span> =&gt; (result, { gameID }) =&gt; //     <span class="hljs-built_in"><span class="hljs-built_in">next</span></span>(result, gameID) //         . const firstTwo = <span class="hljs-built_in"><span class="hljs-built_in">next</span></span> =&gt; { //          . // n -  ,        //  . let n = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (result, score) =&gt; { //    ,       . <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { result = <span class="hljs-built_in"><span class="hljs-built_in">next</span></span>(result, score) n -= <span class="hljs-number"><span class="hljs-number">1</span></span> } //    ,  . <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { result = reduced(result) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result } } const appendToResult = (result, gameID) =&gt; result.<span class="hljs-built_in"><span class="hljs-built_in">concat</span></span>([gameID]) const result = reduce( //   ,     // ,     . filterWins(mapGameID(firstTwo(appendToResult))), [], scores, )</code> </pre> <br><p>  It seems like they simplified it, breaking it up into functions, but it turned out scary.  I would not like to write this every time.  But we will fix this a bit later when we unify the code for reuse. </p><br><p>  The pattern may seem familiar to you, because this is how middleware works.  This is middleware.  And these are the transducers, because transducers are the middleware.  A transducer is a function that accepts one reducer and returns a new one (with additional logic before or after calling the reducer). </p><br><p>  Those who hear the concept of <code>middleware</code> for the first time can familiarize themselves with it here: <a href="http://expressjs.com/ru/guide/using-middleware.html">express.js</a> , <a href="http://laravel.su/docs/5.0/middleware">laravel</a> , and also yesterday I tried to explain it in my own words: <a href="https://vk.com/home_kana%3Fw%3Dwall-135720595_334">my post</a> </p><br><p>  In this solution, we have three transducer: <code>filterWins</code> , <code>mapGameID</code> and <code>firstTwo</code> , and we consistently apply them to the appendToResult <code>appendToResult</code> , creating an increasingly complex reducer. </p><br><p>  And now let's unify our transducers: </p><br><pre> <code class="hljs lua">// pred -  - ,      <span class="hljs-literal"><span class="hljs-literal">true</span></span>  <span class="hljs-literal"><span class="hljs-literal">false</span></span>. //    <span class="hljs-literal"><span class="hljs-literal">true</span></span>,      ,  //   . const filter = pred =&gt; <span class="hljs-built_in"><span class="hljs-built_in">next</span></span> =&gt; (acc, x) =&gt; pred(x) ? <span class="hljs-built_in"><span class="hljs-built_in">next</span></span>(acc, x) : acc // mapper - ,      . const map = mapper =&gt; <span class="hljs-built_in"><span class="hljs-built_in">next</span></span> =&gt; (acc, x) =&gt; <span class="hljs-built_in"><span class="hljs-built_in">next</span></span>(acc, mapper(x)) //     ,    n . //  n-   . const take = n =&gt; <span class="hljs-built_in"><span class="hljs-built_in">next</span></span> =&gt; (acc, x) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { acc = <span class="hljs-built_in"><span class="hljs-built_in">next</span></span>(acc, x) n -= <span class="hljs-number"><span class="hljs-number">1</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { acc = reduced(acc) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> acc }</code> </pre> <br><p>  At the same time rename the reducer: </p><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> append = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">xs, x</span></span></span><span class="hljs-function">) =&gt;</span></span> xs.concat([x])</code> </pre> <br><p>  And also add a helper for the composition of functions to remove the extra brackets: </p><br><pre> <code class="hljs coffeescript">const compose = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(...fns)</span></span></span><span class="hljs-function"> =&gt;</span></span> x =&gt; fns.reduceRight(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, fn)</span></span></span><span class="hljs-function"> =&gt;</span></span> fn(x), x)</code> </pre> <br><p>  Add a helper, which will apply the transducer to the reducer and cause reduce with the resulting reducer: </p><br><pre> <code class="hljs lisp">const transduce = (<span class="hljs-name"><span class="hljs-name">transducer</span></span>, reducer, init, array) =&gt; reduce(<span class="hljs-name"><span class="hljs-name">transducer</span></span>(<span class="hljs-name"><span class="hljs-name">reducer</span></span>), init, array)</code> </pre> <br><p>  Finally, we will solve the problem with the help of all these functions: </p><br><pre> <code class="hljs lisp">const firstTwoWins = compose( <span class="hljs-name"><span class="hljs-name">filter</span></span>(({ my, others }) =&gt; my &gt; others), map(({ gameID }) =&gt; gameID), take(<span class="hljs-number"><span class="hljs-number">2</span></span>), ) const result = transduce(<span class="hljs-name"><span class="hljs-name">firstTwoWins</span></span>, append, [], scores)</code> </pre> <br><p>  It turned out a beautiful, fast, functional, immutable, ready-to-use solution. </p><br><h3 id="vyvod">  Conclusion: </h3><br><p>  Transducers are a very simple pattern, which is a special case of the middleware pattern, which is much more widely known (hence the name of the article), the basis of which is the creation of complex reducers using composition.  And the resulting reducers, in turn, are very versatile, they can be used with the processing of collections, streams, Redux. </p><br><p>  It‚Äôs not necessary to write all the code for working with transducers manually each time, because transducers have long been implemented in many libraries for data processing (for example, in <code>ramda.js</code> or the standard clojure library) </p><br><h4 id="ramda">  Ramda: </h4><br><pre> <code class="hljs perl">const scores = [ { gameID: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, others: <span class="hljs-number"><span class="hljs-number">2</span></span> }, { gameID: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, others: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { gameID: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, others: <span class="hljs-number"><span class="hljs-number">3</span></span> }, { gameID: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, others: <span class="hljs-number"><span class="hljs-number">2</span></span> }, { gameID: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, others: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { gameID: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, others: <span class="hljs-number"><span class="hljs-number">0</span></span> }, { gameID: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, others: <span class="hljs-number"><span class="hljs-number">1</span></span> }, ] { const firstTwoWins = compose( filter(({ <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>, others }) =&gt; <span class="hljs-keyword"><span class="hljs-keyword">my</span></span> &gt; others), pluck(<span class="hljs-string"><span class="hljs-string">"gameID"</span></span>), take(<span class="hljs-number"><span class="hljs-number">2</span></span>), ) const result = transduce(firstTwoWins, flip(append), [], scores) } //    { const firstTwoWins = into([], compose( filter(({ <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>, others }) =&gt; <span class="hljs-keyword"><span class="hljs-keyword">my</span></span> &gt; others), pluck(<span class="hljs-string"><span class="hljs-string">"gameID"</span></span>), take(<span class="hljs-number"><span class="hljs-number">2</span></span>), )) const result = firstTwoWins(scores) }</code> </pre> <br><h4 id="clojure">  Clojure: </h4><br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">def</span></span> scores [{<span class="hljs-symbol"><span class="hljs-symbol">:game-id</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:my</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:others</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>} {<span class="hljs-symbol"><span class="hljs-symbol">:game-id</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:my</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:others</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>} {<span class="hljs-symbol"><span class="hljs-symbol">:game-id</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:my</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:others</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>} {<span class="hljs-symbol"><span class="hljs-symbol">:game-id</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:my</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:others</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>} {<span class="hljs-symbol"><span class="hljs-symbol">:game-id</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:my</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:others</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>} {<span class="hljs-symbol"><span class="hljs-symbol">:game-id</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:my</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:others</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>} {<span class="hljs-symbol"><span class="hljs-symbol">:game-id</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:my</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:others</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>}]) (<span class="hljs-name"><span class="hljs-name">defn</span></span> win? [{<span class="hljs-symbol"><span class="hljs-symbol">:keys</span></span> [my others]}] (<span class="hljs-name"><span class="hljs-name">&gt;</span></span> my others)) (<span class="hljs-name"><span class="hljs-name">def</span></span> first-two-wins (<span class="hljs-name"><span class="hljs-name">comp</span></span> (<span class="hljs-name"><span class="hljs-name">filter</span></span> win?) (<span class="hljs-name"><span class="hljs-name">map</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:game-id</span></span>) (<span class="hljs-name"><span class="hljs-name">take</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>))) (<span class="hljs-name"><span class="hljs-name">def</span></span> result (<span class="hljs-name"><span class="hljs-name">transduce</span></span> first-two-wins conj [] scores)) <span class="hljs-comment"><span class="hljs-comment">;; [1 3]</span></span></code> </pre> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/325388/">https://habr.com/ru/post/325388/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325378/index.html">Moscow Python Meetup ‚Ññ44</a></li>
<li><a href="../325380/index.html">Security Week 13: Doctor Who fans were found in the CIA, APT29 allows backdoor traffic through Google, start the SAP GUI patch</a></li>
<li><a href="../325382/index.html">Fundamental laws of information security</a></li>
<li><a href="../325384/index.html">Making your first game on the Phaser. Part 3 - Creating the game world</a></li>
<li><a href="../325386/index.html">10 applications to protect devices on Android</a></li>
<li><a href="../325390/index.html">This is not a joke - only a few days left ... before the deadline at GSoC 2017</a></li>
<li><a href="../325392/index.html">Leningrad telephone broadcast: the first Soviet chat</a></li>
<li><a href="../325394/index.html">Horoscope for developers</a></li>
<li><a href="../325398/index.html">Commodore 64 Secret Colors</a></li>
<li><a href="../325400/index.html">Pattern recognition</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>