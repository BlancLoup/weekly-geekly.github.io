<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Calculate editorial distance</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The distance, or Levenshtein distance, is a metric that allows determining the ‚Äúsimilarity‚Äù of two lines ‚Äî the minimum number of operations to insert ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Calculate editorial distance</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/205/723/bbb/205723bbb3bbbaf77aaa9c1a5f42f19a.jpg" align="right"><br>  The distance, or Levenshtein distance, is a metric that allows determining the ‚Äúsimilarity‚Äù of two lines ‚Äî the minimum number of operations to insert one character, delete one character, and replace one character with another, necessary to turn one line into another.  The article presents a method for calculating the editorial distance when using a small amount of memory, without significant loss of speed.  This approach can be applied for large lines (of the order of 10 <sup>5</sup> characters, i.e., actually for texts) when receiving not only the ‚Äúsimilarity‚Äù estimate, but also the sequence of changes for translating one line to another. <br><a name="habracut"></a><br><h5>  Slight formalization </h5><br>  Suppose there are two lines S <sub>1</sub> and S <sub>2</sub> .  We want to translate one into another (even if the first to the second, it is easy to show that the operations are symmetrical), using the following operations: <br><ul><li>  I: Insert a character in an arbitrary location; </li><li>  D: Delete a character from an arbitrary position; </li><li>  R: Replacing a character with another. </li></ul><br>  Then d (S <sub>1</sub> , S <sub>2</sub> ) is the minimum number of I / D / R operations for translating S <sub>1</sub> into S <sub>2</sub> , and the editorial prescription is listing the operations for translating with their parameters. <br><br>  The task is easily solved by the <a href="http://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B0%25D1%2581%25D1%2581%25D1%2582%25D0%25BE%25D1%258F%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%259B%25D0%25B5%25D0%25B2%25D0%25B5%25D0%25BD%25D1%2588%25D1%2582%25D0%25B5%25D0%25B9%25D0%25BD%25D0%25B0">Wagner ‚Äì Fisher</a> algorithm, but to restore the editorial prescription, O (| S <sub>1</sub> | * | S <sub>2</sub> |) memory cells will be required.  In brief, I present the algorithm itself, since the ‚Äúoptimization‚Äù is based on it. <br><br><h5>  Wagner-Fisher Algorithm </h5><br>  The desired distance is formed through the auxiliary function D (M, N), which finds the editorial distance for the substrings S <sub>1</sub> [0..M] and S <sub>2</sub> [0..N].  Then the full editorial distance will be equal to the distance for full-length substrings: d (S <sub>1</sub> , S <sub>2</sub> ) = D <sub>S <sub>1</sub> , S <sub>2</sub></sub> (M, N). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The self-evident fact is that: <br><br>  D (0,0) = 0. <br><br>  Indeed, the blank lines match. <br><br>  Also, the implications for: <br><br>  D (i, 0) = i; <br>  D (0, j) = j. <br><br>  Indeed, any line can turn out to be empty, adding the necessary number of necessary characters, any other operations will only increase the estimate. <br><br>  In general, a little more complicated: <br><br>  D (i, j) = D (i-1, j-1), if S <sub>1</sub> [i] = S <sub>2</sub> [j], <br>  otherwise, D (i, j) = min (D (i-1, j), D (i, j-1), D (i-1, j-1)) + 1. <br><br>  In this case, we choose which is more profitable: delete the character (D (i-1, j)), add (D (i, j-1)), or replace (D (i-1, j-1)). <br><br>  It is easy to understand that the algorithm for obtaining the estimate does not require memory of more than two columns, the current (D (i, *)) and the previous one (D (i-1, *)).  However, the full matrix is ‚Äã‚Äãneeded to restore the editorial prescription.  Starting from the lower right corner of the matrix (M, N) we go to the upper left, at each step looking for the minimum of three values: <br><ul><li>  if the minimum is (D (i-1, j) + 1), add the deletion of the symbol S <sub>1</sub> [i] and go to (i-1, j); </li><li>  if the minimum is (D (i, j-1) + 1), add the insertion of the character S <sub>1</sub> [i] and go to (i, j-1); </li><li>  if it is minimal (D (i-1, j-1) + m), where m = 1, if S <sub>1</sub> [i]! = S <sub>2</sub> [j], otherwise m = 0;  then go to (i-1, j-1) and add a replacement if m = 1. </li></ul>  Here (i, j) is the cell of the matrix in which we are at this step.  If two of the three values ‚Äã‚Äãare minimal (or all three are equal), this means that there are 2 or 3 equivalent editorial guidelines. <br><br>  As a result, you need O (| S <sub>1</sub> | * | S <sub>2</sub> |) time and <b>O (| S <sub>1</sub> | * | S <sub>2</sub> |)</b> memory. <br><br><h5>  General arguments </h5><br>  A prerequisite for the creation of this method is a simple fact: in real-world conditions, memory is more expensive than time.  Indeed, for lines with a length of 2 <sup>16</sup> characters, you need about 2 <sup>32</sup> computational operations (which at current capacities will fall within ten seconds of calculations) and 2 <sup>32 of the</sup> same memory, which in most cases is already larger than the physical memory of the machine. <br><br>  The idea of ‚Äã‚Äãhow to use linear memory (2 * | S <sub>1</sub> |) to estimate the distance lies on the surface, it remains to transfer it correctly to the calculation of the editorial prescription. <br><br><h5>  Counter calculation method (Hirschberg algorithm) </h5><br>  We will use recursion to split the task into subtasks, each of which does not require a lot of memory.  For further sketches take some initial values ‚Äã‚Äãof the lines. <br><br>  S <sub>1</sub> = ACGTACGTACGT, <br>  S <sub>2</sub> = AGTACCTACCGT. <br><br>  Looks like, isn't it?  But rewriting one into the other "by eye" is not so obvious.  The letters, by the way, were not chosen by chance - they are nitrogen bases (A, T, G, C), DNA components: the editorial distance estimation method is actively used in biology to evaluate mutations. <br><br>  Then the initial blank matrix will look (exactly look, we will store only the necessary data) as follows: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/624/3a2/42b/6243a242b2ccaafe11e3c914636dceef.png"><br><br>  In each cell should be the value of the editorial distance. <br><br>  We divide the original task into a subtask, divide the second line into two equal (or almost equal) parts, remember the place of splitting, and begin to fill in the matrix exactly the same way as did Wagner-Fisher: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f0a/5fe/b2f/f0a5feb2f80991264167975531b80114.png"><br><br>  When filling, we will not store the previous columns, moving from left to right, top to bottom, as the values ‚Äã‚Äãof D (i, j) are calculated, the values ‚Äã‚Äãof D (i-1, j) can be deleted: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/832/8c2/2d5/8328c22d58fce3c3e839de75797d27ce.png"><br><br>  Similarly, fill in the right side of the partition.  Here we will move from right to left, from top to bottom: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a48/dc9/d74/a48dc9d748f66bfcfd2dec3dcd3599c1.png"><br><br>  <i>So we met.</i>  Now you can get a part of the solution to the general problem by combining the private ones  Sum up the values ‚Äã‚Äãin the left and right columns and select the minimum. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/976/a52/24b/976a5224bacdf69a4bebb0378283c749.png"><br><br>  What does this combination mean?  We tried to combine the first row with the first half of the second row, then the first row with the second half of the row.  The sum allows you to get the number of operations to change the first line to bring it to the concatenation of the first and second half of the second line (that is, the second line) ... this means that we got the value of the editorial distance!  But it‚Äôs too early to rejoice, because this result could have been achieved even easier (the method described above). <br><br>  However, looking at the picture from a different angle (literally), we got another significant fact: now we know how to cut the first line into two halves so that the corresponding pairs give us the editorial distance: d (S <sub>1 <sub>1</sub></sub> , S <sub>2 <sub>1</sub></sub> ) + d (S <sub>1 <sub>2</sub></sub> , S <sub>2 <sub>2</sub></sub> ) = d (S <sub>1</sub> , S <sub>2</sub> ).  A row (in the matrix) in which the minimum is located and there is the required partition S <sub>1</sub> , and this partition is sent to issue an editorial instruction. <br><br>  Similarly, we will divide the task already for the resulting substrings S <sub>1 <sub>1</sub></sub> and S <sub>2 <sub>1</sub></sub> (and we will not forget the second pair either): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/054/e2a/4c3/054e2a4c32122e0bf60e0a422c511091.png"><br><br>  We finish the division when there is no single substring S <sub>1 of</sub> length greater than 1. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/40e/603/19d/40e60319df05912da5e73402e19b32b8.png"><br><br>  We obtain a list of partitions, where each substring S <sub>1</sub> (look vertically) gives a minimal estimate of changes relative to the corresponding substring S <sub>2</sub> (horizontally). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b9b/a62/2cb/b9ba622cbbe96f3ba3cfc944b6062eeb.png"><br><br>  For convenience, I colored the marks with colors: green means symbol-by-word matching of lines in selected positions, blue needs replacing, and red means deleting or adding.  It is easy to see that the ‚Äúred‚Äù circles are in the same row / column (a little attentive task: explain what this means). <br><br>  In a more convenient form, the result can be written as follows (the red dashes are the correspondence of symbols, the shifts are indicated by black horizontal ones): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a86/1e8/0b4/a861e80b47f1f73295136e2d247ab5f2.png"><br><br><h5>  Algorithm analysis </h5><br>  Memory: for each step, you will need to memorize no more than one column d (i, *) and a set of partitions S <sub>1</sub> .  Total O (| S <sub>1</sub> | + | S <sub>2</sub> |).  That is, instead of a quadratic volume, we get a linear one. <br><br>  Time: each partitioning of S [0..N] by column t generates the processing of substrings S [0..t] and S [t..N].  The total number of partitions is N. When processing each partition (S <sub>1</sub> [i..j], S <sub>1</sub> [k..n]), (j - i) x (n - k) operations are required.  Summing up the worst-case estimate for substrings, we end up with 2 * | S <sub>1</sub> |  * | S <sub>2</sub> |  operations.  The running time of the algorithm remains quadratic, although the multiplicative constant has changed. <br><br>  So, we solved the problem using a linear amount of memory and slightly lost in speed, which in this case can be considered a success. <br><br>  [*] Wikipedia: <a href="http://en.wikipedia.org/wiki/Hirschberg%2527s_algorithm">Hirschberg algorithm</a> . </div><p>Source: <a href="https://habr.com/ru/post/117063/">https://habr.com/ru/post/117063/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../117049/index.html">Top 5 custom video contests on the Internet</a></li>
<li><a href="../117050/index.html">Dd command and everything related to it</a></li>
<li><a href="../117051/index.html">Origami and augmented reality</a></li>
<li><a href="../117053/index.html">About miracles</a></li>
<li><a href="../117058/index.html">Positive Hack Days 2011: Intro</a></li>
<li><a href="../117064/index.html">Connection of additional services from your provider</a></li>
<li><a href="../117065/index.html">The results of the research staff in the market for web development</a></li>
<li><a href="../117069/index.html">JavaScript modular approach</a></li>
<li><a href="../117070/index.html">Origami and augmented reality (continued)</a></li>
<li><a href="../117071/index.html">IT-portfolio: we are in open beta!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>