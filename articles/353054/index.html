<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Learn OpenGL. Lesson 5.1 - Advanced Lighting. Model Blinna-Fong</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Advanced lighting 


 In the lesson on the basics of lighting, we briefly reviewed the Phong lighting model, which allows us to give a significant sha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Learn OpenGL. Lesson 5.1 - Advanced Lighting. Model Blinna-Fong</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/web/c9e/9b2/a3b/c9e9b2a3baf749ab8e2b385c6d93d966.png" alt="Ogl3" width="300"><h1>  Advanced lighting </h1><br><p>  In the lesson on the <a href="https://habrahabr.ru/post/333932/">basics of lighting,</a> we briefly reviewed the Phong lighting model, which allows us to give a significant share of realism to our scenes.  The Phong model looks quite good, but it has several drawbacks that we will focus on in this lesson. </p><br><a name="habracut"></a><div class="spoiler">  <b class="spoiler_title">Content</b> <div class="spoiler_text">  Part 1. Start <br><br><ol><li>  <a href="https://habrahabr.ru/post/310790/">Opengl</a> </li><li>  <a href="https://habrahabr.ru/post/311198/">Creating a window</a> </li><li>  <a href="https://habrahabr.ru/post/311234/">Hello window</a> </li><li>  <a href="https://habrahabr.ru/post/311808/">Hello triangle</a> </li><li>  <a href="https://habrahabr.ru/post/313380/">Shaders</a> </li><li>  <a href="https://habrahabr.ru/post/315294/">Textures</a> </li><li>  <a href="https://habrahabr.ru/post/319144/">Transformations</a> </li><li>  <a href="https://habrahabr.ru/post/324968/">Coordinate systems</a> </li><li>  <a href="https://habrahabr.ru/post/327604/">Camera</a> </li></ol><br>  Part 2. Basic lighting <br><br><ol><li>  <a href="https://habrahabr.ru/post/329592/">Colors</a> </li><li>  <a href="https://habrahabr.ru/post/333932/">Lighting Basics</a> </li><li>  <a href="https://habrahabr.ru/post/336166/">Materials</a> </li><li>  <a href="https://habrahabr.ru/post/337550/">Texture Cards</a> </li><li>  <a href="https://habrahabr.ru/post/337642/">Sources of light</a> </li><li>  <a href="https://habrahabr.ru/post/338254/">Multiple light sources</a> </li></ol><br>  Part 3. Loading 3D Models 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  <a href="https://habrahabr.ru/post/338436/">Assimp library</a> </li><li>  <a href="https://habrahabr.ru/post/338436/">Mesh mesh class</a> </li><li>  <a href="https://habrahabr.ru/post/338998/">Model class</a> </li></ol><br>  Part 4. OpenGL advanced features <br><br><ol><li>  <a href="https://habrahabr.ru/post/342610/">Depth test</a> </li><li>  <a href="https://habrahabr.ru/post/344238/">Stencil test</a> </li><li>  <a href="https://habrahabr.ru/post/343096/">Mixing colors</a> </li><li>  <a href="https://habrahabr.ru/post/346964/">Face clipping</a> </li><li>  <a href="https://habrahabr.ru/post/347354/">Frame buffer</a> </li><li>  <a href="https://habrahabr.ru/post/347750/">Cubic cards</a> </li><li>  <a href="https://habrahabr.ru/post/350008/">Advanced data handling</a> </li><li>  <a href="https://habrahabr.ru/post/350156/">Advanced GLSL</a> </li><li>  <a href="https://habrahabr.ru/post/350782/">Geometric shader</a> </li><li>  <a href="https://habrahabr.ru/post/352962/">Instancing</a> </li><li>  <a href="https://habrahabr.ru/post/351706/">Smoothing</a> </li></ol><br>  Part 5. Advanced Lighting <br><br><ol><li>  Advanced lighting.  Model Blinna-Phong. </li><li>  <a href="https://habrahabr.ru/post/353632/">Gamma Correction</a> </li></ol></div></div><br><h2>  Model Blinna-Fong </h2><br><p>  The Phong model is a very effective approximation for calculating lighting, but under certain conditions it can lose some of the components of the specular highlights.  This can be noticed at small values ‚Äã‚Äãof the gloss power ( <b>shininess</b> ) when the specular reflection area becomes rather large.  The figure below shows what happens when we use a specular gloss of 1.0 for a flat textured surface: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/em/yp/j3/emypj3wbhjb3c8ijppwrjzpq4ug.png"></div><br><p>  As you can see, the area of ‚Äã‚Äãmirror reflection has a sharply defined border.  This occurs because the angle between the viewing vector and the reflection vector should not exceed 90 degrees, otherwise their scalar product becomes negative, which makes the component of the mirror highlights equal to zero.  You might think that there is nothing terrible in this, because we should not get any illumination at angles above 90 degrees, right? </p><br><p>  Not really.  This is applicable only to the diffuse component, where the angle above 90 degrees between the normal vector and the direction of light means that the light source is below the illuminated surface and, therefore, the contribution of diffuse illumination should be zero.  However, in the case of a mirror component, we do not measure the angle between the direction of light and the normal, but the angle between the viewing and reflecting vectors.  Take a look at the following two figures: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dt/qp/wb/dtqpwb1eowpmgweclpbhi9zixiy.png"></div><br><p>  Now the problem becomes obvious.  On the left, we see the familiar picture of the Phong reflection with Œ∏ less than 90 degrees.  In the right figure, the angle Œ∏ between the directions of view and reflection is greater than 90 degrees, as a result of which the contribution of the mirror light is canceled.  This is usually not a cause for concern, as the viewing vector is often noticeably distant from the reflection vector.  But for small values ‚Äã‚Äãof the specular gloss, the radius of the reflection region becomes quite large, and makes a significant contribution to the overall picture.  Using the Phong model, we cancel this contribution at angles greater than 90 degrees (as seen in the first image). </p><br><p>  In 1977, James F. Blinn introduced the Blinna-Phong lighting model as an addition to the Phong model that we have used so far.  It is in many ways similar to the Phong model, but uses a slightly different approach to the calculation of the mirror component, which allows us to solve our problem.  Instead of relying on the reflection vector, we use the so-called <b>median vector</b> ( <b>halfway vector</b> ), which is a unit vector exactly midway between the direction of view and the direction of light.  The closer this vector is to the surface normal, the greater will be the contribution of the mirror component. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lm/rd/bt/lmrdbtuzf53c7qoom28du4krp_8.png"></div><br><p>  When the viewing direction coincides fully with the (now imaginary) reflection vector, the median vector coincides with the normal to the surface.  Thus, the closer the viewing direction is to the reflection direction, the stronger the specular brilliance becomes. </p><br><p>  Obviously, regardless of the direction from which the observer looks, the angle between the median vector and the normal to the surface will never exceed 90 degrees (unless, of course, the light source is below the surface).  Due to this, we get slightly different results compared to the Fongov reflection, and in general the picture looks more visually plausible, especially at low values ‚Äã‚Äãof the specular gloss.  It was the Blinna-Phong lighting model that was used in the earlier, fixed OpenGL pipeline. </p><br><p>  Finding the median vector is easy: you need to add the vector of the direction of light with the review vector and normalize the result: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>H</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>L</mi><mo>+</mo><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>V</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>L</mi><mo>+</mo><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="44.308ex" height="2.66ex" viewBox="0 -832 19076.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-63" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-48" x="1635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMAIN-3D" x="2801" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-66" x="4108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-72" x="4658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-61" x="5110" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-63" x="5639" y="0"></use><g transform="translate(6073,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-63" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-4C" x="1635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMAIN-2B" x="2539" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-76" x="3789" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-65" x="4275" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-63" x="4741" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-56" x="5175" y="0"></use></g><g transform="translate(12018,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMAIN-7C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMAIN-7C" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-76" x="807" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-65" x="1292" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-63" x="1759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-4C" x="2192" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMAIN-2B" x="3096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-76" x="4346" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-65" x="4832" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-63" x="5298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMATHI-56" x="5732" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMAIN-7C" x="6501" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/353054/&amp;xid=17259,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgFL9YtMaC1RDV8ntONvZ3M3zN9aw#MJMAIN-7C" x="6780" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>H</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>L</mi><mo>+</mo><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>V</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>L</mi><mo>+</mo><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>c</mi><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> \ vec H = \ frac {\ vec L + \ vec V} {|| \ vec L + \ vec V ||} </script></p><br><p>  In GLSL it looks like this: </p><br><pre><code class="hljs mel">vec3 lightDir = <span class="hljs-keyword"><span class="hljs-keyword">normalize</span></span>(lightPos - FragPos); vec3 viewDir = <span class="hljs-keyword"><span class="hljs-keyword">normalize</span></span>(viewPos - FragPos); vec3 halfwayDir = <span class="hljs-keyword"><span class="hljs-keyword">normalize</span></span>(lightDir + viewDir);</code> </pre> <br><p>  Thus, the calculation of the mirror component is reduced to a simple calculation of the scalar product between the normal to the surface and the median vector in order to obtain the cosine value of the angle between them, which we again raise to the power of the specular gloss: </p><br><pre> <code class="hljs lisp">float spec = pow(<span class="hljs-name"><span class="hljs-name">max</span></span>(<span class="hljs-name"><span class="hljs-name">dot</span></span>(<span class="hljs-name"><span class="hljs-name">normal</span></span>, halfwayDir), <span class="hljs-number"><span class="hljs-number">0.0</span></span>), shininess)<span class="hljs-comment"><span class="hljs-comment">; vec3 specular = lightColor * spec;</span></span></code> </pre> <br><p>  Actually, this is all about the Blinna-Phong model.  The only difference between the mirror reflection in the Blinna-Phong and Phong models is that we now measure the angle between the normal and the median vector instead of the angle between the direction of the view and the reflection vector. </p><br><p>  Using the median vector to calculate the components of the specular highlights, we will no longer have a problem typical of the Phong model with a sharp boundary of the specular reflection region.  The image below shows the region of specular reflection of both methods with a specular gloss of 0.5: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9q/pi/f8/9qpif8vzotfbinkrimdheft_n2a.png"></div><br><p>  Another small difference between the Phong and Blinna-Phong models is that the angle between the median vector and the surface normal is often less than the angle between the viewing and reflecting vectors.  Therefore, in order to obtain similar Phong model results, the value of the specular gloss strength should be slightly higher.  It is empirically established that it is somewhere 2-4 times more compared with the Phong model. </p><br><p>  The following is a comparison of the mirror component between models with a specular gloss of 8 for the Phong model and 32 for the Blinna-Phong model: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/of/iv/xg/ofivxgalrxobjfokaagt4ehun3i.png"></div><br><p>  As can be seen, the mirror component of the Blinna-Phong is sharper.  It usually requires a small adjustment to get results similar to those obtained earlier using the Phong model, but, in general, the Blinna-Phong coverage gives a more realistic picture. </p><br><p>  For this demonstration, we used a simple fragmentary shader that switches between regular Phong reflection and Blinna-Phong reflection: </p><br><pre> <code class="hljs mel">void main() { [...] <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> spec = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(blinn) { vec3 halfwayDir = <span class="hljs-keyword"><span class="hljs-keyword">normalize</span></span>(lightDir + viewDir); spec = <span class="hljs-keyword"><span class="hljs-keyword">pow</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">dot</span></span>(normal, halfwayDir), <span class="hljs-number"><span class="hljs-number">0.0</span></span>), <span class="hljs-number"><span class="hljs-number">16.0</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { vec3 reflectDir = reflect(-lightDir, normal); spec = <span class="hljs-keyword"><span class="hljs-keyword">pow</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">max</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">dot</span></span>(viewDir, reflectDir), <span class="hljs-number"><span class="hljs-number">0.0</span></span>), <span class="hljs-number"><span class="hljs-number">8.0</span></span>); } [...]</code> </pre><br><p>  The source code for this tutorial can be found <a href="https://learnopengl.com/code_viewer_gh.php%3Fcode%3Dsrc/5.advanced_lighting/1.advanced_lighting/advanced_lighting.cpp">here</a> .  By pressing the b key, you can switch from the Phong model to the Blinna-Phong model and back. </p><br><p>  <a href="https://learnopengl.com/Advanced-Lighting/Advanced-Lighting">Original article</a> . </p></div><p>Source: <a href="https://habr.com/ru/post/353054/">https://habr.com/ru/post/353054/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353044/index.html">The digest of interesting materials for the mobile developer # 248 (April 2 - April 8)</a></li>
<li><a href="../353046/index.html">Briefly about the formats of fiscal documents: shoals version 1.0 and the transition to version 1.05 and 1.1</a></li>
<li><a href="../353048/index.html">Windows virtual server with video card on board</a></li>
<li><a href="../353050/index.html">Data Analysis Using Python</a></li>
<li><a href="../353052/index.html">Android Lifecycle-aware Architecture Components</a></li>
<li><a href="../353056/index.html">PHP Digest 128 (March 25 - April 8, 2018)</a></li>
<li><a href="../353058/index.html">Is there any powder in the old dog? Hackathon Radio Canada 2018 (Part Three - Start! Attention! March!)</a></li>
<li><a href="../353060/index.html">Application of convolutional neural networks for NLP problems</a></li>
<li><a href="../353064/index.html">Kubernetes 1.10: we stabilize data storage, security and networking</a></li>
<li><a href="../353066/index.html">ITSM literacy program: 7 ways to diagnose the causes of IT incidents and problems</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>