<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The simplest implementation of cross-platform multiplayer on the example of the evolution of a single .NET game</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 
 Immediately I will ask for an apology for the style of my writing and ignorance of the Russian language - unfortunately I have never been a b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The simplest implementation of cross-platform multiplayer on the example of the evolution of a single .NET game</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br>  Immediately I will ask for an apology for the style of my writing and ignorance of the Russian language - unfortunately I have never been a blog writer, but the desire to leave comments on Habr√© is a strong motivator.  Besides the fact that I am not a writer, I am also not a programmer, but a civil engineer who sometimes indulges in writing a couple of lines of code ‚Äî such is a hobby among others.  But about the construction I wrote enough at the time of preparation and protection of the disser, and there is no more desire to return to it. <br>  And in this article I want to describe the personal experience of creating a single toy with the implementation of a multiplayer game that allows you to support various platforms (I write on .NET, so first of all my experience concerns Windows / WP, but this method is perfect for other platforms, I have working prototypes of the described game for Android / iOS, but so far there is no desire to pay for 1k usd for commercial packages Xamarin).  And yes - in this introductory article (which was originally planned exclusively in the sandbox) I will not disclose technical details, since in this case I‚Äôm risking not finishing it for a long time.  Who knows, maybe I still have time and the opportunity to write a more detailed sequel. <br><a name="habracut"></a><br>  First, a little history.  It all started back in 2005 (4 ?, 6?), When I, in the company of my wife's friends, played knuffel, a dice game that I liked so much that I wanted to make my own computer implementation without fail.  In those days, I knew VB.NET quite well and took my first steps in C #, so the first version was ready the next day. <br><br><img src="https://habrastorage.org/storage2/a94/b48/21c/a94b4821caa9dd038f13e3612df44e16.png" alt="image"><br>  <i>"Knifel" - the first version</i> <br><br>  Of course, I understood that this was a ‚Äúsilent horror‚Äù and therefore I continued to improve myself and went to read smart books.  In <a href="http://books.google.by/books/about/Learn_VB_Net_through_game_programming.html%3Fid%3D6ICKkbWHrHkC%26redir_esc%3Dy">one of them,</a> I got the idea of ‚Äã‚Äãa dice controller, which formed the basis of all my subsequent knippels.  I remember that the second version of the game was very successful at my work for some time - it happened that they even lingered to throw computer bones.  That Windows Forms game has long been abandoned, and I don‚Äôt even know where the source code is, but it is still available for download on some sites. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/874/988/724/874988724f7ae198f3680172480c79fe.jpg" alt="image"><br>  <i>"Kniffel" - the second version</i> <br><br>  The story continued in 2010 when, having mastered Silverlight, I decided to make an application for VKontakte from the ‚ÄúKliffel‚Äù.  But, of course, playing on the same network on one computer is not an option, then for the first time I was faced with the need to implement a network game.  The main problem is that the standard http request-response scheme is not applicable here, since the server needs to inform several clients about the game status.  Fortunately, in Silverlight for solving this task there is an option almost out of the box and it is called Duplex WCF service.  Having implemented client-server communications through a duplex service, I got a fairly stable game, but only for a while ... <br><br><img src="https://habrastorage.org/storage2/b26/a33/a09/b26a33a0986470711c621506b8765b6d.png" alt="image"><br>  <i>"Knifel" - the third version, online game vkontakte</i> <br><br>  The weak point of the system was the server part, which I placed on a shared hosting, where my website had access to something around 5% of the CPU time of the weakest processor.  Many people liked the game and gained some popularity, and with it the number of users simultaneously online has increased.  The server began to simply reset the session, the game began to end, hang.  It became impossible to play.  Then I did not know how to solve this problem and therefore I decided to just ‚Äúscore‚Äù ... <br>  Well, last year, I finally ‚Äúflew into the clouds‚Äù.  While doing several projects using AWS and Windows Azure, I thought that this could be a great solution for reanimation of a book store. <br>  At about the same time, my wife became the owner of the Windows Phone phone, and I became ‚Äúdelighted with him‚Äù.  I really liked the whole concept of the system, so I bought the Windows background for myself and started porting the book on it, and on Windows 8 at the same time - the benefit is the same Silverlight in WP, and XAML /  # in WinRT too.  So using MVVM pattern and relatively small effort, I got three applications - for Windows Phone, Windows 8 and (rewrote) Silverlight.  In applications, 95% of the code is in common cs files with # ifan specific points.  It is very convenient for unit testing and support - it is enough to change something in just one project and just make sure that everything works.  The problem remained only in the network game - it was impossible to use my duplex service on all platforms, especially considering the potential expansion to iOS and Android.  The solution I needed was a universal one to fit into my concept of ‚Äúcommon code for all platforms‚Äù. <br>  Such a solution was found - WebSockets.  Web sockets are natively supported by .NET 4.5, so there were no problems with the implementation in the server part and for Windows 8.  And for Silverlight and Windows Phone, I found the implementation as an open source library of <a href="http://websocket4net.codeplex.com/">WebSocket4Net</a> .  The same library is for Monotouch and Mono for Android.  C Html / JS is still as simple: I have successfully tested communication with my server from the simplest web page. <br>  Well, the server - in Windows Azure.  It all works well - you can perfectly play simultaneously from all supported platforms, there are of course jambs, but how can it be without them ... <br><br><img src="https://habrastorage.org/storage2/0d9/15f/e8b/0d915fe8b99f3837b46f759ce82238bc.jpg" alt="image"><br>  <i>"Knifel" (more precisely already "Magical Yatzy") - the current version, a multiplayer game between Windows 8, Windows RT, WP7 and WP8</i> <br><br>  This is the ‚Äúsandbox‚Äù article that turned out to be - largely autobiographical and in some places, possibly stupid ... well, as I can. <br><br>  Ps.  After the publication of the game in the international arena and claims from the German copyright holder, I had to abandon the name ‚Äúknuffel‚Äù and move to a more neutral ‚Äúinternational non-proprietary name‚Äú Yatzy ‚Äù, this has nothing to do with the matter, but still ... <br></div><p>Source: <a href="https://habr.com/ru/post/186486/">https://habr.com/ru/post/186486/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../186468/index.html">(Video) Booth Demonstrations: ZyXEL X8004 Universal IP Telephony Communication System</a></li>
<li><a href="../186470/index.html">(Video) HP Networking Networking Products and Solutions</a></li>
<li><a href="../186476/index.html">New summer version of ‚ÄúSimple business‚Äù 1.8.1.2. "Fort Knox": identifying the number, linking tables, speeding up work with documents and cases</a></li>
<li><a href="../186482/index.html">Honest glow and speed</a></li>
<li><a href="../186484/index.html">jPutty for layout, jQuery plugin</a></li>
<li><a href="../186488/index.html">MikroTik + port knocking over ICMP</a></li>
<li><a href="../186490/index.html">Roskomnadzor plans to block resources with information about blocked resources</a></li>
<li><a href="../186492/index.html">Again on bioinformatics: the assembly of bacterial genomes</a></li>
<li><a href="../186494/index.html">Dune 2 The Building of A Dynasty</a></li>
<li><a href="../186496/index.html">Human parser on Selenium WD</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>