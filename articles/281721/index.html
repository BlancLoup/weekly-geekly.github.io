<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>AngularJS: Migration from 1.2 to 1.4, part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the first part we went over all the main problems of the transition to the new version, and in this we will touch on why we did it. 





 As menti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>AngularJS: Migration from 1.2 to 1.4, part 2</h1><div class="post__text post__text-html js-mediator-article"><p>  In the <a href="https://habrahabr.ru/post/268265/">first part</a> we went over all the main problems of the transition to the new version, and in this we will touch on why we did it. </p><br><p><img src="https://habrastorage.org/files/3e9/74a/7d4/3e974a7d4c764cbcad24437ac455a413.jpg" alt="image"></p><br><p> As mentioned earlier, the main reason for the transition can be a significant increase in the speed of the application: 4.3 times faster manipulations with DOM and 3.5 times faster <code>$digest</code> cycles (compared to 1.2), as Jeff Cross and Brian Ford stated at ngEurope conference . </p><br><p>  However, this speed is for the most part acquired not through internal optimizations and magic, but by providing tools that allow you to write code more efficiently. </p><br><p>  Let's look at these tools! </p><a name="habracut"></a><br><h2>  Debug info </h2><br><p>  It‚Äôs not news that Angulyar spends a significant amount of resources on information that facilitates debugging, such as adding classes. <br>  DOM elements (for example, the <code>ng-binding</code> and <code>ng-isolated-scope</code> classes) or attaching various methods to access the <code>scope</code> (for example, <code>.scope()</code> and <code>.isolateScope()</code> ) to them. </p><br><p>  All this is useful and necessary for the work of tools such as Protractor and Batarang, but is this data needed in production? </p><br><p>  Starting from version <strong>1.3</strong> , debug info can be disabled: </p><br><pre> <code class="hljs php">app.config([<span class="hljs-string"><span class="hljs-string">'$compileProvider'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($compileProvider)</span></span></span><span class="hljs-function"> </span></span>{ $compileProvider.debugInfoEnabled(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); }]);</code> </pre> <br><p>  But what to do if we need to launch production, and debug is disabled? </p><br><p>  Here, the <code>.reloadWithDebugInfo()</code> method of the <code>angular</code> object will save us, and since the <code>angular</code> object is global, we can execute this code simply from the console: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">angular</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.reloadWithDebugInfo</span></span>();</code> </pre> <br><h2>  $ applyAsync </h2><br><p>  With version <strong>1.3</strong> , the <code>$applyAsync</code> service came, in many respects similar in its mechanics to the already existing <code>$evalAsync</code> service: </p><br><p>  Simply put, it adds an expression to the queue, then it waits (setsTimeout (..., 0), in modern browsers it is about 10 milliseconds), and if no other expression is added to the queue in the past time, it starts <br>  <code>$rootScope.$digest()</code> . </p><br><p>  This allows you to run multiple parallel expressions that affect the DOM, being sure that they will run in the same $ digest cycle and not worrying about the frequent use of $ apply. </p><br><p>  <strong>What is the difference from $ evalAsync?</strong> </p><br><p>  The main difference is that <code>$applyAsync</code> itself executes the entire expression queue <strong>at the beginning</strong> of the <code>$digest</code> loop, before dirty checking, which allows it to be executed only once, while the <code>$evalAsync</code> runs <strong>during a</strong> dirty check (more precisely, in the the beginning of the dirty check loop), and any expression added to the queue (outside $ watch) will start the $ digest loop again, which will lead to the repeated execution of the expression in the same <code>$digest</code> bit later. </p><br><p>  <a href="http://www.bennadel.com/blog/2751-scope-applyasync-vs-scope-evalasync-in-angularjs-1-3.htm">[more]</a> </p><br><p>  However, the true benefits of using this tool can be seen in the internal services of the angular, for example, in <code>$httpProvider</code> . </p><br><h3>  $ http </h3><br><p>  The main difference between the <code>$http</code> service and other ways to make an XHR request is the <code>$apply</code> call when it is completed. </p><br><p>  The problem lies in the set of parallel queries, each of which causes <code>$apply</code> at its completion, which leads to brakes. </p><br><p>  The problem is solved with the arrival of <code>$applyAsync</code> in version <strong>1.3</strong> : </p><br><pre> <code class="hljs php">app.config(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($httpProvider)</span></span></span><span class="hljs-function"> </span></span>{ $httpProvider.useApplyAsync(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); });</code> </pre> <br><p>  This code includes the use of the <code>$applyAsync</code> inside <code>$httpProvider</code> . </p><br><p>  This allows you to run $ apply only once, when all promises of simultaneous queries will be <code>resolved</code> , which gives a significant performance boost. </p><br><h2>  Bind once </h2><br><p>  One of the main performance problems in AngularJS is the huge amount of <code>$watch</code> 's due to the fact that two-way binding is applied to all expressions, but not all data require it. </p><br><p>  For static data, one-way binding is sufficient, without hanging yesterday, and before this was solved by custom directives, but everything changed in version <strong>1.3</strong> . </p><br><p>  Starting with version <strong>1.3</strong> , a new syntax is available in the form <code>::</code> at the beginning of an expression. </p><br><p>  Any expression starting with <code>::</code> will be perceived as one-way binding and will no longer be monitored (unwatch) as soon as the data in the expression becomes stable and passes the first <code>$digest</code> cycle. </p><br><p>  <strong>For example:</strong> </p><br><pre> <code class="hljs django"><span class="xml"></span><span class="hljs-template-variable"><span class="xml"></span><span class="hljs-template-variable">{{:: foo }}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ng-bind</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">":: foo"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ng-repeat</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">":: foo in bar"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">custom-directive</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">two-way-bind-property</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">":: foo"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">custom-directive</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><p>  <strong>Data stability:</strong> </p><br><p>  Data is considered unstable as long as it is <code>undefined</code> .  Any other data, be it <code>NaN</code> , <code>false</code> , <code>''</code> , <code>[]</code> or <code>null</code> , is considered stable and will result in <code>unwatch</code> expressions. </p><br><p>  This is necessary for static data that is not available during the first $ digest cycle. </p><br><p>  For example, if the data comes from the server, you can simply keep the variable value <code>undefined</code> while waiting for a request.  All this time, the pattern of this expression will live and only after setting data other than <code>undefined</code> , will it give ends. </p><br><p>  Treat expressions with <code>::</code> as a constant: once it is set, it is no longer possible to change it. </p><br><p>  <strong>Update non-updateable:</strong> </p><br><p>  Suppose we have an expression that is not updated in 99 cases out of 100 (that is, we didn‚Äôt fall for it), but sometimes it is required.  How to be?  I wondered if the bind-once expression could be updated by force. </p><br><p>  No, you can't :) However, you can write your own attribute directive, which will force the entire directive to be re-compiled in response to certain events.  An example is available <a href="http://jsbin.com/tifukitesu/1/edit%3Fhtml,js,output">here</a> . </p><br><hr><br><p>  This part of the performance ends, and you can talk about just nice buns: </p><br><h2>  ngModel Options </h2><br><p>  Version <strong>1.3</strong> presented in addition to the <code>ng-model</code> auxiliary directive <code>ng-model-options</code> , which is responsible for when the model is updated. </p><br><p>  The update time depends on two factors: </p><br><p>  1) <code>updateOn</code> - special events (events) for which the model is updated, for example, it can be <code>blur</code> , <code>click</code> or some kind of custom event.  The default is always <code>default</code> , meaning that each control will use its own event.  If you want to extend the standard event by adding your <code>{event: "default customEvent"}</code> , do not forget to add to the <code>default</code> list, for example: <code>{event: "default customEvent"}</code> . </p><br><p>  2) <code>debounce</code> - delay in updating the model in anticipation of new data (default 0, i.e. instantly).  If you specify the <code>{debounce: 300}</code> input and enter 3 characters with an interval of less than 300 milliseconds, your model (and therefore various modifiers / validators) will be updated only once.  In addition, <code>debounce</code> can be combined with events by specifying a delay for each of them, for example: <code>{event: "default customEvent", debounce: {default: 0, customEvent: 400}}</code> . </p><br><p>  This allows us to get rid of many bicycles (farewell, setTimeout / clearTimeout) and significantly improves performance (after all, we get rid of the useless restart of <code>$digest</code> , and accordingly all <code>$watchers</code> ), and also reduces the number of false positives for asynchronous validation (however, <code>$http</code> the service is smart enough not to send spam with queries, but wait for stable data). </p><br><h3>  But there are three more useful options. </h3><br><p>  The <strong>allowInvalid</strong> flag <strong>allows you</strong> to set <code>$modelValue</code> , even if the value is not valid for it (by default, while the value is not valid, the model is written <code>undefined</code> , which does not allow, for example, to know the intermediate value) </p><br><p>  The <strong>setterGetter</strong> flag <strong>allows you</strong> to set your own function as <code>ngModel</code> , a kind of intermediary between <code>ngModel.modelValue</code> and <code>ngModel.viewValue</code> acting as a setter and getter.  <a href="http://plnkr.co/edit/Zyzg6hLMLlOBdjeW4TO0%3Fp%3Dpreview">A live example on plunker</a> . </p><br><p>  <strong>timezone</strong> allows you to set the time zone for time related controls ( <code>date</code> or <code>time</code> ), for example, <code>'+0430'</code> will mean '4 hours 30 minutes GTM'.  By default, the browser time zone is taken. </p><br><h3>  Ignoring updateOn and debounce </h3><br><p>  Sometimes when manually recording a model, you need to ignore the delay set in the events and perform the update instantly.  For this there is a method <code>ngModelCtrl.$commitViewValue()</code> . </p><br><h3>  Undo change </h3><br><p>  If it is necessary to undo all changes and hangs in the <code>debounce</code> process, there is a <code>$rollbackViewValue()</code> method (formerly <code>$cancelUpdate()</code> ), which customizes the view to the current state of the model. </p><br><p>  As an example of using this feature, official documentation <a href="http://plnkr.co/edit/ngMJa2a4UCcEA2nMtTHc%3Fp%3Dpreview">suggests</a> inpat, changes in which can be rolled back by pressing ESC. </p><br><p>  <a href="https://docs.angularjs.org/api/ng/directive/ngModelOptions">Detailed documentation</a> </p><br><h2>  Validation </h2><br><p>  One of the major improvements in terms of usability is the validation of forms. </p><br><p>  Previously, we had to implement the validation mechanism through <code>ndModel.$formatters</code> and <code>ndModel.$parsers</code> , affecting the validation result directly, through <code>ndModel.$setValidity()</code> , and the implementation of asynchronous checks delivered a separate joy. </p><br><p>  <strong>Innovation affected the performance:</strong> </p><br><p>  After all, the previously validating functions were launched with each update in the DOM ( <code>$parsers</code> ) or model ( <code>$formatters</code> ), often affecting each other‚Äôs values, thereby restarting the test loop again. </p><br><p>  In the new version, validation is launched only if the model is changed and only if there is no error in this model ( <code>{parse: true</code> ).  The influence on the model or the representation of the control inside the validator is also excluded, which has a positive effect on the speed of the application. </p><br><div class="spoiler">  <b class="spoiler_title">What are $ formatters and $ parsers, what are they created for?</b>  <b class="spoiler_title">Are they removed?</b> <div class="spoiler_text"><p>  No, they have not been removed, these are other tools for other things, and they are still needed. </p><br><p>  Both <code>$formatters</code> and <code>$parsers</code> are arrays containing handler functions that take a value and pass it along the chain to the next handler function.  Each link in the chain can modify the value before passing it on. </p><br><p>  <strong>$ formatters</strong> <br>  Every time the model changes, <code>$formatters</code> handlers in the array in reverse order, from end to beginning.  The last value passed is responsible for how the model is represented in the DOM.  In other words, <code>$formatters</code> is responsible for how <code>ngModelCtrl.$modelValue</code> will be converted to <code>ngModelCtrl.$viewValue</code> . </p><br><p>  <strong>$ parsers</strong> <br>  Each time the control reads a value from the DOM, <code>$parsers</code> through the array of handlers in the normal order, from the beginning to the end, passing the value along the chain.  The last value transferred is responsible for how the value is represented in the model.  In other words, <code>$parsers</code> is responsible for how <code>ngModelCtrl.$viewValue</code> will be converted to <code>ngModelCtrl.$modelValue</code> . </p><br><p>  <strong>Where is it used?</strong> <br>  First of all, they are used in their work by the angular.  For example, if you create a control with validation at the minimum length, and then check the <code>$formatters</code> , you will notice that it is not empty, but already contains one processing function that converts the value from DOM to a string. </p><br><p>  The example above is the use of handlers for preprocessing (sanitize) values, if we want to be sure that it will fit into the model only in a strictly defined form. </p><br><p>  The other two popular ways to use it are two-way filtering of values ‚Äã‚Äã(for example, when the user enters "10, 000" into the input, and the model stores "10,000" and vice versa) and creating masks (for example, when the user must fill in the phone mask "+7 (000 ) 000-00-00 ", and in the model we will store" 70000000000 "). </p><br><p>  As can be seen from the examples - an indispensable tool. </p></div></div><br><div class="spoiler">  <b class="spoiler_title">How did the validation work before?</b> <div class="spoiler_text"><p>  Exhaustive information about the old validation methods can be obtained from these articles on Habr√©: </p><br><ul><li>  <a href="http://habrahabr.ru/post/167793/">Form Validation in AngularJS</a> </li><li>  <a href="http://habrahabr.ru/post/179473/">Forms in Angularjs.</a>  <a href="http://habrahabr.ru/post/179473/">How I found love</a> </li></ul></div></div><br><div class="spoiler">  <b class="spoiler_title">Why it is not necessary to use old methods of validation and further?</b> <div class="spoiler_text"><p>  The fact is that returning <code>undefined</code> from <code>ndModel.$parsers</code> now causes <code>ngModelCtrl.$modelValue</code> to be <code>ngModelCtrl.$modelValue</code> to <code>undefined</code> and adding <code>{parse: false}</code> to <code>ngModelCtrl.$modelValue</code> , i.e.  disability field. </p><br><p>  In this case, the validators ( <code>$validators</code> and <code>$asyncValidators</code> ) do not even begin their work. </p><br><p>  This behavior can be disabled in <code>ngModelOptions</code> by setting the <code>allowInvalid</code> flag to <code>true</code> . </p><br><p>  Starting from version <strong>1.3</strong> , we have the tools for convenient synchronous and asynchronous checking. </p><br><p>  It is also worth mentioning that since the work of new validators is tied to updating the model, it also depends on <code>ngModelOptions</code> , which were mentioned above. </p></div></div><br><h3>  Synchronous </h3><br><p>  For synchronous validation, the new version offers us the <code>ndModel.$validators</code> , expanding it with a validator function. </p><br><p>  The validator function must return <code>true</code> or <code>false</code> for valid and non-valid values, respectively. </p><br><p>  <strong>Example:</strong> </p><br><pre> <code class="hljs ruby"> ngModel.$validators.integer = function(modelValue, viewValue) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ,      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ctrl.$isEmpty(modelValue)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (INTEGER_REGEXP.test(viewValue)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    };</code> </pre> <br><h3>  Asynchronous </h3><br><p>  For asynchronous validation, the <code>ngModelCtrl.$asyncValidators</code> collection is used, with the same logic expanding it with a validator function. </p><br><p>  The main differences of the asynchronous version: </p><br><ul><li>  Asynchronous validation starts only if all synchronous validations are valid. </li><li>  The validator function should return only promis, implementing its <code>resolve()</code> or <code>reject()</code> , for valid and non-valid values, respectively. </li></ul><br><p>  Promises in AngularJS are generated by a special <code>$q</code> service, as well as services like <code>$timeout</code> and <code>$http</code> , which basically also use <code>$q</code> . </p><br><p>  The collection contains no more than one promise returned by one validator.  This means that if validation is called several times, only the promise from the last call of the validator will be counted, regardless of the result of the previous promises. </p><br><p>  From the moment a promise is transmitted by the validator function, and until resolved ( <code>resolve()</code> or <code>reject()</code> ), the <code>ngModelCtrl.$pending</code> field stores the name of the validator, and <code>ngModelCtrl.$valid</code> <code>ngModelCtrl.$invalid</code> and <code>ngModelCtrl.$invalid</code> are equal to <code>undefined</code> </p><br><p>  Be careful with this feature: as long as validation is in <code>FormCtrl.$errors</code> form will not be valid, and you will not see any errors in <code>FormCtrl.$errors</code> Errors, but you can see "waiting" validators in <code>FormCtrl.$pending</code> . </p><br><div class="spoiler">  <b class="spoiler_title">Examples:</b> <div class="spoiler_text"><pre> <code class="hljs ruby"> ngModelCtrl.$asyncValidators.username = function(modelValue, viewValue) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ,      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ctrl.$isEmpty(modelValue)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $q.<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>(); } var <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> = $</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">q</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    $timeout(function() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (usernames.indexOf(modelValue) === -<span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resolve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  ,   } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  ,    } }, <span class="hljs-number"><span class="hljs-number">2000</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">promise</span></span></span><span class="hljs-function">;</span></span> }; ngModelCtrl.$asyncValidators.uniqueUsername = function(modelValue, viewValue) { var value = modelValue <span class="hljs-params"><span class="hljs-params">||</span></span> viewValue; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ,     <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $http.get(<span class="hljs-string"><span class="hljs-string">'/api/users/'</span></span> + value). <span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(function resolved() { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  ,   ,     <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $q.reject(<span class="hljs-string"><span class="hljs-string">'exists'</span></span>); }, function rejected() { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   ,  ,    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }); };</code> </pre> </div></div><br><p>  It is worth using asynchronous validation with fields that use value modifiers (via <code>$formatters</code> and <code>$parsers</code> ): this can cause multiple operations, as well as false validation or invalidation of the field. </p><br><div class="spoiler">  <b class="spoiler_title">Validation example for such cases</b> <div class="spoiler_text"><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pendingPromise; ngModelCtrl.$asyncValidators.checkPhoneUnique = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(modelValue)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pendingPromise) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> pendingPromise; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> deferred = $q.defer(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (modelValue) { pendingPromise = deferred.promise; $http.post(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, {value: modelValue}) .success(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.Result === <span class="hljs-string"><span class="hljs-string">'   '</span></span>) { deferred.resolve(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { deferred.reject(); } }).error(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ deferred.reject(); }).<span class="hljs-keyword"><span class="hljs-keyword">finally</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ pendingPromise = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { deferred.resolve(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> deferred.promise; };</code> </pre> </div></div><br><h2>  ngMessages </h2><br><p>  Module <code>ngMessages</code> designed to facilitate the display of messages on the page. </p><br><p>  Despite the fact that this module can be conveniently used for any messages on the page, it is usually used to display errors in the forms.  To understand what problems this tool solves, let's see what pain the old way of displaying errors gave us, and compare it with the new one. </p><br><p>  For the comparison example, we will use this form for adding a comment: </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"commentForm"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"warnings"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-if</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"commentForm.$error &amp;&amp; commentForm.$dirty"</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span>:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"username"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-model</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"comment.username"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">required</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span>:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textarea</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"message"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-model</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"comment.message"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">minlength</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"5"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">maxlength</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"500"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textarea</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Let's leave the implementation directly validation and consider only the display of messages about the necessary conditions: </p><br><ul><li>  The field "Name" must not be empty </li><li>  The field "Message" must not be less than 5 characters </li><li>  The field "Message" must not exceed 500 characters <br>  The errors will be displayed in the <code>.errors</code> block. </li></ul><br><h3>  Old methods of displaying errors </h3><br><div class="spoiler">  <b class="spoiler_title">The example came out long, so I hid it under the spoiler.</b> <div class="spoiler_text"><p>  Now imagine how we display errors for these fields: </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"commentForm"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"warnings"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-if</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"commentForm.$error &amp;&amp; commentForm.$dirty"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-if</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"commentForm.message.$error.minlength"</span></span></span><span class="hljs-tag">&gt;</span></span>      5  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-if</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"commentForm.username.$error.maxlength"</span></span></span><span class="hljs-tag">&gt;</span></span>      500  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-if</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"commentForm.username.$error.required"</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span>:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span>:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Well, as long as things don't look so bad, right? <br>  But why are nicknames and comments all displayed at once?  Let's fix this by adding a sequential mapping: </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"commentForm"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"warnings"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-if</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"commentForm.$error &amp;&amp; commentForm.$dirty"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-if</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"commentForm.message.$error.minlength &amp;&amp; commentForm.username.$valid"</span></span></span><span class="hljs-tag">&gt;</span></span>      5  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span>:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span>:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Do you still think: ‚Äúthis is not so bad‚Äù?  Imagine that the fields on the page are not 2, but 20, and each has at least 5 messages.  In a similar style, our page will quickly turn into a trash of conditions. </p><br><p>  Of course, there are best practices for the implementation of this task, special directives and crutches that extend the behavior of the <code>FormController</code> (for example, in our project all controls were extended by the <code>showError</code> property that kept the current error), but they all lose in convenience to the methods we will talk about further . </p></div></div><br><h3>  New methods of displaying errors </h3><br><div class="spoiler">  <b class="spoiler_title">Connection</b> <div class="spoiler_text"><p>  <code>ngMesssages</code> supplied as a separate module, and before we start working with it, we need to connect it.  Download or install the module through the package manager and connect to the project: </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"path/to/angular-messages.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  And add depending: </p><br><pre> <code class="hljs java">angular.<span class="hljs-keyword"><span class="hljs-keyword">module</span></span>(<span class="hljs-string"><span class="hljs-string">'myApp'</span></span>, [<span class="hljs-string"><span class="hljs-string">'ngMessages'</span></span>]);</code> </pre> </div></div><br><p>  Basic work with this module comes down to working with two directives: </p><br><ol><li>  <code>ng-messages</code> - the container containing our messages </li><li>  <code>ng-message</code> - direct message </li></ol><br><p>  <code>ng-messages</code> takes as an argument a collection, the keys of which will check and show already <code>ng-message</code> , which take as an argument for comparison a string or expression (starting with <strong>1.4</strong> ). </p><br><p>  Let's repeat the example of the same form for adding a comment, but using <code>ngMessages</code> : </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-messages</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"commentForm.message.$error"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"warnings"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-message</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"minlength"</span></span></span><span class="hljs-tag">&gt;</span></span>      5  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-message</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"maxlength"</span></span></span><span class="hljs-tag">&gt;</span></span>      500  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-message</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"required"</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  <code>ngMessages</code> can <code>ngMessages</code> be used as an element: </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-messages</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"commentForm.message.$error"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"warnings"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-message</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">when</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"minlength"</span></span></span><span class="hljs-tag">&gt;</span></span>      5  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-message</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">when</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"maxlength"</span></span></span><span class="hljs-tag">&gt;</span></span>      500  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-message</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">when</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"required"</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-messages</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  And so, right <code>ngMessages</code> solved two problems for us: </p><br><ul><li>  The noodles of the conditions turned into a readable <code>switch</code> like list. </li><li>  The problem with the output of messages one by one decided by itself </li></ul><br><p>  In addition, the problem of <strong>prioritizing the</strong> output of messages is also being solved.  Everything is simple here: messages are displayed according to their location in the DOM. </p><br><p>  <strong>Multiple messages</strong> can be enabled by adding the <code>ng-messages-multiple</code> attribute to the <code>ng-messages-multiple</code> directive: </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-messages</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ng-messages-multiple</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"commentForm.message.$error"</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-messages</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p> <strong> </strong>  ‚Äì      <code>ngMessages</code> ,     ,  ,    : </p><br><div class="spoiler"> <b class="spoiler_title">,      1.4,   1.3  </b> <div class="spoiler_text"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Version </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.3</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> uses </font></font><code>ng-messages-include</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as an additional attribute </font></font><code>ng-messages</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, while in later versions </font></font><code>ng-messages-include</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">it is a self-contained child directive along with </font></font><code>ng-message</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font></p><br><p> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.3</font></font></strong> </p><br><pre> <code class="hljs pgsql">&lt;ng-messages ng-messages-<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>="length-message" <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>="commentForm.message.$error"&gt; &lt;/ng-messages&gt;</code> </pre> <br><p> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1.4+</font></font></strong> </p><br><pre> <code class="hljs pgsql">&lt;ng-messages <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>="commentForm.message.$error"&gt; &lt;ng-messages-<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>="length-message"&gt;&lt;/ng-messages-<span class="hljs-keyword"><span class="hljs-keyword">include</span></span>&gt; &lt;/ng-messages&gt;</code> </pre> </div></div><br><p>        (,    )   ,          : </p><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"script/ng-template"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"length-message"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ng-message</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">when</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"minlength"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">     </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ng-message</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-messages</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"commentForm.message.$error"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-messages-include="length-message"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-messages-include</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-messages</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-messages</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"anotherForm.someField.$error"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-messages-include="length-message"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-messages-include</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-messages</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>      ,  ,        .                        . </p><br><p>      ,    <strong>1.4</strong>   <strong> </strong> ,      <code>ng-message-exp</code> : </p><br><pre> <code class="hljs lua">// <span class="hljs-built_in"><span class="hljs-built_in">error</span></span> = {<span class="hljs-built_in"><span class="hljs-built_in">type</span></span>: required, message: <span class="hljs-string"><span class="hljs-string">'    '</span></span>}; &lt;ng-messages <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>=<span class="hljs-string"><span class="hljs-string">"commentForm.message.$error"</span></span>&gt; &lt;ng-message-<span class="hljs-built_in"><span class="hljs-built_in">exp</span></span>=<span class="hljs-string"><span class="hljs-string">"error.type"</span></span>&gt; {{ <span class="hljs-built_in"><span class="hljs-built_in">error</span></span>.message }} &lt;/ng-message-<span class="hljs-built_in"><span class="hljs-built_in">exp</span></span>&gt; &lt;/ng-messages&gt;</code> </pre> <br><p> <code>ng-message-exp</code> ,    <code>ng-message</code> ,      ( <code>expression</code> ).   , ,  ,      AJAX . </p><br><p>    ‚Äì   .                     <code>ng-messages</code> ! </p><br><p> <strong>    :</strong> </p><br><ul><li>       </li><li>         </li><li>      </li><li>      </li><li>             <code>ng-messages</code> </li></ul><br><h2>  </h2><br><h3> bindToController </h3><br><p> <a href="http://plnkr.co/edit/i5HvEsBcgT9S4z4qQHKp%3Fp%3Dpreview">[]</a> </p><br><p> ,    <code>controller as</code> ,         <code>scope</code> . </p><br><p>      ,   <code>this.something</code>  .         . </p><br><p>  <strong>For example:</strong> </p><br><pre> <code class="hljs actionscript">app.directive(<span class="hljs-string"><span class="hljs-string">'someDirective'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { scope: { name: <span class="hljs-string"><span class="hljs-string">'='</span></span> }, controller: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = <span class="hljs-string"><span class="hljs-string">'Foo'</span></span> }, controllerAs: <span class="hljs-string"><span class="hljs-string">'ctrl'</span></span> ... }; });</code> </pre> <br><p>   <code>name</code>        . </p><br><p>     <del>  </del> : </p><br><pre> <code class="hljs actionscript"> $scope.$watch(<span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(newValue)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = newValue; }.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>));</code> </pre> <br><p>   , ,   ,      ,  ? </p><br><p>     <strong>1.3</strong> : </p><br><p>   <code>bindToController</code> . </p><br><pre> <code class="hljs actionscript">app.directive(<span class="hljs-string"><span class="hljs-string">'someDirective'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { scope: { name: <span class="hljs-string"><span class="hljs-string">'='</span></span> }, controller: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = <span class="hljs-string"><span class="hljs-string">'Foo'</span></span> }, bindToController: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, ... }; });</code> </pre> <br><p>  <code>ctrl.name</code>   <code>$scope.name</code>      . </p><br><p>   <strong>1.4</strong>      : </p><br><pre> <code class="hljs actionscript">app.directive(<span class="hljs-string"><span class="hljs-string">'someDirective'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { scope: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, bindToController: { name: <span class="hljs-string"><span class="hljs-string">'='</span></span> }, controller: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = <span class="hljs-string"><span class="hljs-string">'Foo'</span></span> }, ... }; });</code> </pre> <br><p>      <code>scope</code>   <code>bindToController</code> . </p><br><p> ,    <code>bindToController</code> ,    ,  ,    <code>scope</code> ,    <code>scope</code> . </p><br><p>    -  <code>scope</code>   ,  <code>true</code> .       <code>bindToController</code>    <code>scope</code> . </p><br><h2>  </h2><br><pre> <code class="hljs mel">{{ <span class="hljs-keyword"><span class="hljs-keyword">expression</span></span> | <span class="hljs-keyword"><span class="hljs-keyword">filter</span></span> }}</code> </pre> <br><h3>   </h3><br><p>     ,    ,  ¬´¬ª      ( <code>expression</code> ),     ( <code>filter</code> ).   , , ,      . </p><br><p>    1.3    :    ,       .    ,         ,     <code>$digest</code> ,    ,     .                ,    ,     . </p><br><p> <a href="http://plnkr.co/edit/sA76SBrWwhQjfSL4h5Gk%3Fp%3Dpreview">   plunker</a> </p><br><p>   :    ,       ,    -  ?  ,     , ¬´¬ª ,    ? </p><br><p>    1.3     ( <code>stateless</code> )   ( <code>stateful</code> ) .       <code>stateless</code> .    ,     <code>$stateful</code>  <code>true</code> . </p><br><p>  <strong>Example:</strong> </p><br><pre> <code class="hljs lua">angular.module(<span class="hljs-string"><span class="hljs-string">'myApp'</span></span>, []) .filter(<span class="hljs-string"><span class="hljs-string">'customFilter'</span></span>, [<span class="hljs-string"><span class="hljs-string">'someService'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(someService)</span></span></span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">customFilter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(input)</span></span></span></span> { //     someService <span class="hljs-built_in"><span class="hljs-built_in">input</span></span> += someService.getData(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">input</span></span>; } customFilter.$stateful = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> customFilter; }]);</code> </pre> <br><p> <strong>Breaking change:</strong> <br>    ,           .  ,        ,     . </p><br><h3>  <code>dateFilter</code> </h3><br><p>          <code>weeks</code> </p><br><h3>  Conclusion </h3><br><p>  That's all.    -            ,    . </p><br><p>    <a href="http://blog.thoughtram.io/"> </a> ,          . </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><p>  ,    markdown.              -         html. </p><br><p>   ,  ,     :) </p><br><p><img src="https://habrastorage.org/files/534/f67/335/534f673353684249a97dce4a6462a74d.png" alt="image"></p></div></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/281721/">https://habr.com/ru/post/281721/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../281709/index.html">Dcoin on iOS ... and Kate. The final</a></li>
<li><a href="../281711/index.html">Vertical indents or again about the margin</a></li>
<li><a href="../281715/index.html">Programming and debugging ARM Cortex-M4 microcontrollers by Atmel in the environment of the Linux operating system. Part 2</a></li>
<li><a href="../281717/index.html">Ladies Code Conference: Girls at IT April 26 in Moscow</a></li>
<li><a href="../281719/index.html">The main issue of programming, refactoring and all that</a></li>
<li><a href="../281723/index.html">On the issue of availability</a></li>
<li><a href="../281725/index.html">News of the world of IT. April</a></li>
<li><a href="../281727/index.html">Angular 2 Beta, training course "Tour of Heroes" part 2</a></li>
<li><a href="../281729/index.html">Security Week 15: Badlock is not impressed, more cryptographs, another vulnerability in iMessage</a></li>
<li><a href="../281731/index.html">Manifesto of future changes through the prism of the market</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>