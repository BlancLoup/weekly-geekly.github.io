<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using SQLite in .NET applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In some projects, quite often there is a need for data storage, the volume of which can no longer be called small, but at the same time it is too expe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using SQLite in .NET applications</h1><div class="post__text post__text-html js-mediator-article"><img title="SQLite + Microsoft .NET" src="https://habrastorage.org/getpro/habr/post_images/d5a/71c/8f4/d5a71c8f453bb8f879a009c9e7d9bb8f.png"><br><br>  In some projects, quite often there is a need for data storage, the volume of which can no longer be called small, but at the same time it is too expensive to use any DBMS due to the complexity of the application deployment.  And here comes to the aid of such a beautiful thing as SQLite - compact embedded database. <br><br>  For those who write using the .NET platform, having a good time will be <a name="habracut"></a>  ready ADO.NET provider for working with SQLite, which can be downloaded from the site: <a href="http://sqlite.phxsoftware.com/">http://sqlite.phxsoftware.com/</a> .  This provider also allows you to use all the additional features of the latest versions of .NET, such as LINQ, Entity Framework. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Where to begin </h2><br>  The first thing to start with is the choice of the platform that the created application is aimed at.  We must pay tribute to the developers of the provider for SQLite, which provided support for almost all available platforms.  All you need to do is select the version of the System.Data.SQLite.dll assembly you need.  The assembly itself is compiled in various variations: <br><ol><li>  Managed Only is the best option for those who create applications that should work on both Windows and Linux-based operating systems.  In this case, the assembly includes only the managed code of the provider, and depending on the OS, you will need the native version of the SQLite library (for example: sqlite3.dll on Windows), which can be obtained from <a href="http://www.sqlite.org/">http://www.sqlite.org</a> . </li><li>  Compact Framework is a version for working in the .NET CF environment for mobile devices running Windows CE.  Includes a wrapper for the unmanaged SQLite library and the implementation of the necessary ADO.NET interfaces.  The uncontrollable library of the SQLite engine for Windows CE is located in the same place where the System.Data.SQLite.dll assembly is the SQLite.Interop.060.DLL file. </li><li>  Itanium is the version of the adapter for work on Intel Itanium processors.  In this case, the application requires only the System.Data.SQLite.dll assembly, which already contains unmanaged SQLite engine code. </li><li>  x64 is a version for platforms with x64 architecture.  Also contains managed and unmanaged parts in a single assembly. </li><li>  x86 is a version for platforms with x86 architecture.  It is built in the same way as the x64 and Itanium versions and does not require any unmanaged versions of the library of the SQLite engine. </li></ol><br>  It is worth noting that the third, fourth and fifth versions use a number of specific features of C ++ with Managed Extensions, which allows you to compile the managed part of ADO.NET and the unmanaged part of the SQLite database engine itself as a single assembly.  Because of this, the use of these assemblies is limited only to the Windows platform. <br><br>  If you use the Visual Studio development environment (in particular, version 2008), then SQLite Designer can also come in handy, which allows you to use visual tools for working with SQLite databases: Query Builder, table editing, and a number of other features. <br><br>  Well, in addition to everything, the provider library includes the System.Data.SQLite.Linq.dll assembly, which provides access to the LINQ technology. <br><br><h2>  Creating SQLite Database </h2><br>  You can create a SQLite database both programmatically and using Server Explorer, which is available in Visual Studio.  Consider a programmatic way to create a database using the ADO.NET provider.  As the simplest example, I will create a database and one table in which data will be stored on the workers of an abstract firm. <br><br>  Creating a database and tables using ADO.NET: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">using</font> System; <br> <font color="#0000ff">using</font> System.IO; <br> <font color="#0000ff">using</font> System.Data; <br> <font color="#0000ff">using</font> System.Data.Common; <br> <font color="#0000ff">using</font> System.Data.SQLite; <br> <br> <font color="#0000ff">class</font> Program <br> { <br> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Main( <font color="#0000ff">string</font> [] args) <br> { <br> <font color="#0000ff">string</font> baseName = <font color="#A31515">"CompanyWorkers.db3"</font> ; <br> <br> SQLiteConnection.CreateFile(baseName); <br> <br> SQLiteFactory factory = (SQLiteFactory)DbProviderFactories.GetFactory( <font color="#A31515">"System.Data.SQLite"</font> ); <br> <font color="#0000ff">using</font> (SQLiteConnection connection = (SQLiteConnection)factory.CreateConnection()) <br> { <br> connection.ConnectionString = <font color="#A31515">"Data Source = "</font> + baseName; <br> connection.Open(); <br> <br> <font color="#0000ff">using</font> (SQLiteCommand command = <font color="#0000ff">new</font> SQLiteCommand(connection)) <br> { <br> command.CommandText = <font color="#A31515">@"CREATE TABLE [workers] ( <br> [id] integer PRIMARY KEY AUTOINCREMENT NOT NULL, <br> [name] char(100) NOT NULL, <br> [family] char(100) NOT NULL, <br> [age] int NOT NULL, <br> [profession] char(100) NOT NULL <br> );"</font> ; <br> command.CommandType = CommandType.Text; <br> command.ExecuteNonQuery(); <br> } <br> } <br> } <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  In this example, the SQLiteFactory, SQLiteConnection, SQLiteCommand classes are used to create the database file, connect to the data source, and execute SQL queries.  These classes also implement support for the ADO.NET interfaces by inheriting the basic abstract classes of ADO.NET, this can be seen if you look at their prototypes in the Object Browser.  Here are some of them: <br><br><blockquote> <code><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">sealed</font> <font color="#0000ff">class</font> SQLiteFactory : DbProviderFactory, IServiceProvider <br> <font color="#0000ff">public</font> <font color="#0000ff">sealed</font> <font color="#0000ff">class</font> SQLiteConnection : DbConnection, ICloneable <br></font> <br></code> </blockquote><br><br>  So, the SQLiteFactory class implements the DbProviderFactory functional, and the SQLiteConnection class implements the DbConnection functionality.  The DbProviderFactory and DbConnection classes are part of the standard ADO.NET abstract classes, whose interfaces provide unified access to data regardless of the DBMS used. <br><br>  You can make sure that the database was actually created using the Server Explorer mentioned above, simply by creating a connection to the database file: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/161/c90/113/161c901130e25b8790aa0acc79c1d4fb.png"><br><br>  Fig.  1. View CompanyWorkers database through Server Explorer <br><br>  In general, the provider for SQLite implements all the functionality that is necessary for working with databases at both the linked and unrelated levels of ADO.NET. <br><br><h2>  Editing SQLite Database </h2><br>  Editing the database, consider the example of the simplest Web Forms application.  In general, working with SQLite in this case differs little from working with another DBMS, due to the use of the ADO.NET interface. <br><br>  I'll create a simple ASP.NET page that uses a GridView control, DetailsView, and two SqlDataSource objects that provide access to the CompanyWorkers.db3 database.  Further, I present only the most important points that are necessary for the operation of the application. <br><ul><li>  Set up the first SqlDataSource1 object.  In the editor, it is used only as a data source for the GridView1 object, so when setting up a connection to the database, it will be enough to specify that you only need to extract data from CompanyWorkers.db3, this is easy to do in the SqlDataSource1 settings window: </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/806/499/146/80649914631d141142cec5e118ae188c.png"><br>  Fig.  2. Select all columns in the workers table. <br><ul><li>  After configuring SqlDataSource1, you need to add an object of the GridView class to the form, which is done by simply dragging the control from the Toolbox onto the apsx page.  For the resulting GridView1 object, select the data source SqlDataSource1.  In the GridView1 settings, enable the Enable Selection option, which will be needed when editing the desired row. </li><li>  Next we add to the form an element of the DetailsView class and another object of the SqlDataSource class.  The DetailsView1 element will be the main data editor for the workers table.  Pre-configure the SqlDataSource2 to select the desired record from the table for DetailsView1 when you click Select opposite the employee of interest in GridView1.  To do this, in the data source settings, go to WHERE and specify how the current item is selected for DetailsView1: </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/4db/71b/a6b/4db71ba6b413c8394cc27a16b39b1ac2.png"><br>  Fig.  3. We associate the selection of a record from the table with the value of the SelectedValue of the DataGrid1 element. <br><ul><li>  We return to the previous window and in Advanced we set a checkbox to generate insert requests, update and delete records in the table: </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/f1f/fe9/34c/f1ffe934c1bcba505708fbd65a439b5e.png"><br>  Fig.  4. Create insertion, update and delete requests. <br><ul><li>  Set SqlDataSource2 as a data source for DetailsView1.  In general, the application is already ready, but when working with it you can see that when adding and removing employees using DetailsView1 in DataGrid1, the data is not updated, in order to fix this you need to add handlers in DetailsView1 for the ItemDeleted, ItemUpdated and ItemIserted events that link DataGrid1 to updated data: </li></ul><br><blockquote> <code><font color="black"><font color="#0000ff">using</font> System; <br> <font color="#0000ff">using</font> System.Collections; <br> <font color="#0000ff">using</font> System.Configuration; <br> <font color="#0000ff">using</font> System.Data; <br> <font color="#0000ff">using</font> System.Web; <br> <font color="#0000ff">using</font> System.Web.Security; <br> <font color="#0000ff">using</font> System.Web.UI; <br> <font color="#0000ff">using</font> System.Web.UI.HtmlControls; <br> <font color="#0000ff">using</font> System.Web.UI.WebControls; <br> <font color="#0000ff">using</font> System.Web.UI.WebControls.WebParts; <br> <font color="#0000ff">using</font> DataEditor.CompanyWorkersTableAdaptersTableAdapters; <br> <br> <font color="#0000ff">namespace</font> DataEditor <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> <font color="#2B91AF">_Default</font> : System.Web.UI. <font color="#2B91AF">Page</font> <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> GridViewDataBind() <br> { <br> <font color="#008000">//   GridView1</font> <br> <font color="#0000ff">this</font> .GridView1.DataBind(); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">void</font> DetailsView1_ItemDeleted( <font color="#0000ff">object</font> sender, DetailsViewDeletedEventArgs e) <br> { <br> GridViewDataBind(); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">void</font> DetailsView1_ItemUpdated( <font color="#0000ff">object</font> sender, DetailsViewUpdatedEventArgs e) <br> { <br> GridViewDataBind(); <br> } <br> <br> <font color="#0000ff">protected</font> <font color="#0000ff">void</font> DetailsView1_ItemInserted( <font color="#0000ff">object</font> sender, DetailsViewInsertedEventArgs e) <br> { <br> GridViewDataBind(); <br> } <br> } <br> } <br></font> <br></code> </blockquote><br><br>  Now the application is fully ready for use.  The final view of the editor for editing the workers table from the CompanyWorkers.db3 database: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/03f/cfd/d26/03fcfdd2633aa3f0adc34bda13abc9d7.png"><br>  Fig.  5. Editor ready to work. <br><br>  Thanks to SQLite, I didn‚Äôt need to deploy any services to work with the database. <br><br><h2>  Conclusion </h2><br>  I think the SQLite capabilities should be enough for a sufficiently wide range of tasks.  At the same time, you should not try to use it in any serious projects with very large amounts of data and a large number of users, since this DBMS is not intended for this: there is no support for multiprocessing and the levels of isolation for transactions are limited.  In general, for medium projects, such as a database of a small company or a telephone directory, the most appropriate tool. <br><br>  PS: I used the x86 version of the System.Data.SQLite.dll assembly in my examples. </div><p>Source: <a href="https://habr.com/ru/post/56694/">https://habr.com/ru/post/56694/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../56689/index.html">Jailbreak firmware 3.0 for iPhone</a></li>
<li><a href="../5669/index.html">Free ... Kaspersky</a></li>
<li><a href="../56690/index.html">VPN with firewall / NAT</a></li>
<li><a href="../56691/index.html">Are you participating in the development of open source projects?</a></li>
<li><a href="../56693/index.html">Web 2.0 conference in Minsk is looking for speakers</a></li>
<li><a href="../56697/index.html">Learning from a distance or a bit about Moodle</a></li>
<li><a href="../567/index.html">Habrazniz system Stanislavsky</a></li>
<li><a href="../5670/index.html">Geek recommendation</a></li>
<li><a href="../56700/index.html">Has something changed in Yandex this night? "Yandex" gets rid of the "tick"?</a></li>
<li><a href="../56702/index.html">Basics of replication in MySQL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>