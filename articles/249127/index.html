<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Practice "Intel IoT". Galileo Gen2 - Eclipse & libmraa + UPM</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is time to assemble and launch your ‚ÄúHello, world!‚Äù (And not only) on Galileo, having studied in the process how to do this in the most technical w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Practice "Intel IoT". Galileo Gen2 - Eclipse & libmraa + UPM</h1><div class="post__text post__text-html js-mediator-article">  It is time to assemble and launch your ‚ÄúHello, world!‚Äù (And not only) on Galileo, having studied in the process how to do this in the most technical way. <br><br> <a href="http://habrahabr.ru/company/intel/blog/249127/"><img src="https://habrastorage.org/getpro/habr/post_images/c31/d7d/8af/c31d7d8af8fe8a36589f4dc9067b272c.jpg" alt="image"></a> <br><a name="habracut"></a><br><h2>  <font color="#0071c5">Hardcore</font> </h2><br>  To create programs for Intel Galileo, you can not use any development environment at all.  In the image of <a href="https://www.yoctoproject.org/">Yocto</a> , which we have prepared and installed in the <a href="http://habrahabr.ru/company/intel/blog/248893/">previous part of the "practical work"</a> - there is everything you need: <br><br><ul><li>  Editor </li><li>  Libraries </li><li>  Compiler </li></ul><br>  Therefore, we proceed: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>1.</b> Connect to our target system via SSH (the current folder is / home / root / by default) <br><br>  <b>2.</b> Start the text editor with the file being created: <br><br><pre><code class="bash hljs">nano blink.cpp</code> </pre> <br>  <b>3.</b> Enter the following code: <br><br><pre> <code class="hljs vbscript">#include <span class="hljs-string"><span class="hljs-string">"mraa.h"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> main() { mraa_gpio_context gpio; gpio = mraa_gpio_init(<span class="hljs-number"><span class="hljs-number">13</span></span>); mraa_gpio_dir(gpio, MRAA_GPIO_OUT); bool ledState=<span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-literal"><span class="hljs-literal">true</span></span>){ mraa_gpio_write(gpio, ledState?<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>); ledState=!ledState; sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>); } }</code> </pre><br>  Exit (Ctrl + X) and confirm the save. <br><br>  <b>4.</b> Compile: <br><br><pre> <code class="bash hljs">g++ blink.cpp -lmraa -o blink</code> </pre> <br>  If all is well, then there will be no error messages. <br><br>  <b>5.</b> Run the application: <br><br><pre> <code class="bash hljs">./blink</code> </pre> <br>  After that, the integrated LED on the board blinks as expected. <br><br>  The code above requires clarification: for such a simple manipulation of pins, the library libmraa is used. <br><br><h2>  <font color="#0071c5">Libmraa library</font> </h2><br>  As it was <a href="http://habrahabr.ru/company/intel/blog/236179/">written earlier</a> , this is a ‚Äúbicycle‚Äù, which was invented by Intel in order to provide the easiest access to the pins that are present on Galileo (and Edison) debugging platforms.  The library is a ‚Äúwrapper‚Äù for configuring and managing these pins. <br><blockquote>  Since the library is <a href="https://github.com/intel-iot-devkit/mraa">open source</a> - you can just peep at how you can work with the corresponding ports directly, without abstractions provided by libmraa. </blockquote><br>  This maximally simplifies the ‚Äúentry‚Äù into the development for ‚Äúformer Arduinschikov‚Äù or beginners.  The <a href="http://iotdk.intel.com/docs/master/mraa/">libmraa</a> library allows you to configure pins as GPIO, ADC, PWM, I2C, SPI and RS232.  It helps that the library is well documented. <br><br>  This is good (for the Intel platform), but the Arduino platform is still very attractive for ordinary users (especially beginners) because there are a huge number of different libraries that implement the most simple interaction with various sensors / displays / "performers", etc.  Intel decided to offer its solution in this matter: <br><br><h2>  <font color="#0071c5">UPM library</font> </h2><br>  <a href="http://iotdk.intel.com/docs/master/upm/">UPM</a> runs on top of libmraa and knows nothing about the hardware component of the platform.  This library implements the logic of working with connected devices.  Unfortunately, the list of compatible devices with which you can work through UPM is still <a href="">quite modest</a> , but I am sure that this is a temporary phenomenon. <br><br>  The UPM library is also <a href="https://github.com/intel-iot-devkit/UPM">open source</a> - if you wish, you can understand and add support for the missing device. <br><br>  But back directly to the programming process.  Writing code in the console editor is not a great pleasure and is only suitable for "real Jedi", but most developers prefer to use handy development tools with code highlighting, autocompletion and other buns, and one of these tools is <b><a href="http://habrahabr.ru/hub/eclipse/">Eclipse</a></b> .  The guys from Intel took care and prepared this environment for working with the Galileo (and Edison) debugging boards. <br><br><h2>  <font color="#0071c5">Installation and first launch</font> </h2><br>  Installation is as simple as possible for all platforms - just download the <a href="http://iotdk.intel.com/sdk/1.1/">appropriate</a> file with the archive of the pre-configured development environment (includes Eclipse itself, libraries and examples) and unpack it to any convenient place on the disk. <br><img src="https://habrastorage.org/files/015/b59/8ec/015b598ec19e4b0384830fb82917d417.png"><br>  <i><font color="#999">Appearance of the development environment at the first launch</font></i> <br><br>  Since we plan to conduct development for Intel Galileo Gen2 - you need the environment to indicate this.  To do this, go to the Remote System Explorer tab (in the upper right corner of the Eclipse interface).  Since Intel has already prepared almost everything, there is already a ‚Äúgalileo‚Äù node in the opened tree of remote systems - all that remains is to specify the IP address of the target system (how to find out the IP address of the Intel Galileo Gen2 described in the <a href="http://habrahabr.ru/company/intel/blog/248893/">previous part of</a> the practicum).  After that, you can connect to the node (context menu on the node "galileo" -&gt; "Connect").  If done correctly, you will be prompted for a password: <br><img src="https://habrastorage.org/files/1b1/911/5f2/1b19115f26fe4a7f8f1c9ab1914a9e3a.png"><br>  After successfully connecting with Intel Galileo Gen2, each element of the ‚Äúgalileo‚Äù node will have green ‚Äúpluses‚Äù, showing that everything is in order and you can work. <br><br>  Next we do the usual Build.  Since everything is already set up - the project from the example will ‚Äúassemble‚Äù without errors (we look at the messages in the console from below and there we look at the ‚ÄúProblems‚Äù section).  Done, run the project (Run) - at the bottom we see the data from the debug board (as if the application was launched directly via the SSH console): <br><img src="https://habrastorage.org/files/61d/720/165/61d72016547c49199a50a6c0c02c9c0d.png"><br>  Is done.  Now you can experiment with already prepared examples. <br><br><h2>  <font color="#0071c5">Upgrade libmraa and upm</font> </h2><br>  When studying the <a href="https://github.com/intel-iot-devkit/upm/tree/master/examples">examples</a> , it turned out that the versions of the libraries that come with the Intel IoT Developer Kit (iotdk) are somewhat outdated and need to be updated.  Update: <br><br><h3>  <font color="#0071c5">On Intel Galileo Gen2</font> </h3><br>  The update is done as follows: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"src maa-upm http://iotdk.intel.com/repos/1.1/intelgalactic"</span></span> &gt; /etc/opkg/intel-iotdk.conf opkg update opkg upgrade</code> </pre><br>  I can recommend to do it regularly, as the project develops. <br><br><h3>  <font color="#0071c5">On the desktop</font> </h3><br>  Download the latest versions of libraries (with maximum numbers) <a href="http://iotdk.intel.com/sdk/mraa-update/">mraa</a> and <a href="http://iotdk.intel.com/sdk/upm-update/">upm</a> and simply unzip them into the folder where you have the IDE installed.  Naturally, you need to download the version for your platform.  Now we have up-to-date versions of libraries and the development environment is ready to ‚Äúfight‚Äù! <br><br>  The pre-configured Eclipse with examples is just great, but nothing is said about how to create a new project in such a way that it works just like the examples.  Correct this situation. <br><br><h2>  <font color="#0071c5">Creating a new project</font> </h2><br>  Here I am a little cunning: I will use one of the projects that the guys at Intel have prepared, since creating a project from scratch, all its configuration for building and preparing all environment variables is a very troublesome task. <br><blockquote>  Naturally, it is possible to create a project anew, having previously ‚Äúsketched‚Äù all the parameters of an ‚Äúexemplary‚Äù project, but this is a more complicated way (although, perhaps, a more correct one).  I will follow a simple and fast-reproducible way with a guaranteed result and minimal possibilities for error. </blockquote><br>  I will take the project 3_c_onboard_LED_blink as a basis. <br><br>  The first thing to do to successfully copy a project is to close all other projects.  To do this, right-click on the desired project and select ‚ÄúClose Unrelated Projects‚Äù in the drop-down menu (and the folders in the project tree will ‚Äúclose‚Äù).  After that, the original project can be subjected to the Copy / Paste procedure (through the same context menu of the project) ‚Äîa dialog box will appear for entering the name of the new project: <br><img src="https://habrastorage.org/files/3e4/df3/244/3e4df32441af4ad38f04a318db703e7c.png"><br>  I called my project myTest.  The original project can be closed (so as not to occupy a place in the project tree).  If you expand the new project tree, you can see that all the source codes and binaries remain there.  They can be removed at any time - they are no longer needed, but I recommend to leave the contents of the includes folder - it is part of the "magic" that will allow us to get together for our project and make money on Intel Galileo Gen2.  Then in this folder you can add others missing for the library project. <br><br>  I deleted everything unnecessary in the project, and in the src folder (not to be confused with the Debug / src folder) I created a new source file (right-click on the src folder and in the dropdown menu ‚ÄúNew‚Äù -&gt; ‚ÄúSource File‚Äù: <br><img src="https://habrastorage.org/files/66e/9b7/d8f/66e9b7d8f60843d987f6bd3a89c11d6b.png"><br>  In the new file we will write something simple (you can take, for example, the blink code, which I quoted at the beginning of this post).  ‚ÄúBildim‚Äù project: if everything is good, the project was compiled, in the ‚ÄúProblems‚Äù section - empty. <br><br>  Only one step left before launching the finished application.  It is required to explain to Eclipse that the application must be launched remotely (and not locally).  To do this, right-click on the resulting binary (in the project tree) and select in the context menu: ‚ÄúRun As‚Äù -&gt; ‚ÄúRun Configurations ...‚Äù.  The dialog box looks like this: <br><img src="https://habrastorage.org/files/90a/803/cff/90a803cffa2a4136a9f9b37c6384248a.png"><br>  Pay special attention to the sections marked with arrows.  At the top, you need to select our target connection (galileo).  Two fields fill in the same way as I have in the screenshot.  The first field indicates the full path to the application on the target device, the second field indicates the command that must be executed before launching our application (in my case, the compiled file is given permissions to run).  Further simply - Apply and Run.  If done correctly, the LED on the board will start blinking.  After that, you can already use the Run button on the Eclipse toolbar. <br><br>  Of course, programming in Eclipse is much more convenient than in the console (or in the Arduino IDE), which makes the Intel platform very attractive for developers.  But the developer is not the only Eclipse, there is also the <a href="https://software.intel.com/en-us/html5/documentation/getting-started-with-intel-xdk-iot-edition">Intel XDK</a> . <br><br><h2>  <font color="#0071c5">IMHO</font> </h2><br>  Thus, Intel provides the maximum possibilities: excellent debug board Intel Galileo Gen2, libraries, development tools and <a href="https://software.intel.com/en-us/forums/internet-of-things">support</a> . <br><br>  But even this is not all!  In the next part of the "workshop": <br><br><div class="spoiler">  <b class="spoiler_title">Attention, spoiler!</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/44d/1f5/973/44d1f5973c11446f9b69302fb66815c5.jpg"><br></div></div><br>  Write in the comments that you are interested first of all to learn about the contents of the spoiler.  You looked in, didn't you?  :) <br><br>  <b>PS</b> In the discussion of the first part of the ‚Äúpractical work‚Äù there were questions about the fact that, despite the fast processor, Intel Galileo Gen2 is not too prominent when changing the state of a pin.  While preparing this material I stumbled upon <a href="http://www.emutexlabs.com/component/content/article%3Fid%3D203:getting-started-with-intel-galileo-gen-2">this page</a> , where it is written that it is possible to provide the switching frequency as much as 2.9 MHz (compared to the ‚Äúbase‚Äù 385 kHz), although these frequencies are not available for all pins - this is due to the hardware implementation. <br><br>  <b><font color="#0071c5">¬ª</font></b> The first part of the" workshop ": <a href="http://habrahabr.ru/company/intel/blog/248279/">Galileo Gen2 - The first acquaintance</a> . <br>  <b><font color="#0071c5">¬ª</font></b> The second part of the" workshop ": <a href="http://habrahabr.ru/company/intel/blog/248893/">Galileo Gen2 - Linux &amp; Arduino</a> . </div><p>Source: <a href="https://habr.com/ru/post/249127/">https://habr.com/ru/post/249127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../249113/index.html">Categories</a></li>
<li><a href="../249115/index.html">How we made a mod under the Oculus Rift for World of Tanks</a></li>
<li><a href="../249117/index.html">Proxy server for free internet</a></li>
<li><a href="../249119/index.html">Xclaim - ‚Äúnoisy‚Äù * Wi-Fi invasion of small business</a></li>
<li><a href="../249123/index.html">Upgrade from Windows 7 / 8.1 to Windows 10 TP via Windows Update</a></li>
<li><a href="../249129/index.html">Push non-ASCII to inappropriate locations.</a></li>
<li><a href="../249131/index.html">Three words that can change the world</a></li>
<li><a href="../249135/index.html">CLR bug: how to drag an object into a sandbox without marshalling and call a callback</a></li>
<li><a href="../249137/index.html">GHOST (dot) WEB: First Blood</a></li>
<li><a href="../249139/index.html">A brief course of computer graphics: we write a simplified OpenGL do it yourself, article 6 of 6</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>