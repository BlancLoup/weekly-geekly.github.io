<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automation of printing in corporate systems or how to make friends with your ‚Äúbike‚Äù with a printer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, habrazhitel! I want to share with you sore experience, I hope it will be useful. Today I will talk about how to develop a system for printing d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automation of printing in corporate systems or how to make friends with your ‚Äúbike‚Äù with a printer</h1><div class="post__text post__text-html js-mediator-article">  Hello, habrazhitel!  I want to share with you <s>sore</s> experience, I hope it will be useful.  Today I will talk about how to develop a system for printing documents in the corporate system. <br><br><h3>  How it all began </h3><br>  It all began with the development of ERP-platform in one trading company about 2 years ago.  Linux was chosen, the C ++ / Qt stack, PostgreSql and the front for the web.  In C ++ / Qt, an application server was implemented and in the same place, business logic was written through the interpreter's JS layer.  Why this is a separate story, here we consider how the printing system was developed. <br><a name="habracut"></a><br><h3>  The first samples of the pen </h3><br><h4>  HTML </h4><br>  Initially, as long as all documents were printed from 1C (we use the 1C + bundle of our own ‚ÄúERP‚Äù for management accounting in the company) everything was fine, and the plans were to switch to our system.  Then it took to fasten the seal to the system. <br><br>  The first idea was to make up the html form, programmatically fill in the data, html the user to the browser and let them print from there. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Immediately revealed some nuances: <br><br><ol><li>  Under all documents, you will have to impose a template from 0 </li><li>  The end user is not able to edit html </li><li>  Managers conducted some analytics in excel. </li><li>  Problems with line breaks when printing multi-page files </li></ol><br>  As a result, only one template was made for printing an application to the logistics (one-page form) which is still successfully used <br><br><h4>  Xlsx </h4><br>  The second idea was to work with XLSX documents.  Google quickly suggested the <a href="https://github.com/dbzhang800/QtXlsxWriter">QtXlsxWriter</a> library.  <a href="https://wiki.qt.io/Handling_Microsoft_Excel_file_format">There were more options</a> , but eventually settled on QtXlsxWriter. <br><br>  What did the library do: <br><br><ul><li>  Open / Create xlsx and read cell value </li><li>  Change cell value, save file </li><li>  Work with cell format (including framing) </li><li>  Height / width of rows / columns </li><li>  Cell merging </li><li>  Row / column grouping </li><li>  Insert images </li></ul><br>  This made it possible to immediately take the document templates in xlsx format from other systems (Hi 1C), fill in the required data and give the user xlsx a file with which he can already work with as he pleases. <br><br>  Immediately, pitfalls appeared, QtXlsxWriter ‚Äúpoorly‚Äù handled the loading of a document from a template, lost cell formats (wrap / aling, etc.).  After hours of digging ‚Äúxlsx format (if someone does not know, xlsx is a zip archive with a set of xml documents), we found out that, in different versions of boolean, attributes in xml files are saved differently, or <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ta="0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">b</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br>  or <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ta="true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">b</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  and QtXlsxWriter in places parsil is only 1/0, in places only true / false, and in some places both.  But nothing, there are hands, fixed. <br><br>  There was also an unpleasant moment, after the formation of the xlsx file through QtXlsxWriter, if you open it in MS Office, he began to swear. <br><blockquote>  In the book "test1.xlsx" content was found that could not be read.  Try to restore the contents of the book?  If you trust the source ... </blockquote><br>  At the same time, after opening, visually, all the data was in place.  At the same time, many ordinary users (our customers) could be frightened by such a message when opening our price lists. <br><br>  After many hours sticking in the xml files of MS Office and QtXlsxWriter and searching for that, <s>I don‚Äôt know</s> what MS didn‚Äôt like, a crutch was invented.  If you take the file generated by QtXlsxWriter and process it with the help of <a href="https://www.libreoffice.org/">LibreOffice, you</a> get a valid xlsx file with all the initial data, but MS Office does not swear at it: <br><br><pre> <code class="bash hljs">libreoffice --headless --invisible --quickstart --convert-to xlsx test.xlsx --outdir valid_xlsx</code> </pre> <br>  And it became good to live, a small code was written for the necessary reports to form the xlsx document, it was unloaded to users, they worked with it if they had to type and MS Office did not scare them anymore.  We were even able to implement OLAP report unloading in xlsx with groupings <s>and courtesans</s> . <br><br><h2>  Automation </h2><br>  The company grew, there were more customers, more documents (applications, sales, invoices, etc.), printing began to take a lot of working time.  At the same time, some documents were printed from 1C part from our system.  We decided to automate this matter.  Before that (5-7 years ago) there was a printing experience through Windows OLE containers (a container was created with Excel, a file was opened, print settings were set and sent to print), but I didn‚Äôt really want to get involved, and the platform is spinning on Linux and dragging I did not want a Windows module here (although a print server on Windows was considered as an extreme option). <br><br><h4>  All to PDF </h4><br>  Linux has <a href="https://ru.wikipedia.org/wiki/Common_UNIX_Printing_System">CUPS,</a> and with this, it seems like everything is fine, the lpr command can easily print a pdf file.  Here only we do not know how to generate pdf.  The solution was found quickly. <br><br><pre> <code class="bash hljs">libreoffice --convert-to pdf 1.xlsx --headless</code> </pre> <br>  But it was not so easy.  Files were converted with a 100% scale and were not adapted to the size of the pages (A4 / A3, portrait / landscape, indents), or rather everything was adjusted according to standard parameters (A4, portrait).  It turned out that if you set these attitudes through LibreOffice (open LibreOffice Calc by hand), save to xlsx and convert via libreoffice --convert-to pdf, everything worked almost perfectly. <br><br><ol><li>  Indents and page settings were processed correctly. </li><li>  If it was necessary to adjust the scale, this parameter was ignored and converted with a scale of 100%. </li><li>  If the settings were customized by the size / number of pages, everything worked </li></ol><br>  Regarding paragraph 2, <a href="https://bugs.documentfoundation.org/show_bug.cgi%3Fid%3D106853">unsubscribed</a> in support of LibreOffice, I <a href="https://bugs.documentfoundation.org/show_bug.cgi%3Fid%3D106853">am</a> waiting for a response from them. <br><br>  The benefit of paragraph 3 is working correctly, we decided to build on it.  Now you need to teach QtXlsxWriter to work with page settings.  Scrapping xml files in xlsx documents found places responsible for this business <br><br>  xl / worksheets / sheet1.xml <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">worksheet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sheetPr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">filterMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pageSetUpPr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fitToPage</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sheetPr</span></span></span><span class="hljs-tag">&gt;</span></span> ... ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pageMargins</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">left</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.7875"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">right</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.7875"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">top</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.05277777777778"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.05277777777778"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">header</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.7875"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">footer</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.7875"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pageSetup</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">paperSize</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"9"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">scale</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"50"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">firstPageNumber</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fitToWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fitToHeight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pageOrder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"downThenOver"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">usePrinterDefaults</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">blackAndWhite</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">draft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cellComments</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"none"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">useFirstPageNumber</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">horizontalDpi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"300"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">verticalDpi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"300"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">copies</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">/&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">worksheet</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  What is interesting here: <br>  pageMargins - I think this is all clear <br>  fitToPage - fit to the size / number of pages or use the scale <br>  fitToWidth - number of pages in width <br>  fitToHeight - number of pages by height <br>  scale - scale in% <br>  paperSize - paper size (9 = A4) <br>  orientation - portrait / landscape <br><br>  Added work with these parameters in QtXlsxWriter.  It remains only to form an xlsx document with indents in the right places so that no pieces of unfinished content are printed on different sheets.  With this, not everything just turned out to be. <br><br><h4>  Print </h4><br>  Consider the situation when we print a route list on A4 sheet of portrait orientation, without indents. <br><br><div class="spoiler">  <b class="spoiler_title">Sample route sheet</b> <div class="spoiler_text"> <a href="http://www.picshare.ru/view/8009257/"><img src="https://s8.hostingkartinok.com/uploads/thumbs/2017/03/716f058c6330f9cbda2a96dfff765c61.png"></a> <br></div></div><br>  It is necessary that the width of the document fit into 1 page.  Set the settings: <br><br>  fitToPage = false <br>  fitToWidth = 1 <br>  fitToHeight = 100 <br>  pageMargins - all by 0 <br><br>  Under these conditions, fitToHeight should be obviously more than the number of expected pages when printing. <br><br>  The itinerary is a header with an indication of the route and a list of customers with add.  information that will be delivered. <br><br>  If you leave everything as it is, there is a high probability that the part of the block with customer information falling on the end of the sheet will break, some will be at the end of the first and some at the beginning of the second, which is unacceptable for us. <br><br>  As a result, the next approach was born (possibly a crutch). <br><br>  We initially know the size of A4 paper: <br>  Width 21 cm <br>  Height 29.7 cm <br><br>  And we know that our content will be tailored to the width of the sheet, so  You can calculate the relative degree of content compression: <br><br>  scale = sheet width / content width <br><br>  Here we were in for a surprise, in order to calculate the width of the content, it is necessary to add the width of all the columns, this is not difficult to do. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">double</span></span> QXlsx::Document::columnWidth(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> column);</code> </pre> <br>  It was just completely incomprehensible in what units of measurement the result is obtained.  Perhaps the correct solution can be found <a href="http://webapp.docx4java.org/OnlineDemo/ecma376/SpreadsheetML/col.html">here</a> , but could not, in the end, the magic number 5.10238 was found empirically <br>  1 cm = 5.10238 e.  (column width unit) <br><br><pre> <code class="hljs pgsql">scale = <span class="hljs-number"><span class="hljs-number">4</span></span>_ * <span class="hljs-number"><span class="hljs-number">5.10238</span></span> / sum(columnWidth)</code> </pre> <br>  next, we calculate the size of the content that we can fit along the width of the sheet <br><br><pre> <code class="hljs mel">height=<span class="hljs-number"><span class="hljs-number">4</span></span>_ * <span class="hljs-number"><span class="hljs-number">28.3464567</span></span> / <span class="hljs-keyword"><span class="hljs-keyword">scale</span></span></code> </pre> <br>  Another magic number appeared, you guessed it, this is to convert the height of the line to from, see e.i.vs (line height measurement unit, on the Internet found such information ‚Äûr.Height = ht * 28.3464567 // Convert CM to postscript points ‚Äú) <br><br>  Line height can be found in: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">double</span></span> QXlsx::Document::rowHeight(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> column);</code> </pre> <br>  Using the height parameter, we hammer content into the xlsx file while the content height &lt;= height.  If, when adding a new block B, we go beyond the height, then before B we insert an empty line of the required height so that block B is printed from a new line.  The height of the empty line can be calculated by knowing the height of the content (sum (rowHeight)) inserted before block B. <br><br>  I don‚Äôt consider here the calculation of pagination using indents (pageMargins), I‚Äôll just say that the xml data stores the values ‚Äã‚Äãof these variables in inches (1 inch = 2.54 cm). <br><br>  Thus, it turns out xlsx file with ready settings and a breakdown by line for printing.  Next, using libreoffice --convert-to pdf we convert to pdf and our document is ready for printing. <br><br>  It remains to print: <br><br><pre> <code class="bash hljs">lpr -pFS-4300DN test.pdf</code> </pre> <br>  Now we are doing automation of printing on multifunction printers with a finisher (stapling).  Already played a little with the test device and under Linux, it turned out everything was just for stapling. <br><br>  Stamped printing with one clip in the upper left corner: <br><br><pre> <code class="bash hljs">lpr -P printer_name -o StapleLocation=<span class="hljs-string"><span class="hljs-string">"UpperLeft"</span></span> order.pdf</code> </pre> <br><h3>  the end </h3><br>  That's all.  I would be glad to learn other approaches to the implementation of this task. <br><br>  Thanks for attention ) </div><p>Source: <a href="https://habr.com/ru/post/325586/">https://habr.com/ru/post/325586/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325572/index.html">Users convinced GitLab not to leave the cloud</a></li>
<li><a href="../325574/index.html">Announcement of mitc.ap Sync.NET # 4 in Kharkov</a></li>
<li><a href="../325576/index.html">Freedom of choice: freelance or large corporation</a></li>
<li><a href="../325580/index.html">UFOCTF 2017: we decompile Python in the King Arthur assignment (PPC600)</a></li>
<li><a href="../325582/index.html">Fail-safe processing of 10M OAuth tokens on Tarantool</a></li>
<li><a href="../325590/index.html">Recursive Moving Average Filter</a></li>
<li><a href="../325592/index.html">Azure-IaaS-Digest # 14 (March)</a></li>
<li><a href="../325596/index.html">This is Science: observing plant growth</a></li>
<li><a href="../325600/index.html">Serious errors in the code CryEngine V</a></li>
<li><a href="../325602/index.html">Pentestit Corporate Laboratories: Case Analysis for Penetration Testing</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>