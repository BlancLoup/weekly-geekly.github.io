<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Get RSS / Atom feeds from any page</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Happy New Year! While on the street is a holiday, I was engaged in one of the interesting problems (or tasks, as to whom) of my project. Given - a sys...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Get RSS / Atom feeds from any page</h1><div class="post__text post__text-html js-mediator-article"><img src="http://abrdev.com/wp-content/uploads/2010/01/Billboard_Feed_256x256.png" align="left" width="256" height="256">  Happy New Year!  While on the street is a holiday, I was engaged in one of the interesting problems (or tasks, as to whom) of my project.  Given - a system similar to Google Readers, which receives a certain address from the user and should provide a view (and later, a subscription) of RSS feeds available there.  The task is complicated by the fact that it is impossible to require the user to enter the full address of the tape, or even just the address of the site or an arbitrary page - it can be entered in completely different ways, in whole or in part, etc.  Themselves tapes on the page can also be more than one, often several formats at once (or even not at all).  Therefore, we need to select the latest posts from all available tapes and display to the user so that he will eventually choose one tape that interests him.  Let me tell you a secret - yes, this is only the beginning and in subsequent articles we will together build a slightly smaller version of the aggregation system and news readings.  But today we will try to solve the first task, without which our ‚Äúreader‚Äù simply cannot work, no matter what further technology is used. <br><br>  The basis will be my favorite tool - <a href="http://framework.zend.com/">Zend Framework</a> (using the latest, trunk version).  If you are familiar with its capabilities, immediately offer a component of <a href="http://framework.zend.com/manual/en/zend.feed.html">Zend_Feed</a> , which has built-in capabilities for extracting tapes from the page.  However, do not rush, in practice the task is not so simple.  Therefore, we will solve it gradually. <br><a name="habracut"></a><br><br>  <strong>URL normalization.</strong> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The user enters some address from which we have to extract all available tapes.  The first barrier is that the standard component (the same Zend_Feed) can work only with full page addresses (or the correct link to the site root).  Not a component at all, but the mechanism for finding tapes.  That is, if we want to use automatic detection of tapes, we need to give him the full address of the page and no more.  If the link is already a direct link to the tape, oddly enough, as a result we get ... we get nothing.  The same will happen if we enter, for example, the site address in this way - <a href="http://www.abrdev.com/">www.abrdev.com</a> or abrdev.com, instead of the full URL with the protocol - <a href="http://abrdev.com/">http://abrdev.com</a> .  Therefore, the very first step will be a banal check to see if our line begins with a protocol indication - ‚Äúhttp: //‚Äù or ‚Äúhttps: //‚Äù.  The current implementation of the Zend component can only work with these protocols.  In addition, there is a limitation when working with tapes that require authorization for access.  In principle, if simple HTTP authorization is used there, this is completely solvable, but if something else is required, the components are already powerless, so we can only work with publicly available tapes. <br><br>  And so, we need a function that accepts an arbitrary string as input, presumably with the address of the site or feed, and returns always or false if the string doesn‚Äôt look like a URL, or a complete address, with a protocol, etc.  For validation, we use another framework component - <a href="http://framework.zend.com/manual/en/zend.uri.html">Zend_Uri</a> , which provides us with several tools for processing and checking URI (Uniform Resource Identifiers). <br><br>  First, we will rely on the user, so we will try to immediately use the transmitted string as the address.  If this does not work out and Zend_Uri refuses to recognize this as the correct address, it will throw an exception (or return false if the address is just wrong), which we will intercept and try to bring it to a more correct form.  If the second attempt fails, then all, give up and return false, meaning that the user entered is not the correct location for the tape. <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } }</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> /** <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> *     URI <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> * <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> * @param String $uri <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> * @return boolean|string     <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> * @throw Zend_Uri_Exception <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> */ <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><font color="#0000ff"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); try { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { //  URI $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { //  ,   URL <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#0000ff"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } else <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { // ? <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#0000ff"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> try { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#0000ff"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } else <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> //  ,     ? <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">/**</font> <font color="#008000">*     URI</font> <font color="#008000">*</font> <font color="#008000">* @param String $uri</font> <font color="#008000">* @return boolean|string    </font> <font color="#008000">* @throw Zend_Uri_Exception</font> <font color="#008000">*/</font> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">function</font> _validURI($uri) { <font color="#0000ff">if</font> (empty($uri)) <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; <font color="#0000ff">else</font> $uri = trim(strtolower(uri)); <font color="#0000ff">try</font> { <font color="#008000">//  URI</font> $_uri = Zend_Uri::factory($uri); $res = $_uri-&gt;valid($uri); <font color="#0000ff">if</font> ($res === <font color="#0000ff">true</font> ) { <font color="#008000">//  ,   URL</font> <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#008000">// ?</font> <font color="#0000ff">try</font> { <font color="#0000ff">if</font> ( (strpos($uri, <font color="#A31515">'http://'</font> ) === <font color="#0000ff">false</font> ) || (strpos($uri, <font color="#A31515">'https://'</font> ) === <font color="#0000ff">false</font> ) ) { $uri = self::$defailt_rss_scheme . $uri; $_uri = Zend_Uri::factory($uri); <font color="#0000ff">if</font> ($_uri-&gt;valid($uri)) <font color="#0000ff">return</font> $_uri-&gt;getUri(); } <font color="#0000ff">else</font> <font color="#008000">//  ,     ?</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } <font color="#0000ff">catch</font> (Zend_Uri_Exception $e) { <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; } } }</font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  And so, the first problem is solved - we can send any type of address, and as a result we get either false, which means an error, or a string with a full URL that is suitable for further processing.  Please note that only URLs with http / https protocols are available, besides, only public ones (this is not checked at this stage, therefore, apparently, you should warn the user in the address input interface, since we already had cases when users entered addresses tapes that are available only after authorization, and when you try to access such a resource, the server received just the default authorization page). <br><br>  <strong>Getting direct links to tape.</strong> <br><br>  Now the next step - we need to get direct links to all the tapes that we can find at the address specified by the user.  Always remember that there may simply not be a single tape, and maybe several, both different and the same, just a different format.  This is what, and the various formats and specifications of the tape have accumulated enough, besides, there are often unique and most complicated tapes (while the tape from CNBC turned out to be the most difficult, in principle, which served as the basis for rewriting the old tape processing system).  Our luck is that Zend developers have already taken care that the components have completely independent interfaces and the developers abstract from all the nuances of the specifications. <br><br>  And so, at this stage we can have three options: <br><ul><li>  link to the website (root or specific page) where we need to find all the tapes. </li><li>  direct link to the feed (by the way, maybe with redirection inside) </li><li>  link where there are no feeds. </li></ul><br>  Here, for example, the most difficult feed - <a href="">http://www.cnbc.com/id/19789731/device/rss/rss.xml</a> .  I have not fully understood why the Zend_Feed component cannot cope with it.  I could be mistaken, but in my opinion there it is connected with attached styles, which were automatically applied for some reason during processing and the output was not XML, but a regular HTML page (but this may be wrong, if anyone can figure it out, write in the comments) .  So I had to try a new component - <a href="http://framework.zend.com/manual/en/zend.feed.reader.html">Zend_Feed_Reader</a> , which easily managed. <br><br>  My system will work with a stream of links, so it‚Äôs likely that the tapes could be duplicated.  And you never know what, a person will simply enter the same address again.  Since the processing and search for feeds is a lengthy operation associated with network access to a remote resource, I would like to maximize server unload.  This will help us built into the Zend_Feed_Reader ability to cache data.  Yes, and at the stage of data collection we don‚Äôt have the task to receive only relevant news - if we show the client to confirm the feed subscription to confirm the last 10 entries, but this will not be the very latest, but let's say, an hour late, nothing special will happen .  In addition, if the server that gives the tape supports the correct caching headers, then our cache will be automatically checked and updated.  So we will significantly reduce the load in the case of mass subscriptions to a standard set of tapes (it‚Äôs no secret that the greater likelihood that a new user will subscribe just to popular tapes that someone has already viewed before him, which means the tape will be in the cache). <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  $ cache = Zend_Cache :: factory ( <font color="#A31515">'Core'</font> , </li><li>  <font color="#A31515">'File'</font> , </li><li>  array ( </li><li>  <font color="#A31515">'lifetime'</font> =&gt; 24 * 3600, </li><li>  <font color="#A31515">'automatic_serialization'</font> =&gt; <font color="#0000ff">true</font> </li><li>  <font color="#A31515">'caching'</font> =&gt; <font color="#0000ff">true</font> </li><li>  <font color="#A31515">'cache_id_prefix'</font> =&gt; <font color="#A31515">'preview_feed_'</font> , </li><li>  <font color="#A31515">'write_control'</font> =&gt; <font color="#0000ff">true</font> </li><li>  <font color="#A31515">'ignore_user_abort'</font> =&gt; <font color="#0000ff">true</font> </li><li>  ), </li><li>  array ( </li><li>  <font color="#A31515">'read_control_type'</font> =&gt; <font color="#A31515">'adler32'</font> , </li><li>  <font color="#A31515">'cache_dir'</font> =&gt; <font color="#A31515">'/ tmp / cache'</font> </li><li>  )) </li><li></li><li>  Zend_Feed_Reader :: setCache ($ cache); </li><li>  Zend_Feed_Reader :: useHttpConditionalGet ( <font color="#0000ff">true</font> ); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  Now you can proceed directly to the processing.  I tried the test script on a small array of addresses, so it was convenient for me to output the result in an array whose keys are domain names, so first I checked all the links again and pulled out the domain from there (using Zend_Uri_Http).  In a real system, this is most likely not needed, as we will process one address at a time. <br><br>  For example, take the following list at random: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  $ _url = array ( </li><li>  <font color="#A31515">'http://www.cnbc.com/id/19789731/device/rss/rss.xml'</font> , </li><li>  <font color="#A31515">'http://www.planet-php.net/'</font> , </li><li>  <font color="#A31515">'ajaxian.com'</font> , </li><li>  <font color="#A31515">'http://twitter.com/abrdev'</font> , </li><li>  <font color="#A31515">'http://verens.com/archives/2009/12/28/multiple-file-uploads-using-html5/'</font> ); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  Then we will pass it through the validator described above and get an array of the full URL. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#008000">// an array of links that are ready for processing (valid URIs)</font> </li><li>  $ _links = Array (); </li><li></li><li>  echo <font color="#A31515">"Checking URL ... &lt;br /&gt;"</font> ; </li><li>  <font color="#0000ff">foreach</font> ($ _url <font color="#0000ff">as</font> $ u) </li><li>  { </li><li>  echo <font color="#A31515">"Original URL:"</font> .  $ u.  <font color="#A31515">"... &lt;br /&gt;"</font> ; </li><li></li><li>  $ _url = self :: _ validURI ($ u); </li><li></li><li>  <font color="#0000ff">if</font> ($ _url === <font color="#0000ff">false</font> ) <font color="#0000ff">continue</font> ; </li><li>  <font color="#0000ff">else</font> </li><li>  $ _links [] = $ _url; </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  Now we will form the basis for an array of results - at first it will be just links for each given address, then the latest messages from each tape will also be added there. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">foreach</font> ($ _links <font color="#0000ff">as</font> $ fl) </li><li>  { </li><li>  <font color="#008000">// try to extract the URL from the specified site</font> </li><li>  <font color="#0000ff">try</font> </li><li>  { </li><li>  $ _lhttp = Zend_Uri_Http :: fromString ($ fl); </li><li>  <font color="#0000ff">if</font> ($ _lhttp-&gt; valid ()) </li><li>  { </li><li>  <font color="#008000">// check and get the site name</font> </li><li>  $ site = $ _lhttp-&gt; getHost (); </li><li></li><li>  $ _feeds_links [$ site] = Array (); </li><li>  } </li><li>  <font color="#0000ff">else</font> </li><li>  <font color="#008000">// if the check failed, skip</font> </li><li>  <font color="#0000ff">continue</font> ; </li><li>  } </li><li>  <font color="#0000ff">catch</font> (Zend_Uri_Exception $ e) { <font color="#0000ff">continue</font> ;  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  Then we consistently try to extract all tapes from each address.  Using Zend_Feed_Reader, we try to find tapes on the page that will be returned as an array of <a href="http://framework.zend.com/apidoc/core/Zend_Feed_Reader/_Feed---Reader---FeedSet.php.html">Zend_Feed_Reader_FeedSet</a> class <a href="http://framework.zend.com/apidoc/core/Zend_Feed_Reader/_Feed---Reader---FeedSet.php.html">objects</a> , and in fact just arrays (or rather, an object simply implements the necessary interfaces, so you can work with it like a regular array. If there are tapes, we iterate over everything and extract the href property containing a direct link from them. In case there are no tapes at the specified address (this is a case of just plain pages without tapes, and when using the direct feed address, it will also be perceived as missing tapes)  we make the assumption that maybe this is just the case of a direct address and try to get the feed directly. If this attempt fails, we think that, alas, there are no tapes at the specified address and proceed to the next address in the list. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">try</font> </li><li>  { </li><li>  $ _ln = Zend_Feed_Reader :: findFeedLinks ($ fl); </li><li></li><li>  <font color="#0000ff">if</font> (($ _ln instanceOf Zend_Feed_Reader_FeedSet) &amp;&amp; (count ($ _ ln)&gt; 0)) </li><li>  { </li><li>  $ tmp = Array (); </li><li></li><li>  <font color="#0000ff">foreach</font> ($ _ln <font color="#0000ff">as</font> $ cf) </li><li>  { </li><li>  <font color="#008000">// in $ cf we have an object for each feed, Zend_Feed_Reader_FeedSet</font> </li><li>  <font color="#008000">// it inherits from ArrayObject and contains three fields</font> </li><li>  <font color="#008000">// interesting to us: 'href' containing link to feed</font> </li><li>  $ tmp [] = $ cf [ <font color="#A31515">'href'</font> ]; </li><li>  } </li><li></li><li>  <font color="#008000">// since there are duplicate feeds, remove duplicates</font> </li><li>  <font color="#0000ff">if</font> (! empty ($ tmp)) </li><li>  { </li><li>  $ _feeds_links [$ site] = array_unique ($ tmp); </li><li>  } </li><li>  } </li><li>  <font color="#0000ff">else</font> </li><li>  { </li><li>  <font color="#008000">// it can be a direct link to FeedURL</font> </li><li>  <font color="#008000">// for this you have to try to download the document</font> </li><li>  <font color="#0000ff">try</font> </li><li>  { </li><li>  $ _tmp_feed = Zend_Feed_Reader :: import ($ fl); </li><li></li><li>  <font color="#008000">// we do not know in advance which format</font> </li><li>  <font color="#0000ff">if</font> ($ _tmp_feed instanceOf Zend_Feed_Reader_FeedAbstract) </li><li>  { </li><li>  <font color="#008000">// yes, this is a normal feed, it is already in the cache,</font> </li><li>  <font color="#008000">// so just get the address in case of using proxy services</font> </li><li>  <font color="#008000">// Practice has shown that using getFeedLink ()</font> </li><li>  <font color="#008000">// sometimes does not give the desired result, for example for a CNBC feed</font> </li><li></li><li>  $ _feeds_links [$ site] [] = $ fl; </li><li></li><li>  <font color="#0000ff">continue</font> ; </li><li>  } </li><li>  <font color="#0000ff">else</font> </li><li>  <font color="#0000ff">throw</font> <font color="#0000ff">new</font> Zend_Exception ( <font color="#A31515">'Bad feed'</font> ); </li><li>  } </li><li>  <font color="#0000ff">catch</font> (Zend_Exception $ e) </li><li>  { </li><li>  <font color="#008000">//definitely not</font> </li><li>  echo <font color="#A31515">"&lt;br /&gt; &lt;b&gt;"</font> .  $ fl.  <font color="#A31515">"&lt;/ b&gt; == Nothing feeds! &lt;br /&gt;"</font> ; </li><li>  <font color="#0000ff">continue</font> ; </li><li>  } </li><li>  } </li><li></li><li>  } </li><li>  <font color="#0000ff">catch</font> (Zend_Exception $ e) </li><li>  { </li><li>  <font color="#0000ff">continue</font> ; </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  Please note that when we try to upload a feed directly, we don‚Äôt know what the format will be, so to check the result we use the fact that all feed classes have a common ancestor, the abstract class Zend_Feed_Reader_FeedAbstract.  Also in this case there will be some duplication, as we will continue to receive the latest entries from the feeds.  But since we use caching, then for the case of direct links, the data will already be in the cache, so there will be no repeated request. <br><br>  <strong>Getting the latest tape entries.</strong> <br><br>  In order to provide the user with a choice of several tapes, or just to show what kind of feed he will read after the subscription, we select the last 10 messages and show the user along with the subscription address.  Here we do not need to select the entire message, so we limit ourselves to the title and link.  Initially, I also wanted to choose other information about the tape, for example, a description or a list of authors, copyright, but it turned out that in many tapes of these fields there is simply no (empty), therefore we restrict ourselves to just the name. <br><br>  If at this stage we meet with an error, then we simply skip the tape - at best, there will be another tape on the page, but in a different format, at worst - we will not find anything.  When the tape is imported, we will get a header, and then in the loop the last 10 records, for each of which we will get a link, name and date of creation (the date always goes to GMT).  In the test example, I immediately form a string, in reality, most likely you save each of the components separately, and the time may lead to a single standard (for example, taking into account the user's current locale) and convert to UNIX TIMESTAMP for ease of processing. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  echo <font color="#A31515">'&lt;br /&gt; &lt;br /&gt; Retriving last feed items ... &lt;br /&gt;'</font> ; </li><li></li><li>  $ _feeds_items = Array ();  <font color="#008000">// posts in feed</font> </li><li>  $ _item_per_feed = 10;  <font color="#008000">// How many messages from the tape pull</font> </li><li></li><li>  <font color="#0000ff">foreach</font> ($ _feeds_links <font color="#0000ff">as</font> $ _flinks) </li><li>  { </li><li>  <font color="#0000ff">if</font> (count ($ _ flinks)&gt; 0) </li><li>  { </li><li>  <font color="#0000ff">foreach</font> ($ _flinks <font color="#0000ff">as</font> $ fl) </li><li>  { </li><li>  <font color="#0000ff">try</font> </li><li>  { </li><li>  $ _x_feed = Zend_Feed_Reader :: import ($ fl); </li><li></li><li>  <font color="#008000">// can be both Atom and RSS,</font> </li><li>  <font color="#008000">// so we check by abstract ancestor class</font> </li><li>  <font color="#0000ff">if</font> ($ _x_feed instanceOf Zend_Feed_Reader_FeedAbstract) </li><li>  { </li><li>  $ tmpx = Array ( <font color="#A31515">'title'</font> =&gt; <font color="#0000ff">null</font> , <font color="#A31515">'items'</font> =&gt; Array ()); </li><li></li><li>  $ tmpx [ <font color="#A31515">'title'</font> ] = htmlspecialchars ($ _ x_feed-&gt; getTitle (), ENT_QUOTES); </li><li></li><li>  $ i = 0; </li><li>  <font color="#0000ff">foreach</font> ($ _x_feed <font color="#0000ff">as</font> $ fitm) </li><li>  { </li><li>  <font color="#0000ff">if</font> ($ i &lt;$ _item_per_feed) </li><li>  { </li><li>  $ i ++; </li><li>  <font color="#008000">// get the name, link and date (in GMT)</font> </li><li>  <font color="#008000">// GUID - md5 (getId ());</font> </li><li>  $ tmpx [ <font color="#A31515">'items'</font> ] [] = <font color="#A31515">' &lt;a href="'</font> .$fitm-&gt; getLink (). <font color="#A31515">'"target =" _ blank "&gt;'</font> .htmlspecialchars ($ fitm-&gt; getTitle (), ENT_QUOTES).  <font color="#A31515">'&lt;/a&gt; at'</font> .  $ fitm-&gt; getDateCreated () -&gt; toString ().  <font color="#A31515">'&lt;br /&gt;'</font> ; </li><li>  } </li><li>  <font color="#0000ff">else</font> <font color="#0000ff">break</font> ; </li><li>  } </li><li></li><li>  $ _feeds_items [$ fl] = $ tmpx; </li><li>  } </li><li>  } </li><li>  <font color="#0000ff">catch</font> (Zend_Exception $ e) { <font color="#0000ff">continue</font> ;  } </li><li>  } </li><li>  } </li><li>  } </li><li></li><li>  <font color="#008000">// see the result?</font> </li><li>  var_dump ($ _ feeds_items); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  For the time being, we simply output the result through var_dump to the browser (after all, this is just a test script).  In a real system, all this data is packaged into a JSON array and sent to the client, which it displays to the user and gives the opportunity to choose one of the tapes to subscribe.  Of course, it would be possible to do everything for the user - for example, in the case of several tapes that differ only in format, check the news ID match, and if they are the same, then just take the preferred format and that's it.  But it already depends on the specifics of specific tasks. <br><br>  That's all.  Of course, the above code is just an illustration and is not intended for real use (especially by the copy / past method).  In the future, we will continue this topic and try to write a real news server aggregator with Web 2.0 AJAX interface, real-time delivery of new messages (via Comet), and also build a server platform for distributed background processing of news feeds (since there may be many tapes for different tapes different polling frequency settings). <br></div><p>Source: <a href="https://habr.com/ru/post/79879/">https://habr.com/ru/post/79879/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../79869/index.html">Experimentally proved the existence of memories that persist in the brain for life</a></li>
<li><a href="../79870/index.html">Microsoft conducts Best Buy staff training</a></li>
<li><a href="../79874/index.html">EB-5 visa wants to expand on the founders of startups</a></li>
<li><a href="../79876/index.html">nginx + apache. Caching</a></li>
<li><a href="../79878/index.html">Doctrine, extending the capabilities of your favorite ORM framework! Part 1.a (I18n, quick access to translatable attributes)</a></li>
<li><a href="../79880/index.html">Breaking "for an article"</a></li>
<li><a href="../79882/index.html">Notes on NLP (Part 5)</a></li>
<li><a href="../79883/index.html">C # coprocessor programming? Yes!</a></li>
<li><a href="../79884/index.html">Review of trackers of Ukraine</a></li>
<li><a href="../79888/index.html">Muscular computer interface</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>