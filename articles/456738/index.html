<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Neural networks and deep learning: online tutorial, chapter 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Note 
 Before you is a translation of the free online book by Michael Nielsen "Neural Networks and Deep Learning", distributed under the Creative Comm...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Neural networks and deep learning: online tutorial, chapter 1</h1><div class="post__text post__text-html js-mediator-article"><h3>  Note </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/d1f/7ac/ee5/d1f7acee5600a381c43f05c7df9c439a.jpg" alt="Michael Nielsen" align="left">  Before you is a translation of the free online book by Michael Nielsen "Neural Networks and Deep Learning", distributed under the <a href="http://creativecommons.org/licenses/by-nc/3.0/deed.en_GB">Creative Commons Attribution-NonCommercial 3.0 Unported License</a> .  The motivation for its creation was the successful experience of translating a textbook on programming, " <a href="https://habr.com/ru/post/240219/">Expressive JavaScript</a> ."  The book on neural networks is also quite popular, the authors of English-language articles actively refer to it.  I did not find her translations, except for the <a href="https://habr.com/ru/post/333492/">translation of the beginning of the first chapter with abbreviations</a> . <br><br>  Those who want to thank the author of the book can do it on its <a href="http://neuralnetworksanddeeplearning.com/about.html">official page</a> , transfer via PayPal or Bitcoin.  For support of the translator on Habr√© there is a form "to support the author". <br><br><h2>  Introduction </h2><br>  This tutorial will tell you in detail about such concepts as: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Neural networks are an excellent program paradigm created under the influence of biology, which allows computers to learn from observations. </li><li>  Deep learning is a powerful set of neural network training techniques. </li></ul><br>  Neural networks (NN) and deep learning (GO) today provide the best solution to many problems from the areas of image recognition, voice and natural language processing.  This tutorial will teach you many of the key concepts underlying NA and GO. <br><a name="habracut"></a><br><h2>  What is this book about </h2><br>  The National Assembly is one of the most beautiful programming paradigms ever invented by man.  With the standard programming approach, we tell the computer what to do, we break up large tasks into many small ones, we precisely define tasks that the computer will easily perform.  In the case of the National Assembly, on the contrary, we do not tell the computer how to solve the problem.  He learns this himself on the basis of ‚Äúobservations‚Äù of the data, ‚Äúinventing‚Äù his own solution of the task. <br><br>  Automated data-based learning sounds promising.  However, until 2006, we did not know how to train NAs so that they could outperform the more traditional approaches, with the exception of a few special cases.  In 2006, teaching techniques of the so-called  deep neural networks (GNS).  Now these techniques are known as deep learning (GO).  They continued to be developed, and today the STS and civil defense have achieved amazing results in many important tasks related to computer vision, speech recognition and natural language processing.  On a large scale, companies such as Google, Microsoft and Facebook are deploying them. <br><br>  The purpose of this book is to help you master the key concepts of neural networks, including modern GO techniques.  Having worked with the textbook, you will write a code that uses NA and GO to solve complex problems of recognition of patterns.  You will have a foundation for the use of the National Assembly and Civil Defense in the approach to solving your own problems. <br><br><h3>  Principle-based approach </h3><br>  One of the beliefs underlying the book is that it is better to master a firm understanding of the key principles of the National Assembly and civil society than to grab knowledge from a long list of different ideas.  If you understand key ideas well, you will quickly understand other new material.  In the programmer's language, we can say that we will study the basic syntax, libraries, and data structures of the new language.  You may recognize only a small fraction of the entire language ‚Äî many languages ‚Äã‚Äãhave vast standard libraries ‚Äî but you can understand new libraries and data structures quickly and easily. <br><br>  So, this book is categorically not a teaching material on how to use any particular library for the National Assembly.  If you just want to learn how to work with the library - do not read the book!  Find the library you need, and work with training materials and documentation.  But keep in mind: although this approach has an advantage in instant problem solving, if you want to understand exactly what is happening inside the National Assembly, if you want to master ideas that will be relevant even after many years, then it will not be enough for you just to study some fashionable library.  You need to understand the reliable and long-term ideas underlying the work of the National Assembly.  Technology comes and goes, but ideas are forever. <br><br><h3>  Practical approach </h3><br>  We will learn the basic principles on the example of a specific task: learning computer to recognize handwritten numbers.  Using traditional approaches to programming, this task is extremely difficult to solve.  However, we can solve it quite well with a simple NA and a few dozen lines of code, without any special libraries.  Moreover, we will gradually improve this program, consistently incorporating into it more and more key ideas about the National Assembly and Civil Defense. <br><br>  Such a practical approach means that you will need some programming experience.  But you don't have to be a professional programmer.  I wrote python code (version 2.7), which should be understandable, even if you did not write python programs.  In the process of studying, we will create our own library for the National Assembly, which you can use for experiments and further training.  All code can be <a href="https://github.com/mnielsen/neural-networks-and-deep-learning">downloaded by reference</a> .  Having finished the book, or in the process of reading, you can choose one of the more complete libraries for the National Assembly, adapted for use in real projects. <br><br>  The mathematical requirements for understanding the material are rather average.  Most chapters have mathematical parts, but usually they are elementary algebra and graphs of functions.  Sometimes I use more advanced mathematics, but I structured the material so that you can understand it, even if some details will elude you.  Most of all, mathematics is used in Chapter 2, where a bit of mathematical analysis and linear algebra are required.  For those to whom they are not familiar, I begin chapter 2 with an introduction to mathematics.  If it seems complicated to you, just skip the chapter down to the debriefing.  In any case, do not worry about it. <br><br>  The book is rarely both oriented towards an understanding of principles and a practical approach.  But I think it is better to study on the basis of the fundamental ideas of the National Assembly.  We will write working code, and not just study abstract theory, and this code you can explore and expand.  In this way, you will understand the basics, both theory and practice, and will be able to study further. <br><br><h3>  Exercises and tasks </h3><br>  The authors of technical books often warn the reader that he just needs to perform all the exercises and solve all the problems.  When reading such warnings to me, they always seem a bit strange.  Does anything bad happen to me if I do not do the exercises and solve the problems?  Of course not.  I will simply save time due to less deep understanding.  Sometimes it's worth it.  Sometimes not. <br><br>  What should be done with this book?  I advise you to try to do most of the exercises, but do not try to solve most of the tasks. <br><br>  You need to do most of the exercises because these are basic checks for understanding the material correctly.  If you can't do the exercise with relative ease, you probably missed something fundamental.  Of course, if you really get stuck on an exercise - drop it, maybe it's some slight misunderstanding, or maybe I haven't formulated anything well.  But if most exercises cause you trouble, then you most likely need to reread the previous material. <br><br>  Tasks are another matter.  They are more difficult exercises, and with some you have to hard.  It is annoying, but, of course, patience in the face of such disappointment is the only way to truly understand and assimilate the subject. <br><br>  So I do not recommend solving all problems.  Even better - pick your own project.  Maybe you want to use the NA to classify your music collection.  Or to predict the value of shares.  Or something else.  But find an interesting project for you.  And then you can ignore the tasks from the book, or use them purely as inspiration for working on your project.  Problems with your own project will teach you more than working with any number of tasks.  Emotional involvement is a key factor in mastery. <br><br>  Of course, while you may not have such a project.  This is normal.  Solve problems for which you feel internal motivation.  Use material from the book to help yourself in finding ideas for personal creative projects. <br><br><h2>  Chapter 1 </h2><br>  The human visual system is one of the wonders of the world.  Consider the following sequence of handwritten numbers: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/839/d0b/543/839d0b54370af70f06b3f097897de457.png"><br><br>  Most people read them easily, like 504192. But this simplicity is deceptive.  In each hemisphere of the brain, a person has a primary <a href="https://ru.wikipedia.org/wiki/%25D0%2597%25D1%2580%25D0%25B8%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BA%25D0%25BE%25D1%2580%25D0%25B0">visual cortex</a> , also known as V1, which contains 140 million neurons and tens of billions of connections between them.  At the same time, not only V1, but a whole sequence of brain regions - V2, V3, V4 and V5 - are involved in the increasingly complex image processing.  We carry a supercomputer in our head, tuned by evolution for hundreds of millions of years, and perfectly adapted for understanding the visible world.  Recognizing handwritten numbers is not easy.  It‚Äôs just that we, people, are amazingly, surprisingly well aware of what our eyes show us.  But almost all this work is done unconsciously.  And usually we don‚Äôt attach importance to the complexity of our visual systems. <br><br>  The difficulty of recognizing visual patterns becomes apparent when you try to write a computer program to recognize such figures as those given above.  What seems easy in our performance suddenly turns out to be extremely difficult.  A simple concept of how we recognize forms - ‚Äúthe nine at the top has a loop, and the vertical dash at the bottom right‚Äù - is not so simple for an algorithmic expression.  Trying to formulate these rules clearly, you quickly get stuck in the quagmire of exceptions, pitfalls and special cases.  The task seems hopeless. <br><br>  NA approach to solving the problem differently.  The idea is to take a variety of handwritten numbers, known as teaching examples, <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a67/2ff/15c/a672ff15c58d9672b9f5d2b427a20eb6.png"><br><br>  and develop a system capable of learning from these examples.  In other words, NA uses examples to automatically build rules for the recognition of handwritten numbers.  Moreover, by increasing the number of training examples, the network can learn more about handwritten numbers and improve its accuracy.  So, although I have given above 100 training examples, we may be able to create a better handwritten recognizer using thousands or even millions and billions of teaching examples. <br><br>  In this chapter, we will write a computer program that implements the NA, learning to recognize handwritten numbers.  The program will be only 74 lines long, and will not use special libraries for NA.  However, this short program will be able to recognize handwritten numbers with an accuracy of more than 96%, without requiring human intervention.  Moreover, in later chapters we will develop ideas that can improve accuracy up to 99% or more.  In fact, the best commercial NAs do the job so well that they are used by banks to process checks, and the postal service does it to recognize addresses. <br><br>  We concentrate on handwriting recognition, since this is a great prototype of a task for studying NA.  Such a prototype is ideal for us: it is a difficult task (recognizing handwritten numbers is not an easy task), but not so difficult that it requires an extremely complex solution or vast computational power.  Moreover, it is a great way to develop more complex techniques such as GO.  Therefore, in the book we will constantly return to the problem of handwriting recognition.  Later we will discuss how these ideas can be applied to other tasks of computer vision, speech recognition, processing of natural language and other areas. <br><br>  Of course, if the purpose of this chapter was only to write a handwritten number recognition program, the chapter would be much shorter!  However, in the process, we will develop many key ideas related to NA, including two important types of artificial neuron ( <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D0%25B5%25D1%2580%25D1%2586%25D0%25B5%25D0%25BF%25D1%2582%25D1%2580%25D0%25BE%25D0%25BD">perceptron</a> and sigmoid neuron), and the standard NA learning algorithm, <a href="http://www.machinelearning.ru/wiki/index.php%3Ftitle%3D%25D0%25A1%25D1%2582%25D0%25BE%25D1%2585%25D0%25B0%25D1%2581%25D1%2582%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25B3%25D1%2580%25D0%25B0%25D0%25B4%25D0%25B8%25D0%25B5%25D0%25BD%25D1%2582%25D0%25BD%25D1%258B%25D0%25B9_%25D1%2581%25D0%25BF%25D1%2583%25D1%2581%25D0%25BA">stochastic gradient descent</a> .  In the text, I concentrate on explaining why everything is done that way, and on shaping your understanding of the National Assembly.  This requires a longer conversation than if I simply presented the basic mechanics of what is happening, but it is worth a deeper understanding that you will have.  Among other advantages - by the end of the chapter you will understand what GO is and why it is so important. <br><br><h3>  Perceptrons </h3><br>  What is a neural network?  To begin, I will talk about one type of artificial neuron, which is called the perceptron.  Perceptrons came up with the scientist <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25BE%25D0%25B7%25D0%25B5%25D0%25BD%25D0%25B1%25D0%25BB%25D0%25B0%25D1%2582%25D1%2582,_%25D0%25A4%25D1%2580%25D1%258D%25D0%25BD%25D0%25BA">Frank Rosenblatt</a> in the 1950s and 1960s, inspired by the early work of <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B0%25D0%25BA-%25D0%259A%25D0%25B0%25D0%25BB%25D0%25BB%25D0%25BE%25D0%25BA,_%25D0%25A3%25D0%25BE%25D1%2580%25D1%2580%25D0%25B5%25D0%25BD">Warren McCulloch</a> and <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D0%25B8%25D1%2582%25D1%2582%25D1%2581,_%25D0%25A3%25D0%25BE%25D0%25BB%25D1%2582%25D0%25B5%25D1%2580">Walter Pitts</a> .  Today, other models of artificial neurons are used more often - in this book, and most modern works on NA, they mostly use the sigmoid model of the neuron.  We will meet her soon.  But to understand why sigmoid neurons are defined this way, it is worth spending time analyzing the perceptron. <br><br>  So how do perceptrons work?  The perceptron accepts several binary numbers x <sub>1</sub> , x <sub>2</sub> , ... as an input and produces one binary number: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/293/1f3/f5c/2931f3f5c6125d14262954583868f959.png"><br><br>  In this example, the perceptron has three input numbers, x <sub>1</sub> , x <sub>2</sub> , x <sub>3</sub> .  In general, there may be more or less.  Rosenblatt proposed a simple rule for calculating the result.  He introduced weights, w <sub>1</sub> , w <sub>2</sub> , real numbers expressing the importance of the corresponding input numbers for the results.  The output of a neuron, 0 or 1, is determined by whether the weighted sum is less than or greater than a certain [threshold] threshold. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">u</span><span class="MJXp-msubsup" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-7" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-8"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-10" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-13" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.764ex" height="2.057ex" viewBox="0 -520.7 4634.5 885.9" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1242" y="-213"></use></g><g transform="translate(2562,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1013" y="-213"></use></g><g transform="translate(3670,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="809" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-1"> \ sum_j w_jx_j </script>  .  Like weights, the threshold is a real number, a parameter of a neuron.  In mathematical terms: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-14"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">t</span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-22">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">n</span><span class="MJXp-mrow" id="MJXp-Span-28"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">s</span></span><span class="MJXp-mn" id="MJXp-Span-34">0</span><span class="MJXp-mtext" id="MJXp-Span-35">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">f</span><span class="MJXp-mtext" id="MJXp-Span-38">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-39">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">u</span><span class="MJXp-msubsup" id="MJXp-Span-42"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-44" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-45"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-47" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-48"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-50" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-51">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63">d</span><span class="MJXp-mspace" id="MJXp-Span-64" style="width: 0em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-65">1</span><span class="MJXp-mtext" id="MJXp-Span-66">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">f</span><span class="MJXp-mtext" id="MJXp-Span-69">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-70">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">u</span><span class="MJXp-msubsup" id="MJXp-Span-73"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-75" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-78" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-81" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">d</span><span class="MJXp-mtext" id="MJXp-Span-92">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">d</span><span class="MJXp-mrow" id="MJXp-Span-96"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">s</span></span><span class="MJXp-mtext" id="MJXp-Span-102">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">g</span><span class="MJXp-mrow" id="MJXp-Span-106"><span class="MJXp-mn" id="MJXp-Span-107">1</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="6.033ex" viewBox="0 -780.1 40358 2597.7" role="img" focusable="false" style="vertical-align: -4.222ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(9504,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="485" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="1058" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-70" x="1419" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="1923" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="2495" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-3D" x="3134" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-62" x="4441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="4870" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-67" x="5337" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-69" x="5817" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6E" x="6163" y="0"></use><g transform="translate(6763,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="1899" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-30" x="9132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-69" x="9882" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-66" x="10228" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="11278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="11748" y="0"></use><g transform="translate(12320,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1242" y="-213"></use></g><g transform="translate(13590,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1013" y="-213"></use></g><g transform="translate(14698,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6C" x="15913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="16211" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-71" x="16678" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="17138" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-68" x="17500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-72" x="18076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="18528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="18994" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-68" x="19464" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6F" x="20040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6C" x="20526" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-64" x="20824" y="0"></use></g><g transform="translate(10976,-1432)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-69" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-66" x="1096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="2146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="2616" y="0"></use><g transform="translate(3188,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1242" y="-213"></use></g><g transform="translate(4458,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1013" y="-213"></use></g><g transform="translate(5566,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-3E" x="6808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="7865" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-68" x="8226" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-72" x="8803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="9254" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="9721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-68" x="10190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6F" x="10767" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6C" x="11252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-64" x="11551" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="12324" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6E" x="12791" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-64" x="13391" y="0"></use><g transform="translate(13915,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="1899" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="16533" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-61" x="16895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-67" x="17424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="17905" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> output = \ begin {cases} 0 ~ if ~ \ sum_j w_jx_j \ leq threshold \\ 1 ~ if ~ \ sum_j w_jx_j> threshold \ end {cases} \ tag {1} </script></p><br><br>  That's all the description of the work of the perceptron! <br><br>  Such is the basic mathematical model.  A perceptron can be thought of as a decision-making device, weighing evidence.  Let me give you a not very realistic, but a simple example.  Let's say the weekend is coming, and you have heard that a cheese festival will be held in your city.  You like cheese, and you try to decide whether to go to the festival or not.  You can decide by weighing three factors: <br><br><ol><li>  Is the weather good? </li><li>  Does your partner want to go with you? </li><li>  Is the festival far from the public transport stop?  (You do not have a car). </li></ol><br>  These three factors can be represented by binary variables x <sub>1</sub> , x <sub>2</sub> , x <sub>3</sub> .  For example, x <sub>1</sub> = 1 if the weather is good and 0 if it is bad.  x <sub>2</sub> = 1 if your partner wants to go, and 0 if not.  Same for x <sub>3</sub> . <br><br>  Now, let's say you are a fan of cheese so much that you are ready to go to the festival, even if your partner is not interested, and it is difficult to get to him.  But maybe you just hate bad weather, and in the event of bad weather, you will not go to the festival.  You can use perceptrons to model such a decision making process.  One way is to choose the weight w <sub>1</sub> = 6 for the weather, and w <sub>2</sub> = 2, w <sub>3</sub> = 2 for other conditions.  A higher w <sub>1</sub> value means that the weather matters to you much more than whether your partner joins you, or whether the festival is close to a halt.  Finally, let's say you choose a threshold for the perceptron 5. With these options, the perceptron implements the desired decision-making model, returning 1 when the weather is bad and 0 when it is bad.  The partner‚Äôs wish and the proximity of the stop do not affect the output value. <br><br>  By changing weights and thresholds, we can get different decision making models.  For example, let's say take threshold 3. Then the perceptron decides that you need to go to the festival, either when the weather is fine, or when the festival is near the stop and your partner agrees to go with you.  In other words, the model is different.  Lowering the threshold means more you want to go to the festival. <br><br>  Obviously, the perceptron is not a complete human decision-making model!  But this example shows how a perceptron can weigh different types of evidence to make decisions.  It seems possible that a complex network of perceptrons can make very complex decisions: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f1/853/0d8/5f18530d8e17d640b3146924f7666032.png"><br><br>  In this network, the first column of perceptrons ‚Äî what we call the first layer of perceptrons ‚Äî makes three very simple decisions, weighing the input evidence.  What about perceptrons from the second layer?  Each of them makes a decision, weighing the results of the first decision layer.  In this way, the perceptron of the second layer can make a decision on a more complex and abstract level, compared to the perceptron of the first layer.  And even more complex decisions can be made by perceptrons on the third layer.  In this way, a multilayer network of perceptrons can be involved in making complex decisions. <br><br>  By the way, when I determined the perceptron, I said that it has only one output value.  But in the network at the top, the perceptrons look like they have several output values.  In fact, they have only one way out.  The set of output arrows is simply a convenient way to show that the output of the perceptron is used as the input of several other perceptrons.  This is less cumbersome than drawing one forked exit. <br><br>  Let's simplify the description of perceptrons.  Condition <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-108"><span class="MJXp-mtext" id="MJXp-Span-109">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">u</span><span class="MJXp-msubsup" id="MJXp-Span-112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-114" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-117" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-120" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">d</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.301ex" height="2.66ex" viewBox="0 -780.1 9601.6 1145.2" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1242" y="-213"></use></g><g transform="translate(2562,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1013" y="-213"></use></g><g transform="translate(3670,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-3E" x="4912" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="5968" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-72" x="6330" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="6781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="7248" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-68" x="7717" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6F" x="8294" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6C" x="8779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-64" x="9078" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> \ sum_j w_jx_j> treshold </script>  awkward, and we can agree on two changes to the record to simplify it.  The first is to record <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-130"><span class="MJXp-mtext" id="MJXp-Span-131">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">u</span><span class="MJXp-msubsup" id="MJXp-Span-134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-136" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-139" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-142" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.764ex" height="2.057ex" viewBox="0 -520.7 4634.5 885.9" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1242" y="-213"></use></g><g transform="translate(2562,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1013" y="-213"></use></g><g transform="translate(3670,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="809" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-4"> \ sum_j w_jx_j </script>  as a dot product, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">w</span><span class="MJXp-mtext" id="MJXp-Span-145">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">x</span><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-152">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">u</span><span class="MJXp-msubsup" id="MJXp-Span-155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-157" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-160" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-163" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.627ex" height="2.66ex" viewBox="0 -780.1 9311.6 1145.2" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-63" x="966" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-64" x="1400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6F" x="1923" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="2409" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-78" x="2770" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-3D" x="3620" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="4927" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="5396" y="0"></use><g transform="translate(5969,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1242" y="-213"></use></g><g transform="translate(7239,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1013" y="-213"></use></g><g transform="translate(8347,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="809" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-5"> w \ cdot x = \ sum_j w_jx_j </script>  , where w and x are vectors whose components are weights and input data, respectively.  The second is to transfer the threshold to another part of the inequality, and replace it with a value known as the perceptron offset [bias], <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">b</span><span class="MJXp-mtext" id="MJXp-Span-166">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">v</span><span class="MJXp-mo" id="MJXp-Span-172" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">d</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.608ex" height="2.419ex" viewBox="0 -780.1 8442.4 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-62" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-71" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="1606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-69" x="2179" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="2524" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2212" x="3232" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="4232" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-68" x="4594" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-72" x="5170" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="5622" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="6088" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-68" x="6558" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6F" x="7134" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6C" x="7620" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-64" x="7918" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> b \ equiv ‚àíthreshold </script>  .  Using offset instead of threshold, we can rewrite the perceptron rule: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">t</span><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-190">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">n</span><span class="MJXp-mrow" id="MJXp-Span-196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">s</span></span><span class="MJXp-mn" id="MJXp-Span-202">0</span><span class="MJXp-mtext" id="MJXp-Span-203">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">f</span><span class="MJXp-mtext" id="MJXp-Span-206">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">w</span><span class="MJXp-mtext" id="MJXp-Span-208">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">x</span><span class="MJXp-mo" id="MJXp-Span-214" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">b</span><span class="MJXp-mtext" id="MJXp-Span-216">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">q</span><span class="MJXp-mn" id="MJXp-Span-220">0</span><span class="MJXp-mspace" id="MJXp-Span-221" style="width: 0em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-222">1</span><span class="MJXp-mtext" id="MJXp-Span-223">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">f</span><span class="MJXp-mtext" id="MJXp-Span-226">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">w</span><span class="MJXp-mtext" id="MJXp-Span-228">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">x</span><span class="MJXp-mo" id="MJXp-Span-234" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">b</span><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-237">0</span><span class="MJXp-mtext" id="MJXp-Span-238">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">d</span><span class="MJXp-mrow" id="MJXp-Span-242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">s</span></span><span class="MJXp-mtext" id="MJXp-Span-248">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">g</span><span class="MJXp-mrow" id="MJXp-Span-252"><span class="MJXp-mn" id="MJXp-Span-253">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="5.551ex" viewBox="0 -780.1 40358 2390.2" role="img" focusable="false" style="vertical-align: -3.74ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(11178,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="485" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="1058" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-70" x="1419" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="1923" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="2495" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-3D" x="3134" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-62" x="4441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="4870" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-67" x="5337" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-69" x="5817" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6E" x="6163" y="0"></use><g transform="translate(6763,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="1899" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-30" x="9132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-69" x="9882" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-66" x="10228" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="11028" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-63" x="11995" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-64" x="12428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6F" x="12952" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="13437" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-78" x="13799" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2B" x="14593" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-62" x="15594" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6C" x="16274" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="16572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-71" x="17039" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-30" x="17499" y="0"></use></g><g transform="translate(12650,-1343)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-69" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-66" x="1096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="1896" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-63" x="2863" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-64" x="3296" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6F" x="3820" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="4305" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-78" x="4667" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2B" x="5461" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-62" x="6462" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-3E" x="7169" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-30" x="8226" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="8976" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6E" x="9443" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-64" x="10043" y="0"></use><g transform="translate(10567,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="1899" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="13185" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-61" x="13547" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-67" x="14076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-32" x="14557" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-7"> output = \ begin {cases} 0 ~ if ~ w \ cdot x + b \ leq 0 \\ 1 ~ if ~ w \ cdot x + b> 0 \ end {cases} \ tag {2} </script></p><br><br>  The offset can be represented as a measure of how easy it is to obtain the value 1 at the output from the perceptron.  Or, in biological terms, displacement is a measure of how easy it is to make the perceptron activate.  It is extremely easy to give out a perceptron with a very large offset 1. But with a very large negative offset, this is difficult to do.  Obviously, the introduction of an offset is a small change in the description of perceptrons, but later we will see that it leads to a further simplification of the record.  Therefore, below we will not use the threshold, but will always use the offset. <br><br>  I described the perceptrons in terms of the method of weighing evidence with a view to making a decision.  Another way to use them is to compute elementary logical functions, which we usually consider basic computations, such as AND, OR, and NAND.  Suppose, for example, that we have a perceptron with two inputs, the weight of each of which is -2, and its offset is 3. Here it is: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/530/d45/9a9/530d459a9262c475caf057106a500ddc.png"><br><br>  Input data 00 gives output 1, because (‚àí2) ‚àó 0 + (- 2) ‚àó 0 + 3 = 3 is greater than zero.  The same calculations say that input data 01 and 10 give 1. But 11 at the input gives 0 at the output, because (‚àí2) ‚àó 1 + (- 2) ‚àó 1 + 3 = ‚àí1, less than zero.  Therefore, our perceptron implements the NAND function! <br><br>  This example shows that you can use perceptrons to compute basic logic functions.  In fact, we can use networks of perceptrons to calculate any logical functions at all.  The fact is that the <a href="https://ru.wikipedia.org/wiki/%25D0%259B%25D0%25BE%25D0%25B3%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25B2%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D0%25BB%25D1%258C">logical</a> NAND <a href="https://ru.wikipedia.org/wiki/%25D0%259B%25D0%25BE%25D0%25B3%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25B2%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D0%25BB%25D1%258C">gate is</a> universal for computing ‚Äî any calculation can be built on its basis.  For example, you can use NAND gates to create a contour that folds two bits, x <sub>1</sub> and x <sub>2</sub> .  To do this, calculate the bitwise sum. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-254"><span class="MJXp-msubsup" id="MJXp-Span-255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-257" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mtext" id="MJXp-Span-258">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">s</span><span class="MJXp-msubsup" id="MJXp-Span-264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-266" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.759ex" height="2.419ex" viewBox="0 -780.1 4632.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="809" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6F" x="1276" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-70" x="1761" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6C" x="2265" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="2563" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="3136" y="0"></use><g transform="translate(3605,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-32" x="809" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-8"> x_1 \ oplus x_2 </script>  and <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25BB%25D0%25B0%25D0%25B3_%25D0%25BF%25D0%25B5%25D1%2580%25D0%25B5%25D0%25BD%25D0%25BE%25D1%2581%25D0%25B0">the carry flag</a> , which is 1 when both x <sub>1</sub> and x <sub>2</sub> are 1 - that is, the carry flag is simply the result of a bitwise multiplication x <sub>1</sub> x <sub>2</sub> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d25/af6/afe/d25af6afec499649a0b338f2ccc67f63.png"><br><br>  To get an equivalent network of perceptrons, we replace all NAND gates with two inputs, each with a weight of -2, and with an offset of 3. This is the resulting network.  Note that I moved the perceptron corresponding to the right bottom valve, just to make it easier to draw arrows: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/222/5b4/71b/2225b471b11b7357777ebc024bd287c2.png"><br><br>  One notable aspect of this network of perceptrons is that the output of the leftmost one is used twice as input for the lower one.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Defining the model of the perceptron, I did not mention the admissibility of such a dual output scheme in the same place. In fact, it does not matter much. If we do not want to allow this, we can simply combine the two lines with weights of -2 into one with a weight of -4. (If this does not seem obvious to you, stop and prove it to yourself). After this change, the network looks like this, with all unpartitioned weights equal to -2, all offsets are equal to 3, and one weight ‚Äì4 is marked: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/151/d84/dbd/151d84dbdf944cc9016ed656ba70e424.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Such a record of perceptrons that have an output, but no inputs: it </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/41c/8e3/e46/41c8e3e46587bf536bab96b8427e9bcd.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is just an abbreviation. This does not mean that he has no inputs. To understand this, suppose that we have a perceptron without inputs. Then the weighted sum ‚àë </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> w </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> x </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">would always be zero, so the perceptron would give 1 for b&gt; 0 and 0 for b ‚â§ 0. That is, the perceptron would simply give out a fixed value, rather than the one we need (x </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the example above). It is better to consider the input perceptrons not as perceptrons, but as special units that are simply defined to produce the desired values ‚Äã‚Äãx </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , x </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ... The </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">example with the adder demonstrates how you can use a network of perceptrons to simulate a circuit containing many NAND gates. And since these gates are universal for computing, therefore, perceptrons are universal for computing.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The computational versatility of perceptrons is both reassuring and disappointing. It is encouraging, ensuring that the network of perceptrons can be as powerful as any other computing device. It is disappointing, giving the impression that perceptrons are just a new type of NAND logic gate. So-so opening!</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, the situation is actually better. </font><font style="vertical-align: inherit;">It turns out that we can develop training algorithms that can automatically adjust the weights and offsets of a network of artificial neurons. </font><font style="vertical-align: inherit;">This adjustment occurs in response to external stimuli, without direct intervention by the programmer. </font><font style="vertical-align: inherit;">These learning algorithms allow us to use artificial neurons in a way that is radically different from ordinary logic gates. </font><font style="vertical-align: inherit;">Instead of explicitly registering the circuit from the NAND gates and others, our neural networks can simply learn to solve problems, sometimes for which it would be extremely difficult to directly design a conventional circuit.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sigmoid neurons </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Learning algorithms are great. However, how to develop such an algorithm for a neural network? Suppose we have a network of perceptrons that we want to use to train the solution of the problem. Suppose the network's input can be pixels of a handwritten digit scanned image. And we want the network to know the weights and offsets necessary to properly classify numbers. To understand how this kind of training can work, let's imagine that we are changing a little bit of some weight (or offset) in the network. We want this small change to lead to a small change in the network output. As we soon see, this property makes learning possible. Schematically, we want the following (obviously, such a network is too simple to recognize handwriting!):</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2cf/d97/76f/2cfd9776fdb27a7106bdf2a94d76eb46.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If a small change in weight (or displacement) would result in a small change in output, we could change the weights and offsets so that our network behaves a little closer to what we want. For example, suppose that the network incorrectly attributed the image to "8", although it should have been assigned to "9". We could figure out how to make a small change in weights and offsets, so that the network is a little closer to image classification, like ‚Äú9‚Äù. And then we would repeat it, changing weights and shifts over and over again to get the best and best result. The network would learn.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The problem is that if there are perceptrons in the network, this does not happen. A small change in the weights or displacement of any perceptron can sometimes lead to a change in its output to the opposite, say, from 0 to 1. Such a revolution can change the behavior of the rest of the network in a very complex way. And even if now our ‚Äú9‚Äù will be correctly recognized, the behavior of the network with all the other images is likely to have completely changed in a way that is difficult to control. Because of this, it is difficult to imagine how you can gradually adjust the weights and offsets so that the network gradually approaches the desired behavior. Perhaps there is some clever way around this problem. But there is no simple solution to the problem of learning the network of perceptrons.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This problem can be circumvented by introducing a new type of artificial neuron called the sigmoid neuron. They look like perceptrons, but are modified so that small changes in weights and offsets result in only small changes in the output. This is the main fact that will allow the network of sigmoid neurons to learn. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let me describe the sigmoid neuron. We will draw them in the same way as perceptrons: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2cd/0b3/ccf/2cd0b3ccf36d0dabf96fd15649c29f90.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It also has input data x </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , x </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ... But instead of being equated to 0 or 1, these inputs can have any value in the range from 0 to 1. K For example, a value of 0.638 would be a valid input for a sigmoid neuron (CH). Like the perceptron, CH has weights for each input, w </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , w</font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ... and the total offset b. </font><font style="vertical-align: inherit;">But its output value will not be 0 or 1. It will be œÉ (w‚ãÖx + b), where œÉ is a sigmoid. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By the way, œÉ is sometimes called the </font></font><a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D1%2581%25D0%25BA%25D1%2583%25D1%2581%25D1%2581%25D1%2582%25D0%25B2%25D0%25B5%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25BD%25D0%25B5%25D0%25B9%25D1%2580%25D0%25BE%25D0%25BD"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logistic function</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and this class of neurons is </font><font style="vertical-align: inherit;">called </font><font style="vertical-align: inherit;">logistic neurons. </font><font style="vertical-align: inherit;">This terminology is useful to remember, as many people working with neural networks use these terms. </font><font style="vertical-align: inherit;">However, we will stick to sigmoid terminology. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The function is defined as:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-267"><span class="MJXp-mtable" id="MJXp-Span-268"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-269" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-270" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">œÉ </font></font></span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z </font></font></span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-275" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚â° </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-276" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-277"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-278"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-279" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-282" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-283"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span></span></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="5.31ex" viewBox="0 -1402.6 40358 2286.5" role="img" focusable="false" style="vertical-align: -1.873ex; margin-bottom: -0.18ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(39078,0)"><g id="mjx-eqn-3" transform="translate(0,-38)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-33" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="890" y="0"></use></g></g><g transform="translate(17010,0)"><g transform="translate(-15,0)"><g transform="translate(0,-38)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-3C3" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28" x="572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-7A" x="962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="1430" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2261" x="2097" y="0"></use><g transform="translate(2876,0)"><g transform="translate(397,0)"><rect stroke="none" width="3291" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="1395" y="676"></use><g transform="translate(60,-686)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2B" x="722" y="0"></use><g transform="translate(1723,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,288)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-7A" x="778" y="0"></use></g></g></g></g></g></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-9"> \sigma(z) \equiv \frac{1}{1+e^{-z}} \tag{3} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In our case, the output value of the sigmoid neuron with input data x </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , x </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ... weights w </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , w </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ... and the offset b will be considered as:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-285"><span class="MJXp-mtable" id="MJXp-Span-286"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-287" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-288" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-289" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-290"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-291"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mo" id="MJXp-Span-297" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-298"><span class="MJXp-mo" id="MJXp-Span-299" style="margin-left: 0.111em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àë </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-300" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-303" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-306" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-307" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-309" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="6.154ex" viewBox="0 -1558.2 40358 2649.6" role="img" focusable="false" style="vertical-align: -2.535ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(39078,0)"><g id="mjx-eqn-4" transform="translate(0,154)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-34" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="890" y="0"></use></g></g><g transform="translate(15008,0)"><g transform="translate(-15,0)"><g transform="translate(0,154)"><g transform="translate(120,0)"><rect stroke="none" width="10449" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="4974" y="676"></use><g transform="translate(60,-721)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2B" x="722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-65" x="1723" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-78" x="2189" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-70" x="2762" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28" x="3265" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2212" x="3655" y="0"></use><g transform="translate(4600,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJSZ1-2211" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1494" y="-405"></use></g><g transform="translate(6215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1013" y="-213"></use></g><g transform="translate(7323,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2212" x="8510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-62" x="9510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="9940" y="0"></use></g></g></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> \frac{1}{1+exp(-\sum_j w_jx_j - b)} \tag{4} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At first glance, CH seem to be completely different from neurons. </font><font style="vertical-align: inherit;">The algebraic form of sigmoids may seem confusing and obscure if you are not familiar with it. </font><font style="vertical-align: inherit;">In fact, there are many similarities between perceptrons and CH, and the algebraic form of sigmoids turns out to be more technical in detail than a serious barrier to understanding.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To understand the similarity with the perceptron model, suppose that z ‚â° w ‚ãÖ x + b is a large positive number. Then e - z ‚âà 0, therefore œÉ (z) ‚âà 1. In other words, when z = w ‚ãÖ x + b is large and positive, the output of CH is approximately equal to 1, as in the perceptron. Suppose that z = w ‚ãÖ x + b is large with a minus sign. Then e - z ‚Üí ‚àû, and œÉ (z) ‚âà 0. So, for large z with a minus sign, the behavior of CH also approaches the perceptron. And only when w ‚ãÖ x + b has an average size, serious deviations from the perceptron model are observed. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What about an algebraic form œÉ? How do we understand him? In fact, the exact form of œÉ is not so important - the form of the function on the graph is important.</font></font> Here she is: <br><br><img src="https://habrastorage.org/webt/sm/u4/jv/smu4jvbwuriryrfojrpt-ukdr6w.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is a smoothed version of the step function: </font></font><br><br><img src="https://habrastorage.org/webt/2i/p0/a-/2ip0a-3cmpstyiwrglx_michl3m.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If œÉ were stepped, then CH would be a perceptron, since it would have 0 or 1 output depending on the sign w ‚ãÖ x + b (well, in fact, at z = 0 the perceptron produces 0 , and the step function is 1, so that at one point, the function would have to be changed). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Using the real function œÉ, we obtain a smoothed perceptron. And the main thing here is the smoothness of the function, and not its exact form. Smoothness means that small changes in Œîw </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> weights and Œ¥b offsets will give small changes in Œîoutput output. The algebra tells us that Œîoutput is well approximated as follows:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-310"><span class="MJXp-mtable" id="MJXp-Span-311"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-312" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-313" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-314">Œî</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">t</span><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0.333em; margin-right: 0.333em;">‚âà</span><span class="MJXp-munderover" id="MJXp-Span-322"><span class=""><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324" style="margin-left: 0px;">j</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-325" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-326">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">t</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-333">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-336" style="vertical-align: -0.4em;">j</span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-337">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-340" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-341" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-342" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-343">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">t</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-350">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">b</span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-352">Œî</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">b</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="6.756ex" viewBox="0 -1713.8 40358 2908.9" role="img" focusable="false" style="vertical-align: -2.582ex; margin-bottom: -0.194ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(39078,0)"><g id="mjx-eqn-5" transform="translate(0,219)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-35" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="890" y="0"></use></g></g><g transform="translate(11037,0)"><g transform="translate(-15,0)"><g transform="translate(0,219)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-394" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6F" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="1319" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="1891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-70" x="2253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="2756" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="3329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2248" x="3968" y="0"></use><g transform="translate(5024,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJSZ2-2211" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="815" y="-1536"></use></g><g transform="translate(6469,0)"><g transform="translate(286,0)"><rect stroke="none" width="3544" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6F" x="567" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="1053" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="1625" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-70" x="1987" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="2490" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="3063" y="0"></use></g><g transform="translate(934,-686)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><g transform="translate(567,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1013" y="-213"></use></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-394" x="10420" y="0"></use><g transform="translate(11253,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6A" x="1013" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2B" x="12584" y="0"></use><g transform="translate(13362,0)"><g transform="translate(342,0)"><rect stroke="none" width="3544" height="60" x="0" y="220"></rect><g transform="translate(60,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6F" x="567" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="1053" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="1625" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-70" x="1987" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="2490" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="3063" y="0"></use></g><g transform="translate(1273,-686)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-62" x="567" y="0"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-394" x="17369" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-62" x="18202" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> \Delta output \approx \sum_j \frac{\partial output}{\partial w_j}\Delta w_j + \frac{\partial output}{\partial b}\Delta b \tag{5} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Where the summation goes over all weights w </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and ‚àÇoutput / ‚àÇw </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and ‚àÇoutput / ‚àÇb denote the partial derivatives of the output data on w </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and b, respectively. Do not panic if you feel insecure in the company of private derivatives! Although the formula looks complicated, with all these partial derivatives, it actually says something quite simple (and useful): Œîoutput is a linear function depending on the Œîw </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and Œîb of the weights and the offset. Its linearity facilitates the selection of small changes in weights and offsets to achieve any desired small output offset. So, although in terms of their qualitative behavior, CHs are similar to perceptrons, they make it easier to understand how you can change the output by changing weights and offsets.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If the general form œÉ matters for us, and not its exact form, then why do we use just such a formula (3)? In fact, later we will sometimes consider neurons whose output is equal to f (w (x + b), where f () is some other activation function. The main thing that changes when changing a function is the values ‚Äã‚Äãof partial derivatives in equation (5). It turns out that when we then calculate these partial derivatives, the use of œÉ greatly simplifies algebra, since the exponentials have very pleasant properties when differentiating. In any case, œÉ is often used in work with neural networks, and most often in this book we will use such an activation function.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How to interpret the result of CH? Obviously, the main difference between perceptrons and CHs is that CHs do not give out only 0 or 1. Their output can be any real number from 0 to 1, so values ‚Äã‚Äãlike 0.173 or 0.689 are valid. This can be useful, for example, if you need the output value to indicate, for example, the average brightness of the pixels of the image received at the input of the NA. But sometimes it can be uncomfortable. Suppose we want the network output to say that ‚Äúimage 9 has arrived at the input‚Äù or ‚Äúincoming image is not 9‚Äù. Obviously, it would be easier if the output values ‚Äã‚Äãwere 0 or 1, as in the perceptron. But in practice, we can agree that any output value not less than 0.5 would mean ‚Äú9‚Äù at the input, and any value less than 0.5 would mean that it is ‚Äúnot 9‚Äù.I will always clearly indicate the existence of such arrangements.</font></font><br><br>  Exercises <br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SN simulating perceptrons, part 1 </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suppose we take all the weights and offsets from the network of perceptrons, and multiply them by the positive constant c&gt; 0. </font><font style="vertical-align: inherit;">Show that the network behavior does not change.</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> SN simulating perceptrons, part 2 </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suppose we have the same situation as in the previous task - the network of perceptrons. </font><font style="vertical-align: inherit;">Also assume that the input data is selected for the network. </font><font style="vertical-align: inherit;">We do not need a specific value, the main thing is that it is fixed. </font><font style="vertical-align: inherit;">Suppose the weights and displacements are such that w‚ãÖx + b ‚â† 0, where x is the input value of any perceptron of the network. </font><font style="vertical-align: inherit;">Now we replace all perceptrons in the network by cN, and multiply the weights and displacements by a positive constant c&gt; 0. </font><font style="vertical-align: inherit;">Show that in the limit c ‚Üí ‚àû, the behavior of the network from CH will be exactly the same as the network of perceptrons. </font><font style="vertical-align: inherit;">How will this statement be violated if for one of the perceptrons w‚ãÖx + b = 0?</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Neural network architecture </font></font></h3><br>  In the next section, I will introduce a neural network capable of a good classification of handwritten numbers.  Before that, it is useful to explain terminology that allows us to point to different parts of the network.  Suppose we have the following network: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/472/521/00b/47252100b91b8e1a527796217a6ed0fa.png"><br><br>  As I already mentioned, the leftmost layer in the network is called the input layer, and its neurons are called the input neurons.  The rightmost, or output layer, contains the output neurons, or, as in our case, one output neuron.  The middle layer is called hidden because its neurons are neither input nor output.  The term "hidden" may sound a little mysterious - for the first time I heard it, I decided that it should have some deep philosophical or mathematical importance - but it means only "no entry and no exit."  The network above has only one hidden layer, but some networks have several hidden layers.  For example, in the following four-layer network there are two hidden layers: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/26e/be9/c5f/26ebe9c5f4c7f61413cfa43e67151734.png"><br><br>  This can be confusing, but for historical reasons such networks with several layers are sometimes called multilayer perceptrons, MLP, despite the fact that they consist of sigmoid neurons rather than perceptrons.  I am not going to use such terminology, since it is confusing, but I must warn of its existence. <br><br>  Designing input and output layers is sometimes a simple task.  For example, let's say we are trying to determine whether the handwritten number means ‚Äú9‚Äù or not.  A natural network circuit will encode the brightness of the image pixels in the input neurons.  If the image is black and white, 64x64 pixels in size, then we will have 64x64 = 4096 input neurons, with a brightness in the range from 0 to 1. The output layer will contain only one neuron, whose value less than 0.5 will mean that ‚Äúon the input was not 9 ", and the values ‚Äã‚Äãmore will mean that" the input was 9 ". <br><br>  And if the design of input and output layers is often a simple task, then the design of hidden layers can be a complicated art.  In particular, it is impossible to describe the process of developing hidden layers with the help of a few simple practical rules.  Researchers of the National Assembly have developed many heuristic rules for designing hidden layers to help get the desired behavior of neural networks.  For example, such heuristics can be used to understand how to reach a compromise between the number of hidden layers and the time available for network training.  Later we will come across some of these rules. <br><br>  So far we have discussed NA, in which the output of one layer is used as input for the next.  Such networks are called forward propagation neural networks.  This means that there are no loops in the network - information always flows forward and never feeds back.  If we had loops, we would have encountered situations in which the input data sigmoids would depend on the output.  It would be hard to comprehend, and we do not allow such loops. <br><br>  However, there are other models of artificial NA in which it is possible to use feedback loops.  These models are called <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B5%25D0%25BA%25D1%2583%25D1%2580%25D1%2580%25D0%25B5%25D0%25BD%25D1%2582%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BD%25D0%25B5%25D0%25B9%25D1%2580%25D0%25BE%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2581%25D0%25B5%25D1%2582%25D1%258C">recurrent neural networks</a> (RNS).  The idea of ‚Äã‚Äãthese networks is that their neurons are activated for limited periods of time.  This activation can stimulate other neutrons, which can be activated a little later, also for a limited time.  This leads to the activation of the following neurons, and over time we get a cascade of activated neurons.  Loops in such models do not pose a problem, since the output of a neuron affects its entrance to some later point, and not immediately. <br><br>  The RNS were not as influential as the direct propagation NA, in particular, because the training algorithms for the RNS so far have fewer capabilities.  However, the PHC is still extremely interesting.  In the spirit of the work they are much closer to the brain than the NA direct distribution.  It is possible that the RNS will be able to solve important tasks that can be solved with great difficulty with the help of the ND.  However, in order to limit the scope of our study, we will focus on more widely used NA direct distribution. <br><br><h3>  Simple handwriting classification network </h3><br>  Having determined the neural network, let us return to handwriting recognition.  We can divide the task of recognizing handwritten numbers into two subtasks.  First we want to find a way to split an image containing many digits into a sequence of separate images, each of which contains one digit.  For example, we would like to break the image <br><br><img src="https://habrastorage.org/getpro/habr/post_images/839/d0b/543/839d0b54370af70f06b3f097897de457.png"><br><br>  into six separate <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b36/135/6ae/b361356aec440b1dbf77c8dedbc6f9b6.png"><br><br>  We, people, easily solve this segmentation problem, but for a computer program it is difficult to correctly split an image.  After segmentation, the program needs to classify each individual digit.  So, for example, we want our program to recognize that the first digit <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e5a/c2a/808/e5ac2a808e18ac02ba0f09b2052fff4f.png"><br><br>  this is 5. <br><br>  We will focus on creating a program for solving the second task, the classification of individual numbers.  It turns out that the segmentation task is not as difficult to solve as soon as we find a good way to classify individual numbers.  To solve the problem of segmentation, there are many approaches.  One of them is to try many different ways of image segmentation using a classifier of individual numbers, evaluating each attempt.  Trial segmentation is highly appreciated if the classifier of individual numbers is confident in the classification of all segments, and low if it has problems in one or several segments.  The idea is that if the classifier has problems somewhere, it most likely means that the segmentation is incorrect.  This idea and other options can be used to solve the segmentation problem quite well.  So, instead of worrying about segmentation, we will focus on developing an NA that can solve a more interesting and challenging task, namely, recognize individual handwritten numbers. <br><br>  For the recognition of individual numbers, we will use the NA of three layers: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e6b/350/3dc/e6b3503dcc1e2848980d17ad8c193018.png"><br><br>  The input network layer contains neurons that encode different values ‚Äã‚Äãof the input pixels.  As will be indicated in the next section, our training data will consist of a set of images of scanned handwritten numbers of 28x28 pixels, so the input layer contains 28x28 = 784 neurons.  For simplicity, I did not specify most of the 784 neurons in the diagram.  The incoming pixels are black and white, with a value of 0.0 indicating white, 1.0 indicating black, and intermediate values ‚Äã‚Äãindicating increasingly darker shades of gray. <br><br>  The second layer of the network is hidden.  We denote the number of neurons in this layer n, and we will experiment with different values ‚Äã‚Äãof n.  The example above shows a small hidden layer containing only n = 15 neurons. <br><br>  In the output layer of the network 10 neurons.  If the first neuron is activated, that is, its output value is ‚âà 1, this indicates that the network considers that the input was 0. If the second neuron is activated, the network considers that there was 1 at the input. And so on.  Strictly speaking, we number the output neurons from 0 to 9, and see which one of them has the maximum activation value.  If this is, let's say, neuron No. 6, then our network considers that the number 6 was at the input. And so on. <br><br>  You may wonder why we need to use ten neurons.  After all, we want to know which digit from 0 to 9 corresponds to the input image.  It would be natural to use only 4 output neurons, each of which would take a binary value depending on whether its output value is closer to 0 or 1. Four neurons will be enough, since 2 <sup>4</sup> = 16, more than 10 possible values.  Why should our network use 10 neurons?  This is ineffective?  The basis for this is empirical;  we can try both versions of the network, and it turns out that for this task a network with 10 output neurons is better trained to recognize numbers than a network with 4.  However, the question remains, why are 10 output neurons better?  Is there any heuristics that would tell us in advance that you should use 10 output neurons instead of 4? <br><br>  To understand why, it is useful to think about what makes a neural network.  Consider first the variant with 10 output neurons.  Let's concentrate on the first output neuron, which is trying to decide whether the incoming image is zero.  He does this by weighing the evidence obtained from the hidden layer.  What do hidden neurons do?  Suppose the first neuron in the hidden layer determines whether there is something like this in the picture: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/650/c35/402/650c3540204f98b406e25078ddc8742a.png"><br><br>  He can do this by assigning large weights to the pixels that coincide with this image, and small weights to the rest.  In the same way, we assume that the second, third, and fourth neurons in the hidden layer are looking for whether there are such fragments in the image: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d94/4c3/cea/d944c3cea54d91106d2ee2198d04c801.png"><br><br>  As you might have guessed, collectively, these four fragments give the image 0, which we saw earlier: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f99/a20/1e5/f99a201e557bacdbe39190a6f913b49e.png"><br><br>  So, if four hidden neurons are activated, we can conclude that the number is 0. Of course, this is not the only evidence that 0 was shown there - we can get 0 and in many other ways (by slightly shifting these images or slightly distorting them).  However, it can be said for sure that, at least in this case, we can conclude that the input was 0. <br><br>  If we assume that the network works this way, we can give a plausible explanation for why it is better to use 10 output neurons instead of 4. If we had 4 output neurons, then the first neuron would try to decide what is the most significant bit of the incoming digit.  And there is no easy way to associate the most significant bit with the simple forms given above.  It is difficult to imagine any historical reasons for which parts of the form of the number would be somehow related to the most significant bit of the output data. <br><br>  However, all of the above is supported only by heuristics.  Nothing speaks in favor of the fact that the three-layer network should work as I said, and hidden neurons should find simple components of the forms.  Perhaps a clever learning algorithm will find some weights that will allow us to use only 4 output neurons.  However, as a heuristic, my method works well, and can save you considerable time in developing a good NA architecture. <br><br><h3>  Exercises </h3><br><ul><li>  There is a way to determine the bitwise representation of a number by adding an extra layer to the three-layer network.  The additional layer converts the output values ‚Äã‚Äãof the previous layer to binary format, as shown in the figure below.  Find the weights and offsets for the new output layer.  We assume that the first 3 layers of neurons are such that the correct output from the third layer (the former output layer) is activated by values ‚Äã‚Äãof at least 0.99, and incorrect output values ‚Äã‚Äãdo not exceed 0.01. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/f5b/4af/2e9/f5b4af2e9acf846ab8cc5c60dac20c03.png"><br><br><h3>  Gradient Descent Training </h3><br>  So, we have a NA scheme - how can she learn to recognize numbers?  The first thing we need is training data, the so-called.  training data set.  We will use the <a href="http://yann.lecun.com/exdb/mnist/">MNIST set</a> , containing tens of thousands of scanned images of handwritten numbers, and their correct classification.  The name MNIST is due to the fact that it is a modified subset of the two data sets collected by <a href="https://ru.wikipedia.org/wiki/%25D0%259D%25D0%25B0%25D1%2586%25D0%25B8%25D0%25BE%25D0%25BD%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B8%25D0%25BD%25D1%2581%25D1%2582%25D0%25B8%25D1%2582%25D1%2583%25D1%2582_%25D1%2581%25D1%2582%25D0%25B0%25D0%25BD%25D0%25B4%25D0%25B0%25D1%2580%25D1%2582%25D0%25BE%25D0%25B2_%25D0%25B8_%25D1%2582%25D0%25B5%25D1%2585%25D0%25BD%25D0%25BE%25D0%25BB%25D0%25BE%25D0%25B3%25D0%25B8%25D0%25B9">NIST</a> , the US National Institute of Standards and Technology.  Here are some images from MNIST: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b36/135/6ae/b361356aec440b1dbf77c8dedbc6f9b6.png"><br><br>  These are the same figures that were given at the beginning of the chapter as a recognition problem.  Of course, when checking the NA, we will ask her to recognize the wrong images that were already in the training set! <br><br>  MNIST data consists of two parts.  The first contains 60,000 images intended for learning.  This scanned handwritten notes of 250 people, half of whom were employees of the US Census Bureau, and the second half - high school students.  Images are black and white, measuring 28x28 pixels.  The second part of the MNIST dataset is 10,000 images to test the network.  These are also black and white images of 28x28 pixels.  We will use this data to assess how well the network has learned to recognize numbers.  To improve the quality of the assessment, these figures were taken from another 250 people who did not participate in the enrollment (although these were also Bureau staff and high school students).  This helps us to make sure that our system can recognize handwritten input of people that it has not met during the training. <br><br>  We denote the training input by x.  It will be convenient to treat each input image x as a vector with 28x28 = 784 dimensions.  Each value inside the vector indicates the brightness of one pixel of the image.  The output value will be denoted as y = y (x), where y is a ten-dimensional vector.  For example, if a specific training image x contains 6, then y (x) = (0,0,0,0,0,0,0,0,0,0) <sup>T</sup> will be the vector we need.  T is a transpose operation that turns a row vector into a column vector. <br><br>  We want to find an algorithm that allows us to search for such weights and displacements so that the output of the network approaches y (x) for all training inputs x.  To quantify the approximation to this goal, we define the cost function (sometimes called the <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D1%2583%25D0%25BD%25D0%25BA%25D1%2586%25D0%25B8%25D1%258F_%25D0%25BF%25D0%25BE%25D1%2582%25D0%25B5%25D1%2580%25D1%258C">loss function</a> ; in the book we will use the cost function, but keep in mind another name): <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">C</span><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">w</span><span class="MJXp-mo" id="MJXp-Span-358" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">b</span><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-362">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">c</span><span class="MJXp-mrow" id="MJXp-Span-367"><span class="MJXp-mn" id="MJXp-Span-368">1</span></span><span class="MJXp-mrow" id="MJXp-Span-369"><span class="MJXp-mn" id="MJXp-Span-370">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">n</span></span><span class="MJXp-mtext" id="MJXp-Span-372">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">u</span><span class="MJXp-msubsup" id="MJXp-Span-375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-377" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mrow" id="MJXp-Span-378"><span class="MJXp-mo" id="MJXp-Span-379" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-380"><span class="MJXp-mo" id="MJXp-Span-381" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">y</span><span class="MJXp-mo" id="MJXp-Span-383" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">x</span><span class="MJXp-mo" id="MJXp-Span-385" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-386" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">a</span><span class="MJXp-mrow" id="MJXp-Span-388"><span class="MJXp-mo" id="MJXp-Span-389" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-390"><span class="MJXp-mrow" id="MJXp-Span-391" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-392" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-393" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-394">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">g</span><span class="MJXp-mrow" id="MJXp-Span-398"><span class="MJXp-mn" id="MJXp-Span-399">6</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="42.382ex" height="3.142ex" viewBox="0 -1039.5 18247.9 1352.7" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28" x="760" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="1150" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2C" x="1866" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-62" x="2311" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="2741" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-3D" x="3408" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-66" x="4714" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-72" x="5265" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-61" x="5716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-63" x="6246" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="6679" y="0"></use><g transform="translate(7180,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6E" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-73" x="8531" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-75" x="9000" y="0"></use><g transform="translate(9573,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-78" x="1242" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-7C" x="10956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-7C" x="11235" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-79" x="11513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28" x="12011" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-78" x="12400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="12973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2212" x="13584" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-61" x="14585" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-7C" x="15114" y="0"></use><g transform="translate(15393,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-32" x="393" y="675"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-74" x="16375" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-61" x="16737" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-67" x="17266" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-36" x="17747" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-12"> C (w, b) = \ frac {1} {2n} \ sum_x || y (x) - a || ^ 2 \ tag {6} </script></p><br><br>  Here w denotes a set of weights of the network, b is the set of offsets, n is the number of training inputs, a is the output data vector, when x is the input data, and the sum goes through all the training input data x.  The output, of course, depends on x, w and b, but for simplicity I did not denote this dependence.  Designation || v ||  means the length of the vector v.  We will call C a quadratic cost function;  it is sometimes also referred to as root-mean-square error, or MSE.  If you look at C, you can see that it is not negative, since all terms of the sum are non-negative.  In addition, the cost C (w, b) becomes small, that is, C (w, b) ‚âà 0, precisely when y (x) is approximately equal to the output vector a of all the training input data x.  So our algorithm worked well, if it managed to find weights and offsets such that C (w, b) ‚âà 0. And vice versa, it worked badly when C (w, b) is large - this means that y (x) does not match with output for a large amount of input data.  It turns out that the purpose of the learning algorithm is to minimize the cost of C (w, b) as a function of weights and offsets.  In other words, we need to find a set of weights and offsets that minimizes the value of the cost.  We will do this with an algorithm called gradient descent. <br><br>  Why do we need a quadratic cost?  Are we not mainly interested in the number of images correctly recognized by the network?  Is it possible to simply maximize this number directly, and not to minimize the intermediate value of the quadratic value?  The problem is that the number of correctly recognized images is not a smooth function of the weights and network offsets.  For the most part, small changes in weights and offsets will not change the number of correctly recognized images.  Because of this, it is hard to understand how to change weights and biases to improve efficiency.  If we use the smooth cost function, it will be easy for us to understand how to make small changes in weight and displacement to improve the cost.  Therefore, we first concentrate on the quadratic cost, and then we will examine the accuracy of the classification. <br><br>  Even considering that we want to use a smooth cost function, you can still wonder - why did we choose the quadratic function for equation (6)?  Can it not be chosen arbitrarily?  Perhaps if we chose a different function, we would get a completely different set of minimizing weights and offsets.  A reasonable question, and later we will again study the cost function and make some edits to it.  However, the quadratic cost function works great for understanding basic things in NA learning, so for now we‚Äôll stick to it. <br><br>  To summarize: our goal in teaching NN comes down to finding weights and displacements that minimize the quadratic cost function C (w, b).  The task is well set, but so far it has many distracting structures - interpreting w and b as weights and offsets, function œÉ hidden in the background, choice of network architecture, MNIST, and so on.  It turns out that we can understand a great deal, ignoring most of this structure, and concentrating only on the aspect of minimization.  So for the time being, we will forget about the special form of the cost function, communication with NA and so on.  Instead, we are going to imagine that we simply have a function with many variables, and we want to minimize it.  We will develop a technology called gradient descent, which can be used to solve such problems.  And then we will return to a certain function that we want to minimize for the National Assembly. <br><br>  Well, let's say we are trying to minimize a certain function C (v).  It can be any function with real values ‚Äã‚Äãin many variables v = v <sub>1</sub> , v <sub>2</sub> , ... Notice that I replaced the entry w and b with v, to show that it can be any function - we are no longer fixating on the NA.  It is useful to imagine that the C function has only two variables - v <sub>1</sub> and v <sub>2</sub> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fff/752/1ad/fff7521ad0e339cb68eceace0f200697.png"><br><br>  We would like to find where C reaches the global minimum.  Of course, with the function drawn above, we can study the graph and find the minimum.  In this sense, I may have given you a function too simple!  In general, C can be a complex function of many variables, and it is usually impossible to just look at the graph and find the minimum. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One of the ways to solve the problem is to use algebra to find the minimum analytically. We can calculate the derivatives and try to use them to find the extremum. If we are lucky, it will work when C is a function of one or two variables. But with a large number of variables, this turns into a nightmare. And for NA, we often need much more variables ‚Äî for the largest NA, the cost functions in a complex way depend on billions of weights and offsets. Use algebra to minimize these functions will not work!</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Having said that it would be more convenient for us to consider C as a function of two variables, I twice in two paragraphs said ‚Äúyes, but what if it is a function of a much larger number of variables?‚Äù I apologize. Believe that it would be useful for us to represent C as a function two variables. Sometimes this picture falls apart, which is why the two previous sections were needed. For mathematical reasoning, it is often necessary to juggle with several intuitive representations, learning when the presentation can be used, and when not zya.)</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Okay, so algebra won't work. Fortunately, there is a great analogy that suggests a well-functioning algorithm. We see our function as something of a valley. With the latest schedule it will not be so difficult to do. And we imagine a ball rolling down the side of a valley. Our experience tells us that the ball will eventually roll to the bottom. Perhaps we can use this idea to find the minimum of a function? We will randomly choose the starting point for an imaginary ball, and then simulate the movement of the ball, as if it were rolling down to the bottom of a valley. We can use this simulation simply by counting the derivatives (and, possibly, the second derivatives) C - they will tell us everything about the local form of the valley, and, consequently, about how our ball will roll.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Based on what you have written, you might think that we will write down Newton's equations of motion for the ball, consider the effects of friction and gravity, and so on. In fact, we will not follow this analogy with the ball so closely - we are developing an algorithm for minimizing C, and not an exact simulation of the laws of physics! This analogy should stimulate our imagination, and not limit thinking. So instead of diving into the complex details of physics, let's ask the question: if we were appointed by God for one day, and we would create our own laws of physics, telling the ball how to roll which law or laws of motion we would choose so that the ball always rolls on valley bottom? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To clarify the question, let's think about what happens if we move the ball a small distance Œîv </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the direction of v </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and a small distance Œîv </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the direction of v </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Algebra tells us that C changes as follows:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-400"><span class="MJXp-mtable" id="MJXp-Span-401"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-402" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-403" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-404"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-406" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚âà </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-407" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-408"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-410"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-413" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-414"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Œî</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-417" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-418" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-419" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-420"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-422"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-425" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-426"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Œî</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-429" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="5.551ex" viewBox="0 -1454.5 40358 2390.2" role="img" focusable="false" style="vertical-align: -2.008ex; margin-bottom: -0.165ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(39078,0)"><g id="mjx-eqn-7" transform="translate(0,-28)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-37" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="890" y="0"></use></g></g><g transform="translate(14637,0)"><g transform="translate(-15,0)"><g transform="translate(0,-28)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-394" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2248" x="1871" y="0"></use><g transform="translate(2650,0)"><g transform="translate(397,0)"><rect stroke="none" width="1626" height="60" x="0" y="220"></rect><g transform="translate(149,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="567" y="0"></use></g><g transform="translate(60,-686)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><g transform="translate(567,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="686" y="-213"></use></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-394" x="4794" y="0"></use><g transform="translate(5628,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="686" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2B" x="6790" y="0"></use><g transform="translate(7568,0)"><g transform="translate(342,0)"><rect stroke="none" width="1626" height="60" x="0" y="220"></rect><g transform="translate(149,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="567" y="0"></use></g><g transform="translate(60,-686)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><g transform="translate(567,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-32" x="686" y="-213"></use></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-394" x="9657" y="0"></use><g transform="translate(10491,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-32" x="686" y="-213"></use></g></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-13"> \Delta C \approx \frac{\partial C}{\partial v_1} \Delta v_1 + \frac{\partial C}{\partial v_2} \Delta v_2 \tag{7} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We will find a way to select Œîv </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and Œîv </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> such that ŒîC is less than zero; </font><font style="vertical-align: inherit;">that is, we will select them so that the ball rolls down. </font><font style="vertical-align: inherit;">To understand how to do this, it is useful to define Œîv as a vector of changes, that is, Œîv ‚â° (Œîv </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Œîv </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , where T is the transpose operation that turns the row vectors into column vectors. </font><font style="vertical-align: inherit;">We also define the gradient vector C as partial derivatives (‚àÇS / ‚àÇv </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ‚àÇS / ‚àÇv </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Denote the gradient vector, we will ‚àáC:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-430"><span class="MJXp-mtable" id="MJXp-Span-431"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-432" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-433" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-434"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-436" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚â° </font></font></span><span class="MJXp-mo" id="MJXp-Span-437" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-438" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-439"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-441"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-444" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-445" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-446" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-447"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-449"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-452" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-453"><span class="MJXp-mo" id="MJXp-Span-454" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-455" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="5.551ex" viewBox="0 -1454.5 40358 2390.2" role="img" focusable="false" style="vertical-align: -2.008ex; margin-bottom: -0.165ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(39078,0)"><g id="mjx-eqn-8" transform="translate(0,-28)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-38" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="890" y="0"></use></g></g><g transform="translate(16111,0)"><g transform="translate(-15,0)"><g transform="translate(0,-28)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2207" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2261" x="1871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28" x="2928" y="0"></use><g transform="translate(3317,0)"><g transform="translate(120,0)"><rect stroke="none" width="1626" height="60" x="0" y="220"></rect><g transform="translate(149,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="567" y="0"></use></g><g transform="translate(60,-686)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><g transform="translate(567,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="686" y="-213"></use></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2C" x="5184" y="0"></use><g transform="translate(5462,0)"><g transform="translate(286,0)"><rect stroke="none" width="1626" height="60" x="0" y="220"></rect><g transform="translate(149,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="567" y="0"></use></g><g transform="translate(60,-686)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><g transform="translate(567,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-32" x="686" y="-213"></use></g></g></g></g><g transform="translate(7496,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-54" x="550" y="583"></use></g></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-14"> \nabla C \equiv (\frac{\partial C}{\partial v_1}, \frac{\partial C}{\partial v_2})^T \tag{8} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soon we will rewrite the change in ŒîC through Œîv and gradient C. In the meantime, I want to clarify something, which is why people often hang on the gradient. When they first meet C, people sometimes don‚Äôt understand how they should perceive the symbol. What does he specifically mean? In fact, you can safely assume that C is a single mathematical object ‚Äî a vector previously defined ‚Äî that is simply written using two characters. From this point of view, ‚àá is like waving a flag telling that "‚àáC is a gradient vector." There are also more advanced points of view, from which ‚àá can be considered as an independent mathematical entity (for example, as a differentiation operator), but we will not need them. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">With such definitions, expression (7) can be rewritten as:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-456"><span class="MJXp-mtable" id="MJXp-Span-457"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-458" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-459" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-460"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-462" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚âà </font></font></span><span class="MJXp-mi" id="MJXp-Span-463"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ãÖ </font></font></span><span class="MJXp-mi" id="MJXp-Span-466"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="2.78ex" viewBox="0 -832 40358 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(39078,0)"><g id="mjx-eqn-9" transform="translate(0,-25)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-39" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="890" y="0"></use></g></g><g transform="translate(17071,0)"><g transform="translate(-15,0)"><g transform="translate(0,-25)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-394" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2248" x="1871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2207" x="2928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="3761" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-22C5" x="4744" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-394" x="5245" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="6078" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-15"> \Delta C \approx \nabla C \cdot \Delta v \tag{9} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This equation helps explain why ‚àáC is called a gradient vector: it associates changes in v with changes in C, exactly as expected from an entity called a gradient. </font><font style="vertical-align: inherit;">[eng </font><font style="vertical-align: inherit;">gradient - deviation / approx. </font><font style="vertical-align: inherit;">transl.] However, it is more interesting that this equation allows us to see how to choose Œîv so that ŒîC is negative. </font><font style="vertical-align: inherit;">Let's say we choose</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-468"><span class="MJXp-mtable" id="MJXp-Span-469"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-470" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-471" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-472"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-475" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-mi" id="MJXp-Span-477"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="2.78ex" viewBox="0 -832 40358 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(38577,0)"><g id="mjx-eqn-10" transform="translate(0,-25)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-30" x="890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(17588,0)"><g transform="translate(-15,0)"><g transform="translate(0,-25)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-394" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-3D" x="1596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2212" x="2653" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-3B7" x="3431" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2207" x="3935" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="4768" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> \Delta v = - \eta \nabla C \tag{10} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where Œ∑ is a small positive parameter (learning rate). </font><font style="vertical-align: inherit;">Then equation (9) tells us that ŒîC &amp; approx; </font><font style="vertical-align: inherit;">- Œ∑ ‚àáC &amp; cdot; </font><font style="vertical-align: inherit;">= - Œ∑ || ‚àáC ||</font></font> <sup>2</sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Since || ‚àáC || </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚â• 0, this ensures that ŒîC ‚â§ 0, that is, C will decrease all the time if we change v, as stated in (10) (of course, within the approximation from equation (9)). </font><font style="vertical-align: inherit;">And that is exactly what we need! </font><font style="vertical-align: inherit;">Therefore, we take equation (10) to determine the "law of motion" of the ball in our gradient descent algorithm. </font><font style="vertical-align: inherit;">That is, we will use equation (10) to calculate the value of Œîv, and then we will move the ball to this value:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-479"><span class="MJXp-mtable" id="MJXp-Span-480"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-481" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-482" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mo" id="MJXp-Span-484" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-msup" id="MJXp-Span-485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-487" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä≤</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-488" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mo" id="MJXp-Span-490" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-mi" id="MJXp-Span-492"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="2.901ex" viewBox="0 -883.9 40358 1249" role="img" focusable="false" style="vertical-align: -0.848ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(38577,0)"><g id="mjx-eqn-11" transform="translate(0,-30)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(16372,0)"><g transform="translate(-15,0)"><g transform="translate(0,-30)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2192" x="763" y="0"></use><g transform="translate(2041,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2032" x="686" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-3D" x="3099" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="4155" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2212" x="4863" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-3B7" x="5864" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2207" x="6367" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="7201" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-17"> v \rightarrow v' = v - \eta \nabla C \tag{11} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then we again apply this rule for the next move. Continuing the repetition, we will lower C until, as we hope, we reach a global minimum. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Summing up, the gradient descent works through the sequential calculation of the gradient ‚àá C, and the subsequent displacement in the opposite direction, which leads to a ‚Äúfall‚Äù along the slope of the valley. This can be visualized as follows: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f7/495/966/5f749596634bc20923f5f8a3e49a3b9f.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note that with this rule, gradient descent does not reproduce real physical movement. In real life, the ball has an impulse that can allow it to roll across a slope, or even roll up for a while. Only after the work of the friction force the ball is guaranteed to roll down the valley. Our selection rule, Œîv, simply says ‚Äúgo down.‚Äù Pretty good rule for finding the minimum!</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In order for the gradient descent to work correctly, we need to choose a sufficiently small value of the learning speed Œ∑ so that equation (9) is a good approximation. Otherwise, it may turn out that ŒîC&gt; 0 is no good! At the same time, it is not necessary that Œ∑ be too small, since then the changes in Œîv will be tiny, and the algorithm will work too slowly. In practice, Œ∑ changes in such a way that equation (9) gives a good approximation, and the algorithm did not work too slowly. We will see later how this works. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I explained the gradient descent, when function C depended only on two variables. But it works the same if C is a function of many variables. Suppose that it has m variables, v </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ..., v </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Then the change in ŒîC caused by a small change in Œîv = (Œîv </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ..., Œîv </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will equal</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-494"><span class="MJXp-mtable" id="MJXp-Span-495"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-496" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-497" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-498"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚âà </font></font></span><span class="MJXp-mi" id="MJXp-Span-501"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-503" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ãÖ </font></font></span><span class="MJXp-mi" id="MJXp-Span-504"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="2.78ex" viewBox="0 -832 40358 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(38577,0)"><g id="mjx-eqn-12" transform="translate(0,-25)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-32" x="890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(17071,0)"><g transform="translate(-15,0)"><g transform="translate(0,-25)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-394" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2248" x="1871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2207" x="2928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="3761" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-22C5" x="4744" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-394" x="5245" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="6078" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-18"> \Delta C \approx \nabla C \cdot \Delta v \tag{12} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> where the ‚àáC gradient is a vector </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-506"><span class="MJXp-mtable" id="MJXp-Span-507"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-508" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-509" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-510"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-512" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚â° </font></font></span><span class="MJXp-mo" id="MJXp-Span-513" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-514" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-515"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-517"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-520" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-521" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></span><span class="MJXp-mo" id="MJXp-Span-522" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font></span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-524" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-525"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-527"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-528"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-530" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-531"><span class="MJXp-mo" id="MJXp-Span-532" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-533" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="5.551ex" viewBox="0 -1454.5 40358 2390.2" role="img" focusable="false" style="vertical-align: -2.173ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(38577,0)"><g id="mjx-eqn-13" transform="translate(0,-25)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-33" x="890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(15085,0)"><g transform="translate(-15,0)"><g transform="translate(0,-25)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2207" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2261" x="1871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28" x="2928" y="0"></use><g transform="translate(3317,0)"><g transform="translate(120,0)"><rect stroke="none" width="1626" height="60" x="0" y="220"></rect><g transform="translate(149,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="567" y="0"></use></g><g transform="translate(60,-686)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><g transform="translate(567,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="686" y="-213"></use></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2C" x="5184" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2026" x="5629" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2C" x="6968" y="0"></use><g transform="translate(7247,0)"><g transform="translate(286,0)"><rect stroke="none" width="1894" height="60" x="0" y="220"></rect><g transform="translate(283,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="567" y="0"></use></g><g transform="translate(60,-686)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><g transform="translate(567,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6D" x="686" y="-213"></use></g></g></g></g><g transform="translate(9548,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-54" x="550" y="583"></use></g></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-19"> \nabla C \equiv (\frac{\partial C}{\partial v_1},‚Ä¶, \frac{\partial C}{\partial v_m})^T \tag{13} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> As with the two variables, we can choose </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-534"><span class="MJXp-mtable" id="MJXp-Span-535"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-536" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-537" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-538"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mo" id="MJXp-Span-540" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-541" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-mi" id="MJXp-Span-543"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="2.78ex" viewBox="0 -832 40358 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(38577,0)"><g id="mjx-eqn-14" transform="translate(0,-25)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-34" x="890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(17588,0)"><g transform="translate(-15,0)"><g transform="translate(0,-25)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-394" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-3D" x="1596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2212" x="2653" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-3B7" x="3431" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2207" x="3935" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="4768" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-20"> \Delta v = - \eta \nabla C \tag{14} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and ensure that our approximate expression (12) for ŒîC is negative. </font><font style="vertical-align: inherit;">This gives us a way to follow the gradient to a minimum, even when C is a function of many variables, applying the update rule over and over again.</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-545"><span class="MJXp-mtable" id="MJXp-Span-546"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-547" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-548" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mo" id="MJXp-Span-550" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-msup" id="MJXp-Span-551"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-553" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä≤</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-554" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mo" id="MJXp-Span-556" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-mi" id="MJXp-Span-558"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="2.901ex" viewBox="0 -883.9 40358 1249" role="img" focusable="false" style="vertical-align: -0.848ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(38577,0)"><g id="mjx-eqn-15" transform="translate(0,-30)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-35" x="890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(16372,0)"><g transform="translate(-15,0)"><g transform="translate(0,-30)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2192" x="763" y="0"></use><g transform="translate(2041,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2032" x="686" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-3D" x="3099" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-76" x="4155" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2212" x="4863" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-3B7" x="5864" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2207" x="6367" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="7201" y="0"></use></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-21"> v \rightarrow v' = v - \eta \nabla C \tag{15} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This update rule can be considered the determining algorithm for gradient descent. </font><font style="vertical-align: inherit;">It gives us the method of repeatedly changing the position of v in search of a minimum of function C. This rule does not always work - several things can go wrong by preventing the gradient descent from finding the global minimum C - by this point we will return in the following chapters. </font><font style="vertical-align: inherit;">But in practice, gradient descent often works very well, and we will see that in NA it is an effective way to minimize the cost function, and, therefore, network training.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In a sense, gradient descent can be considered the optimal strategy for finding a minimum. Suppose we are trying to move Œîv to the position to maximize C. This is equivalent to minimizing ŒîC &amp; approx; ‚àáC &amp; cdot; Œîv. We will limit the step size so that || Œîv || = Œµ for some small constant Œµ&gt; 0. In other words, we want to move a small distance of a fixed size, and try to find the direction of movement that reduces C as much as possible. It can be proved that choosing Œîv that minimizes ‚àáC &amp; cdot; Œîv, equal to Œîv = -Œ∑‚àáC, where Œ∑ = Œµ / || ‚àáC ||, is determined by the constraint || Œîv || = Œµ. So, gradient descent can be considered a way to take small steps in the direction that most strongly reduces C.</font></font><br><br><h3>  Exercises </h3><br><ul><li>     . :      <a href="https://ru.wikipedia.org/wiki/%25D0%259D%25D0%25B5%25D1%2580%25D0%25B0%25D0%25B2%25D0%25B5%25D0%25BD%25D1%2581%25D1%2582%25D0%25B2%25D0%25BE_%25D0%259A%25D0%25BE%25D1%2588%25D0%25B8_%25E2%2580%2594_%25D0%2591%25D1%2583%25D0%25BD%25D1%258F%25D0%25BA%25D0%25BE%25D0%25B2%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B3%25D0%25BE">  ‚Äî </a> , ,  ,      . </li><li>     ,      ,       .  ,       ?            ? </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">People have studied many options for gradient descent, including those that more accurately reproduce the real physical ball. Such options have their advantages, but also a big drawback: the need to calculate the second partial derivatives of C, which can take a lot of resources. To understand this, suppose that we need to calculate all the second partial derivatives of ‚àÇ </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C / ‚àÇ v </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àÇ v </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . If there are v </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> million </font><font style="vertical-align: inherit;">variables </font><font style="vertical-align: inherit;">, then we need to calculate approximately a trillion (million squared) second partial derivatives (actually, half a trillion, since ‚àÇ </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C / ‚àÇ v </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àÇ v </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = ‚àÇ </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C / v </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àÇ v </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. But you caught the essence). This will require a lot of computational resources. There are tricks to avoid this, and the search for alternatives to gradient descent is an area of ‚Äã‚Äãactive research. However, in this book we will use gradient descent and its variants as the main approach to the teaching of the National Assembly. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How do we apply gradient descent to learning NA? We need to use it to search for weights w </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and displacements b </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> minimizing the cost equation (6). Let's rewrite the update rule for gradient descent, replacing the variables v </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j with</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> weights and offsets. In other words, now our ‚Äúposition‚Äù has components w </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and b </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and the gradient vector ‚àáC has corresponding components ‚àÇC / ‚àÇw</font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and ‚àÇC / ‚àÇb </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">By writing our update rule with new components, we get:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-560"><span class="MJXp-mtable" id="MJXp-Span-561"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-562" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-563" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-566" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-571"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">' </font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-572" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-575" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-578" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-579"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-581"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-584" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="5.551ex" viewBox="0 -1454.5 40358 2390.2" role="img" focusable="false" style="vertical-align: -2.173ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(38577,0)"><g id="mjx-eqn-16" transform="translate(0,-25)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-36" x="890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-29" x="1390" y="0"></use></g></g><g transform="translate(15210,0)"><g transform="translate(-15,0)"><g transform="translate(0,-25)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6B" x="1013" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2192" x="1463" y="0"></use><g transform="translate(2741,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2032" x="1013" y="445"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6B" x="1013" y="-463"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-3D" x="4204" y="0"></use><g transform="translate(5260,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6B" x="1013" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2212" x="6668" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-3B7" x="7668" y="0"></use><g transform="translate(8172,0)"><g transform="translate(120,0)"><rect stroke="none" width="1872" height="60" x="0" y="220"></rect><g transform="translate(272,676)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-43" x="567" y="0"></use></g><g transform="translate(60,-686)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMAIN-2202" x="0" y="0"></use><g transform="translate(567,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/456738/&amp;xid=17259,15700022,15700186,15700190,15700256,15700259&amp;usg=ALkJrhg0LytiYyGJJXcL0VJGqSoymOLQsg#MJMATHI-6B" x="1013" y="-213"></use></g></g></g></g></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-22"> w_k \rightarrow w'_k = w_k - \eta \frac{\partial C}{\partial w_k} \tag{16} </script></p><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-585"><span class="MJXp-mtable" id="MJXp-Span-586"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-587" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-588" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-591" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-592" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-593"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-596"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä≤ </font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-597" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-600" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-603" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-604"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-606"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-607"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-609" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></span></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-23"> b_l \rightarrow b'_l = b_l - \eta \frac{\partial C}{\partial b_l} \tag{17} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By reapplying this update rule, we can ‚Äúroll downhill‚Äù and, if we are lucky, find the minimum cost function. In other words, this rule can be used for teaching NA. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are several obstacles to the application of the gradient descent rule. We will study them in more detail in the following chapters. But for now, I want to mention only one problem. To understand it, let's go back to the quadratic value in equation (6). Note that this cost function looks like C = 1 / n ‚àë </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , that is, it is an average of cost C </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (|| y (x) ‚àía || </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) / 2 for individual teaching examples. In practice, to calculate the gradient ‚àáC we need to calculate the gradients ‚àáC </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">separately for each training input x, and then averaging them, ‚àáC = 1 / n ‚àë </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àáC </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Unfortunately, when the amount of input data is very large, it will take a very long time, and such training will take place slowly. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To speed up learning, you can use stochastic gradient descent. The idea is to approximate the gradient of ‚àáC by calculating ‚àáC </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for a small random sample of training input. Having considered their average, we can quickly get a good estimate of the true gradient of ‚àáC, and this helps speed up the gradient descent, and therefore learning.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">More precisely, stochastic gradient descent works through random sampling of a small amount of m training input. </font><font style="vertical-align: inherit;">We call this random data X </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , X </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , .., X </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and call it a mini-packet. </font><font style="vertical-align: inherit;">If the sample size m is large enough, the average value of ‚àáC </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will be close enough to the average for all ‚àáCx, that is,</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-610"><span class="MJXp-mtable" id="MJXp-Span-611"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-612" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-613" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-614" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-615"><span class="MJXp-mo" id="MJXp-Span-616" style="margin-left: 0.111em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àë </font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j </font></font></span><span class="MJXp-mo" id="MJXp-Span-619"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-620"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-622"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àá </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-623"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-625" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-628" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚âà</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-631" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-632"><span class="MJXp-mo" id="MJXp-Span-633" style="margin-left: 0.111em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àë</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-634" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span><span class="MJXp-mi" id="MJXp-Span-635"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-638" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-640" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mi" id="MJXp-Span-641"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-24"> \frac{\sum^m_{j=1} \nabla C_{X_j}}{m} \approx \frac{\sum_x \nabla C_x}{n} = \nabla C \tag{18} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where the second amount goes across the entire training data set. </font><font style="vertical-align: inherit;">Swapping the parts, we get</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-643"><span class="MJXp-mtable" id="MJXp-Span-644"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-645" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-646" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-647"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚âà </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-650" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-651"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-653"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-659" style="margin-right: 0px; margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m </font></font></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-654" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àë</font></font></span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-655" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> j</font></font></span><span class="MJXp-mo" id="MJXp-Span-657"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mn" id="MJXp-Span-658"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-660"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-663" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-666" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-25"> \nabla C \approx \frac{1}{m} \sum^m_{j=1} \nabla C_{X_j} \tag{19} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">which confirms that we can estimate the overall gradient by calculating gradients for a randomly selected mini-packet. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To relate this directly to the teaching of the NA, let's assume that w </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and b </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> denote the weights and displacements of our NA. </font><font style="vertical-align: inherit;">Then the stochastic gradient descent selects a random mini-packet of input data, and learns from them.</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-667"><span class="MJXp-mtable" id="MJXp-Span-668"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-669" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-670" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-673" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-674" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-675"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-678"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä≤ </font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-682" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-683" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-684" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-687"><span class=""><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àë</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-690" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-691"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-694" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> X </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-697" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-698"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-701" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-26"> w_k \rightarrow w'_k = w_k - \frac{\eta}{m} \sum_j \frac{\partial C_{X_j}}{\partial w_k} \tag{20} </script></p><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-702"><span class="MJXp-mtable" id="MJXp-Span-703"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-704" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-705" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-708" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-709" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-713"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä≤ </font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-714" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-715"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-717" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-718" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-719" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-722"><span class=""><span class="MJXp-mo" id="MJXp-Span-723" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àë</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-725" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-726"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-729" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> X </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-732" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-733"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-736" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></span></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-27"> b_l \rightarrow b'_l = b_l - \frac{\eta}{m} \sum_j \frac{\partial C_{X_j}}{\partial b_l} \tag{21} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where is the summation of all teaching examples X </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the current mini-package. </font><font style="vertical-align: inherit;">Then we select another random mini-pack and learn from it. </font><font style="vertical-align: inherit;">And so on, until we have exhausted all the training data, which is called the end of the learning era. </font><font style="vertical-align: inherit;">At this moment we are starting a new era of learning.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By the way, it is worth noting that agreements regarding the scaling of the cost function and the updates of weights and offsets by the mini-package differ. In equation (6), we scaled the cost function by 1 / n times. Sometimes people omit 1 / n, summing up the cost of individual teaching examples, instead of calculating the average. This is useful when the total number of training examples is not known in advance. This can happen, for example, when additional data appears in real time. In the same way, the update rules for the mini-package (20) and (21) sometimes omit the 1 / m term before the sum. Conceptually, this does not affect anything, since it is equivalent to a change in the learning rate Œ∑. However, it is worth paying attention to when comparing different works.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A stochastic gradient descent can be thought of as a political vote: it is much easier to take a sample in the form of a mini-package than to apply a gradient descent to a full sample ‚Äî just like a poll at the exit of a site is easier than conducting full choices. For example, if our training set has a size of n = 60,000, as MNIST, and we will sample a mini packet of size m = 10, then it will speed up the gradient estimation by a factor of 6000! Of course, the estimate will not be perfect - there will be a statistical fluctuation in it - but it doesn‚Äôt have to be perfect: we only need to move in approximately the direction that C decreases, which means that we don‚Äôt need to accurately calculate the gradient. In practice, stochastic gradient descent is a common and powerful teaching technique of the National Assembly, and the base of most of the training technologies that we develop in the framework of the book.</font></font><br><br><h3>  Exercises </h3><br><ul><li>       -  1.  ,    x         w <sub>k</sub> ‚Üí w‚Ä≤ <sub>k</sub> = w <sub>k</sub> ‚àí Œ∑ ‚àÇC <sub>x</sub> / ‚àÇw <sub>k</sub>  b <sub>l</sub> ‚Üí b‚Ä≤ <sub>l</sub> = b <sub>l</sub> ‚àí Œ∑ ‚àÇC <sub>x</sub> / ‚àÇb <sub>l</sub> .              .  And so on.   ,  -,   .  -            ( ).       -         -  20. </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let us end this section with a discussion of a topic that sometimes worries people who first came across a gradient descent. In HC, cost C is a function of many variables ‚Äî all weights and displacements ‚Äî and in a sense, defines a surface in a very multidimensional space. People begin to think: ‚ÄúI will have to visualize all these extra dimensions.‚Äù And they begin to worry: ‚ÄúI cannot navigate in four dimensions, not to mention five (or five million)‚Äù. Do they not have any special quality available to the "real" supermathematicians? Of course not. Even professional mathematicians cannot visualize 4-dimensional space well enough ‚Äî if they can at all. They go on tricks, developing other ways of presenting what is happening. We did just that:we used the algebraic (and not visual) representation of ŒîC to understand how to move, so that C decreases. People who cope well with a large number of dimensions have a large library of similar techniques in their minds; our algebraic trick is just one example. These techniques may not be as simple as we are used to when visualizing three dimensions, but when you created a library of similar techniques, you start thinking well in higher dimensions. I will not go into details, but if you are interested, you might liketo which we are accustomed to visualizing three dimensions, but when you created a library of similar techniques, you begin to think well in higher dimensions. I will not go into details, but if you are interested, you might liketo which we are accustomed to visualizing three dimensions, but when you created a library of similar techniques, you begin to think well in higher dimensions. I will not go into details, but if you are interested, you might like</font></font><a href="http://mathoverflow.net/questions/25983/intuitive-crutches-for-higher-dimensional-thinking"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">discussion of some of these techniques by</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> professional mathematicians who are used to thinking in higher dimensions. </font><font style="vertical-align: inherit;">And although some of the techniques discussed are quite complex, most of the best answers are intuitive and accessible to all.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Network implementation to classify numbers </font></font></h3><br>  Ok, now let's write a program that learns how to recognize handwritten numbers using stochastic gradient descent and MNIST training data.  We will do this with a short python 2.7 program consisting of only 74 lines!  The first thing we need is to download the MNIST data.  If you use git, then you can get them by cloning the repository of this book: <br><br> <code>git clone https://github.com/mnielsen/neural-networks-and-deep-learning.git</code> <br> <br>  If not, download the code <a href="">by reference</a> . <br><br>  By the way, when I mentioned the MNIST data before, I said that they are broken up into 60,000 training images and 10,000 verification images.  This is the official description from MNIST.  We will break the data a little differently.  We will leave the verification images unchanged, but we will break the training set into two parts: 50,000 pictures, which we will use to train the National Assembly, and a separate 10,000 pictures for additional ratification.  For the time being we will not use them, but later they will be useful to us when we understand the setting up of some hyperparameters of the National Assembly ‚Äî learning rates, etc., which our algorithm does not directly choose.  Although the ratification data is not included in the original MNIST specification, many people use MNIST in this way, and in the field of NA, the use of ratification data is common.  Now, speaking of the ‚ÄúMNIST tutorial data,‚Äù I will refer to our 50,000 caritsnacks, not the original 60,000. <br><br>  In addition to the MNIST data, we also need a python library called <a href="http://numpy.org/">Numpy</a> for quick calculations of linear algebra.  If you do not have it, you can take it <a href="http://www.scipy.org/install.html">by reference</a> . <br><br>  Before giving you the whole program, let me explain the main features of the code for the NA.  The central place is occupied by the Network class, which we use to represent the National Assembly.  Here is the initialization code for the Network object: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Network</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, sizes)</span></span></span><span class="hljs-function">:</span></span> self.num_layers = len(sizes) self.sizes = sizes self.biases = [np.random.randn(y, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> y <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sizes[<span class="hljs-number"><span class="hljs-number">1</span></span>:]] self.weights = [np.random.randn(y, x) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x, y <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(sizes[:<span class="hljs-number"><span class="hljs-number">-1</span></span>], sizes[<span class="hljs-number"><span class="hljs-number">1</span></span>:])]</code> </pre> <br>  The sizes array contains the number of neurons in the corresponding layers.  So, if we want to create a Network object with two neurons in the first layer, three neurons in the second layer, and one neuron in the third, then we write it this way: <br><br><pre> <code class="python hljs">net = Network([<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>])</code> </pre> <br>  Offsets and weights in the Network object are initialized randomly using the np.random.randn function from Numpy, which generates a Gaussian distribution with a mean of 0 and a standard deviation of 1. This random initialization gives our stochastic gradient descent algorithm a starting point.  In the following chapters we will find the best ways to initialize weights and offsets, but for now this is enough.  Note that the Network initialization code assumes that the first layer of neurons will be input, and does not assign displacements to them, since they are used only when calculating the output data. <br><br>  Also note that offsets and weights are stored as an array of Numpy matrices.  For example, net.weights [1] is a Numpy matrix that stores the weights connecting the second and third layers of neurons (this is not the first and second layers, since in python the numbering of the elements of the array comes from scratch).  Since writing net.weights [1] will be too long, we denote this matrix as w.  This is such a matrix that w <sub>jk</sub> is the weight of the connection between the kth neuron in the second layer and the jth neuron in the third.  Such an order of indices j and k may seem strange - would it not be more logical to swap them?  But the big advantage of such a recording is that the activation vector of the third layer of neurons is obtained: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-737"><span class="MJXp-msup" id="MJXp-Span-738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-740" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä≤</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-741" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743"><font style="vertical-align: inherit;">s </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749"><font style="vertical-align: inherit;">w </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mo" id="MJXp-Span-751" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;">+ </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752"><font style="vertical-align: inherit;">b </font></span><span class="MJXp-mo" id="MJXp-Span-753" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">) </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mrow" id="MJXp-Span-758"><span class="MJXp-mn" id="MJXp-Span-759"><font style="vertical-align: inherit;">22</font></span></span></font><span class="MJXp-mtext" id="MJXp-Span-742">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-751" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-753" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-754">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-758"><span class="MJXp-mn" id="MJXp-Span-759"><font style="vertical-align: inherit;"></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-28"> a '= \ sigma (wa + b) \ tag {22} </script></p><br><br>  Let's look at this rather saturated equation.  a is the vector of activations of the second layer of neurons.  To get a ', we multiply a by the weights matrix w, and add the displacement vector b.  Then we apply the sigmoid œÉ elementwise to each element of the vector wa + b (this is called the vectorization of the function œÉ).  It is easy to verify that equation (22) gives the same result as rule (4) for calculating the sigmoid neuron. <br><br><h3>  Exercise </h3><br><ul><li>  Write equation (22) in component form, and make sure that it gives the same result as rule (4) for calculating the sigmoid neuron. </li></ul><br>  Given all this, it is easy to write code that computes the output of a Network object.  We begin by defining sigmoids: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sigmoid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(z)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1.0</span></span>/(<span class="hljs-number"><span class="hljs-number">1.0</span></span>+np.exp(-z))</code> </pre> <br>  Note that when the parameter z is a vector or an array of Numpy, then Numpy will automatically apply sigmoid elementwise, that is, in a vector form. <br><br>  Add a direct distribution method to the Network class, which accepts input a from the network and returns the corresponding output.  It is assumed that the a parameter is (n, 1) Numpy ndarray, and not a vector (n,).  Here n is the number of input neurons.  If you try to use a vector (n,), you will get strange results. <br><br>  The method simply applies equation (22) to each layer: <br><br><pre> <code class="python hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">feedforward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, a)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""       "a"""</span></span><span class="hljs-string"><span class="hljs-string">" for b, w in zip(self.biases, self.weights): a = sigmoid(np.dot(w, a)+b) return a</span></span></code> </pre> <br>  Of course, most of us from Network objects need them to learn.  To do this, we give them the SGD method that implements a stochastic gradient descent.  Here is his code.  In some places it is quite mysterious, but below we will analyze it in more detail. <br><br><pre> <code class="python hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SGD</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, training_data, epochs, mini_batch_size, eta, test_data=None)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    -    . training_data ‚Äì   "(x, y)",       .       .  test_data ,          ,     .     ,    . """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> test_data: n_test = len(test_data) n = len(training_data) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> j <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> xrange(epochs): random.shuffle(training_data) mini_batches = [ training_data[k:k+mini_batch_size] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> k <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> xrange(<span class="hljs-number"><span class="hljs-number">0</span></span>, n, mini_batch_size)] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> mini_batch <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> mini_batches: self.update_mini_batch(mini_batch, eta) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> test_data: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Epoch {0}: {1} / {2}"</span></span>.format( j, self.evaluate(test_data), n_test) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"Epoch {0} complete"</span></span>.format(j)</code> </pre> <br>  training_data is a list of "(x, y)" tuples denoting the training input and the desired output.  The variables epochs and mini_batch_size are the number of epochs for training and the size of mini-packages for use.  eta is the learning rate, Œ∑.  If test_data is specified, then the network will be evaluated against the verification data after each epoch, and the current progress will be displayed.  This is useful for tracking progress, but slows down significantly. <br><br>  The code works like this.  In each epoch, he begins by randomly mixing the training data, and then splitting them into mini packets of the desired size.  This is an easy way to create a sample of training data.  Then for each mini_batch we apply one step gradient descent.  This makes the code self.update_mini_batch (mini_batch, eta) updating the weights and offsets of the network according to one iteration of the gradient descent, using only the training data in mini_batch.  Here is the code for the update_mini_batch method: <br><br><pre> <code class="python hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update_mini_batch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, mini_batch, eta)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    ,          -. mini_batch ‚Äì    (x, y),  eta ‚Äì  ."""</span></span> nabla_b = [np.zeros(b.shape) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> b <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.biases] nabla_w = [np.zeros(w.shape) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> w <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.weights] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x, y <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> mini_batch: delta_nabla_b, delta_nabla_w = self.backprop(x, y) nabla_b = [nb+dnb <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> nb, dnb <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(nabla_b, delta_nabla_b)] nabla_w = [nw+dnw <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> nw, dnw <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(nabla_w, delta_nabla_w)] self.weights = [w-(eta/len(mini_batch))*nw <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> w, nw <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(self.weights, nabla_w)] self.biases = [b-(eta/len(mini_batch))*nb <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> b, nb <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(self.biases, nabla_b)]</code> </pre> <br>  Most of the work is done by the line. <br><br><pre> <code class="python hljs"> delta_nabla_b, delta_nabla_w = self.backprop(x, y)</code> </pre> <br>  It triggers backpropagation algorithm ‚Äî it's a quick way to calculate the gradient of the cost function.  So update_mini_batch simply calculates these gradients for each tutorial from mini_batch, and then updates self.weights and self.biases. <br><br>  So far, I will not demonstrate the code for self.backprop.  We will study back propagation work in the next chapter, and there will be self.backprop code.  For now, suppose that it behaves, as stated, by returning the appropriate gradient for the cost associated with teaching example x. <br><br>  Let's look at the program entirely, including explanatory comments.  With the exception of the self.backprop function, the program speaks for itself - the main work is done by self.SGD and self.update_mini_batch.  The self.backprop method uses several additional functions to calculate the gradient, namely, sigmoid_prime, which calculates the sigmoid derivative, and self.cost_derivative, which I will not describe here.  You can get an idea of ‚Äã‚Äãthem by reviewing the code and comments.  In the next chapter we will look at them in more detail.  Note that although the program seems to be long, most of the code is comments that facilitate understanding.  In fact, the program itself consists of only 74 lines of code ‚Äî not empty and no comments.  All <a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/network.py">code is available on GitHub</a> . <br><br><pre> <code class="python hljs"><span class="hljs-string"><span class="hljs-string">""" network.py ~~~~~~~~~~           .      .     ,    .   ,       . """</span></span> <span class="hljs-comment"><span class="hljs-comment">####  #   import random #   import numpy as np class Network(object): def __init__(self, sizes): """  sizes      .  ,      Network      ,     ,     ,    ,  [2, 3, 1].               0    1. ,      ,       ,        . """ self.num_layers = len(sizes) self.sizes = sizes self.biases = [np.random.randn(y, 1) for y in sizes[1:]] self.weights = [np.random.randn(y, x) for x, y in zip(sizes[:-1], sizes[1:])] def feedforward(self, a): """   ,  ``a`` -  .""" for b, w in zip(self.biases, self.weights): a = sigmoid(np.dot(w, a)+b) return a def SGD(self, training_data, epochs, mini_batch_size, eta, test_data=None): """    -    . training_data ‚Äì   "(x, y)",       .       .  test_data ,          ,     .     ,    . """ if test_data: n_test = len(test_data) n = len(training_data) for j in xrange(epochs): random.shuffle(training_data) mini_batches = [ training_data[k:k+mini_batch_size] for k in xrange(0, n, mini_batch_size)] for mini_batch in mini_batches: self.update_mini_batch(mini_batch, eta) if test_data: print "Epoch {0}: {1} / {2}".format( j, self.evaluate(test_data), n_test) else: print "Epoch {0} complete".format(j) def update_mini_batch(self, mini_batch, eta): """    ,          -. mini_batch ‚Äì    (x, y),  eta ‚Äì  .""" nabla_b = [np.zeros(b.shape) for b in self.biases] nabla_w = [np.zeros(w.shape) for w in self.weights] for x, y in mini_batch: delta_nabla_b, delta_nabla_w = self.backprop(x, y) nabla_b = [nb+dnb for nb, dnb in zip(nabla_b, delta_nabla_b)] nabla_w = [nw+dnw for nw, dnw in zip(nabla_w, delta_nabla_w)] self.weights = [w-(eta/len(mini_batch))*nw for w, nw in zip(self.weights, nabla_w)] self.biases = [b-(eta/len(mini_batch))*nb for b, nb in zip(self.biases, nabla_b)] def backprop(self, x, y): """  ``(nabla_b, nabla_w)``,      C_x. ``nabla_b``  ``nabla_w`` -    numpy,   ``self.biases`` and ``self.weights``.""" nabla_b = [np.zeros(b.shape) for b in self.biases] nabla_w = [np.zeros(w.shape) for w in self.weights] #   activation = x activations = [x] #      zs = [] #     z- for b, w in zip(self.biases, self.weights): z = np.dot(w, activation)+b zs.append(z) activation = sigmoid(z) activations.append(activation) #   delta = self.cost_derivative(activations[-1], y) * \ sigmoid_prime(zs[-1]) nabla_b[-1] = delta nabla_w[-1] = np.dot(delta, activations[-2].transpose()) """ l      ,      . l = 1    , l = 2 ‚Äì ,   .    ,   python      .""" for l in xrange(2, self.num_layers): z = zs[-l] sp = sigmoid_prime(z) delta = np.dot(self.weights[-l+1].transpose(), delta) * sp nabla_b[-l] = delta nabla_w[-l] = np.dot(delta, activations[-l-1].transpose()) return (nabla_b, nabla_w) def evaluate(self, test_data): """    ,      .    ‚Äì          .""" test_results = [(np.argmax(self.feedforward(x)), y) for (x, y) in test_data] return sum(int(x == y) for (x, y) in test_results) def cost_derivative(self, output_activations, y): """    ( C_x /  a)   .""" return (output_activations-y) ####   def sigmoid(z): """.""" return 1.0/(1.0+np.exp(-z)) def sigmoid_prime(z): """ .""" return sigmoid(z)*(1-sigmoid(z))</span></span></code> </pre> <br>  How well does the program recognize handwritten numbers?  Let's start by loading the MNIST data.  We do this with a small helper program mnist_loader.py, which I will describe below.  Run the following commands in the python shell: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mnist_loader &gt;&gt;&gt; training_data, validation_data, test_data = \ ... mnist_loader.load_data_wrapper()</code> </pre> <br>  This, of course, can be done in a separate program, but if you work in parallel with the book, it will be easier. <br><br>  After downloading the MNIST data, we set up a network of 30 hidden neurons.  We will do this after importing the program described above, which is called network: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> network &gt;&gt;&gt; net = network.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>])</code> </pre> <br>  Finally, we use a stochastic gradient descent for training on training data for 30 epochs, with a mini-packet size of 10, and a learning rate of Œ∑ = 3.0: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>net.SGD(training_data, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">3.0</span></span>, test_data=test_data)</code> </pre> <br>  If you execute code in parallel with reading a book, please note that it will take several minutes to complete.  I suggest you run everything, continue reading, and periodically check what the program gives out.  If you are in a hurry, you can reduce the number of epochs by reducing the number of hidden neurons, or using only a fraction of the training data.  The final working code will work faster: these python scripts are designed to make you understand how the network works, and they are not high-performance!  And, of course, after training, the network can work very quickly on almost any computing platform.  For example, when we teach the network a good set of weights and offsets, it can easily be ported to work in JavaScript in a web browser, or as a native application on a mobile device.  In any case, about such a conclusion gives a program that teaches a neural network.  She writes the number of correctly recognized test images after each training era.  As you can see, even after one epoch, it reaches an accuracy of 9,129 out of 10,000, and this number continues to grow: <br><br> <code>Epoch 0: 9129 / 10000 <br> Epoch 1: 9295 / 10000 <br> Epoch 2: 9348 / 10000 <br> ... <br> Epoch 27: 9528 / 10000 <br> Epoch 28: 9542 / 10000 <br> Epoch 29: 9534 / 10000</code> <br> <br>  It turns out that a trained network gives a percentage of correct classification of about 95 - 95.42% at the maximum!  Quite a promising first attempt.  I warn you that your code will not necessarily produce exactly the same results, since we initialize the network with random weights and offsets.  For this chapter, I chose the best of the three attempts. <br><br>  Let's restart the experiment by changing the number of hidden neurons to 100. As before, if you run the code simultaneously with reading, note that it takes quite a long time to complete (on my machine, each epoch takes several tens of seconds), so it‚Äôs best to read in parallel with the execution code. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>net = network.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>]) &gt;&gt;&gt; net.SGD(training_data, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">3.0</span></span>, test_data=test_data)</code> </pre> <br>  Naturally, this improves the result to 96.59%.  At least in this case, using more hidden neurons helps to get better results. <br><br>  Feedback from readers suggests that the results of this experiment vary greatly, and some of the learning outcomes are much worse.  Using techniques from Chapter 3 will seriously reduce the variety of work efficiency from one run to the next. <br><br>  Of course, in order to achieve such accuracy, I had to choose a certain number of epochs for learning, a mini-packet size and a learning rate Œ∑.  As I mentioned above, they are called the hyperparameters of our NA ‚Äî to distinguish them from simple parameters (weights and offsets) that the algorithm sets up in the learning process.  If we choose poorly hyper parameters, we will get poor results.  Suppose, for example, that we chose the learning rate Œ∑ = 0.001: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>net = network.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>]) &gt;&gt;&gt; net.SGD(training_data, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.001</span></span>, test_data=test_data)</code> </pre> <br>  The results are much less impressive: <br><br> <code>Epoch 0: 1139 / 10000 <br> Epoch 1: 1136 / 10000 <br> Epoch 2: 1135 / 10000 <br> ... <br> Epoch 27: 2101 / 10000 <br> Epoch 28: 2123 / 10000 <br> Epoch 29: 2142 / 10000</code> <br> <br>  However, it can be seen that network efficiency is slowly growing over time.  This suggests that you can try to increase the speed of learning, for example, to 0.01.  In this case, the results will be better, which suggests the need to further increase the speed (if the change improves the situation, change further!).  If you do this several times, we end up with Œ∑ = 1.0 (and sometimes even 3.0), which is close to our earlier experiments.  So, although we initially poorly selected hyper parameters, at least we collected enough information to be able to improve our choice of parameters. <br><br>  In general, debugging NA is difficult.  This is especially so when the choice of initial hyperparameters produces results that do not exceed the random noise.  Suppose we try to use a successful architecture of 30 neurons, but change the learning speed to 100.0: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>net = network.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>]) &gt;&gt;&gt; net.SGD(training_data, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">100.0</span></span>, test_data=test_data)</code> </pre> <br>  In the end, it turns out that we have gone too far, and took too much speed: <br><br> <code>Epoch 0: 1009 / 10000 <br> Epoch 1: 1009 / 10000 <br> Epoch 2: 1009 / 10000 <br> Epoch 3: 1009 / 10000 <br> ... <br> Epoch 27: 982 / 10000 <br> Epoch 28: 982 / 10000 <br> Epoch 29: 982 / 10000</code> <br> <br>  Now imagine that we are approaching this task for the first time.  Of course, we know from early experiments that it would be correct to reduce the speed of learning.  But if we were to approach this task for the first time, we would have no output that could lead us to the right decision.  Could we start thinking that maybe we chose the wrong starting parameters for weights and offsets, and the network is difficult to learn?  Or perhaps we don‚Äôt have enough training data to get a meaningful result?  Perhaps we did not wait for enough eras?  Perhaps a neural network with such an architecture simply cannot learn to recognize handwritten numbers?  Perhaps the learning rate is too low?  The first approach to the problem you never have confidence. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">From this it is worthwhile to learn the lesson that debugging NA is not a trivial task, and this, like ordinary programming, is part of art. </font><font style="vertical-align: inherit;">You need to learn this debugging art to get good results from the NA. </font><font style="vertical-align: inherit;">In general, we need to develop heuristics for choosing good hyperparameters and good architecture. </font><font style="vertical-align: inherit;">We will discuss this in detail in the book, including how I chose the above hyperparameters.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Exercise </font></font></h3><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Try to create a network of just two layers - input and output, without hidden - with 784 and 10 neurons, respectively. </font><font style="vertical-align: inherit;">Teach the net with a stochastic gradient descent. </font><font style="vertical-align: inherit;">What classification accuracy do you get?</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Earlier, I missed the details of loading MNIST data. </font><font style="vertical-align: inherit;">It happens quite simply. </font><font style="vertical-align: inherit;">Here is the code for completeness. </font><font style="vertical-align: inherit;">The data structures are described in the comments - everything is simple, the tuples and arrays of Numpy ndarray objects (if you are not familiar with such objects, imagine them as vectors).</font></font><br><br><pre> <code class="python hljs"><span class="hljs-string"><span class="hljs-string">""" mnist_loader ~~~~~~~~~~~~      MNIST.       ``load_data``  ``load_data_wrapper``.  , ``load_data_wrapper`` -  ,     . """</span></span> <span class="hljs-comment"><span class="hljs-comment">####  #  import cPickle import gzip #  import numpy as np def load_data(): """  MNIST   ,  ,    . ``training_data``      .    .  numpy ndarray  50 000 .   ‚Äì     numpy ndarray  784 ,  28 * 28 = 784    MNIST.  ‚Äì  numpy ndarray  50 000 .   ‚Äì   0  9   ,    . ``validation_data``  ``test_data`` ,    10 000 .    ,           ``training_data``.    - ``load_data_wrapper()``. """ f = gzip.open('../data/mnist.pkl.gz', 'rb') training_data, validation_data, test_data = cPickle.load(f) f.close() return (training_data, validation_data, test_data) def load_data_wrapper(): """ ,  ``(training_data, validation_data, test_data)``.   ``load_data``,         .  , ``training_data`` -    50 000    , ``(x, y)``. ``x`` -  784- numpy.ndarray,   . ``y`` -  10- numpy.ndarray,   ,     ``x``. ``validation_data``  ``test_data`` -  ,   10 000    , ``(x, y)``. ``x`` -  784- numpy.ndarray,   ,  ``y`` -   ,  ,   ( ),  ``x``. ,  ,           .         .""" tr_d, va_d, te_d = load_data() training_inputs = [np.reshape(x, (784, 1)) for x in tr_d[0]] training_results = [vectorized_result(y) for y in tr_d[1]] training_data = zip(training_inputs, training_results) validation_inputs = [np.reshape(x, (784, 1)) for x in va_d[0]] validation_data = zip(validation_inputs, va_d[1]) test_inputs = [np.reshape(x, (784, 1)) for x in te_d[0]] test_data = zip(test_inputs, te_d[1]) return (training_data, validation_data, test_data) def vectorized_result(j): """ 10-    1.0   j     .      (0..9)     .""" e = np.zeros((10, 1)) e[j] = 1.0 return e</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I said that our program achieves fairly good results. </font></font> What does this mean?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Good compared to what? It is useful to have the results of some simple, basic tests with which one could make a comparison in order to understand what ‚Äúgood results‚Äù means. The simplest basic level, of course, will be a random guess. This can be done in about 10% of cases. And we show a much better result! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What about a less trivial baseline? Let's look at how dark the picture is. For example, image 2 will usually be darker than image 1, simply because it has more dark pixels, as seen in the examples below:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f59/0de/5b7/f590de5b7bc6581b9854b2013e5013de.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">From this it follows that we can calculate the average darkness for each digit from 0 to 9. When receiving a new image, we calculate its darkness, and we guess that it shows a figure with the nearest average darkness. This is a simple procedure that is easy to program, so I will not write code ‚Äî if it is interesting, it </font></font><a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/mnist_average_darkness.py"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lies on GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . But this is already a serious improvement compared to random guesses - the code correctly recognizes 2,225 out of 10,000 images, that is, it gives an accuracy of 22.25%.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is easy to find other ideas that achieve accuracy in the range from 20 to 50%. After working a little more, you can exceed 50%. But in order to achieve much greater accuracy, it is better to use authoritative MO algorithms. Let's try one of the most well-known algorithms, support vector machine or SVM. If you are unfamiliar with SVM, do not worry, we do not need to understand these details. We simply use the python library called scikit-learn, which provides a simple interface to the fast C library for SVM, known as </font></font><a href="http://www.csie.ntu.edu.tw/~cjlin/libsvm/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LIBSVM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If we run the sckit-learn SVM classifier on the default settings, we will get the correct classification 9,435 out of 10,000 (the code </font></font><a href="https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/src/mnist_svm.py"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is available at the link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). This is a great improvement compared to the naive approach of classifying images by darkness. This means that SVM works about as well as our NA, only a bit worse. In the following chapters, we will get acquainted with new techniques that will allow us to improve our NA so much that they overtake SVM.</font></font><br><br>  But that's not all.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The result of 9,435 out of 10,000 from scikit-learn is specified for the default settings. SVM has many parameters that can be adjusted, and you can look for parameters that improve this result. I will not go into details, they can be read in the </font></font><a href="http://peekaboo-vision.blogspot.de/2010/09/mnist-for-ever.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article by</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Andreas Muller. He showed that having done the work on parameter optimization, it is possible to achieve an accuracy of at least 98.5%. In other words, a well-tuned SVM is mistaken only in one digit out of 70. A good result! Can NA achieve more? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It turns out they can. Today, a well-tuned NA overtakes any other known technology in the MNIST solution, including SVM. </font></font><a href="https://www.matthewzeiler.com/mattzeiler/regularization.pdf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Record for 2013</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">correctly classified 9,979 out of 10,000 images. And most of the technology used for this we will see in this book. This level of accuracy is close to human, and, perhaps, exceeds it, because several images from MNIST are difficult to decipher even to a person, for example: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/def/4b3/b37/def4b3b37d8d510615d60a372a06ad47.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I think you will agree that they are difficult to classify! With such images in the MNIST dataset, it is surprising that the NN can correctly recognize all the images from 10,000, except 21. Programmers usually think that a complex algorithm is required to solve such a complex task. But even the National Assembly in the </font></font><a href="https://www.matthewzeiler.com/mattzeiler/regularization.pdf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">work</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-recordmans use fairly simple algorithms, which are small variations of those we discussed in this chapter. </font><font style="vertical-align: inherit;">All complexity automatically appears during training based on training data. </font><font style="vertical-align: inherit;">In a sense, the moral of our results and those contained in more complex works is that for some tasks</font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> complex algorithm ‚â§ simple learning algorithm + good learning data </font></font></blockquote><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> To deep learning </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Although our network demonstrates impressive performance, it is achieved in a mysterious way. </font><font style="vertical-align: inherit;">Weights and mixing nets are automatically detected. </font><font style="vertical-align: inherit;">So, we have no ready explanation for how the network does what it does. </font><font style="vertical-align: inherit;">Is it possible to find some way to understand the basic principles of classification by handwritten numbers? </font><font style="vertical-align: inherit;">And is it possible, given them, to improve the result?</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let us reformulate these questions more rigidly: let us assume that in a few decades the National Assembly will turn into artificial intelligence (AI). Will we understand how this AI works? We may not understand the networks for us, with their weights and offsets, as they are automatically assigned. In the early years of AI research, people hoped that attempts at creating AI could also help us understand the principles underlying intelligence, and maybe even the workings of the human brain. However, in the end, it may turn out that we will not understand either the brain or the way AI works! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To deal with these questions, let us recall the interpretation of artificial neurons that I gave at the beginning of the chapter - that this is a way to weigh evidence. Suppose we want to determine if there is a person‚Äôs face in the image:</font></font><br><br><img src="https://habrastorage.org/webt/up/2e/af/up2eafnwrrpph5xdai4oapmgw8m.jpeg"><br><br><img src="https://habrastorage.org/webt/tu/8i/an/tu8ianduufnfebbjnqaibtzskyy.jpeg"><br><br><img src="https://habrastorage.org/webt/wf/tj/4j/wftj4j86hzytgwyypbw_eqk0jte.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This problem can be approached in the same way as handwriting recognition: using image pixels as input for the NA, and at the output of the NA there will be one neuron that says, ‚ÄúYes, this face‚Äù, or ‚ÄúNo, this is not a face ". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suppose we do this, but not using the learning algorithm. We will try to manually create a network by choosing the appropriate weights and offsets. How can we approach this? Forgetting the NA for a minute, we could break the task down into subtasks: does the image of the eyes have in the upper left corner? Is there an eye in the upper right corner? Is there a nose in the middle? Is there a mouth down in the middle? Do you have hair at the top?</font></font> And so on. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If the answers to several of these questions are positive, or even ‚Äúprobably yes‚Äù, then we conclude that there may be a face in the image. Conversely, if the answers are negative, then the person is probably not.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This, of course, is an approximate heuristic, and it has many shortcomings. Perhaps this is a bald man, and he has no hair. Perhaps we can see only part of the face, or face at an angle, so that some parts of the face are closed. And yet, heuristics say that if we can solve subtasks using neural networks, then perhaps we can create an NA for face recognition, combining networks for subtasks. The following is a possible architecture of such a network, in which rectangles indicate subnets. This is not a realistic approach to solving the problem of face recognition: it is needed to help us intuitively understand the work of neural networks. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/61b/dd0/ef6/61bdd0ef651ebc30afff87ed56204bd0.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the rectangles - subtasks: does the image of the eyes in the upper left corner? Is there an eye in the upper right corner? Is there a nose in the middle? Is there a mouth down in the middle? Do you have hair at the top?</font></font></i>  <i>And so on.</i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is possible that subnets can also be disassembled into components. Take the question of having an eye in the upper left corner. It can be disassembled into questions like: ‚ÄúIs there an eyebrow?‚Äù, ‚ÄúAre there eyelashes?‚Äù, ‚ÄúIs there a pupil?‚Äù And so on. Of course, the questions should contain information about the location - ‚ÄúIs the eyebrow located at the top left above the pupil?‚Äù, And so on - but let's simplify it for now. Therefore, the network that answers the question about the presence of an eye can be disassembled into components: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d87/871/6ff/d878716ff0ecad83cfa5b0e9c54a866e.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúIs there an eyebrow?‚Äù, ‚ÄúAre there eyelashes?‚Äù, ‚ÄúIs there a pupil?‚Äù</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">These questions can be further divided into small ones, step by step through many layers. As a result, we will work with subnets that answer such simple questions that they can be easily disassembled at the pixel level. These questions may concern, for example, the presence or absence of the simplest forms in certain places of the image. Individual neurons associated with pixels will be able to respond to them.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The result will be a network that breaks down very difficult questions - the presence of a face on the image - to very simple questions that can be answered at the level of individual pixels. It will do this through a sequence of many layers in which the first layers answer very simple and concrete questions about the image, and the latter create a hierarchy of more complex and abstract concepts. Networks with such a multi-layered structure ‚Äî two or more hidden layers ‚Äî are called deep neural networks (GNS).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of course, I didn‚Äôt talk about how to do this recursive subnetting. It is definitely impractical to manually pick weights and offsets. We would like to use training algorithms so that the network automatically learns weights and offsets - and through them hierarchies of concepts - based on training data. Researchers in the 1980s and 1990s tried to use stochastic gradient descent and backward propagation to train the STS. Unfortunately, with the exception of a few special architectures, they did not succeed. The networks were trained, but very slowly, and in practice it was too slow for it to be used in any way.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Since 2006, several technologies have been developed that allow teaching STS. They are based on stochastic gradient descent and back propagation, but contain new ideas. They allowed to train much deeper networks - today people quietly train networks with 5-10 layers. And it turns out that they solve many problems much better than shallow NAs, that is, networks with one hidden layer. The reason, of course, is that the STS can create a complex hierarchy of concepts. This is similar to how programming languages ‚Äã‚Äãuse modular schemes and ideas of abstractions so that they can create complex computer programs. Comparing a deep NA with a shallow NA is about how to compare a programming language that can make function calls to a language that does not. Abstraction in the NA looks not like in programming languages,but is of the same importance.</font></font></div><p>Source: <a href="https://habr.com/ru/post/456738/">https://habr.com/ru/post/456738/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../456722/index.html">PostgreSQL Recipes: Asynchronous Task Scheduler</a></li>
<li><a href="../456724/index.html">5 extremely simple ways to significantly increase the speed of your VueJS-application</a></li>
<li><a href="../45673/index.html">Everything we dreamed of for so long is the first official release of MySQL 5.1.</a></li>
<li><a href="../456732/index.html">To be a mentor</a></li>
<li><a href="../456736/index.html">PostgreSQL recipes: cURL: get, post and ... email</a></li>
<li><a href="../456744/index.html">10 problems that I solved with reminders on my smartphone</a></li>
<li><a href="../456746/index.html">Big data - big responsibility, big stress and big money</a></li>
<li><a href="../456748/index.html">Thermal printer 2003 from the flea market: what can he do in 2019?</a></li>
<li><a href="../456760/index.html">Crowdsourcing in ML Boot Camp. We consider mIOU without pictures for a new task from Odnoklassniki</a></li>
<li><a href="../456768/index.html">4 difficulties in localizing mobile games on the example of Fishing Clash - translation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>