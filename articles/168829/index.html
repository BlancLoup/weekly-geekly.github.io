<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>File Manager (Silex + Kendo UI) - Tutorial</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sudden story from the past! Here is how it was. Despite the fact that I am a programmer of ‚Äúa little different sense‚Äù, they turned to me with a standa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>File Manager (Silex + Kendo UI) - Tutorial</h1><div class="post__text post__text-html js-mediator-article">  Sudden story from the past!  Here is how it was.  Despite the fact that I am a programmer of ‚Äúa little different sense‚Äù, they turned to me with a standard request - to make a website.  I usually don‚Äôt undertake such cases, but this time I decided to earn some money, especially since it was not a business card site or an online store, but a normal site with a base of some objects, objects are added-edited-deleted (ala CRUD) and they need to perform some operations.  ABOUT!  I thought it was an ideal task for (the name of the framework is hidden) and after all kinds of bookkeeping I immediately set to work. <br><br>  Actually, nothing interesting and unusual has happened.  After some time, the site was shown to the customer.  And ... he was pleased.  Very unexpected completion of the story. <br><br>  True, there was a small request.  He didn‚Äôt like the file manager, the one with which the picture can be inserted into the article.  He wanted to make it somehow easier.  And here and buttons as much as 20!  Yes, and a lot of action.  All you need is to upload a picture to the server and paste it onto a page.  Well, well, I thought, their whole Internet, and I myself have made similar decisions many times.  But one is terrible, like hell, another one downloads one file at a time, but the third one is like that, but it‚Äôs paid.  In general, the story ended quickly, creating a simple file manager from scratch.  But somehow I sat there and felt sad.  And I drank (juice with pulp, of course).  And he opened the IDE and it started ... <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/170/010/5e0/1700105e01e30663ed5a452789198c95.png"><br><br>  I corrected the code, added a bunch of some features there and wrote this article in which I would try to tell, unlike heaps of manuals, to make a blog in any way, and how to make a file manager on the Silex + Kendo UI.  Without a database, without a browser and editors, and without other "husk". <br><br>  First, let me start by trying to explain why I chose these particular tools (frameworks). <br><br>  Silex is a microfogram, about which I have heard a review many times: ‚ÄúSo there is no nichrome in it!‚Äù.  But this is not true, Silex is a logical decision, but it was to take a huge Symfony2 and delete the vendors folder.  Totally.  After all, Composer was invented - a ‚Äútool‚Äù, about which many have already written, but he can, on the basis of the contents of the composer.json file, take and download the current versions of the necessary libraries (vendors).  We need ORM to access the database, we love the TWIG template engine, we want to store values ‚Äã‚Äãin redis.  Let's write the necessary in composer.json, execute the command php composer.phar install and now Silex is not so bad. <br>  But for the file manager, it is much better suited than some other bulky solutions. <br><br>  We need to decide what we need from silex: <br>  1) Of course, the solution on the popular framework itself is already good <br>  2) Work with sessions <br>  3) Work with answers (response and redirect) <br>  4) twig template engine <br>  I‚Äôll add a little why I love twig so much and strongly encourage others to use it.  I am not a layout designer, but very often I have to work in templates (view) in the usual form of php: i.e.  use php inserts.  ‚ÄúPhp is powerful, it's its own template maker!‚Äù - repeat the guys opposite.  So it is yes, but it is too powerful template engine.  Many times I caught myself thinking that I was writing logic in a template!  And this is absolutely impossible to do!  So twig makes you rethink the process of creating templates.  It is powerful enough to be able to do a lot, and at the same time it leaves the ideas to ‚Äúprogram‚Äù in the template. <br><br>  Well, okay, with the php framework decided - let it be.  Why kendo ui?  Is he big?  Well, yes, he really is not small.  But, in the first place that I did already use kendo, and secondly, the solution on this JS framework looks beautiful. <br>  What we need from kendo: <br>  1) <a href="http://demos.kendoui.com/web/window/index.html">window</a> <br>  2) <a href="http://demos.kendoui.com/web/splitter/index.html">splitter</a> <br>  3) <a href="http://demos.kendoui.com/web/upload/index.html">uploader</a> <br>  4) <a href="http://demos.kendoui.com/web/menu/index.html">menubar</a> <br>  5) <a href="http://demos.kendoui.com/web/treeview/index.html">treeview</a> <br>  By the way, if you take third-party js for such purposes, you‚Äôll get a solution that is not too small. <br><br>  Now I will try to describe the operation of the application.  I think you can read the code without me, so I‚Äôll focus on the things I consider more important. <br><br><h5>  Response </h5><br>  Symfony2 and of course Silex have a very convenient feature to work with - they allow you to manage outgoing (response) requests.  This application actively uses javascript, and js (in particular jquery ajax) can respond differently to the response from the application.  In other words, if the ajax function receives a normal response with code 200, it will respond this way, and if the error is different.  For example, the jquery function ajax can handle the onSuccess (answer 200 OK) and onError (not 200, but, for example, 500) methods (onSuccess and HeError recently done and fail).  And with the help of the vendor HttpFoundation \ Response, you can just send a response with the necessary code. <br><br>  Where it is used - we are trying to save the file (upload) in the file system.  But the system administrator, something there namudril, and instead of the user www-data folder became owned by the user root.  So, we can not save the file - not enough rights.  Let's write the resulting error into the $ this-&gt; error variable.  And in the handler function of the action (saving the picture), we do this: <br><br><pre><code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($save-&gt;handleUpload($sPath, $_thumbPath)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Response(<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Response($save-&gt;getError(), <span class="hljs-number"><span class="hljs-number">200</span></span>); }</code> </pre> <br><br>  Where, handleUpload is a function that saves the file, if the operation succeeds, it returns TRUE, otherwise FALSE. <br><br><h5>  Namespaces </h5><br>  Silex tries to use all the latest php, and in particular actively uses namespaces. <br>  In principle, you can use the usual include, but this is somehow not kosher.  We will use the method that Silex offers, and the latter, in turn, has recently shifted the function of ‚Äúregistration of the address space‚Äù to the composer. <br><br>  So.  In our file manager, we can distinguish two logical parts: <br>  1) work with the file system; <br>  2) saving files and generating thumbnails for images. <br>  Create two classes: class Files {} and class Save {}.  Each class will be in the same file in the folder: / src / Fm / Components.  In order for our application to understand where you need to download these files, we will write in composer.json: <br><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">"autoload"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"psr-0"</span></span>:{ <span class="hljs-string"><span class="hljs-string">"Fm"</span></span> : <span class="hljs-string"><span class="hljs-string">"src/"</span></span> } }</code> </pre><br><br>  And now execute the command: <br>  php composer.phar update <br><br>  Now you can use our classes, but before that we do not forget to declare them. <br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Fm</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Save</span></span> <span class="hljs-title"><span class="hljs-title">use</span></span> <span class="hljs-title"><span class="hljs-title">Fm</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Files</span></span></code> </pre><br><br>  You can appreciate the beauty of using namespaces only in a large application, but nevertheless, you should try to use the ‚Äúcorrect‚Äù methods.  After all, it often happens that if you neglect such a seemingly smallness, it may later turn out that the application has grown and it's too late to think about refactoring, and it is cheaper to rewrite it from scratch. <br><br><h5>  Depency injecting </h5><br>  The next feature of the Silex framework is the omnipresent Depency Injecting.  If you heard about it from Symfony2 it may seem that this is some kind of most terrible and muddy hnya, which is needed only in Entrprise.  And again, this opinion is not true. <br>  1) All DI texts are completely clumsy industrial translation from English documentation that was generated in phpDocumentaror <br>  2) People who work in this very Entrprise cannot speak in simple words or do not want to, because they know something.  IT Buddhists. <br><br>  I'll be back to DI.  The Files () class is used a lot in code.  If you work in the old fashioned way, then in every action you will have to create a new object Files ().  DI allows you to create an object only once: <br><br><pre> <code class="php hljs">$app[<span class="hljs-string"><span class="hljs-string">'files'</span></span>] = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Files(); };</code> </pre><br><br>  And later already have his copy referring to $ app ['files'].  But, it is important to remember that: <br><pre> <code class="php hljs">$app[<span class="hljs-string"><span class="hljs-string">'files'</span></span>]-&gt;getFiles($dir); <span class="hljs-comment"><span class="hljs-comment">//    private $_files; $app['files']-&gt;getFolderFiles(); //,   $_files;</span></span></code> </pre><br><br>  Will not work!  Because, you need to do this: <br><br><pre> <code class="php hljs">$class = $app[<span class="hljs-string"><span class="hljs-string">'files'</span></span>]; $class-&gt;getFiles($dir); <span class="hljs-comment"><span class="hljs-comment">//    private $_files; $class-&gt;getFolderFiles(); //,   $_files;</span></span></code> </pre><br><br>  In other words, each time $ app ['files'] is accessed, a new copy of the ‚Äúservice‚Äù will be created.  A new "service" can be created like this: <br><br><pre> <code class="php hljs">$app[<span class="hljs-string"><span class="hljs-string">'some_service'</span></span>] = $app-&gt;share(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Service(); });</code> </pre><br><br>  Then in the process of executing the application there will always be one copy of it. <br><br>  The file manager is laid out on <a href="https://github.com/Zazza/fm-silex-kendo">Github</a> . <br><br>  This article does not cover the kendo ui library.  In principle, if there is a desire - you can make a cursory inspection of it, with features that affect the topic of the file manager. <br><br>  <b>PS Although very few people read the topic - but still:</b> <br>  ckfinder is not free; <br>  elfinder is the manager who caused a stupor at the customer.  It has 24 buttons, no signatures, + actions on the right click; <br>  All these and many other FMs are written on another php, here is Silex, and the entire application logic is in: <br><br>  /index.php - 11kb <br>  /js/fm.js - 10 kb <br>  + "Models": <br>  /silex/src/Fm/Components/Files.php - 11 kb <br>  /silex/src/Fm/Components/Save.php - 3 kb </div><p>Source: <a href="https://habr.com/ru/post/168829/">https://habr.com/ru/post/168829/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../168811/index.html">.Net: we get Portable Library and UI</a></li>
<li><a href="../168813/index.html">Refinement completion Ricoh Dx2330</a></li>
<li><a href="../168817/index.html">My experience of introducing R or "I Love R"</a></li>
<li><a href="../168823/index.html">On the way to creating a secure web resource. Part 2 - Development</a></li>
<li><a href="../168827/index.html">Type conversion to Boost.Python. We do the conversion between the usual types of C + + and Python</a></li>
<li><a href="../168831/index.html">keyContentSwitcher - JS library for quick switch creation</a></li>
<li><a href="../168833/index.html">People and organizations that influenced the creation and development of the Internet</a></li>
<li><a href="../168835/index.html">Installing Fusion Drive in iMac 2010</a></li>
<li><a href="../168839/index.html">We exploit the vulnerabilities of wi-fi routers from an android device</a></li>
<li><a href="../168841/index.html">"Reader" returned to the App Store</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>