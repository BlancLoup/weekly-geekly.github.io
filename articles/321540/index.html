<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to fill 100 timeshits in 2 minutes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A post about why our programmers now do not fill in the timesheet 32, but only 2 minutes and how you can set up an automatic time tracking by importin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to fill 100 timeshits in 2 minutes</h1><div class="post__text post__text-html js-mediator-article">  A post about why our programmers now do not fill in the timesheet 32, but only 2 minutes and how you can set up an automatic time tracking by importing data from the TFS, Redmine and Jira tracking systems to Microsoft Project Server. <br><br><img src="https://habrastorage.org/files/634/f6a/250/634f6a25002a48a390c3a3d67e2d9956.png"><br><br>  The article will be of interest to project managers, heads of development companies, as well as programmers interested in the integration of various project management systems. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  The problem is mess in filling out the timesheets </h2><br>  For 99% of software development companies, working time accounting for programmers is needed as air to count costs. <a name="habracut"></a>  Therefore, many force employees to fill in timeshields (timesheet, a kind of - time sheet).  Often this means manually filling in a table with tasks and time spent on them. <br><br>  99% of programmers, to put it mildly, dislike this procedure.  Still, there is a great prospect for Friday evening - 30 minutes to sit and stupidly copy-paste all of your tasks for a week from the tracking program into timeshare.  And, as you know, when people do stupid and hated work, the result is so-so.  In our company, half the timeshats on Friday night were far from perfect.  What was it expressed in? <br><br>  First of all, the timeshields did not reflect all the ‚Äúcombat‚Äù tasks that were solved by the developers.  The programmer could write that just all 40 hours worked on such a project.  Or could tasks from one project be mistakenly attributed to a timesheet to another. <br><br>  To combat all this disorder, an excellent employee from the project office (a photo of which would undoubtedly embellish the article, but we still won't publish it) gently, but relentlessly pressing 100 people half a working day on Monday.  Then, according to a long check-list, I checked 1200 table rows of all timeshits.  And only by Tuesday the management had a complete picture. <br><br>  <b>Result:</b> with a delay of 3 working days, the managers finally received a report on the working time spent last week. <br><br><h3>  As it was.  The procedure for collecting timesheets. </h3><br>  <b>More than three days</b> <br><img src="https://habrastorage.org/files/6e3/129/297/6e31292971c24db19f5d1e74a7f609d2.png"><br><br><h3>  The solution is to automate the process of filling the timesheets. </h3><br>  The solution of the problem crystallized gradually.  We reasoned like that.  If a programmer fixes all his work in the tracker, then why not take data on tasks and the number of working hours directly from there?  This will allow you to quickly receive information for the analysis of labor costs, personnel workflow and other managerial tasks.  Then it was a matter of small things - to find a beautiful technological solution for integrating our trackers with a system in which we take into account working hours (Microsoft Project Server - read more about it <a href="https://habrahabr.ru/company/eastbanctech/blog/211222/">here</a> ). <br><br><h3>  As it became.  The timesheet filling procedure </h3><br>  <b>Up to 100 pieces in 2 minutes!</b> <b><br></b>  <b>The maximum data collection time is 2 hours and 10 minutes.</b> <br><img src="https://habrastorage.org/files/c22/8f1/178/c228f1178b4648388070e7ed941705cd.png"><br><br><h2>  What did we get? </h2><br>  A magic button appeared in MS Project Server, which allows you to do timeshift in 2 minutes.  You come on Friday in Project Server, it automatically builds timeshams according to the data from the tracker for the week.  There it remains to add only data about time off, vacation, sick leave, if there were.  And voila - you press the button, you confirm that everything is correct, and the timeshit is ready. <br><iframe width="560" height="315" src="https://www.youtube.com/embed/BFoCl5Asbng" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  I must say that the magic works only for those who observed the technology of project management in the tracker all week: fixed tasks, as well as planned and actual time for their implementation.  These good guys on Friday get a plus in karma and automatic time-filling. <br><br>  <b>Automatically completed timeshit</b> <br><img src="https://habrastorage.org/files/aa1/a98/177/aa1a981775024ce78d4fb4ad4bd6be2a.png"><br><br><h2>  Magic button bonuses </h2><br><h3>  1. Saved 200 working hours </h3><br>  If earlier an employee took 30-40 minutes to fill out the timesheets, now it's 2 minutes.  And if you count per 100 people per month, then we saved about 200 working hours. <br><br>  Here you can add another 32 working hours, which were spent on checking the correctness of filling of timesheets, instead of which now takes only 4 hours a month.  Saving time is explained simply: now real-time tasks are unloaded from trackers, and not those that people have hammered into their hands. <br><br><img src="https://habrastorage.org/files/172/73c/5e0/17273c5e005544d99efeca5152465b72.png"><br><br><h3>  2. We quickly get analytics on projects for the week </h3><br>  Now at 19:00 on Friday, 91% of timesheets are completely filled, and managers have an analyst of project labor costs at the end of the week.  Previously, by this time less than half had been collected. <br><br>  <b>Friday, 19:00</b>  <b>The number of fully completed timeshits</b> <br><img src="https://habrastorage.org/files/13c/246/2f1/13c2462f1e764fc88456217fb079cecc.png"><br><br><h3>  3. Consolidated standards for the management of all projects. </h3><br>  Now in all tracking systems all projects, clients and other data are designated uniformly.  Everywhere numbers on planned and actual time for performance of tasks are put down.  This reduces our risks and improves project manageability. <br><br><h3>  4. Simplified control over how project management technology is respected. </h3><br>  Previously, in order to understand how a project was being conducted, it was necessary to manually look into the tracker.  Now the control is done automatically when sending timeshit.  For example, if the status of tasks and the time for their execution are not set in Redmine, then these tasks simply will not be uploaded to the timesheet.  And vice versa, if the project office sees correctly filled timesheet - this confirms that its author has filled in all the fields in the tracking program. <br><br>  In fact, at the exit we received a reengineering of the entire business process.  Equipped the work as it is convenient for us, with our complex large projects. <br><br><h3>  5. We get analytics on any parameters already on Friday </h3><br>  If earlier the analyst for the last week came to the managers only on Tuesday-Wednesday, now already at the end of the current week, on Friday evening, 90% of the information on the timesheets is collected.  Based on its built OLAP-cube. <br><br>  How many bugs in a week have been fixed?  How many hours did each project take?  Where are the bottlenecks and why?  Analyze data is now possible more quickly.  But this is not the limit.  Next time we will talk about how you can get a summary of all projects from trackers in real time using the improved version of our OLAP-cube. <br><br>  And now the details, the meat and pieces of code. <br><br><h2>  Automate the business process step by step </h2><br><h3>  Step 1. Standardize project management in different tracking systems. </h3><br><img src="https://habrastorage.org/files/f01/460/747/f0146074781d42788438c47a27f70791.jpg"><br><br>  The challenge was that the company used three different trackers (project management systems) to manage projects that were different in terms of technology.  This is dictated by the requirements in terms of technology and the specifics of the projects themselves. <br><br><table><tbody><tr><td>  <b>Project management in development departments - specialized tracking systems</b> </td><td>  <b>Time tracking and analysis of business processes in the company</b> </td></tr><tr><td>  TFS is for Microsoft technology. </td><td rowspan="3">  Microsoft Project Server - a system for managing project portfolios </td></tr><tr><td>  Jira - projects in which the customer also uses the Jira system. </td></tr><tr><td>  Redmine - for the department of mobile technologies, Java-developers and designers. </td></tr></tbody></table><br>  Standards of project management in different trackers were slightly different.  For example, different workflows could be accepted for different projects.  Or, a complex project for the same customer could be called ‚ÄúMobile for a cool client N‚Äù in the mobile development department (in Redmine), and ‚ÄúN company‚Äôs internal website‚Äù in the web development department (in TFS). <br><br>  For integration, this whole zoo had to be combed - to ensure that the identical projects were given the same name in each system, the time of task execution was specified everywhere and the general reference methodology was applied. <br><br>  At the technology level, this required some features to be added to the trackers themselves.  For example, in TFS there is no column in which you can enter the number of hours that you spent on a task on a specific date. <br><br><h3>  Step 2. Write a page that imports entries in MS Project Server </h3><br>  We will tell you how to make such a page.  Outline a brief outline of what you need: <br><br><ol><li>  Add a button to MS Project. </li><li>  Log in to the tracking system and read data on labor costs from there. </li><li>  Display the received data to the user for verification. </li><li>  Write data to MS Project. </li></ol><br><h4>  2.1.  Little button. </h4><br>  Let's look at how you can extend the interface of MS Project Server.  Since, as everyone knows, MS Project Server runs on top of MS SharePoint Server, you can use the capabilities of the latter to add various elements to the MS Project interface.  In particular, we needed the user to start the import directly from the timesheet page.  To do this, you can add a special button in the Ribbon timesheet and associate it with the corresponding action.  In order to be able to deploy this in MS SharePoint, you need to create a Feature that contains a Custom Action type element. <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CustomAction</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"EBT.MSP.TimesheetSync.ImportFromRedmine.CustomAction"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Location</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CommandUI.Ribbon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Import data from RedMine"</span></span></span><span class="hljs-tag"> &gt;</span></span> ‚Ä¶ <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CustomAction</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Inside this CA, we define the appropriate extension. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CommandUIDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Location</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Ribbon.ContextualTabs.Timesheet.Home.Sheet.Controls._children"</span></span></span><span class="hljs-tag">&gt;</span></span> ‚Ä¶ <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CommandUIDefinition</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Actually, it's pretty well known. <br><br>  The only problem that can arise is how to calculate the mentioned Location.  We want the button to appear here. <br><br><img src="https://habrastorage.org/files/910/6f4/944/9106f4944f9646afb06542c7eaf6b7c3.png"><br><br>  There is not a lot of information on the Internet on this issue, therefore the main source of information is the pwaribbon file.  The file is quite large, but you can understand it.  After we have found the desired Location, everything is simple: <br><br>  Add a button to it. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"EBT.MSP.TimesheetSync.Import.ANCHOR.RedmineButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">LabelText</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Import from Redmine"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Image16by16</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/_layouts/15/EBT.MSP.TimesheetSync/img/rm_small.png"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Command</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"EBT.MSP.TimesheetSync.Import.ANCHOR.RedmineButton.Command"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">TemplateAlias</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"o1"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  And determine the appropriate command. <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CommandUIHandler</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Command</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"EBT.MSP.TimesheetSync.Import.ANCHOR.JiraButton.Command"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">CommandAction</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript:function ProjectCenterExtension() { var _grid; // Display surface (a view) of the JS Grid. var _satellite; // Control wrapper for the JS Grid. var props = window.timesheetComponent.get_TimesheetSatellite().get_impl()._pageProperties; window.location = '_layouts/15/EBT.MSP.TimesheetSync/ImportTimesheetData.aspx?ts=' + props.tsUid + '&amp;prd=' + props.prdUid + '&amp;datasource=jira_ebt'; }; ProjectCenterExtension();"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  As you can see from the above code, the command simply redirects the user to the appropriate page of type ApplicationPage.  This page we wrote ourselves.  Actually, inside of it, all further "dirty" things happen. <br><br>  Namely: <br><br><ol><li>  Authorization in the tracking system and data reading. </li><li>  Displays this data on the page so that the user can see what is added to his Timesheet. </li><li>  Record information in MS Project. </li></ol><br><h4>  2.2.  Reading data </h4><br>  There were two problems: <br><br>  1. How to log in to trackers to receive data. <br>  2. How to compare the MS Project user with the tracking system user. <br><br>  Globally, there are 2 approaches.  Looking ahead, we say that we had to apply both approaches for different trackers: <br><br><ul><li>  Create a certain superuser who can get all the data from the tracker.  And then try to match the user names of MS Project Server and trackers. </li><li>  "Forward" authorization from MS Project Server to the tracker.  There is an obvious plus here - the mapping is not necessary, you can simply get the user's records by his ‚Äúforwarded‚Äù account.  But with this and some problems, which a little later. </li></ul><br>  <b>Solution for Redmine and TFS</b> <br>  In our particular case, these trackers "live" in our infrastructure, so we decided to go the first way. <br><br>  In the case of Redmine, everything is simple - in Redmine there is a Log Work function that works exactly as it should.  That is, a person can enter the task and note how many hours he spent on the task of such and such a number. <br><br><img src="https://habrastorage.org/files/054/a39/a83/054a39a83408477f915516f81145e3b0.png"><br><br>  Next thing is to make a presentation in the Redmine database (Redmine uses MySQL), and everything is ready.  Problem solved, we can get data. <br><br>  In the case of TFS, things are a bit more complicated.  There is no such opportunity as in Redmine.  There are certain Add-Ins that give it, for example, <a href="http://www.tfs-timetracker.com/">www.tfs-timetracker.com</a> is an interesting thing, although not cheap. <br><br>  But it is possible to approach this task from an organizational point of view.  How?  In TFS there is a field Completed Work, in which developers must record the total hours spent on the task.  In Scrum-type project templates, this field is hidden, but it can be displayed.  Further, in the Work Item change history, you can track the change in this field and understand when the clock was added, when, by whom and how much time was spent.  Of course, this requires very tight work with the tracker from the developer.  He cannot report backdating time, but, nevertheless, if everything is done on time and accurately, then this approach works very well.  Moreover, it makes developers behave more disciplined. <br><br>  <b>Jira</b> <br>  In our case, JIRA is ‚Äúhosted‚Äù in a third-party environment.  Therefore, we do not have a superuser or access to its database.  But in JIRA there is a wonderful REST API that provides what you need ( <a href="https://docs.atlassian.com/jira/REST/cloud/">https://docs.atlassian.com/jira/REST/cloud/</a> ). <br><br>  To read data, you need to log in via OAuth.  After starting the import from JIRA, the person is redirected to the JIRA authorization page, authorized there (if the user has not been authorized yet), and then returns to the import page. <br><br>  (Unfortunately, JIRA only supports OAUTH 1, which is currently a bit old, but you can break through.) Having received the OAUTH token, we: <br><br>  1. We take out the name of the author method <br><br><pre> <code class="hljs">api/v2/myself</code> </pre><br>  And so no name matching is necessary, we just take the user who logged in to JIRA. <br><br>  2. Next, we look for all the tasks for which the user pledged time in a certain period. <br><br><pre> <code class="hljs pgsql">api/v2/myself/<span class="hljs-keyword"><span class="hljs-keyword">search</span></span>?jql=worklogDate&gt;={start_date} <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> worklogDate&lt;{end_date} <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> timespent&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> worklogAuthor={author}&amp;fields=<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>,project,parent,timeoriginalestimate,{pswa}&amp;startAt=<span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br>  At first glance, this is all that is needed, but not quite.  MS Project supports work in delegate mode, when a person does something on behalf of another, and our managers actively use it.  Certain collisions happen here, of course, because if person A personifies person B in MS Project (usually the manager is a subordinate, or the person in charge is an employee), then in JIRA he does not personify him, but remains himself.  And with such a request, he will receive tasks assigned to himself, that is, person A, who will be recorded in the timesheet person B. Moreover, unfortunately, there is no method (or we did not find it) to get all the tasks for all projects in which specified user has logged their work.  And that's not all - man A may not have at all in JIRA the appropriate authority to read the necessary tasks.  However, the last question can be solved organizationally. <br><br>  In order to sort through all the tasks, you must first get all the projects using the method: <br><br><pre> <code class="hljs cmake">api/v2/<span class="hljs-keyword"><span class="hljs-keyword">project</span></span></code> </pre><br>  Then run through all the projects and get all the tasks. <br><br><pre> <code class="hljs pgsql">api/v2/<span class="hljs-keyword"><span class="hljs-keyword">search</span></span>?jql=project={projectKey}&amp;fields=<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>,project,parent,timeoriginalestimate,{pswa}&amp;startAt=<span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br>  For each task found, get the pledged time and choose what falls in the right period and belong to the right author. <br><br><pre> <code class="hljs objectivec">api/v2/issue/{<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>}/worklog</code> </pre><br>  In this case, the problem of matching names again, of course, greets us cheerfully.  In addition, this process takes a lot of time.  Much better, probably, here and not come up with, however, if there is a better solution, they would be glad to hear. <br><br><h4>  2.3.  Display data. </h4><br>  There is nothing special to tell - the code on the good old ASP.Net, which draws the data. <br><br><h4>  2.4.  Writing data to the Timesheet </h4><br>  So, we went to a special page, logged in, got the necessary records, it remains to write them in MS Project.  In fact, MS Project has several types of APIs, but since we work inside it, we used the same one that the Project‚Äôs pages use.  This API looks, let's say, unusual. <br><br>  For example, to read a resource, you need to call a method. <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dataset = resourceSvc.<span class="hljs-type"><span class="hljs-type">ReadResource</span></span>(userId);</code> </pre><br>  And this is quite understandable, but then you have to spend a lot of time trying to figure out where the label, row and column is in this DataSet.  There are quite a few documentation on this issue and, to be honest, we have not found a single example of adding Timesheet Lines to the Timesheet working with this API.  But, digging into the "gut" of MS Project Server using ILSPY, we finally wrote the following code: <br><br><pre> <code class="hljs pgsql">private <span class="hljs-type"><span class="hljs-type">void</span></span> ReportTime(Guid timeSheetId, List&lt;TaskData&gt; tasks, Guid projectId) { var timesheetDs = _timeSheetSvc.ReadTimesheet(timeSheetId); TimesheetDataSet.LinesRow[] <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> = (TimesheetDataSet.LinesRow[])timesheetDs.Lines.<span class="hljs-keyword"><span class="hljs-keyword">Select</span></span>(); <span class="hljs-type"><span class="hljs-type">bool</span></span> needUpdate = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (var task <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tasks) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!task.Estimation.HasValue &amp;&amp; !task.IgnoreEstimation) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; Guid taskId = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Guid(task.Id); Guid assnId = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Guid(task.AssnId); <span class="hljs-type"><span class="hljs-type">bool</span></span> isRowExist = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (var <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>.ASSN_UID != assnId) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; isRowExist = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; AddActual(timesheetDs, task, <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!isRowExist) { TimesheetDataSet.LinesRow <span class="hljs-type"><span class="hljs-type">line</span></span> = timesheetDs.Lines.NewLinesRow(); <span class="hljs-type"><span class="hljs-type">line</span></span>.TS_UID = timeSheetId; <span class="hljs-type"><span class="hljs-type">line</span></span>.TASK_UID = taskId; <span class="hljs-type"><span class="hljs-type">line</span></span>.PROJ_UID = projectId; <span class="hljs-type"><span class="hljs-type">line</span></span>.ASSN_UID = assnId; <span class="hljs-type"><span class="hljs-type">line</span></span>.TS_LINE_CACHED_ASSIGN_NAME = task.Name; <span class="hljs-type"><span class="hljs-type">line</span></span>.TS_LINE_UID = Guid.NewGuid(); <span class="hljs-type"><span class="hljs-type">line</span></span>.TS_LINE_CLASS_UID = PSLibrary.TimesheetConst.const_StandardLineClassGuid; <span class="hljs-type"><span class="hljs-type">line</span></span>.TS_LINE_STATUS = (byte)LineStatus.Pending; <span class="hljs-type"><span class="hljs-type">line</span></span>.TS_LINE_VALIDATION_TYPE = (byte)ValidationType.Verified; timesheetDs.Lines.AddLinesRow(<span class="hljs-type"><span class="hljs-type">line</span></span>); _timeSheetSvc.PrepareTimesheetLine(timeSheetId, <span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> timesheetDs, <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Guid[] { <span class="hljs-type"><span class="hljs-type">line</span></span>.TS_LINE_UID }); AddActual(timesheetDs, task, <span class="hljs-type"><span class="hljs-type">line</span></span>); } needUpdate = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (needUpdate) { Guid jobUid = Guid.NewGuid(); _timeSheetSvc.QueueUpdateTimesheet(jobUid, timeSheetId, timesheetDs.GetChanges() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> TimesheetDataSet); TaskUtils.WaitForQueue(_queueSvc, jobUid); } }</code> </pre><br>  This code, in fact, writes the necessary data in MS SharePoint.  To be honest, the problems with working with MS Project were the most.  About this you can write a whole separate article. <br><br><h3>  Step 3. Rollback technology on a test group of users. </h3><br>  We implemented a ‚Äúmagic button‚Äù separately for each tracker, each time covering ~ 30% of employees, and each time before a full launch, we trained on a small group of 3-5 ‚Äúexperimental‚Äù users, with whom we went through the whole process in a calm atmosphere before the production ready state, in order not to get a flurry of questions and indignation on Friday night from 30 people at once. <br><br><img src="https://habrastorage.org/files/88a/f07/22a/88af0722a59e4dda815b5b9af24a3199.png"><br><br><h3>  Step 4. Gather feedback </h3><br>  What do EastBanc Technologies employees say about the ‚Äúmagic button‚Äù for filling out the timesheets <br><br><img src="https://habrastorage.org/files/fdb/064/aea/fdb064aeadb640afba715831aef89987.jpg"><br>  <b>Yury Bulkin, chief Java architect</b> . <br><br>  The fire!!!  When I first pressed the button and immediately saw the timeframe completely filled - I just did not believe my eyes.  I have been told many times that everything will happen this way.  And I understood how it should look.  But when I myself received the timeshit automatically filled with twenty tasks, it was so cool that I only realized the convenience of this thing. <br><br><img src="https://habrastorage.org/files/735/0e7/281/7350e728104c41548594818210cbbcd1.png">  <b>Alexandra Ocheretinskaya, head of the project office</b> . <br><br>  We understood that the fact that we are on Friday forcing programmers to fill in time-sheets is an unprofitable, non-intellectual activity.  We require you to manually enter information that already exists, just in another place and in another form.  And we can save people from this unnecessary work.  If people, in any case, are already working on tasks that are set up in trackers, then why not just upload this information for accounting?  So we did. <br><br><img src="https://habrastorage.org/files/675/fde/ddb/675fdeddba79402c9b2d66e1ebdacc5a.png">  <b>Maxim Podusov, software engineer</b> . <br><br>  The process of filling in timesheets has become much faster, about 30 minutes ... It used to be 32 minutes, and now it's only 2 minutes. <br><br><img src="https://habrastorage.org/files/d9d/7df/102/d9d7df102b264f8f8211dce7c6332573.png">  <b>Vasily Lebedev, leading software engineer</b> . <br><br>  Cool!  Less duplicate work, more detailed task.  You look, and the time-sheets in time will start to start.  :) <br><br><img src="https://habrastorage.org/files/73d/48d/93d/73d48d93d2d34d558338a14e0af171c9.png">  <b>Irina Manannikova, Project Manager</b> <br><br>  Specifically, in my work, I got rid of the monotonous, routine manual process of weekly testing of timesheets (labor costs).  The speed of filling in timesheets is a nice bonus.  And the main goal was to quickly get a transparent and clear picture of the projects in the trackers.  The goal has been achieved, at the end of each week we have almost 100% relevant information on each project following the results of the last week. <br><br><h3>  Step 5. Profit! </h3><br>  We enjoy life and effectively use the released time. <br><img src="https://habrastorage.org/files/a1d/ae3/f03/a1dae3f0321f45a28ae1235eeb1541e0.gif"></div><p>Source: <a href="https://habr.com/ru/post/321540/">https://habr.com/ru/post/321540/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../321526/index.html">Security Week 06: SCADA open passwords, SMB vulnerability, Google Apps token</a></li>
<li><a href="../321530/index.html">MIPSfpga and SDRAM. Part 1</a></li>
<li><a href="../321532/index.html">MIPSfpga and SDRAM. Part 2</a></li>
<li><a href="../321534/index.html">How to get the top five using data analysis?</a></li>
<li><a href="../321538/index.html">VxRail Hyper Converged Devices</a></li>
<li><a href="../321542/index.html">PIC Controller Programming Tools</a></li>
<li><a href="../321544/index.html">Events and streams. Part 1</a></li>
<li><a href="../321546/index.html">C # language is almost functional</a></li>
<li><a href="../321548/index.html">How smart contracts will change our lives</a></li>
<li><a href="../321550/index.html">It's hard to be a junior</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>