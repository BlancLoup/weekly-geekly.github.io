<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Rethinking markup. First steps with Gantry 5</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Competent layout layout on CMS WordPress is an important task (after several projects it became clear to me that this takes a lot of time). To speed u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Rethinking markup. First steps with Gantry 5</h1><div class="post__text post__text-html js-mediator-article">  Competent layout layout on CMS WordPress is an important task (after several projects it became clear to me that this takes a lot of time).  To speed up the process, I started looking for a framework for writing WordPress themes.  About Gantry 5 found out from a colleague who runs sites on Joomla.  He said that there is an engine that can work, as well as on WordPress, and on Joomla (and for some time on Grav).  So I decided to learn more about it.  After all, you will agree that it is good: to work with one system and, switching to another, continue to use the same tools. <br><br>  Almost nothing was found in the Russian part of the Internet - neither reviews, nor documentation, and the articles were superficial.  The only complete information - only on the official site. <br><br>  After reading everything I could find on the Russian-language Internet and partially the documentation, I decided to study Gantry 5. Using twig as a template maker, and storing configs in the yaml format became an additional advantage (since I had been looking for symfony for a long time, but I couldn‚Äôt find the time ). <br><img src="https://habrastorage.org/getpro/habr/post_images/c71/6b1/597/c716b15976e6da3c17c1eacaca3cd1da.jpg" alt="image"><br><a name="habracut"></a><br><h3>  <b>Opportunities</b> </h3><br>  There are several articles about the main features of Gantry 5. They describe them in insufficient detail, but what is responsible for what can be understood (albeit from the user's point of view).  Alas, about how to build a template, they did not find a single line.  Therefore, I will try to describe the tools, based on the development of the topic. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  <b>Basic terms</b> </h3><br>  <b>Particle</b> is the main building material.  Easier - this is 1 module.  They are of three types: <br><br><ul><li>  <b>Standard particle</b> - modules that allow you to display data on the page, taking into account the parameters of the particle itself (what data it will output, depends on the particle itself). </li><li>  <b>Position</b> - particles that contain basic information returned by the system in the query.  For example, the text of the article or a list of goods store. </li><li>  <b>Atoms</b> - hidden items, scripts.  For example, Google Analytics. </li></ul><br>  Gantry 5 uses a large number of native field types.  You can get acquainted with their list and functionality here (alas, only English documentation) <br><br><h3>  <b>File Structure (Hydrogen)</b> </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/3d2/80c/01e/3d280c01e814345b6fdcf9f264842499.png" alt="image"><br><br>  Hydrogen is a basic Gantry 5 template that can be downloaded <a href="http://gantry.org/downloads">here</a> .  Talking about the structure of the template, I will focus on it (you should create your own templates according to the given image and likeness). <br><br>  <b>/ admin /</b> - redefinition of system files (highly discouraged) and some materials that can be used in the admin area (for example, images). <br><br>  <b>/ blueprints /</b> - directory can contain three directories style, content, page. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bd7/171/e4e/bd7171e4eda43ad68830f3660769d5f5.png" alt="image"><br><br>  Here, files with the .yaml extension store data about the fields, information from which can later be used as variables when compiling scss or for controlling a template. <br><br>  <b>/ config /</b> - like some configs, but how many did not try to experiment, could not determine for what they are and what role they carry. <br><br>  <b>/ fonts /</b> - fonts to be used.  By default, Gantry 5 pulls them from Google.  To avoid this, you can put used fonts here. <br><br>  <b>/ gantry /</b> - directory where theme description files are stored in .yaml format (theme description and color scheme variations). <br><br>  <b>/ images /</b> - directory with images of the theme, they can be used to customize the theme. <br><br>  <b>/ includes /</b> - directory with files responsible for the interaction of the theme with Gantry 5. <br><br>  <b>/ install /</b> - long tried to understand what configs in this directory are responsible for.  From the content it seems that this is a description of the markup that is created in the subject when it is installed at the time of activation. <br><br>  <b>/ layouts /</b> - directory for storing markup templates.  By default, there are 3 mandatory templates ‚ÄúBody only‚Äù, ‚ÄúError‚Äù and ‚ÄúOffline‚Äù. <br><br>  <b>/ particles /</b> - directory for storing your own particles.  To define a new particle, it must contain 2 files {name} .yaml and {name} .html.twig.  The first describes the configuration of the particle, the second is responsible for its render. <br><br>  <b>/ scss /</b> - directory for scss files that Gantry 5 will compile. <br><br>  <b>/ views /</b> - directory with twig templates. <br><br><h3>  <b>How to create a template</b> </h3><br>  On the Internet I could find <i><b>2 ways to</b></i> work with templates on Gantry 5: <br><br><ol><li>  Create a child theme based on the lightweight Hydrogen, which was developed by the RocketTheme themselves.  This way they propose to use. </li><li>  Describe the entire topic within the / custom / directory, which appears after the first save of the Hydrogen topic.  This directory is not updated when a new version of the topic is released, and its data will not be lost.  But I consider it unprofessional, because / custom / is essentially a cache of our data, all our settings are saved there.  It turns out that in fact the work goes in temporary storage, and it‚Äôs somehow ugly to give such a customer. </li></ol><br>  Thanks to the old adage (if you want to do well, do it yourself) the <i><b>third way</b></i> was chosen <i><b>.</b></i> <i><br></i> <br>  I created a separate clean topic and taught her how to work with Gantry 5 (the benefit is not very difficult).  In addition, this approach has an advantage: I stitched the <a href="http://tgmpluginactivation.com/">TGM Plugin Activation</a> theme, turned on the Gantry 5 plugin and made it mandatory.  Thus, when the theme is activated, the necessary plug-in will be installed immediately (plus, you can put a lot more useful here). <br><br><h3>  <b>Let's start in order</b> </h3><br>  <b>Initialization</b> <br><br>  Create a directory for the WP theme and there are three files in it <b>index.php</b> , <b>style.css</b> , <b>functions.php</b> .  We copy from the hydrogen theme the folders <b>includes</b> and <b>gantry</b> (there are two files in this directory - one with persets, the second with theme options, use them as the basis for describing our configs).  In the <b>style.css we</b> initialize the theme, and add the following code to the <b>functions.php</b> file: <br><br><pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//*****************************// //Gantry //*****************************// { //    Gantry 5 $requiredGantryVersion = '5.4.0'; //   Gantry 5 $gantry_include = get_stylesheet_directory() . '/includes/gantry.php'; //           if ( ! file_exists( $gantry_include ) ) { $gantry_include = get_template_directory() . '/includes/gantry.php'; } $gantry = include_once $gantry_include; if ( ! $gantry ) { return; } //    Gantry if ( ! $gantry-&gt;isCompatible( $requiredGantryVersion ) ) { $current_theme = wp_get_theme(); $error = sprintf('Please upgrade Gantry 5 Framework to v%s (or later) before using %s theme!', strtoupper( $requiredGantryVersion ), $current_theme-&gt;get( 'Name' ) ); if ( is_admin() ) { add_action( 'admin_notices', function () use ( $error ) { echo '&lt;div class="error"&gt;&lt;p&gt;' . $error . '&lt;/p&gt;&lt;/div&gt;'; }); } else { wp_die( $error ); } } /** @var \Gantry\Framework\Theme $theme */ $theme = $gantry['theme']; //              $helpers = array( 'includes/helper.php', //        ); foreach ( $helpers as $file ) { if ( ! $filepath = locate_template( $file ) ) { trigger_error( sprintf( 'Error locating %s for inclusion', $file ), E_USER_ERROR ); } require $filepath; } }</span></span></code> </pre> <br>  After that, the theme will already work with Gantry 5. <br><br>  Yes, I collected the topic myself, but I studied at Hydrogen and used it as a base.  And now I'm sure in the subject and its efficiency, I know where to look, if something breaks. <br><br>  <b>Development mode</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2e4/570/76f/2e457076f0bad37f1173a4e0fea6872c.png" alt="image"></div><br>  The first thing you should pay attention to when opening the administrative panel of Gantry 5, is the developer mode.  When developing a theme, it should always be included. <br><br>  Gantry 5 incorporates the scss preprocessor, which allows you to compile style files on the fly.  Moreover, the compilation is designed in such a way that the preprocessor can use Gantry 5 field values ‚Äã‚Äãas variables. For example, in /blueprints/styles/body.yaml there is a field responsible for color, and you need to change the background from the body with it.  In scss code is written: <br><br><pre> <code class="css hljs">//      <span class="hljs-selector-tag"><span class="hljs-selector-tag">body</span></span>   ,     //      $<span class="hljs-selector-tag"><span class="hljs-selector-tag">body-color-1</span></span>: <span class="hljs-selector-id"><span class="hljs-selector-id">#ffffff</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">body</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: $body-color-<span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre><br>  When compiling, if the admin color is set, the background will be repainted into it, if not, the default one set in our file will be used. <br><br>  If it is necessary to use such settings in particles, they should be specified in the twig-pattern of the particle through the style attribute. <br><br>  Ideally, there should be as many configuration fields as there are variables involved in the scss file.  This will create a highly customizable theme. <br><br>  In addition, Gantry 5 allows you to create several predefined color styles.  There is nothing to add: one scheme is chosen - the colors are one, another is chosen - the colors change. <br><br>  So, when compiling, Gantry 5 creates a css-file that it uses in the future (in development, it is inconvenient to constantly re-compile the file, as many actions are required).  This is what the development mode is for.  Every time he refreshes the page, he collects a new style file. <br><br>  The second advantage of the design mode are error messages and more complete information about them.  For example, if it is not possible to output the template file .twig or other problems arise, Gantry 5 will notify you about it and tell you what's broken. <br><br>  <b>Markup Templates</b> <br><br>  Adaptability in Gantry 5 is built on the Nucleus markup system.  Style files are located at ‚ÄúROOT / wp-content / plugins / gantry5 / engines / nucleus /‚Äù.  In the template, in scss it is necessary to include 4 files: <br><br><pre> <code class="css hljs">@<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"vendor/bourbon/bourbon"</span></span>; @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"configuration/nucleus/base"</span></span>; @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"nucleus/functions/base"</span></span>; @<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"nucleus/mixins/base"</span></span>;</code> </pre><br>  At the same time, it is not necessary to override them; they will be pulled from the plugin when compiled. <br><br>  Thanks to the previously connected styles, you can create page layout templates for the subsequent layout of particles on them. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c2f/fb3/727/c2ffb3727dd1c74917d34c74b50c87e9.png" alt="image"><br><br>  The markup templates are described in the <b>{theme directory} / layouts directory</b> .  After configuring the page layout, the template appears in the Administrative Panel, and it can be used to compose particles. <br><br>  Here is an example of the <b>default.yaml</b> template description: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">version</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> # preset: image: gantry-<span class="hljs-keyword"><span class="hljs-keyword">admin</span></span>://images/layouts/<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>.png //   /<span class="hljs-keyword"><span class="hljs-keyword">admin</span></span>/ #   .        layout: /<span class="hljs-keyword"><span class="hljs-keyword">header</span></span>/: - [logo <span class="hljs-number"><span class="hljs-number">30</span></span>, position-<span class="hljs-keyword"><span class="hljs-keyword">header</span></span> <span class="hljs-number"><span class="hljs-number">70</span></span>] /navigation/: - menu /main/: - position-breadcrumbs - <span class="hljs-keyword"><span class="hljs-keyword">system</span></span>-messages - <span class="hljs-keyword"><span class="hljs-keyword">system</span></span>-content /footer/: - position-footer - [copyright <span class="hljs-number"><span class="hljs-number">40</span></span>, spacer <span class="hljs-number"><span class="hljs-number">30</span></span>, branding <span class="hljs-number"><span class="hljs-number">30</span></span>] offcanvas: - mobile-menu</code> </pre><br>  One important feature should be noted - the inheritance of particle parameters from one markup template to another.  By default, there is a basic markup.  It also sets up the main parts - for example, the menu, the cap, the basement.  And in other templates, these elements can be inherited (but if necessary, inheritance can be turned off). <br><br>  <b>More about particles</b> <br><br>  When installing the Gantry 5 plugin, 11 particles, 5 positions, 4 preset atoms are available by default.  If we are not satisfied with their behavior, we can always redefine them and teach them what we need. <br><br>  <b>Simple particles</b> <br><br>  The particle itself is a separate independent module that can be displayed anywhere on the page template. <br><br>  In most cases, the usual set of particles is enough, but what if you need to create something unlike any particle (for example, the output of an address or phone)?  All you need to do is create two files in the particles directory (for example, <b>phone.yaml</b> and <b>phone.html.twig</b> ).  The first describes the configuration of the particle, the second - the output pattern.  In <b>phone.yaml,</b> you must describe the particle, indicate its name, description, type of <b>particle</b> ( <b>atom</b> , <b>position</b> ) and icon ( <a href="http://fontawesome.io/">Font Awesome</a> ). <br><br>  As for positions and atoms, they should not be redefined.  If you need a similar particle, it is better to copy and create a new one on its basis. <br><br><h3>  <b>General impressions</b> </h3><br>  Responsiveness, particles, a comfortable admin panel, interesting solutions, high speed of work (because all configs are stored in files), the ability to work on WordPress, Joomla, Grav and technologies that would not seem to be used in WordPress made this framework just a discovery . <br><br>  After an in-depth acquaintance with technology, I don‚Äôt understand why so little is known about it. <br><br>  At the moment, the only disadvantages of Gantry 5 that I was able to see are the English documentation (although which side to look at) and the lack of information about the framework in our segment of the Internet. <br><br><h3>  <b>Small conclusion</b> </h3><br>  I understand that this article does not say too much, but if you go into the details of the design and operation of each aspect of Gantry 5, perhaps it will turn out too long.  I intend to study the topic thoroughly and continue the conversation. </div><p>Source: <a href="https://habr.com/ru/post/325744/">https://habr.com/ru/post/325744/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325732/index.html">From developers - to Solution Architects: the story of one transformation</a></li>
<li><a href="../325734/index.html">Setting up backup of information in the cloud Microsoft Azure Backup</a></li>
<li><a href="../325736/index.html">9th MSK.NET Community Meeting</a></li>
<li><a href="../325738/index.html">Why a lot of JOIN in the query is bad or do not interfere with the optimizer</a></li>
<li><a href="../325740/index.html">IT Events Calendar for April '17</a></li>
<li><a href="../325746/index.html">Repair remote server after removing part of OS</a></li>
<li><a href="../325748/index.html">Games and the cloud. Myths and reality. We expect a heated discussion on April 12. Come virtually</a></li>
<li><a href="../325752/index.html">A bug in Telegram VoIP, which allows you to find out the address of the interlocutor</a></li>
<li><a href="../325756/index.html">Evolution on React + Redux</a></li>
<li><a href="../325758/index.html">Petri net with symfony a la WorkFlow component</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>