<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Meteor. And now loading photos</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It's very simple (yeah, when there is an example). 

 [ demo ] - multiboot with progress bars, registration is required. 
 [ source ] - comments on th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Meteor. And now loading photos</h1><div class="post__text post__text-html js-mediator-article">  It's very simple (yeah, when there is an example). <br><br>  [ <a href="http://demo-cfs.meteor.com/">demo</a> ] - multiboot with progress bars, registration is required. <br>  [ <a href="https://github.com/comerc/meteor-demo-cfs">source</a> ] - comments on the code below. <br><a name="habracut"></a><br>  <b>one)</b> <br>  Start Meteor. <br><pre><code class="bash hljs">$ meteor create meteor-demo-cfs $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> meteor-demo-cfs $ meteor</code> </pre>  In order not to interfere with the terminal screen, I run in the console [ctrl] + [alt] + [f4];  switch back by [ctrl] + [alt] + [f7].  This is in Ubuntu. <br><br>  <b>2)</b> <br>  I edit ./meteor/packages - gentlemen's set of packages. <br><pre> <code class="bash hljs">meteor-platform coffeescript less mquandalle:jade accounts-password ian:accounts-ui-bootstrap-3 twbs:bootstrap cfs:standard-packages cfs:filesystem cfs:gridfs cfs:ui</code> </pre>  Meteor will deliver everything as soon as the file is saved. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>3)</b> <br>  I delete the tops - all files from the project root (.js, .html, .css).  Adding: main.coffee, main.jade, main.less. <br><br>  <b>four)</b> <br>  main.coffee <br><pre> <code class="coffeescript hljs"><span class="hljs-comment"><span class="hljs-comment">#    cl = (something) -&gt; console.log(something) #    config = admin: email: 'demo@example.com', password: '12345678' if Meteor.isServer Meteor.startup -&gt; if Meteor.users.find().count() is 0 seedUserId = Accounts.createUser email: config.admin.email, password: config.admin.password # photoStore -    ,    # https://github.com/CollectionFS/Meteor-CollectionFS#storage-adapters if Meteor.isClient # photoStore = new FS.Store.FileSystem 'photos' photoStore = new FS.Store.GridFS 'photos' if Meteor.isServer # photoStore = new FS.Store.FileSystem 'photos' photoStore = new FS.Store.GridFS 'photos', # mongoUrl: 'mongodb://127.0.0.1:27017/test/', # optional, defaults to Meteor's local MongoDB # mongoOptions: {...}, # optional, see note below # transformWrite: myTransformWriteFunction, # optional # transformRead: myTransformReadFunction, # optional # maxTries: 1, # optional, default 5 # chunkSize: 1024*1024 # optional, default GridFS chunk size in bytes (can be overridden per file). # # Default: 2MB. Reasonable range: 512KB - 4MB {} #    Photos = new FS.Collection 'photos', stores: [photoStore] filter: allow: contentTypes: ['image/*'] # allow only images in this FS.Collection #    https://github.com/CollectionFS/Meteor-CollectionFS#security Photos.allow insert: (userId, file) -&gt; userId and file.metadata?.userId is userId update: (userId, file, fieldNames, modifier) -&gt; userId and file.metadata?.userId is userId remove: (userId, file) -&gt; userId and file.metadata?.userId is userId download: (userId, file, shareId) -&gt; true fetch: ['metadata.userId', 'original'] if Meteor.isClient #     newUpload = [] Meteor.startup -&gt; Tracker.autorun -&gt; if not Meteor.userId() # reset,     newUpload = [] Template.hello.events 'change input[type="file"]': (event, template) -&gt; # FileAPI http://caniuse.com/#search=fileapi #  http://habrahabr.ru/company/mailru/blog/201010/ files = event.target.files count = files.length i = 0 while i &lt; count newFile = new FS.File(files[i]) #      https://github.com/CollectionFS/Meteor-CollectionFS#add-custom-metadata-to-a-file-before-inserting newFile.metadata = userId: Meteor.userId() Photos.insert newFile, (error, file) -&gt; throw error if error # If !error, we have inserted new doc with ID file._id, and # kicked off the data upload using HTTP cl file i++ Template.hello.helpers #    mongo- photos: -&gt; Photos.find() #    progress-bar isNewUpload: -&gt; if newUpload.indexOf(this._id) + 1 return true unless this.isUploaded() newUpload.push(this._id) return true return false #    http://ru.discovermeteor.com/chapters/publications-and-subscriptions/ if Meteor.isServer Meteor.publish 'photos', (limit) -&gt; check(arguments, [Match.Any]) [ Photos.find({}, {limit: limit}) ] if Meteor.isClient Meteor.subscribe 'photos', 100</span></span></code> </pre><br><br>  <b>five)</b> <br>  I publish. <br><pre> <code class="bash hljs">$ meteor deploy demo-cfs.meteor.com</code> </pre><br><br>  <b>Stsylki.</b> <br><ul><li>  The minimum set to start CoffeeScript: <br><ul><li>  <a href="http://cidocs.ru/coffeescript/">coffeescript.org</a> </li><li>  <a href="https://github.com/andrew--r/the-little-book-on-coffeescript">The Little Book on CoffeeScript</a> </li><li>  <a href="http://js2coffee.org/">js2coffee.org</a> </li></ul></li><li>  <a href="http://jade-lang.com/">Jade</a> - speed layout.  Less coding, more COD. </li><li>  <a href="http://lesscss.org/">Less</a> - speed css.  Less coding, more COD. </li><li>  About <a href="http://jsman.ru/mongo-book/">MongoDB</a> . </li><li>  About <a href="https://github.com/CollectionFS/Meteor-CollectionFS">Meteor-CollectionFS</a> . </li><li>  About <a href="http://ru.discovermeteor.com/">Meteor</a> . </li><li>  <a href="https://atom.io/">Atom</a> is a great tool for coding Meteor from the creators of GitHub.  Optional packages: Stylus, Sublime-Style-Column-Selection, language-jade, meteor-snippets, todo-show. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/248875/">https://habr.com/ru/post/248875/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../248863/index.html">Clustering: tell me what you buy and I will tell you who you are</a></li>
<li><a href="../248867/index.html">Interview: CISSP, CISA, SecurityPlus and other words that only IT security experts can understand</a></li>
<li><a href="../248869/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ144 (January 19 - 25, 2015)</a></li>
<li><a href="../248871/index.html">Runscript - utility to run python scripts</a></li>
<li><a href="../248873/index.html">Skyforge rendering technology</a></li>
<li><a href="../248879/index.html">Boost.DI: dependency injection in C ++</a></li>
<li><a href="../248881/index.html">Overview Friendly interactive shell (fish) and why it is better than bash</a></li>
<li><a href="../248887/index.html">Hacking a bitcoin exchange on Rails</a></li>
<li><a href="../248889/index.html">‚ÄúOpen Financial Data: Possibilities for Using It‚Äù</a></li>
<li><a href="../248891/index.html">Do not rush to throw out the old servers, you can assemble fast Ethernet-storage in an hour</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>