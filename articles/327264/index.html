<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Everything is bad</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Well, everything is bad. It‚Äôs a little fun to say this: at the conference ( Web √† Qu√©bec ) there was a lot of talk about a wonderful future and things...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Everything is bad</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/getpro/habr/post_images/742/57b/896/74257b896a83d16bc00409578b4cd7f4.jpg" alt="image"></p><br><p>  Well, everything is bad.  It‚Äôs a little fun to say this: at the conference ( <a href="https://webaquebec.org/programmation/tout-est-terrible">Web √† Qu√©bec</a> ) there was a lot of talk about a wonderful future and things possible thanks to new technologies.  On new tools and devices that should make our lives easier.  My friends know that I usually have a very cynical view of technology;  I personally fear all these smart devices that respond to my words, what other speakers admired. </p><br><p>  Mainly because the more time I spend on programming and spend in this industry, the more I learn how everything works from the inside, and the less trust all this inspires in me.  I picked up the image for the slide.  This is the painting "The Triumph of Death" by Peter Bruegel.  To some extent, she reveals my attitude to the "smart home". </p><a name="habracut"></a><br><p><img src="https://habrastorage.org/getpro/habr/post_images/2bf/2e0/de3/2bf2e0de3f3b772d2efdf77d4ad11e31.png" alt="image"></p><br><p>  I want to show that having even a very simple application that looks very, very reasonable, and show a lot of problems and potential errors that can hide in it and unpleasantly surprise us.  I want to demonstrate that it‚Äôs hard to really feel safe when it comes to code.  It will be a scary story! </p><br><p><img src="https://habrastorage.org/files/3e7/833/aaf/3e7833aafb9841139c222f068ef7f148.png" alt="image"></p><br><p>  To reveal my point of view, I will start with a basic application familiar to any developer in this room.  Here I have a small web application.  On the right - users, using their devices, connect to my frontend, executing code written in some language and responsible for the application logic.  There is a connection to the database where the information is stored.  Next - cron, it is needed for a number of background tasks, perhaps, not particularly difficult.  Then comes the cloud, which is probably used by many other components of the system.  Maybe you store images in S3 or something else. </p><br><p>  So, this is a reasonable application, but there will be problems easily in it: if any mechanism fails, the whole system ceases to function correctly.  Instead, we consider the following: </p><br><p><img src="https://habrastorage.org/files/a37/4bf/21a/a374bf21ae3d4c0fb1b234377860a01a.png" alt="image"></p><br><p>  Such a scheme is safer.  Now I have an additional front, and I can connect or disconnect any of them and still be accessible to customers.  The second node of the database gives us the possibility of failover in case of problems, but this is not a backup solution.  Just one person is enough, DROP TABLE users and real-time replication to remove the Users table and lose this hot spare.  So let's say that we acted reasonably and created a backup in this cloud. </p><br><p>  Thus, only one server with cron is needed, because asynchronous tasks can be solved a little later.  That's better.  Our architecture is quite reliable and convenient, and now we will only worry about the code. </p><br><p><img src="https://habrastorage.org/files/4de/d31/0ee/4ded310ee0c1405b93350c72b5d36101.png" alt="image"></p><br><p>  Here are a few abstractions. </p><br><p>  In the upper left corner you see data structures: trees, maps, arrays, dictionaries, sets, lists, etc. They allow us to structure information into something more than bits of memory.  Obviously, this is good. </p><br><p>  Next we have identifiers.  I consider them abstractions.  They can be your auto-increment identifiers in the database, a UUID or GUID, or variables, pointers, URLs or URIs.  They basically allow you to refer to an element, part of the data or an object without the need for its full description.  Typically, identifiers are related by context, which gives them meaning.  I can say: ‚ÄúYou are John,‚Äù and people who know a particular John will have an idea of ‚Äã‚Äãwho John is, based on his acquaintance, on indicators such as his height, profession, age, etc. Identifiers allow we define what the whole true element supports. </p><br><p>  Here we have numbers.  None of those present here today can raise his hand and say that he is implementing his own half-adder in each of his projects.  We basically just use numbers directly, not bits, as before. </p><br><p>  Bottom left is our network.  These are all just abstractions.  Your connections, ordered data streams, IP addresses and port numbers (which are also identifiers!), Packets, etc. Fortunately, we are not just transmitting electrical signals over the cable. </p><br><p>  Next comes the time.  And here I will not describe it.  Philosophers, metaphysicians and scientists for thousands of years argued to get closer to what we mean by this word today. </p><br><p>  And then we have the lines, the format for everything else that we do not know how to portray. </p><br><p>  Each of these essential tools is necessary for us to work and perform tasks without knowledge of what has been created for decades by science, mathematics and technology.  However, if we are not aware of some of the limitations of these abstractions and use them in ways that contradict the actual properties of the abstractions, this can lead to irreversible consequences. </p><br><p><img src="https://habrastorage.org/files/e90/927/da8/e90927da849f4fce95eab3963500bbf6.png" alt="image"></p><br><p>  Let's start with floating point primes.  If you have ever seen a sum of 0.1 + 0.2, equal to 0.30000000000000004, you know what it is.  There is an infinity of numbers from 0.1 to 0.2, but we have a limited number of bytes to represent them.  Some numbers are not completely divided, and without working with the fractional part it will be very difficult not to lose accuracy when the computer starts replacing the numbers so that they acquire meaning. </p><br><p>  Perhaps you have met this when working with money.  The trick is this: do not use floating point numbers when it comes to money if you do not want to lose them.  Always take the smallest indivisible unit you need.  It doesn't matter if cents, millidollars, picodollars or femtodollars are just non-floating point numbers. </p><br><p>  I heard about a project in which the bank tried to broadcast its old code bases using node.js.  Unfortunately for the team, no one told them that there are only floating-point numbers in JavaScript, and the team had to abandon the project. </p><br><p>  By the way, languages ‚Äã‚Äãwith JavaScript type floats have an upper limit on the precision of integers, in this case 2 <sup>53</sup> . </p><br><p><img src="https://habrastorage.org/files/810/98c/5b2/81098c5b2a9c401b9c0230e46f2f6f41.png" alt="image"></p><br><p> With integers a bit easier.  People for the most part understand better the limitations that helps.  But this is not enough: you need the right structure and type of use, because not all integers mean the same thing.  Think of the Mars Climate Orbiter, which failed because some parts of the code worked in imperial units, and others in the metric system.  Oops. </p><br><p>  The image shows a special look at these intricate units.  Ask Siri or Wolfram | Alpha how many Chinese kings are on one square meter, and you will get 1,628 √ó 10 <sup>‚Äì4</sup> .  Not quite sure what that means, but every time it is reliably determined. </p><br><p><img src="https://habrastorage.org/files/87e/3c9/3bf/87e3c93bf6854e53997e3d2f5f87b833.png" alt="image"></p><br><p>  More interesting when language processing is added.  I do not understand why, but to the question ‚ÄúWho is the king of the United States?‚Äù We get the answer ‚Äú1.57 billion Chinese kings.‚Äù </p><br><p>  As a rule, it is quite easy to prevent such an error.  Be careful and if you are dealing with a fancy type system, use it to the fullest.  Do not chase the "whole" for all its types;  specify what are the integers, what is their unit. </p><br><p><img src="https://habrastorage.org/files/33c/bba/31a/33cbba31ab9549c7a4c37834f9ba4f78.png" alt="image"></p><br><p>  Suppose that my application does an excellent job with its redundancy and also does an excellent job with number manipulation.  Perhaps I even had users.  Now I need to pay attention to such a useful thing as sharding, or maybe I will just work with external services.  In any case, I will most likely use a UUID or GUID, since they are unpredictable and can ‚Äúguarantee‚Äù uniqueness. </p><br><p>  UUIDs are just a group of bits that you compare.  If they all came together, the ID passed the test.  If not, then it is different.  There are many different options, some random, some based on time or address. </p><br><p>  As we can see, the UUID is what is located on the top of the slide, with hexadecimal numbers separated by hyphens.  This is a little risky. </p><br><p><img src="https://habrastorage.org/files/c77/752/a77/c77752a77363456ab190a01bc4a61bc0.png" alt="image"></p><br><p>  Depending on the language or stack you are resorting to, you may have libraries that allow you to store UUIDs as binary blobs in memory.  Or the lines where their abstract representations are stored.  In some cases, you will have to use strings as an intermediate format, for example, when transferring information on different systems that do not support raw binary data, such as SQL queries or JSON. </p><br><p>  That is the risk.  By default, most strings in most languages ‚Äã‚Äãhave case-sensitive comparison operators.  So, although these three UUIDs are identical in their authentic binary representation, they will not be compared as equal strings.  Case sensitivity exists in any case and must be taken into account by your system, since the string representation is not an ideal abstract of the true properties of the UUID. </p><br><p><img src="https://habrastorage.org/files/21c/c47/4f1/21cc474f1f6b4b269ee65b6c6c3dbf0a.png" alt="image"></p><br><p>  Indeed, various components that do not use the same exact presentation can be a serious headache.  Your front-end, back-end, database, and cloud services users must either be case insensitive or inconsistent with the overall view. </p><br><p>  For certain languages, special libraries are required, one part of which will do everything correctly, and you cannot expect the same from the other.  Databases can be complicated: </p><br><ul><li>  Using PostgreSQL, you get a case-insensitive comparison, but a lower-case representation. </li><li>  MySQL supports the creation of an uppercase UUID, but does not have a storage format for them.  It is recommended to choose case sensitive VARCHAR. </li><li>  MSSQL can store a GUID, but is suitable for presentation in upper case. </li><li>  Oracle can store raw data, so there should be no problems. </li><li>  Redis does not support UUIDs, and most likely you will have to use a case-sensitive string. </li><li>  MongoDB does everything right with the binary representation. </li></ul><br><p>  Nevertheless, even if you, for your part, do everything flawlessly, there is no guarantee that the system will work.  Just one subsystem is enough to destroy everything.  For example, external services, such as some Amazon services, have many different offers that are not always consistent with each other (for example, DynamoDB and SimpleDB are case sensitive, so a third AWS service based on them will most likely inherit these properties).  If this happens to you, if you, say, use PostgreSQL locally and store the UUID as a UUID, then nothing good will come of it.  Theoretically, objects may start to conflict with each other or simply disappear, since your local representation of the lower register does not exist for the upper register service. </p><br><p>  Any part of the system that acts differently than others can cause problems.  You will have to store the canonical UUID (for comparison) with its small copy (for its original version) or to study how each service stores the material.  Not very fun. </p><br><p><img src="https://habrastorage.org/files/af6/1b5/9b3/af61b59b31d24241b828fc985f4b28d5.png" alt="image"></p><br><p>  However, string comparison can lead to big trouble.  Another interesting property of the compared strings (not only strings, but also most arrays and data structures) is in your desire for the operation to take place as quickly as possible. </p><br><p>  If I compare password hashes, the uppermost one is the correct one, and the second and third ones are other attempts, then when my '==' operator reaches the difference, it is reset and returns false. </p><br><p>  This is interesting because the duration of the calculation is information.  In the area of ‚Äã‚Äãsecurity and cryptography, we strive to hide as much information as possible.  A hacker can send multiple requests with different assumptions, and then see how long the processing takes, and understand how close the intended answer is to the solution.  This can lead to leakage of information about the value of the hash, the attacker is able to offer new options based on time. </p><br><p>  In fact, this is a time attack.  Although there are many more varieties. </p><br><p><img src="https://habrastorage.org/files/5f5/b40/aa1/5f5b40aa12874be1a4f98dcde80dcb28.png" alt="image"></p><br><p>  This problem can be solved by replacing the comparison operator with a strict disjunction.  Set the value to false, and then make a bitwise or one byte comparison with the XOR.  Each time both values ‚Äã‚Äãare the same, 0 (false) is returned, and each time the values ‚Äã‚Äãare different, 1 (true) is returned.  OR leads to the original value, and if in the end it is not 0, then you know that there is a difference. </p><br><p>  Still need to be careful.  You need to make sure that there is no leakage of information about the amount of data and that certain optimizations do not harm you.  Good cryptographic libraries do this anyway.  Use bcrypt or scrypt, and there will be no problems with passwords, but the more you know, the better. </p><br><p>  It's funny that sometimes cryptography requires that everything happen as slowly as possible from a design point of view, but as quickly as possible in implementation, as this prevents brute force attacks. </p><br><p><img src="https://habrastorage.org/files/511/081/a43/511081a43b8e48258b3c4c8498b2edc8.png" alt="image"></p><br><p>  Of course, some devices take it too close to the heart, and their sluggishness is not really necessary! </p><br><p><img src="https://habrastorage.org/files/b87/ab4/f15/b87ab4f15e624766b40e2ada9d1865db.png" alt="image"></p><br><p>  So, we have this wonderful application.  Now it does an excellent job with redundancy, integers, floating-points, UUIDs and passwords.  I have a lot more users, and performance relative to response time begins to decline.  From the blog posts I learned that I was losing an important percentage of users who did not receive a response every tenth second of the time spent.  This is a signal to action! </p><br><p>  Some operations last longer and restrain others.  As a rule, it is really difficult to predict what this may be, and peak times are annoying.  Someone from the team comes up with an idea that will help solve all the problems.  What is this idea? </p><br><p><img src="https://habrastorage.org/files/6c3/3f6/d38/6c33f6d38a8044bf969114c4930e76f1.png" alt="image"></p><br><p>  Stick to the queue!  The external server simply sends simple short requests to the database directly, and all complex, time consuming queued.  Data is accepted into the queue without processing, and I can quickly return the results to users. </p><br><p><img src="https://habrastorage.org/files/af6/260/1b1/af62601b192a4e93b879ed0393b4dfb8.png" alt="image"></p><br><p>  And what?  All my actions are returned.  Damn, it's even faster than before! </p><br><p>  However, there is some problem. </p><br><p><img src="https://habrastorage.org/files/1ba/75d/ac9/1ba75dac997540f18581a42a53268523.png" alt="image"></p><br><p>  When we added the queue, an interesting thing happened: the transfer of the general state of the system to an external server ceased.  If earlier, thanks to returning the result from the end-to-end operation, system users could see if all their requests were processed, then the implementation of the queue destroyed this concept. </p><br><p>  Now the external server allows us to find out only about the presence of direct connections.  We have no idea about the queue user, the asynchronous server, its ability to interact with the database or with the asynchronous queue itself. </p><br><p><img src="https://habrastorage.org/files/8a5/321/f08/8a5321f0879b4f7bb1586e2010178d4b.png" alt="image"></p><br><p>  In fact, if the work is not done carefully, the events can be repeated.  Here is the user Reddit, who bought the game for 12.74 dollars.  He bought it once, but received a request for payment many times, until there was an excess of a loan of ‚Äì93 thousand dollars on his bank account. </p><br><p>  Of course, there is no guarantee that this problem is caused by the queue, but very similar to that.  When something goes wrong and the end-to-end data flow is broken up in mysterious ways, the consequences are usually extremely noticeable. </p><br><p><img src="https://habrastorage.org/files/55f/d17/188/55fd17188f7e41679b784be8f83fe575.png" alt="image"></p><br><p>  But that is not all.  The reason why my application started to work slowly: it was overloaded.  So now I have completely separated the perceived performance from the actual load in the system. </p><br><p>  No matter how bad everything is in the back end, the performance of the frontend does not change.  This scheme works in the case of a temporary overload for some large operations, but does not justify itself when it comes to long-term stability.  By controlling the performance of the frontend, we, in fact, watched the entire system.  If I divide it into two parts, my monitoring shows not only the performance, but also the performance of only half of the system. </p><br><p><img src="https://habrastorage.org/files/314/d02/a9d/314d02a9dede402db847088988fba16f.png" alt="image"></p><br><p>  As a result, the queue is full and crashes.  Of course, not only she fails. </p><br><p><img src="https://habrastorage.org/files/d35/1e2/b9a/d351e2b9ae8047468870dd5900ce596c.png" alt="image"></p><br><p>  The error gets to the interface nodes, and as a result we get catastrophic failures. </p><br><p>  How can we be?  Someone arranges a meeting, says that such is unacceptable.  And what are the developers doing? </p><br><p><img src="https://habrastorage.org/files/f96/512/e9a/f96512e9a15f4b3da179522260306154.png" alt="image"></p><br><p>  Increase the queue.  But that is not all.  Since at the time of the accident all the data in the queue was lost, all participants in the meeting also agree to make it permanent.  It slows it down, and since we love redundancy, why not add another queue? </p><br><p><img src="https://habrastorage.org/files/f02/e5d/e12/f02e5de1223d46bfb9d2017e59334c00.png" alt="image"></p><br><p>  The next time an error occurs, we can do the same. </p><br><p><img src="https://habrastorage.org/files/da5/a70/53d/da5a7053dd2a40be99b98ccbfe7d86e9.png" alt="image"></p><br><p>  All these queues are a good solution.  But we are a great big company, and therefore we need the technology of the next generation.  We all know that this architectural scheme is terrible.  So, we are introducing something special ... </p><br><p><img src="https://habrastorage.org/files/e00/d7b/1b3/e00d7b1b398b4bc2b1b498c7a41dce34.png" alt="image"></p><br><p>  And these are microservices! </p><br><p><img src="https://habrastorage.org/files/42e/a98/cdd/42ea98cddf9b46f5b71b5bbc9848e169.png" alt="image"></p><br><p>  Of course, the problem is the same.  The difficulty is still related to monitoring only part of the system.  Such changes in the architecture should be invisible to users, but they have a very important influence on the maintenance and operation of the system. </p><br><p>  Combining a user and operator or excluding one of them is a deadly mistake for your project.  Operations become very complicated. </p><br><p>  Of course, this is not all!  All our components must be able to interact with each other. </p><br><p><img src="https://habrastorage.org/files/eeb/401/a17/eeb401a17da947518d15deb8871c3b27.png" alt="image"></p><br><p>  We could choose something like JSON.  This is a chart from seriot.ch that tracks about 50 implementations of JSON libraries in more than ten languages. </p><br><p>  Almost each of them processes information in its own way. </p><br><p><img src="https://habrastorage.org/files/66f/371/992/66f371992bf84f3cadd110a8770e0226.png" alt="image"></p><br><p>  It's not very good. </p><br><p><img src="https://habrastorage.org/files/ace/ac9/9b8/aceac99b83fa46ccb98c152eb9509829.png" alt="image"></p><br><p>  The JSON standard is very small, but it probably means that it provides a space for interpretation and, therefore, for special non-standard behavior. </p><br><p>  The most interesting thing: if you run several microservices and send an equally carefully processed data set to all of them, this can lead to inconsistent behavior.  Take, for example, invalid JSON with a set of identical keys that have different values.  Let's say I have an object ‚Äúperson‚Äù, where the attribute ‚Äúname‚Äù appears twice, the first time is ‚ÄúMark‚Äù, the second time is ‚ÄúJohn‚Äù. </p><br><p>  Most likely, the analyzer will behave in one of three ways: </p><br><ol><li>  Refuse to parse the record, as it should be. </li><li>  Keep the first name (Mark). </li><li>  Keep the middle name (John). </li></ol><br><p>  The choice of the last two methods depends on the order of analysis (using the stack or in turn). </p><br><p>  Suppose I have three services, each of them has its own version of behavior.  Then one service will stop and refuse to process the record, and the other two will see different values ‚Äã‚Äãfor the same object.  Handle them with care. </p><br><p><img src="https://habrastorage.org/files/0c0/d36/6ab/0c0d366ab0a14f238134403432ad4695.png" alt="image"></p><br><p>  Another problem is time.  Different clocks operate at different speeds.  Last year, I conducted an experiment for a presentation on calendars (no, don't laugh, the calendars are actually very interesting), during which I turned off the clock synchronization on my computer.  Then I did the same with the oven and microwave to see where the deviation would be greatest.  Somewhere in three or four weeks, the time on the microwave shifted by about 3 minutes, on the laptop - by about 2 minutes and 16 seconds, and on the oven - did not change. </p><br><p>  Clocks deviate depending on hardware, temperature, voltage, humidity, etc. They cannot be accurate for a long time. </p><br><p><img src="https://habrastorage.org/files/fc8/a5f/ce7/fc8a5fce7a6a4b0485d88393e51b0cc3.png" alt="image"></p><br><p>  So, without synchronization, the timestamps for the same event can be divided and lead to disparate results.  To avoid this, NTP is required.  You can monitor the time and see that its deviation is insignificant.  Nevertheless, for events that occur very quickly, even NTP can have enough ways to cause problems. </p><br><p>  And this happens even on one device.  In the previous work, we somehow broke the Hadoop cluster.  It turned out that we ran fast trades on the millisecond scale and noted the time at two points: when the request was received and at the close of the auction.  We could then use this data to register the event and calculate the time difference to find out how long the processing takes. </p><br><p>  On the fateful day, when the transaction was carried out especially quickly, the NTP synchronization of the computer clock led to a deviation of a fraction of a second: it is enough to put a second time stamp before the first one.  For complete happiness, this happened at about midnight on the last day of the month or at some other turn of the cycle. </p><br><p>  The events ended the day before they began, which was very embarrassing for the cluster, which simply fell on obviously garbage data. </p><br><p>  The trick here is to create a significant difference between monotone and system time. </p><br><p><img src="https://habrastorage.org/files/8eb/d22/e22/8ebd22e22fee4174b7598caeeda83425.png" alt="image"></p><br><p>  But that is not all.  Time always causes problems.  Working with similar systems, we can get completely different logical endings. </p><br><p>  In this case, the client can send a request that will transfer it to the first service, then to the second and the third.  Suppose the service confirms the purchase of goods and sends a notification about this to the interface.  After the third service immediately sends an order for the fourth service, which, say, confirms delivery or something like that.  It also sends a notification to the interface. </p><br><p>  At this stage, due to network delays, the interface may receive information that the shipment occurs before the purchase is confirmed. </p><br><p>  If you are a front-end developer, you are able to anticipate such events and handle them properly.  If, instead, the same events fall into any audit system, it may well take them for an error, raise an alarm, cancel the dispatch, etc. Who knows what horrors will occur. </p><br><p>  Then it is necessary to use logical time to track causality, instead of considering it unconditional, but this is too broad a topic to talk about it here. </p><br><p><img src="https://habrastorage.org/files/286/c79/efa/286c79efa04445ef831b2a480ba3de2f.png" alt="image"></p><br><p>  In fact, logical errors are quite funny.  They allow us to travel in time. </p><br><p><img src="https://habrastorage.org/files/296/df2/9e2/296df29e22b44faca7aa14f556a773a2.png" alt="image"></p><br><p>  But that is not all.  Those present here are probably familiar with time zones.  But did anyone here hear about belts in half an hour? </p><br><p>  (Most people raise their hands.) </p><br><p>  Yes, this belt is located in Newfoundland.  It is within the country, it is good that you know. </p><br><p>  But then again, who knows about the existence of a quarter-hour time zone?  Similar was in New Zealand.  Or that a 44-minute minute was recorded in Liberia?  Maybe some here have heard that in 1927 in the time zones in China there were deviations in five minutes and a few seconds? </p><br><p>  But that's not all.  Changes in time zones are not always insignificant.  For example, Samoa exists between UTC ‚Äì 11 and UTC +13, completely switching days.  The trick is that they are on the date line change.  In 1892, the islands decided to align their calendars with the United States, based on market considerations.  That year they had twice on July 4th.  The first of July, the second of July, the third of July, the fourth of July, the fourth of July, the fifth of July ... </p><br><p>  And again, in 2011 (quite recently!), They agreed on calendars with China, and this time on the Samoan Islands was not on December 31. </p><br><p>  In addition, there is summer time.  If you are familiar with Brazilian sysadmins, you may have heard of such a funny fact (I don‚Äôt know if they still do this) that every region / province / state in Brazil annually votes on whether they adhere to DST.  It is impossible to know in advance whether to update time zone files. </p><br><p><img src="https://habrastorage.org/files/8cf/ebc/100/8cfebc100a7c4620ab5c823c5d3a79c9.png" alt="image"></p><br><p>  Next, leap seconds.  The problems of time zones will be solved simply by UTC.  But this has very interesting implications, since each type still uses UNIX timestamps and is freely convertible between UTC and the UNIX era, which begins on January 1, 1970. </p><br><p>    ,  UTC   ,   :   ,      ,      .  1970      27- .  UNIX       . </p><br><p> ,      ,     -   iPhone,         1  1970     .        - .      ,     ,  . </p><br><p>   ,    (  ,   ),     .        ‚Äî      ‚Äî   ,  1  1970 ,   ,     UTC     ,   -27,       .      .  32     2106 ,         ,      . </p><br><p><img src="https://habrastorage.org/files/3d2/83f/066/3d283f06653c4af3b2fd81fb3ef4fc82.png" alt="image"></p><br><p>  But that is not all.   . ,     ,    . -      ,    ? (  .) </p><br><p>  Not so much.    ,   ,    ‚Äî    : </p><br><ul><li>  . ,         . </li><li>  .   - .     (    )   . </li><li>  .     ,   ,    .         .     ,       .    ,     ,  ,  ,      . </li><li>  .    .   ,  .     ,    ,   - .          .          ,    . </li><li>  ,     .    ,    . ,             ,                 .           ,      . </li><li>    ,        . </li><li>  ,  ,      ,     ‚Äî     . ,     .       -    ,     : ¬´ ,     ¬ª. ,       ,      ,       . </li></ul><br><p>   .      .         . </p><br><p><img src="https://habrastorage.org/files/6e0/a1e/e29/6e0a1ee291e747b5bc57f013a722ed9e.png" alt="image"></p><br><p>  Oh no. .  :       ,      .  . (    .) </p><br><p>  Yes.  ,  ,   .       Latin-1 ( ISO-8859-1)  UTF-8. </p><br><p><img src="https://habrastorage.org/files/352/810/9b9/3528109b95e44affbe3fd1f452970391.png" alt="image"></p><br><p>  ,     UTF-8  ISO-8859-1  ,       ASCII. </p><br><p>             .  ,      HTTP (  ),  ,    (       UTF-8),      ( SQL   ,    ),      .   ,            . </p><br><p>        ,    ,  .   ,       . </p><br><p><img src="https://habrastorage.org/files/14c/43f/bb5/14c43fbb56a044e38bbe92d6bd188711.png" alt="image"></p><br><p>    ‚Äî   .     .         : </p><br><ul><li>    ,    14   UTF-8, 12  UTF-16  20  UTF-32. </li><li>     ,    ,        .    14  UTF-8, 6  UTF-16  5  UTF-32. </li><li>        .     5,         ,     . </li><li>  ,   ,  , ,  .      ¬´     Delete,     ¬ª.   4. </li></ul><br><p>       ,      ,   . </p><br><p>  .           40+ . <br>         ,         (code points).   ,       ,  .   30 ,  -   ,       . </p><br><p>        ,      ,    .    . </p><br><p><img src="https://habrastorage.org/files/6a0/cf5/f30/6a0cf5f30f0d48c7ba9ccc355aa7fdb2.png" alt="image"></p><br><p>     .  ,    ,     . </p><br><p><img src="https://habrastorage.org/files/254/428/e9a/254428e9a6854efb8aabe0e12f32c2b4.png" alt="image"></p><br><p> ,  .         Spotify,     .    ,    ,    <a href="https://labs.spotify.com/2013/06/18/creative-usernames/">    </a> . </p><br><p><img src="https://habrastorage.org/files/655/f0f/4a0/655f0f4a05624c05b1cc6b03a49b7088.png" alt="image"></p><br><p>      .         Spotify,    <a href="https://labs.spotify.com/2013/06/18/creative-usernames/">    </a> . </p><br><p><img src="https://habrastorage.org/files/ffe/104/e02/ffe104e02eaa4f1ca3bb6ea1cb653a1c.png" alt="image"></p><br><p>      -  ! !    2012  ¬´    :  SSL-  ¬ª,    . </p><br><p>      ,      .  ,      ,    ( -),    ,      ¬´ ¬ª       .  . </p><br><p><img src="https://habrastorage.org/files/75e/b51/fa8/75eb51fa810c4c48b725f07b3f98922c.png" alt="image"></p><br><p>      OpenSSL.          . </p><br><p><img src="https://habrastorage.org/files/2fe/47d/74e/2fe47d74e2d54146b075e91671113713.png" alt="image"></p><br><p>     GnuTLS     . </p><br><p><img src="https://habrastorage.org/files/79d/faf/edc/79dfafedc6c849b9be6b90090babd171.png" alt="image"></p><br><p>  API cURL  PHP  .      ,     ,      CURLOPT_SSL_VERIFYHOST  true.    ,   PHP ( ,   C  C++) true ‚Äî    ,  1.   1  CURLOPT_SSL_VERIFYHOST  .   ‚Äî 2. </p><br><p>  Oops. </p><br><p><img src="https://habrastorage.org/files/183/c72/8f4/183c728f4429474784f3f8068269011a.png" alt="image"></p><br><p> ,     class breaks,         . </p><br><p>    ,         .    , .         ,        . </p><br><p>          class breaks,          .       . </p><br><p><img src="https://habrastorage.org/files/8ce/0a5/ed6/8ce0a5ed6ca3485db66f567f113d93bd.png" alt="image"></p><br><p> ¬´ ¬ª,         ,   .   .      ,      ,   IoT    . </p><br><p>    . ,       (,     ,             ?),   , ,   -,    . . </p><br><p><img src="https://habrastorage.org/files/183/c72/8f4/183c728f4429474784f3f8068269011a.png" alt="image"></p><br><p>     .     ,   , ,    ,       .          .       ?      ,      ? </p><br><p>   , , ,       .         -  ,      . ,   ,   -     ,  ,    .            . </p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Do we use adequate means to ensure the safety of our creations? </font><font style="vertical-align: inherit;">Will we leave everything as it is because we have not killed enough people yet? </font><font style="vertical-align: inherit;">Maybe we all know about the problem, but simply deny our personal responsibility, until something forces us to act as a single whole in order to achieve more?</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I do not know for sure, but all this is very scary. </font><font style="vertical-align: inherit;">I can only hope that I am not one of those who ultimately cause enough harm to make laws. </font><font style="vertical-align: inherit;">Maybe we should all be a little wary of this. </font><font style="vertical-align: inherit;">Everything is bad, and we are to blame.</font></font></p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/327264/">https://habr.com/ru/post/327264/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../327254/index.html">A prototype of a simple service for healthy eating.</a></li>
<li><a href="../327256/index.html">How DDos-attacks are ‚Äúordered‚Äù: life story</a></li>
<li><a href="../327258/index.html">Why do we need chat bots, or the story of Bitrix24</a></li>
<li><a href="../327260/index.html">How Google Cloud protects its data centers from cybercriminals and internal errors</a></li>
<li><a href="../327262/index.html">UIKit + Viper or MVC healthy person</a></li>
<li><a href="../327266/index.html">How to beat groundhog day ‚Üí Automate testing of the KOMPAS-3D v17 interface</a></li>
<li><a href="../327270/index.html">Hacksplaining - an online course on web vulnerabilities</a></li>
<li><a href="../327272/index.html">‚ÄúCryptography in blockchains‚Äù: about hash functions, keys and digital signatures</a></li>
<li><a href="../327274/index.html">Development of an accelerated BBC News homepage</a></li>
<li><a href="../327276/index.html">Open access to HighLoad ++ video over the past five years</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>