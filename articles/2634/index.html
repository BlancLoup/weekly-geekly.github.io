<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Protect flash files.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Since korowkin Korovkin and I had rested the mp3 habrapleer for the second time ( here again , here about the first time ), I decided to do self-educa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Protect flash files.</h1><div class="post__text post__text-html js-mediator-article">  Since <a href="https://habrahabr.ru/users/korowkin/" class="user_link">korowkin</a> Korovkin and I had rested the mp3 <a href="https://habrahabr.ru/users/korowkin/" class="user_link">habrapleer for the</a> second time ( <a href="http://www.agomy.com/">here again</a> , <a href="http://xek.habrahabr.ru/blog/3029.html">here about the first time</a> ), I decided to do self-education :) <br><br>  So, SWF protection, etc. <br><a name="habracut"></a><br>  SWF is an open standard where the code is converted to assembler-like, which then decompilers successfully decompile back to fla. <br><br>  Thanks to <a href="https://habrahabr.ru/users/uznick/" class="user_link">Uznick</a> 's, I found the program Amayeta SWF Encrypt, which the code converts to the form: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote>  var \ x01 = 707; <br>  if (eval ("\ x01") == 732) <br>  { <br>  } <br>  else <br>  { <br>  while (\ x01 = eval ("\ x01") - 86, if (eval ("\ x01")! = 732) goto 12, \ x01 = eval ("\ x01") + 87, // Jump to 429496724, // Jump to 87, eval ("\ x01") == 621) <br>  { <br>  \ x01 = eval ("\ x01") + 44; <br>  if (false) <br>  { <br>  continue; <br>  } // end if <br>  \ x01 = eval ("\ x01") - 260; <br>  } // end while <br>  if (eval ("\ x01") == 376) <br>  { </blockquote><br>  etc. <br><br>  That is, apparently, by replacing functions with their opcodes, obfuscation and shuffling the code.  For which office many thanks.  Downloaded on the site.  The serial is in eMule. <br><br>  Then I sketched a code that checks from where the swf file is running and blocks the wrong domains. <br><br><blockquote>  var allowDomains = new Array ("averin.ru", "rpod.ru");  // list of what you can.  Notice how the domains are written. <br>  var passTest = false;  // store test results here <br><br>  for (eachDomain in allowDomains) // bust domains <br>  { <br>  hostdomain1 = "http: //" + allowDomains [eachDomain] + "/"; <br>  hostdomain2 = " <a href="http://www/">www</a> ." + allowDomains [eachDomain] + "/"; <br>  if (_root._url.substr (0, hostdomain1.length) == hostdomain1 <br>  ||  _root._url.substr (0, hostdomain2.length) == hostdomain2) passTest = true; <br>  } <br>  if (passTest == false) <br>  { <br>  getURL (" <a href="http://averin.ru/">averin.ru</a> ", "_ self");  // if the test is not ale - send <br>  _root.gotoAndStop (1); // here you can conjure, it may not help, depending on what is written in the actions of frame 1 <br>  } <br></blockquote><br><br>  Plus, if you have any links are transferred to the swf, you also need to check for their correctness.  So how can you not steal and just make the player play the wrong files :) <br><br>  Pictures, drawing and the like are unfortunately not coded: (So far, I hope. <br>  There is an option for their protection to load them from the outside after verification. <br></div><p>Source: <a href="https://habr.com/ru/post/2634/">https://habr.com/ru/post/2634/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../263387/index.html">Research interstitial ads on Google+ with advertisements</a></li>
<li><a href="../263391/index.html">Automate it</a></li>
<li><a href="../263393/index.html">Organizing collaborative web development environment</a></li>
<li><a href="../263397/index.html">Bit Kung Fu, or How to optimize traffic between a mobile application and a server</a></li>
<li><a href="../263399/index.html">The first experience of participation in the kaggle-competition and work on the bugs</a></li>
<li><a href="../26340/index.html">‡§ï‡§∞‡•ç‡§Æ (Sanskr.- Karma) - where is she hiding on the Internet</a></li>
<li><a href="../263403/index.html">My code does not work :-(</a></li>
<li><a href="../263405/index.html">Video of reports from Zabbix Moscow Meetup</a></li>
<li><a href="../263407/index.html">Dirty secrets of express programming courses</a></li>
<li><a href="../263409/index.html">The end of the IT era</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>