<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Backup telegram</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Immediately start with the fact that I do not urge anyone to run out of the Messenger, which can not be called. Quite the contrary. Just sleep is much...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Backup telegram</h1><div class="post__text post__text-html js-mediator-article"><p>  Immediately start with the fact that I do not urge anyone to run out of the Messenger, which can not be called.  Quite the contrary.  Just sleep is much calmer when one cloud is buried in another cloud.  And even the clouds periodically fall on the sinful earth, and losing years of correspondence is very disappointing.  Yes, and a friend asked me how to make a backup, but I did not immediately find a clear instruction. </p><br><p>  I warn you right away - for backup, you need Linux, or at least a virtual machine with it.  If you have hands, you can also on Mac OS, and maybe even on a stub that is now built into Windows - but I do not guarantee anything. </p><br><p>  Go! <a name="habracut"></a></p><br><p>  We will be backing up using two cute programs: </p><br><ul><li>  dump <a href="https://github.com/tvdstaaij/telegram-history-dump">software</a> </li><li>  Console <a href="https://github.com/vysheng/tg">client</a> telegrams </li></ul><br><p>  We will take the source from trusted sources from the gita, so the first thing you need is a client: </p><br><pre><code class="bash hljs">sudo apt install git</code> </pre> <br><p>  Next, create yourself some directory where you will create chaos, for example </p><br><pre> <code class="bash hljs">mkdir telegram-backup</code> </pre> <br><p>  Then we clone the console client and go to its folder: </p><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> --recursive https://github.com/vysheng/tg.git &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> tg</code> </pre> <br><p>  Now we install any dependences for its assembly.  If you do not have an ubunt, then alternative assembly methods are described on the program page: </p><br><pre> <code class="bash hljs">sudo apt-get install libreadline-dev libconfig-dev libssl-dev lua5.2 liblua5.2-dev libevent-dev libjansson-dev libpython-dev make</code> </pre> <br><p>  Then - classic </p><br><pre> <code class="bash hljs">./configure make</code> </pre> <br><p>  Now we start the client, the public key transmitted to it as a parameter, which lies right there: </p><br><pre> <code class="bash hljs">bin/telegram-cli -k tg-server.pub</code> </pre> <br><p>  If everything went well, you will see something like the following: </p><br><blockquote>  Telegram-cli version 1.4.1, Copyright ¬© 2013-2015 Vitaly Valtman <br>  Telegram-cli comes with ABSOLUTELY NO WARRANTY;  for details type <code>show_license'. This is free software, and you are welcome to redistribute it under certain conditions; type</code> <code>show_license'. This is free software, and you are welcome to redistribute it under certain conditions; type</code>  <code>show_license'. This is free software, and you are welcome to redistribute it under certain conditions; type</code> show_license 'for details. <br>  Telegram-cli uses libtgl version 2.1.0 <br>  Telegram-cli includes software developed by the OpenSSL Project <br>  for use in the OpenSSL Toolkit.  ( <a href="http://www.openssl.org/">http://www.openssl.org/</a> ) <br>  I: config dir = [/ home / jehy / .telegram-cli] <br>  [/home/jehy/.telegram-cli] created <br>  [/home/jehy/.telegram-cli/downloads] created </blockquote><p>  Further from the console you will be asked for a phone number, enter it: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">phone</span></span> number: <span class="hljs-number"><span class="hljs-number">79166666666</span></span></code> </pre> <br><p>  And they will ask for the code that comes in SMS or to another open client, the message from the client looks something like this: </p><br><blockquote>  Your login code: 123456 <br><br>  This code can be used to log in to your Telegram account.  We never ask it for anything else.  Do not give it to anyone !!! <br><br>  If you didn‚Äôt request this, simply ignore this message. </blockquote><p>  Enter the code: </p><br><pre> <code class="hljs cs">code (<span class="hljs-string"><span class="hljs-string">'CALL'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> phone code):<span class="hljs-number"><span class="hljs-number">123456</span></span></code> </pre> <br><p>  And enter the password (if you have it installed, which is generally very good): </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">password</span></span> :xxx</code> </pre> <br><p>  Further, under a successful set of circumstances, you will see that you have logged into the client and you have started receiving messages: </p><br><blockquote>  User Jehy updated flags <br>  User Jehy updated flags <br>  [19:41] Alexander Zharov &gt;&gt;&gt; Hi! <br>  [19:41] Alexander Zharov &gt;&gt;&gt; How are you? </blockquote><p>  Fine!  Now we cut down the client (Ctrl + C) and start it in server mode: </p><br><pre> <code class="bash hljs">bin/telegram-cli --json -P 9009</code> </pre> <br><p>  After that, we leave this console alone, open the second one, arrive at our telegram-backup daddy and put the second program there: </p><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/tvdstaaij/telegram-history-dump.git</code> </pre> <br><p>  Go to its directory </p><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> telegram-history-backup</code> </pre> <br><p>  And run </p><br><pre> <code class="bash hljs">ruby telegram-history-dump.rb</code> </pre> <br><p>  If everything is good, then we will see that the backup has started, it will look something like this: </p><br><blockquote>  ruby telegram-history-dump.rb <br>  I, [2018-04-26T19: 43: 38.286782 # 11274] INFO -: Attaching to local control: 9009 <br>  I, [2018-04-26T19: 43: 39.689541 # 11274] INFO -: Skipping 34 dialogs: "Mila_Milan", "Stormy_Daniels", "Amila_Miley", "Sasha_Gray" <br>  I, [2018-04-26T19: 43: 39.689946 # 11274] INFO -: Backing up 181 dialogs: "user # 1299351", "Canela_Skin", "Dana_DeAmond", "Lita_Phoenix", "Erica_Lauren", "Naomi_Woods", ‚Äú Well, you understood " <br>  I, [2018-04-26T19: 43: 39.690609 # 11274] INFO -: Dumping "user # 122679361" (range 1-100) <br>  I, [2018-04-26T19: 43: 40.975234 # 11274] INFO -: Dumping "Jessa_Rhodes" (range 1-100) <br>  I, [2018-04-26T19: 43: 42.262817 # 11274] INFO -: Dumping "Anya_Ivu" (range 1-100) <br>  I, [2018-04-26T19: 43: 43.548510 # 11274] INFO -: Dumping "Brandi_Bae" (range 1-100) <br>  I, [2018-04-26T19: 44: 42.541472 # 11274] INFO -: Dumping Everlasting_Yearning (range 101-200) <br>  I, [2018-04-26T19: 44: 43.541788 # 11274] INFO -: Dumping Infinite_Summer (range 201-300) <br>  I, [2018-04-26T19: 44: 44.542101 # 11274] INFO -: Dumping Infinite_Summer (range 301-400) <br>  I, [2018-04-26T19: 44: 45.542446 # 11274] INFO -: Dumping Infinite_Summer (range 401-500) </blockquote><p>  Be patient - the telegram has its limits, and therefore the history is not pumped out quickly - about 100 messages from a user or group per second. </p><br><p>  When the program finishes its action, an interesting question arises - what exactly and where did we download?  To understand this, make the program directory </p><br><pre> <code class="hljs pgsql">cd output/<span class="hljs-type"><span class="hljs-type">json</span></span></code> </pre> <br><p>  There will be a bunch of files in JSON format, each of which contains a correspondence with some of the contacts.  Of course, it is quite difficult to read, but you can easily export from JSON to any other readable format.  By the way, it was still possible to specify a different format when exporting a story ‚Äî for example, so that you could generate an HTML page per contact. <br>  And if you like hardcore, you can just ruff over the story, like this: </p><br><pre> <code class="hljs bash">grep <span class="hljs-string"><span class="hljs-string">"porn"</span></span> . -R ./.jsonl:{<span class="hljs-string"><span class="hljs-string">"event"</span></span>:<span class="hljs-string"><span class="hljs-string">"message"</span></span>,<span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"02040050001310087a8e0200000000000000000000000000"</span></span>,<span class="hljs-string"><span class="hljs-string">"flags"</span></span>:228,<span class="hljs-string"><span class="hljs-string">"from"</span></span>:{<span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$0120000078745a00625f8a35c922bb6c</span></span></span><span class="hljs-string">"</span></span>,<span class="hljs-string"><span class="hljs-string">"p eer_type"</span></span>:<span class="hljs-string"><span class="hljs-string">"user"</span></span>,<span class="hljs-string"><span class="hljs-string">"peer_id"</span></span>:3328156,<span class="hljs-string"><span class="hljs-string">"print_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Jehy"</span></span>,<span class="hljs-string"><span class="hljs-string">"flags"</span></span>:721597,<span class="hljs-string"><span class="hljs-string">"first_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Jehy"</span></span>,<span class="hljs-string"><span class="hljs-string">"when"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-04-26 20:09:54"</span></span>,<span class="hljs-string"><span class="hljs-string">"last_name"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">"phone"</span></span>:<span class="hljs-string"><span class="hljs-string">"7123456 "</span></span>,<span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"Jehy_rus"</span></span>},<span class="hljs-string"><span class="hljs-string">"to"</span></span>:{<span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$02000001005310020000000000000000</span></span></span><span class="hljs-string">"</span></span>,<span class="hljs-string"><span class="hljs-string">"peer_type"</span></span>:<span class="hljs-string"><span class="hljs-string">"chat"</span></span>,<span class="hljs-string"><span class="hljs-string">"peer_id"</span></span>:115391548,<span class="hljs-string"><span class="hljs-string">"print_name"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">"flags"</span></span>:1,<span class="hljs-string"><span class="hljs-string">"title"</span></span>:<span class="hljs-string"><span class="hljs-string">" "</span></span>,<span class="hljs-string"><span class="hljs-string">"admin"</span></span>:{<span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$01000000001000000000001000000000</span></span></span><span class="hljs-string">"</span></span>,<span class="hljs-string"><span class="hljs-string">"peer_type"</span></span>:<span class="hljs-string"><span class="hljs-string">"user"</span></span>,<span class="hljs-string"><span class="hljs-string">"peer_id"</span></span>:0,<span class="hljs-string"><span class="hljs-string">"print_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"user#0"</span></span>},<span class="hljs-string"><span class="hljs-string">"members_num"</span></span>:3},<span class="hljs-string"><span class="hljs-string">"out"</span></span>:<span class="hljs-literal"><span class="hljs-literal">true</span></span>,<span class="hljs-string"><span class="hljs-string">"unread"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span> ,<span class="hljs-string"><span class="hljs-string">"service"</span></span>:<span class="hljs-literal"><span class="hljs-literal">false</span></span>,<span class="hljs-string"><span class="hljs-string">"date"</span></span>:1504003822,<span class="hljs-string"><span class="hljs-string">"text"</span></span>:<span class="hljs-string"><span class="hljs-string">"https://tjournal.ru/58619-polzovatel-reddit-zaarhiviroval-dva-petabayta-porno-chtoby-proverit-bezlimitnoe-oblac hnoe-hranilishche-amazon?from=digest\n\n@navalny ?"</span></span>,<span class="hljs-string"><span class="hljs-string">"media"</span></span>:{<span class="hljs-string"><span class="hljs-string">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"webpage"</span></span>,<span class="hljs-string"><span class="hljs-string">"url"</span></span>:<span class="hljs-string"><span class="hljs-string">"https://tjournal.ru/58619-polzovatel-reddit-zaarhiviroval-dva-pe tabayta-porno-chtoby-proverit-bezlimitnoe-oblachnoe-hranilishche-amazon?from=digest"</span></span>,<span class="hljs-string"><span class="hljs-string">"title"</span></span>:<span class="hljs-string"><span class="hljs-string">" Reddit    ,      Amazon"</span></span>,<span class="hljs-string"><span class="hljs-string">"description"</span></span>:<span class="hljs-string"><span class="hljs-string">"         ."</span></span>}}</code> </pre> <br><p>  Something like that.  At the same time I recall: </p><br><ul><li>  Naturally, the history of private chats is not saved; </li><li>  Media files are also not saved.  Maybe it can be done somehow, but I didn‚Äôt really care; </li><li>  Please keep backups of your correspondence in safe places.  And then in the long-term correspondence anything can be found. </li><li>  It is possible that somewhere you will find a more convenient tool for export or a prepared docker image with all this software or anything else.  Be careful, check these tools three times. </li></ul><br><p>  In general, I slowly have the feeling that soon everything will again be like in the 90s - music, movies and files on local machines, and only programmers can go on the Internet.  Not to say that it pleased me. </p><br><h3 id="ne-ochen-poleznye-ssylki-s-alternativnymi-variantami">  Not very useful links with alternatives: </h3><br><ul><li>  <a href="https://telegram.wiki/general/exporting-chats">An amazing recommendation</a> from a wiki telegram is to scroll through your entire chat in a web client and then save it in pdf; </li><li>  Sly <a href="https://gist.github.com/agentcooper/b5c0cec210bd81c6b49a6385f9d66069">client javascript</a> for exporting data directly from the client's web; </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/354472/">https://habr.com/ru/post/354472/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354460/index.html">Testing systems in TPC-C - fast and easy</a></li>
<li><a href="../354462/index.html">Improving opportunities for finding vacancies and specialists at My Circle</a></li>
<li><a href="../354464/index.html">Interfaces in the real world-4: updates to the traditional pieces</a></li>
<li><a href="../354466/index.html">How to improve the quality of their work</a></li>
<li><a href="../354468/index.html">Automating log downloads from Kibana to Redmine</a></li>
<li><a href="../354474/index.html">Splunk 7.1. What's new? New web interface, integration with Apache Kafka and much more ...</a></li>
<li><a href="../354476/index.html">PDF generation for downloading server configs</a></li>
<li><a href="../354478/index.html">When computers were people ...</a></li>
<li><a href="../354480/index.html">Bobaos - KNX TP / UART, Raspberry Pi and Apple HomeKit</a></li>
<li><a href="../354484/index.html">Block the entire Internet, or a monkey with a grenade</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>