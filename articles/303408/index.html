<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Intuit has accelerated the site almost 5 times and increased conversion by 20%</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the second case from the series ‚ÄúHow to speed up the site correctly, and what it gives.‚Äù We published the full list of cases here . In this ca...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Intuit has accelerated the site almost 5 times and increased conversion by 20%</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/megamozg/post_images/a54/c76/e1c/a54c76e1ca3f975a664d21e086eb1df6.png"><br><br>  <i>This is the second case from the series ‚ÄúHow to speed up the site correctly, and what it gives.‚Äù</i>  <i><a href="https://habrahabr.ru/post/300210/">We published the full list of cases here</a> .</i>  <i>In this case, it is instructive how the development team negotiated with other business units to really speed up the site.</i> <br><br>  Intuit company produces business software in the field of finance and accounting.  The first version of the company's website was released in 1996, then constantly modified.  The developers and standards of the Web have changed, the site has become overlaid with various patches and additional code.  In 2012, the company's website began to load awfully long - 15 seconds. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The development team was tasked with reducing by 50% the load time of the top 50 pages on 6 different company sites. <br><br>  A typical web page was as follows: <br><ul><li>  Total volume: 1.5-2 MB </li><li>  Images: 50-70 + pieces, volume about 1.2 MB </li><li>  External CSS / JS: 30-40 + </li><li>  Javascript size: more than 400 KB </li><li>  30x redirects: more than 20 </li><li>  HTTP requests: more than 120 </li></ul><a name="habracut"></a><br><h2>  Starting from scratch </h2><br><h3>  CSS / JS </h3><br>  One of the basic rules for speeding up site loading is ‚Äúminimize http requests‚Äù. <br><br>  It turned out to be not so easy to do, because the sites used a lot of images and CSS / JS files.  Many files were used on other sites of the company, some styles were written inside the pages and not highlighted in files.  There were global variables and Javascript functions. <br><br>  The team conducted a global CSS / JS purge, optimized walkthroughs in the DOM document tree, created a global stylesheet and script file that was used on all sites.  Several of the same files were created that were used only on certain sites. <br><br>  As a result, requests related to CSS / JS, reduced by 10 times (from 30-40 to 3-4). <br><br><h3>  Work with images </h3><br>  The main part of the work was to combine images (sprites) to reduce the number of http requests. <br><br>  The design used images with transparency (24-bit PNG files).  For example, the sprite shown below was 306 KB. <br><br><img src="https://habrastorage.org/files/c9b/bde/067/c9bbde067ecf41a7ae0561f8cb7c1fb2.png"><br><br>  The team worked with the designers, persuaded them to abandon the transparency in the images and switch to using the JPG format.  This allowed us to save 250 KB on this sprite (saving more than 6 times). <br><br>  However, the sprite technique did not always help.  The example below shows a collection of images for a page with a screenshot gallery.  Each screenshot is 102x768 in size.  The overall image size is 5 MB.  Sprites should be used deliberately! <br><br><img src="https://habrastorage.org/files/603/0c9/bb3/6030c9bb3a1349bf94903be0f2cc7d1a.png"><br><br><h3>  CDN </h3><br>  Company sites have already used Akamai.  In some places there were problems with the configuration, files were downloaded sometimes from the CDN, and sometimes from their servers.  All sites used the same CDN domain images.smallbusiness.intuit.com. <br><br>  Cookies were transmitted with each http request to this domain.  Average cookie size: 0.8-1 KB.  Multiply by more than 100 requests per page, we find that about 100 KB of traffic was spent only on cookies. <br><br>  The problem was solved by reconfiguring Akamai.  All static files began to be loaded from the CDN, switched to using the CDN domain without cookies. <br><br><h3>  Tracking tags </h3><br>  20-30 different tracking tags (pixels) were used on the site. <br><br>  The site team worked with marketers, all tracking tags were checked for the need for their presence, many were refused.  Those tags that were left were replaced with their latest actual version to improve performance. <br><br>  As a result, from 20-30 their number was reduced to 8-10. <br><br><h3>  Other types of optimization </h3><br><ul><li>  All images not used in sprites are checked for optimal compression. </li><li>  Images located below the first visible part of the page were loaded later, asynchronously. </li><li>  No longer use all non-standard fonts. </li><li>  Removed duplicate code. </li><li>  Removed 30x redirects. </li></ul><br>  The total duration of all work on optimization was 6 months. <br><br><blockquote>  Result: optimized pages began to load in 6 seconds instead of 15. </blockquote><br><h2>  Better than good </h2><br>  Then the company management began to ask questions: is it possible to further accelerate the loading of pages.  The team of optimizers faced an unusual problem, since they had already done the main optimization steps at the previous stage. <br><br>  The team analyzed all other possible bottlenecks and identified the following sources of boot problems: <br><br><ul><li>  Software responsible for A / B testing. </li><li>  Problem video player. </li><li>  Slow header site. </li><li>  Javascript: an obvious possibility of its further optimization. </li></ul><br><h3>  A / V Testing Software </h3><br><img src="https://habrastorage.org/files/6d0/588/901/6d0588901e6b4444b4c20e67c423001f.png"><br><br>  As you can see in the above picture, there was a series of blocking calls on the page: each next waits for the completion of the previous one and does not start without it.  Any such call went to the server responsible for testing, and the server has already determined whether this user should ‚Äúget‚Äù to a particular A / B test, if yes - then other content was shown to him in a certain place.  Many users did not fall into any test. <br><br><img src="https://habrastorage.org/files/0aa/df3/e79/0aadf3e79b2a4eba8c0a9079e4fd3afc.png"><br><br>  These requests in total gave about 750 milliseconds.  That is, 3/4 seconds (out of 6), so that in most cases nothing can be done for the user. <br><br>  Another problem with the A / B tests was their logic: <br><ul><li>  All users downloaded default content </li><li>  If the user falls into the category of those on whom the A / B test is being conducted, he also downloaded the test content, which he saw on the screen instead of the default content. </li></ul><br>  The architecture of the A / V tests was flawed. <br><br><img src="https://habrastorage.org/files/8c1/073/c16/8c1073c167bf45ad8c8a4101d2a1c9e2.png"><br><br>  The content on the page was organized as follows: a container div with the name of the class, behind which was located the Javascript code that accessed the testing server for the desired content. <br><br>  If the testing server determined that this user is participating in the A / V test, and sent other content, then the code looked for the desired div in the DOM and inserted the modified content into it.  Each such code had to go through the entire DOM, find the div in front of it and insert other content into it. <br><br>  What was finally done: <br><ul><li>  Removed code associated with already completed tests. </li><li>  Commented inactive while tests </li><li>  Switched to other software for A / V testing </li></ul><br><h3>  Video player </h3><br>  The video player, as it turned out, not only plays the video, but also adds problems.  Here is what the video player download on the page looks like: <br><br><ul><li>  SWF-file (the player itself) is loaded in 6-8 seconds </li><li>  Many external calls to various analytical services: 23 requests, 9 domains, 7 SWF files </li><li>  A static picture that the player shows until the user has clicked on the playback takes more than 3 seconds to download. </li><li>  Until the static image is loaded, the page is blocked and other elements are not loaded. </li></ul><br>  Solution: replaced 3 different video players on the pages with one, the other vendor. <br><br><blockquote>  Recommendation: if for some reason you cannot switch to another video player, at least use the ‚Äúlazyload‚Äù technique. </blockquote><br><h3>  General cap and menu </h3><br>  The problems were very significant, considering that the header was loaded on ALL pages of all sites: <br><ul><li>  2 calls for A / B testing </li><li>  Sprites instead of CSS </li><li>  Javascript in mouseover events </li><li>  Hundreds of event listeners </li><li>  Over 1100 DOM Elements </li></ul><br>  The team created a special blank page where only the menu header was loaded: this page was loaded for 5 seconds. <br><br>  As a result, the team completely rewrote navigation using HTML / CSS / JS standards, minimized the use of images and DOM passes, and used event delegation. <br><br>  As a result, each page began to load 1-1.5 seconds faster. <br><br><h3>  Using the Control.js library </h3><br>  This library is written by Steve Sanders, and helps developers control how Javascript is loaded and executed. <br><br>  When the script is loaded through the usual &lt;script&gt; tag. <br><br>  The team used Control.js on some pages, but not on all sites.  It turned out that it is not easy to manage the code that was tracking the <code>onload</code> .  Another reason is that not all developers know this technique, and there are difficulties in writing TK for third-party developers. <br><br><h3>  Preloading resources </h3><br>  Preloading was used on pages related to conversions of various types, when it is known in advance what the next page will be, where the user will go. <br><br>  While the user is idle, or enters his data into the form, the resources of the next page are loaded in the background.  When the user gets to the next page, its resources are already in the cache, which allows you to display the page very quickly. <br><br>  The team also optimized a number of other points: rewrote a lot of Javascript code, increased the use of lazy load, changed the infrastructure somewhere and moved to a faster stack. <br><br><h3>  Final results </h3><br><ul><li>  In February 2012, a typical ‚Äúweighed‚Äù page was 1.2 MB and loaded for 15 seconds. </li><li>  At the end of the optimization process in April 2013, the typical page weighed 400 KB and loaded in 3.6 seconds. </li></ul><br>  Visually, the pages were almost the same. <br><br><img src="https://habrastorage.org/files/495/588/c6a/495588c6aa614d94ba0a256b97e91e0a.png"><br><h3>  Impact on business </h3><br>  The team notes that it is rather difficult to measure the impact of this whole process, because it lasted more than a year.  During this time, the company introduced many other changes: in offers, tariff plans, products. <br><br>  However, in specific isolated time periods when the only change was a change in download speed, improvements in conversion were recorded. <br><br>  For example, at the 14th week of 2012, when the only change was to speed up the page load from 9-12 seconds to 5-6 seconds, conversions increased by 14%. <br><br><img src="https://habrastorage.org/files/ce5/4dd/0b1/ce54dd0b1d2346d1b6a8fd28271e3981.png"><br><h2>  How speed affects conversion </h2><br>  The team‚Äôs impact on conversion has been reduced to the following final formula.  Each decrease in page load time by 1 second gives the following effect: <br><ol><li>  If the page loads in 7 seconds or more: + 3% for each second of acceleration </li><li>  If the page loads from 5 to 7 seconds: + 2% per second </li><li>  If the page loads in less than 5 seconds: + 1%. </li></ol><br>  Note: it is important to remember that these are the results of 2013.  Since then, 5 seconds of page load has become quite a long time. </div><p>Source: <a href="https://habr.com/ru/post/303408/">https://habr.com/ru/post/303408/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../303398/index.html">Do you correspond on personal questions from your work computer? Do you know what the European Court thinks about this?</a></li>
<li><a href="../303400/index.html">KUKU.io - how the cloud service is designed for managing social networks</a></li>
<li><a href="../303402/index.html">Databoom control panel. Work with collections. Part 1</a></li>
<li><a href="../303404/index.html">Trying on deduplication and compression to backup</a></li>
<li><a href="../303406/index.html">Several useful tricks for developing on Yii 2</a></li>
<li><a href="../303410/index.html">Adopted a law on Google tax</a></li>
<li><a href="../303412/index.html">Fake Ferrari or why camel hump. How systems with circumcised functionality try to take over the world</a></li>
<li><a href="../303416/index.html">Congratulations to the winners of the "Summer Sprint" PETAMelon</a></li>
<li><a href="../303418/index.html">SaltStack: using salt-ssh</a></li>
<li><a href="../303420/index.html">Interview with the author of Flask Armin Rahner</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>