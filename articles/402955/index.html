<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google‚Äôs dedicated ASIC for machine learning is tens of times faster than a GPU</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Four years ago, Google realized the real potential of using neural networks in its applications. Then she began to implement them everywhere - in the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google‚Äôs dedicated ASIC for machine learning is tens of times faster than a GPU</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/265/7b9/cb4/2657b9cb49834f6ebc249ddcb70c9136.jpg"><br><br>  Four years ago, Google realized the real potential of using neural networks in its applications.  Then she began to implement them everywhere - in the translation of texts, voice search with speech recognition, etc. But it immediately became clear that the use of neural networks greatly increases the load on Google servers.  Roughly speaking, if each person performed a voice search on Android (or dictated text with speech recognition) only three minutes a day, then Google would have to double the number of data centers (!) Just for the neural networks to process this amount of voice traffic. <br><br>  We had to do something - and Google found a solution.  In 2015, it developed its own hardware learning architecture (Tensor Processing Unit, TPU), which is up to 70 times higher than traditional GPUs and CPUs in performance and up to 196 times in number of calculations per watt.  The traditional GPU / CPU refers to general-purpose Xeon E5 v3 (Haswell) processors and Nvidia Tesla K80 graphics processors. <br><a name="habracut"></a><br>  The TPU architecture is described for the first time this week in <a href="https://drive.google.com/file/d/0Bx4hafXDDq2EMzRNcy1vSUxtcEk/view">scientific work (pdf)</a> , which will be presented at the 44th International Symposium on Computer Architectures (ISCA), June 26, 2017 in Toronto.  The lead author of more than 70 authors of this scientific work, <a href="https://www.computer.org/web/awards/eckert-norman-jouppi">distinguished engineer Norman Juppi</a> (Norman Jouppi), known as one of the creators of the MIPS processor, in <a href="https://www.nextplatform.com/2017/04/05/first-depth-look-googles-tpu-architecture/">an interview</a> with <i>The Next Platform</i> explained in his own words the unique features of the TPU architecture, which in fact is a specialized ASIC, that is integrated circuit special purpose. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Unlike conventional FPGAs or highly specialized ASICs, TPU modules are programmed in the same way as a GPU or CPU; this is not a narrow-purpose hardware for a single neural network.  Norman Yuppi says that TPU supports CISC instructions for different types of neural networks: convolutional neural networks, LSTM models and large, fully connected models.  So it still remains programmable, only using the matrix as a primitive, and not vector or scalar primitives. <br><br>  Google stresses that while other developers optimize their microchips for convolutional neural networks, such neural networks provide only 5% of the load in Google data centers.  The main part of Google applications uses <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE%25D1%2581%25D0%25BB%25D0%25BE%25D0%25B9%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25BF%25D0%25B5%25D1%2580%25D1%2586%25D0%25B5%25D0%25BF%25D1%2582%25D1%2580%25D0%25BE%25D0%25BD_%25D0%25A0%25D1%2583%25D0%25BC%25D0%25B5%25D0%25BB%25D1%258C%25D1%2585%25D0%25B0%25D1%2580%25D1%2582%25D0%25B0">Rumelhart's multi-layer perceptrons</a> , which is why it was so important to create a more universal architecture, not ‚Äúsharpened‚Äù just for convolutional neural networks. <br><br><img src="https://habrastorage.org/files/99f/df0/d93/99fdf0d93e494088a3f1fd86791e0b23.png"><br>  <i>One of the elements of the architecture is the systolic engine of the data stream, a 256 √ó 256 array, into which activations (weights) from the neurons to the left arrive, and then everything moves step by step, multiplying by the weights in the cell.</i>  <i>It turns out that the systolic matrix performs 65,536 calculations per cycle.</i>  <i>This architecture is ideal for neural networks.</i> <br><br>  According to Yuppi, the TPU architecture is more like an FPU co-processor than a regular GPU, although numerous multiplication matrices do not store any programs, they simply execute instructions received from the host. <br><br><img src="https://habrastorage.org/files/9ba/2a1/2d1/9ba2a12d11204b74888b70e29ecdf876.png"><br>  <i>All TPU architecture except DDR3 memory.</i>  <i>Instructions are sent from the host (left) to the queue.</i>  <i>Then, the control logic, depending on the instruction, can repeatedly run each of them.</i> <br><br>  It is not yet known how this architecture scales.  Yuppi says that in a system with this kind of host there will always be some kind of bottle neck. <br><br><img src="https://habrastorage.org/files/6c0/87d/3c7/6c087d3c75b744628a716e65a6f0ae5e.png"><br><br>  Compared to conventional CPUs and GPUs, Google‚Äôs machine architecture is dozens of times more powerful.  For example, the Haswell Xeon E5-2699 v3 processor with 18 cores at a clock frequency of 2.3 GHz with 64-bit floating point performs 1.3 tera-operations per second (TOPS) and shows the exchange rate with a memory of 51 GB / s.  In this case, the chip itself consumes 145 watts, and the entire system on it with 256 GB of memory - 455 watts. <br><br>  For comparison, TPU on 8-bit operations with 256 GB of external memory and 32 GB of internal memory shows an exchange rate with memory of 34 GB / s, but the card performs 92 TOPS, that is, approximately 71 times more than the Haswell processor.  The server's power consumption on the TPU is 384 watts. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/fbb/21b/e41/fbb21be41722273b1e79febcd8b6f9ab.jpg"><br><br>  The following graph compares the relative performance per watt of the server with the GPU (blue column), the server on the TPU (red) relative to the server on the CPU.  It also compares the relative performance per watt of the server with the TPU in relation to the server on the GPU (orange) and the improved version of the TPU in relation to the server on the CPU (green) and the server on the GPU (purple). <br><br><img src="https://habrastorage.org/files/d85/52a/445/d8552a4455ed436c9daca5bdba5c1c2e.png"><br><br>  It should be noted that Google conducted comparisons in tests of applications on TensorFlow with the relative old version of Haswell Xeon, while in the newer version of Broadwell Xeon E5 v4 the number of instructions per cycle increased by 5% due to architectural improvements, and in the version of Skylake Xeon E5 v5 which is expected in summer, the number of instructions per cycle may increase by another 9-10%.  And with the increase in the number of cores from 18 to 28 in Skylake, the overall performance of Intel processors in Google tests can improve by 80%.  But even so, there will be a huge difference in performance with TPU.  In the 32-bit floating-point version of the test, the TPU difference with the CPU is reduced to about 3.5 times.  But most models are perfectly quantized to 8 bits. <br><br>  Google thought about how to use GPU, FPGA and ASIC in its data centers since 2006, but it did not find use for them until recently when it introduced machine learning for a number of practical tasks, and the load with billions of requests from users began to grow on these neural networks.  Now the company has no choice but to move away from traditional CPUs. <br><br>  The company does not plan to sell its processors to anyone, but it hopes that the scientific work with the ASIC sample of 2015 will allow others to improve the architecture and create improved versions of ASIC that "raise the bar even higher."  Google itself is probably working on a new version of ASIC. </div><p>Source: <a href="https://habr.com/ru/post/402955/">https://habr.com/ru/post/402955/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../402941/index.html">Pebble smart watches untie from cloud sync</a></li>
<li><a href="../402943/index.html">A world without pensions</a></li>
<li><a href="../402947/index.html">Jeff Bezos spends $ 1 billion a year on Blue Origin development.</a></li>
<li><a href="../402951/index.html">ONYX BOOX MAX Carta Review: Uncompromising A4 Format</a></li>
<li><a href="../402953/index.html">Invented a scheme of withdrawing money from credit cards through pawnshops</a></li>
<li><a href="../402957/index.html">On the inkjet printer printed three-bit RAM</a></li>
<li><a href="../402959/index.html">Windows 10 Creators Update can be downloaded today</a></li>
<li><a href="../402961/index.html">‚ÄúAgain the same thing‚Äù: how to form a playlist on radio stations</a></li>
<li><a href="../402963/index.html">If you stand on the subway escalator in two rows, its capacity increases by 31%</a></li>
<li><a href="../402965/index.html">Geek-key-holder, part II: SmartPoket for large keys, which we did thanks to you</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>