<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Watch Dogs in real life, or serious vulnerabilities in access control systems</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It seems to me that many guys, especially at a young age, wanted to be cool hackers. Hack sites, phones, access systems. So I still have a little boyi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Watch Dogs in real life, or serious vulnerabilities in access control systems</h1><div class="post__text post__text-html js-mediator-article"><p>  It seems to me that many guys, especially at a young age, wanted to be cool hackers.  Hack sites, phones, access systems.  So I still have a little boyish enthusiasm.  Therefore, periodically poking around in various software and did not find anything worthwhile.  But one day, I turned up luck, and even some!  ACS, full of vulnerabilities that allow access to the management of the entire system (opening / closing doors, adding your own pass card, etc.). </p><br><p>  Interesting?  Then welcome under the cat! <a name="habracut"></a></p><br><p>  <em>Everything described below was carried out on a test stand.</em>  <em>The article is written solely for informational purposes and in general this is all an invention of the author.</em> </p><br><p>  <em>ACS - access control system</em> </p><br><p>  It so happened that at one time I worked at a road construction company, where I wrote a set of programs for issuing permits, issuing food for these permits and reporting.  It took me to integrate all of this with one fairly popular access control system.  The developers have long responded to requests for documentation, and the deadlines were burning.  I had to understand their software myself. </p><br><p><img src="https://habrastorage.org/webt/0g/wf/ui/0gwfuitutvoja-8a8a4fmkpfmyq.jpeg" alt="image"><br>  <em>Approximate scheme of work of SKUD</em> </p><br><p>  I started learning from the database.  The access control server works with the firebird 2.5 database.  The login and password to it turned out to be standard, which is already very alarming, but the password can be set in the program settings.  Passwords in the database to the accounts are hashed, but without salt, which is bad, but again uncritical.  It stores all zones of passage, users, numbers of their cards, accesses and addresses of controllers. </p><br><p><img src="https://habrastorage.org/webt/s-/ia/jd/s-iajdlqzr1g3gnpqbkvycgolei.png" alt="image"><br>  <em>DB</em> </p><br><p>  Then we take some program for sniffing traffic (I took ‚ÄúSmatrSniff‚Äù, the first one that could see the localhost traffic) and see what the client sends to the server.  All data is sent over TCP and part over UDP in unencrypted form.  And here the most interesting begins.  The server first sends in open form the password from the database, its location and only then checks the login and password! </p><br><p><img src="https://habrastorage.org/webt/cl/wp/ea/clwpeapmkhgsvlbtwghlbtlzue4.png" alt="image"><br>  <em>Password from the base "masterkey"</em> </p><br><p>  It turns out that, without knowing the login and password, we can get full access to the database, which gives us almost unlimited possibilities.  We can issue a card with access to any object.  Register your card to another user and enter under his name.  But in order for this data to be loaded onto the controllers, you need to give a command to the server from the client.  Although we can take the password to the client from the database, use the open MD5 bases and try to pick up the password to the hash (I remind you that the passwords in the database are without salt), but if the password is complex, then most likely nothing will come of it.  We'll have to wait for someone to click on the full unload button. </p><br><p>  Then I looked, but does authorization affect anything at all?  For this, I tried to repeat requests to the server using the ‚ÄúTCP / IP Builder‚Äù.  And yes, subsequent requests to the server, without authorization, do not work (sends a response in response to a failure).  Here I am a little sad because the integration will have to implement the repetition of the entire authorization chain and only then send the package to download data to the controller. </p><br><p>  Finally, I decided to repeat the request to transfer the door to open mode.  The server responded ‚Äúok‚Äù, and the door squealed.  Without any authorization.  I repeated this from another computer on the local network and it worked too. </p><br><p><img src="https://habrastorage.org/webt/cb/kg/zx/cbkgzxa4tjxpoqnn-5rjkb6iqt8.jpeg" alt="image"><br>  <em>Approximate package view</em> </p><br><p>  This means that we can open / close any door from any computer on the local network.  Register your card and immediately download this data to the controllers.  After that, calmly walk through the objects and delete all logs of our visit. </p><br><p>  I killed a couple of hours to study the protocol of communication between the controller and the server in order to break it completely, but I didn‚Äôt manage to fully understand the data format.  But I am sure that there is no protection here either.  The packages exactly have the mac-addresses of the controller and server / gateway (binding to the server goes to the mac-address, there are no encryption keys and the like in the database, so you can most likely pretend to be a server for the controller if you know the mac server).  Unfortunately, there are no dumps and access to the equipment, so I can‚Äôt show it. </p><br><p>  As a result, we have a complete ACS vulnerabilities that give us unlimited access to the passage to the objects.  Because of the cheapness of the components and free software, this access control system is very common.  She stands in many schools in Moscow, and I saw her at other sites.  The company is proud of prizes at various events.  I do not specifically name the name of this organization, and I also did not write to them about it.  Because I think that such vulnerabilities at the architecture level cannot be fixed without rewriting all the software from scratch and updating all the equipment of people who bought this system (there are some more serious holes at the architecture level, but their description would have tripled the article).  Those who have learned from the access control screen and it is installed at you - I advise you to completely isolate the network (which seems to be considered ‚Äúbest practices‚Äù) in which all the components of the system are located, and access to the database to add employees only through VPN.  Proper routing configuration can also help. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/452458/">https://habr.com/ru/post/452458/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../452440/index.html">Mal, yes Del: a real look at the Japanese project Minimal Fab</a></li>
<li><a href="../452442/index.html">We play in the browser console</a></li>
<li><a href="../452444/index.html">Deal for $ 39 million: why the creators of the open source DBMS decided to engage in mobile development</a></li>
<li><a href="../452446/index.html">How we are analyzed in shops and restaurants - continuation of the story</a></li>
<li><a href="../452450/index.html">Glitter and poverty: a little more about how modern musicians make their living</a></li>
<li><a href="../45246/index.html">nopCommerce - open source e-shop</a></li>
<li><a href="../452462/index.html">About OOP</a></li>
<li><a href="../452466/index.html">Braille keyboard</a></li>
<li><a href="../452468/index.html">"If you need to kill someone, then you came to the right place."</a></li>
<li><a href="../452474/index.html">Wavelet analysis. Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>