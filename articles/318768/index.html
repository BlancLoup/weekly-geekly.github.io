<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Second Coming GOST 28147-89: Honest Tests</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="About ten years ago, symmetric cryptography, based on GOST 28147-89, ceased to meet the needs of hardware platforms in terms of speed parameters. The ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Second Coming GOST 28147-89: Honest Tests</h1><div class="post__text post__text-html js-mediator-article"> About ten years ago, symmetric cryptography, based on GOST 28147-89, ceased to meet the needs of hardware platforms in terms of speed parameters.  The speed of crypto-transformations provided by algorithms implemented on general-purpose registers of processors did not keep pace with the speed of information exchange in networks and on disk drives. <br><br>  On the other hand (American), AES-256 appeared, which showed much better speed parameters with the same degree of cryptographic strength. <br><br>  In this situation, the 8th FSB center began work on a new block cipher, which later received the name "Grasshopper" from the initial letters of the authors' last names. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Initially, it was a hopeless undertaking, since the logic of the AES cipher was repeated, but if it was accelerated by hardware in Intel and AMD processors, then the Grasshopper certainly could not have such hardware acceleration on these processors. <br><br>  So Grasshopper is a classic example of budget money thrown away and not small ... <br><a name="habracut"></a><br>  But there was another option to speed up cryptographic operations; unfortunately, he did not receive official support for specific reasons.  This option involves the development of algorithms for implementing GOST 28147-89 for multithreading and the refinement of the standard itself to meet the requirements of multithreading. <br><br>  Multithreading is based on three new methods of implementing GOST 28147-89 in x86-64 architecture processors. <br><br>  The first is the pipeline operation of the processor in encryption mode.  The second is the implementation of the replacement unit on the SSE / AVX processor commands.  The third is the use of specialized registers XMM / YMM / ZMM, having a width of 16/32/64 bytes. <br><br>  These new methods together made it possible to increase the encryption speed according to GOST 28147-89 by at least an order of magnitude and ensure the high-speed encryption parameters are not worse than the American AES-256, which uses a special crypto accelerator in Intel / AMD processors. <br><br>  But, as they say, the god of the Rogue marks, and time puts everything in its rightful places. <br>  Currently, the cipher "Grasshopper" is perceived as exotic and has no practical use due to the low conversion speed and dubious reputation, manufacturers began to use multi-threaded encryption according to GOST 28147-89 instead.  But they try not to talk about this, because they know that copyrights are being violated. <br><br>  <b>Encryption acceleration methods are patented.</b> <br><br>  Largely because of this, there were no honest tests for the speed of various encryption systems, and in online publications and on forums all sorts of fabulous and completely unfounded figures walked, having nothing to do with reality. <br><br>  Therefore, a stable myth about the superiority of AES-256 over GOST 28147-89 in terms of speed parameters almost ten times took shape ... <br><br>  It is time to conduct an honest test. <br><br>  <b>Honest Tests</b> <br><br>  In the articles devoted to cryptographic transformations, various ‚Äúfantastic‚Äù data on the speed of the crypto function work are given, there is a lot of cunning in these figures.  We will be honest, no "synthetic" tests, all "for real". <br><br>  Encryption is essentially a service background process.  Crypto-procedure works in the background of much more important tasks and the situation with 100% processor load encryption is exotic.  Therefore, we will not speed up the crypto function by increasing the priority and the number of processor cores used; we will limit the maximum processor load to a crypto function of 15%. <br><br>  In the demo version of the program <b>FastSecurityBoxs</b> (a <i>proprietary handicrafts, please write in the comments</i> ) create dumps of encrypted disks on a four-core Skylake processor with a frequency of 2.6 g Hertz, hypertrading is activated (only 8 logical cores).  The cryptographic procedure works on one logical core (out of 8 available), respectively, the CPU load created by it does not exceed 12-15 percent, which corresponds to the actual work of the background task.  Two SSD disks were used for copying, the read / write speed on them in the file system mode is approximately 450-500MB / s.  on a cleaned device, after running TRIM. <br>  Here is a clean copy without cryptography: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f1c/996/b75/f1c996b75b1d9940b1bfb26a7eebeda5.png" alt="image"><br><br>  Reading disk sectors ( <b>ProjectFK.exe</b> ) takes 5%, writing to a file (System) takes 2% of processor time at a speed of 449 MB / s.  Let us remember these numbers, when we turn on cryptography, the costs of crypto-transformations will be added to them, respectively, it will be possible to estimate the costs of the crypto-transformation of the processor load. <br><br>  Now, creating a dump, turn on cryptography.  First, encryption in 8 streams according to GOST 28147-89: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/acf/09d/058/acf09d05879681d2d76ba2c36fb930cb.png" alt="image"><br><br>  Screenshot of creating backup copies of disks using crypto-transformation strictly according to GOST in 8 streams. <br><br>  The speed of a cryptographic dump that is actually created is 190 MB / s.  The speed is limited by crypto-transformation, since the CPU load generated by the ProjectFK. Exe program is 12%, in our case it is the limit on the load of the processor's logical core.  SSD drives can work much faster, but they are hampered by the restriction on the use of only half of one physical processor core in cryptographic procedures. <br><br>  <b>The crypto-transformation in the ProjectFK program spends 7% of the CPU load.</b> <br><br>  Now encryption in 16 streams according to GOST 28147-89: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e2d/98e/840/e2d98e8402e4c7572b6f73f0c916f27d.png" alt="image"><br><br>  Screenshot of creating backup copies of disks using crypto-transformation strictly according to GOST in 16 streams.  This mode works effectively only on Intel processors of the Skylake generation and higher, but this will be discussed later. <br><br>  The speed increased to 334 mbyte / s.  The CPU load is 10.5%, here the restriction also creates crypto-transformation, but the load on the logical processor core is reduced. <br><br>  <b>5.5% of the processor load is spent on crypto-transformation in the ProjectFK program.</b> <br><br>  Well, what can AES encryption provide?  Take the most advanced solution using this cipher, Bitlocker.  The encryption function is built into his OS kernel and is optimized as much as possible; it‚Äôs not a user application like FastSecurityBoxs, so it has a significant handicap ... <br><br>  This is what Bitlocker gives (AES-128 for 10 rounds) when creating a dump on an encrypted disk: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/77c/156/008/77c156008eb184a896d27c3126bbf408.png" alt="image"><br><br>  Here, the ProjectFK.exe program only creates a dump, this dump is encrypted by the Bitlocker directly in the System process that writes it to disk, respectively, you need to summarize the processor loads created by both these processes.  The load is 12.5 percent of the processor time at the rate of creating an encrypted dump of 392 MB / s. <br><br>  <b>In the System process, 5% of the processor load is spent on crypto-transformation.</b> <br><br>  Not bad at all, just keep in mind that AES-128 is not equal to GOST 28147-89, they are from different weight categories of cryptographic resistance. <br><br>  <b>"Dry residue" tests</b> <br><br>  Encryption according to GOST 28147-89 in the background (5-7% of the CPU load), at a speed of 200 MB / s., Is already fantastic, these parameters are not in any real-world applications, with hardware accelerated AES-256 cryptography for 14 rounds condition. <br><br>  In AES-128 mode, it is possible to work a little faster on 10 rounds, but the cryptographic strength of this algorithm is much lower than that of GOST 28147-89 due to the size of the key being twice as small. <br><br>  <b>We state the obvious.</b>  The cryptographic procedure according to strict GOST 28147-89 in a multi-threaded version is capable of running in the background at speeds of 200-400 MBytes / s, loading the processor by only 5-7 percent.  But nothing prevents to raise the speed and higher, increasing the CPU load. <br><br>  According to strict GOST 28147-89, in a multi-threaded mode, the FSB-certified cryptographic tool can provide background encryption of modern SSD and HDD disks on the SATA interface with a processor load of this operation not more than 7%.  This allows the use of GOST 28147-89 in programs like Bitlocker even more efficiently than the currently used American standard AES-128, but with much more ‚Äústrong‚Äù cryptographic protection ... <br><br>  For disks on the interface, NVMe is already operating at speeds of 2‚Äì3 Gbyte / s.  and for 10G / 10G + networks, you need to increase the speed at least another two times. <br><br>  There are two ways.  The first, passive path has already been tested, when we switched from 8 streams to 16 streams when implementing GOST 28147-89.  You can wait for the AVX-512 instruction set to be implemented in the processor.  These commands operate on 64-byte registers and can provide multi-threaded execution according to strict GOST 28147-89 in 32 threads at once.  That will automatically double the performance of the crypto function. <br><br>  There is a small ‚Äúbut‚Äù, a processor with support for the AVX-512 will only appear next year, and the AVX-512 commands will first be emulated by firmware, which means they will be executed very slowly.  So slowly that using them in real programs is pointless. <br><br>  We have already seen this in the example of the introduction of AVX2 commands, 3 years passed between the appearance of this instruction set and the translation of its execution into a hardware cycle.  Only in 2016 Intel introduced hardware support for AVX2 commands on Skylake generation processors. <br><br>  Wait for Intel to transfer the AVX-512 to a hardware implementation will need about 3 more years ... <br><br>  The second way is active, it is to develop a new encryption algorithm, originally sharpened on multithreading, because now only a small part of the potential of parallel computing is used. <br><br>  So let's take this further, do not wait for 3 years ... So expect in the near future the third coming of GOST 28147-89. </div><p>Source: <a href="https://habr.com/ru/post/318768/">https://habr.com/ru/post/318768/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318758/index.html">Why this winter we again invite everyone to play computer games using artificial intelligence</a></li>
<li><a href="../318760/index.html">3CX brings together Elastix and PBX in a Flash communities</a></li>
<li><a href="../318762/index.html">Programming multi-core DSP processors TMS320C66x using OpenMP</a></li>
<li><a href="../318764/index.html">Roaming in Wi-Fi networks without using a controller</a></li>
<li><a href="../318766/index.html">Founder's advice. Evgeny Kobzev, technical director and co-founder of the company "Button"</a></li>
<li><a href="../318770/index.html">Cdr. Save and Grow</a></li>
<li><a href="../318772/index.html">Pimcore licensing FAQ</a></li>
<li><a href="../318774/index.html">About recovery. Is RAID on a VPS SSD advisable in case of dedicated drives? Analog server until February for free</a></li>
<li><a href="../318776/index.html">Stylish Python code, or learning to use Flake8</a></li>
<li><a href="../318778/index.html">PHPixie Cache: PSR-6, PSR-16 and some interesting features</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>