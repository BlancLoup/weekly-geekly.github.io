<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Network factory for the data center Cisco ACI - to help admin</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="With the help of this magic piece of the Cisco ACI script, you can quickly set up a network. 

 The network factory for the Cisco ACI data center has ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Network factory for the data center Cisco ACI - to help admin</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/sy/ml/l2/symll2m6gww_cyira-8xkwg5i3a.jpeg"><br>  <i>With the help of this magic piece of the Cisco ACI script, you can quickly set up a network.</i> <br><br>  The network factory for the Cisco ACI data center has existed for five years, but nothing was said about it at Habr√©, so I decided to fix it a bit.  I'll tell you in my own experience what it is, what is the use of it and where is its rake. <br><br><h3>  What is it and where did it come from? </h3><br>  By the time ACI (Application Centric Infrastructure) was announced in 2013, competitors were approaching traditional approaches to data center networks from three sides at once. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      On the one hand, the first-generation SDN solutions based on OpenFlow promised to make networks more flexible and cheaper at the same time.  The idea was to make decision making, traditionally performed by proprietary switch software, on a central controller. <br><br>  This controller would have a single vision of everything that happens and, based on this, would program the hardware of all switches at the level of rules for processing specific threads. <a name="habracut"></a><br>  On the other hand, overlay network solutions made it possible to implement the necessary connectivity and security policies without any changes in the physical network, building software tunnels between virtualized hosts.  The most famous example of this approach was Nicira's solution, which by that time had already been acquired by VMWare for $ 1.26 billion and gave rise to the current VMWare NSX.  Some piquancy of the situation was added by the fact that the co-founders of Nicira were the same people who previously stood at the origins of OpenFlow, who now said that it was <a href="https://searchnetworking.techtarget.com/news/2240174517/Why-Nicira-abandoned-OpenFlow-hardware-control">not suitable</a> for building a data center factory <a href="https://searchnetworking.techtarget.com/news/2240174517/Why-Nicira-abandoned-OpenFlow-hardware-control">OpenFlow</a> . <br><br>  And finally, switching chips available on the open market (what is called merchant silicon) have reached a maturity level at which they became a real threat to traditional switch manufacturers.  If earlier each vendor himself developed chips for his switches, then over time, chips from third-party manufacturers, first of all, from Broadcom, began to reduce the distance from vendor chips in terms of functions, and exceeded them in price / performance ratio.  Therefore, many believed that the days of switches on self-developed chips are numbered. <br><br>  ACI has become Cisco‚Äôs ‚Äúasymmetric response‚Äù (more precisely, Insieme, which was incorporated into it by its former employees) for all of the above. <br><br><h3>  What is the difference with OpenFlow? </h3><br>  In terms of the distribution of functions, ACI is actually the opposite of OpenFlow. <br>  In the OpenFlow architecture, the controller is responsible for writing detailed rules (streams) <br>  in the equipment of all switches, that is, in a large network, it may be responsible for maintaining and, most importantly, changing tens of millions of records in hundreds of points in the network, so its performance and reliability in large-scale implementation become a bottleneck. <br><br>  ACI uses the opposite approach: the controller also, of course, exists, but switches receive high-level declarative policies from it, and the switch itself renders them in details of specific settings in the equipment.  The controller can be rebooted or turned off altogether, and nothing bad will happen to the network, except, of course, the lack of control at this moment.  Interestingly, in ACI there are situations in which OpenFlow is still used, but locally within the host for programming Open vSwitch. <br><br>  ACI is built entirely on VXLAN-based overlay transport, but it also includes the underlying IP transport as part of a single solution.  Cisco called this the term "integrated overlay."  In most cases, factory switches are used as the point of termination of overlays in ACI (they do this at the speed of the channel).  Hosts are not required to know something about the factory, encapsulations, etc., however, in some cases (for example, to connect OpenStack-hosts) VXLAN traffic can be communicated to them. <br><br>  Overlays are used in ACI not only to provide flexible connectivity through the transport network, but also to transmit meta information (it is used, for example, to apply security policies). <br><br>  The chips from Broadcom used to be used by Cisco in the Nexus 3000 series switches. The Nexus 9000 family, specifically released to support ACI, originally implemented a hybrid model, which was called Merchant +.  In the switch, both the new Broadcom Trident 2 chip and the Cisco development chip complementing it, implementing all the ACI magic, were used at the same time.  Apparently, this allowed us to speed up the output of the product and reduce the switch price tag to a level close to the models just for Trident 2. This approach was enough for the first two or three years of ACI supply.  During this time, Cisco has developed and launched the next generation Nexus 9000 already on its own chips with higher performance and feature set, but at the same price level.  External specifications in terms of interaction in the factory are fully preserved.  At the same time, the internal filling has completely changed: something like refactoring, but for iron. <br><br><h3>  How the Cisco ACI Architecture Works </h3><br>  In the simplest case, ACI is based on the topology of the Clos network, or, as it is often said, Spine-Leaf.  Spine-level switches can be from two (or one, if we do not care about fault tolerance) to six.  Accordingly, the more of them, the higher the fault tolerance (the smaller the reduction in bandwidth and reliability in the event of an accident or the servicing of one Spine) and overall performance.  All external connections go to Leaf-level switches: these are servers, and docking with external networks via L2 or L3, and connecting APIC controllers.  In general, with ACI, not only tuning, but also collecting statistics, monitoring failures, and so on - everything is done through the interface of controllers, of which there are three pieces in regular-size implementations. <br><br>  The console never has to connect to the switches, even to start the network: the controller itself detects the switches and builds a factory out of them, including the settings of all service protocols, so, by the way, it‚Äôs very important to record serial numbers of the installed equipment during installation, so that you won‚Äôt which rack is located.  For troubleshooting, the switches can be connected via SSH, if necessary, with the usual Cisco show commands that are carefully reproduced. <br><br>  Inside, the factory uses IP transport, so there is no spanning tree and other horrors of the past: all links are involved, and the convergence with failures is very fast.  Traffic in the factory is transmitted through VXLAN based tunnels.  More specifically, Cisco itself calls iVXLAN encapsulation, and it differs from regular VXLAN in that the reserved fields in the network header are used to transfer service information, primarily about the relationship of traffic to the EPG group.  This allows you to implement the rules of interaction between groups in the equipment, using their numbers in the same way as usual access lists use addresses. <br><br>  The tunnels allow you to stretch through the internal IP transport and L2-segments, and L3 (that is, VRF).  At the same time, the default gateway is distributed.  This means that each switch is involved in routing the traffic that enters the factory.  In terms of traffic logic, ACI is similar to a VXLAN / EVPN based fabric. <br><br><h3>  If so, what is the difference?  Everything else! </h3><br>  The difference number one that you come across in ACI is how they are included in the server's network.  In traditional networks, the inclusion of both physical servers and virtual computers goes to VLANs, and everything else dances from them: connectivity, security, etc. In ACI, they use a construction that Cisco calls EPG (End-point Group), from which get away  Is it possible to equate it with VLAN?  Yes, but in this case there is a chance to lose most of what ACI gives. <br><br>  With respect to the EPG, all access rules are formulated, and the ACI principle by default uses the ‚Äúwhite list‚Äù principle, that is, only traffic is allowed, which is allowed to be passed explicitly.  That is, we can create EPG-groups ‚ÄúWeb‚Äù and ‚ÄúMySQL‚Äù and define a rule allowing interaction between them only on port 3306. This will work without binding to network addresses and even within the same subnet! <br><br>  We have customers who have chosen ACI because of this feature, because it allows you to restrict access between servers (virtual or physical - it does not matter) without dragging them between subnets, which means without touching the addressing.  Yes, yes, we know, because no one handles IP addresses in application configurations, right? <br><br>  The rules for passing traffic to ACI are called contracts.  In such a contract, one or several groups or levels in a multi-tier application become a service provider (say, a database service), others become a consumer.  A contract can simply skip traffic, and can do something more cunning, for example, send it to a firewall or balancer, and also change the QoS value. <br><br>  How do servers get into these groups?  If these are physical servers or something included in the existing network into which we created the VLAN trunk, then in order to place them in the EPG you will need to point to the switch port and the VLAN used on it.  As you can see, VLANs appear where you can not do without them. <br><br>  If the servers are virtuals, then it is enough to refer to the connected virtualization environment, and then everything happens by itself: a port-group will be created (if to speak in terms of VMWare) to connect the VM, the necessary VLANs or VXLANs are assigned, the necessary ports of switches are configured, etc. So, although ACI is built around a physical network, connections for virtual servers look much easier than for physical ones.  ACI already has a bundle with VMWare and MS Hyper-V, as well as support for OpenStack and RedHat Virtualization.  At some point, there was also built-in support for container platforms: Kubernetes, OpenShift, Cloud Foundry, while it concerns the application of policies and monitoring, that is, the network administrator can immediately see on which hosts which subsets work and which groups they belong to. <br><br>  In addition to being included in a particular port group, virtual servers have additional properties: name, attributes, etc., which can be used as criteria for transferring them to another group, for example, when renaming a VM or when an additional tag appears.  Cisco calls this the microsegmentation groups, although, by and large, the design itself with the ability to create many security segments in the form of an EPG on the same subnet is also quite a microsegmentation.  Well, the vendor knows better. <br><br>  The EPGs themselves are purely logical constructions that are not tied to specific switches, servers, etc., so that with them and constructions based on them (applications and tenants) you can do things that are difficult to do in regular networks, for example, to clone.  As a result, say, it is very easy to create a clone of the production environment in order to get a test environment that is guaranteed to be identical to the product.  You can do it manually, but better (and easier) - through the API. <br><br>  In general, the control logic in ACI is not at all like what you usually meet <br>  in traditional networks from the same Cisco: the software interface is primary, and the GUI or CLI is secondary, because they work through the same API.  Therefore, almost everyone who is involved in ACI, after a while begins to navigate the object model used for management, and automate something to fit their needs.  The easiest way to do this is from Python: there are convenient ready-made tools for it. <br><br><h3>  Promised rake </h3><br>  The main problem is that many things in ACI are done differently.  To start working with it normally, you need to relearn.  This is especially true of network operation teams in large customers, where engineers have been involved in ‚Äúprescribing VLANs‚Äù for years on request.  The fact that now VLANs are no longer VLANs, but for laying new networks to virtualized hosts, you don‚Äôt need to create VLANs with your hands at all, completely ‚Äútearing down the roof‚Äù of traditional networkers and forcing them to cling to familiar approaches.  It should be noted that Cisco has tried to sweeten the pill a bit and added a ‚ÄúNXOS-like‚Äù CLI to the controller, which allows you to configure from an interface similar to traditional switches.  But still, in order to start using ACI normally, you will have to understand how it works. <br><br>  From the point of view of prices on large and medium-sized networks, the ACI network doesn‚Äôt actually differ from traditional networks on Cisco equipment, since the same switches are used to build them (Nexus 9000 can work in ACI and in traditional mode now) main workhorse for new data center projects).  But for the data centers of the two switches, the presence of controllers and Spine-Leaf-architecture, of course, make themselves felt.  Recently, Mini ACI-factory appeared, in which two of the three controllers were replaced by virtual machines.  This reduces the cost difference, but it still remains.  So for the customer, the choice is dictated by how interested he is in security features, integration with virtualization, a single point of management, and so on. </div><p>Source: <a href="https://habr.com/ru/post/455882/">https://habr.com/ru/post/455882/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../455874/index.html">Electron application notarization procedure for macOS 10.14.5</a></li>
<li><a href="../455876/index.html">Performance Comparison: JavaScript vs Compiled Languages</a></li>
<li><a href="../455878/index.html">Scenarios of video analytics in retail. In the footsteps of "Video Analytics in Retail"</a></li>
<li><a href="../45588/index.html">Interview with Nikita Sherman (Odnoklassniki.Ru)</a></li>
<li><a href="../455880/index.html">New serialization may appear in java</a></li>
<li><a href="../455884/index.html">VS Code Extension - Snippets - I'll tell you how to save time</a></li>
<li><a href="../455886/index.html">Give the name of the star and exoplanet in the system HAT-P-3</a></li>
<li><a href="../455888/index.html">Internet for summer resident. Part 3. Russian go</a></li>
<li><a href="../455890/index.html">The truth about contactless payments in fitness bracelets</a></li>
<li><a href="../455894/index.html">Online Trends 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>