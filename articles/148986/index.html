<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Examples of working with the Google Map API using Java</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, habrovchane. 

 I want to share some experience using Google Maps API Web Services. 
 In this article I will explain how to use servic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Examples of working with the Google Map API using Java</h1><div class="post__text post__text-html js-mediator-article">  Good afternoon, habrovchane. <br><br>  I want to share some experience using Google Maps API Web Services. <br>  In this article I will explain how to use services for geocoding, geo-decoding. <br>  Just as you can find distances and routes between points.  And, of course, I will touch upon the solution of the problem ‚Äúwhere to go closer there or there." <br><a name="habracut"></a><br>  To begin with, we will define third-party libraries, whose help we will need. <br><br><h3>  Instruments </h3><br>  Google Maps API Web Services can return messages using <strong>json</strong> and <strong>xml</strong> .  Google recommends using json, I also prefer it, because it is smaller and clearer.  To work with json, we will use the <a href="http://www.json.org/">org.json</a> library, it is not large and performs all the tasks that I need. <br>  Additionally, we will use the <a href="http://code.google.com/p/guava-libraries/">guava</a> library to work with collections. <br>  And, of course, jdk 1.6. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To contact web services and get an answer in json, <strong>let's</strong> write the <strong>JsonReader</strong> class. <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JsonReader</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readAll</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Reader rd)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> StringBuilder sb = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> cp; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ((cp = rd.read()) != -<span class="hljs-number"><span class="hljs-number">1</span></span>) { sb.append((<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>) cp); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sb.toString(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> JSONObject </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> String url)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException, JSONException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> InputStream is = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> URL(url).openStream(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> BufferedReader rd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BufferedReader(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InputStreamReader(is, Charset.forName(<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String jsonText = readAll(rd); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> JSONObject json = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JSONObject(jsonText); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> json; } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { is.close(); } } }</code> </pre> <br><br>  For convenience, we will store the request parameters in the map, in order to get a path of the form <strong>key1 = value1 &amp; key2 = value2 ...</strong> from the map, we will write a static method. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">encodeParams</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Map&lt;String, String&gt; params)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String paramsUrl = Joiner.on(<span class="hljs-string"><span class="hljs-string">'&amp;'</span></span>).join(<span class="hljs-comment"><span class="hljs-comment">//    key1=value1&amp;key2=value2... Iterables.transform(params.entrySet(), new Function&lt;Entry&lt;String, String&gt;, String&gt;() { @Override public String apply(final Entry&lt;String, String&gt; input) { try { final StringBuffer buffer = new StringBuffer(); buffer.append(input.getKey());//    key=value buffer.append('='); buffer.append(URLEncoder.encode(input.getValue(), "utf-8"));//       HTML 4.01 return buffer.toString(); } catch (final UnsupportedEncodingException e) { throw new RuntimeException(e); } } })); return paramsUrl; }</span></span></code> </pre><br><br>  We decided on the tools, let's get to the point. <br><br><h3>  Geocoding and geo decoding </h3><br><blockquote>  Geocoding is the process of converting addresses (such as 1600 Parkway Amphitheater, Mountain View, CA) into geographic coordinates (such as latitude 37.423021 and longitude -122.083739) that can be used to place markers or positioning a map.  The Google Geocoding API service provides direct access to the geocoder via an HTTP request.  Also, this service allows you to perform the reverse action (translation of coordinates into addresses).  This process is called reverse geocoding. </blockquote><br><br>  Consider a request to the geocoding service, using the example of the address Russia, Moscow, Poklonnaya Street, 12. <br>  The path to the <a href="http://maps.googleapis.com/maps/api/geocode/output%3Fparameters">maps.googleapis.com/maps/api/geocode/output?parameters</a> service, the structure of the request and response is described in detail <a href="https://developers.google.com/maps/documentation/geocoding/%3Fhl%3Dru">here</a> and <a href="https://developers.google.com/maps/documentation/geocoding/%3Fhl%3Dru">here</a> . <br><br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> main(final String[] args) throws IOException, JSONException { final String baseUrl = "http://maps.googleapis.com/maps/api/geocode/json";//   Geocoding API  HTTP final Map&lt;String, String&gt; params = Maps.newHashMap(); params.put("sensor", "false");//           params.put("address", ", ,  , 12");// ,    final String url = baseUrl + <span class="hljs-string"><span class="hljs-string">'?'</span></span> + encodeParams(params);//     <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span>.println(url);// ,          final JSONObject response = JsonReader.<span class="hljs-keyword"><span class="hljs-keyword">read</span></span>(url);//          //               // //results[<span class="hljs-number"><span class="hljs-number">0</span></span>]/geometry/<span class="hljs-keyword"><span class="hljs-keyword">location</span></span>/lng  //results[<span class="hljs-number"><span class="hljs-number">0</span></span>]/geometry/<span class="hljs-keyword"><span class="hljs-keyword">location</span></span>/lat JSONObject <span class="hljs-keyword"><span class="hljs-keyword">location</span></span> = response.getJSONArray("results").getJSONObject(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">location</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">location</span></span>.getJSONObject("geometry"); <span class="hljs-keyword"><span class="hljs-keyword">location</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">location</span></span>.getJSONObject("location"); final <span class="hljs-type"><span class="hljs-type">double</span></span> lng = <span class="hljs-keyword"><span class="hljs-keyword">location</span></span>.getDouble("lng");//  final <span class="hljs-type"><span class="hljs-type">double</span></span> lat = <span class="hljs-keyword"><span class="hljs-keyword">location</span></span>.getDouble("lat");//  <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span>.println(String.format("%f,%f", lat, lng));//     }</code> </pre><br><br>  Console: <br><pre> http://maps.googleapis.com/maps/api/geocode/json?sensor=false&amp;address=%D0%A0%D0%BE%D1%81 %D1% 81% D0% B8% D1% 8F % 9C% D0% BE% D1% 81% D0% BA% D0% B2% D0% B0% 2C +% D1% 83% D0% BB% D0% B8% D1% 86% D0% B0 +% D0% 9F% D0 % BE% D0% BA% D0% BB% D0% BE% D0% BD% D0% BD% D0% B0% D1% 8F% 2C + 12
 55.735893,37.527420
</pre><br><br>  Now we perform the inverse operation, replacing in the <strong>address</strong> parameters with <strong>latlng</strong> <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> String[] args)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException, JSONException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String baseUrl = <span class="hljs-string"><span class="hljs-string">"http://maps.googleapis.com/maps/api/geocode/json"</span></span>;<span class="hljs-comment"><span class="hljs-comment">//   Geocoding API  HTTP final Map&lt;String, String&gt; params = Maps.newHashMap(); params.put("language", "ru");//  ,      params.put("sensor", "false");//           //   /,        ,   //   ,     params.put("latlng", "55.735893,37.527420"); final String url = baseUrl + '?' + encodeParams(params);//     System.out.println(url);// ,          final JSONObject response = JsonReader.read(url);//          //  ,             // //results[0]/formatted_address final JSONObject location = response.getJSONArray("results").getJSONObject(0); final String formattedAddress = location.getString("formatted_address"); System.out.println(formattedAddress);//   }</span></span></code> </pre><br><br>  Console: <br><pre> http://maps.googleapis.com/maps/api/geocode/json?sensor=false&amp;latlng=55.735893%2C37.527420&amp;language=ru
 Poklonnaya st., 12, Moscow, Russia, 121170
</pre><br><br><h3>  Calculation of distances between points </h3><br>  To calculate the distance, it would be logical to get two points and calculate the total by the formula. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> EARTH_RADIUS = <span class="hljs-number"><span class="hljs-number">6371</span></span>.; <span class="hljs-comment"><span class="hljs-comment">//   public static void main(final String[] args) throws IOException, JSONException { final Point subwayStationPoint = getPoint(", ,  , 12"); final Point addressPoint = getPoint(", ,    "); //     final double dlng = deg2rad(subwayStationPoint.lng - addressPoint.lng); final double dlat = deg2rad(subwayStationPoint.lat - addressPoint.lat); final double a = sin(dlat / 2) * sin(dlat / 2) + cos(deg2rad(addressPoint.lat)) * cos(deg2rad(subwayStationPoint.lat)) * sin(dlng / 2) * sin(dlng / 2); final double c = 2 * atan2(sqrt(a), sqrt(1 - a)); System.out.println("distance: " + c * EARTH_RADIUS); //     } /** *  ,     * */ private static class Point { public double lat; public double lng; public Point(final double lng, final double lat) { this.lng = lng; this.lat = lat; } @Override public String toString() { return lat + "," + lng; } } /** *   * * @param address * @return * @throws IOException * @throws JSONException */ private static Point getPoint(final String address) throws IOException, JSONException { final String baseUrl = "http://maps.googleapis.com/maps/api/geocode/json";//   Geocoding API  HTTP final Map&lt;String, String&gt; params = Maps.newHashMap(); params.put("sensor", "false");// ,          //  params.put("address", address);// ,    final String url = baseUrl + '?' + encodeParams(params);//     System.out.println(url);//         final JSONObject response = JsonReader.read(url);//          //               // //results[0]/geometry/location/lng  //results[0]/geometry/location/lat JSONObject location = response.getJSONArray("results").getJSONObject(0); location = location.getJSONObject("geometry"); location = location.getJSONObject("location"); final double lng = location.getDouble("lng");//  final double lat = location.getDouble("lat");//  final Point point = new Point(lng, lat); System.out.println(address + " " + point); //       return point; } /** *       * * @param degree * @return */ private static double deg2rad(final double degree) { return degree * (Math.PI / 180); }</span></span></code> </pre><br><br>  Console: <br><pre> http://maps.googleapis.com/maps/api/geocode/json?sensor=false&amp;address=%D0%A0%D0%BE%D1%81 %D1% 81% D0% B8% D1% 8F % 9C% D0% BE% D1% 81% D0% BA% D0% B2% D0% B0% 2C +% D1% 83% D0% BB% D0% B8% D1% 86% D0% B0 +% D0% 9F% D0 % BE% D0% BA% D0% BB% D0% BE% D0% BD% D0% BD% D0% B0% D1% 8F% 2C + 12
 Russia, Moscow, Poklonnaya Street, 12 55.7358925,37.5274195
 http://maps.googleapis.com/maps/api/geocode/json?sensor=false&amp;address=%D0%A0%D0%BE%D1%81 %D1% 81% D0% B8% D1% 8F % 9C% D0% BE% D1% 81% D0% BA% D0% B2% D0% B0% 2C +% D1% 81% D1% 82% D0% B0% D0% BD% D1% 86% D0% B8% D1 % 8F +% D0% BC% D0% B5% D1% 82% D1% 80% D0% BE +% D0% 9F% D0% B0% D1% 80% D0% BA +% D0% 9F% D0% BE% D0% B1 % D0% B5% D0% B4% D1% 8B
 Russia, Moscow, metro station Park Pobedy 55.736217,37.516838
 distance: 0.6634200825814502
</pre><br><br>  But this option will indicate the distance between points only in a straight line, not taking into account obstacles.  Fortunately, Google offers a service for retrieving route data. <br><br><h3>  Calculating distances between points using routes </h3><br><blockquote>  The Google Directions API is a service that calculates routes between points using an HTTP request.  In the Directions service, the points of departure and destination can be indicated as text strings (for example, ‚ÄúChicago, Illinois‚Äù or ‚ÄúDarwin, New South Wales, Australia‚Äù) or as coordinates of latitude and longitude.  The Directions API service can return multiple routes as a sequence of waypoints. </blockquote><br><br>  The path to the <a href="http://maps.googleapis.com/maps/api/directions/output%3Fparameters">maps.googleapis.com/maps/api/directions/output?parameters</a> service, the structure of the request and response is described in detail <a href="https://developers.google.com/maps/documentation/directions/%3Fhl%3Dru">here</a> and <a href="https://developers.google.com/maps/documentation/directions/%3Fhl%3Dru">here</a> . <br>  For example, we want to know how much time to go from Poklonnaya Street, 12 to Park Pobedy metro station: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> String[] args)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException, JSONException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String baseUrl = <span class="hljs-string"><span class="hljs-string">"http://maps.googleapis.com/maps/api/directions/json"</span></span>;<span class="hljs-comment"><span class="hljs-comment">//   Geocoding API  // HTTP final Map&lt;String, String&gt; params = Maps.newHashMap(); params.put("sensor", "false");// ,          params.put("language", "ru");//        params.put("mode", "walking");//  ,   driving, walking, bicycling params.put("origin", ", ,  , 12");//       //    params.put("destination", ", ,    ");//       //  //     final String url = baseUrl + '?' + encodeParams(params);//     System.out.println(url); //         final JSONObject response = JsonReader.read(url);//          //               // //results[0]/geometry/location/lng  //results[0]/geometry/location/lat JSONObject location = response.getJSONArray("routes").getJSONObject(0); location = location.getJSONArray("legs").getJSONObject(0); final String distance = location.getJSONObject("distance").getString("text"); final String duration = location.getJSONObject("duration").getString("text"); System.out.println(distance + "\n" + duration); }</span></span></code> </pre><br><br>  Console <br><pre> http://anonymouse.org/cgi-bin/anon-www.cgi/http://maps.googleapis.com/maps/api/directions/json?sensor=false&amp;origin=%D0%A0%D0%BE%D1 % 81% D1% 81% D0% B8% D1% 8F% 2C +% D0% 9C% D0% BE% D1% 81% D0% BA% D0% B2% D0% B0% 2C +% D1% 83% D0% BB % D0% B8% D1% 86% D0% B0 +% D0% 94% D0% B5% D0% BD% D0% B8% D1% 81% D0% B0 +% D0% 94% D0% B0% D0% B2% D1 % 8B% D0% B4% D0% BE% D0% B2% D0% B0% 2C + 7 &amp; language = ru &amp; destination =% D0% A0% D0% BE% D1% 81% D1% 81% D0% B8% D1% 8F% 2C +% D0% 9C% D0% BE% D1% 81% D0% BA% D0% B2% D0% B0% 2C +% D1% 83% D0% BB% D0% B8% D1% 86% D0% B0 +% D0% 9A% D1% 83% D0% BB% D1% 8C% D0% BD% D0% B5% D0% B2% D0% B0 + 3 &amp; mode = walking
 0.9 km
 10 min.
</pre><br><br>  But what to do if we want to know which Park Pobedy metro station or Kutuzovskaya metro station is the nearest to go from Poklonnaya Street, 12 <br>  To solve this problem, we suggest using the Google Distance Matrix API service. <br><br><h3>  Calculate distance and travel time for a matrix of source and end points </h3><br><blockquote>  The Google Distance Matrix API is a service that provides distance and time information for a matrix of source and end points.  The information is based on the recommended route between the start and end points calculated using the Google Maps API, and is a string containing the values ‚Äã‚Äãof the duration and distance for each pair of points. </blockquote><br><br>  The path to the <a href="http://maps.googleapis.com/maps/api/distancematrix/output%3Fparameters">maps.googleapis.com/maps/api/distancematrix/output?parameters</a> service, the structure of the request and response is described in detail <a href="https://developers.google.com/maps/documentation/distancematrix/%3Fhl%3Dru">here</a> and <a href="https://developers.google.com/maps/documentation/distancematrix/%3Fhl%3Dru">here</a> . <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> String[] args)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException, JSONException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String baseUrl = <span class="hljs-string"><span class="hljs-string">"http://maps.googleapis.com/maps/api/distancematrix/json"</span></span>;<span class="hljs-comment"><span class="hljs-comment">//   Geocoding API  HTTP final Map&lt;String, String&gt; params = Maps.newHashMap(); params.put("sensor", "false");// ,          params.put("language", "ru");//   params.put("mode", "walking");//  ,   driving, walking, bicycling //      final String[] origins = { ", ,  , 12" }; params.put("origins", Joiner.on('|').join(origins)); //      final String[] destionations = { // ", ,    ", // ", ,   " // }; //       '|' params.put("destinations", Joiner.on('|').join(destionations)); final String url = baseUrl + '?' + encodeParams(params);//     System.out.println(url); //         final JSONObject response = JsonReader.read(url);//          final JSONObject location = response.getJSONArray("rows").getJSONObject(0); final JSONArray arrays = location.getJSONArray("elements");//      //         final JSONObject result = Ordering.from(new Comparator&lt;JSONObject&gt;() { @Override public int compare(final JSONObject o1, final JSONObject o2) { final Integer duration1 = getDurationValue(o1); final Integer duration2 = getDurationValue(o2); return duration1.compareTo(duration2);//      } /** *     * * @param obj * @return */ private int getDurationValue(final JSONObject obj) { try { return obj.getJSONObject("duration").getInt("value"); } catch (final JSONException e) { throw new RuntimeException(e); } } }).min(new AbstractIterator&lt;JSONObject&gt;() {//   JSONArray  ,     private int index = 0; @Override protected JSONObject computeNext() { try { JSONObject result; if (index &lt; arrays.length()) { final String destionation = destionations[index]; result = arrays.getJSONObject(index++); result.put("address", destionation);//      ,      //   } else { result = endOfData(); } return result; } catch (final JSONException e) { throw new RuntimeException(e); } } }); final String distance = result.getJSONObject("distance").getString("text");//    final String duration = result.getJSONObject("duration").getString("text");//    final String address = result.getString("address");//  System.out.println(address + "\n" + distance + "\n" + duration); }</span></span></code> </pre><br><br>  Console <br><pre> http://maps.googleapis.com/maps/api/distancematrix/json?sensor=false&amp;destinations=%D0%A0%D0%BE%D1%81% D1%81% 82D0BB% D1 % 9C% D0% BE% D1% 81% D0% BA% D0% B2% D0% B0% 2C +% D1% 81% D1% 82% D0% B0% D0% BD% D1% 86% D0% B8% D1 % 8F +% D0% BC% D0% B5% D1% 82% D1% 80% D0% BE +% D0% 9F% D0% B0% D1% 80% D0% BA +% D0% 9F% D0% BE% D0% B1 % D0% B5% D0% B4% D1% 8B% 7C% D0% A0% D0% BE% D1% 81% D1% 81% D0% B8% D1% 8F% 2C +% D0% 9C% D0% BE% D1 % 81% D0% BA% D0% B2% D0% B0% 2C +% D1% 81% D1% 82% D0% B0% D0% BD% D1% 86% D0% B8% D1% 8F +% D0% BC% D0 % B5% D1% 82% D1% 80% D0% BE +% D0% 9A% D1% 83% D1% 82% D1% 83% D0% B7% D0% BE% D0% B2% D1% 81% D0% BA % D0% B0% D1% 8F &amp; origins =% D0% A0% D0% BE% D1% 81% D1% 81% D0% B8% D1% 8F% 2C +% D0% 9C% D0% BE% D1% 81% D0% BA% D0% B2% D0% B0% 2C +% D1% 83% D0% BB% D0% B8% D1% 86% D0% B0 +% D0% 9F% D0% BE% D0% BA% D0% BB% D0% BE% D0% BD% D0% BD% D0% B0% D1% 8F% 2C + 12 &amp; language = en &amp; mode = walking
 Russia, Moscow, metro station Kutuzovskaya
 0.8 km
 9 min
</pre><br>  Having slightly improved the approach, you can find out which spouse is easier to call at the bank or go to the post office. <br><br><h3>  Restrictions on use </h3><br>  Google is one, and we all have a lot.  It‚Äôs hard to imagine how many requests these services take every day.  Whatever the burden of load, the corporation of good simply set limits on the use of its services. <br>  Today, you can make no more than 2500 requests from one IP per day, and no more than 10 requests per second.  If you work out your limit, the result of the query will be returned empty with the status OVER_QUERY_LIMIT. <br><br>  In addition, the number of characters in the URL should not exceed 2048, so it‚Äôs best to use coordinates when plotting routes. <br><br><h3>  Links </h3><br>  <a href="https://developers.google.com/maps/documentation/geocoding/%3Fhl%3Dru">developers.google.com/maps/documentation/geocoding/?hl=en</a> <br>  <a href="https://developers.google.com/maps/documentation/directions/%3Fhl%3Dru">developers.google.com/maps/documentation/directions/?hl=en</a> <br>  <a href="https://developers.google.com/maps/documentation/distancematrix/%3Fhl%3Dru">developers.google.com/maps/documentation/distancematrix/?hl=en</a> <br><br><br>  UPD: Posted source <a href="https://github.com/nestor-by/map-api-samples">github.com/nestor-by/map-api-samples</a> </div><p>Source: <a href="https://habr.com/ru/post/148986/">https://habr.com/ru/post/148986/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148980/index.html">We save on matches, Or ...?</a></li>
<li><a href="../148981/index.html">Sony Smart Headset Mini Headset Review</a></li>
<li><a href="../148983/index.html">Access to MySQL stored procedure bodies</a></li>
<li><a href="../148984/index.html">Tax news for Ukrainian programmers</a></li>
<li><a href="../148985/index.html">Making the compiler distinguish between cows and galoshes</a></li>
<li><a href="../148989/index.html">The first open source powder 3D printer</a></li>
<li><a href="../148990/index.html">What happens with Oracle?</a></li>
<li><a href="../148991/index.html">"Hola, apple gadgets!"</a></li>
<li><a href="../148993/index.html">In court for "Like"</a></li>
<li><a href="../148996/index.html">Creating a plugin for Intellij Platform (IntelliJ IDEA, RubyMine, WebStorm, PhpStorm, PyCharm and AppCode)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>