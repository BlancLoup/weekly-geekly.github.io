<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Escape from hell async / await</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="More recently, the async / await construction in JavaScript looked like a great way to get rid of hell callbacks. However, careless use of async / awa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Escape from hell async / await</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://habrahabr.ru/company/ruvds/blog/339770/">More recently,</a> the async / await construction in JavaScript looked like a great way to get rid of hell callbacks.  However, careless use of async / await led to the emergence of a new hell. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/131/df9/2b8/131df92b88609e61295a5d38d676cbe9.png"></div><a name="habracut"></a><br>  The author of the material, the translation of which we are publishing today, talks about what hell is async / await, and how to escape from it. <br><br><h2>  <font color="#3AC1EF">What is hell async / await</font> </h2><br>  In the process of working with asynchronous JavaScript capabilities, programmers often use constructs consisting of multiple function calls, each of which is preceded by the <code>await</code> keyword.  Since often in such cases, expressions with <code>await</code> independent of each other, such code leads to performance problems.  The point here is that before the system can deal with the next function, it needs to wait for the completion of the previous function.  This is hell async / await. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  <font color="#3AC1EF">Example: ordering pizza and drinks</font> </h2><br>  Imagine that we need to write a script for ordering pizza and drinks.  This script might look like this: <br><br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">async</span></span> () =&gt; { const pizzaData = await getPizzaData()    //   const drinkData = await getDrinkData()    //   const chosenPizza = choosePizza()    //   const chosenDrink = chooseDrink()    //   await addPizzaToCart(<span class="hljs-name"><span class="hljs-name">chosenPizza</span></span>)    //   await addDrinkToCart(<span class="hljs-name"><span class="hljs-name">chosenDrink</span></span>)    //   orderItems()    //   })()</code> </pre> <br>  At first glance, the script looks quite normal, besides - it works as expected.  However, upon careful consideration of this code, it turns out that its implementation is lame, since it does not take into account the features of asynchronous code execution.  Having dealt with what is wrong here, we will be able to solve the problem of this script. <br><br>  The code is wrapped in an asynchronous immediately called functional expression ( <a href="https://developer.mozilla.org/en-US/docs/Glossary/IIFE">IIFE</a> ).  Please note that all tasks are performed exactly in the order in which they are given in the code, while in order to proceed to the next task, you need to wait for the previous one to complete.  Namely, this is what happens here: <br><br><ol><li>  Getting a list of pizza. </li><li>  Getting a list of drinks. </li><li>  Pizza selection from the list. </li><li>  Select a drink from the list. </li><li>  Adding the selected pizza to the basket. </li><li>  Add selected drink to cart. </li><li>  Checkout. </li></ol><br>  The above focuses on the fact that operations in the script are performed strictly sequentially.  It does not use the possibility of parallel code execution.  Consider the following: why do we expect to receive a list of types of pizza in order to start downloading the list of drinks?  Should perform these tasks simultaneously.  However, in order to be able to choose a pizza from the list, you must first wait for the pizza list to load.  The same applies to the process of choosing a drink. <br><br>  As a result, it can be concluded that tasks related to pizza and tasks related to drinks can be performed in parallel, but separate operations related only to pizza (or only to drinks) should be performed sequentially. <br><br><h2>  <font color="#3AC1EF">Example: placing an order based on the contents of the basket</font> </h2><br>  Here is an example of code in which the data on the contents of the cart are loaded and the request to form an order is sent: <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">orderItems</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> items = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> getCartItems()    <span class="hljs-comment"><span class="hljs-comment">//   const noOfItems = items.length for(var i = 0; i &lt; noOfItems; i++) {   await sendRequest(items[i])    //   } }</span></span></code> </pre> <br>  In this case, the <code>for</code> loop has to wait for the completion of each call to the <code>sendRequest()</code> function in order to proceed to the next iteration.  However, we do not really need this expectation.  We want to complete all requests as quickly as possible, and then wait for them to complete. <br>  I hope, now you are closer to understanding the essence of async / await hell, and how much it can affect application performance.  Now think about the question posed in the heading of the next section. <br><br><h2>  <font color="#3AC1EF">What if you forget to use the await keyword?</font> </h2><br>  If you forget to use the <code>await</code> keyword when calling an asynchronous function, the function will simply start executing.  Such a function will return a promise that can be used later. <br><br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">async</span></span> () =&gt; { const value = doSomeAsyncTask() console.log(<span class="hljs-name"><span class="hljs-name">value</span></span>) //   })()</code> </pre> <br>  Another consequence of calling an asynchronous function without <code>await</code> is that the compiler will not know that the programmer wants to wait for the complete completion of the function.  As a result, the compiler will exit the program without completing the asynchronous task.  Therefore, do not forget about the <code>await</code> keyword where it is needed. <br><br>  The promises have an interesting property: in one line of the code you can get a promise, and in the other - wait for its resolution.  This fact is the key to escape from async / await hell. <br><br><pre> <code class="hljs cs">(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> promise = doSomeAsyncTask() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> promise console.log(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) <span class="hljs-comment"><span class="hljs-comment">//   })()</span></span></code> </pre> <br>  As you can see, the call to <code>doSomeAsyncTask()</code> returns a promise.  At this point, this function starts to run.  In order to get the result of the promise resolution, we use the <code>await</code> keyword, telling the system that it should not immediately execute the following line of code.  Instead, we must wait for the permission of the promise, and only then proceed to the next line. <br><br><h2>  <font color="#3AC1EF">How to get out of hell async / await?</font> </h2><br>  To get out of hell async / await, you can use the following action plan. <br><br><h3>  <font color="#3AC1EF">‚ñç1.</font>  <font color="#3AC1EF">Find expressions that depend on the execution of other expressions.</font> </h3><br>  In the first example, a script was shown for selecting a pizza and a drink.  We decided that before we have the opportunity to choose a pizza from the list, we need to download a list of types of pizza.  And before you add the pizza to the basket, you need to choose it.  As a result, it can be said that these three steps depend on each other.  You can not go to the next step without completing the previous one. <br><br>  Now, if you think more broadly and think about drinks, it turns out that the process of choosing a pizza does not depend on the process of choosing a drink, so these two tasks can be parallelized.  Computers do a very good job with parallel tasks. <br><br>  As a result, we understood exactly which expressions depend on each other, and which ones do not. <br><br><h3>  <font color="#3AC1EF">‚ñç2.</font>  <font color="#3AC1EF">Group dependent expressions in separate asynchronous functions.</font> </h3><br>  As we have already found out, the process of choosing a pizza consists of several steps: loading a list of types of pizza, choosing a specific pizza and adding it to the basket.  It is these actions that should be collected into a separate asynchronous function.  Not forgetting that a similar sequence of actions is typical for drinks, we come to two asynchronous functions, which can be called <code>selectPizza()</code> and <code>selectDrink()</code> . <br><br><h3>  <font color="#3AC1EF">‚ñç3.</font>  <font color="#3AC1EF">Run the resulting asynchronous functions in parallel</font> </h3><br>  Now let us use the possibilities of the JavaScript event cycle in order to organize parallel non-blocking execution of the obtained asynchronous functions.  There are two common patterns used here - early return of promises and the <code>Promise.all()</code> method. <br><br><h2>  <font color="#3AC1EF">Bug work</font> </h2><br>  Let's apply in practice the three steps described above to get rid of hell async / await.  Correct the above examples.  This is how the first one will look now. <br><br><pre> <code class="hljs matlab">async <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">selectPizza</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pizzaData</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPizzaData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">    //   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chosenPizza</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">choosePizza</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">    //   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addPizzaToCart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(chosenPizza)</span></span></span><span class="hljs-function">    //   } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">async</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">selectDrink</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drinkData</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDrinkData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">    //   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chosenDrink</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chooseDrink</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">    //   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addDrinkToCart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(chosenDrink)</span></span></span><span class="hljs-function">    //   } </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(async ()</span></span></span><span class="hljs-function"> =&gt; { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pizzaPromise</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">selectPizza</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drinkPromise</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">selectDrink</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pizzaPromise</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drinkPromise</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">orderItems</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">    //   })</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> //    ,   ,      </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(async ()</span></span></span><span class="hljs-function"> =&gt; { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Promise</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">all</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">([selectPizza()</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">selectDrink</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">]).</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">then</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(orderItems)</span></span></span><span class="hljs-function">   //   })</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span></code> </pre> <br>  Pizza and drink related expressions are now grouped in the <code>selectPizza()</code> and <code>selectDrink()</code> functions.  Inside these functions, the order of command execution is important, since the following commands depend on the results of the previous ones.  Once the functions are prepared, we call them asynchronously. <br><br>  In the second example, we have to deal with an unknown amount of promises.  However, to solve this problem is very simple.  Namely, it is necessary to create an array and put promises into it.  Then, using <code>Promise.all()</code> , you can organize the pending resolution of all these promises. <br><br><pre> <code class="hljs matlab">async <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">orderItems</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">items</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCartItems</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">    //   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">noOfItems</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">items</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">length</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">promises</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(var i = 0; i &lt; noOfItems; i++)</span></span></span><span class="hljs-function"> {   </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">orderPromise</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendRequest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(items[i])</span></span></span><span class="hljs-function">    //     </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">promises</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(orderPromise)</span></span></span><span class="hljs-function">    //   } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">await</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Promise</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">all</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(promises)</span></span></span><span class="hljs-function">    //   }</span></span></code> </pre> <br><h2>  <font color="#3AC1EF">Results</font> </h2><br>  As you can see, what is called ‚Äúasync / await hell‚Äù at first glance looks quite decent, however, external well-being has a negative impact on performance.  From this hell, however, it is not so difficult to escape.  It is enough to analyze the code, find out what tasks can be solved using it, can be parallelized, and make the necessary changes to the program. <br><br>  <b>Dear readers!</b>  Have you ever seen hell async / await? <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div><p>Source: <a href="https://habr.com/ru/post/353658/">https://habr.com/ru/post/353658/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353648/index.html">Useful VPN features</a></li>
<li><a href="../353650/index.html">Fintech Digest: a trillion rubles to the wind, a bank branch managed by robots and PayPal as a bank</a></li>
<li><a href="../353652/index.html">Not a bot yet, but already something - we receive notifications from Zabbix to instant messengers</a></li>
<li><a href="../353654/index.html">Why SQLite does not use Git</a></li>
<li><a href="../353656/index.html">Lessons learned in creating the first game, and why I want to write my own engine</a></li>
<li><a href="../353660/index.html">Experience of implementing "Continent TLS VPN" in a cluster configuration</a></li>
<li><a href="../353662/index.html">How I passed the test task for the summer internship in Yandex</a></li>
<li><a href="../353664/index.html">Impose flex-calendar</a></li>
<li><a href="../353666/index.html">How we broke Glusterfs</a></li>
<li><a href="../353668/index.html">Interfaces: how to tell the user if ‚ÄúOops, something went wrong‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>