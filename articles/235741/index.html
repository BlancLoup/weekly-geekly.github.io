<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Writing a lossless audio player in JavaScript</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon,% username%. Today I would like to share my experience in developing a prototype of an online lossless audio player. 

 Today, it is ha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Writing a lossless audio player in JavaScript</h1><div class="post__text post__text-html js-mediator-article">  Good afternoon,% username%.  Today I would like to share my experience in developing a prototype of an online lossless audio player. <br><br>  Today, it is hardly possible to surprise someone with an audio or video player embedded directly in the web page.  Existing technologies, libraries and APIs make it easy to fill the site with any media content.  But there are people for whom this is not enough (including me).  That is why, as a true music lover at lossless, I needed to make a browser player that supports audio format such as <b>flac</b> . <br><a name="habracut"></a><br>  One article pushed me to this idea: <a href="http://habrahabr.ru/post/222729/">Web player FLAC.JS (HTML5)</a> .  Having learned that there is such a wonderful framework as <b>Aurora.js</b> and flac format decoder for it, I could not just pass by all of this.  Everything - I thought - now that my level of enthusiasm has gone too high, I have to make this player.  So, let's begin‚Ä¶ <br><br><h2>  Backend </h2><br>  As backend, we will have the notorious Nginx and Apache with PHP (where to go without it).  The first will be responsible for the return of audio data, the second will produce a page with the player and process Ajax requests. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Nginx configuration with CORS support</b> <div class="spoiler_text"><pre><code class="nginx hljs"><span class="hljs-section"><span class="hljs-section">http</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">sendfile</span></span> <span class="hljs-literal"><span class="hljs-literal">on</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">include</span></span> /etc/nginx/mime.types; <span class="hljs-attribute"><span class="hljs-attribute">default_type</span></span> audio/flac; <span class="hljs-section"><span class="hljs-section">server</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">listen</span></span> *:<span class="hljs-number"><span class="hljs-number">80</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">server_name</span></span> as.iostd.ru; <span class="hljs-attribute"><span class="hljs-attribute">root</span></span> /var/mcs/storage; <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> / { <span class="hljs-attribute"><span class="hljs-attribute">rewrite</span></span> <span class="hljs-string"><span class="hljs-string">"^\/(([a-z0-9]{2})([a-z0-9]{2})([a-z0-9]{2})([a-z0-9]{2})[a-z0-9]{56}).flac$"</span></span> /<span class="hljs-variable"><span class="hljs-variable">$2</span></span>/<span class="hljs-variable"><span class="hljs-variable">$3</span></span>/<span class="hljs-variable"><span class="hljs-variable">$4</span></span>/<span class="hljs-variable"><span class="hljs-variable">$5</span></span>/<span class="hljs-variable"><span class="hljs-variable">$1</span></span>.flac <span class="hljs-literal"><span class="hljs-literal">last</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$http_origin</span></span> <span class="hljs-regexp"><span class="hljs-regexp">~* (https?://([^/]*\.)?.?iostd\.ru(:[0-9]+)?))</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$cors</span></span> <span class="hljs-string"><span class="hljs-string">"true"</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$request_method</span></span> = <span class="hljs-string"><span class="hljs-string">'OPTIONS'</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$cors</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${cors}</span></span></span><span class="hljs-string">options"</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$request_method</span></span> = <span class="hljs-string"><span class="hljs-string">'GET'</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$cors</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${cors}</span></span></span><span class="hljs-string">get"</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$request_method</span></span> = <span class="hljs-string"><span class="hljs-string">'POST'</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$cors</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${cors}</span></span></span><span class="hljs-string">post"</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$request_method</span></span> = <span class="hljs-string"><span class="hljs-string">'HEAD'</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$cors</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${cors}</span></span></span><span class="hljs-string">head"</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$cors</span></span> = <span class="hljs-string"><span class="hljs-string">"trueget"</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Origin'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$http_origin</span></span></span><span class="hljs-string">"</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Credentials'</span></span> <span class="hljs-string"><span class="hljs-string">'true'</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$cors</span></span> = <span class="hljs-string"><span class="hljs-string">"truepost"</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Origin'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$http_origin</span></span></span><span class="hljs-string">"</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Credentials'</span></span> <span class="hljs-string"><span class="hljs-string">'true'</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$cors</span></span> = <span class="hljs-string"><span class="hljs-string">"truehead"</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Origin'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$http_origin</span></span></span><span class="hljs-string">"</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Credentials'</span></span> <span class="hljs-string"><span class="hljs-string">'true'</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Max-Age'</span></span> <span class="hljs-number"><span class="hljs-number">1728000</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Methods'</span></span> <span class="hljs-string"><span class="hljs-string">'GET, POST, OPTIONS'</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Headers'</span></span> <span class="hljs-string"><span class="hljs-string">'Authorization,Content-Type,Accept,Origin,User-Agent,DNT,Cache-Control,Range,X-Mx-ReqToken,Keep-Alive,X-Requested-With,If-Modified-Since'</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Expose-Headers'</span></span> <span class="hljs-string"><span class="hljs-string">'Accept-Ranges,Content-Encoding,Content-Length,Content-Range'</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$cors</span></span> = <span class="hljs-string"><span class="hljs-string">"trueoptions"</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Origin'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$http_origin</span></span></span><span class="hljs-string">"</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Credentials'</span></span> <span class="hljs-string"><span class="hljs-string">'true'</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Max-Age'</span></span> <span class="hljs-number"><span class="hljs-number">1728000</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Methods'</span></span> <span class="hljs-string"><span class="hljs-string">'GET, POST, OPTIONS'</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Headers'</span></span> <span class="hljs-string"><span class="hljs-string">'Authorization,Content-Type,Accept,Origin,User-Agent,DNT,Cache-Control,Range,X-Mx-ReqToken,Keep-Alive,X-Requested-With,If-Modified-Since'</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Access-Control-Expose-Headers'</span></span> <span class="hljs-string"><span class="hljs-string">'Accept-Ranges,Content-Encoding,Content-Length,Content-Range'</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Content-Length'</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> <span class="hljs-string"><span class="hljs-string">'Content-Type'</span></span> <span class="hljs-string"><span class="hljs-string">'text/plain charset=UTF-8'</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">return</span></span> <span class="hljs-number"><span class="hljs-number">204</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">try_files</span></span> <span class="hljs-variable"><span class="hljs-variable">$uri</span></span> <span class="hljs-variable"><span class="hljs-variable">$uri</span></span>/; } } }</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">PHP Script "In a hurry"</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> error_reporting(E_ALL); ini_set(<span class="hljs-string"><span class="hljs-string">'display_errors'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span>(<span class="hljs-string"><span class="hljs-string">'MysqliDb.php'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// https://github.com/joshcam/PHP-MySQLi-Database-Class function cors() { if (isset($_SERVER['HTTP_ORIGIN'])) { header("Access-Control-Allow-Origin: {$_SERVER['HTTP_ORIGIN']}"); header('Access-Control-Allow-Credentials: true'); header('Access-Control-Max-Age: 86400'); } if ($_SERVER['REQUEST_METHOD'] == 'OPTIONS') { if (isset($_SERVER['HTTP_ACCESS_CONTROL_REQUEST_METHOD'])) header("Access-Control-Allow-Methods: GET, POST, OPTIONS"); if (isset($_SERVER['HTTP_ACCESS_CONTROL_REQUEST_HEADERS'])) header("Access-Control-Allow-Headers: {$_SERVER['HTTP_ACCESS_CONTROL_REQUEST_HEADERS']}"); exit(0); } } function answer($data = array(), $status = "OK", $message = "") { if(!is_array($data)) return; $rcode = array(); $rcode["status"] = $status; if($status == "ERROR" &amp;&amp; $message != "" ) $rcode["message"] = $message; header('Content-Type: application/json'); echo json_encode(array_merge($rcode, array("result" =&gt; $data))); exit(); } function error($message) { answer(array(), "ERROR", $message); } cors(); $db = new MysqliDb ('localhost', 'root', 'hackme', 'audio'); // https://github.com/joshcam/PHP-MySQLi-Database-Class if(!isset($_REQUEST["c"])) error("Bad request"); if($_REQUEST["c"] == "tracks") { $tracks = $db-&gt;rawQuery('SELECT title, a.artist, audio FROM tracks INNER JOIN artists a ON (tracks.artistid = a.id) LIMIT 20'); answer($tracks); } error("Bad request");</span></span></code> </pre></div></div><br><br><h2>  Frontend </h2><br>  First of all, you need to think over all the functionality that our player will support.  The most obvious ones are Play / Pause, Next, Prev, buffering and search bar, volume, track name string and time.  I would also like to implement the display of album covers, playlists, search in the database of the audio library, and so on, but for now I decided to stop at the most basic.  Since I didn‚Äôt often come across web development, I‚Äôm not very good at layout and design. <br><br>  Here's what I got in the end: <br><br><img src="https://habrastorage.org/files/749/a2b/42d/749a2b42db2a46d8b5ba786f7c43bc66.png"><br><br>  Layout: <br><div class="spoiler">  <b class="spoiler_title">HTML</b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"player"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"info"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"tackinfo"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"artist"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> - <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"title"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"timer"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"time"</span></span></span><span class="hljs-tag">&gt;</span></span>00:00<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"seekbar"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"seek"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"buffer"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"progress"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"controls"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"playback"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"play"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fa fa-play"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fb"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"backward"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fa fa-backward"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"forward"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fa fa-forward"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"volumebar"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"volume"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"volumevalue"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">Styles</b> <div class="spoiler_text"><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.player</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">border</span></span>: <span class="hljs-number"><span class="hljs-number">1px</span></span> solid <span class="hljs-number"><span class="hljs-number">#D0D0D0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: <span class="hljs-number"><span class="hljs-number">#F0F0F0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">67px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-radius</span></span>: <span class="hljs-number"><span class="hljs-number">2px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>: <span class="hljs-number"><span class="hljs-number">5px</span></span>;} <span class="hljs-selector-class"><span class="hljs-selector-class">.player</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.tackinfo</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">float</span></span>: left; <span class="hljs-attribute"><span class="hljs-attribute">margin-left</span></span>: <span class="hljs-number"><span class="hljs-number">0px</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.player</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.tackinfo</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#artist</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: <span class="hljs-number"><span class="hljs-number">#0474C0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">font-weight</span></span>: bold; } <span class="hljs-selector-class"><span class="hljs-selector-class">.player</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.tackinfo</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#title</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: <span class="hljs-number"><span class="hljs-number">#787878</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.player</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.timer</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">float</span></span>: right; <span class="hljs-attribute"><span class="hljs-attribute">cursor</span></span>: pointer; } <span class="hljs-selector-class"><span class="hljs-selector-class">.player</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.seekbar</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">clear</span></span>: both; <span class="hljs-attribute"><span class="hljs-attribute">cursor</span></span>: pointer; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>: <span class="hljs-number"><span class="hljs-number">5px</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>;} <span class="hljs-selector-class"><span class="hljs-selector-class">.player</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.seekbar</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.wrap</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: <span class="hljs-number"><span class="hljs-number">#D0D0D0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">overflow</span></span>:hidden; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>:<span class="hljs-number"><span class="hljs-number">5px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-radius</span></span>: <span class="hljs-number"><span class="hljs-number">2px</span></span>;} <span class="hljs-selector-class"><span class="hljs-selector-class">.player</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#buffer</span></span>, <span class="hljs-selector-class"><span class="hljs-selector-class">.player</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#progress</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>:<span class="hljs-number"><span class="hljs-number">100%</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>:<span class="hljs-number"><span class="hljs-number">0%</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.player</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#buffer</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>:<span class="hljs-number"><span class="hljs-number">#909090</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.player</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#progress</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: <span class="hljs-number"><span class="hljs-number">#0474C0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">margin-top</span></span>:-<span class="hljs-number"><span class="hljs-number">5px</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.controls</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.playback</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">float</span></span>: left; } <span class="hljs-selector-class"><span class="hljs-selector-class">.controls</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.playback</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.fb</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">float</span></span>: left; } <span class="hljs-selector-class"><span class="hljs-selector-class">.playback</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#play</span></span>, <span class="hljs-selector-class"><span class="hljs-selector-class">.playback</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#backward</span></span>, <span class="hljs-selector-class"><span class="hljs-selector-class">.playback</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#forward</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: <span class="hljs-number"><span class="hljs-number">#0474C0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">cursor</span></span>: pointer; <span class="hljs-attribute"><span class="hljs-attribute">border-radius</span></span>: <span class="hljs-number"><span class="hljs-number">2px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">text-align</span></span>: center; <span class="hljs-attribute"><span class="hljs-attribute">vertical-align</span></span>: middle; <span class="hljs-attribute"><span class="hljs-attribute">float</span></span>:left; <span class="hljs-attribute"><span class="hljs-attribute">margin-right</span></span>: <span class="hljs-number"><span class="hljs-number">2px</span></span>;} <span class="hljs-selector-class"><span class="hljs-selector-class">.playback</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#play</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:hover</span></span>, <span class="hljs-selector-class"><span class="hljs-selector-class">.playback</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#backward</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:hover</span></span>, <span class="hljs-selector-class"><span class="hljs-selector-class">.playback</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#forward</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:hover</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: <span class="hljs-number"><span class="hljs-number">#D8D8D8</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.playback</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#play</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">font-size</span></span>: <span class="hljs-number"><span class="hljs-number">24px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">32px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>: <span class="hljs-number"><span class="hljs-number">32px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">line-height</span></span>: <span class="hljs-number"><span class="hljs-number">32px</span></span>;} <span class="hljs-selector-class"><span class="hljs-selector-class">.playback</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#backward</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">font-size</span></span>: <span class="hljs-number"><span class="hljs-number">16px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">32px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>: <span class="hljs-number"><span class="hljs-number">32px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">line-height</span></span>: <span class="hljs-number"><span class="hljs-number">32px</span></span>;} <span class="hljs-selector-class"><span class="hljs-selector-class">.playback</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#forward</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">font-size</span></span>: <span class="hljs-number"><span class="hljs-number">16px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">32px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>: <span class="hljs-number"><span class="hljs-number">32px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">line-height</span></span>: <span class="hljs-number"><span class="hljs-number">32px</span></span>;} <span class="hljs-selector-class"><span class="hljs-selector-class">.volumebar</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">float</span></span>: right; <span class="hljs-attribute"><span class="hljs-attribute">cursor</span></span>: pointer; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>: <span class="hljs-number"><span class="hljs-number">15px</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>:<span class="hljs-number"><span class="hljs-number">80px</span></span>;} <span class="hljs-selector-class"><span class="hljs-selector-class">.volumebar</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.wrap</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>:<span class="hljs-number"><span class="hljs-number">#D8D8D8</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">overflow</span></span>:hidden; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>:<span class="hljs-number"><span class="hljs-number">5px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-radius</span></span>: <span class="hljs-number"><span class="hljs-number">2px</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.volumebar</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#volumevalue</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>:<span class="hljs-number"><span class="hljs-number">100%</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>:<span class="hljs-number"><span class="hljs-number">0%</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: <span class="hljs-number"><span class="hljs-number">#0474C0</span></span>; }</code> </pre></div></div><br>  Fine.  We have the necessary minimum.  Now you need to revive all this.  Therefore, go to JavaScript. <br><br>  Create a Playlist class which, as you already understood, will be responsible for the playlist: <br><br><pre> <code class="javascript hljs">Playlist = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.list = []; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repeatmode = <span class="hljs-number"><span class="hljs-number">0</span></span>; };</code> </pre><br>  Where <i>list</i> is the list itself, <i>current</i> is the current track number, <i>repeatmode</i> is the repeat mode (0 <i>means</i> no repeat, 1 repeats the entire list, 2 repeats one track). <br><br>  Further we implement all the necessary methods. <br><br>  Add track: <br><pre> <code class="javascript hljs">Playlist.prototype.add = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">track</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.list.push(track); };</code> </pre><br>  Getting the current track: <br><pre> <code class="javascript hljs">Playlist.prototype.getCurrent = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.list[<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current]; };</code> </pre><br>  Methods forward, backward: <br><pre> <code class="javascript hljs">Playlist.prototype.next = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repeatmode == <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current &gt;= <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.list.length - <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repeatmode == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.repeatmode == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current = <span class="hljs-number"><span class="hljs-number">0</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ++<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current; }; Playlist.prototype.prev = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> --<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current; };</code> </pre><br>  And finally, the method of mixing the list: <br><pre> <code class="javascript hljs">Playlist.prototype.shuffle = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> j, x, i = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.list.length; i; j = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random() * i), x = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.list[--i], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.list[i] = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.list[j], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.list[j] = x); };</code> </pre><br>  We have a playlist, go to the player itself.  Create a class Musica: <br><br><pre> <code class="javascript hljs">Musica = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">params</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui = { <span class="hljs-attr"><span class="hljs-attr">artist</span></span>: params.artist, <span class="hljs-attr"><span class="hljs-attr">title</span></span>: params.title, <span class="hljs-attr"><span class="hljs-attr">seekbar</span></span>: params.seekbar, <span class="hljs-attr"><span class="hljs-attr">bufferbar</span></span>: params.bufferbar, <span class="hljs-attr"><span class="hljs-attr">progressbar</span></span>: params.progressbar, <span class="hljs-attr"><span class="hljs-attr">timer</span></span>: params.timer, <span class="hljs-attr"><span class="hljs-attr">playbtn</span></span>: params.playbtn, <span class="hljs-attr"><span class="hljs-attr">backwardbtn</span></span>: params.backwardbtn, <span class="hljs-attr"><span class="hljs-attr">forwardbtn</span></span>: params.forwardbtn, <span class="hljs-attr"><span class="hljs-attr">volumebar</span></span>: params.volumebar, <span class="hljs-attr"><span class="hljs-attr">volume</span></span>: params.volume }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.pstate = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.seekstate = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timetype = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aurora; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.volume = <span class="hljs-number"><span class="hljs-number">100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.playlist = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Playlist(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.timer.click((<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_this</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ _this.timetype = _this.timetype == <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>; _this.setTimer(_this.aurora.currentTime); }; })(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.playbtn.click((<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_this</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(_this.pstate == <span class="hljs-number"><span class="hljs-number">0</span></span>) _this.play(); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> _this.pause(); }; })(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.backwardbtn.click((<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_this</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ _this.prev(); }; })(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.forwardbtn.click((<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_this</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ _this.next(); }; })(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); };</code> </pre><br>  In <i>params</i> we will place all interface elements using jQuery selectors, using the <i>pstate</i> variable <i>,</i> we will determine the status of the player (play / not play), <i>seekstate</i> will be useful for us when we implement the search bar, and <i>timetype</i> determines the type of timer (how long or how much is left) .  Also in this constructor, we immediately hung up event handlers on all available buttons. <br><br>  The Aurora.js framework contains the Player class, which implements the minimum we need.  It has such methods as play (), pause (), stop (), seek (), and also an event handler is implemented.  This greatly simplifies our task. <br><br>  Let's try to implement the player initialization method: <br><pre> <code class="javascript hljs">Musica.prototype.open = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aurora) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aurora.stop(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aurora = AV.Player.fromURL(<span class="hljs-string"><span class="hljs-string">'http://as.iostd.ru/'</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.playlist.getCurrent().audio + <span class="hljs-string"><span class="hljs-string">'.flac'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aurora.volume = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.volume; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.volume.css(<span class="hljs-string"><span class="hljs-string">'width'</span></span>, ((<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.volume * <span class="hljs-number"><span class="hljs-number">100</span></span> ) / <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.volumebar.width())+<span class="hljs-string"><span class="hljs-string">'%'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.pstate = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.playbtn.removeClass(<span class="hljs-string"><span class="hljs-string">"fa-play fa-pause"</span></span>).addClass(<span class="hljs-string"><span class="hljs-string">"fa-play"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.artist.html(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.playlist.getCurrent().artist); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.title.html(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.playlist.getCurrent().title); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.bufferbar.css(<span class="hljs-string"><span class="hljs-string">'width'</span></span>, <span class="hljs-string"><span class="hljs-string">'0%'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.progressbar.css(<span class="hljs-string"><span class="hljs-string">'width'</span></span>, <span class="hljs-string"><span class="hljs-string">'0%'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aurora.on(<span class="hljs-string"><span class="hljs-string">'buffer'</span></span>, (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_this</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">percent</span></span></span><span class="hljs-function">) </span></span>{ _this.ui.bufferbar.css(<span class="hljs-string"><span class="hljs-string">'width'</span></span>, percent+<span class="hljs-string"><span class="hljs-string">'%'</span></span>); }; })(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aurora.on(<span class="hljs-string"><span class="hljs-string">'progress'</span></span>, (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_this</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">time</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(_this.seekstate == <span class="hljs-number"><span class="hljs-number">0</span></span>) _this.ui.progressbar.css(<span class="hljs-string"><span class="hljs-string">'width'</span></span>, ((time * <span class="hljs-number"><span class="hljs-number">100</span></span> ) / _this.aurora.duration)+<span class="hljs-string"><span class="hljs-string">'%'</span></span>); _this._setTimer(time); }; })(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aurora.on(<span class="hljs-string"><span class="hljs-string">'end'</span></span>, (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_this</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ _this.next(); }; })(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aurora.preload(); };</code> </pre><br>  Here we load the current track from the playlist into the framework, reset the GUI to default values ‚Äã‚Äãand connect event handlers.  We will call this method every time we need to play a new track. <br><br>  Now we need to do, in my opinion, the most difficult thing: the search bar and volume control.  These two elements of the interface are very similar to each other (at least in our case). <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.seekbar.off(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.seekbar.mousedown((<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_this</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> offsetx = e.offsetX; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> origin = $(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); _this.seekstate = <span class="hljs-number"><span class="hljs-number">1</span></span>; _this.ui.progressbar.css(<span class="hljs-string"><span class="hljs-string">'width'</span></span>, ((offsetx * <span class="hljs-number"><span class="hljs-number">100</span></span> ) / $(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>).width())+<span class="hljs-string"><span class="hljs-string">'%'</span></span>); $(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).mousemove(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ offsetx = e.pageX - origin.offset().left; offsetx = offsetx &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span> : (offsetx &gt; origin.width() ? origin.width() : offsetx); _this.ui.progressbar.css(<span class="hljs-string"><span class="hljs-string">'width'</span></span>, ((offsetx * <span class="hljs-number"><span class="hljs-number">100</span></span> ) / origin.width())+<span class="hljs-string"><span class="hljs-string">'%'</span></span>); }); $(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).mouseup(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ $(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).off(<span class="hljs-string"><span class="hljs-string">"mousemove"</span></span>); $(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).off(<span class="hljs-string"><span class="hljs-string">"mouseup"</span></span>); _this.aurora.seek(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor((offsetx * _this.aurora.duration) / origin.width())); _this.seekstate = <span class="hljs-number"><span class="hljs-number">0</span></span>; }); }; })(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>));</code> </pre><br><br>  First, we connect the <i>mousedown</i> event handler.  After that, we change the <i>progressbar</i> value and connect two more handlers.  In the first ( <i>mousemove</i> ), we also change the <i>progressbar</i> value.  In the second ( <i>mouseup</i> ), we disable these two handlers and call the seek () framework method.  In order that during the search with the mouse, the <i>progressbar</i> does not twitch from the <i>progress</i> event that we process above, we need to <i>seekstate</i> . <br><br>  In the same way we do the volume control: <br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.volumebar.off(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.volumebar.mousedown((<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_this</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> offsetx = e.offsetX; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> origin = $(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); _this.ui.volume.css(<span class="hljs-string"><span class="hljs-string">'width'</span></span>, ((offsetx * <span class="hljs-number"><span class="hljs-number">100</span></span> ) / origin.width())+<span class="hljs-string"><span class="hljs-string">'%'</span></span>); _this.volume = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor((offsetx * <span class="hljs-number"><span class="hljs-number">100</span></span>) / origin.width()); _this.aurora.volume = _this.volume; $(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).mousemove(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ offsetx = e.pageX - origin.offset().left; offsetx = offsetx &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span> : (offsetx &gt; origin.width() ? origin.width() : offsetx); _this.ui.volume.css(<span class="hljs-string"><span class="hljs-string">'width'</span></span>, ((offsetx * <span class="hljs-number"><span class="hljs-number">100</span></span> ) / origin.width())+<span class="hljs-string"><span class="hljs-string">'%'</span></span>); _this.volume = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor((offsetx * <span class="hljs-number"><span class="hljs-number">100</span></span>) / origin.width()); _this.aurora.volume = _this.volume }); $(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).mouseup(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ $(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).off(<span class="hljs-string"><span class="hljs-string">"mousemove"</span></span>); $(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).off(<span class="hljs-string"><span class="hljs-string">"mouseup"</span></span>); _this.volume = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor((offsetx * <span class="hljs-number"><span class="hljs-number">100</span></span>) / origin.width()); _this.aurora.volume = _this.volume; }); }; })(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>));</code> </pre><br><br>  The player is almost ready.  We only need to add the methods play (), netxt (), prev ().  There is nothing difficult in their implementation: <br><br><pre> <code class="javascript hljs">Musica.prototype.play = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aurora.play(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.pstate = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.playbtn.removeClass(<span class="hljs-string"><span class="hljs-string">"fa-play fa-pause"</span></span>).addClass(<span class="hljs-string"><span class="hljs-string">"fa-pause"</span></span>); }; Musica.prototype.pause = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.aurora.pause(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.pstate = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ui.playbtn.removeClass(<span class="hljs-string"><span class="hljs-string">"fa-play fa-pause"</span></span>).addClass(<span class="hljs-string"><span class="hljs-string">"fa-play"</span></span>); }; Musica.prototype.next = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.playlist.next() !== <span class="hljs-number"><span class="hljs-number">-1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pss = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.pstate; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.pause(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.open(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(pss == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.play(); } } }; Musica.prototype.prev = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.playlist.prev() !== <span class="hljs-number"><span class="hljs-number">-1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pss = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.pstate; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.pause(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.open(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(pss == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.play(); } } };</code> </pre><br><br>  Is done.  You can connect the player. <br><br><div class="spoiler">  <b class="spoiler_title">We connect</b> <div class="spoiler_text"><pre> <code class="javascript hljs">$(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> params = { <span class="hljs-attr"><span class="hljs-attr">artist</span></span>: $(<span class="hljs-string"><span class="hljs-string">'#artist'</span></span>), <span class="hljs-attr"><span class="hljs-attr">title</span></span>: $(<span class="hljs-string"><span class="hljs-string">'#title'</span></span>), <span class="hljs-attr"><span class="hljs-attr">seekbar</span></span>: $(<span class="hljs-string"><span class="hljs-string">'#seek'</span></span>), <span class="hljs-attr"><span class="hljs-attr">bufferbar</span></span>: $(<span class="hljs-string"><span class="hljs-string">"#buffer"</span></span>), <span class="hljs-attr"><span class="hljs-attr">progressbar</span></span>: $(<span class="hljs-string"><span class="hljs-string">"#progress"</span></span>), <span class="hljs-attr"><span class="hljs-attr">timer</span></span>: $(<span class="hljs-string"><span class="hljs-string">"#time"</span></span>), <span class="hljs-attr"><span class="hljs-attr">playbtn</span></span>: $(<span class="hljs-string"><span class="hljs-string">"#play"</span></span>), <span class="hljs-attr"><span class="hljs-attr">backwardbtn</span></span>: $(<span class="hljs-string"><span class="hljs-string">"#backward"</span></span>), <span class="hljs-attr"><span class="hljs-attr">forwardbtn</span></span>: $(<span class="hljs-string"><span class="hljs-string">"#forward"</span></span>), <span class="hljs-attr"><span class="hljs-attr">volumebar</span></span>: $(<span class="hljs-string"><span class="hljs-string">"#volume"</span></span>), <span class="hljs-attr"><span class="hljs-attr">volume</span></span>: $(<span class="hljs-string"><span class="hljs-string">"#volumevalue"</span></span>) }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mplayer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Musica(params); $.get( <span class="hljs-string"><span class="hljs-string">"http://iostd.ru/audioapi.php?c=tracks"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> data </span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; data.result.length; i++) { mplayer.playlist.add(data.result[i]); } mplayer.open(); mplayer.play(); }); });</code> </pre></div></div><br><br>  PS As you can see, it is not so difficult to make a player like VK. <br><br>  Demo: <a href="http://audio.iostd.ru/">http://audio.iostd.ru/</a> <br>  Sources: <a href="https://github.com/Show-vars/HTML5LosslessPlayer">https://github.com/Show-vars/HTML5LosslessPlayer</a> </div><p>Source: <a href="https://habr.com/ru/post/235741/">https://habr.com/ru/post/235741/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../235727/index.html">Uploading sketches to Arduino via Bluetooth</a></li>
<li><a href="../235729/index.html">Realistic gravity lensing on Unity</a></li>
<li><a href="../235731/index.html">Ideal development environment for PIC - personal experience</a></li>
<li><a href="../235735/index.html">3D mode in Diablo 2</a></li>
<li><a href="../235739/index.html">Recycling Gadgets</a></li>
<li><a href="../235743/index.html">Das Experiment, or a few days of life without Resharper</a></li>
<li><a href="../235745/index.html">Study: how users actually work with touch screens</a></li>
<li><a href="../235749/index.html">Smart watches from Lively service: personal rescue service that is always in touch</a></li>
<li><a href="../235751/index.html">Work desks employees, part 2</a></li>
<li><a href="../235753/index.html">New Evernote 6 for Android: redesign, web clipper and more</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>