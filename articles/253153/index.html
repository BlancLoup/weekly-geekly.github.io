<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Brutfors passwords of the engineering menu of the radio station</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What is the engineering menu and why is it needed? Let me quote from the wiki : 
 Undocumented features (undocumented features), NDV - the capabilitie...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Brutfors passwords of the engineering menu of the radio station</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/fbd/52d/4ec/fbd52d4ec6aa47d3a47d0da37cee0967.jpg" alt="image"><br><br>  What is the engineering menu and why is it needed?  Let me quote from the <a href="https://ru.wikipedia.org/wiki/%25D0%259D%25D0%25B5%25D0%25B4%25D0%25BE%25D0%25BA%25D1%2583%25D0%25BC%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B5_%25D0%25B2%25D0%25BE%25D0%25B7%25D0%25BC%25D0%25BE%25D0%25B6%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D0%25B8">wiki</a> : <br><blockquote>  <b>Undocumented features</b> (undocumented features), NDV - the capabilities of technical devices and / or software that are not reflected in the documentation.  Most often, undocumented features are deliberately laid by developers for the purpose of testing, further expanding functionality.  Undocumented features are usually detected during the <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2580%25D0%25B0%25D1%2582%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2580%25D0%25B0%25D0%25B7%25D1%2580%25D0%25B0%25D0%25B1%25D0%25BE%25D1%2582%25D0%25BA%25D0%25B0">reverse engineering</a> process, but they can also be discovered by chance. </blockquote>  Further in article, the description of my attempt to pick up codes to the engineering menu of radio station. <br><a name="habracut"></a><br><h4>  Introduction </h4><br>  I once bought a Chinese-made KYD-IP620 radio station, but under a domestic ‚Äúbrand‚Äù.  I will not advertise the brand, Google will tell.  He twirled in his hands, played and abandoned.  But recently I came across it again and decided to pay more attention to this miracle of technology.  A stupid menu on the settings, forced me to look for software to work with this station.  It seemed to me that the software will give more settings than is available through the menu. <br><br>  Going to the manufacturer's website, I found my radio station model, but I didn‚Äôt find the software.  I wrote a letter to tech support, responded quickly and sent software.  Installed, launched and the first thing that caught my eye, this is a greater number of supported ranges.  They pushed me to look for opportunities to record the required frequency (within reasonable limits of the current range).  But here I was waiting for a bummer. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The official software before recording checked the entered frequency for entering the selected range and prohibited recording out of range.  Okay, I launched a sniffer, figured out the read-write protocol, sketched my utility on the Delphi <s>knee</s> .  But then another bjaka appeared.  I managed to record the frequency I wanted, but the radio station was stupidly silent on it.  Reception or transmission is silence.  Apparently, there is a check also in the MK station. <br><br>  Disassembled the station.  On the board, among other things, 24C64 was found.  This is an i2c EEPROM chip.  It vypayal, took a dump, soldered back.  There was nothing in the dump except my settings and the frequencies I recorded.  I hooked the i2c sniffer to my memory, drove the recording / reading with the official software, my utility, nothing.  Everything that ran on the i2c bus was in the EEPROM, nothing extra was read or written.  All data in the EEPROM is only what I wrote down.  Later, I had already finalized the write / read protocol and was able to read / write in all memory addresses. <br><br><h4>  What is it all about? </h4><br>  Anticipating the question "why do I need all this, what am I writing here?" I will try to describe my thought.  Google gave several schemes of the previous and the following models of the radio station.  I did not find the schematic diagram of my experimental subject, which I am describing in the article, but it coincides with them by 70% (I found out while I was calling the right legs).  According to the scheme, the differences are not significant.  Hence the conclusion that in order to reduce the cost of production to the customer, the manufacturer, especially China (with its mass production) will not re-design globally the schemes, write software under the radio station MC, etc.  Why when there is already ready, which needs a little adjustment - and give.  IMHO is easiest to adjust programmatically, and without the use of the programmer.  This will make a large pile of blanks, which then bring to the requirements of the customer with the least effort.  After this thought, I began to look for an entrance to the engineering menu, and found it.  There was nothing difficult: it was necessary to hold down the 2nd buttons and turn on the radio station. <br><br><h4>  Here it is! </h4><br>  Before entering the menu is written the inscription "SET". <br><br><img src="https://habrastorage.org/files/7f3/0ab/253/7f30ab2533fe475cba6b1041aaf6234e.JPG" alt="image"><br><br>  For further access to the functions, a 6-digit password is required.  Manual search is tedious and disappears.  If the password is incorrect, the word ‚ÄúSET‚Äù is displayed again.  Google gave one password, which leads to reset to factory settings.  When you enter it, the inscription changes to ‚ÄúERASE‚Äù.  Here it is then me when debugging and useful.  There was a thought to organize a search at the MK.  Let him slowly passwords to himself, and I will be engaged in my own business. <br><br><img src="https://habrastorage.org/files/889/f6e/7b9/889f6e7b980a448fba9eef2a1704dd7f.JPG" alt="image"><br><br><h4>  Let's get started </h4><br>  To enter the password on the radio station there is: a push-button keyboard and an encoder. <br><br>  Display of entered data: LCD screen.  I did not want to fasten the camera to the whole case and analyze the pictures or video from it.  We have a screen, we will use it.  Having studied a little more in detail the interior of the station, I discovered that the driver HT1621B is responsible for the LCD display.  Googling datasheet on the driver and pinout it, found out the pins I needed.  These are CS, WR and DATA.  In short, CS is the beginning of the transfer, WR- ‚Äúsynchronization‚Äù, DATA- data. Let's try to take off with it.  Call and podpaivaem on the findings of the MK station, leading to the legs of the driver LCD screen. <br><br><img src="https://habrastorage.org/files/762/019/5d7/7620195d7c9b407fa925034fa89bf0a1.JPG" alt="image"><br><br>  We connect the logic analyzer and watch the transmitted data on the driver for the inscription "SET" and for the inscription "ERASE".  It is clear that the data are different, and we need them.  Next, go to the "organs" of input.  We need the 2nd buttons from the keyboard (MENU and F), and the encoder.  I have no Arduins, I will do what is at hand.  At hand was the Pinboard with AtMega16, from comrade <a href="http://habrahabr.ru/users/dihalt/" class="user_link">DiHalt</a> . <br><br><img src="https://habrastorage.org/files/656/e3f/ba7/656e3fba7eb0499c942f9ce2d9d6faaa.JPG" alt="image"><br><br><h4>  Technical task </h4><br>  We write the encoder emulator and the emulator of pressing the buttons ‚ÄúMENU‚Äù and ‚ÄúF‚Äù (they are needed to enter and confirm the password).  Analyzing the data displayed on the LCD screen.  We will read the LCD driver data through AtMega16 interrupts.  With various driver data from the ‚Äústandard‚Äù (‚ÄúSET‚Äù), we will output the current password using the UART. You can not go deeper into the data format for the driver.  We need to distinguish when the inscription ‚ÄúSET‚Äù is not displayed after pressing the ‚ÄúMENU‚Äù button and when it is lit.  It is logical that the data will be different.  Therefore, I will compare the string of received bytes after the last entered digit of the password and pressing the ‚ÄúMENU‚Äù button.  Having caught several packages of the LCD driver for the inscription ‚ÄúSET‚Äù, making sure that they are the same, he took this premise for the standard.  Comparing with it, I recline those that are the same; I transfer others to the UART for further analysis.  I checked this algorithm with a password that leads to resetting to factory settings; it met my expectations.  In general, the password entry algorithm looks like this: the inscription "SET" is on, an invitation to the engineering menu.  Press the ‚ÄúMENU‚Äù button and enter the 1st character of the password.  Then again press the ‚ÄúMENU‚Äù button to enter the next character.  So we repeat to the last character.  When the last character is entered, press the ‚ÄúMENU‚Äù button again.  And here or the inscription "SET" or something else.  If the ‚ÄúSET‚Äù is lit, we stamp at the beginning by iterating the password, if it is different, we transmit the password via UART for analysis.  Screen for brute force management. <br><br><img src="https://habrastorage.org/files/580/0ae/15e/5800ae15e0f54aafb1c2e9a0b3943144.jpg" alt="image"><br><br><h4>  Reality </h4><br>  The reality is that I was counting on a great speed of search, but life made adjustments.  In the radio station, the MK handles the encoder and keystrokes as it should, with ‚Äúanti-bounce‚Äù of contacts, with delays in the user's reaction.  Therefore, delays are included in the bruteforce code.  Yes, it is all built on delays.  Sketched utility to control brute force.  In the case of reading data from a driver other than the ‚Äústandard‚Äù, a password is transmitted to the utility on the computer via UART, at which it occurred. <br><br><h4>  Total </h4><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/ENqmlK0CWYQ%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700190,15700253,15700259&amp;usg=ALkJrhhidz0Km3Rc9CzgaInsWAvhFOLMqQ" frameborder="0" allowfullscreen=""></iframe><br><br>  Busting launched, and ticking.  At the moment, nothing has twisted.  But I do not give up.  I will wait patiently for the end.  It is clear that with this approach there may be ‚Äúfalse‚Äù triggers.  But on the general background of the future number of passwords - this is a drop in the ocean.  These "false" passwords can later be quickly rechecked via the utility.  At the end of the search, I will definitely inform you how the whole brute force ended and what happened in the end. <br><br>  Utility sources, AtMega16 firmware are <a href="https://github.com/lepik/BruteIP-620">available on the githab</a> . </div><p>Source: <a href="https://habr.com/ru/post/253153/">https://habr.com/ru/post/253153/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../253139/index.html">Test Chef cookbook</a></li>
<li><a href="../253143/index.html">Automatics for the KTC or extend battery life</a></li>
<li><a href="../253145/index.html">"Patch" mirror in the car</a></li>
<li><a href="../253149/index.html">Corporate search</a></li>
<li><a href="../253151/index.html">The Groovy project intends to join the Apache Software Foundation</a></li>
<li><a href="../253155/index.html">How are we tested</a></li>
<li><a href="../253157/index.html">Haskell Range Control Arithmetic with Type-Level Literals</a></li>
<li><a href="../253159/index.html">The history of participation in the competition "Flying robots". Part 1</a></li>
<li><a href="../253163/index.html">The tenth issue of the magazine TsODy.RF</a></li>
<li><a href="../253167/index.html">3D systems - a selection of great ways to mingle with content</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>