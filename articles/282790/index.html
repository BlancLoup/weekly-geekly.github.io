<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 17: Hacking SWIFT and cash registers, soliciting Android with exploits, bypassing AppLocker</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Financial cyber fraud often affects ordinary people, bank customers, but as a result, financial institutions themselves experience problems. From the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 17: Hacking SWIFT and cash registers, soliciting Android with exploits, bypassing AppLocker</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/826/df5/bd9/826df5bd9a2c496cba6c247310c997fd.jpg" align="right">  Financial cyber fraud often affects ordinary people, bank customers, but as a result, financial institutions themselves experience problems.  From the fact that user devices attack is easier than the banking infrastructure, everyone suffers.  But there are exceptions: the <a href="https://securelist.ru/blog/issledovaniya/25106/bolshoe-bankovskoe-ograblenie-apt-kampaniya-carbanak/">Carbanak</a> campaign, discovered by our experts last year, the fresh attacks of <a href="https://securelist.ru/blog/issledovaniya/28044/uvelichivaetsya-kolichestvo-apt-ograblenij-bankov-s-ispolzovaniem-atak-metel-gcman-i-carbanak-2-0/">Metel, GCMan</a> and the Carbanak 2.0 campaign <a href="https://securelist.ru/blog/issledovaniya/28044/uvelichivaetsya-kolichestvo-apt-ograblenij-bankov-s-ispolzovaniem-atak-metel-gcman-i-carbanak-2-0/">, which</a> is more focused on the clients of the (large) ones.  Add to this the high-tech robbery of the central bank of the Republic of Bangladesh, which occurred in February of this year.  Certainly, such attacks require significantly more <i>skills and exp</i> , than fraud with users' wallets, but you can hit the jackpot too much (or go to jail for a longer time, as lucky). <br><br>  This week, the bank robbery story continued: the technical details of the attack became known.  <a href="https://threatpost.com/bangladesh-bank-hackers-accessed-swift-system-to-steal-cover-tracks/117637/">It turned out</a> that the robbers directly manipulated the software of the international payment system SWIFT.  That is, it is not only a matter of the vulnerability of the infrastructure of a particular bank: all large financial organizations are subject to such an attack in varying degrees.  Back to the technique later, this story is worth telling from the beginning. <br><br>  So, on technology alone, even the coolest, the crackers would not have gone far: the theft of tens of millions of dollars in any case will be noticed quickly.  The attack took place somewhere between February 4 and 5, on the eve of the weekend (in Bangladesh it is Friday and Saturday).  A total of 32 transactions were made for a total amount under a billion dollars.  Of these, 30 transactions were identified and blocked ‚Äî they managed, despite the day off.  Two transfers, in amounts of $ 21 and $ 80 million, respectively, to Sri Lanka and the Philippines, were successful. <br><a name="habracut"></a><br>  The transfer to Sri Lanka was subsequently returned thanks to a banal typo.  Directing funds to a local nonprofit organization, the organizers of the attack made a mistake in the word ‚Äúfoundation‚Äù (fandation instead of foundation), and the German Deutsche Bank serving as an intermediary stopped the ‚Äúpending clarification‚Äù transaction.  In the Philippines, everything worked out.  The Bank of Bangladesh notified the local RCBC bank of the fact of fraud, but if the attack itself was made possible by Muslim holidays, the Philippine bank employees were prevented from taking measures in time for the Chinese New Year.  When at last everyone went to work, someone had already withdrawn from the account 58.15 million dollars for false documents.  I wonder how the process of withdrawing $ 58 million from a bank account looks like? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Details of the attack became known only recently.  On April 22, local police <a href="http://www.reuters.com/article/us-usa-fed-bangladesh-idUSKCN0XI1UO">shared their</a> data, and according to officials, there was ... no security at the bank.  With physical security, everything was not bad: all operations with the SWIFT system were carried out from a separate and, apparently, carefully guarded premises.  Reports on all electronic transactions must be printed. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/538/8b6/2b5/5388b62b561a4182b8ba2486de1d73e4.jpg"></div><br><br>  At the network level, SWIFT operations were isolated or poorly, or not at all, judging by the scant statements of the police.  The 10-dollar baud switches were mentioned, the lack of a firewall (apparently between the SWIFT infrastructure and everything else, including the Internet).  The police tend to blame both the bank itself and representatives of the international payment system: the latter suddenly found out that SWIFT operations are not protected when it was already late.  It is quite expected that, in principle, the bank could not understand how the leak occurred ( <i>and what it all was</i> ) until experts were invited for analysis.  By the way, the difference between the presence of protection systems and their absence (or incorrect implementation).  You can even hack a protected system, but in an unprotected one you can also cover the traces so as to make further investigation as difficult as possible. <br><br>  Well, now turn to the technique.  A detailed analysis of the tools for the attack was <a href="http://baesystemsai.blogspot.ru/2016/04/two-bytes-to-951m.html">carried out by the</a> company BAE Systems, and then a direct attack on the specialized SWIFT software was revealed.  Robbers could act differently: to seize control of a computer connected to the payment system, and continue to do the wiring "hands", but went more difficult and reliable way.  The malicious code intercepted SWIFT system messages, looked for predefined sequences of characters in them, in general, conducted reconnaissance. <br><br>  For the attack, the crackers replaced the standard modules of the payment system and cut off part of the checks.  An illustrative example is also given: to disable one of the checks, which, presumably, the fraudulent translation could not get through, it was enough to change two bytes, removing the conditional jump from the code. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/7fa/401/439/7fa40143981541d48a8f20727d76d0f9.png"></div><br><br>  It also turned out to be easy to deceive an additional security measure with the obligatory printing of transactions on the printer.  For printing, the system generates files with the necessary information, and the malware simply scored these files with zeros, that is, not only blocked the printing, but also erased the information in digital form. <br><br>  My colleagues at Threatpost asked for a comment from SWIFT, and <a href="https://threatpost.com/bangladesh-bank-hackers-accessed-swift-system-to-steal-cover-tracks/117637/">received a</a> response that was very similar to the usual reaction of financial organizations to the facts of fraud from ordinary customers. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c3e/1c9/2e3/c3e1c92e35a64a73a1c79bde91ceaaf0.jpg"></div><br><br>  In a sense, the attack did not reveal vulnerabilities in the SWIFT infrastructure, it‚Äôs about the unsafe environment of the client; in short, the <i>problem is not on our side</i> .  And they are right, but this is such a rightness that will not help anyone.  I do not think that there will be many such incidents, and most likely from this whole story, conclusions have already been made: there are not so many places where it is possible to steal a billion in one fell swoop.  But the "consumer" cyber fraud, attacks on heterogeneous banks, customers for mere mortals, small and large businesses, will become more.  To deal with it is more difficult, but necessary. <br><br>  <b>Unusual ransomware Trojan for Android with Exploits Included</b> <br>  <a href="https://threatpost.ru/android-ransomware-attacks-using-towelroot-hacking-team-exploits/15941/">News</a>  Blue Coat <a href="https://www.bluecoat.com/security-blog/2016-04-25/android-exploit-delivers-dogspectus-ransomware">research</a> . <br><br>  Extortionists for ordinary computers use exploits in full force, although they are not limited to them.  But on mobile devices, until recently, the situation looked different: for the initial infection, the attackers rely more on social engineering methods.  But the threat landscape for Android is developing in the same spiral as the attacks on the PC, just much faster.  This means that the appearance of malware for smartphones and tablets that are installed without the owner‚Äôs help is inevitable.  And they did appear.  A curious sample of such a ransomware Trojan was analyzed by experts from Blue Coat.  The extortionist, known as Cyber.Police, attacks devices from Android versions 4.x and is an extortioner, but not a cryptographer.  The data are not taken hostage, the device is simply blocked and the ransom <s>puppies are</s> required to be <s>bought</s> with iTunes payment cards for $ 200. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/267/d88/281/267d88281f9b4766ad9a3898426b351b.jpg"></div> <br><br>  Much more interesting, as the extortionist gets on the device.  To do this, use two exploit.  The first exploit lbxslt allows you to take control of the device after viewing the site with an infected script in a regular browser.  This exploit, along with a number of others, was stolen from the Hacking Team last year.  The second, known as Towelroot, exploits a vulnerability in the Linux kernel up to 3.4.15 ( <a href="https://cve.mitre.org/cgi-bin/cvename.cgi%3Fname%3DCVE-2014-3153">CVE</a> ) and is in fact a modification of a once popular utility for gaining root rights.  At this stage, a malicious application, the Trojan itself, is installed, with the suppression of standard messages about the appearance of a new app in the system. <br><br>  According <a href="https://developer.android.com/about/dashboards/index.html">to</a> Google itself, more than half of the devices still work on various versions of Android 4.x.  In an interview with Threatpost, Blue Coat researcher Andrew Brandt compared this version of Android with Windows XP - by perception this is an outdated system that is not supported by most vendors and is extremely vulnerable.  Meanwhile, Windows XP was released 15 years ago, and the latest version of Android 4.x (KitKat) - 2.5 years ago.  Progress is moving by leaps and bounds, but in this context it somehow does not inspire at all. <br><br>  <b>Group FIN6 attacks POS-terminals, successfully stole data of 20 million credit cards</b> <br>  <a href="https://threatpost.com/pos-attacks-net-crooks-20-million-stolen-bank-cards/117595/">News</a>  FireEye <a href="https://www2.fireeye.com/rs/848-DID-242/images/rpt-fin6.pdf">study</a> . <br><br>  FireEye research on the activities of the group, known as FIN6, does not reveal America: yes, checkout point terminals, and steal money.  Such operations are developed according to the targeted attack scenario: the corresponding master keys are selected for the victim‚Äôs infrastructure, and then the malware finds specialized computers and begins intercepting data.  The story is interesting in context.  After similar attacks on the largest US retail chains (the Target network has <i><a href="https://threatpost.ru/poteri_target_otsenili_v_11_gb/1372/">distinguished the</a></i> most), the United States began a long and painful transition to the chip card payment system common in Europe (and we, too). <br><br>  EMV cards are much better protected and attacks like FIN6 are not necessarily susceptible (although options are possible).  So, in connection with this, a US-oriented cybercrime started a party on a sinking ship.  Chip-and-pin companies that have introduced a system report a noticeable decrease in the number of incidents related to fraud, while those who are late report a growth <a href="https://blog.kaspersky.com/us-emv-transition-increases-fraud/11929/">of an average of 11%</a> .  Since buyers do not have the habit of refusing to buy in places where they still scan the magnetic strip with credit cards, it turns out that this temporary transitional period will be more dangerous for residents and guests of the United States than before or after.  However, the recommendation on the use of one-time cards for payment during trips is unlikely to be canceled even when absolutely everyone switches to chip cards. <br><br>  <b>What else happened:</b> <br>  Windows-built Regsvr32 <a href="https://threatpost.ru/core-windows-utility-can-be-used-to-bypass-applocker/15889/">can be used</a> to download and run arbitrary code to bypass security systems, in particular, AppLocker.  Fortunately, this is still the Proof of Concept from the researcher, and technically it cannot even be called a vulnerability, rather using standard system tools in an unnatural way. <br><br><img src="https://habrastorage.org/files/1a3/d84/77c/1a3d8477c94641beaa19694292d10b54.png" align="right">  <b>Antiquities:</b> <br>  "Astra-976" <br><br>  A very dangerous resident virus, encrypted, is written to the COM files of the current directory when the infected file is started and then into all COM files that are launched for execution.  If at the start of the file the system clock shows 17 minutes, then the virus encrypts (XOR 55h) the partitioning table in the MBR of the hard drive.  Traces int21h.  It contains the lines: "¬© AsTrA, 1991", "(2)". <br><br>  <i>Quote from the book "Computer viruses in MS-DOS" Eugene Kaspersky.</i>  <i>1992</i>  <i>Page 26.</i> <br><br>  <i>Disclaimer: This column reflects only the personal opinion of its author.</i>  <i>It may coincide with the position of Kaspersky Lab, or it may not coincide.</i>  <i>Then how lucky.</i> </div><p>Source: <a href="https://habr.com/ru/post/282790/">https://habr.com/ru/post/282790/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../282780/index.html">The path of the laplacian. Part 2</a></li>
<li><a href="../282782/index.html">About the unconventional way to use a computer mouse</a></li>
<li><a href="../282784/index.html">The art of rx</a></li>
<li><a href="../282786/index.html">Internet bees, or the green future of M2M applications</a></li>
<li><a href="../282788/index.html">Evolution of programming languages</a></li>
<li><a href="../282792/index.html">Disconnection of analog satellite TV: 4 years later (part 2)</a></li>
<li><a href="../282794/index.html">Two-headed monster in the world of viruses: GozNym</a></li>
<li><a href="../282798/index.html">Working with MySQL: how to scale the data warehouse 20 times in three weeks</a></li>
<li><a href="../282800/index.html">Russian translation of the speech by Alex Ionescu "Crazy attempt to rewrite Windows from scratch"</a></li>
<li><a href="../282806/index.html">01100100 years since the birth of Claude Shannon</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>