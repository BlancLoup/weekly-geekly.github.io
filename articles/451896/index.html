<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The ‚Äúunbreakable‚Äù eyeDisk is protected by an iris scan, but transmits the password in clear text</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="EyeDisk USB drive with biometric protection that is ‚Äúimpossible to crack‚Äù 

 Most modern methods of biometric protection do not always mean increased ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The ‚Äúunbreakable‚Äù eyeDisk is protected by an iris scan, but transmits the password in clear text</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/6k/sq/9g/6ksq9gind5a3pvcjbelnlbv3q0y.png"><br>  <i><font color="gray">EyeDisk USB drive with biometric protection that is ‚Äúimpossible to crack‚Äù</font></i> <br><br>  Most modern methods of biometric protection do not always mean increased security.  The failure of eyeDisk developers actually shows more general trends.  Unfortunately, in the IT industry it happens that, under the impression of "brilliant" new technologies, people forget about the basics of security. <br><br>  The developers advertised eyeDisk as an ‚Äúunbreakable‚Äù USB-drive - and successfully issued <a href="https://www.kickstarter.com/projects/eyedisk/eyedisk-unhackable-usb-flash-drive">over $ 21 thousand pre-orders</a> on Kickstarter. <br><a name="habracut"></a><br>  In fact, the eyeDisk device is a flash card with an integrated camera that scans the iris.  Since the computing power of the gadget is not enough for image analysis and authentication, the picture, along with the password, is transferred via USB to the computer where the special software works. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Scanning and recognition take about 0.5 seconds. <br><br><img src="https://habrastorage.org/webt/1f/j9/d7/1fj9d7swddd8_hxyfnnvcht3raw.gif"><br><br>  A 32GB flash drive is sold for $ 99, and investors could order it for $ 50 as part of a crowdfunding campaign.  The most expensive 128 GB flash drive costs $ 178 ($ 89).  Sales began in March 2019. <br><br>  The ‚Äúunbreakable‚Äù flash drive attracted the attention of hackers from PenTest Partners.  They <a href="https://www.pentestpartners.com/security-blog/eyedisk-hacking-the-unhackable-again/">write</a> that the first thing connected the media to the Windows virtual machine.  It was recognized as three devices, including a USB camera.  The infrared camera takes funny black and white photos: for example, bearded people do not have a beard. <br><br>  Then penterster opened eyeDisk and examined its insides.  Subsequently, it was not useful for hacking, but this is the standard procedure.  They paid attention to a curious fact: there are three MCUs on the board (highlighted in red and green in the photos), but there is no central control unit among them, each chip has its own role. <br><br><img src="https://habrastorage.org/webt/-e/1o/ix/-e1oixxdt3xwlmlmbem7afachse.png"><br><br>  The camera is shown in blue, and purple is two tssop8 chips (PUYA P25Q040H SPI NOR Flash). <br><br><img src="https://habrastorage.org/webt/ib/vq/lm/ibvqlmq4xscattkcwvmgj6jodyo.png"><br><br>  Then it's software time.  The latest versions of the Wireshark sniffer are able to listen on USB traffic.  For reference, USB mass storage is a shell for SCSI commands, so the general pattern looks like this: <br><br><img src="https://habrastorage.org/webt/0d/8u/l3/0d8ul3gkjrkbqoc4iwbodz0wixc.png"><br><br>  Here are the LUN (Logical Unit Number), under which the device is recognized, and the CDB command descriptor block (Command Descriptor Block).  In this case, the top packet sends a SCSI command with opcode 0x06 and receives a response from the device.  In USB terminology, the word ‚ÄúIn‚Äù indicates the direction to the host, ‚ÄúOut‚Äù to the device. <br><br>  Contents of the first package: <br><br><img src="https://habrastorage.org/webt/dd/ne/gq/ddnegqf4fbx8nfh1ex1m-wl1t5s.png"><br><br>  The contents of the response packet: <br><br><img src="https://habrastorage.org/webt/ek/oi/tm/ekoitmki8efe2txsscrpmfln4r4.png"><br><br>  But what packets are transmitted at the time of unlocking the device after successful authentication.  First SCSI command from host: <br><br><img src="https://habrastorage.org/webt/q9/gr/u7/q9gru7x84te205fojnz17mv0bje.png"><br><br>  And the device response: <br><br><img src="https://habrastorage.org/webt/zf/w-/wl/zfw-wlyq7rktafifhhsuoxcvi8c.png"><br><br>  The red color shows the password that is set for the device.  As you can see, it is transmitted in the clear.  But listening to the USB bus does not pose any difficulty, which the developers did not think at all.  Or they were freelancers who were not directly told to implement password encryption (see the article <a href="https://habr.com/ru/company/globalsign/blog/449452/">‚ÄúWeb developers write unsafe code by default‚Äù</a> : the web has the same problem). <br><br>  The blue color in the screenshot highlights 16 bytes of the iris hash - the second factor of two-factor authentication. <br><br>  The most interesting thing is that if you enter the wrong password or scan an arbitrary iris, the program sends exactly the same data packet to the device, receiving the same answer. <br><br>  That's all that constitutes an ‚Äúunbreakable‚Äù eyeDisk drive. <br><br>  Pentesters fumbled a bit more with flash memory, made a dump and found a specific memory area where the password is stored.  Although it was already, in principle, optional.  The principal vulnerability is that, for verification, the software requests a password from the device and an iris scan of the real user, which is transmitted in the open form.  Information is transmitted with each authentication attempt, and verification occurs on the host. <br><br>  The vulnerability report was sent to eyeDisk a month ago, the manufacturer promised to fix the vulnerability, but so far it hasn‚Äôt given an answer; <br><br>  Listening to traffic very often reveals vulnerabilities in the Internet of Things and other peripherals.  Developers sometimes forget that any transmission channel can be heard.  Trendy modern technologies like iris scanning or other biometrics will not add security if we ignore encryption. <br><br><hr><br>  Take part in the PKI survey from GlobalSign until May 24, 2019 and you will get the opportunity to win prizes, one of which is the Amazon Gift Card for $ 500. <br><br><img src="https://habrastorage.org/webt/ws/t8/pj/wst8pjyal67lg9pajdynsk6ibom.png"><br>  The survey is available at: <a href="https://www.surveymonkey.com/r/GlobalSignPKI-2019">www.surveymonkey.com/r/GlobalSignPKI-2019</a> </div><p>Source: <a href="https://habr.com/ru/post/451896/">https://habr.com/ru/post/451896/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../451880/index.html">DevPRO'19: View from Wrike's booth</a></li>
<li><a href="../451884/index.html">Seven years of working as a developer: what lessons have I learned</a></li>
<li><a href="../451886/index.html">Use of discrete mathematics in testing</a></li>
<li><a href="../451890/index.html">Delegating the reverse zone subnet less than / 24 in BIND. How it works</a></li>
<li><a href="../451894/index.html">A brief and vigorous overview of the architecture of compilers</a></li>
<li><a href="../451898/index.html">Innovations in Russian</a></li>
<li><a href="../4519/index.html">"Fat" investment hinders a good startup</a></li>
<li><a href="../451900/index.html">The first contribution to the browser API from Facebook</a></li>
<li><a href="../451902/index.html">Microsoft Azure Developer Camp Russia</a></li>
<li><a href="../451904/index.html">Sometimes more is less. When reducing the load increases the delay</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>