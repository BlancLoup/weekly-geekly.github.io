<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>External impact on the web client 1C: Enterprise</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="External impact on the web client 1C: Enterprise 
 The described method allows you to organize the container using html and JavaScript and place the 1...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>External impact on the web client 1C: Enterprise</h1><div class="post__text post__text-html js-mediator-article"><h4>  External impact on the web client 1C: Enterprise </h4><br>  The described method allows you to organize the container using html and JavaScript and place the 1C web client in it.  At the same time, the container is able to manage the web client, both at the algorithm level and at the style management level.  The approach was tested on 1C version 8.2.18.96. <br><br><h5>  Setup on the web server side </h5><br>  Each 1C web client works with an information base published on a web server.  For a more complete integration, the container into which the web client will be embedded must be created on the same server.  This will avoid the security problems associated with cross-domain calls.  For example, Silverlight and Flash do not allow access to the content of other sites unless the corresponding policies are configured as xml files.  Post requests between domains can also be difficult. <br><a name="habracut"></a><br>  Apache configuration is stored in the conf / httpd.conf file <br><br><img src="http://www.richmedia.us/file.axd?file=2013%2f6%2fimage001.jpg" alt="File Location in Far">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      You need to change the value of the paths.  Below are the values ‚Äã‚Äãfor the c path: /Apache.www - it contains links to the 1C information bases. <br><br><pre><code class="javascript hljs">DocumentRoot <span class="hljs-string"><span class="hljs-string">"C:/Apache.www"</span></span> &lt;Directory <span class="hljs-string"><span class="hljs-string">"C:/Apache.www"</span></span>&gt;</code> </pre> <br><br><h5>  Presetting </h5><br>  It is better to start the project of the HTML file with a ready-made template, where styles are written for all browsers.  A very decent template is located at <a href="http://html5boilerplate.com/">html5boilerplate.com</a> <br><br>  It should be placed in the root directory of documents that was specified when setting up your web browser.  The index.html file is currently responsible for the home page - it needs to be edited. <br><br>  Just in case we set the browser compatibility mode - compatibility with the latest: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"X-UA-Compatible"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"IE=edge,chrome=1"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  The template used works with jQuery. <br><br>  The launch of the 1C web client will occur in the IFrame inside index.html.  The first button will be responsible for launching the 1C App, the second for launching the NetBridge application. <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"appButton"</span></span></span><span class="hljs-tag">&gt;</span></span> 1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"netBridgeButton"</span></span></span><span class="hljs-tag">&gt;</span></span> 2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"iframe"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  The button handler looks like this: <br><br><pre> <code class="javascript hljs">$(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).ready(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#appButton"</span></span>).click(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#iframe"</span></span>).attr(<span class="hljs-string"><span class="hljs-string">"src"</span></span>, <span class="hljs-string"><span class="hljs-string">"App/ru_RU/?N="</span></span>); }); $(<span class="hljs-string"><span class="hljs-string">"#netBridgeButton"</span></span>).click(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#iframe"</span></span>).attr(<span class="hljs-string"><span class="hljs-string">"src"</span></span>, <span class="hljs-string"><span class="hljs-string">"NetBridge/ru_RU/?N="</span></span>); }); ...</code> </pre><br><br>  At this stage, you can affect the startup parameters of the web client.  For example, pass the user name (N = Administrator) and password. <br><br><h5>  Reaction to web client events </h5><br>  The first event that needs to be caught is the event when the 1C web client is loaded and ready to use. <br><br>  IFrame implements an onload event for which you can subscribe.  The problem is that onload web client can be called up to 3 times.  such a call is associated with redirections, for example, the 1C web client redirects the web client based on the user's language.  By experiment, we managed to establish that the last onload call is connected with the appearance of the WebUI object in the web client.  But the initialization process of 1C is not over.  At this stage the necessary libraries are not loaded and the interface of the main form is not created.  For a sign of creating the main interface, you can take the moment when the variable initialized becomes equal to true. <br><br>  The variables of the 1C web client can be accessed through the structure: <br><br><pre> <code class="javascript hljs">cw = $(<span class="hljs-string"><span class="hljs-string">"#iframe"</span></span>).get(<span class="hljs-number"><span class="hljs-number">0</span></span>).contentWindow;</code> </pre><br><br>  Handlers will look like this: <br><br><pre> <code class="javascript hljs">$(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).ready(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ ... $(<span class="hljs-string"><span class="hljs-string">'#iframe'</span></span>).load(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   .      ru_RU,  if ("WebUI" in $("#iframe").get(0).contentWindow) { var cw = $("#iframe").get(0).contentWindow; setTimeout(function () { desktopLoadedComplete(); }, 50); } }); });</span></span></code> </pre><br><br>  As a result of the event chain, the desktopLoadedComplete function will be called: <br><br><pre> <code class="javascript hljs">desktopLoadedComplete = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cw = $(<span class="hljs-string"><span class="hljs-string">"#iframe"</span></span>).get(<span class="hljs-number"><span class="hljs-number">0</span></span>).contentWindow; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($(<span class="hljs-string"><span class="hljs-string">"#iframe"</span></span>).get(<span class="hljs-number"><span class="hljs-number">0</span></span>).contentWindow.Web.Application.initialized) { <span class="hljs-comment"><span class="hljs-comment">//alert(cw.Web.Common.Version); themes = cw.winManager.controls["themes"]; themes.setListener(handleEvents); $('span.themeLink', $("#iframe").contents()).css('text-decoration', 'line-through'); } else { setTimeout(function () { desktopLoadedComplete(); }, 50); } }</span></span></code> </pre><br><br>  In desktopLoadedComplelte, you can affect the 1C form.  For example, make the section selection letters crossed out.  The jQuery construction is suitable for this: <br><br><pre> <code class="javascript hljs">$(<span class="hljs-string"><span class="hljs-string">'span.themeLink'</span></span>, $(<span class="hljs-string"><span class="hljs-string">"#iframe"</span></span>).contents()).css(<span class="hljs-string"><span class="hljs-string">'text-decoration'</span></span>, <span class="hljs-string"><span class="hljs-string">'line-through'</span></span>);</code> </pre><br><br><img src="http://www.richmedia.us/file.axd?file=2013%2f6%2fimage002.jpg" alt="Changed 1C web client design"><br><br>  The winManager.controls ["themes"] object of type WebUI.ThemesPanel is responsible for the sections window.  This type is inherited from WebUI.NavigationControl, which in turn is inherited from WebUI.Control and Web.Events.EventsBase. <br><br>  Experiencedly managed to connect to the partition switching event.  It looks like this: <br><br><pre> <code class="javascript hljs">themes = cw.winManager.controls[<span class="hljs-string"><span class="hljs-string">"themes"</span></span>]; themes.setListener(handleEvents);</code> </pre><br><br>  The handleEvents event handler receives several parameters, among which is the source of the event, the event code.  To analyze the partition switching, the handler will be as follows: <br><br><pre> <code class="javascript hljs">handleEvents = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sender, eventId, data0</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cw = $(<span class="hljs-string"><span class="hljs-string">"#iframe"</span></span>).get(<span class="hljs-number"><span class="hljs-number">0</span></span>).contentWindow; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (eventId == cw.Web.Events.UIThemeButtonClickedEvent) { alert(<span class="hljs-string"><span class="hljs-string">"eventId = Web.Events.UIThemeButtonClickedEvent"</span></span>); cw.winManager.handleEvents(sender, eventId, data0); } }</code> </pre><br><br>  When the partition is switched, a dialog box will be called up and control will be transferred to the native event handler 1C. <br><br><h5>  findings </h5><br>  Html, JavaScript and jQuery provide powerful tools for managing the 1C web client from the outside.  Parameters transfer (login, password), design and style management, event subscription are available.  Web client 1C contains a powerful framework that takes a long time to deal with it. <br><br>  The article does not cover the operation of calling server and client procedures, but theoretically this possibility exists. <br><br>  The article is also interesting when using the HTML field on a web client without the proposed technology.  Since in this case, the entire infrastructure of 1C is also available through the parent window.  In theory, when called in such a context of server procedures, it is possible to organize interaction between user html-code and native 1C controls.  This option is an alternative to using WebBrowser Control, which means unbinding from Windows. <br><br>  Website source code: <a href="">web-site.zip (86,88 kb)</a> </div><p>Source: <a href="https://habr.com/ru/post/183016/">https://habr.com/ru/post/183016/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../183004/index.html">XQuery enhancements in MarkLogic Server</a></li>
<li><a href="../183006/index.html">Electricity Lessons - Transmission Lines</a></li>
<li><a href="../183008/index.html">Deferred objects in AngularJS</a></li>
<li><a href="../183010/index.html">PHPUnit: a simple syntax for creating mock objects</a></li>
<li><a href="../183012/index.html">Windows Server 2012 - life without GUI</a></li>
<li><a href="../183018/index.html">Web Design + Mac OS - Adobe = Sketch. The new tool is better than all the old</a></li>
<li><a href="../183022/index.html">Random'ization in Python. Is it random?</a></li>
<li><a href="../183024/index.html">Numbers in itself</a></li>
<li><a href="../183028/index.html">How to quickly make a cyborg cockroach</a></li>
<li><a href="../183030/index.html">RedHat's cloud-based OpenShift platform completed testing and unveiled the first paid tariff with a trial period.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>