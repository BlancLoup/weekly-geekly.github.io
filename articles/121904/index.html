<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Odorless filtering and non-linear estimation *</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="* from English "Unscented filtering and nonlinear estimation" (by Google Translator ) 
 At the request of dmitriyn decided to publish his vision on th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Odorless filtering and non-linear estimation *</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/b75/42a/1a5/b7542a1a587c0970bf97cd1559a8cbfe.png" alt="image" align="left">  <i>* from English</i>  <i>"Unscented filtering and nonlinear estimation" (by <a href="http://translate.google.ru/">Google Translator</a> )</i> <br>  At the request of <a href="http://habrahabr.ru/users/dmitriyn/" class="user_link">dmitriyn</a> decided to publish his vision on the so-called "Unscented Kalman filter", which is the extension of Kalman linear filtering in the case when the dynamic and observation equations of the system are non-linear and cannot be adequately linearized. <br>  As the name of this filtering method <s>‚Äúkosher‚Äù is readily</s> translated into Russian, I do not know yet what is reflected in the title of the article, so I decided to just copy-paste a rather amusing, in my opinion, machine translation.  Another fun version of the translation is the <a href="http://www.rsdn.ru/forum/dictionary/1245324.flat.aspx">insensitive filter</a> . <br clear="left"><a name="habracut"></a><br>  <b>UPD</b> : Added a comment to the section "UT APPLICATION" <br><br><h4>  INTRODUCTION </h4><br>  In a <a href="http://habrahabr.ru/blogs/algorithm/120133/">previous article</a> on <b>linear</b> Kalman filtering, one of the possible approaches to the synthesis of FC for the case of a linearized simplified mathematical model of a dynamic system was described.  The Kalman filter described there is sometimes referred to in literature as ‚Äúconventional Kalman Filter‚Äù [ <a href="http://www.hindawi.com/journals/mpe/2009/140963/">2</a> ].  This name he received, because  gives the smallest root-mean-square error only if several hypotheses (conventions) are observed - for example, the noise is white and distributed according to the normal law, the expectation of the noise is zero, there are no correlations between the noise and the cross-links between the phase coordinates.  These restrictions are quite serious and in practice often hypotheses are violated.  There are techniques to circumvent these limitations (for example, adding coordinates to a phase vector filter for a colored noise generator and entering a fictitious perturbation for ‚Äúbiased‚Äù noise).  All of them lead to an increase in computational complexity (the dimension of the problem grows) and difficulties in the synthesis of a filter that is resistant to violation of conventions. <br>  There is also an ‚ÄúExtended Kalman filter‚Äù [ <a href="http://en.wikipedia.org/wiki/Kalman_filter">1</a> ], which is similar in its structure to the linear version, differing in that the equations of dynamics and observations contain non-linear (power, trigonometric, etc.) functions from the phase coordinates (see equations below).  This difference also implies the existence of cross-links between phase coordinates (for example, the product of two coordinates). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/26a/a38/6ef/26aa386ef643315f8e9e3be50a4fef85.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/e22/dd7/cc6/e22dd7cc6c4663129dbd792ea6ed9bba.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      When using EKF, it is necessary to calculate the Jacobian, a matrix of partial derivatives of the phase coordinates, at each iteration step.  Because of this, computational complexity greatly increases and the question of the stability of discretized differential equations becomes even more acute.  In essence, EKF realizes in itself a linearization layer of a nonlinear dynamical system.  This is the main reason why EKF may be ineffective.  The use of a strongly non-linear model of a dynamic system leads to a very poor conditionality of the problem, i.e.  small error of the parameters of the mat.  models will lead to large computational errors.  As a result, the algorithm will lose robustness (error tolerance). <br><br>  The unscented Kalman filter (UKF) [ <a href="http://www.cs.unc.edu/~welch/kalman/media/pdf/Julier1997_SPIE_KF.pdf">3</a> ] uses a different approach ("unscented transform").  <s>According to Wikipedia,</s> this approach implies the choice of a certain minimum set of samples (sigma points) for the data of expectation and covariance of the desired vector with random interference superimposed on it.  Nonlinear prediction functions are constructed by sigma points, which are then used to compute the crosscovariance matrix (the core of the Kalman filtering algorithm). <br>  After writing the last paragraph I personally had more questions.  Like St. Augustine, who knew what time was, until he was asked about the time.  Below I will try to explain to myself and you, dear readers, the essence of the considered method of nonlinear filtering. <br><br><h4>  UNSCENTED TRANSFORM </h4><br>  Perhaps I'll start with a more detailed description of the two main problems of the linear Kalman filter (FC) and the nonlinear (extended, EKF).  The first problem is interference conventions.  As written above, the linear FC assumes that the noises are ‚Äúwhite‚Äù and are distributed according to the normal law.  If the noise is ‚Äúcolored‚Äù, then we must synthesize a digital shaping filter, by passing ‚Äúwhite‚Äù noise through which we will receive noise with a spectral characteristic equivalent (ideally) or close to the existing de facto.  The phase vector of this filter is added to the phase vector FC.  This in turn increases the dimension of the problem.  Suppose that this problem is not too serious.  But there is a second - the problem of nonlinearity of the mathematical model.  In consequence of non-linearity, we must implement an approximator that allows linearizing the non-linear matrix function (see ‚Äúh‚Äù in the equation above) and thus provide the opportunity to separate the variables.  Variables must be separated so that it is possible to make equations for the components of the phase vector.  In the EKF, linearization is performed by calculating the Jacobian, i.e.  For each equation in ‚Äúh‚Äù, partial derivatives are calculated for each of the phase variables.  By itself, this operation is already a problem - a large amount of computation.  In addition, to calculate the Jacobian, a Taylor (multidimensional) series expansion is used: <br><br><img src="https://habrastorage.org/storage/b5320290/0c5ef930/ed4e0a2e/3c37f8f8.png"><br><br>  In this case, only the first member of the series is taken, and the rest are assumed to be negligible.  Thus, using this linearization, we obtain an expression of the form: <br><br><img src="https://habrastorage.org/storage/5a9b36a4/7d8a1380/dc95db78/ec8cba8e.png"><br>  In this equation, ‚ÄúDe‚Äù is the operator for calculating the total differential of the matrix function. <br><br>  If the nonlinearity of the mathematical model is small (the model is almost linear), this statement can be considered true.  However, in practice, the nonlinearities of the model are such that they do not allow rejection of the expansion terms of the second and / or higher orders of smallness.  In such cases, the linearization in the EKF generates a computational error, which cannot be neglected.  In some, particular cases, it is possible to do without decomposition into a Taylor series, but these are particular solutions that are rigidly tied to one specific object.  There is also a solution that cuts the Taylor series to a member of the second order of smallness [6].  It involves the calculation of the Hessian - the second order derivative tensor.  Just please do not make me chew what it is.  Awareness of the fact that this makes EKF even more difficult and complicates its implementation is enough. <br>  So, FC can be applied to a nonlinear model of an object if there is a certain transformation known that allows to project the current value of the phase vector (to make a ‚Äúnonlinear‚Äù forecast) for the next iteration step.  If this (adequate) transformation is unknown, then we use EKF with its, often also inadequate, linearization and a very large computational load.  Thus, we need a method that allows one to dispense with the linearization used in the EKF, and which does not have more computational complexity compared to the EKF.  This method is the ‚ÄúUnscented Transformation‚Äù (UT, do not further confuse this abbreviation with a computer game). <br><br>  The main idea of ‚Äã‚ÄãUT is to <s>collect more frags</s> in the intuitive assumption that it is much easier to approximate the probability distribution function of a random variable with a nonzero expectation (which is our phase vector - random interference is imposed on it) than to approximate some arbitrary nonlinear transformation function.  This technique involves the selection of a set of points (sigma points) in the parameter space (phase coordinates), which characterizes with sufficient accuracy the statistical characteristics (expectation, dispersion and other higher-order moment characteristics) of the desired random vector (in our case, the phase vector with superimposed by the noise vector).  To select these points, the following expressions are used: <br><br><img src="https://habrastorage.org/storage/1cad0620/524c5d66/e2e5f9d5/f134a071.png"><br>  In these expressions, " <i>Nx</i> " is the dimension of the desired phase vector;  " <i>i</i> " is the index of the sigma point (i = 1 .. <i>Nx</i> );  " <i>Wi</i> " is the weight of the ith sigma point; <br><img src="https://habrastorage.org/storage/f47c9f75/016d93fc/a4981e65/a16622e0.png">  - <i>i-</i> th column of the matrix square root of the covariance matrix of the initial non-linear transformation of the model multiplied by the dimension of the phase vector. <br><br>  It should be noted that this is not the only option for a set of sigma points.  The above expressions uniquely characterize the distribution statistics only for the first and second moments (expectation and variance).  UT, characterizing the statistics of the distribution of the desired vector to moments of higher orders, differ in the number of sigma points (generally speaking, their number will not necessarily be greater than for the expressions above) and the choice of weights.  For simplicity, I will omit the details.  I will cite only as an example the expressions for UT, which take into account the higher orders of the moments of the statistics of the distribution of the phase vector: <br><img src="https://habrastorage.org/storage/66a7481f/b25bece3/0b46cbd5/8ad63b5c.png"><br><br>  In principle, about UT itself, in short, everything.  Why it is needed and how it is used in the UKF is written below.  Here it is necessary to make a reservation about the moment characteristics of high orders.  What it is?  An intuitive analogy is the position, speed, and acceleration of a moving body.  If we consider the position as a moment of the first order, then the speed will be the second moment (rate of change of position), and acceleration - the third (speed of change of speed).  You can calculate the derivative of acceleration - we get the fourth moment.  But does it have a practical meaning?  Similarly, with the moment characteristics in statistics - in most cases, the expectation and variance are sufficient.  From the statistical accuracy of UT, i.e.  on the method of choosing sigma points, the filtering efficiency depends, but probably not so much that for most practical problems there was a need to take into account the moment characteristics of high orders. <br><br><h4>  APPLICATION UT </h4><br>  As mentioned above, UT is a method to get rid of the linearization procedure in non-linear stochastic estimation.  So far we have only learned that with the help of UT it is possible to pick up a set of points that quite accurately characterize the statistics of the desired vector (phase vector).  What does this give us?  The key point in Kalman filtering is the calculation of the crosscovariance matrix (see the ‚ÄúKk‚Äù matrix in the <a href="http://habrahabr.ru/blogs/algorithm/120133/">previous article</a> ).  This matrix in a linear FC is calculated as a solution of the matrix Riccati equation.  In the case of a nonlinear mat.  model of the system, this procedure is very complicated.  UT makes it possible to obtain an alternate cross-crossing matrix.  Below is a step-by-step filtering procedure using the UT method. <br><br><ol><li>  Find the statistical parameters of the desired vector (phase vector or vector of observation - the vector of the output signals of the sensors).  The obtained statistical characteristics can be considered constant or updated in real time. </li><li>  According to the obtained statistical data we calculate the set of sigma points. </li><li>  We skip these points through the original non-linear mat.  dynamic process model: <br><img src="https://habrastorage.org/storage/674ea031/7a19f3e7/ccd5eb46/e23ead91.png"></li><li>  We calculate the forecast of expectation and covariance: <br><img src="https://habrastorage.org/storage/28e2a373/7a461472/b627fc4c/cdd5fd66.png"><br><img src="https://habrastorage.org/storage/34841295/c636c0a8/74944ca8/749b6fbb.png"></li><li>  We skip the points obtained at the third step through the observation model (in the general case also non-linear): <br><img src="https://habrastorage.org/storage/b477d075/79f71337/39aadc0d/72faa40f.png"></li><li>  We calculate the forecast of observation (in the form of a weighted average of the values ‚Äã‚Äãin the previous step): <br><img src="https://habrastorage.org/storage/bef41435/9894a947/738bd297/ac0d6b87.png"></li><li>  Calculate the covariance of the observation: <br><img src="https://habrastorage.org/storage/70e64e30/833afffb/f1ae5175/68d81638.png"></li><li>  Find the desired cross-sharing matrix: <br><img src="https://habrastorage.org/storage/284c4e7d/e07f6031/bd82f49b/468a4168.png"></li><li>  Finally, we use the standard FC expressions: <br><img src="https://habrastorage.org/storage/fce2ef46/11e61a44/1d69e18d/8ac5fd72.png"></li></ol><br><br>  The last block of expressions is copied from article [3] as is.  In my opinion something is wrong in it.  It is not clear where the ‚Äúyn‚Äù without a cap and the cross-crossing matrix with unmarked signs are taken from.  But it does not matter.  About the "standard expressions FC" I already wrote.  It is only necessary to substitute in them the matrix gain found by UT Kalmans (also known as the crosscovariance matrix) and calculate the corrected estimate of the phase vector. <br>  Another remark about the phase vector.  In the expressions above, there is a phase vector with the index ‚Äúa‚Äù (Xa, n) - this is the phase vector supplemented (augmented) with coordinates for process noise and observation.  At the very beginning I wrote that there is such a technique for circumventing the limitation on the spectral characteristic of interference.  So, in the expressions above, somehow, the transition from augmented vectors to ordinary ones was made in a quiet way (there is also a simple and complementary expectation of mu). <br><br><h4>  CONCLUSION </h4><br>  So, using UT, we were able to calculate the prediction of the phase vector and the crosscovariance matrix without linearization.  Substituting their values ‚Äã‚Äãin the standard expressions for the correction phase of the prediction FC (see "Measurement Update" in the article about linear FC), we obtained the estimates of the phase vector.  The most resource-intensive procedure is the calculation of the matrix square root in the formation of a set of sigma points.  The total complexity of the UKF is obtained no more than that of the EKF.  The main advantages of the UKF are common synthesis for different tasks (the synthesis procedure does not depend on which object you are working with), as well as the stability of the resulting algorithm (the numerical conditionality of UT is higher than the conditionality of the linearization procedure in the EKF) and the absence of bias in the estimates obtained (again, due to for refusing linearization).  As an illustration, I will cite the graphs of estimation errors from paper [3] (see Fig. 1). <br><img src="https://habrastorage.org/storage/78a0fc00/467fa8ab/014674e4/6a3a7b07.png"><br>  Fig.  1. Graphs of mean square error and estimation variance for EKF and UKF <br>  In this figure, the thin line is the root mean square error for EKF (mean-squarred errors).  Point graph (bold, at the very bottom) is an estimate of covariances (estimated covariances).  Two other charts are for UKF.  The EKF has less covariance estimates (it smooths out a little better), but the mean deviations are very high in his estimates.  In the UKF, the covariances and the deviations are approximately at the same level.  By the way, it seemed to me that there was some kind of mistake here.  Dispersion is a square from the standard deviation.  How can they be together?  Here either I interpreted the terms incorrectly (I quoted them in parentheses above), or, nevertheless, the estimates of the covariances and the standard deviation are separate values. <br>  <b>UPD</b> I also want to note that I myself have not yet fully understood how this method works, and whether I understood it correctly.  I will try to implement it - it seems like an algorithm that is really easy to implement.  I'll see how he shows himself how time will be. <br>  In the meantime, your thoughts, suggestions, comments ... and THANKS FOR YOUR ATTENTION! <br><br><h4>  BIBLIOGRAPHY: </h4><br><ol><li>  <a href="http://en.wikipedia.org/wiki/Kalman_filter">UKF at Wiki</a> </li><li>  <a href="http://www.hindawi.com/journals/mpe/2009/140963/">A Discussion of Nonlinear Sigma Point Kalman Filter Orbit Determination</a> </li><li>  <a href="http://www.cs.unc.edu/~welch/kalman/media/pdf/Julier1997_SPIE_KF.pdf">Julier, SJ;</a>  <a href="http://www.cs.unc.edu/~welch/kalman/media/pdf/Julier1997_SPIE_KF.pdf">Uhlmann, JK (1997).</a>  <a href="http://www.cs.unc.edu/~welch/kalman/media/pdf/Julier1997_SPIE_KF.pdf">‚ÄúA new extension of the Kalman filter to nonlinear systems‚Äù.</a>  <a href="http://www.cs.unc.edu/~welch/kalman/media/pdf/Julier1997_SPIE_KF.pdf">Int.</a>  <a href="http://www.cs.unc.edu/~welch/kalman/media/pdf/Julier1997_SPIE_KF.pdf">Symp.</a>  <a href="http://www.cs.unc.edu/~welch/kalman/media/pdf/Julier1997_SPIE_KF.pdf">Aerospace / Defense Sensing, Simul.</a>  <a href="http://www.cs.unc.edu/~welch/kalman/media/pdf/Julier1997_SPIE_KF.pdf">and Controls 3. Retrieved 2008-05-03.</a> </li><li>  <a href="http://mycoordinates.org/fuzzy-strong-tracking-unscented-kalman-filter/">Fuzzy strong tracking unscented Kalman filter</a> </li><li>  <a href="http://www.nottingham.ac.uk/ggiemr/downloads/A%2520Ajayi%2520Phd%2520Thesis/Chapter%25208.pdf">Unscented Transform</a> </li><li>  M. Athans, RP Wishner, and A. Bertolini, ‚ÄúSuboptimal state <br>  estimation for continuous-time nonlinear systems from discrete <br>  noisy measurements, ‚ÄùIEEE Trans.  Automat.  Contr., Vol.  AC-13, <br>  pp.  504-518, Oct.  1968. </li></ol></div><p>Source: <a href="https://habr.com/ru/post/121904/">https://habr.com/ru/post/121904/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../121895/index.html">Site concept: how and why to create it</a></li>
<li><a href="../121896/index.html">A couple of sentences</a></li>
<li><a href="../121898/index.html">Weekend not at the cottage</a></li>
<li><a href="../121899/index.html">Denial of the Day: Android 2.3 (Gingerbread) will still be released on HTC Desire</a></li>
<li><a href="../121903/index.html">Multiuser chat on BAT</a></li>
<li><a href="../121905/index.html">Add a button for UIKeyboardTypeNumberPad</a></li>
<li><a href="../121906/index.html">Thrustmaster T500 RS: no compromise</a></li>
<li><a href="../121909/index.html">Versioned database structure migration: another approach</a></li>
<li><a href="../121910/index.html">Can e-books replace textbooks</a></li>
<li><a href="../121911/index.html">Again about IE6, fanaticism, end-users and client-oriented web development market</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>