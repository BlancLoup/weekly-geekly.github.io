<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Protecting PHP scripts from copying - is it possible?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It so happens that you are reluctant to provide the source code of the projects that you developed. To do this, you can use obfuscators, which were re...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Protecting PHP scripts from copying - is it possible?</h1><div class="post__text post__text-html js-mediator-article">  It so happens that you are reluctant to provide the source code of the projects that you developed.  To do this, you can use obfuscators, which were recently <a href="http://habrahabr.ru/blog/webdev/46780.html">discussed</a> . <br><br>  And it happens that you do not want to close the source code, how to protect the script from being copied.  In my opinion, hiding the source code, in most cases, does not make sense without copy protection. <a name="habracut"></a>  Some obfuscators that encrypt a code (and not just distort) have the ability to lock a script for a specific domain or IP.  But, first, we don‚Äôt want to re-encrypt all sources for each domain?  Secondly, I managed to unlock this protection with a single line at the beginning of the script: <br><blockquote>  $ _SERVER ['HTTP_HOST'] = 'allowed domain'; </blockquote><br>  I have been searching for a copy protection solution on the Internet for a long time.  On forums, this question was often discussed, mostly newbies asked it, and experienced (apparently) programmers answered "- You are a fool who need your code. Teach materiel, and in general php scripts are not worth anything!".  Well, I thought.  Probably really impossible.  But wait, the same Bitrix (foo) licenses individual sites, and you get an open source code after purchasing a license.  What prevents copy it on several of their sites?  I do not know, and if you know, please tell me. <br><br>  As a result, I had to do copy protection myself.  I set the following initial conditions of the problem: <br><ul><li>  The script should obviously be encrypted, for example, by Zend.  But I liked Lock It - firstly, it does not require Zend Optimizer, and, secondly, it is inexpensive.  But now it's not about how to encrypt the script, but how to protect it from copying.  Therefore, we go further, we will simply assume that the source code is closed.  Obviously, this is a necessary condition. <br></li><li>  I want to issue a key (I will call it a license) for each copy of the script.  That is, I want to give each person only a license, and let the script roll in the public domain. <br></li><li>  The license is tied to the domain, but if the domain has synonyms - the script should work when accessing through them.  The main thing is that it should be the same copy of the script. <br></li><li>  No connections to another (my) server.  The script must be self-sufficient. <br></li><li>  No script trust in server or environment variables during license validation.  They can be easily overridden. <br></li></ul><br><h1>  Decision </h1><br><h2>  1. Issuing a license and validating a license with a script </h2><br>  I create the key to the domain like this: <br><blockquote>  $ key = md5 ($ domain. $ secretword); </blockquote><br>  The script checks its license as follows: <br><blockquote>  $ key == md5 ($ domain. $ secretword); </blockquote><br>  Indeed, it is ugly to store $ secretword in the scripts themselves.  Therefore, you can use public key encryption.  When issuing a license, I will sign it with my private key, and the script, when checking the license, with the public key will check the validity of the license.  But I didn‚Äôt find any public key encryption functions in the standard PHP suite, not even RSA (am I blind?).  If you help, I will be grateful. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, the script checked the validity of the license.  That is, does the specified key match the specified domain?  Go ahead. <br><br><h2>  2. Domain Check </h2><br>  How can the script check if it is in the specified domain?  We do not trust $ _SERVER ['HTTP_HOST']. <br>  Also, under the conditions - no connections to another server.  So, we connect ourselves to our intended domain, and we check if we are there :) <br><br>  Or rather: <br>  1) we save a random number on the server (for example, in a temporary file) 2) contact the address our_domain.ru / our_script.php? Action = say_the number 3) check what number we give to this address.  If it corresponds to what we have saved, then we are at the address:) 0) the zero point should be added to the return of the stored number, if we were called with the parameter action = say_count <br>  I simplified the algorithm a little, in fact, for each access to the script, these random numbers need to be considered separately. <br><br>  Now the script knows that the license is valid and that it lies on the corresponding domain.  The main task is solved! <br><br>  You tell me - wtf, the script will pull itself at each call?  Indeed, cruel somehow.  Therefore: <br><br><h2>  3. Temporary license </h2><br>  On the first access, if the check was successful, the script saves the temporary license in a temporary file. <br>  A temporary license is something like md5 (today's_date, domain, secret word). <br>  Now, with each request, we check only the temporary license, which is valid for the day.  As soon as something is wrong with the temporary license (changed, deleted, a day has passed) - the script will again check everything seriously and save the new temporary license. <br><br><h2>  4. Running the script on a local computer without a license </h2><br><br>  It would be ideal if the script did not require a license when running on the local computer.  Why, one wonders, does a person require a license from me if he just wants to test the script on his computer?  He must download it and use it.  But when he puts the script on the server, then he will come to me. <br><br>  I do not know how to solve this problem.  I still have 3 solutions, but I do not like them: <br>  1) If the script lies on a domain without points (like <a href="http://myscript/">myscript</a> ) - assume that this is a virtual domain, then, most likely, this is a local test.  The disadvantage of this method is that the craftsmen will create a virtual domain on their server, and the real domain will be made synonymous.  Also, it is not clear what to do with the localhost domain. <br><br>  2) Check $ _SERVER ["REMOTE_ADDR"].  We check the presence of '127' at the beginning of the ip-address.  The disadvantage is that you can override this variable before executing the script. <br><br>  3) It's funny, but you can check the server operating system.  And allow execution under Windows.  Just do not hit me, it's just an option. <br><br>  I post <a href="http://pikusov.kiev.ua/copy.php.txt">an example script</a> for testing. <br><br>  I am gratefully waiting for constructive comments.  Perhaps you will find an error in this protection, or give a good idea. <br></div><p>Source: <a href="https://habr.com/ru/post/29301/">https://habr.com/ru/post/29301/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../292998/index.html">How to become the leader of the team UX-development</a></li>
<li><a href="../293000/index.html">Series A: How to prepare for the first round of investment</a></li>
<li><a href="../293004/index.html">After selling Financial Times, Pearson plans to sell 50% of The Economist</a></li>
<li><a href="../293006/index.html">Alexander Kovalsky, CreativePeople: From Design Punks to Design Evangelists</a></li>
<li><a href="../293008/index.html">Apple is going to save $ 1 billion on investments</a></li>
<li><a href="../293014/index.html">Pro competitive advantages for an electronics manufacturer</a></li>
<li><a href="../293016/index.html">3 legal errors online store</a></li>
<li><a href="../293018/index.html">7 things to be destroyed by self-driving cars</a></li>
<li><a href="../293020/index.html">How to manage user motivation in online sales</a></li>
<li><a href="../293024/index.html">Deceived shoppers fitness band Fuelband achieved monetary compensation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>