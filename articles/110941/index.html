<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tool for drawing snowflakes in the browser</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Theme design "Habrahabr . " 

 2 days ago I finished developing a tool for drawing snowflakes, debugged it in greenhouse local conditions and was read...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tool for drawing snowflakes in the browser</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://apostolstudio.com/lab/snowflake/"><img src="https://habrastorage.org/getpro/habr/post_images/411/24e/61a/41124e61aa81d672208d044069dd1a39.png" alt="Snowflake do it yourself. Habrahabr"></a> <br>  Theme design <a href="http://apostolstudio.com/lab/snowflake/">"Habrahabr</a> . <a href="http://apostolstudio.com/lab/snowflake/">"</a> <br><br>  2 days ago I finished developing a tool for drawing snowflakes, debugged it in greenhouse local conditions and was ready to send it to the long voyage.  But the launch of the ‚Äúproject‚Äù on the open Internet had to be postponed 2 times.  At first, when integrating with a third-party site, cross-domain AJAX requests refused to work using the POST method (and GET was not enough for all requests), then on a slow channel, asynchronous data loading and presentation appeared in the form of glitches.  Now everything seems to be fixed, laid out and awaiting manifestations of attention in relation to itself. <br><br><a name="habracut"></a>  I will talk about the development, plans, <s>brazenly promoting the</s> offer of cooperation.  Now a lot of text will go, and below is another picture. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Prehistory, passing into history </h4><br>  A passion for snowflakes arose somehow unexpectedly.  Developed a library of exporting documents to PDF and when I got to the transformation of vector objects I thought that it would be nice to sketch out some cool demo after the completion of the development and thus make an advertisement for myself.  I wanted to start before the New Year, so I considered the topics relevant. <br><br>  I caught fire to develop a generator of snowflakes for given weather conditions, reread a lot of information about this and even advanced a bit in drawing snow crystals according to specified parameters (see the <a href="http://yuriy-apostol.livejournal.com/12889.html">first screenshots</a> ).  But then I realized that I would not have time to make a full-fledged generator of correct snowflakes and decided to limit myself to an editor.  In addition, it is also more fun for the user, since it assumes his personal participation.  So the idea of ‚Äã‚Äãdeveloping an interactive greeting card was born.  Subsequently - a separate postcard, and not as part of some other project.  By the way, I did not manage to launch the project related to PDF before the holidays. <br><br>  In the early stages of development, the snowflake drawing tool was an SVG image with an embedded JavaScript library.  Of course, not all browsers worked, so at one point I moved to the graphic framework <a href="http://raphaeljs.com/">Rapha√´l, which</a> is well-known in our narrow circles.  For even more skrashivaniya everyday web developer <a href="http://jquery.com/">jQuery</a> was connected.  jQuery became responsible for AJAX requests to the server where data is stored and for tricky platform-independent manipulations with DOM.  Rapha√´l was entrusted with browser-independent rendering of all vector and interaction of objects on the canvas with the user's mouse. <br><br>  Rapha√´l had to finish quite a bit, because there were problems with updating the canvas in Chrome (there is a special crutch for WebKit, but it does not work for all versions of browsers on WebKit) and did not want to change their position in the stack of graphic objects contained in the &lt;a &gt; (and these are not only those that are in the link, but also those that have a pop-up hint).  The first was treated by adjusting the regular expression that defines the browser engine.  The second is to add an automatic deletion of &lt;a&gt; when resetting to empty lines of the <i>href</i> and <i>title</i> parameters.  In an amicable way, it would be necessary to finish the methods of moving objects themselves, but there I would not get off with a little blood. <br><br>  By the way, the &lt;a&gt; tag in SVG interfered with the correct initialization of the ‚Äúbookmark button‚Äù <a href="http://www.addthis.com/">AddThis</a> .  I used it in order not to fence the bike with sharing the results of drawing. <br><br>  Now about cross-domain AJAX requests using the POST method.  Unfortunately, they are not supported by browsers in order to ensure user security.  The GET method has no such restrictions, but has a de facto length limit.  De jure, this should not be so, however, some browsers, let's not poke fingers, do not allow making inquiries on links a little more than 2 thousand in length.  And somehow it is ugly to drive large amounts of data in addresses.  Therefore, it was decided to continue to transmit POST within your domain, and when placing the application on a third-party site, cut the data into pieces, transfer it using the GET method (using JSONP technology) and only when sending the last piece, execute the request on the server. <br><br>  In order to make it convenient to use the application on any site, all the code is in the JS library.  It is connected and initialized by inserting a few tags on the page.  Therefore, even the index page on the project site is a simple HTML file.  The link to the library in the &lt;script&gt; tag can at anchor (everything after #) contain additional parameters: the client identifier (used only when placing the code on a third-party site), the design theme and the default snowflake identifier. <br><br>  The anchor also passes identifiers in the link to a specific snowflake with a specific theme.  That is, if you remove the application from the page, the link will remain working, just without a postcard.  This is the first important reason for which the anchors were used, and the second - they allow you to maximally abandon the scripts on the server. <br><br>  Themes, like the snowflake parameters, are regular JavaScript objects in JSON format.  If for the description of snowflakes in the object only the sizes of crystals of half of one branch of snowflakes are stored (the rest are cloned when built), then with the themes it is a little more complicated.  It describes the entire interface of the application: where what elements are located, how they look (images are specified by a vector or a raster), how they behave when hovering, pressing, when they are inactive.  There are also text strings for specific languages ‚Äã‚Äã(changing the language without loading another theme is only planned) and even styles for the page (if there is a need to change them according to the theme) and raw JS code (you may need for special actions, for example, to add events or moving objects). <br><br>  In general, the themes can be very different from each other and initially I planned to use this opportunity for branding cards.  It is a pity that I did not have time to finish earlier.  But Christmas is still ahead, Old New Year, New Year of the next year ... So contact us, we can integrate a card somewhere. <br><br> <a href="http://apostolstudio.com/lab/snowflake/"><img src="https://habrastorage.org/getpro/habr/post_images/364/a4c/217/364a4c21705253eacc87528161a51299.png" alt="Snowflake do it yourself. White Rabbit"></a> <br>  <a href="http://apostolstudio.com/lab/snowflake/">"White Rabbit"</a> - the main theme of the coming year. <br><br><h4>  Plans </h4><ul><li>  Add print mode folded snowflakes to cut it out of paper.  As in childhood, but more technologically. </li><li>  Add export to vector and raster formats. </li><li>  Refine the choice of language and change the topic directly in the application, and not through a link. </li><li>  Add personal pages with a list of your own snowflakes and statistics (data are already being collected, but so far they are only tied to the user ID, which is carefully stored in COOKIE). </li><li>  Add a snowflake rating. </li><li>  Add the ability to leave comments, personal greetings and photos. </li><li>  Modify the drawing of a double 12-coal snowflake. </li><li>  Refine moving and zooming while editing. </li><li>  Optimize code. </li></ul><br><br>  <b>UPD <sub>1</sub> :</b> <s>Now when using the application</s> <br><br>  <b>UPD <sub>2</sub> :</b> Yesterday, when using the application on a third-party site without registering as a partner, visitors were given links to images on my site.  Eliminated this misunderstanding.  And further.  If someone plans to place the code on his homepage or simply wants to receive news about the project, email me at yuriyapostol@gmail.com something like ‚ÄúI want to receive news about the Snowflake project‚Äù or ‚ÄúI want to be aware of changes in the Snowflakes API‚Äù. <br><br>  <b>UPD <sub>3</sub> :</b> Embed code on your website: <br><br><pre><code class="javascript hljs">&lt;script src=<span class="hljs-string"><span class="hljs-string">"https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"</span></span> type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span> charset=<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script src=<span class="hljs-string"><span class="hljs-string">"http://apostolstudio.com/lab/snowflake/raphael-apos.min.js"</span></span> type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span> charset=<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script src=<span class="hljs-string"><span class="hljs-string">"http://apostolstudio.com/lab/snowflake/snowflake.js"</span></span> type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span> charset=<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;div id=<span class="hljs-string"><span class="hljs-string">"snowflake_container"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"snowflake_paper"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">...</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><br>  All scripts can be moved to &lt;head&gt;.  To initialize an application with special parameters, list them in the link to the main script after #.  Example with theme and default snowflakes: <br><br><pre> <code class="javascript hljs">&lt;script src=<span class="hljs-string"><span class="hljs-string">"http://apostolstudio.com/lab/snowflake/snowflake.js#theme=Rabbit&amp;flake=kOQxOPNwnQZS"</span></span> type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span> charset=<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> </div><p>Source: <a href="https://habr.com/ru/post/110941/">https://habr.com/ru/post/110941/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../110930/index.html">History of ABBYY Lingvo. Four-zero</a></li>
<li><a href="../110933/index.html">Torrent tracker KickassTorrents compiled a list of the most popular user requests</a></li>
<li><a href="../110935/index.html">South Korean government fails to tighten control over the Internet in their country</a></li>
<li><a href="../110936/index.html">Native Instruments Reaktor: synthesis of sawtooth, square, triangular and sine waves</a></li>
<li><a href="../110939/index.html">Add support for different languages ‚Äã‚Äãin the program for BlackBerry</a></li>
<li><a href="../110945/index.html">New victories over Sony PS3 protection</a></li>
<li><a href="../110946/index.html">Three Stars: Aerospace Program</a></li>
<li><a href="../110948/index.html">Skype launches video calls on iPhone</a></li>
<li><a href="../110949/index.html">Facebook: coal with a human face</a></li>
<li><a href="../110950/index.html">Geinimi: a fancy trojan for Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>