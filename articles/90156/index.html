<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>.Net and Navision 5.0 - Friendship Forever</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The plot. 
 And so, hello. 
 Working in an office that deals with the introduction of such a thing as Ms Dynamics Nav had to face one problem, the sol...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>.Net and Navision 5.0 - Friendship Forever</h1><div class="post__text post__text-html js-mediator-article"><h3>  The plot. </h3><br>  And so, hello. <br>  Working in an office that deals with the introduction of such a thing as Ms Dynamics Nav had to face one problem, the solution of which by means of Navik himself (I allow myself to be so familiar), was impossible. <br>  The essence of the problem is as follows: <br>  introducing the system into the enterprise that is engaged in translation, there was a tough problem with the file names, since the requirements stated that the name that was named for the source file must fully match the name that the already translated file will receive.  With all this, the customer required to write files to the MS SQL database.  Since Navik is sooo far from Unicode, all the built-in functions for working with files distorted the name, removing umlauts, axants and other elements of the European alphabet. <br>  To solve this problem, the task was to write a dll-ku that will write files with correct names to the database.  And then, on request, return these files from the database to the file system.  With all this, there was a problem with downloading large files, so, again, a strong decision was made to use such a thing as FILESTREAM in MS SQL. <br><a name="habracut"></a><br><h3>  Decision </h3><br><h4>  Chapter i </h4><br>  I sincerely hope that the essence of the problem has become clear.  Now proceed to the resolution. <br>  Since your obedient servant handles C # best of all, I decided to write on it.  I've never done anything like this, so I had to search through a bunch of materials. <br>  First of all, a series of functions was written, which carry out the above described activity, without connecting to the mobile. <br>  The next step is to make our Com library available.  That is to register [assembly: ComVisible (true)] in the AssemblyInfo.cs file <br><br>  Further, respectively, register it in the system regasm - ohm. <br>  Regasm d: /Classlibraryfornav.dll / codebase / tlb <br><br><h4>  Chapter II </h4><br>  Now we need to prepare a table where all this will be recorded. <br>  First, we create a table in Navizhn, and then edit it in MS SQL, to connect FILESTREAM. <br>  At first, the table looks like this: <br><img src="http://img.flashtux.org/upload/img132b5362767fx9a32af8d.png" alt="image"><br>  But then, we turn on the FILESTREAM server on Esquel: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To enable FILESTREAM: <br><br>  1. Start SQL Server Configuration Manager and in the properties of SQL Server on the FILESTREAM tab put all three checkboxes;  then run the following query: <br><br> <code>EXEC sp_configure filestream_access_level, 2 <br> RECONFIGURE</code> <br> <br>  2. Next, you need to add a file group and label the file storage. <br><br> <code>ALTER database currentDb <br> ADD FILEGROUP Uploads <br> CONTAINS FILESTREAM <br> GO <br> <br> ALTER database currentDb <br> ADD FILE <br> ( <br> NAME= 'Upload', <br> FILENAME = 'C:\Users\Administrator\Upload' <br> ) <br> TO FILEGROUP Uploads <br> GO</code> <br> <br>  Well, a little tweak the plate itself: <br>  execute the following three commands: <br>  a.  ALTER TABLE ***. Dbo. *** ADD [Id] [uniqueidentifier] ROWGUIDCOL NOT NULL UNIQUE - required for FILESTREAM <br>  b.  ALTER TABLE ***. Dbo. *** ADD UploadFiles VARBINARY (MAX) FILESTREAM - he himself <br>  c.  ALTER TABLE ***. Dbo. *** ADD FileFullName NVARCHAR (MAX) is a field badly perceived by Navik, but necessary, for a multi-language display. <br><br>  That is, it turns out that we have duplicated two fields: <br>  Id = NavId - one for navigate, another for FILESTREAM <br>  FileName! = FullFileName - the first one contains the name of the file with the path, converted to ASCII, so that it can be viewed in the file.  And the field FullFileName, inaccessible Navizhnu, but necessary to save the full name of the file. <br><br><h4>  <b>Chapter three</b> </h4><br>  The next stage, we connect our dll-ku to Navik.  That is, in the Codeunit we create a variable of type Automation and in the subtype we find our registered library, with a specific class created by us.  It happened to me like this: <img src="http://img.flashtux.org/upload/img132b53627561x7b5725e6.png" alt="image"><br><br>  Further, already in the code: <br><br>  CREATE ("Var"); <br>  ‚ÄúVar‚Äù .PutToDataBase ('Order', 'Material', 'Project', TRUE); <br><br>  Ps <br>  When using Arabic, for example, in a language, questions are displayed in any way.  You can fight this only by installing Arabic, and switch the program to this language entirely. </div><p>Source: <a href="https://habr.com/ru/post/90156/">https://habr.com/ru/post/90156/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../90149/index.html">I propose to draw an icon symbolizing Fidonet Network, and then begin to freely distribute it.</a></li>
<li><a href="../90150/index.html">Finding an Alternative to Basecamp: Unfuddle.com Review</a></li>
<li><a href="../90151/index.html">Faith-driven development</a></li>
<li><a href="../90153/index.html">In the wake of RusKrypto'2010</a></li>
<li><a href="../90154/index.html">Electronic check-in for the Russian Railways train - export of a ticket to Google and Yandex. Calendar</a></li>
<li><a href="../90160/index.html">Merging Rails and Merb: Performance (Part 2 of 6)</a></li>
<li><a href="../90164/index.html">SunCalc - Solar Calculator</a></li>
<li><a href="../90166/index.html">How to make money on vending machines: VendExpo 2010</a></li>
<li><a href="../90167/index.html">Where is it all the valor?</a></li>
<li><a href="../90169/index.html">Advertising platform = provider?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>