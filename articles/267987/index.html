<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Windows 10 through 10. Issue # 3. Using Cortana to interact with users</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this issue of our Windows 10 to 10 series of articles , we will discuss how to extend the experience of interacting with your application in Window...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Windows 10 through 10. Issue # 3. Using Cortana to interact with users</h1><div class="post__text post__text-html js-mediator-article">  In this issue of our <a href="http://habrahabr.ru/search/%3Fq%3D%255BWindows10x10%255D%26target_type%3Dposts">Windows 10 to 10</a> series of articles <a href="http://habrahabr.ru/search/%3Fq%3D%255BWindows10x10%255D%26target_type%3Dposts">,</a> we will discuss how to extend the experience of interacting with your application in Windows 10 to those moments when the application is not even running.  The topic of the last article, <a href="http://habrahabr.ru/company/microsoft/blog/265777/">live tiles and notifications</a> , revealed one of the possible ways, today we will look at how to use Cortana, a personal assistant in Windows 10, for this task. We will use the example AdventureWorks, available on <a href="http://wndw.ms/w3git">GitHub</a> as the basis for the cited code fragments. . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fcb/39b/0cf/fcb39b0cf648eb79f59be7643ce9b376.png"><br><br>  In this article, we will try to figure out what Cortana is like, how to make it support meaningful interaction with your users, what needs to be done to integrate Cortana into the application, and then consider two ways (of many) how your application can interact with users depending on the scenario. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><h2>  What is Cortana? </h2><br>  One of the most interesting features of Windows 10 is Cortana‚Äôs personal assistant, previously available on Windows Phone.  Cortana is a key element for communicating with Windows 10 in natural language.  With the help of Cortana, users can interact with Windows (both with the OS itself and with your applications), using the usual voice way of communicating with other people. <br><br>  For example, think about the questions that only your application can give answers to and which people could give in Cortana‚Äôs voice: ‚Äúwhen is my next trip?‚Äù, ‚ÄúFind a radio station‚Äù, ‚Äúis Jack available?‚Äù.  In turn, your application can answer such questions by providing an answer to Cortana for the utterance and display. <br><br>  Or imagine the tasks that a person could ask Cortana to do in the context of your application: ‚Äúcancel my trip to London‚Äù, ‚Äúremember this radio station‚Äù, ‚Äúwrite Jack, I'll be back later‚Äù. <br><br>  Voice commands can provide quick access to information within the application.  This is a kind of deep link in your application.  Just as you create tiles today to provide quick access to the contents of your application, you can use voice commands as a quick way to ‚Äúlook inside‚Äù the application.  And just as you make it possible to pin the next trip created in the app on the Start screen, you can also allow the user to use the voice command for Cortana to access the same trip.  This feature will make your users more productive, and interaction with the application more accessible. <br><br>  By expanding Cortana, you can improve interaction with your users and please them with the ability to perform actions with fast voice commands.  However, since this article is not about <a href="http://wndw.ms/w3cortw10">Cortana</a> ‚Äôs <a href="http://wndw.ms/w3cortw10">user experience</a> , let's figure out how to integrate with it. <br><br><h2>  Hey, Cortana, let's talk </h2><br>  Since the interaction with Cortana rests on the voice, the created experience of interaction should be as close as possible to the natural dialogue.  On MSDN, you'll find a general <a href="http://wndw.ms/w3cortDG">design guide for Cortana</a> with recommendations for building engagement experiences.  To achieve the best result, we advise you to follow the following principles: efficiency, relevance, clarity and trust. <br><br>  What do they mean in practice? <br><ul><li>  <b>Efficiency</b> : less is better.  Be short and try to reduce the number of words without losing the meaning. </li><li>  <b>Relevance</b> : do not deviate from the topic.  If I asked to add my favorite ABBA song to the playlist, I don‚Äôt need to report a low battery at the same time.  Better confirm that in a moment I can enjoy ABBA.  :) </li><li>  <b>Clarity</b> : dialogue must fit the audience.  Use normal everyday language instead of jargon understood by a narrow group of people. </li><li>  <b>Trust</b> : Answers must accurately reflect what is happening and respect user preferences.  If your application did not complete the task, do not say that you did it.  Also, do not return phrases that, from the user's point of view, would not be worth saying out loud. </li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/20c/4a9/ec6/20c4a9ec6c62b43bf731f4a343b9a9a1.gif"><br><br>  At the same time, you should consider localizing interaction with Cortana, especially if you have already localized the rest of the application and made it globally accessible.  Cortana is currently available in the USA, Great Britain, China, France, Italy, Germany and Spain ( <a href="http://blogs.windows.com/bloggingwindows/2015/09/01/windows-10-insider-preview-bringing-cortana-to-more-countries-for-insiders/">announcement about expansion into additional markets</a> ).  Localization will help you encourage users to use Cortana more often to interact with your application. <br><br><h3>  Teaching Cortana what to answer </h3><br>  Cortana uses the <a href="http://wndw.ms/w3VCD">Voice Command Definition</a> (VCD) definition file to understand how the user can interact with your application using voice.  This file can be a ready-made XML file or generated from code (you will need to fill in a set of commands in a VCD file when you first start it).  The following is an example VCD file: <br><br><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">VoiceCommands</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/voicecommands/1.1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CommandSet</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xml:lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en-us"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AdventureWorksCommandSet_en-us"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CommandPrefix</span></span></span><span class="hljs-tag">&gt;</span></span> Adventure Works, <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CommandPrefix</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Example</span></span></span><span class="hljs-tag">&gt;</span></span> Show trip to London <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Example</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Command</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"showTripToDestination"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Example</span></span></span><span class="hljs-tag">&gt;</span></span> show trip to London <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Example</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListenFor</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">RequireAppName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"BeforeOrAfterPhrase"</span></span></span><span class="hljs-tag">&gt;</span></span> show trip to {destination} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListenFor</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Feedback</span></span></span><span class="hljs-tag">&gt;</span></span> Showing trip to {destination} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Feedback</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Navigate</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Command</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PhraseList</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"destination"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag">&gt;</span></span> London <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag">&gt;</span></span> Dallas <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PhraseList</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CommandSet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Other CommandSets for other languages --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">VoiceCommands</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  When activating an application from the <a href="http://wndw.ms/w3OnLau">OnLaunched</a> application launch <a href="http://wndw.ms/w3OnLau">event,</a> you need to call the <a href="https://msdn.microsoft.com/en-us/library/windows/apps/xaml/windows.applicationmodel.voicecommands.voicecommanddefinitionmanager.installcommanddefinitionsfromstoragefileasync.aspx">InstallCommandSetsFromStorageFileAsync</a> method to register the commands that Cortana should recognize.  Keep in mind that if the device is restored from backup and your application is reinstalled, then voice commands are not restored automatically.  To ensure that the voice command description data remain intact, you can initialize the VCD file each time you start or activate the application.  But it is better to keep a setting that indicates whether the VCD file is already installed, and check this particular parameter.  Below is a simple code example showing how to install a VCD file from an application: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> storageFile = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> Windows.Storage.StorageFile.GetFileFromApplicationUriAsync(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Uri(<span class="hljs-string"><span class="hljs-string">"ms-appx:///CortanaVcd.xml"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> Windows.ApplicationModel.VoiceCommands.VoiceCommandDefinitionManager.InstallCommandSetsFromStorageFileAsync(storageFile);</code> </pre><br><br><h3>  Add dynamism </h3><br>  Now that you are familiar with the basics, we can add a bit of <a href="http://wndw.ms/w3dynam">variety at runtime</a> .  Below is an example of the dynamic switching of a VCD file that needs to be downloaded: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Windows.ApplicationModel.VoiceCommands.VoiceCommnadDefinition.VoiceCommandSet commandSetEnUs; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Windows.ApplicationModel.VoiceCommands.VoiceCommandDefinitionManager.InstalledCommandSets.TryGetValue(<span class="hljs-string"><span class="hljs-string">"AdventureWorksCommandSet_en-us"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> commandSetEnUs)) { <span class="hljs-comment"><span class="hljs-comment">// this code will fully replace the destination list await commandSetEnUs.SetPhraseListAsync("destination", new string[] {"Chicago", "Seattle", "New York", "Phoenix"}); }</span></span></code> </pre> <br><br><h2>  How will my application interact with Cortana? </h2><br>  There are several ways how your application can communicate with Cortana.  Here are the three most typical ways: <br><ol><li>  Launch application from Cortana.  In addition to simply launching the application, you can also specify a ‚Äúdeep‚Äù link or command to execute inside the application. </li><li>  Simple interaction within the Cortana interface (usually this is saving / querying data through a background process). </li><li>  The interaction between the user and the application inside Cortana. </li></ol><br><br><h3>  Application launch </h3><br>  If you have a difficult task and you want the user to go directly to your application, using Cortana for this is a great idea!  Since some complex tasks in reality can be performed faster and more accurately through voice commands, this can really help users. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnActivated</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IActivatedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Was the app activated by a voice command? if (e.Kind != Windows.ApplicationModel.Activation.ActivationKind.VoiceCommand) { return; } var commandArgs = e as Windows.ApplicationModel.Activation.VoiceCommandActivatedEventArgs; var navigationParameterString = ""; Windows.ApplicationModel.VoiceCommands.VoiceCommand.SpeechRecognitionResult speechRecognitionResult = commandArgs.Result; // Get the name of the voice command and the text spoken string voiceCommandName = speechRecognitionResult.RulePath[0]; string textSpoken = speechRecognitionResult.Text; // The commandMode is either "voice" or "text", and it indicates how the voice command was entered by the user. // Apps should respect "text" mode by providing feedback in a silent form. string commandMode = this.SemanticInterpretation("commandMode", speechRecognitionResult); switch (voiceCommandName) { case "showTripToDestination": // Access the value of the {destination} phrase in the voice command string destination = speechRecognitionResult.SemanticInterpretation.Properties["destination"][0]; // Create a navigation parameter string to pass to the page navigationParameterString = string.Format("{0}|{1}|{2}|{3}", voiceCommandName, commandMode, textSpoken, destination); // Set the page where to navigate for this voice command navigateToPageType = typeof(TripPage); break; default: // There is no match for the voice command name. Navigate to MainPage navigateToPageType = typeof(MainPage); break; } if (this.rootFrame == null) { // App needs to create a new Frame, not shown } if (!this.rootFrame.Navigate(navigateToPageType, navigationParameterString)) { throw new Exception("Failed to create voice command page"); } }</span></span></code> </pre><br><br><h3>  Simple interaction inside Cortana to save or query data </h3><br>  Now that your VCD file is connected to Cortana, and you know how to perform basic interaction, let's see how to do more complex operations.  For example, you want Cortana to show the user some data or, on the contrary, save it.  The MSDN website has detailed <a href="http://wndw.ms/w3LauBac">instructions for setting up background tasks for Cortana</a> .  Here is a brief summary: <br><br><ol><li>  Create a Windows Runtime Component project in your solution. </li><li>  Create a new class that implements the IBackgroundTask interface, which will work as an application service </li><li>  In the manifest of your UWP application (Package.appxmanifest) add a new extension for the created service.  This step is described in detail in MSDN. </li></ol><br><br>  The following is an example of a fragment of the Package.appxmanifest file: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Package</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Applications</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Extensions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Extension</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Category</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"windows.appService"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">EntryPoint</span></span></span><span class="hljs-tag">= </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AdventureWorks.VoiceCommands.AdventureWorksVoiceCommandService"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AppService</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AdventureWorksVoiceCommandService"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Extension</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Extensions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Applications</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Package</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  After starting, the background service of the application has 0.5 seconds to call the <a href="http://wndw.ms/w3VCSC">ReportSuccessAsync</a> method.  Cortana uses the data provided by the application to demonstrate and voice the response indicated in the VCD file.  If the application spends more than half a second to return the result, Cortana inserts an intermediate screen, as shown below.  Cortana displays a temporary screen until the application returns the result via ReportSuccessAsync, but for no more than 5 seconds.  If the application did not call the ReportSuccessAsync method or any of the <a href="http://wndw.ms/w3voiceserv">VoiceCommandServiceConnection</a> methods to provide information to Cortane, the user will receive an error message and the service call will be canceled. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cfa/335/2f9/cfa3352f9b7d1691968071b15a19c127.png"><br><br>  Here is a simple code example for implementing IBackgroundTask in the application service: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Windows.ApplicationModel.Background; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">AdventureWorks.VoiceCommands</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AdventureWorksVoiceCommandService</span></span> : <span class="hljs-title"><span class="hljs-title">IBackgroundTask</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Run</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IBackgroundTaskInstance taskInstance</span></span></span><span class="hljs-function">)</span></span> { BackgroundTaskDeferral _deferral = taskInstance.GetDeferral(); <span class="hljs-comment"><span class="hljs-comment">// // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Insert code // _deferral.Complete(); } } }</span></span></code> </pre> <br><br><h3>  Interaction within Cortana </h3><br>  At this point, you have learned the basics and are ready to realize even tighter <a href="http://wndw.ms/w3CortBapp">interaction with Cortana</a> .  An application can request different screen types to support this or that functionality: <br><ul><li>  Successful completion </li><li>  Intermediate </li><li>  Progress </li><li>  the confirmation </li><li>  Uncertainty </li><li>  Mistake </li></ul><br><br>  Let's take a closer look at one of these scenarios: uncertainty.  Sometimes it happens that your application has several options that it can return.  In such situations, you need to resolve the uncertainty of what to do next.  For example, if a user chose music and needed to decide what to play next: ABBA, Nickelback or White Snake, Cortana can help make a choice.  The code snippet below from the Adventure Works example shows how to resolve the ambiguity that has appeared within the application service: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// Create a VoiceCommandUserMessage for the initial question. var userPrompt = new VoiceCommandUserMessage(); userPrompt.DisplayMessage = "Which one do you want to cancel?"; userPrompt.SpokenMessage = "Which Chicago trip do you wanna cancel?"; // Create a VoiceCommandUserMessage for the second question, // in case Cortana needs to reprompt. var userReprompt = new VoiceCommandUserMessage(); userReprompt.DisplayMessage = ‚ÄúWhich one did you want to cancel?‚Äù; userReprompt.SpokenMessage = "Which one did you wanna to cancel?"; // Create the list of content tiles to show the selection items. var destinationsContentTiles = new List&lt;VoiceCommandContentTile&gt;(); // create your VoiceCommandContentTiles for(int i=0; i &lt; 5; i++) { var destinationTile = new VoiceCommandContentTile(); destinationTile.ContentTileType = VoiceCommandContentTileType.TitleWith68x68IconAndText; // The AppContext is optional. // Replace this value with something specific to your app. destinationTile.AppContext = "id_Vegas_00" + i; destinationTile.Title = "Tech Conference"; destinationTile.TextLine1 = "May " + i + "th"; destinationsContentTiles.Add(destinationTile); } // Create the disambiguation response. var response = VoiceCommandResponse.CreateResponseForPrompt(userPrompt, userReprompt, destinationsContentTiles); // Request that Cortana shows the disambiguation screen. var voiceCommandDisambiguationResult = await voiceServiceConnection.RequestDisambiguationAsync(response); if (voiceCommandDisambiguationResult != null) { // Use the voiceCommandDisambiguationResult.SelectedItem to take action. // Call Cortana to present the next screen in .5 seconds // and avoid a transition screen. }</span></span></code> </pre> <br><br><h2>  Summing up </h2><br>  We hope that now you better understand how easy it is to add integration with Cortana into your application and thereby improve the interaction experience for your users.  From simple application launching to complex interaction models even without launching the application - in all cases, Cortana can actually be useful.  To take advantage of the integration with Cortana, you can start from the simplest - add a new way to work with deep links in your application. <br><br>  If you feel that working with Cortana in practice can add value to your application, feel free to implement it.  As soon as you update your application, do not forget to declare yourself in the DVLUP program in the nomination ‚Äú <a href="http://wndw.ms/w3ch">Adding Cortana to your app</a> ‚Äù to get points and XP for updating the application.  Tell us what you have done via Twitter <a href="http://wndw.ms/windev">@WindowsDev</a> with the hashtag # Win10x10 - we will be happy to know what the developers create under Windows. <br><br><h3>  Additional materials </h3><br>  Below are some links with useful additional information about the expansion of Cortana: <br><ul><li>  Article on MSDN: <a href="https://msdn.microsoft.com/ru-ru/library/windows/apps/xaml/mt185598.aspx">Interaction with Cortana</a> </li><li>  MSDN article: <a href="https://msdn.microsoft.com/library/windows/apps/dn974233.aspx">Cortana Design Guidelines</a> </li><li>  MSDN article: <a href="https://msdn.microsoft.com/ru-ru/library/windows/apps/xaml/mt185603.aspx">Interaction with Cortana Background Application</a> </li><li>  Excellent <a href="http://metulev.com/meet-the-speech-platform-in-windows-10/">article by Nikola Metuleva about Cortana and working with speech in Windows</a> .  In the article you will find interesting examples and a detailed story about programming for Cortana. </li><li>  Detailed article by Oliver Mathis with <a href="http://www.guruumeditation.net/en/integration-of-an-application-to-cortana/">best practices for integrating applications with Cortana</a> . </li></ul></div><p>Source: <a href="https://habr.com/ru/post/267987/">https://habr.com/ru/post/267987/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267977/index.html">Operator famous banker Trojan Citadel sentenced to prison</a></li>
<li><a href="../267979/index.html">Transition from SQL to NoSQL: the experience of the SMEV 2.0 project</a></li>
<li><a href="../267981/index.html">Cloud Security</a></li>
<li><a href="../267983/index.html">WinRAR critical vulnerability</a></li>
<li><a href="../267985/index.html">PBX 3CX for hosting - change the rules of the game</a></li>
<li><a href="../267989/index.html">Li-ion battery: another step towards savings</a></li>
<li><a href="../267991/index.html">SMPP Specification Guide</a></li>
<li><a href="../267995/index.html">Webix 3.0 - New, Purple</a></li>
<li><a href="../267997/index.html">DaData.ru turns guides into addresses and knows all the kids in the sky</a></li>
<li><a href="../268003/index.html">Elasticweb is the most democratic shared hosting</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>