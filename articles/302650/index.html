<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Inertial sensors: cooking recipes for positioning systems</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this post we will talk about inertial sensors. The fact that they measure and how these physical quantities can be used. 


 Most modern mobile pho...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Inertial sensors: cooking recipes for positioning systems</h1><div class="post__text post__text-html js-mediator-article"><p>  In this post we will talk about inertial sensors.  The fact that they measure and how these physical quantities can be used. </p><br><p>  Most modern mobile phones have on board a triad of accelerometers, gyroscopes and magnetometers, often in addition to them, an atmospheric pressure sensor is installed. </p><br><p>  Everything is very clear with the last sensor: almost every one of us has a barometer hanging at home or in the country and millimeters of its mercury column are firmly connected with the rain, bad weather and general well-being of their beloved grandmother.  But what is measured by the accelerometer, gyroscope and magnetometer, and how to use this information to determine the orientation of the device in space? <a name="habracut"></a></p><br><h4>  Accelerometer </h4><br><p>  Wikipedia says that an accelerometer is a device that measures the projection of apparent acceleration.  A typical accelerometer consists of three mutually perpendicular measuring axes that register gravitational and linear accelerations. </p><br><p>  Using measurements of a triaxial accelerometer, one can determine its orientation relative to the reference vector, which in this case is gravitational acceleration.  Then, however, the orientation will not be fully resolved - there will be uncertainty about the angle of rotation around an axis parallel to the direction of the acceleration of gravity. </p><br><p>  This is explained in more detail in the figure below.  Imagine that we have a measuring device with an accelerometer that has three X, Y, and Z axes. In the figure, these axes are marked in red, green, and blue and form the left three of vectors.  Obviously, if only the gravitational acceleration vector is available for determining the orientation, then there will be an infinite number of possible orientations of the measuring device, in which the Z axis of the accelerometer will measure the gravitational acceleration value, but we cannot resolve the absolute orientation of the device. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aab/0b5/5b7/aab0b55b70a99a958a5a000112a45ad2.png" width="500"></div><br><h4>  Magnetometer </h4><br><p>  To allow orientation completely, we need a second basis vector that will not be parallel to the first.  Such a vector may be, for example, the vector of the magnetic field of our planet.  If its direction is known, then the orientation will be resolved unequivocally. </p><br><p>  Knowing the orientation of one coordinate system relative to another, it becomes possible to transfer measurements from the device coordinate system to the global one.  And knowledge of accelerations in the global coordinate system will allow, by integration, to restore speed and obtain information about the relative location. </p><br><h4>  Gyroscope </h4><br><p>  The gyroscope allows you to measure the speed of rotation of the device, respectively, in order to bring the speed to the angle of rotation, we must integrate it.  The main orientation problem is connected with this position only with the help of a gyroscope - due to continuous integration of not quite accurate measurements of angular velocities caused by zero displacement or temperature effects, we will get an orientation drift, or, in other words, it will ‚Äúfloat‚Äù from the true value. </p><br><p>  The advantage of using all three sensors in the orientation filter is that: </p><br><ul><li>  Thanks to the measurements of the gyroscope, it becomes possible to simultaneously suppress orientation jumps while preserving the filter's reactivity, in fact we get an analogue low-pass filter without any delay, while visualizing a "smoothness" is observed when the object rotates.  A good quick start filter is a <a href="https://habrahabr.ru/post/255661/">Madwick</a> filter, but in my opinion, the Mahoney filter is even more intuitive because the orientation error in it is calculated not by using a gradient, but by simple vector multiplication. <br>  Similar filters can also be used to combine measurements of sensor pairs.  For example, the following figure shows the result of the height estimation using the Kalman filter, where atmospheric pressure data are used as measurements, and accelerometer measurements are used as external influences.  By the way, there is a similar solution on the Habr√©; there, an accelerometer and a barometer are used to <a href="https://geektimes.ru/post/255736/">stabilize the</a> height of the quadrocopter. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/720/ce4/6f7/720ce46f717c4a3631f5b1f3eca67950.png" width="500"></div></li><li>  It becomes possible to include sensor parameters in the system state vector: such as the zero displacement of the accelerometer and gyroscope.  Used filters, built on the basis of complementary or Kalman filter, gradually converge to the true value of the zero offset of the sensor. </li><li>  You can efficiently organize the collection of calibration data.  Thus, when collecting calibration data for a magnetometer, the device‚Äôs orientation data can be used to maximize the surface coverage of the ball and only start the calibration process after all the required ball segments contain at least one measurement. </li><li>  It is possible in some way to solve the main problems in determining orientation: to estimate the direction of external acceleration or to determine whether a local magnetic disturbance is present at a given point, which means you should not trust the measurements of the magnetometer. </li></ul><br><h4>  How else can you use data from inertial sensors? </h4><br><p>  In addition to the traditional and well-studied task of determining the orientation of the device, inertial sensors can be used for: </p><br><ul><li>  Collection of data on the magnetic map of the room.  An example of such a card is shown in the figure below.  It can be seen that in different parts of the building, not only the magnetic field magnitude (in ŒºT), but also the direction of the magnetic induction vector (indicated by the pink line) changes.  This map <a href="https://habrahabr.ru/post/147549/">can be</a> used for the refined positioning of the object in addition to the traditional radio signal maps. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a97/3f8/654/a973f86542f6ed8321b1085058316a59.jpg"></div></li><li><p>  Restoration of the trajectory of the object.  Such an object may be a pedestrian or a car.  In some cases, for example, when mounting the device on the leg and preliminary calibrating the sensors, it is possible to achieve an error of returning to the starting point of movement not exceeding tens of centimeters for a path length exceeding 100 meters.  An example of a restored trajectory using the ZUPT method (when resetting an error during periods of immobility), supplemented by measurements of the atmospheric pressure sensor, is shown in the following figure (the trajectory included the passage along the corridor, descending the stairs, another passage and the elevator).  The similar method was already mentioned on Habr√© <a href="https://habrahabr.ru/company/ibm_bluemix/blog/259877/">here</a> . </p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/521/ecd/476/521ecd476166b395293857562f7b0215.png" width="600"></div><br><p>  With an arbitrary fixing of the device on the human body, the error of returning to the starting point, as a rule, is much larger and amounts to 15-20% of the distance covered.  This value is due, firstly, to the error in determining the step length, and secondly, to the error in determining the direction of movement. </p><br></li><li><p>  Initiating any event or device control.  This can be done by using a device to draw a figure or image in the air, for example, the ‚àû symbol can be used to start the calibration of a magnetometer, longitudinal sweeps by the device to generate an emergency message, and triple tap to turn it off.  These problems are solved with the help of pre-trained classifiers. </p><br></li><li>  Determine current user activity.  For example, when using devices in an office, it may be useful to know how much a person moved during a work day and the type of movement - how much time he spent standing, sitting, how much time he spent on various transitions in a building. </li></ul><br><p>  In future articles, it is planned to reveal the topics of how to work with inertial sensors ‚Äî discuss ways of calibrating them (although this has already been <a href="https://habrahabr.ru/post/196878/">discussed</a> in Habr√©), look at existing ways of restoring the trajectory of a person‚Äôs movement, explore approaches to detecting and eliminating magnetic field disturbances, and discuss firmware architecture for timely time stamping and processing of their measurements. </p><br><p>  The author - Alexander Mikov. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/302650/">https://habr.com/ru/post/302650/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../302638/index.html">Fountain codes</a></li>
<li><a href="../302642/index.html">How to raise CI for iOS developers in a day. Part 2</a></li>
<li><a href="../302644/index.html">Hacking VKontakte: data stolen 171 million users</a></li>
<li><a href="../302646/index.html">Why Gorodor can be useful to you if you already have an RA or media?</a></li>
<li><a href="../302648/index.html">Aytreker in the service of a presentation consultant</a></li>
<li><a href="../302652/index.html">Adventure Jam 2016</a></li>
<li><a href="../302654/index.html">How Jack Ma managed to overcome his 7 biggest failures</a></li>
<li><a href="../302656/index.html">1000 and 1 repost: a guide on the "share" button in Russian social networks</a></li>
<li><a href="../302660/index.html">Asus automatically updates BIOS / UEFI over HTTP without verification</a></li>
<li><a href="../302662/index.html">Regular Expression Crossword Algorithm</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>