<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to create a neural network with just 30 lines of JavaScript code</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="30 lines of code . 

 In this article we will look at how you can create and train a neural network using the Synaptic.js library, which allows you to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to create a neural network with just 30 lines of JavaScript code</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/rs/fn/uh/rsfnuhna5htqhkxcgkaghemjkk4.jpeg"><br><br>  <i><a href="">30 lines of code</a> .</i> <br><br>  In this article we will look at how you can create and train a neural network using the <a href="http://caza.la/synaptic/">Synaptic.js</a> library, which allows you to conduct in-depth training in conjunction with the browser Node.js.  Let's create the simplest neural network that solves the <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BB%25D0%25BE%25D0%25B6%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25BF%25D0%25BE_%25D0%25BC%25D0%25BE%25D0%25B4%25D1%2583%25D0%25BB%25D1%258E_2">XOR equation</a> .  You can also explore a specially written <a href="https://scrimba.com/casts/cast-1980">interactive tutorial</a> . <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/dx/sn/4o/dxsn4o9meddeczs-oae4id0qo3a.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But before moving on to the code, let's talk about the basics of neural networks. <br><br><h2>  Neurons and synapses </h2><br>  The main "building" element of a neural network is, of course, a <a href="https://medium.com/learning-new-stuff/how-to-learn-neural-networks-758b78f2736e">neuron</a> .  Like a function, it takes several input values ‚Äã‚Äãand produces some kind of result.  There are different types of neurons.  Our network will use <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D0%25B3%25D0%25BC%25D0%25BE%25D0%25B8%25D0%25B4%25D0%25B0">sigmoids</a> that take any numbers and reduce them to values ‚Äã‚Äãin the range from 0 to 1. The principle of operation of such a neuron is illustrated below.  At the entrance it has the number 5, and at the output 1. The arrows denote synapses connecting the neuron with other layers of the neural network. <br><br><img src="https://habrastorage.org/webt/s6/cw/jc/s6cwjc9hlxjhfltrnkam7wt6xco.png"><br><br>  But why is the number 5 at the entrance?  This is the sum of three synapses, "included" in the neuron.  Let's figure it out. <br><br>  On the left we see the values ‚Äã‚Äã1 and 0, as well as the <b>offset</b> -2.  First, the first two values ‚Äã‚Äãare multiplied by their <b>weights</b> , which are 7 and 3, the results are added and the offset is added to them, we get 5. This will be the input value for our artificial neuron. <br><br><img src="https://habrastorage.org/webt/g6/zh/uq/g6zhuqqwjixmbbjhrfiskdb2jgq.png"><br><br>  And since this is a sigmoid, which reduces any value to the range from 0 to 1, then the output value will be 1. If such neurons are connected to each other using synapses, you will get a neural network through which the values ‚Äã‚Äãpass from input to output and are transformed.  Like that: <br><br><img src="https://habrastorage.org/webt/ef/nl/if/efnlifvrcy3vtt2fsyjal8i6i28.png"><br><br>  The neural network is trained to make generalizations for the sake of solving various problems, for example, handwriting recognition or mail spam.  And the ability to generalize well depends on the choice of the right <b>weights</b> and <b>offsets</b> within the entire neural network. <br><br>  For training, you simply give a set of samples and force the neural network to process them time after time, until it gives the correct answer.  After each iteration, the prediction <b>accuracy is</b> calculated and the weights and offsets are adjusted so that the next time the neural network‚Äôs response is slightly more accurate.  This learning process is called backpropagation.  If you spend thousands of iterations, your neural network will learn how to generalize well. <br><br>  We will not consider the work of the back propagation method of an error; this is beyond the scope of our guidelines.  But if you are interested in the details, you can read these articles: <br><br><ul><li>  <a href="http://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/">A Step by Step Back Propagation Example</a> </li><li>  <a href="http://karpathy.github.io/neuralnets/">Hackers Guide to Neural Nets</a> </li><li>  <a href="http://neuralnetworksanddeeplearning.com/chap1.html">NeuralNetworksAndDeepLarning</a> </li></ul><br><h2>  Code </h2><br>  First we create the layers and do it in the synaptic mode using the function <code>new Layer()</code> .  The number transmitted to it means the number of neurons in the fresh layer.  If you do not know what a <b>layer is</b> , then look at the above <a href="https://scrimba.com/casts/cast-1980">tutorial</a> . <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { Layer, Network } = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.synaptic; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> inputLayer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Layer(<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> hiddenLayer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Layer(<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> outputLayer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Layer(<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> <br>  Now we merge the layers together and instantiate a new network. <br><br><pre> <code class="javascript hljs">inputLayer.project(hiddenLayer); hiddenLayer.project(outputLayer); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> myNetwork = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Network({ <span class="hljs-attr"><span class="hljs-attr">input</span></span>: inputLayer, <span class="hljs-attr"><span class="hljs-attr">hidden</span></span>: [hiddenLayer], <span class="hljs-attr"><span class="hljs-attr">output</span></span>: outputLayer });</code> </pre> <br>  We have a network of 2‚Äì3‚Äì1, which looks like this: <br><br><img src="https://habrastorage.org/webt/nc/rw/wa/ncrwwairx-1x6fmfegxlmwke45a.png"><br><br>  Let's teach her: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// train the network - learn XOR var learningRate = .3; for (var i = 0; i &lt; 20000; i++) { // 0,0 =&gt; 0 myNetwork.activate([0,0]); myNetwork.propagate(learningRate, [0]); // 0,1 =&gt; 1 myNetwork.activate([0,1]); myNetwork.propagate(learningRate, [1]); // 1,0 =&gt; 1 myNetwork.activate([1,0]); myNetwork.propagate(learningRate, [1]); // 1,1 =&gt; 0 myNetwork.activate([1,1]); myNetwork.propagate(learningRate, [0]); }</span></span></code> </pre> <br>  We drove 20,000 iterations of learning.  In each iteration, the data is run back and forth four times, that is, four possible combinations of values ‚Äã‚Äãare fed to the input: <code>[0,0] [0,1] [1,0] [1,1]</code> . <br><br>  Let's start by running <code>myNetwork.activate([0,0])</code> , where <code>[0,0]</code> is the input.  This is called forward propagation, or <b>activation of a</b> neural network.  After each forward propagation, the opposite should be done, in which the neural network updates its weights and offsets. <br><br>  <code>myNetwork.propagate(learningRate, [0])</code> propagation is performed using <code>myNetwork.propagate(learningRate, [0])</code> , where <code>learningRate</code> is a constant, meaning how much weights need to be adjusted each time.  The second parameter <code>0</code> is the correct output value for the input <code>[0,0]</code> . <br><br>  <b>Next, the neural network compares the resulting output value with the correct one.</b>  <b>Thus, it determines the accuracy of its own work.</b> <br><br>  According to the results of the comparison, the neural network adjusts the weights and displacements to answer a little more accurately the next time.  After 20,000 such cycles, you can check how well our neural network has learned by activating it with the help of all four possible input values: <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(myNetwork.activate([<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>])); -&gt; [<span class="hljs-number"><span class="hljs-number">0.015020775950893527</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(myNetwork.activate([<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>])); -&gt;[<span class="hljs-number"><span class="hljs-number">0.9815816381088985</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(myNetwork.activate([<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>])); -&gt; [<span class="hljs-number"><span class="hljs-number">0.9871822457132193</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(myNetwork.activate([<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>])); -&gt; [<span class="hljs-number"><span class="hljs-number">0.012950087641929467</span></span>]</code> </pre> <br>  If we round the results to the nearest integer values, we get the exact answers for the XOR-equation.  Works! <br><br>  That's all.  Although we have just dug up the subject of neural networks, you can already experiment with Synaptic and continue learning yourself.  There are many good tutorials on the library's <a href="https://github.com/cazala/synaptic/wiki">wiki</a> . </div><p>Source: <a href="https://habr.com/ru/post/354108/">https://habr.com/ru/post/354108/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354092/index.html">Another article about the recognition of workers without helmets neural networks</a></li>
<li><a href="../354096/index.html">How to prove the importance of tests for each project participant</a></li>
<li><a href="../354098/index.html">How data sharing affects the quality of recommendations</a></li>
<li><a href="../354104/index.html">React HoC in TypeScript. Typing without pain</a></li>
<li><a href="../354106/index.html">How to get rid of the difficulty in managing a state in React - report on the results of a trip to React Amsterdam</a></li>
<li><a href="../354110/index.html">Urgent Relocation from Amazon Web Services - Two Customer Stories</a></li>
<li><a href="../354112/index.html">Own Goal We are testing DDoS protection.</a></li>
<li><a href="../354114/index.html">Java 10 migration notes</a></li>
<li><a href="../354116/index.html">Inventions for smugglers and pharmacists + training your research institute</a></li>
<li><a href="../354118/index.html">True XP / TDD in Pivotal from the inside: how does it look and is it possible?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>