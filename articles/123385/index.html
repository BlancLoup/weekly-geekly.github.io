<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The architecture of the Aggregation-Access network of large providers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The architecture of networks of modern telecom operators is perfectly described in all sorts of manuals, guides on preparing for Cisco certifications,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The architecture of the Aggregation-Access network of large providers</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage1/1657379d/9d7a6028/ab6b4cae/1c6fb749.jpg"><br>  The architecture of networks of modern telecom operators is perfectly described in all sorts of manuals, guides on preparing for Cisco certifications, and just smart and good books.  But many of them focus precisely on MPLS Core with interesting features of this technology (such as Traffic Engineering, MPLS BGP Multipath, etc.), bypassing the distribution-access segment.  I propose to talk about the architecture of the access network, adopted by large providers.  As examples, we will consider the access networks of one of the UAE operators (let's call it UAE Telecom) and Tier 1 operator from the USA (say, USA Telecom), with whom I was lucky to work.  According to the information, the same aggregation-access architecture has an IP network of one of the largest Ukrainian operators. <br><a name="habracut"></a><br>  The carrier network consists of a core, usually using MPLS technology, and segments of aggregation-access networks that allow users to connect to the network.  USA Telecom has several networks, one of which, however, is built without using MPLS ‚Äî hardware packet-switching technology using Routing Plane and Forwarding Plane separation (Cisco Express Forwarding and similar to Juniper) allows you to route regular IP packets at the same speed as it is switched by MPLS routers. <br><br>  Provider Edge (PE) routers are located on the border of the MPLS core.  They are more productive than core routers (P Routers), because they need to ‚Äúhold‚Äù the BGP table.  So USA Telecom uses GSR 12000 and even CRS-1 as PE routers - Tier 1 status and tasks are required. <br><br>  After PE routers, there is a network consisting of switches to which users connect.  Today we will talk about her. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The main task: to make the network as scalable as possible, since resources are becoming more expensive with each following ‚Äústep‚Äù: the switch distribution port is more expensive than the switch access port, and the PE router port is more expensive than the switch distribution port.  The applied architecture allows to expand the network most efficiently.  In addition, such an extension is carried out with the provision of communication redundancy in the most efficient way. <br><br>  UAE Telecom uses Cisco ME 4924 as a distribution device, and Cisco 4506 as an access switch. I suggest using them in our model. <br><br><img src="https://habrastorage.org/storage1/674fb756/bfe0143f/8dfa6249/fef0e9db.jpg"><br><br>  It is important to say that the operator uses several architectural approaches, and only one of them is described in this article.  The second, with a similar configuration, implies connecting two access switches in each ring.  This increases the number of access ports and does not affect reliability: <br><br><img src="https://habrastorage.org/storage1/9dd7ebd4/3fbae5af/15b819d4/b85c192e.jpg"><br><br>  The operator provides Triple Play services to individuals, but the customer can determine for himself exactly which Play from these Triple ones he needs.  Enterprises are offered a Layer 2/3 VPN and separate access service configurations with redundant access.  In this case, the customer receives a link to two different access rings. <br><br>  Connecting the Internet, each customer receives a separate VLAN.  All VoIP traffic of all customers, however, ‚Äúwalks‚Äù in a separate VoIP VLAN with the appropriate QoS settings.  This is what the access switch configuration looks like for an average customer: <br><br><pre><code class="tex hljs">policy-map mark-voice class class-default set dscp ef ! interface FastEthernet3/47 description 00000000-Customer-Loc switchport access vlan 434 switchport mode access switchport voice vlan 808 logging event link-status qos vlan-based no snmp trap link-status storm-control broadcast level 1.00 tx-queue 3 bandwidth percent 30 priority high spanning-tree portfast spanning-tree bpduguard enable ! interface Vlan808 no ip address service-policy input mark-voice</code> </pre> <br><br>  The use of level 3 switches at the access level allows you to configure flexible QoS policies and prioritize key traffic, such as VoIP and routing protocol updates, already at the access level. <br><br>  VLANs for a typical set of services are terminated on distribution switches.  For each of them, SVI is the default gateway.  Immediately - at the level of distribution of switches, provides traffic shaping. <br><br>  STP in the face of PVST supports link redundancy.  For individuals, only this type of redundancy is provided - if the link to ‚Äúits‚Äù distribution of the switch ‚Äúfalls‚Äù, traffic will be able to get there along the ring through the second switch. <br><br>  For organizations, the distribution of switches is supported by redundancy - between the pair of SVIs that act as the default gateway for the organization on each distribution router, the HSRP is configured.  If one of the distribution of switches fails, individuals whose VLANs are tied to its SVI will be left unconnected, but the organization will pick up the second distribution switch by making their SVI default gateway for their VLANs. <br><br><img src="https://habrastorage.org/storage1/c8eb2533/abdaaf9a/b37172cb/3cf0686b.jpg"><br><br><pre> <code class="tex hljs">router ospf 100 ! passive-interface Vlan333 network 123.102.12.49 0.0.0.3 area 23.123.15.0 ! interface Vlan333 description Customer-SVI ip address 123.102.10.133 255.255.255.252 ip access-group 101 in no ip redirects ip ospf message-digest-key 1 md5 7 0200005700002120 service-policy input TECOM-Policy-2MB service-policy output TECOM-Policy-2MB ! interface Vlan281 description Enterprise-SVI bandwidth 2000 ip address 123.102.12.49 255.255.255.252 ip access-group 101 in no ip redirects ip ospf message-digest-key 1 md5 7 033000070200004D standby 170 ip 123.102.12.48 standby 170 priority 110 service-policy input TECOM-Policy-512K service-policy output TECOM-Policy-4MB</code> </pre> <br><br>  OSPF also works on distribution switches.  This is necessary due to the fact that these switches are engaged in routing traffic between VLANs within the same distribution pair of devices.  But there are exceptions: if a client orders a Layer 3 VPN, the CE router must establish an OSPF neighborhood with the PE router of the provider.  To ensure this, such a client is allocated a VLAN, which is not terminated on the SVI switch, but is forwarded further, to the PE port of the router, by a trunk.  Total, from distribution of a switch to PE of a router one Vlan leaves, with the traffic which the switch routes to PE, and set of VLAN of clients who use Layer 3 VPN: <br><br><img src="https://habrastorage.org/storage1/115bd097/3adaf7ad/f9333661/71ba0e7c.jpg"><br><br><pre> <code class="tex hljs">interface GigabitEthernet1/3 description Uplink to PE Router switchport trunk encapsulation dot1q switchport trunk allowed vlan 1,12,19,31-33,36-41,70-79,88,98,112,113,125,126 switchport trunk allowed vlan add 135,143,198,199,314,316,320,322,399,440-444 switchport trunk allowed vlan add 454,456,459,480,490,510,511,530,550,557-559 switchport trunk allowed vlan add 563,567,571,578,579,582,588,602-604,616,626 switchport trunk allowed vlan add 637,660,661,666,670,672,675,677-679,688,699 switchport trunk allowed vlan add 705,713,728,739-749,753,754,757,760,762 switchport trunk allowed vlan add 769-778,783,788-790,793-795,799,806,812,822 switchport trunk allowed vlan add 823,878,888,900,923,925,950,955-958,987,990 switchport trunk allowed vlan add 993-995,998,999,1100,1206,1209,1252,1301 switchport trunk allowed vlan add 1302,1313,1325,1326,1350,1351,1360,1361,1400 switchport trunk allowed vlan add 1705,2100,2400,3432,3900 switchport mode trunk qos trust dscp udld port aggressive mac access-group filtermac in tx-queue 1 bandwidth percent 10 tx-queue 2 bandwidth percent 20 tx-queue 3 bandwidth percent 30 priority high tx-queue 4 bandwidth percent 40 service-policy input police-in-ge</code> </pre> <br><br>  Thus, each distribution pair of devices forms a separate VLAN domain, and in the network controlled by another distribution pair of switches, you can use VLANs with the same numbers again. <br><br>  In the UAE, the Internet and other IP services are very popular, because the coverage is very, very dense.  So a pair of switch distribution can cover one building.  And for one of the largest skyscrapers - business centers, even a separate pair of PE routers was allocated.  For comparison, according to the stories, at Kyivstar, a pair of PE routers provides coverage for one area.  Although, of course, IP services are not the largest part of the business of this operator, the comparison is significant. <br><br>  <b>PS</b> Company names, IP addresses, descriptions, MD5 hashes and other information that can be kept confidential are changed.  All technological details, however, are preserved in the original. </div><p>Source: <a href="https://habr.com/ru/post/123385/">https://habr.com/ru/post/123385/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../123377/index.html">Geo Planner - 2.0</a></li>
<li><a href="../123378/index.html">Disc with accompanying materials DevCon posted online</a></li>
<li><a href="../123380/index.html">SMS and SIP gateway - Multiphone, Asterisk, Kannel</a></li>
<li><a href="../123382/index.html">Course on training idiots (quotes from the book "The Art of website design")</a></li>
<li><a href="../123383/index.html">During the year the number of spam decreased by 82.22%</a></li>
<li><a href="../123386/index.html">Storage format for sharing in the cloud</a></li>
<li><a href="../123388/index.html">Sony is going to put into operation the Playstation Network and Qriocity by July 6</a></li>
<li><a href="../123391/index.html">Using MySQL events in practice</a></li>
<li><a href="../123394/index.html">Working with ShapeFile (* .shp) in Delphi</a></li>
<li><a href="../123395/index.html">Accounting system based on the OCR system</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>