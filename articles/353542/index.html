<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to develop a SIEM (Information Security Incident Management System) in one day</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúColleagues, I remind you, in this quarter, advanced training courses are planned for partners on the topic of information security management. Our te...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to develop a SIEM (Information Security Incident Management System) in one day</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ar/0w/la/ar0wlas6ni0hfv4ulrt5d1jsttm.png" alt="SIEM system architecture"></div><br>  ‚ÄúColleagues, I remind you, in this quarter, advanced training courses are planned for partners on the topic of information security management.  Our team is invited to prepare a practical lesson dedicated to the issues of building SIEM systems! ‚Äù- after such a proposal from the chief, there was a pause during the next training session. <br><br>  The participants of the meeting, from among the supposed performers, understood the significance of such a proposal ( <s>glory and honor of the</s> time, effort, nerves).  But, since conducting studies of SIEM solutions (Security Information and Event Management, security incident management systems) is one of our areas of business, it was not possible to refuse a proposal.  Breathed and started. <br><br>  After two months of hard work and the preparation of the final version of the lesson, we admitted that we had spent this time incredibly productively.  And they didn‚Äôt even realize how useful a professional response the team would be to answer such a ‚Äúchallenge‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We are sharing the workshop materials on developing our own SIEM system in one day with convincing examples. <br><br><blockquote>  <i>Disclaimer</i>  The material is voluminous, designed for a full school day at a measured pace.  The example is primitive.  The authors doubt the industrial applicability of open-source solutions of SIEM, but at the same time they believe that the study of practical examples will allow a better understanding of the subject area. </blockquote><a name="habracut"></a><br><h2>  Source data analysis and problem statement </h2><br>  We specify the initial data and determine the average "profile" of the course listener.  Our partners send to the training of engineers and specialists in the field of information security (IB), whose responsibilities include both conducting applied research, developing specialized software, and providing relevant services. <br><br>  The audience promises to be prepared and experienced, with a higher education, selectively with academic degrees and professional certificates.  Students in the courses are not ‚Äúserving the number‚Äù, but are interested in new knowledge. <br><br>  The wishes of partners are also known to consider in the classroom the construction of modern security incident management systems with a minimum of theory and a maximum of practice and benefit. <br><br>  So, it is proposed to prepare a workshop, during which: <br><br><ul><li>  talk about the well-known approaches to the construction of SIEM systems; </li><li>  to clarify the architectural features of the class of such systems on the example (albeit primitive, but convincing) of developing their own solution; </li><li>  demonstrate the operation of its own SIEM system in ‚Äúcombat-training‚Äù conditions for monitoring the security of a test network infrastructure. </li></ul><br>  We hope that students are familiar with network technologies and the basics of programming (examples of code are in PHP and C #). <br><br>  We start the development of materials for future classes. <br><br><h2>  Workshop on the development of SIEM systems </h2><br>  In the opening remarks we confine ourselves to general explanations. <br><br>  The main task of the SIEM system is to analyze events from different sources recorded in the protected infrastructure and detect attacks / attack scenarios / suspicious actions / deviations from the norm, forming appropriate security incidents if necessary. <br><br>  The basic capabilities of the SIEM system should provide the following tasks [1, 2]: <br><br><ul><li>  collection and storage of incoming security events; </li><li>  processing and analysis of recorded security events; </li><li>  detection of attacks and violations of security policies in real time (close to real time); </li><li>  identification and analysis of security incidents; </li><li>  report generation. </li></ul><br>  In addition, additional requirements are imposed on modern solutions of the SIEM class in order to ensure the implementation of the following functionality [3]: <br><br><ul><li>  assessment of the security of resources of the controlled system; </li><li>  verification of compliance of the IS management system with existing requirements and standards; </li><li>  IS risk management, etc. </li></ul><br>  The functional model of the SIEM system combines the following functional subsystems: data collection, preprocessing, storage, analysis, presentation [1].  The generalized sequence of processing security events in the solutions of the SIEM is illustrated by the figure [2]: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pq/ca/gj/pqcagjc3je-b9qba16cu1t2mpgy.png" alt="SIEM subsystems"></div><br>  Further it is proposed to consider an example of developing your own SIEM system for the development of practical skills. <br><br>  The example simulates a simplified ‚Äúbrute-force‚Äù attack scenario with respect to a web-based training application.  The task of the system being developed by SIEM is to notify the security administrator of an attempt to implement such an attack. <br><br>  To build a test bench, open-source solutions and proprietary PHP and C # applications will be used.  The architecture of the test bench is shown in the figure below (repeats the title image of the publication). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ar/0w/la/ar0wlas6ni0hfv4ulrt5d1jsttm.png" alt="SIEM system architecture"></div><br>  For ease of navigation, the example sections are numbered.  Getting to practice: <br><br><pre> 1. Organization of the test environment.
      1.1.  Install and configure the Apache web server.
      1.2.  Install and configure MongoDB data storage.
      1.3.  Install and configure the message broker RabbitMQ.
      1.4.  Installing and configuring the development environment Visual Studio.
 2. Develop a secure web application Buggy Webapp.
 3. Development of a connector for the Apache web server.
 4. Development of core correlation (event handler).
      4.1.  Performance evaluation of MongoDB data warehouse.
      4.2.  Formation of a set of correlation rules.
      4.3.  Core Correlation Implementation.
 5. Development of the security administration console.
 6. Testing the performance of the developed SIEM system. </pre><br><br>  Bibliographic list: <br><br><ol><li>  <a href="http://www.mathnet.ru/links/65be775b07c89226eea39519e63fe8dd/trspy488.pdf">‚ÄúThe use of information and security event management technology to protect information in critical infrastructures‚Äù</a> is one of the first articles (2012) of the SPIIRAS computer security research team (I. V. Kotenko, I. B. Saenko, O. V. Polubelova , A. A. Chechulin) with general provisions on the construction and operation of SIEM systems.  <a href="http://comsec.spb.ru/ru/papers">Full list of publications of the laboratory</a> . </li><li>  <a href="https://www.amazon.com/Security-Information-Management-Implementation-Network/dp/0071701095">Security Information and Event Management (SIEM) Implementation</a> is a wonderful book by David Miller, Sean Harris, and others. The 2011 edition, with some outdated chapters, but in many ways still relevant.  A systematic look at the organization of SIEM systems, accessible English, clear examples. </li><li> <a href="https://www.gartner.com/doc/3097022/magic-quadrant-security-information-event">Magic Quadrant for Security Information and Event Management 2015</a> .  Gartner's thematic reports for 2016 and 2017 will also be useful to researchers of SIEM systems. </li></ol><br><h2>  1. Organization of the test environment </h2><br><blockquote>  <i>Note.</i>  It is likely that the stand will function with the latest versions of software solutions used.  But in order to ensure the reproducibility of the research results, we will fix the version numbers for which all the necessary dependencies have been clarified and the operability checked. </blockquote><br><h3>  1.1 Installing and Configuring the Apache Web Server </h3><br>  As a web server, we will use <a href="https://www.apachefriends.org/ru/index.html">the XAMPP for Windows build</a> , version 7.1.9 (Apache 2.4.27 + PHP 7.1.9).  Download and install XAMPP using the installer, select the default installation folder - ‚Äúc: \ xampp \‚Äù. <br><br>  To check the installation of the web server, simply open the XAMPP Control Panel and launch the Apache module.  Then the welcome page of the XAMPP project will open in the browser at the address ‚Äúhttp://127.0.0.1/‚Äù. <br><br>  If there are no errors, go to the next item. <br><br><h3>  1.2 Install and configure MongoDB data storage </h3><br>  To organize the data warehouse, it is proposed to use <a href="https://www.mongodb.com/">the MongoDB</a> document <a href="https://www.mongodb.com/">database</a> .  The main reason for this choice is the solution of the educational problem and familiarity with the approaches of NoSQL.  In addition, even a cursory study of commercial SIEM systems allows us to conclude that most of the leading manufacturers, together with traditional SQL databases, use NoSQL / NewSQL technology in their solutions. <br><br>  Below is a model of one well-known commercial SIEM system, confirming that the manufacturer uses MongoDB and RabbitMQ solutions (the message broker is discussed further): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ow/xh/ia/owxhiatay--6ch6qop9er1p4nca.png" alt="Model commercial SIEM system"></div><br>  We download from the <a href="https://www.mongodb.com/download-center">official site</a> and install the MongoDB Community Server version 3.4.10 installation package.  Examples of instructions: <br><br><ul><li>  <a href="http://snippets.pp.ru/article/346">Simple instructions for installing MongoDB as a service</a> </li><li>  <a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-windows/">Install MongoDB Community Edition on Windows</a> </li></ul><br>  We check the server performance by creating a new document in the collection (collection) test (document) with a field (field) {a: 1}.  An attempt to find a document in the collection should succeed. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zn/sa/co/znsaconxnilxqfkikhjliju3jga.png" alt="MongoDB check result"></div><br>  Note that when you add a document to the collection, the MongoDB server, by default, complements the document with an _id field of <a href="https://docs.mongodb.com/v3.4/reference/method/ObjectId/">type ObjectId</a> .  The ‚Äúadditive‚Äù is unique (not to be confused with the hash, the rules of formation are different) and allows you to uniquely identify the document in the collection. <br><br>  Perform another check, more visual.  Download one of the available administration tools, such as <a href="https://www.robomongo.org/">Robomongo</a> version 1.1.0-Beta, and connect to the MongoDB server.  The test collection must contain the created document with the field {a: 1}. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/af/el/f8/afelf8id2te537oevuacevdxmk8.png" alt="Robomongo check"></div><br>  In the screenshot, instead of the expected address 127.0.0.1, the address is 192.168.137.1 - we use a distributed test bench for experiments, consisting of several physical workstations and virtual machines.  But the difficulties in installing all components on the same workstation in the host operating system should not be. <br><br>  An assessment of the performance of the data warehouse is proposed below. <br><br>  If there are no errors, go to the next item. <br><br>  Useful links and sources of additional knowledge: <br><br><ul><li>  The popular science publication <a href="https://www.amazon.com/NoSQL-Distilled-Emerging-Polyglot-Persistence/dp/0321826620/ref%3Dsr_1_1%3Fs%3Dbooks%26ie%3DUTF8%26qid%3D1518085184%26sr%3D1-1%26keywords%3Dnosql%2Bdistilled">‚ÄúNoSQL Distilled‚Äù by</a> Martin Fowler and Pramod Sadaladzha.  There is a decent translation - <a href="http://www.williamspublishing.com/Books/978-5-8459-1829-1.html">"NoSQL: a new methodology for developing non-relational databases."</a> </li><li>  From fresh on Habr√©: <a href="https://habrahabr.ru/company/alconost/blog/340372/">"Why SQL prevails over NoSQL, and what it will lead to in the future"</a> , <a href="https://habrahabr.ru/company/ruvds/blog/324936/">"SQL or NoSQL - that is the question</a> . <a href="https://habrahabr.ru/company/ruvds/blog/324936/">"</a> </li></ul><br><h3>  1.3 Installing and Configuring the RabbitMQ Message Broker </h3><br>  To organize data exchange between the components of the developed system, we will use <a href="http://www.rabbitmq.com/">RabbitMQ message broker</a> , one of the most common solutions of this class <a href="https://stackshare.io/message-queue/">according to stackshare.io</a> . <br><br>  Follow the recommended RabbitMQ Server installation <a href="http://www.rabbitmq.com/install-windows.html">instructions</a> for Windows (version 3.7.2).  You will need to <a href="http://www.erlang.org/downloads">install Erlang</a> , having previously checked the dependencies of the versions - for RabbitMQ Server 3.7.2, Erlang version 20.1 will do. <br><br>  The installer will configure the RabbitMQ Server as a service.  For further checks, go to the directory "c: \ Program Files \ RabbitMQ Server \ rabbitmq_server-3.7.2 \ sbin \". <br><br>  Run the command to start the service: <br><br><pre><code class="tex hljs">rabbitmq-service start</code> </pre> <br>  Check the status of the team <br><br><pre> <code class="tex hljs">rabbitmqctl status</code> </pre> <br>  If the status is without errors, then everything is fine. <br><br>  To visually monitor the operation of the message broker, let's connect the appropriate plugin - Management plugin: <br><br><pre> <code class="tex hljs">rabbitmq-plugins enable rabbitmq_management</code> </pre> <br>  After launching the plug-in in the browser, the administration panel (default account is guest / guest) will be available at the address ‚Äúhttp://127.0.0.1:15672/‚Äù. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zu/s6/mq/zus6mqs5jaahh5kl7fgvcym48nk.png" alt="RabbitMQ check"></div><br>  When building the test bench, we installed a messaging server on the node with the address 192.168.137.1.  If you need a remote connection to the administration panel, you will need to create a new user and grant him the appropriate permissions, for example: <br><br><pre> <code class="tex hljs">rabbitmqctl add_user siemuser siempass rabbitmqctl set_user_tags siemuser administrator rabbitmqctl set_permissions -p / siemuser ".*" ".*" ".*"</code> </pre> <br>  After checking the connection to the administration panel, we consider the installation and configuration of the message broker successful.  We check the messaging in the following steps. <br><br>  Sources of additional knowledge: <br><br><ul><li>  <a href="https://redis.io/topics/pubsub">Redis Pub / Sub</a> : messaging system!  Check it out. </li><li>  <a href="https://developers.google.com/protocol-buffers/">Google Protocol Buffers</a> </li></ul><br><h3>  1.4 Installing and Configuring the Visual Studio Development Environment </h3><br>  It so happened that the development of a security event handling core in our team is conducted in C #.  Therefore, some examples will be in C #, nothing personal and no holivar.  In addition, the language is simple enough to understand, which is consistent with the educational objectives of the project. <br><br>  We use Visual Studio Community 2017, the starting point for installation is <a href="https://www.visualstudio.com/ru/downloads/">www.visualstudio.com/en/downloads/</a> .  Checking the installation is postponed until the assembly of the first solution in C #. <br><br><h2>  2. Buggy Webapp Secure Web Application Development </h2><br>  For example, we will develop a simple web application that implements the user authentication function.  <a href="https://bootsnipp.com/tags/login">Inspired by the</a> ideas of minimalism in the markup, we impose the layout of the application using <a href="https://getbootstrap.com/">Bootstrap 4</a> .  For implementation we use the PHP language. <br><br>  The source code of the application Buggy Webapp: <a href="https://github.com/fisher85/AirSIEM/blob/master/buggy/admin.php">buggy / admin.php</a> . <br><br>  The admin.php script asks for a username and password and compares them with the corresponding administrative account settings (admin / admin).  If the username and / or password do not match, an error message is displayed. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bl/mc/s2/blmcs2xnr8nvwxdzbrhmchtgno8.png" alt="Error message"></div><br>  In the case of a correctly entered username and password, access to the administrative section is provided. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7m/m-/y1/7mm-y1ppy7cgyz46e354woznrsa.png" alt="Providing access"></div><br>  We save the admin.php file in the corresponding folder of the XAMPP assembly (the path to the file is ‚Äúc: \ xampp \ htdocs \ buggy \ admin.php‚Äù).  From the XAMPP control panel, we launch the web server, after which the web application should be available in the browser at the address ‚Äúhttp://127.0.0.1/buggy/admin.php‚Äù.  If there are no errors, go ahead. <br><br><h2>  3. Connector Development for Apache Web Server </h2><br>  How to track calls to the protected web application and try to detect suspicious user activity?  A simple and understandable way is to view the access log (access log) of the web server. <br><br>  In the case of the environment used, the access log is stored in the access.log file (the approximate path in XAMPP is ‚Äúc: \ xampp \ apache \ logs \ access.log‚Äù). <br><br>  After several downloads of the web application in the browser, we turn to the contents of the log file: <br><br><pre> <code class="tex hljs">127.0.0.1 - - [01/Jan/2099:12:30:39 +0300] "GET /buggy/admin.php?username=hacker&amp;password=123 HTTP/1.1" 200 2040 "http://127.0.0.1/buggy/admin.php" "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.91 Safari/537.36"</code> </pre> <br>  The format of the record is defined in the Apache web server httpd.conf configuration file (approximate path in XAMPP is ‚Äúc: \ xampp \ apache \ conf \ httpd.conf‚Äù): <br><br><pre> <code class="tex hljs">LogFormat "<span class="hljs-comment"><span class="hljs-comment">%h %l %u %t \"%r\" %&gt;s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined CustomLog "logs/access.log" combined</span></span></code> </pre> <br>  We get acquainted with the <a href="httpd.apache.org/docs/2.4/mod/mod_log_config.html">detailed description of the format</a> , prepare the mapping scheme and proceed to the development of the connector. <br><br>  Remember that code efficiency issues are less important for our conditions than simplicity. <br><br>  Connector source code: <a href="https://github.com/fisher85/AirSIEM/tree/master/ApacheConnector">ApacheConnector</a> . <br><br>  General description of the algorithm: <br><br><ol><li>  At the initial stage, access the access.log access log and remember the file size. </li><li>  Further, in an infinite loop with a pause between iterations, we track file size changes.  When we increase the size, we read the last added lines from the file and pass it to the RabbitMQ message queue, remember the new file size. </li><li>  The access.log file may be overwritten.  We take into account such a case (reducing the file size). </li></ol><br>  We try to maintain the formatting style of the code according to the examples of <a href="https://www.piter.com/collection/kompyutery-i-internet/product/clr-via-c-programmirovanie-na-platforme-microsoft-net-framework-45-na-yazyke-c-4-e-izd-2">Jeffrey Richter</a> and <a href="https://www.piter.com/collection/all/product/sovershennyy-kod">Steve McConnell</a> .  Both of these books are hotly recommended to all interested parties. <br><br>  To build a connector, you will need to connect the <a href="http://www.rabbitmq.com/dotnet.html">.NET / C # RabbitMQ client library</a> to the project.  The easiest way to do this is to install the appropriate NuGet package in the Package Manager Console of the Visual Studio development environment using the command: <br><br><pre> <code class="tex hljs">Install-Package RabbitMQ.Client -Version 5.0.1</code> </pre> <br>  Note that when building a solution available on GitHub ( <a href="https://github.com/fisher85/AirSIEM">github.com/fisher85/AirSIEM</a> ), there is no need to manually install packages ‚Äî they will be downloaded automatically (only an Internet connection is required). <br><br>  Perform a test launch of the connector with simultaneous testing of the message broker according to the following scenario: <br><br><ol><li>  Launch the ApacheConnector application.  The connector begins tracking changes in the size of the access.log file. </li><li>  In the browser, the Buggy Webapp web application page is updated several times, and the lines corresponding to browser requests to the web server will be added to the access log of the web server. </li><li>  The ApacheConnector application will detect file size changes and send the last lines to the RabbitMQ message broker's queue. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/a3/pu/ps/a3pupsngjnhqd77i32xrexmohwo.png" alt="ApacheConnector check"></div></li><li>  If everything is properly configured, in the RabbitMQ administration panel (the address for our case is ‚Äúhttp://192.168.137.1:15672/‚Äù) we will find an added non-zero load AirSIEM_ConnectorQueue queue. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/d8/l-/hq/d8l-hqeofhv6owj_lmkm7p4llbc.png" alt="RabbitMQ load"></div></li></ol><br>  If the test script ended in the same way, proceed to the next step.  Otherwise, it is necessary to eliminate all errors that occur. <br><br>  A modest experience in fixing RabbitMQ configuration errors: <br><br><ol><li>  The first thing to try is to disable the firewall, antivirus, proxy, etc. If it helps, enable and configure them correctly. </li><li>  If a mismatch error occurs between Erlang hash of the interacting components, try leaving the single installed version of Erlang on the workstation. </li></ol><br>  Notes on the algorithm of the connector: <br><br><ol><li>  Sources of inspiration: examples from Jeffrey Richter <a href="https://www.piter.com/collection/kompyutery-i-internet/product/clr-via-c-programmirovanie-na-platforme-microsoft-net-framework-45-na-yazyke-c-4-e-izd-2">‚Äôs</a> book <a href="https://www.piter.com/collection/kompyutery-i-internet/product/clr-via-c-programmirovanie-na-platforme-microsoft-net-framework-45-na-yazyke-c-4-e-izd-2">‚ÄúProgramming on the .NET 4.5 Platform‚Äù</a> (Chapter 27, ‚ÄúAsynchronous Computational Operations‚Äù) and <a href="https://www.codeproject.com/Articles/19062/Log-Monitor">the Log Monitor project</a> . </li><li>  Why not use FileSystemWatcher?  In one case per million class will <a href="https://blogs.msdn.microsoft.com/alejacma/2011/03/23/filesystemwatcher-class-does-not-fire-change-events-when-notifyfilters-size-is-used/">incorrectly track file changes</a> .  This case, according to a known <a href="https://ru.wikipedia.org/wiki/%25D0%2597%25D0%25B0%25D0%25BA%25D0%25BE%25D0%25BD_%25D0%259C%25D0%25B5%25D1%2580%25D1%2584%25D0%25B8">law</a> , was observed during the experiments. </li></ol><br><h2>  4. Development of core correlation (event handler) </h2><br>  So, to this stage, we have configured a security event collection subsystem from a single source - the Apache web server.  The ApacheConnector connector tracks access.log access history changes and sends the last lines to the RabbitMQ message broker's queue. <br>  The next stage is the development of a correlation core (event handler).  But previously, as noted earlier, it is proposed to estimate the speed of writing and reading from the MongoDB data warehouse.  We expect that this component will be a bottleneck of the system being developed and will determine the upper limit of performance. <br><br><h3>  4.1 Performance evaluation of MongoDB data warehouse </h3><br>  Perform performance testing in a simple way - first, we estimate the speed of sequential writing to the repository (single documents and document packages), and then we estimate the speed of random reading a document from the collection. <br><br>  Application source code: <a href="https://github.com/fisher85/AirSIEM/tree/master/MongoBenchmark">MongoBenchmark / Program.cs</a> . <br><br>  To work with MongoDB, you need to connect the <a href="https://www.nuget.org/packages/MongoDB.Driver/">.NET driver for MongoDB</a> to the project.  The easiest way to do this is to install the appropriate NuGet package in the Package Manager Console using the command: <br><br><pre> <code class="tex hljs">Install-Package MongoDB.Driver -Version 2.5.0</code> </pre> <br>  After launching the application, we will evaluate the benchmark results: <br><br><pre> <code class="tex hljs">InsertMany by 1: 20000 ops in 13.52 seconds (1479.15 ops/sec) =&gt; 1479.15 docs/sec InsertMany by 2: 10000 ops in 7.11 seconds (1406.24 ops/sec) =&gt; 2812.48 docs/sec InsertMany by 5: 4000 ops in 3.20 seconds (1250.93 ops/sec) =&gt; 6254.66 docs/sec InsertMany by 10: 2000 ops in 2.08 seconds (960.88 ops/sec) =&gt; 9608.78 docs/sec InsertMany by 50: 400 ops in 1.15 seconds (347.68 ops/sec) =&gt; 17384.15 docs/sec InsertMany by 100: 200 ops in 1.06 seconds (188.32 ops/sec) =&gt; 18832.26 docs/sec InsertMany by 250: 80 ops in 0.95 seconds (83.87 ops/sec) =&gt; 20968.05 docs/sec InsertMany by 500: 40 ops in 0.92 seconds (43.67 ops/sec) =&gt; 21835.64 docs/sec InsertMany by 1000: 20 ops in 0.93 seconds (21.39 ops/sec) =&gt; 21391.22 docs/sec InsertMany by 5000: 4 ops in 1.00 seconds (3.99 ops/sec) =&gt; 19936.32 docs/sec InsertMany by 10000: 2 ops in 1.01 seconds (1.97 ops/sec) =&gt; 19730.96 docs/sec InsertMany by 20000: 1 ops in 1.01 seconds (0.99 ops/sec) =&gt; 19832.80 docs/sec Find: 10000 ops in 6.17 seconds (1620.21 ops/sec)</code> </pre> <br>  The ‚Äúhump‚Äù of the distribution falls on the case of sending 500 events in one packet (block), the speed of sequential writing is 21,835 documents per second.  The random read speed from the collection is 1620 documents per second.  Considering the fact that the test stand is organized using personal computers of ‚Äúnon-top‚Äù configurations, we are quite satisfied with the results.  We believe that the read and write speed values ‚Äã‚Äãobtained in the experiment will allow the MongoDB data storage to handle the load planned in the example. <br><br>  Notes: <br><br><ul><li>  A widely cited source on the issue of ‚Äúrunning time‚Äù of operations: a <a href="https://stackoverflow.com/questions/243351/environment-tickcount-vs-datetime-now">discussion of Environment.TickCount vs DateTime.Now</a> on Stack Overflow. </li><li>  An attempt to insert into the collection two documents with the same _id will end in trouble as an exception MongoDB.Driver.MongoWriteException with an approximate explanation: <br><br><pre> <code class="tex hljs">E11000 duplicate key error collection: test.events index: _id_ dup key: { : ObjectId('5a2a2b386a49df197845deaa') }</code> </pre></li></ul><br><h3>  4.2 Formation of a set of correlation rules </h3><br>  And one more digression.  When the next security event arrives, the correlation kernel tries to apply pre-loaded processing rules to it (rules for detecting dependencies between individual events, correlation rules).  Let's form a test rule set that will be used later in the example. <br><br>  To describe the rules, we will use the syntax of the correlation rules proposed in <a href="https://ossec.github.io/docs/syntax/head_rules.html">the OSSEC project</a> with minimal changes.  The example simulates a simplified brute-force attack scenario with respect to the protected web application, for this example we <a href="">compose the</a> corresponding set of rules <a href="">test_webapp_rules.xml</a> : <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">group</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"web-app"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">level</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">match</span></span></span><span class="hljs-tag">&gt;</span></span>/buggy/<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">match</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Access to BUGGY webapp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100001"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">level</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">if_sid</span></span></span><span class="hljs-tag">&gt;</span></span>100000<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">if_sid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">match</span></span></span><span class="hljs-tag">&gt;</span></span>password<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">match</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Attempt to login to BUGGY webapp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">level</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">frequency</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">timeframe</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"5"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">if_matched_sid</span></span></span><span class="hljs-tag">&gt;</span></span>100001<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">if_matched_sid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">same_source_ip</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Brute force trying to login to BUGGY webapp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">group</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  The format of the rule set is minimally different from the XML format.  For example, multiple root elements are allowed in the file.  Such a document is not a <a href="https://en.wikipedia.org/wiki/Well-formed_element">well-formed</a> XML document; we will take this feature into account when parsing a file using the means provided by the System.XML namespace. <br><br>  Next, we consider separately each rule and briefly explain the features of the syntax.  The first rule: <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">level</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">match</span></span></span><span class="hljs-tag">&gt;</span></span>/buggy/<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">match</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Access to BUGGY webapp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  The &lt;rule&gt; element describes a rule. <br><br>  The id attribute of the &lt;rule&gt; element defines the rule identifier.  Identifiers are selected from the range recommended by the OSSEC project for the ‚Äúcopyright‚Äù rules:&gt; = 100000. <br><br>  The level attribute of the &lt;rule&gt; element determines the significance level of the rule.  The minimum value is 0 (generally not displayed in the security administration console), the maximum value is 16. <br><br>  The &lt;match&gt; element specifies a substring to search for in the message being processed. <br><br>  The &lt;description&gt; element specifies the description of the rule that will be displayed as an alert to the security administrator. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The case of triggering such a rule is checked simply - if the substring specified in the &lt;match&gt; element is detected in the line of the message being processed, the core of the correlation will generate a security alert. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The logic of rule 100000 is as follows: notify the security system of all attempts to contact the protected Buggy Webapp web application. For this, the substring "/ buggy /" is monitored in all calls to the web server. The significance level of the 100000 rule is zero, there is no criticality in the monitored hits, the rule triggering will be used to build more complex chains of rules.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We note separately that, in essence, rule 100000 does not detect any dependencies between security events and does not reveal ‚Äúcorrelations‚Äù. In this sense, it is more correct to call such a record a processing rule, and not a correlation rule. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The second rule:</font></font><br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100001"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">level</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">if_sid</span></span></span><span class="hljs-tag">&gt;</span></span>100000<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">if_sid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">match</span></span></span><span class="hljs-tag">&gt;</span></span>password<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">match</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Attempt to login to BUGGY webapp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>    100001    &lt;if_sid&gt;    100000,      ‚Äì ,      100000. <br><br>   100001:          - (   100000)       -   ¬´password¬ª (           ),          ‚Äì ¬´Attempt to login to BUGGY webapp¬ª. <br><br>  100001             . <br><br>  : <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">level</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">frequency</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">timeframe</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"5"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">if_matched_sid</span></span></span><span class="hljs-tag">&gt;</span></span>100001<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">if_matched_sid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">same_source_ip</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Brute force trying to login to BUGGY webapp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>    100002    &lt;if_matched_sid&gt;    100001,      ‚Äì ,   100001    3  ( frequency=¬´3¬ª  &lt;rule&gt;)    5  (timeframe=¬´5¬ª). <br><br>   &lt;same_source_ip/&gt;   ,     ,   &lt;if_matched_sid&gt;,      IP- . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rule 100002 logic: if during the last 5 seconds, many attempts (3 or more) to access the protected web application were recorded from the same address, then create an alert with a higher level of significance level = "1" about the attempt to select an access password - "Brute force trying to login to BUGGY webapp". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The set of correlation rules for the considered example is formed, we proceed to the immediate implementation of the event handler. </font><font style="vertical-align: inherit;">At the end of the example, we will perform step-by-step debugging of the correlation core and check how the correlation rules are applied to incoming security events and which alerts are generated.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 4.3 Core Correlation Implementation </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The software implementation of the correlation core is the most complex and voluminous part of the example, essentially defining the entire logic of processing security events developed by the SIEM system. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In general, the logic of the core correlation is described as follows:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The correlation core is ‚Äúlistening‚Äù to the AirSIEM_ConnectorQueue message queue. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> When the next message (event) arrives, the kernel tries to apply pre-loaded event processing rules (correlation rules) to it. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> If one of the rules is applicable to the received security event, the kernel, if necessary, forms a security incident and stores it in the alerts collection of the MongoDB data warehouse. </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source code: </font></font><a href="https://github.com/fisher85/AirSIEM/tree/master/AirSIEM"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AirSIEM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The implementation will be quite voluminous, so for the convenience of debugging, we will connect the </font></font><a href="http://nlog-project.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NLog</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> logging system to the project </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The easiest way to do this is to install the appropriate NuGet package in the Package Manager Console using the command:</font></font><br><br><pre> <code class="tex hljs">Install-Package NLog -Version 4.4.12</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In addition, to work with the message broker, you need to connect the RabbitMQ.Client package, and to interact with the data store, you need the MongoDB.Driver package: </font></font><br><br><pre> <code class="tex hljs">Install-Package RabbitMQ.Client -Version 5.0.1 Install-Package MongoDB.Driver -Version 2.5.0</code> </pre> <br>  <a href="https://github.com/nlog/nlog/wiki/Tutorial"></a>    NLog,    ( Project &gt; Add Existing Item)   nlog.config ( <a href="https://github.com/fisher85/AirSIEM/blob/master/AirSIEM/AirSIEM/nlog.config"> </a> )         (   Solution Explorer &gt;   nlog.config &gt;    Properties &gt;   ¬´Copy To Output Directory¬ª   ¬´Copy always¬ª). <br><br>    ,  .        AirSIEM.exe.config ‚Äì               . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To verify the correctness of the correlation kernel, you need to make sure that in case of detection of attack scenarios (set by the relevant rules), the kernel creates security incidents and stores them in the alert collection of the MongoDB data warehouse. </font><font style="vertical-align: inherit;">It is proposed to perform verification at the final stage, after the development of all system components.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 5. Development of the security administration console </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For the convenience of the security administrator, we will provide an appropriate solution - the management console. </font><font style="vertical-align: inherit;">The functionality of the console is limited to viewing the generated security incidents, the implementation option is a PHP web application. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source code: </font></font><a href="https://github.com/fisher85/AirSIEM/blob/master/console/index.php"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">console / index.php</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In order for PHP code to interact with MongoDB, you need to perform two actions: connect the appropriate extension to the PHP interpreter, and the corresponding library to the web application.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 5.1 Connecting the php_mongodb.dll extension to the web server </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recall that we use XAMPP for Windows as a web server. By default, the PHP interpreter does not know about the existence of the MongoDB repository, you can fix this by installing the MongoDB PHP Driver on Windows driver. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open the installation instructions for our case - </font></font><a href="http://php.net/manual/en/mongodb.installation.windows.php"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installing the MongoDB PHP Driver on Windows</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Go to the site </font></font><a href="http://pecl.php.net/package/mongodb"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pecl.php.net/package/mongodb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in search of a suitable version of the driver php_mongodb.dll. Select the latest stable version (1.4.0), Windows OS, PHP Version 7.1, thread safe, x86. The selected archive is </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">php_mongodb-1.4.0-7.1-ts-vc14-x86.zip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , in the archive you need the php_mongodb.dll file.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copy the php_mongodb.dll driver to the PHP extensions folder. </font><font style="vertical-align: inherit;">The default is "c: \ xampp \ php \ ext \". </font><font style="vertical-align: inherit;">Add the line ‚Äúextension = php_mongodb.dll‚Äù to the section for connecting extensions to the PHP settings file (by default, ‚Äúc: \ xampp \ php \ php.ini‚Äù). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We restart Apache (the easiest way is from the XAMPP panel), so that at subsequent stages we don‚Äôt waste too much time analyzing errors like ‚ÄúUncaught Error: Class 'MongoDB \ Driver \ Manager' not found‚Äù.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 5.2 Connecting to the MongoDB PHP Library web application </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next you need to connect the MongoDB PHP Library to the admin console project. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We study the </font></font><a href="https://docs.mongodb.com/php-library/current/tutorial/install-php-library/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">official documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The guide recommends the easiest way - using </font></font><a href="https://getcomposer.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Composer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Install Composer, get acquainted with examples of use. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create a folder for the future project, for example, ‚Äúc: \ xampp \ htdocs \ console \‚Äù, execute the mongodb package installation command in the folder:</font></font><br><br><pre> <code class="tex hljs">composer require mongodb/mongodb</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The result of the command: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sd/f8/xw/sdf8xw5x8fuz-5cecw0io-k77k8.png" alt=" Composer"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Composer will download the necessary files and add them to the project. </font><font style="vertical-align: inherit;">In order for the project to use the functionality of the MongoDB PHP Library, you need to add one line to the code:</font></font><br><br><pre> <code class="tex hljs">require_once __DIR__ . "/vendor/autoload.php";</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Save the application code in the file "c: \ xampp \ htdocs \ console \ index.php" and open it in the browser. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/k2/h4/nz/k2h4nzo6vsaet5sq2ban-zlcwhs.png" alt="  "></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The table may be non-empty at the first start, if the correlation kernel during test runs has generated security incidents and saved the relevant documents in the MongoDB data warehouse alerts collection. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If there are no errors, proceed to the final stage. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sources of additional knowledge:</font></font><br><br><ol><li> <a href="https://docs.mongodb.com/ecosystem/drivers/php/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MongoDB PHP Driver</font></font></a> </li><li> <a href="https://docs.mongodb.com/php-library/current/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MongoDB PHP Library</font></font></a> </li><li> <a href="https://docs.mongodb.com/php-library/current/tutorial/install-php-library/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Install the MongoDB PHP Library</font></font></a> </li></ol><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6. Functional check of the developed SIEM system </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, the development of the SIEM system is complete. </font><font style="vertical-align: inherit;">At the final stage, we have to perform step-by-step debugging of the correlation core and make sure that the entire solution works correctly. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recall the main task of the developed system is to notify the security administrator of an attempt to implement a brute-force attack scenario with respect to the protected web application. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consider the final test case in general:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The attacker opens the admin.php page of the protected Buggy Webapp web application and several times tries to find the username and password of the administrator. </font></font></li><li>          ‚Äì ¬´admin/admin¬ª ‚Äì       (       ‚Äì  ). </li><li>  SIEM                ,      . </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Further it is proposed to execute a test script and consider the sequence of actions of the SIEM system. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Step 1. Preliminary preparation.</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> For the "purity" of the experiment, clear the data warehouse. To do this, connect to MongoDB using Robomongo and delete the AirSIEM database (if it exists). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Run the ApacheConnector. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Step 2. Modeling the actions of the attacker.</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Open in the browser the web application Buggy Webapp at the address ‚Äúhttp://127.0.0.1/buggy/admin.php‚Äù. Within 5 seconds, we make three attempts to select the administrator username and password. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Step 3. Checking the operation of the connector.</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the application window of the ApacheConnector, we check the fact of reading the web server access log and sending the registered security events to the message broker queue. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the administration panel of the RabbitMQ message broker (‚Äúhttp://127.0.0.1:15672/‚Äù), we check the presence of load: messages should appear in the AirSIEM_ConnectorQueue queue. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Step 4. Checking the operation of the correlation kernel. </font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Further, the core of the correlation enters the process. </font><font style="vertical-align: inherit;">Run the AirSIEM application. </font><font style="vertical-align: inherit;">The correctness of the work will be evaluated by the logs Logs / log.txt (the path relative to the output build directory) of the logger NLog. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At the preliminary stage, the correlation rules are loaded:</font></font><br><br><pre> <code class="tex hljs">----- AirSIEM start ----- ParseRuleDir start ParseRulesFromXML handles file: test_webapp_rules.xml 3 rules processed: 100000, 100001, 100002 ParseRuleDir: total 1 files processed ParseRuleDir: total 3 rules processed ParseRuleDir stop</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> After the rules are loaded, the chains of rules are built: </font></font><br><br><pre> <code class="tex hljs">CheckDependencies start Dependencies: 100000 children =&gt; 100001 100001 children =&gt; 100002 100002 children =&gt; CheckDependencies stop</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next, queues are created to count the number of times that rules are triggered, the identifiers of which are found in the &lt;if_matched_sid&gt; elements. </font><font style="vertical-align: inherit;">The test set contains 3 rules, among which only one rule 100002 counts the responses of another rule - with identifier 100001. A queue is created for identifier 100001:</font></font><br><br><pre> <code class="tex hljs">GenerateQueueList start Created 1 queues: [100001, FireQueue object =&gt; ID=[100001], count=[0], timeFrame=[5 sec], maxSize=[1000]] GenerateQueueList stop</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Then, the subscriber is initialized and started, which ‚Äúlistens‚Äù to the AirSIEM_ConnectorQueue queue and passes the received messages to the handler: </font></font><br><br><pre> <code class="tex hljs">RabbitMQConsumer init RabbitMQConsumer start</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> After the first attempt of the attacker to pick up the username and password, the ApacheConnector connector sends the next line from the access server log of the web server to the RabbitMQ queue, the ‚Äúsubscriber‚Äù receives the message and sends it to the processing: </font></font><br><br><pre> <code class="tex hljs">RMQ message received: ApacheConnector:127.0.0.1 - - [01/Jan/2099:16:24:57 +0300] "GET /buggy/admin.php?username=1&amp;password...</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> From the message, a normalized security event is generated (an instance of the SecurityEvent class): </font></font><br><br><pre> <code class="tex hljs">SecurityEvent object =&gt; timestamp=[16:24:57], source=[127.0.0.1], destination=[], message=[GET /buggy/admin.php?username=1&amp;password=1 HTTP/1.1]</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next, the correlation kernel applies the loaded rules to the event being processed. </font><font style="vertical-align: inherit;">During the first ‚Äúpass‚Äù, only those rules are viewed whose operations do not depend on other rules:</font></font><br><br><pre> <code class="tex hljs">Check rule 100000 - Access to BUGGY webapp Check &lt;match&gt;/buggy/&lt;/match&gt; Rule 100000 matched ALERT: LEVEL 0 - Access to BUGGY webapp</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rule 100000 is triggered, a security incident is generated, a notification is sent to MongoDB and displayed in the administrator console (during debugging, we will display all alerts, even with zero severity level). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next, recursively look through the rules, the triggering of which depends on the triggering of rule 100000:</font></font><br><br><pre> <code class="tex hljs"> Check the child rules Check rule 100001 - Attempt to login to BUGGY webapp Check &lt;if_sid&gt;100000&lt;/if_sid&gt; Check &lt;match&gt;password&lt;/match&gt; Rule 100001 matched ALERT: LEVEL 0 - Attempt to login to BUGGY webapp Matched rule is queue tracked Enqueue item: FireQueueItem object =&gt; timestamp=[16:24:57], source=[127.0.0.1], destination=[] FireQueue object =&gt; ID=[100001], count=[1], timeFrame=[5 sec], maxSize=[1000] 1: FireQueueItem object =&gt; timestamp=[16:24:57], source=[127.0.0.1], destination=[] Check the child rules Check rule 100002 - Brute force trying to login to BUGGY webapp Check &lt;if_matched_sid&gt;100001&lt;/if_matched_sid&gt; QueueDictionary.CheckIfMatched start counter++ =&gt; counter=[1] counterSameSourceIP++ =&gt; counterSameSourceIP=[1] Rule 100001 QueueDictionary.CheckIfMatched == FALSE Rule 100002 not matched Check rule 100002: OK Check the child rules: OK Check rule 100001: OK Check the child rules: OK Check rule 100000: OK</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a result of processing, the rule 100001 is triggered, the first response is entered into the FireQueue's counting queue. </font><font style="vertical-align: inherit;">When the number of operations becomes equal to 3, one of the conditions for triggering the rule 100002 is executed. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let </font><font style="vertical-align: inherit;">us skip the </font><font style="vertical-align: inherit;">processing of the second access to the web application, we will immediately proceed to the third attempt to find the password:</font></font><br><br><pre> <code class="tex hljs">RMQ message received: ApacheConnector:127.0.0.1 - - [01/Jan/2099:16:25:02 +0300] "GET /buggy/admin.php?username=1&amp;password... SecurityEvent object =&gt; timestamp=[16:25:02], source=[127.0.0.1], destination=[], message=[GET /buggy/admin.php?username=1&amp;password=1 HTTP/1.1] Check rule 100000 - Access to BUGGY webapp Check &lt;match&gt;/buggy/&lt;/match&gt; Rule 100000 matched ALERT: LEVEL 0 - Access to BUGGY webapp Check the child rules Check rule 100001 - Attempt to login to BUGGY webapp Check &lt;if_sid&gt;100000&lt;/if_sid&gt; Check &lt;match&gt;password&lt;/match&gt; Rule 100001 matched ALERT: LEVEL 0 - Attempt to login to BUGGY webapp</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After the rule 100001 is triggered, it is checked whether the number of operations in any FireQueue counting queue is counted. </font><font style="vertical-align: inherit;">Indeed, for the rule identifier 100001, such a queue exists:</font></font><br><br><pre> <code class="tex hljs"> Matched rule is queue tracked Enqueue item: FireQueueItem object =&gt; timestamp=[16:25:02], source=[127.0.0.1], destination=[] FireQueue object =&gt; ID=[100001], count=[3], timeFrame=[5 sec], maxSize=[1000] 1: FireQueueItem object =&gt; timestamp=[16:24:57], source=[127.0.0.1], destination=[] 2: FireQueueItem object =&gt; timestamp=[16:25:01], source=[127.0.0.1], destination=[] 3: FireQueueItem object =&gt; timestamp=[16:25:02], source=[127.0.0.1], destination=[]</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the counting queue, 3 triggerings of rule 100001 were recorded during a timeframe time interval (5 seconds). </font><font style="vertical-align: inherit;">Security event processing continues:</font></font><br><br><pre> <code class="tex hljs"> Check the child rules Check rule 100002 - Brute force trying to login to BUGGY webapp Check &lt;if_matched_sid&gt;100001&lt;/if_matched_sid&gt;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At this point, the number of triggerings of rule 100001 is checked. Since the &lt;same_source_ip /&gt; element was present in the description of the rule, the triggerings with the same source IP address are simultaneously counted:</font></font><br><br><pre> <code class="tex hljs"> QueueDictionary.CheckIfMatched start counter++ =&gt; counter=[1] counterSameSourceIP++ =&gt; counterSameSourceIP=[1] counter++ =&gt; counter=[2] counterSameSourceIP++ =&gt; counterSameSourceIP=[2] counter++ =&gt; counter=[3] counterSameSourceIP++ =&gt; counterSameSourceIP=[3] Rule 100001 QueueDictionary.CheckIfMatched == TRUE Rule 100002 matched ALERT: LEVEL 1 - Brute force trying to login to BUGGY webapp Check rule 100002: OK Check the child rules: OK Check rule 100001: OK Check the child rules: OK Check rule 100000: OK</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rule 100002 is triggered, the core correlation detects a brute-force attack scenario and generates a corresponding security incident. Incident information is sent to the MongoDB data warehouse. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Step 5. Checking the data warehouse.</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Check the formation of alerts. To do this, we connect to MongoDB with the help of Robomongo and view the collection of alerts documents in the AirSIEM database. The collection must be non-empty. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Step 6. Modeling security administrator actions.</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Open the security administration console in your browser at: ‚Äúhttp://127.0.0.1/console/index.php‚Äù. If all components of the SIEM system are configured correctly, after executing the test script, the console window should look like this:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/p3/9l/7o/p39l7o3orefawgfbgwd_fou9lhk.png" alt="   SIEM "></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We emphasize that not only individual events were detected, but the sequence of actions of the attacker was highlighted and the attack script was identified. </font><font style="vertical-align: inherit;">In the administrator console, this is line number 7, highlighted in color, with a message about the detected implementation of a brute-force attack scenario. </font><font style="vertical-align: inherit;">The time stamp 16:25:03 is set by the correlation core, the value differs from the time stamp of the event corresponding to the third attempt to gain access by the attacker (16:25:02). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If zero-level alerts are considered as false positives, you can disable their output to the console. </font><font style="vertical-align: inherit;">And thereby reducing the burden on the operator.</font></font><br><br>  <b>Results</b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Security administrator notified of suspicious activity of the attacker. </font><font style="vertical-align: inherit;">The system developed by SIEM has completed the task.</font></font> A curtain. <br><br><h2>  Conclusions and Conclusion </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The materials of the lesson deal with the construction of modern security incident management systems (SIEM) on the example of developing their own SIEM solution. The possibilities of practical application of the developed system in the conditions of monitoring the security of the protected web application are demonstrated: a brute-force attack scenario was successfully detected, an incident was generated, and the administrator was notified. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is necessary to agree that the given example is rather primitive and does not reflect many architectural and functional features of SIEM systems as a class of information security tools. The attentive reader will correctly note that the final solution is more like WAF than SIEM.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition, the authors doubt the industrial applicability of open-source SIEM solutions and agree with most of the positions with the opinion of Anton Chuvakin - </font></font><a href="http://chuvakin.blogspot.ru/2009/06/why-no-open-source-siem-ever.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúWhy No Open Source SIEM, EVER?‚Äù</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At the same time, the authors are confident that familiarity with SIEM systems using simple and clear examples (including code examples) will help researchers to understand the subject area in detail and, perhaps, inspire new discoveries. And let the number of information security incident management professionals grow! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">All source codes of the projects used are available on GitHub in </font></font><a href="https://github.com/fisher85/AirSIEM"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the AirSIEM</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> open </font><a href="https://github.com/fisher85/AirSIEM"><font style="vertical-align: inherit;">repository</font></a><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The authors will be glad to cooperate, all comments, comments and suggestions. </font><font style="vertical-align: inherit;">Thank you for your attention, the main part of the lesson is complete, ready to answer your questions.</font></font></div><p>Source: <a href="https://habr.com/ru/post/353542/">https://habr.com/ru/post/353542/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353530/index.html">How to pass the test MTCNA (Mikrotik) at 100%</a></li>
<li><a href="../353532/index.html">GDPR. Practical advice</a></li>
<li><a href="../353534/index.html">Docker images with GOST-certificates support in openssl, curl, php, nginx</a></li>
<li><a href="../353536/index.html">How IaaS helps develop the car market</a></li>
<li><a href="../353540/index.html">The digest of interesting materials for the mobile developer # 249 (April 9 - April 15)</a></li>
<li><a href="../353546/index.html">JupyterHub, or how to manage hundreds of Python users. Yandex lecture</a></li>
<li><a href="../353548/index.html">[Yekaterinburg, Announcement] UralJS # 7 - three reports on React Native, convenient navigation in the SPA and the principles of working with DateTime</a></li>
<li><a href="../353550/index.html">Microsoft Exchange Server Development Basics</a></li>
<li><a href="../353552/index.html">Reactive programming in Objective-C</a></li>
<li><a href="../353554/index.html">Improving Redux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>