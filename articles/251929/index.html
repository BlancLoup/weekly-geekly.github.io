<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Detection of mobile malware in the wild</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Smartphones are increasingly penetrating our lives, for many people they have become an indispensable everyday companion. These gadgets give us connec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Detection of mobile malware in the wild</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/78e/bf6/54a/78ebf654a83a4d4783b9e624db5feb54.jpg"><br><br>  Smartphones are increasingly penetrating our lives, for many people they have become an indispensable everyday companion.  These gadgets give us connections with other people and entertain us.  We trust them with more and more confidential and personal information, and it is not surprising that attackers are paying ever closer attention to the mobile segment.  Since 2004, when Kaspersky Lab <a href="http://www.kaspersky.com/news%3Fid%3D149499226%26ClickID%3Dbqudy66lygnevduqyvsyenmsqgsmqsmesgdg">detected the</a> first network mobile worm Cabir, more and more new malware samples appear every year.  Accordingly, the development of methods for detecting malware ‚Äúin the wild‚Äù, that is, in mobile app stores, is becoming increasingly relevant. <br><a name="habracut"></a><br><h3>  What is malware? </h3><br>  Malicious software (malware) is called an application designed to carry out all sorts of illegal actions.  This includes viruses, botnets, worms, trojans, etc.  Today, malware is widely used to extract profits from all sorts of ways, from stealing bank accounts to direct extortion.  And in this shadow business big money is spinning, which attracts more and more new participants. <br><br>  Malware detection technologies in ‚Äúlarge‚Äù operating systems are already quite diverse and very effective.  However, the mobile segment in the information security industry is still in its infancy. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In addition to malware, two more categories of threats for mobile devices should be mentioned - spyware (spyware) and conditionally malicious software (grayware).  Spyware applications collect information about his movements, SMS-messaging, call history, etc. secretly from the user.  In the strict sense, if spyware does not send information collected somewhere, then it cannot be called illegal.  But the fact of installation without the knowledge of the user of such an application can not be called ethical. <br><br>  Conditionally harmful software is much more harmless than the "classic", but at the same time quite annoying.  For example, a program belonging to a similar class may change the system fonts or their color, or give all sorts of ridiculous and mocking messages.  In general, by analogy with human society, conditionally-harmful software is a petty bully, a dirty dog.  We can say that grayware is on the edge of legality: the authors usually do not hide their intentions and give a description of the functionality of their software, but users usually press the ‚ÄúI agree‚Äù button without reading the terms of the license agreement. <br><br>  Many security professionals prefer to classify malware based on behavioral patterns and the motivation of their authors.  Below are the most important views: <br><br><ul><li>  Offering users all kinds of new items and entertainment.  Usually such software is developed for the purpose of entertaining the author himself and demonstrating his skills, mainly with the help of senseless destructive actions on the victim's device.  Example: <a href="http://www.symantec.com/security_response/writeup.jsp%3Fdocid%3D2011-033008-4831-99">Android.Walkinwat</a> </li><li>  Trading user information.  Such applications secretly collect data about the user's location, installed applications, download history and contact list contents.  For this information there is a steady demand from advertisers and marketers.  Example: <a href="http://blog.trendmicro.com/trendlabs-security-intelligence/analysis-of-droiddreamlight-android-malware/">DroidDreamLight</a> </li><li>  Stealing financial information.  Most often these are accounts to bank accounts.  Intercepted text messages, recorded all the buttons pressed, apply phishing attacks.  Example: <a href="https://www.f-secure.com/v-descs/worm_iphoneos_ikee_b.shtml">Ikee.B</a> </li><li>  Manipulating the delivery of various content.  Such software is intended for personal calls and SMS sending with technical support offers, stock reports, intimate services, etc.  Example: <a href="http://www.symantec.com/security_response/writeup.jsp%3Fdocid%3D2010-081100-1646-99">FakePlayer</a> </li><li>  Send SMS spam.  From the number of the victim begins sending spam, usually containing advertising and phishing links.  Example: <a href="http://www.symantec.com/security_response/writeup.jsp%3Fdocid%3D2011-010111-5403-99">Geinimi</a> </li><li>  Manipulating search results.  Artificially raise various sites in search results.  Example: <a href="https://blog.lookout.com/blog/2011/02/15/security-alert-hongtoutou-new-android-trojan-found-in-china/">Hong Tou Tou</a> </li></ul><br><h3>  Ways to detect malware </h3><br>  Each of the existing methods for determining mobile malware has its own advantages and disadvantages. <br><br>  <b>Static code analysis</b> <br>  This is a fast and low-cost method.  It consists in searching for malicious characteristics or suspicious pieces of code without launching the application.  The techniques shown below are widely used for preliminary analysis when you first need to test a suspicious application for the most obvious malicious functionality. <br><br><img src="https://habrastorage.org/files/f2a/372/ca9/f2a372ca91d44e3d86f33cde9d5015f5.jpg"><br><br>  The first two branches are typical for detecting malware on Symbian OS and iOS, so we‚Äôll omit its description.  We are interested in the third branch of the scheme, which describes the algorithm of actions for Android.  Using the <a href="http://siis.cse.psu.edu/ded/">decompiler</a> , the source code of the application is generated.  Further, it is subjected to static analysis by tools from the <a href="http://www8.hp.com/us/en/software-solutions/application-security/index.html">Fortify SCA</a> software package.  The disadvantages of this technique include the fact that, in general, it is only suitable for analyzing applications with a relatively small number of access rights and API calls. <br><br>  <b>Dynamic code analysis</b> <br>  In contrast to static, dynamic analysis involves the execution of an application in an isolated environment.  For example, inside a virtual machine or emulator, so that you can monitor the behavior of the application.  Most often, dynamic analysis is used when tracing system calls or taint-tracking. <br><br>  For a dynamic system-wide taint analysis, you can use the <a href="https://github.com/TaintDroid">TaintDroid</a> tool.  The illustration below shows how an application is first sent to a virtual machine, where it is evaluated at four levels: variables, methods, messages, and files.  During taint-tracking, any data requests from the geolocation module, microphone, camera, etc.  This method implies that all native libraries are called only from a virtual machine, and not directly.  Finally, dynamic analysis identifies potential data leaks before information is transferred from the system to the network interface. <br><br><img src="https://habrastorage.org/files/6bd/ea2/6fa/6bdea26fab4143eab3690ab2d13e0919.jpg"><br><br>  Testing of many popular Android applications from third-party developers has shown that a significant number of them send information on the location of users to advertising companies.  Some even send phone IDs to remote servers.  However, TaintDroid can produce both false-negative and false-positive analysis results.  In addition, this tool allows you to analyze only one type of vulnerabilities - data streams. <br><br>  The second part of the illustration shows a two-step analysis system for Android applications using the sandbox (AASandbox).  In it, binary files are first disassembled, and in the <a href="http://code.google.com/p/smali/">resulting code</a> a search is made for characteristic patterns.  Then, during the dynamic analysis, the application is executed in the Android emulator, and all system calls are recorded in the log.  If it is not possible to take real user-generated input data, then you can use the Android Monkey tool (ADB Monkey). <br><br>  <b>Application Access Analysis</b> <br>  In mobile applications, access rights play a key role: they show the user the intentions of the application and the activity of the backend.  In smartphones, access rights are explicitly set, so application authors should also explicitly request them.  However, some deliberately hide the rights used by the application, which leads to the appearance of vulnerabilities. <br><br>  Below is a diagram of the tool for analyzing the permissions of Android applications, Kirin.  During the installation of the application being studied, it retrieves the security settings and verifies them with the existing security policy.  If the application fails validation, then Kirin warns the user, or even deletes the application. <br><br><img src="https://habrastorage.org/files/507/454/e61/507454e618244dc4807fdef0d642c722.jpg"><br><br>  Kirin security policy example: <br><br> <code>An application must not have PHONE_STATE,RECORD_AUDIO, and INTERNET permission labels'</code> <br> <br>  This rule prohibits the application to record audio or access the Internet while the user is on the phone.  This avoids telephone tapping. <br><br>  A <a href="http://static.usenix.org/events/webapps11/tech/final_files/Felt.pdf">study of</a> 100 paid and 856 free Android applications conducted in 2011 showed that about 93% of free and 82% of paid ones request obtaining at least one potentially dangerous access right.  Among them, the most common was a request for network access, even if the purpose of the application did not imply its use. <br><br>  The disadvantages of Kirin include the fact that the analysis of requests for rights is not enough to detect malware, it is an auxiliary tool that must be used simultaneously with static or dynamic code analysis. <br><br>  <b>Analysis using cloud services</b> <br>  Obviously, the smartphone will not be able to fully analyze suspicious applications due to the limited resources of the device itself.  A simple file scan will take a lot of time and ‚Äúeat‚Äù a noticeable fraction of the battery charge.  One way to solve this problem is to analyze using cloud services. <br><br>  The following illustration shows a diagram of the operation of Paranoid Android, a cloud service for protection against malicious software.  The advantage is obvious - all computational and analytical operations are carried out not on the user device, but in the emulators on remote servers.  On the smartphone, only the tracer works, which records all the information necessary for the analysis of the application operation.  Then the tracer sends data to the cloud emulator.  It can carry out several different checks, including dynamic analysis, memory scanning, detection of suspicious system calls and anti-virus scanning. <br><br><img src="https://habrastorage.org/files/d32/45f/ce8/d3245fce8bad4c8abe0df475c96b61e3.jpg"><br><br>  For the temporary storage of incoming traffic, Paranoid Android uses a proxy, which saves the battery power of the smartphone and does not send the same data to the server.  He can directly contact the proxy and get the necessary data to emulate the analyzed application.  Nevertheless, the use of RA for the analysis of "heavy" applications still significantly increases the power consumption and the load on the processor.  And since the tracer works in the user environment, system calls load the processor much more than the native code execution.  Conventionally, the trace of the read () system call takes 0.7 milliseconds in the user environment, and 0.1 in the kernel. <br><br>  The right half of the previous illustration shows a diagram of Crowdroid, a tool for analyzing application behavior.  This is a lightweight client application that monitors system calls initiated by a monitored application, pre-processes them, and sends them to the cloud.  And there already using clustering determines whether the application is malicious or not.  Unfortunately, Crowdroid has false positive results if there is very little data to analyze. <br><br>  <b>Battery consumption monitoring</b> <br>  Higher, compared with peers, energy consumption when running an application can be an indirect evidence of harmfulness.  Of course, this works if the user‚Äôs behavior, battery condition, signal level, network traffic volume and other parameters are well known. <br><br>  <b>Mobile Malware Protection Tips</b> <br>  Given the limited computing and energy resources of smartphones, it can be assumed that in the future, the protective functionality will be mainly represented by cloud services.  With the development of payment systems based on NFC, we can also expect the emergence of malicious software aimed specifically at stealing payment data through this channel.  Surely there will be attempts to obtain bank card details using reverse engineering applications for payments through NFC.  Such threats must be prevented in advance, for example, by using strong encryption and admitting a limited number of developers to create payment software. <br><br>  But despite the development of tools to identify malware and protect their devices, it is best to avoid infection and its consequences altogether.  After all, our own negligence and lack of caution can lead to very poor results.  Therefore, it is better to follow the tips below: <br><br><ul><li>  Install a good protective application that will protect against attacks and alert you if you detect suspicious application activity. </li><li>  Download applications only from trusted sources. </li><li>  Before installing it is better to read the reviews and see the rating, even if you have heard a lot about the author of the application. </li><li>  Always carefully read the list of requested permissions.  If there are any suspicions, it is better to refuse installation.  You can also leave a comment that will alert other users. </li><li>  If you currently do not need Wi-Fi, Bluetooth and other wireless modules, turn them off.  So it will be safer, and the battery will live longer.  Connect to public access points with care: activate the firewall in advance, turn off file sharing and use SSL or VPN. </li><li>  Regularly update your applications, as well as the firmware of your smartphone. </li><li>  Use encryption to store all important data stored on your smartphone.  Also do not forget to make regular backups.  Make sure that critical information is not cached anywhere. </li><li>  Wherever possible, put passwords to access important files and applications. </li><li>  Do not follow suspicious or untrusted links.  If you still really need, it is better to type the address manually, and do not copy and paste into the browser.  This will protect against attacks using shadow boot. </li><li>  Regularly monitor battery consumption, sent SMS and call log.  Any oddities should be considered as a reason to check the entire system, especially recently installed applications. </li><li>  Finally, if the smartphone has been lost or stolen, erase all applications, contacts and confidential information remotely.  And also block the device itself. </li></ul><br><br>  In general, it is highly unlikely that truly serious malware will be evaluated falsely positively.  So following the above tips will surely protect you from various troubles, be vigilant and careful in the open spaces of the network.  We, in turn, are preparing various solutions for the information protection of our smartphones, read about it in one of the next publications. </div><p>Source: <a href="https://habr.com/ru/post/251929/">https://habr.com/ru/post/251929/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../251917/index.html">Crucial moment. Bank of England makes its bitcoin</a></li>
<li><a href="../251919/index.html">Big pitfalls of a small controller</a></li>
<li><a href="../251921/index.html">New server park Fujitsu</a></li>
<li><a href="../251923/index.html">Cubieboard customization highlights with linux</a></li>
<li><a href="../251927/index.html">PHP and Erlang interaction through RabbitMQ</a></li>
<li><a href="../251931/index.html">We test content distribution in GlusterFS</a></li>
<li><a href="../251933/index.html">The magic of one div. Masterclass from the creator of a.singlediv.com</a></li>
<li><a href="../251935/index.html">Ciklum Dnepropetrovsk C ++ Saturday: The first subbotnik of the year for C ++ fans is happy to meet everyone</a></li>
<li><a href="../251937/index.html">Reading GATT-characteristics of a Bluetooth device</a></li>
<li><a href="../251939/index.html">We use web application downtime for background tasks.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>