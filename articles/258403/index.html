<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Migrating from symfony 2.0 to 2.6</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, I would like to talk about some of the nuances that I had to go through to migrate a project from outdated Symfony 2.0 to the current...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Migrating from symfony 2.0 to 2.6</h1><div class="post__text post__text-html js-mediator-article">  In this article, I would like to talk about some of the nuances that I had to go through to migrate a project from outdated Symfony 2.0 to the current Symfony 2.6. <br><br><h5>  Dependency manager </h5><br>  Each symfony project has its own dependencies (bundles).  In version 2.0, dependencies were specified in the deps file and were pulled up by the command: <br><br><pre><code class="bash hljs">php bin/vendors install</code> </pre> <br>  Now for these purposes it is important to use Composer. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Download Composer to the repository root: <br><a name="habracut"></a><br><pre> <code class="bash hljs">php -r <span class="hljs-string"><span class="hljs-string">"readfile('https://getcomposer.org/installer');"</span></span> | php</code> </pre><br><br>  Then we create the composer.json file in the project root with the following content: <br>  <a href="">github.com/symfony/symfony/blob/2.6/composer.json</a> <br>  And execute the command: <br><br><pre> <code class="bash hljs">php composer.phar update</code> </pre><br>  After that, Symfony 2.6 with all the dependencies needed for it will be pulled to our project and a composer.lock file will be created, which will contain the current versions of the downloaded dependencies. <br><br>  All we have to do is add the dependencies we need to the composer.json file.  This can be done manually by editing the file: <br><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">"require"</span></span>: { <span class="hljs-string"><span class="hljs-string">"{ }"</span></span>:<span class="hljs-string"><span class="hljs-string">"{ }"</span></span> },</code> </pre><br>  Or using the command: <br><br><pre> <code class="bash hljs">php composer.phar require { }:{ }</code> </pre><br>  Now we have all the necessary bundles and we can delete the deps and deps.lock files, but for the framework to work correctly, we should also update the web / app.php and web / app_dev.php files: <br><br><h6>  app.php </h6><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">ClassLoader</span></span>\<span class="hljs-title"><span class="hljs-title">ApcClassLoader</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">HttpFoundation</span></span>\<span class="hljs-title"><span class="hljs-title">Request</span></span>; $loader = <span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span> <span class="hljs-keyword"><span class="hljs-keyword">__DIR__</span></span>.<span class="hljs-string"><span class="hljs-string">'/../app/bootstrap.php.cache'</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Enable APC for autoloading to improve performance. // You should change the ApcClassLoader first argument to a unique prefix // in order to prevent cache key conflicts with other applications // also using APC. /* $apcLoader = new ApcClassLoader(sha1(__FILE__), $loader); $loader-&gt;unregister(); $apcLoader-&gt;register(true); */ require_once __DIR__.'/../app/AppKernel.php'; //require_once __DIR__.'/../app/AppCache.php'; $kernel = new AppKernel('prod', false); $kernel-&gt;loadClassCache(); //$kernel = new AppCache($kernel); // When using the HttpCache, you need to call the method in your front controller instead of relying on the configuration parameter //Request::enableHttpMethodParameterOverride(); $request = Request::createFromGlobals(); $response = $kernel-&gt;handle($request); $response-&gt;send(); $kernel-&gt;terminate($request, $response);</span></span></code> </pre><br><h6>  app_dev.php </h6><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">HttpFoundation</span></span>\<span class="hljs-title"><span class="hljs-title">Request</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Symfony</span></span>\<span class="hljs-title"><span class="hljs-title">Component</span></span>\<span class="hljs-title"><span class="hljs-title">Debug</span></span>\<span class="hljs-title"><span class="hljs-title">Debug</span></span>; <span class="hljs-comment"><span class="hljs-comment">// If you don't want to setup permissions the proper way, just uncomment the following PHP line // read http://symfony.com/doc/current/book/installation.html#configuration-and-setup for more information //umask(0000); // This check prevents access to debug front controllers that are deployed by accident to production servers. // Feel free to remove this, extend it, or make something more sophisticated. if (isset($_SERVER['HTTP_CLIENT_IP']) || isset($_SERVER['HTTP_X_FORWARDED_FOR']) || !(in_array(@$_SERVER['REMOTE_ADDR'], array('127.0.0.1', 'fe80::1', '::1')) || php_sapi_name() === 'cli-server') ) { header('HTTP/1.0 403 Forbidden'); exit('You are not allowed to access this file. Check '.basename(__FILE__).' for more information.'); } $loader = require_once __DIR__.'/../app/bootstrap.php.cache'; De</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">bug:</span></span></span><span class="hljs-comment">:enable(); require_once __DIR__.'/../app/AppKernel.php'; $kernel = new AppKernel('dev', true); $kernel-&gt;loadClassCache(); $request = Request::createFromGlobals(); $response = $kernel-&gt;handle($request); $response-&gt;send(); $kernel-&gt;terminate($request, $response);</span></span></code> </pre><br><h5>  Options </h5><br>  For the symfony 2.0 version, the parameters were loaded from the file app / config / parameters.ini.  All we need is to rename it to app / config / parameters.yml and bring it to the yml file: <br><br>  Before: <br><br><pre> <code class="php hljs">[parameters] locale = en</code> </pre><br>  After: <br><br><pre> <code class="php hljs">parameters: locale: en</code> </pre><br>  Then in app / config / config.yml we will write the path for our file: <br><br><pre> <code class="php hljs">imports: - { resource: parameters.yml }</code> </pre><br>  Parameters changed and connected. <br><br><h5>  Backward compatibility </h5><br>  There are quite a few changes from version 2.0 to 2.6, I would like to tell only about some of them. <br><br><h6>  Forms: </h6><br>  Some functions now raise exceptions if they are used on a form already submitted: <br><pre> <code class="php hljs">add(), remove(), setParent(), bind() <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> setData()</code> </pre><br><br>  You can call them from the listener in formBuilder just before submitting the form, or slightly change the logic of your form.  But as a temporary measure, you can use the following code: <br><br><pre> <code class="php hljs">$formData = $form-&gt;getData(); $form = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;createForm(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> YourForm()); $form-&gt;setData($formData);</code> </pre><br>  After we have re-created the form and transferred all the parameters from the old form to it, we can use all the functions on it that could not be used on the already submitted form. <br><br><h6>  Validation of Forms: </h6><br>  Instead of using the FormBulder's defunct CallbackValidation class, we simply use an EventListener after the form has already been submitted.  POST_SUBMIT. <br><br>  Before: <br><br><pre> <code class="php hljs"> $builder-&gt;addValidator(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CallbackValidator(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FormInterface $form)</span></span></span><span class="hljs-function"> </span></span>{ $value = $form[<span class="hljs-string"><span class="hljs-string">'date'</span></span>]-&gt;getData(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($value != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { $form[<span class="hljs-string"><span class="hljs-string">'date'</span></span>]-&gt;addError(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FormError(<span class="hljs-string"><span class="hljs-string">'  '</span></span>)); } }));</code> </pre><br>  After: <br><br><pre> <code class="php hljs"> $builder-&gt;addEventListener(FormEvents::POST_SUBMIT, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FormEvent $event)</span></span></span><span class="hljs-function"> </span></span>{ $form = $event-&gt;getForm(); $value = $form[<span class="hljs-string"><span class="hljs-string">'date'</span></span>]-&gt;getData(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($value != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { $form[<span class="hljs-string"><span class="hljs-string">'date'</span></span>]-&gt;addError(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FormError(<span class="hljs-string"><span class="hljs-string">'  '</span></span>)); } });</code> </pre><br><br><h6>  Adding your option in the form field </h6><br>  When creating your option in the form field MyBundle \ Forms \ ExtensionExtensionForm.php;  It is necessary to specify for which type of fields these options will be added: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getExtendedType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'text'</span></span>; }</code> </pre><br>  If we want to add them for all field types, you must specify: <br><br><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getExtendedType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'form'</span></span>; }</code> </pre><br><h4>  Full list of changes </h4><br>  <a href="">github.com/symfony/symfony/blob/2.7/UPGRADE-2.1.md</a> <br>  <a href="">github.com/symfony/symfony/blob/2.7/UPGRADE-2.2.md</a> <br>  <a href="">github.com/symfony/symfony/blob/2.7/UPGRADE-2.3.md</a> <br>  <a href="">github.com/symfony/symfony/blob/2.7/UPGRADE-2.4.md</a> <br>  <a href="">github.com/symfony/symfony/blob/2.7/UPGRADE-2.5.md</a> <br>  <a href="">github.com/symfony/symfony/blob/2.7/UPGRADE-2.6.md</a> <br><br>  Official symfony documentation: <a href="http://symfony.com/doc/current/cookbook/index.html">symfony.com/doc/current/cookbook/index.html</a> </div><p>Source: <a href="https://habr.com/ru/post/258403/">https://habr.com/ru/post/258403/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258391/index.html">"Curse" braces</a></li>
<li><a href="../258393/index.html">The best students from all over the world take part in the ‚ÄúIntellect Battle‚Äù World Programming Championship</a></li>
<li><a href="../258395/index.html">When should we expect the apocalypse of network infrastructure?</a></li>
<li><a href="../258397/index.html">Parsing formats: sound package in the Unreal Engine</a></li>
<li><a href="../258399/index.html">How to create artificial intelligence? The second story. Algorithms for intelligent search and storage of information</a></li>
<li><a href="../258405/index.html">Semantic Web Technologies</a></li>
<li><a href="../258407/index.html">Minimal mail server based on Postfix and Dovecot. Part 2: Postfix</a></li>
<li><a href="../258409/index.html">Day of Universal Accessibility Awareness (GAAD) 2015</a></li>
<li><a href="../258411/index.html">GammaRay - a means of introspection Qt-applications</a></li>
<li><a href="../258413/index.html">Luwrain - a working environment for people with visual impairments</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>