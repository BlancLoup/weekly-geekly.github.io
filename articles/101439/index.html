<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ShopStyle</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For unclear reasons, the post disappeared from the official blog a few hours after publication, and the content from the demo site was also removed. L...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ShopStyle</h1><div class="post__text post__text-html js-mediator-article">  <i>For unclear reasons, the post disappeared from the official blog a few hours after publication, and the content from the demo site was also removed.</i>  <i>Later, the blog entry appeared again, but with the message that the application will be available soon</i> <br><br> <a href="http://www.shopstyleapp.com/"><img align="right" src="http://www.sencha.com/blog/wp-content/uploads/2010/08/hero-ipad-portrait.png" width="216" height="314"></a>  Today, the Sencha development team announces the release of a new demo application based on their library: <a href="http://www.shopstyleapp.com/">ShopStyle</a> .  ShopStyle is a classic iPhone and iPad app that is part of the PopSugar portal.  The presented application was developed at the Sencha Touch library and uses one of the innovations: Touch Carousel.  In particular, there is the ‚Äúendless carousel‚Äù, one of the new features that is part of the Sencha Touch.  The most important feature of this component is the active DOM management which allows the application to fit into the memory limitations existing on the iPad. <br><br>  Of course, you can explore the source code on the site, and in this article the most interesting technical points in the creation of this application will be considered.  The main problem is that in one category there may be thousands of products.  Downloading all this data into the browser‚Äôs memory at once is a guaranteed file. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Creating a carousel </h3><br>  A carousel can process thousands of items using a sliding viewport that displays data.  Three areas with content are created for the current page: current, previous and next.  While the user scrolls through the corresponding areas are created and destroyed, which ensures that the content matches the current state.  This ensures that at any point in the carousel there is a fairly small fixed number of elements, despite the fact that their actual number can be huge.  In the diagram below, the sliding area consists of three pages.  Initially the third page is focused and pages two through four are initialized.  When the user moves to the fourth page, the active area is shifted to the right, and the second page is also deleted and the fifth page is created. <br><br><div style="text-align:center;"><img src="http://www.sencha.com/blog/wp-content/uploads/2010/08/slidingwindow.png"></div><br>  Initialization of the carousel is elementary.  Instead of directly using the <em>items</em> parameter, a <em>createItem</em> is defined that accepts a function.  when it is necessary to initialize the element, the function with the index of the element will be called.  The function creates and returns an element.  To demonstrate this, there is a small piece of code with a normal and infinite carousel. <br><br><blockquote><code><font color="black"><font color="#008000">// Normal carousel</font> <br> <font color="#0000ff">var</font> carousel = <font color="#0000ff">new</font> Ext.Carousel({ <br> items: [{ <br> html: <font color="#A31515">'1'</font> <br> },{ <br> html: <font color="#A31515">'2'</font> <br> }, { <br> html: <font color="#A31515">'3'</font> <br> }] <br> }); <br> <br> <font color="#008000">// Infinite carousel</font> <br> <font color="#0000ff">var</font> carousel = <font color="#0000ff">new</font> SS.BufferedCarousel({ <br> itemCount: 3, <br> createItem: <font color="#0000ff">function</font> (index) { <br> <font color="#0000ff">return</font> {html: (i+1)+ <font color="#A31515">''</font> }; <br> } <br> });</font></code> </blockquote> <br>  In principle, the sliding area is quite simple.  At initialization and each time when the scope changes, the sliding area is updated. <br><br><blockquote> <code><font color="black">bufferCards: <font color="#0000ff">function</font> (index) { <br> <font color="#008000">// Quick return if there is nothing to do</font> <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .lastBufferedIndex == index) { <font color="#0000ff">return</font> ; } <br> <font color="#0000ff">this</font> .lastBufferedIndex = index; <br> <br> <font color="#008000">// Initialize variables</font> <br> <font color="#0000ff">var</font> <br> <font color="#008000">// size of the window</font> <br> bufferSize = <font color="#0000ff">this</font> .bufferSize, <br> <font color="#008000">// constrained start index of the window</font> <br> start = (index-bufferSize).constrain(0, <font color="#0000ff">this</font> .itemCount-1), <br> <font color="#008000">// constrained end index of the window</font> <br> end = (index+bufferSize).constrain(0, <font color="#0000ff">this</font> .itemCount-1), <br> items = <font color="#0000ff">this</font> .items, <br> <font color="#008000">// flag to determine if any items were added/removed</font> <br> changed = <font color="#0000ff">false</font> , <br> <font color="#008000">// will be set to the item where its position == index</font> <br> activeCard; <br> <br> <font color="#008000">// make sure the index is within bounds</font> <br> index = index.constrain(0, <font color="#0000ff">this</font> .itemCount-1); <br> <br> <font color="#008000">// cull existing items</font> <br> <font color="#0000ff">var</font> i = 0; <br> <font color="#0000ff">while</font> (i &lt; items.length) { <br> <font color="#0000ff">var</font> item = items.get(i), <br> itemIndex = item.carouselPosition; <br> <br> <font color="#0000ff">if</font> (itemIndex end) { <br> <font color="#0000ff">this</font> .remove(item, <font color="#0000ff">true</font> ); <br> changed = <font color="#0000ff">true</font> ; <br> } <br> <font color="#0000ff">else</font> { <br> i++; <br> } <br> } <br> <br> <font color="#008000">// function to create a card and add to the carousel</font> <br> <font color="#0000ff">var</font> createCard = <font color="#0000ff">function</font> (carouselPos, layoutPos) { <br> <font color="#0000ff">var</font> card = <font color="#0000ff">this</font> .createItem(i); <br> <font color="#0000ff">if</font> (card) { <br> card.carouselPosition = carouselPos; <br> <font color="#0000ff">if</font> (layoutPos != <font color="#0000ff">null</font> ) { <br> <font color="#0000ff">this</font> .insert(layoutPos, card); <br> } <br> <font color="#0000ff">else</font> { <br> <font color="#0000ff">this</font> .add(card); <br> } <br> <font color="#0000ff">if</font> (carouselPos == index) { <br> activeCard = card; <br> } <br> changed = <font color="#0000ff">true</font> ; <br> } <br> }; <br> <br> <font color="#008000">// add new items</font> <br> <font color="#0000ff">if</font> (items.length) { <font color="#008000">// if existing items, add to the left and right</font> <br> <font color="#0000ff">var</font> first = items.first().carouselPosition, <br> last = items.last().carouselPosition; <br> <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = first-1; i&gt;=start; i--) { <br> <font color="#0000ff">if</font> (i &gt;= 0) { <br> createCard.call( <font color="#0000ff">this</font> , i, 0); <br> } <br> } <br> <br> <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = last+1; i&lt;=end; i++) { <br> createCard.call( <font color="#0000ff">this</font> , i); <br> } <br> } <br> <font color="#0000ff">else</font> { <font color="#008000">// if no existing items, just add cards</font> <br> <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = start; i= 0) { <br> createCard.call( <font color="#0000ff">this</font> , i); <br> } <br> } <br> } <br> <br> <font color="#008000">// if changed, make sure the layout is updated</font> <br> <font color="#008000">// also, update the active item if needed</font> <br> <font color="#0000ff">if</font> (changed) { <br> <font color="#0000ff">this</font> .doLayout(); <br> <br> <font color="#0000ff">var</font> activeItem = <font color="#0000ff">this</font> .layout.getActiveItem(); <br> <font color="#0000ff">if</font> (activeCard &amp;&amp; activeItem != activeCard) { <br> <font color="#0000ff">this</font> .layout.setActiveItem(activeCard); <br> } <br> } <br> }</font></code> </blockquote> <br><h3>  Data Acquisition and Caching </h3><br>  ShopStyle provides an API that allows you to receive and filter products from a category.  There is also the possibility of obtaining parts of the data that is necessary for the implementation of paging.  The developers wanted to have direct access to the data, as well as to avoid problems caused by receiving data from the network, which meant caching images. <br><br>  For these purposes, a DataCache class has been created to simplify the retrieval of data and the caching of product data.  At its core, DataCache contains a simple ‚ÄúgetItems‚Äù function that accepts a range of products as well as a callback function to process data about goods after they are received, it also has some simple processing to avoid identical requests and directly returns data that has already been received.  As a result, caching becomes elementary ‚Äî all that is needed is to call getItems with a range of products.  This process is depicted in the diagram: <br><br><div style="text-align:center;"><img src="http://www.sencha.com/blog/wp-content/uploads/2010/08/datacacheseq.png" width="442" height="482"></div><br>  When <em>getItems</em> is called for the first 100 items, a request is sent to ShopStyle.  In subsequent <em>getItems</em> requests for elements 1-10 and 11-20, the application determines that this data is already being requested and does not send additional requests to the API.  When a reply comes, the corresponding callback function is called.  The subsequent call to <em>getItems</em> for elements 21-30 immediately calls the inverse function, since the data has already been received. <br><br><h3>  XTemplate </h3><br>  When displaying products, each page displays 8 or 9 (depending on orientation) elements in the grid layout.  In most cases, floating elements are used, but the developers wanted to go a little different way and use the features of CSS3: <br><br><blockquote> <code><font color="black">SS.PagedCarousel.Indicator = Ext.extend(Ext.Component, { <br> baseCls: <font color="#A31515">"ss-pagedCarousel-indicator"</font> , <br> <br> initComponent: <font color="#0000ff">function</font> () { <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .carousel.rendered) { <br> <font color="#0000ff">this</font> .render( <font color="#0000ff">this</font> .carousel.body); <br> } <br> <font color="#0000ff">else</font> { <br> <font color="#0000ff">this</font> .carousel.on( <font color="#A31515">'render'</font> , <font color="#0000ff">function</font> () { <br> <font color="#0000ff">this</font> .render( <font color="#0000ff">this</font> .carousel.body); <br> }, <font color="#0000ff">this</font> , {single: <font color="#0000ff">true</font> }); <br> } <br> }, <br> <br> onRender: <font color="#0000ff">function</font> () { <br> SS.PagedCarousel.Indicator.superclass.onRender.apply( <font color="#0000ff">this</font> , arguments); <br> <br> <font color="#0000ff">this</font> .positionIndicator = <font color="#0000ff">this</font> .el.createChild({tag: <font color="#A31515">'span'</font> }); <br> }, <br> <br> onBeforeCardSwitch: <font color="#0000ff">function</font> (carousel, card) { <br> <font color="#0000ff">if</font> (card) { <br> <font color="#0000ff">var</font> position = card.carouselPosition/( <font color="#0000ff">this</font> .carousel.itemCount-1), <br> position = isNaN(position) ? 0 : position*100, <br> el = <font color="#0000ff">this</font> .el; <br> <br> <font color="#0000ff">this</font> .positionIndicator[ <font color="#0000ff">this</font> .carousel.direction== <font color="#A31515">'vertical'</font> ? <font color="#A31515">'setTop'</font> : <font color="#A31515">'setLeft'</font> ](position.toFixed(2)+ <font color="#A31515">"%"</font> ); <br> <br> el.setStyle( <font color="#A31515">'opacity'</font> , <font color="#A31515">'1'</font> ); <br> <br> <font color="#0000ff">if</font> ( <font color="#0000ff">this</font> .hideTimeout != <font color="#0000ff">null</font> ) { <br> clearTimeout( <font color="#0000ff">this</font> .hideTimeout); <br> } <br> <br> <font color="#0000ff">this</font> .hideTimeout = setTimeout( <font color="#0000ff">function</font> () { <br> el.setStyle( <font color="#A31515">'opacity'</font> , <font color="#A31515">'0'</font> ); <br> }, 1500); <br> } <br> }, <br> <br> });</font></code> </blockquote> <br><br><h3>  Mobile Internet </h3><br>  The touch version of the application is not a complete copy of the original application ‚Äî for example, the search capability was implemented while the original application uses a filter mechanism.  All this demonstrates the advantages of Sencha Touch when creating application analogs available on mobile platforms, and since this is still an Internet application, it will work on both WebOS and Android (right after developers finish the corresponding library support) out of the box. <br><br>  Well, in conclusion, the author of the original article thanks Brian Sugar and Trey Matteson from Sugar for providing access to the API, as well as advising on relevant issues and wishes them everything. </div><p>Source: <a href="https://habr.com/ru/post/101439/">https://habr.com/ru/post/101439/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../101426/index.html">CDNvideo - new CDN network in Runet</a></li>
<li><a href="../101430/index.html">Variadic templates in C ++ 0x</a></li>
<li><a href="../101431/index.html">A simple way to slightly unload initialization javascript on the page</a></li>
<li><a href="../101432/index.html">2 mouse = 2 cursor</a></li>
<li><a href="../101435/index.html">KDE SC 4.5 release</a></li>
<li><a href="../101440/index.html">How to avoid becoming a spammer with your cozy mailing list</a></li>
<li><a href="../101441/index.html">Google has updated the Gmail and Contacts interface</a></li>
<li><a href="../101442/index.html">How to help escape ideas from prison</a></li>
<li><a href="../101446/index.html">Digit recognition with simplest statistics and topology analysis</a></li>
<li><a href="../101447/index.html">Modern virtualization capabilities</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>