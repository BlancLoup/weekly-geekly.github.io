<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Apache Spark in combat projects - survival experience</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We offer you materials based on the speech of Alexander Serbul at the BigData Conference . I, as the author and speaker, have slightly edited the text...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Apache Spark in combat projects - survival experience</h1><div class="post__text post__text-html js-mediator-article">  We offer you materials based on the speech of Alexander Serbul at the <a href="http://bigdataconf.com.ua/2015/">BigData Conference</a> .  I, as the author and speaker, have slightly edited the text and added modern thoughts and actual problems, so I hope the post will bring you both additional practical useful knowledge in the industry and food for thought - where to go with your knowledge.  So - into battle! <br><a name="habracut"></a><br><br><h1>  Bigdata </h1><br>  In my understanding, BigData is something crazy, i.e.  the term is, and the convolutions inside it are not.  On the one hand, administrators are puzzled where to put a significant amount of information.  On the other hand, it is a high load development.  It is necessary to create a cluster, look for hardcore developers, very experienced.  In addition, it is necessary to use higher mathematics: differential computing, linear algebra, probability theory, machine learning, graphs and training on them, logistic regression, linear discriminant analysis, and so on.  How to survive in this situation, what tools to take, what else is raw (unfortunately, the majority), how to bring money to the company.  After all, this is the main purpose of using BigData, and everything else is populism. <br><br><h1>  MapReduce </h1><br>  <a href="https://ru.wikipedia.org/wiki/MapReduce">MapReduce</a> is a paradigm of convolution functions for performing large and complex data queries proposed by Google.  It allows parallel processing of information in the spirit of <a href="https://en.wikipedia.org/wiki/Parallel_computing">data parallelizm</a> .  Ideally, you need all the algorithms used to work with large and not only big data, remake on MapReduce.  But no one does it for free ;-) In the old book, your grandmother on the shelf on the web will rather quickly find a good K-means clustering algorithm and it will work reliably.  But suddenly, before the release, or when there is more data than you expected, you will find that this algorithm does not work in "parallel mode", does not work through MapReduce - they can only load one processor core.  Therefore, you will need to urgently and re-invent another algorithm that can work in parallel, and figure out how it should work in the MapReduce paradigm.  And not everyone succeeds in doing so - this is Computer Science (in fact, sometimes, without PhD knowledge, it is possible to remake the algorithm on the MapReduce algorithm using the strong coffee method and blackboards with markers). <br>  In our projects, we started using algorithms on the Hadoop MapReduce platform, but then switched to Spark, because it turned out to be more reasonable and practical.  Classic Hadoop MapReduce works very simply: completed the task, put the result in the file.  Took, completed, put.  Spark - takes, performs all tasks, and then unloads the result.  In my opinion, and not only mine, Hadoop MapReduce, if not cool - an outdated conglomerate that is constantly and convulsively trying to change, which is why developers and system administrators constantly have to relearn, and businesses need to play Russian roulette with "raw technologies."  But ... we have almost no choice (yes, we watched <a href="http://storm.apache.org/">Apache Storm</a> - but it is from a completely different area: <a href="http://en.wikipedia.org/wiki/Task_parallelism">task parallel computng</a> ). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Alternatively, Apache Spark, to be honest, is not yet visible.  This is the most active open-source project in the Apache infrastructure, this is also an object to follow - look at least at <a href="http://fortune.com/2015/09/16/microsoft-prajna-spark-alternative/">Prajna</a> from Microsoft. <br><br>  You can throw in response to <a href="http://tez.apache.org/">Apache Tez</a> or find something small in the Apache Zoo - but, believe me, to reduce risks, it is better to use mainstream technologies that evolve in tune with the market. <br><br>  Somewhere nearby, not quite from this area, but from the interesting and if you really want to - look also at the <a href="http://giraph.apache.org/">Apache Giraph</a> and <a href="https://www.tensorflow.org/">TensorFlow</a> .  And ask the question: this is TaskParallel or DataParallel technology - and everything will become clear. <br><br><h1>  For what tasks we use Spark </h1><br>  We use parallel data processing technologies like this.  On MySQL-servers hundreds of thousands of databases of clients-companies, with staff from units to thousands of employees turn.  Spark is mainly used in the service of personal recommendations, which was described in one of the <a href="http://habrahabr.ru/company/bitrix/blog/272041/">previous publications</a> . <br><br>  We collect events - viewing orders, adding to the cart, paying for orders - processing, putting in Amazon Kinesis, processing with workers, saving in NoSQL (DynamoDB), and finally sending to Spark to generate models and analytics. <br><br>  At first glance, the scheme looks unnecessarily complicated, but gradually comes an understanding of why all this is needed.  This is the minimum necessary tools that are necessary for survival. <br><br>  We upload the results to Apache Mahout and get specific recommendations for the client.  The total volume of events recorded by the recommendation service reaches tens of millions per day. <br><br>  So far, we are intensively using and developing algorithms for collaborative filtering, but we see something like this roadmap for the development of algorithms: <br>  ‚Ä¢ Multimodality <br>  ‚Ä¢ Content-based recommendations <br>  ‚Ä¢ Clustering <br>  ‚Ä¢ Machine learning, deep learning <br>  ‚Ä¢ Targeting <br><br>  Now, more than ever, multimodality is valued - i.e.  using several different algorithms to answer a question (in our case, issuing a personal recommendation).  It is not enough just to start a service based on Apache Mahout, it will not give any gains over competitors.  Today you will not surprise anyone with collaborative filtering.  It is necessary to take into account the cloud of user tags when he went to the store and received some information.  Clustering allows for more flexible organization of information targeting.  Here, of course, can not do without machine learning.  Deep learning is, in simple terms, ‚Äúquality‚Äù machine learning, implying a very detailed study of the problem by the machine and, often, the use of a multilayered recurrent neural network.  With proper application, this helps to increase the conversion even more, to work more effectively with customers. <br><br><h1>  Reverse side of diversity </h1><br>  There are many software environments, tools, tools and products for developing and analyzing data on the market today.  Thank you for opensource (yes, it‚Äôs full of raw, glued ghouls, but there are some great solutions)!  On the one hand, diversity is an undoubted benefit.  On the other hand, the development process can become rather chaotic and confused.  For example, first try to use Apache Pig, when something does not work, refer to Apache Hive.  We looked, played, started writing on Spark SQL.  When requests begin to fall - rush to Impala (and it's still worse).  Under the threat of suicide, some curse the world of BigData and return to the good old RDBMS.  This is sometimes the impression that a lot of toys have been created for ‚Äúspecialists‚Äù, often with the same ‚Äúspecialists‚Äù.  But business does not understand all these searches, it needs to earn money, it requires specifics on time. <br>  Today, perhaps, only Apache Hive can be considered a classic and reliable tool for working with SQL queries on distributed data, like HDFS is a classic among cluster file systems (yes, there is of course also GusterFS, CEPH).  Nevertheless, many are switching to Spark SQL, because this framework is written (as one would like to believe), taking into account the interests of the business.  Also, HBase, Casandra, Mahout, Spark MLLib are increasingly being used.  However, to demand that every developer and / or sysadmin freely orientates himself in all these tools is stupid.  This is a profanation.  Technology - deep, with a bunch of settings, and each requires a deep dive for a month.  Do not rush - quality will inevitably suffer because of the race for quantity. <br><br><h1>  What to read </h1><br>  First of all I want to recommend to everyone who works or intends to start working with parallel algorithms and MapReduce, read the book ‚ÄúMining of Massive Datasets‚Äù, which is in the public domain.  It must be read several times, with a notebook and a pencil, otherwise porridge in your head can not be avoided.  At first, nothing will most likely be clear (I began to open from 3 times).  But this is one of the basic and, importantly, accessible to engineers who do not have a black belt in mathematics, a book on algorithms for working with big data.  In particular, chapter 2.3.6 is devoted to relational algebra and methods of projecting its operations on MapReduce.  Very useful material, in fact, here are ready-made tips for developers, it‚Äôs enough just to implement them carefully. <br><br>  Reading a literature full of mathematical details, remember the joke and smile :-) <br><pre> Two of them fly in a balloon, fall into the fog, get lost.  Suddenly their
 presses to the ground and they see a man.  One of them shouts down: "Where
 we? ". The person, having thought, answers:" You are in a balloon ... ". Another
 in a gust of wind, the orb flies high.
 - He's an idiot?
 - No, a mathematician.
 - ??????
 - First, he thought before answering.  Secondly, he gave absolutely
 the exact answer.  And thirdly, this answer is completely unnecessary.
</pre><br><br><h1>  Goodies Apache Spark </h1><br>  ‚Ä¢ DAG (directed acyclic graph) vs Hadoop MapReduce vs Hadoop Streaming.  You can write a large SQL query, which consists of several MapReduce operations in a chain, which will be executed correctly.  Streaming is implemented in Spark much better than in Hadoop, they are much more convenient to use and often work more efficiently by caching data in memory. <br>  ‚Ä¢ Spark Programming Guide + API.  Documentation is very sensible and useful. <br>  ‚Ä¢ Can be programmed in Java.  C ++ was considered a difficult language, but Scala is much ... no, not more difficult, rather, in my opinion, more highly intelligent.  Scala is a cool language, despite some academic rottenness and inorganic communication with the living dead with widely bulging eyes like Haskel.  I really love Scala, but you can go crazy about it, and the compilation time leaves much to be desired for yourself and your children.  Therefore, if you wish, you can connect to Spark from both Java and Python and from R. <br>  ‚Ä¢ Convenient abstraction: Resilient Distributed Dataset (RDD).  A beautiful, simply divine concept from the world of functional programming, allowing you to parallelize files of enormous size - into hundreds of gigabytes, or even terabytes. <br>  ‚Ä¢ Convenient collections: filter, map, flatMap.  A convenient approach to Spark is collections and operations on them: filter, map, flatMap.  Where does this come from?  This came from functional programming, which Scala is now actively preaching (and not only in it). <br><br><h1>  Java7 and Spark </h1><br>  Historically, we write to Spark in Java 7, and not in Java 8. Unfortunately, there is no normal support for functional objects in the G-7, so we are forced to do sadomasochism and create objects like PairFunction, Tuple2, TupleN.  In general, get ready - when Java7 integrates with Scala, you get a terribly unreadable code.  I, of course, exaggerate a little, but everything is mixed in it and I want to wear glasses with 13 eyepieces. <br><pre><code class="java hljs">JavaRDD&lt;String&gt; combinedRowsOrdered = combinedRows.mapToPair(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PairFunction&lt;String,String,String&gt;() {‚Ä¶ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Tuple2&lt;String,String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( String row )</span></span></span><span class="hljs-function"> </span></span>{ ‚Ä¶<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Tuple2&lt;String, String&gt;‚Ä¶</code> </pre> <br>  If you do not want to climb into the jungle of Scala, then better use Java 8. The code is more readable and shorter. <br><br><h1>  More about Scala </h1><br>  The name Scala is derived from English scalable.  It is a language for developing large component applications created by mathematicians.  I personally have the impression that Scala is a trend.  The trend of reviving functional programming (hello again Haskel, F #, ...).  Somehow ‚Äúsuddenly‚Äù it turned out (although scientists had guessed about it much earlier) that processing data arrays in the Data-Parallel paradigm is more convenient in the functional style, wow!  :-) Spark actively uses Scala Actors (hello Erlang).  They allow you to write simple, readable, single-threaded code that runs on a large number of servers.  You get rid of the risks of multi-threaded programming, which are forced to engage in Java - it is difficult, long and expensive (but cool).  In addition, due to the complexity of multi-threaded programming, many errors occur.  And thanks to the actors, life ‚Äúsuddenly‚Äù becomes simpler. <br><br><h1>  Spark cluster </h1><br>  For deployment in Amazon, Spark offers us a script called Spark-es2.  He downloads half the Berkeley repository, does something on Ruby under the hood (hello Japan) and installs a bunch of some kind of software.  The resulting system is quite fragile, sensitive to changes in the configuration of machines.  There are also complaints about logging and updating system components. <br>  For a while we existed with the Spark-ec2 script, but it turned out that it was better to write the Spark installer ourselves.  In addition, the installer will be able to take into account the ability to connect new spot-machines. <br>  All this is painful for us, because we do not have a large staff of system administrators - we are more programmers. If we had 30 system administrators, I would say: ‚ÄúGuys, I will program on Scala, and you are here, please do not sleep at night and work in clusters Spark.  A much more attractive option was a bunch of Spark and Elastic MapReduce.  Also, colleagues praise the solutions with Spark from Cloudera and HortonWorks - maybe they will also be useful to you. <br><br><h1>  Amazon EMR </h1><br>  Amazon offers us not to waste time and deploy a Spark cluster in them using the ElasticMapReduce service.  Here almost everything will work out of the box.  Spark is integrated into the Yarn-cluster, there is a lot of software, there is sub-monitoring, you can add machines, scale HDFS, change cluster size, increase and decrease the number of tasks due to spot-machines.  Spot machines in Amazon are 5-10 times cheaper.  We always use them because it is convenient, cheap and fast. <br><br>  Spark in EMR is professionally integrated with S3.  That's right, because that's where you'll most likely be storing files in Amazon.  We compared the storage of large files in S3 and HDFS, and it turned out that the access speed is about the same.  Then why bother with HDFS, suffer with a cluster file system, if there is a ready service.  Also in Elastic MapReduce to the giblets of Sparlk / Hadoop you can prokinut through ssh-tunneling of the web admin and get used to them (although I'm not used to it). <br><br><h1>  Amazon EMR Cost </h1><br>  It turns out a little more expensive than conventional cars, the difference is about 10%.  At the same time, you get a lot of ‚Äúbundled‚Äù, though a bit buggy software (Hue is the most buggy) and the ability to scale the cluster.  At the same time, you don't even need an admin - you, as developers, are kings and gods there. <br><h2>  Types of cars </h2><br>  Cars here are of three types: <br>  ‚Ä¢ Master-machines that control the entire cluster in general.  Spark Master is installed on them. <br>  ‚Ä¢ Core-machines on which the file system is deployed - HDFS.  There may be several of them.  However, it is recommended only to increase the number of core-machines, and not to reduce, otherwise the data is lost. <br>  ‚Ä¢ For everything else, task machines are used.  These are the usual Spark servers on which the workers work.  The number of spot-machines can be freely changed, creating a park of at least hundreds of cars. <br><h2>  Soft </h2><br>  ‚Ä¢ Spark.  In previous versions of Amazon images, spark.dynamicAllocation.enabled is not yet supported, so you have to tell yourself how many machines are needed to complete the task.  If the cluster is partially idle, then Spark will not take the remaining machines to run.  You have to strictly prescribe how many cars he needs.  It is not comfortable.  But since AMI 4, this feature is already working. <br>  ‚Ä¢ Hadoop / Yarn / HDFS.  In Yarn-clusters, as in Oracle, a lot of settings are used, and, for good, you need an admin who is very good at this.  But, despite the pain, Hadoop-clusters confidently solve their problems.  Most of all I do not like in Yarn and Hadoop that there is a mess with logging.  Everything is written into logs, the settings for logging levels are scattered in different parts of the cluster giblets and therefore their number grows very quickly.  And there is no normal solution to this problem.  It would be nice to learn from the good old inhabitants of unix - for example, from mysql, apache. <br>  ‚Ä¢ Ganglia.  This is a time-series software that builds graphs on various metrics: load, number of tasks, etc.  It helps to get an idea of ‚Äã‚Äãthe cluster status.  A handy thing, but there are drawbacks - the ‚Äúdead‚Äù spot cars continue to hang and overload the graphics. <br>  ‚Ä¢ Hive.  This is support for SQL commands that works on files in HDFS and S3.  A good tool, but sometimes its capabilities are not enough.  We use  But when you need more, we go to Spark and directly solve problems using relational algebra. <br>  ‚Ä¢ Pig.  We do not use it, so I find it difficult to give any assessment. <br>  ‚Ä¢ Hbase.  Option NoSQL, while not using. <br>  ‚Ä¢ Impala.  A very interesting thing about which you can write a separate post. While it seems like a raw software.  So use at your own risk. <br>  ‚Ä¢ Hue.  This is the admin panel for bigdate written in Python.  Its GUI allows you to combine Impala, Hbase, Pig, and Hive together.  That is, you can make your analyst corner on the web :-) I used it for a week, it began to fail, hang, then it stopped opening at all - in general, unfinished software <br><br><h1>  The main problems Spark, with whom we met </h1><br><h2>  Memory drops </h2><br>  What is a Map?  We take something, we scatter on the keys, and we scatter them on the cluster.  Nothing should fall here - algorithmically. <br>  What is Reduce?  When in one worker the data grouped in one key is collected.  If it is good to program, then it is possible to transfer in portions to the reducer all the values ‚Äã‚Äãinside one key and nothing will fall.  But in practice it turned out that Spark could fall at different points - then the buffer was not enough for serialization, then the memory was not enough for the worker.  And, in my opinion, this is the main problem.  But you can still tidy up.  We Spark now does not fall, although we have achieved this with the help of magic. <br><br>  Be sure to set a reasonable Executor Memory: --executor-memory 20G, --conf spark.kryoserializer.buffer.mb = 256, --conf spark.default.parallelism = 128, --conf spark.storage.memoryFraction = 0.1 <br>  KryoSerializer allows you to compress objects (spark.serializer org.apache.spark.serializer.KryoSerializer).  Without this, they consume much more memory.  I also do not recommend reducing the value of the constant spark.default.parallelism = 128, otherwise it can often fall from memory.  As for memoryFraction, we do not use caching. <br><br><h2>  Uploading results </h2><br>  Suppose you need to upload data from a Spark to a model.  If the volume is large, then it will take a very long time. <br>  ‚Ä¢ Thanks to --driver-memory 10G, you understand what you are unloading from the driver. <br>  ‚Ä¢ When using Collekt (), the entire result is collected in the memory in the driver and it may fall.  Therefore, I recommend using toLocalIterator ().  Alas, its performance is very very low.  So we had to write the code to build the partitions.  Who cares, I will tell more. <br><br><h2>  Logging </h2><br>  This code is the only thing that helped us deal with the problem of logging: <br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> SPARK_LOCAL_DIRS=<span class="hljs-string"><span class="hljs-string">"/mnt/spark,/mnt2/spark"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> SPARK_WORKER_DIR=<span class="hljs-string"><span class="hljs-string">"/mnt/spark_worker"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> SPARK_WORKER_OPTS=<span class="hljs-string"><span class="hljs-string">"-Dspark.worker.cleanup.enabled=true -Dspark.worker.cleanup.interval=1800 -Dspark.worker.cleanup.appDataTtl=259200"</span></span> #Worker executor <span class="hljs-built_in"><span class="hljs-built_in">stdout</span></span>/<span class="hljs-built_in"><span class="hljs-built_in">stderr</span></span> logs spark.executor.logs.rolling.maxRetainedFiles <span class="hljs-number"><span class="hljs-number">2</span></span> spark.executor.logs.rolling.strategy time spark.executor.logs.rolling.time.interval daily</code> </pre><br><br><h1>  Conclusion </h1><br>  I hope it was both useful and interesting.  Parallel algorithms on MapReduce more and more actively in our life.  There are few of them, they are looking for them, but there seems to be no other way out (well, maybe something will turn out to count faster on the Apache Giraph and TensorFlow and through the Task-Parallel paradigm).  The classic platform, Hadoop MapReduce, gives way to the Apache Spark platform, functionally written in modern language and mathematics.  Most likely you will be forced to begin to understand, at least at the level of terms, the inhabitants of the Hadoop-zoo: Hive, Pig, HDFS, Presto, Impala.  But constantly learning is our everything and in order to be ahead of the competitors you need to know more, write faster and think more brightly.  Good luck to everyone and Happy New Year! </div><p>Source: <a href="https://habr.com/ru/post/273279/">https://habr.com/ru/post/273279/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../273267/index.html">JavaScript Shortcuts</a></li>
<li><a href="../273269/index.html">Development environment andriod applications App Inventor 2 and its application in the community Arduino</a></li>
<li><a href="../273271/index.html">In continuation of the topic (We are testing p2p video for overload)</a></li>
<li><a href="../273273/index.html">Data Storage: Something about 3D Disks</a></li>
<li><a href="../273275/index.html">C-like structures in javascript</a></li>
<li><a href="../273281/index.html">Creating a business process in BPEL using the Serena Business Manager platform</a></li>
<li><a href="../273283/index.html">Open source application architecture: How nginx works</a></li>
<li><a href="../273289/index.html">Intel RealSense SDK and Oculus Rift DK2</a></li>
<li><a href="../273291/index.html">Look in both or a little about infographics.</a></li>
<li><a href="../273293/index.html">Castanedovskiy warrior risk management</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>