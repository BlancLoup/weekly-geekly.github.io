<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating OS X Applications with JavaScript</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, OS X Yosemite introduced the ability to use JavaScript for automation. This makes it possible to access native * OS X frameworks from JavaSc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating OS X Applications with JavaScript</h1><div class="post__text post__text-html js-mediator-article">  Recently, OS X Yosemite introduced the ability to use JavaScript for automation.  This makes it possible to access native * OS X frameworks from JavaScript.  I rummaged around in this new world and gathered a few <a href="https://github.com/tylergaw/js-osx-app-examples">examples</a> .  In this post I will explain the basics and step by step will show the process of creating a <a href="">small application.</a> <a name="habracut"></a>  . <br>  At WWDC 2014, there was an <a href="https://developer.apple.com/librarY/prerelease/mac/releasenotes/InterapplicationCommunication/RN-JavaScriptForAutomation/index.html">automation</a> session <a href="https://developer.apple.com/librarY/prerelease/mac/releasenotes/InterapplicationCommunication/RN-JavaScriptForAutomation/index.html">using JavaScript</a> .  It said that you can now use JavaScript to automate applications instead of AppleScript.  This is an exciting news in itself.  The ability to automate repetitive operations using AppleScript has been around for quite some time.  Writing in AppleScript is not the most pleasant thing, so using the familiar syntax instead would be very good. <br>  During this session, the speaker spoke about the bridge with Objective-C.  This is where the fun begins.  Bridge allows you to import any Objective-C framework into a JS application.  For example, if you want to write a GUI using standard OS X controls, you need to import Cocoa: <br><pre><code class="javascript hljs">ObjC.import(<span class="hljs-string"><span class="hljs-string">"Cocoa"</span></span>);</code> </pre> <br>  The FreeMork <a href="https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/ObjC_classic/_index.html">Foundation</a> does exactly what its name suggests.  It allows you to assemble blocks for OS X applications. It has a huge set of classes and protocols.  <b>NSArray</b> , <b>NSURL</b> , <b>NSUserNotification</b> , etc.  Maybe you are not familiar with all of them, but their names suggest what they are for.  Because of its extreme importance, the framework is available by default, without the need to import into a new application. <br>  As far as I can tell, you can do all the same in JavaScript as in Objective-C or Swift. <br><br><h4>  Example </h4><br>  <i>Warning: for this example to work, you need Yosemite Developer Preview 7+</i> <br>  The best way to learn something is to simply take and try to do something.  I'm going to show you the process of creating a small application that can display images from a computer. <br>  You can download the full sample from my <a href="https://github.com/tylergaw/js-osx-app-examples">repository</a> . <br><img src="https://habrastorage.org/files/a3f/a5b/acb/a3fa5bacb9bf4d41a52dca4cc821d465.jpg"><br>  <i>Screen application that I am going to write.</i> <br><br>  The application will have a window, a text box, an input field and a button.  Well, or by class names: <b>NSWindow</b> , <b>NSTextField</b> , <b>NSTextField</b> and <b>NSButton</b> . <br>  Clicking on the ‚ÄúSelect File‚Äù button will open <b>NSOpenPanel</b> to select a file.  We will configure the panel in such a way that it will not allow the user to select files with an extension other than .jpg, .png and .gif. <br>  After selecting the image, we show it in the window.  The window will adjust its size to the width and height of the image plus the height of the controls.  We will also indicate the minimum window size so that the controls do not disappear. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Project Setup </h4><br>  Open the Apple Script Editor application in <b>Applictions&gt; Utilities</b> .  This is not the best editor I've tried, but now it is needed.  There are a number of necessary features for building an OS X application on JS.  Not sure what's going on under the hood, but he can compile and run your scripts as applications.  It also creates additional necessary things, such as the Info.plist file.  It seems to me that it is possible to force other editors to do the same, but I have not figured it out yet. <br>  Create a new document via <b>File&gt; New</b> or <b>cmd + n</b> .  The first thing we need to do is save the document as an application.  Save it via <b>File&gt; Save</b> or <b>cmd + s</b> .  Do not rush to save once.  There are two settings that are required in order to run the project as an application. <br><img src="https://habrastorage.org/files/cfd/41e/201/cfd41e2016224886be7ab227e44131a6.jpg"><br>  <i>Script Editor with the necessary settings</i> <br><br>  Change the format to ‚ÄúApplication‚Äù and tick the checkbox ‚ÄúDo not close‚Äù ** <br>  <i>Important note: these settings can be changed: open the File menu and hold the option button.</i>  <i>This will open the "Save As ..." item.</i>  <i>In the save dialog, you can make changes to the settings.</i>  <i>But it is better to do it immediately when creating a project.</i> <br>  If you do not tick the ‚ÄúDo not close‚Äù box, your application will open and then immediately close.  There is almost no documentation on this functionality on the Internet.  I only found out about this after several hours I beat my forehead into the keyboard. <br><br><h4>  Let's do something already! </h4><br>  Add the following lines to your script and run everything via <b>Script&gt; Run</b> Application or <b>cmd + r</b> . <br><pre> <code class="javascript hljs">ObjC.import(<span class="hljs-string"><span class="hljs-string">"Cocoa"</span></span>); $.NSLog(<span class="hljs-string"><span class="hljs-string">"Hi everybody!"</span></span>);</code> </pre><br>  Almost nothing happened.  The only visible changes are in the menu bar and dock.  The name of the application appeared in the menu bar and the items File and Edit.  You can see that the application is running, as its icon is now in the dock. <br>  Where is the line "Hi everybody!"?  And what's the dollar sign, jQuery?  Close the application via <b>File&gt; Quit</b> or <b>cmd + q</b> and let's find out where this NSLog happened. <br>  Open the console: <b>Applications&gt; Utilities&gt; Console</b> .  Each application can write something to the console.  It is not much different from the Developer Tools in Chrome, Safari or Firefox.  The main difference is that you debug applications instead of sites. <br>  There are a lot of messages in it.  Filter it by writing ‚Äúapplet‚Äù in the search bar in the upper right corner.  Return to the Script Editor and run the application again via <b>opt + cmd + r</b> . <br><img src="https://habrastorage.org/files/eff/ba0/0b9/effba00b99734d76ba1fa50c8c88ef57.jpg"><br>  Have you seen !?  The message ‚ÄúHi everybody!‚Äù Should appear in the console.  If it is not there, close your application and run it again.  I forgot to close it many times and the code did not start. <br><br><h4>  What about the dollar sign? </h4><br>  The dollar sign is your access to the bridge in Objective-C.  Every time you need to access an Objective-C class or constant, you need to use <b>$ .foo</b> or <b>ObjC.foo</b> .  Later I will talk about other ways to use <b>$</b> . <br>  The console application and NSLog are indispensable things, you will always use them for debugging.  To learn how to log something other than strings, study my <a href="">NSLog example</a> . <br><br><h4>  Create a window </h4><br>  Let's do something to interact with.  Add your code: <br><pre> <code class="javascript hljs">ObjC.import(<span class="hljs-string"><span class="hljs-string">"Cocoa"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> styleMask = $.NSTitledWindowMask | $.NSClosableWindowMask | $.NSMiniaturizableWindowMask; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> windowHeight = <span class="hljs-number"><span class="hljs-number">85</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> windowWidth = <span class="hljs-number"><span class="hljs-number">600</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ctrlsHeight = <span class="hljs-number"><span class="hljs-number">80</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> minWidth = <span class="hljs-number"><span class="hljs-number">400</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> minHeight = <span class="hljs-number"><span class="hljs-number">340</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-built_in"><span class="hljs-built_in">window</span></span> = $.NSWindow.alloc.initWithContentRectStyleMaskBackingDefer( $.NSMakeRect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, windowWidth, windowHeight), styleMask, $.NSBackingStoreBuffered, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.center; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.title = <span class="hljs-string"><span class="hljs-string">"Choose and Display Image"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.makeKeyAndOrderFront(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>);</code> </pre><br>  Then run the application.  <b>opt + cmd + r</b> .  Now let's talk!  We made a small amount of code an application that can be moved, collapsed and closed. <br><img src="https://habrastorage.org/files/fe8/eda/91c/fe8eda91c3874092b446f146e3ba6d74.jpg"><br>  <i>Simple NSWindow window created with JS</i> <br><br>  If you, like me, have never had to build applications with Objective-C or Cocoa, all of this may look a little crazy.  I was so shown the length of the names of the methods.  I like descriptive names, but Cocoa goes too far. <br>  However, this is javascript.  The code looks like you are writing a site. <br>  What happens in the first lines where we set the <b>styleMask</b> value?  Style masks are used to customize windows.  Each option says that it adds;  title, close button, minimize button.  These options are constants.  Use bitwise or ("|") to separate one setting from another. <br>  There are many options.  You can read about them all in the <a href="https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/WinPanel/Tasks/SettingWindowAppearance.html">documentation</a> .  Try adding <b>NSResizableWindowMask</b> and see what happens. <br>  You need to remember a few curious things about syntax.  <b>$ .NSWindow.alloc</b> calls the <b>alloc</b> method of an <b>NSWindow</b> object.  Note that after calling the method there are no brackets.  In JavaScript, this gives access to properties, not methods.  How is it going?  In JS for OS X, brackets are allowed only if you pass parameters.  Attempting to use parentheses with no arguments will result in a runtime error.  If something goes wrong as intended, look at the console for errors. <br>  Here is an example of a super-long method name: <br><pre> <code class="javascript hljs">initWithContentRectStyleMaskBackingDefer</code> </pre><br>  In the <a href="https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSWindow_Class/Reference/Reference.html">documentation for NSWindow,</a> this method looks somewhat different: <br> <code>initWithContentRect:styleMask:backing:defer:</code> <br>  In Objective-C, such windows are created as follows: <br><pre> <code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">NSWindow</span></span>* window [[<span class="hljs-built_in"><span class="hljs-built_in">NSWindow</span></span> alloc] initWithContentRect: <span class="hljs-built_in"><span class="hljs-built_in">NSMakeRect</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, windowWidth, windowHeight) styleMask: styleMask, backing: <span class="hljs-built_in"><span class="hljs-built_in">NSBackingStoreBuffered</span></span> defer: <span class="hljs-literal"><span class="hljs-literal">NO</span></span> ];</code> </pre><br>  Note the colons (":") in the original method description.  To use the Objective-C method in JS, you need to remove them and replace the next letter with a capital letter.  The square brackets ("[]") are a call to a class / object method.  <b>[NSWindow alloc]</b> calls the <b>alloc</b> method of the <b>NSWindow</b> class.  In JS, this is equivalent to <b>NSWindow.alloc</b> , plus, if necessary, brackets. <br>  I think the rest of the code is pretty simple.  I will miss her detailed description.  To deal with what happens next, you will need a lot of time and have to read a lot of documentation, but you can handle it.  If you have a window showing, it's already great.  Let's do something else. <br><br><h4>  Adding controls </h4><br>  We need a label, a text field and a button.  We will use <b>NSTextField</b> and <b>NSButton</b> .  Update your code and run the application again. <br><pre> <code class="javascript hljs">ObjC.import(<span class="hljs-string"><span class="hljs-string">"Cocoa"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> styleMask = $.NSTitledWindowMask | $.NSClosableWindowMask | $.NSMiniaturizableWindowMask; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> windowHeight = <span class="hljs-number"><span class="hljs-number">85</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> windowWidth = <span class="hljs-number"><span class="hljs-number">600</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ctrlsHeight = <span class="hljs-number"><span class="hljs-number">80</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> minWidth = <span class="hljs-number"><span class="hljs-number">400</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> minHeight = <span class="hljs-number"><span class="hljs-number">340</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-built_in"><span class="hljs-built_in">window</span></span> = $.NSWindow.alloc.initWithContentRectStyleMaskBackingDefer( $.NSMakeRect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, windowWidth, windowHeight), styleMask, $.NSBackingStoreBuffered, <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> textFieldLabel = $.NSTextField.alloc.initWithFrame($.NSMakeRect(<span class="hljs-number"><span class="hljs-number">25</span></span>, (windowHeight - <span class="hljs-number"><span class="hljs-number">40</span></span>), <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>)); textFieldLabel.stringValue = <span class="hljs-string"><span class="hljs-string">"Image: (jpg, png, or gif)"</span></span>; textFieldLabel.drawsBackground = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; textFieldLabel.editable = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; textFieldLabel.bezeled = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; textFieldLabel.selectable = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> textField = $.NSTextField.alloc.initWithFrame($.NSMakeRect(<span class="hljs-number"><span class="hljs-number">25</span></span>, (windowHeight - <span class="hljs-number"><span class="hljs-number">60</span></span>), <span class="hljs-number"><span class="hljs-number">205</span></span>, <span class="hljs-number"><span class="hljs-number">24</span></span>)); textField.editable = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> btn = $.NSButton.alloc.initWithFrame($.NSMakeRect(<span class="hljs-number"><span class="hljs-number">230</span></span>, (windowHeight - <span class="hljs-number"><span class="hljs-number">62</span></span>), <span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>)); btn.title = <span class="hljs-string"><span class="hljs-string">"Choose an Image..."</span></span>; btn.bezelStyle = $.NSRoundedBezelStyle; btn.buttonType = $.NSMomentaryLightButton; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.contentView.addSubview(textFieldLabel); <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.contentView.addSubview(textField); <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.contentView.addSubview(btn); <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.center; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.title = <span class="hljs-string"><span class="hljs-string">"Choose and Display Image"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.makeKeyAndOrderFront(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>);</code> </pre><br>  If everything went well, then you now have a window with controls.  Nothing can be entered in the field, and the button does nothing, but wait a minute, we are already moving. <br><img src="https://habrastorage.org/files/e6a/f18/c1c/e6af18c1cb6b4d738bcb89ffbaa7a0b2.jpg"><br>  <i>Window controls</i> <br><br>  What did we do here?  <b>textFieldLabel</b> and <b>textField</b> are similar.  They are both instances of <b>NSTextField</b> .  We created them the same way we created the window.  When you see <b>initWithFrame</b> and <b>NSMakeRect</b> , then most likely, a UI element is created here.  <b>NSMakeRect</b> does what is rendered in its name.  It creates a rectangle with the specified coordinates and dimensions;  <b>(x, y, width, height)</b> .  As a result, it creates what is called ‚Äústructure‚Äù in Objective-C.  In JS, the equivalent can be an object, a hash, or perhaps a dictionary.  Pairs key value. <br>  After creating the text boxes, set each handful of properties to get the desired result.  Cocoa doesn't have anything like the html label element.  So, let's make our own by turning off the background and the ability to edit. <br>  We will set the text field programmatically, simultaneously disabling editing.  If we didn‚Äôt need this, we would be treated in one line. <br>  To create a button we use <b>NSButton</b> .  As with the text field, we need structure.  Select two properties: <b>bezelStyle</b> and <b>buttonType</b> .  The values ‚Äã‚Äãof both are constants.  These properties determine how the element will be drawn and what styles it will have.  See the <a href="https://developer.apple.com/library/mac/documentation/cocoa/reference/applicationkit/classes/NSButton_Class/Reference/Reference.html">NSButton documentation</a> to find out what else you can do with the button.  I also have <a href="">an example</a> where various styles and types of buttons are shown in action. <br>  The last of the new things we are doing here is adding items to the window using <b>addSubView</b> .  The first time I tried to do it using <pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addSubview(theView)</code> </pre><br>  On other standard views that you create using <b>NSView</b> , this will work, but not with instances of <b>NSWindow</b> .  Not sure why, but in the window elements need to be added to the <b>contentView</b> .  The documentation says: "The topmost available NSView object in the window hierarchy."  It worked for me. <br><br><h4>  Making the button work </h4><br>  Clicking on the button ‚ÄúSelect image‚Äù should lead to the opening of the panel displaying files on the computer.  Before that, let's warm up by adding a message to the console when the button is pressed. <br>  In JS, event handlers are attached to elements for handling clicks.  Objective-C uses a slightly different concept.  It uses what is called "messaging" ***.  That is, you send a message to the object containing the name of the method.  The object must have information about what to do when it receives such a message.  Maybe this is not the most accurate description, but I understand that. <br>  The first is to set the <b>target</b> and the <b>action of</b> the button.  <b>Target</b> is the object to which you want to send the message contained in <b>action</b> .  If it is not clear now, move on, you will understand everything when you see the code.  Update the part of the script where the button is configured: <br><pre> <code class="javascript hljs">... btn.target = appDelegate; btn.action = <span class="hljs-string"><span class="hljs-string">"btnClickHandler"</span></span>; ...</code> </pre><br>  <b>appDelegate</b> and <b>btnClickHandler</b> do not exist yet.  We must make them.  In the following code, order is important.  I added comments to show where the new code is. <br><pre> <code class="javascript hljs">ObjC.import(<span class="hljs-string"><span class="hljs-string">"Cocoa"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   ObjC.registerSubclass({ name: "AppDelegate", methods: { "btnClickHandler": { types: ["void", ["id"]], implementation: function (sender) { $.NSLog("Clicked!"); } } } }); var appDelegate = $.AppDelegate.alloc.init; //    //  ,    var textFieldLabel = $.NSTextField.alloc.initWithFrame($.NSMakeRect(25, (windowHeight - 40), 200, 24)); textFieldLabel.stringValue = "Image: (jpg, png, or gif)"; ...</span></span></code> </pre><br>  Launch the application, click on the button and look in the console.  See the ‚ÄúClicked!‚Äù Message when you click a button?  If yes, then this is just a bailout, right?  If not, check the code and errors in the console. <br><br><h4>  Inheritance </h4><br>  And what about <b>ObjC.registerSubclass</b> ?  Inheritance is a way to create a new class that inherits from another Objective-C class.  Lyrical digression: there is a chance that I use the wrong terminology.  Fight me.  <b>registerSubclass</b> takes one argument: a JS object containing the properties of the new object.  Properties can be: <b>name</b> , <b>superclass</b> , <b>protocols</b> , <b>properties</b> and <b>methods</b> .  I'm not 100% sure that this is an exhaustive list, but this is how it is described in <a href="https://developer.apple.com/librarY/prerelease/mac/releasenotes/InterapplicationCommunication/RN-JavaScriptForAutomation/index.html">release notes</a> . <br>  That's all well and good, but what have we done here?  Since we did not specify a superclass, we inherit from <b>NSObject</b> .  This is the base class for most Objective-C classes.  The name property will allow us to access a new class in the future through <b>$</b> or <b>ObjC</b> . <br>  <b>$ .AppDelegate.alloc.init;</b>  creates an instance of our <b>AppDelegate</b> class.  Again, note that the parentheses of the calls to the <b>alloc</b> and <b>init</b> methods <b>are</b> not used, since we do not pass arguments to them. <br><br><h4>  Heir methods </h4><br>  The method is created by assigning any string name to it.  For example, <b>btnClickHandler</b> .  Pass an object with the <b>types</b> and <b>implementation</b> properties to it.  I did not find official documentation on what the array of types should contain.  Through trial and error, I realized that it looks something like this: <br><pre> <code class="javascript hljs">[<span class="hljs-string"><span class="hljs-string">"return type"</span></span>, [<span class="hljs-string"><span class="hljs-string">"arg 1 type"</span></span>, <span class="hljs-string"><span class="hljs-string">"arg 2 type"</span></span>,...]]</code> </pre><br>  <b>btnClickHandler returns</b> nothing, so the first element will be void.  It takes one parameter, the object sending the message.  In our case, <b>NSButton</b> , which we called <b>btn</b> .  A full list of types is available <a href="https://developer.apple.com/librarY/prerelease/mac/releasenotes/InterapplicationCommunication/RN-JavaScriptForAutomation/index.html">here</a> . <br>  <b>implementation</b> is a common feature.  In it, you write JavaScript.  You have all the same access to <b>$</b> as outside the object.  Also, variables declared outside the function are available to you. <br><br><h4>  A quick note about using protocols </h4><br>  You can inherit subclasses from Cocoa protocols, but there are pitfalls.  I managed to find out that if you use the <b>protocols</b> array, your script will simply crash without errors.  I wrote <a href="">an example and an explanation</a> , so if you want to work with them, read. <br><br><h4>  Select and display images </h4><br>  We are ready to open the panel, select the image and show it.  Update function code <br><pre> <code class="javascript hljs"> btnClickHandler: ... implementation: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sender</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> panel = $.NSOpenPanel.openPanel; panel.title = <span class="hljs-string"><span class="hljs-string">"Choose an Image"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> allowedTypes = [<span class="hljs-string"><span class="hljs-string">"jpg"</span></span>, <span class="hljs-string"><span class="hljs-string">"png"</span></span>, <span class="hljs-string"><span class="hljs-string">"gif"</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">NOTE:</span></span></span><span class="hljs-comment">    JS   NSArray panel.allowedFileTypes = $(allowedTypes); if (panel.runModal == $.NSOKButton) { // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">NOTE:</span></span></span><span class="hljs-comment"> panel.URLs -  NSArray,   JS array var imagePath = panel.URLs.objectAtIndex(0).path; textField.stringValue = imagePath; var img = $.NSImage.alloc.initByReferencingFile(imagePath); var imgView = $.NSImageView.alloc.initWithFrame( $.NSMakeRect(0, windowHeight, img.size.width, img.size.height)); window.setFrameDisplay( $.NSMakeRect( 0, 0, (img.size.width &gt; minWidth) ? img.size.width : minWidth, ((img.size.height &gt; minHeight) ? img.size.height : minHeight) + ctrlsHeight ), true ); imgView.setImage(img); window.contentView.addSubview(imgView); window.center; } }</span></span></code> </pre><br>  First, we create an instance of <b>NSOpenPanel</b> .  You saw the panels in action if you ever selected a file or chose where to save this file. <br>  All we need from the application is to show images.  The <b>allowedFileTypes</b> property allows us to determine which types of files the panel can choose.  It takes on the value of type <b>NSArray</b> .  We create a JS array with valid types, but we still need to convert it to <b>NSArray</b> .  This is done like this: <b>$ (allowdTypes)</b> .  This is another way to use the bridge.  We use this method to translate the JS value in Objective-C.  The reverse operation is as follows: <b>$ (ObjCThing) .js</b> . <br>  Open the panel with <b>panel.runModal</b> .  The execution of the code is suspended.  If you click <b>Cancel</b> or <b>Open</b> , the panel returns the value.  If the <b>Open</b> button is pressed, the <b>$ .NSOKButton</b> constant will return. <br>  The following note about <b>panel.URLs is</b> very important.  In JS, access to the array values ‚Äã‚Äãis as follows: <b>array [0]</b> .  Because URLs are of type <b>NSArray</b> , you cannot use square brackets.  Instead, use the <b>objectAtIndex</b> method.  The result will be the same. <br>  After receiving the image URL, you can create a new instance of <b>NSImage</b> .  Since creating an image by a file URL is a widespread approach, there is a convenient method for this: <br> <code>initByReferencingFile</code> <br>  <b>NSImageView</b> is created in the same way we used to create other UI elements.  <b>imgView</b> manages image display. <br>  We need to adjust the window size to the width and height of the image, while not going beyond the lower limits of the height / width.  To resize a window, use <b>setFrameDisplay</b> . <br>  So we set the image for <b>imageView</b> and add it to the window.  Since its width and height have changed, the window needs to be centered. <br>  And here is our little application.  Go ahead, open a couple of files.  And yes, animated gifs will work too, so don't forget about them. <br><br><h4>  Savory news </h4><br>  Until now, you have started the application using <b>opt + cmd + r</b> .  But you launch a regular application by double clicking on the icon. <br><img src="https://habrastorage.org/files/f34/467/db7/f34467db766f471d94e7f952b29bc14d.jpg"><br>  <i>Double click on the icon to launch the application.</i> <br><br>  The icon can be changed by replacing <b>/Contents/Resources/applet.icns</b> .  To access the application's resources, right-click on the icon and select "Show Package Contents". <br><br><h4>  Why did it get me so excited </h4><br>  Because I think there is a lot of potential.  That's why.  When Yosemite comes out, anyone can sit down and write a native application.  And they can do it using one of the most common programming languages.  They will not have to download or install anything.  Even XCode will not need to be installed if you do not want to.  The threshold of entry will be greatly reduced.  This is incredible. <br>  I know that developing applications for OS X is a much deeper process than writing a script on my knee.  I have no illusions about the fact that JavaScript will become the de facto standard for starting development for Mac.  I believe this will help developers write small applications that will make development easier for themselves and other people.  Do you have a person in the team who find it difficult to work with the command line?  Write a GUI for him quickly.  Need a way to quickly, visually create or change configs?  Make a small application for this. <br>  These features are in other languages.  In Python and Ruby, you have access to the same native API and people make applications using them.  However, using javascript for this is different.  It turns everything upside down.  It‚Äôs as if the DIY principles of web development are knocking on the development door under Desktop.  Apple left the door unlocked, I enter. <br><br>  <b>Translator's Notes:</b> <br>  * - native, the word is already becoming common, for example, to distinguish between HTML5 applications and traditional <br>  ** - Stay open after run handler, not sure exactly how the setting is called in the Russian version of Script Editor <br>  *** - message passing </div><p>Source: <a href="https://habr.com/ru/post/239635/">https://habr.com/ru/post/239635/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../239621/index.html">User intention: enhancing the digital campaign with user factors</a></li>
<li><a href="../239625/index.html">200 microcomputers in 3 hours, or small-scale production of microelectronics in Shenzhen (on the example of the VoCore project)</a></li>
<li><a href="../239627/index.html">Algorithmic trading on the stock market in Russia: trends and technologies</a></li>
<li><a href="../239629/index.html">Check Network Security Services Library</a></li>
<li><a href="../239633/index.html">We use MongoDB in a cloud backend of mobile applications</a></li>
<li><a href="../239637/index.html">Do not be afraid to use HandlerSocket</a></li>
<li><a href="../239639/index.html">Exoskeletons in medicine</a></li>
<li><a href="../239641/index.html">Instructions for obtaining a radio call sign and certificate of registration of RES</a></li>
<li><a href="../239643/index.html">Alternative outcome of creating a strong AI</a></li>
<li><a href="../239645/index.html">Cloud Autotest Selenium + Ubuntu (step by step instructions)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>