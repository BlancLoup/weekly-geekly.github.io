<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we ur did</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This game has no name. 

 Victor Pelevin "Generation P" 
 
 The road to a thousand li begins with the first step. 

 Lao Tzu 
 

 In relation to my pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we ur did</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/getpro/habr/post_images/abf/f6a/1c6/abff6a1c62873e37de5f4ad635490766.png">  <i><b>This game has no name.</b></i> <i><b><br><br></b></i>  <i><b>Victor Pelevin "Generation P"</b></i> <i><b><br></b></i> <br>  <i><b>The road to a thousand li begins with the first step.</b></i> <i><b><br><br></b></i>  <i><b>Lao Tzu</b></i> <i><b><br></b></i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In relation to my <a href="http://habrahabr.ru/post/224661/">previous article</a> , the Habr effect worked in unexpected ways.  The very first comment to it, dear <a href="https://habr.com/users/nomad1/" class="user_link">Nomad1,</a> <a href="http://habrahabr.ru/post/224661/">asked</a> if I wanted to create a full-fledged implementation?  I, at that moment, as usual, thought about my own and did not immediately understand it.  Of course, it was not about creating a universal game engine (the thought of which does not bother me), but about developing the implementation of the game Ur for mobile platforms.  Although I had little idea, at that time, with what I could be useful, I agreed to help. <br><a name="habracut"></a><br>  Of course, all my <a href="">achievements</a> for ZoG were completely useless here.  ZRF is so peculiar language that all its solutions and idioms have value only for ZRF-developers and for no one else (for the most part, they all solve the problems of ZRF itself).  Fortunately, Alexey already had a ready-made framework, which made it possible to program the game logic in record time.  My task was to reconcile the game rules and develop the principles of the AI ‚Äã‚Äãfor this game. <br><br>  We have tried to reproduce as accurately as possible the <a href="http://skyruk.livejournal.com/231444.html">version of the rules</a> proposed by <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BA%25D0%25B8%25D1%2580%25D1%258E%25D0%25BA,_%25D0%2594%25D0%25BC%25D0%25B8%25D1%2582%25D1%2580%25D0%25B8%25D0%25B9_%25D0%2598%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B5%25D0%25B2%25D0%25B8%25D1%2587">Dmitry Skiryuk</a> , since we consider it the most interesting (in the game relation) of all proposed to date. <br><br><div class="spoiler">  <b class="spoiler_title">Remind the rules</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/b7f/59b/17f/b7f59b17f6e7449451eb7341498f58f0.png"><br><br>  At your disposal 7 fighters novices.  Your task is to lead them across the river and return home.  The gods will help you along the way. <br><br><ul><li>  If white color fell on one of the bones, you can take one step. </li><li>  Two white bones means that any of your fighters can move two steps. </li><li>  If white color fell on three bones, you can move any of your fighters three steps. </li><li>  Three black bones give the right to go four steps forward. </li></ul><br>  If none of your fighters can walk, you miss a turn. <br><br>  Not all the places you pass through are the same. <br><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/467/5e4/ef9/4675e4ef9a972f4c331bc617708f702d.png">  This is the gate of Ishtar - the patron saint of warriors. <br>  Staying here, you have the right to make another move. <br><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/1a5/d58/dd6/1a5d58dd645a7aad832deb4ccc39aada.png">  Here you can camp.  In the camp can be no more than 4 of your fighters. <br>  As long as there is at least one fighter in the camp, the enemy cannot enter this place. <br><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/acc/db8/536/accdb85365da62abf7d2dff774ff16cf.png">  This is a holy place.  The enemy cannot attack you here, but you cannot attack him.  No more than 4 fighters (your and your opponent) can stay in this place.  Remember, the one who entered last is the first to leave! <br><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/43f/a13/ffc/43fa13ffcc5d460de03c107fa97419ba.png">  After passing through this place, the novice fighters turn into war veterans.  A rookie cannot defeat a veteran in a battle, but veterans do not attack rookies either. <br><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/b31/44c/78e/b3144c78e368b524fda3f73132656f29.png">  No one can beat a veteran while he is in this place. <br><br><br>  Coming out of the camp, you will meet with the enemy.  If one of your fighters is killed, you will get another newcomer. <br><br>  Seven warriors must cross the river and return home. <br>  The enemy should not get ahead of you! <br></div></div><br>  One of the "highlights" of this version of the rules is the process of "turning over" the chips.  Let me remind you that the chips are turned over so that the player does not get confused in the direction of their movement.  Ordinary chips move in the direction of the "small" block, inverted - from him.  But "turning over" chips affects the gameplay.  Only identical chips can "chop" each other.  Ordinary chips can not "cut down" inverted and vice versa.  This greatly diversifies the gameplay, but creates a threat of "congestion."  For example, in the process of debugging a ZoG application, I had the following situation: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1e2/bdb/c82/1e2bdbc82ab0cdc32b179e237c486dc4.jpg"><br><br>  This is the real position that has arisen during the test run of the ‚ÄúSimple Ur‚Äù game variant, in which the board‚Äôs fields, apart from the ‚Äúsockets‚Äù, do not have any special properties.  This congestion is not at all easy to disassemble (if there were no chips left in reserve, the game would have ended with this).  No matter how many points any player has thrown, none of the blocks that blocked each other will be able to move.  I think this is the main reason why Dmitry introduced special fields into the game.  Fields c2 and f2 (in chess notation) are designed to relieve ‚Äútraffic‚Äù. <br><br>  In these fields, chips of any color can be arranged in a "column" on each other (but not more than 4 pieces).  In this case, the lower chips do not return to the reserve, but simply remain blocked until the upper chip passes further.  This simple rule change has a magical effect on gameplay.  Congestion ceases to exist.  Faced chips easily diverge!  But the surprises associated with turning the chips do not end there.  Look at the following position: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/498/2f0/732/4982f0732379537b20b7ef34ed7cfacd.jpg"><br><br>  According to Dmitry's rules, the chip turns over not when it gets on the transformation field (h1 for white and h3 for black), but passing through it!  As a result, the white chip cannot cut black on h3, since it must be turned upside down, making any move with h1.  But she easily hits an inverted black chip on h2, turning over in the process!  This rule, in fact, makes the fields g1, h1, g3 and h3 safe.  These fields are the perfect place for ambush. <br><br>  The g2 field is also safe (but for a different reason).  In this field with eyes, chips can also be arranged in a ‚Äúcolumn‚Äù, but only chips of the same color!  As long as this field is occupied by at least one of our chips, the enemy chip cannot enter it.  Similar fields on b1, b3, d1 and d3 help to more effectively introduce new chips into the game. <br><br>  Another important feature of the game is the field with "sockets", which allow when you stop on them, make an extra move.  The introduction of these fields gives the game a truly hurricane character.  If we play with a group of chips, it is not necessary to throw out the ‚Äúfours‚Äù each time in order to ‚Äúwalk on the rosettes‚Äù.  It is often possible to make 2-3 moves before the move goes to the opponent. <br><br>  A little apart, in my opinion, is the rule that does not allow "to cut down" an inverted chip that has reached a2.  One can argue long about the validity or usefulness of this rule, but the fact that it works is an indisputable fact.  During the test runs of the game, situations repeatedly arose when the winning of one of the parties was determined by whether this rule is valid or not.  We implemented it also because it introduces intrigue into the game.  When the opponent brought his last chip up to a2, he must be very lucky so that we could win him.  We can not cut this chip in any way, but as soon as the enemy has a ‚Äúone‚Äù, the game will be over. <br><br>  If you think that on this game surprises from Ur end, you are mistaken!  Why are three D2 bones used for the game, and not one D4?  <a href="http://skyruk.livejournal.com/pics/catalog/6819/167235">D4-</a> type game dice (with four facets) were widespread in the ancient world.  Why in the game was not used one "bone" instead of three?  This is not obvious at first glance, but when using such a game scheme, the ejected points are not equally probable.  Units and twos fall out three times more often than threes and fours. <br><br>  This directly affects the gameplay.  Positions at a distance of 3-4 cells from the enemy‚Äôs catching chips are much safer than a distance of 1-2 cells.  But not one but several chips can catch up with us, moreover, ‚Äúsafe‚Äù fields should be taken into account.  In general, this game is not so simple as it seems at first glance. <br><br>  We should also talk about the game AI.  It is very important that the program plays at approximately the same level as the person.  The ZoG implementation, for example, plays very poorly.  Often it is possible to win her "dry".  Playing with her is not very interesting.  But if the program will constantly win, it can also ‚Äúscare away‚Äù the user.  We tried to keep a balance.  The game has four levels of difficulty.  At the highest level, I manage to win in about half of the games, with a margin of 1-2 chips.  The low level of complexity may be of interest to ‚Äúcasual players‚Äù. <br><br>  Initially, we wanted to use the <a href="http://ru.wikipedia.org/wiki/%25D0%2590%25D0%25BB%25D1%258C%25D1%2584%25D0%25B0-%25D0%25B1%25D0%25B5%25D1%2582%25D0%25B0_%25D0%25BE%25D1%2582%25D1%2581%25D0%25B5%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">alpha-beta algorithm</a> to implement AI, but we quickly abandoned this idea.  The random nature of the generation of moves has its own specifics.  In fact, it is only important that you are not ‚Äúeaten‚Äù (with a high probability) on the next turn.  Looking further is expensive and, on the whole, useless.  This game requires not ‚Äúartificial intelligence‚Äù, but rather ‚Äúartificial instinct‚Äù, but ‚Äúinstinct‚Äù rather complicated.  Here is the pseudo-code that I ended up with: <br><br><div class="spoiler">  <b class="spoiler_title">The implementation of the game AI</b> <div class="spoiler_text"><pre><code class="hljs 1c">- Segment <span class="hljs-number"><span class="hljs-number">1</span></span>  = <span class="hljs-number"><span class="hljs-number">0.5</span></span> - level &gt;= <span class="hljs-number"><span class="hljs-number">3</span></span> - level &lt; <span class="hljs-number"><span class="hljs-number">8</span></span> - <span class="hljs-keyword"><span class="hljs-keyword"></span></span>    <span class="hljs-string"><span class="hljs-string">""</span></span>,  <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  ,     - level &gt;= <span class="hljs-number"><span class="hljs-number">8</span></span> - <span class="hljs-keyword"><span class="hljs-keyword"></span></span>    <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  g2 ,       - Segment <span class="hljs-number"><span class="hljs-number">2</span></span>  = <span class="hljs-number"><span class="hljs-number">0.3</span></span> - level &gt;= <span class="hljs-number"><span class="hljs-number">5</span></span> - <span class="hljs-keyword"><span class="hljs-keyword"></span></span>      ,      - <span class="hljs-keyword"><span class="hljs-keyword"></span></span>      ,     - level = <span class="hljs-number"><span class="hljs-number">4</span></span> - <span class="hljs-keyword"><span class="hljs-keyword"></span></span>    ,  <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  ,     - level &gt;= <span class="hljs-number"><span class="hljs-number">8</span></span> - <span class="hljs-keyword"><span class="hljs-keyword"></span></span>     g2   ,   - level &gt;= <span class="hljs-number"><span class="hljs-number">9</span></span> - <span class="hljs-keyword"><span class="hljs-keyword"></span></span>    g1 <span class="hljs-keyword"><span class="hljs-keyword"></span></span> h1,   - level &gt;= <span class="hljs-number"><span class="hljs-number">6</span></span> - <span class="hljs-keyword"><span class="hljs-keyword"></span></span>     ,    - level &gt;= <span class="hljs-number"><span class="hljs-number">5</span></span> - <span class="hljs-keyword"><span class="hljs-keyword"></span></span>      ,      - level &gt;= <span class="hljs-number"><span class="hljs-number">4</span></span> - <span class="hljs-keyword"><span class="hljs-keyword"></span></span>    ,   <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  - Segment <span class="hljs-number"><span class="hljs-number">3</span></span>  = <span class="hljs-number"><span class="hljs-number">0.2</span></span> - level &lt; <span class="hljs-number"><span class="hljs-number">8</span></span> - level &gt;= <span class="hljs-number"><span class="hljs-number">7</span></span> - <span class="hljs-keyword"><span class="hljs-keyword"></span></span>     <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  ,   <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  - level &gt;= <span class="hljs-number"><span class="hljs-number">2</span></span> - X ,     - level = <span class="hljs-number"><span class="hljs-number">1</span></span> -     - level &gt;= <span class="hljs-number"><span class="hljs-number">8</span></span> - level = <span class="hljs-number"><span class="hljs-number">8</span></span> -         <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  , <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  g2  -      , <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  g2  - level = <span class="hljs-number"><span class="hljs-number">9</span></span> -         <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  , <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  g2 , <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  g1 <span class="hljs-keyword"><span class="hljs-keyword"></span></span> h1 -      , <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  g2 , <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  g1 <span class="hljs-keyword"><span class="hljs-keyword"></span></span> h1 -   </code> </pre> <br></div></div><br>  Here, 9 game levels are defined, taking into account various aspects of the current position.  In fact, in a more complex game, like Chess, similar heuristics would control the order of iterating moves (to see the ‚Äúbest‚Äù moves first).  Our game is easier.  In it, heuristics can be used directly to select the ‚Äúbest‚Äù move.  As I said above, this is quite enough for the program to play at about the same level as the person. <br><br>  Here it is, ‚ÄúForgotten Game of Ur‚Äù, which we received as a result: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/WGzVWT5Jk5A" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  This game is really nice to play!  She brings me back to the times when we visited each other not only to drink and eat.  Yes, then the grass was greener and the trees higher, but that was not the point.  We almost stopped playing Chess and Checkers.  We are not going to families to play Bridge.  Go and Shogi are unattainable exotic for most of us.  Even the old dominoes disappeared from the yard somewhere.  <a href="http://ru.wikipedia.org/wiki/Homo_Ludens">Homo Ludens</a> - ‚ÄúThe Man Playing‚Äù has forgotten about board games.  Of course, the development of just one game for iOS and Android will not fix this, but perhaps in some way it will help to restore interest in board games?  I hope so. <br></div><p>Source: <a href="https://habr.com/ru/post/225631/">https://habr.com/ru/post/225631/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../225621/index.html">8 ‚Ä≥ windows-tablet - peripherals and programs</a></li>
<li><a href="../225623/index.html">About higher education</a></li>
<li><a href="../225625/index.html">Why success stories are so useless</a></li>
<li><a href="../225627/index.html">Useful tools for development on Laravel</a></li>
<li><a href="../225629/index.html">Translation of Unity3D documentation</a></li>
<li><a href="../225633/index.html">DevConf 2014 - will be held this Saturday. New Storage section - will reveal all the secrets of data storage</a></li>
<li><a href="../225635/index.html">C ++ drivers for STM8L051F3</a></li>
<li><a href="../225637/index.html">Ideas underlying responsive emails</a></li>
<li><a href="../225639/index.html">Mikrotik and GNS3</a></li>
<li><a href="../225641/index.html">New Optional class in Java 8, not a panacea for NullPointerException</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>