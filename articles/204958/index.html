<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Back to the Upper Paleolithic technologies, from everyone's favorite REST, STATEless, CRUD, CGI, Fast–°GI and MVC</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""Only with the death of dogma does science begin." 
 // Galileo Galilei 

 ‚ÄúI began to envy the slaves. They know everything in advance. They have str...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Back to the Upper Paleolithic technologies, from everyone's favorite REST, STATEless, CRUD, CGI, Fast–°GI and MVC</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/getpro/habr/post_images/5b0/5dd/add/5b05ddadd5200113e662be77a83dcc07.jpg">  <i><b>"Only with the death of dogma does science begin."</b></i> <i><br></i>  <i>// Galileo Galilei</i> <br><br>  <i><b>‚ÄúI began to envy the slaves.</b></i>  <i><b>They know everything in advance.</b></i>  <i><b>They have strong convictions. ‚Äù</b></i> <i><br></i>  <i>// x / f Mark Zakharov "Kill the Dragon" based on the play by Evgeny Schwartz</i> <br><br>  For a couple of years and a day has not passed, so I did not hear (or did not read) from people starting new projects, a phrase like <b>"Take the server engine for the REST API and MVC, and drove off</b> . <b>"</b>  At first I thought that these words have one source, maybe a book that was delivered to all the stores or somewhere in the top of the search engines is an article that zombies developers.  If you find out from them what they mean by REST and MVC, then you can be damaged by the mind.  Well, with MVC everything is already clear, I <a href="http://habrahabr.ru/post/117791/">wrote</a> about this a <a href="http://habrahabr.ru/post/117791/">long time ago</a> , nothing has changed, it only worsened, it‚Äôs worth typing in Google Images <a href="https://www.google.com/search%3Fq%3Dmvc%26tbm%3Disch"><b>"mvc" and we will see the scary</b></a> , arrows in any direction.  Well, about the REST answer the following: well, we need to call server methods from the browser GUI and mobile application, for example: <b>setUserCity (userId, cityId)</b> or <b>calculateMatrix (data)</b> or <b>startVideoConverter (options, source, destination)</b> and then we will encounter heavy load and the REST architecture will solve everything.  Then I ask questions, from which the eyes are rounded already by those who have recently burned with righteous faith, rushed into battle and knew exactly what was happening in this world.  Now we can proceed to the consideration of <b>terminological catastrophe</b> , in the epicenter of which we are staying. <br><a name="habracut"></a><br><h4>  MVC Questions </h4><br>  <b>First question:</b> draw me a ‚Äúwhat is MVC?‚Äù Diagram.  What I get: <br><img src="https://habrastorage.org/getpro/habr/post_images/d3d/9db/454/d3d9db4544447e30cddcdfd79091cf02.png"><br>  For MVP, such understandings and schemes are also sufficient, do not even hesitate. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>The second question:</b> how can this pattern intended for user interfaces be applied on the server? <br>  I can not list here all the possible answers.  But the correct one is very rare and it‚Äôs like this: on the MVC server, it can only be if our user interface is fully implemented on the server, i.e.  There is no browser code, the interface is generated on the server, and the browser simply shows it. <br><br>  <b>The third question:</b> how did you manage to combine MVC with REST? <br>  I will not hold back, I will publish common options: <br><ul><li>  Well, of course, MVC is implemented using REST </li><li>  Well, of course, our REST is implemented using MVC </li></ul><br>  I can not comment on this, it is absolutely clear that we are dealing with a <b>terminological catastrophe</b> , but more on that later. <br><br><h4>  REST Questions </h4><br>  <b>The first question is:</b> well, my dear, how can these setUserCity, calculateMatrix and startVideoConverter be implemented on REST? <br>  My answer: the whole point of REST is that it operates on files, each of which has its own unique URL and only HTTP methods can be performed on this file: GET, PUT, POST, DELETE.  Therefore, all those of your own setUserCity will be kindly replaced with HTTP POST / user / id and you need to send there a completely serialized user.  Or another option, you need for each user parameter to have a separate URL.  Obviously, CRUD methods (create, read, update, delete), called via HTTP methods, are enough to manipulate files or objects in the database.  For example, to enter forms and forms, save them to tables with further deletion and editing.  But any modern application can not be reduced to such primitive challenges.  And developers, most often, understand REST as its opposite - <b>RPC</b> (remote procedure call), when we can do as many methods as possible, not just CRUD, and when a single URL can give completely different answers, depending on which user He was called, with what parameters and in what sequence.  And this is not a REST at all, for example, Habr issues at <a href="http://habrahabr.ru/tracker/">http://habrahabr.ru/tracker/ a</a> different list for each of us and this is everywhere, on Google, Facebook, Github, etc.  So, remove the misleading word REST, do the API and that's it. <br><br>  <b>The second question:</b> okay, what is REST for you? <br>  The range of opinions here is not as wide as for MVC, but the <b>terminological catastrophe</b> is this: as I showed above, REST is understood not as REST, but to make everyone go to science and study dogmatic literature on REST, look for frameworks with REST support, and as a result, RPC and REST hybrid come out.  And worst of all, that all this happens <b>unconsciously</b> . <br><br>  <b>The third question:</b> can you explain how exactly REST will save you from large loads? <br>  My answer: he is <b>STATEless</b> , but what does this mean and why should we give up the state on the server - we will discuss below. <br><br><h4>  What is the meaning of STATEless </h4><br>  When scaling, <s>modern</s> web servers spawn separate processes for each request.  If these processes are STATEless, then there is no difference, the system works on one server or hundreds of servers.  Each process receives request data via the <b>CGI</b> protocol and must allocate memory, deploy its data structures in it, if necessary, create connections to the database, read files or make calls to external modules.  Then the process will perform its logic and all this economy is killed.  Such procedures delay the execution of HTTP requests, so there is FastGI, which provides for several always running processes and saves time on their generation, on initial allocation of memory, on its release and on completion of processes.  Another FastGI allows you to reuse connections to the database and other descriptors.  But the memory structures needed to process each HTTP request still do not live long, they die and are created, and at the same time, queries are executed in the database, accessing files and external modules.  But even in this case, it is necessary to adhere to the STATEless principle, because it is not known which process the next HTTP request falls into.  And different requests may relate to different <s>sites</s> applications, and even in the same application may relate to different sessions or provide for the deployment in memory of very different data structures. <br><br><h4>  It is happiness for a programmer from the Upper Paleolithic </h4><br>  At the time when my programming worldview was developing (1997-2002), the <b>three-tier</b> application <b>architecture</b> (window client, application server, DBMS) was the mainstream.  And clients interacted with application servers by RPC.  Everything was STATEful, but then there were no such tasks that would require scaling the application server on many machines.  And so, for many years, from 2002 to 2012, I endured REST and STATEless, dreaming in my heart about full-fledged STATEful programming and RPC for high-load systems.  Now, when most languages ‚Äã‚Äãand platforms have their Event-Loop solutions, like Node.js, Python's Twisted and the Ruby Event Machine, I feel like a completely happy person and I don‚Äôt know anymore why STATEless is needed and where phrases like <b>‚Äú Take the server engine for REST API and MVC, and drove</b> . <b>"</b> <br><br>  Since the opportunity to make highly loaded application servers with a state appeared, the processes began to live again for a long time, all data structures can be left in memory, connections to the database, caches, timers remain, a complex model can be deployed in memory and it will sit there for a month .  And the client part can interact with this model through the API.  And now a bit of arithmetic, imagine that the user state is 32Kb, and we have 16GB of memory, which is enough for 524288 (more than half a million) users. <br><br>  The only thing left to solve is how to send all requests related to the same session to the same process.  That is, you need to <b>"glue" the</b> session to the server and to the process (the process can be on one of many servers).  To do this, we have hardware and software balancers that implement <b>adhesion by IP</b> (ip-sticky) and cookie (cookie-sticky).  Of course, each process must mark with a cookie with its identifier all requests that do not have such an identifier.  If there is an identifier, then sticking works, and if not, then <b>round robin</b> or a more complex balancing algorithm. <br><br><h4>  And with MVC, we have not finished </h4><br>  MVC taught everyone to separate the model, the view and the controller, and thoughtlessly where and where not.  But a common understanding of each component has not been developed.  Someone leaves only the parameters in the model, and the methods brings to the controller, and some models are able to save and restore themselves from the database, others are violent opponents of this approach and allocate another data access layer to access the database.  In any case, you need to do something with a <b>terminological catastrophe</b> . <br><br>  I propose to use the word <b>‚Äúmodel‚Äù</b> as it is customary to use it in science and technology, namely, this is a <b>simplified representation of a real system and / or process</b> .  From this it follows that the model may contain parameters and methods.  But these methods must fit the definition.  For example, CRUD methods cannot be part of the model of a real-world object, because no real object can create or delete itself.  CRUD is not part of the model, but part of the data storage layer API, just like drawing methods are part of the graphics layer API.  The model should not know anything about its storage, transmission protocols over the network, features of rendering in the browser, etc.  A good example of a method for a model is: SteppingMotor.setSpeed ‚Äã‚Äã(x) when the model is a physical device driver or is used to model a physical device.  Another good example is mathematical models, for example Equation.calculateRoots ().  And the third example is information models, for example: Patient.assignBed (bedId). <br><br>  The words ‚Äúview‚Äù and ‚Äúcontroller‚Äù are avoided whenever possible, only because in the minds of individual developers they may have completely unpredictable and strange meanings.  Instead, it is better to use more specific concepts such as ‚Äútemplate‚Äù, ‚Äúcontrol‚Äù (or ‚Äúuser interface control‚Äù), ‚Äúrequest router‚Äù, etc. <br><br><h4>  Application Tips for Upper Paleolithic Technology </h4><br>  From event-oriented solutions, I personally use Node.js, but I think that they can be universal: <br>  1. Separate client and server (browser application and network API) according to the principles of RPC and STATEful with gluing sessions to processes. <br>  2. Use RAM, do not climb into the database constantly.  STATEful is a great opportunity to write fast applications, and not even because Event Loop frameworks offer non-blocking I / O, but because of proper memory usage.  Most I / O operations do not even need to be done during query processing, reading can be done proactive and parallel, and writing is lazy (lazy).  Expand data into the memory of the application, build hashes, objects, arrays that will live a long and happy life in the STATEful process. <br>  3. Interact between different processes via ZeroMQ (and other MQ), TCP, HTTP, IPC, and anything else.  Thus, the data of different processes, depending on what this data is, can either be duplicated in memory (cached if it is common data) or be divided into ‚Äústicky‚Äù sessions or synchronized with each other through interprocess communication. <br><br><h4>  Conclusion </h4><br>  <b>Rethink</b> design <b>patterns</b> every time.  do not take other people's decisions just because of their credibility, they may not be bad, but not for your case.  It is possible and necessary to take decisions, but only with their full digestion and understanding. <br>  <b>Always check the terminology</b> with your colleagues even before the start of the project and specify it up to the creation of the dictionary in the public domain.  With the confusion of concepts that has accumulated in our time, it is impossible to be sure that you are talking about the same thing, even if you use the same words. <br><br>  <b>UPD: The</b> comments below are the best proof of a <b>terminological catastrophe</b> .  It turns out there is no common understanding, not only in what <b>REST</b> and <b>MVC are</b> , but even in what <b>stateless</b> and <b>statefull are</b> .  And even more interesting, there is no common understanding of what a <b>‚Äústate‚Äù</b> is.  Someone understands this as the <b>state of the process</b> (its memory), someone the <b>status of all servers</b> (then the state may be in another process), and someone the <b>state of the system as a whole</b> (then the stored files and data in the database can be considered as a state) .  In such a situation, it is better to <b>discard the old terms</b> , spoiled and stained, the meaning of which no longer has any hope of agreeing to introduce new ones, but making already <b>strict dictionary definitions</b> .  Otherwise, there is nothing to talk about at all, it is impossible to build a dialogue, speaking in words, but about completely different concepts. </div><p>Source: <a href="https://habr.com/ru/post/204958/">https://habr.com/ru/post/204958/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../204942/index.html">Ciklum Speakers' Corner "Centralized Log Management and Monitoring of Java Applications"</a></li>
<li><a href="../204948/index.html">The code to launch US atomic bombs: 00000000</a></li>
<li><a href="../204952/index.html">IconBIT CALLISTO 100 review: how to turn a smart watch into a smartphone</a></li>
<li><a href="../204954/index.html">24 ways to finally find a good specialist</a></li>
<li><a href="../204956/index.html">Math Focus for MP3, JPEG and Homer Simpson</a></li>
<li><a href="../204960/index.html">Tesla Model S car was sold in California using Bitcoin as a means of payment</a></li>
<li><a href="../204964/index.html">The final of the open competition in programming artificial intelligence Russian AI Cup 2013</a></li>
<li><a href="../204966/index.html">Windows Azure Blob-storage: CORS support</a></li>
<li><a href="../204968/index.html">Stupid sorting and some others, smarter</a></li>
<li><a href="../204970/index.html">We decided to change the operator? Do not forget to find a favorable rate with the help of Dr. Tariff</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>