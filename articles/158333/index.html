<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We visualize geoinformation from logs on a web map in real time.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In order to avoid ambiguities, I will outline the essence. When applying for a new job, I was given a test task, which can be briefly described as: ‚ÄúW...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We visualize geoinformation from logs on a web map in real time.</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/71e/b65/f4c/71eb65f4c898dc7688a7d89dbd5ecc65.jpg"><br><br>  In order to avoid ambiguities, I will outline the essence.  When applying for a new job, I was given a test task, which can be briefly described as: ‚ÄúWrite an analogue of <a href="http://blog.mozilla.org/website-archive/2011/06/14/glow-1-0/">Glow</a> for geovizualizing the events of users entering the online store.‚Äù  Simply put, it is necessary to monitor the system log for the occurrence of certain events and, in the case of these, perform (in this case) a point on the map, which will be determined by the user's IP address.  The goal of implementation: to create a pleasant-looking ‚Äútoy‚Äù for presentational purposes, capable of immersing the beholder into nirvana of harmony and aesthetic pleasure.  The main condition was the use of Java technologies in the development of the stack, which caused many decisions to be made.  In addition, it was decided to implement this in the form of a one-page site.  And since I was extremely familiar with Java and the web (I wrote mostly in C / C ++), I had to learn a lot.  Well, we will understand together. <br><blockquote>  The article is intended for interested and beginners, however, it does not ‚Äúchew on‚Äù simple things that can be read with the help of documentation or specialized articles.  The most useful resources, a link to the sources (distributed under the <a href="http://opensource.org/licenses/BSD-3-Clause">BSD license</a> ) and a <b>link to the working version</b> are given at the end of the article. </blockquote><br><a name="habracut"></a><br><blockquote>  And in general, why not use the source code of the above Glow?  First, they are quite specific for the amount of data Mozilla was using ‚Äî remember the number of Firefox installations on the launch day, and also the fact that their logging system is decentralized.  In our case, about 100 records per second are written to a single log file at the peak, of which only a part needs to be visualized.  Secondly, the map in Glow is not the most pleasant in appearance.  And thirdly, this is a test task :) </blockquote><br><h4>  Quick look </h4><br>  What is required from our mini-system? <br><ul><li> Keep track of updates in the log file (such as <a href="http://www.linuxmanpages.com/man1/tail.1.php"><code>tail -f</code></a> ).  In addition, it should be noted that once a day the log file is closed and carefully archived, and a new file takes its place, that is, you need to monitor these actions and switch to the current log. </li><li>  Determine the type of event corresponding to each new record in the log, and if it is necessary to display it on the map as a point, allow (rezolvit) the coordinates of the point by the IP address contained in the record. </li><li>  Event data must be transmitted in real time to clients (in this case, to the script in the client‚Äôs browser). </li><li>  The client script should deal with the output of information in the form of a neat card with points on it, which are colored according to the type of the corresponding event. </li></ul><br>  After conducting a small study on each item, it was decided the following.  Watching the log, parsing the entries, resolving the IP will be a small java daemon (it sounds funny, I understand, but nothing), which will send the data to the server via HTTP POST.  This will then make it easy to change parts of the system without a headache.  The server will also be a part-time servlet container, for which we will write the corresponding servlet.  As a client side, there should be some kind of cartographic widget (render map) that will communicate with the server asynchronously.  There are several main ways (more details in article <a href="https://habr.com/ru/post/158333/">[1]</a> and review <a href="https://habr.com/ru/post/158333/">[2]</a> ): <br><ol><li>  Comet.  The client connects to the server, and the server does not terminate the connection, but keeps it open, which allows you to immediately send it to the client when it arrives (push).  As an option - the use of technology <a href="http://www.websocket.org/">WebSocket</a> . </li><li>  Frequent polls.  The client with the specified frequency polls the server for new data. </li><li>  "Long" polls (long polling).  Something in between the previous two ways.  The client requests new data from the server, and if there is no such data on the server yet, the server does not close the connection.  When data is received, it is sent to the client, and the latter in turn again sends a request for new data. </li></ol><br>  The choice fell on long polling, because WebSocket is <a href="http://caniuse.com/">not</a> supported by <a href="http://caniuse.com/">all browsers</a> , and frequent polls simply eats away traffic for nothing, exploiting server resources.  In addition, the web server (partly servlet-container) Jetty allows you to use the <a href="http://en.wikipedia.org/wiki/Continuation">continuations</a> technique to process long polling requests (see <a href="https://habr.com/ru/post/158333/">[1]</a> ).  But let me tell you, where is realtime here?  We are not writing an embedded system for airplanes, but a neat presentation map, so the delays between the user's action and the point on the observer map in 1-2 seconds are not so critical, is it? <br>  Among the mapping engines, <a href="http://leafletjs.com/">Leaflet</a> was chosen as one of the most pleasant-looking and having a simple, friendly API.  Also, pay attention to good Leaflet browsers support. <br>  Well, let's proceed to implementation, and we will solve the problems at the place of receipt. <br><br><h4>  Get data from the log </h4><br>  How to keep track of updates to the log, given its periodic archiving-creation?  You can use, for example, the <a href="http://commons.apache.org/io/apidocs/org/apache/commons/io/input/Tailer.html"><code>Tailer</code></a> class from the well-known <a href="http://commons.apache.org/">Apache Commons</a> library, but we will go our own, partly in a similar way.  Our <a href=""><code>TailReader</code></a> class <a href=""><code>TailReader</code></a> initialized by the directory in which the log is located, with a <a href="http://www.regular-expressions.info/">regular schedule</a> that describes the name of the log file (since it can change) and the update period ‚Äî the time through which we will periodically check for new entries in the log.  The class interface resembles working with standard I / O streams (streams), however, it blocks the execution process when calling <code>nextRecord()</code> , if no new entries appear in the log.  To check for new entries (without blocking), you can use the <code>hasNext()</code> method.  Since the log is monitored in a separate thread (not to be confused with I / O, thread), there are <code>start()</code> and <code>stop()</code> methods for controlling the operation of the thread.  If the file stream is closed (the log has been sent for archiving), after a set number of attempts to read, the class object will decide that it is time to open a new log.  The log is searched for according to the rules specified in <code>getLogFile()</code> : <br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">/** *      - * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> -  null    */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> File </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getLogFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ File logCatalog = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(logFileCatalog); File[] files = logCatalog.listFiles(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileFilter() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">accept</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(File pathname)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> pathname.canRead() &amp;&amp; pathname.isFile() &amp;&amp; pathname.getName().matches(logFileNamePattern); } }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span> == files.length) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (files.length &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) Arrays.sort(files, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Comparator&lt;File&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">compare</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(File o1, File o2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) (o1.lastModified() - o2.lastModified()); } }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> files[files.length - <span class="hljs-number"><span class="hljs-number">1</span></span>]; }</code> </pre><br>  After we have learned to follow the updates of the log, it is necessary to do something with these updates.  First of all, it is necessary to determine the type of this event, and if it is necessary to display it on the map, pull out the client's IP and rezolvit it to geo-coordinates. <br>  The <a href=""><code>RecordParser</code></a> class, as it is not difficult to guess, analyzes the lines of the log file using regular expressions.  The <code>LogEvent parse(String record)</code> method returns a simple object that encapsulates the event type and IP address, or <code>null</code> if we are not interested in the given log record (this, by the way, is not the best practice in the world of Java development - it's better to use the <a href="http://en.wikipedia.org/wiki/Null_Object_pattern">Null</a> pattern <a href="http://en.wikipedia.org/wiki/Null_Object_pattern">Object</a> ).  In this case, the records are also filtered from the requests of search robots (they are not exactly users of the store, right?). <br>  Finally, the <a href=""><code>IpToLocationConverter</code></a> class <a href=""><code>IpToLocationConverter</code></a> with resolving IP addresses to their respective geo-coordinates using the <a href="http://www.maxmind.com/en/home">Maxmind</a> ( <a href="https://github.com/maxmind/geoip-api-java">Java API to it</a> ) and <a href="http://ipgeobase.ru/">IpGeoBase services</a> (accessed through the <a href="http://blog.ipgeobase.ru/%3Fp%3D76">XML API</a> , which is encapsulated in the <a href="https://github.com/injecto/geowid/tree/master/geowidd/src/com/ecwid/geowid/daemon/resolvers"><code>com.ecwid.geowid.daemon.resolvers</code></a> package ).  Maxmind rather lousy rezolvit Russian addresses, so we use an additional IpGeoBase.  The Maxmind API is trivial, the resolving is done through a database file located locally.  For IpGeoBase, a <a href="">resolver</a> was written that caches calls to the service for obvious reasons. <br>  In order not to load the server, we will send it data in batches of several pieces so that the records in one pack differ slightly in time.  For this, objects of the points accumulated for visualization on the map (class <a href=""><code>Point</code></a> ) are stored in a buffer - an object of the <a href=""><code>PointsBuffer</code></a> class and ‚Äúreset‚Äù when it is filled into the server in JSON format (serializing objects using <a href="http://code.google.com/p/google-gson/">Gson</a> ). <br>  The entire logic of the daemon is in the <a href=""><code>GeowidDaemon</code></a> class.  The daemon settings are stored in XML (vulgarity on my part, it would be possible to <a href="http://en.wikipedia.org/wiki/.properties">manage</a> properies or <a href="http://www.yaml.org/">YAML</a> files, but I wanted to try <a href="http://www.oracle.com/technetwork/articles/javase/index-140168.html">XML to Object mapping</a> ).  pay attention to <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">events</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">event</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>def<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pattern</span></span></span><span class="hljs-tag">&gt;</span></span>\b((?:\d{1,3}\.){3}\d{1,3})\b\s+script\.js<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">event</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">event</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>mob<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pattern</span></span></span><span class="hljs-tag">&gt;</span></span>\b((?:\d{1,3}\.){3}\d{1,3})\b\s+mobile:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">event</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">event</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>api<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pattern</span></span></span><span class="hljs-tag">&gt;</span></span>\b((?:\d{1,3}\.){3}\d{1,3})\b\s+api:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">event</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">events</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Types of events: <code>def</code> - the opening of the "ordinary" casterer; <code>mob</code> - the opening of the mobile casterer; <code>api</code> - the service API call.  The type is determined by the location in the log of the substring corresponding to a particular regular program in which the IP is allocated to the group. <br>  To launch the daemon in the vastness of the network, a wonderful <a href="http://shrubbery.mynetgear.net/c/display/W/Java%2BDaemon%2BStartup%2BScript">script</a> was found. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Distribute data to customers </h4><br>  Let's rock, what's up with the vaunted continuations in API Jetty (let's agree to use the 7th version of the server)?  This is perfectly written in the documentation <a href="https://habr.com/ru/post/158333/">[3]</a> , including code examples.  And we will use them.  Our servlet <a href=""><code>GeowidServlet</code></a> minimalist: it can receive data from a daemon and give it to clients.  The most interesting in this respect is the following code: <br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doPost</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> ServletException, IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">synchronized</span></span> (continuations) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Continuation continuation : continuations.values()) { continuation.setAttribute(resultAttribute, req.getParameter(requestKey)); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { continuation.resume(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IllegalStateException e) { <span class="hljs-comment"><span class="hljs-comment">// ok } } continuations.clear(); resp.setStatus(HttpServletResponse.SC_OK); } } @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { String reqId = req.getParameter(idParameterName); if (null == reqId) { resp.sendError(HttpServletResponse.SC_BAD_REQUEST, "Request ID needed"); logger.info("Request without ID rejected [{}]", req.getRequestURI()); return; } Object result = req.getAttribute(resultAttribute); if (null == result) { Continuation continuation = ContinuationSupport.getContinuation(req); synchronized (continuations) { if (!continuations.containsKey(reqId)) { continuation.setTimeout(timeOut); try { continuation.suspend(); continuations.put(reqId, continuation); } catch (IllegalStateException e) { logger.warn("Continuation with reqID={} can't be suspended", reqId); resp.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR); } } else if (continuation.isExpired()) { synchronized (continuations) { continuations.remove(reqId); } resp.setContentType(contentType); resp.getWriter().println(emptyResult); } else { resp.sendError(HttpServletResponse.SC_BAD_REQUEST, "Request ID conflict"); } } } else { resp.setContentType(contentType); resp.getWriter().println((String) result); } }</span></span></code> </pre><br>  What's going on here? <br>  When a client comes for new data, we check the availability of its unique identifier in the GET-request parameters (which, in truth, is pseudo-unique, see the implementation of the client-side, <code>getPseudoGUID()</code> function <a href="">here</a> ), if the ID is not present - we ‚Äúsew‚Äù the client.  This is necessary in order to correctly identify the continuation associated with a particular client.  Next, we check whether the attribute containing the necessary data is set for this request.  Naturally, if the client came to us for the first time, there can be no talk about any data.  Therefore, we create a continuation for it with a given timeout, suspend it and place it in a hash table for storage.  However, there are situations where the continuation timeout has expired, and there is no data as it is, or not.  In this case, checking the <code>if (continuation.isExpired())</code> condition <code>if (continuation.isExpired())</code> helps us; when it passes, the servlet gives the client an empty array in JSON, removing the corresponding continuation from the table as unnecessary. <br>  If the data attribute is set, we simply return this data to the client.  Where does this data come from?  In the POST request handler, of course.  As soon as the daemon sent the data, the servlet goes over the table of ‚Äúsuspended‚Äù continuations, setting an attribute with the data for each one and resuming each (resume), then clearing the table.  It is at this moment that the <code>doGet()</code> method is re-entered for each continuation, but with the data the user needs. <br><blockquote>  You can, for example, measure the mysterious power of these very continuations with the help of a profiler under load.  For this, the author used <a href="http://docs.oracle.com/javase/6/docs/technotes/guides/visualvm/index.html">VisualVM</a> and <a href="http://www.joedog.org/siege-home/">Siege</a> .  From the author testers mediocre, so the test looked very artificial.  JVM ‚Äúwarmed up‚Äù for about an hour, settling into a 15Mb heap space.  After that, with the help of Siege, we load the server with parallel 3000 requests per second (I did not want to poke around in the system to raise the limits for open files, etc.) for 5 minutes.  JVM otshila ~ 250Mb heap space, loading the processor core by ~ 10-15%.  I think a good result for beginners. </blockquote><br><br><h4>  Visualization sir </h4><br><blockquote>  Immediately make a reservation: maybe my JavaScript code will seem ‚Äúnon-canonical‚Äù from the point of view of a professional frontend developer.  To judge those who will understand in my code :) </blockquote><br>  So, use Leaflet.  How do we display points on the map?  Standard markers look inappropriate.  Using png or, forbid W3C, gif, you can not get a nice picture with animation points.  There are two ways: <br><ol><li>  Animation by SVG.  On Habr√© recently skipped a great <a href="http://habrahabr.ru/post/157087/">article</a> on this topic.  Pros: Leaflet already has a great <a href="http://dynmeth.github.com/RaphaelLayer/">plugin</a> (see the demo at the bottom of the page), using the excellent <a href="http://raphaeljs.com/">Rapha√´l</a> library, and this library allows you to draw SVG even on IE6 (more precisely <a href="http://www.w3.org/TR/NOTE-VML">VML</a> ).  Disadvantages: due to the specifics of SVG, the animation on it is quite a resource-intensive operation (imagine yourself in the browser: you will have to parse the XML most of the time and render the graphics in accordance with the changes in it). </li><li>  HTML5's <code><a href="http://www.html5canvastutorials.com/"></a> <a href="http://kineticjs.com/"></a> .    ,  ,   ,   (    www.html5canvastutorials.com  KineticJS). : ,      . :    .</code> <br> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/158333/">https://habr.com/ru/post/158333/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../158321/index.html">Stealthphone Software - cryptographic information protection in mobile phones</a></li>
<li><a href="../158323/index.html">January 30 RIM will show two smartphones on the BlackBerry 10</a></li>
<li><a href="../158325/index.html">Electric dragonfly</a></li>
<li><a href="../158327/index.html">How to set an alarm with Asterisk, FreeBSD and some free time</a></li>
<li><a href="../158329/index.html">Solving the problem "EMFILE, too many open files"</a></li>
<li><a href="../158335/index.html">India has released the second version of the ultra-cheap tablet</a></li>
<li><a href="../158341/index.html">WAT driven development</a></li>
<li><a href="../158343/index.html">AWS: New AWS Asia Pacific Region (Sydney)</a></li>
<li><a href="../158345/index.html">Rutreker listed in the register RosKomNadzor</a></li>
<li><a href="../158347/index.html">How malloc memory eats</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>