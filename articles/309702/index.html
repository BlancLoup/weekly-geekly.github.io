<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We write quine-polyglot-palindromes in honor of the day 2 ^ 2 ^ 3</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Congratulations to all translators of human language to machine with their professional day, I wish you fewer bugs and more or less cool ideas! And as...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We write quine-polyglot-palindromes in honor of the day 2 ^ 2 ^ 3</h1><div class="post__text post__text-html js-mediator-article"><p> <a href="https://habrahabr.ru/post/309702/"><img align="left" alt="PalidromePolyglotQuine" src="https://habrastorage.org/files/b0e/458/9ec/b0e4589ec6494616b28f63c65843d896.png"></a> </p><br><p>  Congratulations to all translators of human language to machine with their professional day, I wish you fewer bugs and more or less cool ideas!  And as an ideological gift, on my part, I propose a solution to one beautiful task - writing code that produces its own text at the output, is valid for interpreters and compilers of various languages, and is correctly executed when reversing the source code. </p><br><p>  Not so long ago, I learned about code that can be simultaneously interpreted in PHP and compiled into Java: <a href="https://gist.github.com/forairan/b1143f42883b3b0ee1237bc9bd0b7b2c">PhpJava.java</a> .  As it turned out, this idea is not new: the code valid for several compilers or interpreters at once is called a <a href="https://en.wikipedia.org/wiki/Polyglot_(computing)">polyglot</a> .  It is possible to write such code due to the peculiarities of processing lines and comments in various interpreters or compilers. <a name="habracut"></a></p><cut></cut><br><p>  For example, in Java, you can describe characters in the usual way, for example, the symbol '/', or in the form of unicode-records: 'u002F'.  In the C # compiler, such entries will not be valid.  However, if they are "hidden" in a comment, then, on the one hand, they will not interfere with the compilation of C # code, on the other, they will be valid in Java code.  For example, if you want code <strong>A to be</strong> compiled only in C #, but not compiled in Java, and code <strong>B</strong> compiled only in Java, but not compiled in C #, you need to use the following snippet: </p><br><pre><code class="hljs tex">//<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>000A<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002F<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002A A//<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002A<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002FB</code> </pre> <br><p>  The C # compiler will "perceive" this code in the usual way, comments will remain comments: </p><br><pre> <code class="hljs tex">//<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>000A<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002F<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002A A//<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002A<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002FB</code> </pre> <br><p>  But with Java all the more interesting, because  The unicode entry is transformed and you get the following: </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// /* A//*/B</span></span></code> </pre> <br><p>  By combining instructions common to both languages, as well as sharing different ones, you can write any program. </p><br><p>  However, tricks are not limited to such unicode entries.  For example, in C-like languages, there are preprocessor directives that can determine which code should be compiled and which should not.  In a non-compiled code, you can put a completely different language code.  For example, the following is a polyglot code in C ++ and Python ( <a href="https://gist.github.com/LionZXY/5916ce355d08d6d43a8b6acd71951c25">from here</a> ), in which Python code is placed in the <code>#if false</code> section.  And the <code>'''</code> sequences begin and end a comment in Python code. </p><br><pre> <code class="hljs go">#include &lt;stdio.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> <span class="hljs-string"><span class="hljs-string">"Hello world"</span></span> <span class="hljs-string"><span class="hljs-string">'''</span></span> #endif <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> main() { printf(<span class="hljs-string"><span class="hljs-string">"Hello world"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } #<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-string"><span class="hljs-string">'''</span></span> #endif</code> </pre> <br><p>  In HTML, for example, comments begin with a sequence of <code>&lt;!--</code> symbols, which can also be used.  There are also more complex polyglots working simultaneously in 6 and in 16 languages.  The first displays the message "hitforum" for all languages, and the second works more interesting: displays the name of the language in which it is compiled or interpreted. </p><br><h3 id="kod-poliglot-na-c-shell-perl-brainfuck-befunge-whitespace">  Polyglot C, Shell, Perl, Brainfuck, Befunge, Whitespace </h3><br><pre> <code class="hljs lua"># define xu /* v # :::::::::::::::::::&gt;&gt;&gt;&gt;&gt;&gt;&gt;$$$a<span class="hljs-string"><span class="hljs-string">"muroftih"</span></span>#[&gt;:#,_@] eval <span class="hljs-string"><span class="hljs-string">'echo "hitforum";exit'</span></span>;<span class="hljs-built_in"><span class="hljs-built_in">sub</span></span> echo { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> <span class="hljs-string"><span class="hljs-string">"@_\n"</span></span>} __END__&gt;++++++++++&gt;++++++++++[&gt;+++++++++++&gt;++++++++++ +&lt;&lt;-]&gt;<span class="hljs-comment"><span class="hljs-comment">------.+.&gt;++++++.&lt;---.+++++++++.&gt;--.+++ .&lt;--.&lt;&lt;. */ main() { printf ("hitforum\n"); }</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">16-language polyglot code</b> <div class="spoiler_text"><pre> <code class="perl hljs"><span class="hljs-comment"><span class="hljs-comment"># /* [ &lt;!-- */ include &lt;stdio.h&gt; /* \ #`{{coding=utf-8\ "true" if 0 != 0 and q != """0" ; ` \ \ if [ -n "$ZSH_VERSION" ]; then \ \ echo exec echo I\'ma zsh script.; \ \ elif [ -n "$BASH_VERSION" ]; then \ \ echo exec echo I\'ma bash script.; \ else \ echo exec echo I\'ma sh script.; \ fi`; #!;#\ BEGIN{print"I'm a ", 0 ? "Ruby" :"Perl", " program.\n"; exit; } #\ %q~ set =dummy 0; puts [list "I'm" "a" "tcl" "script."]; exit all: ; @echo "I'm a Makefile." \ #*/ /*: */ enum {a, b}; \ \ static int c99(void) { #ifndef __cplusplus /* bah */ unused1: if ((enum {b, a})0) \ (void)0; #endif unused2: return a; \ } \ static int trigraphs(void) { \ \ return sizeof "??!" == 2; \ } \ char X; \ \ int main(void) { \ \ struct X { \ \ char a[2]; \ };\ if (sizeof(X) != 1) { \ \ printf("I'm a C++ program (trigraphs %sabled).\n", \ \ trigraphs() ? "en" : "dis");\ \ }else if (1//**/2 )unused3 : { ; \ printf("I'm a C program (C%s, trigraphs %sabled).\n", \ c99() ? "89 with // comments" : "99", \ trigraphs() ? "en" : "dis"); \ } else { \ printf("I'm a C program (C89, trigraphs %sabled).\n", \ trigraphs() ? "en" : "dis"); \ } \ return 0; \ } /* # \ \begin{code} import Prelude hiding ((:)); import Data.List (intercalate); import Language.Haskell.TH; import Data.String; default (S, String, Integer, Double); data S = S; instance Eq S where { _ == _ = False }; instance IsString S where { fromString = const S }; ifThenElse cte = case c of True -&gt; t; False -&gt; e cPP = False; {- #define cPP True -} main :: IO () main = putStr ("I'm a Literate Haskell program" ++ bonus ++ ".\n") where _ = (); bonus | null details = "" | otherwise = " (" ++ details ++ ")" details = intercalate ", " [ name | (True, name) &lt;- extensions ] :: String extensions = (bangPatterns, "BangPatterns" ) : (templateHaskell, "TemplateHaskell" ) : (rebindableSyntax, "RebindableSyntax" ) : (magicHash, "MagicHash" ) : (overloadedStrings, "OverloadedStrings" ) : (noMonomorphismRestriction, "NoMonomorphismRestriction") : (scopedTypeVariables, "ScopedTypeVariables" ) : (cPP, "CPP" ) : (unicodeSyntax, "UnicodeSyntax" ) : (negativeLiterals, "NegativeLiterals" ) : (binaryLiterals, "BinaryLiterals" ) : (numDecimals, "NumDecimals" ) : [] (!) = (!!) bangPatterns = [True] ! 0 where foo !bar = False templateHaskell = thc $(return (TupE []) :: ExpQ) rebindableSyntax = null (do { [()]; [()] }) where _ &gt;&gt; _ = [] :: [()] magicHash = foo# () where foo = ['.']; "." # _ = False; foo# _ = True overloadedStrings = "" /= "" noMonomorphismRestriction = show foo == "0" where foo = 0 bar = foo :: Double unicodeSyntax = let (‚òÖ) = True in (*) where (*) = False negativeLiterals = -1 == NNa binaryLiterals = let b1 = 1 in 0b1 == 1 numDecimals = show 0e0 == "0" scopedTypeVariables = stv (0 :: Double) == "0.0" data{- = -} NN = NNa | NNb deriving Eq; instance Num NN where { fromInteger _ = NNa; negate _ = NNb; _ + _ = NNa; _ * _ = NNa; abs _ = NNa; signum _ = NNa } instance{- = -} (Num a) =&gt; Num (e -&gt; a) where { fromInteger = const . fromInteger; negate = (.) negate; abs = (.) abs; signum = (.) signum; x + y = \e -&gt; xe + ye; x * y = \e -&gt; xe * ye } class THC a where { thc :: a -&gt; Bool }; instance THC () where { thc _ = True }; instance THC (Q a) where { thc _ = False }; class (Show a, Num a) =&gt; STV a where stv :: a -&gt; String stv = const $ show (f 0) where f = id :: a -&gt; a instance STV Double -- : \ \end{code} # \ ]&gt;++++++++[&lt;+++++++++&gt;-]&lt;+.&gt;&gt;++++[&lt;++++++++++&gt;-]&lt;-.[-]&gt;++++++++++ \ [&lt;+++++++++++&gt;-]&lt;-.&gt;&gt;++++[&lt;++++++++&gt;-]&lt;.&gt;&gt;++++++++++[&lt;++++++++++&gt; \ -]&lt;- - -.&lt;.&gt;+.-&gt;&gt;++++++++++[&lt;+++++++++++&gt;-]&lt;++++.&lt;.&gt;&gt;&gt;++++++++++[ \ &lt;++++++++++&gt;-]&lt;+++++.&lt;&lt;&lt;&lt;+.-&gt;&gt;&gt;&gt;- - -.&lt;+++.- - -&lt;++.- -&gt;&gt;&gt;&gt;&gt;+++++ \ +++++[&lt;+++++++++++&gt;-]&lt;- - -.&lt;&lt;&lt;&lt;&lt;.&lt;+++.&gt;&gt;&gt;.&lt;&lt;&lt;-.- -&gt;&gt;&gt;&gt;+.&lt;.&lt;.&lt;&lt;.&gt; \ ++++++++++++++.[-]++++++++++""" else 0 # \ from platform import * # \ print("I'm a Python program (%s %s)." % # [-][ \ (python_implementation(), python_version())); """--&gt;&lt;html&gt;&lt;head&gt; &lt;!--:--&gt;&lt;title&gt;I'm a HTML page&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;!--:--&gt;&lt;h1&gt;I'm a &lt;marquee&gt;&lt;blink&gt;horrible HTML&lt;/blink&gt;&lt;/marquee&gt; page&lt;/h1&gt; &lt;!--:--&gt;&lt;script language="JavaScript"&gt; &lt;!--: # \ setTimeout( // \ function () { // \ document.body.innerHTML = "&lt;h1&gt;I'm a javascript-generated HTML page&lt;/h1&gt;"; // \ }, 10000); // \ //--&gt; &lt;/script&gt;&lt;!--: \ &lt;/body&gt;&lt;/html&gt;&lt;!-- }} # \ say "I'm a Perl6 program."; # """ # */ #define FOO ]--&gt;~</span></span></code> </pre> </div></div><br><h2 id="kvayn-poliglot">  Quine polyglot </h2><br><p>  In order to write a quine polyglot in C # and Java, it is necessary to combine the principles of quine and polyglot development.  As it turned out, such a topic is not new: on the website codegolf, users are competing who has a quinte polyglot or polyquine a shorter time: <a href="http://codegolf.stackexchange.com/questions/37464/write-a-polyquine">Write a Polyquine</a> .  However, in this question there were no options with more verbose C # and Java languages, which I wanted to correct. </p><br><p>  To write such a quine-polyglot, you need to escape characters that are prohibited in the strings of both languages ‚Äã‚Äãand are found in the strings of the program itself.  These characters are quotation marks ", line break \ n, and backslash \. And to further reduce the size of the code, repeated sequences of characters, such as \ u000A, \ u002F, and \ u002A, were also replaced with single characters in the encoding string itself. Here is an example the resulting quine polyglot valid for C # and Java compilers: </p><br><h3 id="polyglotquinecsjava-757-simvolov">  PolyglotQuine.cs.java, 757 characters: </h3><br><pre> <code class="hljs tex">//<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>000A<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002F<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002A using System;//<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002A<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002F class Program{public static void//<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>000A<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002F<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002A Main//<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002A<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span>002Fmain (String[]z){String s="//@#'^using System;//'#^class Program{public static void//@#'^Main//'#main^(String[]z){String s=!<span class="hljs-formula"><span class="hljs-formula">$!,t=s;int[]a=new int[]{33,94,38,64,35,39,36};String[]b=new String[]{!&amp;!!,!&amp;n!,!&amp;&amp;!,!&amp;@!,!&amp;#!,!&amp;'!,s};for(int i=0;i&lt;7;i++)t=t.//@#'^Replace//'#replace^(!!+(char)a[i],b[i]);//@#'^Console.Write//'#System.out.printf^(t);}}",t=s;int[]a=new int[]{33,94,38,64,35,39,36};String[]b=new String[]{"</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">"</span></span></span></span></span><span class="hljs-formula">","</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">n</span></span></span></span></span><span class="hljs-formula">","</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span></span><span class="hljs-formula">","</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span></span><span class="hljs-formula">u000A","</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span></span><span class="hljs-formula">u002F","</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">\</span></span></span></span></span><span class="hljs-formula">u002A",s};for(int i=0;i&lt;7;i++)t=t.//</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span></span><span class="hljs-formula">000A</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span></span><span class="hljs-formula">002F</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span></span><span class="hljs-formula">002A Replace//</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span></span><span class="hljs-formula">002A</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span></span><span class="hljs-formula">002Freplace (""+(char)a[i],b[i]);//</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span></span><span class="hljs-formula">000A</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span></span><span class="hljs-formula">002F</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span></span><span class="hljs-formula">002A Console.Write//</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span></span><span class="hljs-formula">002A</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">u</span></span></span></span></span><span class="hljs-formula">002FSystem.out.printf (t);}}</span></span></code> </pre> <br><h2 id="kvayn-poliglot-palindrom">  Quine Polyglot Palindrome </h2><br><p>  Further complicating the task: try to write a quine polyglot palindrome.  Let me remind you that a palindrome is a number or text that is equally readable in both directions.  I <a href="https://habrahabr.ru/post/189192/">described the</a> principle of developing quayns-palindromes <a href="https://habrahabr.ru/post/189192/">in an article</a> 3 years ago, also on the day of the programmer.  The principle of the palindrome code is that the mirror part of the program is placed in a single-line or multi-line comment, which does not interfere with the compilation.  The simplest C # code palindrome in C # looks like this: </p><br><pre> <code class="hljs cs"><span class="hljs-comment"><span class="hljs-comment">/**/</span></span><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">P</span></span>{<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{}};<span class="hljs-comment"><span class="hljs-comment">/*/;}}{)(niaM diov citats{P ssalc/**/</span></span></code> </pre> <br><p>  As you can see, the multi-line comment <code>/*</code> starts from the middle and continues to the end, where it is closed by the sequence <code>*/</code> .  An empty comment at the beginning is needed to make the line completely symmetrical. </p><br><p>  So, combining the principles of creating a palindrome, polyglot and quine, I wrote the following code: </p><br><h3 id="palidromepolyglotquinecsjava-1747-simvolov">  PalidromePolyglotQuine.cs.java, 1747 characters: </h3><br><pre> <code class="hljs markdown">/<span class="hljs-strong"><span class="hljs-strong">**///\u000A\u002F\u002A using System;//\u002A\u002F class Program{public static void//\u000A\u002F\u002A Main//\u002A\u002Fmain (String[]z){String s="`**</span></span>?<span class="hljs-code"><span class="hljs-code">`@#_^using System;?_#^class Program{public static void?@#_^Main?_#main^(String[]z){String s=!$!,t=s;int i;int[]a=new int[]{33,94,38,64,35,95,96,63,36};String[]b=new String[]{!&amp;!!,!&amp;n!,!&amp;&amp;!,!&amp;@!,!&amp;#!,!&amp;_!,!`</span></span>!,!?!,s};for(i=0;i<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">9;i++)t=t.?@#_^Replace?_#replace^(!!+(char)a[i],b[i]);t+='*';for(i=872;i</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>=0;i--)t=t+t?@#<span class="hljs-emphasis"><span class="hljs-emphasis">_^[i];Console.Write?_</span></span>#.charAt(i);System.out.printf^(t);}}/",t=s;int i;int[<span class="hljs-string"></span><span class="hljs-string"></span>]a=new int[<span class="hljs-string"></span><span class="hljs-string"></span>]{33,94,38,64,35,95,96,63,36};String[<span class="hljs-string"></span><span class="hljs-string"></span>]b=new String[<span class="hljs-string"></span><span class="hljs-string"></span>]{"\"","\n","\\","\\u000A","\\u002F","\\u002A","/","//",s};for(i=0;i<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">9;i++)t=t.</span></span></span></span><span class="xml"><span class="hljs-tag">//\</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">u000A</span></span></span></span><span class="xml"><span class="hljs-tag">\</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">u002F</span></span></span></span><span class="xml"><span class="hljs-tag">\</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">u002A</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Replace</span></span></span></span><span class="xml"><span class="hljs-tag">//\</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">u002A</span></span></span></span><span class="xml"><span class="hljs-tag">\</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">u002Freplace</span></span></span></span><span class="xml"><span class="hljs-tag"> (""+(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">char</span></span></span></span><span class="xml"><span class="hljs-tag">)</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">a</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">],</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">b</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">]);</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">t</span></span></span></span><span class="xml"><span class="hljs-tag">+=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'*'</span></span></span></span><span class="xml"><span class="hljs-tag">;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">for</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">872;i</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>=0;i--)t=t+t//\u000A\u002F\u002A [<span class="hljs-string"><span class="hljs-string">i</span></span>];Console.Write//\u002A\u002F.charAt(i);System.out.printf (t);}}/<span class="hljs-emphasis"><span class="hljs-emphasis">*/}};)t( ftnirp.tuo.metsyS;)i(tArahc.F200u\A200u\//etirW.elosnoC;]i[ A200u\F200u\A000u\//t+t=t)--i;0=&gt;i;278=i(rof;'*</span></span>'=+t;)]i[<span class="hljs-string"><span class="hljs-string">b,</span></span>]i[<span class="hljs-string"><span class="hljs-string">a)rahc(+""( ecalperF200u\A200u\//ecalpeR A200u\F200u\A000u\//.t=t)++i;9&lt;i;0=i(rof;}s,"//","/","A200u\\","F200u\\","A000u\\","\\","n\",""\"{</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">gnirtS wen=b</span></span>][<span class="hljs-string"><span class="hljs-string">gnirtS;}63,36,69,59,53,46,83,49,33{</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">tni wen=a</span></span>][<span class="hljs-string"><span class="hljs-string">tni;i tni;s=t,"/}};)t(^ftnirp.tuo.metsyS;)i(tArahc.#_?etirW.elosnoC;</span></span>]i[<span class="hljs-string"><span class="hljs-string">^_#@?t+t=t)--i;0=&gt;i;278=i(rof;'*'=+t;)</span></span>]i[<span class="hljs-string"><span class="hljs-string">b,</span></span>]i[<span class="hljs-string"><span class="hljs-string">a)rahc(+!!(^ecalper#_?ecalpeR^_#@?.t=t)++i;9&lt;i;0=i(rof;}s,!?!,!`!,!_&amp;!,!#&amp;!,!@&amp;!,!&amp;&amp;!,!n&amp;!,!!&amp;!{</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">gnirtS wen=b</span></span>][<span class="hljs-string"><span class="hljs-string">gnirtS;}63,36,69,59,53,46,83,49,33{</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">tni wen=a</span></span>][<span class="hljs-string"><span class="hljs-string">tni;i tni;s=t,!$!=s gnirtS{)z</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">gnirtS(^niam#_?niaM^_#@?diov citats cilbup{margorP ssalc^#_?;metsyS gnisu^_#@`?**`"=s gnirtS{)z</span></span>][<span class="hljs-string"><span class="hljs-string">gnirtS( niamF200u\A200u\//niaM A200u\F200u\A000u\//diov citats cilbup{margorP ssalc F200u\A200u\//;metsyS gnisu A200u\F200u\A000u\///**/</span></span></code> </pre> <br><p>  Unfortunately, the monster turned out to be too large (1747 characters), but this is due to the long chains of Unicode characters and the verbosity of the C # and Java languages.  I am sure that in other languages ‚Äã‚Äãit will be possible to write a much smaller quine-palindrome-polyglot. </p><br><p>  Now let's check how this program is executed.  To get started, let's get rid of all comments and format the code correctly: </p><br><div class="spoiler">  <b class="spoiler_title">Formatted and cleaned PalidromePolyglotQuine.cs.java code under C #</b> <div class="spoiler_text"><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">String[] z</span></span></span><span class="hljs-function">)</span></span> { String s = <span class="hljs-string"><span class="hljs-string">"`**?`@#_^using System;?_#^class Program{public static void?@#_^Main?_#main^(String[]z){String s=!$!,t=s;int i;int[]a=new int[]{33,94,38,64,35,95,96,63,36};String[]b=new String[]{!&amp;!!,!&amp;n!,!&amp;&amp;!,!&amp;@!,!&amp;#!,!&amp;_!,!`!,!?!,s};for(i=0;i&lt;9;i++)t=t.?@#_^Replace?_#replace^(!!+(char)a[i],b[i]);t+='*';for(i=872;i&gt;=0;i--)t=t+t?@#_^[i];Console.Write?_#.charAt(i);System.out.printf^(t);}}/"</span></span>, t = s; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] a = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] { <span class="hljs-number"><span class="hljs-number">33</span></span>, <span class="hljs-number"><span class="hljs-number">94</span></span>, <span class="hljs-number"><span class="hljs-number">38</span></span>, <span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">35</span></span>, <span class="hljs-number"><span class="hljs-number">95</span></span>, <span class="hljs-number"><span class="hljs-number">96</span></span>, <span class="hljs-number"><span class="hljs-number">63</span></span>, <span class="hljs-number"><span class="hljs-number">36</span></span> }; String[] b = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[] { <span class="hljs-string"><span class="hljs-string">"\""</span></span>, <span class="hljs-string"><span class="hljs-string">"\n"</span></span>, <span class="hljs-string"><span class="hljs-string">"\\"</span></span>, <span class="hljs-string"><span class="hljs-string">"\\u000A"</span></span>, <span class="hljs-string"><span class="hljs-string">"\\u002F"</span></span>, <span class="hljs-string"><span class="hljs-string">"\\u002A"</span></span>, <span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-string"><span class="hljs-string">"//"</span></span>, s }; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">9</span></span>; i++) t = t.Replace(<span class="hljs-string"><span class="hljs-string">""</span></span> + (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>)a[i], b[i]); t += <span class="hljs-string"><span class="hljs-string">'*'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">872</span></span>; i &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>; i--) t = t + t[i]; Console.Write(t); } }</code> </pre> </div></div><br><p>  From the listing it becomes clear that the variable <code>s</code> contains the program code, in which the characters forbidden in the lines are escaped and the repeated sequences are compressed.  Below is a table of characters in the code - character - replacement format, which is used to form the output string <code>t</code> . </p><br><table><thead><tr><th>  code </th><th>  symbol </th><th>  replacement </th></tr></thead><tbody><tr><td>  33 </td><td>  ! </td><td>  " </td></tr><tr><td>  94 </td><td>  ^ </td><td>  \ n </td></tr><tr><td>  38 </td><td>  &amp; </td><td>  \ </td></tr><tr><td>  64 </td><td>  @ </td><td>  \ u000A </td></tr><tr><td>  35 </td><td>  # </td><td>  \ u002F </td></tr><tr><td>  95 </td><td>  _ </td><td>  \ u002A </td></tr><tr><td>  96 </td><td>  ` </td><td>  / </td></tr><tr><td>  63 </td><td>  ? </td><td>  // </td></tr><tr><td>  36 </td><td>  $ </td><td>  s </td></tr></tbody></table><br><p>  At the next stage, the string <code>t</code> is concatenated with it, inverted so that the output will be a palindrome.  It should be noted that the number 872 (the length of the string <code>t</code> ) must be calculated after the quine has already been written.  And for this you need to run the already written code, which also presents certain difficulties. </p><br><p>  The main criterion for writing such a code was to achieve the smallest size in text form, not its purity.  Therefore, of course, it looks a bit strange. </p><br><p>  As you can see, there is nothing difficult in writing such quineas.  For those who do not believe that all this really works, tests were written in the <a href="">Freaky-Sources</a> repository (for launch, Java is required to be installed). </p><br><p>  Throw in a comment your Quind-palindromes-polyglots in other languages ‚Äã‚Äãand other interesting code-friches things, I will be happy to study them. </p><br><p>  Once again, congratulations to all programmers and sympathizers! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/309702/">https://habr.com/ru/post/309702/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../309688/index.html">Secrets of the effective management of data centers around the world: from Tokyo to St. Louis, from Sydney to London</a></li>
<li><a href="../309694/index.html">Intel and Hewlett Packard have released a security alert for a ThinkPwn vulnerability</a></li>
<li><a href="../309696/index.html">How to secure a Linux system: 10 tips</a></li>
<li><a href="../309698/index.html">Adobe Captivate feature overview</a></li>
<li><a href="../309700/index.html">The digest of interesting materials for Mobile Developer # 170 (September 5-11)</a></li>
<li><a href="../309704/index.html">Several ways to optimize working with Git</a></li>
<li><a href="../309706/index.html">Create a localized system voice menu in 3CX</a></li>
<li><a href="../309708/index.html">The digest of fresh materials from the world of the frontend for the last week No. 227 (September 4 - 11, 2016)</a></li>
<li><a href="../309710/index.html">PHP Digest number 92 - interesting news, materials and tools (August 29 - September 11, 2016)</a></li>
<li><a href="../309712/index.html">Convert a forum from MS Exchange to MySQL using Python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>