<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using the Entity Framework Core code-first with SQLite DBMS when developing WinForms-applications in VisualStudio 2015</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At first glance, the material below may seem another banal ‚ÄúHalloween world‚Äù, ‚Äúa tutorial from Captain Obviousness‚Äù, of which there are already plenty...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using the Entity Framework Core code-first with SQLite DBMS when developing WinForms-applications in VisualStudio 2015</h1><div class="post__text post__text-html js-mediator-article">  At first glance, the material below may seem another banal ‚ÄúHalloween world‚Äù, ‚Äúa tutorial from Captain Obviousness‚Äù, of which there are already plenty on the Internet, but this impression is deceptive.  In fact, in order to achieve the same result from scratch, a WinForms programmer who had not previously worked with the Entity Framework Core (not to be confused with the classic Entity Framework) and armed only with EF Core tutorials and documentation that already abound in the Internet‚Äôs open spaces can take much longer than he naively expected before he got down to business.  It happened to me.  Therefore I want to share the experience. <br><a name="habracut"></a><br>  The main problem is that the vast majority of available materials on EF Core do not imply the use of Visual Studio (instead, the use of the lightweight cross-platform .NET Core tuling is implied) and certainly do not take into account that someone wants to use EF Core in desktop file distribution. an application based on the Windows Forms framework (which usually means using the ASP.NET core instead).  But the tasks and situations in which the solution in the form of a desktop application is preferable (or even necessary) still exist, and the advantages (as is, of course, disadvantages) of the Entity Framework Core compared to Entity Framework 6 are.  In addition, in the examples available on the Web, as a rule, only the most elementary actions such as adding a record to the database are considered, even the question of subsequent data retrieval is often not considered, and there are no obvious points in it.  It can also be noted that EF Core is actively developing and many instructions lose their relevance, including  for this reason. <br><br>  In my attempts to solve such an seemingly elementary task as the development of a minimal WinForms demo application using EF Core in VisualStudo 2015, I came across a whole range of problems such as exceptions, unexpected behavior, misunderstanding how to do something that in tutorials is meant as self-evident, etc. .  As a result, some of the steps that I will give below had to grope almost blindly, Google, asking questions and experimenting. <br><br>  As a platform, I chose the .NET Framework 4.6.1 (version 4.6.2 for some reason does not appear in the list of available in my Visual Studio, but when selecting 4.6.1 everything works, it will probably work with earlier versions, but I did not check), as a development environment - Visual Studio Community Edition 2015 Update 3, as a DBMS - SQLite, as an OS - Windows 7 64-bit. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Below is a list of steps that resulted in a properly running demo application and during the execution of which no error message was received. <br><br>  <b>0.</b> Verify that the latest versions of the .NET Framework 4.6.2 ( <a href="https://www.microsoft.com/en-us/download/details.aspx%3Fid%3D53345">web installer</a> , <a href="https://www.microsoft.com/en-us/download/details.aspx%3Fid%3D53344">offline installer</a> ) and Visual Studio 2015 Update 3 are <a href="https://go.microsoft.com/fwlink/%3FLinkId%3D691129">installed</a> ( <a href="https://go.microsoft.com/fwlink/%3FLinkId%3D691129">update web installer</a> , <a href="https://go.microsoft.com/fwlink/%3FLinkId%3D708984">update offline installer ISO</a> , <a href="https://go.microsoft.com/fwlink/%3FLinkID%3D626924">web installer full version of Visual Studio 2015 Update Community Edition 3</a> , <a href="">offline installer ISO full version of Visual Studio 2015 Update Community Edition 3 with the integrated update</a> ) <br><br>  <b>1.</b> Install <a href="https://www.microsoft.com/en-us/download/details.aspx%3Fid%3D50395">Windows Management Framework 5.0</a> to upgrade PowerShell to version 5.0.  I (after installing Windows 7 and Visual Studio 2015 and all the updates for them) had version 2.0 in the system and then in the process I received an error message demanding a newer version <br><br>  <b>2.</b> Install .NET Core 1.0.1 tools Preview 2 ( <a href="https://go.microsoft.com/fwlink/%3FLinkID%3D827546">web installer</a> , can be used to create an offline distribution using <a href="https://msdn.microsoft.com/en-us/library/mt706497.aspx">the / layout key</a> ). <br><br>  <b>3.</b> Update the Visual Studio extension to work with NuGet repositories.  To do this, either download the currently available version 3.5.0.1996 by a <a href="">direct link,</a> or add the <a href="https://dotnet.myget.org/F/nuget-beta/vsix/">corresponding repository of extensions</a> for automatic updates to the Visual Studio settings. <br><br><img src="http://i.imgur.com/5lisgHWl.png" alt="Visual Studio 2015 'Tools' - 'Options' - 'Extensions and Updates' dialogue"><br><br>  <b>4.</b> Create a new project like Windows Forms Application.  I called it ‚ÄúVs2015WinFormsEfcSqliteCodeFirst20170304Example‚Äù (an example of a WinForms application using the Entity Framework Core, the ‚Äúcode-first‚Äù approach and SQLite DBMS in Visual Studio 2015) is relevant on 04.03.2017.  As the target framework, select the .NET Framework 4.6.1. <br><br>  <b>5.</b> Right-click on our project in the Solution Explorer panel, select Manage NuGet Packages ..., go to the Browse tab, install Microsoft.EntityFrameworkCore.Sqlite.Design and Microsoft.EntityFrameworkCore.Tools.  To install the current versions, you may need to tick the ‚ÄúInclude prerelease‚Äù checkbox; in stable versions, something may be missing or there are uncorrected bugs.  I installed the latest Microsoft.EntityFrameworkCore.Sqlite.Design 1.1.0 and Microsoft.EntityFrameworkCore.Tools 1.1.0-preview4-final.  If you have problems installing Microsoft.EntityFrameworkCore.Tools, you can try to do it via the NuGet command line: choose Tools - NuGet Package Manager - Package Manager Console in the menu, in the console that appears (which, by the way, we still need) after the prompt ‚ÄúPM&gt; "Enter" Install-Package Microsoft.EntityFrameworkCore.Tools -Pre " <br><br><pre><code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">PM</span></span>&gt; <span class="hljs-selector-tag"><span class="hljs-selector-tag">Install-Package</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Microsoft</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.EntityFrameworkCore</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.Tools</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-Pre</span></span></code> </pre> <br>  <b>6.</b> Create the source code files of the data model classes.  For the order, I put them in the ‚ÄúModel‚Äù subfolder (some call it ‚ÄúEntities‚Äù, some throw all the classes at the root of the project, and some in one file).  The model describes an educational example of a database storing a list of cities and people to / from them.  Each person can be associated with only one city, it may be unknown from which city he is at all. <br><br>  <i>Vs2015WinFormsEfcSqliteCodeFirst20170304ExampleContext.cs</i> <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.EntityFrameworkCore; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Vs2015WinFormsEfcSqliteCodeFirst20170304Example.Model</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Vs2015WinFormsEfcSqliteCodeFirst20170304ExampleContext</span></span> : <span class="hljs-title"><span class="hljs-title">DbContext</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbSet&lt;City&gt; Cities { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> DbSet&lt;Person&gt; People { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnConfiguring</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DbContextOptionsBuilder optionsBuilder</span></span></span><span class="hljs-function">)</span></span> { optionsBuilder.UseSqlite(<span class="hljs-string"><span class="hljs-string">"Filename=Vs2015WinFormsEfcSqliteCodeFirst20170304Example.sqlite"</span></span>); } } }</code> </pre><br>  <i>City.cs</i> <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ComponentModel.DataAnnotations.Schema; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Vs2015WinFormsEfcSqliteCodeFirst20170304Example.Model</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">City</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Id { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [InverseProperty(<span class="hljs-string"><span class="hljs-string">"City"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ICollection&lt;Person&gt; People { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } }</code> </pre><br>  <i>Person.cs</i> <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.ComponentModel.DataAnnotations.Schema; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Vs2015WinFormsEfcSqliteCodeFirst20170304Example.Model</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Person</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Id { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Surname { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>? CityId { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [InverseProperty(<span class="hljs-string"><span class="hljs-string">"People"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> City City { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } } }</code> </pre><br>  <b>7.</b> Allowing PowerShell scripts, if this is not done, an error can occur "... \ packages \ Microsoft.EntityFrameworkCore.Tools.1.1.0-preview4-final \ tools \ init.ps1 . "  To do this, go to the NuGet command line (select Tools - NuGet Package Manager - Package Manager Console in the menu) and execute the following command <br><br><pre> <code class="hljs pgsql">PM&gt; <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>-ExecutionPolicy RemoteSigned</code> </pre> <br>  <b>8.</b> Create a "migration."  To do this, save and compile our code (just to make sure there are no obvious typos) go to the NuGet command line and execute the following command. <br><br><pre> <code class="hljs pgsql">PM&gt; <span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>-Migration -<span class="hljs-type"><span class="hljs-type">Name</span></span> "Vs2015WinFormsEfcSqliteCodeFirst20170304ExampleMigration" -Context "Vs2015WinFormsEfcSqliteCodeFirst20170304ExampleContext"</code> </pre> <br>  in vsth in the project should be in the folder "Migrations" and two files in it: "vs2015WinFormsEftsp4pciteitedevice20170304ExampleContextModelSnapshot.cs" and the moment of generation in an obvious format, I then deleted it altogether leaving only ‚ÄúVs2015WinFormsEfcSqliteCodeFirst20170304ExampleMigration.cs‚Äù). <br><br>  <b>9.</b> Edit the generated files to add a unique condition (unique constraint, also known as the secondary key) to the name of the city (in reality, of course, there are cities with the same name, but for example, it will not be superfluous) <br><br>  <i>Vs2015WinFormsEfcSqliteCodeFirst20170304ExampleMigration.cs</i> <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.EntityFrameworkCore.Migrations; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Vs2015WinFormsEfcSqliteCodeFirst20170304Example.Migrations</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Vs2015WinFormsEfcSqliteCodeFirst20170304ExampleMigration</span></span> : <span class="hljs-title"><span class="hljs-title">Migration</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Up</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">MigrationBuilder migrationBuilder</span></span></span><span class="hljs-function">)</span></span> { migrationBuilder.CreateTable( name: <span class="hljs-string"><span class="hljs-string">"Cities"</span></span>, columns: table =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { Id = table.Column&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(nullable: <span class="hljs-literal"><span class="hljs-literal">false</span></span>) .Annotation(<span class="hljs-string"><span class="hljs-string">"Sqlite:Autoincrement"</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>), Name = table.Column&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(nullable: <span class="hljs-literal"><span class="hljs-literal">true</span></span>) }, constraints: table =&gt; { table.PrimaryKey(<span class="hljs-string"><span class="hljs-string">"PK_Cities"</span></span>, x =&gt; x.Id); <span class="hljs-comment"><span class="hljs-comment">//     table.UniqueConstraint("UQ_Cities_Name", x =&gt; x.Name); }); migrationBuilder.CreateTable( name: "People", columns: table =&gt; new { Id = table.Column&lt;int&gt;(nullable: false) .Annotation("Sqlite:Autoincrement", true), CityId = table.Column&lt;int&gt;(nullable: true), Name = table.Column&lt;string&gt;(nullable: true), Surname = table.Column&lt;string&gt;(nullable: true) }, constraints: table =&gt; { table.PrimaryKey("PK_People", x =&gt; x.Id); table.ForeignKey( name: "FK_People_Cities_CityId", column: x =&gt; x.CityId, principalTable: "Cities", principalColumn: "Id", onDelete: ReferentialAction.Restrict); }); migrationBuilder.CreateIndex( name: "IX_People_CityId", table: "People", column: "CityId"); } protected override void Down(MigrationBuilder migrationBuilder) { migrationBuilder.DropTable( name: "People"); migrationBuilder.DropTable( name: "Cities"); } } }</span></span></code> </pre><br>  <i>Vs2015WinFormsEfcSqliteCodeFirst20170304ExampleContextModelSnapshot.cs</i> <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.EntityFrameworkCore; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.EntityFrameworkCore.Infrastructure; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Vs2015WinFormsEfcSqliteCodeFirst20170304Example.Model; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Vs2015WinFormsEfcSqliteCodeFirst20170304Example.Migrations</span></span> { [DbContext(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Vs2015WinFormsEfcSqliteCodeFirst20170304ExampleContext))] <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Vs2015WinFormsEfcSqliteCodeFirst20170304ExampleContextModelSnapshot</span></span> : <span class="hljs-title"><span class="hljs-title">ModelSnapshot</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BuildModel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ModelBuilder modelBuilder</span></span></span><span class="hljs-function">)</span></span> { modelBuilder .HasAnnotation(<span class="hljs-string"><span class="hljs-string">"ProductVersion"</span></span>, <span class="hljs-string"><span class="hljs-string">"1.1.0-rtm-22752"</span></span>); modelBuilder.Entity(<span class="hljs-string"><span class="hljs-string">"Vs2015WinFormsEfcSqliteCodeFirst20170304Example.Model.City"</span></span>, b =&gt; { b.Property&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"Id"</span></span>) .ValueGeneratedOnAdd(); b.Property&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;(<span class="hljs-string"><span class="hljs-string">"Name"</span></span>); b.HasKey(<span class="hljs-string"><span class="hljs-string">"Id"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     b.HasIndex("Name").IsUnique(); b.ToTable("Cities"); }); modelBuilder.Entity("Vs2015WinFormsEfcSqliteCodeFirst20170304Example.Model.Person", b =&gt; { b.Property&lt;int&gt;("Id") .ValueGeneratedOnAdd(); b.Property&lt;int?&gt;("CityId"); b.Property&lt;string&gt;("Name"); b.Property&lt;string&gt;("Surname"); b.HasKey("Id"); b.HasIndex("CityId"); b.ToTable("People"); }); modelBuilder.Entity("Vs2015WinFormsEfcSqliteCodeFirst20170304Example.Model.Person", b =&gt; { b.HasOne("Vs2015WinFormsEfcSqliteCodeFirst20170304Example.Model.City", "City") .WithMany("People") .HasForeignKey("CityId"); }); } } }</span></span></code> </pre><br>  <b>10.</b> Generate the database file.  To do this, in the command line NuGet run the following command <br><br><pre> <code class="hljs pgsql">PM&gt; <span class="hljs-keyword"><span class="hljs-keyword">Update</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">Database</span></span> -Context "Vs2015WinFormsEfcSqliteCodeFirst20170304ExampleContext"</code> </pre> <br>  The database file will be created in the same directory as the compiled exe-file of our application, I have this "... \ Vs2015WinFormsEfcSqliteCodeFirst20170304Example \ bin \ Debug \ Vs2015WinFormsEfcSqliteCodeFirst20170304Example.sll". <br><br>  At this stage, we can already look inside the created file, for example, using the official console client <a href="https://sqlite.org/download.html">sqlite3</a> or the free <a href="http://sqlitebrowser.org/">DB Browser for SQLite DB</a> Cross- <a href="https://sqlite.org/download.html">Platform</a> GUI, and make sure that the tables were created correctly.  In addition to our ‚ÄúCities‚Äù and ‚ÄúPeople‚Äù tables, we also find there the ‚Äú__EFMigrationsHistory‚Äù table with the EF Core service information and the ‚Äúsqlite_sequence‚Äù table with the SQLite service information. <br><br>  <b>11.</b> Now let's move on to the designer of our form, place a button on it, click and on it twice to create an event handler for clicking a button and proceed to editing its code.  Below I provide my code demonstrating the main actions with database records.  I still have the habit of always renaming Form1 to MainForm and controls in a similar way (in this case, the only button1 control in mainButton), but this is a matter of taste and naming standards adopted by your team. <br><br>  <i>MainForm.cs</i> <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mainButton_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, EventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//       using (var context = new Vs2015WinFormsEfcSqliteCodeFirst20170304ExampleContext()) { foreach (var person in context.People) context.Remove(person); foreach (var city in context.Cities) context.Remove(city); context.SaveChanges(); } //         //     ,     using (var context = new Vs2015WinFormsEfcSqliteCodeFirst20170304ExampleContext()) { var praha = new City { Name = "Praha" }; var london = new City { Name = "London" }; var madrid = new City { Name = "Madrid" }; var jan = new Person { Name = "Jan", City = praha }; var john = new Person { Name = "John", City = london }; var juan = new Person { Name = "Juan", City = madrid }; context.Cities.AddRange(praha, london, madrid); context.People.AddRange(jan, john, juan); context.SaveChanges(); } //        , //      , //       ( ) using (var context = new Vs2015WinFormsEfcSqliteCodeFirst20170304ExampleContext()) { //     Include(city =&gt; city.People) //    context.Cities.Single(city =&gt; city.Name == "London"); //   ,    .People   null. //  production    .Single     , //           var london = context.Cities.Include(city =&gt; city.People)(city =&gt; city.Name == "London"); var peter = new Person { Name = "Peter", City = london }; var john = london.People.Single(person =&gt; person.Name == "John"); john.Surname = "Smith"; context.Add(peter); context.Update(john); context.SaveChanges(); } }</span></span></code> </pre><br>  Of course, in real life, you implement a richer interface, more meaningful logic in the application, add exception handling and data validation to prevent them, the same example is enough to understand how to do it. <br><br>  Download all the above and the accompanying code <a href="https://github.com/strangeattr/Vs2015WinFormsEfcSqliteCodeFirst20170304Example">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/324272/">https://habr.com/ru/post/324272/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../324260/index.html">Creating Web Applications with Scala.js and React - Part 1</a></li>
<li><a href="../324262/index.html">Interview IT specialists. On ‚Äúyou‚Äù or on ‚Äúyou‚Äù?</a></li>
<li><a href="../324264/index.html">Get the list of PostgreSQL statements</a></li>
<li><a href="../324266/index.html">On the market, a man sold a cow (optimally)</a></li>
<li><a href="../324268/index.html">Juniper: composite-next-hop</a></li>
<li><a href="../324274/index.html">We build Docker images for CI / CD quickly and conveniently along with dapp (review and video)</a></li>
<li><a href="../324276/index.html">Iptables: a little about the action of REDIRECT, its limitations and scope</a></li>
<li><a href="../324280/index.html">How to create music for video games</a></li>
<li><a href="../324284/index.html">Resizing images based on content</a></li>
<li><a href="../324286/index.html">easymake - ‚Äúalmost‚Äù regular task-runner for building, testing and other tasks for node.js</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>