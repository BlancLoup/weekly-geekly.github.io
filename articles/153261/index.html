<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MODX Revolution - a pair of crutches for unusual situations</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="MODX is certainly a cool CMF, but sometimes you get on with the little things that strain. I will not cry in this topic how bad everything is, and I'm...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MODX Revolution - a pair of crutches for unusual situations</h1><div class="post__text post__text-html js-mediator-article">  MODX is certainly a cool CMF, but sometimes you get on with the little things that strain.  I will not cry in this topic how bad everything is, and I'm so good.  Take, for example, the Revolution branch and dissect it.  And so that you don't lose interest in this article, here is a small outline of the article: <br><ol><li>  Backend parsing </li><li>  Deeper into the settings </li><li>  Work with nested chunks </li><li>  Observe the work of the parser </li><li>  Powerful cache </li></ol><br><a name="habracut"></a><br><habracut><br><h4>  Removing a parameter from a parameter set </h4><br>  Create a set of parameters.  We add X parameters to it, and then we understand that we parted ways.  We are trying to find the delete button ... <br><img src="https://habrastorage.org/storage2/9d0/24c/bca/9d024cbca77ff19797eee4d663169cb0.png"><br>  In general, I did not work out.  I had to look for another way to remove the parameter. <br>  <b>Solving the problem</b> : open an unnecessary parameter for editing and completely copy all the data of another necessary parameter (ostensibly trying to overwrite the old parameter with new data). <br>  <b>Corollary:</b> We can overwrite the value of the desired parameter. <br><br><h4>  Key Values ‚Äã‚Äãin Context Settings </h4><br>  Let us model this situation: several contexts, each context has its own settings attached. <br>  If there are several sites in the admin area, then as a rule in the context settings such key as site_name overrides.  Now imagine, your company has always positioned its name as <u>Steep {Peppers}</u> . <br><img src="https://habrastorage.org/storage2/e1b/e48/46a/e1be4846a3d9370a81b4a1f74489f604.png"><br>  What do you think, what result will we see in the front-end?  Right, just Cool. <br>  <b>Solution of the problem</b> : instead of brackets use special characters. <br>  And what should those who have 1 template use in several contexts and want to specify a certain set of parameters for the JS code as a key?  There, special characters will not help, and one chunk is indispensable. <br>  <b>There are already two solutions</b> <br><ul><li>  <u>The first solution</u> : create your snippet and, depending on the context, give the desired chunk via getChunk. </li><li>  <u>The second solution</u> : For each context, create your own chunk and in the template instead of the key, register [[$ name _ [[* context_key]]]].  But as if there was nothing, this record looks out of the blue ... <i>Thank you <a href="https://habrahabr.ru/users/artdevue/" class="user_link">artdevue</a> for this solution</i> . </li></ul><br><br><h4>  Work with nested chunks </h4><br>  In MODX, for a long time there is such a function as <div class="spoiler">  <b class="spoiler_title">getChunk</b> <div class="spoiler_text">  (parseChunk, for example, depends on it). <br><pre><code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getChunk</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($chunkName, array $properties= array </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ $output= <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (array_key_exists($chunkName, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;sourceCache[<span class="hljs-string"><span class="hljs-string">'modChunk'</span></span>])) { $chunk = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;newObject(<span class="hljs-string"><span class="hljs-string">'modChunk'</span></span>); $chunk-&gt;fromArray(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;sourceCache[<span class="hljs-string"><span class="hljs-string">'modChunk'</span></span>][$chunkName][<span class="hljs-string"><span class="hljs-string">'fields'</span></span>], <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); $chunk-&gt;setPolicies(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;sourceCache[<span class="hljs-string"><span class="hljs-string">'modChunk'</span></span>][$chunkName][<span class="hljs-string"><span class="hljs-string">'policies'</span></span>]); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $chunk= <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getObject(<span class="hljs-string"><span class="hljs-string">'modChunk'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> (<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; $chunkName), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($chunk) || $chunk === <span class="hljs-string"><span class="hljs-string">'0'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;sourceCache[<span class="hljs-string"><span class="hljs-string">'modChunk'</span></span>][$chunkName]= <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> ( <span class="hljs-string"><span class="hljs-string">'fields'</span></span> =&gt; $chunk-&gt;toArray(), <span class="hljs-string"><span class="hljs-string">'policies'</span></span> =&gt; $chunk-&gt;getPolicies() ); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($chunk) || $chunk === <span class="hljs-string"><span class="hljs-string">'0'</span></span>) { $chunk-&gt;setCacheable(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); $output= $chunk-&gt;process($properties); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $output; }</code> </pre> <br></div></div><br>  And now let's create a simple <div class="spoiler">  <b class="spoiler_title">snippet</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> ini_set(<span class="hljs-string"><span class="hljs-string">"display_errors"</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>); $data=<span class="hljs-string"><span class="hljs-string">''</span></span>; $phs=<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($phs)?explode(<span class="hljs-string"><span class="hljs-string">","</span></span>,$phs):<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($tpl,$phs) &amp;&amp; $tpl!=<span class="hljs-string"><span class="hljs-string">''</span></span> &amp;&amp; count($phs)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>($phs <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $item){ $data.=$modx-&gt;parseChunk($tpl,<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'item'</span></span>=&gt;$item,<span class="hljs-string"><span class="hljs-string">'time'</span></span>=&gt;time())); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $data;</code> </pre><br></div></div><br>  install phpthumbof and create <div class="spoiler">  <b class="spoiler_title">chunk</b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>[[+time]]<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>: [[+item]] - [[!phpthumbof? &amp;input=`[[+item]]` &amp;options=`&amp;h=150&amp;f=jpg`]]<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Let's call this on the page like this: <code>[[!test? &amp;tpl=`test` &amp;phs=`/assets/1.jpg,/assets/2.jpg`]]</code> <code>[[!test? &amp;tpl=`test` &amp;phs=`/assets/1.jpg,/assets/2.jpg`]]</code> <br>  But bad luck, the first time you call the [[+ item]] line in the phpthumbof snippet, and only for all subsequent rasparseny placeholder <br><img src="https://habrastorage.org/storage2/ef4/cea/da1/ef4ceada126fe286f6758bd7905d3d51.png"><br>  <b>Solution</b> : Store such problem chunks in files.  Those.  tick static and select file <br><img src="https://habrastorage.org/storage2/cd0/a2a/c20/cd0a2ac20f2e2caf3e2ca31362142744.png"><br>  <b><a href="http://habrahabr.ru/post/153261/">Another solution</a></b> from <a href="https://habrahabr.ru/users/bezumkin/" class="user_link">bezumkin</a> : Replace parseChunk with getChunk. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Observe the work of the parser </h4><br>  We will conduct the experiment as follows: create a new document with the blank template.  Content and everything else is left blank.  Let's check that it is worth checking a tick. <div class="spoiler">  <b class="spoiler_title">Now open the processElementTags function from the /core/mode/modx/modparser.class.php file</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processElementTags</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($parentTag, &amp; $content, $processUncacheable= false, $removeUnprocessed= false, $prefix= </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"[["</span></span></span></span><span class="hljs-function"><span class="hljs-params">, $suffix= </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"]]"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, $tokens= array </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span><span class="hljs-function"><span class="hljs-params">, $depth= </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_processingTag = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_processingUncacheable = (boolean) $processUncacheable; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_removingUnprocessed = (boolean) $removeUnprocessed; $depth = $depth &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? $depth - <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>; $processed= <span class="hljs-number"><span class="hljs-number">0</span></span>; $tags= <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> (); <span class="hljs-comment"><span class="hljs-comment">/* invoke OnParseDocument event */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;modx-&gt;documentOutput = $content; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;modx-&gt;invokeEvent(<span class="hljs-string"><span class="hljs-string">'OnParseDocument'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'content'</span></span> =&gt; &amp;$content)); $content = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;modx-&gt;documentOutput; <span class="hljs-keyword"><span class="hljs-keyword">unset</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;modx-&gt;documentOutput); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($collected= <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;collectElementTags($content, $tags, $prefix, $suffix, $tokens)) { $tagMap= <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> (); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($tags <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $tag) { $token= substr($tag[<span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$processUncacheable &amp;&amp; $token === <span class="hljs-string"><span class="hljs-string">'!'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($removeUnprocessed) { $tagMap[$tag[<span class="hljs-number"><span class="hljs-number">0</span></span>]]= <span class="hljs-string"><span class="hljs-string">''</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span> ($tokens) &amp;&amp; !in_array($token, $tokens)) { $collected--; <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($tag[<span class="hljs-number"><span class="hljs-number">0</span></span>] === $parentTag) { $tagMap[$tag[<span class="hljs-number"><span class="hljs-number">0</span></span>]]= <span class="hljs-string"><span class="hljs-string">''</span></span>; $processed++; <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } $tagOutput= <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;processTag($tag, $processUncacheable); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (($tagOutput === <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || $tagOutput === <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) &amp;&amp; $removeUnprocessed) { $tagMap[$tag[<span class="hljs-number"><span class="hljs-number">0</span></span>]]= <span class="hljs-string"><span class="hljs-string">''</span></span>; $processed++; } <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> ($tagOutput !== <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; $tagOutput !== <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) { $tagMap[$tag[<span class="hljs-number"><span class="hljs-number">0</span></span>]]= $tagOutput; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($tag[<span class="hljs-number"><span class="hljs-number">0</span></span>] !== $tagOutput) $processed++; } } <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;mergeTagOutput($tagMap, $content); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($depth &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { $processed+= <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;processElementTags($parentTag, $content, $processUncacheable, $removeUnprocessed, $prefix, $suffix, $tokens, $depth); } } <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_processingTag = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $processed; }</code> </pre><br></div></div><br>  before the line <pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_processingTag = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>;</code> </pre>  add <pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> $test; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> ++$test.<span class="hljs-string"><span class="hljs-string">"&lt;br /&gt;"</span></span>;</code> </pre> <br>  Well, open our page in the browser.  o0!  The number 1..2..3 What kind of mother is your question ... A blank page.  What is there to parse?  We look carefully the source <pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;modx-&gt;invokeEvent(<span class="hljs-string"><span class="hljs-string">'OnParseDocument'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'content'</span></span> =&gt; &amp;$content));</code> </pre> <br>  Thus, even on a blank page, we trigger the same event 3 times.  I'm scared to think what will happen to those sites that have some code hanging on this event. <br>  <a href="https://habrahabr.ru/users/artdevue/" class="user_link">artdevue</a> for the experiment checked how many times this function will be performed under different conditions.  so we have the following table. <br><table><tbody><tr><th>  Condition </th><th>  Iterations </th></tr><tr><td>  [[snippet]] </td><td>  2 </td></tr><tr><td>  {{$ chunk}} </td><td>  2 </td></tr><tr><td>  Empty page </td><td>  3 </td></tr><tr><td>  [[num? input = `1000`]] </td><td>  five </td></tr><tr><td>  [[* pagetitle: num]] </td><td>  6 </td></tr><tr><td>  [[num? input = `[[* pagetitle]]`]] </td><td>  7 </td></tr><tr><td>  Non-existent snippet </td><td>  23 </td></tr><tr><td>  Nonexistent chunk </td><td>  23 </td></tr></tbody></table><br><br><h4>  Powerful cache </h4><br>  On one of the work sites I opened the cache folder and almost fell off the chair.  1 page in the cache takes from 50 to 200 KB.  No, this may of course be normal, but the cache is updated with each change of documents.  Updated 1 document - all cached pages were deleted.  And if 100 pages?  1000?  This is a few MB pulls.  And if the news is added every day? <br><br>  <i><b>PS</b> Renamed the topic to look less whiny and defiant</i> </habracut></div><p>Source: <a href="https://habr.com/ru/post/153261/">https://habr.com/ru/post/153261/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../153247/index.html">Ukrainians will receive electronic passports</a></li>
<li><a href="../153249/index.html">Publicity-privacy: a matter of respected public</a></li>
<li><a href="../153255/index.html">Methods for calculating multinomial coefficients</a></li>
<li><a href="../153257/index.html">The simplest free-lance board on Ruby on Rails</a></li>
<li><a href="../153259/index.html">iTunes 10.7 tried to connect to the domain bogusapple.com</a></li>
<li><a href="../153263/index.html">LEGO laptop docking station</a></li>
<li><a href="../153265/index.html">Start selling software on Steam</a></li>
<li><a href="../153269/index.html">Development Parks and a new format of the developing environment - expedition to the future interaktorium. Part 1</a></li>
<li><a href="../153275/index.html">Cisco also wants to cloud</a></li>
<li><a href="../153277/index.html">Open interview with Vasily Voropaev (Free-Lance.ru) [UPD]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>