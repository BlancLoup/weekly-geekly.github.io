<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>HTTP Strict-Transport-Security or how to protect yourself from man-in-the-middle attacks and force the browser to always use HTTPS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Attention to detail gives rise to perfection, 
 perfection is no longer a trifle. 

 Michelangelo Buonarroti 


 Since 2012, new Strict Transport Tran...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>HTTP Strict-Transport-Security or how to protect yourself from man-in-the-middle attacks and force the browser to always use HTTPS</h1><div class="post__text post__text-html js-mediator-article">  <i>Attention to detail gives rise to perfection,</i> <i><br></i>  <i>perfection is no longer a trifle.</i> <br><br>  <i>Michelangelo Buonarroti</i> <br><br><br>  Since 2012, new Strict Transport Transport Security (HSTS) technology has become available to web resource administrators - a mechanism that activates a forced secure connection over HTTPS.  This security policy allows you to immediately establish a secure connection, instead of using HTTP.  The mechanism uses a special HTTP Strict-Transport-Security header to switch a user who has logged in via HTTP to an HTTPS server [ <a href="http://ru.wikipedia.org/wiki/HSTS">1</a> ]. <br>  HSTS aims to close the following vulnerabilities to attacks: <table border="1" cellpadding="2"><tbody><tr><td>  The user bookmarks or types in the address bar <a href="http://example.com/">http://example.com/</a> and becomes the victim of the attack "man-in-the-middle" </td><td>  HSTS automatically converts HTTP requests to HTTPS for the target domain. </td></tr><tr><td>  A web application that is supposed to be used strictly over HTTPS, negligently contains HTTP links or gives content over HTTP </td><td>  HSTS automatically converts HTTP requests to HTTPS for the target domain. </td></tr><tr><td>  The attacker man-in-the-middle tries to intercept the victim's traffic using a fake certificate in the hope that the user will not pay attention to the message about the invalid certificate. </td><td>  HSTS will not allow the user to go further reports of problems with the certificate </td></tr></tbody></table>  Turning on this technology is easier than ever; you need to return the HTTP header ‚ÄúStrict-Transport-Security‚Äù at the moment when he enters the site via HTTPS: <pre>  Strict-Transport-Security: max-age = expireTime [;  includeSubdomains] </pre><br>  <i>expireTime</i> <br>  The time in seconds for which the browser should remember that this site should be visited exclusively via HTTPS.  <i>includeSubdomains (optional)</i> <br>  If you specify this optional parameter, the rules also apply to all subdomains. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  What does it give </h4>  If the website accepts HTTP connections and redirects them to HTTPS, the user can easily access the unencrypted version of the site before redirection if, for example, he types in the address bar <a href="http://example.com/">http://example.com/</a> or, even easier, example.com.  This opens up the potential for man-in-the-middle attacks, in which an HTTP redirect instead of the original encrypted page will send the user straight to the attacker's website. <br>  The HTTP Strict Transport Security mechanism allows the website to inform the browser that it should not use HTTP and, instead, automatically for its part convert all HTTP requests to HTTPS. <br>  For example, you connect to an open Wi-Fi access point in a public place and open the RB of your favorite bank to check the balance and make a couple of payments.  Unfortunately, the access point you are using is actually a malicious user's laptop that intercepts your HTTP requests and redirects you instead of the original bank site to a page-clone.  Your data falls directly into his hands. <br>  HSTS solves this problem.  If you have at least once successfully connected to the bank's website via HTTPS using ‚ÄúStrict Transport Security‚Äù, the browser will automatically start using HTTS for all requests.  This will prevent the possibility of man-in-the-middle attacks of the type described above. <br><br><h4>  What does the browser do </h4>  The first time when a site is visited via HTTPS and returns the ‚ÄúStrict Transport Security‚Äù header, the browser remembers the specified information and all further attempts to access the site via HTTP will be automatically converted to HTTPS. <br>  When the timeout specified in the ‚ÄúStrict-Transport-Security‚Äù header expires, the next attempt to load the site via HTTP will occur as usual and automatic redirection to HTTPS will not be realized. <br>  Whenever the ‚ÄúStrict-Transport-Security‚Äù header is received, the browser updates the timeout, i.e.  Sites have the ability to update this information and prevent the timeout from expiring (or vice versa, for some reason, to reduce it). <br><blockquote>  <b>By the way:</b> the Strict-Transport-Security header is ignored by the browser when connected via HTTP, since an attacker can intercept an HTTP connection and change the header.  The browser will understand that the site is HTTPS-compatible and will properly handle the ‚ÄúStrict-Transport-Security‚Äù header if the site is accessed via HTTPS without error with the certificates. </blockquote><br><h4>  Browser Support </h4><ul><li>  Chromium and Google Chrome from versions 4.0.211.0 </li><li>  Firefox since version 4 [ <a href="https://developer.mozilla.org/en-US/docs/Security/HTTP_Strict_Transport_Security">2</a> ];  with Firefox 17, Mozilla has implemented a list of websites that support HSTS. </li><li>  Opera since version 12 </li><li>  Safari from OS X Mavericks </li></ul><br><h4>  Implementation details </h4>  The ‚ÄúStrict-Transport-Security‚Äù headers should only be sent over HTTPS.  Clients should not process HSTS headers sent in non-HTTPS responses or over HTTPS with invalid, incorrectly configured certificates.  The following configuration snippets should be within the SSL context and code samples are assumed solely in the context of HTTPS responses. <br>  Keep in mind that the max-age directive is presented in seconds.  31536000 seconds (12 months) in the examples below, m.  are changed depending on how long the web server administrator intends to use the site exclusively over HTTPS.  It is recommended to set the value of ‚Äúmax-age‚Äù to be rather large, like 31536000 (12 months) or 63072000 (24 months).  [ <a href="http://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security">3</a> ] <br><br><h5>  Apache implementation </h5><pre>  # we load the module (on the example of RHEL / CentOS)
 LoadModule headers_module modules / mod_headers.so
 &lt;VirtualHost 10.0.0.1:443&gt;
    # Secure HTTP connections
    Header always set Strict-Transport-Security "max-age = 31536000; includeSubDomains"
 &lt;/ Virtualhost&gt; </pre><br><h5>  Implementation in nginx </h5><pre>  add_header Strict-Transport-Security "max-age = 31536000; includeSubDomains"; </pre><br><h4>  Predefined HSTS sites </h4>  There is a gap in which a user with a freshly installed browser and collected settings is vulnerable.  For this reason, Chrome and Firefox maintain a list of ‚Äúpredetermined‚Äù HSTS resources.  The following domains are configured to use out-of-box HSTS: <ul><li>  Google </li><li>  Paypal </li><li>  Twitter </li><li>  Torproject </li><li>  passport.yandex.ru </li></ul>  The full list of sites is available at the link: <a href="http://src.chromium.org/viewvc/chrome/trunk/src/net/">http://src.chromium.org/viewvc/chrome/trunk/src/net/http/transport_security_state_static.json</a> [ <a href="http://dev.chromium.org/sts">4</a> ] <br><br><h4>  For self-study: </h4><ol><li>  <a href="http://ru.wikipedia.org/wiki/HSTS">ru.wikipedia.org: HSTS</a> </li><li>  <a href="https://developer.mozilla.org/en-US/docs/Security/HTTP_Strict_Transport_Security">developer.mozilla.org: HTTP Strict Transport Security</a> </li><li>  <a href="http://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security">en.wikipedia.org: HTTP Strict Transport Security</a> </li><li>  <a href="http://dev.chromium.org/sts">dev.chromium.org: HTTP Strict Transport Security</a> </li><li>  <a href="https://www.owasp.org/index.php/Top_10_2010-A9-Insufficient_Transport_Layer_Protection">www.owasp.org: Top 10 2010-A9-Insufficient Transport Layer Protection</a> </li><li>  <a href="http://security.stackexchange.com/questions/23690/how-can-a-web-application-protect-ie-users-when-this-browser-doesnt-support-hst">security.stackexchange.com: HSTS?</a> </li><li>  <a href="http://habrahabr.ru/post/145359/">habrahabr.ru: All on https, safe and cheap</a> </li><li>  <a href="http://habrahabr.ru/post/168739/">habrahabr.ru: On the way to creating a secure web resource.</a>  <a href="http://habrahabr.ru/post/168739/">Part 1 - server software</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/216751/">https://habr.com/ru/post/216751/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../216737/index.html">Interface with drag-and-drop: how not to confuse the user?</a></li>
<li><a href="../216739/index.html">SQLite database encryption in Qt</a></li>
<li><a href="../216741/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ101 (March 16 - 22, 2014)</a></li>
<li><a href="../216743/index.html">Build-traffic light: the story of another introduction</a></li>
<li><a href="../216747/index.html">In a major anti-piracy campaign, the BSA used "pirated" photo</a></li>
<li><a href="../216753/index.html">Transformation of backup storage technologies: software products and data deduplication devices</a></li>
<li><a href="../216755/index.html">Useful materials for mobile developer # 45 (March 17-23)</a></li>
<li><a href="../216757/index.html">Boat for the arcade. Part number 2: connect OpenCV</a></li>
<li><a href="../216759/index.html">Building FreeType2 for iOS</a></li>
<li><a href="../216765/index.html">LinkMeUp. Issue 13. Project management. Guest from Ericsson</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>