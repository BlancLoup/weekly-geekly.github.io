<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Python in the service of the designer. Taming the Kompas 3D API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Working in the design department, I was faced with the task - to calculate the complexity of the development of design documentation. If we take the d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Python in the service of the designer. Taming the Kompas 3D API</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/75a/869/fe6/75a869fe65854087a5b965b1b2c82f75.png" alt="Logo" title="Python constructor"></p><br><p>  Working in the design department, I was faced with the task - to calculate the complexity of the development of design documentation.  If we take the document as a basis: <a href="http://www.consultant.ru/document/cons_doc_LAW_199653/">‚ÄúTypical time standards for the development of design documentation.</a>  <a href="http://www.consultant.ru/document/cons_doc_LAW_199653/">Cipher 13.01.01 "(approved by the Ministry of Labor of Russia 07.03.2014 N 003)"</a> , then to calculate the complexity of the drawing details, we need the following data: </p><br><ul><li>  Drawing format and number of sheets </li><li>  Scale </li><li>  Number of dimensions in the drawing (including roughness marks and extension lines) </li><li>  Number of technical requirements </li></ul><br><p>  From the available tools in the enterprise we have: Kompas 3D v14 and Python 3.5. </p><br><p>  There are not so many articles on writing programs using the Kompas 3D API, and even less information on how to do this in Python.  I will try to tell you in steps how the task was solved and what rakes you had to step on.  The article is intended for people who know the basics of programming and are familiar with the Python language.  So let's get started. </p><br><a name="habracut"></a><br><h2 id="podgotovitelnaya-operaciya">  Preparatory operation: </h2><br><p>  Make sure you have Kompas 3D, version 14, and Python 3 installed on your computer. You also need to install <a href="http://sourceforge.net/projects/pywin32/">pywin3</a> (Python for Windows extensions). </p><br><h2 id="podklyuchenie-k-kompas-3d">  Connection to Kompas 3D: </h2><br><p>  The Kompas 3D system has two API versions: API5, which provides the KompasObject interface, and API7, which provides the IKompasAPIObject interface.  API versions 5 and 7 largely duplicate their functionality, but according to the developers, in the 7th version, the object-oriented approach is more pronounced.  This article focuses on the 7th version. </p><br><p>  The connection function is as follows: </p><br><pre><code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pythoncom from win32com.client <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Dispatch, gencache #   API7  Kompas <span class="hljs-number"><span class="hljs-number">3</span></span>D def get_kompas_api7(): module = gencache.EnsureModule(<span class="hljs-string"><span class="hljs-string">"{69AC2981-37C0-4379-84FD-5DD2F3C0A520}"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) api = module.IKompasAPIObject( Dispatch(<span class="hljs-string"><span class="hljs-string">"Kompas.Application.7"</span></span>)._oleobj_.QueryInterface(module.IKompasAPIObject.CLSID, pythoncom.IID_IDispatch)) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> = gencache.EnsureModule(<span class="hljs-string"><span class="hljs-string">"{75C9F5D0-B5B8-4526-8681-9903C567D2ED}"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>).constants <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> module, api, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span></code> </pre> <br><p>  A little more about the win32com module <a href="http://docs.activestate.com/activepython/3.4/pywin32/html/com/win32com/HTML/GeneratedSupport.html">here</a> . </p><br><p>  Now, to connect to the interface, we need the following code: </p><br><pre> <code class="hljs pgsql">module7, api7, const7 = get_kompas_api7() #   API7 app7 = api7.Application #    app7.Visible = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> #    ( ) app7.HideMessage = const7.ksHideMessageNo #       print(app7.ApplicationName(FullName=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)) #   </code> </pre> <br><p>  For a deeper understanding of the API, let's take a look at the SDK.  On my computer, it is located at: <i>C: \ Program Files \ ASCON \ KOMPAS-3D V16 \ SDK \ SDK.chm</i> .  Here you can learn more about, for example, the HideMessage method: </p><br><p><img src="https://habrastorage.org/files/d4f/094/eb2/d4f094eb276a474b92ae63235b35e46a.png" alt="HideMessage" title="SDK Help Window"></p><br><p>  After executing our code, we will return everything to its place: if Kompas 3D was launched by us (in the process of the script), we will close it.  The easiest way to determine if a process is running is to use the standard subprocess module: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> subprocess #  ,    Kompas <span class="hljs-number"><span class="hljs-number">3</span></span>D def is_running(): proc_list = subprocess.Popen(<span class="hljs-string"><span class="hljs-string">'tasklist /NH /FI "IMAGENAME eq KOMPAS*"'</span></span>, shell=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, stdout=subprocess.PIPE).communicate()[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> proc_list <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span></code> </pre> <br><p>  This function checks if the KOMPAS process is running <a href="https://technet.microsoft.com/en-us/library/bb491010.aspx">using standard Windows methods</a> .  Please note that different versions of the Kompas 3D program may have different process names! </p><br><h2 id="schitaem-kolichestvo-listov-i-ih-format">  We count the number of sheets and their format: </h2><br><p>  Everything is simple: our doc7 document has an interface for the collection of layout sheets, LayoutSheets.  Each sheet has the property of format and multiplicity.  For Compass, starting with version 15, the LayoutSheets interface is available not only for drawing files, but also for specifications and text documents. </p><br><pre> <code class="hljs pgsql">#       def amount_sheet(doc7): sheets = {"A0": <span class="hljs-number"><span class="hljs-number">0</span></span>, "A1": <span class="hljs-number"><span class="hljs-number">0</span></span>, "A2": <span class="hljs-number"><span class="hljs-number">0</span></span>, "A3": <span class="hljs-number"><span class="hljs-number">0</span></span>, "A4": <span class="hljs-number"><span class="hljs-number">0</span></span>, "A5": <span class="hljs-number"><span class="hljs-number">0</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> sheet <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(doc7.LayoutSheets.Count): <span class="hljs-keyword"><span class="hljs-keyword">format</span></span> = doc7.LayoutSheets.Item(sheet).<span class="hljs-keyword"><span class="hljs-keyword">Format</span></span> # sheet -  ,    <span class="hljs-number"><span class="hljs-number">0</span></span> sheets["A" + str(<span class="hljs-keyword"><span class="hljs-keyword">format</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">Format</span></span>)] += <span class="hljs-number"><span class="hljs-number">1</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">format</span></span>.FormatMultiplicity <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sheets</code> </pre> <br><p>  Let's look at the process of studying the SDK to find the functions of interest to us: </p><br><p><img src="https://habrastorage.org/files/d71/883/e2c/d71883e2c3654b0fb7ca0bec92b8998c.gif" alt="Animated"></p><br><h2 id="chitaem-osnovnuyu-nadpis">  We read the main title: </h2><br><p>  Here all the same LayoutSheets will help us: </p><br><pre> <code class="hljs scala">#    ,  ‚Ññ<span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stamp_scale</span></span></span></span>(doc7): stamp = doc7.<span class="hljs-type"><span class="hljs-type">LayoutSheets</span></span>.<span class="hljs-type"><span class="hljs-type">Item</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>).<span class="hljs-type"><span class="hljs-type">Stamp</span></span> # <span class="hljs-type"><span class="hljs-type">Item</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>)      <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> stamp.<span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-number"><span class="hljs-number">6</span></span>).<span class="hljs-type"><span class="hljs-type">Str</span></span></code> </pre> <br><p>  In fact, cell number 6 for a sheet with a different design may contain not a scale, but completely different information.  Let's see how drawing styles are defined in Kompas 3D: </p><br><p><img src="https://habrastorage.org/files/371/b6d/490/371b6d490efb4ce59876457318c4513d.png" alt="Style"></p><br><p>  Thus, it is important to check which file and design number correspond to the drawing sheet.  It is also worth remembering that the document may contain a title page!  Therefore it is necessary to complicate the code.  Let's use <a href="https://habrahabr.ru/post/115825/">regular expressions</a> , since  the text in the cell can be a link: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> re #     def stamp(doc7): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> sheet <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(doc7.LayoutSheets.Count): style_filename = os.path.basename(doc7.LayoutSheets.Item(sheet).LayoutLibraryFileName) style_number = <span class="hljs-type"><span class="hljs-type">int</span></span>(doc7.LayoutSheets.Item(sheet).LayoutStyleNumber) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> style_filename <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [<span class="hljs-string"><span class="hljs-string">'graphic.lyt'</span></span>, <span class="hljs-string"><span class="hljs-string">'Graphic.lyt'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> style_number == <span class="hljs-number"><span class="hljs-number">1</span></span>: stamp = doc7.LayoutSheets.Item(sheet).Stamp <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {"Scale": re.<span class="hljs-keyword"><span class="hljs-keyword">search</span></span>(r"\d+:\d+", stamp.Text(<span class="hljs-number"><span class="hljs-number">6</span></span>).Str).<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>(), "Designer": stamp.Text(<span class="hljs-number"><span class="hljs-number">110</span></span>).Str} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {"Scale": <span class="hljs-string"><span class="hljs-string">'  '</span></span>, "Designer": <span class="hljs-string"><span class="hljs-string">'  '</span></span>}</code> </pre> <br><p>  The last question remains: how to find out the desired cell number?  For these purposes, it is convenient to create a drawing file in which the cells of interest will be filled, and then read all possible options using the following function: </p><br><pre> <code class="hljs pgsql">#    def parse_stamp(doc7, number_sheet): stamp = doc7.LayoutSheets.Item(number_sheet).Stamp <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">10000</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> stamp.Text(i).Str: print(<span class="hljs-string"><span class="hljs-string">'  = %-5d  = %s'</span></span> % (i, stamp.Text(i).Str))</code> </pre> <br><h2 id="schitaem-kolichestvo-punktov-tehnicheskih-trebovaniy">  We count the number of points of technical requirements: </h2><br><p>  According to the SDK, we just need to get the TechnicalDemand interface from IDrawingDocument, and <br>  IDrawingDocument can be obtained from iDocuments using a wonderful method with the speaker name IUnknown :: QueryInterface.  And only in the SDK 16 version of Kompas 3D, an explanation appeared how to do it: </p><br><p><img src="https://habrastorage.org/files/e7c/a58/b7e/e7ca58b7efdb49f9ace1f39ad64b7f12.png" alt="IUnknown"></p><br><p>  With such clarifications, it is easy to write the following: </p><br><pre> <code class="hljs pgsql">#   ,   ,     def count_TT(doc7, module7): doc2D_s = doc7._oleobj_.QueryInterface(module7.NamesToIIDMap[<span class="hljs-string"><span class="hljs-string">'IDrawingDocument'</span></span>], pythoncom.IID_IDispatch) doc2D = module7.IDrawingDocument(doc2D_s) text_TT = doc2D.TechnicalDemand.Text count_tt = <span class="hljs-number"><span class="hljs-number">0</span></span> #     <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(text_TT.Count): #       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> text_TT.TextLines[i].Numbering == <span class="hljs-number"><span class="hljs-number">1</span></span>: #  ,      count_tt += <span class="hljs-number"><span class="hljs-number">1</span></span> #   ,    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> count_tt <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> text_TT.TextLines[<span class="hljs-number"><span class="hljs-number">0</span></span>]: count_tt += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> count_tt</code> </pre> <br><p>  It should be noted that this code relies on the automatic numbering of technical requirements.  So, if automatic numbering was not applied or technical requirements are typed using a simple ‚ÄúText‚Äù tool, the code will be more complicated.  I leave the solution of this problem to the reader. </p><br><h2 id="schitaem-kolichestvo-razmerov-na-chertezhe">  Consider the number of sizes on the drawing: </h2><br><p>  When calculating the dimensions, one must bear in mind that it is necessary to count them on each type of drawing: </p><br><pre> <code class="hljs tex">#    ,      def count_dimension(doc7, module7): IKompasDocument2D = doc7._oleobj_.QueryInterface(module7.NamesToIIDMap['IKompasDocument2D'], pythoncom.IID_IDispatch) doc2D = module7.IKompasDocument2D(IKompasDocument2D) views = doc2D.ViewsAndLayersManager.Views count_dim = 0 for i in range(views.Count): ISymbols2DContainer = views.View(i)._oleobj_.QueryInterface(module7.NamesToIIDMap['ISymbols2DContainer'], pythoncom.IID_IDispatch) dimensions = module7.ISymbols2DContainer(ISymbols2DContainer) #     count_dim += dimensions.AngleDimensions.Count + <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>dimensions.ArcDimensions.Count + <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>dimensions.Bases.Count + <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>dimensions.BreakLineDimensions.Count + <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>dimensions.BreakRadialDimensions.Count + <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>dimensions.DiametralDimensions.Count + <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>dimensions.Leaders.Count + <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>dimensions.LineDimensions.Count + <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>dimensions.RadialDimensions.Count + <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>dimensions.RemoteElements.Count + <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>dimensions.Roughs.Count + <span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"> </span></span></span></span>dimensions.Tolerances.Count return count_dim</code> </pre> <br><h2 id="osnovnaya-funkciya-skripta">  The main function of the script </h2><br><p>  As a result of the work done, we received the following: </p><br><pre> <code class="hljs pgsql">def parse_design_documents(paths): is_run = is_running() #  ,   , #        module7, api7, const7 = get_kompas_api7() #    app7 = api7.Application #     app7.Visible = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> #    ( ) app7.HideMessage = const7.ksHideMessageNo #       table = [] #    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-type"><span class="hljs-type">path</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> paths: doc7 = app7.Documents.<span class="hljs-keyword"><span class="hljs-keyword">Open</span></span>(PathName=<span class="hljs-type"><span class="hljs-type">path</span></span>, Visible=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, ReadOnly=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) #          <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> = amount_sheet(doc7) #  -    <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">update</span></span>(stamp(doc7)) #    <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">update</span></span>({ "Filename": doc7.Name, #   "CountTD": count_demand(doc7, module7), #     "CountDim": count_dimension(doc7, module7), #     }) <span class="hljs-keyword"><span class="hljs-keyword">table</span></span>.append(<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>) #      doc7.<span class="hljs-keyword"><span class="hljs-keyword">Close</span></span>(const7.kdDoNotSaveChanges) #     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> is_run: app7.Quit() #    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span></code> </pre> <br><h2 id="dialogovoe-okno-vybora-faylov">  File Selection Dialog </h2><br><p>  For convenient use of our script, we will use the capabilities of the standard tkinter module and display the file selection dialog box: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tkinter <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Tk <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tkinter.filedialog <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> askopenfilenames <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == "__main__": root = Tk() root.withdraw() #         filenames = askopenfilenames(title="  ", filetypes=[(<span class="hljs-string"><span class="hljs-string">'Kompas 3D'</span></span>, <span class="hljs-string"><span class="hljs-string">'*.cdw'</span></span>),]) print_to_excel(parse_design_documents(filenames)) root.destroy() #    root.mainloop()</code> </pre> <br><h2 id="otchyotnost">  Reporting </h2><br><p>  In order not to draw a user interface in tkintere, I suggest using a good Excel program, where we will output the result of our work: </p><br><pre> <code class="hljs pgsql">def print_to_excel(result): excel = Dispatch("Excel.Application") #   Excel excel.Visible = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> #    wb = excel.Workbooks.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>() #    sheet = wb.ActiveSheet #      #    sheet.Range("A1:J1").<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = [" ", "", "- ", "-  ", "0", "1", "2", "3", "4", ""] #   <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(result): sheet.Range("A%d:J%d" % i+<span class="hljs-number"><span class="hljs-number">2</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = [<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>[<span class="hljs-string"><span class="hljs-string">'Filename'</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>[<span class="hljs-string"><span class="hljs-string">'Designer'</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>[<span class="hljs-string"><span class="hljs-string">'CountDim'</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>[<span class="hljs-string"><span class="hljs-string">'CountTD'</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>[<span class="hljs-string"><span class="hljs-string">'A0'</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>[<span class="hljs-string"><span class="hljs-string">'A1'</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>[<span class="hljs-string"><span class="hljs-string">'A2'</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>[<span class="hljs-string"><span class="hljs-string">'A3'</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>[<span class="hljs-string"><span class="hljs-string">'A4'</span></span>], "".<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>((<span class="hljs-string"><span class="hljs-string">'="'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>[<span class="hljs-string"><span class="hljs-string">'Scale'</span></span>], <span class="hljs-string"><span class="hljs-string">'"'</span></span>))]</code> </pre> <br><p>  If you don‚Äôt be lazy and prepare the Excel file correctly, then the result of the work of our script can be immediately presented in a visual form: </p><br><p><img src="https://habrastorage.org/files/368/ebd/e0b/368ebde0bc76418b91e57ab9e5a1e7b6.png" alt="Here is a beautiful color image from Excel"></p><br><p>  The graph shows the participation of each employee of the department in the release of product documentation. </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Using the script for the drawing, created specifically for this article, we get the following results: </p><br><ul><li>  Number of sizes: 25 pieces </li><li>  Number of points of technical requirements: 3 pieces </li><li>  Scale: 1: 1 </li><li>  Number of sheets: 1, A3 format </li></ul><br><p>  Labor costs, according to the document mentioned at the beginning of the article, were: 1 hour 20 minutes.  Oddly enough, about as much time was spent on the development of the drawing. <br>  Of course, for the introduction of such standards in the enterprise, more serious research and completely different volumes of design documentation are needed.  This article will help to simplify the work with the Kompas 3D API when solving similar problems. <br>  I will be glad to any of your comments and suggestions to the article. </p><br><h2 id="ishodnyy-kod">  Source </h2><br><ul><li>  <a href="">Github</a> </li></ul><br><h2 id="resursy-v-pomosch">  Resources to help: </h2><br><ol><li>  SDK ( <i>C: \ Program Files \ ASCON \ KOMPAS-3D V16 \ SDK \ SDK.chm</i> ) </li><li>  <a href="http://forum.ascon.ru/">forum.ascon.ru</a> </li></ol></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/323078/">https://habr.com/ru/post/323078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../323066/index.html">Promises on the example of a burger party</a></li>
<li><a href="../323068/index.html">Mobile bankers were distributed on Google Play under the guise of weather applications</a></li>
<li><a href="../323070/index.html">How we made the first L / C on blockchain at Alfa-Bank</a></li>
<li><a href="../323072/index.html">Sound effects in virtual worlds</a></li>
<li><a href="../323074/index.html">Bitcoin walks the world. Or not?</a></li>
<li><a href="../323080/index.html">The fate of the package. Cisco IOS XE</a></li>
<li><a href="../323084/index.html">What you need to know to use omnichannel communications?</a></li>
<li><a href="../323086/index.html">Creating images on CSS makes a maker-up better, or What to do during long winter evenings</a></li>
<li><a href="../323090/index.html">Uninvented stories about EastBanc Technologies in photos</a></li>
<li><a href="../323092/index.html">Recreating subdatasheet in table on AngularJS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>