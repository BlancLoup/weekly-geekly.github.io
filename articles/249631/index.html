<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The first development and publication of the game in social networks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Idea of ‚Äã‚Äãthe game 
 I had a long-standing desire to develop a full-fledged game for social networks, but there were no interesting ideas. Once I saw ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The first development and publication of the game in social networks</h1><div class="post__text post__text-html js-mediator-article"><h5>  Idea of ‚Äã‚Äãthe game </h5><br>  I had a long-standing desire to develop a full-fledged game for social networks, but there were no interesting ideas.  Once I saw in the appstore a word game that was only in English.  I wanted to do the same with the Russian dictionary. <br><br>  The meaning of the game is to make words from contiguous hexagons.  The game has 3 modes: <br><ul><li>  game against time (when searching for words, 1 second is added for each letter); </li><li>  find a way out of the allotted time (find the words and thus pave the way to the exit from the center); </li><li>  free mode (word search and completion at any time). </li></ul><br><div class="spoiler">  <b class="spoiler_title">Appearance</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/f80/0d3/8e5/f800d38e585a452b9489cdafd34cf2fc.jpg"><br><br><img src="https://habrastorage.org/files/77c/282/09e/77c28209e08a4653af79fec3e74a4c15.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/2e2/6ab/7a2/2e26ab7a2c8a41788b161db9dd8069ab.jpg"><br></div></div><br><a name="habracut"></a><br><h5>  Monetization </h5><br>  In the original game, the monetization was that one of three types of games was available to the user.  The rest are unlocked after 50 and 100 games played. <br><br>  I decided to do a similar monetization.  But later he added the functionality of word hints.  Tips can be purchased. <br><br>  Additional advertising: <br><ul><li>  VK - dating service and preloader </li><li>  OK - offer traffic management system </li></ul><br><br><h5>  Time spent </h5><br>  The development was conducted from scratch (including the study of the framework) in its free time from the main work, in the first month is very active. <br><br>  The schedule of expenses of pure time for development (does not include time for documentation and forums): <br><br><img src="https://habrastorage.org/files/f44/6b4/5d1/f446b45d1e134e918ef9ef963fd8aacb.png" alt="image"><br><br><h5>  Theory </h5><br>  First of all, before developing the game, I had to study the features of mathematics with hexagons.  Great article that covers everything I need to know <a href="http://www.redblobgames.com/grids/hexagons/">www.redblobgames.com/grids/hexagons</a> <br><br><h5>  Choosing a development environment </h5><br>  The development was divided into 2 parts - into 2 autonomous projects: <br><ol><li>  JS code of the game itself; </li><li>  PHP code for saving / issuing player statistics and additional files for interacting with social networks. </li></ol><br>  Initially, the idea was to use a cross-platform framework to develop a game for the browser and then port it to ios and android.  Therefore, the choice fell on the cocos2d framework version html5. <br><br>  The main disadvantage of this framework is bad documentation, some things had to be found in the source code.  But the use of this framework was bribed by some of its popularity, as well as the participation of zynga in its development.  In general, I was not disappointed in him. <br><br>  A feature of this framework is that everything on the screen is divided into layers and sprite objects.  Which by default are drawn with a frequency of 60 frames / sec.  You can also activate forcibly or automatically selecting a webgl mode that enables hardware acceleration for graphics. <br><br><h5>  Graphics </h5><br>  I ordered all the graphics on the freelance site after the prototype was ready.  Separately, I had to order the icon, which has become more advantageous. <br><br><h4>  Some technical issues and development features </h4><br><h5>  Problem 1 - sprite caching </h5><br>  If you look at the main screen of the game, you can see a lot of objects - hexagons and letters.  In two games, their total number is about 5 thousand. This caused the first problem - the framework redraws them all 60 times per second and slows down terribly. <br><br>  To solve this problem, there was one solution: <br><ol><li>  Use letters as pictures; </li><li>  Combining all the pictures into one file.  Using the Texture Packer program, all the pictures were packed into 2 png files.  One file was used for images in the main menu, the second - in the game itself.  It saves one common picture with sprites and additionally attaches an xml file with a description of the boundaries of each sprite.  This is all imported by the framework and stored in memory; </li><li>  Using a special container SpriteBatchNode.  According to the documentation, all the sprites included in SpriteBatchNode will be rendered in a single WebGL rendering call, and all the sprites that are not included in this component are drawn individually.  Be sure all files added to the container must be in the same file. <br><br><div class="spoiler">  <b class="spoiler_title">Sample code that uses the SpriteBatchNode container</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> size = cc.director.getWinSize(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x0 = size.width / <span class="hljs-number"><span class="hljs-number">2</span></span> - (<span class="hljs-number"><span class="hljs-number">3</span></span> / <span class="hljs-number"><span class="hljs-number">4</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.game.tileWidth * <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.game.size) / <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> y0 = size.height / <span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.game.tileHeight * <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.game.size / <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> hex = cc.textureCache.addImage(res.Game_png); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._hexBatch = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> cc.SpriteBatchNode(hex, <span class="hljs-number"><span class="hljs-number">50</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._tableLayer.addChild(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._hexBatch); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.game.size; i++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.game.size; j++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> layer = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.game.table[i][j]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!layer || layer == <span class="hljs-string"><span class="hljs-string">'*'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> height = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sqrt(<span class="hljs-number"><span class="hljs-number">3</span></span>) / <span class="hljs-number"><span class="hljs-number">2</span></span> * layer.width - <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> width = layer.width - <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = x0 + i * <span class="hljs-number"><span class="hljs-number">3</span></span> / <span class="hljs-number"><span class="hljs-number">4</span></span> * width; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> y = y0 - j * height / <span class="hljs-number"><span class="hljs-number">2</span></span> - (j + <span class="hljs-number"><span class="hljs-number">1</span></span>) * height / <span class="hljs-number"><span class="hljs-number">2</span></span> - (i % <span class="hljs-number"><span class="hljs-number">2</span></span>) * height / <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> border = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> cc.Sprite(<span class="hljs-string"><span class="hljs-string">'#'</span></span> + layer.hexagon_border); border.x = x; border.y = y; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._hexBatch.addChild(border); layer.attr({ <span class="hljs-attr"><span class="hljs-attr">x</span></span>: x, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: y }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._hexBatch.addChild(layer); } } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addChild(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._tableLayer); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.wordPreviewLayer = WordPreviewLayer.create(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addChild(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.wordPreviewLayer);</code> </pre> <br></div></div><br>  The only problem is that it only makes sense if the user has an active WebGL, without hardware acceleration, it will not work in the same way. <br></li></ol><br><br><h5>  Problem 2 - events </h5><br>  The whole project is divided into separate components, each of which lies in a separate class and file.  They do not directly contact each other.  Interaction is implemented using global events.  Cocos2d contains the EventManager class for working with events. <br><br>  A number of own events were created. <br><br><div class="spoiler">  <b class="spoiler_title">Event Initialization Example</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Timer = cc.LabelBMFont.extend({ <span class="hljs-attr"><span class="hljs-attr">started</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">paused</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">lastTime</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">timerLength</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">alert</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-attr"><span class="hljs-attr">listeners</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">init</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners.push(cc.eventManager.addCustomListener(EVENT_TIMER_START, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.start(data.getUserData()); }.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners.push(cc.eventManager.addCustomListener(EVENT_TIMER_STOP, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stop(); }.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners.push(cc.eventManager.addCustomListener(EVENT_TIMER_PAUSE, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.pause(); }.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners.push(cc.eventManager.addCustomListener(EVENT_TIMER_CONTINUE, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.resume(); }.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners.push(cc.eventManager.addCustomListener(EVENT_TIMER_ADD, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> seconds = data.getUserData(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.add(seconds); cc.eventManager.dispatchCustomEvent(EVENT_TIMER, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timerLength); }.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners.push(cc.eventManager.addCustomListener(EVENT_TIMER_END, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timerLength = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stop(); }.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }, <span class="hljs-attr"><span class="hljs-attr">cleanup</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._super(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners) { cc.eventManager.removeListener(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.listeners[i]); } },</code> </pre><br></div></div><br>  Event call example: <br><br><pre> <code class="javascript hljs">cc.eventManager.dispatchCustomEvent(EVENT_TIMER_START, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timer_start);</code> </pre><br>  When working with custom events, there are also some features: after an object is destroyed, the eventManager will still consider it subscribed.  To solve this problem, a local array of listeners is filled in for each object, and when the object is destroyed, the destructor method is always called cleanup, in which I remove the custom methods that have been added. <br><br><h5>  Problem 3 - mobile version </h5><br>  With the mobile version of the game did not happen. <br>  Firstly, the game is launched in a mobile environment in the SpiderMonkey emulator, in which, for some reason, caching did not work.  Because of what the game is terribly slow on the iPad. <br><br>  Secondly, some constructions written by me caused an error, the code needs to be modified in some places for compatibility. <br><br>  The porting plan for ios and android is currently postponed. <br><br><h5>  Achivki </h5><br>  Later in the game were added 50 achivok.  Working with them was not so difficult.  To implement achivok, we create an array that contains the parameters and the init method to initialize the handler, which will fix the fulfillment of the achivka condition: <br><br><div class="spoiler">  <b class="spoiler_title">Example</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> achievements = [ { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-string"><span class="hljs-string">'the_graduate'</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: t(<span class="hljs-string"><span class="hljs-string">'The Graduate'</span></span>), <span class="hljs-attr"><span class="hljs-attr">description</span></span>: t(<span class="hljs-string"><span class="hljs-string">'You completed Tutorial'</span></span>), <span class="hljs-attr"><span class="hljs-attr">game</span></span>: <span class="hljs-string"><span class="hljs-string">'Tutorial'</span></span>, <span class="hljs-attr"><span class="hljs-attr">icon</span></span>: <span class="hljs-string"><span class="hljs-string">'graduate.png'</span></span>, <span class="hljs-attr"><span class="hljs-attr">pts</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">init</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> event = cc.eventManager.addCustomListener(EVENT_TUTORIAL_END, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ sendAchieve(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, event); }.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); } }, { ‚Ä¶ }];</code> </pre><br></div></div><br>  And we add initialization of all achievements that the user has not earned yet. <br><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text"><pre> <code class="javascript hljs">cc.eventManager.addCustomListener(EVENT_GAME_LOADED, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> achievements) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!cc.UserData.achievements || cc.UserData.achievements.indexOf(achievements[i].id) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) { achievements[i].init(); } } cc.eventManager.addCustomListener(EVENT_SEND_ACHIEVEMENT, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> achieveData = data.getUserData(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!cc.UserData.achievements) { cc.UserData.achievements = []; } cc.UserData.achievements.push(achieveData.id); }) });</code> </pre><br></div></div><br>  In this example, when the user completes the training level, a pop-up message about the earned profit is displayed to the user, a request is sent to the server, and the feedback is added to the array of information about the user. <br><br><h5>  Word search </h5><br>  When a game is loaded from the server, a dictionary of words is loaded, which is searched by selecting each letter.  Initially, a simple array with words was used, which affected the overall performance, as the dictionary contains about 150 thousand words.  When I started looking for a solution to this problem, I came across the concept of Trie or Prefix Tree.  As a result, the original array was converted to a file in trie data format.  This solution has significantly reduced the brakes in the allocation of each letter of the word. <br><br><h5>  Build project </h5><br>  Before you transfer the js source to the second project, you need to build and minify all files into one js file.  For this, cocos2d already has a ready-made build.xml file, which has been updated.  As a result, the assembly is performed by one command in the console - ant.  We simply copy the finished file to the second project. <br><br><h5>  Statistics collection and integration with social networks </h5><br>  As a backend, the choice fell on symfony 2 and DB mongo just because for me it is a quick and easy way to implement the backend part. <br><br>  Here you can select only one feature - for each social network a separate integration file was created and build.xml created 3 minified files for each social network. <br><br><h5>  Web server optimization </h5><br>  The entire project is hosted on one vps server from digitalocean with a standard rate of $ 10: 1 core cpu, 1Gb ram, 30Gb ssd.  OS debian, nginx + php-fpm web server.  Db mongodb. <br><br>  To optimize traffic, gzip optimization was enabled.  But it increased the load on the processor at the time when there was a lot of traffic to classmates.  As a result, the following solution was implemented: <br><br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">gzip_static</span></span> <span class="hljs-literal"><span class="hljs-literal">on</span></span>;</code> </pre><br>  For each js file, the build.xml script created a compressed version with the .gz extension. As a result, nginx simply took these files and gave them to the client without any load on the processor. <br><br><h4>  Statistics </h4><br>  The game was first launched in the VC.  The day after approval, the game was added to the new section. <br>  A separate splash was after 2 weeks, when I ordered a new icon, which looked more logical. <br><br><div class="spoiler">  <b class="spoiler_title">Schedule</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/bc6/077/9bd/bc60779bdea74ff78f5edbccb5f61f78.jpg" alt="image"><br></div></div><br>  With Facebook is not a very clear situation.  Yet it seems to me that there is no point in crawling there without advertising - there are many mobile games in the catalog. <br><br>  Statistics next.  In early January, a clear surge is seen, which abruptly went to zero. <br>  To transfer the money earned, you must provide documents.  Here, too, I did not understand - you can register as a private person, but they also ask for the OGRN. <br><br><div class="spoiler">  <b class="spoiler_title">Schedule</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/9fd/fb2/709/9fdfb2709a4047669f9edb19939d3cd0.png" alt="image"><br></div></div><br>  To start the game in the OK you need to have the PI or legal entity.  But you can find people who already have their games in OK and publish through them, agreeing on the amount of 10% of the funds transferred to the p / s account (OK takes a little more than 50%). <br><br>  In OK, the statistics look more interesting: <br><br><div class="spoiler">  <b class="spoiler_title">Schedule</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/88c/a2d/f54/88ca2df54e5b4952b3318645a7dd855a.png" alt="image"><br></div></div><br>  Google general statistics since launch: <br><br><div class="spoiler">  <b class="spoiler_title">Schedule</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/6c3/628/7cf/6c36287cf54d4adc893173ddc69705ba.jpg" alt="image"><br></div></div><br>  Also, Google has the ability to save events.  For example, there are such statistics on events in the game: <br><br><div class="spoiler">  <b class="spoiler_title">Schedule</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/b2d/521/9a8/b2d5219a84d44627a6c327cf1bd62afd.png" alt="image"><br></div></div><br>  CPU load statistics: <br><br><div class="spoiler">  <b class="spoiler_title">Schedule</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/67a/006/246/67a006246c074e4b890bbd04d9d4079d.png" alt="image"><br></div></div><br><br><h5>  Total </h5><br><h6>  Expenses </h6><br><ul><li>  The development took about 200 hours of free time from work; </li><li>  Design - 5500 rubles. </li></ul><br><br><h6>  "Income" </h6><br>  VC: <br><ul><li>  Users - 31,000 people; </li><li>  Payments for the entire period - 84 votes; </li><li>  Advertising revenue - 1500 rubles. </li></ul><br>  OK: <br><ul><li>  Users - 171,500 people; </li><li>  Payments for January - 27660 OK; </li><li>  Advertising revenue (for 2 weeks) - 2600 rubles. </li></ul><br>  FB: <br><ul><li>  Users - 12,900 people; </li><li>  Payments are $ 4.70. </li></ul><br><br><h4>  Results </h4><br>  It can be concluded that for some earnings you need a game with a mandatory donat.  Also, all types of monetization and advertising must be connected immediately.  Since I was not familiar with popular advertising sites and the actual amount of traffic, I didn‚Äôt connect them later when the first wave of traffic passed. <br><br>  It is also necessary to perform load testing, since it is not known in advance how the game will go. </div><p>Source: <a href="https://habr.com/ru/post/249631/">https://habr.com/ru/post/249631/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../249621/index.html">R programming language</a></li>
<li><a href="../249623/index.html">Observium - more than a monitoring system</a></li>
<li><a href="../249625/index.html">Own browser - mouse path: the beginning</a></li>
<li><a href="../249627/index.html">We convert what3words addresses to other spatial coordinates using TWCC</a></li>
<li><a href="../249629/index.html">BemPHP: implementation of the BEM methodology using PHP</a></li>
<li><a href="../249633/index.html">What is CRM-systems and how to choose them correctly?</a></li>
<li><a href="../249635/index.html">Yandex killed service Subscriptions</a></li>
<li><a href="../249637/index.html">Twitter-based bot Markov and phrases from the series</a></li>
<li><a href="../249639/index.html">KISS - the design principle, containing all other design principles</a></li>
<li><a href="../249641/index.html">Diablo 3 - Resource Bubbles</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>