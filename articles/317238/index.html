<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Minimal environment for JS development: ava, standard, chokidar-cli and precommit-hook</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There are a lot of JavaScript frameworks, libraries and various tools around. What to choose? Looking at this diversity, the developer is not easy to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Minimal environment for JS development: ava, standard, chokidar-cli and precommit-hook</h1><div class="post__text post__text-html js-mediator-article">  There are a lot of JavaScript frameworks, libraries and various tools around.  What to choose?  Looking at this diversity, the developer is not easy to answer this question. <br><br> <a href="https://habrahabr.ru/company/ruvds/blog/317238/"><img src="https://habrastorage.org/getpro/habr/post_images/122/42e/9e9/12242e9e9a94897c5abb6a954784082a.jpg" alt="image"></a> <br><br>  I know from experience: the first step of a new project, for example, creating a module or command-line tool, is to set up the working environment.  Some people like this step, some cannot stand it, but even in those and others, preliminary preparation often takes an inadmissibly long time.  Especially when you need to carefully check everything and make all mechanisms work together smoothly and stably. <br><a name="habracut"></a><br>  Of course, you can include webpack, eslint, jasmine, or even TypeScript in the JS developer‚Äôs arsenal.  With this approach, finding and fixing errors will not be problems.  But the thing is that simple tools that require almost no adjustment are perfect for solving most auxiliary tasks.  The environment collected from them will allow you to get started as quickly as possible, will ensure control of the correctness of the code and timely notification of errors. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      When I think about the minimal JS environment, four things immediately come to mind: testing the program and analyzing the code, tracking file changes during work and checking the project before committing transactions to the version control system. <br><br>  Now I will talk in detail about how, from scratch, to create a development environment that will allow you to begin productive work in a matter of minutes. <br><br><h2>  <font color="#3AC1EF">Initializing the Node.js project and the Git repository</font> </h2><br>  First create a directory and go to it.  Here the <code>$_</code> construct holds the argument of the last command. <br><br><pre> <code class="hljs ruby">$ mkdir awesome-<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> &amp;&amp; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cd</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">_</span></span></span></span></code> </pre> <br>  Now we initialize the Node.js project with default settings. <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">npm</span></span> init --<span class="hljs-literal"><span class="hljs-literal">yes</span></span></code> </pre> <br>  Create folders and files <br><br><pre> <code class="hljs cmake">$ mkdir lib <span class="hljs-keyword"><span class="hljs-keyword">test</span></span> $ touch index.js lib/meaningOfLife.js <span class="hljs-keyword"><span class="hljs-keyword">test</span></span>/index.<span class="hljs-keyword"><span class="hljs-keyword">test</span></span>.js <span class="hljs-keyword"><span class="hljs-keyword">test</span></span>/meaningOfLife.<span class="hljs-keyword"><span class="hljs-keyword">test</span></span>.js</code> </pre> <br>  Now, we initialize the Git repository and commit the first transaction. <br><br><pre> <code class="hljs pgsql">$ git init $ git <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> -A; git <span class="hljs-keyword"><span class="hljs-keyword">commit</span></span> -am "Awesome Module, day one"</code> </pre> <br>  We have prepared the structure of the project, we will deal with the tools. <br><br><h2>  <font color="#3AC1EF">Installation tools</font> </h2><br>  We will use four simple modules, each of which is designed to solve one problem: <br><br><ul><li>  <a href="https://github.com/avajs/ava">Ava</a> - testing. <br></li><li>  <a href="https://github.com/feross/standard">Standard</a> - static code analysis. </li><li>  <a href="https://github.com/kimmobrunfeldt/chokidar-cli">Chokidar-cli</a> - monitoring changes in files. </li><li>  <a href="https://github.com/nlf/precommit-hook">Precommit-hook</a> - automatic launch of npm-scripts. </li></ul><br>  Why did I choose them?  Just because they do not require any configuration at all.  This approach perfectly unloads the head, opening the way to useful ideas relating to the development.  Install the modules by running the following command in the project folder: <br><br><pre> <code class="hljs pgsql">$ npm i <span class="hljs-comment"><span class="hljs-comment">--save-dev ava standard chokidar-cli precommit-hook</span></span></code> </pre> <br>  After installation (the speed of which depends only on the NPM mood), do not forget to create a <code>.gitignore</code> file and add the <code>node_modules</code> folder to <code>node_modules</code> .  It is not needed in the repository. <br><br><h2>  <font color="#3AC1EF">Project Setup</font> </h2><br>  By themselves, our tools do not need to be set up, but the project, nevertheless, will have to be set up.  True, everything is extremely simple.  Open <code>package.json</code> and add the following scripts to it: <br><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"scripts"</span></span>: { <span class="hljs-string"><span class="hljs-string">"test"</span></span>: <span class="hljs-string"><span class="hljs-string">"ava"</span></span>, <span class="hljs-string"><span class="hljs-string">"lint"</span></span>: <span class="hljs-string"><span class="hljs-string">"standard"</span></span>, <span class="hljs-string"><span class="hljs-string">"dev"</span></span>: <span class="hljs-string"><span class="hljs-string">"chokidar '**/*.js' -c 'standard &amp;&amp; ava'"</span></span> }, <span class="hljs-string"><span class="hljs-string">"pre-commit"</span></span>: [<span class="hljs-string"><span class="hljs-string">"test"</span></span>, <span class="hljs-string"><span class="hljs-string">"lint"</span></span>],</code> </pre> <br>  That's all.  As soon as you execute the <code>npm run dev</code> <code>chokidar</code> , <code>chokidar</code> will begin to monitor the status of the files, launching, if necessary, the <code>standard</code> for static analysis, and the <code>ava</code> for testing the code.  If problems are found, you will immediately find out.  The same applies to making changes to the repository.  Our environment will not allow to commit a transaction until the project is successfully analyzed and tested. <br><br>  Here I would like to draw attention to two things. <br><br><ol><li>  You do not need to set <code>standard</code> or <code>ava</code> globally, since they are executed from within the context of the <code>node</code> . <br><br></li><li>  Since we use <code>&amp;&amp;</code> instead of <code>;</code>  in the <code>dev</code> script, the tests will not be called until the code passes the test with the static analyzer.  It speeds up the work. </li></ol><br><h2>  <font color="#3AC1EF">How to use it</font> </h2><br>  The development environment is designed for programming in development style through testing (TDD).  As soon as the <code>dev</code> script is run, you can create tests, they will be automatically added to the test code set, without the need to restart the file monitoring tool or perform any other operations. <br><br>  Let's create the first test. <br><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> test/meaningOfLife.test.js const test = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'ava'</span></span>) const meaningOfLife = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../lib/meaningOfLife'</span></span>) test(<span class="hljs-string"><span class="hljs-string">'Real meaning of life'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t)</span></span></span><span class="hljs-function"> =&gt;</span></span> { t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(meaningOfLife(), <span class="hljs-number"><span class="hljs-number">42</span></span>) })</code> </pre> <br>  After saving this file, the system immediately reports that one of the tests failed.  Fix it. <br><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> lib/meaningOfLife.js <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-number"><span class="hljs-number">42</span></span></code> </pre> <br>  Now everything works as it should!  There is simply no place.  Create a module that multiplies the numeric parameters.  We will immediately prepare a unit test for it, and also see if the new module works correctly with <code>meaningOfLife</code> .  This, by the way, will be an integration test, not a unit test.  Here is the module code: <br><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> lib/multiply.js <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(number)</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> number !== <span class="hljs-string"><span class="hljs-string">'number'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TypeError(<span class="hljs-string"><span class="hljs-string">'Only numbers can be multiplied!'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> number * <span class="hljs-number"><span class="hljs-number">2</span></span> }</code> </pre> <br>  Here is a test for it: <br><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> test/multiply.test.js const test = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'ava'</span></span>) const multiply = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../lib/multiply'</span></span>) test(<span class="hljs-string"><span class="hljs-string">'Can multiply numbers'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t)</span></span></span><span class="hljs-function"> =&gt;</span></span> { t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(multiply(<span class="hljs-number"><span class="hljs-number">10</span></span>), <span class="hljs-number"><span class="hljs-number">20</span></span>) }) test(<span class="hljs-string"><span class="hljs-string">'Throws when you try to multiply non-number value'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t)</span></span></span><span class="hljs-function"> =&gt;</span></span> { t.throws(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> multiply(<span class="hljs-string"><span class="hljs-string">'ohai!'</span></span>), <span class="hljs-string"><span class="hljs-string">'Only numbers can be multiplied!'</span></span>) })</code> </pre> <br>  Now let's test everything together: <br><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> test/index.test.js const test = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'ava'</span></span>) const awesomeModule = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../index'</span></span>) test(<span class="hljs-string"><span class="hljs-string">'Works nicely together'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t)</span></span></span><span class="hljs-function"> =&gt;</span></span> { t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(awesomeModule(), <span class="hljs-number"><span class="hljs-number">84</span></span>) })</code> </pre> <br>  And we add the following to index.js: <br><br><pre> <code class="hljs coffeescript"><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> index.js const meaningOfLife = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./lib/meaningOfLife'</span></span>) const multiply = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./lib/multiply'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> multiply(meaningOfLife())</code> </pre> <br>  Tests passed!  As you can see, thanks to the simplicity of the tools, we very quickly started working on the project, spending quite a bit of time preparing the environment. <br><br><h2>  <font color="#3AC1EF">Results</font> </h2><br>  New sparkling tools often literally hypnotize programmers, forcing to forget about the main thing.  And the main thing is simplification and acceleration of work and struggle with errors.  Usually, much more often than it may seem, the simplest means are enough to solve these problems.  Those that allow you to spend time on creating programs, and not on setting up auxiliary systems. <br><br>  When the project starts to grow, you may feel that you need something much more advanced than the simple combination of ava, standard, chokidar-cli and precommit-hook.  But in most cases, however, nothing else is needed.  And those simple and understandable tools that I have described will serve you faithfully for a very, very long time. <br>  And in what environment do you create programs? </div><p>Source: <a href="https://habr.com/ru/post/317238/">https://habr.com/ru/post/317238/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../317226/index.html">What a botnet begins with: a dangerous backdoor found in Sony IP cameras</a></li>
<li><a href="../317228/index.html">Paul Graham's Strategic Essay: Refraction (Part 2)</a></li>
<li><a href="../317230/index.html">Hetzner, save IPv4 addresses for XenServer virtual machines</a></li>
<li><a href="../317232/index.html">Implementing NSTouchBar on Swift</a></li>
<li><a href="../317236/index.html">Developing a game for Android on Unity 5. From idea to monetization (Live)</a></li>
<li><a href="../317240/index.html">Rostelecom has reported on the reflection of the attack of the Internet of Things on the largest Russian banks</a></li>
<li><a href="../317242/index.html">Taxi service plays a database of customer contacts and drivers</a></li>
<li><a href="../317244/index.html">Case Digital BBDO: How We Promoted Rostelecom With Relap.io Native Advertising</a></li>
<li><a href="../317246/index.html">Prediction of the severity of insurance claims for Allstate. Graduation project of our graduate</a></li>
<li><a href="../317248/index.html">Unchangeable JavaScript: how it is done with ES6 and higher</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>