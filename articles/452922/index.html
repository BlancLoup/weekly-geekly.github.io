<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Flexible tables on CSS Grid</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="View a list of leads ("cold" contacts) 

 Since we have already started, I can finally tell you about a secret project that I have been working on for...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Flexible tables on CSS Grid</h1><div class="post__text post__text-html js-mediator-article"> <a href=""><img src="https://habrastorage.org/webt/id/sg/ye/idsgyex13y6jxpp3ylbvnqrvsxs.png"></a> <br>  <i><font color="gray">View a list of leads ("cold" contacts)</font></i> <br><br>  Since we have already started, I can finally tell you about a secret project that I have been working on for the last two years.  One of the interesting features of <a href="https://www.teamwork.com/crm">Teamwork CRM</a> is a list view. <br><br>  This is a powerful component that occurs seven times in an application.  In fact, the table on steroids.  I could tell a lot, but do not want to bore you.  Focusing on how we implemented this flexibility with just a few lines of CSS (Grid).  Namely, how we lay out heavy data tables, how we support column resizing and more. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      First, you need to explain the context, starting with the goal and objectives of the design of these tables.  If this does not interest, feel free to go directly to the <a href="https://habr.com/ru/post/452922/">technical implementation</a> . <br><a name="habracut"></a><br>  First of all, our solution allows customers to quickly browse lists, for example, leads or contacts, and notice important details.  This is not similar to an Excel spreadsheet ‚Äî we better cope with data layouts if there are a lot of them. <br><br>  Absolutely everything works in an adaptive, flexible design.  We start with the narrowest option and customize the layout based on the content, design and use cases (we do not have device-oriented brekpoints). <br><br>  At the minimum width of the screen, the columns are stacked vertically, occupying the entire width of the screen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c72/5a1/2d8/c725a12d8eab7988110693b9616428a2.png"></div><br>  <i><font color="gray">How the list looks on a narrow screen</font></i> <br><br>  Flexible tables are not easy to do.  You can choose from <a href="https://bradfrost.github.io/this-is-responsive/patterns.html">several existing templates</a> .  Think about what information users are looking for, and choose wisely. <br><br>  Once we have enough pixels on the screen, we switch to a more typical layout, so the speakers ... well, become the speakers.  Then there are no major changes in the layout, but we still want to display the columns as conveniently as possible for the client. <br><br>  Suppose we have a lot of columns (later we will look at how the user can customize them).  First, the table should at least fill the width of the screen.  Secondly, the width of the columns should be determined by their contents and type of values.  For example, short / long text, date, number, URL, etc. Date columns should take up less space than long text columns. <br><br>  The columns should have a minimum width.  The result is often a table that scrolls both vertically and horizontally. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4f3/29d/eae/4f329deae55f9b04370786801d217e92.gif"><br>  <i><font color="gray">How the layout depends on the width of the window.</font></i>  <i><font color="gray">Sorry for the tattered gif, later I will give a few interactive examples</font></i> <br><br>  Let's start with the fact that we are using the usual old school CSS for the table to the maximum.  Then we improve it using CSS Grid.  Then I will show how Grid users resize columns, which was much more inconvenient with regular CSS. <br><br><a name="1"></a><h1>  Well, show already CSS Grid </h1><br>  I'm not a CSS Grid expert, but I like him.  This is an extremely powerful and simple tool that implements complex layouts with a minimal amount of code.  Here I will skip the introduction to technology.  You can read Rachel Andrew <a href="https://abookapart.com/products/the-new-css-layout">'s New CSS Layouts</a> or <a href="https://css-tricks.com/snippets/css/complete-guide-grid/">the Complete Grid Guide</a> .  When you finish thinking about where this tool has been all your life, come back to me. <br><br>  First, we apply <code>display:grid</code> to <code>&lt;table&gt;</code> to turn the table into a grid.  It will not break anything: if the browser does not support the Grid, then apply <code>display:table</code> .  The <code>&lt;thead&gt;</code> and <code>&lt;tbody&gt;</code> elements become grid elements.  We don't need to think about <code>&lt;thead&gt;</code> , <code>&lt;tbody&gt;</code> or even <code>&lt;tr&gt;</code> .  We want to put our <code>&lt;th&gt;</code> and <code>&lt;td&gt;</code> on this grid by applying <code>display:grid</code> to each of them (i.e. the grids inside the grids), but this is not ideal.  Each <code>&lt;tr&gt;</code> grid will be independent of the others, and this is not good (you will see later that the same problem with the Flexbox). <br><br>  A workaround is to use <code>display:contents</code> on <code>&lt;thead&gt;</code> , <code>&lt;tbody&gt;</code> and <code>&lt;tr&gt;</code> .  This basically removes them from the grid layout, pushing forward child elements ( <code>&lt;th&gt;</code> and <code>&lt;td&gt;</code> ). <br><br>  Then we use the <code>grid-template-columns</code> magic rule to control the grid elements.  Yes, just one line of CSS.  For example, if we have a date column and a URL column, we‚Äôll have something like this: <br><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">grid-template-columns</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">minmax</span></span>(150<span class="hljs-selector-tag"><span class="hljs-selector-tag">px</span></span>, 1<span class="hljs-selector-class"><span class="hljs-selector-class">.33fr</span></span>) <span class="hljs-selector-tag"><span class="hljs-selector-tag">minmax</span></span>(150<span class="hljs-selector-tag"><span class="hljs-selector-tag">px</span></span>, 2<span class="hljs-selector-class"><span class="hljs-selector-class">.33fr</span></span>);</code> </pre> <br>  We use the same minimum size for all columns, but the maximum value ( <code>fr</code> ) is determined by the data type of the column.  I tried <code>auto</code> and <code>max-content</code> , but we came up with a better option.  Here is a simplified example: <a href="https://codepen.io/adam-lynch/pen/XwKWdG">an interactive table with code</a> .  Try resizing the window. <br><br><h1>  Changing column widths with a grid </h1><br>  In addition, in our tables, you can swap, change the width and hide the columns.  The latter is important because so many columns with different data types are supported: these are properties of the element itself (for example, leads), properties of related elements (for example, a company associated with a lead), and custom fields. <br><br>  For example, a user can create a custom field (date) for contacts called ‚ÄúDate of birth‚Äù, which will be tracked in the system for each contact. <br><br>  Since the creation of a custom field selects the type "Date", the system will process this field taking into account this type.  First I will explain how the width changes. <br><br><ol><li>  When the user hovers the cursor over a column heading, a resize handle appears on the right.  We are listening to the <code>mousedown</code> event in the resize slider. <br></li><li>  When the user clicks the slider, we bind a few more methods to listen for <code>mousemove</code> and <code>mousedown</code> events (to the <code>window</code> ).  At this stage, we also add some classes for decoration. <br></li><li>  When the user moves the mouse, we calculate the new width of the column, taking into account the position of the cursor, the scrolling position of the table and the set minimum.  Then re-establish the <code>grid-template-columns</code> rule for <code>&lt;table&gt;</code> (via the <code>style</code> attribute), this time replacing the maximum value ( <code>fr</code> ) with the pixel one.  For example, <code>grid-template-columns: minmax(150px, 1.33fr) 296px;</code>  .  This is done using <code>requestAnimationFrame</code> to provide as smooth animation as possible. <br></li><li>  When <code>mouseup</code> arrives, we cancel event listeners and remove classes. </li></ol><br>  Try on <a href="https://codepen.io/adam-lynch/pen/GaqgXP">this simplified example</a> . <br><br>  It's great to update only one item in the DOM, and not every cell. <br><br>  We always develop UI with touch input, but in this case it‚Äôs quite normal not to support it.  This is too precise an action.  Even if I wanted to change the size of the touchscreen column, I would probably expect another interaction, for example, through a multitouch gesture. <br><br><h1>  Fixed-width speakers </h1><br>  You may have noticed that something was silent.  In fact, the width of not one, but all columns changes.  Maybe you didn‚Äôt even notice this, because this is how it should work. <br><br>  Initially, I thought users would like it: when they stretch or squeeze the columns, others also adjust.  If the columns beautifully fill the width of the screen, and you narrow one of them, then the others can expand if there is content there that does not fit in one line.  Try <a href="https://codepen.io/adam-lynch/pen/wbWvep">this example</a> . <br><br>  But after a little user testing, it turned out that for people this is unexpected behavior.  The user feels some loss of control when his actions cause unpredictable side effects. <br><br>  We should not make assumptions on the basis of the columns with which the interaction occurred, and with which not.  When resizing one column, the user could already make an implicit decision that the width of the rest is perfect. <br><br>  Therefore, if you open the application for the first time, the columns are laid out in an optimal way.  If you change the screen size, the columns also change according to the same principle.  As soon as you touch the slider to resize any column, the width of all visible columns is fixed. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/516/c6d/d4f/516c6dd4f7ebed8a02774eedf20081cc.gif"><br>  <i><font color="gray">Before, during and after changing the width of the column.</font></i>  <i><font color="gray">Again, I apologize that the gif is twitching a bit</font></i> <br><br>  Each time a column is resized or fixed, we create an independent localStorage entry that maps the column identifier to the pixel value in order to preserve the user settings. <br><br>  I can not remember exactly why we decided to set a fixed value in pixels, and not an adaptive option.  Maybe for simplicity.  Or because, in the absence of Grid and <code>display:contents</code> support, there is a rollback to a more archaic approach to setting the width of columns. <br><br>  Probably, the adaptive option in any case will not correspond to the intentions of the user.  We cannot assume that the most important thing for him is to make all the columns smaller so that they all remain on the screen.  If a person has changed the width of a column, he wants to see a certain amount of content in this column.  If we have an adaptive block, and then it narrows in a smaller window, then we ignore the choice of the person.  He will have to change the width of the column again to see the same content.  It is unlikely that the user thinks: "Hmm, I want this column to occupy 20% of the window, even if I change it."  However, I‚Äôm too deep into a borderline situation: in fact, users rarely change the size of windows. <br><br><h1>  Moving and deleting columns </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/35a/e5f/5c2/35ae5f5c24401049b45f65802202708c.png"><br>  <i><font color="gray">Interface for customizing displayed columns</font></i> <br><br>  Imagine a user changing a set of columns through this interface.  If none of the selected columns has changed before, they will be displayed using the default <code>grid-template-column</code> values ‚Äã‚Äãdepending on the data type.  For example, <code>minmax(150px, 3.33fr)</code> . <br><br>  If the width of a column is fixed in localStorage, we fix the width of <i>all the</i> selected columns and also store these values ‚Äã‚Äãin localStorage. <br><br>  Over time, more and more columns retain a fixed width.  For users, the only way to return to responsive design is to reset the columns. <br><br>  We also store an array of column identifiers in localStorage, separate from the width entries. <br><br><h1>  ‚ÄúWhy didn't you just use {{libraryName}}?‚Äù </h1><br>  With the JavaScript library, the solution will be cumbersome, jerky, will not provide interactivity, and may not even support the &lt;table&gt; at all.  I also did not want to write something like that.  I thought, "There must be a better way." <br><br><h1>  ‚ÄúWhy didn't you just use the Flexbox?‚Äù </h1><br>  Each row will be evaluated / displayed independently of each other.  The column may not be aligned with the column above due to the different contents of the column. <br><br>  I could switch to &lt;div&gt; 's for columns with vertical grouping of cells inside.  But did not want to do this.  I wanted to use &lt;table&gt;.  In addition, we could easily encounter other problems: for example, the mismatch of the cells in height between the columns. <br><br><h1>  ‚ÄúWhy didn't you just use <code>&lt;colgroup&gt;</code> ?‚Äù </h1><br>  Indeed, <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/colgroup">&lt;colgroup&gt;</a> is a convenient old element.  After defining columns with &lt;col&gt;, styles applied to one will be effectively applied to all the cells in that column. <br><br>  But this turned out to be a too limited solution.  We tried, but very quickly abandoned it.  So fast that I can no longer remember exactly what the problems were.  I am almost sure that it was impossible to achieve the desired level of adaptability and it did not work with Flexbox and Grid. <br><br><h1>  ‚ÄúWhy didn't you just use table-layout: fixed?‚Äù </h1><br>  I could apply a <code>table-layout: fixed</code> rule to <code>&lt;table&gt;</code> and set the width of the columns in percent.  But looking at the examples and playing with this rule, it seemed that it works only on tables with a width of 100%.  In addition, changing the size of one column causes the size of the other columns to change to a total of 100% of the width. <br><br><h1>  ‚ÄúBut you could do with simple tables!‚Äù </h1><br>  Yes, the tables out of the box are capable of many clever things, but they cannot effectively support everything that I wanted to implement.  Do not agree?  Well, wizard, teach me. <br><br><h1>  Do not overdo it with display: contents </h1><br>  The <code>display: contents</code> value allowed to save the table layout.  Use it only when you really need it.  Some browsers have or at least have accessibility problems and screen readers. <br><br>  We found a <a href="https://bugzilla.mozilla.org/show_bug.cgi%3Fid%3D1550728">strange</a> <code>display: contents</code> <a href="https://bugzilla.mozilla.org/show_bug.cgi%3Fid%3D1550728">bug</a> with native drag and drop in Firefox. <br><br>  Fortunately, the subgrid function will be released soon, which will allow child elements to be properly embedded in the grids.  In our application, we only want to simplify the markup, but the subgrid will open the doors to wild multidimensional grid orgies.  See <a href="https://rachelandrew.co.uk/archives/2017/07/20/why-display-contents-is-not-css-grid-layout-subgrid/">‚ÄúWhy display: contents is not a CSS Grid Layout subgrid</a> . <a href="https://rachelandrew.co.uk/archives/2017/07/20/why-display-contents-is-not-css-grid-layout-subgrid/">‚Äù</a> <br><br><h1>  I guess I forgot something </h1><br>  It seems there was still a problem with the overflow of the text when the size of the columns was changed, but I don‚Äôt remember exactly. <br><br>  To save the table headings when scrolling down, we use <code>position: sticky</code> .  This is a great improvement, and it degrades well in older browsers.  However, for IE11 users, we have backup javascript.  In fact, I would not recommend <code>position: sticky</code> due to difficulties with horizontal scrolling. <br><br>  I didn't even mention some of the features of our list views.  For example, users can apply, save and share custom filters (for example, show leads above $ 500 with potential customers in Europe).  In these filters, you can memorize a set of columns to always display specific columns for a particular workflow. <br><br>  Soon we are going to implement bulk editing in the list view, as well as export the custom view to CSV. <br><br>  Anyway, thanks for reading. </div><p>Source: <a href="https://habr.com/ru/post/452922/">https://habr.com/ru/post/452922/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../452908/index.html">Selenium WebDriver - Real-time test metrics using Grafana and InfluxDB</a></li>
<li><a href="../45291/index.html">Prince of Persia - trailer gameplay demonstration and some screenshots.</a></li>
<li><a href="../452914/index.html">ML on Scala with a smile, for those who are not afraid of experiments</a></li>
<li><a href="../452916/index.html">Get up and go. Spinal surgery: when to do, what is dangerous</a></li>
<li><a href="../45292/index.html">PhpMathPublisher - Math Formulas in HTML</a></li>
<li><a href="../452926/index.html">Static testing or save Private Ryan</a></li>
<li><a href="../452930/index.html">About beer through the eyes of a chemist. Part 1</a></li>
<li><a href="../452938/index.html">The guns from the 3D printer are back, and now you can‚Äôt stop them</a></li>
<li><a href="../45294/index.html">Project Palantir</a></li>
<li><a href="../452944/index.html">What will be the ‚ÄúDialogue‚Äù of linguists and data analyst</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>