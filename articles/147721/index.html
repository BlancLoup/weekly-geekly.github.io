<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MHook vs Zuma</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There is not exactly about the zoom, and not quite about mhook. The fact is that I did a little wrap over mhook (to help my work), I would like to sho...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MHook vs Zuma</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/f41/6de/b8e/f416deb8e4a3a6d3ebb3e78920c5a737.png" align="left" height="320" width="320">  There is not exactly about the zoom, and not quite about mhook.  The fact is that I did a little wrap over mhook (to help my work), I would like to show what happened, how I use it, and get some constructive criticism.  And in order not to use synthetic examples, I will go over the thumb and make fun of zuma.  I will tell in the following sequence: first a couple of words (really few) about how the mhook intercepts, then a little about how I used it, then I will describe what I did, and end up implanting a pair of electrodes into my favorite frog.  So you can decide for yourself what is interesting to you, and accordingly, where to start reading. <br><a name="habracut"></a><br>  In the beginning, as I said, a couple of words about <a href="http://codefromthe70s.org/mhook22.aspx">Mhook</a> .  Mhook is a library for embedding your code into the code flow of another application.  On Habr√©, the question of code injection has been repeatedly raised, so if anyone is interested in a detailed consideration of the issue, you can search about it on the site.  In short, to intercept the code, 5 bytes are removed at the address that will be intercepted and the unconditional branching code (jmp #addr) is recorded in the interception function.  And those 5 bytes, which were removed, are transferred to a specially designated place, which is also called a springboard.  When the interception function runs, it can make an unconditional transition to the springboard, the 5 most saved bytes will be executed there and the transition to the intercepted code will occur.  So it will look like a schematic: <br><br><img src="https://habrastorage.org/storage2/be5/ca0/19d/be5ca019d51b1c301a1d30cafa8b20d0.png"><br><br>  It looks great, but sometimes, especially when you need to intercept code execution somewhere, for example, in the middle of a procedure, do something interesting (write the state of some memory cells to the file, change registers, something else like that) you need to insert another intermediate function between the intercepted and the interception handler.  This function is declared as _naked and is needed in order not to spoil the registers.  I used to do it like this (I‚Äôm ashamed to show it, so I‚Äôll use the hidden text): 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Horrible horror</b> <div class="spoiler_text"><blockquote>  <font color="#666666">// intercept data handler function</font> <br>  <font color="#0000ff">void</font> onProc <font color="#008000">(</font> DWORD backTrace, DWORD arg1 <font color="#008000">)</font> <font color="#008000">{</font> <br>  <font color="#0000dd">printf</font> <font color="#008000">(</font> <font color="#FF0000">"% d% d"</font> , backTrace, arg1 <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#666666">// intermediate interception function</font> <br>  __declspec <font color="#008000">(</font> naked <font color="#008000">)</font> <font color="#0000ff">void</font> hookProc <font color="#008000">(</font> <font color="#008000">)</font> <font color="#008000">{</font> <br>  <font color="#666666">// save registers</font> <br>  pushad <br>  <font color="#666666">// collect data that I need</font> <br>  __asm <font color="#008000">{</font> <br>  push <font color="#008000">[</font> esp <font color="#000040">+</font> <font color="#208080">0x20</font> <font color="#008000">]</font> <br>  pop backTrace <br>  push <font color="#008000">[</font> esp <font color="#000040">+</font> <font color="#208080">0x24</font> <font color="#008000">]</font> <br>  pop arg1 <br>  <font color="#008000">}</font> <font color="#008080">;</font> <br>  <font color="#666666">// call handler</font> <br>  onProc <font color="#008000">(</font> backTrace, player <font color="#008000">)</font> <font color="#008080">;</font> <br>  __asm <font color="#008000">{</font> <br>  <font color="#666666">// restore registers and go to the springboard to the intercepted function</font> <br>  popad <br>  jmp realProc <br>  <font color="#008000">}</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#666666">// set capture</font> <br>  Mhook_SetHook <font color="#008000">(</font> <font color="#000040">&amp;</font> <font color="#008000">(</font> PVOID <font color="#000040">&amp;</font> <font color="#008000">)</font> realProc, hookProc <font color="#008000">)</font> <font color="#008080">;</font> </blockquote><br></div></div><br><br>  As you can see, it does not look very.  It‚Äôs also so-so to use, all the time it‚Äôs lazy to make a new interception, because you have to write all these ties.  I decided to throw out this very intermediate function (hookProc).  And in the handler function, transfer the value of registers in the form of a c ++ class.  I called this class Context.  It contains all general purpose registers, and provides access to them.  For complete happiness, I need the following features: <br><br><blockquote>  Context context <font color="#008080">;</font> <br>  <font color="#666666">// can read the value from the register</font> <br>  DWORD var <font color="#000080">=</font> context.  <font color="#007788">EAX</font> <font color="#008080">;</font> <br>  <font color="#666666">// can be written to the register</font> <br>  context.  <font color="#007788">EAX</font> <font color="#000080">=</font> var <br>  <font color="#666666">// you can read the value from the memory.</font> <br>  <font color="#666666">// The index can be a constant</font> <br>  var <font color="#000080">=</font> context <font color="#008000">[</font> <font color="#208080">0xBEDABEDA</font> <font color="#008000">]</font> <br>  <font color="#666666">// So is the register</font> <br>  var <font color="#000080">=</font> context <font color="#008000">[</font> EAX <font color="#008000">]</font> <br>  <font color="#666666">// and it should also be possible to write to memory</font> <br>  context <font color="#008000">[</font> <font color="#208080">0xBEDABEDA</font> <font color="#008000">]</font> <font color="#000080">=</font> var <br>  context <font color="#008000">[</font> EAX <font color="#008000">]</font> <font color="#000080">=</font> var <br>  <font color="#666666">// and so that register arithmetic can be performed</font> <br>  context.  <font color="#007788">EAX</font> <font color="#000080">=</font> context.  <font color="#007788">EAX</font> <font color="#000040">+</font> context.  <font color="#007788">EBX</font> <font color="#000040">*</font> <font color="#0000dd">4</font> <br>  <font color="#666666">// And so that the index can be this arithmetic expression</font> <br>  context <font color="#008000">[</font> context.  <font color="#007788">EAX</font> <font color="#000040">+</font> context.  <font color="#007788">EBX</font> <font color="#000040">*</font> <font color="#0000dd">4</font> <font color="#008000">]</font> <font color="#000080">=</font> var <br>  <font color="#666666">// and not quite obvious, but for some reason I wanted.</font> <br>  <font color="#666666">// so that the offset from the register can be specified in square brackets</font> <br>  var <font color="#000080">=</font> context.  <font color="#007788">ESI</font> <font color="#008000">[</font> <font color="#208080">0x20</font> <font color="#008000">]</font> </blockquote><br><br>  The function from the previous example takes the following form: <br><br><blockquote>  <font color="#0000ff">void</font> onProc <font color="#008000">(</font> Context context <font color="#008000">)</font> <font color="#008000">{</font> <br>  DWORD backTrace <font color="#000080">=</font> context <font color="#008000">[</font> esp <font color="#008000">]</font> <br>  DWORD arg1 <font color="#000080">=</font> context <font color="#008000">[</font> esp <font color="#000040">+</font> <font color="#0000dd">4</font> <font color="#008000">]</font> <br>  <font color="#0000dd">printf</font> <font color="#008000">(</font> <font color="#FF0000">"% d% d"</font> , backTrace, arg1 <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  RegisterHook <font color="#008000">(</font> realProc, hookProc <font color="#008000">)</font> <font color="#008080">;</font> </blockquote><br><br>  To make all this joy possible, we had to create a Register class and overload the type conversion, index and arithmetic operators in it.  I am not a great expert in this, but if someone really wants to, a link to the code at the end of the article). <br><br>  How does all this get into the program?  I have already described above how mhook works.  I added another step: <br><br><blockquote>  <font color="#666666">;</font>  <font color="#666666">save registers</font> <br>  <font color="#00007f">pushad</font> <br>  <font color="#666666">;</font>  <font color="#666666">pass a pointer to them in the handler function</font> <br>  <font color="#00007f">push</font> <font color="#00007f">esp</font> <br>  <font color="#666666">;</font>  <font color="#666666">call handler function</font> <br>  <font color="#00007f">call</font> hook <br>  <font color="#666666">;</font>  <font color="#666666">clear stack</font> <br>  <font color="#00007f">add</font> <font color="#00007f">esp</font> <font color="#339933">,</font> <font color="#0000ff">4</font> <br>  <font color="#666666">;</font>  <font color="#666666">restore registers</font> <br>  <font color="#00007f">popad</font> <br>  <font color="#666666">;</font>  <font color="#666666">go to the springboard for the real function</font> <br>  <font color="#00007f">jmp</font> trampoline </blockquote><br><br>  This code is stored in the string <font color="#A31515">"x60x54xE8x00x00x00x00x83xC4x04x61xE9x00x00x00x00"</font> .  When you need to install a hook, memory is allocated, a string is copied there, the displacement of the handler function is substituted into the call operator, and the springboard offset is substituted into the jmp operator.  pushad, in addition to saving registers, prepares data for the handler function, so to speak.  If the handler function changes this data, the changes are applied by the popad command.  Not sure what is so clear.  I'll try on the pictures to show. <br><br><img src="https://habrastorage.org/storage2/0d6/a90/b02/0d6a90b0277f8ea8a8d3207cf20a1271.png"><br><br>  Once again I will note that after the execution of the esp command, the stack pointer points to all the saved registers, so it is passed to the handler function as a pointer to the execution context. <br><br>  And now - dessert!  Using this all in real terms, on the game about toads and balls.  I will take the task easier.  For example, to make the reward for balls increased 10 times. <br>  To begin with, I try to find where the account is kept.  To make it more interesting, I do not use a debugger and utilities such as Art Money. <br><br>  In Zuma, as in many casual games, the score is a multiple of ten or a hundred.  As far as I know, this is done because for some reason the score with a zero at the end is perceived by players as more ‚Äúpleasant‚Äù and increases the pleasure from the game.  And I am making a strange conclusion, just like in the joke about Vanka-Kosoy.  If the score is a multiple of ten, then somewhere it is divided.  And, in theory, should apply for this integer division, since the score is an integer and will always be divided completely into ten.  You can intercept all these division operations, write down the dividend and the address where this division occurs, and then compare with the score.  This is simplified by the fact that the compiler optimizes integer division by ten, replacing by multiplying by the constant 0x66666667 and then shifting it to the right (if interested, you can read about it in the book "Algorithmic Tricks for Programmers" chapter 10.3).  Like that: <br><br><blockquote>  <font color="#00007f">mov</font> <font color="#00007f">eax</font> <font color="#339933">,</font> <font color="#0000ff">66666667h</font> <font color="#666666">;</font>  <font color="#666666">magic number to divide by 2.5</font> <br>  <font color="#00007f">imul</font> <font color="#00007f">ecx</font> <font color="#666666">; EDX: EAX ‚Üê EAX (in edx, the result of dividing by 2.5)</font> <br>  <font color="#00007f">sar</font> <font color="#00007f">edx</font> <font color="#339933">,</font> <font color="#0000ff">2</font> <font color="#666666">;</font>  <font color="#666666">the result is divided by 4. it turns out edx = ecx / 10</font> </blockquote><br><br>  Another luck is that mov eax, 66666667 takes exactly five bytes and is easily replaced by jmp or call.  I bypass the TEXT section in the loop, look for the opcodes of the operation (0xB8, 0x67, 0x66, 0x66, 0x66) and replace them with the call of the trap.  Since the division into ten is a rather popular operation, showing all operations that have fallen into a trap is absolutely not informative, and it has an extremely negative effect on the speed of the game.  It is necessary to filter so that one of the operands is equal to the current account.  And how to find out the bill, if I'm just looking for it?  It is necessary to work out a series of rules according to which the testing will take place, so that you can predict what the score will be at a certain point in time. <br>  1) The game starts with a score of zero. <br>  2) Every mouse click - shot <br>  3) Every shot is effective <br>  4) Each shot brings thirty points <br>  5) Corollary to the second rule: since you have to do a few mouse clicks before the game, the program of interception should start counting from the moment only after the game has started and you can already collect sequences of balls. <br>  After the rules are formulated, it becomes clear that you need to put a trap on the window procedure of the game.  Then it will be known about all clicks on the mouse button, and it will be possible to signal the beginning of the game by pressing the button on the keyboard. <br>  Finding the address of the window procedure is not difficult, for this you need to look at the arguments of the RegisterClass function in IDA.  Here is what the window procedure trap will look like with all the requirements: <br><br><blockquote>  <font color="#0000ff">void</font> onMainProc <font color="#008000">(</font> Context <font color="#000040">*</font> context <font color="#008000">)</font> <font color="#008000">{</font> <br>  <font color="#666666">// button 0 on the numpad switches the state: does the scoring go or not</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> <font color="#008000">(</font> context <font color="#000040">-</font> <font color="#000080">&gt;</font> ESP <font color="#008000">[</font> <font color="#208080">0x08</font> <font color="#008000">]</font> <font color="#000080">==</font> WM_KEYUP <font color="#008000">)</font> <font color="#000040">&amp;&amp;</font> <font color="#008000">(</font> context <font color="#000040">-</font> <font color="#000080">&gt;</font> ESP <font color="#008000">[</font> <font color="#208080">0x0C</font> <font color="#008000">]</font> <font color="#000080">==</font> VK_NUMPAD0 <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">{</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> state <font color="#000080">==</font> kCounting <font color="#008000">)</font> <font color="#008000">{</font> <br>  state <font color="#000080">=</font> kNotCounting <font color="#008080">;</font> <br>  <font color="#008000">}</font> <font color="#0000ff">else</font> <font color="#008000">{</font> <br>  state <font color="#000080">=</font> kCounting <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> <br>  <font color="#666666">// If the calculation is going on and the left mouse button is pressed, the expected score increases</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> <font color="#008000">(</font> state <font color="#000080">==</font> kCounting <font color="#008000">)</font> <font color="#000040">&amp;&amp;</font> <font color="#008000">(</font> context <font color="#000040">-</font> <font color="#000080">&gt;</font> ESP <font color="#008000">[</font> <font color="#208080">0x08</font> <font color="#008000">]</font> <font color="#000080">==</font> WM_LBUTTONUP <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">{</font> <br>  score <font color="#000040">+</font> <font color="#000080">=</font> <font color="#0000dd">30</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> <br><br>  <font color="#666666">// And so it will look like a trap for division</font> <br>  <font color="#0000ff">void</font> onDivision <font color="#008000">(</font> Context <font color="#000040">*</font> context <font color="#008000">)</font> <font color="#008000">{</font> <br>  <font color="#0000ff">char</font> buf <font color="#008000">[</font> <font color="#0000dd">512</font> <font color="#008000">]</font> <font color="#008080">;</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> state <font color="#000080">==</font> kCounting <font color="#008000">)</font> <font color="#008000">{</font> <br>  <font color="#666666">// If one of the possible divisibles is equal to the intended account, then the address at which the division occurs and the values ‚Äã‚Äãof the registers are sent to the debug output.</font> <br>  <font color="#0000ff">if</font> <font color="#008000">(</font> <font color="#008000">(</font> context <font color="#000040">-</font> <font color="#000080">&gt;</font> EBX <font color="#000080">==</font> score <font color="#008000">)</font> <font color="#000040">||</font> <font color="#008000">(</font> context <font color="#000040">-</font> <font color="#000080">&gt;</font> ECX <font color="#000080">==</font> score <font color="#008000">)</font> <font color="#000040">||</font> <font color="#008000">(</font> context <font color="#000040">-</font> <font color="#000080">&gt;</font> EDX <font color="#000080">==</font> score <font color="#008000">)</font> <font color="#008000">)</font> <font color="#008000">{</font> <br>  <font color="#0000dd">sprintf</font> <font color="#008000">(</font> buf, <font color="#FF0000">"% x: EBX =% d, ECX =% d, EDX =% d"</font> , context <font color="#000040">-</font> <font color="#000080">&gt;</font> ESP <font color="#008000">[</font> <font color="#0000dd">0</font> <font color="#008000">]</font> , context <font color="#000040">-</font> <font color="#000080">&gt;</font> EBX, context <font color="#000040">-</font> <font color="#000080">&gt;</font> ECX, context <font color="#000040">-</font> <font color="#000080">&gt;</font> EDX <font color="#008000">)</font> <font color="#008080">;</font> <br>  OutputDebugStringA <font color="#008000">(</font> buf <font color="#008000">)</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> <br>  <font color="#008000">}</font> <br>  <font color="#666666">// Instead, the code was inserted jmp, so you need to run it</font> <br>  context <font color="#000040">-</font> <font color="#000080">&gt;</font> EAX <font color="#000080">=</font> <font color="#208080">0x66666667</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> </blockquote><br><br>  The video shows how I'm trying to find the address (a rather interesting modification of the rules turned out. "Zuma in the giveaway"). <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/fS3-u_rQG-o%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhhu6tbpTMelySebvV1ZXc14h0mxMA" frameborder="0" allowfullscreen=""></iframe><br><br>  After the address is found, I study the function to which it belongs. <br><br><img src="https://habrastorage.org/storage2/d8c/759/0bf/d8c7590bf1b565ddb61daf0ba7368eb3.jpg"><br><br>  The part where the division takes place performs the calculation of digits in the sum of points that the player scored from the beginning of the level.  In general, the function is apparently responsible for updating the point counter after the sequence of balls has been destroyed.  Two arguments are passed to it.  The first argument is a pointer to some structure (maybe the counter itself).  At offset 0x18C is the current number of points, and at offset 0x190 is the number of points at the beginning of the level.  The second argument is the current number of points.  To find out where it comes from, I go up the stack.  Immediately I discover that the current account is transferred to a function from a certain structure, where it is located at the offset 0x104.  Slightly higher, I detect the operation add [esi + 0x104], edi.  Obviously, this is what I‚Äôm looking for, and if you set a trap here, you can have some influence on the number of points earned by the combination.  The trap code is extremely simple.  The EDI register is increased tenfold, giving us an increased number of points for a successful combination. <br><br><blockquote>  <font color="#0000ff">void</font> onAddScore <font color="#008000">(</font> Context <font color="#000040">*</font> context <font color="#008000">)</font> <font color="#008000">{</font> <br>  context <font color="#000040">-</font> <font color="#000080">&gt;</font> EDI <font color="#000080">=</font> context <font color="#000040">-</font> <font color="#000080">&gt;</font> EDI <font color="#000040">*</font> <font color="#0000dd">10</font> <font color="#008080">;</font> <br>  <font color="#008000">}</font> </blockquote><br><br>  Look like that's it.  It remains to apologize for the large interval between posts and horse illustrations (if someone tells you how best to place them, thank you very much). <br><br>  Oh, and the <a href="https://github.com/karan-dash/ZumaHook">code</a> , of course.  But this is a big fan, for review and for the consequences I am not responsible. </div><p>Source: <a href="https://habr.com/ru/post/147721/">https://habr.com/ru/post/147721/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../147710/index.html">Lesson 2. Create your application on Ext.NET, part 1</a></li>
<li><a href="../147711/index.html">Hard drive for a million years</a></li>
<li><a href="../147713/index.html">FBL for your domains</a></li>
<li><a href="../147716/index.html">Jelly Bean ported to ARMv6</a></li>
<li><a href="../147720/index.html">IT R & D Cream (Release 16) - 3 in 1</a></li>
<li><a href="../147722/index.html">What I learned in programming</a></li>
<li><a href="../147725/index.html">Is a higher education for a web programmer important for you when applying for a job?</a></li>
<li><a href="../147726/index.html">Sergey Belousov knows how to get investment</a></li>
<li><a href="../147727/index.html">Life experiment open source</a></li>
<li><a href="../147728/index.html">Syte - an engine for personal websites with the ability to integrate social services</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>