<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Our controller for smart home</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="UPD : we took the video of Wiren Board Smart Home 

 Summary: 
 On the basis of our Wiren Board platform (a compact industrial computer with Linux and...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Our controller for smart home</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/34d/387/92f/34d38792fb914db8340db096f08b278f.png"><br><br>  <b>UPD</b> : <a href="http://habrahabr.ru/company/contactless/blog/214381/">we took the video of Wiren Board Smart Home</a> <br><br><h4>  Summary: </h4><br>  On the basis of our <a href="http://habrahabr.ru/company/contactless/blog/197522/">Wiren Board</a> platform (a compact industrial computer with <b>Linux</b> and various interfaces), we made a fancy controller for <b>Wiren Board Smart Home</b> automation (ARM9 64MB RAM, GSM / GPRS, Ethernet, Wi-Fi, USB, 2xRS-485 / Modbus, CAN, 2 relays, ASK / FSK radio module 433MHz, NRF24L01 +, etc.), to which you can connect a bunch of wired and wireless actuators and sensors from different systems and manufacturers.  The device is ready and tested.  For devices from the first large batch, we open <a href="http://contactless.ru/store/">an order</a> with delivery up to the May holidays at a special price. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Motivation </h4><br>  Even after our very first article, many enthusiasts wrote to us that they would like to use our single board computer as the basis of a smart home. <br><br>  We worked through this issue and realized that on the basis of our Wiren Board platform, you can make a good home automation controller that allows you to control actuators and sensors in the medium, low-cost and ultra-cheap price category (see below). <br><br>  In addition to the functionality that is in the usual Wiren Board, namely: <br><ul><li>  ARM9 454Mhz, 64MB RAM, 4GB + ROM running GNU / Linux 3.13 </li><li>  GSM / GPRS - modem </li><li>  Wi-Fi (including in the access point mode) </li><li>  Ethernet (with passive PoE 12-15V) </li><li>  2xUSB-host </li><li>  RS-485 / Modbus </li><li>  ADC inputs </li><li>  battery operation </li></ul><br>  were added: <br><ul><li>  CAN bus </li><li>  Second RS-485 </li><li>  Two relays 220V 5A </li><li>  RTC - real time clock </li><li>  Sound transmitter </li><li>  Audio output - 3.5 mm jack </li><li>  RS-232 full duplex, non-opto-isolated (optional) </li><li>  radio module NRF24 </li><li>  and 433 MHz packet radio. </li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c63/229/148/c632291483a5b39edcef1fb9fd2e887d.png"><br><br>  Inside are expansion connectors: two UEXT and USB-host. <br>  As unnecessary, the NFC and GPS modules were removed. <br><br>  This time we picked up a good standard case and designed a board for it.  The choice fell on the case on the DIN rail D6MG from Gainta.  It is not very compact (106x90x57.5 mm), but the DIN rail mounting allows you to safely place the controller in a standard cabinet with other equipment.  In this case, the board is easily and securely fixed by the case parts without attachments to the racks.  All connectors are derived from two sides of the case. <br><img src="https://habrastorage.org/getpro/habr/post_images/956/0c3/445/9560c34456b297fbd10811bfd9090925.png"><br><br>  In addition, we have provided the possibility of using a Plexiglas case on the racks.  Such a body is quite compact, looks good and fits well, if you expect a more ‚Äúdesktop‚Äù application. <br><div class="spoiler">  <b class="spoiler_title">It looks like this:</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/42c/74e/2c3/42c74e2c36c418e9aac3fb4ea7a00307.png"><br>  We have not yet received the cut sheets for the new case, but the similar case we ordered for the standard Wiren Board gives a rough idea of ‚Äã‚Äãhow this case will look. <br></div></div><br><br>  When designing, we focused on solutions such as <a href="http://evika.ru/katalog/lm3-reactor/">Evik</a> (yes, this is a very budget solution :)), <a href="http://ninjablocks.com/products/ninja-blocks-kit">Ninja Blocks</a> and others. <br><br>  So, <br><br><h4>  What can be connected to the controller directly? </h4><br><br><ul><li>  low voltage load: LED strips, locks, etc.  to <b>4 open collector type outputs</b> </li><li>  <b>4 ADC inputs</b> allow you to measure voltages up to 30 volts </li><li>  R1-R4 inputs (0.5 kŒ© input resistance) allow <br><ul><li>  measure low voltage </li><li>  connect resistive sensors (measure resistance), for example, temperature, humidity, gas, etc. sensors </li><li>  work as a GPIO (tolerant to external signals with levels up to 12V) </li><li>  connect card readers and Wiegand keyboards </li></ul></li><li>  I / O W1-W3 is a GPIO with built-in 3.3V pull-up resistors.  They can be used as GPIO and as <b>1-wire</b> bus controllers (including the possibility of strong braces). <br><ul><li>  connection of 1-wire temperature sensors, for example DS18B20 </li><li>  connection of counters with pulse outputs. </li><li>  connecting buttons </li></ul></li><li>  actuators and sensors operating on <b>RS-485</b> (Modbus) and <b>CAN</b> buses, for example: <br><ul><li>  devices of the system <a href="http://www.razumdom.ru/oborudovanie_rs485/">"smart house"</a> on the bus Modbus or A-BUS </li><li>  <s>lighting control (by <a href="https://ru.wikipedia.org/wiki/DMX-512">DMX-512</a> )</s> </li><li>  electricity meters </li></ul></li><li>  <b>2 relays</b> allow you to directly control the power load ( <b>250V / 5A</b> ). </li></ul><br><br><h4>  433Mhz radio module </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/fdb/f19/011/fdbf19011cc67e32153630c394dbe95f.png"><br>  The killer feature of our controller is a <b>transceiver for 433 Mhz</b> .  We use the advanced HopeRF <a href="http://www.k-industry.pro/content/rfm69hw-news">RFM69H</a> packet radio module with very good output power (+ 13 / + 20 dBm) and sensitivity (up to -120 dBm).  The radio chip has a lot of settings, supports various modulation modes, can encrypt traffic by hardware, allows you to programmatically change the carrier frequency, bandwidth, bit rate, etc.  Working with the chip occurs in batch mode - the code in user space just reads / writes bytes with data from the device. <br><br>  What is all this magnificence for?  Using this radio module, you can receive and send signals to the zoo for low-cost devices with proprietary radio protocols.  Examples: <br><ul><li>  Chinese actuators, sensors and remotes from wireless kits.  They exist a huge amount, freely sold at ridiculous prices, including in Russia.  A non-exhaustive list can be found <a href="http://forums.ninjablocks.com/index.php%3Fp%3D/discussion/120/dirt-cheap-sensorsactuators-/p1">here</a> , <a href="http://help.ninjablocks.com/customer/portal/articles/692139-what-rf-devices-can-my-ninja-block-talk-to-">here</a> , <a href="http://code.google.com/p/rc-switch/wiki/List_KnownDevices">here</a> , besides, they have <a href="http://habrahabr.ru/post/210830/">been repeatedly</a> <a href="http://habrahabr.ru/post/211234/">told</a> in <a href="http://habrahabr.ru/post/210664/">Habr√©</a> lately. </li><li> The executive devices and consoles of the <a href="http://www.noo.com.by/sistema-noolite.html">Noolite</a> system ( <a href="http://habrahabr.ru/company/boxowerview/blog/168039/">one</a> , <a href="http://habrahabr.ru/company/boxowerview/blog/165131/">two</a> ) are very convenient low-cost pieces of iron for controlling the light. </li><li>  Pieces from <a href="http://www.neroelectronics.ru/">www.neroelectronics.ru</a> </li><li>  Wireless sensors for weather stations Oregon Scientific: <a href="http://habrahabr.ru/post/165747/">habrahabr.ru/post/165747</a> </li><li>  Gateways from Wireless-X10 to X10 over a 220V network, such as <a href="http://www.razumdom.ru/komandnye_i_interfejsnye_moduli_h10/row390">these</a> </li><li>  etc. </li></ul><br><br>  The radio module, of course, can be used for its intended purpose - to organize a communication channel and build its wireless networks. <br><br>  In the following articles we will write in more detail about working with the radio module and show how to disassemble various proprietary protocols and connect interesting devices to our controller. <br><br><h4>  Radio module NRF24L01 + </h4><br>  <a href="http://www.nordicsemi.com/kor/node_176/2.4GHz-RF/nRF24L01P">The NRF24L01 +</a> is a very <a href="https://github.com/search%3Fq%3Dnrf24%26ref%3Dcmdform">popular</a> in the DIY community and a very <a href="http://www.ebay.com/sch/i.html%3F_sacat%3D0%26_from%3DR40%26_sop%3D15%26_nkw%3Dnrf24l01%252B%26rt%3Dnc%26LH_BIN%3D1">cheap</a> radio chip for organizing wireless communications at 2.4GHz using the proprietary protocol from Nordic.  The NRF24 module is available in our controller for home automation as an option, and can be useful if you are going to connect any home-made modules on arduinka / analogs. <br><br><h4>  And still </h4><br><ul><li>  <b>GSM</b> and <b>GPRS</b> .  Like the standard Wiren Board platform, the new controller for home automation has a GSM / GPRS modem.  It is inexpensive, but it allows you to organize a backup and emergency communication channel.  Applications can come up with a variety of, for example, sending an alarm SMS when power is lost in the network, or vice versa, remote control from a mobile phone when the Internet is not available. </li><li>  <b>Wi-Fi</b> 802.11n 1T1R, can work in client mode and access point. </li><li>  <b>Battery</b>  The standard lithium-ion battery at 1800mAh lasts about 4 hours of work. </li><li>  3 <b>USB Host</b> ports.  Two are located outside, one inside. </li><li>  Stereo 3.5mm audio output </li></ul><br><br><h4>  And more (extensions) </h4><br>  Although we tried, it is clear that we could not support all the diversity of wired and wireless interfaces for connecting devices for a smart home.  However, we took care to add support for some systems was quite simple. <br><br>  On the board, inside the case, we brought out one USB port.  In it, you can connect and hide inside the case of USB-sticks, for example, for: <br><ul><li>  Works with Z-Wave.  For example, <a href="http://rus.z-wave.me/shop/controllers/z-way-for-windows/)">such</a> or <a href="http://www.amazon.com/gp/product/B003MWQ30E%3Fref_%3Das_li_qf_sp_asin_il_tl%26redirect%3Dtrue%26tag%3Dtl3po-20%26linkCode%3Das2%26camp%3D1789%26creative%3D9325%26creativeASIN%3DB003MWQ30E%26pldnSite%3D1">such</a> , etc. </li><li>  Zigbee  For example, <a href="https://estore.ti.com/CC2531EMK-CC2531-Evaluation-Module-Kit-P1753.aspx">this</a> or <a href="http://item.taobao.com/item.htm%3Fspm%3Da230r.1.14.135.tfjH7i%26id%3D36276324808">that</a> (carefully, you need a programmer that is on sale nearby) </li><li>  <a href="http://www.enocean.com/de/enocean_module/usb-300-oem">EnOcean</a> </li><li>  Or for example, a <a href="http://habrahabr.ru/company/coolrf/blog/210750/">USB whistle for COOLRF dimmers</a> </li><li>  Bluetooth </li></ul><br><br>  There are also two <a href="https://en.wikipedia.org/wiki/UEXT">UEXT</a> connectors on the <a href="https://en.wikipedia.org/wiki/UEXT">board</a> , to which you can connect different modules from <a href="https://www.olimex.com/Products/Modules/">Olimex</a> . <br><br>  The design of the selected housing allows you to place additional fees above the main one.  In the future, we plan to release several such expansion cards. <br><br><h4>  Soft </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/12e/34d/0fe/12e34d0fe85905b89cef45404cf20313.png"><br><br>  The controller's hardware is supported by the mainline Linux kernel with our patch set (3.13).  We use Debian GNU / Linux 7 Wheezy as the OS. <br>  As a management software, we suggest using open projects, for example, <a href="http://www.agocontrol.com/">AgoControl</a> or <a href="http://ninjablocks.com/pages/open-source">NinjaBlocks</a> .  Both projects are lively and have a large user base.  AgoControl is a classic offline system, the web server runs on the device. <br>  In contrast, Ninja Blocks is an interesting cloud platform.  Under her control, the controller loads data and receives commands from the cloud.  Dashboard with viewing indications and management, scripting are available through the <a href="https://a.ninja.is/">a.ninja.is</a> web service. <br><br>  All software for working with hardware, for example, for working with a radio module, is made independent of specific systems so that other software can be easily used. <br>  We implement full controller support for the two systems mentioned, AgoControl and NinjaBlocks. <br><br><h4>  And pre-order </h4><br>  The development of the controller is completed, the first samples are collected and tested.  To produce a large batch, we just need to purchase the components in the required quantity and send the order to the factory. <br><br>  <b>We announce the start of sales on pre-orders</b> .  We are talking about real pre-orders, i.e.  purchase for real money (cards, interbank) in <a href="http://contactless.ru/store/">our online store</a> with deferred delivery. <br>  Collection of pre-orders will go until March 15. <br>  Production and installation of boards will be in Russia.  The process is already debugged by us, so we will meet in a fairly short time.  We plan to ship controllers before the May holidays. <br>  We will inform about the production process on our <a href="http://contactless.ru/blog/">website</a> . <br><br>  Why is there such a complicated procedure?  The cost of the device is highly dependent on the batch size.  If ordered in small batches, then selling at an affordable price, unfortunately, will not work.  Virtual pre-orders, without payment, as our experience has shown, give highly overestimated figures in comparison with real sales.  We decided not to get involved in Russian crowdfunding sites, because they charge a large commission, without attracting customers themselves. <br><br><h4>  Prices </h4><br><br>  The design of our controller is modular, so the price depends on the specific configuration that you can choose in the <a href="http://contactless.ru/store/">store</a> . <br><br>  <s>Prices start at <b>3900r</b> in the minimum configuration.</s>  <s>For example, the standard configuration: <abbr title="LAN, USB, 2 RS-485 ports, Wi-Fi, GSM / GPRS modem and 433MHz radio module">everything except CAN and NRF24,</abbr> on pre-order will cost <b>5,000</b> rubles, and the same, but without GSM, - for another <b>500</b> rubles.</s>  <s>cheaper.</s> <br>  <b>UPD (2014-03-10):</b> It turned out that incomplete configurations are practically not in demand.  They left only the full configuration (LAN, USB, 2 RS-485 ports, Wi-Fi, GSM / GPRS modem and radio module at 433MHz, radio NRF24L01 +, CAN port) for <b>5300</b> rubles. <br><br><h4>  Conclusion </h4><br>  We are waiting for your comments and suggestions (for example, about expansion modules) here in the comments, or on our <a href="http://contactless.ru/forums/forum/wiren-board-main/">forum</a> .  We will be happy to answer any questions! <br><br>  - <br>  Best wishes, <br>  wiren board <a href="http://habrahabr.ru/company/contactless/profile/">command</a> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/19d/934/325/19d934325e049a1044d8c33b60b2b7a3.png"></div><p>Source: <a href="https://habr.com/ru/post/213243/">https://habr.com/ru/post/213243/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../213233/index.html">UnionTest / KORAD UT3005EP Laboratory Programmable Linear Power Supply & Calibration / Control</a></li>
<li><a href="../213235/index.html">How we did a car tracker</a></li>
<li><a href="../213237/index.html">As we brought the smart outlet to the level of a mass product</a></li>
<li><a href="../213239/index.html">Google Fiber expands to 9 more US cities</a></li>
<li><a href="../213241/index.html">Camp game "Torrents"</a></li>
<li><a href="../213245/index.html">Facebook buys WhatsApp for $ 16 billion</a></li>
<li><a href="../213247/index.html">FDB switch tables. Adventures in the zoo. Part 1 - SNMP</a></li>
<li><a href="../213251/index.html">First blog post: moving from idea to project layout</a></li>
<li><a href="../213253/index.html">Making the game right before your eyes - part 4: Shader for fade in on the palette (a la NES)</a></li>
<li><a href="../213257/index.html">Therascale OCP Solution</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>