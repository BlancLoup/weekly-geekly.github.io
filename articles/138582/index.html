<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating Gems - Guide</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Although on Habr√© already articles about creating gems have already skipped, they either contain outdated or incomplete information. 

 How do you rea...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating Gems - Guide</h1><div class="post__text post__text-html js-mediator-article">  Although on Habr√© already articles about creating gems have already skipped, they either contain outdated or incomplete information. <br><br>  How do you really need to create, develop and publish your gems? <br><br>  A modern approach is to use the <a href="http://gembundler.com/">Bundler</a> with other tools, such as Git, <a href="http://yardoc.org/">YARD</a> and <a href="https://www.relishapp.com/rspec">RSpec-2</a> . <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Creating a basic structure </h4><br>  So, to create a new gem, just run the command <br><pre><code class="bash hljs">bundle gem YOUR-GEM-NAME</code> </pre> <br>  Naturally, you must have already installed the bundler <code>gem install bundler</code> ( <code>gem install bundler</code> ) before executing this command. <br><br>  After this, you will receive the basic structure of your new gem in the <i>YOUR-GEM-NAME</i> catalog with ready-made commands for geme construction, its installation and publication in rubygems: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> YOUR-GEM-NAME rake -T rake build <span class="hljs-comment"><span class="hljs-comment"># Build YOUR-GEM-NAME-0.0.1.gem into the pkg directory rake install # Build and install YOUR-GEM-NAME-0.0.1.gem into system gems rake release # Create tag v0.0.1 and build and push YOUR-GEM-NAME-0.0.1.gem to Ru...</span></span></code> </pre><br><br>  It is important to note that the source library code should not litter the global namespace.  Please place all your classes inside a class or module with the name suggested by Bundler in the lib / <i>YOUR-GEM-NAME</i> subdirectory, including them from the file lib / <i>YOUR-GEM-NAME</i> .rb.  Avoid using autoload, as this feature has been deprecated for Ruby 2.0. <br><br>  Whenever possible, all documentation files should use Markdown markup (preferably having a README.md file). <br><br><h4>  Documenting code </h4><br>  A modern tool for documenting code is the YARD in markdown mode using the redcarpet module to support code highlighting using GitHub syntax.  In this case, you automatically receive the publication of documentation on rubydoc.info ( <a href="http://rubydoc.info/github/bitboxer/git-commit-notifier/master/frames">example</a> ). <br><br>  Connecting it is quite simple: <br><ul><li>  Add development time dependency to gemspec: <br><pre> <code class="ruby hljs"> s.add_development_dependency <span class="hljs-string"><span class="hljs-string">"redcarpet"</span></span>, <span class="hljs-string"><span class="hljs-string">"~&gt; 1.17"</span></span> s.add_development_dependency <span class="hljs-string"><span class="hljs-string">"yard"</span></span>, <span class="hljs-string"><span class="hljs-string">"~&gt; 0.7.5"</span></span></code> </pre><br>  If you use ruby ‚Äã‚Äãversion 1.8, then it is also advisable to use the gem ripper, which will add useful functionality for YARD.  Connect it better through a gemfile: <br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">"ripper"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:platforms</span></span> =&gt; <span class="hljs-symbol"><span class="hljs-symbol">:ruby_18</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:group</span></span> =&gt; <span class="hljs-symbol"><span class="hljs-symbol">:development</span></span></code> </pre><br></li><li>  We perform the installation of gems <br><pre> <code class="bash hljs">bundle install</code> </pre><br></li><li>  Customize YARD by creating a .yardopts file with these contents: <br><pre> --markup markdown
 --markup-provider redcarpet
 --charset utf-8
 - readme README.md
 -
 README.md
 LICENSE
</pre><br>  Here, after a single-line hyphen, we indicate a list of files that must be additionally included in the documentation (usually a readme and license). <br></li><li>  And add the rake yard task to generate the documentation in the Rakefile: <br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'yard'</span></span> YARD::Rake::YardocTask.new</code> </pre><br></li></ul><br>  Now, using the rake yard command, we will receive the complete library documentation in the doc directory. <br><br>  By the way, do not forget to add doc /, .yardoc / and Gemfile.lock to .gitignore. <br><br><h4>  We start writing specs </h4><br>  Personally, I prefer to use for specs RSpec 2 together with <a href="https://github.com/btakita/rr">RR</a> .  Add the appropriate dependencies to gemspec: <br><pre> <code class="ruby hljs"> s.add_development_dependency <span class="hljs-string"><span class="hljs-string">"rspec-core"</span></span>, <span class="hljs-string"><span class="hljs-string">"~&gt; 2.0"</span></span> s.add_development_dependency <span class="hljs-string"><span class="hljs-string">"rspec-expectations"</span></span>, <span class="hljs-string"><span class="hljs-string">"~&gt; 2.0"</span></span> s.add_development_dependency <span class="hljs-string"><span class="hljs-string">"rr"</span></span>, <span class="hljs-string"><span class="hljs-string">"~&gt; 1.0"</span></span></code> </pre><br><br>  Install gems and create basic RSpec 2 files <br><pre> <code class="bash hljs">bundle install bundle <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> rspec --init</code> </pre><br><br>  Add the rake spec task to the rakefile: <br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'rspec/core/rake_task'</span></span> RSpec::Core::RakeTask.new</code> </pre><br>  And please use the default RR in spec / spec_helper.rb: <br><pre> <code class="ruby hljs"> config.mock_with <span class="hljs-symbol"><span class="hljs-symbol">:rr</span></span></code> </pre><br>  Everything, now you can write specs and code. <br><br><h4>  Little about executables </h4><br>  The files that you put into the bin directory of your gem are installed as executable files of the target operating system during gem installation. <br><br>  There is a small nuance here: in different operating systems, this installation occurs in different ways, and sometimes your executable files are not run from the bin subdirectory of your heme, which you could accidentally tune into. <br><br>  In this regard, the best practice when creating an executable file is to transfer all the logic to the library so that the binary file of your-gem-exec would look like this somewhere: <br><br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'rubygems'</span></span> <span class="hljs-comment"><span class="hljs-comment">#    ruby 1.9   require 'your-gem' require 'your-gem/exec'</span></span></code> </pre><br>  In addition, this approach means that most of the logic can be covered with specs. <br><br><h4>  Version control </h4><br>  The general rule is to use Git as a repository and <a href="http://semver.org/">semantic versioning</a> when generating gem version numbers.  rake release will automatically create the necessary tags in the repository and publish the gems in rubygems. <br><br><h4>  Removing erroneous versions of gems </h4><br>  Sometimes there is a task to delete any version of the heme with rubygems due to problems of a specific version (errors in the code or incorrect versioning).  This task is performed using the command <br><br><pre> <code class="bash hljs">gem yank gemname -v version</code> </pre><br>  This command does not come with rubygems by default, so you need to install a jeweler gem to use it. <br><br><pre> <code class="bash hljs">gem install jeweler</code> </pre></div><p>Source: <a href="https://habr.com/ru/post/138582/">https://habr.com/ru/post/138582/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../138574/index.html">.NET-chiki, we meet on February 25 at the Siclum .NET Subbotnik in Dnepropetrovsk!</a></li>
<li><a href="../138575/index.html">Online Notepad note-pad.net</a></li>
<li><a href="../138576/index.html">Release stable version of Apache 2.4</a></li>
<li><a href="../138577/index.html">Why we created Julia, the new YAP for technical computing</a></li>
<li><a href="../138580/index.html">In-line editing tabular data in ASP.Net MVC 3</a></li>
<li><a href="../138585/index.html">Once again about Bridge (in pictures)</a></li>
<li><a href="../138586/index.html">Here be dragons</a></li>
<li><a href="../138587/index.html">I like vs like</a></li>
<li><a href="../138590/index.html">How to rollback commits on github.com</a></li>
<li><a href="../138591/index.html">What does "> / dev / null 2> & 1" mean?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>