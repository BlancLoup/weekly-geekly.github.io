<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Data Warehouse Metrics</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings. 

 Creating, or even maintaining, an existing data warehouse, inevitably there is such a stage when a plurality of user desires meets with ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Data Warehouse Metrics</h1><div class="post__text post__text-html js-mediator-article">  Greetings. <br><br>  Creating, or even maintaining, an existing data warehouse, inevitably there is such a stage when a plurality of user desires meets with the inevitability of the physical limitations of the <i>DBMS</i> that is used for the storage.  In fact, no one can have infinite disk space, processor power, or an arbitrarily long time to update data. <br><br>  At this point, the management may have questions, if they did not arise earlier, what exactly takes up so much space in the database, why the download has not yet ended, and so on. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To know what to answer, it is necessary to conduct accounting.  The creation of HD is a long process, the people who designed the architecture may already be far away, I'm not even talking about the fact that business requirements change, sometimes, as quickly as new versions of the <i>Firefox</i> browser come out. <br><a name="habracut"></a><br><br>  When with a question about how much more data we can store and process in the current HD, my customer contacted me, I could only say what I could answer about, but I would have to calculate everything first, i.e.  collect data storage metrics. <br><br>  I tried to prepare some set of basic metrics that it is desirable to calculate in the first place, and, based on which, we can obtain derived metrics, which, in turn, could be used for forecasting. <br><br>  After this set was received, I decided to google this topic, and found <a href="http://www.b-eye-network.com/view/480">an article by Bill Inmon with a list of metrics</a> that it would be nice to have considered in most HDs. <br><br><h5>  Start of translation </h5><br>  Everything has metrics.  There is a speed limit on the road, people have weight, days are temperature, there is a tachometer in the cars. <br><br>  Metrics help us organize our reasoning and make meaningful comparisons.  Even without referring to metrics as such, we can compare events and the conditions for their manifestation.  And data warehouses are no exception in this case.  We must have measurable characteristics if we are going to compare the data stores of different companies.  It is a part of human nature, to have some criteria by which you could tell about yourself or your work and compare them with the merits of others. <br><br>  Given the above, the list of metrics for the data warehouse system could be as follows: <br><br>  <b>The size</b> <br><ul><li>  In tables HD. </li><li>  In indexes HD. </li><li>  The volume of the transform area (the volume of the temporary tables and / or the spool). </li></ul><br>  <b>ETL</b> <br><ul><li>  The number of ETL programs. </li><li>  Startup frequency </li><li>  The amount of data processed by ETL. </li><li>  The place of execution of ETL programs. </li></ul><br>  <b>Datamars</b> <br><ul><li>  The number of dates in HD. </li><li>  The amount of data in the data marts. </li><li>  The frequency of replenishment data. </li></ul><br>  <b>Detailed HD data</b> <br><ul><li>  Data access speed (bytes per second). </li><li>  The size of the physical record. </li></ul><br>  <b>HD structures</b> <br><ul><li>  The number of tables. </li><li>  The number of rows in each table. </li><li>  The average row size for each table. </li></ul><br>  <b>Export data from HD</b> <br><ul><li>  The number of rows per table leaving HD. </li><li>  The frequency of export to the table. </li><li>  Export criteria. </li></ul><br>  <b>Requests to HD</b> <br><ul><li>  The number of requests processed per day. </li><li>  The average amount of data for each request. </li></ul><br>  <b>Story</b> <br><ul><li>  The period of time during which the HD stores the history. </li></ul><br>  <b>Other</b> <br><ul><li>  Use date mining. </li><li>  Adaptive datmarts. </li><li>  Decision Support Applications (DSS). </li><li>  ERP application. </li><li>  Ods. </li><li>  Using tape or other type of long-term storage of information </li><li>  Archive repository. </li></ul><br><br>  Here such metrics could be in order to measure your HD. <br><br>  Of course, this list can be expanded and changed in many different ways.  One of the possible improvements is the addition of time to these metrics, since it is better to keep track of the values ‚Äã‚Äãover a period of time.  So, you can count, for example, besides the size metric, also the indicator how much the size has changed. <br><br>  Or you can divide some tables by company department.  It often makes sense to group data together, even if such grouping is not provided in the physical database tables.  Of course, you can also show which DBMS are used for which tables, for example: <br><ul><li>  Table ABC - Teradata </li><li>  DEF Table - IBM UDB </li><li>  Etc. </li></ul><br>  So, who can use HD metrics? <br><ul><li>  Admin DB. </li><li>  Architects DB. </li><li>  DB developers. </li><li>  HD users. </li><li>  Attracted administrators. </li><li>  System programmers </li><li>  And many others ... </li></ul><br><h5>  End of translation </h5><br><br>  I chose 4 groups of metrics, considering that such a set would be good for determining the need for collecting metrics specifically in our multi- <b>owner</b> Data Warehouse ( <b>Multitenant DWH</b> ) <b>project</b> .  These groups are: <br><ol><li>  Metric by the number of rows in the tables HD. </li><li>  Metric by space (number of bytes) for each scheme.  The data in the repository is located in several Oracle DBMS schemas. </li><li>  Metrics for the data load process (ETL). </li><li>  Metrics on the largest fact table in HD. </li></ol><br><br>  Metrics from each group were collected on a specific date and for each individual owner using <i>PL / SQL</i> procedures that were run after each loading process. <br><br>  Let's take a closer look at each group. <br><br><h5>  Row number metrics </h5><br>  In this group of metrics, information is collected about how many rows for each owner were in the HD schemes for each time point when these metrics were calculated. <br><br>  Using these indicators, it is also possible to determine the ratio between different layers of CD, how many tables are detailed data, datamarts, range area.  When the new table appeared, or how many, on average, reference books for one fact table. <br><br>  It also becomes possible to quantify for different owners on the contents of each specific table. <br><br>  The calculation was made using a standard approach - generating and running <i>SQL</i> code in a cycle of selecting all tables from a given list of schemas. <br><br><h5>  Volume metrics </h5><br>  For the metrics of the volume occupied by the CD tables, I decided to calculate only the space occupied by the data in the diagrams reported by the DBMS: <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> owner, <span class="hljs-keyword"><span class="hljs-keyword">to_date</span></span>(v_cur_date, <span class="hljs-string"><span class="hljs-string">'RRRR-MM-DD'</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">bytes</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> dba_segments <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> owner <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'   '</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> owner</code> </pre> <br><br>  In addition to this metric, I also want to add the calculation of the space occupied by the data on the disk.  By comparing both indicators, you can get, for example, the ratio of the efficiency of <i>ETL</i> in terms of disk space utilization. <br><br><h5>  ETL metrics </h5><br>  <i>ETL</i> tool that is used to download - <b>Oracle Warehouse Builder</b> .  The script shown below collects execution statistics for a given loading process, aggregating the number of processed lines from subordinate mappings. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> ae.top_level_execution_audit_id, ae.execution_name, ae.created_on, ae.elapse_time, dt.Selected, dt.Inserted, dt.Updated, dt.Deleted <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> owbsys.All_Rt_Audit_Executions ae, ( <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(au.number_records_selected, <span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Selected, <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(au.number_records_inserted, <span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Inserted, <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(au.number_records_updated, <span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Updated</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">coalesce</span></span>(au.number_records_deleted, <span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Deleted <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> OWBSYS.ALL_RT_AUDIT_MAP_RUNS au <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> au.execution_audit_id <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> execution_audit_id <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> owbsys.All_Rt_Audit_Executions ae <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> ae.top_level_execution_audit_id = &lt;  &gt;) ) dt <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> ae.top_level_execution_audit_id = &lt;  &gt;</code> </pre><br><br>  If you wish to monitor the performance of each individual mapping, you can expand the set of data collected. <br><br><h5>  Metrics of the largest table </h5><br>  The largest fact table consists of transactions performed once a month for each active employee of the owner.  The following script: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> p_Customer_Num, t.month_start_date, <span class="hljs-keyword"><span class="hljs-keyword">count</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">distinct</span></span> f.Person_Id) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> uniq, <span class="hljs-keyword"><span class="hljs-keyword">count</span></span>(f.Person_Id) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> t_cnt <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> dm.time_dimension t <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">outer</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> dm.trans_fact f <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> f.time_id = t.id <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> f.customer = p_Customer_Num <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> month_start_date <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> p_Start_Date <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> p_End_Date <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> month_start_date;</code> </pre><br>  allows you to collect data on the number of rows for each data owner for each month plus the number of unique employees for each month. <br><br>  This metric is a point around which you can connect the remaining metrics in our <b>BI</b> tool and get, as a result, the following derived indicators: <br><br><ul><li>  The average cost of space (in GB) add a new owner for every 1000 employees. </li><li>  The average cost of time (in hours) to add a new owner for every 1000 employees. </li><li>  The average cost for a DBMS for processing rows (in millions of rows) of adding a new owner for every 1000 employees. </li></ul><br><br>  You can also create a bunch of beautiful graphs that show the average daily loading time, the dependence of this time on the number of owners processed, etc.  Compare these metrics with each other after changes in ETL, improvements or deterioration in DBMS, etc., which will help to more objectively evaluate the results of improvements in HD building processes and answer the questions with which I started this article. <br><br><img src="https://habrastorage.org/storage2/c51/916/253/c5191625353c60be04906591b04505d0.png"></div><p>Source: <a href="https://habr.com/ru/post/144568/">https://habr.com/ru/post/144568/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../144561/index.html">Unbound jailbreak for iOS 5.1.1 Absinthe 2.0.4 released</a></li>
<li><a href="../144563/index.html">Creating regular expressions from mobile phone number ranges</a></li>
<li><a href="../144565/index.html">Stream encryption at 10 Gbit / s? Yes. Parallel</a></li>
<li><a href="../144566/index.html">Logging - a library for easy logging in Python</a></li>
<li><a href="../144567/index.html">About deleting quoted lines from JavaScript text</a></li>
<li><a href="../144569/index.html">Dragon SpaceX successfully reached the ISS</a></li>
<li><a href="../144571/index.html">Localization of a point in a convex polygon</a></li>
<li><a href="../144572/index.html">Leaked PS4 specs</a></li>
<li><a href="../144573/index.html">Large images on the site for users with Retina Display - retina.js</a></li>
<li><a href="../144574/index.html">Auto-update of stock deadline in Yandex.Direct</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>