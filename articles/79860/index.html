<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google Search Integration into Drupal website</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Some time ago it became necessary to organize a search on a site on the Drupal with filtering by type of materials and the ability to search by user p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google Search Integration into Drupal website</h1><div class="post__text post__text-html js-mediator-article"><img src="http://drupal.org/sites/all/themes/bluebeach/logos/drupal.org.png" alt="image" hspace="5" align="left">  Some time ago it became necessary to organize a search on a site on the Drupal with filtering by type of materials and the ability to search by user profiles.  The existing solutions did not suit for several reasons.  Two options immediately came to mind: either write your search (using ready-made libraries like phpMorphy), or use Google.  We stopped at the second. <br><br>  The logic of work is simple: Google allows you to search on a specific site.  That is, we can search on <a href="http://www.example.com/">www.example.com</a> , on <a href="http://www.example.com/first/">www.example.com/first</a> , on <a href="http://www.example.com/second/">www.example.com/second</a> , etc.  To search for certain types of materials, we only need to configure different paths for different types of materials and embed them on the <a href="http://www.google.com/cse/%3Fhl%3Dru">Google Custom Search</a> site. <br><br>  Then, briefly, step by step, how it works (a lot of code, no pictures): <br><a name="habracut"></a><br><ul><li>  Turn on the <a href="http://drupal.org/project/pathauto">Pathauto</a> module (pull the <a href="http://drupal.org/project/token">Token</a> module <a href="http://drupal.org/project/token">along</a> ) <br><ol><li>  On the <i>admin / build / path / pathauto page we</i> configure <b>different</b> paths for different types of materials (this is necessary for the search to work correctly) </li><li>  In the same place, we massively reformulate synonyms for all materials on the site. </li></ol><br></li><li>  Google Custom Search Module <br><ol><li>  Hook menu (I will not give all the code, only the main points) <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; }</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { //  $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">function google_custom_search_menu() { <font color="#008000">// </font> $config = variable_get( <font color="#A31515">"google_custom_search"</font> ,array()); $pagelink = <font color="#A31515">"search/google-custom-search"</font> ; $type = MENU_LOCAL_TASK; <font color="#0000ff">if</font> ($config[ <font color="#A31515">'page'</font> ]) { $pagelink = $config[ <font color="#A31515">'page'</font> ]; $type = MENU_SUGGESTED_ITEM; } $items[$pagelink] = array( <font color="#A31515">'title'</font> =&gt; ($config[ <font color="#A31515">'pagename'</font> ]?$config[ <font color="#A31515">'pagename'</font> ]: <font color="#A31515">'Google Custom Search'</font> ), <font color="#A31515">'page callback'</font> =&gt; <font color="#A31515">'google_custom_search_page'</font> , <font color="#A31515">'page arguments'</font> =&gt; array($config), <font color="#A31515">'access arguments'</font> =&gt; array( <font color="#A31515">'use google custom search'</font> ), <font color="#A31515">'type'</font> =&gt; $type, ); <font color="#0000ff">return</font> $items; }</font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> </li><li>  We form the form of choice of types of materials <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  function google_custom_search_main_form () { </li><li>  <font color="#008000">// Connect Pathauto</font> </li><li>  _pathauto_include (); </li><li>  <font color="#008000">// Pathauto Settings</font> </li><li>  $ all_settings = module_invoke_all ( <font color="#A31515">'pathauto'</font> , <font color="#A31515">'settings'</font> ); </li><li>  <font color="#008000">// Types of materials</font> </li><li>  $ types = node_get_types ( <font color="#A31515">'types'</font> ); </li><li>  <font color="#008000">// In the cycle we get all available types of materials, blogs and users</font> </li><li>  <font color="#0000ff">foreach</font> ($ all_settings <font color="#0000ff">as</font> $ settings) { </li><li>  $ module = $ settings-&gt; module; </li><li>  <font color="#0000ff">switch</font> ($ module) { </li><li>  <font color="#0000ff">case</font> <font color="#A31515">'user'</font> : </li><li>  <font color="#008000">// ...</font> </li><li>  <font color="#0000ff">break</font> ; </li><li>  <font color="#0000ff">case</font> <font color="#A31515">'node'</font> : </li><li>  <font color="#0000ff">foreach</font> ($ settings-&gt; patternitems <font color="#0000ff">as</font> $ itemname =&gt; $ itemlabel) { </li><li>  <font color="#008000">// ...</font> </li><li>  } </li><li>  <font color="#0000ff">break</font> ; </li><li>  <font color="#0000ff">case</font> <font color="#A31515">'blog'</font> : </li><li>  <font color="#008000">// ...</font> </li><li>  <font color="#0000ff">break</font> ; </li><li>  } </li><li>  } </li><li>  <font color="#008000">// Print everything on the form</font> </li><li>  $ form = array (); </li><li>  $ form [ <font color="#A31515">'materials'</font> ] = array ( </li><li>  <font color="#A31515">'#type'</font> =&gt; <font color="#A31515">'fieldset'</font> , </li><li>  <font color="#A31515">'#title'</font> =&gt; <font color="#A31515">'Advanced Search'</font> , </li><li>  <font color="#A31515">'#collapsible'</font> =&gt; TRUE, </li><li>  <font color="#A31515">'#collapsed'</font> =&gt; TRUE, </li><li>  ); </li><li>  <font color="#0000ff">foreach</font> ($ final <font color="#0000ff">as</font> $ i =&gt; $ v) { </li><li>  $ form [ <font color="#A31515">'materials'</font> ] [$ names [$ i]] = array ( </li><li>  <font color="#A31515">'#type'</font> =&gt; <font color="#A31515">'checkbox'</font> , </li><li>  <font color="#A31515">'#title'</font> =&gt; $ v, </li><li>  <font color="#A31515">'#default_value'</font> =&gt; 0, </li><li>  <font color="#A31515">'#name'</font> =&gt; $ i, </li><li>  <font color="#A31515">'#attributes'</font> =&gt; array ( <font color="#A31515">'class'</font> =&gt; <font color="#A31515">'google_custom_search_checkbox'</font> ), </li><li>  ); </li><li>  } </li><li>  <font color="#0000ff">return</font> $ form; </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br></li><li>  We create a search page <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  function google_custom_search_page ($ config) { </li><li>  <font color="#0000ff">if</font> (! $ config) { </li><li>  drupal_set_message ( <font color="#A31515">"Google Custom Search module is not configured. Please contact your administrator."</font> , <font color="#A31515">'warning'</font> ); </li><li>  <font color="#0000ff">return</font> FALSE; </li><li>  } </li><li>  $ output = drupal_get_form ( <font color="#A31515">'google_custom_search_main_form'</font> ); </li><li>  $ key = $ config [ <font color="#A31515">'key'</font> ]; </li><li>  $ host = $ _SERVER [ <font color="#A31515">'HTTP_HOST'</font> ]; </li><li>  <font color="#0000ff">if</font> ($ config [ <font color="#A31515">'host'</font> ]) { </li><li>  $ host = $ config [ <font color="#A31515">'host'</font> ]; </li><li>  } </li><li>  $ style = $ config [ <font color="#A31515">'style'</font> ]; </li><li>  $ <font color="#0000ff">string</font> = isset ($ _ POST [ <font color="#A31515">'google_custom_search_string'</font> ])?  htmlspecialchars ($ _ POST [ <font color="#A31515">'google_custom_search_string'</font> ]): <font color="#A31515">""</font> ; </li><li>  $ output. = &lt;&lt;&lt; THIS </li><li>  &lt;script type = <font color="#A31515">"text / javascript"</font> src = <font color="#A31515">"http://www.google.com/jsapi?key=$key"</font> &gt; &lt;/ script&gt; </li><li>  &lt;script type = <font color="#A31515">"text / javascript"</font> &gt; </li><li>  google.load ( <font color="#A31515">"search"</font> , <font color="#A31515">"1"</font> , { <font color="#A31515">"nocss"</font> : <font color="#0000ff">true</font> }); </li><li>  function OnLoad () { </li><li>  <font color="#008000">// Download Google CSE</font> </li><li>  searchHost = <font color="#A31515">"$ host /"</font> ; </li><li>  searchControl = <font color="#0000ff">new</font> google.search.SearchControl (); </li><li>  <font color="#008000">// Set the output type</font> </li><li>  searchControl.setResultSetSize (google.search.Search.LARGE_RESULTSET); </li><li>  <font color="#0000ff">var</font> siteSearch = <font color="#0000ff">new</font> google.search.WebSearch (); </li><li>  siteSearch.setUserDefinedClassSuffix ( <font color="#A31515">"siteSearch"</font> ); </li><li>  siteSearch.setSiteRestriction (searchHost); </li><li>  <font color="#008000">// By default, we search the entire site</font> </li><li>  siteSearch.setUserDefinedLabel ( <font color="#A31515">"All Results"</font> ); </li><li>  searchControl.addSearcher (siteSearch); </li><li>  <font color="#0000ff">var</font> drawOptions = <font color="#0000ff">new</font> google.search.DrawOptions (); </li><li>  <font color="#008000">// Output style depending on the module settings (tabs or one after another)</font> </li><li>  drawOptions.setDrawMode (google.search.SearchControl. $ style); </li><li>  searchControl.draw (document.getElementById ( <font color="#A31515">"searchcontrol"</font> ), drawOptions); </li><li>  searchControl.execute ( <font color="#A31515">"$ string"</font> ); </li><li>  } </li><li>  <font color="#008000">// Update Google CSE when choosing the type of material (the same, but different tabs for different types of materials)</font> </li><li>  $ ( <font color="#A31515">'.google_custom_search_checkbox'</font> ) .change (function () { </li><li>  delete searchControl; </li><li>  searchControl = <font color="#0000ff">new</font> google.search.SearchControl (); </li><li>  searchControl.setResultSetSize (google.search.Search.LARGE_RESULTSET); </li><li>  <font color="#0000ff">var</font> siteSearch = <font color="#0000ff">new</font> google.search.WebSearch (); </li><li>  siteSearch.setUserDefinedClassSuffix ( <font color="#A31515">'siteSearch'</font> ); </li><li>  siteSearch.setSiteRestriction (searchHost); </li><li>  siteSearch.setUserDefinedLabel ( <font color="#A31515">'All Results'</font> ); </li><li>  searchControl.addSearcher (siteSearch); </li><li>  <font color="#008000">// Pass through all selected types</font> </li><li>  $ ( <font color="#A31515">'.google_custom_search_checkbox'</font> ) .each (function () { </li><li>  <font color="#0000ff">if</font> ($ ( <font color="#0000ff">this</font> ) .attr ( <font color="#A31515">'checked'</font> )) { </li><li>  <font color="#0000ff">var</font> siteSearch = <font color="#0000ff">new</font> google.search.WebSearch (); </li><li>  siteSearch.setUserDefinedClassSuffix ( <font color="#A31515">'siteSearch'</font> ); </li><li>  <font color="#0000ff">var</font> newSearchName = $ ( <font color="#0000ff">this</font> ) .parent (). text (). replace (/ / g, <font color="#A31515">''</font> ) .replace (/ (^ \ s +) | (\ s + $) / g, <font color="#A31515">''</font> ); </li><li>  <font color="#0000ff">var</font> newSearchHost = searchHost + $ ( <font color="#0000ff">this</font> ) .attr ( <font color="#A31515">'name'</font> ) .replace (/ / g, <font color="#A31515">''</font> ) .replace (/ (^ \ s +) | (\ s + $) / g, <font color="#A31515">''</font> ); </li><li>  siteSearch.setSiteRestriction (newSearchHost); </li><li>  siteSearch.setUserDefinedLabel (newSearchName); </li><li>  searchControl.addSearcher (siteSearch); </li><li>  } </li><li>  }); </li><li>  <font color="#0000ff">var</font> drawOptions = <font color="#0000ff">new</font> google.search.DrawOptions (); </li><li>  drawOptions.setDrawMode (google.search.SearchControl. $ style); </li><li>  searchControl.draw (document.getElementById ( <font color="#A31515">'searchcontrol'</font> ), drawOptions); </li><li>  }); </li><li>  google.setOnLoadCallback (OnLoad, <font color="#0000ff">true</font> ); </li><li>  &lt;/ script&gt; </li><li>  THIS; </li><li></li><li>  <font color="#0000ff">return</font> $ output; </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br></li></ol><br></li><li>  We create the module settings page and other trifles </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Download the result <a href="http://depositfiles.com/files/omhccaaxr">here</a> or <a href="http://disk.tom.ru/rqjwu7g">here.</a> <br><br>  Criticism is welcome. </div><p>Source: <a href="https://habr.com/ru/post/79860/">https://habr.com/ru/post/79860/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../79853/index.html">Notes on NLP (Part 4)</a></li>
<li><a href="../79854/index.html">Translation Of The Day Of The Triffids (Part One)</a></li>
<li><a href="../79856/index.html">Monitoring home router</a></li>
<li><a href="../79857/index.html">LG XG1 Chic External Drive</a></li>
<li><a href="../79859/index.html">KazNet Congratulation</a></li>
<li><a href="../79861/index.html">Firefox for Maemo operating system (Nokia N900 and N810) reached Release Candidate status</a></li>
<li><a href="../79864/index.html">Another neblon Habr</a></li>
<li><a href="../79869/index.html">Experimentally proved the existence of memories that persist in the brain for life</a></li>
<li><a href="../79870/index.html">Microsoft conducts Best Buy staff training</a></li>
<li><a href="../79874/index.html">EB-5 visa wants to expand on the founders of startups</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>