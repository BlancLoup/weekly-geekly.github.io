<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Can a JavaScript construct (a == 1 && a == 2 && a == 3) be true?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently on Twitter and Reddit was walking an interesting piece of JavaScript code. The question connected with it was the following: ‚ÄúCan the express...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Can a JavaScript construct (a == 1 && a == 2 && a == 3) be true?</h1><div class="post__text post__text-html js-mediator-article"> Recently on <a href="https://twitter.com/hugojmd/status/953763304958255105">Twitter</a> and <a href="https://www.reddit.com/r/javascript/comments/7r0i00/can_a_1_a_2_a3_ever_evaluate_to_true/">Reddit was</a> walking an interesting piece of JavaScript code.  The question connected with it was the following: ‚ÄúCan the expression <code>(a==1 &amp;&amp; a==2 &amp;&amp; a==3)</code> return <code>true</code> ?‚Äù.  The answer to the question, oddly enough, was positive. <br><br> <a href="https://habrahabr.ru/company/ruvds/blog/347530/"><img src="https://habrastorage.org/getpro/habr/post_images/ad8/f14/df8/ad8f14df8e2bd5d7596ec8b06a2b7ce3.png" alt="image"></a> <br><br>  Today we will analyze this code and try to understand it. <br><a name="habracut"></a><br>  Here he is: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = { <span class="hljs-attr"><span class="hljs-attr">num</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">valueOf</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.num += <span class="hljs-number"><span class="hljs-number">1</span></span> } }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> equality = (a==<span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; a==<span class="hljs-number"><span class="hljs-number">2</span></span> &amp;&amp; a==<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(equality); <span class="hljs-comment"><span class="hljs-comment">// true</span></span></code> </pre> <br>  If you are using Google Chrome, open the developer tools console using <code>Ctrl + Shift + J</code> on Windows, or <code>Cmd + Opt + J</code> on macOS.  Copy this code, paste it into the console and make sure that the output really turns out <code>true</code> . <br><br><h2>  <font color="#3AC1EF">What is the catch?</font> </h2><br>  In fact, there is nothing surprising here.  Simply, this code uses two basic JavaScript concepts: <br><br><ul><li>  Operator of nonstrict equality. <br></li><li>  The object <code>valueOf()</code> . <br></li></ul><br><h2>  <font color="#3AC1EF">Lax equality operator</font> </h2><br>  Notice that in the expression under study, <code>(a==1 &amp;&amp; a==2 &amp;&amp; a==3)</code> , a non-strict equality operator is used.  This means that during the calculation of the value of this expression, the casting will be used, that is, using <code>==</code> you can compare values ‚Äã‚Äãof different types.  I have already written a lot about this, so I will not go into details here.  If you need to remember the features of the work of comparison operators in JS - refer to <a href="https://codeburst.io/javascript-double-equals-vs-triple-equals-61d4ce5a121a">this material</a> . <br><br><h2>  <font color="#3AC1EF">ValueOf () method</font> </h2><br>  JavaScript has a built-in method for converting an object to a primitive value: <code>Object.prototype.valueOf()</code> .  By default, this method returns the object for which it was called. <br><br>  Create an object: <br><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = { num: <span class="hljs-number"><span class="hljs-number">0</span></span> }</code> </pre> <br>  As stated above, when we call <code>valueOf()</code> for an object <code>a</code> , it simply returns the object itself: <br><br><pre> <code class="hljs objectivec">a.valueOf(); <span class="hljs-comment"><span class="hljs-comment">// {num: 0}</span></span></code> </pre> <br>  In addition, we can use <code>typeOf()</code> to check whether <code>valueOf()</code> actually returns an object: <br><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> a.valueOf(); <span class="hljs-comment"><span class="hljs-comment">// "object"</span></span></code> </pre> <br><h2>  <font color="#3AC1EF">We write the valueOf ()</font> </h2><br>  The most interesting thing about working with <code>valueOf()</code> is that we can override this method in order to convert an object into a primitive value.  In other words, you can use <code>valueOf()</code> to return objects instead of strings, numbers, booleans, and so on.  Take a look at the following code: <br><br><pre> <code class="hljs actionscript">a.valueOf = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.num; }</code> </pre> <br>  Here we have replaced the standard <code>valueOf()</code> method for object <code>a</code> .  Now, when calling <code>valueOf()</code> , the value of <code>a.num</code> . <br><br>  All this leads to the following: <br><br><pre> <code class="hljs objectivec">a.valueOf(); <span class="hljs-comment"><span class="hljs-comment">// 0</span></span></code> </pre> <br>  As you can see, now <code>valueOf()</code> returns 0!  The most important thing here is that 0 is the value that is assigned to the property of the <code>a.num</code> object.  We can verify this by running several tests: <br><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> a.valueOf(); <span class="hljs-comment"><span class="hljs-comment">// "number" a.num == a.valueOf() // true</span></span></code> </pre> <br>  Now let's talk about why this is important. <br><br><h2>  <font color="#3AC1EF">Non-Strict Equality Operation and Type Casting</font> </h2><br>  When calculating the result of a non-strict equality operation for operands of different types, JavaScript will attempt to cast types - that is, it will attempt to cast (convert) operands to similar types or to the same type. <br><br>  In our expression, <code>(a==1 &amp;&amp; a==2 &amp;&amp; a==3)</code> , JavaScript will try to bring object <code>a</code> to a numeric type before comparing it with a number.  When performing a cast operation on a JavaScript object, it will first try to call the <code>valueOf()</code> method. <br><br>  Since we changed the standard <code>valueOf()</code> method so that it now returns <code>a.num</code> , which is a number, we can now do the following: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">a</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> // <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br>  Is the problem solved?  Not yet, but nothing remains. <br><br><h2>  <font color="#3AC1EF">The assignment operator with addition</font> </h2><br>  Now we need a way to systematically increase the value of <code>a.num</code> each time <code>valueOf()</code> called.  Fortunately, JavaScript has an assignment operator with addition, or an incremental assignment operator ( <code>+=</code> ). <br><br>  This operator simply adds the value of the right operand to the variable on the left, and assigns the resulting value to this variable.  Here is a simple example: <br><br><pre> <code class="hljs pgsql">let b = <span class="hljs-number"><span class="hljs-number">1</span></span> console.log(b+=<span class="hljs-number"><span class="hljs-number">1</span></span>); // <span class="hljs-number"><span class="hljs-number">2</span></span> console.log(b+=<span class="hljs-number"><span class="hljs-number">1</span></span>); // <span class="hljs-number"><span class="hljs-number">3</span></span> console.log(b+=<span class="hljs-number"><span class="hljs-number">1</span></span>); // <span class="hljs-number"><span class="hljs-number">4</span></span></code> </pre> <br>  As you can see, every time we use the assignment operator with addition, the value of the variable increases!  We use this idea in our <code>valueOf()</code> method: <br><br><pre> <code class="hljs actionscript">a.valueOf = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.num += <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre> <br>  Instead of simply returning <code>this.num</code> , we will now, with each call to <code>valueOf()</code> , return the value of <code>this.num</code> , incremented by 1, and write the new value in <code>this.num</code> . <br><br>  After this change is made to the code, we can finally try everything out: <br><br><pre> <code class="hljs lisp">const equality = (<span class="hljs-name"><span class="hljs-name">a==1</span></span> <span class="hljs-symbol"><span class="hljs-symbol">&amp;&amp;</span></span> a==2 <span class="hljs-symbol"><span class="hljs-symbol">&amp;&amp;</span></span> a==3)<span class="hljs-comment"><span class="hljs-comment">; console.log(equality); // true</span></span></code> </pre> <br>  Works! <br><br><h2>  <font color="#3AC1EF">Step by Step Parsing</font> </h2><br>  Remember that when using the non-strict equality operator, JS tries to perform a type conversion.  Our object calls the <code>valueOf()</code> method, which returns <code>a.num += 1</code> , in other words, returns <code>a.num</code> value, incremented by one each time it is called.  Now it remains only to compare two numbers.  In our case, all comparisons will be <code>true</code> . <br><br>  It may be useful to consider what happens step by step: <br><br><pre> <code class="hljs rust">a                     == <span class="hljs-number"><span class="hljs-number">1</span></span>   -&gt; a.valueOf()           == <span class="hljs-number"><span class="hljs-number">1</span></span>   -&gt; a.num += <span class="hljs-number"><span class="hljs-number">1</span></span>            == <span class="hljs-number"><span class="hljs-number">1</span></span>   -&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>     += <span class="hljs-number"><span class="hljs-number">1</span></span>            == <span class="hljs-number"><span class="hljs-number">1</span></span>   -&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>                     == <span class="hljs-number"><span class="hljs-number">1</span></span>   -&gt; <span class="hljs-literal"><span class="hljs-literal">true</span></span> a                     == <span class="hljs-number"><span class="hljs-number">2</span></span>   -&gt; a.valueOf()           == <span class="hljs-number"><span class="hljs-number">2</span></span>   -&gt; a.num += <span class="hljs-number"><span class="hljs-number">1</span></span>            == <span class="hljs-number"><span class="hljs-number">2</span></span>   -&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>     += <span class="hljs-number"><span class="hljs-number">1</span></span>            == <span class="hljs-number"><span class="hljs-number">2</span></span>   -&gt; <span class="hljs-number"><span class="hljs-number">2</span></span>                     == <span class="hljs-number"><span class="hljs-number">2</span></span>   -&gt; <span class="hljs-literal"><span class="hljs-literal">true</span></span> a                     == <span class="hljs-number"><span class="hljs-number">3</span></span>   -&gt; a.valueOf()           == <span class="hljs-number"><span class="hljs-number">3</span></span>   -&gt; a.num += <span class="hljs-number"><span class="hljs-number">1</span></span>            == <span class="hljs-number"><span class="hljs-number">3</span></span>   -&gt; <span class="hljs-number"><span class="hljs-number">2</span></span>     += <span class="hljs-number"><span class="hljs-number">1</span></span>            == <span class="hljs-number"><span class="hljs-number">3</span></span>   -&gt; <span class="hljs-number"><span class="hljs-number">3</span></span>                     == <span class="hljs-number"><span class="hljs-number">3</span></span>   -&gt; <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br><h2>  <font color="#3AC1EF">Results</font> </h2><br>  We believe that examples like the one discussed above help, firstly, it‚Äôs better to learn the basic features of JavaScript, and secondly, they don‚Äôt let us forget that in JS not everything is what it seems. <br><br>  <b>Dear readers!</b>  If you are aware of any curiosities from the JavaScript field, please share them. <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div><p>Source: <a href="https://habr.com/ru/post/347530/">https://habr.com/ru/post/347530/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../347520/index.html">The book "Programming for children. Learning to create websites, applications and games. HTML, CSS and JavaScript ¬ª</a></li>
<li><a href="../347522/index.html">Dependencies between SQL objects: use regular expressions and small algorithmic focus</a></li>
<li><a href="../347524/index.html">Major advances in natural language processing in 2017</a></li>
<li><a href="../347526/index.html">Telegram-bot for Redmine. How to simplify the life of yourself and people</a></li>
<li><a href="../347528/index.html">NLog extension for error monitoring</a></li>
<li><a href="../347534/index.html">All the pain of p2p development</a></li>
<li><a href="../347536/index.html">Chromium: the sixth project check and 250 bugs</a></li>
<li><a href="../347538/index.html">MODx Revo workflow. Workflow organization, version control and deployment</a></li>
<li><a href="../347540/index.html">Legal status of cryptocurrency - the survey is conducted by the bot of the University Innopolis</a></li>
<li><a href="../347542/index.html">Implementing fork () without MMU</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>