<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Programming for Nintendo DS. The first steps</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article covers the basics of developing software for Nintendo DS under Linux. However, all the tools used are cross-platform and there should not...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Programming for Nintendo DS. The first steps</h1><div class="post__text post__text-html js-mediator-article"> This article covers the basics of developing software for Nintendo DS under Linux.  However, all the tools used are cross-platform and there should not be big differences for other operating systems. <br><br>  For a start, let's see what this game console is all about.  This is what Wikipedia tells us: <br>  * Processor: ARM946E-S - 67 MHz, ARM7TDMI coprocessor - 33 MHz <br>  * Memory: 4 MB, 656 KB of video memory, 512K of memory for textures <br>  * Screen: two separate LCDs, a diagonal of 77 mm (3 inches), resolution of 256x192 pixels, up to 260 thousand colors.  The distance between the screens is approximately 21 mm, which is equivalent to 92 "hidden" lines. <br>  * Video system: 2D and 3D support (T &amp; L, texture coordinate transformation, texture mapping, alpha blending, anti-aliasing, cel-shading and Z-buffering) theoretically allows you to draw 120,000 polygons in s 2048 triangles per frame). <br>  * Sound: Stereo, 16-channel ADPCM / PCM <br>  * Drives: 1 slot for Nintendo DS's own cartridge, 2 slot for Nintendo Gameboy Advance cartridge <br>  * Connectivity: IEEE 802.11 (Wi-Fi), the connection uses Nintendo's own format.  The radius of the local network from 10 to 30 meters depending on conditions. <br>  * Control: touch screen, built-in microphone for voice recognition, A / B / X / Y buttons, D-Pad, L / R keys, Start and Select buttons <br>  * Working time: 6-10 hours <br>  * Weight: 275 grams <br>  * Dimensions: 148.7 √ó 84.7 √ó 28.9 mm <br><a name="habracut"></a><br>  As we can see, the console has two processors: ARM9 and ARM7.  The main thing for us is ARM9, our programs will be executed on it.  ARM7 is usually used for touchscreen, keyboard, microphone and other peripherals.  The libNDS library includes a standard program for ARM7 (default.arm7), which fully satisfies the need for communication with standard peripherals.  So at the initial stage we will not have to think about the work of the second processor. <br><br>  Next, set up an environment for cross-compilation. <br>  We will need: <br>  development kit for ARM - DevkitARM <a href="http://sourceforge.net/projects/devkitpro/files/devkitARM">sourceforge.net/projects/devkitpro/files/devkitARM</a> ; <br>  library for simplifying development for Nintendo DS - libNDS <a href="http://sourceforge.net/projects/devkitpro/files/libnds">sourceforge.net/projects/devkitpro/files/libnds</a> ; <br>  as well as an emulator, for example, DeSmuME - <a href="http://desmume.org/download/">desmume.org/download</a> . <br>  Create the directory / opt / devkitpro, into which we unpack devkitARM and libNDS. <br>  Configuring environment variables: <br> <code>export DEVKITPRO=/opt/devkitpro <br> export DEVKITARM=$DEVKITPRO/devkitARM</code> <br>  Here, in general, everything is set up. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now it's time to look at the graphics subsystem, and at the same time write a simple program, something like ‚ÄúHello World!‚Äù.  NDS has two graphic cores: the main one is used by default for the upper screen and the additional (sub) one for the lower one.  Each of the cores can work in one of six modes, and the main one has 2 more additional modes for displaying large images. <br><br><table><caption><h5>  Graphic modes of the video controller: </h5></caption><tbody><tr><th colspan="5"><h6>  Main 2D core </h6></th></tr><tr><td>  Mode </td><td>  Bg0 </td><td>  Bg1 </td><td>  Bg2 </td><td>  Bg3 </td></tr><tr><td>  Mode 0 </td><td>  Text / 3D </td><td>  Text </td><td>  Text </td><td>  Text </td></tr><tr><td>  Mode 1 </td><td>  Text / 3D </td><td>  Text </td><td>  Text </td><td>  Rotation </td></tr><tr><td>  Mode 2 </td><td>  Text / 3D </td><td>  Text </td><td>  Rotation </td><td>  Rotation </td></tr><tr><td>  Mode 3 </td><td>  Text / 3D </td><td>  Text </td><td>  Text </td><td>  Extended </td></tr><tr><td>  Mode 4 </td><td>  Text / 3D </td><td>  Text </td><td>  Rotation </td><td>  Extended </td></tr><tr><td>  Mode 5 </td><td>  Text / 3D </td><td>  Text </td><td>  Extended </td><td>  Extended </td></tr><tr><td>  Mode 6 </td><td>  3D </td><td>  - </td><td>  Large Bitmap </td><td>  - </td></tr><tr><td>  Frame buffer </td><td colspan="4">  Direct VRAM display as a bitmap </td></tr><tr><th colspan="5"><h6>  Additional 2D core </h6></th></tr><tr><td>  Mode </td><td>  Bg0 </td><td>  Bg1 </td><td>  Bg2 </td><td>  Bg3 </td></tr><tr><td>  Mode 0 </td><td>  Text </td><td>  Text </td><td>  Text </td><td>  Text </td></tr><tr><td>  Mode 1 </td><td>  Text </td><td>  Text </td><td>  Text </td><td>  Rotation </td></tr><tr><td>  Mode 2 </td><td>  Text </td><td>  Text </td><td>  Rotation </td><td>  Rotation </td></tr><tr><td>  Mode 3 </td><td>  Text </td><td>  Text </td><td>  Text </td><td>  Extended </td></tr><tr><td>  Mode 4 </td><td>  Text </td><td>  Text </td><td>  Rotation </td><td>  Extended </td></tr><tr><td>  Mode 5 </td><td>  Text </td><td>  Text </td><td>  Extended </td><td>  Extended </td></tr></tbody></table><br><br>  To use the kernel, we must first enable it, set the mode of operation, and ‚Äúmuzzle‚Äù the memory. <br>  Our program will require the output of 2D information, therefore we include the 2D graphics core for the main screen: <br> <code>powerOn(POWER_2D_A);</code> <br> <br>  Set the video mode for the graphics core: <br> <code>videoSetMode(MODE_FB0);</code> <br>  Framebuffer mode - direct correspondence of video memory to display pixels. <br><br>  Next, you need to specify the graphics core, what area of ‚Äã‚Äãmemory it needs to use, because both graphics cores share common video memory.  Bank A is used as a framebuffer for the top screen: <br> <code>vramSetBankA(VRAM_A_LCD);</code> <br> <br>  At this initialization is completed and we can already display information on the screen.  For example, fill the screen with pixels of random color. <br>  Here is the entire text of the program: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#include &lt;nds.h&gt; <br> <font color="#0000ff">int</font> main() <br> { <br> powerOn(POWER_2D_A); <font color="#008000">//  2D </font> <br> videoSetMode(MODE_FB0); <font color="#008000">//  </font> <br> vramSetBankA(VRAM_A_LCD); <font color="#008000">//  </font> <br> uint16* buffer; <br> <font color="#0000ff">while</font> ( <font color="#0000ff">true</font> ){ <br> buffer = VRAM_A + rand()/(RAND_MAX/SCREEN_WIDTH/SCREEN_HEIGHT); <font color="#008000">//   </font> <br> *buffer = RGB15(rand()/(RAND_MAX/31),rand()/(RAND_MAX/31),rand()/(RAND_MAX/31)); <font color="#008000">// </font> <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Here is the program with the makefile: <a href="http://narod.ru/disk/23987391000/example1.tar.gz.html">narod.ru/disk/23987391000/example1.tar.gz.html</a> <br><br>  So, we have just created, albeit a primitive, but well-functioning program for the Nintendo DS.  In the next article I plan to consider working with tile graphics, interrupts, keyboard and touch screen on the example of a simple game. <br><br>  And here is a very good cycle of lessons in English: <a href="http://dev-scene.com/NDS/Tutorials">dev-scene.com/NDS/Tutorials</a> </div><p>Source: <a href="https://habr.com/ru/post/102666/">https://habr.com/ru/post/102666/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../102656/index.html">How Alfa Bank makes money on customers</a></li>
<li><a href="../102657/index.html">Calls to phones from Gmail</a></li>
<li><a href="../102659/index.html">A giant wind farm is being built in Idaho.</a></li>
<li><a href="../102662/index.html">IT student diary</a></li>
<li><a href="../102663/index.html">A bug in the payment terminals Petroelektrosbyt</a></li>
<li><a href="../102670/index.html">Using Intel TBB to create multi-threaded applications</a></li>
<li><a href="../102671/index.html">Future Amusement Park</a></li>
<li><a href="../102673/index.html">Internet Explorer 9 Beta Screenshot</a></li>
<li><a href="../102676/index.html">Internship at Google 2 (Google campus in pictures)</a></li>
<li><a href="../102677/index.html">New Gmail chat caller in conjunction with Google Voice: first impressions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>