<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Introduction to Vector Displays</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is a translation of this article. 
 I hope my translation will not be too clumsy, and the material is interesting. 

 Today, vector displ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Introduction to Vector Displays</h1><div class="post__text post__text-html js-mediator-article">  <i>This article is a translation of <a href="http://www.nycresistor.com/2012/09/03/vector-display/">this</a> article.</i> <i><br></i>  <i>I hope my translation will not be too clumsy, and the material is interesting.</i> <br><br>  Today, vector displays are rather old wonders than a means of displaying information; nevertheless, their use in arcade machines and radar systems gives them a certain charm. <br>  Unlike ordinary raster displays, where the beam passes from left to right and top to bottom each time to draw each line, in vector displays the beam moves along the lines defining the image. <br><br>  Most two-channel oscilloscopes have an XY mode, in which the signal used to scan the image in time is replaced by the input signal, thereby allowing control of the position of the beam in two planes.  Using <a href="http://ru.wikipedia.org/wiki/%25D0%25A8%25D0%25B8%25D1%2580%25D0%25BE%25D1%2582%25D0%25BD%25D0%25BE-%25D0%25B8%25D0%25BC%25D0%25BF%25D1%2583%25D0%25BB%25D1%258C%25D1%2581%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BC%25D0%25BE%25D0%25B4%25D1%2583%25D0%25BB%25D1%258F%25D1%2586%25D0%25B8%25D1%258F">PWM</a> with a low pass filter can be effective for controlling the brightness of the LED, but in order to draw complex shapes a faster way is needed.  The easiest way is to use a <a href="http://ru.wikipedia.org/wiki/%25D0%25A6%25D0%25B8%25D1%2584%25D1%2580%25D0%25BE-%25D0%25B0%25D0%25BD%25D0%25B0%25D0%25BB%25D0%25BE%25D0%25B3%25D0%25BE%25D0%25B2%25D1%258B%25D0%25B9_%25D0%25BF%25D1%2580%25D0%25B5%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D0%25B7%25D0%25BE%25D0%25B2%25D0%25B0%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C">DAC</a> (digital-to-analog converter) according to the R-2R scheme. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/fdc/2b6/aef/fdc2b6aefe7b8c8034ba7ebd84f0e810.jpg" alt="image"><br><br>  If you are interested in learning more about creating a vector display or how to draw an oscilloscope on the screen, welcome under cat. <br><a name="habracut"></a><br><h4>  Parallel DAC under the scheme R-2R </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/176/8fa/2ef/1768fa2ef01352f66f7cbb3f139210bb.jpg" alt="image"><br>  Eight-bit DAC is simple to create, it requires only 16 resistors per channel.  It is advisable to use resistors with a one percent tolerance, but 5% will also fit.  You need 7 resistors with resistance R and 9 with resistance 2 * R. <br>  In this case, 0.5 and 1 kŒ© resistors are used. <br>  Schematic diagram of the converter: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a70/46c/2e4/a7046c2e4378ecc407927959ed4cec9d.png" alt="image"><br><br>  Since we control two channels of the oscilloscope, we need two DACs. <br><br>  If you do not want to solder so many parts, then you can use resistor assemblies in SIP packages or use something like MC1408 / 1508 (multiplying DAC) in a 16 pin DIP package. <br><br>  This project uses a card based on the ATMEGA32U4 microcontroller, you can use almost any other microcontroller, the main thing is that it has two 8-pin ports free so that you can change the state of the pins simultaneously. <br><br>  I use ports PORTD and PORTB. <br><br><h4>  Oscilloscope setup </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/b79/8e1/9c0/b798e19c0075ec5f4ffd3e82bb728767.jpg" alt="image"><br>  After splicing the circuit, connect it to the oscilloscope and put it in XY mode. <br>  In inexpensive Rigol, for this you need to enter the Horizontal Menu - Time Base menu and select the XY mode. <br>  Unfortunately, inexpensive digital oscilloscopes with LCD screens are inferior to analog ones in the drawing context, although some of them have a Digital Phosphor mode that simulates screen inertia. <br><br><h4>  Horizontal and vertical lines </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/9bb/530/76b/9bb53076b7a88edb1767e3ef91a1aa0e.jpg" alt="image"><br><br>  By connecting the DACs directly to the ports of the microcontroller, the analog voltage can be changed by writing values ‚Äã‚Äãto the port.  For example, to generate a 2 volt signal, the value should be 256 * 2.0V / 5.0V == 102. <br><br><pre><code class="cpp hljs">DDRB = <span class="hljs-number"><span class="hljs-number">0xFF</span></span>; PORTB = <span class="hljs-number"><span class="hljs-number">102</span></span>; <span class="hljs-comment"><span class="hljs-comment">//,    ,  2 </span></span></code> </pre> <br><br>  In principle, we are not interested in the specific voltage value, it is important that the output voltage varies linearly from 0 volts at 0x00 to 5 volts at 0xFF. <br><br>  The oscilloscope should be adjusted to the range of 0-5 Volts and aligned on each of the axes. <br>  The first thing to try is to draw horizontal and vertical lines; this can be done with the help of cycles, leaving one variable unchanged.  For example, when drawing a horizontal line, the value of Y is constant and vice versa. <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">line_vert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x0, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y0, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> w )</span></span></span><span class="hljs-function"> </span></span>{ PORTB = x0; PORTD = y0; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span> ; i &lt; w ; i++) PORTD++; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">line_horiz</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x0, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y0, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> h )</span></span></span><span class="hljs-function"> </span></span>{ PORTB = x0; PORTD = y0; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span> ; i &lt; h ; i++) PORTB++; }</code> </pre><br><br>  The code for drawing a square, like the one in the previous figure. <br><br><pre> <code class="cpp hljs"> line_vert(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">128</span></span>); line_vert(<span class="hljs-number"><span class="hljs-number">196</span></span>, <span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">128</span></span>); line_horiz(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">128</span></span>); line_horiz(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-number"><span class="hljs-number">196</span></span>, <span class="hljs-number"><span class="hljs-number">128</span></span>);</code> </pre><br><br><h4>  Sloping lines </h4><br><img src="http://farm9.staticflickr.com/8321/7925249358_b521a0d554_z.jpg" alt="image"><br><br>  This image shows a common artifact of vector displays: bright dots at the beginning and end of a line.  This effect arises because the intensity of the glow point depends on the time spent by the beam at this point, and since the program needs some time to load a new line, the beam is delayed a little longer in one place.  To solve this problem, you can use 16-bit arithmetic or add NOPs, so that switching always takes place at the same time. <br><br>  Here it is necessary to say about the burnout of the screen. <br><br>  If the values ‚Äã‚Äãdo not change for a long time, then the phosphorus in this place can fade and become a different color.  Screens can also be damaged if you constantly display the same image.  During the firmware of the microcontroller, the ports usually switch to the Z-mode, which means that zeros are fed to the oscilloscope input, which results in a bright spot in the corner of the screen. <br><br>  <b>During flashing it is best to reduce the brightness.</b> <br><br>  Drawing slanted lines is much more difficult than drawing vertical or horizontal lines. <br>  An ideal option is to use analog circuits to smoothly change the signal, as, for example, this is done in the <a href="http://www.cathodecorner.com/sc200c.html">SC200</a> . <br><br>  In other matters, instead, we can use the Brezenham algorithm, to split the line into points.  The use of this algorithm causes the appearance of steps on the image, but this is offset by the simplicity of the implementation. <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">line</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x0, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y0, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y1 )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dx, dy, sx, sy; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (x0 &lt; x1) { dx = x1 - x0; sx = <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { dx = x0 - x1; sx = <span class="hljs-number"><span class="hljs-number">-1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (y0 &lt; y1) { dy = y1 - y0; sy = <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { dy = y0 - y1; sy = <span class="hljs-number"><span class="hljs-number">-1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> err = dx - dy; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>) { PORTB = x0; PORTD = y0; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (x0 == x1 &amp;&amp; y0 == y1) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> e2 = <span class="hljs-number"><span class="hljs-number">2</span></span> * err; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e2 &gt; -dy) { err = err - dy; x0 += sx; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e2 &lt; dx) { err = err + dx; y0 += sy; } } }</code> </pre><br><br><h4>  Fonts </h4><br><img src="http://farm9.staticflickr.com/8170/7903933104_84d223e39e_z.jpg" alt="image"><br><br>  After we learned to draw lines, nothing prevents us from drawing symbols. <br>  It is convenient to use the <a href="http://paulbourke.net/dataformats/hershey/">Hershey Fonts</a> library as a font. <br>  In it, each character consists of less than 32 points.  All coordinates of the points are located relative to the lower left corner of the symbol and are connected until the value (-1, 1) is encountered, which means that you need to jump to the next point.  The contour ends at the point with the value (0, 0). <br>  Example for the number 1. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int8_t</span></span> x, y; } <span class="hljs-keyword"><span class="hljs-keyword">path_t</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PROGMEM <span class="hljs-keyword"><span class="hljs-keyword">path_t</span></span> digits[][<span class="hljs-number"><span class="hljs-number">32</span></span>] = { [<span class="hljs-number"><span class="hljs-number">1</span></span>] = { { <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">17</span></span>}, { <span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>}, {<span class="hljs-number"><span class="hljs-number">11</span></span>,<span class="hljs-number"><span class="hljs-number">21</span></span>}, {<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}, }, };</code> </pre><br><br><br>  Sometimes in the image you can see the lines between two points that do not connect, this is because the voltage on the DAC does not change instantaneously.  This effect can be corrected if you use the brightness channel of the oscilloscope, unfortunately my oscilloscope does not have such a function. <br><br><h4>  Raster images </h4><br><img src="http://farm9.staticflickr.com/8439/7916968344_4d944c8f84_z.jpg" alt="image"><br>  Using the oscilloscope can also display raster images. <br>  Images are obtained by converting the image to the X Bitmap format using ImageMagick.  X Bitmap is a text format for representing images, can be used directly in the source code. <br><pre> <code class="bash hljs">convert -resize 256x256 input.jpg image/image.xbm</code> </pre><br>  The result is a monochromatic image that takes up 8 kilobytes of program memory. <br><br><h4>  Video </h4><br> <a data-flickr-embed="true" href="https://www.flickr.com/photos/osr/7925036218/" title="Oscilloscope vector clock by hudson, on Flickr"><img src="https://farm9.staticflickr.com/8439/7925036218_c9006a067f_n.jpg" width="320" height="180" alt="Oscilloscope vector clock"></a> <script async="" src="https://embedr.flickr.com/assets/client-code.js" charset="utf-8"></script><br>  If the video is not displayed, it can be found at <a href="http://www.flickr.com/photos/osr/7925036218/in/set-72157631344809602/">www.flickr.com/photos/osr/7925036218/in/set-72157631344809602</a> <br><h4>  Future plans </h4><br><img src="http://farm9.staticflickr.com/8452/7910089746_f2beaef485_z.jpg" alt="image"><br>  In the future, I plan to restore a wonderful CRT oscilloscope and port Spacewar with a PDP-1. </div><p>Source: <a href="https://habr.com/ru/post/161767/">https://habr.com/ru/post/161767/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../161747/index.html">Forwarding NVIDIA Quadro 4000 to a virtual machine using the Xen hypervisor</a></li>
<li><a href="../161755/index.html">Create a complex maze in the background of the web page (on the client)</a></li>
<li><a href="../161757/index.html">What is appropriate to pay attention to in the report "2012 Internet Trends (Update)", leafing through it in its entirety</a></li>
<li><a href="../161761/index.html">Price reduction for Windows Azure Storage</a></li>
<li><a href="../161763/index.html">Custom buttons in the Yandex.Maps API 2.0</a></li>
<li><a href="../161771/index.html">Peter Westerback in Skolkovo</a></li>
<li><a href="../161773/index.html">‚ÄúSimple Business‚Äù received new perpetual licenses from the FSB and FSTEC</a></li>
<li><a href="../161775/index.html">Making OpenGL ES LiveWallpaper on Linderdaum Engine for Android</a></li>
<li><a href="../161779/index.html">Curved LCDs can be used as screens in contact lenses.</a></li>
<li><a href="../161783/index.html">Free distance education</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>