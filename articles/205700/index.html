<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hesperbot targets Germany and Australia</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In September, we reported on a new banking Trojan called Hesperbot (found as Win32 / Spy.Hesperbot ). Cybercriminals using this tool are still active,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hesperbot targets Germany and Australia</h1><div class="post__text post__text-html js-mediator-article">  In September, we <a href="http://habrahabr.ru/company/eset/blog/193318/">reported</a> on a new banking Trojan called <b>Hesperbot</b> (found as <a href="http://virusradar.com/en/Win32_Spy.Hesperbot/detail">Win32 / Spy.Hesperbot</a> ).  Cybercriminals using this tool are still active, in November new cases of the use of this malware were recorded. <br><br>  We have already shown that the geographical distribution of infections of this malware is quite localized in several specific countries.  Spam campaigns with phishing messages in their native language were used to infect users.  As expected, the attackers did not take much time to start targeting new countries.  In addition to the four that we have already indicated (Turkey, the Czech Republic, Portugal, and the United Kingdom), in the past month new versions of malicious code were recorded for users in Germany and Australia. <br><br>  Over the past month, there have been major cases of infections in the Czech Republic, and attackers have also added web injection scripts (web injection) to the configuration files for the Czech botnet.  The diagram below shows the distribution of Hesperbot infections by country, which we recorded in November using ESET LiveGrid. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><img src="https://habrastorage.org/getpro/habr/post_images/385/694/503/3856945037119a33ca4148273abd8543.png"><br><br>  Hesperbot has a modular architecture and, through configuration files, allows attackers to target malicious code to new online banking systems.  Using this configuration file, specific instructions are given to the malicious code, for example, which URLs the form-taking module (form grabber) should ignore.  That is, when meeting such a URL in an HTTP POST request, this module will not perform special actions to steal user data into web forms in order to obtain information about online banking accounts / credit cards and transfer them to attackers.  Another address list is used to determine the situations of the video capture module (it can be used as a means of bypassing virtual keyboards and helps the botnet operator to monitor the balance of the victim‚Äôs bank account without having to log in to the online banking account).  The configuration file also contains web injections, in a format similar to <a href="http://www.welivesecurity.com/search/%3Fs%3Dzeus%26x%3D0%26y%3D0">Zeus</a> and <a href="http://www.welivesecurity.com/search/%3Fs%3Dspyeye%26x%3D0%26y%3D0">SpyEye</a> . <br><br>  The table below shows the URLs of online banking systems that were found in one of the latest configuration files. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5ac/26d/76b/5ac26d76b6596d0c25765273cae775d6.png"><br><br>  Below is the layout of a web form, with which attackers try to lure the victim to install a mobile component. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/af0/63d/a35/af063da35682da21efa802f80b2d390b.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3d4/73d/303/3d473d303f6bf1aee08c41d9fb92c942.png"><br><br>  Next, the user needs to follow the appropriate installation instructions. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c3b/575/90b/c3b57590b1188e60d69193b3409b780d.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5ee/d5c/586/5eed5c586f7a609716e2a67837698506.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/df1/32a/869/df132a869832abd55fc5739894cd1106.png"><br><br>  Below is the present case of a web injection on the website of a Czech bank. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e40/f02/76e/e40f0276e707ee12ade774e0a47ad9e4.jpg"><br><br>  Note that in the case of Hesperbot, the user continues to observe the https connection icon in the address bar of the browser.  More detailed information about the methods used by him for this purpose can be found in our <a href="http://habrahabr.ru/company/eset/blog/193318/">detailed analysis</a> . <br><br>  We have already described various Hesperbot modules in our previous analysis.  The latest version of the malicious code now uses two new modules.  The first is called <i>gbitcoin</i> and tries to steal the following files: <br><br>  -% APPDATA% \ Bitcoin \ wallet.dat <br>  -% APPDATA% \ MultiBit \ multibit.wallet <br><br>  These files are used as Bitcoin repositories and store secret keys for Bitcoin and MultiBit clients.  With the current high value of the Bitcoin currency, such a decision to add such a module is quite understandable.  Some tips on how to safely use Bitcoins can be found on our <a href="http://www.welivesecurity.com/2013/11/29/cash-or-crash-tips-and-tricks-for-using-bitcoin-safely/">English-language blog</a> , as well as on the <a href="https://en.bitcoin.it/wiki/Securing_your_wallet">Bitcoin wiki</a> . <br><br>  The second module added by cybercriminals is even more interesting than the first.  The activity of this module is determined by the configuration file Hesperbot.  If there are corresponding records in it, the module can perform the following actions: <br><br><ul><li>  Stop all threads in the required process, and also hide all its visible windows. </li><li>  Show special messages to the user using the <i>MessageBox</i> function. </li><li>  Block network interaction by intercepting the <i>recv</i> , <i>WSARecv</i> , <i>send</i> , <i>WSASend functions</i> from the ws2_32.dll library for a certain time. </li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f12/7cd/9f4/f127cd9f4b912f8992e25107806bc607.png"><br>  Fig.  Hesperbot intercepted network functions. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/969/50b/5a2/96950b5a247f5a07a1f379e534c879a2.png"><br>  Fig.  Hesperbot intercepted network functions. <br><br>  In this case, the functions being intercepted will return a WSAEACCESS error.  To implement the hooks, Hesperbot uses the sch_mod helper module. <br><br>  So far, we have not been able to detect configuration files that activate this new functionality.  The possible purpose of using such handlers is to block the work of individual banking applications on which the Trojan program cannot be managed.  This practice can push the user to use the browser's web interface, which has already been compromised by malicious code. <br><br>  We were able to detect the C &amp; C Hesperbot control panel. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/abb/9e1/4ee/abb9e14eecc45c389ad502a2cc661277.png"><br><br>  The screenshot above shows the different banks for countries targeted by Hesperbot and the number of successful mobile component installations.  As mentioned earlier, cybercriminals lured victims to the mobile component installation page via web-based injection to online banking systems sites.  The control panel shown above can provide statistics on Turkish, Australian and German botnets. <br><br>  <b>Conclusion</b> <br><br>  The intruders using Hesperbot have been very active lately, so you can expect appropriate financial losses for bank customers.  We continue to monitor the activity of Hesperbot and we will keep you informed of further developments. </div><p>Source: <a href="https://habr.com/ru/post/205700/">https://habr.com/ru/post/205700/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../205690/index.html">Video review monoblock (tablet) Dell XPS 18</a></li>
<li><a href="../205692/index.html">We lost that web</a></li>
<li><a href="../205694/index.html">Technological neutrality of radio frequencies in Russia announced</a></li>
<li><a href="../205696/index.html">Script for fixing the date of setting the user's password in AD</a></li>
<li><a href="../205698/index.html">Porting an extension from Chrome to Firefox</a></li>
<li><a href="../205702/index.html">A small intermediate result of the year of great work</a></li>
<li><a href="../205704/index.html">All participants of the DARPA robot competition have been identified.</a></li>
<li><a href="../205710/index.html">New database module for PHPixie completed</a></li>
<li><a href="../205720/index.html">New Google Sheets: Faster, More Powerful and Work Offline</a></li>
<li><a href="../205724/index.html">Everything is ready to ship!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>