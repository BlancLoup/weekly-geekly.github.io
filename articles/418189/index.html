<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The heir of Zeus: how dangerous is IcedID Trojan for bank customers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Group-IB experts analyzed the Trojans attacking the customers of US banks and made public the results of a deep analysis of the dynamic configuration ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The heir of Zeus: how dangerous is IcedID Trojan for bank customers</h1><div class="post__text post__text-html js-mediator-article">  <b>Group-IB experts analyzed the Trojans attacking the customers of US banks and made public the results of a deep analysis of the dynamic configuration data format with Python scripts and information on CnC servers.</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b0/4i/rd/b04ird-g1xlcbwcd27zrl3rzg90.png" alt="image"></div><br>  In November 2017, a team of researchers from IBM X-Force published a report on the new Trojan - <a href="https://securityintelligence.com/new-banking-trojan-icedid-discovered-by-ibm-x-force-research/">IcedID</a> , which is aimed mainly at customers of US banks.  The bot has many of the capabilities of the infamous Zeus malware, including: loading and launching modules, collecting and sending authentication data to the server, information about the infected device, carrying out a man-in-the-browser attack (MITB).  Despite the fact that in terms of its functionality, the new trojan turned out to be similar to other popular bankers - Trickbot, GOZI, Dridex, actively attacking bank customers, IcedID uses a non-standard binary format for storing configuration data.  Another distinguishing feature of this malware is the ability to deploy a proxy server directly on an infected machine to carry out an MITB attack. <a name="habracut"></a><br><br>  <b>Text: Ivan Pisarev, Group-IB Malicious Code Analysis Specialist</b> <b><br></b> <br>  Immediately, we note that IcedID is not as widely distributed as compared to other Trojans, however, it already has enough functional capabilities to accomplish the tasks set for it, the main one being the theft of credentials of victims.  This can be achieved in many ways, ranging from the banal theft of files and registry entries from an infected computer, to the interception and change of encrypted browser traffic (man-in-the-browser attack). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the case of IcedID, data from accounts was stolen: Windows Live Mail, Windows Mail, RimArts, Poco Systems Inc, IncrediMail, The Bat!  and Outlook.  The MITB attack is performed using a proxy server, which the Trojan raises on the infected device, thereby passing all network traffic through itself and modifying it.  IcedID also has a command processing module from the server that allows you to remotely download and run a file (for example, in the case under study, the sample loaded the VNC module, whose program code has similar parts of the code with IcedID). <br><br>  Using a proxy server for MITB is an atypical behavior for this type of trojan.  More often, the malware is embedded in the browser context and redirection of function calls from standard libraries to its handler functions (example: <b>WinHttpConnect ()</b> , <b>InternetConnect ()</b> , <b>InternetReadFile ()</b> , <b>WinHttpReadData ()</b> , etc.).  Previously, the proxy server trick was already used in <a href="https://securityintelligence.com/gootkit-developers-dress-it-up-with-web-traffic-proxy/">GootKit</a> . <br><br>  IcedID was spread with the help of other malware - Emotet (currently it is often used as a bootloader, although it has advanced functionality) and already at the start included an extensive list of modern methods of theft of user data. <br><br>  Now the trojan has rather weak anti-analysis mechanisms (string encryption, header corrupt) and does not have any VM-detect methods.  From the point of view of the researcher, malware is still in development and these protection mechanisms will be added later. <br><br>  The Group-IB Threat Intelligence cyber intelligence system did not detect IcedID sales in the subject forums, which means either the appearance of a new group in the banking Trojans arena or the sale of the Trojan through private channels.  The bot's targets, judging by the dynamic configuration data (hereinafter referred to as configs), are located mainly in the USA. <br><br><div class="spoiler">  <b class="spoiler_title">Target list</b> <div class="spoiler_text">  Chase <br>  Charles Schwab <br>  Bank of America <br>  USAA <br>  American express <br>  Wells fargo <br>  Capital One <br>  Td Commercial Banking <br>  TD Bank <br>  Central Bank <br>  US Bank <br>  Union Bank of California <br>  Amazon <br>  PNC Online Banking <br>  Synovus <br>  BB &amp; T Bank <br>  Citibank <br>  eBanking <br>  Huntington <br>  Cashanalyzer <br>  E-trade <br>  JPMorgan Chase <br>  CIBC <br>  Regions onepass <br>  Post Oak Bank <br>  Comerica <br>  Discover Bank <br>  Keybank <br>  Frost Cash Manager <br>  HSBC <br>  RBC <br>  Halifax <br>  Verizon wireless <br>  Lloyds bank <br>  M &amp; T Bank <br>  VirWoX <br>  ADP <br></div></div><br>  This article includes a detailed analysis of the Trojan, a deep analysis of the format of dynamic configs with Python scripts and information on CnC. <br><br><h2>  Technical part </h2><br><h3>  General description of the work of the Trojan </h3><br>  Initially, the trojan‚Äôs <b>.data</b> section is encrypted.  First of all, after the launch, it decrypts the section according to the algorithm: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/a-/q0/ix/a-q0ixeg0onp--szzafmr9on6os.png" alt="image"></div><br>  The <b>initial_seed</b> and <b>size_seed variables</b> are located at the beginning of the data section (the first 8 bytes of the section), after which the encrypted data of <b>size</b> bytes is found.  The <b>make_seed ()</b> function is a unique pseudo-random number generator ( <b>PRNG)</b> function for IcedID, to which we will return again and again.  A Python version of the function can be found <a href="https://github.com/mResearch/research/blob/master/icedid_config.py">here</a> . <br><br>  Initially, the bot contains encrypted strings.  To facilitate analysis, a <a href="https://github.com/mResearch/research/blob/master/icedid_ida.py">script</a> was written for IDA Pro to decipher the strings (you need to insert the address of the decryption function in your sample). <br><br>  The next step is to add an exception handler using the <b>SetUnhandledExceptionFilter ()</b> function.  If any exception occurs during the operation of the application, it simply restarts. <br><br>  After adding an exception handler, the Trojan collects information about the infected system: <br><br><ol><li>  OS version </li><li>  OS build number </li><li>  Service Pack Version </li><li>  System capacity </li><li>  OS type </li></ol><br>  The application creates a security descriptor: <b>D: (A ;; GA ;;; WD) (A ;; GA ;;; AN) S: (ML ;; NW ;;; S-1-16-0)</b> , and then allocates memory for logging information in the process of trojan operation.  An example of logged lines (the lines were obtained using a script in IDA): <br><br><ol><li>  E | C | IN | INS | ISF | CP% u </li><li>  I | C | IN | INT | CI |  % u </li><li>  W | C | IN | INT | CI | CRLL </li></ol><br>  IcedID can take several parameters.  Among them: <br><br><ul><li>  <b>--svc =</b> - saves the string from the parameter to the registry by key with the name <b>IcedID_reg ("* p *")</b> , where <b>IcedID_reg (str)</b> is the function for generating the key name from the string <b>str</b> (the algorithm for generating registry key names will be described later), after which Trojan refers to an event named <b>Global \ &lt;% A string of random characters%&gt;</b> .  In case of an error, the bot creates a copy of its process with the <b>/ w =</b> parameter.  If this could not be done, creates a value in the registry: </li></ul><br><blockquote>  HKEY_CURRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ Run \ &lt;% String of length 9 of random characters [az]%&gt; </blockquote><br>  thereby ensuring the persistence of the system.  This key is intended for the initial launch of the Trojan. <br><br><ul><li>  <b>/ u</b> - by default, the malware attempts to launch itself as a domain administrator (using the <b>runas</b> program).  If this flag is present, the Trojan does not perform this operation and simply creates its copy in the <b>C: \ Users \ &lt;% username%&gt; \ AppData \ Local \ &lt;%</b> directory. <b>A string of length 9 from random characters [az]%&gt;</b> with the name <b>&lt;% The string of length 9 consists of random characters of the alphabet [az]%&gt;. Exe</b> , and writes the path to the file to the registry, thereby ensuring its persistence in the system. </li></ul><br><blockquote>  HKEY_CURRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ Run \ &lt;% String of length 9 of random characters [az]%&gt; </blockquote><br>  It seems that this key is used when updating the banker.  Before restarting, the Trojan goes to sleep for 5 seconds. <br><br><ul><li>  <b>/ c</b> - before execution of malicious functions, the trojan "falls asleep" for 5 seconds </li><li>  <b>/ w =</b> - saves the string from the parameter to the registry by key with the name <b>IcedID_reg ("* p *")</b> </li></ul><br>  After processing the parameters, the application accesses the registry and retrieves dynamic configuration data from there that contains CnC addresses as well as Web injections.  The format for storing data in the registry is described in the following sections. <br><br>  After accessing the registry, the program creates a stream that every 5 or 10 minutes (depending on the internal flag) calls the CnC to receive commands.  It is worth noting the nonstandard mechanism of ‚Äúfalling asleep‚Äù of the bot between the call to CnC: the developers did not use the standard <b>Sleep ()</b> function, instead they created an event in a non-alarm state and without calling it in a signal state they call the <b>WaitForSingleObject ()</b> function.  CnC call flow creation function: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vu/bg/1_/vubg1_zk61_dw8auvz80yi1lhxc.png" alt="image"></div><br>  Analogue of the <b>Sleep ()</b> function in IcedID: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yd/if/f3/ydiff39eemw9rymerxmj82rintw.png" alt="image"></div><br>  A long period of access to the server, as well as a non-standard ‚Äúsleep function‚Äù are most likely intended to counter analysis. <br><br>  SSL is used to hide the traffic between the server and the application. <br><br>  After the start of the stream, the bot ‚Äúraises‚Äù a proxy server on the local machine in order to process the traffic on the infected machine. <br><br>  The communication protocol of the server and the infected device will be discussed in the following sections.  However, it is worth noting that a malicious program can update configs, start and stop a VNC server, execute cmd.exe commands, download files. <br><br><h3>  Interaction between IcedID and CnC server </h3><br>  The list of CnC addresses is stored in the body of the banker in encrypted form, as well as in the registry in the form of a dynamic config.  The interaction between the server and the trojan is carried out using the HTTPS protocol.  Data is sent to the server by POST requests, using GET to get data. <br><br>  The server request string is as follows: <br><br><blockquote>  &lt;% CnC%&gt; /forum/viewtopic.php?a=&lt;%Integer%&gt;&amp;b=&lt;%Long integer%&gt; &amp; d = &lt;% Integer%&gt; &amp; e = &lt;% Integer%&gt; &amp; &lt;% Other data%&gt; </blockquote><br>  Field value: <br><br><ul><li>  a - type of request, this field can take values: <br><table><tbody><tr><th>  <nobr>Value</nobr> </th><th>  Act </th></tr><tr><td>  0.1 </td><td>  Send information about the infected machine </td></tr><tr><td>  2.3 </td><td>  Send other data to server </td></tr><tr><td>  four </td><td>  Get the latest version of dynamic configs and put them into the registry by key with the name <b>IcedID_reg ("* cfg1")</b> <br></td></tr><tr><td>  five </td><td>  Get the latest version of dynamic configs and put them into the registry by key with the name <b>IcedID_reg ("* cfg0")</b> <br></td></tr><tr><td>  6 </td><td>  Get the latest version of dynamic configs and put them into the registry by key with the name <b>IcedID_reg ("* rtd")</b> (CnC-addresses) <br></td></tr><tr><td>  7 </td><td>  Get the latest version of the VNC module </td></tr><tr><td>  eight </td><td>  Get the latest version of the bot </td></tr></tbody></table></li><li>  b - bot ID </li><li>  d - flag </li><li>  e - constant, located directly in the bot code </li></ul><br>  Further, the field values ‚Äã‚Äãdepend on the ‚Äúa‚Äù field.  If it is 0 or 1, then the request is as follows: <br><br><blockquote>  POST /forum/viewtopic.php?a=&lt;%0 or 1%&gt; &amp; b = &lt;% BotID%&gt; &amp; d = &lt;% Integer%&gt; &amp; e = &lt;% Constant%&gt; &amp; f = &lt;% Cfg1 Checksum%&gt; &amp; g = &lt;% Cfg0 Checksum%&gt; &amp; h = &lt;% Rtd Checksum%&gt; &amp; r = &lt;% VNC Checksum%&gt; &amp; i = &lt;% Request Time%&gt; HTTP / 1.1 <br>  Connection: close <br>  Content-Type: application / x-www-form-urlencoded <br>  Content-Length: </blockquote><br>  The request body contains information about the infected machine.  Information is provided in the form of: <br><br><blockquote>  k = &lt;% String%&gt; &amp; l = &lt;% String%&gt;% j = &lt;% Integer%&gt; &amp; n = &lt;% Integer%&gt; &amp; m = &lt;% String%&gt; </blockquote><br>  Where: <br><br><ul><li>  k - computer name in UNICODE </li><li>  l - domain member in UNICODE </li><li>  m - System Information: <br><ol><li>  OS version </li><li>  OS build number </li><li>  Service Pack Version </li><li>  System capacity </li><li>  OS type </li></ol></li></ul><br>  If the field is 2 or 3, then the request is as follows: <br><br><blockquote>  POST /forum/viewtopic.php?a=&lt;%3 or 2%&gt; &amp; b = &lt;% BotID%&gt; &amp; d = &lt;% Integer%&gt; &amp; e = &lt;% Constant%&gt; HTTP / 1.1 <br>  Connection: close <br>  Content-Type: application / octet-stream <br>  Content-Length: </blockquote><br>  Otherwise, the query looks like this: <br><br><blockquote>  GET /forum/viewtopic.php?a=&lt;%4-8%&gt;&amp;b=&lt;%BotID%&gt;&amp;d=&lt;%Integer%&gt;&amp;e=&lt;%Constant%&gt;&amp;o=&lt;%Object checksum%&gt; <br>  HTTP / 1.1 <br>  Connection: close <br><br>  Content-Type: application / x-www-form-urlencoded <br>  Content-Length: </blockquote><br>  Examples of requests are presented in the figures below.  Package header when accessing the server: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4t/yj/cw/4tyjcwlgccfqrer5fkblehqaza0.png" alt="image"></div><br>  Message body: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nx/iu/7r/nxiu7r72nmfovwhqcz85fdjwoga.png" alt="image"></div><br>  The trojan can receive commands from the server.  Commands are represented as integer values.  All commands come to the bot in the form of strings, the parameters of which are separated by the symbol ";".  The program can process 23 commands: <br><br><table><tbody><tr><th>  <nobr>Team</nobr> </th><th>  Value </th></tr><tr><td>  0 </td><td>  Does nothing (probably will be added in the future) <br></td></tr><tr><td>  one </td><td>  Update the value by registry key named <b>IcedID_reg ("* cfg0")</b> <br></td></tr><tr><td>  2 </td><td>  Update the value by registry key named <b>IcedID_reg ("* cfg1")</b> <br></td></tr><tr><td>  3 </td><td>  Update the value by registry key named <b>IcedID_reg ("* rtd")</b> <br></td></tr><tr><td>  four </td><td>  Download the file, save to the AppData directory and execute <br></td></tr><tr><td>  five </td><td>  Run the program, the name and the launch arguments come as parameters <br></td></tr><tr><td>  6 </td><td>  Get information about running processes, including: PID and process name <br></td></tr><tr><td>  7 </td><td>  Turn off the computer with the information, as function parameters: <br>  <b>SHTDN_REASON_FLAG_PLANNED</b> <b><br></b>  <b>SHTDN_REASON_MINOR_INSTALLATION</b> <b><br></b>  <b>SHTDN_REASON_MAJOR_APPLICATION</b> <br></td></tr><tr><td>  eight </td><td>  Write the value to the registry (the name is generated based on the algorithm described below) <br></td></tr><tr><td>  9 </td><td>  Read the value in the registry (the name is generated based on the algorithm described below) <br></td></tr><tr><td>  ten </td><td>  Delete the key from the registry (the name is generated based on the algorithm described below) <br></td></tr><tr><td>  eleven </td><td>  Run extended command processing module from server <br></td></tr><tr><td>  12 </td><td>  Stop the extended command processing module from the server <br></td></tr><tr><td>  13 </td><td>  Update VNC module (located in the% TEMP% directory) <br></td></tr><tr><td>  14 </td><td>  Get a list of files on the desktop of an infected device. <br></td></tr><tr><td>  15 </td><td>  Download the file, save it with the name <b>&lt;% String of random characters%&gt;. Tmp</b> and run it with the <b>\ u</b> key.  It seems that this command is necessary to update the version of the bot on the infected device. <br></td></tr><tr><td>  sixteen </td><td>  Delete the file whose name contains the string (comes as a parameter) <br></td></tr><tr><td>  17 </td><td>  Launch the network distribution module.  Distribution occurs by copying and running the bot in the Windows directory to another device using the LDAP protocol. <br></td></tr><tr><td>  18 </td><td>  Get bot log data <br></td></tr><tr><td>  nineteen </td><td>  Translate server access event to alarm state <br></td></tr><tr><td>  20 </td><td>  Get account data for the following applications: Windows Live Mail, Windows Mail, RimArts, Poco Systems Inc, IncrediMail, The Bat!  and Outlook <br></td></tr><tr><td>  21 </td><td>  Change the interval between accessing the server <br></td></tr><tr><td>  22 </td><td>  Get the path from the environment variable, download the file and save it along the path <br></td></tr><tr><td>  21 </td><td>  Upload the file to the AppData directory, run it with the <b>/ t = &lt;% Handle</b> parameters of the <b>specially generated event%&gt; / f = &lt;% Handle 2 of the specially generated event%&gt;</b> .  After the events are transferred to the alarm state, the downloaded file is deleted from the AppData directory. <br></td></tr></tbody></table><br>  If the command is executed successfully, the Trojan sends the string ‚ÄúTrue‚Äù to the server, otherwise ‚ÄúFalse‚Äù. <br><br>  In case of receiving a command to launch the module of extended commands, the application sends two bytes to the server, and then waits for a response.  The first byte received from the server corresponds to the extended command from the table: <br><br><table><tbody><tr><th>  <nobr>Team</nobr> </th><th>  Value </th></tr><tr><td>  five </td><td>  Start a stream that executes cmd.exe commands on an infected machine. <br></td></tr><tr><td>  6 </td><td>  Start the VNC server.  In the case under study, the VNC server was represented as a DLL, which had a similar string encryption algorithm. <br></td></tr><tr><td>  7 </td><td>  Execute the command from the table above.  To receive a normal command, the Trojan sends two characters to the server, notifying the server of readiness by accepting a command bot. <br></td></tr></tbody></table><br>  The VNC server can be started in two possible ways (depending on the internal flag): <br><br><ol><li>  Using the <b>CreateProcessA ()</b> function with the <b>rundll32.exe</b> parameter of <b>kernel32, Sleep -s &lt;% param%&gt;</b> </li><li>  Using the <b>CreateProcessA ()</b> function with the <b>svchost.exe -s &lt;% param%&gt;</b> parameter </li></ol><br>  where <b>&lt;% param%&gt;</b> is 16 bytes in string representation, fill in as follows: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4o/st/i2/4osti2buinqlg7gegp8decyoiio.png" alt="image"></div><br>  Immediately after launching, the VNC module checks the presence of the <b>-s</b> key, then reads the passed parameter, checks the condition: <br><pre><code class="cpp hljs">paramValue[<span class="hljs-number"><span class="hljs-number">0</span></span>] == paramValue[<span class="hljs-number"><span class="hljs-number">1</span></span>] ^ (paramValue[<span class="hljs-number"><span class="hljs-number">3</span></span>] | (paramValue[<span class="hljs-number"><span class="hljs-number">2</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span>))</code> </pre> <br>  and using the <b>DuplicateHandle ()</b> function creates a copy of the socket handle for further interaction with the server. <br><br>  The <b>StartupInfo</b> parameter of the <b>CreateProcessA ()</b> function contains the name of the specially generated Desktop'a: <b>Default &lt;% flag%&gt;</b> .  Also in the <b>ProcessInformation</b> parameter before calling the function is placed the address of the VNC module: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/na/fd/zu/nafdzutb3bptvxfmbis9ver33v8.png" alt="image"></div><br><br>  As you can see from the list, IcedID has a wide range of options for full control of an infected machine.  Even if the operator faces the problem of the absence of any function, he will simply load another program with the help of a trojan and perform the tasks set for him.  For example, at the end of December 2017, we recorded distribution with the help of this TrickBot banker. <br><br><h3>  Configuration Information </h3><br><h4>  Generating names for registry entries </h4><br>  All configuration data that the program receives from the server is stored in the registry of the infected device (with the exception of the VNC module, which is stored in the% TEMP% directory in the format <b>tmp% 0.8X01.dat</b> ). <br><br>  The names of registry keys that store the configuration data of interest to us are calculated using the following function: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/v5/bf/nj/v5bfnjuhkwpc3koekqfmclrrffk.png" alt="image"></div><br>  As can be seen from the figure, the key name is an MD5 hash value of two variables - <b>str</b> and <b>computerSeed</b> .  The value of the first variable determines what type of data is stored in the registry variable.  For example, if the value of the variable is <b>* cfg0</b> or <b>* cfg1,</b> the registry key stores Web injections, and if the value is <b>* rtd, the</b> key stores the CnC list. <br><br>  <b>computerSeed</b> is a unique user variable.  It is calculated on the basis of the user's SID.  The <a href="https://github.com/mResearch/research/blob/master/icedid_config.py">script</a> represents the python version of the calculation of this variable. <br><br>  Full path to configuration entries in the registry: <br><br><blockquote>  HKEY_CLASSES_ROOT \ CLSID \ &lt;% MD5 value in format: {% 0.8X-% 0.4X-% 0.4X-% 0.4X-% 0.4X% 0.8X}%&gt; <br></blockquote><br>  The algorithm described above is just the algorithm for generating the name <b>IcedID_reg ()</b> , which has been repeatedly mentioned above. <br><br>  We found the following string values ‚Äã‚Äãthat are involved in generating registry names important information for the banker: <br><br><ul><li>  <b>* cfg0</b> - contains a general list of Web injects </li><li>  <b>* cfg1</b> - contains a list of addresses and strings to completely steal page data </li><li>  <b>* rtd</b> - list of CnC addresses </li><li>  <b>* bc *</b> - notifies about the status of the extended command processing module from the server  If this entry is present in the registry, the module is running. </li><li>  <b>* p *</b> - saves startup parameters with <b>--svc =</b> and <b>/ w =</b> keys </li></ul><br><h4>  Structure of storage of dynamic configuration files </h4><br>  Dynamic configs are stored in the registry in encrypted form.  The VNC server, which is located in the% TEMP% of the directory, is encrypted in the same way. <br><br>  Two algorithms are used to encrypt data: the Trojan's own algorithm and RC4.  Decryption algorithm scheme: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/j8/2j/g8/j82jg8lcmeg3l9tv9cmge5erbbs.png" alt="image"></div><br>  Let's move from theory to practice.  Initially encrypted data after reading from the registry: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/q5/2f/7r/q52f7rrl9zsv9wqv9lf6anr9-hq.png" alt="image"></div><br>  After receiving the data, the malware decrypts it using its own algorithm: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ji/fx/ik/jifxik3og5ezrfp9wufshxhbc5k.png" alt="image"></div><br>  And we again meet the function <b>make_seed ()</b> ! <br><br>  After decryption, we have (note the addresses - it is decrypted in the same memory location): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ok/-1/ek/ok-1ek0zschromjam2tbv2am-um.png" alt="image"></div><br>  After the second decryption in memory, we see the following: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kx/ct/nb/kxctnbronnbv-hovhydbmqb9wx4.png" alt="image"></div><br>  After the data is unzipped and parted.  It is noteworthy that before the release of memory, data is encrypted back in RC4 - protection against dynamic analysis of the application. <br><br>  Further data structure depends on the type of configuration data.  For example, configuration data with the prefix <b>rtd</b> are stored in the format: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CNCStruct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> signedMD5sum[<span class="hljs-number"><span class="hljs-number">128</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> checksum; BStrings cnc[N]; } CNCStruct; <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BStrings</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> str[length]; } BStrings;</code> </pre><br>  A list of CnC addresses in one of the studies: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ne/xi/ta/nexitapjnsiyirmq7heoidb2jcw.png" alt="image"></div><br>  Before accessing the CnC addresses from the received list, the bot checks the digital signature.  The public key to verify the signature is stored in the body of the bot in encrypted form.  After the signature verification procedure, the application ‚Äúerases‚Äù the public key first with random data and then with zeros: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/oa/ns/tt/oansttaenay3ehss5praybpcenw.png" alt="image"></div><br>  Configurations with the <b>cfg</b> prefix are stored in the format: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CfgStruct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> checksum; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> elements_count; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> config[]; } CfgStruct;</code> </pre> <br>  In the case under study, we saw the following data: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/o3/wj/qp/o3wjqphnlymrn0yeydqqsxu8-ca.png" alt="image"></div><br>  Data is stored in a unique binary format, which will be discussed later. <br><br>  The algorithm for generating registry keys, as well as decrypting configuration data, you can see in the <a href="https://github.com/mResearch/research/blob/master/icedid_config.py">script</a> . <br><br><h4>  Algorithm for parsing configuration data </h4><br>  After decrypting the data, the program parses them and saves them as a linked list, which later participates in the analysis of traffic on the infected device (MITB).  First of all, the data is divided into blocks that have the structure: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseBlock</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> type; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> global_flag; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> data[size - <span class="hljs-number"><span class="hljs-number">6</span></span>]; } BaseBlock;</code> </pre> <br>  The structure of the <b>data</b> field depends on the <b>type</b> flag.  A flag in this structure indicates what happens when a string is found in the URL / body of the request.  The field can take the following values: <br><br><table><tbody><tr><th>  <nobr>Flag</nobr> </th><th>  Value </th></tr><tr><td>  0x10 </td><td>  Partial replacement of the page body, as parameters - tags, between which it is necessary to carry out the replacement, as well as the value by which the body will be replaced <br></td></tr><tr><td>  <nobr>0x11,0x13</nobr> </td><td>  Partial replacement of the page body, as parameters - part of the page to be replaced, as well as the value by which the body will be replaced <br></td></tr><tr><td>  0x12 </td><td>  Full body page replacement <br></td></tr><tr><td>  0x20 </td><td>  Theft of the page body.  As parameters - tags between which there is an interesting part of the page. </td></tr><tr><td>  0x21 </td><td>  Complete theft of the page body </td></tr><tr><td>  0x22 </td><td>  Complete theft of the page body, the body is stored in the registry </td></tr><tr><td>  0x2E </td><td>  Search in the body of the page of lines with tags 0x40 and 0x41, in case of detection - theft of the body of the page </td></tr><tr><td>  0x30 </td><td>  Blocking request </td></tr><tr><td>  0x31 </td><td>  Make screenshot page </td></tr><tr><td>  <nobr>0x32,0x33</nobr> </td><td>  Redirect to another page (page path is one of the parameters).  In addition, as a parameter, the string <b>&lt;% Registry Salt%&gt; # &lt;% URL%&gt;</b> , the bot accesses <b>&lt;% URL%&gt;</b> , loads data from there, and then saves it to the registry using the key <b>IcedID_reg (&lt;% Registry Salt%&gt;)</b> </td></tr><tr><td>  0x34 </td><td>  Redirect to another page (page path is one of the parameters) </td></tr><tr><td>  <nobr>0x40,0x41</nobr> </td><td>  String patterns in the body of the page </td></tr><tr><td>  0x51 </td><td>  Ignore page </td></tr><tr><td>  0x60 </td><td>  Save the value of the variable in the registry (replaces the body of the page to "True" or "False" depending on the result of the command, the name is generated based on the algorithm described above) </td></tr><tr><td>  0x61 </td><td>  Demonstrate a variable from the registry (the name is generated based on the algorithm described above) </td></tr><tr><td>  0x62 </td><td>  Delete the variable from the registry (replaces the body of the page with ‚ÄúTrue‚Äù or ‚ÄúFalse‚Äù depending on the result of the command, the name is generated based on the algorithm described above) </td></tr><tr><td>  0x63 </td><td>  Launch the extended command processing module from the server (replaces the body of the page with ‚ÄúTrue‚Äù or ‚ÄúFalse‚Äù depending on the result of the command execution) </td></tr><tr><td>  0x64 </td><td>  Save the page body to the bot's memory (replaces the page body with ‚ÄúTrue‚Äù or ‚ÄúFalse‚Äù depending on the result of the command execution) </td></tr></tbody></table>  The structure of the <b>data</b> field if <b>type</b> is 0x40 or 0x41: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConfigBlock</span></span></span><span class="hljs-class"> {</span></span> BStrings patterns[N]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); } ConfigBlock;</code> </pre> <br>  Otherwise the field structure: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseBlock</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> typeSizeStr; <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> urlStr; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> flagSize; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> flag[flagSize]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> firstOptStrSize; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> firstOptStr[firstOptStrSize]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> secondOptStrSize; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> secondOptStr[secondOptStrSize]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> thirdOptStrSize; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> thirdOptStr[thirdOptStrSize]; } BaseBlock;</code> </pre> <br>  Let's take a closer look at one of the sample blocks: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/k2/um/x_/k2umx_oc-ftptuundim8rft1yaw.png" alt="image"></div><br>  First of all we will pay attention to the ‚ÄúConfig block type‚Äù field in the ‚ÄúConfig block common information‚Äù block.  It is 0x11 - it means that when a user loads a page whose URL falls under the regular expression rule <b>^ [^ =] * \ / wcmfd \ / wcmpw \ / CustomerLogin $</b> , the body of the page will be replaced with the string <b>&lt;body</b> (second argument) for <b>&lt; body style = "display: none;"</b> (third argument). <br><br>  A coherent list is created in the application's memory for each type.  The Parsa algorithm for linked lists is shown in the figure below as an IDA Pro screen.  Python-script parsa configuration data you can see <a href="https://github.com/mResearch/research/blob/master/icedid_config.py">here</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/e9/5m/ke/e95mkeu6eqisfys7fnhe63fqvtg.png" alt="image"></div><br><h3>  CnC Information </h3><br>  For several months of monitoring the development of IcedID, we discovered many domains that the Trojan included in the list of dynamic configs in the CnC section.  We will represent domains as a correspondence (e-mail from which the registration ‚Üí domain took place): <br><table><tbody><tr><th>  <nobr>post office</nobr> </th><th>  Domains </th></tr><tr><td>  davidphugley@jourrapide.com </td><td>  percalabia.com <br>  borrespons.com <br>  divorough.com <br>  eyrannon.com <br>  britically.com <br></td></tr><tr><td>  joshuastaube@dayrep.com </td><td>  manismay.com <br>  deterhood.com <br>  marrivate.com <br>  greatoric.com <br>  phonetarif.com <br></td></tr><tr><td>  CynthiaTHeller@grr.la </td><td>  binncu.net </td></tr><tr><td>  PatriceAAdams@grr.la </td><td>  arcadyflyff.com </td></tr><tr><td>  LindaJRowan@dayrep.com </td><td>  yutlitsi.com </td></tr><tr><td>  SeanHumphreys@pokemail.net </td><td>  urnachay.com </td></tr><tr><td>  RuthFThigpen@pokemail.net </td><td>  oksigur.net </td></tr><tr><td>  FlorenceTButler@pokemail.net </td><td>  rfisoty.com </td></tr><tr><td>  FreidaDDelgado@pokemail.net </td><td>  urnisim.net </td></tr><tr><td>  TinaLHobson@grr.la </td><td>  cupicratings.com </td></tr><tr><td>  ElisaRTucker@pokemail.net </td><td>  freegameshacks.net </td></tr><tr><td>  DaleKMontes@pokemail.net </td><td>  gordondeen.net </td></tr><tr><td>  patrickggutierez@dayrep.com </td><td>  poorloo.com <br>  dismissey.com <br>  euphratt.com <br>  detrole.com <br></td></tr><tr><td>  JustineRBoatner@pokemail.net </td><td>  lumpyve.com </td></tr><tr><td>  MatthewAPerkins@grr.la </td><td>  gooblesooq.com <br>  fzlajsf.net <br></td></tr><tr><td>  JosephLSmith@grr.la </td><td>  newpctoday.com <br>  triodgt.com <br></td></tr><tr><td>  DominicNDecker@pokemail.net </td><td>  onsunga.net </td></tr><tr><td>  MarcellaBCraighead@pokemail.net </td><td>  rybatas.com </td></tr><tr><td>  KellyJMaldonado@grr.la </td><td>  netocraze.net <br>  irtazin.net <br></td></tr></tbody></table><br>  Let's now take a closer look at the users to which domains have been registered: <br><br><div class="spoiler">  <b class="spoiler_title">Information about registrants</b> <div class="spoiler_text">  Mail <b>davidphugley@jourrapide.com</b> : <br><br><ul><li>  Registrar: PDR Ltd.  d / b / a PublicDomainRegistry.com </li><li>  Name: David P. Hugley (registrant, admin, tech) </li><li>  Street: 2453 Round Table Drive (registrant, admin, tech) </li><li>  City: Hamilton (registrant, admin, tech) </li><li>  State: Ohio (registrant, admin, tech) </li><li>  Postal: 45011 (registrant, admin, tech) </li><li>  Country: US (registrant, admin, tech) </li><li>  Phone: 15138878784 (registrant, admin, tech) </li></ul><br>  Mail <b>joshuastaube@dayrep.com</b> : <br><br><ul><li>  Registrar: PDR Ltd.  d / b / a PublicDomainRegistry.com </li><li>  Name: Joshua S. Taube (registrant, admin, tech) </li><li>  Organization: </li><li>  Street: 2173 Kyle Street (registrant, admin, tech) </li><li>  City: Hay Springs (registrant, admin, tech) </li><li>  State: Nevada (registrant, admin, tech) </li><li>  Postal: 69347 (registrant, admin, tech) </li><li>  Country: US (registrant, admin, tech) </li><li>  Phone: 13086385612 (registrant, admin, tech) </li></ul><br>  Mail <b>CynthiaTHeller@grr.la</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Cynthia Heller (registrant, admin, billing, tech) </li><li>  Organization: </li><li>  Street: 396 Tennessee Avenue (registrant, admin, billing, tech) </li><li>  City: Southfield (registrant, admin, billing, tech) </li><li>  State: MX (registrant, admin, billing, tech) </li><li>  Postal: 48034 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 12482469621 (registrant, admin, billing, tech) </li></ul><br>  Mail <b>PatriceAAdams@grr.la</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Patrice Adams (registrant, admin, billing, tech) </li><li>  Organization </li><li>  Street: 3997 Marietta Street (registrant, admin, billing, tech) </li><li>  City: Cazadero (registrant, admin, billing, tech) </li><li>  State: JL (registrant, admin, billing, tech) </li><li>  Postal: 95421 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 17076322681 (registrant, admin, billing, tech) </li></ul><br>  Mail <b>LindaJRowan@dayrep.com</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Linda Rowan (registrant, admin, billing, tech) </li><li>  Organization: </li><li>  Street: 1908 Luke Lane (registrant, admin, billing, tech) </li><li>  City: Elk City (registrant, admin, billing, tech) </li><li>  State: EK (registrant, admin, billing, tech) </li><li>  Postal: 73644 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 15802259140 (registrant, admin, billing, tech) </li></ul><br>  Mail <b>SeanHumphreys@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Sean Humphreys (registrant, admin, billing, tech) </li><li>  Organization: </li><li>  Street: 4661 Kincheloe Road (registrant, admin, billing, tech) </li><li>  City: Portland (registrant, admin, billing, tech) </li><li>  State: EL (registrant, admin, billing, tech) </li><li>  Postal: 97205 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 16384273711 (registrant, admin, billing, tech) </li></ul><br>  Mail <b>RuthFThigpen@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Ruth Thigpen (registrant, admin, billing, tech) </li><li>  Organization </li><li>  Street: 765 Michael Street (registrant, admin, billing, tech) </li><li>  City: Houston (registrant, admin, billing, tech) </li><li>  State: DK (registrant, admin, billing, tech) </li><li>  Postal: 77021 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 17137485876 (registrant, admin, billing, tech) </li></ul><br>  Email <b>FlorenceTButler@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Florence Butler (registrant, admin, billing, tech) </li><li>  Organization: </li><li>  Street: 4554 Par Drive (registrant, admin, billing, tech) </li><li>  City: Lompoc (registrant, admin, billing, tech) </li><li>  State: JL (registrant, admin, billing, tech) </li><li>  Postal: 93436 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 198058660048 (registrant, admin, billing, tech) </li></ul><br>  Mail <b>FreidaDDelgado@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Freida Delgado (registrant, admin, billing, tech) </li><li>  Organization: </li><li>  Street: 4439 Burning Memory Lane (registrant, admin, billing, tech) </li><li>  City: Philadelphia (registrant, admin, billing, tech) </li><li>  State: BX (registrant, admin, billing, tech) </li><li>  Postal: 19115 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 12153306416 (registrant, admin, billing, tech) </li></ul><br>  Mail <b>TinaLHobson@grr.la</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Tina Hobson (registrant, admin, billing, tech) </li><li>  Organization: </li><li>  Street: 3960 Woodridge Lane (registrant, admin, billing, tech) </li><li>  City: Memphis (registrant, admin, billing, tech) </li><li>  State: TN (registrant, admin, billing, tech) </li><li>  Postal: 38110 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 19012994734 (registrant, admin, billing, tech) </li></ul><br>  <b>ElisaRTucker@pokemail.net</b> Mail: <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Elisa Tucker (registrant, admin, billing, tech) </li><li>  Organization </li><li>  Street: 3316 Corbin Branch Road (registrant, admin, billing, tech) </li><li>  City: Johnson City (registrant, admin, billing, tech) </li><li>  State: TN (registrant, admin, billing, tech) </li><li>  Postal: 37601 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 14234332211 (registrant, admin, billing, tech) </li></ul><br>  Mail <b>DaleKMontes@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Dale Montes (registrant, admin, billing, tech) </li><li>  Organization: </li><li>  Street: 2719 Norman Street (registrant, admin, billing, tech) </li><li>  City: Los Angeles (registrant, admin, billing, tech) </li><li>  State: JL (registrant, admin, billing, tech) </li><li>  Postal: 90008 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 13232919311 (registrant, admin, billing, tech) </li></ul><br>  Email <b>patrickggutierez@dayrep.com</b> : <br><br><ul><li>  Registrar: PDR Ltd.  d / b / a PublicDomainRegistry.com </li><li>  Name: Patrick G. Gutierez (registrant, admin, tech) </li><li>  Organization: </li><li>  Street: 1146 Mount Olive Road (registrant, admin, tech) </li><li>  City: Atlanta (registrant, admin, tech) </li><li>  State: Georgia (registrant, admin, tech) </li><li>  Postal: 30328 (registrant, admin, tech) </li><li>  Country: US (registrant, admin, tech) </li><li>  Phone: 16789874672 (registrant, admin, tech) </li></ul><br>  <b>JustineRBoatner@pokemail.net</b> Mail: <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Justine Boatner (registrant, admin, billing, tech) </li><li>  Organization: </li><li>  Street: 2875 Kemper Lane (registrant, admin, billing, tech) </li><li>  City: Kearns (registrant, admin, billing, tech) </li><li>  State: YT (registrant, admin, billing, tech) </li><li>  Postal: 84118 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 18019026902 (registrant, admin, billing, tech) </li></ul><br>  Mail <b>MatthewAPerkins@grr.la</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Matthew Perkins (registrant, admin, billing, tech) </li><li>  Organization: </li><li>  Street: 2507 Locust Street (registrant, admin, billing, tech) </li><li>  City: Ellaville (registrant, admin, billing, tech) </li><li>  State: QZ (registrant, admin, billing, tech) </li><li>  Postal: 31806 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 12299379022 (registrant, admin, billing, tech) </li></ul><br>  <b>JosephLSmith@grr.la</b> Mail: <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Joseph Smith (registrant, admin, billing, tech) </li><li>  Organization: </li><li>  Street: 2808 Ruckman Road (registrant, admin, billing, tech) </li><li>  City: Oklahoma City (registrant, admin, billing, tech) </li><li>  State: EK (registrant, admin, billing, tech) </li><li>  Postal: 73102 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 14058506091 (registrant, admin, billing, tech) </li></ul><br>  Mail <b>DominicNDecker@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Dominic Decker (registrant, admin, billing, tech) </li><li>  Organization: </li><li>  Street: 1169 Golden Ridge Road (registrant, admin, billing, tech) </li><li>  City: Gloversville (registrant, admin, billing, tech) </li><li>  State: NY (registrant, admin, billing, tech) </li><li>  Postal: 12078 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 15187485876 (registrant, admin, billing, tech) </li></ul><br>  Mail <b>MarcellaBCraighead@pokemail.net</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Marcella Craighead (registrant, admin, billing, tech) </li><li>  Organization: </li><li>  Street: 1659 Lilac Lane (registrant, admin, billing, tech) </li><li>  City: Savannah (registrant, admin, billing, tech) </li><li>  State: QZ (registrant, admin, billing, tech) </li><li>  Postal: 31401 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 19125956971 (registrant, admin, billing, tech) </li></ul><br>  Mail <b>KellyJMaldonado@grr.la</b> : <br><br><ul><li>  Registrar: Eranet International Limited </li><li>  Name: Kelly Maldonado (registrant, admin, billing, tech) </li><li>  Organization: NA </li><li>  Street: 4391 Ben Street (registrant, admin, billing, tech) </li><li>  City: Albany (registrant, admin, billing, tech) </li><li>  State: NY (registrant, admin, billing, tech) </li><li>  Postal: 12207 (registrant, admin, billing, tech) </li><li>  Country: US (registrant, admin, billing, tech) </li><li>  Phone: 15182623616 (registrant, admin, billing, tech) </li></ul><br></div></div><br>  Finally, consider the chronology of changes in the IP addresses of domains.  All IP addresses have been added to the table since November 2017: <br><br><div class="spoiler">  <b class="spoiler_title">IP address table</b> <div class="spoiler_text"><table><tbody><tr><th>  Domain </th><th>  IP </th><th>  Country </th><th>  First seen in the wild </th></tr><tr><td>  gooblesooq.com </td><td>  185.127.26.227 </td><td>  Ru </td><td>  11/7/2017 </td></tr><tr><td>  irtazin.net </td><td>  185.127.26.227 </td><td>  Ru </td><td>  11/7/2017 </td></tr><tr><td>  netocraze.net </td><td>  185.5.251.33 </td><td>  Ru </td><td>  11/7/2017 </td></tr><tr><td>  triodgt.com </td><td>  185.5.251.33 </td><td>  Ru </td><td>  11/7/2017 </td></tr><tr><td>  newpctoday.com </td><td>  185.5.251.33 </td><td>  Ru </td><td>  11/7/2017 </td></tr><tr><td>  fzlajsf.net </td><td>  185.127.26.227 </td><td>  Ru </td><td>  11/25/2017 </td></tr><tr><td>  netocraze.net </td><td>  185.48.56.139 </td><td>  NL </td><td>  11/27/2017 </td></tr><tr><td>  triodgt.com </td><td>  185.48.56.139 </td><td>  NL </td><td>  11/27/2017 </td></tr><tr><td>  newpctoday.com </td><td>  185.48.56.139 </td><td>  NL </td><td>  11/29/2017 </td></tr><tr><td>  netocraze.net </td><td>  185.22.65.17 </td><td>  KZ </td><td>  12/1/2017 </td></tr><tr><td>  triodgt.com </td><td>  185.22.65.17 </td><td>  KZ </td><td>  12/1/2017 </td></tr><tr><td>  newpctoday.com </td><td>  185.22.65.17 </td><td>  KZ </td><td>  12/1/2017 </td></tr><tr><td>  gordondeen.net </td><td>  185.127.26.227 </td><td>  Ru </td><td>  12/11/2017 </td></tr><tr><td>  netocraze.net </td><td>  46.148.26.106 </td><td>  UA </td><td>  12/11/2017 </td></tr><tr><td>  arcadyflyff.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  12/12/2017 </td></tr><tr><td>  cupicratings.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  12/12/2017 </td></tr><tr><td>  freegameshacks.net </td><td>  185.127.26.227 </td><td>  Ru </td><td>  12/12/2017 </td></tr><tr><td>  newpctoday.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  12/13/2018 </td></tr><tr><td>  onsunga.net </td><td>  107.150.99.20 </td><td>  CN </td><td>  12/17/2017 </td></tr><tr><td>  oksigur.net </td><td>  107.150.99.20 </td><td>  CN </td><td>  12/17/2017 </td></tr><tr><td>  rfisoty.com </td><td>  107.150.99.20 </td><td>  CN </td><td>  12/17/2017 </td></tr><tr><td>  rybatas.com </td><td>  107.150.99.20 </td><td>  CN </td><td>  12/17/2017 </td></tr><tr><td>  urnachay.com </td><td>  107.150.99.20 </td><td>  CN </td><td>  12/17/2017 </td></tr><tr><td>  rfisoty.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  1/24/2018 </td></tr><tr><td>  rybatas.com </td><td>  185.127.26.227 </td><td>  Ru </td><td>  1/24/2018 </td></tr><tr><td>  urnachay.com </td><td>  185.127.26.227 </td><td>  Ru </td><td>  1/24/2018 </td></tr><tr><td>  yutlitsi.com </td><td>  185.127.26.227 </td><td>  Ru </td><td>  1/24/2018 </td></tr><tr><td>  urnisim.net </td><td>  185.127.26.227 </td><td>  Ru </td><td>  1/24/2018 </td></tr><tr><td>  oksigur.net </td><td>  185.127.26.227 </td><td>  Ru </td><td>  1/26/2018 </td></tr><tr><td>  urnachay.com </td><td>  109.234.35.121 </td><td>  Ru </td><td>  1/31/2018 </td></tr><tr><td>  oksigur.net </td><td>  109.234.35.121 </td><td>  Ru </td><td>  1/31/2018 </td></tr><tr><td>  yutlitsi.com </td><td>  109.234.35.121 </td><td>  Ru </td><td>  2/1/2018 </td></tr><tr><td>  urnisim.net </td><td>  109.234.35.121 </td><td>  Ru </td><td>  2/1/2018 </td></tr><tr><td>  divorough.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  2/21/2018 </td></tr><tr><td>  percalabia.com </td><td>  109.234.35.121 </td><td>  Ru </td><td>  2/22/2018 </td></tr><tr><td>  borrespons.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  2/26/2018 </td></tr><tr><td>  britically.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  2/26/2018 </td></tr><tr><td>  eyrannon.com </td><td>  109.234.35.121 </td><td>  Ru </td><td>  2/26/2018 </td></tr><tr><td>  deterhood.com </td><td>  109.234.35.121 </td><td>  Ru </td><td>  3/1/2018 </td></tr><tr><td>  greatoric.com </td><td>  109.234.35.121 </td><td>  Ru </td><td>  3/1/2018 </td></tr><tr><td>  manismay.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  3/1/2018 </td></tr><tr><td>  marrivate.com </td><td>  109.234.35.121 </td><td>  Ru </td><td>  3/1/2018 </td></tr><tr><td>  moindal.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  3/1/2018 </td></tr><tr><td>  phonetarif.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  3/1/2018 </td></tr><tr><td>  moindal.com </td><td>  185.169.229.119 </td><td>  CH </td><td>  3/5/2018 </td></tr><tr><td>  dismissey.com </td><td>  46.148.26.106 </td><td>  UA </td><td>  4/3/2018 </td></tr><tr><td>  euphratt.com </td><td>  109.234.35.121 </td><td>  Ru </td><td>  4/4/2018 </td></tr><tr><td>  percalabia.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  4/23/2018 </td></tr><tr><td>  deterhood.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  4/24/2018 </td></tr><tr><td>  eyrannon.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  4/24/2018 </td></tr><tr><td>  greatoric.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  4/24/2018 </td></tr><tr><td>  marrivate.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  4/24/2018 </td></tr><tr><td>  euphratt.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  4/25/2018 </td></tr><tr><td>  borrespons.com </td><td>  185.48.56.134 </td><td>  NL </td><td>  5/7/2018 </td></tr><tr><td>  britically.com </td><td>  185.48.56.134 </td><td>  NL </td><td>  5/7/2018 </td></tr><tr><td>  dismissey.com </td><td>  185.48.56.134 </td><td>  NL </td><td>  5/7/2018 </td></tr><tr><td>  divorough.com </td><td>  185.48.56.134 </td><td>  NL </td><td>  5/7/2018 </td></tr><tr><td>  rfisoty.com </td><td>  185.48.56.134 </td><td>  NL </td><td>  5/7/2018 </td></tr><tr><td>  detrole.com </td><td>  109.236.87.25 </td><td>  NL </td><td>  5/8/2018 </td></tr><tr><td>  manismay.com </td><td>  185.48.56.134 </td><td>  NL </td><td>  5/8/2018 </td></tr><tr><td>  phonetarif.com </td><td>  185.48.56.134 </td><td>  NL </td><td>  5/13/2018 </td></tr><tr><td>  binncu.net </td><td>  46.148.26.106 </td><td>  UA </td><td>  5/17/2018 </td></tr><tr><td>  urnisim.net </td><td>  46.148.26.11 </td><td>  UA </td><td>  5/17/2018 </td></tr><tr><td>  urnachay.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  5/18/2018 </td></tr><tr><td>  yutlitsi.com </td><td>  46.148.26.11 </td><td>  UA </td><td>  5/18/2018 </td></tr><tr><td>  oksigur.net </td><td>  46.148.26.11 </td><td>  UA </td><td>  5/21/2018 </td></tr><tr><td>  greatoric.com </td><td>  5.187.0.158 </td><td>  DE </td><td>  5/22/2018 </td></tr><tr><td>  marrivate.com </td><td>  5.187.0.158 </td><td>  DE </td><td>  5/22/2018 </td></tr><tr><td>  percalabia.com </td><td>  5.187.0.158 </td><td>  DE </td><td>  5/22/2018 </td></tr><tr><td>  urnachay.com </td><td>  5.187.0.158 </td><td>  DE </td><td>  5/22/2018 </td></tr><tr><td>  yutlitsi.com </td><td>  5.187.0.158 </td><td>  DE </td><td>  5/22/2018 </td></tr><tr><td>  lumpyve.com </td><td>  185.48.56.134 </td><td>  NL </td><td>  5/24/2018 </td></tr><tr><td>  urnisim.net </td><td>  5.187.0.158 </td><td>  DE </td><td>  5/27/2018 </td></tr><tr><td>  borrespons.com </td><td>  85.143.202.82 </td><td>  Ru </td><td>  6/7/2018 </td></tr><tr><td>  manismay.com </td><td>  85.143.202.82 </td><td>  Ru </td><td>  6/7/2018 </td></tr><tr><td>  phonetarif.com </td><td>  85.143.202.82 </td><td>  Ru </td><td>  6/7/2018 </td></tr><tr><td>  rfisoty.com </td><td>  85.143.202.82 </td><td>  Ru </td><td>  6/7/2018 </td></tr><tr><td>  borrespons.com </td><td>  212.83.61.213 </td><td>  DE </td><td>  6/20/2018 </td></tr><tr><td>  manismay.com </td><td>  212.83.61.213 </td><td>  DE </td><td>  6/20/2018 </td></tr><tr><td>  rfisoty.com </td><td>  212.83.61.213 </td><td>  DE </td><td>  6/20/2018 </td></tr><tr><td>  lumpyve.com </td><td>  212.83.61.213 </td><td>  DE </td><td>  6/20/2018 </td></tr><tr><td>  phonetarif.com </td><td>  212.83.61.213 </td><td>  DE </td><td>  6/20/2018 </td></tr></tbody></table><br></div></div><br>  Having studied the submitted data, it can be summarized that all domains are registered to mail generated by the temporary mail service.  The location of the fictitious registrant is the United States, while the domains themselves are located in Russia, Ukraine, the Netherlands, China, Kazakhstan and Germany (recently there has been a trend of ‚Äúmoving‚Äù domains to Ukraine and Germany).  All domains are in the domain zones "com" and "net".  The alphabet of which the domain is composed includes only letters of the English alphabet.  On the CnC side, the OpenResty Web server is raised. <br><br><h2>  Conclusion </h2><br>  Despite the "antiquity" of Zeus-like Trojans, their relevance does not fall.  As a result - the emergence of IcedID in the arena of Trojans aimed at customers of banks.  Although the banker already at the start had an extensive list of possibilities, it is still being improved: the methods of unpacking become more complicated, the list of goals expands.  Most likely, in the future, the malicious program will acquire anti-analysis mechanisms, and the CnC server will selectively give out Web injections to infected devices.  In the meantime, the Trojan does not satisfy all the requirements of its ‚Äúusers‚Äù, as evidenced by the use of TrickBot in December last year together with IcedID. </div><p>Source: <a href="https://habr.com/ru/post/418189/">https://habr.com/ru/post/418189/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../418177/index.html">Editing .heic images without losing colors</a></li>
<li><a href="../418181/index.html">Roskomnadzor re-blocked the Hideme.ru VPN service. The site again moved to a new address.</a></li>
<li><a href="../418183/index.html">The use of speech analytics in business</a></li>
<li><a href="../418185/index.html">The story of one autopsy: how we reversed Hancitor</a></li>
<li><a href="../418187/index.html">In America, they suggested replacing all libraries with Amazon hubs. The public is indignant</a></li>
<li><a href="../418191/index.html">Analogs in Python and JavaScript. Part three</a></li>
<li><a href="../418193/index.html">How does it feel to create a game for Game Boy in 2017</a></li>
<li><a href="../418195/index.html">MIT course "Computer Systems Security". Lecture 4: "Separation of privileges", part 1</a></li>
<li><a href="../418197/index.html">MIT course "Computer Systems Security". Lecture 4: "Separation of privileges", part 2</a></li>
<li><a href="../418199/index.html">How to make a simple technical task and not lose money and nerves</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>