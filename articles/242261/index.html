<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Effective Django. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuing to translate articles on Django from effectivedjango.com . I stumbled upon this site while studying this framework. The information posted ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Effective Django. Part 2</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/364/751/01a/36475101ad10426197c121e865900197.png"></div><br>  <em>Continuing to translate articles on Django from <a href="http://effectivedjango.com/">effectivedjango.com</a> .</em>  <em>I stumbled upon this site while studying this framework.</em>  <em>The information posted on this resource seemed useful to me, but since I did not find a translation into Russian anywhere, I decided to do this good deed myself.</em>  <em>This cycle of articles, I think, will be useful for web developers who are only taking the first steps in learning Django.</em> <br><a name="habracut"></a><br><hr><br><a name="contents"></a><h1>  Table of contents </h1><ul><li>  <a href="http://habrahabr.ru/post/240463/">Introduction</a> </li><li>  Effective Django.  Manual <br><ul><li>  <a href="http://habrahabr.ru/post/240463/">Chapter 1. Getting Started</a> </li><li>  <a href="http://habrahabr.ru/post/240463/">Chapter 2. Using the model</a> </li><li>  <a href="https://habr.com/ru/post/242261/">Chapter 3. We write a presentation</a> </li><li>  <a href="https://habr.com/ru/post/242261/">Chapter 4. Using Static Resources</a> </li><li>  Chapter 5. Additional Basic Views </li><li>  Chapter 6. Form Basics </li><li>  Chapter 7. Related Models </li><li>  Chapter 8. Authentication and Authorization Processing </li></ul></li><li>  Testing in Django </li><li>  Understanding Middlewares </li><li>  Databases and Models </li><li>  Representation Classes (CBV) </li><li>  Forms </li></ul><br><a name="chapter_03"></a><h1>  Chapter 3. Writing a presentation <a href="https://habr.com/ru/post/242261/" title="to contents">‚áß</a> </h1><br><h2>  3.1.  Basics of ideas </h2><br>  Django views get an <abbr title="HTTP Request"><a href="&amp;xid=17259,15700022,15700186,15700190,15700253&amp;usg=ALkJrhgL9UKF5ASg1j8_fotXC6PsgHoSdQ#">HTTP request</a></abbr> and return an <abbr title="HTTP Response"><a href="&amp;xid=17259,15700022,15700186,15700190,15700253&amp;usg=ALkJrhgL9UKF5ASg1j8_fotXC6PsgHoSdQ#">HTTP response to the</a></abbr> user: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/e3a/ab7/63e/e3aab763e8e64329b0ac903fd7c22fe4.png"></div><br>  Any Python object called can be a representation.  The only <abbr title="hard and fast">strict and necessary</abbr> requirement is that the Python object being called must accept <abbr title="request object">the request object</abbr> as the first argument (usually this parameter is called ‚Äú <code>request</code> ).  This means that the minimum representation will be very simple: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.http <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HttpResponse <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hello_world</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(request)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> HttpResponse(<span class="hljs-string"><span class="hljs-string">"Hello, World"</span></span>)</code> </pre><br>  Of course, like most other frameworks, Django allows you to pass arguments to a view via a URL.  We will talk about this when we build our application. <br><br><h2>  3.2.  <abbr title="generic">General</abbr> views and <abbr title="class-based views">class views</abbr> </h2><br><ul><li>  <a href="https://docs.djangoproject.com/en/1.7/topics/class-based-views/generic-display/">General views</a> always provide some basic functionality: <abbr title="render">visualize a</abbr> template, redirect, create, edit a model, etc. </li><li>  since version 1.3, for general views in Django, <abbr title="class-based views"><a href="https://docs.djangoproject.com/en/1.7/topics/class-based-views/">class-views</a></abbr> (CBV) have appeared; </li><li>  general views and CBV provide a higher level of abstraction and composability; </li><li>  besides, they hide quite a bit of complexity that might otherwise confuse newbies; </li><li>  Fortunately, in the new versions of Django, the documentation of all this has become much better. </li></ul><br>  Django 1.3 introduces class views that we will focus on in this chapter.  Class views, or CBVs, can eliminate a lot of template code from your views, especially from views for editing something where you want to take different actions for GET and POST requests.  Representations classes will give you the opportunity to assemble the functionality in parts.  The disadvantage is that all this power entails some additional complication. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  3.3.  Representation Classes (CBV) </h2><br>  The minimal representation, implemented as CBV, is derived from the <code>View</code> <sup><a href="https://docs.djangoproject.com/en/1.7/ref/class-based-views/base/">doc</a></sup> class and implements the supported HTTP methods.  Below is a very small representation of ‚ÄúHello, World‚Äù written by us earlier, but executed as a class-representation: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.http <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HttpResponse <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.views.generic <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> View <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyView</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(View)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, request, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> HttpResponse(<span class="hljs-string"><span class="hljs-string">"Hello, World"</span></span>)</code> </pre><br>  In class view, HTTP method names are mapped to class methods.  In our case, we defined a handler for a GET request using the <code>get</code> class method.  In the same way as when implemented by a function, this method takes the request object as the first parameter and returns an HTTP response. <br><br><blockquote>  <b><u>Note:</u> <abbr title="Permissive Signatures">Valid Signatures</abbr></b> <br>  You may notice several additional arguments in the function signature compared to the representation we wrote earlier, in particular <code>*args</code> and <code>**kwargs</code> .  CBVs were first created to make Django‚Äôs ‚Äúgeneric‚Äù representations more flexible.  The implication was that they would be used in a variety of different contexts, with potentially different arguments extracted from the URL.  Being engaged in the last year of writing class representations, I continue to write them using valid signatures, and each time this turns out to be useful in unexpected situations. </blockquote><br><h2>  3.4.  Display a list of contacts </h2><br>  We will start with a view that displays a list of contacts from the database. <br><br>  The basic implementation of the view is very short.  We can write it all in just a few lines.  To do this, in the <code>views.py</code> file of our <code>contacts</code> application, type the following code: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.views.generic <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ListView <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> contacts.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Contact <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ListContactView</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(ListView)</span></span></span><span class="hljs-class">:</span></span> model = Contact</code> </pre><br>  The <code>ListView</code> <sup><a href="https://docs.djangoproject.com/en/1.7/ref/class-based-views/generic-display/">doc</a></sup> class, from which we inherited the view, is itself composed of several <abbr title="mixins">impurities</abbr> that implement some behavior.  This gives us great power with a small amount of code.  In our case, we specified a model ( <code>model = Contact</code> ), which will force this view to list <u>all</u> contacts of the <code>Contact</code> model from our database. <br><br><h2>  3.5.  Define URLs </h2><br>  The URL configuration (URLconf) tells Django how to find your Python code at the request address.  Django looks for a URL configuration that is defined in the <code>urlpatterns</code> variable of the <code>urlpatterns</code> file. <br><br>  Let's add to the <code>addressbook/urls.py</code> URL template for our view that displays a list of contacts: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.conf.urls <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> patterns, include, url <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> contacts.views urlpatterns = patterns(<span class="hljs-string"><span class="hljs-string">''</span></span>, url(<span class="hljs-string"><span class="hljs-string">r'^$'</span></span>, contacts.views.ListContactView.as_view(), name=<span class="hljs-string"><span class="hljs-string">'contacts-list'</span></span>,), )</code> </pre><br><ul><li>  using the <code>url()</code> function is not strictly required, but I prefer to use it: when you start adding more information to URL patterns, it will allow you to use named parameters, making the code more clean; </li><li>  The first parameter accepted by the function <code>url()</code> is a regular expression.  Notice the trailing character <code>$</code> ;  Why do you think it is important? </li><li>  the second parameter is the called view.  This can be either a directly called object (manually imported) or a string describing it.  If it is a string, then if the URL pattern matches the query string, Django itself imports the required module (up to the last point), and will call the last segment of the line (after the last dot); </li><li>  Note that when we use a class view, we <u>are obliged to</u> use a real object, and not a string describing this object.  We have to do this because we call the class method <code>as_view()</code> .  This method returns a wrapper over our class that the Django URL Manager can call; </li><li>  the name given to the URL pattern will allow you to do a <abbr title="reverse lookup">reverse search</abbr> ; </li><li>  A URL name is useful when you are linking from one view to another, or redirecting, since you can manage the structure of URLs from one place. </li></ul><br>  While the <code>urlpatterns</code> variable must be defined, Django also allows you to define several other values ‚Äã‚Äã( <em>variables</em> ) for exceptions.  These values ‚Äã‚Äãinclude <code>handler403</code> , <code>handler404</code> , and <code>handler500</code> , which tell Django which view to use in case of an HTTP error.  For more information, see the <a href="https://docs.djangoproject.com/en/1.7/ref/urls/">Django</a> URL configuration <a href="https://docs.djangoproject.com/en/1.7/ref/urls/">documentation</a> . <br><br><blockquote>  <b><u>Note:</u> Error importing URL configuration</b> <br>  Django loads the URL configuration very early during startup and tries to import modules found inside.  If at least one of the import operations fails, the error message may be a little confusing.  If your project has stopped working due to an import error, try importing the URL configuration in an interactive shell.  This allows, in most cases, to determine where the problem occurred. </blockquote><br><h2>  3.6.  Creating a Template </h2><br>  Now, by defining the URL for our contact list view, we can try it.  Django includes a server suitable for development purposes, which you can use to test your project: <br><br><pre> <code class="hljs cs">(venv:tutorial)$ python ./manage.py runserver <span class="hljs-number"><span class="hljs-number">0.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>:<span class="hljs-number"><span class="hljs-number">8080</span></span> Validating models... <span class="hljs-number"><span class="hljs-number">0</span></span> errors found November <span class="hljs-number"><span class="hljs-number">04</span></span>, <span class="hljs-number"><span class="hljs-number">2014</span></span> - <span class="hljs-number"><span class="hljs-number">15</span></span>:<span class="hljs-number"><span class="hljs-number">25</span></span>:<span class="hljs-number"><span class="hljs-number">05</span></span> Django version <span class="hljs-number"><span class="hljs-number">1.6</span></span><span class="hljs-number"><span class="hljs-number">.7</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> settings <span class="hljs-string"><span class="hljs-string">'addressbook.settings'</span></span> Starting development server at http:<span class="hljs-comment"><span class="hljs-comment">//0.0.0.0:8080/ Quit the server with CONTROL-C.</span></span></code> </pre><br>  If you visit <a href="http://localhost:8080/">http: // localhost: 8080 /</a> in your browser, you still get a <code>TemplateDoesNotExists</code> error <br><blockquote>  <em><u>Translator's Note:</u></em> <br>  <em><code>localhost</code> if you start the browser from the same host where the server is running.</em>  <em>If your server is running on another host (like mine) - instead of <code>localhost</code> specify the IP address of this host (in my case it is <code>192.168.1.51</code> ).</em> </blockquote><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/files/939/e01/661/939e01661f7c4246a95f71216d9776b7.png"></a> </div><br>  Most of the common Django views (here, the <code>ListView</code> we used) have a predefined template name that they expect to find.  We can see in this error message that the view expected to find a template file named <code>contact_list.html</code> , which was derived from the model name.  Let's create such a template. <br><br>  By default, Django searches for templates in applications, as well as in the directories specified in <code>settings.TEMPLATE_DIRS</code> .  General views expect patterns to be found in the application directory (in this case, in the <code>contacts</code> directory), and the file name will contain the model name (in this case, the expected file name: <code>contact_list.html</code> ).  This comes in handy when you develop applications for reuse: the user of your application can create their own templates that will override the default templates and they will be stored in a directory directly associated with the application. <br><br><blockquote>  <em><u>Translator's Note:</u></em> <br>  <em>Django expects the template to be located at <code>_/templates/_/_</code></em> </blockquote><br>  For our purposes, however, we do not need an additional layer from directory structures, so we explicitly define the template using the <code>template_name</code> property of our class view.  Let's add one line to <code>views.py</code> : <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.views.generic <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ListView <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> contacts.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Contact <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ListContactView</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(ListView)</span></span></span><span class="hljs-class">:</span></span> model = Contact template_name = <span class="hljs-string"><span class="hljs-string">'contact_list.html'</span></span></code> </pre><br>  Create the <code>templates</code> subdirectory in the <code>contacts</code> directory (this is the directory with the application), and in it create the <code>contact_list.html</code> template <code>contact_list.html</code> : <br><br><pre> <code class="django hljs"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Contacts</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">for</span></span></span></span></span><span class="hljs-template-tag"> contact </span><span class="hljs-keyword"><span class="hljs-template-tag"><span class="hljs-keyword">in</span></span></span><span class="hljs-template-tag"> object_list %}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"contact"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ contact }}</span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">endfor</span></span></span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre><br>  When you re-open (or refresh) the <a href="http://localhost:8080/">http: // localhost: 8080 /</a> page in your browser, you will need to see at least one contact that we created earlier through an interactive shell. <br><br> <a href=""><img src="https://habrastorage.org/files/77c/40f/097/77c40f097ead4c5fa46f8a03bd83cb33.png"></a> <br><br><h2>  3.7.  Create contacts </h2><br>  Adding information to the database through an interactive shell takes too much time, so let's create a view to add new contacts. <br><br>  As with the list of contacts, we use one of the common concepts of Django.  In the <code>views.py</code> file we will add a few lines: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.core.urlresolvers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> reverse <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.views.generic <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ListView <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.views.generic <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> CreateView <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> contacts.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Contact <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ListContactView</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(ListView)</span></span></span><span class="hljs-class">:</span></span> model = Contact template_name = <span class="hljs-string"><span class="hljs-string">'contact_list.html'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateContactView</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(CreateView)</span></span></span><span class="hljs-class">:</span></span> model = Contact template_name = <span class="hljs-string"><span class="hljs-string">'edit_contact.html'</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_success_url</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> reverse(<span class="hljs-string"><span class="hljs-string">'contacts-list'</span></span>)</code> </pre><br><blockquote>  <em><u>Translator's Note:</u></em> <br>  <em>If you are using Django version&gt; = 1.7, then you can add an additional field to the <code>CreateContactView</code> class:</em> <br><br><pre> <code class="python hljs"> fields = [<span class="hljs-string"><span class="hljs-string">'first_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'last_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'email'</span></span>]</code> </pre> <br>  <em>This is not necessary, but since Django 1.7, the <u>disuse of</u> this field in classes with automatic generation of forms has been declared obsolete (they will tell you about this when running the tests).</em>  <em>If you do not specify it, then all fields will be used in the edit form, but from Django 1.8 version this behavior will be removed.</em> </blockquote><br>  Most of the common submissions that work with forms have the concept of a ‚Äúsuccessful URL‚Äù: such a URL where the user is redirected after the form has been successfully processed.  All submissions processing forms adhere to the practice of <abbr title="POST-redirect-GET">POST-redirect-GET</abbr> to accept changes, so updating the final page does not resend the form.  You can implement this concept as a class property, or override the <code>get_success_url()</code> method, as we did.  In our case, we use the <code>reverse</code> function to calculate the URL of the contact list. <br><br><blockquote>  <b><u>Note:</u> Context variables in class views</b> <br>  The set of variables available in a template when it is displayed is called a <abbr title="Context">context</abbr> .  Context is a combination of data from the view and information from <abbr title="context processors"><a href="https://docs.djangoproject.com/en/1.7/ref/templates/api/">the context processors</a></abbr> . <br>  When you use built-in generic views, it‚Äôs not at all obvious what variables are available in context.  Over time, you will discover that their names (provided by common concepts into the context of the template) are fairly consistent ‚Äî <code>form</code> , <code>object</code> and <code>object_list</code> are often used ‚Äî although this will not help you at the beginning of the path.  Fortunately, the documentation on this issue has become prettier since Django 1.5. <br>  In class <code>get_context_data()</code> method is used to add information to the context.  If you overload this method, you will need to enable <code>**kwargs</code> and call the superclass. </blockquote><br>  The template for adding a contact will be a bit more complicated than the template for the contact list, but not too much.  Our <code>contacts/templates/edit_contact.html</code> will look something like this: <br><br><pre> <code class="django hljs"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Add Contact</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span></span></span></span></span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">url</span></span></span></span></span><span class="hljs-template-tag"> "contacts-new" %}</span></span><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"POST"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">csrf_token</span></span></span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ form.as_ul }}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">input</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"save_contact"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Save"</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">form</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span></span></span></span></span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">url</span></span></span></span></span><span class="hljs-template-tag"> "contacts-list" %}</span></span><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">back to list</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre><br>  A few new pieces of note: <br><ul><li>  <code>form</code> from context is the <a href="https://docs.djangoproject.com/en/1.7/topics/forms/">Django Form</a> for our model.  Since we didn‚Äôt specify one of our own, Django created one for us.  How thoughtful; </li><li>  if we just wrote <code>{{ form }}</code> we would get table rows;  but we add <code>.as_ul</code> , which forces output fields to be displayed as elements of an unordered list.  Try using <code>.as_p</code> and see what happens; </li><li>  when we display a form ( <em>pr .: automatically generated</em> ), only our fields are displayed, but not the form-framing tag <code><code>   /&gt;</code> ,        ;</code> <br>  the template tag <code>{% csrf_token %}</code> inserts a hidden field by which Django determines that the request came from your project and that it is not a cross-site request forgery ( <a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery">CSRF</a> ).  Try not to include it in the template: you will still have access to the page, but as soon as you try to submit the form, you will get an error; <br>  we use the <code>url</code> template tag to generate a link back to the contact list.  Notice that <code>contacts-list</code> is the name of our view, which we specified in the URL settings.  Using <code>url</code> instead of full path, we don‚Äôt have to worry about broken links.  <code>url</code> in the template is equivalent to <code>reverse</code> in Python code. <br></li></ul></div><p>Source: <a href="https://habr.com/ru/post/242261/">https://habr.com/ru/post/242261/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../242247/index.html">The first browser specifically for developers: soon</a></li>
<li><a href="../242251/index.html">Algorithms for eliminating false and redundant data in the GPS stream</a></li>
<li><a href="../242253/index.html">As a Windows driver crafty breaks sound in Linux or painful bug searches</a></li>
<li><a href="../242255/index.html">Ilya Grigorik on the implementation of HTTP / 2</a></li>
<li><a href="../242257/index.html">Startup, Westing, Cliff: Shares in Business and Rights of Participants</a></li>
<li><a href="../242263/index.html">We restore the old clock "Electronics-7"</a></li>
<li><a href="../242267/index.html">Free signing for Open Source from Certum</a></li>
<li><a href="../242269/index.html">There will be no exceptions in Rust 1.0</a></li>
<li><a href="../242271/index.html">RemoteIE Announcement: We are testing the latest version of Internet Explorer on Windows, Mac OS X, iOS and Android</a></li>
<li><a href="../242273/index.html">Welcome to Moscow Django Meetup and Moscow.pm November 6</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>