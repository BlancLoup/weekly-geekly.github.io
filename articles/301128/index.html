<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Work with ListView in Xamarin.Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I had the idea to collect all the basic most frequently used features for ListView in Android and for convenience to combine them into one p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Work with ListView in Xamarin.Android</h1><div class="post__text post__text-html js-mediator-article">  Recently, I had the idea to collect all the basic most frequently used features for ListView in Android and for convenience to combine them into one project.  As usual, I went to the Internet and found there a wonderful <a href="http://www.vogella.com/tutorials/AndroidListView/article.html">article</a> and its translations in Habr√© ( <a href="https://habrahabr.ru/post/133569/">translation 1</a> , <a href="https://habrahabr.ru/post/133575/">translation 2</a> ).  Not everything, in my opinion, was necessary and useful in this article, so I included in the final project only what seemed to me significant.  I hope in the future it will be useful to someone else. <br><a name="habracut"></a><br>  By the way, I‚Äôm Xamarin developer, so the <a href="https://github.com/IGR777/AndroidListsDemo">project</a> (and samples, respectively) will be written in C # for Xamarin.Android. <br><br>  So let's get started: <br><br><h4>  Data Filling (TODO 1) </h4><br>  As you know, ListView in Android is an item that provides data in the form of a list, where each item is represented by its View.  Adapters are used to control the display of cells.  In order to fill the ListView data in the most modest form, you can use the ArrayAdapter.  This is done in two lines: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> animals = GetAnimals (); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> adapter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayAdapter&lt;Animal&gt; (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, Android.Resource.Layout.SimpleListItem1, animals);</code> </pre> <br>  As you can see, the result is appropriate - fast, cheap and not very nice, but we'll return to this. <br><br><img width="300" height="400" src="https://habrastorage.org/files/144/a38/144/144a381440d3474fa353f8f5b13cd5e1.png"><br><br><h4>  Cell selection processing (TODO 2) </h4><br>  The user often needs to somehow communicate with the displayed list ‚Äî select items, view detailed information, etc.  To handle cell selection in Xamarin.Android, you just need to subscribe to the ItemClick event on the ListView.  To delete the selected item, use the following code: <br><br><pre> <code class="hljs coffeescript">bool inDeletion = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; list.ItemClick += <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sender, e)</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!inDeletion) { inDeletion = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; e.View.Animate () .SetDuration (<span class="hljs-number"><span class="hljs-number">500</span></span>) .Alpha (<span class="hljs-number"><span class="hljs-number">0.0</span></span>f) .WithEndAction (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Runnable (<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">#region TODO5 //TODO 05 var item = adapter.GetRawItem (e.Position); #endregion //var item = list.Adapter.GetItem(e.Position); adapter.Remove (item); adapter.NotifyDataSetChanged (); e.View.Alpha = 1; #region TODO9 //TODO 09 ShowSnackBar (1); #endregion inDeletion = false; })); } };</span></span></code> </pre><br><h4>  Handling an empty list (TODO 3) </h4><br>  There is a possibility that the user will see a list without elements.  In order for it not to get lost and to close the application, it is best to use an EmptyView.  It should be declared in the layout Activity and in a single line make the ListView understand that it must show this View when it has no elements: <br><br><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">list</span></span>.EmptyView = FindViewById&lt;TextView&gt; (Resource.Id.<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>);</code> </pre><br><h4>  Change Cell Appearance (TODO 4,5) </h4><br>  To slightly improve the appearance of our list, you can apply an overload of the ArrayAdapter constructor and pass the layout to it, which will be used to display the list item.  You also need to pass an Id of the text field, where the string analogue of the object will be displayed: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> adapter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayAdapter&lt;Animal&gt; (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, Resource.Layout.row_custom, Resource.Id.row_custom_text, animals);</code> </pre><br>  Now our list looks a little better: <br><br><img width="300" height="400" src="https://habrastorage.org/files/415/f6d/df8/415f6ddf89904e33a7cf3041073a500f.png"><br><br>  To further update the appearance, we will create our own adapter, in which we will override the GetView method and will manage the appearance of the cells ourselves.  The adapter implementation is the most basic, so posting all the code here is unnecessary.  If you want to see the changes, uncomment the code in the <a href="">TODO5</a> region.  Also, some old code will require modification - the GetItem method can only return an object of type Java.Lang.Object.  Since wrapping each item in the list in Java.Lang.Object is an excessive luxury, let's create our own GetRawItem method that will return the desired type.  Now as to the modification, in order for the project to compile, when deleting a cell, you need to replace the GetItem call with GetRawItem. <br><br><img width="300" height="400" src="https://habrastorage.org/files/907/54e/1f5/90754e1f53604f2abecaef2b077b7961.png"><br><br>  Here we see this as a result.  At the design competition is not suitable, but for the test project what you need. <br><br><h4>  Add Contextual Action Bar (CAB) (TODO 6) </h4><br>  Our next step is to add the CAB functionality to our ListView.  For reference, a description and detailed implementation guide can be found <a href="https://habrahabr.ru/post/185004/">here</a> .  In order to add a CAB, firstly you need a menu that will appear with a custom long tap.  Menu file: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">menu</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/ActionModeDeleteItem"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Delete"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:showAsAction</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"always"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">menu</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Secondly, you need to implement the ActionMode.ICallback interface in the Activity as follows: <br><br><pre> <code class="hljs coffeescript">public bool OnActionItemClicked (ActionMode mode, IMenuItem item) { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(item.ItemId){ case Resource.Id.ActionModeDeleteItem: SparseBooleanArray selected = _adapter.SelectedIds; List&lt;Animal&gt; itemList = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;Animal&gt; (); var keys = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;int&gt; (); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int i = (selected.Size () - <span class="hljs-number"><span class="hljs-number">1</span></span>); i &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>; i--) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>checkisvaluecheckedby user <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (selected.ValueAt (i)) { keys.Add (selected.KeyAt (i)); var selectedItem = _adapter.GetRawItem (selected.KeyAt (i)); itemList.Add (selectedItem); } } _adapter.Remove (itemList); _mode.Finish(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; default: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } public bool OnCreateActionMode (ActionMode mode, IMenu menu) { mode.MenuInflater.Inflate (Resource.Menu.menu, menu); inActionMode = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } public void OnDestroyActionMode (ActionMode mode) { _adapter.RemoveSelection (); _adapter.NotifyDataSetChanged (); _mode = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; inActionMode = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } public bool OnPrepareActionMode (ActionMode mode, IMenu menu) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre><br>  Thirdly, in the method of processing a user click you need to take into account that the user can be located in ActionMode: <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(inActionMode){ adapter.ToggleSelection(e.Position); _mode.Title=(adapter.SelectedCount.ToString()+<span class="hljs-string"><span class="hljs-string">" selected"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; }</code> </pre><br>  Fourth, methods should be added to the adapter that will be responsible for selecting the element: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SelectView</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> position, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) _selectedItemsIds.Put(position,<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> _selectedItemsIds.Delete(position); NotifyDataSetChanged(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToggleSelection</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> position</span></span></span><span class="hljs-function">)</span></span>{ SelectView(position, !_selectedItemsIds.Get(position)); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> SelectedCount { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _selectedItemsIds.Size(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RemoveSelection</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ _selectedItemsIds=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SparseBooleanArray(); NotifyDataSetChanged(); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> SparseBooleanArray SelectedIds{ <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _selectedItemsIds; } }</code> </pre><br>  Then we get the desired result: <br><br><img width="300" height="400" src="https://habrastorage.org/files/dfe/7a0/e62/dfe7a0e62568417f8c64c5e878ddb0c5.png"><br><br><h4>  ListView Performance (TODO 7) </h4><br>  To make the ListView show its elements faster, we implement the <a href="http://developer.android.com/intl/ru/training/improving-layouts/smooth-scrolling.html">ViewHolder pattern</a> .  To do this, create a ViewHolder class that inherits the base Java.Lang.Object (this is necessary in order to assign the ViewHolder property to view.Tag).  People in the know <a href="http://www.vogella.com/tutorials/AndroidListView/article.html">say</a> that ListView with ViewHolder is 15% faster.  On my simulator, the speed from 1-3ms jumped to 0-1ms for one View.  Of course, this depends on how often the FindViewByID is called.  Now, actually, let's see how our GetView method has changed: <br><br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> override <span class="hljs-keyword"><span class="hljs-keyword">View</span></span> GetView(<span class="hljs-type"><span class="hljs-type">int</span></span> position, <span class="hljs-keyword"><span class="hljs-keyword">View</span></span> convertView, ViewGroup parent) { var item = this [position]; var <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> = convertView; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">view</span></span> == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> = LayoutInflater.<span class="hljs-keyword"><span class="hljs-keyword">From</span></span> (parent.Context).Inflate (Resource.Layout.row_custom_adapter, parent, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); var viewHolder = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ViewHolder (); viewHolder.Text = <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.FindViewById&lt;TextView&gt; (Resource.Id.row_custom_name); viewHolder.Weight = <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.FindViewById&lt;TextView&gt; (Resource.Id.row_custom_weight); viewHolder.Icon = <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.FindViewById&lt;ImageView&gt; (Resource.Id.row_custom_icon); <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.Tag = viewHolder; } var holder = (ViewHolder)<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.Tag; holder.Text.Text = item.Name; holder.Weight.Text = item.Weight.ToString ("F"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_selectedItemsIds.Size () &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; _selectedItemsIds.<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> (position)) { <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.SetBackgroundColor (Android.Graphics.Color.CadetBlue); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.Background = GetBackground (item.Color); } holder.Icon.SetImageResource (GetImage (item.Name)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>; }</code> </pre><br><h4>  Adding Sections (TODO 8) </h4><br>  In order for our animals to look more consistent, you should divide them into groups according to colors.  To do this, create a new adapter SectionAnimalAdapter, which will inherit AnimalAdapter.  The main difference of this adapter is that it stores objects as a dictionary Dictionary &lt;string, List&gt; and each time it deletes an element, calls the BuildSections method to re-create the Dictionary.  Also add a new Viewtype - header and layout for it.  The code can be viewed in the <a href="">file</a> . <br><br>  Now our list will look like this: <br><br><img width="300" height="400" src="https://habrastorage.org/files/f3a/cf3/37f/f3acf337fcce4fb68b839dfb8ae94b52.png"><br><br><h4>  Undo last action (TODO 9) </h4><br>  Very often, users have a desire to cancel the last action, especially when it comes to deleting.  We implement this functionality using <a href="https://www.google.com/design/spec/components/snackbars-toasts.html">Snackbar</a> .  After deletion, we will show the user Snackbar with a proposal to cancel the last action.  Of course, this will require small manipulations in the adapter - you should create an additional list where the last state will be stored, to which the user can roll back, and the Rollback method: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RollBack</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _animals = _rollbackAnimals; _rollbackAnimals = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre><br><img width="300" height="400" src="https://habrastorage.org/files/b06/561/3a5/b065613a5c5247a4ae9aa49d2cb7ebbb.png"><br><br><h4>  Drop-down Lists (TODO 10) </h4><br>  If necessary, you can implement drop-down lists.  For a list to be a drop-down list, it must be of type ExpandableListView, and its adapter must inherit the type BaseExpandableListAdapter.  Its main difference from the usual adapter is two methods for the group and for the child element: <br><br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> override <span class="hljs-keyword"><span class="hljs-keyword">View</span></span> GetGroupView (<span class="hljs-type"><span class="hljs-type">int</span></span> position, <span class="hljs-type"><span class="hljs-type">bool</span></span> isExpandable, <span class="hljs-keyword"><span class="hljs-keyword">View</span></span> convertView, ViewGroup parent) { GroupViewHolder holder = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; var <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> = convertView; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">view</span></span> != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) holder = <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.Tag <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> GroupViewHolder; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (holder == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> = LayoutInflater.<span class="hljs-keyword"><span class="hljs-keyword">From</span></span> (parent.Context).Inflate (Resource.Layout.row_expandable_header, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); holder = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> GroupViewHolder (); holder.Text = <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> CheckedTextView; } var sect = _sections.Keys.ToList () [position]; var <span class="hljs-type"><span class="hljs-type">name</span></span> = _sections [sect].First ().Name; holder.Text.Text = <span class="hljs-type"><span class="hljs-type">name</span></span>; holder.Text.Checked = isExpandable; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> override <span class="hljs-keyword"><span class="hljs-keyword">View</span></span> GetChildView (<span class="hljs-type"><span class="hljs-type">int</span></span> groupPosition, <span class="hljs-type"><span class="hljs-type">int</span></span> childPosition, <span class="hljs-type"><span class="hljs-type">bool</span></span> isLastChild, <span class="hljs-keyword"><span class="hljs-keyword">View</span></span> convertView, ViewGroup parent) { var <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> = convertView; var sect = _sections.Keys.ToList () [groupPosition]; var item = _sections [sect] [childPosition]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">view</span></span> == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> = LayoutInflater.<span class="hljs-keyword"><span class="hljs-keyword">From</span></span> (parent.Context).Inflate (Resource.Layout.row_custom_adapter, parent, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); var viewHolder = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ChildViewHolder (); viewHolder.Text = <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.FindViewById&lt;TextView&gt; (Resource.Id.row_custom_name); viewHolder.Weight = <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.FindViewById&lt;TextView&gt; (Resource.Id.row_custom_weight); viewHolder.Icon = <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.FindViewById&lt;ImageView&gt; (Resource.Id.row_custom_icon); <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.Tag = viewHolder; } var holder = (ChildViewHolder)<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.Tag; holder.Text.Text = item.Name; holder.Weight.Text = item.Weight.ToString ("F"); holder.Icon.SetImageResource (GetImage (item.Name)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>; }</code> </pre><br><img width="300" height="400" src="https://habrastorage.org/files/190/79b/514/19079b514e7648009fd8bb3a2d3b743f.png"><br><br><h4>  Drag'n'Drop lists (TODO 11) </h4><br>  To implement a list that will support drag'n'drop, you need to create a new class that will inherit the ListView class.  The original example is taken from <a href="https://www.youtube.com/watch%3Fv%3D_BZIvjMgH-Q">this video</a> .  In a nutshell, with a long-tap user per cell, a snapshot of her is created, which moves to the next of the user's finger.  When the finger reaches the next cell, the objects in the adapter are swapped and redrawn.  DynamicListView code <a href="http://https:%20">here</a> . <br><br>  In order to start the application with the drag'n'drop list, you should set the starting SecondaryActivity.  Uncomment the line MainLauncher = true. <br><br><img width="300" height="400" src="https://habrastorage.org/files/cf6/b91/469/cf6b91469be34cec9635a031ec81375e.png"><br><br>  That's all I wanted to tell about ListView for Android.  But perhaps the project still lacks some important features?  I would be glad to hear in the comments what features your ListView uses most often :) </div><p>Source: <a href="https://habr.com/ru/post/301128/">https://habr.com/ru/post/301128/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../301116/index.html">Digital asset protection is a strategic task.</a></li>
<li><a href="../301118/index.html">E-mail delivery guide or how not to become a ‚Äúspammer‚Äù</a></li>
<li><a href="../301120/index.html">Non-technological leak protection problems. Field Engineer Practice</a></li>
<li><a href="../301122/index.html">Type Analysis with Proxy</a></li>
<li><a href="../301126/index.html">Koajs 2.0: a new generation of the framework of the new generation</a></li>
<li><a href="../301132/index.html">Optical fibers for telecommunications: quartz and not only</a></li>
<li><a href="../301134/index.html">Firsthand case: how Igor Kalganov‚Äôs IT service ‚Äú33 Elephants‚Äù began to compete with real estate managers</a></li>
<li><a href="../301136/index.html">Animated stub "Sorry, your browser doesn't support WebGL"</a></li>
<li><a href="../301146/index.html">What is isomorphism for?</a></li>
<li><a href="../301148/index.html">How to dial in an IT startup development team that really makes the product?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>