<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The film "Hidden figures": tasks from the film and a modern approach to the calculations of the orbit and return to Earth</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Translated by Jeffrey Bryant, Paco Jain and Michael Trott, " Hidden Figures: Modern Approaches to Orbit and Reentry Calculations ". 
 The code given i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The film "Hidden figures": tasks from the film and a modern approach to the calculations of the orbit and return to Earth</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/a4c/06c/f0d/a4c06cf0dd524789a0131cf391f03be9.png"></div><br>  <i>Translated by Jeffrey Bryant, Paco Jain and Michael Trott, " <a href="http://blog.wolfram.com/2017/02/24/hidden-figures-modern-approaches-to-orbit-and-reentry-calculations/">Hidden Figures: Modern Approaches to Orbit and Reentry Calculations</a> ".</i> <i><br></i>  <i>The code given in the article can be downloaded <a href="">here</a> .</i> <i><br></i>  <i>I express my deep gratitude to <a href="https://vk.com/id65091763">Polina Sologub</a> for assistance in translating and preparing the publication.</i> <br><hr><br><h2>  Content </h2><br>  - <a href="https://habrahabr.ru/company/wolfram/blog/NUMBER/">Placement of the satellite in a specific location</a> <br>  - <a href="https://habrahabr.ru/company/wolfram/blog/NUMBER/">Constants and primary processing</a> <br>  - <a href="https://habrahabr.ru/company/wolfram/blog/NUMBER/">Calculations</a> <br>  - <a href="https://habrahabr.ru/company/wolfram/blog/NUMBER/">Plotting</a> <br>  - <a href="https://habrahabr.ru/company/wolfram/blog/NUMBER/">How are orbits calculated today</a> <br>  <a href="https://habrahabr.ru/company/wolfram/blog/NUMBER/">Simulation of the returned satellite</a> <br><br><hr><br>  The film <a href="http://www.wolframalpha.com/input/%3Fi%3DHidden%2BFigures"><i>Hidden Figures,</i></a> recently released in cinemas, has received good reviews.  The action takes place in an important period of US history;  It also covers a number of topics such as civil rights and the space race.  At the center of the story is the story of <a href="https://ru.wikipedia.org/wiki/%25D0%2594%25D0%25B6%25D0%25BE%25D0%25BD%25D1%2581%25D0%25BE%25D0%25BD,_%25D0%259A%25D1%258D%25D1%2582%25D1%2580%25D0%25B8%25D0%25BD">Catherine Johnson</a> and her colleagues ( <a href="https://en.wikipedia.org/wiki/Dorothy_Vaughan">Dorothy Vaughan</a> and <a href="https://en.wikipedia.org/wiki/Mary_Jackson_(engineer)">Mary Jackson</a> ) from NASA during the deployment of the Mercury program and early research into manned space flight.  Attention is also focused on the dramatic struggle for the civil rights of African-American women at NASA, which took place at that time.  Computers barely appeared at that time, so the ability of Johnson and her colleagues to solve difficult navigation problems of orbital mechanics without using a computer provided an important test of early computer results. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d86/741/6f7/d867416f77b14b01668cbe99343a66b0.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I will focus on two aspects of her scientific work mentioned in the film: <em>orbit</em> <em>calculations</em> and <em>calculations related to entering the atmosphere</em> .  For orbital calculations, I first did exactly the same thing as Johnson, and then applied a more modern direct approach using the <a href="http://www.wolfram.com/language/">Wolfram Language</a> tools.  The film mentions the solution of differential equations <a href="http://mathworld.wolfram.com/EulerForwardMethod.html">by the Euler method</a> ;  I will compare this method with a more modern one and calculate the return trajectory using the data of the atmospheric model, obtained directly from the Wolfram Language). <br><a name="habracut"></a><br>  The film does not cover the details of solving the mathematical problems of the Johnson team, however, what you see is enough to get a feel for and compare the approach displayed in the film with the one that exists at the moment. <br><br><a name="1"></a><h2>  Placing a satellite in a specific location </h2><br>  One of the earliest works in which Johnson co-authored (" <a href="https://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19980227091.pdf">Determining the azimuth angle at the burnout point to place a satellite over a selected point</a> ") deals with the problem of checking whether a satellite can be placed above a certain point of the Earth after a certain number of orbits around an orbit the starting position (for example, Cape Canaveral, Florida) and the trajectory of rotation.  The approach that the Johnson team used to determine the azimuth angle (the angle formed by the velocity vector of the spacecraft at the time of the engine shutdown, with a fixed direction, say, north) to launch the rocket was based on other orbital parameters.  This is an important step to ensure the astronaut is properly located to enter the atmosphere on Earth. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b91/20f/518/b9120f518a0f40715ff057758c121e39.jpg"></div><br><a name="2"></a><h2>  Constants and primary processing </h2><br>  In the article, Johnson defines a series of constants and input parameters necessary for solving the problem manually.  Step back a bit to explain the term "burnout", referring to stopping the rocket engine.  After the ‚Äúburnout‚Äù, the parameters of the orbit seem to be ‚Äúfrozen‚Äù, and the spacecraft moves only under the action of the Earth‚Äôs gravity (in accordance with Newton‚Äôs laws).  In this section, I follow the definitions of units that were adopted in the article. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b5f/cf8/5ef/b5fcf85ef2b5022e4dcccf476d643672.png"><br><br>  Some functions for convenience are defined to interact with angles in degrees instead of radians.  This allows you to optimize the work when calculating the angles: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f1c/644/e2b/f1c644e2b233878fccccd599d3a71847.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/fbd/bb5/81b/fbdbb581ba610e3c842ee97099797f4a.png"><br><br>  Johnson describes several other derived parameters, although it is interesting to note that sometimes she accepts certain values ‚Äã‚Äãfor them, rather than using the values ‚Äã‚Äãobtained using her formulas.  Its values ‚Äã‚Äãwere often close to the values ‚Äã‚Äãobtained by the formulas.  For simplicity, the values ‚Äã‚Äãfrom the formulas are used here. <br><br>  <a href="http://mathworld.wolfram.com/SemilatusRectum.html">Semilatus rectum</a> elliptical orbit: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ad/ee1/49b/7adee149b93321a66b7032ea3bcc4dbc.png"><br><br>  The angle in the plane of the orbit between the perigee and the point of burnout: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fdb/67e/1ac/fdb67e1ac534a5a8ea32ed3b99a5b766.png"><br><br>  The eccentricity of the orbit: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/87c/432/bf3/87c432bf3b3fec7a12897b64e5df5dce.png"><br><br>  Orbit period: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ac/3fb/cf7/7ac3fbcf721d3f3c0f528bc07c7d7fb0.png"><br><br>  Eccentric anomaly: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c30/ba6/5ab/c30ba65abf6c07d85fac06912e21b589.png"><br><br>  To describe the next parameter, it will be easier to quote the original article: "the <em>requirement that a satellite with a burn point œÜ1, Œª1 pass through the selected position œÜ2, Œª2 after completing n orbital passes is equivalent to the requirement that the satellite passes through during the first revolution equivalent place with latitude œÜ2 as in the selected position, but with Œª2 longitude shifted eastwards from Œª2 by an amount sufficient to compensate for the Earth‚Äôs rotation during n total rotations, i.e. polar</em>  <em>hour angle nœâ <sub>E</sub> T. The longitude of this equivalent position, therefore, is determined by the ratio</em> ": <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a1f/745/b63/a1f745b63e65230247bc346c6859220a.png"><br><br>  Time from perigee for angle <i>Œ∏</i> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b9/b9a/6a9/2b9b9a6a96b961ee711b277e8c0b9e99.png"><br><br><a name="3"></a><h2>  Calculations </h2><br>  Part of the final decision is to determine the value for the intermediate parameters <i>Œ¥Œª</i> <sub>1-2 <i>e</i></sub> and <i>Œ∏</i> <sub>2</sub> <sub><i>e</i></sub> .  This can be done in several ways.  First, I can use <b><a href="http://reference.wolfram.com/language/ref/ContourPlot.html">ContourPlot</a></b> to get a graphical solution using equations 19 and 20 of the article: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dea/217/61f/dea21761fc0b3d1b3422c0d756d7bdb7.png"><br><br>  <b><a href="http://reference.wolfram.com/language/ref/FindRoot.html">FindRoot</a></b> can be used to find numerical solutions: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8bc/5ef/053/8bc5ef05321437daa502016f8d5b50c7.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/91a/f4e/353/91af4e35327f13131cd882c89fb44a89.png"><br><br>  Of course, Johnson did not have access to the <b>ContourPlot</b> or <b>FindRoot functions</b> , so her article describes an iterative method.  I translated the methodology described in the article into the Wolfram language, and also revealed a number of other parameters using its iterative method.  Since the basic calculations are calculated for the spherical shape of the Earth, the corrections for flattening included: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9a9/8c1/7ed/9a98c17ed8661e348ae82550c3da681b.png"><br><br>  The graphic representation of the <i>Œ∏</i> 2e value for various iterations demonstrates fast convergence: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d84/58c/b44/d8458cb442f581dc2e4e03c038706488.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b37/df8/489/b37df848934362ccd0da6a792b31a22d.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/770/089/949/77008994948c14f77b5272bd21bbf316.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/74f/d13/648/74fd1364871f44dbc59f38d3a7302021.png"><br><br>  I can convert the method in the <b>FindRoot command</b> as follows: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e7d/f62/cb6/e7df62cb62a3dce34bfee68a59830319.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/227/25e/500/22725e500d2736f396d7402905157fab.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ac9/363/a7d/ac9363a7d1726716e77d56450b25bb17.png"><br><br>  Interestingly, even the iterative steps of finding the root of this more complex system converge fairly quickly: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/196/8e3/47b/1968e347bdc925a3e8d1eb408e792b77.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b5b/c05/bff/b5bc05bff18edc80652671b76bec7c5f.png"><br><br><a name="4"></a><h2>  Plotting </h2><br>  When the orbital parameters are determined, the solution can be visualized.  First, from the previous solutions some parameters must be extracted: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/edc/3a8/9a8/edc3a89a89f81f22ccbb0c5ac6b634ae.png"><br><br>  Next should be obtained the latitude and longitude of the satellite, depending on the azimuth angle: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/980/fca/b23/980fcab23e937ad15cc18180c7ddb629.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/8cb/a85/b8e/8cba85b8ee7d482fb32be6249b62e492.png"><br><br>  <i>œÜ</i> s and <i>Œª</i> s - latitude and longitude as a function of <i>Œ∏</i> s: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d51/d77/a36/d51d77a363bded21d402e5427b4f483a.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/9d5/2bd/dd1/9d52bddd1bf4460ae0419dbcb2146e85.png"><br><br>  The satellite ground track can be built by creating a table of points: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/adb/4ce/3b8/adb4ce3b8655f639ce2abcc28759b115.png"><br><br>  The Johnson article presents an orbital solution scheme, including burnout markers, as well as selected and equivalent positions.  This scheme is easy to reproduce: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e8d/58b/345/e8d58b3452f1b235ab8ced18a27376bf.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/538/898/11a/53889811a19abe965ed6755804ed46ae.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/095/3c7/3cd/0953c73cdbcaaf8357a62118d0f43f1a.png"><br><br>  Here is its original comparison chart: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e34/1db/8b4/e341db8b46ffbd99fda0779cb3f1dac0.png"><br><br>  A more visually useful version can be built using the <a href="http://reference.wolfram.com/language/ref/GeoGraphics.html"><b>GeoGraphics</b></a> function, which converts geocentric coordinates to geodesics: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cb1/412/61e/cb141261ef7578e1995aebf4ae687559.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ef9/fc3/954/ef9fc3954904b7cc49454e89dd184072.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7b8/f8d/325/7b8f8d325aa2aeb122112670fa836f9f.png"><br><br><a name="5"></a><h2>  How are orbits calculated today </h2><br>  Today, almost all of us have access to computing resources that are much more powerful than those that NASA had in the 1960s.  Now, using only the desktop computer and the Wolfram Language, you can easily find direct numerical solutions of orbital mechanics problems like those that Catherine Johnson and her team were doing. <br><br>  To calculate the azimuth angle <i>œà</i> using more modern methods, let's set the parameters for a simple circular orbit originating after burning out over Florida;  Let us also assume that the Earth is spherically symmetric (I will not try to search for an exact correspondence with the data from Johnson‚Äôs article and redefine some values ‚Äã‚Äãusing the modern system of SI units).  Starting from the same height of the near-earth orbit used by Johnson, and using spherical trigonometry, it is easy to derive the initial conditions for our orbit: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/45b/c6a/a3a/45bc6aa3a7565d86d1fa153f414cb282.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b79/e32/30d/b79e3230d84bc368acd014ab9ffddc6c.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/186/b29/5c4/186b295c47fedb40e21053bab3e95a9c.png"><br><br>  The corresponding physical parameters can be obtained directly using the Wolfram Language: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cca/87b/1e2/cca87b1e2c8cbc4fa4f23cb41fa3a6c3.png"><br><br>  Then I got the differential equation of motion of our spacecraft, taking into account the gravitational field of the Earth.  There are several ways to simulate the gravitational potential near the Earth.  Suppose the planet is spherically symmetric and use a Cartesian coordinate system: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/780/f26/3bb/780f263bb27456923c080b0d160584c7.png"><br><br>  In addition, you can use a more realistic model of gravity of the Earth, where the oblate ellipsoid of rotation is taken as the shape of the planet.  The exact shape of the potential of such an ellipsoid (assuming a constant mass density of ellipsoidal shells) is available using the <a href="http://reference.wolfram.com/language/ref/EntityValue.html"><b>EntityValue</b></a> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b45/226/a9f/b45226a9f44b303fdf43a3b3bf65398b.png"><br><br>  For a common homogeneous triaxial ellipsoid, the potential contains piecewise functions: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d9a/943/71c/d9a94371c838ff0d3b372a912312200a.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a4a/0b3/713/a4a0b37139459ddcc02f5cbd4c3aec9d.png"><br><br>  Here <i>Œ∫</i> is the largest root of the expression <i>x</i> <sup>2</sup> / (a <sup>2</sup> + <i>Œ∫</i> ) + <i>y</i> <sup>2</sup> / ( <i>b</i> <sup>2</sup> + <i>k</i> ) + <i>z</i> <sup>2</sup> / ( <i>c</i> <sup>2</sup> + <i>Œ∫</i> ) = 1. In the case of a flattened ellipsoid, the previous the formula can be simplified to elementary functions ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/58a/71e/682/58a71e682a1baee8320b4b7d739616dc.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/503/5ca/658/5035ca65808d50e10a0d1ab4bcc3fb7e.png"><br><br>  ... where <em>Œ∫</em> = ((2 <em>z</em> <sup>2</sup> ( <em>a</em> <sup>2</sup> - <em>c</em> <sup>2</sup> + <em>x</em> <sup>2</sup> + <em>y</em> <sup>2</sup> ) + (- <em>a</em> <sup>2</sup> + <em>c</em> <sup>2</sup> + <em>x</em> <sup>2</sup> + <em>y</em> <sup>2</sup> ) <sup>2</sup> + <em>z</em> <sup>4</sup> ) <sup>1/2</sup> - <em>a</em> <sup>2</sup> - <em>c</em> <sup>2</sup> + <em>x <em><sup>2</sup> + <em>y</em> <sup>2</sup> + <em>z</em> <sup>2</sup></em> )</em> / 2. <br><br>  The simpler form, which I will use here, is given by the so-called conventional formula for the acceleration of gravity (IGF).  This formula takes into account the differences from the spherically symmetric potential up to the second order in spherical harmonics, and gives the results numerically indistinguishable from the exact potential to which they previously referred.  In terms of the four measured geodetic parameters, the IGF potential can be determined as follows: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b06/0df/5a3/b060df5a3ea4e308ff9559555fa42ff5.png"><br><br>  I could easily use even more accurate values ‚Äã‚Äãfor gravity using the <b><a href="http://reference.wolfram.com/language/ref/GeogravityModelData.html">GeogravityModelData</a></b> function.  In the initial position, the potential of IGF only by 0.06% deviates from the high order approximation: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ff7/3f7/b5c/ff73f7b5c019312168357aa065282954.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/71e/c28/0a9/71ec280a93767e11e76607e4fd40bc96.png"><br><br>  With these functional forms of potential, finding the orbital path requires calculating the potential gradient to obtain a gravitational field vector, then applying Newton's third law.  I get the orbital equations of motion for two models of gravity: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/416/9d7/c17/4169d7c1726200f1586ba071c7a59fb0.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/aca/75a/c66/aca75ac662d4c46a33e7f26a22092927.png"><br><br>  Now I am ready to use the power of <b><a href="http://reference.wolfram.com/language/ref/NDSolve.html">NDSolve</a></b> to calculate orbital trajectories.  However, before you do this, it will be nice to display the orbital path as a curve in three-dimensional space.  To embed these curves in context, I built them on a texture map of the Earth‚Äôs surface and projected onto a sphere.  Here I built the necessary graphic objects: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1d2/586/96f/1d258696f1b5e135134c4c665f13f5a3.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/16e/f76/6d2/16ef766d2859570eefc8c2213b8f3c4b.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f04/e24/0f8/f04e240f8ad7ac322e623c1e34de85d4.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/913/5e3/4de/9135e34de77c947017f885a3b9438a85.png"><br><br>  While the orbital path, calculated in the inertial reference frame, forms a periodic closed curve, it turns out that the spacecraft will pass through different points on the surface of the Earth during each subsequent revolution.  I can visualize this effect by adding extra spin time to the solutions I get from the <b>NDSolve</b> function.  Assuming that the number of orbital periods is three (by analogy with the John Glenn flight), I used the <b><a href="http://reference.wolfram.com/language/ref/Manipulate.html">Manipulate</a></b> function to see how the orbital path depends on the azimuth angle, like the study in Johnson‚Äôs article.  I will build one graph for a spherical Earth (white) and another, green, to demonstrate the effect of oblate (note that the discrepancy increases with each turn): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/36a/104/120/36a1041208bd2ebc2c2066bd6d1c48b7.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f87/328/f61/f87328f611eee374127e571dafce3578.png"><br><br>  In the document attached to this record, you can see the <b>Manipulate</b> function in action;  pay attention to the speed at which each new solution is located.  Hopefully, Catherine Johnson and her colleagues at NASA would be impressed! <br><br>  Now, by changing the angle <i>œà</i> at the burnout point, it is easy to calculate the position of the spacecraft after, say, three turns: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a39/7a2/c22/a397a2c224e2db1e920be87a102ddc86.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/05a/7cf/a48/05a7cfa481256f182fb893c1b05f6ce5.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ac4/ee5/c83/ac4ee5c839c4269579231eb9b6dd64d5.png"><br><br><a name="6"></a><h1>  Simulation of the returned satellite </h1><br>  The film also mentions the Euler method in connection with the return phase.  After solving the initial problem of finding the azimuth angle, as was done in the previous sections, it was time to return to Earth.  To slow down rotation, rockets are launched, and then, when moving from the airless environment of the cosmos into the atmosphere, a complex set of events occurs.  For a cosmonaut to return safely to Earth, factors such as a change in the density of the atmosphere, rapid deceleration and frictional heating should be taken into account.  It is necessary to solve the problems of altitude, speed and acceleration as a function of time.  This set of problems can be solved using the Euler method, as was done by Catherine Johnson, or using the functionality of solving differential equations in Wolfram Language. <br><br>  For simple differential equations, a detailed step-by-step solution can be obtained using the specified quadrature method.  The equivalent of Newton's well-known formula <i>F</i> = <i>m</i> for the time-dependent mass <i>m</i> <i>(t)</i> is the so-called equation for an ideal rocket (in one dimension) ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ca2/cce/7b8/ca2cce7b8c3bea0d4fa1d38d660bde2a.png"><br><br>  ... where <i>m</i> <i>(t)</i> is the mass of the rocket, <i>v</i> <sub><i>e is</i></sub> the exhaust speed of the rocket engine, and <em>m <sup>'</sup> <sub>p</sub></em> <i>(t)</i> is the derivative of the mass of fuel and time.  At constant <em>m <sup>'</sup> <sub>p</sub></em> <i>(t), the</i> structure of the equation turns out to be relatively simple and easily solvable in closed form: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e56/9bf/a59/e569bfa5948fd73a068d7e6c5ccf9cab.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/44d/f3b/a1f/44df3ba1f91012457b2d5f58c855374e.png"><br><br>  Having the initial and final conditions for the mass, I get the famous equation of the rocket motion ( <a href="http://www.tsiolkovsky.ru/index.php%3Foption%3Dcom_content%26task%3Dview%26id%3D64">K.E. Tsiolkovsky, 1903</a> ): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fd2/f8b/32f/fd2f8b32f5d08488a121819f2c9c37af.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/272/0ef/5bb/2720ef5bb8e097023d0b59960756f6cf.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/dd3/95b/dce/dd395bdce9dd08c1da7415bd36e8df8e.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b7a/e1e/b38/b7ae1eb3804423f25ff356ad7067a893.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/bff/218/1dc/bff2181dc86ead34f0d8f0c65641162d.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/fa1/daa/27c/fa1daa27c4c3d93f192a0aeed2b581c3.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/be9/ba1/84b/be9ba184b9e3c89dba96565b6d45c931.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/db1/ff5/71b/db1ff571b6be1d1b66037a13f2fd5c50.png"><br><br>  Details of the solution of this equation with specific values ‚Äã‚Äãof the parameters I can take from <a href="http://www.wolframalpha.com/">Wolfram | Alpha</a> .  Here are the details along with a comparison with the exact solution, as well as with other methods of numerical integration: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/70f/5ea/929/70f5ea9298c972a4ee4c7d4d6bb0afb6.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/615/4bc/9a0/6154bc9a03298c2501c2da01be0d3fbc.png"><br><br>  Following the plot of the film, I am now implementing a minimalist model of the re-entry process.  We begin by defining parameters that mimic Glenn‚Äôs flight: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3a1/7fe/e4b/3a17fee4bc485db9f549972714f487d2.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b5f/d34/07c/b5fd3407cd6328b71829ae47426198e2.png"><br><br>  I believe that in the process of braking 1% of the thrust of the engine of the first stage is used, and it lasts, say, 60 seconds.  Equation of motion: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4b8/3cf/44c/4b83cf44ceea205c6454d4125cf5fef8.png"><br><br>  Here <em><strong>F</strong></em> <sub>grav</sub> is the force of gravity, <em><strong>F</strong></em> <sub>exhaust</sub> ( <em>t</em> ) is the time-dependent force of the engine, and friction force <em><strong>F</strong></em> <sub>friction</sub> ( <em><strong>x</strong></em> ( <em>t</em> ), <em><strong>v</strong></em> ( <em>t</em> )).  The latter depends on both the air density in the <em><strong>x</strong></em> ( <em>t</em> ) position and the friction law for <em><strong>v</strong></em> ( <em>t</em> ). <br><br>  For air density, which depends on altitude, I can use the <a href="http://reference.wolfram.com/language/ref/StandardAtmosphereData.html"><b>StandardAtmosphereData</b></a> function.  I consider it also because of the parachute, which opens at an altitude of about 8.5 km above the ground: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/004/c53/4f4/004c534f42e503f95207ce3a126df59f.png"><br><br>  This gives the following set of related non-linear differential equations that need to be solved.  The <a href="http://reference.wolfram.com/language/ref/WhenEvent.html"><b>WhenEvent</b></a> function [...] indicates the end of the construction of a remote control solution when the capsule reaches the surface of the Earth.  I use the vector values ‚Äã‚Äãof the position and velocity of the variables X and V: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5ca/e8b/045/5cae8b045306035bc4fc3804b7879d7e.png"><br><br>  Given these definitions for weight, exhaust and air friction, the point of view ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e26/bec/a5d/e26beca5dd8e29ad41a68df8e8ffbba8.png"><br><br>  ... the resulting force can be found by: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a9d/f00/439/a9df004398d767a6ebca5645b8226d84.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/fbb/e44/195/fbbe441951aec356e6f82161cfc43eca.png"><br><br>  In this model, I neglected the rotation of the Earth, the internal angles of rotation of the capsule, the active changes in the angle of flight, the supersonic effects of friction force, and many others.  The equations solved by Katherine Johnson: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6f5/0f2/3ec/6f50f23ec50560d15e374b1b33a839db.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/9c9/bd7/6ba/9c9bd76ba85adbcca58d77a8e0d85040.png"><br><br>  This system of equations is simply solved numerically, if we supplement it with the initial position and velocity.  To do this, just refer to the function of <b>NDSolve</b> .  I don‚Äôt have to worry about the method used, step size control, error control, and so on, because Wolfram Language automatically selects those values ‚Äã‚Äãthat guarantee meaningful results: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6f9/bbc/e73/6f9bbce731f9d0e90ebb38f7b8993e3c.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b92/158/238/b921582382f6086eeea5bf0fe0012e17.png"><br><br>  Here is a graph of altitude, speed and acceleration versus time: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9e4/636/4a8/9e46364a89dc85aef9eec96909409e7b.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d65/4ed/c42/d654edc42428c59892d82e829e5ec83a.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/63b/933/4b4/63b9334b46937bbdfb6e01fb4a592a27.png"><br><br>  The curve of dependence on height instead of time demonstrates that an exponential increase in air density is responsible for strong inhibition.  This is not related to parachuting, which occurs at a relatively low altitude.  The deceleration peak occurs at a very high altitude when the capsule quickly transitions from vacuum to atmospheric environment: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8b2/86d/379/8b286d379e5a8cdd2b51255527ade5bf.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/118/1fe/0d1/1181fe0d1816ab6aee50f7cbc757f906.png"><br><br>  But the graph of the vertical and tangential velocity of the capsule in the process of re-entry: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8cb/55a/db5/8cb55adb5310a09ac7f15ffe25212bba.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ec0/9af/a48/ec09afa4831c6e64a235b5f774b73011.png"><br><br>  Now I will repeat the numerical solution by the Euler method with a fixed step: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5a7/06e/c98/5a706ec98a04ef88adb1d01e9270f323.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b17/275/f33/b17275f331e6ca71adf4928e626fba18.png"><br><br>  Qualitatively, this solution looks the same as the previous one: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fbc/797/868/fbc797868f34dc79db35d445c05070f5.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/29c/033/97d/29c03397dccfb626ee1ea8b5e6d36ac3.png"><br><br>  For the used step size of integration over time, the accumulated error is of the order of several percent.  Smaller step sizes will reduce the error: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a0e/1fe/aea/a0e1feaea80e93b2c71da81461c4255e.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/19b/865/b6e/19b865b6e661c0942b091e1eb9c4600e.png"><br><br>  Note that the landing time predicted by the Euler method deviates by only 0.11% compared to the previous time (for comparison: if I solved the equation with two modern methods, say, <b>BDF</b> or <b>Adams</b> , then the error was would be less by several orders of magnitude). <br><br>  A large amount of heat is generated during the re-entry process.  Here you need a heat shield.  At what height is the greatest amount of heat produced per unit area <i>Q</i> ?  Without going into details, I can, purely for reasons of dimension, apply the hypothesis <img src="https://habrastorage.org/getpro/habr/post_images/0b9/0f4/c0a/0b90f4c0a7bdc010226db04b5cdc89c6.png">  : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e82/67f/231/e8267f231d2f2120926e4e100d47f66b.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/498/326/0fb/4983260fb5ca2123ee1663958ebe7937.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/18c/98f/62a/18c98f62a788be5d2465ecd88c5dc2e7.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/047/b7f/f0d/047b7ff0d58a88e5817593c31b13f5b3.png"><br><br>  A lot of interesting things could be calculated ( <a href="http://www.dtic.mil/dtic/tr/fulltext/u2/a505342.pdf">Hicks 2009</a> ), but just as the film was supposed to end, so now I have to complete my article.  I hope you forgive me for my words: with the Wolfram Language you can do whatever you want. </div><p>Source: <a href="https://habr.com/ru/post/326756/">https://habr.com/ru/post/326756/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../326746/index.html">LVM Thin Provision: operating experience at a small facility</a></li>
<li><a href="../326748/index.html">YouTrack 2017.2 release: updated user profile, experimental functionality and more</a></li>
<li><a href="../326750/index.html">Jonker-Volgenta + t-SNE algorithm = superpower</a></li>
<li><a href="../326752/index.html">How we did ML Boot Camp III</a></li>
<li><a href="../326754/index.html">Media Analysis</a></li>
<li><a href="../326758/index.html">Application server on pl / pgsql</a></li>
<li><a href="../326760/index.html">DentalTap service overview - Treatment section</a></li>
<li><a href="../326762/index.html">‚ÄúBig Data is clear and simple‚Äù - an interview with the project manager for big data in QIWI Sergey Chekansky</a></li>
<li><a href="../326764/index.html">GoTo MeetUp: Security by Default</a></li>
<li><a href="../326766/index.html">Bitcoinophobia of St. Petersburg ships with blocking without victims</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>