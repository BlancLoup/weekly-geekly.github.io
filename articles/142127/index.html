<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating Attached Property for BusyIndicator step by step</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is a continuation of the Automatic BusyIndicator article for asynchronous operations and more . 


 In the case of attached property all ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating Attached Property for BusyIndicator step by step</h1><div class="post__text post__text-html js-mediator-article"> This article is a continuation of the <a href="http://habrahabr.ru/post/141731/">Automatic BusyIndicator article for asynchronous operations and more</a> . <br><br><a name="habracut"></a><br>  In the case of <code>attached property</code> all we need to write in XAML is: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BusyIndicator</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AsyncIndicator.Attached</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ItemsSource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding DataList, IsAsync=true}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ListBox</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BusyIndicator</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  As for me, you can‚Äôt think less! <br><br>  Let's start with the standard <code>attached property</code> : 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AsyncIndicator</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AsyncIndicator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> DependencyProperty AttachedProperty = DependencyProperty.RegisterAttached(<span class="hljs-string"><span class="hljs-string">"Attached"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> (ContentControl), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FrameworkPropertyMetadata(<span class="hljs-literal"><span class="hljs-literal">false</span></span>, AttachedChanged)); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Boolean </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetAttached</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">UIElement element</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (Boolean) element.GetValue(AttachedProperty); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetAttached</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">UIElement element, Boolean </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span></span><span class="hljs-function">)</span></span> { element.SetValue(AttachedProperty, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AttachedChanged</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DependencyObject busyIndicator, DependencyPropertyChangedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { } }</code> </pre><br>  <i>Interestingly, the <code>GetAttached</code> and <code>SetAttached</code> theoretically not needed and are never called in our script, but the <code>attached property</code> will not be available without them.</i> <br><br>  We are interested in the <code>AttachedChanged</code> event method.  The general idea is this: look for the content <code>BusyIndicator</code> 'and the <code>ItemsSource</code> property (more precisely, the <code>dependency property</code> <code>ItemsSourceProperty</code> ), if such a property is found, we intercept the moment of this property change.  If its value is <code>null</code> - turn on the indicator, otherwise turn it off. <br><br>  Immediately there is a slight difficulty: at the time of calling <code>AttachedChanged</code> content of <code>BusyIndicator</code> is not yet established, which is not surprising. <br>  I did not find a standard event like <code>ContentChanged</code> in <code>ContentControl</code> , so I had to go around it: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AttachedChanged</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DependencyObject busyIndicator, DependencyPropertyChangedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { SetPropertyChangedCallback(ContentControl.ContentProperty, busyIndicator, ContentChangedCallback); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetPropertyChangedCallback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DependencyProperty dp, DependencyObject d, PropertyChangedCallback callback, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> reset = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">false</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dp == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || d == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> typ = d.GetType(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> metadata = dp.GetMetadata(typ); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> oldValue = metadata.SetPropValue(<span class="hljs-string"><span class="hljs-string">"Sealed"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); metadata.PropertyChangedCallback -= callback; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!reset) metadata.PropertyChangedCallback += callback; metadata.SetPropValue(<span class="hljs-string"><span class="hljs-string">"Sealed"</span></span>, oldValue); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ContentChangedCallback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DependencyObject busyIndicator, DependencyPropertyChangedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>) busyIndicator.GetValue(AttachedProperty)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; SetBusyIndicator(e.OldValue <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DependencyObject, <span class="hljs-literal"><span class="hljs-literal">null</span></span>); SetBusyIndicator(e.NewValue <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DependencyObject, busyIndicator); }</code> </pre><br>  I will comment on this code a little. <br>  The <code>SetPropertyChangedCallback</code> method receives metadata of <code>dependency property ContentProperty</code> and adds (or removes) an event handler for changing the value of this property. <br>  There is one small hack: the fact is that it is impossible to simply change the metadata after initialization, which is directly indicated in the exception.  However, an analysis of the source code of the <code>PropertyMetadata.cs</code> module showed that the indication of this initialization is the <code>internal</code> <code>Sealed</code> property.  In order not to overload the code of the example, I do not give an implementation of the <code>SetPropValu</code> method, but I think it would be easy for anyone to write a change in the property of an object through reflection. <br><br>  <i>If someone from WPF hackers tell you how to solve this problem more beautifully - write in the comments, plz.</i> <br><br>  Now the <code>ContentChangedCallback</code> method will be called up at the time of installation of new content for <code>BusyIndicator</code> 'a.  The first line of this method is very important - because  this method will be called for all <code>BusyIndicator</code> , and not just the one in which we set the <code>AsyncIndicator.Attached="true"</code> property. <code>AsyncIndicator.Attached="true"</code> .  Therefore, we check that the value of this property is exactly <code>true</code> . <br><br>  The second line of this method disables the event by changing the ItemsSource for the previous content, and the third, on the contrary, adds an event to the new content. <br><br>  Consider the <code>SetBusyIndicator</code> method: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> DependencyProperty _busyIndicatorProperty = DependencyProperty.RegisterAttached(<span class="hljs-string"><span class="hljs-string">"%BusyIndicatorProperty%"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> (ContentControl), <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> (DependencyObject)); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetBusyIndicator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DependencyObject contentObject, DependencyObject busyIndicator</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (contentObject != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { SetPropertyChangedCallback(GetItemsSourceValue(contentObject), contentObject, ItemsSourceChangedCallback, busyIndicator == <span class="hljs-literal"><span class="hljs-literal">null</span></span>); contentObject.SetValue(_busyIndicatorProperty, busyIndicator); } UpdateBusyIndicator(busyIndicator, contentObject); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetItemsSourceValue</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DependencyObject contentObject</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> itemsSourceProperty = contentObject.GetFieldValue(<span class="hljs-string"><span class="hljs-string">"ItemsSourceProperty"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> contentObject == <span class="hljs-literal"><span class="hljs-literal">null</span></span> ? <span class="hljs-literal"><span class="hljs-literal">null</span></span> : contentObject.GetValue(itemsSourceProperty); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateBusyIndicator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DependencyObject busyIndicator, DependencyObject contentObject</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (busyIndicator == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (contentObject == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) busyIndicator.SetPropValue(<span class="hljs-string"><span class="hljs-string">"IsBusy"</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> itemsSource = contentObject == <span class="hljs-literal"><span class="hljs-literal">null</span></span> ? <span class="hljs-literal"><span class="hljs-literal">null</span></span> : contentObject.GetValue(GetItemsSourceValue(contentObject)); busyIndicator.SetPropValue(<span class="hljs-string"><span class="hljs-string">"IsBusy"</span></span>, itemsSource == <span class="hljs-literal"><span class="hljs-literal">null</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ItemsSourceChangedCallback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DependencyObject contentObject, DependencyPropertyChangedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> busyIndicator = contentObject == <span class="hljs-literal"><span class="hljs-literal">null</span></span> ? <span class="hljs-literal"><span class="hljs-literal">null</span></span> : contentObject.GetValue(_busyIndicatorProperty) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> DependencyObject; UpdateBusyIndicator(busyIndicator, contentObject); }</code> </pre><br>  This code also requires some explanation: <br>  First, the <code>SetBusyIndicator</code> method sets an event handler to change the <code>dependency property ItemsSource</code> change in a way we already know. <br>  Secondly, you need to somehow save the link to the instance of <code>busyIndicator</code> in the <code>contentObject</code> control in <code>contentObject</code> for the <code>contentObject</code> know to which <code>BusyIndicator</code> 'y to change the <code>IsBusy</code> attribute.  The simplest and most obvious solution for this, it seemed to me, was to use another private <code>dependency property _busyIndicatorProperty</code> . <br>  Thirdly, in the <code>UpdateBusyIndicator</code> method <code>UpdateBusyIndicator</code> we set the reflection to set the IsBusy property of our BusyIndicator stored in <code>_busyIndicatorProperty</code> . <br><br>  <a href="http://pastebin.com/hrq0tGKz">Full text of the example</a> <br><br>  <i>Thanks for attention.</i> </div><p>Source: <a href="https://habr.com/ru/post/142127/">https://habr.com/ru/post/142127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../142118/index.html">Enigma Encryption Machine in Excel</a></li>
<li><a href="../142120/index.html">62 useful tools for responsive design (Responsive web design)</a></li>
<li><a href="../142122/index.html">Simplified User Agreement (ToS)</a></li>
<li><a href="../142124/index.html">Release SBShop 1.0 - online store for MODX Evolution</a></li>
<li><a href="../142126/index.html">Nostalgia: digging near the ‚ÄúTanchiki‚Äù under the hood</a></li>
<li><a href="../142128/index.html">Authentication in rails applications using facebook, vkontakte</a></li>
<li><a href="../142130/index.html">Epic Fail with VMWare Newsletters</a></li>
<li><a href="../142131/index.html">VolgaCTF as a member</a></li>
<li><a href="../142134/index.html">15 largest transactions on the Internet</a></li>
<li><a href="../142135/index.html">Epic Fail with Evernote Newsletters</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>