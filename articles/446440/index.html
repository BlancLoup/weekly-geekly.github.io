<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The book "React quickly. Web applications on React, JSX, Redux and GraphQL ¬ª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habrozhiteli! The original edition came out in the fall of 2017, but is still considered the best book for exploring React. The author constantly ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The book "React quickly. Web applications on React, JSX, Redux and GraphQL ¬ª</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habr.com/ru/company/piter/blog/446440/"><img src="https://habrastorage.org/webt/za/bm/rw/zabmrwn_latmfqhxzpog6svpeoe.jpeg" align="left" alt="image"></a>  Hi, Habrozhiteli!  The original edition came out in the fall of 2017, but is still considered the best book for exploring React.  The author constantly updates and refines the code for the book in the <a href="https://github.com/azat-co/react-quickly">Github</a> repository. <br><br>  We offer in the post to get acquainted with the passage "States and their role in the interactive nature of React" <br><br>  If you had to read only one chapter in this book, it would be worth choosing this one!  Without states, the React components remain nothing more than enhanced static templates.  I hope you share my enthusiasm, because understanding the concepts of this chapter will allow you to build much more interesting applications. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  Imagine that you are building an input field with auto-completion (Fig. 4.1).  When entering data, the field should issue a request to the server to get information about suitable options for displaying the output on a web page.  So far you have worked with properties, and you know that changing properties allows you to get different views.  However, properties cannot be changed in the context of the current component, because they are passed when the component is created. <br><br><img src="https://habrastorage.org/webt/hv/b_/s0/hvb_s0fbckd7lprixqyfldxeyao.png" align="left" alt="image">  In other words, properties are immutable in the current component, which means that you cannot change the properties in this component, unless you create the component again and transfer new values ‚Äã‚Äãfrom the parent (Fig. 4.2).  But the information received from the server, you need to save somewhere, and then display a new list of options in the view.  How to update the view if the properties can not be changed? <br><br>  One possible solution is to render the item with new properties every time you receive a new response from the server.  But then you have to place the logic outside the component - and the component ceases to be self-sufficient.  Obviously, if the property values ‚Äã‚Äãcannot be changed, and auto-completion should be self-sufficient, the properties cannot be used.  Then the question arises: how to update views in response to events without re-creating the component (createElement () or JSX &lt;NAME /&gt;)?  It is this problem that states solve. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rh/2n/rm/rh2nrmgxmoggbssmhcytpnqlwmk.png" alt="image"></div><br>  After the response from the server is ready, the callback code will change the state of the component accordingly.  You will have to write this code yourself.  However, after the state is updated, React will automatically update the view for you (only in those places where it should be updated, that is, where state data is used). <br><br>  With the state of React components, you can build interactive, meaningful React applications.  State is a fundamental concept that allows you to build React components that can store data and automatically update views in accordance with changes in data. <br><br><h3>  What is the state of the React component? </h3><br>  A React state is a variable component data store ‚Äî autonomous, function-oriented user interface and logic blocks.  ‚ÄúVariability‚Äù means that the values ‚Äã‚Äãof the states are subject to change.  By using the state in the view (render ()) and changing the values ‚Äã‚Äãlater, you can influence the appearance of the view. <br><br>  Metaphor: if we imagine a component in the form of a function, to the input of which properties and state are transmitted, then the result of the function will be a description of the user interface (presentation).  Properties and states extend views, but they are used for different purposes (see Section 4.3). <br><br>  By working with states, you refer to them by name.  A name is an attribute (that is, an object key or an object property ‚Äî not a component property) of the this.state object, for example, this.state.autocompleMatches or this.state.inputFieldValue. <br><br>  State data is often used to display dynamic information in a view to extend the rendering of views.  Returning to the earlier example of an auto-complete field: the state changes in response to an XHR request to the server, which, in turn, is triggered by the input of data in the field.  React provides an update of views when the state used in views changes.  In fact, when a state changes, only the relevant parts of the views change (up to individual elements and even the attribute values ‚Äã‚Äãof an individual element). <br><br>  Everything else in the DOM remains unchanged.  This is possible due to the virtual DOM model (see Section 1.1.1), which React uses to determine the delta (set of changes) in the reconciliation process.  This fact allows you to write code in a declarative style.  React does all the routine work for you.  The main stages of changing the presentation are discussed in Chapter 5. <br><br>  React developers use states to generate new user interfaces.  Component properties (this.props), ordinary variables (inputValue) and class attributes (this.inputValue) are not suitable for this, because changing their values ‚Äã‚Äã(in the context of the current component) does not trigger changes to the view.  For example, the following snippet is antipattern, which indicates that changing a value in any location other than the state will not update the view: <br><br><pre><code class="plaintext hljs">// :   ! let inputValue = 'Texas' class Autocomplete extends React.Component { updateValues() ‚Üê {      ( ) this.props.inputValue = 'California' inputValue = 'California' this.inputValue = 'California' } render() { return ( &lt;div&gt; {this.props.inputValue} {inputValue} {this.inputValue} &lt;/div&gt; ) } }</code> </pre> <br>  Now let's see how to work with the states of the React components. <br><br><h3>  Work with states </h3><br>  To work with states, you must be able to access values, update them, and set initial values.  Let's start by referring to the states in the React components. <br><br><h3>  Appeal to states </h3><br>  The state object is an attribute of the component, and it should be accessed through a this link, for example this.state.name.  As you remember, variables can be accessed and displayed in JSX code in curly braces ({}).  Similarly, in render () you can render this.state (like any other variable or class attribute of a nonstandard component), for example {this.state.inputFieldValue}.  This syntax is similar to the syntax for accessing properties in this.props.name. <br><br><img src="https://habrastorage.org/webt/ei/wy/cj/eiwycjaglq1319bi377c13zyat8.png" align="left" alt="image">  We use what you learned to implement the clock in fig.  4.3.  Our goal is to create a standalone component class that anyone can import and use in their application without much hassle.  The clock should display the current time. <br><br>  The project has the following structure: <br><br><pre> <code class="plaintext hljs">/clock index.html /jsx script.jsx clock.jsx /js script.js clock.js react.js react-dom.js</code> </pre> <br>  I use the Babel CLI with the tracking flags (-w) and the directory (-d) to compile all the JSX source files from clock / jsx to the target folder clock / js and recompile when changes are detected.  In addition, I saved the command as a npm script in the package.json file of the parent folder ch04 for executing the npm run build-clock command from ch04: <br><br><pre> <code class="plaintext hljs">"scripts": { "build-clock": "./node_modules/.bin/babel clock/jsx -d clock/js -w" },</code> </pre> <br>  Of course, time does not stand still (whether we like it or not).  Because of this, you must constantly update the view, and for this you can use the state.  Name it currentTime and try to render the state as shown in listing 4.1. <br><br>  Listing 4.1.  Render states in JSX <br><br><pre> <code class="plaintext hljs">class Clock extends React.Component { render() { return &lt;div&gt;{this.state.currentTime}&lt;/div&gt; } } ReactDOM.render( &lt;Clock /&gt;, document.getElementById('content') )</code> </pre> <br>  You will receive an error message: Uncaught TypeError: Cannot read property 'currentTime' of null.  Usually, JavaScript error messages are about as good as a glass of cold water for a drowning person.  Well, at least in this case, JavaScript displays a meaningful message. <br><br>  The message indicates that the currentTime value is undefined.  Unlike properties, states are not set in the parent.  Calling setState in render () also fails, because it will create a loop (setState ‚Üí render ‚Üí setState ...), and React will report an error. <br><br><h3>  Purpose of the initial state </h3><br>  You have already seen that it is necessary to initialize the state before using state data in render ().  To set the initial state, use this.state in the constructor with the syntax of the class ES6 React.Component.  Remember to call super () with properties;  otherwise, the logic in the parent (React.Component) will not work: <br><br><pre> <code class="plaintext hljs">class MyFancyComponent extends React.Component { constructor(props) { super(props) this.state = {...} } render() { ... } }</code> </pre> <br>  When assigning an initial state, you can also add other logic ‚Äî for example, set the value to currentTime using new Date ().  You can even use toLocaleString () to get the correct date / time format for the current location of the user, as shown below (ch04 / clock). <br><br>  Listing 4.2.  Clock Component Constructor <br><br><pre> <code class="plaintext hljs">class Clock extends React.Component { constructor(props) { super(props) this.state = {currentTime: (new Date()).toLocaleString()} } ... }</code> </pre> <br>  The value of this.state must be an object.  We will not go into the details of constructor () from ES6;  Refer to Appendix D and ES6 at <a href="https://github.com/azat-co/cheatsheets/tree/master/es6">github.com/azat-co/cheatsheets/tree/master/es6</a> .  The bottom line is that, as in other OOP languages, the constructor (that is, the constructor ()) is called when an instance of the class is created.  The name of the constructor method must be exactly that;  consider this one of the rules of ES6.  In addition, when creating the constructor () method, it almost always has to include a call to super (), without which the parent constructor will not be executed.  On the other hand, if you do not define the constructor () method, then the super () call will be assumed by default. <br><br>  The name currentTime is arbitrary;  you must use the same name later when reading and updating this state. <br><br>  The state object may contain nested objects or arrays.  In the following example, an array with book descriptions is added to the state: <br><br><pre> <code class="plaintext hljs">class Content extends React.Component { constructor(props) { super(props) this.state = { githubName: 'azat-co', books: [ 'pro express.js', 'practical node.js', 'rapid prototyping with js' ] } } render() { ... } }</code> </pre> <br>  The constructor () method is called only once, when creating a React element based on a class.  Thus, you can set the state directly using this.state only once - in the constructor () method.  Do not install or update the state directly with this.state = ... somewhere else, as this may lead to unintended consequences. <br><br>  So you only get the original value, which will very quickly become obsolete - in just 1 second.  Who needs a watch that does not show the current time?  Fortunately, there is a mechanism for updating the current state. <br><br><h3>  Status update </h3><br>  The state is changed by the method of the class this.setState (data, callback).  When this method is called, React merges data with the current states and calls render (), and then calls a callback. <br><br>  The definition of a callback in setState () is important because the method works asynchronously.  If the operation of the application depends on the new state, you can use this callback to make sure that the new state has become available. <br><br>  If you just assume that the state has been updated without waiting for the completion of setState (), that is, working synchronously when performing an asynchronous operation, an error may occur: the program‚Äôs operation depends on updating the state values, and the state remains old. <br>  So far, we have rendered time from state.  You already know how to set the initial state, but it should be updated every second, right?  To do this, use the setInterval () browser's timer function (http://mng.bz/P2d6), which will update the state every n milliseconds.  The setInterval () method is implemented in almost all modern browsers as a global one, which means that it can be used without any additional libraries or prefixes.  Example: <br><br><pre> <code class="plaintext hljs">setInterval(()=&gt;{ console.log('Updating time...') this.setState({ currentTime: (new Date()).toLocaleString() }) }, 1000)</code> </pre> <br>  To start the countdown, you need to call setInterval () only once.  Create a launchClock () method exclusively for this purpose;  launchClock () will be called in the constructor.  The final version of the component is shown in listing 4.3 (ch04 / clock / jsx / clock.jsx). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wk/uz/ez/wkuzezejgvya-npm71161pn-_aa.png" alt="image"></div><br>  The setState () method can be called anywhere, not only in the launchClock () method (which is called in the constructor), as in the example.  Typically, the setState () method is called from an event handler or as a callback when it arrives or updates data. <br><br><blockquote>  TIP An attempt to change the state in the code with a command like this.state.name = 'new name' will lead to nothing.  It will not re-render and update the real DOM, whatever you want.  In most cases, a direct state change without setState () is an anti-pattern and should be avoided. </blockquote><br>  It is important to note that the setState () method updates only those states that were transferred to it (partially or with merge, but without full replacement).  It does not replace the entire state object every time.  Therefore, if only one of the three states has changed, the other two will remain unchanged.  In the following example, userEmail and userId will not be changed: <br><br><pre> <code class="plaintext hljs">constructor(props) { super(props) this.state = { userName: 'Azat Mardan', userEmail: 'hi@azat.co', userId: 3967 } } updateValues() { this.setState({userName: 'Azat'}) }</code> </pre> <br>  If you intend to update all three states, you will have to do this explicitly by passing the new values ‚Äã‚Äãof these states to setState ().  (Also, in the old code, which is no longer working, the this.replaceState () method is sometimes found; it is officially recognized as obsolete. As you might guess by name, it replaced the entire state object with all its attributes.) <br><br>  Remember that calling setState () triggers the execution of render ().  In most cases, it works.  In some special cases in which the code depends on external data, you can initiate a re-render by calling this.forceUpdate ().  However, such solutions are undesirable because relying on external data (instead of state) makes the components less reliable and dependent on external factors (hard linking). <br><br>  As mentioned earlier, the state object can be accessed in this.state entries.  In JSX, the displayed values ‚Äã‚Äãare enclosed in curly brackets ({}), therefore, the declaration {this.state.NAME} should be applied to declare the state property in the view (that is, in the return command of the render method). <br><br>  React magic occurs when you use state data in a view (for example, in output, in an if / else command, as an attribute value or the value of a child element property), and then pass new values ‚Äã‚Äãto setState ().  Bah!  React updates all the necessary HTML markup for you.  This can be seen in the DevTools console, where the ‚ÄúUpdating ...‚Äù and ‚ÄúRendering ...‚Äù cycles should be displayed.  And the most remarkable thing is that it will only affect the absolute minimum of the required DOM elements. <br><br>  ¬ªMore information about the book can be found on <a href="https://www.piter.com/collection/react/product/react-bystro-veb-prilozheniya-na-react-jsx-redux-i-graphql%3F_gs_cttl%3D120%26gs_direct_link%3D1%26gsaid%3D82744%26gsmid%3D29789%26gstid%3Dc">the publisher's website.</a> <br>  ¬ª <a href="https://storage.piter.com/upload/contents/978544610952/978544610952_X.pdf">Table of Contents</a> <br>  ¬ª <a href="https://storage.piter.com/upload/contents/978544610952/978544610952_p.pdf">Excerpt</a> <br><br>  For Habrozhiteley 20% discount coupon - <b>React</b> <br><br>  Upon payment of the paper version of the book, an electronic version of the book is sent to the e-mail. </div><p>Source: <a href="https://habr.com/ru/post/446440/">https://habr.com/ru/post/446440/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../446430/index.html">Levitating nanoparticle cooling via optical resonator</a></li>
<li><a href="../446432/index.html">A seminar on technical document circulation was held in Crimea</a></li>
<li><a href="../446434/index.html">Scaling Zimbra Collaboration Suite</a></li>
<li><a href="../446436/index.html">How to generate hypotheses about the needs of potential consumers of your future product</a></li>
<li><a href="../446438/index.html">Our experience in creating API Gateway</a></li>
<li><a href="../446442/index.html">Happy Party or a couple of memory lines about your introduction to PostgreSQL10 partitioning</a></li>
<li><a href="../446444/index.html">From Skype to WebRTC: how we organized video calling over the web</a></li>
<li><a href="../446446/index.html">Basics of JavaScript engines: common forms and inline caching. Part 1</a></li>
<li><a href="../446448/index.html">5 basic rules for conducting problem interviews to identify consumer needs</a></li>
<li><a href="../446452/index.html">Lunar mission "Bereshit" - April 4, 2019 made a transition to lunar orbit, ahead of 7 days of flight, 6 maneuvers and 1 landing</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>