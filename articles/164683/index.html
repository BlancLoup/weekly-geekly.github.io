<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Pictures in doc-file: weight reduction by surgery</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once upon a time there was one translation in the world (as a process, and not as a result). It existed in the following way: slices were cut from pdf...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Pictures in doc-file: weight reduction by surgery</h1><div class="post__text post__text-html js-mediator-article"> Once upon a time there was one translation in the world (as a process, and not as a result).  It existed in the following way: slices were cut from pdfs with the original text, inserted directly into Word, and Russian text appeared from below through considerable mental effort, and, as a rule, a couple of other footnotes.  And if in the original there were footnotes, then pictures also appeared in footnotes.  The translation went, and the file grew - there were 51 images in the 16-page file, and Word began to work so slowly that the translation could not be the result. <br>  For some reason, the built-in function of image compression did not help at all, so it was decided to perform an intervention surgically. <br><a name="habracut"></a><br>  The file looks like this (narrow columns are not text, but pictures): <br><img src="https://habrastorage.org/storage2/8fa/8e1/b4b/8fa8e1b4b917a0278997a203733c2ded.png"><br><br>  You can also get into the doc-file inside, but it is much easier to do this in .docx.  Re-save.  We see that re-saving by itself has yielded nothing - both the file weighed 12 megabytes and weighs. <br><img src="https://habrastorage.org/storage2/96d/7f4/6f6/96d7f46f617aee2832694271618a57aa.png"><br><br>  As you know, the .docx file is a zip-archive with a special internal structure - therefore, without any difficulty looking into his guts, and there ... <br><img src="https://habrastorage.org/storage2/9ee/853/8a9/9ee8538a9d249aab6cb3778a78d24923.png"><br>  in the unpacked form, the <code>word</code> directory would weigh <i>almost seven hundred megabytes</i> !  No wonder Word refuses to work ... <br>  Of course, the main culprit is the images, each of which takes about ten megabytes: <br><img src="https://habrastorage.org/storage2/172/268/4a5/1722684a5424a8bd34a54d3b1a190478.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I wonder why obviously raster images Word stores in EMF - vector format?  Probably, there is some deep explanation that will involve the argument about the PDF source (‚Äúafter all, PDF is also a vector format!‚Äù), But right now we don‚Äôt care.  In order not to be confused by editing the document.xml file when changing the format of the figures, we will limit ourselves only to reducing their size.  Fortunately, IrfanView among all other useful functions can write EMF (Photoshop, for example, does not know how out of the box).  And he can also reduce the image packs - this function we use.  800 pixels on the long side is enough. <br><img src="https://habrastorage.org/storage2/d76/d19/9eb/d76d199ebb3891e182271bae30c009dc.png"><br>  (in the picture above, on the right, a fragment of the letter g is visible - and this is also the original version, which is reduced in width to the screen) <br><br>  After that, you can pack back the modified files - they will weigh significantly less (15 times): <br><img src="https://habrastorage.org/storage2/c73/38f/72a/c7338f72a5b94d7afc30f324542a2b67.png">  . <br><br>  Word calmly ate this file.  True, when you save it back to .doc, it is somewhat stouter, but still not so much: <br><img src="https://habrastorage.org/storage2/8cb/51e/142/8cb51e1428a9f76387ed45fe58904ab7.png"><br><br>  <b>Total</b> : the file is compressed 6.5 times without reducing the visible quality (the file is not intended for printing, but even in this case it would look good), the translation process went much faster (and with a smaller number of expletives), and at home it became somewhat calmer that, no doubt, is a major achievement. <br><br>  <b>UPD:</b> <br>  <a href="http://habrahabr.ru/post/164683/">Discussion</a> in the comments, for what reason, Word inserts images in the EMF </div><p>Source: <a href="https://habr.com/ru/post/164683/">https://habr.com/ru/post/164683/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../164671/index.html">A look at the design process</a></li>
<li><a href="../164673/index.html">GravityLight: a $ 5 light bulb that works on gravity</a></li>
<li><a href="../164675/index.html">High resolution patches - new life of old games</a></li>
<li><a href="../164677/index.html">jQuery from the inside - DOM manipulations</a></li>
<li><a href="../164679/index.html">Webinar: Sikuli - simple examples of proper automation (Java)</a></li>
<li><a href="../164685/index.html">Rails params & gc</a></li>
<li><a href="../164687/index.html">Alternative terminal for Windows</a></li>
<li><a href="../164689/index.html">We are looking for money. Catalog of investors for a startup</a></li>
<li><a href="../164693/index.html">OMNI-395 payment terminal from the inside</a></li>
<li><a href="../164695/index.html">Mars rover Spirit went down to Mars 9 years ago</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>