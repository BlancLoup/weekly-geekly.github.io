<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Debian's RISC under QEMU</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For embedded systems based on MIPS and ARM architectures, specialized GNU / Linux distribution generators are often used: buildroot, openwrt, and othe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Debian's RISC under QEMU</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/4de/acf/fff/4deacfffff854b80b56b11d567bf4e91.png"><br>  For embedded systems based on MIPS and ARM architectures, specialized GNU / Linux distribution generators are often used: buildroot, openwrt, and other Yocto. <br>  But sometimes it is interesting to run a universal Debian OS on such a system.  Installing Debian on a computer with an x86 / amd64 architecture processor is simple, but with embedded systems, <em>believe me, everything is not so simple ...</em> <br>  In this publication, I will tell you how to install using debootstrap, and then how to use Debian for running a Debian operating system for computers with MIPS and ARM processors using QEMU. <br><a name="habracut"></a><br><br><h3>  Introduction </h3><br>  GNU / Linux operating systems most often consist of at least two components: the OS kernel (kernel) and the user programs (userspace).  The Linux kernel (yes, yes, this is exactly the kernel called Linux!) Directly interacts with the hardware and provides user programs access to computer hardware resources using abstract interfaces. <br>  While the kernel is strongly tied to a specific SoC family or even to a specific board, user applications are much more ‚Äúloose‚Äù components;  their executable files are tied only to a specific version of the processor command system (for example, MIPS-I or MIPS32r2), and to the version of the kernel programming interfaces. <br>  This state of affairs turns out to be the following: it becomes possible to run the same applications on completely different SoCs, on completely different boards, the main thing is to ensure that the program interfaces of the kernel are the same. <br>  Such a ‚Äúlag‚Äù of applications can be very useful in practice.  For example, the <a href="https://geektimes.ru/post/255054/">Raspbian and QEMU</a> publication describes the launch of the Raspbian OS for the Raspberry Pi on an ARM Versatile card emulated with QEMU. <br><br><h3>  Action plan </h3><br>  From the above, it is clear that to run Debian on an emulated MIPS (or ARM) board we need: <br><ul><li>  Linux kernel that runs on QEMU; </li><li>  image of the Debian root filesystem (i.e. the applications mentioned above). </li></ul><br>  We will build the Linux kernel using cross-development tools on our own, and we will entrust the creation of an image of the root file system of Debian to the debootstrap program. <br>  We will use a computer with an x86_64 processor running the Debian Linux testing version as an instrumental computer (a computer on which we will cross-compile and run the QEMU emulator). <br><div class="spoiler">  <b class="spoiler_title">Why choose Debian testing?</b> <div class="spoiler_text">  Because out-of-the-box Debian testing supports a comparatively recent version of QEMU and cross-compilers for both MIPS and ARM. <br></div></div><br>  All actions to build the kernel and form an image of the root file system are performed from the command line, do not require operator intervention, and can easily be placed inside a script. <br>  Commands to be executed as root are preceded by a <code>#</code> character, commands that do not need superuser privileges are preceded by a <code>$</code> character. <br>  For example: <br><ul><li>  The command for installing the software is executed as the root user: <br><blockquote><pre> # aptitude install -y binfmt-support qemu qemu-user-static debootstrap </pre></blockquote></li><li>  The linux kernel build command can be executed on behalf of an unprivileged user: <br><blockquote><pre> $ make </pre></blockquote></li></ul><br><div class="spoiler">  <b class="spoiler_title">How to quickly build the required tool computer?</b> <div class="spoiler_text">  The required tool computer is easy to build with virtualization software (VMWare, VirtualBox or QEMU / KVM). <br>  For this: <br><ul><li>  Download the <a href="">debian-8.3.0-amd64-netinst.iso</a> network installation disk <a href="">image</a> , </li><li>  Create a virtual computer with the following minimum parameters: RAM: 1 GB, HDD: 8 GB;  connect the Debian installation boot disk to the virtual computer; </li><li>  start the virtual computer with the download of the Debian installer from the installation disk; </li><li>  Install the Debian virtual computer OS on an almost minimal configuration (for example, to launch QEMU there is no need to install the components of a web server and a graphical user interface): </li></ul><br><img src="https://habrastorage.org/files/0fb/5e0/214/0fb5e02145dd4623b584cd2aab6593d5.png"><br><ul><li>  Download the newly installed Debian OS, and log in as root; </li><li>  enable the ability to install Debian packages of the testing version, to do this in the command line <br><blockquote><pre> # echo "deb http://ftp.ru.debian.org/debian/ testing main non-free contrib" \
         &gt;&gt; /etc/apt/sources.list
 # apt-get update </pre></blockquote></li></ul><br><blockquote>  Note: in a good way, it would be better to do <code>apt-get dist-upgrade</code> after <code>apt-get update</code> , but if you want to use a virtual machine only to start Debian MIPS / ARM, then this is not necessary at all. <br></blockquote><br></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Debian for MIPS </h3><br>  Debian for MIPS under QEMU will be demonstrated on a MIPS Malta virtual board with a MIPS32R2 architecture processor in big-endian mode. <br><br><h4>  Linux kernel build for QEMU Malta </h4><br>  First, let's take care of getting the source code for the kernel - download it from kernel.org: <br><blockquote><pre> $ wget https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-4.4.3.tar.xz </pre></blockquote><br>  Unpack the archive and go to the <code>linux-4.4.3</code> directory: <br><blockquote><pre> $ tar fx linux-4.4.3.tar.xz
 $ cd linux-4.4.3 </pre></blockquote><br>  Install the toolchain for MIPS: <br><blockquote><pre> # aptitude install -y gcc-mips-linux-gnu </pre></blockquote><br>  In addition to the toolchain for MIPS, additional tools will be needed to build the Linux kernel: <br><blockquote><pre> # aptitude install -y make gcc gawk </pre></blockquote><br>  Prepare for assembly under MIPS: <br><blockquote><pre> $ export ARCH = mips
 $ export CROSS_COMPILE = mips-linux-gnu- </pre></blockquote><br>  The <code>ARCH</code> variable explains to the kernel build system (Kbuild) that all platform-specific kernel components are taken in the <code>arch/mips</code> directory, and the <code>CROSS_COMPILE</code> variable explicitly tells Kbuild which compiler (or rather toolchain) to use - they can be several on the machine, and Kbuild likes accuracy. <br><div class="spoiler">  <b class="spoiler_title">A note about ARCH and CROSS_COMPILE</b> <div class="spoiler_text">  In principle, you can not do this, and each time you can set the <code>ARCH</code> and <code>CROSS_COMPILE</code> on the make command line, but then the make line will look somewhat cumbersome. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Note about out of tree build</b> <div class="spoiler_text">  The Linux kernel build order described below is called <em>in tree build</em> , i.e.  compiled object files fall into the same directories as the source files.  Kbuild allows you to use the <em>out of tree build</em> order, in which the object files fall into a separate directory, which allows you to collect several different kernel variants from the same source code, while the object files of different kernel variants will not conflict.  For details, see, for example, <a href="http://www.crashcourse.ca/wiki/index.php/Building_kernel_out_of_tree">here</a> . <br></div></div><br>  Now select the configuration for the core based on the pre-configured configuration for the Malta board. <br>  The preparation of the configuration file for the Malta <code>arch/mips/configs/malta_defconfig</code> that ships in linux-4.4.3 does not work for two reasons: <br><ul><li>  The configuration is designed for Malta in little-endian mode, and I would like to use big-endian mode. </li><li>  in the <code>malta_defconfig</code> configuration, the options ( <code>CONFIG_FHANDLE</code> and <code>CONFIG_CGROUPS</code> ) are not enabled, without which Debian 8 simply will not boot. </li></ul><br>  Based on the <code>malta_defconfig</code> we will create the necessary <code>malta_defconfig</code> configuration file <code>malta-big_defconfig</code> , which will not have these disadvantages: <br><blockquote><pre> $ sed "s / CONFIG_CPU_LITTLE_ENDIAN = y / CONFIG_CPU_BIG_ENDIAN = y /" \
         &lt;arch / mips / configs / malta_defconfig \
         &gt; arch / mips / configs / malta-big_defconfig
 $ echo "CONFIG_FHANDLE = y" &gt;&gt; arch / mips / configs / malta-big_defconfig
 $ echo "CONFIG_CGROUPS = y" &gt;&gt; arch / mips / configs / malta-big_defconfig </pre></blockquote><br>  Now, from the workpiece, we will generate the kernel configuration file <code>.config</code> : <br><blockquote><pre> $ make malta-big_defconfig </pre></blockquote><br>  And run the build process: <br><blockquote><pre> $ make </pre></blockquote><br><blockquote>  Note: If your tool computer has more than one processor core, you should use them.  In order to parallelize the make operation, the -j option is used, the argument of which is the number of tasks (commands) that make will try to run at the same time.  So on a 4-processor instrumental computer, it makes sense to run make like this: <code>$ make -j 4</code> <br></blockquote><br>  As a result, we get the <code>vmlinux</code> kernel <code>vmlinux</code> .  Check its performance under QEMU! <br>  Install QEMU: <br><blockquote><pre> # aptitude install -y qemu-system </pre></blockquote><br>  Run the newly compiled kernel under QEMU, after leaving the linux-4.4.3 directory: <br><blockquote><pre> $ cd ..
 $ qemu-system-mips -nodefaults -nographic -kernel linux-4.4.3 / vmlinux -serial stdio
 Linux version 4.4.3 (user @ debian) (gcc version 5.3.1 20160205 (Debian 5.3.1-8))
 earlycon console serial ix port 0x3f8 (options '38400n8')
 bootconsole [uart0] enabled
 Config serial console: console = ttyS0,38400n8r
 CPU0 revision is: 00019300 (MIPS 24Kc)
 FPU revision is: 00739300
 MIPS: machine is mti, malta<font></font>
<font></font>
 ...
 Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block (0,0) </pre></blockquote><br>  As you can see, the kernel successfully passed the initialization and tried to mount the root file system, which, however, did not work. <br>  Create the necessary root filesystem! <br><br><h4>  Creating a root file system for MIPS </h4><br>  Creating the Debian root filesystem will therefore begin with the installation of debootstrap and the components necessary for it to work: <br><blockquote><pre> # aptitude install -y binfmt-support qemu qemu-user-static debootstrap </pre></blockquote><br>  Now run the first stage of debootstrap: <br><blockquote><pre> # debootstrap --foreign --arch = mips jessie debian-jessie-mips / \
         http://ftp.ru.debian.org/debian/ </pre></blockquote><br>  At the first stage, debootstrap will download the jessie version (stable) Debian packages required for the minimal root filesystem from <a href="http://ftp.ru.debian.org/debian/">ftp.ru.debian.org/debian</a> (the official Russian Debian mirror) for the 32-bit MIPS big-endian architecture (options <code>--foreign</code> and <code>--arch=mips</code> ), and unpack them into the <code>debian-jessie-mips/</code> directory. <br>  According to the results of the first stage of debootstrap, a file system will be formed in the <code>debian-jessie-mips/</code> directory, very similar to the real one, you can even try to use it for downloading.  However, the root filesystem components (Debian packages) are not yet configured at this stage. <br>  To perform the setup, you must run the second stage of debootstrap.  At this stage, you need to run programs for MIPS, so you have to use a special version of QEMU, the so-called usermode qemu, which ensures the launch of separate programs for Linux MIPS under Linux amd64. <br>  We will put a statically assembled system emulator with a MIPS architecture processor inside the root file system and run debootstrap inside the root file system using chroot: <br><blockquote><pre> # cp / usr / bin / qemu-mips-static debian-jessie-mips / usr / bin /
 # DEBIAN_FRONTEND = noninteractive DEBCONF_NONINTERACTIVE_SEEN = true \
         LC_ALL = C LANGUAGE = C LANG = C \
         PATH = / usr / local / bin: / usr / bin: / bin: / usr / local / sbin: / usr / sbin: / sbin \
         chroot debian-jessie-mips / / debootstrap / debootstrap - second-stage </pre></blockquote><br>  When the second stage of debootstrap is finished, the components of the Debian root filesystem are configured, and it remains to put the final touches (for example, fix some files in <code>/etc</code> , say, configure the host and network, add users, etc.). <br>  But for this demo, we will limit ourselves to installing the trivial password 123 for the root user: <br><blockquote><pre> # echo 'root: 123' |  chroot debian-jessie-mips / chpasswd </pre></blockquote><br>  Now the root file system can be considered configured - it's time to cover up the tracks.  For safekeeping, archive the root file system: <br><blockquote><pre> # rm debian-jessie-mips / usr / bin / qemu-mips-static
 # tar czf debian-jessie-mips.tar.gz -C debian-jessie-mips. </pre></blockquote><br>  To run under the emulator, the root file system will have to be placed on a virtual drive (in the case of Malta it is a virtual IDE disk). <br>  Let us estimate the size of the disk we will have to create: <br><blockquote><pre> # du -sh debian-jessie-mips /
 284M debian-jessie-mips / </pre></blockquote><br>  Once the root file system is less than 300 MB, it is quite possible to allocate a virtual disk of 512 MB for its storage.  Create a virtual disk file, create an ext2 file system on it, and copy our root file system to it: <br><blockquote><pre> $ dd if = / dev / zero bs = 1M count = 512 of = debian-jessie-mips.ext2
 $ / sbin / mke2fs -F debian-jessie-mips.ext2<font></font>
<font></font>
 # mkdir ext2
 # mount debian-jessie-mips.ext2 ext2 /
 # tar xf debian-jessie-mips.tar.gz -C ext2 /
 # umount ext2 /
 # rmdir ext2 / </pre></blockquote><br>  Now we will start Debian Linux under QEMU: <br><blockquote><pre> $ qemu-system-mips -nodefaults -nographic -kernel linux-4.4.3 / vmlinux \
         -serial stdio -hda debian-jessie-mips.ext2 -append "root = / dev / sda" </pre></blockquote><br>  After the <code>login:</code> prompt appears <code>login:</code> you can log in as root (the password is 123) and check the processor type: <br><img src="https://habrastorage.org/files/495/7e4/aa5/4957e4aa54ba4914b7812328ffc10629.png"><br><br><h3>  Debian for ARM </h3><br>  Debian for ARM under QEMU will be demonstrated on the ARM Versatile PB virtual board. <br>  The steps to build a Linux kernel and create a root filesystem are almost completely similar to those for MIPS, so I‚Äôll only give a sequence of commands to achieve a result with minimal comments. <br>  We will assume that we are starting to work on a ‚Äúclean‚Äù instrumental computer. <br><br><h4>  Build Linux kernel for ARM Versatile PB </h4><br><blockquote><pre> $ wget https://cdn.kernel.org/pub/linux/kernel/v4.x/linux-4.4.3.tar.xz
 $ tar fx linux-4.4.3.tar.xz
 $ cd linux-4.4.3<font></font>
<font></font>
 # aptitude install -y gcc-arm-linux-gnueabi
 # aptitude install -y make gcc gawk<font></font>
<font></font>
 $ export ARCH = arm
 $ export CROSS_COMPILE = arm-linux-gnueabi- </pre></blockquote><br>  With the preparation of the kernel configuration for Versatile, you will have to tinker, since the built-in ROM Versatile PB emulated by QEMU is quite small (64 MB).  Fortunately, the emulated Versatile PB has a PCI controller to which you can connect a virtual SCSI controller.  However, support for this hardware will have to be enabled in the kernel: <br><blockquote><pre> $ cp arch / arm / configs / versatile_defconfig arch / arm / configs / versatile-debian_defconfig
 $ echo "CONFIG_FHANDLE = y" &gt;&gt; arch / arm / configs / versatile-debian_defconfig
 $ echo "CONFIG_CGROUPS = y" &gt;&gt; arch / arm / configs / versatile-debian_defconfig
 $ echo "CONFIG_DEVTMPFS = y" &gt;&gt; arch / arm / configs / versatile-debian_defconfig
 $ echo "CONFIG_TMPFS = y" &gt;&gt; arch / arm / configs / versatile-debian_defconfig
 $ echo "CONFIG_PCI = y" &gt;&gt; arch / arm / configs / versatile-debian_defconfig
 $ echo "CONFIG_SCSI = y" &gt;&gt; arch / arm / configs / versatile-debian_defconfig
 $ echo "CONFIG_BLK_DEV_SD = y" &gt;&gt; arch / arm / configs / versatile-debian_defconfig
 $ echo "CONFIG_SCSI_SYM53C8XX_2 = y" &gt;&gt; arch / arm / configs / versatile-debian_defconfig<font></font>
<font></font>
 $ make versatile-debian_defconfig
 $ make<font></font>
<font></font>
 # aptitude install -y qemu-system </pre></blockquote><br>  Unlike the MIPS Malta board, <code>vmlinux</code> download <code>vmlinux</code> for Versatile PB is not implemented, <code>zImage</code> images are <code>zImage</code> : <br><blockquote><pre> $ cd ..
 $ qemu-system-arm -nodefaults -nographic -M versatilepb \
         -kernel linux-4.4.3 / arch / arm / boot / zImage \
         -append "console = ttyAMA0" -serial stdio
 ...
 Uncompressing Linux ... done, booting the kernel.
 Booting Linux on physical CPU 0x0
 Linux version 4.4.3 (antony @ debian) (gcc version 5.3.1 20160205 (Debian 5.3.1-8))
 CPU: ARM926EJ-S [41069265] revision 5 (ARMv5TEJ), cr = 00093177
 CPU: VIVT data cache, VIVT instruction cache
 Machine: ARM-Versatile PB
 ...
 Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block (0,0) </pre></blockquote><br><br><h4>  Creating a root file system for ARM </h4><br><blockquote><pre> # aptitude install -y binfmt-support qemu qemu-user-static debootstrap
 # debootstrap --foreign --arch = armel jessie debian-jessie-armel \
         http://ftp.ru.debian.org/debian/
 # cp / usr / bin / qemu-arm-static debian-jessie-armel / usr / bin /
 # DEBIAN_FRONTEND = noninteractive DEBCONF_NONINTERACTIVE_SEEN = true \
         LC_ALL = C LANGUAGE = C LANG = C \
         PATH = / usr / local / bin: / usr / bin: / bin: / usr / local / sbin: / usr / sbin: / sbin \
         chroot debian-jessie-armel / / debootstrap / debootstrap --second-stage
 # echo 'root: 123' |  chroot debian-jessie-armel / chpasswd
 # rm debian-jessie-armel / usr / bin / qemu-arm-static
 # tar czf debian-jessie-armel.tar.gz -C debian-jessie-armel.<font></font>
<font></font>
 # du -sh debian-jessie-armel /
 270M debian-jessie-armel /<font></font>
<font></font>
 $ dd if = / dev / zero bs = 1M count = 512 of = debian-jessie-armel.ext2
 $ / sbin / mke2fs -F debian-jessie-armel.ext2<font></font>
<font></font>
 # mkdir ext2
 # mount debian-jessie-armel.ext2 ext2 /
 # tar xf debian-jessie-armel.tar.gz -C ext2 /
 # umount ext2 /
 # rmdir ext2 /<font></font>
<font></font>
 $ qemu-system-arm -nodefaults -nographic -M versatilepb \
         -kernel linux-4.4.3 / arch / arm / boot / zImage \
         -append "console = ttyAMA0 root = / dev / sda" \
         -serial stdio -hda debian-jessie-armel.ext2 </pre></blockquote><br>  The results of checking the type of processor (remember, the password is 123): <br><img src="https://habrastorage.org/files/359/f11/b2d/359f11b2d13b468abc7ae46213b63146.png"><br><br><h3>  Conclusion </h3><br>  As you can see, installing and running Debian for MIPS and ARM is not that difficult. <br>  Running Debian on a real motherboard with a MIPS or ARM processor is usually more troublesome and is worthy of a separate publication. <br><br><h3>  Links </h3><br><ul><li>  <a href="https://blog.aurel32.net/46">Aur√©lien Jarno: Debian QEMU images updated</a> </li><li>  <a href="http://www.elinux.org/How_to_make_a_debian_rootfs_for_MIPS_CI20">How to make a debian rootfs for MIPS CI20</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/278159/">https://habr.com/ru/post/278159/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278127/index.html">Anniversary digest of interesting materials from the world of web development and IT for the last week No. 200 (February 22 - 28, 2016)</a></li>
<li><a href="../278129/index.html">Azure Backup Server - free DPM</a></li>
<li><a href="../278137/index.html">PHP Digest number 80 - interesting news, materials and tools (February 14 - 28, 2016)</a></li>
<li><a href="../278151/index.html">Pathfinding: A simple implementation of a funnel algorithm (Funnel Algorithm)</a></li>
<li><a href="../278153/index.html">Part 1. Installing and Configuring a Reputable DNS Server Based on the PowerDNS Solution // Basic Installation</a></li>
<li><a href="../278163/index.html">CodingFuture + Puppet. Part III: Install Puppet Server (cfpuppetserver)</a></li>
<li><a href="../278165/index.html">Best practices Richard Siddeway Powershell in depth</a></li>
<li><a href="../278167/index.html">HTTP / 2: getting ready for the transition</a></li>
<li><a href="../278169/index.html">How to shoot yourself in Kotlin</a></li>
<li><a href="../278171/index.html">Simple checksum calculation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>