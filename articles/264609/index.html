<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Immersion into the abyss of the Python interpreter. P1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From the translator: Probably everyone is interested in what is inside the instrument that you use, this interest has taken possession of me, but the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Immersion into the abyss of the Python interpreter. P1</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/d2d/af8/a6b/d2daf8a6bfba4e1e85de156f18f835e8.jpg"><br><br>  <i>From the translator: Probably everyone is interested in what is inside the instrument that you use, this interest has taken possession of me, but the main thing is not to drown in it and not to dig in so that it does not crawl out.</i>  <i>Having found for myself an <a href="http://akaptur.com/blog/2013/11/15/introduction-to-the-python-interpreter/">interesting material</a> , I decided to carefully translate it and present it to the habrosocommunity (my first publication, please do not kick with my legs).</i>  <i>For those who are interested in how Python actually works, please follow under cat.</i> <br><a name="habracut"></a><br>  For the last three months I have spent a lot of time on <a href="https://github.com/nedbat/byterun">byterun</a> , an interpreter of Python bytecode written in python.  Working on this project was exciting and fun for me.  I would be glad if you too would poke him.  But first we need to settle down a bit, understand how python works, so that we know what an interpreter really is and what it is eaten with. <br><br>  I mean that you are now in the same position as I was three months ago.  You understand python, but have no idea how it works. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A quick note: I am working with version 2.7 in this post.  The third version is almost similar to the second, there are small differences in syntax and names, but in general, all the same. <br><br><h2>  How does python work? </h2><br>  We will start with a very (very very) high level of inner work.  What happens when you run the code in your interpreter? <br><br><pre><code class="python hljs">~ $ python Python <span class="hljs-number"><span class="hljs-number">2.7</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> (default, Jun <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">2012</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>:<span class="hljs-number"><span class="hljs-number">23</span></span>:<span class="hljs-number"><span class="hljs-number">33</span></span>) [GCC <span class="hljs-number"><span class="hljs-number">4.2</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> Compatible Apple Clang <span class="hljs-number"><span class="hljs-number">4.0</span></span> (tags/Apple/clang<span class="hljs-number"><span class="hljs-number">-418.0</span></span><span class="hljs-number"><span class="hljs-number">.60</span></span>)] on darwin Type <span class="hljs-string"><span class="hljs-string">"help"</span></span>, <span class="hljs-string"><span class="hljs-string">"copyright"</span></span>, <span class="hljs-string"><span class="hljs-string">"credits"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">"license"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> more information. &gt;&gt;&gt; a = <span class="hljs-string"><span class="hljs-string">"hello"</span></span></code> </pre> <br>  The years go by, the ice-boats melt, Linus Torvalds saws the next core, and the 64-bit processor <a href="http://xkcd.ru/676/">works</a> tirelessly, meanwhile there are four steps: lexical analysis, parsing, compilation, and finally interpretation.  The parser picks up instructions fed to it and generates a structure that explains their relationship forming an <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25B1%25D1%2581%25D1%2582%25D1%2580%25D0%25B0%25D0%25BA%25D1%2582%25D0%25BD%25D0%25BE%25D0%25B5_%25D1%2581%25D0%25B8%25D0%25BD%25D1%2582%25D0%25B0%25D0%25BA%25D1%2581%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B5_%25D0%25B4%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B2%25D0%25BE">AST</a> (Abstract Syntax Tree).  The compiler then converts the AST to one (or several) code objects (bytecode + binding).  Then the interpreter executes each object. <br><br>  I am not going to talk about lexical analysis, parsing or compilation today, probably because I myself don‚Äôt know anything about these things, but don‚Äôt be discouraged: you can always learn this by spending fifty hours or so.  We assume that these steps went well and successfully, and we have python code objects in our hands. <br><br>  Before I get down to business, I want to make a small remark: in this topic we will talk about function objects, code objects, and bytecode.  These are all different things.  Let's start with the functions.  We don‚Äôt have to go deeply into them to get to the interpreter, but I just want to clarify that function objects and code objects are two big differences, and function objects are the most interesting. <br><br><h2>  Function Objects </h2><br>  You could probably hear about the "function objects".  These are things that people mean when they say: "Functions are first class objects."  Let's explore them in more detail: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a)</span></span></span><span class="hljs-function">:</span></span> ... x = <span class="hljs-number"><span class="hljs-number">3</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + a ... &gt;&gt;&gt; foo &lt;function foo at <span class="hljs-number"><span class="hljs-number">0x107ef7aa0</span></span>&gt;</code> </pre><br>  ‚ÄúFunctions are objects of the first class‚Äù means that functions are objects as well as a list is an object or MyObject instances are objects.  Since foo is an object, we can exploit it without performing it (this is the difference between foo () and foo).  We can pass foo as a parameter to another function or we can assign it to a variable. <br><br>  Let's look at foo for a bit more detail: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a)</span></span></span><span class="hljs-function">:</span></span> ... x = <span class="hljs-number"><span class="hljs-number">3</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + a ... &gt;&gt;&gt; foo &lt;function foo at <span class="hljs-number"><span class="hljs-number">0x107ef7aa0</span></span>&gt; &gt;&gt;&gt; foo.func_code &lt;code object foo at <span class="hljs-number"><span class="hljs-number">0x107eeccb0</span></span>, file <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">1</span></span>&gt;</code> </pre><br>  As you can see in the above code, the code object is an attribute of a function object.  The code object is generated by the Python compiler and interpreter, it contains the information necessary for the interpreter to work.  Let's look at the attributes of the code object: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>dir(foo.func_code) [<span class="hljs-string"><span class="hljs-string">'__class__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__cmp__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__delattr__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__doc__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__eq__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__format__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__ge__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__getattribute__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__gt__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__hash__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__init__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__le__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__lt__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__ne__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__new__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__reduce__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__reduce_ex__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__repr__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__setattr__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__sizeof__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__str__'</span></span>, <span class="hljs-string"><span class="hljs-string">'__subclasshook__'</span></span>, <span class="hljs-string"><span class="hljs-string">'co_argcount'</span></span>, <span class="hljs-string"><span class="hljs-string">'co_cellvars'</span></span>, <span class="hljs-string"><span class="hljs-string">'co_code'</span></span>, <span class="hljs-string"><span class="hljs-string">'co_consts'</span></span>, <span class="hljs-string"><span class="hljs-string">'co_filename'</span></span>, <span class="hljs-string"><span class="hljs-string">'co_firstlineno'</span></span>, <span class="hljs-string"><span class="hljs-string">'co_flags'</span></span>, <span class="hljs-string"><span class="hljs-string">'co_freevars'</span></span>, <span class="hljs-string"><span class="hljs-string">'co_lnotab'</span></span>, <span class="hljs-string"><span class="hljs-string">'co_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'co_names'</span></span>, <span class="hljs-string"><span class="hljs-string">'co_nlocals'</span></span>, <span class="hljs-string"><span class="hljs-string">'co_stacksize'</span></span>, <span class="hljs-string"><span class="hljs-string">'co_varnames'</span></span>]</code> </pre><br>  Here a whole bunch of nishtyakov, most of which nm is not needed now.  Let's take a closer look at the three attributes of the foo object. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>foo.func_code.co_varnames (<span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'x'</span></span>) &gt;&gt;&gt; foo.func_code.co_consts (<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) &gt;&gt;&gt; foo.func_code.co_argcount <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br>  Here is what is there: the names of variables and constants that are used in our function and the number of arguments taken.  But we still do not see anything that would be similar to the instructions.  The instructions call the bytecode reference, by the way this is an attribute of the code object: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>foo.func_code.co_code <span class="hljs-string"><span class="hljs-string">'d\x01\x00}\x01\x00|\x01\x00|\x00\x00\x17S'</span></span></code> </pre><br>  I remind you that bytecode and code objects are not the same.  Bytecode is an attribute of a code object besides many other attributes.  So what is baytkod?  Well, it's just a set of bytes.  They look weird when we print them because some bytes match characters and others don‚Äôt, let's output them as numbers. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>[ord(b) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> b <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> foo.func_code.co_code] [<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">125</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">124</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">124</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">23</span></span>, <span class="hljs-number"><span class="hljs-number">83</span></span>]</code> </pre><br>  Here are the bytes that do all the magic.  The interpreter will sequentially and tirelessly select bytes, watch what operations they perform and with which arguments and execute commands.  In order to go even further, you can view the source code of Cpython and specifically ceval.c that we will do later. <br><br><h2>  Disassembling bytecode </h2><br>  Disassembling means to take all these bytes and transform them into something that we humans can understand.  This is not performed in the standard python cycle.  Today there is a great tool for this task - the <strong>dis</strong> module.  We will use the <strong>dis.dis</strong> function to analyze what our <strong>foo is</strong> doing. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a)</span></span></span><span class="hljs-function">:</span></span> ... x = <span class="hljs-number"><span class="hljs-number">3</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + a ... &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dis &gt;&gt;&gt; dis.dis(foo.func_code) <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> LOAD_CONST <span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-number"><span class="hljs-number">3</span></span> STORE_FAST <span class="hljs-number"><span class="hljs-number">1</span></span> (x) <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> LOAD_FAST <span class="hljs-number"><span class="hljs-number">1</span></span> (x) <span class="hljs-number"><span class="hljs-number">9</span></span> LOAD_FAST <span class="hljs-number"><span class="hljs-number">0</span></span> (a) <span class="hljs-number"><span class="hljs-number">12</span></span> BINARY_ADD <span class="hljs-number"><span class="hljs-number">13</span></span> RETURN_VALUE</code> </pre><br>  The first number is the line of the source python code, the second number is the offset inside bytecode: <strong>LOAD_CONST</strong> is at position 0, <strong>STORE_FAST is</strong> at position 3, and so on.  The middle column is the name of the instruction itself, the last two columns give an idea of ‚Äã‚Äãthe arguments of the instruction (if they are), the fourth column shows the argument itself, which is an index in other attributes of the code object.  In this example, the argument for <strong>LOAD_CONST</strong> is the index in the co_consts list, and the argument for <strong>STORE_FAST</strong> is the index in co_varnames, in the fifth column the variable names or the value of the constants are displayed.  We can easily verify this: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>foo.func_code.co_consts[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-number"><span class="hljs-number">3</span></span> &gt;&gt;&gt; foo.func_code.co_varnames[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-string"><span class="hljs-string">'x'</span></span></code> </pre><br>  This also explains the second <strong>STORE_FAST</strong> instruction which is position 3 in the bytecode.  If the instruction has an argument the next two bytes and there is this argument.  The work of the interpreter is just the same so as not to get confused and continue to sow reasonable, good, eternal.  (you may have noticed that <strong>BINARY_ADD</strong> has no arguments, do not worry, we will come back to this) <br><br>  There was one thing that surprised me when I started to understand how python works, how can python be dynamic if it is also ‚Äúcompiled‚Äù?  Usually, these two words are ‚Äúantonyms‚Äù, there are dynamic languages ‚Äã‚Äãsuch as Python, Ruby, and Javascript, but there are compiled ones like C, Java, and Haskell. <br><br>  When people talk about compiled languages, they mean compiling into native x86 / ARM / etc instructions.  The interpreted language has no compilation at all, except that it is only ‚Äúcompiled‚Äù on the fly into bytecode.  The python interpreter parses the bytecode and executes it inside the virtual machine, which by the way is a lot of work, but we'll talk about it later. <br><br>  In order to be dynamic you need to be abstract, let's see what it means: <br><pre> <code class="python hljs">&gt;&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">modulus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y)</span></span></span><span class="hljs-function">:</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x % y ... &gt;&gt;&gt; [ord(b) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> b <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> modulus.func_code.co_code] [<span class="hljs-number"><span class="hljs-number">124</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">124</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span>, <span class="hljs-number"><span class="hljs-number">83</span></span>] &gt;&gt;&gt; dis.dis(modulus.func_code) <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> LOAD_FAST <span class="hljs-number"><span class="hljs-number">0</span></span> (x) <span class="hljs-number"><span class="hljs-number">3</span></span> LOAD_FAST <span class="hljs-number"><span class="hljs-number">1</span></span> (y) <span class="hljs-number"><span class="hljs-number">6</span></span> BINARY_MODULO <span class="hljs-number"><span class="hljs-number">7</span></span> RETURN_VALUE</code> </pre><br><br>  This is a disassembly function in bytecode.  By the time we get the invitation, the modus function has been compiled and the cord object has been generated.  Suddenly enough, but the operation of the remainder of the division of <strong>%</strong> (modulus operation) is converted to <strong>BINARY_MODULO</strong> .  It looks like this function can be used for numbers: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>modulus(<span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>) <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre><br>  Not bad, but what if we pass something else, such as a string. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>modulus(<span class="hljs-string"><span class="hljs-string">"hello %s"</span></span>, <span class="hljs-string"><span class="hljs-string">"world"</span></span>) <span class="hljs-string"><span class="hljs-string">'hello world'</span></span></code> </pre><br>  Opana, what is it here?  You've probably seen this before: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"hello %s"</span></span> % <span class="hljs-string"><span class="hljs-string">"world"</span></span> hello world</code> </pre><br>  When the <strong>BINARY_MODULO</strong> operation <strong>is</strong> performed for two strings, it performs string substitution instead of division remainder.  This situation is an excellent example of dynamic typing.  When the compiler generates a code object for modulus, it has no idea what <strong>x</strong> and <strong>y are</strong> , whether they are strings or numbers or something else.  It simply executes instructions: load one variable, load another, perform preparation of a binary module, return the result.  The interpreter's job is to understand what <strong>BINARY_MODULO</strong> means in the current context.  Our modulus function can count the remainder, substitute strings ... maybe something else?  If we define a class with the <strong>__mod__</strong> method <strong>,</strong> then we can do anything. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Surprise</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, num)</span></span></span><span class="hljs-function">:</span></span> ... self.num = num ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__mod__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, other)</span></span></span><span class="hljs-function">:</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.num + other.num ... &gt;&gt;&gt; seven = Surprise(<span class="hljs-number"><span class="hljs-number">7</span></span>) &gt;&gt;&gt; four = Surprise(<span class="hljs-number"><span class="hljs-number">4</span></span>) &gt;&gt;&gt; modulus(seven, four) <span class="hljs-number"><span class="hljs-number">11</span></span> &gt;&gt;&gt; modulus(<span class="hljs-number"><span class="hljs-number">7</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>) <span class="hljs-number"><span class="hljs-number">3</span></span> &gt;&gt;&gt; modulus(<span class="hljs-string"><span class="hljs-string">"hello %s"</span></span>, <span class="hljs-string"><span class="hljs-string">"world"</span></span>) <span class="hljs-string"><span class="hljs-string">'hello world'</span></span></code> </pre><br>  The same function with the same bytecode can perform different operations depending on the type of context.  Also, the modulus function can raise an exception for the TypeError example if we call it for objects that are not implemented. <br><br>  This is one of the reasons why it is difficult to optimize python.  You do not know when you generate an object code and a byte code, what kind of objects will be in the end.  Russell Power and Alex Rubinsteyn wrote an article ‚Äúhow fast python can be‚Äù, this article is sufficiently informative. <br><br>  <i>For now, for now.</i>  <i>Original article <a href="http://akaptur.com/blog/2013/11/15/introduction-to-the-python-interpreter/">here</a> .</i>  <i>I apologize for possible errors</i>  <i>by nature I possess inborn illiteracy and it is compelled to use a machine way of verification of the text.</i> </div><p>Source: <a href="https://habr.com/ru/post/264609/">https://habr.com/ru/post/264609/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264597/index.html">Forensic VS Schroeder: Gaining Access to Deleted Files</a></li>
<li><a href="../264599/index.html">Man is the main vulnerability. A little bit about social engineering at PHDays V</a></li>
<li><a href="../264601/index.html">Malefactors actively exploit new vulnerability in Windows</a></li>
<li><a href="../264603/index.html">Adobe has added new security restrictions for Flash Player.</a></li>
<li><a href="../264607/index.html">Universal JavaScript</a></li>
<li><a href="../264611/index.html">Platform for Android on Unity3D</a></li>
<li><a href="../264617/index.html">OTRS 4.0.10. We put on Ubuntu + AD + Kerberos + SSO (Part One)</a></li>
<li><a href="../264619/index.html">Mozilla Firefox web browser under fire: the anatomy of a 0day cyber attack</a></li>
<li><a href="../264623/index.html">Plot-oriented games</a></li>
<li><a href="../264631/index.html">The third set in the School of Interface Development Yandex. Analysis of introductory tasks and useful tips</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>