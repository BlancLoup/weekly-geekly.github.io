<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SamsPcbGuide Part 7: Tracing Signal Lines. Differential pairs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the seventh article from the cycle and the last in the block on the tracing of signal lines. Then there is an idea to develop the project and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SamsPcbGuide Part 7: Tracing Signal Lines. Differential pairs</h1><div class="post__text post__text-html js-mediator-article">  This is the seventh article from the cycle and the last in the block on the tracing of signal lines.  Then there is an idea to develop the project and go to the manual for the design of printed circuit boards in the form of a convenient book, so it is possible for publications.  there will be a pause.  The article deals with an important topic - the differential data transfer scheme, which is becoming more and more common in modern systems, and offers recommendations on the tracing of differential pairs, allowing to ensure the advantages of this scheme. <a name="habracut"></a><br><br>  In the <a href="https://habr.com/post/416495/">previous one</a> , it was shown that the cross connection between independent signal lines is a source of unwanted interference.  However, in the case of a differential transmission scheme, a strong cross connection, on the contrary, makes the signal more resistant to interference.  In this scheme, two lines are used (differential pair), the signal sources of which are out of phase, and the receiver reacts to the voltage difference on the V lines <sub>DIFF</sub> = V <sub>+</sub> -V <sub>-</sub> (Fig. 1).  The common mode signal (English common signal) is defined as V <sub>COMM</sub> = 1/2 ‚àô (V <sub>+</sub> + V <sub>-</sub> ) and may be non-zero, for example, as in the widespread LVDS standard.  Differential pair is characterized by two resistances: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yl/rx/zp/ylrxzp9guzvhz1zicbwyju7n8nq.png"></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/webt/dq/d2/pq/dqd2pqn-0jxj7xonhpua9nosffq.png"></div><br><br>  The introductory theory of differential signaling is described in many sources, for example, in [1].  From the point of view of the design of printed circuit boards, it is important to dwell on the advantages of the differential circuit with respect to the asymmetric (eng. Single-ended) and on the requirements for the topology of differential pairs, these advantages provide. <br><br>  First of all, the ideal differential pair is symmetric, that is, throughout the entire length, its cross section should be constant and have an axis of symmetry (Fig. 2).  This, as well as in the case of an asymmetric transmission line, ensures the constancy of the characteristic impedance of the differential pair, which significantly reduces line reflections and signal distortion. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zu/vg/xr/zuvgxrlk63synl0iihpuyytt-qk.png"></div><br><blockquote><h3>  R.1. </h3>  The cross section of a differential pair should be maximally (ideally mirror) symmetrically and uniformly throughout its length.  Between the lines of the pair there should not be elements of the topology of other signal chains. </blockquote>  Each line of the differential pair has its own distribution of return current in the supporting layer.  If the mutual connection between the lines of the pair is significantly less than their connection with the supporting layer, then the distribution of the return currents do not intersect (Fig. 3-A).  Such a differential pair is called a loosly coupled differential line (weak coupling) differential pair.  Since the distribution of high-frequency components of the signal is concentrated in the reference layer in the region of ¬± 3 ‚àô h, a practical criterion for weak coupling is the condition that the distance between the edges of the printed tracks is s&gt; 6 ‚àô h or s&gt; 3 ‚àô w.  Since the differential impedance of a pair with weak coupling is almost independent of the distance between the tracks Z <sub>DIFF</sub> ‚âà2 ‚àô Z <sub>0</sub> , this distance can vary along the length of the line - for example, if there is an obstacle in the path of the differential pair.  This simplifies the requirements for the topology of a differential pair, but such lines lack the main advantages of differential data transfer. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9a/ea/pf/9aeapfwtvovmboorhiqkvaja_zg.png"></div><br>  Reducing the distance between the lines to s‚â§2 h results in a significant increase in the mutual coupling and overlapping of the distributions of the return currents in the supporting layer (Fig. 3-B).  Such a differential pair is called a tightly coupled differential line.  Differential impedance becomes more dependent on the distance between tracks.  Its value decreases, therefore, to maintain the previous value, narrower paths are required, which slightly increases ohmic losses.  However, it is this topology of a differential pair that provides the following advantages relative to an asymmetric line: <br><br><ol><li>  Greater stability of the differential signal to induced interference, including cross-interference and interference in the reference layer.  The proximity and symmetry of the lines leads to the fact that the induced noise on each of the lines is almost equal to V <sub>NOISE</sub> <sup>+</sup> ‚âàV <sub>NOISE</sub> <sup>-</sup> , therefore the differential interference is small V <sub>NOISE</sub> <sup>DIFF</sup> = V <sub>NOISE</sub> <sup>+</sup> -V <sub>NOISE</sub> <sup>-</sup> ‚âà0.  This interference is the less, the farther from the differential pair is its source. </li><li>  Lower EMR and generated crosstalk.  Since the signals V <sub>+</sub> and V <sub>-</sub> are in antiphase, the electromagnetic fields emitted by them are approximately equal in magnitude and have the opposite direction to each other.  This leads to the fact that the superposition of fields in the far field tends to zero.  The same effect significantly reduces the near-field crosstalk generated by the differential pair. </li><li>  Less impact of gaps in the bearing layer.  The return currents I <sub>+</sub> and I <sub>- are</sub> also in antiphase, while due to the geometric symmetry of their distribution in the supporting layer are symmetrical.  In this regard, the total current in the reference layer I <sub>REF</sub> = I <sub>+</sub> + I <sub>-</sub> decreases, and in the overlap region becomes equal to zero.  In the case of complete overlap, when the differential pair is at a distance from the support layer h&gt; 2 (s + w) and the interconnection of the lines significantly exceeds their connection with the support layer, there is no current in the support layer (Fig. 3B).  Such a situation may arise, in particular, when a differential pair crosses a wide gap in the support layer.  Despite the fact that the impedance at the intersection undergoes a local change, the distortion of the differential signal is small compared to the distortion of the asymmetric signal in such a case [1]. </li></ol><br>  These advantages should be called potential benefits, because they are fully realized only when two conditions are met simultaneously: <br><br><ol><li>  strict antiphase signals throughout the line, </li><li>  no common mode noise. </li></ol><br>  If you do not take into account the non-ideality of the signal source, then the first requirement is ensured by compliance with recommendation P.1 and coordination of both differential and common-mode signals on the load side.  However, in practice, due to the limitations imposed by the location and geometry of the contact pads of components and vias, the need for turns, the strict constancy of the cross section of a differential pair is difficult to implement, which is also expressed in the difference in the lengths of lines of the pair.  The difference in the lengths of the pair leads to a phase run, distorting the differential signal and interfering with the common-mode signal (Fig. 4). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fi/dc/km/fidckml0ryhiijswfoy4vcyoorg.png"></div><br><br>  A common practice of aligning the lengths of lines (born length matching, tuning) is to increase the length of the shorter lines due to the additional bends that can form a regular structure (Fig. 5).  Obviously, the distance between the lines of the pair inevitably changes.  This, in turn, leads to a local change in the impedance of the pair and the occurrence of reflections.  D. Brooks in <a href="http://www.ultracad.com/mentor/mentor%2520signal%2520timing1.pdf">one of the articles</a> suggests that the task of aligning the lengths of the pair of lines is of greater importance from the point of view of signal integrity and EMC.  And the choice of bending geometry is not critical, with the only proviso that long and narrow bends are not recommended, as they can lead to distortions due to the strong interconnection of sections.  However, this thesis is not a universal rule.  The fact is that there is a more advanced method of aligning the lengths of the lines, which consists in simultaneously maintaining the impedance of the pair in places of bends (due to changes in the width of the lines, the use of local cuts in the support layer, etc.).  However, the construction of such alignment geometry is a rather complicated task, requiring the use of specialized CAD systems, and is justified only for gigahertz signal lines.  Another option is a local increase in the distance between the lines of the pair and alignment due to bends on one of the lines.  In other words, the implementation of a local transition to a differential pair with a weak link, for which the impedance is not so much dependent on the distance between the lines (which is observed in places of bends).  Examples and more detailed information on these techniques can be found in the materials presented on the website of Simberian, Inc. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zu/bu/ap/zubuapuuozete7n2nrsp-kzrxse.png"></div><br><br>  The criterion of a sufficient degree of equality of the lengths of the lines is given in [1]: ‚ÄúThe lengths of the lines of the differential pair must be aligned with each other with an accuracy of ‚àÜL &lt;0.1 ‚àô t <sub>R</sub> ‚àô v.  It is recommended that the alignment section be located in the part of the differential pair where the symmetry is already broken (for example, by the location of the IC pins). ‚Äù  By analogy with asymmetric lines, the influence of local inhomogeneity of the differential impedance is smaller, the shorter the electrical length of the equalization section is compared to the duration of the signal front. <br><br>  The task is complicated by the fact that the alignment works fine only for a strip line, for which the propagation speeds of the common-mode and differential signals are equal.  For a microstrip line, even the perfect alignment of the lengths of the lines of a pair does not ensure the absence of distortion, but is only a method of reducing them.  But since the strip line requires a transition to the inner layers with the use of vias, which themselves are heterogeneous, it cannot be said for sure that the microstrip line has no advantages.  Of course, the significance of these effects increases with increasing upper bound of the frequency band of the signal.  And if at frequencies below 1 GHz the alignment provides a low level of distortion, then in the area of ‚Äã‚Äãseveral gigahertz and above there are no universal recommendations and the problem of tracing is solved with the help of simulation for each specific case. <br><br>  Common mode interferences can occur as in the differential pair itself due to any asymmetry of it, and so can be induced from other signal lines.  It is impossible to eliminate distortions, but by reconciling the line, which prevents the occurrence of repeated reflections and oscillations, their consequences can be minimized.  The main methods for matching the differential pair at the far end are presented in Table 1. The scheme without matching the common mode signal is simple and therefore is used quite often, however, in the presence of common mode noise in the lines, simplicity turns into potential problems.  Unlike the differential signal, the common mode signal is a good source of EMR.  Especially common mode noise becomes critical when using an unshielded twisted pair to transmit a signal, so it is recommended to use shielded twisted pairs and common mode chokes on the output. <br><br>  Table 1. Signal line matching methods. <br><table><tbody><tr><th>  <b>Name and scheme</b> </th><th>  <b>Loss level</b> </th><th>  <b>Comments</b> </th></tr><tr><td><img src="https://habrastorage.org/webt/9y/tp/gm/9ytpgmavwa2vlk1gvjiahxd76nc.png"></td><td>  low </td><td><img src="https://habrastorage.org/webt/cx/pq/2y/cxpq2y22ivgtktktjyvwe0qza_g.png"></td></tr><tr><td><img src="https://habrastorage.org/webt/q7/5i/id/q75iidplb1-tvmdn3znuyeeft-k.png"></td><td>  tall </td><td><img src="https://habrastorage.org/webt/ep/kk/un/epkkun2ywaf0imyojtaeqlp6mzi.png"></td></tr><tr><td><img src="https://habrastorage.org/webt/-x/um/zy/-xumzylnswbx8idqpnwfyskr05w.png"></td><td>  tall </td><td><img src="https://habrastorage.org/webt/ep/kk/un/epkkun2ywaf0imyojtaeqlp6mzi.png"></td></tr><tr><td><img src="https://habrastorage.org/webt/mb/mt/yi/mbmtyi5lcf4gbsl46tdpxm_k1hm.png"></td><td>  average </td><td><img src="https://habrastorage.org/webt/bu/gx/u6/bugxu6jx9tfrl1hejgaay7zyhgs.png"></td></tr></tbody></table><br>  Notes: <br><br>  1. When calculating the values ‚Äã‚Äãof matching resistances, it is convenient to use the values ‚Äã‚Äãof the impedance of even Z <sub>EVEN</sub> (eng. Even mode) and odd Z <sub>ODD</sub> (eng. Odd mode) modes of operation of the differential pair.  By definition, these are the impedance values ‚Äã‚Äãof one of the lines in special modes of operation, when the signal is not distorted during propagation in a differential pair.  In the case of a symmetric differential pair, these are equal signals V <sub>+</sub> = V for the even mode and antiphase signals V <sub>+</sub> = ‚ÄìV for the odd mode.  At the same time, they are associated with the values ‚Äã‚Äãof the characteristic impedances of the differential pair by the following relations: Z <sub>DIFF</sub> = 2 ‚àô Z <sub>ODD</sub> , Z <sub>COMM</sub> = 1/2 ‚àô Z <sub>EVEN</sub> . <br><br>  2. For a differential pair with a weak mutual coupling, Z <sub>ODD</sub> ‚âà Z <sub>EVEN</sub> ‚âà Z <sub>0</sub> and T-shaped matching schemes degenerate into a parallel matching scheme of each of the lines. <br><br>  The differential scheme has many advantages relative to the asymmetric one and is fundamental for reliable and high-speed data transmission standards, including for systems with a large number of nodes.  With the continuation of the clock growth rate, developers will have to deal more and more with the tracing of differential pairs, so this competence is strategically important and should be based not only on general recommendations, but supported by simulation results in specialized CAD systems and experimental data. <br><br><h3>  Literature </h3><br>  [1] Bogatin E. "Signal and power integrity - simplified", 2nd ed., Pearson, 2010 <br><br>  <i>The article was first published in the journal "Components and Technologies" 2018, ‚Ññ5.</i>  <i>The publication on Habr is coordinated with the editors of the journal.</i> <br><br><h3>  PS </h3><br>  <i>I again appeal to readers, of whom, after moving with ‚ÄúGeektimes,‚Äù he said less, for feedback, which can be expressed in comments, in personal messages, as you like.</i>  <i>This applies to this article, and all previous ones.</i>  <i>I would like to make a cool handy reference guide, with which someone will successfully start in the design of printed circuit boards with fewer errors, someone will deepen and improve their quality.</i>  <i>Join us, constructively criticize, make a contribution to the development of the industry.</i> </div><p>Source: <a href="https://habr.com/ru/post/419321/">https://habr.com/ru/post/419321/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../419309/index.html">Average color in javascript</a></li>
<li><a href="../419311/index.html">Industrial lamps from the domestic manufacturer Effest with a good color rendering index</a></li>
<li><a href="../419313/index.html">Buffett's testament or what financial consultants are silent about</a></li>
<li><a href="../419315/index.html">Engine life after the death of the rocket</a></li>
<li><a href="../419319/index.html">How to run Istio using Kubernetes in production. Part 1</a></li>
<li><a href="../419323/index.html">Installing Kubernetes on Hetzner Cloud</a></li>
<li><a href="../419325/index.html">Relocate student to France</a></li>
<li><a href="../419327/index.html">Interface List Guide in MikroTik</a></li>
<li><a href="../419329/index.html">Digital events in Moscow from 6 to 12 August</a></li>
<li><a href="../419331/index.html">Hacken Continuum: an electronic instrument with acoustic responsiveness</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>