<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Getting rid of the ‚Äúhistorical reasons‚Äù in cmd.exe in an easier and standard way.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! Today I want to share with you an easier and more correct, from my point of view, way to achieve a result similar to that described in the arti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Getting rid of the ‚Äúhistorical reasons‚Äù in cmd.exe in an easier and standard way.</h1><div class="post__text post__text-html js-mediator-article">  Hello!  Today I want to share with you an easier and more correct, from my point of view, way to achieve a result similar to that described in the <a href="http://habrahabr.ru/post/260991/">article</a> by <a href="https://habrahabr.ru/users/nikitatrophimov/" class="user_link">NikitaTrophimov</a> . <br>  I think it makes no sense to re-write the introductory part - the author of the original article did it before me - and, since my article would hardly have seen the light, if he did not write his own, and was just an alternative vision of how to solve the problem, I would focus on the main thing. <br><br>  Like the author of the original article, I found the behavior of the ‚Äúcd‚Äù (or ‚Äúchdir‚Äù) command in cmd.exe rather strange.  It seemed illogical that in order to change the active disk it is necessary to perform additional actions each time.  Being a fan of the command line interface, I have repeatedly tried to improve the appearance and capabilities of the standard Microsoft Windows command interpreter, but I did not even think about the possibility of changing the standard behavior of the ‚Äúcd‚Äù command.  After reading the above article on Habr√©, I was haunted by the feeling of excessive non-standard and complexity of the described method ... and the desire to create my own bike and quickly start using it led to a <s>handful of a</s> couple or three hours spent in the next weekend debriefing.  So, who are interested in my research - welcome under the cut! <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">A small educational program on the topic (you can not read)</b> <div class="spoiler_text">  The standard mechanism for changing the behavior of commands / programs "by default" (which is true for all operating systems known to me) is the launch arguments, the parameters specified a space after the name of the command or executable file.  This mechanism allows changing the behavior of the command for changing the current directory in cmd.exe to the one we need.  The "/ d" parameter specified when invoking the "cd" (or "chdir") command allows you to change the active disk simultaneously with the change of the current directory. <br><br>  Another standard mechanism used for setting the parameters of the environment "by itself" is the alias mechanism.  Well-known and often used in the Unix environment of similar operating systems, it often turns out to be deprived of attention and even undeservedly forgotten in Microsoft Windows.  This mechanism allows you to assign your own call names for commands, programs, command / program pairs + parameters and, most importantly, allows you to change the behavior of standard commands and programs, because  aliases have a higher priority than shell commands and programs found by the shell in the directories specified in the PATH environment variable. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This is what we will use.  Let's get started! <br></div></div><br>  <b>Task setting:</b> The ‚Äúcd‚Äù command should automatically change the active disk if the path to the data on a disk other than the current disk is passed as an argument. <br><br>  <b>Solution:</b> It would seem that something easier?  Using the ‚Äúdoskey‚Äù we create the alias ‚Äúcd = cd / d $ *‚Äù and enjoy life ... but what is the problem - the standard behavior of the ‚Äúcd‚Äù command breaks when started without parameters.  Launched without parameters, this command is a complete analogue of the ‚Äúpwd‚Äù command from Unix shells of similar operating systems and should output information about the current directory to the console, but after setting the alias, it will already be executed with the ‚Äú/ d‚Äù key, the presence of which implies The next parameter is the path to go.  If it is not detected, the command will display an error message to the console and exit.  This decision clearly does not suit us! <br><br>  After some amount of reflection, thoughtful browsing of Habr's pages and active Googling, the next solution was born - why not write a .bat file?  Wait, do not rush to shower me with tomatoes, I myself do not like crutches.  The decision was well thought out and, as you will see, have a chance to be a worker. <br><br>  My idea was as follows - I decided to write a .bat file that takes arguments and runs the standard ‚Äúcd‚Äù command with the arguments passed to it.  If there are no launch arguments for the file, it runs the ‚Äúcd‚Äù command with no arguments (output mode of the current directory), if there are any arguments, it adds the ‚Äú/ d‚Äù key in front of them and executes the ‚Äúcd‚Äù command with the / d key and arguments passed to him.  Those.  When using this solution, we get what we want ‚Äî the standard behavior of the ‚Äúcd‚Äù command with no arguments works and the automatic disk change works. <br><br><pre><code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> "%*" == "" ( <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /d "%*" ) <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> /b</code> </pre> <br>  So, we have already received a working solution, but this is not what we need.  It remains to replace the standard command for changing directories, and the alias mechanism will help us in this.  Save the resulting .bat file to one of the directories described in the ‚ÄúPATH‚Äù variable (for example, in% WINDIR% \ System32) with the name cd.bat and create an alias with the command ‚Äúdoskey cd = cd.bat $ *‚Äù.  Everything would be fine, but the alias will remain only until the current cmd.exe window is closed ... it is necessary to correct the situation!  Create another .bat file to automatically set environment variables when launching cmd.exe windows - cmd_env.bat, which is also saved in the selected directory next to cd.bat <br><br><pre> <code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">doskey</span></span> /macrofile="<span class="hljs-variable"><span class="hljs-variable">%USERPROFILE%</span></span>\aliases" <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> /b</code> </pre><br>  You also need to create a simple text file "aliases" and place it in% USERPROFILE% <br><br> <code>cd="%WINDIR%\System32\cd.bat" $* <br> <br></code> <br><br>  and .reg file to activate automatic launch cmd_env.bat when opening cmd.exe <br><br> <code>Windows Registry Editor Version 5.00 <br> <br> [HKEY_CURRENT_USER\Software\Microsoft\Command Processor] <br> "Autorun"="C:\\Windows\\System32\\cmd_env.bat" <br> <br></code> <br><br>  Save it, for example, with the name cmd_env_reg.reg <br><br>  We import the parameters from the cmd_env_reg.reg file into the registry and run cmd.exe in any way possible.  Done!  Check the result! <br><br>  This solution was successfully tested for performance in the Windows 2008 R2, 7, 2003 R2, XP environment. <br><br>  PS: Many thanks to the author of the original article for pushing me into action.  Without his article, I would have endured inconvenience for a long time and dreamed that "if there is time, I will work." <br><br>  PPS: The cmd_env.bat file can and should be used to set up cmd.exe ‚Äî for example, to set standard colors in the console with the ‚Äúcolor 02‚Äù command or to set environment variables. <br><br>  PPPS: Links for those interested in the topic - <a href="http://conemu.github.io/">ConEmu</a> , <a href="http://mridgers.github.io/clink/">Clink</a> , <a href="http://gooseberrycreative.com/cmder/">cmder</a> and others - <a href="http://console.sourceforge.net/">Console2</a> and its fork <a href="https://github.com/cbucher/console">ConsoleZ</a> , <a href="http://habrahabr.ru/post/164249/">rCons</a> , <a href="http://sourceforge.net/projects/winqconsole/">WinQConsole</a> </div><p>Source: <a href="https://habr.com/ru/post/263105/">https://habr.com/ru/post/263105/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../263093/index.html">Crackme Chiwaka1 study</a></li>
<li><a href="../263097/index.html">Event-oriented Python backtesting step by step. Part 1</a></li>
<li><a href="../263099/index.html">Skype turned to people?</a></li>
<li><a href="../263101/index.html">Work with passwords: how to protect your accounts (expert opinion)</a></li>
<li><a href="../263103/index.html">Unobvious performance problems in Doctrine related to the hydration of objects</a></li>
<li><a href="../263109/index.html">User data leakage in QIWI</a></li>
<li><a href="../263111/index.html">Chronos library: make writing long operations easier</a></li>
<li><a href="../263113/index.html">Trouble came from not waiting, XSS vulnerability in Yandex.Metrica</a></li>
<li><a href="../263115/index.html">Clojure Web Applications</a></li>
<li><a href="../263117/index.html">10 years "on the knee" and forced evolution - note for young</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>