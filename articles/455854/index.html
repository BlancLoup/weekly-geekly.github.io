<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to implement context menus (Context Menu) in iOS 13</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello everyone, my name is Denis, we are developing a service for analyzing subscriptions of iOS applications - Apphud. 


 At WWDC 2019, Apple introd...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to implement context menus (Context Menu) in iOS 13</h1><div class="post__text post__text-html js-mediator-article"><p>  Hello everyone, my name is Denis, we are developing a service for analyzing subscriptions of iOS applications - Apphud. </p><br><p>  At WWDC 2019, Apple introduced a new way to interact with your application interface: <em>context menus</em> .  They look like this: </p><br><p><img src="https://habrastorage.org/webt/mo/kw/5c/mokw5cy2bio4dg5gxpgfmxfavg0.gif"></p><br><p>  In this article we will consider some subtleties of their use and learn how to do them. <a name="habracut"></a></p><br><p>  The context menus are a logical continuation of the ‚ÄúPeek and Pop‚Äù technology, when the user could open a preview of an element by strongly pressing on it.  But between them there are several significant differences. </p><br><ul><li><p>  Context menus work on any device running iOS 13. Support for 3D touch from the device is not required.  Therefore, in particular, they can be used on all iPads. </p><br></li><li><p>  Buttons that allow you to interact with the element appear immediately and do not require a swipe up. </p><br></li></ul><br><p>  To open the context menu, the user simply holds his finger on the desired item or press it hard (if the device supports 3D Touch). </p><br><h2 id="rekomendacii-pri-ispolzovanii-kontekstnyh-menyu">  Recommendations when using context menus </h2><br><p>  Apple in <a href="https://developer.apple.com/design/human-interface-guidelines/ios/controls/context-menus/">Human Interface Guidelines</a> recommends following the rules when designing context menus. </p><br><h3 id="proektiruyte-pravilno">  Design correctly </h3><br><p>  It will be bad if you add a menu for some items in some places and not add it for similar items in others.  Then the user will feel that the application is not working properly. </p><br><h3 id="vklyuchayte-v-menyu-tolko-neobhodimoe">  Include only necessary items in the menu </h3><br><p>  The context menu is a great place for the most frequently used commands.  ‚ÄúMost often‚Äù is the key phrase.  Do not add everything there in a row. </p><br><h3 id="ispolzuyte-vlozhennye-menyu">  Use submenus </h3><br><p>  Use nested menus to make it easier for the user to navigate.  Give the menu items simple and clear names. </p><br><h3 id="ispolzuyte-ne-bolee-1-urovnya-vlozhennosti">  Use no more than 1 level of nesting </h3><br><p>  Despite the fact that the submenus can make navigation easier, they can easily complicate it.  Apple does not recommend using more than 1 level of nesting. </p><br><h3 id="raspolagayte-naibolee-chasto-ispolzuemye-punkty-v-verhney-chasti">  Locate the most frequently used items at the top. </h3><br><p>  People primarily focus on the top of the menu, so it will be a little easier for them to navigate in your application. </p><br><h3 id="ispolzuyte-gruppirovku">  Use grouping </h3><br><p>  Group similar menu items </p><br><h3 id="izbegayte-odnovremennogo-ispolzovaniya-kontekstnogo-menyu-i-menyu-redaktirovaniya-na-odnom-elemente">  Avoid simultaneous use of the context menu and the edit menu on the same item. </h3><br><p>  They may conflict with each other, because both are caused by a long tap. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/26d/ed2/24b/26ded224b635217601b986d56783e8b3.png" alt="Edit menu in iOS"></p><br><h3 id="ne-dobavlyayte-otdelnuyu-knopku-otkryt-v-menyu">  Do not add a separate ‚ÄúOpen‚Äù button to the menu. </h3><br><p>  Users can open an item by simply tapping on it.  An additional ‚ÄúOpen‚Äù button will be superfluous. </p><br><h2 id="prosteyshee-kontekstnoe-menyu-dlya-uiview">  The simplest context menu for UIView </h2><br><p>  Now that we have learned the basic rules for using context menus, let's move on to practice.  Of course, the menus work only on iOS 13 and higher, and for testing you will need Xcode 11. You can download the beta version of Xcode 11 <a href="https://developer.apple.com/download/">here</a> . </p><br><blockquote><h1 id="vy-mozhete-skachat-primer-polnostyu-otsyudahttpsgithubcomapphudexample-context_menus">  You can download an example completely <a href="https://github.com/apphud/example-context_menus">from here</a> . </h1><br></blockquote><p> Let's add a context menu, for example, on a <code>UIImageView</code> , <em>as in the animation above</em> . </p><br><p>  For this, it is enough to add the <code>UIImageView</code> object to the controller and write several lines of code, for example, in the <code>viewDidLoad</code> method: </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SingleViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> imageView: <span class="hljs-type"><span class="hljs-type">UIImageView!</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() imageView.isUserInteractionEnabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> interaction = <span class="hljs-type"><span class="hljs-type">UIContextMenuInteraction</span></span>(delegate: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) imageView.addInteraction(interaction) } }</code> </pre> <br><p>  At the beginning, an object of class <code>UIContextMenuInteraction</code> .  The designer requires you to specify a delegate who will be responsible for the menu.  Let's come back to this a little later.  And by the <code>addInteraction</code> method we add our menu to the picture. </p><br><p>  Now it remains to implement the protocol <code>UIContextMenuInteractionDelegate</code> .  It has only one mandatory method, which is responsible for creating the menu: </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SingleViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIContextMenuInteractionDelegate</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">contextMenuInteraction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> interaction: UIContextMenuInteraction, configurationForMenuAtLocation location: CGPoint)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> configuration = <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration</span></span>(identifier: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, previewProvider: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { actions -&gt; <span class="hljs-type"><span class="hljs-type">UIMenu</span></span>&lt;<span class="hljs-type"><span class="hljs-type">UIAction</span></span>&gt;? <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> save = <span class="hljs-type"><span class="hljs-type">UIAction</span></span>(__title: <span class="hljs-string"><span class="hljs-string">"My Button"</span></span>, image: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, options: []) { action <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-comment"><span class="hljs-comment">// Put button handler here } return configuration } }</span></span></code> </pre> <br><p>  If this method returns <code>nil</code> , the context menu will not be called.  Inside the method itself, we create an object of class <code>UIContextMenuConfiguration</code> .  When creating, we pass these parameters: </p><br><ul><li><p>  <code>identifier</code> - the menu identifier. </p><br></li><li><p>  <code>previewProvider</code> is a custom controller that can optionally be displayed instead of the current item in the menu.  We will look at this a little later. </p><br></li><li><p>  in <code>actionProvider</code> we pass context menu items. </p><br></li></ul><br><p>  The elements themselves are simpler to create: the name, an optional icon and a handler for clicking on a menu item are indicated.  That's all! </p><br><h3 id="dobavlyaem-vlozhennoe-menyu">  Add a submenu </h3><br><p>  Let's complicate things a bit.  Add to our picture a menu with two items: ‚ÄúSave‚Äù and ‚ÄúEdit ...‚Äù.  Clicking on ‚ÄúEdit ...‚Äù opens a submenu with the items ‚ÄúRotate‚Äù and ‚ÄúDelete‚Äù.  It should look like this: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/cb1/546/047/cb1546047c9d4b64864f63c2b99cdeb2.gif"></p><br><p>  To do this, you need to rewrite the protocol method <code>UIContextMenuInteractionDelegate</code> as follows: </p><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">contextMenuInteraction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> interaction: UIContextMenuInteraction, configurationForMenuAtLocation location: CGPoint)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> configuration = <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration</span></span>(identifier: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, previewProvider: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { actions -&gt; <span class="hljs-type"><span class="hljs-type">UIMenu</span></span>&lt;<span class="hljs-type"><span class="hljs-type">UIAction</span></span>&gt;? <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-comment"><span class="hljs-comment">// Creating Save button let save = UIAction(__title: "Save", image: UIImage(systemName: "tray.and.arrow.down.fill"), options: []) { action in // Just showing some alert self.showAlert(title: action.title) } // Creating Rotate button let rotate = UIAction(__title: "Rotate", image: UIImage(systemName: "arrow.counterclockwise"), options: []) { action in self.showAlert(title: action.title) } // Creating Delete button let delete = UIAction(__title: "Delete", image: UIImage(systemName: "trash.fill"), options: .destructive) { action in self.showAlert(title: action.title) } // Creating Edit, which will open Submenu let edit = UIMenu&lt;UIAction&gt;.create(title: "Edit...", children: [rotate, delete]) // Creating main context menu return UIMenu&lt;UIAction&gt;.create(title: "Menu", children: [save, edit]) } return configuration }</span></span></code> </pre> <br><p>  Here we create the ‚ÄúSave‚Äù, ‚ÄúRotate‚Äù and ‚ÄúDelete‚Äù buttons, add the last two to the ‚ÄúEdit ...‚Äù submenu and wrap everything into the main context menu. </p><br><h2 id="dobavlyaem-kontekstnoe-menyu-v-uicollectionview">  Add context menu to <code>UICollectionView</code> </h2><br><p>  Let's add a context menu to a <code>UICollectionView</code> .  With a long press on the cell, the user will be shown a menu with the item ‚ÄúArchive‚Äù, like this: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/904/a8f/4ed/904a8f4ed139724afc6b59cc7ac2bde2.gif"></p><br><p>  Adding a context menu to a <code>UICollectionView</code> is easy: just implement the optional <code>func collectionView(_ collectionView: UICollectionView, contextMenuConfigurationForItemAt indexPath: IndexPath, point: CGPoint) -&gt; UIContextMenuConfiguration?</code> method <code>func collectionView(_ collectionView: UICollectionView, contextMenuConfigurationForItemAt indexPath: IndexPath, point: CGPoint) -&gt; UIContextMenuConfiguration?</code>  <code>UICollectionViewDelegate</code> protocol.  This is what happened with us: </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">collectionView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> collectionView: UICollectionView, contextMenuConfigurationForItemAt indexPath: IndexPath, point: CGPoint)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> configuration = <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration</span></span>(identifier: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, previewProvider: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { actions -&gt; <span class="hljs-type"><span class="hljs-type">UIMenu</span></span>&lt;<span class="hljs-type"><span class="hljs-type">UIAction</span></span>&gt;? <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> action = <span class="hljs-type"><span class="hljs-type">UIAction</span></span>(__title: <span class="hljs-string"><span class="hljs-string">"Archive"</span></span>, image: <span class="hljs-type"><span class="hljs-type">UIImage</span></span>(systemName: <span class="hljs-string"><span class="hljs-string">"archivebox.fill"</span></span>), options: .destructive) { action <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-comment"><span class="hljs-comment">// Put button handler here } return UIMenu&lt;UIAction&gt;.create(title: "Menu", children: [action]) } return configuration }</span></span></code> </pre> <br><p>  Here, as before, the element and the menu itself are created.  Now with a long (strong) click on the cell, the user will see the context menu. </p><br><h2 id="dobavlyaem-kontekstnoe-menyu-v-uitableview">  Add context menu in <code>UITableView</code> </h2><br><p>  Here everything is similar to <code>UICollectionView</code> .  You need to implement the <code>contextMenuConfigurationForRowAt</code> method of the <code>UITableViewDelegate</code> protocol like this: </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, contextMenuConfigurationForRowAt indexPath: IndexPath, point: CGPoint)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> configuration = <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration</span></span>(identifier: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, previewProvider: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) { actions -&gt; <span class="hljs-type"><span class="hljs-type">UIMenu</span></span>&lt;<span class="hljs-type"><span class="hljs-type">UIAction</span></span>&gt;? <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> action = <span class="hljs-type"><span class="hljs-type">UIAction</span></span>(__title: <span class="hljs-string"><span class="hljs-string">"Custom action"</span></span>, image: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, options: []) { action <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-comment"><span class="hljs-comment">// Put button handler here } return UIMenu&lt;UIAction&gt;.create(title: "Menu", children: [action]) } return configuration }</span></span></code> </pre> <br><p>  But what if we want to use the custom screen in the context menu?  For example, such: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/42d/724/29d/42d72429d50424a69d1ecddb7a7c91ce.gif"></p><br><p>  To do this, when creating a <code>UIContextMenuConfiguration</code> should pass the desired <code>UIViewController</code> to the <code>previewProvider</code> .  Here is a sample code that implements this: </p><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PreviewViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">controller</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">PreviewViewController</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> storyboard = <span class="hljs-type"><span class="hljs-type">UIStoryboard</span></span>(name: <span class="hljs-string"><span class="hljs-string">"Main"</span></span>, bundle: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> controller = storyboard.instantiateViewController(withIdentifier: <span class="hljs-string"><span class="hljs-string">"PreviewViewController"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! <span class="hljs-type"><span class="hljs-type">PreviewViewController</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> controller } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TableViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITableViewDelegate</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, contextMenuConfigurationForRowAt indexPath: IndexPath, point: CGPoint)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> configuration = <span class="hljs-type"><span class="hljs-type">UIContextMenuConfiguration</span></span>(identifier: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, previewProvider: { () -&gt; <span class="hljs-type"><span class="hljs-type">UIViewController?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-comment"><span class="hljs-comment">// Return Preview View Controller here return PreviewViewController.controller() }) { _ -&gt; UIMenu&lt;UIAction&gt;? in let action = UIAction(__title: "Custom action", image: nil, options: []) { action in // Put button handler here } return UIMenu&lt;UIAction&gt;.create(title: "Menu", children: [action]) } return configuration } }</span></span></code> </pre> <br><p>  In the example, <code>PreviewViewController</code> initialized from the storyboard and displayed in the context menu. </p><br><p>  It remains to add the processing of clicking on this ViewController.  To do this, you need to implement the <code>willCommitMenuWithAnimator</code> method of the <code>UITableViewDelegate</code> protocol.  The handler itself will be placed inside <code>animator.addCompletion</code> : </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tableView: UITableView, willCommitMenuWithAnimator animator: UIContextMenuInteractionCommitAnimating)</span></span></span></span> { animator.addCompletion { <span class="hljs-comment"><span class="hljs-comment">// Put handler here } }</span></span></code> </pre> <br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Context menus are a new powerful tool for user interaction with your application.  And, as you can see, their implementation is quite simple.  But we should not forget that the methods can change until the release version of iOS 13 is released. </p><br><h2 id="chto-pochitat">  What to read? </h2><br><ul><li><p>  <a href="https://habr.com/ru/post/455443/">15 tips on how to get into the App Store with subscriptions</a> </p><br></li><li><p>  <a href="https://habr.com/ru/post/453770/">Apple Subscriptions Notifications for iOS Guide.</a>  <a href="https://habr.com/ru/post/453770/">Are they really good?</a> </p><br></li><li><p>  <a href="https://habr.com/ru/post/453442/">7 important things to know about iOS subscriptions</a> </p><br></li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/455854/">https://habr.com/ru/post/455854/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../455840/index.html">How to work with multiple queries. Composition, Reducer, OP</a></li>
<li><a href="../455842/index.html">Double-page list rotation. Swift Edition</a></li>
<li><a href="../455844/index.html">Creating a Roslyn analyzer using the encapsulation test as an example</a></li>
<li><a href="../455846/index.html">Distributed computing in Julia</a></li>
<li><a href="../455852/index.html">Sinus lifting and simultaneous implantation</a></li>
<li><a href="../455856/index.html">Wireless temperature, humidity and atmospheric pressure sensor on the nRF52832</a></li>
<li><a href="../455862/index.html">What's New in AWS: DATA API, Kinesis Data Analytics, S3 Path</a></li>
<li><a href="../455868/index.html">"Overcoming" Moore's Law: Transistor Technologies of the Future</a></li>
<li><a href="../45587/index.html">Magnetic Flying Globe</a></li>
<li><a href="../455874/index.html">Electron application notarization procedure for macOS 10.14.5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>