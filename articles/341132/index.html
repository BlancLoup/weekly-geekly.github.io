<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Environment for developing TypeScript and React web applications: from 'hello world' to modern SPA. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The purpose of this article is to write together with the reader an environment for developing modern web applications, consistently adding and custom...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Environment for developing TypeScript and React web applications: from 'hello world' to modern SPA. Part 2</h1><div class="post__text post__text-html js-mediator-article">  The purpose of this article is to write together with the reader an environment for developing modern web applications, consistently adding and customizing the necessary tools and libraries.  Similar to numerous starter-kit / boilerplate repositories, but ours is our own. <br><br>  The article is completely open for revision and correction, and, perhaps, the final material will turn into a relevant and convenient reference book, interesting both for professionals and for those who want to try out new technologies for them. <br><br><img src="https://habrastorage.org/webt/59/e5/00/59e500b380b6f460285912.png" alt="image"><br><a name="habracut"></a><br>  The article does not consider the detailed TypeScript syntax and the basics of working with React, if you do not have experience using the above technologies, it is recommended to separate their study. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="https://habrahabr.ru/post/340650/">Link to the first part of the article</a> <br><br>  <a href="https://github.com/SuperOleg39/react-redux-typescript-starter">The project repository</a> contains the code in separate branches for each step. <br><br><h4>  The main theme of the 2nd part is the connection and use of the <a href="http://redux.js.org/">Redux</a> state manager. </h4><br>  The reasons for using Redux, and comparing it with other implementations of the Flux pattern are topics for individual articles, this information is easy to find and study. <br><br>  I will point out several advantages - a large community and ecosystem, the ability to fully control the behavior of your application, ease of testing, and certain steps towards learning functional programming. <br><br>  <b><a href="https://github.com/reactjs/react-redux">React-redux</a></b> is a small library that provides us with several React components ‚Äî the <i>Provider</i> , to transfer Redux storage to the <a href="https://reactjs.org/docs/context.html">context</a> , and <i>connect</i> , the highest order component to point and transfer data from the storage to the properties of the wrapped component. <br><br>  Let's go to the code! <br><br><h4>  Step four - add Redux to the project, basic hello world </h4><br>  To view the final code: <br><br><pre><code class="javascript hljs">git checkout step<span class="hljs-number"><span class="hljs-number">-4</span></span></code> </pre> <br>  In the <i>src</i> folder, we delete components - examples from step # 3, only <i>index.html</i> and <i>index.tsx remain</i> . <br><br>  <b>Installation of dependencies</b> (redux includes in the source file a declaration): <br><br><pre> <code class="javascript hljs">npm install redux react-redux -S npm install @types/react-redux -D</code> </pre><br>  <b>Change project settings:</b> <br><br>  In <i>tsconfig.json,</i> we add the moduleResolution: node property so that the compiler finds the declarations defined in the package.json library (in our case redux): <br><br><div class="spoiler">  <b class="spoiler_title">tsconfig.json</b> <div class="spoiler_text"><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"compilerOptions"</span></span>: { <span class="hljs-string"><span class="hljs-string">"lib"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"es5"</span></span>, <span class="hljs-string"><span class="hljs-string">"es6"</span></span>, <span class="hljs-string"><span class="hljs-string">"es7"</span></span>, <span class="hljs-string"><span class="hljs-string">"dom"</span></span> ], <span class="hljs-string"><span class="hljs-string">"target"</span></span>: <span class="hljs-string"><span class="hljs-string">"es5"</span></span>, <span class="hljs-string"><span class="hljs-string">"module"</span></span>: <span class="hljs-string"><span class="hljs-string">"esnext"</span></span>, <span class="hljs-string"><span class="hljs-string">"jsx"</span></span>: <span class="hljs-string"><span class="hljs-string">"react"</span></span>, <span class="hljs-string"><span class="hljs-string">"moduleResolution"</span></span>: <span class="hljs-string"><span class="hljs-string">"node"</span></span> } }</code> </pre><br></div></div><br>  <b>We will create simple actions and a reducer for the future storage, using the methodology <a href="https://github.com/erikras/ducks-modular-redux">of the ducks modules</a> .</b> <br><br>  In the source folder, create a folder <i>redux</i> to store ducks modules.  Inside we create the file <i>field.ts</i> : <br><br><div class="spoiler">  <b class="spoiler_title">field.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** * State * *       , *      . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface FieldState { <span class="hljs-attr"><span class="hljs-attr">value</span></span>: string; focus: boolean; } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState: FieldState = { <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">focus</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } <span class="hljs-comment"><span class="hljs-comment">/** * Constants * *    ,   . *       ,    *        . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SET = <span class="hljs-string"><span class="hljs-string">'field/SET'</span></span>; type SET = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> SET; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> FOCUS = <span class="hljs-string"><span class="hljs-string">'field/FOCUS'</span></span>; type FOCUS = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> FOCUS; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> BLUR = <span class="hljs-string"><span class="hljs-string">'field/BLUR'</span></span>; type BLUR = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> BLUR; <span class="hljs-comment"><span class="hljs-comment">/** * Actions * *  Redux  TypeScript,     * ,     (FieldAction)   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface SetAction { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: SET; payload: string; } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface FocusAction { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: FOCUS; } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface BlurAction { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: BLUR; } type FieldAction = SetAction | FocusAction | BlurAction; <span class="hljs-comment"><span class="hljs-comment">/** * Reducer * *    ,     ,  *      . *  action     ,  *       (FieldAction),   *      ( case SET)   *    action. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reducer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state: FieldState = initialState, action: FieldAction</span></span></span><span class="hljs-function">): </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FieldState</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> SET: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: action.payload } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> FOCUS: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">focus</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> BLUR: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">focus</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state; } } <span class="hljs-comment"><span class="hljs-comment">/** * Action Creators * *      , *        *  ,       * . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> set = (payload: string): <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SetAction</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">type</span></span>: SET, payload }); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> focus = (): <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">FocusAction</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">type</span></span>: FOCUS }); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> blur = (): <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BlurAction</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">type</span></span>: BLUR });</code> </pre><br></div></div><br>  Add the <i>index.ts</i> file to the <i>redux folder</i> - we will import it into the storage as a root reducer (rootReducer). <br><br><div class="spoiler">  <b class="spoiler_title">redux / index.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { combineReducers } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> fieldReducer <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./field'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> combineReducers({ <span class="hljs-attr"><span class="hljs-attr">field</span></span>: fieldReducer })</code> </pre><br></div></div><br>  Next we will use the tools for developing on Redux - <a href="https://github.com/zalmoxisus/redux-devtools-extension">Redux DevTools</a> . <br>  In the source folder we create the <i>store</i> folder, inside the <i>index.ts</i> file: <br><br><div class="spoiler">  <b class="spoiler_title">store / index.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createStore } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> rootReducer <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { FieldState } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../redux/field'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *       mapStateToProps, *    ,       * (,     redux-thunk) */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface IStore { <span class="hljs-attr"><span class="hljs-attr">field</span></span>: FieldState } <span class="hljs-comment"><span class="hljs-comment">/** *          . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> configureStore = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">initialState?: IStore</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> createStore( rootReducer, initialState, <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.__REDUX_DEVTOOLS_EXTENSION__ &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.__REDUX_DEVTOOLS_EXTENSION__() ) }; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> configureStore;</code> </pre><br></div></div><br>  The TypeScript compiler knows nothing about the __REDUX_DEVTOOLS_EXTENSION__ property of the global window object, so it's time to add your own declarations. <br><br>  Further, we will add global flags to these declarations, which we will transmit via a Webpack, for example __DEV__ or __PRODUCTION__. <br><br>  In the root folder, create the <i>typings</i> folder, inside the <i>window.d.ts</i> file: <br><br><div class="spoiler">  <b class="spoiler_title">window.d.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs">interface Window { <span class="hljs-attr"><span class="hljs-attr">__REDUX_DEVTOOLS_EXTENSION_COMPOSE__</span></span>: any; __REDUX_DEVTOOLS_EXTENSION__: any; }</code> </pre><br></div></div><br>  Next, we write a component that receives data from the repository and causes it to be updated.  For simplicity, there will be no separation into components and containers.  In the source folder we create the <i>components</i> folder, inside the <i>Field.tsx</i> file: <br><br><div class="spoiler">  <b class="spoiler_title">Field.tsx</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { connect, Dispatch, DispatchProp } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { IStore } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../store'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { set, focus, blur } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../redux/field'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *   DispatchProp ,   dispatch  *   .    connect,    *  ( mapDispatchToProps) */</span></span> interface FieldProps extends DispatchProp&lt;IStore&gt;, React.HTMLProps&lt;HTMLInputElement&gt; { value?: string; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Field</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FieldProps</span></span></span><span class="hljs-class">, </span></span>{}&gt; { handleChange = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event: React.FormEvent&lt;HTMLInputElement&gt;</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { dispatch } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> value = event.currentTarget.value; <span class="hljs-comment"><span class="hljs-comment">/** *     set  dispatch  *   . */</span></span> dispatch(set(value)); } handleFocus = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { dispatch } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; dispatch(focus()); } handleBlur = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { dispatch } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; dispatch(blur()); } render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { value, dispatch, ...inputProps } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;input {...inputProps} type=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"text"</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value={value} onChange={</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.handleChange} onFocus={</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.handleFocus} onBlur={</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.handleBlur} </span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/&gt; ); } } /</span></span></span></span><span class="hljs-function"><span class="hljs-params">** *   mapStateToProps,   (  </span></span></span><span class="hljs-function">) *        */ </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">mapStateToProps</span></span></span><span class="hljs-function"> = (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state: IStore, ownProps: FieldProps</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">value</span></span>: state.field.value }); <span class="hljs-comment"><span class="hljs-comment">/** *  mapDispatchToProps: * (dispatch: Dispatch&lt;IStore&gt;, ownProps: FieldProps) =&gt; ({ ... }) */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * connect   ,   10   *   . *  ,   3 : *  mapStateToProps,  mapDispatchToProps,  *   . *  ,       , *         . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> connect&lt;{}, {}, FieldProps&gt;(mapStateToProps)(Field);</code> </pre><br></div></div><br>  And finally, let's collect everything in our application, at the entry point - <i>src / index.tsx</i> : <br><br><div class="spoiler">  <b class="spoiler_title">src / index.tsx</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ReactDOM <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-dom'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Provider } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> configureStore <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./store'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Field <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./components/Field'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *   ,   initialState  * window.__INITIAL_STATE__,       *    . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> store = configureStore(); <span class="hljs-comment"><span class="hljs-comment">/** *          *  DevTools */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> App = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Provider</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">store</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{store}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Hello, Redux!</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Field</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">'I like dev tools!'</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Provider</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ); ReactDOM.render(</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">App</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">, document.getElementById('root'));</span></span></code> </pre><br></div></div><br><h4>  Step Five - Some Typescript Redux Recipes </h4><br>  To view the final code: <br><br><pre> <code class="javascript hljs">git checkout step<span class="hljs-number"><span class="hljs-number">-5</span></span></code> </pre> <br>  <b>The first recipe is middleware.</b> <br><br>  In the source folder, create the <i>middlewares</i> folder, inside the <i>logger.ts</i> file (the code is taken from the <a href="http://redux.js.org/docs/advanced/Middleware.html">official documentation</a> ): <br><br><div class="spoiler">  <b class="spoiler_title">middlewares / logger.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Middleware, MiddlewareAPI, Dispatch, Action } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { IStore } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../store'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *    store - MiddlewareAPI&lt;S &amp; IStore&gt; -   *   ,      *    .     , *    middleware  -. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> logger: Middleware = &lt;S&gt;(store: MiddlewareAPI&lt;S &amp; IStore&gt;) =&gt; (next: Dispatch&lt;S&gt;) =&gt; //   - &lt;A extends Action&gt;(action: A),   . (action: any) =&gt; { //     store.getState().field.value; console.log('dispatching', action); let result = next(action); console.log('next state', store.getState()); return result; } export default logger;</code> </pre><br></div></div><br>  Update the code to create our repository: <br><br><div class="spoiler">  <b class="spoiler_title">store / index.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createStore, compose, applyMiddleware } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> rootReducer <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { FieldState } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../redux/field'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> logger <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../middlewares/logger'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface IStore { <span class="hljs-attr"><span class="hljs-attr">field</span></span>: FieldState } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> composeEnhancers = compose; <span class="hljs-comment"><span class="hljs-comment">//      middleware const middlewares = [ logger ]; if (window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__) { composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__; } const configureStore = (initialState?: IStore) =&gt; { return createStore( rootReducer, initialState, composeEnhancers( applyMiddleware(...middlewares) ) ) }; export default configureStore;</span></span></code> </pre><br></div></div><br>  <b>The second recipe is a high order reducer.</b> <br><br>  In the <i>redux</i> folder, create the file <i>createNamedReducer.ts</i> (the code is taken from the <a href="http://redux.js.org/docs/recipes/reducers/ReusingReducerLogic.html">official documentation</a> ): <br><br><div class="spoiler">  <b class="spoiler_title">createNamedReducer.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Reducer, Action } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { IStore } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../store'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *      ,  * ,   createNamedReducer */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface namedAction extends Action { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: string; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNamedReducer</span></span></span><span class="hljs-function">&lt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">S</span></span></span><span class="hljs-function">&gt;(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">reducer: Reducer&lt;S&gt;, reducerName: string</span></span></span><span class="hljs-function">): </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Reducer</span></span></span><span class="hljs-function">&lt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">S</span></span></span><span class="hljs-function">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state: S, action: namedAction</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { name } = action; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> isInitializationCall = state === <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (name !== reducerName &amp;&amp; !isInitializationCall) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> reducer(state, action); } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> createNamedReducer;</code> </pre><br></div></div><br><h4>  Step Six - work with API </h4><br>  To view the final code: <br><br><pre> <code class="javascript hljs">git checkout step<span class="hljs-number"><span class="hljs-number">-6</span></span></code> </pre> <br>  <b>Attention!</b>  I prefer to make the methods for working with the API into separate services, and bind the data to the repository, calling these methods inside the thunk actions. <br><br>  But there are libraries such as redux-axios-middleware and redux-api, which are designed to reduce the sample code and create a wrapper for creating http requests. <br><br>  Therefore, I would like to add this article with your tips and comments on the Redux bundle with the REST API, and in the future to describe in detail the most popular techniques. <br><br>  For moki API we will use the <a href="https://jsonplaceholder.typicode.com/">jsonplaceholder</a> service. <br><br>  <b>Installation of dependencies</b> (both libraries contain declarations): <br><br><pre> <code class="javascript hljs">npm install axios redux-thunk -S</code> </pre> <br>  Create a <i>services</i> folder in the source of the project, inside the <i>client.ts</i> and <i>users.ts files</i> : <br><br><div class="spoiler">  <b class="spoiler_title">client.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> axios <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'axios'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *        redux * ,       . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> client = axios.create({ <span class="hljs-attr"><span class="hljs-attr">baseURL</span></span>: <span class="hljs-string"><span class="hljs-string">'https://jsonplaceholder.typicode.com'</span></span> }); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> client;</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">users.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { AxiosPromise } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'axios'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> client <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./client'</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       export interface IUser { id: number; name: string; username: string; email: string; address: any; phone: string; website: string; company: any; } export function get(id: number): AxiosPromise&lt;IUser&gt; { return client.get(`/users/${id}`); } export function getList(): AxiosPromise&lt;IUser[]&gt; { return client.get('/users'); }</span></span></code> </pre><br></div></div><br>  Next, we will create a new ducks module <i>users.ts</i> , just at this stage, many questions arise, and many options for resolving them: <br><br><div class="spoiler">  <b class="spoiler_title">redux / users.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Dispatch } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { IStore } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../store'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> client <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../services/users'</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     type Error = any; //       http  interface AsyncState&lt;D&gt; { isFetching: boolean; error: Error; data: D; } //    ,      interface AsyncAction&lt;P&gt; { status?: 'error' | 'success'; payload?: P | Error; } /** * State */ export interface UsersState { get: AsyncState&lt;client.IUser&gt;; getList: AsyncState&lt;client.IUser[]&gt;; } const initialState: UsersState = { get: { isFetching: false, error: null, data: null }, getList: { isFetching: false, error: null, data: [] } } /** * Constants */ const GET = 'users/GET'; type GET = typeof GET; const GET_LIST = 'users/GET_LIST'; type GET_LIST = typeof GET_LIST; /** * Actions */ export interface GetAction extends AsyncAction&lt;client.IUser&gt; { type: GET; } export interface GetListAction extends AsyncAction&lt;client.IUser[]&gt; { type: GET_LIST; } type UsersAction = GetAction | GetListAction; /** * Reducer * * ,  ! *   ,       *    ,    *   . *     ,     * ,  -   . */ export default function reducer(state: UsersState = initialState, action: UsersAction): UsersState { switch (action.type) { case GET: if (!action.status) { return { ...state, get: { ...state.get, isFetching: true, error: null } } } if (action.status === 'error') { return { ...state, get: { isFetching: false, error: action.payload, data: null } } } return { ...state, get: { isFetching: false, error: null, data: action.payload } } case GET_LIST: if (!action.status) { return { ...state, getList: { ...state.getList, isFetching: true, error: null } } } if (action.status === 'error') { return { ...state, getList: { isFetching: false, error: action.payload, data: [] } } } return { ...state, getList: { isFetching: false, error: null, data: action.payload } } default: return state; } } /** * Action Creators */ export const getActionCreator = ( status?: 'error' | 'success', payload?: client.IUser | Error ): GetAction =&gt; ({ type: GET, status, payload, }); export const getListActionCreator = ( status?: 'error' | 'success', payload?: client.IUser[] | Error ): GetListAction =&gt; ({ type: GET_LIST, status, payload, }); /** * Thunk Actions */ export function get(id: number) { return async (dispatch: Dispatch&lt;IStore&gt;, getState: () =&gt; IStore) =&gt; { dispatch(getActionCreator()); try { const response = await client.get(id); dispatch(getActionCreator('success', response.data)); } catch (e) { dispatch(getActionCreator('error', e)); throw new Error(e); } } } export function getList() { return async (dispatch: Dispatch&lt;IStore&gt;, getState: () =&gt; IStore) =&gt; { dispatch(getListActionCreator()); try { const response = await client.getList(); dispatch(getListActionCreator('success', response.data)); } catch (e) { dispatch(getListActionCreator('error', e)); throw new Error(e); } } }</span></span></code> </pre><br></div></div><br>  Update the rootReducer and the storage interface, add thunk-middleware: <br><br><div class="spoiler">  <b class="spoiler_title">redux / index.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { combineReducers } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> fieldReducer <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./field'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> usersReducer <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./users'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> combineReducers({ <span class="hljs-attr"><span class="hljs-attr">field</span></span>: fieldReducer, <span class="hljs-attr"><span class="hljs-attr">users</span></span>: usersReducer });</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">store / index.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createStore, compose, applyMiddleware } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ReduxThunk <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-thunk'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> rootReducer <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { FieldState } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../redux/field'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { UsersState } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../redux/users'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> logger <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../middlewares/logger'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface IStore { <span class="hljs-attr"><span class="hljs-attr">field</span></span>: FieldState, <span class="hljs-attr"><span class="hljs-attr">users</span></span>: UsersState } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> composeEnhancers = compose; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> middlewares = [ logger, ReduxThunk ]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__) { composeEnhancers = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__; } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> configureStore = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">initialState?: IStore</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> createStore( rootReducer, initialState, composeEnhancers( applyMiddleware(...middlewares) ) ) }; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> configureStore;</code> </pre><br></div></div><br>  Next, write a component that display a list of users, an error message, or a conditional preloader: <br><br><div class="spoiler">  <b class="spoiler_title">Users.tsx</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { connect, Dispatch, DispatchProp } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { IStore } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../store'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { getList, <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../redux/users'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { IUser } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../services/users'</span></span>; interface UsersProps extends DispatchProp&lt;IStore&gt; { isFetching?: boolean; error?: <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>; users?: IUser[]; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Users</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UsersProps</span></span></span><span class="hljs-class">, </span></span>{}&gt; { componentDidMount() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { dispatch } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; dispatch(getList()); } render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { isFetching, error, users } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (error) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">b</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> !</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">b</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isFetching) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'...'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> users.map(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">user</span></span></span><span class="hljs-function">) =&gt;</span></span> &lt;div&gt;{user.name}&lt;<span class="hljs-regexp"><span class="hljs-regexp">/div&gt;); } } const mapStateToProps = (state: IStore, ownProps: UsersProps) =&gt; ({ isFetching: state.users.getList.isFetching, error: state.users.getList.error, users: state.users.getList.data }); export default connect&lt;{}, {}, UsersProps&gt;(mapStateToProps)(Users);</span></span></code> </pre><br></div></div><br>  Next, simply call the <i>&lt;Users /&gt;</i> component in the root component of our application. <br><br>  <b>Questions without clear answers:</b> <br><br>  Do I need to store the request object in the repository, and what advantages can it give?  Perhaps this will simplify the cancellation of requests. <br><br>  What to do when one GET request with dynamic: id in url, use many components on one screen? <br><br>  A similar problem with asynchronous autocomplete, when different parameters go to one request.  You can cache responses, but in such cases, you also need to track the status of each of the requests separately, which requires separate reducers. <br><br>  Does it make sense to use components that add reducers dynamically, for one specific request, or part of asynchronous data that is used only locally, do not need to be stored in Redux at all? <br><br>  Let's write a detailed commentary on the article about how we work with the API in our React + Redux applications, and proceed to the next step. <br><br><h4>  Step Seven - production and development build </h4><br>  To view the final code: <br><br><pre> <code class="javascript hljs">git checkout step<span class="hljs-number"><span class="hljs-number">-7</span></span></code> </pre> <br>  1) <b>Cross-browser compatibility</b> <br>  Install dependencies: <br><br><pre> <code class="javascript hljs">npm install core-js -S npm install @types/core-js -D</code> </pre><br>  <a href="https://github.com/zloirock/core-js">Core-js</a> is a library with polyfills of modern JS constructions.  Importing the <i>core-js / shim module is</i> almost the same as using the <i>babel-polyfill plugin</i> . <br><br>  We use only a few <a href="https://reactjs.org/docs/javascript-environment-requirements.html">required polyfills</a> , add them to the beginning of the entry point into the application: <br><br><div class="spoiler">  <b class="spoiler_title">src / index.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'core-js/es6/promise'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'core-js/es6/map'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'core-js/es6/set'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.requestAnimationFrame !== <span class="hljs-string"><span class="hljs-string">'function'</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.requestAnimationFrame = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">callback: FrameRequestCallback</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.setTimeout(callback, <span class="hljs-number"><span class="hljs-number">0</span></span>); } ...</code> </pre><br></div></div><br>  In the <i>tsconfig.json</i> file, the "target" property is already listed as "es5", so most polyfills are not necessary.  The current build supports IE9 +. <br><br>  1) <b>Production assembly</b> <br><br>  At this stage, we need to add the build parameters, change the webpack settings themselves, and send the <i>process.env.NODE_ENV</i> value as a global parameter ‚Äî some libraries, such as React, use the prod or dev source depending on this parameter. <br><br>  Install dependencies: <br><br><pre> <code class="javascript hljs">npm install better-npm-run -D</code> </pre> <br>  <a href="https://github.com/benoror/better-npm-run">better-npm-run</a> - pumps our npm scripts. <br><br>  Edit npm scripts in <i>package.json</i> , environment variables are very conveniently defined in the ‚ÄúbetterScripts‚Äù block: <br><br><div class="spoiler">  <b class="spoiler_title">package.json</b> <div class="spoiler_text"><pre> <code class="javascript hljs">{ ... <span class="hljs-string"><span class="hljs-string">"scripts"</span></span>: { <span class="hljs-string"><span class="hljs-string">"start"</span></span>: <span class="hljs-string"><span class="hljs-string">"better-npm-run dev"</span></span>, <span class="hljs-string"><span class="hljs-string">"build"</span></span>: <span class="hljs-string"><span class="hljs-string">"better-npm-run build"</span></span> }, <span class="hljs-string"><span class="hljs-string">"betterScripts"</span></span>: { <span class="hljs-string"><span class="hljs-string">"dev"</span></span>: { <span class="hljs-string"><span class="hljs-string">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">"webpack-dev-server"</span></span>, <span class="hljs-string"><span class="hljs-string">"env"</span></span>: { <span class="hljs-string"><span class="hljs-string">"NODE_ENV"</span></span>: <span class="hljs-string"><span class="hljs-string">"development"</span></span> } }, <span class="hljs-string"><span class="hljs-string">"build"</span></span>: { <span class="hljs-string"><span class="hljs-string">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">"webpack"</span></span>, <span class="hljs-string"><span class="hljs-string">"env"</span></span>: { <span class="hljs-string"><span class="hljs-string">"NODE_ENV"</span></span>: <span class="hljs-string"><span class="hljs-string">"production"</span></span> } } }, ... }</code> </pre><br></div></div><br>  When the webpack settings are complicated, the <a href="https://github.com/survivejs/webpack-merge">webpack-merge</a> plugin comes to the rescue - at the moment we will not use it, so as not to complicate the code. <br><br>  Changes in <i>webpack.config.js</i> : <br><br><div class="spoiler">  <b class="spoiler_title">webpack.config.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> path = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'path'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> webpack = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'webpack'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> HtmlWebpackPlugin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'html-webpack-plugin'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CleanWebpackPlugin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'clean-webpack-plugin'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    const env = process.env.NODE_ENV; const __DEV__ = env === 'development'; const __PRODUCTION__ = env === 'production'; const paths = { src: path.resolve(__dirname, 'src'), dist: path.resolve(__dirname, 'dist') }; const config = { context: paths.src, entry: { app: './index' }, //     ,   output: { path: paths.dist, filename: __PRODUCTION__ ? '[name].bundle.[chunkhash].js' : '[name].bundle.js', chunkFilename: __PRODUCTION__ ? '[name].bundle.[chunkhash].js' : '[name].bundle.js' }, resolve: { extensions: ['.ts', '.tsx', '.js', '.jsx'] }, module: { rules: [ { test: /\.tsx?$/, loader: 'awesome-typescript-loader' } ] }, plugins: [ //   NODE_ENV     new webpack.DefinePlugin({ 'process.env.NODE_ENV': JSON.stringify(env) }), new HtmlWebpackPlugin({ template: './index.html' }), //      new webpack.optimize.ModuleConcatenationPlugin() ] }; if (__DEV__) { //  source map  development  config.devtool = 'inline-source-map'; } if (__PRODUCTION__) { config.plugins.push(new CleanWebpackPlugin(['dist'])); //   config.plugins.push(new webpack.optimize.UglifyJsPlugin()); } module.exports = config;</span></span></code> </pre><br></div></div><br>  Use the command for the build assembly: <br><br><pre> <code class="javascript hljs">npm run build</code> </pre> <br>  Upon completion of the build, we get a total bandwidth of about 180kb, about 55kb gzipped.  Further, libraries from node_modules can be put into a separate bundle using <a href="https://webpack.js.org/plugins/commons-chunk-plugin/">CommonsChunkPlugin</a> . <br><br>  Topics for the following articles: routing, building progressive web application (PWA), server rendering, testing with Jest. <br><br>  Thank you for attention! </div><p>Source: <a href="https://habr.com/ru/post/341132/">https://habr.com/ru/post/341132/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../341120/index.html">The project is blind: we dive headlong</a></li>
<li><a href="../341122/index.html">Yulmart game theory</a></li>
<li><a href="../341126/index.html">Vibe.js - an attempt to make state management without pain</a></li>
<li><a href="../341128/index.html">Economic experiments in virtual reality</a></li>
<li><a href="../341130/index.html">Chronology of CO level in the atmosphere of the USA (solution of the Kaggle problem using Python + Feature Engineering)</a></li>
<li><a href="../341134/index.html">Design pattern "state" twenty years later</a></li>
<li><a href="../341138/index.html">Step-by-step tutorial on working with Antlr4 with Maven project for Java through Intellij Idea</a></li>
<li><a href="../341140/index.html">Bonus vs depreirovanie</a></li>
<li><a href="../341142/index.html">We look for typo names in PostgreSQL</a></li>
<li><a href="../341144/index.html">What every C programmer should know about Undefined Behavior. Part 2/3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>