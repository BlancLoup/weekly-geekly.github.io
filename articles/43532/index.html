<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Virtualization of the file system and registry within a single application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, Habrovca ‚Äã‚Äãand Khabrovcans! 

 I am the main developer of the boxedapp.com project and I would like to tell a little about it, because for some...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Virtualization of the file system and registry within a single application</h1><div class="post__text post__text-html js-mediator-article"> Hello, Habrovca ‚Äã‚Äãand Khabrovcans! <br><br>  I am the main developer of the <a href="http://boxedapp.com/">boxedapp.com</a> project and I would like to tell a little about it, because  for some reason, very few Russian-speaking users are interested in our development. <br><br>  Surely many have heard of thinstall.  It is a tool that allows you to pack exe along with all the files and registry keys that it requires in a single exe, which you can then run anywhere. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We decided to create something similar, but directly for developers.  A kind of SDK that allows you to create virtual files, registry keys, etc. <br><br>  And, actually, why this may be required? <br><br><a name="habracut"></a><br><br>  For example, we have several dll-ek, which are used in the program.  The task is to continue their use, but to hide the fact of the presence of these files.  The option to save dlls in TEMP is not good - ugly, it may not be enough rights, but you never know.  Using BoxedApp, you can create a virtual file with a DLL, load content into it (from anywhere): <br><br><pre> <code class="hljs objectivec">HANDLE hFile__DLL1 = BoxedAppSDK_CreateVirtualFile( _T(<span class="hljs-string"><span class="hljs-string">"Z:\\DLL1.dll"</span></span>), GENERIC_WRITE, FILE_SHARE_READ, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, CREATE_NEW, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> ); DWORD dwTemp; WriteFile(hFile__DLL1, pBuffer, dwSize, &amp;dwTemp, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); CloseHandle(hFile__DLL1); <br></code> </pre> <code>HANDLE hFile__DLL1 = BoxedAppSDK_CreateVirtualFile( _T("Z:\\DLL1.dll"), GENERIC_WRITE, FILE_SHARE_READ, NULL, CREATE_NEW, 0, NULL ); DWORD dwTemp; WriteFile(hFile__DLL1, pBuffer, dwSize, &amp;dwTemp, NULL); CloseHandle(hFile__DLL1); <br></code> <br><br>  Now we use dll-ku, as if it really existed: <br><br><pre> <code class="hljs objectivec">HMODULE hModule = LoadLibrary(_T(<span class="hljs-string"><span class="hljs-string">"Z:\\DLL1.dll"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> (WINAPI *P_Function)(); P_Function pFunction = (P_Function)GetProcAddress(hModule, <span class="hljs-string"><span class="hljs-string">"Function"</span></span>); pFunction(); FreeLibrary(hModule); <br></code> </pre> <code>HMODULE hModule = LoadLibrary(_T("Z:\\DLL1.dll")); typedef void (WINAPI *P_Function)(); P_Function pFunction = (P_Function)GetProcAddress(hModule, "Function"); pFunction(); FreeLibrary(hModule); <br></code> <br><br>  This is a simple example. <br><br>  Much more interesting when we want to use ActiveX, but for several reasons we can not deploy it on a client computer.  For example, we write so-called.  portable application.  And here BoxedApp can help: <br><br><pre> <code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateVirtualFlashOCX</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ LPVOID pBuffer; DWORD dwSize; ... HANDLE hVirtualFile1 = BoxedAppSDK_CreateVirtualFile( _T(<span class="hljs-string"><span class="hljs-string">"C:\\Flash9e.ocx"</span></span>), GENERIC_READ, FILE_SHARE_READ, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, CREATE_NEW, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); DWORD dwTemp; WriteFile(hVirtualFile1, pBuffer, dwSize, &amp;dwTemp, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); CloseHandle(hVirtualFile1); BoxedAppSDK_RegisterCOMLibraryInVirtualRegistry(_T(<span class="hljs-string"><span class="hljs-string">"C:\\Flash9e.ocx"</span></span>)); } <br></code> </pre> <code>void CreateVirtualFlashOCX() { LPVOID pBuffer; DWORD dwSize; ... HANDLE hVirtualFile1 = BoxedAppSDK_CreateVirtualFile( _T("C:\\Flash9e.ocx"), GENERIC_READ, FILE_SHARE_READ, NULL, CREATE_NEW, 0, NULL); DWORD dwTemp; WriteFile(hVirtualFile1, pBuffer, dwSize, &amp;dwTemp, NULL); CloseHandle(hVirtualFile1); BoxedAppSDK_RegisterCOMLibraryInVirtualRegistry(_T("C:\\Flash9e.ocx")); } <br></code> <br><br>  BoxedAppSDK_RegisterCOMLibraryInVirtualRegistry loads the module specified as an argument and registers it in the virtual registry.  The real registry does not change, and all changes are saved locally within the current process.  When some function later calls CoCreateInstance, and from the depths of the subsystem's COM, the registry will be accessed - BoxedApp will provide the necessary keys, and the COM object will be successfully created. <br><br>  BoxedApp can still very much (for example, pack .net runtime), but will be able to even more :) <br><br>  If you have read it, thank you for your attention! </div><p>Source: <a href="https://habr.com/ru/post/43532/">https://habr.com/ru/post/43532/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../435308/index.html">Electronic books and their formats: we tell about PDF - its history, pluses and minuses</a></li>
<li><a href="../435310/index.html">Widevine L3 DRM protection hacked</a></li>
<li><a href="../435312/index.html">Electric Polestar 2 - the first electric car with native Android Android OS</a></li>
<li><a href="../435314/index.html">‚ÄúYou know what's best ‚Äî do it better‚Äù: a new podcast about the mix of work and the hobby of an editor / marketer</a></li>
<li><a href="../435316/index.html">Korean scientists have created a system for tracking road traffic from two laptops</a></li>
<li><a href="../435320/index.html">Faster and more accurate: a hybrid system of heterogeneous qubits</a></li>
<li><a href="../435322/index.html">Another Redux Boilerplate Reduction Guide (NGRX)</a></li>
<li><a href="../435324/index.html">Tesla starts building a factory in Shanghai, but the situation in the company is complicated</a></li>
<li><a href="../435326/index.html">Videoconferencing systems market overview</a></li>
<li><a href="../435328/index.html">How to work with Shader Graph in Unity3D</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>