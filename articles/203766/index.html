<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using the OpenVAS Vulnerability Scanner</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vulnerability scanners are software or hardware tools used to diagnose and monitor networked computers, allowing you to scan networks, computers and a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using the OpenVAS Vulnerability Scanner</h1><div class="post__text post__text-html js-mediator-article">  Vulnerability scanners are software or hardware tools used to diagnose and monitor networked computers, allowing you to scan networks, computers and applications to detect possible security problems, assess and fix vulnerabilities.  (Wikipedia) <br>  Famous commercial scanners are Nessus, GFI LANguard, XSpider. <br><br>  Unlike others, OpenVAS is free, works without any restrictions and can be useful to both network administrators and information security specialists to identify current problems of its infrastructure. <br><img src="https://habrastorage.org/getpro/habr/post_images/256/c46/c01/256c46c0163e5de310512aca38cc5186.png"><br><a name="habracut"></a><br><br>  At the core of OpenVAS is a constantly updated collection of NVT security tests (of which there are already more than 30,000), as well as a connection to the CVE database, which describes known vulnerabilities.  Executing NVT tests reveals a vulnerability, and CVE provides a description of the problem and how to solve it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's get started <br><br>  <b>1. The choice of iron.</b> <br>  Everything is simple, if you have to scan frequently and large address ranges, the more powerful the iron, the better.  You can increase the number of parallel streams processing network addresses, and the scan itself on each host will be faster. <br><br>  <b>2. Installation.</b> <br>  Here I choose the least problematic way for me to install from packages. <br>  We go to the address. <br>  <a href="http://www.openvas.org/install-packages.html">www.openvas.org/install-packages.html</a> <br>  Select the desired distribution and install. <br><br>  In my case, this is CentOS and the atomicorp repository.  The script itself will download all the dependencies, conduct the initial update of the vulnerability database and prescribe the necessary settings.  In the process, ask for a login and password to access Openvas. <br><br>  <b>3. Usage.</b> <br>  Go to the address <a href="https://localhost/">localhost</a> : 9392 enter the username and password and we are in the management console Greenbone Security Assistant. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f73/c0f/00c/f73c0f00c6b2b09b5fc9d7d763254c25.png"><br><br>  The following is an example of working with Openvas to scan the internal network range  The basic settings are sharpened for the optimal scan speed of each host. <br><br>  <b>3.1 Select the scan configuration.</b> <br>  Go to the section Configuration - Scan Configs. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fc5/046/a84/fc5046a84775a37e4af10e49546d2f76.png"><br><br>  We see 4 standard policies and 1 empty. <br><br>  Politicians are divided into 2 groups - fast and deep. <br>  The principal difference is that deep does not take into account the work of each previous verification script and the collection of information begins anew. <br><br>  According to my tests, this significantly increased the scan time of each host, in the absence of a meaningful result.  Therefore, for greater speed, we select the Full and fast ultimate policy and clone it by clicking on the lamb icon <img src="https://habrastorage.org/getpro/habr/post_images/cfe/77d/600/cfe77d60004ef946dea832c1d21a69f0.png">  . <br>  Now, for the clone, editing options are available to us and clicking on the wrench icon <img src="https://habrastorage.org/getpro/habr/post_images/944/c5e/3f5/944c5e3f5ba774dfdf861f2b4742adb7.png">  , look inside. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f33/9c3/5af/f339c35aff6bfa0c6e363d0adb9a88b3.png"><br><br>  There are a lot of options, a few hundred, on the screen, only the very beginning.  All options are grouped by subsection of NVT tests by various types of operating systems and network equipment, by the settings of various connected utilities such as nmap, nikto, etc. <br><br>  We call our new policy Office_scan_config. <br><br>  Go down below. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e75/0ab/68d/e750ab68da69cd4c47a3685891556a67.png"><br><br>  I draw attention to the following points. <br><br>  safe_check ‚Äì disable will allow potentially dangerous NVT tests to be run, the execution of which may cause the tested host to drop.  Use carefully. <br><br>  optimize_test‚Äì a switch that tells you to use fast or deep scan. <br><br>  Next we go down to the PingHost points and set the switches as in the screenshot. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c58/7aa/34e/c587aa34e8992853b07a5d8e72e8ab78.png"><br><br>  This will allow you to immediately exclude empty addresses and not to spend on them the time of the scanner.  The remaining items do not touch. <br>  Do not forget to save the accepted changes. <br><br>  <b>3.2 Register an account for local checks.</b> <br>  If this item is configured, Openvas will log on to each machine, scan the installed software, local security settings and throw out alerts if problems are detected. <br>  Naturally this will increase the scan time. <br><br>  If not configured, Openvas will limit itself to remote checks. <br><br>  Go to the section Configuration ‚ÄìCredentials. <br>  Create a new entry by clicking on the star icon <img src="https://habrastorage.org/getpro/habr/post_images/206/249/5a4/2062495a438cd8e6741804173383adad.png">  . <br>  Suppose we have a windows network in the domain, there is a user sec_check, with local administrator rights on the necessary machines, then it will look like this. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/145/b90/bbb/145b90bbbbc3ad1508a4175c7b4eedf2.png"><br><br>  Save and move on. <br><br>  <b>3.3 Set scan targets.</b> <br>  Next, we need to score a range of addresses for scanning and decide on a set of ports that Openvas will check. <br><br>  Go to the section Configuration ‚ÄìTarget.  Create a new goal by clicking on the star icon.  We give her the name office. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/391/ae4/6c1/391ae46c143f93f2fabe082d4cb0ee22.png"><br><br>  Here, in principle, everything is clear, in the SMB section, we connected a previously created user to conduct local checks. <br>  In the PortList section, the necessary port range is connected, in this case the set of popular ports offered by Nmap.  The choice in favor of this range, made again in favor of optimization, so as not to shovel all 65 thousand. <br>  In the Hosts section, specify the ip range. <br><br>  <b>3.4 Running!</b> <br>  Go to the section ScanManagement - Task.  Create a new task by clicking on the star icon. <br><br>  Sequentially select the previously created configurations and click on the CreateTask button. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0d3/c92/531/0d3c9253102367acdcb9217d31289245.png"><br><br>  We start. <br>  We go to drink tea. Depending on the saturation of the network and server capacity, the process can take up to several hours. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f5c/be8/7ce/f5cbe87ce74b7a35dc3302c7a1bbcbc4.png"><br><br>  At the end of the process, we can click on the magnifying glass icon and view all the problems found. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/69e/02c/134/69e02c134852b6b8ee7720e3d1ea1985.png"><br><br>  Typical alert. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/97f/abd/cbb/97fabdcbb0d117a7a9cbcb313e81ae7c.png"><br>  <b>4. Updates.</b> <br>  Periodically it is necessary to pump up the current information about vulnerabilities and tests that reveal them. <br>  This is done either from the browser in the Administration section.  (alternately in all 3 sections: nvt, scap, cert) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d0a/6c8/8a4/d0a6c88a4efe567201c9d0a1475479ac.png"><br><br>  Or from the command line, sequential commands. <br><br>  openvas-nvt-sync <br>  openvassd <br>  openvasmd --rebuild <br>  openvas-scapdata-sync <br>  openvas-certdata-sync <br>  killall openvassd <br>  /etc/init.d/openvas-scanner restart <br>  /etc/init.d/openvas-manager restart <br>  /etc/init.d/openvas-administrator restart <br>  /etc/init.d/greenbone-security-assistant restart <br><br>  Owners of powerful iron, can glance in the section Settings and expose a greater number of parallel streams. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f1/194/5e3/3f11945e3c280fe2ac923395f3e743e3.png"><br><br>  Useful techniques for working in Greenbone Security Assistant.  can be found here <br><br>  <a href="http://www.greenbone.net/learningcenter/index.html">www.greenbone.net/learningcenter/index.html</a> <br><br>  Successes in use. </div><p>Source: <a href="https://habr.com/ru/post/203766/">https://habr.com/ru/post/203766/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../203752/index.html">Android NDK Game Development Cookbook</a></li>
<li><a href="../203754/index.html">In search of a developer of a mobile application for the magazine "TsODy.RF"</a></li>
<li><a href="../203756/index.html">ATLAS robot demonstrates walking over rough terrain.</a></li>
<li><a href="../203760/index.html">Your questions to the IT recruiter. Part 2</a></li>
<li><a href="../203764/index.html">Electronic utilities or 27 995 000 rubles for 7 days</a></li>
<li><a href="../203768/index.html">About 65 airports and railway stations appeared on Street View</a></li>
<li><a href="../203770/index.html">Nineteen-Level Open Systems Interconnection Model</a></li>
<li><a href="../203772/index.html">How I stopped worrying and fell in love with Hyper-V Server - part of R2</a></li>
<li><a href="../203774/index.html">Create wallpaper for two or more PC displays</a></li>
<li><a href="../203776/index.html">Overview Preliminary Cybersecurity Framework, or as Obama bequeathed to manage information security risks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>