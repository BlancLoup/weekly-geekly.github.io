<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>On the hunt for "insects": the program bug bounty in Odnoklassniki</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As you know, bug bounty is a reward program for information about security issues in a product. With the help of rewards, the developer encourages him...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>On the hunt for "insects": the program bug bounty in Odnoklassniki</h1><div class="post__text post__text-html js-mediator-article"><p>  As you know, bug bounty is a reward program for information about security issues in a product.  With the help of rewards, the developer encourages him to report vulnerabilities to him, rather than selling information on the black market, and gains time to correct the problem before it becomes known to a wide audience.  After all, the more massive and popular product you have, the more there will be those who want to use it for personal gain.  For social networks, the presence of gaps in the security system is extremely undesirable, because it undermines the trust of users.  And if you want your creation to live long and have a large audience, you need to pay a lot of attention to finding errors and timely correction. </p><br><p>  Therefore, a year ago Odnoklassniki also launched such a program.  My name is Alexander Svatikova, and as an information security specialist, I‚Äôll tell you about what we‚Äôve encountered and what we managed to achieve during the vulnerability scan program. </p><a name="habracut"></a><br><h2>  <font color="#f07d00">Program history</font> </h2><br><p>  Anyone can participate in our program.  The main task is to find and neutralize errors in the field of security and privacy in Odnoklassniki.  You can send us your bug reports, and we will definitely study them, fix them and pay rewards.  The award is given for reporting an unknown security issue to us at Odnoklassniki.  The ideal report is written briefly, in the case, contains a script or a proof of concept and is not copy-paste from vulnerability scanners.  Read more about the rules on our page in <a href="https://hackerone.com/ok">HackerOne</a> . </p><br><p>  A few years ago, we already launched a similar program - users sent their finds by e-mail.  The campaign was quite successful, but we faced organizational difficulties, including the delivery of rewards to participants. </p><br><p>  Since then, the American startup HackerOne has appeared.  This is a platform, a kind of social network, for security professionals with a built-in task tracker and payment platform.  This project is designed to bring together software authors and error hunters and takes over the entire organizational part of the process. </p><br><p>  The popularity of the platform, you can judge by the list of companies working with HackerOne.  As a result, we also decided to move our vulnerability scanner there. </p><br><h2>  <font color="#f07d00">Criminals are not asleep</font> </h2><br><p>  So, we voluntarily invited a crowd of hackers to look for vulnerabilities in Odnoklassniki.  For us, in general, the situation has almost not changed: not only baghunters are constantly attacking us.  We constantly struggle with malicious activity, with those who cause damage to our users.  But the current situation cannot be called characteristic only for Odnoklassniki, this is how all popular resources live.  Hacking accounts, identity theft and spamming is a profitable business.  So we can not say that before the launch of Bug Bounty we lived in peace. </p><br><h2>  <font color="#f07d00">Vulnerability Scanning Features</font> </h2><br><p>  It must be said that technically searching for vulnerabilities for research and criminal purposes is no different.  After we settled on HackerOne, the number of specific calls to our resources dramatically increased, indicating the work of automated security testing tools. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b52/d39/206/b52d39206c0f4a4c9fbfd700b576f65f.png"></div><br><p>  <i>Someone launched Acunetix</i> </p><br><p>  On the frontends, a surge in the number of errors is periodically recorded, corresponding to fuzzing with millions of stupid queries, but we have not received a single noteworthy auto-generation report from scanners. </p><br><p>  We do not provide special conditions for vulnerability seekers.  They torture happiness in the usual way; for our security systems, their investigations are no different from attackers of intruders. </p><br><p>  The monitoring system also underwent ‚Äútesting‚Äù in the framework of a public search for vulnerabilities and was adequately tested: all successful attacks that somehow affected the infrastructure, such as DOS and SSRF, were identified even before we were sent a corresponding report. </p><br><h2>  <font color="#f07d00">First results</font> </h2><br><p>  Today, almost a year after the launch of the program, we receive about ten reports a week.  And in the first two weeks, we received about 700 (purple graph). </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/5d8/a4d/33c/5d8a4d33cb2543bdb2f979fca1ce502f.png"></div><br><ul><li>  <b>New</b> - these are new reports sent; </li><li>  <b>Triaged</b> - checked by us and queued for correction; </li><li>  <b>Resolved</b> - fixed bugs. </li></ul><br><p>  By launching the program, we were ready for a splash.  We had not only our experience with the bug bounty, but also the experience of Mail.Ru Group, which launched the search for vulnerabilities in 2014.  But the response exceeded our expectations and in the first month we barely coped by processing and responding to reports. </p><br><p>  It is expected that most of the reports in the first weeks were standard texts about the false positives of popular scanners and did not represent any value or vulnerability. </p><br><p>  However, we also received useful data.  For the first month of the program, we got tickets for about 50 bugs of varying degrees of criticality. </p><br><p>  There was also a funny case: on the eve of the launch of the program, the stored XSS bypassed a two-stage code review process, manual testing and automatic scanning and entered production.  We received 11 reports on this bug in a day and a half, a kind of benchmark for a new program. </p><br><p>  We also received some interesting reports on vulnerabilities in old unused versions of code, attack scripts on us through bugs in exotic browsers, and even reports on unpublished problems (0day) in the libraries we use. </p><br><h2>  <font color="#f07d00">Labor weekdays for vulnerability hunters</font> </h2><br><p>  After the first shaft of reports subsided, their number per month became more stable, fluctuating in small limits.  A few weeks later, there were far fewer reports of false positives from automated scanners, fewer duplicates.  First of all, this is the result of our efforts to correct the detected bugs.  But also in Hackerone they are working to discipline hackers, to encourage them to send better reports.  We are glad to see the community of bug hunters who explore Odnoklassniki on a regular basis and send us the highest quality and informative reports. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/17f/779/2f7/17f7792f7df742669edcaf42dec3c2a6.png"></div><br><p>  A new bug (New) goes through the verification process: erroneous reports and duplicates are eliminated, the problem is reproduced and analyzed.  We estimate the likelihood of operation and possible damage, sometimes we specify additional details for the sender.  If the problem is confirmed, the application goes to the status of Triaged and transferred to the developers.  The ratio of good and bad reports, as well as the time required for making decisions and corrections, can be estimated on the chart above. </p><br><h2>  <font color="#f07d00">Interesting Entomology</font> </h2><br><p>  What kind of "insects" found the participants?  In addition to the standard set of OWASP Top 10, we received very interesting reports.  I will list the most remembered: </p><br><ul><li>  <a href="https://hackerone.com/reports/78436">A way</a> to buy Odnoklassniki domestic currency is cheaper than the official rate, made possible due to rounding errors (4lemon) </li><li>  csrf tokens in headers by using open redirection (ragnar) </li><li>  <a href="https://hackerone.com/reports/102234">bypass the</a> same origin policy on the main domain using a vulnerable flash drive on a CDN domain (zoczus) </li></ul><br><h2>  <font color="#f07d00">Results</font> </h2><br><p>  For the year of work we received from the participants 1328 messages.  In total, 143 hackers and 167 real vulnerabilities of different degrees of criticality.  Could we have organized an audit of equal size and efficiency within the company?  Obviously not.  From this I boldly conclude that our venture was a success.  If you have questions or want to share your experience - write in the comments! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/307438/">https://habr.com/ru/post/307438/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../307428/index.html">Creating levels using the Super Mario World method</a></li>
<li><a href="../307430/index.html">ProjectSauron: cyber spyware hacking into encrypted communication channels of state organizations</a></li>
<li><a href="../307432/index.html">Lead from the fields: who and how applied qualitative methods in UX Research to develop IT products. Part 3 of 6</a></li>
<li><a href="../307434/index.html">Friendly introduction to Dagger 2. Part 1</a></li>
<li><a href="../307436/index.html">Cisco OpenDNS in every home</a></li>
<li><a href="../307440/index.html">Lead from the fields: who and how applied qualitative methods in UX Research to develop IT products. Part 4 of 6</a></li>
<li><a href="../307442/index.html">Lead from the fields: who and how applied qualitative methods in UX Research to develop IT products. Part 5 of 6</a></li>
<li><a href="../307444/index.html">Lead from the fields: who and how applied qualitative methods in UX Research to develop IT products. Part 6 of 6</a></li>
<li><a href="../307450/index.html">Vulnerabilities of online banks 2016: authorization problems lead</a></li>
<li><a href="../307454/index.html">We create a mobile game on Monogame, solving typical problems of a novice developer.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>