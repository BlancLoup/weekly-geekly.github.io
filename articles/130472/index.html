<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PNG - not gif!</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! 
 Have you ever wanted to know how PNG files are organized? Not? And I still tell. 
 The PNG (Portable Network Graphics) format was invented...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PNG - not gif!</h1><div class="post__text post__text-html js-mediator-article">  Good day! <br>  Have you ever wanted to know how PNG files are organized?  Not?  And I still tell. <br>  The PNG (Portable Network Graphics) format was invented in 1995 to become a replacement for <a href="http://en.wikipedia.org/wiki/Gif">GIF</a> , and as early as 1996, with the release of version 1.0, it was recommended by the <a href="http://en.wikipedia.org/wiki/World_Wide_Web_Consortium">W3C</a> as a full-fledged network format.  Today PNG is one of the main formats of web graphics. <br><img src="https://habrastorage.org/storage1/6ac87c5f/d11dc992/5a83f45e/be3dbcff.png"><br>  Under the cat you will find a general description of the structure of the PNG-file, a number of picture schemes, preparation <img src="https://habrastorage.org/storage1/0bd8b353/e39b0ec6/380571b5/720d7c16.png">  in the hex editor, and, of course, the link to the specification. <a name="habracut"></a><br><br><h4>  Common building </h4><br>  The PNG structure in its most general form is presented in the following figure. <br><img src="https://habrastorage.org/storage1/74941b5e/e77fd13f/fe20628c/07c3611d.png"><br>  That is, the file consists of a signature and a certain number of blocks (chunks, chunks), each of which carries some information (thanks to KO!).  But why the signature can not be considered one of the chunks?  Let's see more in detail. <br><br><h5>  File signature </h5><br>  The signature of the PNG file is always the same, consists of 8 bytes, and is (in hex) <br><blockquote>  89 50 4E 47 0D 0A 1A 0A </blockquote><br>  What does this mean? <br><ul><li>  89 is a non-ASCII character.  Prevents PNG recognition as a text file and vice versa. </li><li>  50 4E 47 - PNG to ASCII records. </li><li>  0D 0A - CRLF (Carriage-return, Line-feed), DOS-style line feed. </li><li>  1A - stops file output in DOS mode (end-of-file), so that you will not fall out a multi-kilo byte image in text form. </li><li>  0A - LF, Unix-style line feed. </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Chunks </h5><br>  Chunks are the data blocks that make up a file.  Each chunk consists of 4 sections. <br><img src="https://habrastorage.org/storage1/6c504223/d3c0dfea/08ef15e5/65bd6297.png"><br>  Let's sort these sections in order. <br><br><h6>  Length </h6><br>  Well, everything seems to be clear with length.  Just the numeric value of the length of the data block. <br><br><h6>  Type (name) </h6><br>  With type a bit more interesting.  The type is 4 case sensitive ASCII characters.  The character registers (the fifth bit in the numeric character entry) in the name of the chunk are not for nothing, these are flags that tell the decoder some additional information. <br><ul><li>  The first character register determines whether this chunk is critical (upper case) or auxiliary (lower case).  Critical chunks must be recognized by each decoder.  If the decoder encounters a critical chunk, the type of which cannot be recognized, it must terminate the execution with an error. </li><li>  The second character register defines ‚Äúpublicity‚Äù (upper case) or ‚Äúprivacy‚Äù (lower case) of the chunk.  ‚ÄúPublic‚Äù chunks - official, documented, recognized by most decoders.  But if suddenly you need to encode specific information for some of your needs, then just in the name of the chunk, make the second character small. </li><li>  The register of the third character is left for future accomplishments.  It is assumed that it will be used to differentiate between different versions of the standard.  For versions 1.0 and 1.1, the third character must be large.  If it (suddenly!) Turned out to be small, all current decoders should deal with a chunk, just like with any other not recognized (that is, exit with an error if the chunk is critical, or skip otherwise). </li><li>  The fourth character register means that editors who cannot recognize it can copy this chunk.  If the register is lower, the chunk can be copied, regardless of the degree of modification of the file, otherwise (upper case) it is copied only if no critical chunks were affected by the modification. </li></ul><br>  For a better understanding, let's look at the flags using the example of a chunk containing text. <br><img src="https://habrastorage.org/storage1/f60b3e74/2aa31559/e56b1fe8/afe4cab5.png"><br><br>  Below is a list of chunk types with brief explanations. <br>  <b>Critical chunks</b> <br><ul><li>  <i>IHDR</i> - the header of the file, contains basic information about the image.  Must be the first chunk. </li><li>  <i>PLTE</i> - palette, list of colors. </li><li>  <i>IDAT</i> - contains, in fact, the image.  Figure can be divided into several IDAT chunks, for streaming.  Each file must have at least one IDAT chunk. </li><li>  <i>IEND</i> - the final chunk, must be the last in the file. </li></ul><br><br>  <b>Auxiliary chunks</b> <br><ul><li>  <i>bKGD</i> - this chunk sets the main background color. </li><li>  <i>cHRM is</i> used to specify the <a href="http://en.wikipedia.org/wiki/CIE_1931_color_space">CIE 1931</a> color space. </li><li>  <i>gAMA</i> - defines gamma. </li><li>  <i>hIST</i> - a histogram or the total content of each color in the image can be stored in this chunk. </li><li>  <i>iCCP</i> - <a href="http://en.wikipedia.org/wiki/ICC_profile">ICC</a> color profile </li><li>  <i>iTXt</i> - contains text in UTF-8, possibly compressed, with an optional language mark.  iTXt chunk with the 'XML: com.adobe.xmp' keyword can contain the <a href="http://en.wikipedia.org/wiki/Extensible_Metadata_Platform">Extensible Metadata Platform (XMP)</a> . </li><li>  <i>pHYs</i> - contains the estimated pixel size and / or aspect ratio of the image. </li><li>  <i>sBIT</i> (significant bits) - defines the "color accuracy" (color-accuracy) of the image (black and white, full color, black and white with transparency, etc.), for easier decoding. </li><li>  <i>sPLT</i> - offers a palette for use if the full range of colors is not available. </li><li>  <i>sRGB</i> indicates the use of the standard sRGB scheme. </li><li>  <i>sTER</i> is a stereoscopic image indicator. </li><li>  <i>tEXt</i> - can contain text in <a href="http://en.wikipedia.org/wiki/ISO/IEC_8859-1">ISO / IEC 8859-1</a> format, with one name = value pair for each chunk. </li><li>  <i>tIME</i> - stores the date the image was last modified. </li><li>  <i>tRNS</i> - contains information about transparency. </li><li>  <i>zTXt</i> is compressed text, with the same limitations as tEXt. </li></ul><br>  More information can be found in the specification. <br><br><h6>  CRC </h6><br>  <a href="http://en.wikipedia.org/wiki/Cyclic_redundancy_check">CRC-32</a> checksum.  By the way the other day was a <a href="http://habrahabr.ru/blogs/windows/130287/">topic</a> about counting it in Windows. <br><br><h4>  Minimal PNG </h4><br>  With the overall structure sorted out.  Now analyze the content of the mandatory chunks.  But which of them are mandatory (not critical, critical are required to be recognized by the decoder, and not present in each file), and what does the minimal PNG file look like?  That's how: <br><img src="https://habrastorage.org/storage1/a4832617/9d080353/fde1784a/1bfbbf4a.png"><br><br><h5>  Ihdr </h5><br>  The data block in the IHDR contains the following fields: <br><ul><li>  Width, <b>4 bytes</b> </li><li>  Height, <b>4 bytes</b> </li><li>  Bit depth (bit depth), determines the number of bits per sample (not pixel), <b>1 byte</b> </li><li>  Color type, consists of 3 flags 1 (a palette is used), 2 (a color is used, not a monochrome image), and 4 (an alpha channel is present), <b>1 byte</b> </li><li>  Compression method.  Currently, only the value 0 is available - <a href="http://en.wikipedia.org/wiki/Deflate">deflate</a> compression.  If the value is different from 0, the chunk is considered unrecognized, and the decoder reports an error.  <b>1 byte</b> </li><li>  Filtering method  As in the case of compression, at the moment it can only be zero.  <b>1 byte</b> </li><li>  Interlace method.  Defines the data transfer order.  Currently 2 values ‚Äã‚Äãare available: 0 (no interlace) and 1 ( <a href="http://en.wikipedia.org/wiki/Adam7_algorithm">Adam7</a> interlace).  <b>1 byte</b> </li></ul><br>  Adam7 interlacing perfectly demonstrates a picture from Wikipedia (yes, GIF in the article about PNG): <br><img src="https://habrastorage.org/getpro/habr/post_images/227/04f/ac9/22704fac9e0928bd41078edd0964244b.gif" alt="image"><br><br><h5>  IEND </h5><br>  Signals about the end of the file, the data block of this chunk does not contain anything. <br><br><h5>  IDAT </h5><br>  Contains the data encoded according to the compression method field in the header.  The decoding algorithm is beyond the scope of this article (however, if desired, it may appear in the following), but it is described quite well (and in Russian) <a href="http://allo.usaaa.ru/workshop/samples/pngread/pngread.htm">here</a> . <br><br>  Thus, the simplest PNG file (by the example of <img src="https://habrastorage.org/storage1/0bd8b353/e39b0ec6/380571b5/720d7c16.png">  ) as follows. <br><img src="https://habrastorage.org/storage1/5d607448/5f0af5fa/7806613b/b9ac0529.png"><br><br><h4>  Conclusion </h4><br>  When writing this article, I set myself the task of giving the reader general knowledge about the structure of the PNG file, for a deeper understanding it is recommended to read the <a href="http://www.w3.org/TR/PNG/">specifications</a> . <br><br>  Topic on habre about the structure of JPEG: <a href="http://habrahabr.ru/blogs/algorithm/102521/">habrahabr.ru/blogs/algorithm/102521</a> <br>  Topic on habre about the structure of the GIF: <a href="http://habrahabr.ru/blogs/algorithm/127083/">habrahabr.ru/blogs/algorithm/127083</a> <br><br>  Thank you for your attention, I will be glad to any criticism! </div><p>Source: <a href="https://habr.com/ru/post/130472/">https://habr.com/ru/post/130472/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../130465/index.html">About poor Aleksandresku I put in a word</a></li>
<li><a href="../130466/index.html">Comparative performance analysis of PCI-E SSD, SSD and HDD drives</a></li>
<li><a href="../130467/index.html">Sony Ericsson ceases production of regular cell phones.</a></li>
<li><a href="../130469/index.html">iModela: $ 977 3D Printer</a></li>
<li><a href="../130471/index.html">Ukrainian keyboard layout on Mac OS X Lion</a></li>
<li><a href="../130473/index.html">Introduction to jQuery Mobile</a></li>
<li><a href="../130476/index.html">Windows will show the wrong time in Armenia, Belarus and Ukraine after October 30</a></li>
<li><a href="../130477/index.html">Siri non-standard behavior in iOS 5</a></li>
<li><a href="../130479/index.html">Three tips on using multitasking on the BlackBerry PlayBook</a></li>
<li><a href="../130480/index.html">Recovery partition update</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>