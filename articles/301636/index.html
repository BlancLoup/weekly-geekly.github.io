<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Add dependencies to CDI. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After the article on how to get started with CDI in your environment and a few tips on how to integrate CDI into an existing Java EE 6 application , I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Add dependencies to CDI. Part 1</h1><div class="post__text post__text-html js-mediator-article"><p>  After the article on how <a href="https://antoniogoncalves.org/2011/01/12/bootstrapping-cdi-in-several-environments/">to get started with CDI</a> in your environment and a few tips on how to <a href="https://antoniogoncalves.org/2011/02/07/adding-cdi-to-an-existing-java-ee-6-application/">integrate CDI into an existing Java EE 6 application</a> , I want to talk about dependency injection.  Yes, about a simple deployment or <strong>how to embed one bin into another</strong> .  In this series of three articles ( <a href="https://habrahabr.ru/company/at_consulting/blog/301768/">Part 2</a> , <a href="https://habrahabr.ru/company/at_consulting/blog/302010/">Part 3</a> ) you will see that there are many different ways: let's start with the simplest - the usual introduction. </p><br><p><img src="https://habrastorage.org/files/95f/dab/15d/95fdab15d0a84a9e9036d93c9308044a.jpg" alt="COFFEE_BEANS"></p><a name="habracut"></a><br><h1>  Default implementation </h1><br><p>  The easiest way to implement ... simple.  You have <em>something</em> , and you embed <em>something</em> into it.  Why do I use the word <em>something</em> ?  Because before Java EE 5, you could only implement resources (EntityManager, Datasource, JMS factories ...) into certain components (EJBs and servlets).  With CDI, you can <strong>embed almost anything into anything</strong> . </p><br><p>  For this article, I used the following software: </p><br><ul><li>  Java SE 1.6.0_23 </li><li>  Glassfish 3.1 </li><li>  Maven 3.0.2 </li></ul><br><p>  To illustrate the implementation, I will use the same example as in <a href="https://antoniogoncalves.org/2011/02/07/adding-cdi-to-an-existing-java-ee-6-application/">previous articles</a> and in my book <a href="https://antoniogoncalves.org/category/books/">Java EE 6</a> (the same example Antonio uses in the book <a href="http://www.apress.com/9781430246268">Beginning Java EE 7</a> [ <a href="http://www.litres.ru/entoni-gonsalves/izuchaem-java-ee-7-2/">translation</a> ] - note. Lane). </p><br><p><img src="https://habrastorage.org/files/479/fc9/e24/479fc9e24e7a4474bb6aa21f268728c2.gif" alt="CDI_CLASS_DIAGRAM"></p><br><p>  The class diagram shows the following components: </p><br><ul><li> <code>Book</code> is a simple JPA entity with some attributes and named queries. </li><li>  <code>ItemEJB</code> is an EJB (without interface) that performs CRUD operations on Book using an EntityManager </li><li>  <code>IsbnGenerator</code> is a simple POJO class that generates a random number ISBN (used for Book) </li><li>  <code>ItemRestService</code> with annotation <code>@Path</code> (denoting a REST service in JAX-RS), delegating a CRUD of <code>ItemEJB</code> operations </li><li>  <code>ItemServlet</code> is a servlet that uses <code>ItemEJB</code> to display all books from a database. </li></ul><br><p>  As you can see, with the exception of EntityManager, which is implemented using <code>@PersistenceContext</code> , all other components are embedded with the <code>@Inject</code> annotation.  Here are a few lines of <code>ItemEJB</code> code that receive a link to the EntityManager: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Stateless</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ItemEJB</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@PersistenceContext</span></span>(unitName = <span class="hljs-string"><span class="hljs-string">"cdiPU"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> EntityManager em; ... }</code> </pre> <br><p>  <code>ItemServlet</code> and <code>ItemRestService</code> very similar, since both are embedded with links to <code>ItemEJB</code> and <code>IsbnGenerator</code> : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@WebServlet</span></span>(urlPatterns = <span class="hljs-string"><span class="hljs-string">"/itemServlet"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ItemServlet</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HttpServlet</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IsbnGenerator numberGenerator; <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ItemEJB itemEJB; ... }</code> </pre> <br><p>  <code>IsbnGenerator</code> is the most common POJO.  It is not inherited from anyone and is not annotated in any way: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IsbnGenerator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateNumber</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"13-84356-"</span></span> + Math.abs(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random().nextInt()); } }</code> </pre> <br><p>  In all these cases, there is only one implementation to choose from (there is only one <code>ItemEJB</code> and one <code>IsbnGenerator</code> ).  If you have only one implementation, CDI will be able to implement it.  Next we talk about the <strong>default implementation</strong> . </p><br><p>  Actually code: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> IsbnGenerator numberGenerator</code> </pre> <br><p>  could be written like this: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-meta"><span class="hljs-meta">@Default</span></span> IsbnGenerator numberGenerator</code> </pre> <br><p>  <code>@Default</code> is a built-in <strong>specifier</strong> that informs the CDI that the implementation of a bin must be implemented by default.  If you define a bin without a specifier, it will be automatically specified by <code>@Default</code> .  The following code is identical to the previous one: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@WebServlet</span></span>(urlPatterns = <span class="hljs-string"><span class="hljs-string">"/itemServlet"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ItemServlet</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HttpServlet</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-meta"><span class="hljs-meta">@Default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IsbnGenerator numberGenerator; ... } <span class="hljs-meta"><span class="hljs-meta">@Default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IsbnGenerator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateNumber</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"13-84356-"</span></span> + Math.abs(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random().nextInt()); } }</code> </pre> <br><p>  If for implementation you have only one <code>IsbnGenerator</code> implementation, then the default handler will work and an ordinary <code>@Inject</code> will do its job.  But sometimes it is necessary to choose between several implementations, then the <strong>specifier</strong> comes into play. </p><br><blockquote>  In this article, I use the term <em>bin</em> , but to be more precise, I have to say <em>managed bin</em> (for example, <em>bin, controlled by CDI</em> ).  ManagedBeans were introduced in Java EE 6. </blockquote><br><h1>  Ambiguous implementations and qualifiers </h1><br><p>  For some type of bins, there may be <strong>several bins that implement this type</strong> .  For example, our application can have two implementations of the <code>NumberGenerator</code> interface: <code>IsbnGenerator</code> , which generates a 13-digit number and <code>IssnGenerator</code> , which generates an 8-digit number.  The component that needs to generate a 13-digit number must somehow distinguish between two implementations.  One option is to explicitly specify the class ( <code>IsbnGenerator</code> ), but then a hard relationship is created between the component and the implementation.  Another option is to describe the implementation of a suitable bean in an external XML configuration.  CDI uses annotation specifiers to obtain strong typing and weak connectivity. </p><br><blockquote>  In this article, I use an introduction through a class field (attribute), but with CDI you can also use an introduction through setters or constructors. </blockquote><br><p>  Suppose for some purpose the <code>ItemServlet</code> creates books with a 13-digit ISBN number, and an <code>ItemRestService</code> with an 8-digit ISSN number.  In both classes ( <code>ItemServlet</code> and <code>ItemRestService</code> ) there are embedded links to the same interface <code>NumberGenerator</code> , but which implementation will be used as a result?  You do not know?  CDI also does not know, and you will receive an error message: </p><br><pre> Ambiguous dependencies for type [NumberGenerator] with qualifiers [@Default] at injection point [[field] @Inject private ItemRestService.numberGenerator].  Possible dependencies [[Managed Bean [class IsbnGenerator] with qualifiers [@Any @Default], Managed Bean [class IssnGenerator] with qualifiers [@Any @Default]]].
</pre><br><p>  This means that you need to remove the ambiguity and specify the CDI, which bin and where it should be implemented.  If you used Spring before, the first thing that comes to your mind is " <em>let's use beans.xml</em> ".  But, as explained in <a href="http://seamframework.org/Documentation/WhatIsBeansxmlAndWhyDoINeedIt.html">this post</a> , " <em>beans.xml is not the XML where the beans are defined</em> ."  With CDI, you must use qualifiers (annotations). </p><br><p>  There are <a href="http://docs.jboss.org/cdi/spec/1.0/html_single/">three</a> specifiers <a href="http://docs.jboss.org/cdi/spec/1.0/html_single/">built</a> into the CDI: </p><br><ul><li>  <code>@Default</code> : if a bin does not contain a specifier in the definition, then it has an <code>@Default</code> specifier </li><li>  <code>@Any</code> : allows an application to specify specifiers dynamically </li><li>  <code>@New</code> : allows an application to get a new specified bin (with CDI 1.1, the <code>@New</code> <a href="http://docs.jboss.org/cdi/spec/1.1/cdi-spec.html">is considered obsolete</a> - approx. Lane) </li></ul><br><p>  A qualifier is a semantic construction that associates a type with some of its implementation.  For example, you could enter a qualifier to represent <em>a 13-digit number</em> <em>generator</em> or <em>an 8-digit number generator</em> .  In Java, specifiers are represented by annotations defined as <code>@Target({FIELD, TYPE, METHOD})</code> and <code>@Retention(RUNTIME)</code> .  They are declared with an indication of the <code>@javax.inject.Qualifier</code> meta-annotation as follows: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Qualifier</span></span> <span class="hljs-meta"><span class="hljs-meta">@Retention</span></span>(RUNTIME) <span class="hljs-meta"><span class="hljs-meta">@Target</span></span>({FIELD, TYPE, METHOD}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-meta"><span class="hljs-meta">@interface</span></span> EightDigits { } <span class="hljs-meta"><span class="hljs-meta">@Qualifier</span></span> <span class="hljs-meta"><span class="hljs-meta">@Retention</span></span>(RUNTIME) <span class="hljs-meta"><span class="hljs-meta">@Target</span></span>({FIELD, TYPE, METHOD}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-meta"><span class="hljs-meta">@interface</span></span> ThirteenDigits { }</code> </pre> <br><p>  As you can see, I just very simply defined two specifiers.  How can I use them now?  Let's look at the chart: </p><br><p><img src="https://habrastorage.org/files/aa7/bb9/fb5/aa7bb9fb539a42e1a3e644adbc22923a.gif" alt="CDI_CLASS_DIAGRAM_QUALIFIER"></p><br><p>  First of all, the specifier needs to annotate the corresponding implementation.  As you can see, <code>@ThirteenDigit</code> annotates the <code>IsbnGenerator</code> , and <code>@EightDigit</code> <code>IssnGenerator</code> : </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@EightDigits</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IssnGenerator</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NumberGenerator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateNumber</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"8-"</span></span> + Math.abs(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random().nextInt()); } } <span class="hljs-meta"><span class="hljs-meta">@ThirteenDigits</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IsbnGenerator</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NumberGenerator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateNumber</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"13-84356-"</span></span> + Math.abs(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random().nextInt()); } }</code> </pre> <br><p>  Then the components in which the references to the <code>NumberGenerator</code> interface are <code>NumberGenerator</code> must be implemented as follows: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@WebServlet</span></span>(urlPatterns = <span class="hljs-string"><span class="hljs-string">"/itemServlet"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ItemServlet</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HttpServlet</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-meta"><span class="hljs-meta">@ThirteenDigits</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> NumberGenerator numberGenerator; ... } <span class="hljs-meta"><span class="hljs-meta">@Path</span></span>(<span class="hljs-string"><span class="hljs-string">"/items"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@ManagedBean</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ItemRestService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-meta"><span class="hljs-meta">@EightDigits</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> NumberGenerator numberGenerator; ... }</code> </pre> <br><p>  You do not need external configuration.  This is why CDI prescribes the use of strong typing.  You can rename your implementations as you like, the deployment points will not change (this is a weak connectivity).  Note also that a bin can be declared by several specifiers.  As you can see, CDI is an elegant way to have type-safe dependency injection.  But if you start creating annotations every time you need to embed something, in the end your code will be hard to read.  In this case, you will be helped by transfers. </p><br><h1>  Qualifiers with enumerations </h1><br><p>  Every time you need to choose between implementations, you create an annotation.  Then, if you need an additional <em>2-digit number</em> <em>generator</em> or <em>a 10-digit number generator</em> , you are creating more and more annotations.  It looks like we are moving from hell xml to annotation hell!  One way to avoid breeding them is to use enums as follows: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@WebServlet</span></span>(urlPatterns = <span class="hljs-string"><span class="hljs-string">"/itemServlet"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ItemServlet</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HttpServlet</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-meta"><span class="hljs-meta">@NumberOfDigits</span></span>(Digits.THIRTEEN) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> NumberGenerator numberGenerator; ... } <span class="hljs-meta"><span class="hljs-meta">@Path</span></span>(<span class="hljs-string"><span class="hljs-string">"/items"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@ManagedBean</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ItemRestService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-meta"><span class="hljs-meta">@NumberOfDigits</span></span>(Digits.EIGHT) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> NumberGenerator numberGenerator; ... } <span class="hljs-meta"><span class="hljs-meta">@NumberOfDigits</span></span>(Digits.THIRTEEN) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IsbnGenerator</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NumberGenerator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateNumber</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"13-84356-"</span></span> + Math.abs(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random().nextInt()); } } <span class="hljs-meta"><span class="hljs-meta">@NumberOfDigits</span></span>(Digits.EIGHT) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IssnGenerator</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NumberGenerator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateNumber</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"8-"</span></span> + Math.abs(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random().nextInt()); } }</code> </pre> <br><p>  As you can see, I got rid of the <code>@ThirteenDigits</code> and <code>@EightDigits</code> and use the single <code>@NumberOfDigit</code> , in which the enumeration is used as the annotation value.  Here is the code you should write: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Qualifier</span></span> <span class="hljs-meta"><span class="hljs-meta">@Retention</span></span>(RUNTIME) <span class="hljs-meta"><span class="hljs-meta">@Target</span></span>({FIELD, TYPE, METHOD}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-meta"><span class="hljs-meta">@interface</span></span> NumberOfDigits { <span class="hljs-function"><span class="hljs-function">Digits </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">value</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Digits { TWO, EIGHT, TEN, THIRTEEN }</code> </pre> <br><h1>  Conclusion </h1><br><p>  I don't know about you, but I love CDI.  I really like the way CDI binds the beans to plain Java and <strong>without XML</strong> .  Yes, I admit that not everything is so beautiful.  The first thing I see is the <strong>proliferation of the number of annotations</strong> in your code.  Thanks to the listings it can be limited.  The second is <strong>support in the IDE</strong> .  Your IDE should know that: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-meta"><span class="hljs-meta">@NumberOfDigits</span></span>(Digits.EIGHT) NumberGenerator numberGenerator</code> </pre> <br><p>  refers to the <code>IssnGenerator</code> .  As for the support in the IDE, I can not say that I deeply understood this topic.  I use Intellij IDEA, and in it CDI support is simply amazing.  I can move between bins without thinking about their implementation.  I suppose NetBeans has some kind of support ... but I‚Äôm wondering if it is in Eclipse; o) (article published in 2011. - approx. Lane) </p><br><p>  In the next article I will look at the <a href="https://habrahabr.ru/company/at_consulting/blog/301768/">various points of implementation</a> . </p><br><h1>  Source </h1><br><p>  <a href="https://github.com/agoncal/agoncal-sample-cdi">Download the code</a> and tell us what you think about it. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/301636/">https://habr.com/ru/post/301636/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../301622/index.html">Project.json changes</a></li>
<li><a href="../301624/index.html">New virtual servers OVH in comparison with domestic state employees</a></li>
<li><a href="../301626/index.html">Static analyzer HuntBugs: check IntelliJ IDEA</a></li>
<li><a href="../301628/index.html">I have long wanted to tell you something</a></li>
<li><a href="../301632/index.html">How Microsoft implemented Yammer (Part I)</a></li>
<li><a href="../301640/index.html">IPython notebook data processing for SEO tasks</a></li>
<li><a href="../301642/index.html">Positive Hack Days VI WAF Bypass Contest</a></li>
<li><a href="../301644/index.html">We are testing asynchronous code.</a></li>
<li><a href="../301646/index.html">Template Description Language Snakeskin</a></li>
<li><a href="../301648/index.html">Dependency Injection Container from PHPixie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>