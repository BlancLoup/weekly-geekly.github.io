<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Review and programming for stationary Internet radio</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A few years ago I was already posting an article about how to make a network sound card from a router. That option required the presence of an active ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Review and programming for stationary Internet radio</h1><div class="post__text post__text-html js-mediator-article"><p>  A few years ago I was already posting <a href="https://habrahabr.ru/post/184110/">an article</a> about how to make a network sound card from a router.  That option required the presence of an active sound source and speakers.  The portable version would look too cumbersome, because it was decided to purchase the finished product.  Due to availability and as the cheapest possible option (50 euros), I chose <strong>renkforce IR 1</strong> . </p><br><p><img src="https://habrastorage.org/files/134/3e8/8fe/1343e88fe09e43379c1128021561de3e.JPG" alt="image"></p><br><p>  Of the key characteristics, the following were important to me: </p><br><ul><li>  <a href="https://habr.com/ru/post/306850/">DLNA</a> (the ability to directly play through pulseaudio) </li><li>  <a href="https://habr.com/ru/post/306850/">WiFi</a> (802.11bg) </li><li>  AUX </li><li>  Remote controller </li><li>  <a href="https://habr.com/ru/post/306850/">Good sound</a> </li><li>  <a href="https://habr.com/ru/post/306850/">Screen</a> </li><li>  <a href="https://habr.com/ru/post/306850/">Ability to create your playlist</a> </li><li>  <a href="https://habr.com/ru/post/306850/">USB</a> </li></ul><a name="habracut"></a><br><p><img src="https://habrastorage.org/files/375/dc8/a74/375dc8a747594fa1925d47e838e00691.JPG" alt="image"></p><br><h2>  DLNA </h2><br><p>  The presence of DLNA allows you to directly redirect the sound from Linux to Internet radio.  This can be done in at least three ways: </p><br><ul><li>  Passive.  Record everything that is played by a sound card to a file and play this file on the radio through the <strong>minidlna</strong> server. </li><li>  Active.  Use <a href="https://wiki.gnome.org/Projects/Rygel">Rygel</a> , which creates a virtual sound card and transmits all the sound from it through DLNA.  Run by scripts, requires configuration files. </li><li>  Active, simple.  Use the project <a href="https://github.com/masmu/pulseaudio-dlna">https://github.com/masmu/pulseaudio-dlna</a> .  You can install it manually via <strong>ppa</strong> repository in Ubuntu or backport the package from <a href="http://packages.ubuntu.com/yakkety/pulseaudio-dlna">Ubuntu 16.10</a> . </li></ul><br><p>  Read more about these methods <a href="http://askubuntu.com/questions/187086/how-do-i-set-up-live-audio-streams-to-a-dlna-compliant-device">here</a> . </p><br><p>  You can also play music straight from your Android phone.  DLNA support was found only in Samsung's music player preinstalled on the phone.  I tried to find music players with DLNA support on Google Play, but without success. </p><br><h2>  WiFi </h2><br><p>  The only minor drawback is the lack of support for the 802.11n protocol. </p><br><h2>  Sound </h2><br><p>  The sound for this category of device is quite decent (one column at 10W).  I'm not an audiophile, but the difference with the speakers built into a regular laptop is significant.  Bass is present, jazz sounds great, rock and electronic music too.  There is an option with two columns (model <strong>renkforce IR 2</strong> ), but I did not consider it as superfluous. </p><br><h2>  Screen </h2><br><p>  The screen is ordinary.  The interface is quite friendly ... </p><br><p><img src="https://habrastorage.org/files/a75/028/8bd/a750288bd0dc445f9cd0b0e11f29a232.JPG" alt="image"></p><br><p>  However, the procedure for adding your own radio stations leaves much to be desired. </p><br><h2>  Playlist </h2><br><p>  Because of the playlist, I decided to write this article.  Manually typing in the URL of the radio station using the remote control or the scroll wheel is something else.  The order of appearance of characters when using the numeric buttons on the remote control is very different from that used to typing SMS in a button phone (for <strong>2</strong> this is the sequence "2 ABC ab c", etc.).  If you use the scroll wheel, you have to scroll through each character of the alphabet.  I decided to analyze whether it is possible to add a playlist via the web interface. </p><br><p>  The web interface has been curtailed.  The open 80th port with the title AirMusic shows only the signatures to the settings.  HTML refers to non-existent CSS styles on port 8080.  The 8080 port itself displays <strong>404 Not Found</strong> by default. </p><br><p>  Fortunately, the telnet port was available.  Using <strong>root</strong> login and password <strong>password,</strong> I managed to access the built-in busybox.  The study of the internal structure gave the following information: </p><br><ul><li>  All this stuff works on the processor with the ARM architecture. </li><li>  <strong>The httpd</strong> server listens on port 8080 and hosts the statics located in <strong>/ UIData</strong> .  CSS styles were not there, as well as other useful information. </li><li>  <strong>UIProto</strong> is the heart of the radio.  A statically compiled application that listens on port 80, launches <strong>mplayer</strong> , displays information on the screen, and more.  By the number of references to the name of this binary on the Internet, the impression was that it was developed by an outsourcing company (mediayou.net) for most Chinese Internet radio. </li></ul><br><p>  <strong>UIProto</strong> saves the playlist favorites in binary format to the file / <strong>flash / myradio.cfg</strong> .  It is possible to read it through the terminal output, but only as text.  To get the file completely had a little bit sweat.  Fortunately, the busybox on the radio is compiled with support for the <strong>ftpput</strong> and <strong>ftpget commands</strong> .  I used them to copy the file to a computer for further study, after setting up an FTP server. </p><br><p>  Analyzed a <a href="">binary file</a> with the <a href="http://linux.die.net/man/1/xxd">xxd (1)</a> utility.  Approximately the file structure looks like this: </p><br><pre><code class="hljs vbscript">Amount of entries: <span class="hljs-number"><span class="hljs-number">2</span></span>b Every entry <span class="hljs-built_in"><span class="hljs-built_in">len</span></span>: <span class="hljs-number"><span class="hljs-number">366</span></span>b <span class="hljs-number"><span class="hljs-number">0x00</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>b <span class="hljs-number"><span class="hljs-number">0x00</span></span>|<span class="hljs-number"><span class="hljs-number">0x02</span></span>|<span class="hljs-number"><span class="hljs-number">0x03</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>b <span class="hljs-number"><span class="hljs-number">0x20</span></span> (<span class="hljs-number"><span class="hljs-number">32</span></span>): <span class="hljs-number"><span class="hljs-number">1</span></span>b <span class="hljs-number"><span class="hljs-number">0x00</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>b <span class="hljs-number"><span class="hljs-number">0x07</span></span>|<span class="hljs-number"><span class="hljs-number">0x05</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>b <span class="hljs-built_in"><span class="hljs-built_in">len</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>xTITLE+<span class="hljs-number"><span class="hljs-number">1</span></span>): <span class="hljs-number"><span class="hljs-number">1</span></span>b <span class="hljs-number"><span class="hljs-number">0x80</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>b <span class="hljs-number"><span class="hljs-number">0</span></span>xTITLE: <span class="hljs-number"><span class="hljs-number">40</span></span>b <span class="hljs-number"><span class="hljs-number">0x00</span></span>: <span class="hljs-number"><span class="hljs-number">59</span></span>b <span class="hljs-number"><span class="hljs-number">0</span></span>xURL: <span class="hljs-number"><span class="hljs-number">250</span></span>b <span class="hljs-number"><span class="hljs-number">0x00</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>b <span class="hljs-number"><span class="hljs-number">0x00</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>b</code> </pre> <br><p>  I do not exclude that some elements in the structure are ordinary garbage from non-zero allocated memory.  The use of zeros in these elements does not affect the final result. </p><br><p>  The original version of the utility in C kept a hard-to-do playlist.  To store the structure in the utility's memory, I used single-linked lists.  The result of the first launch gave a test binary playlist, which I downloaded to the device.  Even with zeros in elements of the structure unknown to me, the new playlist was successfully read.  The final version of the <a href="">utility</a> reads a playlist from a CSV file and writes it in a binary format.  A nice bonus was the use of headers for radio stations instead of their URLs (previously, radio stations in the list were displayed as <strong><a href="">http://1.2.3.4:8080/radio.mp3</a></strong> ). </p><br><p>  In conclusion, for the sake of experiment, I tried to compile a static native binary that could run straight on the radio itself.  There is no practical benefit from this, but you can try to write an httpd daemon that will allow you to edit radio stations straight through the web interface.  A more global and unrealizable idea is to write a fully opensource firmware for Internet radio. </p><br><p>  How to make <strong>UIProto re-</strong> read the playlist after the update, I did not understand.  I use hardcore method - <strong>sync</strong> and reboot. </p><br><p>  For the convenience of downloading a playlist to the radio, I wrote scripts that use <a href="http://linux.die.net/man/1/expect">expect (1)</a> . </p><br><h2>  USB </h2><br><p>  There is a non-soldered USB on the board.  Judging by the <a href="http://linux.die.net/man/1/dmesg">dmesg (1)</a> , it is quite efficient.  To test its performance in practice has not had time. </p><br><p><img src="https://github.com/kayrus/iradio/raw/master/renkforce_ir1.jpg" alt="image"></p><br><h1>  Links </h1><br><ul><li>  The source code of the utility, helper scripts and other information about the radio on github: <a href="https://github.com/kayrus/iradio">https://github.com/kayrus/iradio</a> </li><li>  Information about a similar model of Internet radio: <a href="https://sites.google.com/site/tweakradje/devices/abeo-internet-radio">https://sites.google.com/site/tweakradje/devices/abeo-internet-radio</a> </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/306850/">https://habr.com/ru/post/306850/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../306840/index.html">Chat on Go (part 1)</a></li>
<li><a href="../306842/index.html">Improving the reliability of virtual machines in Microsoft Azure</a></li>
<li><a href="../306844/index.html">Contactless Payments - Towards Consumer and Developer Trust</a></li>
<li><a href="../306846/index.html">MVNO adult</a></li>
<li><a href="../306848/index.html">HOCON - configurable</a></li>
<li><a href="../306852/index.html">Summer internship at Positive Technologies: selection results and some statistics</a></li>
<li><a href="../306856/index.html">I / O tracer in the Linux kernel</a></li>
<li><a href="../306858/index.html">SObjectizer: from simple to complex. Part I</a></li>
<li><a href="../306860/index.html">GitLab 8.10 released</a></li>
<li><a href="../306862/index.html">All kernel mode drivers for Windows 10 (1607) should now be signed by Microsoft</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>