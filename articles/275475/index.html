<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Azure Machine Learning: Developing machine learning services and using them in a mobile application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Thank you very much for preparing the article for Evgeny Grigorenko, Microsoft Student Partner, ( @ evgri243 ) for helping to write this article. Our ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Azure Machine Learning: Developing machine learning services and using them in a mobile application</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <em>Thank you very much for preparing the article for Evgeny Grigorenko, Microsoft Student Partner, ( <a href="http://twitter.com/evgri243">@ evgri243</a> ) for helping to write this article.</em>  <em>Our remaining Azure articles can be found on the <a href="http://habrahabr.ru/search/%3Fq%3D%255Bazureweek%255D%26target_type%3Dposts">azureweek</a> tag <a href="http://habrahabr.ru/search/%3Fq%3D%255Bazureweek%255D%26target_type%3Dposts">.</a></em> </blockquote><br>  Machine learning is one of the most popular areas of Computer Science, although at the same time one of the most avoided among developers.  The main reason for this is that the theoretical part of machine learning requires deep mathematical preparation, which many prefer to forget immediately after graduating from university.  But it is necessary to understand that in addition to the theoretical foundations, there is also a practical side, which turns out to be much simpler for mastering and daily use.  The goal of this work is to bridge the gap between programmers and data processing specialists and show that using machine learning in their applications can be quite a simple task.  The article describes the entire sequence of steps necessary to build a model for predicting the price of a car, depending on its characteristics set and its subsequent use in a mobile application on Windows 10 Mobile. <br><a name="habracut"></a><br>  <b>What is Azure ML?</b> <br><br>  In short, Azure Machine Learning is: <br><ul><li>  cloud solution, allowing the construction and use of complex models of machine learning in a simple and visual form; </li><li>  ecosystem designed to spread and monetize ready-made algorithms. </li></ul><br>  More information about Azure ML can be found further in this article, as well as by clicking on the <a href="http://azure.microsoft.com/en-us/documentation/services/machine-learning/">link</a> <br><br>  <b>Why choose Azure ML?</b> <br>  Because Azure Machine Learning is one of the simplest tools to use machine learning, removing the entrance barrier for anyone who decides to use it for their needs.  With Azure ML, you no longer need to be a mathematician. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>The logical process of building a machine learning algorithm</b> <br><br><img src="https://habrastorage.org/files/2f4/ca6/f73/2f4ca6f739ba42cabb17ea9142afb2b8.png"><br><br><ol><li>  <b>Definition of purpose.</b>  All machine learning algorithms are useless without an explicitly defined goal of the experiment.  In this lab, the goal is to predict the price of a car based on a set of characteristics provided by the end user. </li><li>  <b>Data collection.</b>  During this stage, a sample of data is created that is necessary for further training of the model.  In this case, the data from the University of California machine learning repository will be used. <br>  <a href="https://archive.ics.uci.edu/ml/datasets/Automobile">archive.ics.uci.edu/ml/datasets/Automobile</a> </li><li>  <b>Data preparation.</b>  At this stage, data is prepared by forming characteristics, removing outliers and dividing the sample into training and test. </li><li>  <b>Model development.</b>  In the process of developing a model, one or several data models and corresponding learning algorithms will be selected, which, in the opinion of the developer, will have to give the desired result.  Often this process is combined with a parallel study of the effectiveness of several models and visual analysis of data in order to find any patterns. </li><li>  <b>Learning model.</b>  During training, the learning algorithm searches for hidden patterns in the data sample in order to find a prediction method.  The search process itself is determined by the selected model and learning algorithm. </li><li>  <b>Evaluation of the model.</b>  After the model is trained, it is necessary to investigate its predictive characteristics.  Most often for this, it is run on a test sample and the resulting level of error is estimated.  Depending on this and accuracy requirements, the model can be either taken as a final one or re-trained after adding new input characteristics or even changing the learning algorithm. </li><li>  <b>Using the model.</b>  In case of successful testing of a trained model, a stage of its use begins.  And this is the case when Azure ML becomes indispensable, giving all the necessary tools for publishing, monitoring and monetizing algorithms. </li></ol><br><br>  <b>Building a prognostic model</b> <br><br>  To begin, click on the <a href="http://www.azure.com/">link</a> , in the menu item Products, select Analytics and click Machine Learning.  Or use the <a href="http://azure.microsoft.com/en-us/services/machine-learning/">direct link.</a> <br><br><img src="https://habrastorage.org/files/bfa/920/dc1/bfa920dc19734181b9fdfd7da9415fa1.png"><br><br>  On the page that opens, click Get Started now. <br><br>  To work with Azure ML, you need an active Microsoft Azure subscription.  If you already have one, just sign in to the Azure Management Portal, otherwise, register a free trial account in advance by clicking on the <a href="http://azure.microsoft.com/en-us/pricing/free-trial/">link</a> . <br><br>  After successful authorization, you will find yourself on the main page of the Azure ML Studio - an environment where all further work will take place. <br><br><img src="https://habrastorage.org/files/fa1/6b4/75d/fa16b475d13a4e10806ba1e32eebc702.png"><br><br>  <b>Data loading</b> <br><br>  The first step is to load the training set.  To do this, click on the <a href="https://archive.ics.uci.edu/ml/machine-learning-databases/autos/">link</a> and download to your computer the file imports-85.data, containing a sample of data on cars. <br>  To upload this file to Azure ML Studio, click on New at the bottom of the page and in the panel that opens, select Dataset and From Local File.  In the download menu, specify the path to the downloaded file, the name, and select Generic CSV File with no header (.hn.csv) as the type. <br><br><img src="https://habrastorage.org/files/718/d58/51e/718d5851e3954981a1e152046c669670.png"><br><br>  <b>Create a new experiment</b> <br><br>  To create a new experiment, select New -&gt; Experiment -&gt; Blank Experiment.  This will create a new experiment workspace with the toolbar on the right. <br><br><img src="https://habrastorage.org/files/f0f/0e5/cda/f0f0e5cda20d41dc877dfe670cf00f54.png"><br><br>  <b>Determination of data sampling</b> <br><br>  Previously loaded data should be reflected in the Saved Datasets section on the left.  Select it and drag it to any place in the workspace, for example, wherever the Drag Items Here arrow points. <br><br><img src="https://habrastorage.org/files/81d/aad/d90/81daadd909644733bd56b9b20ec8cc94.png"><br><br>  Note that the data source has a circle-shaped connection point, which is used to connect it to other components. <br><br>  <b>Data preparation</b> <br><br>  When developing machine learning models, it is good practice to check the preliminary results of the experiment after each change.  Therefore, right-click on the connection point and select Visualize.  As a result, a window will appear giving a general idea of ‚Äã‚Äãthe data and its distribution. <br><br><img src="https://habrastorage.org/files/cda/7e0/a7a/cda7e0a7afff4ad9a17b10c5ab6a5512.png"><br><br>  As you can see, the sample has a problem - there are no values ‚Äã‚Äãin the second column.  This can create an undesirable effect in the learning process and significantly degrade the quality of the model.  But, fortunately, these values ‚Äã‚Äãcharacterize insurance costs and are weakly related to the price of the car, and therefore they can be removed.  In addition, the columns have no names, which makes it difficult to work with them. <br><br>  To fix a problem with names from the Data Transformation / Manipulation group, drag the Metadata Editor to the work surface. <br><br>  Drag the output (bottom) of the data sample to the input (top) of the new component to connect them.  Now click on it to open the settings window on the right.  Metadata Editor allows you to change the meta information of one or more columns, including the type or name.  Open the column selection wizard by clicking on Launch column selector.  To select all columns, in the Begin With field, select All columns, delete the selection refinement line by clicking on the ‚Äú-‚Äú sign on the right and confirm by clicking on the check mark. <br><br>  In the New column names field of the settings panel, enter the new column names, separated by commas, which can be found in the import-85.names file from the link provided earlier.  The field value should be as follows: <br><br>  <i>symboling, normalized losses, make-up, fuel-type, body-style, drive-wheels, engine-location, wheel-base, length, width, height, curb-weight, engine-type, num-of-cylinders, engine-size, fuel-system, bore, stroke, compression-ratio, horsepower, peak-rpm, city-mpg, highway-mpg, price</i> <br><br>  In order to see the result of the component, click on the Run from below and visualize the Metadata Editor output as previously described. <br><br><img src="https://habrastorage.org/files/edf/702/d35/edf702d35d9342e9b475d8e995f81946.png"><br><br>  Now remove the normalized-losses.  To do this, drag Project Columns from the same group to the workspace, connect it to the Metadata Editor and go to its settings.  Select the row selection wizard again and this time select all the rows except for normalized-losses, making settings similar to those shown in the figure below. <br><br><img src="https://habrastorage.org/files/a57/6d9/944/a576d99442834f14be2063d91bd6acfd.png"><br><br>  Run the experiment and visualize the result to make sure that the second column is missing from the sample. <br><br>  Unfortunately, there are still columns in which values ‚Äã‚Äãare missing.  But there are not many of them, and therefore it can be confined only to dropping incomplete lines.  To do this, select the Missing Value Scrubber and connect it to Project Columns.  In the For missing values ‚Äã‚Äãfield, change the value to Remove entire row.  Run, visualize and make sure the lines with empty values ‚Äã‚Äãare missing. <br><br><img src="https://habrastorage.org/files/5ae/651/48e/5ae65148e6df4fac97ec4ce50884814e.png"><br><br>  There remains the last question that needs to be answered at the preparation stage: do all the characteristics affect the price of the car?  At this stage, you can limit yourself to the following small number of indicators, a list of which is given below.  In the future, you can always add new ones and test the hypothesis of their sufficiency by comparing the accuracy of the models obtained. <br><br>  <i>make-up, body-style, wheel-base, engine-size, horsepower, peak-rpm, highway-mpg, num-of-cylinders, price</i> <br><br>  Add a new Project Columns and select the above columns. <br><br><img src="https://habrastorage.org/files/b5c/980/d44/b5c980d4410a459688914dc28c1ce320.png"><br><br>  In conclusion, make sure that the data preparation is successful by running the experiment and visualizing the result. <br><br>  <b>Sample breakdown</b> <br><br>  Now the data is ready for use in the learning process.  But in machine learning, the effect, called ‚Äúretraining,‚Äù is possible - learning a data model without generalization.  This behavior leads to the impossibility of adequate prediction on any different data.  To handle this situation, the sample is divided into training and test in the ratio close to 3: 1.  The last of them does not participate in the learning process in any way and upon completion is used to estimate the prediction error.  If this error is significantly different from the error on the training sample, then the effect described above is observed. <br><br>  To create a test sample, drag and drop Split Data from the Data Transformation / Sample and Split group to the last Project Columns.  Set the proportion of lines on the first exit to 0.75 and make sure that the Randomize Split flag is set. <br><br>  <b>Learning linear regression model</b> <br><br>  First, drag the Linear Regression, Train Model, Score Model and Evaluate Model components from the toolbar.  Train Model is a universal component that allows training of any model on any training sample.  To configure our particular case, connect the first (left) output of the Split Data and the output of the Linear Regression to the corresponding inputs of the Train Model.  In the Train Model settings, specify the price as the target value (outcome column).  Now the model is ready to learn. <br><br>  But besides the training itself, it is important to know the result of the training.  The Score Model component allows you to calculate the output of a trained model on an arbitrary sample and calculate the prediction result.  Connect the Train Model output, which contains the trained model, to the corresponding Score Model input, and as a sample of data to another input, submit a test sample from the second output of Split Data.  Connect the Score Model output to any of the Evaluate Model inputs in order to calculate the numerical characteristics of the learning quality.  The result should be a process similar to that shown in the figure. <br><br><img src="https://habrastorage.org/files/0b6/589/4c8/0b65894c872b4ad597cf9d819d6476b6.png"><br><br>  Run the model and visualize the result of the Evaluate Model. <br><br><img src="https://habrastorage.org/files/5c0/fac/e58/5c0face5867b40469c4a2569d74988c1.png"><br><br>  The coefficient of determination indicates how well the regression line describes the raw data.  Values ‚Äã‚Äãtaken from it range from 0 to 1, where absolute absolute value corresponds to one.  In our case, the coefficient is 82%.  Whether this is a good result or not is directly dependent on the formulation of the problem and a certain tolerance for error.  For the case of predicting the price of a car, 82% is an excellent result.  If you want to improve it, try adding other columns to Project Columns or try a completely different algorithm.  For example, Poisson Regression.  The latter can be achieved by simply replacing the linear regression component with a puason.  But a more interesting approach is to assemble parallel training from the elements and connect the result to the second output of the Evaluate Model, which will allow to compare the training results of both models in a convenient form. <br><br><img src="https://habrastorage.org/files/12c/bf6/b0f/12cbf6b0f5314798a60cdd4356d1c477.png"><br><br>  Run the model and visualize the result.  As can be seen from the result, the data are much better described by the linear regression model, and therefore there is every reason to select it as the final one. <br><br><img src="https://habrastorage.org/files/2ff/a7e/ee2/2ffa7eee2c694b3893f6c9da87b149cf.png"><br><br>  Right-click on the Train Model component that responds to linear regression and select Save as Trained Model.  This will allow the model to be used in any other experiments without the need for re-training. <br><br>  <b>Web service publishing</b> <br><br>  To publish a service, select the Train Model component that responds to linear regression and click on Set Up Web Service.  In the menu that opens, select Predictive Web Service [Recommended] and wait for Azure ML to create a new experiment optimized for the needs of the service.  Delete the automatically created Web Service Input and Web Service Output components ‚Äî we will create them later after a little preparation. <br><br>  At the moment, the Score Model element repeats all incoming columns at the output, and the predicted value is given the name Score Labels.  This needs to be fixed. <br><br>  To do this, transfer two familiar components from the toolbar to the work surface: Project Columns and the Metadata Editor.  And connect them in the sequence shown in the figure below.  In the Project Columns settings, select only one Score Labels column, and use the Metadata Editor to rename it to price. <br><br>  In conclusion, you need to add the input and output of the created service.  To do this, add to the Web Service Input and Web Service Output experiment.  Connect the first to the input of the Score Model, and the second to the output of the Metadata Editor.  In the settings of both elements, change the name to ‚Äúinput‚Äù and ‚Äúprediction‚Äù, respectively. <br><br>  Run the model again by clicking on Run, and after the validation is completed, publish the service by clicking Deploy Web Service. <br><br><img src="https://habrastorage.org/files/7c4/c17/f72/7c4c17f720a64ade8efacbbbf23aa711.png"><br><br>  <b>Service testing</b> <br><br>  After clicking Deploy Web Service, you will be redirected to a page with information about the newly created service.  The links under the HELP PAGE API contain a fairly detailed description with information about the contents of the incoming and outgoing JSON packets, as well as an example of the console application code, which gives an idea of ‚Äã‚Äãhow to use. <br><br><img src="https://habrastorage.org/files/9f4/bb2/184/9f4bb21844274df4a5697db67fc17d4c.png"><br><br>  For an interactive study, click on Test and in the window that opens, enter values ‚Äã‚Äãfor each input parameter.  For example, those listed below, and click the check mark to send a test request. <br><br>  <i>audi sedan 99.8 four 109 102 5500 30 13950</i> <br><br><img src="https://habrastorage.org/files/6ef/12e/f88/6ef12ef885784703aeb01ed23b26628f.png"><br><br>  <b>Application development</b> <br><br>  In conclusion, consider the process of developing a mobile application that uses Azure ML as a back-end service.  First create a new project for a universal Windows application.  To do this, open Visual Studio 2015, select File -&gt; New -&gt; Project ... In the window that opens, go to the Windows tab in the left menu and select Blank App (Universal Windows).  In the title field, enter AzureMLDemo and click OK.  If necessary, the finished project can be found on <a href="https://github.com/evgri243/pubic-demos">GitHub</a> . <br><br><img src="https://habrastorage.org/files/be7/598/9bf/be75989bf7d5425caf2b6651a5e7ee97.png"><br><br>  After some preparation, Visual Studio will open a new universal application project.  Make sure that the x86 is indicated in the processor architecture field to the right of Debug, and to the right, select one of the mobile virtual machines as the launch environment.  For example, Mobile Emulator 10.0.10240.0 720p 5 inch 1GB. <br><br>  Now you can proceed to writing the application itself.  In the Solution Explorer menu, double-click on MainPage.xaml.  The description of the XAML markup language of the graphical interface is beyond the scope of this work, so just replace the opening and closing &lt;Grid ...&gt; tags with the code below. <br><br><pre><code class="cs hljs">&lt;ScrollViewer Background=<span class="hljs-string"><span class="hljs-string">"{ThemeResource ApplicationPageBackgroundThemeBrush}"</span></span> HorizontalScrollMode=<span class="hljs-string"><span class="hljs-string">"Disabled"</span></span> VerticalScrollBarVisibility=<span class="hljs-string"><span class="hljs-string">"Hidden"</span></span>&gt; &lt;StackPanel&gt; &lt;TextBlock Text=<span class="hljs-string"><span class="hljs-string">"Estimate the price of your dream car"</span></span> Style=<span class="hljs-string"><span class="hljs-string">"{ThemeResource TitleTextBlockStyle}"</span></span> TextAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5,20,5,5"</span></span> TextWrapping=<span class="hljs-string"><span class="hljs-string">"WrapWholeWords"</span></span>/&gt; &lt;Border Margin=<span class="hljs-string"><span class="hljs-string">"5 10"</span></span> BorderBrush=<span class="hljs-string"><span class="hljs-string">"LightGray"</span></span> BorderThickness=<span class="hljs-string"><span class="hljs-string">"2"</span></span>&gt; &lt;Grid&gt; &lt;Grid.ColumnDefinitions&gt; &lt;ColumnDefinition Width=<span class="hljs-string"><span class="hljs-string">"Auto"</span></span>/&gt; &lt;ColumnDefinition Width=<span class="hljs-string"><span class="hljs-string">"*"</span></span>/&gt; &lt;ColumnDefinition Width=<span class="hljs-string"><span class="hljs-string">"40"</span></span>/&gt; &lt;/Grid.ColumnDefinitions&gt; &lt;Grid.RowDefinitions&gt; &lt;RowDefinition Height=<span class="hljs-string"><span class="hljs-string">"40"</span></span>/&gt; &lt;RowDefinition Height=<span class="hljs-string"><span class="hljs-string">"40"</span></span>/&gt; &lt;RowDefinition Height=<span class="hljs-string"><span class="hljs-string">"40"</span></span>/&gt; &lt;RowDefinition Height=<span class="hljs-string"><span class="hljs-string">"40"</span></span>/&gt; &lt;RowDefinition Height=<span class="hljs-string"><span class="hljs-string">"40"</span></span>/&gt; &lt;RowDefinition Height=<span class="hljs-string"><span class="hljs-string">"40"</span></span>/&gt; &lt;RowDefinition Height=<span class="hljs-string"><span class="hljs-string">"40"</span></span>/&gt; &lt;RowDefinition Height=<span class="hljs-string"><span class="hljs-string">"40"</span></span>/&gt; &lt;/Grid.RowDefinitions&gt; &lt;TextBlock Text=<span class="hljs-string"><span class="hljs-string">"Make"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"0"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"0"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Right"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5"</span></span>/&gt; &lt;TextBox Name=<span class="hljs-string"><span class="hljs-string">"tbxMake"</span></span> Text=<span class="hljs-string"><span class="hljs-string">"Audi"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"0"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"1"</span></span> Grid.ColumnSpan=<span class="hljs-string"><span class="hljs-string">"2"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5"</span></span>/&gt; &lt;TextBlock Text=<span class="hljs-string"><span class="hljs-string">"Body Style"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"1"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"0"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Right"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5"</span></span>/&gt; &lt;TextBox Name=<span class="hljs-string"><span class="hljs-string">"tbxBodyStyle"</span></span> Text=<span class="hljs-string"><span class="hljs-string">"Sedan"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"1"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"1"</span></span> Grid.ColumnSpan=<span class="hljs-string"><span class="hljs-string">"2"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5"</span></span>/&gt; &lt;TextBlock Text=<span class="hljs-string"><span class="hljs-string">"Wheel Base"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"2"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"0"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Right"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5"</span></span>/&gt; &lt;Slider Name=<span class="hljs-string"><span class="hljs-string">"slWheelBase"</span></span> Value=<span class="hljs-string"><span class="hljs-string">"99"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"2"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"1"</span></span> Minimum=<span class="hljs-string"><span class="hljs-string">"86"</span></span> Maximum=<span class="hljs-string"><span class="hljs-string">"121"</span></span> StepFrequency=<span class="hljs-string"><span class="hljs-string">"1"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5,5,3,5"</span></span>/&gt; &lt;TextBlock Name=<span class="hljs-string"><span class="hljs-string">"tbWheelBase"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"2"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"2"</span></span> Text=<span class="hljs-string"><span class="hljs-string">"{x:Bind slWheelBase.Value, Mode=OneWay}"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"2,5,5,5"</span></span>/&gt; &lt;TextBlock Text=<span class="hljs-string"><span class="hljs-string">"Number of Cylinders"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"3"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"0"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Right"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5"</span></span>/&gt; &lt;TextBox Name=<span class="hljs-string"><span class="hljs-string">"tbxNumberOfCylinders"</span></span> Text=<span class="hljs-string"><span class="hljs-string">"Four"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"3"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"1"</span></span> Grid.ColumnSpan=<span class="hljs-string"><span class="hljs-string">"2"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5"</span></span>/&gt; &lt;TextBlock Text=<span class="hljs-string"><span class="hljs-string">"Engine Size"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"4"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"0"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Right"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5"</span></span>/&gt; &lt;Slider Name=<span class="hljs-string"><span class="hljs-string">"slEngineSize"</span></span> Value=<span class="hljs-string"><span class="hljs-string">"109"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"4"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"1"</span></span> Minimum=<span class="hljs-string"><span class="hljs-string">"61"</span></span> Maximum=<span class="hljs-string"><span class="hljs-string">"326"</span></span> StepFrequency=<span class="hljs-string"><span class="hljs-string">"1"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5,5,3,5"</span></span>/&gt; &lt;TextBlock Name=<span class="hljs-string"><span class="hljs-string">"tbEngineSize"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"4"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"2"</span></span> Text=<span class="hljs-string"><span class="hljs-string">"{x:Bind slEngineSize.Value, Mode=OneWay}"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"2,5,5,5"</span></span>/&gt; &lt;TextBlock Text=<span class="hljs-string"><span class="hljs-string">"Horsepowers"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"5"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"0"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Right"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5"</span></span>/&gt; &lt;Slider Name=<span class="hljs-string"><span class="hljs-string">"slHorsepowers"</span></span> Value=<span class="hljs-string"><span class="hljs-string">"102"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"5"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"1"</span></span> Minimum=<span class="hljs-string"><span class="hljs-string">"48"</span></span> Maximum=<span class="hljs-string"><span class="hljs-string">"288"</span></span> StepFrequency=<span class="hljs-string"><span class="hljs-string">"1"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5,5,3,5"</span></span>/&gt; &lt;TextBlock Name=<span class="hljs-string"><span class="hljs-string">"tbHorsepowers"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"5"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"2"</span></span> Text=<span class="hljs-string"><span class="hljs-string">"{x:Bind slHorsepowers.Value, Mode=OneWay}"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"2,5,5,5"</span></span>/&gt; &lt;TextBlock Text=<span class="hljs-string"><span class="hljs-string">"Peak PRM"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"6"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"0"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Right"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5"</span></span>/&gt; &lt;Slider Name=<span class="hljs-string"><span class="hljs-string">"slPeakRPM"</span></span> Value=<span class="hljs-string"><span class="hljs-string">"5500"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"6"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"1"</span></span> Minimum=<span class="hljs-string"><span class="hljs-string">"4150"</span></span> Maximum=<span class="hljs-string"><span class="hljs-string">"6600"</span></span> StepFrequency=<span class="hljs-string"><span class="hljs-string">"1"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5,5,3,5"</span></span>/&gt; &lt;TextBlock Name=<span class="hljs-string"><span class="hljs-string">"tbPeakRPM"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"6"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"2"</span></span> Text=<span class="hljs-string"><span class="hljs-string">"{x:Bind slPeakRPM.Value, Mode=OneWay}"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"2,5,5,5"</span></span>/&gt; &lt;TextBlock Text=<span class="hljs-string"><span class="hljs-string">"Highway MPG"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"7"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"0"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Right"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5"</span></span>/&gt; &lt;Slider Name=<span class="hljs-string"><span class="hljs-string">"slHighwayMPG"</span></span> Value=<span class="hljs-string"><span class="hljs-string">"30"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"7"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"1"</span></span> Minimum=<span class="hljs-string"><span class="hljs-string">"16"</span></span> Maximum=<span class="hljs-string"><span class="hljs-string">"54"</span></span> StepFrequency=<span class="hljs-string"><span class="hljs-string">"1"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Stretch"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"5,5,3,5"</span></span>/&gt; &lt;TextBlock Name=<span class="hljs-string"><span class="hljs-string">"tbHighwayMPG"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"7"</span></span> Grid.Column=<span class="hljs-string"><span class="hljs-string">"2"</span></span> Text=<span class="hljs-string"><span class="hljs-string">"{x:Bind slHighwayMPG.Value, Mode=OneWay}"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"2,5,5,5"</span></span>/&gt; &lt;/Grid&gt; &lt;/Border&gt; &lt;Button Name=<span class="hljs-string"><span class="hljs-string">"btnGetEstimate"</span></span> Grid.Row=<span class="hljs-string"><span class="hljs-string">"2"</span></span> Content=<span class="hljs-string"><span class="hljs-string">"Get estimate"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span>/&gt; &lt;TextBlock Name=<span class="hljs-string"><span class="hljs-string">"tbResult"</span></span> TextAlignment=<span class="hljs-string"><span class="hljs-string">"Left"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"10 5"</span></span> TextWrapping=<span class="hljs-string"><span class="hljs-string">"Wrap"</span></span>/&gt; &lt;/StackPanel&gt; &lt;/ScrollViewer&gt;</code> </pre> <br>  Despite all the seeming complexity, this code creates a fairly simple markup needed to enter user data.  Each input element of one of the model parameters has a name like tbxMake, txbBodyStyle, etc.  Under them is the Get Estimate button, which is responsible for sending a message to the Azure ML service, and all is completed with the tbResult element, into which the result of the call will be placed. <br><br>  Start the application by clicking on Debug -&gt; Start Debugging to make sure that everything has been done correctly, the project is compiled and run.  Check that changing the position of the sliders leads to a corresponding change in the numerical value to the right of them. <br><br>  Stop the debugging session by clicking on Debug -&gt; Stop Debugging. <br><br>  <b>Definition of program logic</b> <br><br>  Now it is necessary to determine the processing code for clicking on the Get Estimate button.  In Solution Explorer, expand MainPage.xaml and double-click on MainPage.xaml.cs to open the Code-behind file of this graphical interface. <br><br>  First of all, you should connect several required libraries.  To do this, right-click on the project name and select Manage Nuget Packages ... In the menu that opens, search WebApi.Slient and install the package called Microsoft.AspNet.WebApi.Client. <br><br><img src="https://habrastorage.org/files/2b4/e6d/e4f/2b4e6de4ffbd42aa9bfb1b51ebee77ee.png"><br><br>  After that, add the following additional using declarations to the beginning of the file: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Net.Http; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Net.Http.Headers; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Newtonsoft.Json; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; &lt;/source      MainPage  ,       . &lt;source lang=<span class="hljs-string"><span class="hljs-string">"cs"</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MainPage</span></span> : <span class="hljs-title"><span class="hljs-title">Page</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _apiKey = <span class="hljs-string"><span class="hljs-string">@"&lt;your API key&gt;"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _requestUri = <span class="hljs-string"><span class="hljs-string">@"Your key"</span></span>;</code> </pre><br>  The access key can be found on the Dashboard page of your service, and the address of the request is on the REQUEST / RESPONSE help page, the link to which is given below. <br><br><img src="https://habrastorage.org/files/fa8/5e7/141/fa85e71411d84cccb6124d14b40a5f99.png"><br><img src="https://habrastorage.org/files/aae/252/ce1/aae252ce1b844b1eafab70e271a59a66.png"><br><br>  The next step is to add a helper function that will query the Azure ML service.  In accordance with the documentation provided on the same REQUEST / RESPONSE help page, to receive a response, we must perform the following sequence of actions: create a request, send it to the service side with a HTTP POST request and process the response. <br>  Create a CallAzureML function that accepts the input values ‚Äã‚Äãof all model parameters and returns a float value with a price estimate.  The Async Task here responds to the implementation of the async / await pattern, which greatly simplifies working with asynchronous calls in the application (additional information can be found <a href="https://msdn.microsoft.com/en-us/library/hh191443.aspx">here</a> ). <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CallAzureML</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> make, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> bodyStyle, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> wheelBase, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> numberOfCylinders, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> engineSize, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> horsepowers, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> peakRPM, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> highwayMPG</span></span></span><span class="hljs-function">)</span></span> { }</code> </pre><br>  Also, to simplify working with JSON, we will use the Newtonsoft.Json library.  Its distinctive feature is that it allows you to interact with JSON objects through a convenient abstraction in the form of ordinary .NET-level objects.  Place the following code at the beginning of the method. <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> requestBody = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { Inputs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>&gt;() { { <span class="hljs-string"><span class="hljs-string">"input"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { ColumnNames = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] {<span class="hljs-string"><span class="hljs-string">"make"</span></span>, <span class="hljs-string"><span class="hljs-string">"body-style"</span></span>, <span class="hljs-string"><span class="hljs-string">"wheel-base"</span></span>, <span class="hljs-string"><span class="hljs-string">"num-of-cylinders"</span></span>, <span class="hljs-string"><span class="hljs-string">"engine-size"</span></span>, <span class="hljs-string"><span class="hljs-string">"horsepower"</span></span>, <span class="hljs-string"><span class="hljs-string">"peak-rpm"</span></span>, <span class="hljs-string"><span class="hljs-string">"highway-mpg"</span></span>, <span class="hljs-string"><span class="hljs-string">"price"</span></span>}, Values = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[,] { { make, bodyStyle, wheelBase.ToString(), numberOfCylinders, engineSize.ToString(), horsepowers.ToString(), peakRPM.ToString(), highwayMPG.ToString(), <span class="hljs-string"><span class="hljs-string">"0"</span></span> } } } } }, GlobalParameters = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;() };</code> </pre><br>  Here the structure of the JSON object of the request is recreated using an anonymous class and completely (case sensitive) repeats the structure of the expected request.  For comparison, an example of such a request from the REQUEST / RESPONSE page is presented below. <br><br> <code>{ <br> "Inputs": { <br> "input": { <br> "ColumnNames": [ "make", "body-style", ‚Äúwheel-base", "num-of-cylinders", <br> "engine-size", "horsepower", "peak-rpm", "highway-mpg", <br> "price" ], <br> "Values": [ <br> [ "value", "value", "0", "value", "0", "0", "0", "0", "0" ], <br> [ "value", "value", "0", "value", "0", "0", "0", "0", "0" ] <br> ] <br> } <br> }, <br> "GlobalParameters": {} <br> } <br></code> <br>  The next step is to make the request to the service itself.  To do this, add the following code to the method being developed. <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> client = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpClient()) { client.DefaultRequestHeaders.Authorization = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AuthenticationHeaderValue(<span class="hljs-string"><span class="hljs-string">"bearer"</span></span>, _apiKey); client.BaseAddress = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Uri(_requestUri); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> response = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> client.PostAsJsonAsync(<span class="hljs-string"><span class="hljs-string">""</span></span>, requestBody); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.IsSuccessStatusCode) { <span class="hljs-comment"><span class="hljs-comment">// succeeded throw new NotImplementedException(); } else { // failed throw new NotImplementedException(); } } } catch (Exception e) { throw; }</span></span></code> </pre><br>  The first task is to create an HTTP client and set all the information needed to successfully connect to the service in Azure ML: the address and access key.  Next, a POST request is made towards the service with the JSON object created earlier.  The success of the call is checked by the HTTP status code. <br><br>  Replace the code in the field marked by the comment succeeded with the one shown below.  It consistently receives the server‚Äôs response as a string, parses it into a dynamic object using the Newtonsoft.Json converter, and then extracts the price information.  An example of the server response for comparison can be found in the section "Testing the service". <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> responseContent = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> response.Content.ReadAsStringAsync(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> val = JsonConvert.DeserializeObject&lt;<span class="hljs-keyword"><span class="hljs-keyword">dynamic</span></span>&gt;(responseContent); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>? price = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)val?.Results?.prediction?.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>?.Values[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (price == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InvalidDataException(<span class="hljs-string"><span class="hljs-string">"Response message has unknown format"</span></span> + <span class="hljs-string"><span class="hljs-string">" or is empty."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)price;</code> </pre><br>  In case of an erroneous state, the method should return maximum information.  Therefore, as in the previous case, the content of the query is retrieved as a string, but this time it is sequentially converted to an object and back to a string.  This is necessary in order to add indentation, allowing more convenient reading of its contents.  Replace the code in the area marked with the failed comment with the one below. <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> responseContent = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> response.Content.ReadAsStringAsync(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> responseObject = JsonConvert.DeserializeObject(responseContent); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> formattedResponseContent = JsonConvert.SerializeObject(responseObject, Formatting.Indented); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> message = String.Format(<span class="hljs-string"><span class="hljs-string">"Server returned status code {0} with message {1}"</span></span>, response.StatusCode, formattedResponseContent); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InvalidDataException(message);</code> </pre><br>  The method of calling Azure ML can be considered complete.  As you can see, its implementation is quite simple, although it builds a whole process behind it on the implementation of a statistical data model, a learning algorithm and a method for evaluating an arbitrary estimate of the input vector.  Quite complex mathematical theories fit in a couple of lines of program code. <br>  In conclusion, you need to implement an event handler for pressing the Get estimate button.  First, go to MainPage.xaml and add the information about the event handler to the XML tag of the GetEstimate button. <br><br><pre> <code class="cs hljs"> &lt;Button ‚Ä¶ Click=<span class="hljs-string"><span class="hljs-string">"GetEstimate_Click"</span></span>/&gt;</code> </pre><br>  Return to MainPage.xaml.cs and create the appropriate method.  It calls the previously created method to access the Azure ML service and sets the result to tbResult. <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetEstimate_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, RoutedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> price = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> CallAzureML(tbxMake.Text, tbxBodyStyle.Text, slWheelBase.Value, tbxNumberOfCylinders.Text, (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)slEngineSize.Value, (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)slHorsepowers.Value, (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)slPeakRPM.Value, (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)slHighwayMPG.Value); tbResult.Text = String.Format(<span class="hljs-string"><span class="hljs-string">"You are lucky!\n"</span></span> + <span class="hljs-string"><span class="hljs-string">"Today it is as cheap as {0:c}. Don't miss your chance!"</span></span>, price); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex) { <span class="hljs-comment"><span class="hljs-comment">// Shows error in result TextBlock tbResult.Text = String.Format("Oops! Something went wrong.\n" + "This can be helpful:\n{0}", ex.ToString()); } }</span></span></code> </pre><br>  That's it, the application is ready.  Run it and experiment with estimating the cost of the car with different sets of characteristics. <br><br><img src="https://habrastorage.org/files/048/912/912/04891291270f4969b0eebc1e87a23e62.png"><br><br>  <b>Conclusion</b> <br><br>  Azure Machine Learning is a new, highly productive tool for working with machine learning algorithms.  Perhaps this is even the only environment that makes it so easy to publish your algorithms as a separate service and later use them in your applications.  In this work, one of the simplest learning algorithms was used - a linear regression algorithm.  Dozens of others are available in Azure ML, created by scientists for a variety of purposes.  And the most important thing is that there is no need to be a mathematician to use them.  It is enough to assemble the necessary data processing with the help of components, conduct several experiments and, if successful, publish everything as a service. <br>  Here are some more samples of data to experiment with: <br><ul><li>  <a href="http://archive.ics.uci.edu/ml/datasets/Daily%2Band%2BSports%2BActivities">Daily and Sports Activities Data Set</a> </li><li>  <a href="http://archive.ics.uci.edu/ml/datasets/Farm%2BAds">Farm Ads Data Set</a> </li><li>  <a href="http://archive.ics.uci.edu/ml/datasets/Arcene">Arcene Data Set</a> </li><li>  <a href="http://archive.ics.uci.edu/ml/datasets/Bag%2Bof%2BWords">Bag of Words Data Set</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/275475/">https://habr.com/ru/post/275475/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../275459/index.html">Measurement of ore weight by stator current. Practice. Part 1. Signal processing algorithm in MK</a></li>
<li><a href="../275463/index.html">Using Chakra and JavaScript in Azure DocumentDB</a></li>
<li><a href="../275469/index.html">The most "New Year" messenger for Yota users is WhatsApp</a></li>
<li><a href="../275471/index.html">Eleven important ONLYOFFICE features that are not found in MS Office Online or in Google Docs</a></li>
<li><a href="../275473/index.html">Remote debugging javascript with VS2015. Part 1</a></li>
<li><a href="../275477/index.html">Javapocalypse in a single system</a></li>
<li><a href="../275479/index.html">Advanced Yandex (and Google) search using the installed script or in the interface</a></li>
<li><a href="../275481/index.html">Cloud Experience: How We Translated the KPI Suite to the Azure Platform</a></li>
<li><a href="../275483/index.html">The first game for iOS and the first difficulties. How not to give up and bring it to release</a></li>
<li><a href="../275485/index.html">How to add a library to the project?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>