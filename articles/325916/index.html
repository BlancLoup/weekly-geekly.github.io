<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Behind the closed door of the front of the EFS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article we will talk about the library of components of the Unified Frontal System (EFS) and how the front-end platform is built in general. 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Behind the closed door of the front of the EFS</h1><div class="post__text post__text-html js-mediator-article">  In this article we will talk about the library of components of the Unified Frontal System (EFS) and how the front-end platform is built in general. <br><br> <a href="https://habrahabr.ru/company/efs/blog/325916/"><img src="https://habrastorage.org/files/b09/f46/c53/b09f46c53efe4cbbbeaeecf05313a005.jpg"></a> <br><a name="habracut"></a><br>  One of the main tasks of the ESF program is the transformation of all frontal systems to a single technological stack.  The frontal system in our context is an interface through which any user interacts with the bank.  This can be an online bank - many of them know Sberbank Online and Sberbank Online for business applications, such as ATMs, terminals, interfaces of operators in branches and call-centers and other systems used by many thousands of customers and bank employees in Russia. <br><br>  The main problem that we solve is the replacement of outdated code: there are many frontal systems in the bank, each has its own architecture, its own design. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Obviously, this is inconvenient for everyone: for customers, employees and the bank as a whole. <br>  Therefore, the main mission of the ESF frontend is to replace the existing hodgepodge and bring everything to a single code base, to a single technological stack with a convenient and understandable user scenario. <br><br><h2>  What are the challenges facing development? </h2><br><ul><li>  Reliability and security, because we are talking about banking software. <br><br></li><li>  Fault tolerance.  This figure includes such a figure as 99.99%, which is approximately 52 minutes per year, when we can suspend the operation of the system. <br><br></li><li>  Convenience for different socio-demographic categories of users.  The interface should be understandable to both the advanced user and the grandmother, both an experienced bank employee and a novice.  We add that uniformity and standardization allow us to save considerable time on training many thousands of employees across Russia. <br><br></li><li>  The speed of work and implementation, the so-called time-to-market. </li></ul><br>  Before the ESF era, the time to launch a new technical product on the market could be up to 1 year.  With EFS, we set ourselves the task of reducing the time-to-market to 1 month. <br>  And this is just the beginning! <br><br><h2>  How is the frontend arranged at ESF? </h2><br>  We have a team of developers of the ESF platform, as well as application developers, whose task is to implement the business logic. <br><br>  The platform team is developing a library of UI components for internal use.  There are quite a few examples of such development - companies such as Google, Yandex, Avito, Mail.ru, etc. also have component libraries.  The teams of applied projects use this library to implement their projects, providing feedback in case of problems. <br>  The platform team now has 8 people.  We work in two-week sprints, at the end of each of them we release a new version of the library, which contains fixes and, possibly, new components.  We, of course, have code review, our own code style - we have taken the best programming practices and adapted them for ourselves. <br><br>  As a toolkit, we use a set of tools from Atlassian: JIRA for setting tasks, BitBucket for git repositories, and Confluence for documentation. <br><br><h2>  What does the library consist of? </h2><br><ul><li>  Various UI elements: various selects, buttons, a large set of fields with different data types, checkboxes, radio buttons and other form elements with which the user interacts. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fac/8f8/f78/fac8f8f78477f4761308cc060edd576c.png"><br><br></li><li>  Methods of displaying information, such as tables or panels with buttons and headings <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7a1/922/efe/7a1922efe68814b2c591652906c4668c.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c44/173/3f9/c441733f9f2f53f0cf81c9119fd4e8a9.png"><br><br></li><li>  Grid.  We looked at how Bootstrap implemented it, and then created something similar for its own purposes.  According to our grid, components are built on forms. <br><br></li><li>  Component view attachments.  It serves for the operator to interact with the attached file, for example, to zoom in or turn out the receipt. <br><br></li><li>  File Download Component <br><br></li><li>  Component for asynchronous loading of React-applications: there are a lot of business processes, we have divided them into separate React-applications, which are loaded during transitions from one process to another. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/505/35e/cf0/50535ecf0d7434f8a7a3cc7cf613c7a7.png"><br></li></ul><br><h2>  Browser support </h2><br>  Target browsers are IE8 +.  Now IE8, if someone remembers, it was IE6 in its time: terrible API and terrible debugging.  Of course, the time spent in debugging in IE8 is priceless.  There were cases when the developers spent several days trying to find where the error occurred, because in IE8 there was a very poor debug toolkit and it sometimes shows that the error occurred in a completely different place. <br><br>  IE support is not random, we have to work with hardware from the browser: RFID tablets, various printers, scanners, etc.  The Web does not have a single standard for working with hardware: in the distant past, ActiveX was selected as the technology for working with it.  The amount of software written using ActiveX is tremendous, and this does not allow us to give up the support of IE overnight and move towards modern browsers.  The plans include converting outdated ActiveX to Java applets and abandoning IE8. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dee/e6b/ea7/deee6bea7cfeda7e824889d713412a59.png"><br><br><h2>  Technology stack </h2><br>  We are a kind of startup inside a large organization and our frontend technology stack is not very different from most global startups: react, redux and PostCSS.  All these technologies have proven themselves at their best, and they also allow us to support IE8.  However, we cannot drastically change the technology stack, since  around it, a specific application architecture is tied, for example, it was React that allowed us to break one huge application into hundreds of small ones and load them on demand using SystemJS. <br><br><h3>  React </h3><br>  This is the first technology we have chosen for the following reasons: <br><br><ol><li>  Allows you to break the application into components, thereby organizing a component approach to development. <br><br></li><li>  Easy to learn - we do not require a new colleague to know React, we just give him a couple of days to figure out the project. <br><br></li><li>  IE8 support.  From this, in fact, it was possible to begin, because, if you look at which frameworks and libraries support IE8, it turns out that there are very few.  The most popular - Angular, Ember, Vue.js - do not support him, so we were lucky with React. </li></ol><br>  Also in the development process, we began experimenting with React Native, which allowed us to release a cross-platform library of UI components.  You can read about it in our <a href="https://habrahabr.ru/company/efs/blog/321828/">first article</a> . <br><br><h3>  How do we make friends with React and IE8? </h3><br>  First, we are not updating the version of React, because at some point they also refused to support IE8.  Secondly, we use es3ify - this is a webpack loader, which takes our ES5 code and surpasses it in ES3.  It simply replaces some things that don't work in IE8. <br><br><h3>  TypeScript </h3><br>  The second technology we chose was TypeScript, which is why: <br><br><ol><li>  Strong typing <br>  By our standards, the any type is prohibited, however, there are exceptions to the rules, because  far from everything can be covered with generics. <br><br></li><li>  Foolproof <br>  We are all human and sometimes use the wrong types, transfer the wrong data, and the compiler produces simple and understandable errors. <br><br></li><li>  Convenience of working with application developers <br>  As described above, we transfer our library to application developers.  Many of them also use TypeScript, and at the compilation stage they understand how to work with components correctly. </li></ol><br>  Now in the library about 70 components.  When we first started developing, we had all the components ‚Äúsmart‚Äù, that is, they contained a state and all the logic was inside.  We had no particular problems.  But, as soon as the components became more difficult, they began to invest in each other, there were a lot of them, we realized that we still had performance problems, we‚Äôll tell you how we solved them. <br><br><h3>  Performance </h3><br>  First, we made the components "stupid", that is, we got rid of the state, bringing it to the application level.  Now, application developers decide how to change the state, and the necessary props are only forwarded to our components. <br><br>  Take an example: <br><br><pre><code class="hljs scala">export <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Input</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component&lt;Props</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">State&gt;</span></span></span><span class="hljs-class"> </span></span>{    static defaultProps: <span class="hljs-type"><span class="hljs-type">Props</span></span> = {        value: ''    }    state: <span class="hljs-type"><span class="hljs-type">State</span></span> = {        value: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.value    }    handleChange = event =&gt; {        const value = event.nativeEvent.target.value;        <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState(prevState =&gt; ({value}))        <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.onChange(value);    };    render() {        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &lt;input onChange={<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleChange}                      value={<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.value} /&gt;;    } }</code> </pre> <br>  There is a library component Input, it has a value stored in state, it returns input in render, and it changes state in onChange.  Is there a lot of code for such a component?  Definitely a lot, let's refactor this example: <br><br><pre> <code class="hljs scala">export <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Input</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component&lt;Props</span></span></span><span class="hljs-class">, </span></span>{}&gt; {   static defaultProps: <span class="hljs-type"><span class="hljs-type">Props</span></span> = {       value: ''   }   handleChange = event =&gt;       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.onChange(event.nativeEvent.target.value);   render() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &lt;input onChange={<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleChange}                     value={<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.value} /&gt;;   } }</code> </pre><br>  The component code has become shorter, and at the level above there is the Form component, which itself decides how to manage the state of the component: via redux or through the simplest setState.  Input has become easier, and, accordingly, more productive. <br><br>  Second, we adhere to the pure components architecture (PureComponent), i.e.  all external properties, internal state and context are checked for compliance with the previous state.  If the state has not changed, then there is no point in calling render once more.  We perform this check in the method shouldComponentUpdate, which we added to all our components. <br><br>  And third, we got rid of memory leaks in callbacks. <br><br><pre> <code class="hljs scala">export <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Button</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component&lt;Props</span></span></span><span class="hljs-class">, </span></span>{}&gt; {   render() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           &lt;button onClick={event =&gt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.onClick(event)}&gt;               {<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.children}           &lt;/button&gt;       );   } }</code> </pre><br>  In this example, the component has an onClick callback and a switch function is passed to it. <br>  If you set it this way, then a leak occurs.  In IE8, it is especially visible because every time you call render, this function is created, it accumulates, and brakes occur in the component.  Let's slightly change our example: <br><br><pre> <code class="hljs scala">export <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Button</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component&lt;Props</span></span></span><span class="hljs-class">, </span></span>{}&gt; {   handleClick = event =&gt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.onClick(event);   render() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           &lt;button onClick={<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.handleClick}&gt;               {<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.children}           &lt;/button&gt;       );   } }</code> </pre><br>  The code itself has become more concise, and besides, we got rid of the leak, since the callback function is no longer created with each call to render. <br><br>  Future plans include ending support for IE8, which will allow the use of more advanced frontend technologies.  In addition, we have already begun work on a large-scale project for integrating with the EFS mobile platform, have begun to develop a hybrid library that allows using the same code for both the web and mobile devices using React Native. <br><br>  In the next article about the frontend of the ESF program, we will tell about how we use Redux and how it became the heart of our architecture, subscribe to our blog, so as not to miss! <br><br>  Ideas, suggestions and wishes - write, we will be happy to talk with you in the comments to the article. </div><p>Source: <a href="https://habr.com/ru/post/325916/">https://habr.com/ru/post/325916/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325904/index.html">rssh, or How to allow SCP, but disable SSH</a></li>
<li><a href="../325906/index.html">From idea to release in one bottle. Cloud Management Development Process - Visual Studio Team Services</a></li>
<li><a href="../325908/index.html">Neural networks in the fight against cancer</a></li>
<li><a href="../325910/index.html">Collection and analysis of logs for beginners</a></li>
<li><a href="../325912/index.html">Caution: high voltage, or when tech support needs support</a></li>
<li><a href="../325918/index.html">IP KVM do it yourself</a></li>
<li><a href="../325920/index.html">14 tools that will be useful for website promotion</a></li>
<li><a href="../325922/index.html">How to choose a video conferencing server</a></li>
<li><a href="../325924/index.html">April 13, Kharkiv: talk ‚ÄúMobile MMO RTS Development at Unity‚Äù</a></li>
<li><a href="../325926/index.html">Connecting Composite</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>