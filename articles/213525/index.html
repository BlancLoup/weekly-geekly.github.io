<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Adam Langley explained the reasons for the bug in iOS: an extra line of code broke all security</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Yesterday, Apple released iOS 7.0.6 security update for iPhone 4 and later, iPod touch 5th generation and iPad 2+. At the same time, a similar patch 6...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Adam Langley explained the reasons for the bug in iOS: an extra line of code broke all security</h1><div class="post__text post__text-html js-mediator-article">  Yesterday, Apple released <a href="http://support.apple.com/kb/HT6147">iOS 7.0.6 security update</a> for iPhone 4 and later, iPod touch 5th generation and iPad 2+.  At the same time, a similar patch 6.1.6 for iPhone 3GS and iPod touch 4th generation was released. <br><br>  The update closes the vulnerability CVE-2014-1266, which allows an attacker from a "privileged position on the network" to intercept and modify packets in sessions <b>protected by SSL / TLS</b> .  We are talking about MiTM-attack with the substitution of traffic. <br><br>  In a concise explanation, Apple says that when setting up a secure connection over SSL / TLS, the system is unable to determine the authenticity of the connection.  The problem was solved by ‚Äúadding missing validation steps‚Äù. <br><a name="habracut"></a><br>  Although the laconic description is not entirely clear what particular ‚Äústages‚Äù were not enough, but we can say that there is no complete protection of the connections.  One way or another, the absence of the necessary authentication steps means that, in the past, all third-party Apple devices probably could have installed fake / modified OS updates on users' smartphones and tablets. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Today, the famous cryptographer Adam Langley published <a href="https://www.imperialviolet.org/2014/02/22/applebug.html">an article</a> with an analysis of the bug in iOS.  He drew attention to the <a href="https://gist.github.com/alexyakoubian/9151610/revisions">difference</a> in the OS X 10.8.5 (Security-55179.13) and 10.9 (Security-55471) code, where the same bug was probably fixed. <br><br>  Actually, here it is. <br><br><pre><code class="hljs vbscript">static OSStatus
SSLVerifySignedServerKeyExchange(SSLContext *ctx, bool isRsa, SSLBuffer signedParams,
                                 uint8_t *signature, UInt16 signatureLen)
{
	OSStatus        <span class="hljs-built_in"><span class="hljs-built_in">err</span></span>;
	...

	<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-built_in"><span class="hljs-built_in">err</span></span> = SSLHashSHA1.update(&amp;hashCtx, &amp;serverRandom)) != <span class="hljs-number"><span class="hljs-number">0</span></span>)
		<span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> fail;
	<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-built_in"><span class="hljs-built_in">err</span></span> = SSLHashSHA1.update(&amp;hashCtx, &amp;signedParams)) != <span class="hljs-number"><span class="hljs-number">0</span></span>)
		<span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> fail;
		<span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> fail;
	<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-built_in"><span class="hljs-built_in">err</span></span> = SSLHashSHA1.final(&amp;hashCtx, &amp;hashOut)) != <span class="hljs-number"><span class="hljs-number">0</span></span>)
		<span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> fail;
	... </code></pre><br>
fail:<br>
<pre><code class="hljs kotlin">	SSLFreeBuffer(&amp;signedHashes);
	SSLFreeBuffer(&amp;hashCtx);
	<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> err;
}</code></pre><br>
  <a href="">  Apple</a>.<br>
<br>
     <code>goto fail</code> .        <code>if</code>,         .  ,       ,   <code>goto fail</code>.  <code>err</code>   ,     SHA1        ¬´¬ª.<br>
<br>
       <a href="https://tools.ietf.org/html/rfc5246">ServerKeyExchange</a>,     DHE  ECDHE     .  : ¬´  ,      ,    ,    ¬ª.    Apple,        ,    .     :     ,      ,     !   ,  ,   ,       . <br>
<br>
, ,     iOS  7.0.5   OS X  10.9.1 .</div><p>Source: <a href="https://habr.com/ru/post/213525/">https://habr.com/ru/post/213525/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../213515/index.html">Cooking IndexedDB</a></li>
<li><a href="../213517/index.html">Neovim: a modern clone of the Vim text editor</a></li>
<li><a href="../213519/index.html">Setting up centralized logging with LogAnalyzer and Rsyslog</a></li>
<li><a href="../213521/index.html">The increase in budgetary places in IT specialties in universities of the Russian Federation in the 2015-2016 academic year</a></li>
<li><a href="../213523/index.html">DdTypograph 2.0b snippet on EMT lib 3.2 (MODX Evo)</a></li>
<li><a href="../213527/index.html">The history of game consoles in advertising. Part 1: From Magnavox Odyssey to Super Nintendo</a></li>
<li><a href="../213529/index.html">Challenge for $ 500. Part two, about money</a></li>
<li><a href="../213531/index.html">Vsem Pro Server or VPS Large-Scale Testing</a></li>
<li><a href="../213537/index.html">Encrypted communication tunnel via VK (RSA + GreaseMonkey)</a></li>
<li><a href="../213539/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ97 (February 16 - 22, 2014)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>