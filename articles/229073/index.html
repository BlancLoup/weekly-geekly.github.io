<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cisco telemetry telemetry against cyber threats</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cyber ‚Äã‚ÄãThreat Defense (CTD) can detect and block complex attacks, including zero-day attacks, confidential information leaks and botnets. These are n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cisco telemetry telemetry against cyber threats</h1><div class="post__text post__text-html js-mediator-article">  Cyber ‚Äã‚ÄãThreat Defense (CTD) can detect and block complex attacks, including zero-day attacks, confidential information leaks and botnets.  These are new mechanisms to combat advanced threats using network activity analysis, which will be revealed in an article on the example of OpenSSL HeartBleed. <br><br>  The solution correlates and analyzes network telemetry collected by intelligent network equipment (in particular, switches, routers and Cisco firewalls), does not require the installation of agents on workstations and servers, and is able to scale for distributed networks of any size. <br><br><img width="470" height="295" src="https://habrastorage.org/getpro/habr/post_images/631/dfc/17f/631dfc17f2c94e5eef89b98666018dd9.png"><br><a name="habracut"></a><br><h2>  New approaches to detect attacks </h2><br>  The traditional detection of attacks at the network level involves the collection and analysis of network traffic on a specific set of signatures that correspond to known attacks.  This requires sensors (IDS / IPS) in key areas of the network that attempt to identify known bad patterns in network traffic.  But for a number of reasons, this approach is no longer relevant in our time: first, signatures are helpless against zero-day attacks and advanced methods of disguising malicious code and control channels of botnets.  Secondly, modern targeted attacks (APT) are able to ‚Äúbypass‚Äù the traditional perimeter of the network, on which sensors are traditionally installed, and act from within the network.  Internal networking between workstations and servers is usually out of sight of IDS / IPS.  Since the installation of dedicated sensors within all network segments and the monitoring of each work station is a technically difficult and financially costly task. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For about 10 years, new approaches to identifying attacks have been developed in the industry by analyzing the behavior and anomalies of network traffic.  In short, the behavior analysis systems reveal the known "bad behavior" of devices on the network, analyzing the network interaction.  Elementary examples of this behavior are network scanning or opening a large number of TCP sessions. <br><br>  Anomalies analysis reveals significant deviations of network device traffic from the ‚Äúnormal‚Äù traffic profile for a given device or group of devices.  Anomalies analysis assumes availability of training and statistical analysis for building and updating the ‚Äúnormal‚Äù traffic profile.  Examples of anomalies are a sudden increase in the Internet traffic of a workstation or a change in the structure of traffic (for example, an increase in encrypted SSL traffic) in comparison with the usual daily metrics for a given workstation.  To identify bad behavior and anomalies in most cases, it is enough to analyze the main traffic parameters (telemetry) and there is no need to scrutinize the contents of each packet, as IPS does. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/784/1b0/19b/7841b019b98631882a2715d67e0a7726.png"><br><br>  Each of these approaches has its own advantages and limitations: <br><br><img width="513" height="173" src="https://habrastorage.org/getpro/habr/post_images/2ac/09b/4a2/2ac09b4a293e9d65bcd0e4469fc35ab5.png"><br><br>  The analysis of behavior and anomalies has much in common with each other and often these approaches are used together.  Protection systems that are built on these principles are called Network Behavior Anomaly Detection (NBAD).  It should be noted that NBAD systems do not replace, but complement traditional IDS / IPS in terms of detecting complex attacks and can be used together.  IDS / IPS focuses on perimeter protection and critical network points.  NBAD systems ‚Äúpenetrate the eye‚Äù deep into the entire network, collecting telemetry from network infrastructure devices and security devices. <br><br><h2>  NetFlow is a valuable source of security telemetry </h2><br>  NetFlow network protocol is an excellent source of information for security tasks.  NetFlow was originally proposed by Cisco for network traffic accounting and monitoring as early as the 1990s.  NetFlow collected statistics of network streams passing through the network infrastructure.  A stream is a set of packets that pass in the same direction and have common parameters: <br><br><ul><li>  Source / Destination Address </li><li>  Source / destination port for UDP and TCP </li><li>  Message Type and Code for ICMP, </li><li>  IP protocol number </li><li>  Network interface </li><li>  IP Type of Service. </li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/445/192/03c/44519203c6fba0e810d304a14bb2d3a4.png"><br><br>  Over the past twenty years, NetFlow has been standardized as the IETF standard (IPFIX protocol) and has received many versions and extensions.  NetFlow learned how to collect detailed granular statistics about traffic patterns, packet sizes and characteristics, fragmentation, and more.  Information about applications can be added to NetFlow if DPI (Deep Packet Analysis) is enabled on network devices.  Thus, using NetFlow, you can identify more than 1000 applications and, for example, differentiate normal web traffic from Skype or P2P file sharing sites on port 80.  NetFlow statistics can be supplemented with information about the compliance of the flow of policies on the firewall, the content of the HTTP URL and other information of the application layer. Thus, the information obtained from NetFlow can be successfully used to analyze network behavior and identify security anomalies. <br><br>  Another difference NetFlow - is the breadth of traffic grip.  NetFlow is supported on all Cisco routers (including ISR G2 and ASR), Cisco ASA firewalls, and Catalyst 2960-X, 3560, 3750-X, 3850, 4500, 6500, and Nexus 7000 switches. Most recently, NetFlow support also appeared on server network interfaces Cisco UCS, which allows you to collect server traffic telemetry and virtual machine traffic.  NetFlow and IPFIX are also supported by many other vendors and Open-Source products. <br><br>  Thus, the NetFlow protocol can collect telemetry and provide visibility of attacks on all parts of the network - from the access level and data center to the remote branch office.  In fact, NetFlow allows you to look into the "behavior" of a separate workstation and server without the need to install a software agent using only the infrastructure functionality. <br><br>  NetFlow can count every packet it processes by providing a detailed analysis of all traffic.  This distinguishes NetFlow from similar protocols such as sFlow, which are able to collect only aggregated statistics (sampled flow), analyzing every nth packet.  Aggregated and full NetFlow can be compared with reading each page of the book and attentive page reading.  Aggregated statistics gives a quick look at traffic, but worse for security tasks.  Full NetFlow provides a comprehensive overview of network activity from a security point of view. <br><br><h2>  Cisco cyber defense solution </h2><br>  It is on the NetFlow protocol that the Cisco Cyber ‚Äã‚ÄãThreat Defense (CTD) cyber threat defense solution is based.  The solution consists of several components: <br><br><ol><li>  network infrastructure (switches, routers, firewalls) with support for NetFlow protocol, </li><li>  Lancope StealthWatch network traffic analysis system </li><li>  Optional Cisco Identity Services Engine (ISE) that adds context information. </li></ol><br><br>  The StealthWatch product is developed by Lancope in partnership with Cisco and is one of the oldest systems on the NBAD market.  StealthWatch and ISE are available in both hardware and virtual device formats. <br><br>  At the initial stage in Cyber ‚Äã‚ÄãThreat Defense it is necessary to describe the zones that make up the organization‚Äôs network.  Such zones can be: <br><br><ul><li>  the local network, </li><li>  branches, </li><li>  workstations integrated by destination or location </li><li>  servers grouped by available services and applications, etc. </li></ul><br><br>  Zones can be nested in each other - for example, a data center zone, which includes zones for applications (web, mail servers, DNS servers, ERP).  The web server zone, in turn, is divided into zones of external and internal web servers. <br><br>  The more accurate the segmentation of the network into zones, the more accurate the solution will be able to analyze the telemetry and device behavior.  CTD may suggest the likely assignment of devices and the ownership of devices in a particular zone.  For example, if the server is the source of web traffic, you will be asked to assign this server to a group of web servers. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/084/e21/025/084e21025823fd3b801dbc484949a95e.png"><br><br>  At the next stage, CTD collects NetFlow telemetry from the network infrastructure and builds network behavior profiles for zones and individual network devices.  The initial self-study and adjustment takes place in the first 7 days, for the next 28 days the profile of normal behavior (baseline) is created.  Profiles automatically adapt as traffic patterns gradually change. <br>  If traffic deviates significantly from normal or ‚Äúbad‚Äù behavior, a notification of a potential security incident will occur.  When registering an incident, the key indicators are the numerical values: <br><br><ul><li>  The alarm index - the Concern Index (CI) - an indicator that a particular host is the source of unacceptable or abnormal activity; </li><li>  Target Index - Target Index (TI) - an indicator that the host is a possible target of an attack or anomalous activity; </li><li>  File Sharing Index (FSI) - tracks potential P2P activity. </li></ul><br><br>  These indices are calculated for all network hosts that are monitored by CTD, taking into account dozens of traffic parameters.  The indices make it possible to track how abnormal the behavior of the hosts and the confidence of the system in the seriousness and reliability of this anomaly.  Also, indexes allow prioritizing incident investigations.  The higher the index value, the more dangerous the incident. <br><br>  We give an example from life.  If a bystander rings the doorbell and then reports that he had the wrong address, then there is no particular reason to worry.  But if a passerby knocked on the tenth door in the same way, this would be a cause for concern.  Thus, the concern index is 10. <br>  Cyber ‚Äã‚ÄãThreat Defense comes in the same way - if the indexes exceed the threshold value, the corresponding alarm is generated.  The system has a large number of standard policies for generating alarms and it is possible to create custom policies that describe unacceptable activity from the point of view of a particular organization. <br><br><h2>  Add context </h2><br>  In the work of the decision context is important.  The NetFlow protocol usually operates with IP addresses and port numbers.  Knowledge of the context allows Cyber ‚Äã‚ÄãThreat Defense to understand: <br><br><ol><li>  which user and device is hidden by this or that IP address, </li><li>  which application is using this port </li><li>  what is the reputation of the IP address or domain name and whether the Internet host was noticed earlier in the unlawful activity (for example, in the work of the botnet). </li></ol><br><br>  Thus, it becomes possible to ‚Äúcolor‚Äù faceless information about IP addresses and ports, providing it with context, allowing you to more accurately and efficiently respond to security incidents. <br><br>  Information about users and devices is gathered through the integration of CTD with the Cisco Identity Services Engine, which has intelligent mechanisms for identifying device types and user names on the network. <br><br>  Reputation data of Internet hosts is obtained in real time from the cloud-based reputation database.  This database in particular has dynamic information about active botnet control centers. <br><br>  When the threshold value is reached, the CTD can perform a predetermined action.  For example, issue a command to the firewall to block the suspicious activity of a specific host or block the switch port.  Commands can be given automatically or semi-automatically (after confirmation by the administrator).  The system has pre-installed scripts for routers and firewalls of different vendors, and it is also possible to create custom scripts. <br><br><h2>  What are we protecting from? </h2><br>  Cyber ‚Äã‚ÄãThreat Defense can be used in different security scenarios to protect against more diverse attacks. <br>  In particular, CTD can detect and help block the following types of attacks and anomalies affecting information security: <br><br><ol><li>  spreading malicious code and virus outbreaks, </li><li>  botnet activity, </li><li>  DDoS attacks </li><li>  network intelligence, </li><li>  unauthorized access to resources, </li><li>  unauthorized data accumulation </li><li>  data breach attempts </li><li>  the use of prohibited applications (such as P2P, IP telephony), </li><li>  unauthorized installation of services (for example, a website), </li><li>  violation of access policies and identification of gaps in the ITU configuration. </li></ol><br><br><img src="https://habrastorage.org/getpro/habr/post_images/06d/fca/68e/06dfca68eecc19fe9ebe242d41374a36.png"><br><br>  CTD is also an excellent tool for auditing information security, allowing you to check whether a network behaves as planned when setting up firewalls, IPS, and network infrastructure. <br><br>  And, of course, Cyber ‚Äã‚ÄãThreat Defense can assist in the investigation of cyber incidents, the study of the propagation of malicious code and attack vectors.  Since information is stored on all network flows and sessions, it is possible to find out with whom and how a suspicious host has interacted at a certain point in time in the past. <br><br>  Consider the mechanisms of Cyber ‚Äã‚ÄãThreat Defense on the example of the high-profile vulnerability OpenSSL HeartBleed. <br>  The difficulty in identifying HearBlead was that, if the attacker correctly exploited the vulnerability, there would be no traces of the exploit in the web server logs.  Also, SSL encryption makes it difficult to differentiate between normal and malicious transactions by request content and signatures.  Therefore, to identify attempts to exploit the vulnerability, it is necessary to focus on the characteristics of the size of SSL requests and responses of the web server. <br><br>  If you look at the system report with attempts to exploit the HeartBleed vulnerability on a test system, you can see two features of these transactions. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ee/f4d/0ce/9eef4d0cee64943802a62fdd5d5426f5.png"><br><br>  First, the ratio of the size of the client request and response is approximately 4.8%.  Secondly, attacks aimed at HeartBleed are likely to create sessions with a longer lifetime.  Each Heartbleed transaction returns a response to the attacker with the contents of a small piece of memory of the attacked web server.  In order to obtain information of interest (SSL private keys or passwords), an attacker will have to repeat transactions many times and the user session will most likely last hours.  CTD has a built-in mechanism for detecting such long-lived sessions (Suspect Long Flow). <br><br>  Thus, using CTD, you can identify suspicious web transactions.  Since NetFlow's network telemetry is usually stored for several months, it is also possible to find attacks that occurred in the past before the official publication of the vulnerability.  Most importantly, to identify such attacks, you do not need to update signatures and the solution is able to find attacks from a ‚Äúzero‚Äù day from the appearance of a vulnerability or exploit. <br><br><img width="600" height="300" src="https://habrastorage.org/getpro/habr/post_images/afa/a32/d54/afaa32d5445daa79b3d9234c3834802e.png"><br><br>  NetFlow is a great source of incident information, but not the only one.  The development of Cisco Cyber ‚Äã‚ÄãThreat Defense is moving along the path of integration into the solution of additional sources of information - IPS SourceFire network, Cisco Advanced Malware Protection, email and web content filtering systems, cloud intelligence.  The breadth of events, together with advanced processing and correlation technologies, will allow you to more accurately and quickly respond to the changing landscape of threats.  Due to the limited size of the article, we focused only on the functionality of Cyber ‚Äã‚ÄãThreat Defense in terms of security.  In fact, the CTD solution can also be very useful for IT administrators to monitor the network activity of users, monitor the use of network resources, analyze application performance and QoS.  More on this in the following articles. <br><br>  More information about the solution can be found at Cisco: <br><br><ol><li>  <a href="http://cs.co/9005YUvW">Cisco Cyber ‚Äã‚ÄãThreat Defense Solution: Get a complete picture of the latest hidden network threats</a> </li><li>  <a href="http://cs.co/9005YUaR">Cisco Cyber ‚Äã‚ÄãThreat Defense Solution</a> </li><li>  <a href="http://cs.co/9008YUae">Cisco Threat Defense</a> </li><li>  <a href="http://cs.co/9004Ysin">Cisco Security Products</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/229073/">https://habr.com/ru/post/229073/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../229061/index.html">Want an adventure - work as a field engineer</a></li>
<li><a href="../229063/index.html">Python came in 1st place for teaching programming in US universities</a></li>
<li><a href="../229065/index.html">The history of special effects in cinema</a></li>
<li><a href="../229069/index.html">Linux Foundation introduced the first release of the OS for the car</a></li>
<li><a href="../229071/index.html">We give animation life</a></li>
<li><a href="../229077/index.html">NASA funds the development of plasma "parachutes"</a></li>
<li><a href="../229079/index.html">Review epitaph of Samsung Gear Live</a></li>
<li><a href="../229081/index.html">Work with Workflow in Cisco UCS Director</a></li>
<li><a href="../229083/index.html">How to manage cloud resources with Python? We raise clusters on demand through several lines of code</a></li>
<li><a href="../229085/index.html">How Software Engineering differs from Computer Science</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>