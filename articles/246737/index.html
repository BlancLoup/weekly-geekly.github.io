<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Play and control sounds in Unity 3D (Sound complete event, Play in edit mode)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A small but useful csharp script will be attached to this article, and it will be shown how to use it. 
 The reason for writing the script was that th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Play and control sounds in Unity 3D (Sound complete event, Play in edit mode)</h1><div class="post__text post__text-html js-mediator-article">  A small but useful csharp script will be attached to this article, and it will be shown how to use it. <br>  The reason for writing the script was that there was a need to set up and test sound effects without starting the project scene.  And also in tracking the main replay events. <br><br>  The script works in the same way as in PlayMode and in EditMode, and allows you to: <br>  1. Play the sound with the necessary delay and track the start of playback. <br>  2. Track the end of the sound, including every moment of the completion of looped playback. <br>  3. Track unplanned end of sound reproduction. <br>  4. Use the event to track and change parameters during playback. <br><a name="habracut"></a><br>  To reproduce sound, static methods are used: <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> SoundTrack </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlaySound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AudioClip clip, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> volume = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> pitch = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> loopTime = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> delayTime = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> SoundTrack </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlaySound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameObject target, AudioClip clip, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> volume = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> pitch = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> loopTime = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> delayTime = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span></span><span class="hljs-function">)</span></span>;</code> </pre> <br>  These methods return an instance of the SoundTrack class to which you can later attach the necessary events.  The first method creates a GameObject on the scene, the second adds the SoundTrack and AudioSource components to the specified GameObject. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The parameters volume and pitch do not need to be presented. <br><br>  loopTime - can be used to set the time in seconds, which will last the playback cycle.  If set to 0, the sound will play only once, if set to float.PositiveInfinity, the sound will play indefinitely. <br>  delayTime is the delay before the sound is played in seconds. <br><blockquote>  Note: <br>  After loopTime, the first method will delete the GameObject created for the sound, the second method will only remove the components created for the sound. <br></blockquote><br>  So, the simplest example of code to play sound in the game. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> AudioClip testSound; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { SoundTrack.PlaySound (testSound); }</code> </pre><br>  And to play sound in the editor. <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">MenuItem(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"MyMenu/TestSound #F1"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestSound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ AudioClip[] clips=Resources.FindObjectsOfTypeAll&lt;AudioClip&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(clips==<span class="hljs-literal"><span class="hljs-literal">null</span></span>||clips.Length==<span class="hljs-number"><span class="hljs-number">0</span></span>){ Debug.LogError(<span class="hljs-string"><span class="hljs-string">"No clips in the resources!"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } SoundTrack.PlaySound(clips[<span class="hljs-number"><span class="hljs-number">0</span></span>]); }</code> </pre><br><br>  Now you can try to figure out the events.  I think for clarity, it is better to immediately take an example for the editor, since in the game mode everything works in a similar way. <br><br>  This example starts with the SHIFT + F1 key combination, and shows how to use events. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEditor; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SoundTrackTest</span></span> : <span class="hljs-title"><span class="hljs-title">Editor</span></span> { [MenuItem(<span class="hljs-string"><span class="hljs-string">"MyMenu/TestSound #F1"</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestSound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ clips=Resources.FindObjectsOfTypeAll&lt;AudioClip&gt;(); Debug.Log(<span class="hljs-string"><span class="hljs-string">"clips "</span></span> + clips.Length); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(clips==<span class="hljs-literal"><span class="hljs-literal">null</span></span>||clips.Length==<span class="hljs-number"><span class="hljs-number">0</span></span>){ Debug.LogError(<span class="hljs-string"><span class="hljs-string">"No clips in the resources!"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } rePlayCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; StartNextSound (<span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> AudioClip[] clips; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rePlayCount=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">StartNextSound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> timePosition</span></span></span><span class="hljs-function">)</span></span>{ SoundTrack track=SoundTrack.PlaySound(clips[Random.Range(<span class="hljs-number"><span class="hljs-number">0</span></span>,clips.Length<span class="hljs-number"><span class="hljs-number">-1</span></span>)]); rePlayCount++; <span class="hljs-comment"><span class="hljs-comment">//    track.start_action += soundStartEvent; //     track.processing += soundProcessEvent; //        //    ,    track.complete_action += soundCompleteEvent; //      track.destroy_action += soundDestroyEvent; if(timePosition&gt;0){ //      ,   track.setTimePosition (timePosition); } } static void soundStartEvent(SoundTrack track){ Debug.Log("Sound Start event!"); } static void soundProcessEvent(SoundTrack track){ track.volume = track.playing_time % 1f; } static void soundCompleteEvent(SoundTrack track, float offset){ Debug.Log("Sound Complete event! "+offset); } static void soundDestroyEvent(SoundTrack track, bool atEndOfSound, float offset){ Debug.Log("Sound Destroy event! "+offset); //          // atEndOfSound   false          //          .. if(atEndOfSound){ //           // offset -      //     track.setTimePosition    //          //      ,      if(rePlayCount&lt;4){ StartNextSound (offset); } } } }</span></span></code> </pre><br>  In order for the example to work, this script must be placed in the Editor folder, as well as having at least one sound file in the project resources.  If you need a test in a running project, you can simply transfer the code to the Start function from the TestSound function, and if necessary, make all the properties and methods non-static. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ clips=Resources.FindObjectsOfTypeAll&lt;AudioClip&gt;(); Debug.Log(<span class="hljs-string"><span class="hljs-string">"clips "</span></span> + clips.Length); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(clips==<span class="hljs-literal"><span class="hljs-literal">null</span></span>||clips.Length==<span class="hljs-number"><span class="hljs-number">0</span></span>){ Debug.LogError(<span class="hljs-string"><span class="hljs-string">"No clips in the resources!"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } rePlayCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; StartNextSound (<span class="hljs-number"><span class="hljs-number">0</span></span>); }</code> </pre><br>  This event is triggered directly at the beginning of the sound playback. <br><br><pre> <code class="cs hljs">track.start_action += soundStartEvent; <span class="hljs-comment"><span class="hljs-comment">//   </span></span></code> </pre><br>  Those.  if delayTime is&gt; 0, it will not work when creating a sound, but when you start playback. <br><br>  This event can be useful in some cases. <br><br><pre> <code class="cs hljs">track.processing += soundProcessEvent; <span class="hljs-comment"><span class="hljs-comment">//    </span></span></code> </pre><br>  For example, you can set different events for the music and effects, and adjust the volume of all the music in the game with one variable and the other with all the effects.  And then add to the effects and music another event, in which you can already adjust the speed of their playback, if the game has a Slow Motion effect. <br>  In this example, the sound should change the volume for each second. <br><br><pre> <code class="cs hljs">track.complete_action += soundCompleteEvent; <span class="hljs-comment"><span class="hljs-comment">//    ,   </span></span></code> </pre><br>  This event can be useful in a situation where loopTime exceeds the length of the sound file, this means that the sound will be played cyclically.  In this case, the event will be triggered at the moment when the sound starts anew.  <i><b>In other cases, the call of this event is not guaranteed.</b></i> <br><br><pre> <code class="cs hljs">track.destroy_action += soundDestroyEvent; <span class="hljs-comment"><span class="hljs-comment">//     </span></span></code> </pre><br>  This event will work in 2 cases.  The first case is when sound playback is completed, after loopTime expires or during one-time playback.  The second case is the unrelated sound script from the stage (for example, manually removing an object from the scene hierarchy).  You can distinguish one case from another using the atEndOfSound parameter; if it is false, then this is just the second case. <br><br>  In the second case, we will no longer have access to the GameObject and sound components. <br><br>  If, for example, you need to consistently play several melodies and create a feeling of continuous sound, you can try to do it as shown in the example in the soundDestroyEvent function. <br><br>  In addition, the script has parameters that may be needed: <br><ul><li>  time_position - the playback position of the audio file, from 0 to the length of the file; </li><li>  life_time - time from the beginning of the sound playback; </li><li>  playing_time - time spent on sound reproduction, does not take into account pauses; </li><li>  loop_time - the time that the sound will play; </li><li>  delay_time - time delay before playback; </li><li>  startTime - the moment the sound starts playing; </li><li>  created_time - the moment of sound creation (startTime-delay_time). </li></ul><br><br>  All the time is calculated relative to <a href="http://docs.unity3d.com/ScriptReference/Time-realtimeSinceStartup.html">Time.realtimeSinceStartup</a> . <br><br>  <a href="https://yadi.sk/d/foSMr3ErdcGpJ">Here</a> you can download the script itself and the above example. <br><br>  If the keyboard shortcut does not work in the example, you can find the TestSound item in the menu. <br><br>  If Unity does not find the sound in the resources, you just need to select it (see the settings of the audio file). </div><p>Source: <a href="https://habr.com/ru/post/246737/">https://habr.com/ru/post/246737/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../246725/index.html">Brand management mistakes</a></li>
<li><a href="../246727/index.html">Massage and IT</a></li>
<li><a href="../246729/index.html">Earnings in the system of mobile motivation AppBonus. Organizational model of the platform and its use</a></li>
<li><a href="../246733/index.html">One-page store on Phalcon PHP + AngularJS. Bug work</a></li>
<li><a href="../246735/index.html">How an online store uses video to increase sales</a></li>
<li><a href="../246739/index.html">Product Design Digest, December 2014</a></li>
<li><a href="../246745/index.html">Top10 non-standard IT security events 2014</a></li>
<li><a href="../246747/index.html">Whence there is a complex number</a></li>
<li><a href="../246751/index.html">IBM Cloud helps improve diabetic care</a></li>
<li><a href="../246753/index.html">LinkMeUp. Issue number 22. STC Metrotek. Software development for FPGA chips. Ethernet measuring equipment</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>