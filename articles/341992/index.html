<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Optimization of securities portfolio using Python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 In the financial market, there are usually several types of securities: government securities, municipal bonds, corporate shares, etc. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Optimization of securities portfolio using Python</h1><div class="post__text post__text-html js-mediator-article"><h3>  Introduction </h3><br>  In the financial market, there are usually several types of securities: government securities, municipal bonds, corporate shares, etc. <br><br>  If a market participant has free money, then they can be taken to a bank and receive interest or buy securities on them and receive additional income.  But which bank to take?  What securities to buy? <br><br>  Low-risk securities tend to be low profitable, and high-yield securities tend to be more risky.  Economic science can give some recommendations for resolving this issue, but for this it is necessary to have appropriate software, preferably with a simple interface and free. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Software for portfolio analysis should work with yield matrices and solve non-linear programming problems with constraints in the form of strict and non-strict inequalities.  The symbolic solution in Python of some types of nonlinear programming problems I have already considered in the publication [1].  However, it is impossible to apply the methods proposed in this publication for the analysis of the securities portfolio due to limitations in the form of strict inequalities. <br><br>  The purpose of this publication is to develop methods for optimizing securities portfolios using the scipy.optimize library.  It was necessary to investigate and apply in programming such little-known possibilities of this library, as the introduction of additional restrictions to the objective function [2]. <br><a name="habracut"></a><br><h3>  Statement of the problem of an optimal Markowitz portfolio </h3><br>  Consider the general task of allocating capital that a market participant wants to spend on acquiring securities.  The goal of the investor is to invest money so as to preserve his capital, and, if possible, increase it. <br><br>  A set of securities held by a market participant is called its portfolio.  Portfolio value is the total value of all its constituent securities.  If today its value is P, and in a year it will be equal to P, then it is natural to call (P'-P) / P yield of the portfolio in percent per annum.  Portfolio returns are returns per unit of value. <br><br>  Let <b>xi</b> be the share of capital spent on the purchase of securities of the i-th type.  All allocated capital is taken as a unit.  Let <b>di</b> be the yield in percent of the annual securities of the i-th type per one monetary unit. <br><br>  Yield fluctuates over time, so we will consider it a random variable.  Let <b>mi</b> , <b>ri</b> be the expected average return and the standard deviation, called risk.  By <b>CVij</b> we denote the covariance of yields of securities of the i - and j - th types. <br><br>  Every owner of a securities portfolio faces a dilemma: you want more efficiency and less risk.  However, since ‚Äúone cannot catch two birds with one stone‚Äù, it is necessary to make a certain choice between efficiency and risk. <br><br><h3>  Markovits optimal portfolio model, which provides minimal risk and a given return </h3><br>  Such a model in the form of a system of equations and inequalities has the form [3]: <br><br><img src="https://habrastorage.org/webt/lb/_v/uh/lb_vuhptnlubjwu8-lch2cjca8m.png"><br><br>  It is necessary to determine: x1, x2 ... xn. <br><br>  The initial data for the calculation is the yield matrix of securities of the following form (filled example of the matrix in the program listing): <br><br><img src="https://habrastorage.org/webt/3y/ri/qz/3yriqzyilrstxdy2w86efhmstg8.png"><br><br>  To implement the minimal risk model in Python, the following development steps must be performed: <br>  1. Determination of average stock returns 1-6: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sympy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.optimize <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> minimize <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sympy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.optimize <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> minimize <span class="hljs-string"><span class="hljs-string">"D-   (   )"</span></span> D=np.array([[<span class="hljs-number"><span class="hljs-number">9.889</span></span>, <span class="hljs-number"><span class="hljs-number">11.603</span></span>,<span class="hljs-number"><span class="hljs-number">11.612</span></span>, <span class="hljs-number"><span class="hljs-number">12.721</span></span>,<span class="hljs-number"><span class="hljs-number">11.453</span></span>,<span class="hljs-number"><span class="hljs-number">12.102</span></span>], [<span class="hljs-number"><span class="hljs-number">12.517</span></span>, <span class="hljs-number"><span class="hljs-number">13.25</span></span>,<span class="hljs-number"><span class="hljs-number">12.947</span></span>,<span class="hljs-number"><span class="hljs-number">12.596</span></span>,<span class="hljs-number"><span class="hljs-number">12.853</span></span>,<span class="hljs-number"><span class="hljs-number">13.036</span></span>], [<span class="hljs-number"><span class="hljs-number">12.786</span></span>, <span class="hljs-number"><span class="hljs-number">12.822</span></span>,<span class="hljs-number"><span class="hljs-number">15.447</span></span>,<span class="hljs-number"><span class="hljs-number">14.452</span></span>,<span class="hljs-number"><span class="hljs-number">15.143</span></span>,<span class="hljs-number"><span class="hljs-number">16.247</span></span>], [<span class="hljs-number"><span class="hljs-number">11.863</span></span>, <span class="hljs-number"><span class="hljs-number">12.114</span></span>,<span class="hljs-number"><span class="hljs-number">13.359</span></span>,<span class="hljs-number"><span class="hljs-number">13.437</span></span>,<span class="hljs-number"><span class="hljs-number">11.913</span></span>,<span class="hljs-number"><span class="hljs-number">15.300</span></span>], [<span class="hljs-number"><span class="hljs-number">11.444</span></span>, <span class="hljs-number"><span class="hljs-number">13.292</span></span>,<span class="hljs-number"><span class="hljs-number">13.703</span></span>,<span class="hljs-number"><span class="hljs-number">11.504</span></span>,<span class="hljs-number"><span class="hljs-number">13.406</span></span>,<span class="hljs-number"><span class="hljs-number">15.255</span></span>], [<span class="hljs-number"><span class="hljs-number">14.696</span></span>, <span class="hljs-number"><span class="hljs-number">15.946</span></span>,<span class="hljs-number"><span class="hljs-number">16.829</span></span>,<span class="hljs-number"><span class="hljs-number">17.698</span></span>,<span class="hljs-number"><span class="hljs-number">16.051</span></span>,<span class="hljs-number"><span class="hljs-number">17.140</span></span>]],np.float64) d= np.zeros([<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>])<span class="hljs-comment"><span class="hljs-comment">#     m,n= D.shape#  for j in np.arange(0,n): for i in np.arange(0,m): d[j,0]=d[j,0]+D[i,j] d=d/n print("   1-6 : \n %s"%d)</span></span></code> </pre> <br>  <b>We get:</b> <br><br>  Average stock returns 1-6: <br><br>  [[12.19916667] <br>  [13.17116667] <br>  [13.98283333] <br>  [13.73466667] <br>  [13.46983333] <br>  [14.84666667]] <br><br>  2. Construction of the covariance matrix (m = n = 6). <br><br>  CV = np.zeros ([m, n]) <br>  for i in np.arange (0, m): <br>  for j in np.arange (0, n): <br>  x = np.array (D [0: m, j]). T <br>  y = np.array (D [0: m, i]). T <br>  X = np.vstack ((x, y)) <br>  CV [i, j] = round (np.cov (x, y, ddof = 0) [1,0], 3) <br>  print (‚ÄúCovariance matrix CV: \ n% s‚Äù% CV) <br><br>  <b>We get:</b> <br><br>  CV covariance matrix: <br><br>  [[2.117 1.773 2.256 2.347 2.077 1.975] <br>  [1.773 1.903 1.941 2.049 1.888 1.601] <br>  [2.256 1.941 2.901 2.787 2.701 2.761] <br>  [2.347 2.049 2.787 3.935 2.464 2.315] <br>  [2.077 1.888 2.701 2.464 2.723 2.364] <br>  [1.975 1.601 2.761 2.315 2.364 3.067]] <br><br>  3. Symbolic definition of the function to determine the variance of the portfolio yield (risk function). <br><br><pre> <code class="python hljs">x1,x2,x3,x4,x5,x6,x7,x8,p,q,w=symbols(<span class="hljs-string"><span class="hljs-string">' x1 x2 x3 x4 x5 x6 x7 x8 pqw'</span></span> , float= <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) v1=Matrix([x1,x2,x3,x4,x5,x6]) v2=v1.T w=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> np.arange(<span class="hljs-number"><span class="hljs-number">0</span></span>,m): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> j <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> np.arange(<span class="hljs-number"><span class="hljs-number">0</span></span>,n): w=w+v1[p.subs({p:i}),q.subs({q:<span class="hljs-number"><span class="hljs-number">0</span></span>})]*v2[p.subs({p:<span class="hljs-number"><span class="hljs-number">0</span></span>}),q.subs({q:j})]*CV[p.subs({p:i}),q.subs({q:j})] print(<span class="hljs-string"><span class="hljs-string">"   ( ):\n%s"</span></span>%w)</code> </pre> <br>  <b>We get:</b> <br><br>  Portfolio return variance (risk function): <br><br>  2.117 * x1 ** 2 + 3.546 * x1 * x2 + 4.512 * x1 * x3 + 4.694 * x1 * x4 + 4.154 * x1 * x5 + 3.95 * x1 * x6 + 1.903 * x2 ** 2 + 3.882 * x2 * x3 + 4.098 * x2 * x4 + 3.776 * x2 * x5 + 3.202 * x2 * x6 + 2.901 * x3 ** 2 + 5.574 * x3 * x4 + 5.402 * x3 * x5 + 5.522 * x3 * x6 + 3.935 * x4 ** 2 + 4.928 * x4 * x5 + 4.63 * x4 * x6 + 2.723 * x5 ** 2 + 4.728 * x5 * x6 + 3.067 * x6 ** 2 <br><br>  4. Determining the optimal stock portfolio for minimum risk and return mp = 13.25 <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">objective</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span><span class="hljs-comment"><span class="hljs-comment">#  x1=x[0];x2=x[1];x3=x[2]; x4=x[3]; x5=x[4]; x6=x[5] return 2.117*x1**2 + 3.546*x1*x2 + 4.512*x1*x3 + 4.694*x1*x4 + 4.154*x1*x5 + 3.95*x1*x6\ + 1.903*x2**2 + 3.882*x2*x3 + 4.098*x2*x4 + 3.776*x2*x5 + 3.202*x2*x6 + 2.901*x3**2 \ + 5.574*x3*x4 + 5.402*x3*x5 + 5.522*x3*x6 + 3.935*x4**2 + 4.928*x4*x5 + 4.63*x4*x6 \ + 2.723*x5**2 + 4.728*x5*x6 + 3.067*x6**2 def constraint1(x):#    -1 return x[0]+x[1]+x[2]+x[3]+x[4]+x[5]-1.0 def constraint2(x): #   return d[0,0]*x[0] + d[1,0]*x[1] + d[2,0]*x[2] + d[3,0]*x[3] + d[4,0]*x[4]+ d[5,0]*x[5] - 13.25 x0=[1,1,0,0,0,1]#        b=(0.0,1.0)#   x       bnds=(b,b,b,b,b,b)#    () con1={'type':'ineq','fun':constraint1} #    () con2={'type':'eq','fun':constraint2} #    () cons=[con1,con2]#    () sol=minimize(objective,x0,method='SLSQP',\ bounds=bnds,constraints=cons)#     print("   -%s"%str(round(sol.fun,3))) print(" 1 - %s, - %s"%(round(sol.x[0],3),round(d[0,0]*sol.x[0],3))) print(" 2 - %s, - %s"%(round(sol.x[1],3),round(d[1,0]*sol.x[1],3))) print(" 3 - %s, - %s"%(round(sol.x[2],3),round(d[2,0]*sol.x[2],3))) print(" 4 - %s, - %s"%(round(sol.x[3],3),round(d[3,0]*sol.x[3],3))) print(" 5 - %s, - %s"%(round(sol.x[4],3),round(d[4,0]*sol.x[4],3))) print(" 6 - %s, - %s"%(round(sol.x[5],3),round(d[5,0]*sol.x[5],3)))</span></span></code> </pre><br>  <b>We get:</b> <br><br>  Minimum risk function -1.846 <br>  Share 1 share- 0.141, yield- 1.721 <br>  Share 2 share- 0.73, yield- 9.616 <br>  Share 3 share- 0.0, profitability- 0.0 <br>  Share 4 share- 0.0, yield- 0.0 <br>  Share 5 share- 0.0, profitability- 0.0 <br>  Share 6 share- 0.129, yield- 1.914 <br><br>  <b>Conclusion:</b> <br><br>  Profitable are 1,2,6 shares.  This is part of the answer to the questions posed at the beginning of the publication. <br><br><div class="spoiler">  <b class="spoiler_title">Full listing of the program to minimize the risk of the Markowitz method for a given yield</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sympy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.optimize <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> minimize <span class="hljs-string"><span class="hljs-string">"D-  (   )"</span></span> D=np.array([[<span class="hljs-number"><span class="hljs-number">9.889</span></span>, <span class="hljs-number"><span class="hljs-number">11.603</span></span>,<span class="hljs-number"><span class="hljs-number">11.612</span></span>, <span class="hljs-number"><span class="hljs-number">12.721</span></span>,<span class="hljs-number"><span class="hljs-number">11.453</span></span>,<span class="hljs-number"><span class="hljs-number">12.102</span></span>], [<span class="hljs-number"><span class="hljs-number">12.517</span></span>, <span class="hljs-number"><span class="hljs-number">13.25</span></span>,<span class="hljs-number"><span class="hljs-number">12.947</span></span>,<span class="hljs-number"><span class="hljs-number">12.596</span></span>,<span class="hljs-number"><span class="hljs-number">12.853</span></span>,<span class="hljs-number"><span class="hljs-number">13.036</span></span>], [<span class="hljs-number"><span class="hljs-number">12.786</span></span>, <span class="hljs-number"><span class="hljs-number">12.822</span></span>,<span class="hljs-number"><span class="hljs-number">15.447</span></span>,<span class="hljs-number"><span class="hljs-number">14.452</span></span>,<span class="hljs-number"><span class="hljs-number">15.143</span></span>,<span class="hljs-number"><span class="hljs-number">16.247</span></span>], [<span class="hljs-number"><span class="hljs-number">11.863</span></span>, <span class="hljs-number"><span class="hljs-number">12.114</span></span>,<span class="hljs-number"><span class="hljs-number">13.359</span></span>,<span class="hljs-number"><span class="hljs-number">13.437</span></span>,<span class="hljs-number"><span class="hljs-number">11.913</span></span>,<span class="hljs-number"><span class="hljs-number">15.300</span></span>], [<span class="hljs-number"><span class="hljs-number">11.444</span></span>, <span class="hljs-number"><span class="hljs-number">13.292</span></span>,<span class="hljs-number"><span class="hljs-number">13.703</span></span>,<span class="hljs-number"><span class="hljs-number">11.504</span></span>,<span class="hljs-number"><span class="hljs-number">13.406</span></span>,<span class="hljs-number"><span class="hljs-number">15.255</span></span>], [<span class="hljs-number"><span class="hljs-number">14.696</span></span>, <span class="hljs-number"><span class="hljs-number">15.946</span></span>,<span class="hljs-number"><span class="hljs-number">16.829</span></span>,<span class="hljs-number"><span class="hljs-number">17.698</span></span>,<span class="hljs-number"><span class="hljs-number">16.051</span></span>,<span class="hljs-number"><span class="hljs-number">17.140</span></span>]],np.float64) d= np.zeros([<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>])<span class="hljs-comment"><span class="hljs-comment">#     m,n= D.shape#  for j in np.arange(0,n): for i in np.arange(0,m): d[j,0]=d[j,0]+D[i,j] d=d/n print("    : \n %s"%d) CV= np.zeros([m,n]) for i in np.arange(0,m): for j in np.arange(0,n): x=np.array(D[0:m,j]).T y=np.array(D[0:m,i]).T X = np.vstack((x,y)) CV[i,j]=round(np.cov(x,y,ddof=0)[1,0],3) print("  CV: \n %s"%CV) x1,x2,x3,x4,x5,x6,x7,x8,p,q,w=symbols(' x1 x2 x3 x4 x5 x6 x7 x8 pqw' , float= True) v1=Matrix([x1,x2,x3,x4,x5,x6]) v2=v1.T w=0 for i in np.arange(0,m): for j in np.arange(0,n): w=w+v1[p.subs({p:i}),q.subs({q:0})]*v2[p.subs({p:0}),q.subs({q:j})]*CV[p.subs({p:i}),q.subs({q:j})] print("   ( ):\n%s"%w) def objective(x):#  x1=x[0];x2=x[1];x3=x[2]; x4=x[3]; x5=x[4]; x6=x[5] return 2.117*x1**2 + 3.546*x1*x2 + 4.512*x1*x3 + 4.694*x1*x4 + 4.154*x1*x5 + 3.95*x1*x6\ + 1.903*x2**2 + 3.882*x2*x3 + 4.098*x2*x4 + 3.776*x2*x5 + 3.202*x2*x6 + 2.901*x3**2 \ + 5.574*x3*x4 + 5.402*x3*x5 + 5.522*x3*x6 + 3.935*x4**2 + 4.928*x4*x5 + 4.63*x4*x6 \ + 2.723*x5**2 + 4.728*x5*x6 + 3.067*x6**2 def constraint1(x):#    -1 return x[0]+x[1]+x[2]+x[3]+x[4]+x[5]-1.0 def constraint2(x): #   return d[0,0]*x[0] + d[1,0]*x[1] + d[2,0]*x[2] + d[3,0]*x[3] + d[4,0]*x[4]+ d[5,0]*x[5] - 13.25 x0=[1,1,0,0,0,1]#        b=(0.0,1.0)#   x       bnds=(b,b,b,b,b,b)#    () con1={'type':'ineq','fun': constraint1} #    () con2={'type':'eq','fun': constraint2} #    () cons=[con1,con2]#    () sol=minimize(objective,x0,method='SLSQP',\ bounds=bnds,constraints=cons)#     print("   -%s"%str(round(sol.fun,3))) print(" 1 - %s, - %s"%(round(sol.x[0],3),round(d[0,0]*sol.x[0],3))) print(" 2 - %s, - %s"%(round(sol.x[1],3),round(d[1,0]*sol.x[1],3))) print(" 3 - %s, - %s"%(round(sol.x[2],3),round(d[2,0]*sol.x[2],3))) print(" 4 - %s, - %s"%(round(sol.x[3],3),round(d[3,0]*sol.x[3],3))) print(" 5 - %s, - %s"%(round(sol.x[4],3),round(d[4,0]*sol.x[4],3))) print(" 6 - %s, - %s"%(round(sol.x[5],3),round(d[5,0]*sol.x[5],3)))</span></span></code> </pre> <br></div></div><br><h3>  The optimal Markowitz portfolio of maximum return and given, (acceptable) risk </h3><br>  The system of equations and inequalities is: <br><br><img src="https://habrastorage.org/webt/co/mr/iw/comriwydck6jluv0dzzoftt7mbq.png"><br><br><div class="spoiler">  <b class="spoiler_title">Optimize your maximum yield portfolio for a given risk in Python</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.optimize <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> minimize d=np.array( [[ <span class="hljs-number"><span class="hljs-number">12.19916667</span></span>], [ <span class="hljs-number"><span class="hljs-number">13.17116667</span></span>], [ <span class="hljs-number"><span class="hljs-number">13.98283333</span></span>], [ <span class="hljs-number"><span class="hljs-number">13.73466667</span></span>], [ <span class="hljs-number"><span class="hljs-number">13.46983333</span></span>], [ <span class="hljs-number"><span class="hljs-number">14.84666667</span></span>]]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">constraint2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> x1=x[<span class="hljs-number"><span class="hljs-number">0</span></span>];x2=x[<span class="hljs-number"><span class="hljs-number">1</span></span>];x3=x[<span class="hljs-number"><span class="hljs-number">2</span></span>]; x4=x[<span class="hljs-number"><span class="hljs-number">3</span></span>]; x5=x[<span class="hljs-number"><span class="hljs-number">4</span></span>]; x6=x[<span class="hljs-number"><span class="hljs-number">5</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2.117</span></span>*x1**<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">3.546</span></span>*x1*x2 + <span class="hljs-number"><span class="hljs-number">4.512</span></span>*x1*x3 + <span class="hljs-number"><span class="hljs-number">4.694</span></span>*x1*x4 + <span class="hljs-number"><span class="hljs-number">4.154</span></span>*x1*x5 \ + <span class="hljs-number"><span class="hljs-number">3.95</span></span>*x1*x6 + <span class="hljs-number"><span class="hljs-number">1.903</span></span>*x2**<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">3.882</span></span>*x2*x3 + <span class="hljs-number"><span class="hljs-number">4.098</span></span>*x2*x4 + <span class="hljs-number"><span class="hljs-number">3.776</span></span>*x2*x5 + <span class="hljs-number"><span class="hljs-number">3.202</span></span>*x2*x6 \ + <span class="hljs-number"><span class="hljs-number">2.901</span></span>*x3**<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">5.574</span></span>*x3*x4 + <span class="hljs-number"><span class="hljs-number">5.402</span></span>*x3*x5 + <span class="hljs-number"><span class="hljs-number">5.522</span></span>*x3*x6 + <span class="hljs-number"><span class="hljs-number">3.935</span></span>*x4**<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">4.928</span></span>*x4*x5 \ + <span class="hljs-number"><span class="hljs-number">4.63</span></span>*x4*x6 + <span class="hljs-number"><span class="hljs-number">2.723</span></span>*x5**<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">4.728</span></span>*x5*x6 + <span class="hljs-number"><span class="hljs-number">3.067</span></span>*x6**<span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-number"><span class="hljs-number">-2</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">constraint1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x[<span class="hljs-number"><span class="hljs-number">0</span></span>]+x[<span class="hljs-number"><span class="hljs-number">1</span></span>]+x[<span class="hljs-number"><span class="hljs-number">2</span></span>]+x[<span class="hljs-number"><span class="hljs-number">3</span></span>]+x[<span class="hljs-number"><span class="hljs-number">4</span></span>]+x[<span class="hljs-number"><span class="hljs-number">5</span></span>]<span class="hljs-number"><span class="hljs-number">-1.0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">objective</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -(<span class="hljs-number"><span class="hljs-number">12.199</span></span>*x[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-number"><span class="hljs-number">13.171</span></span>*x[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">13.983</span></span>*x[<span class="hljs-number"><span class="hljs-number">2</span></span>] + <span class="hljs-number"><span class="hljs-number">13.735</span></span>*x[<span class="hljs-number"><span class="hljs-number">3</span></span>] + <span class="hljs-number"><span class="hljs-number">13.47</span></span>*x[<span class="hljs-number"><span class="hljs-number">4</span></span>]+ <span class="hljs-number"><span class="hljs-number">14.847</span></span>*x[<span class="hljs-number"><span class="hljs-number">5</span></span>] ) x0=[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>] b=(<span class="hljs-number"><span class="hljs-number">0.0</span></span>,<span class="hljs-number"><span class="hljs-number">1.0</span></span>) bnds=(b,b,b,b,b,b) con1={<span class="hljs-string"><span class="hljs-string">'type'</span></span>:<span class="hljs-string"><span class="hljs-string">'ineq'</span></span>,<span class="hljs-string"><span class="hljs-string">'fun'</span></span>:constraint1} con2={<span class="hljs-string"><span class="hljs-string">'type'</span></span>:<span class="hljs-string"><span class="hljs-string">'eq'</span></span>,<span class="hljs-string"><span class="hljs-string">'fun'</span></span>:constraint2} cons=[con1,con2] sol=minimize(objective,x0,method=<span class="hljs-string"><span class="hljs-string">'SLSQP'</span></span>,\ bounds=bnds,constraints=cons) print(<span class="hljs-string"><span class="hljs-string">"   -%s"</span></span>%str(round(sol.fun,<span class="hljs-number"><span class="hljs-number">3</span></span>))) print(<span class="hljs-string"><span class="hljs-string">" 1 - %s, - %s"</span></span>%(round(sol.x[<span class="hljs-number"><span class="hljs-number">0</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>),round(d[<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*sol.x[<span class="hljs-number"><span class="hljs-number">0</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>))) print(<span class="hljs-string"><span class="hljs-string">" 2 - %s, - %s"</span></span>%(round(sol.x[<span class="hljs-number"><span class="hljs-number">1</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>),round(d[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*sol.x[<span class="hljs-number"><span class="hljs-number">1</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>))) print(<span class="hljs-string"><span class="hljs-string">" 3 - %s, - %s"</span></span>%(round(sol.x[<span class="hljs-number"><span class="hljs-number">2</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>),round(d[<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*sol.x[<span class="hljs-number"><span class="hljs-number">2</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>))) print(<span class="hljs-string"><span class="hljs-string">" 4 - %s, - %s"</span></span>%(round(sol.x[<span class="hljs-number"><span class="hljs-number">3</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>),round(d[<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*sol.x[<span class="hljs-number"><span class="hljs-number">3</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>))) print(<span class="hljs-string"><span class="hljs-string">" 5 - %s, - %s"</span></span>%(round(sol.x[<span class="hljs-number"><span class="hljs-number">4</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>),round(d[<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*sol.x[<span class="hljs-number"><span class="hljs-number">4</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>))) print(<span class="hljs-string"><span class="hljs-string">" 6 - %s, - %s"</span></span>%(round(sol.x[<span class="hljs-number"><span class="hljs-number">5</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>),round(d[<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*sol.x[<span class="hljs-number"><span class="hljs-number">5</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>)))</code> </pre><br></div></div><br>  Part of the listing does not require explanation, since everything is described in detail in the previous example.  However, there are differences.  The average yield column d and the condition function def constraint2 (x) are taken from the previous example, and in the previous example it was a minimum risk function.  In addition, to determine the maximum, before defining the value of a new objective function ‚Äî def objective (x), a minus sign is set. <br><br>  <b>Result:</b> <br><br>  Maximum yield function --14.1 <br>  Share 1 share- 0.0, yield- 0.0 <br>  Share 2 share- 0.72, yield- 9.489 <br>  Share 3 share- 0.0, profitability- 0.0 <br>  Share 4 share- 0.0, yield- 0.0 <br>  Share 5 share- 0.0, profitability- 0.0 <br>  Share 6 share- 0.311, yield- 4.611 <br><br>  Shares 2.6 are profitable.  But this is not the only result of optimization with scipy optimize minimize minimize.  I decided to compare the results with the solution of the same problem using Mathcad tools and this is what I got: <br><br><img src="https://habrastorage.org/webt/qm/v4/-s/qmv4-sbxutld8u9u0scxngbbhri.png"><br><br>  Mathcad points to the same numbers 2.6 profitable shares, but the shares are different.  In Python 0.720,0.311 in Mathcad 0.539, 0.461, with different values ‚Äã‚Äãof the maximum yield, respectively, 14.1 and 13.9.  In order to finally make sure which program calculates the optimum correctly, we substitute the values ‚Äã‚Äãof shares obtained in Python in Mathcad, we get: <br><br><img src="https://habrastorage.org/webt/uu/ta/qh/uutaqhbtwsy_uu7cvj_epi9braw.png"><br><br>  Conclusion: Python has an optimum function, and therefore shares and profitability is calculated more accurately than when using Mathcad. <br><br><h3>  Formation of an optimal securities portfolio using the Tobin model </h3><br><br>  Tobin's Minimum Risk Portfolio: <br><br><img src="https://habrastorage.org/webt/de/d6/yv/ded6yvaocpflry5iobgz26fqm7o.png"><br><br>  where d0 is efficiency without risky papers; <br>  x0 is the share of capital invested in risk-free securities; <br>  xi, xj - the share of capital invested in the securities of the i-th and j-th types; <br>  di is the mathematical expectation (arithmetic average) of the yield of the i-th security; <br>  vij is the correlation moment between the efficiency of the papers of the ith and jth species. <br><br>  We select the share of capital of a given return, set the total yield, taking for example the following numerical values ‚Äã‚Äãx0 = 0.3, d0 = 10, dp = 12.7. <br><br><div class="spoiler">  <b class="spoiler_title">Implement Tobin's Minimal Risk Python Portfolio</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.optimize <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> minimize d=np.array( [[ <span class="hljs-number"><span class="hljs-number">12.19916667</span></span>], [ <span class="hljs-number"><span class="hljs-number">13.17116667</span></span>], [ <span class="hljs-number"><span class="hljs-number">13.98283333</span></span>], [ <span class="hljs-number"><span class="hljs-number">13.73466667</span></span>], [ <span class="hljs-number"><span class="hljs-number">13.46983333</span></span>], [ <span class="hljs-number"><span class="hljs-number">14.84666667</span></span>]]) x00=<span class="hljs-number"><span class="hljs-number">0.3</span></span>;d0=<span class="hljs-number"><span class="hljs-number">10</span></span>;dp=<span class="hljs-number"><span class="hljs-number">12.7</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">objective</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span><span class="hljs-comment"><span class="hljs-comment">#  x1=x[0];x2=x[1];x3=x[2]; x4=x[3]; x5=x[4]; x6=x[5] return 2.117*x1**2 + 3.546*x1*x2 + 4.512*x1*x3 + 4.694*x1*x4 + 4.154*x1*x5 + 3.95*x1*x6\ + 1.903*x2**2 + 3.882*x2*x3 + 4.098*x2*x4 + 3.776*x2*x5 + 3.202*x2*x6 + 2.901*x3**2 \ + 5.574*x3*x4 + 5.402*x3*x5 + 5.522*x3*x6 + 3.935*x4**2 + 4.928*x4*x5 + 4.63*x4*x6 \ + 2.723*x5**2 + 4.728*x5*x6 + 3.067*x6**2 def constraint1(x):#    -1 return x[0]+x[1]+x[2]+x[3]+x[4]+x[5]-1.0+x00 def constraint2(x): #   return d[0,0]*x[0] + d[1,0]*x[1] + d[2,0]*x[2] + d[3,0]*x[3] + d[4,0]*x[4]+ d[5,0]*x[5] - dp+x00*d0 x0=[1,1,1,1,1,1]#        b=(-1.0,100.0)#   x       bnds=(b,b,b,b,b,b)#    () con1={'type':'ineq','fun':constraint1} #    () con2={'type':'eq','fun':constraint2} #    () cons=[con1,con2]#    () sol=minimize(objective,x0,method='SLSQP',\ bounds=bnds,constraints=cons)#     print("   : %s"%str(round(sol.fun,3))) print(" 1 - %s, : %s"%(round(sol.x[0],3),round(d[0,0]*sol.x[0],3))) print(" 2 - %s, : %s"%(round(sol.x[1],3),round(d[1,0]*sol.x[1],3))) print(" 3 - %s, : %s"%(round(sol.x[2],3),round(d[2,0]*sol.x[2],3))) print(" 4 - %s, : %s"%(round(sol.x[3],3),round(d[3,0]*sol.x[3],3))) print(" 5 - %s, : %s"%(round(sol.x[4],3),round(d[4,0]*sol.x[4],3))) print(" 6 - %s, : %s"%(round(sol.x[5],3),round(d[5,0]*sol.x[5],3)))</span></span></code> </pre> <br></div></div><br>  We get: <br><br>  Minimum risk function: 0.728 <br>  Share 1 share- -0.023, yield: -0.286 <br>  Share 2 share- 0.666, yield: 8.778 <br>  Share 3 share- -1.0, yield: -13.983 <br>  Share 4 share- 0.079, yield: 1.089 <br>  Share 5 share- 0.3, yield: 4.048 <br>  Share 6 share- 0.677, yield: 10.054 <br><br>  Profitable shares are 2,4,5,6. <br><br><h3>  Tobin's portfolio of maximum efficiency </h3><br><img src="https://habrastorage.org/webt/jh/h2/kc/jhh2kcnfhkquh12ykc-httj1vfi.png"><br><br>  where rp is the portfolio risk. <br><br><div class="spoiler">  <b class="spoiler_title">Implement Tobin's portfolio of maximum efficiency in Python</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.optimize <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> minimize x00=<span class="hljs-number"><span class="hljs-number">0.8</span></span>;d0=<span class="hljs-number"><span class="hljs-number">10</span></span>;rp=<span class="hljs-number"><span class="hljs-number">0.07</span></span> d=np.array( [[ <span class="hljs-number"><span class="hljs-number">12.19916667</span></span>], [ <span class="hljs-number"><span class="hljs-number">13.17116667</span></span>], [ <span class="hljs-number"><span class="hljs-number">13.98283333</span></span>], [ <span class="hljs-number"><span class="hljs-number">13.73466667</span></span>], [ <span class="hljs-number"><span class="hljs-number">13.46983333</span></span>], [ <span class="hljs-number"><span class="hljs-number">14.84666667</span></span>]]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">constraint2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> x1=x[<span class="hljs-number"><span class="hljs-number">0</span></span>];x2=x[<span class="hljs-number"><span class="hljs-number">1</span></span>];x3=x[<span class="hljs-number"><span class="hljs-number">2</span></span>]; x4=x[<span class="hljs-number"><span class="hljs-number">3</span></span>]; x5=x[<span class="hljs-number"><span class="hljs-number">4</span></span>]; x6=x[<span class="hljs-number"><span class="hljs-number">5</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2.117</span></span>*x1**<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">3.546</span></span>*x1*x2 + <span class="hljs-number"><span class="hljs-number">4.512</span></span>*x1*x3 + <span class="hljs-number"><span class="hljs-number">4.694</span></span>*x1*x4 + <span class="hljs-number"><span class="hljs-number">4.154</span></span>*x1*x5 \ + <span class="hljs-number"><span class="hljs-number">3.95</span></span>*x1*x6 + <span class="hljs-number"><span class="hljs-number">1.903</span></span>*x2**<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">3.882</span></span>*x2*x3 + <span class="hljs-number"><span class="hljs-number">4.098</span></span>*x2*x4 + <span class="hljs-number"><span class="hljs-number">3.776</span></span>*x2*x5 + <span class="hljs-number"><span class="hljs-number">3.202</span></span>*x2*x6 \ + <span class="hljs-number"><span class="hljs-number">2.901</span></span>*x3**<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">5.574</span></span>*x3*x4 + <span class="hljs-number"><span class="hljs-number">5.402</span></span>*x3*x5 + <span class="hljs-number"><span class="hljs-number">5.522</span></span>*x3*x6 + <span class="hljs-number"><span class="hljs-number">3.935</span></span>*x4**<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">4.928</span></span>*x4*x5 \ + <span class="hljs-number"><span class="hljs-number">4.63</span></span>*x4*x6 + <span class="hljs-number"><span class="hljs-number">2.723</span></span>*x5**<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">4.728</span></span>*x5*x6 + <span class="hljs-number"><span class="hljs-number">3.067</span></span>*x6**<span class="hljs-number"><span class="hljs-number">2</span></span>-rp <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">constraint1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x[<span class="hljs-number"><span class="hljs-number">0</span></span>]+x[<span class="hljs-number"><span class="hljs-number">1</span></span>]+x[<span class="hljs-number"><span class="hljs-number">2</span></span>]+x[<span class="hljs-number"><span class="hljs-number">3</span></span>]+x[<span class="hljs-number"><span class="hljs-number">4</span></span>]+x[<span class="hljs-number"><span class="hljs-number">5</span></span>]<span class="hljs-number"><span class="hljs-number">-1.0</span></span>+x0 <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">objective</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -(d[<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*x[<span class="hljs-number"><span class="hljs-number">0</span></span>] + d[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*x[<span class="hljs-number"><span class="hljs-number">1</span></span>] + d[<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*x[<span class="hljs-number"><span class="hljs-number">2</span></span>] + d[<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*x[<span class="hljs-number"><span class="hljs-number">3</span></span>] + d[<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*x[<span class="hljs-number"><span class="hljs-number">4</span></span>]+ d[<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*x[<span class="hljs-number"><span class="hljs-number">5</span></span>]+x00*d0) x0=[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>] b=(<span class="hljs-number"><span class="hljs-number">-1.0</span></span>,<span class="hljs-number"><span class="hljs-number">100.0</span></span>) bnds=(b,b,b,b,b,b) con1={<span class="hljs-string"><span class="hljs-string">'type'</span></span>:<span class="hljs-string"><span class="hljs-string">'ineq'</span></span>,<span class="hljs-string"><span class="hljs-string">'fun'</span></span>:constraint1} con2={<span class="hljs-string"><span class="hljs-string">'type'</span></span>:<span class="hljs-string"><span class="hljs-string">'eq'</span></span>,<span class="hljs-string"><span class="hljs-string">'fun'</span></span>:constraint2} cons=[con1,con2] sol=minimize(objective,x0,method=<span class="hljs-string"><span class="hljs-string">'SLSQP'</span></span>,\ bounds=bnds,constraints=cons) print(<span class="hljs-string"><span class="hljs-string">"   : %s"</span></span>%str(round(sol.fun,<span class="hljs-number"><span class="hljs-number">3</span></span>))) print(<span class="hljs-string"><span class="hljs-string">" 1 - %s, : %s"</span></span>%(round(sol.x[<span class="hljs-number"><span class="hljs-number">0</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>),round(d[<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*sol.x[<span class="hljs-number"><span class="hljs-number">0</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>))) print(<span class="hljs-string"><span class="hljs-string">" 2 - %s, : %s"</span></span>%(round(sol.x[<span class="hljs-number"><span class="hljs-number">1</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>),round(d[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*sol.x[<span class="hljs-number"><span class="hljs-number">1</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>))) print(<span class="hljs-string"><span class="hljs-string">" 3 - %s, : %s"</span></span>%(round(sol.x[<span class="hljs-number"><span class="hljs-number">2</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>),round(d[<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*sol.x[<span class="hljs-number"><span class="hljs-number">2</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>))) print(<span class="hljs-string"><span class="hljs-string">" 4 - %s, : %s"</span></span>%(round(sol.x[<span class="hljs-number"><span class="hljs-number">3</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>),round(d[<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*sol.x[<span class="hljs-number"><span class="hljs-number">3</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>))) print(<span class="hljs-string"><span class="hljs-string">" 5 - %s, : %s"</span></span>%(round(sol.x[<span class="hljs-number"><span class="hljs-number">4</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>),round(d[<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*sol.x[<span class="hljs-number"><span class="hljs-number">4</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>))) print(<span class="hljs-string"><span class="hljs-string">" 6 - %s, - %s"</span></span>%(round(sol.x[<span class="hljs-number"><span class="hljs-number">5</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>),round(d[<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]*sol.x[<span class="hljs-number"><span class="hljs-number">5</span></span>],<span class="hljs-number"><span class="hljs-number">3</span></span>)))</code> </pre> <br></div></div><br>  We get: <br><br>  Maximum profitability function: -11.657 <br>  Share 1 share- 0.09, yield: 1.096 <br>  Share 2 share- 0.196, yield: 2.583 <br>  Share 3 share- -1.0, yield: -13.983 <br>  Share 4 share- 0.113, yield: 1.552 <br>  Share 5 share- 0.411, yield: 5.538 <br>  Share 6 share- 0.463, yield 6.872 <br><br>  Profitable shares are 1,2,4,5. <br><br><h3>  Findings: </h3><br>  For the first time, Python solved the problem of optimizing a securities portfolio using Markowitz and Tobin models. <br>  The comparative example with the Mathcad math package shows the benefits of the scipy optimize minimize minimize library. <br><br>  <b>References:</b> <br><br><ol><li>  <a href="https://habrahabr.ru/post/340364/">Character solution of nonlinear programming problems</a> </li><li>  <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html">scipy.optimize.minimize</a> </li><li>  <a href="https://studopedia.ru/11_31924_postanovka-zadachi-ob-optimalnom-portfele.html">Statement of the optimal portfolio problem</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/341992/">https://habr.com/ru/post/341992/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../341982/index.html">Laboratory: welcome to C ++ User Group Meetup</a></li>
<li><a href="../341984/index.html">Olympiad tasks in industrial programming. Part 1</a></li>
<li><a href="../341986/index.html">Integrating the equations of motion</a></li>
<li><a href="../341988/index.html">Model-Update-View pattern and dependent types</a></li>
<li><a href="../341990/index.html">How Badoo is gaining developers</a></li>
<li><a href="../341996/index.html">Installing SSL certificate on Zimbra</a></li>
<li><a href="../341998/index.html">Board game design</a></li>
<li><a href="../342000/index.html">We authorize resources in the REST service</a></li>
<li><a href="../342002/index.html">A little story about the `yes` command in Unix</a></li>
<li><a href="../342004/index.html">Tatiana Puchkova, AlfaStrakhovanie: ‚ÄúI personally promise to pay attention to every startup‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>