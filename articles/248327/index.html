<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Autonomous security and surveillance system on the Raspberry PI</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Having played with the Raspberry Pi and the camera for it, I thought about its practical application. Just by this time, the need for an autonomous mo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Autonomous security and surveillance system on the Raspberry PI</h1><div class="post__text post__text-html js-mediator-article">  Having played with the Raspberry Pi and the camera for it, I thought about its practical application.  Just by this time, the need for an autonomous monitoring system with security functions for the dacha had matured (the neglected children of the neighborhood burned a bath at the dacha as a result of alcohol gathering and smoking). <br><br>  Perhaps my experience and work ( <a href="https://drive.google.com/open%3Fid%3D0B3hH5_ZXlbvwS055bFl1MURrRE0%26authuser%3D0">an SD image with all customized software</a> ) will be useful. <br><br>  Video on the ground did not shoot.  For the winter, I did not dare to leave it at an unguarded dacha with roads covered with snow. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Some pieces of work in greenhouse conditions: <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/b1atUzltB_0%3Ffeature%3Doembed&amp;xid=17259,15700019,15700186,15700191,15700253&amp;usg=ALkJrhheLeIOwhDWgx8QC5Sb7N4YvrZ6Dg" frameborder="0" allowfullscreen=""></iframe><br><a name="habracut"></a><br>  The project was not customized.  He did it exclusively for himself and his own pleasure.  From working with video offline via a modem refused immediately.  Video via modem in mode even in 3G is not serious. <br><br>  Project input restrictions: <br><ol><li>  Low-speed Internet via GSM modem (MTS).  At best, 2G; </li><li>  No host with ‚Äúwhite IP‚Äù; </li><li>  Only readily available components. </li></ol><br><br>  Input requirements that I formulated for myself: <br><ol><li>  Autonomous work with overload after power failure and software failures; </li><li>  Turntable (horizontal + vertical) with a circular view; </li><li>  Long-focus lens; </li><li>  External autonomous sensors with a radio channel; </li><li>  Automatic shooting zone sensor; </li><li>  Sending Alarm SMS; </li><li>  Sending Alarm + low / medium resolution photo to e-mail; </li><li>  Background high resolution photo upload to a cloud drive; </li><li>  Background upload logs to a cloud drive; </li><li>  Management via e-mail (sending bash scripts and getting the results of their execution); </li><li>  Management via SMS.  Call predefined scripts.  For example, turn the camera and take a picture; </li><li>  Forwarding SMS arriving on the modem by e-mail; </li><li>  Additional functionality when staying nearby, within sustainable WiFi (15-20m): </li></ol><br><ul><li>  Functions WiFi router with the distribution of the Internet; </li><li>  Access via ftp and ssh console; </li><li>  Web video stream from camera. </li></ul><br><br>  With the exception of the circular review, all the other requirements were implemented. <br><br><img src="https://habrastorage.org/files/754/e38/0a2/754e380a21bf495f99d49a0e21c023ee.jpg"><br><br><h3>  Circular horizontal view </h3><br>  Fully circular review failed.  Experiments have shown that supplying current through a pair of ‚Äúbrushes from a drill electric motor + current collection from foiled polystyrene material‚Äù is clearly not the best idea.  Approximately within 2-5 of a 360-degree rotation, a power failure occurs and a reboot occurs.  Adding high capacity electrolyte did not help much.  As a result, I put two limiters on the rotation angle of 270 degrees and recorded directly without a current collector. <br><br>  I did not make a photo of the construction with brushes, but I experimented with it a lot.  In the photo you can understand how it looked originally (brushes and collector rings made of foiled PCB were removed). <br>  Experiment with other types of current collectors did not.  For my purposes and the installation location, a 270 degree view is sufficient (building angle). <br><br>  <u>Conclusion: the</u> ‚Äúcarbon brush + copper plane‚Äù current collection is only suitable for cases when the short contact loss is not critical and where the contact will be restored by inertia. <br><br><img src="https://habrastorage.org/files/8c9/af0/052/8c9af0052fce411991d456337c6f37eb.jpg"><br><br><h3>  Swivel platform. </h3><br>  For turning involved cheap stepper motors.  According to the passport, they work from 12V, but as practice has shown, and at 19V they do not heat up in the ‚Äú1 minute after 3 minutes without holding mode‚Äù mode.  The UN2003 driver copes with current at 19V even in the SO16 (SMD) package without overheating.  With regular UN2003 drivers in a DIP package, which are sold in a set for the step-drivers, there should be no problems at all. <br>  The rotation is smooth and completely silent. <br><br>  Involute gears with a 1mm module, if anyone is interested, they are very well cut on a CNC machine with a 1mm mill from fiberglass. <br><br><img src="https://habrastorage.org/files/72c/448/8de/72c4488de4af42e692d4815860f7f79c.jpg"><br><br>  The choice of stepper motors is due to the simplicity of control and positioning accuracy during autonomous operation. <br><br>  For setting to ‚Äú0‚Äù I intended to use a reed switch with a magnet, but after rejecting the circular view, I came to the conclusion that the following technology is more convenient: <br><ol><li>  Rotate the horizontal vertical and platform to the maximum angle; </li><li>  When the stop is reached, stepper motors begin to skip steps (the engines are weak and this is quite acceptable); </li><li>  At the end of the cycle of turning to maximum angles, we can assume that it has reached ‚Äú0‚Äù relative to the stops. </li></ol><br><br>  Positioning to ‚Äú0‚Äù in this way is rather slow, but still faster than loading Linux.  The Linux download speed on raspberries is simply depressing. <br><br><h3>  Power Features </h3><br>  As it has been said many times, raspberries are well VERY picky about nutrition.  I powered it and WiFi USB from the 19V 2.6A power supply (which was) from the old laptop via the stepdown DC-DC converter.  A separate stepdown DC-DC converter was needed to power the 3G modem. <br><br>  It was impossible to power the modem from one converter and the board did not work, although according to the ‚ÄúChinese passport‚Äù the current of the DC-DC module should suffice.  The current in the statics of one converter is enough, but when you activate the modem, you hear how the generation in the voltage converter module fails, going into the audio range, and the output voltage cuts off with the Linux reboot. <br><br><h3>  Camera </h3><br>  Native camera Rasberry Pi c replacement lens.  The lens came from the module MT9D111, bought a long time on e-bay for experiments.  The matrix was not useful, and the lens went perfectly.  Together with the standard lens, the IR-filter built into it also appeared.  What is even good, since the new lens is marked with IR.  The colors in the pictures are somewhat distorted (pinkish shots), but for that IR backlighting is possible. <br><br><h3>  External sensors </h3><br>  The sensor used is the PIR module on the BISS0001.  433 MHz keychain transmitter, slightly finished (one bipolar transistor and resistor) and controlled by the output from the PIR module. <br>  Experiments have shown that this combination works from 12V acid battery for at least 2 months (maybe more, I have not tried it). <br><br>  The receiver is 4-channel and is sold complete with a keychain.  Thus, 4 zones of protection are provided with the ability to make a photo of the place of operation. <br><br>  The range of the transmitter-receiver set is less than that stated by the sellers, and the reception is not stable at approximately 40 meters of direct line of sight.  Perhaps this is interference from Raspberry pi, GSM modem and / or DC-DC converters. <br>  In the summer, some nights, there were "false" triggers.  Probably on birds or bats. <br><br>  The first version of the sensor was with a separate output to activate the IR backlight.  The photo then did not, but there is nothing difficult.  Just another transistor controlled from the PIR output.  The backlight is a circular board from a 12V surveillance camera with IR LEDs. <br><br>  After the samples, the local IR illumination of the sensor area refused: <br><ol><li>  IR LED backlights are clearly visible at dusk.  Unmasks the installation location of the sensor; </li><li>  At night, the local IR backlight turned on by the PIR sensor seems to give positive feedback on IR radiation and ‚Äúmiracles‚Äù begin with the continuous response of the PIR sensor.  It is necessary to "wise" with the mutual arrangement of the sensor and the backlight.  Difficult, inconvenient and depends on the time of day. </li></ol><br><br>  The signal from the sensor: <br><ol><li>  The camera rotates by a programmatically specified angle horizontally and vertically; </li><li>  Takes low-resolution images (640x480) and a maximum resolution image (saved in tmpfs); </li><li>  A low-resolution image is sent to an e-mail; </li><li>  An SMS is sent informing you that the sensor has triggered; </li><li>  The high-resolution snapshot, in the background, is laid out on a cloud drive.  If you can not send immediately, it is saved to the archive on SD, for later sending. </li></ol><br><br><img src="https://habrastorage.org/files/451/f32/43e/451f3243efd442d89e3dbd0bd7b5d54a.jpg"><br><br><h3>  Software </h3><br>  A lot of detailed articles are devoted to the settings of a 3g modem, WiFi, etc., and I consider it irrational to repeat them. <br>  <a href="https://drive.google.com/open%3Fid%3D0B3hH5_ZXlbvwS055bFl1MURrRE0%26authuser%3D0">SD image with everything</a> <a href="https://drive.google.com/open%3Fid%3D0B3hH5_ZXlbvwS055bFl1MURrRE0%26authuser%3D0"><br></a>  <a href="https://drive.google.com/open%3Fid%3D0B3hH5_ZXlbvwS055bFl1MURrRE0%26authuser%3D0">customized software</a> . <br><br>  The file /home/pi/read.me contains links to files where you need to register your passwords. <br>  Configured to Yandex services (e-mail and cloud disk). <br>  Login / password of the console and ftp - standard: ‚Äúpi / raspberry‚Äù <br><br>  Potential room for improvement (in my opinion): <br><ol><li>  Make "/" fully readonly.  For the most part I rendered the entire entry in the files in tmpfs.  But, something that remained and was too lazy, because, in practice, the probability of damage to SD, after an abnormal power off, decreased to satisfying values; </li><li>  Hardware reset of the modem by interrupting its power supply circuit.  Maybe this is subjective, but sometimes ‚Äúon / off‚Äù helps better than software reset of the modem.  In principle, it is not difficult.  Only one field-effect transistor in the modem power circuit. </li></ol><br><br><h3>  Components </h3><br>  Standard components: <br><ol><li>  Raspberry pi + SD card from 4GB; </li><li>  Raspberry pi camera (Chinese clone); </li><li>  GSM modem - MTC 3G (ID 12d1: 1506 Huawei Technologies Co., Ltd. E398 LTE / UMTS / GSM Modem / Networkcard). </li><li>  WiFi from standard, recommended. (ID 0bda: 8176 Realtek Semiconductor Corp. RTL8188CUS 802.11n WLAN Adapter); </li><li>  Stepper motors 28BYJ-48 12V + drivers for UN2003; </li><li>  Power supply - any 12-20V at least 2A; </li><li>  Stepdown DC-DC converters - 2 pcs.  On the "Chinese" output current of at least 2A; </li><li>  The lens, if it does not suit the standard (and it is absolutely none) - any one will like it.  Objectives for surveillance cameras are for any task and wallet; </li><li>  RS232TTL-USB module for connecting the console.  In fact, only for debugging; </li><li>  Receiver card and the required number of PIR modules and transmitter sticks (fully on ebay in different versions). </li></ol><br><br>  Solder: <br><ol><li>  USB extension for modem with offset + 5V to a separate DC-DC converter; </li><li>  Level matching between GPIO 3.3V IN and receiver outputs.  For each channel - bipolar transistor + a pair of resistors.  I still set the LED for control; </li><li>  Connectors and cables to connect all this. </li></ol><br><br>  Who has a CNC machine - without problems, you can draw and cut out the body / gears.  Draw and cut can be a maximum of 3 hours.  I do not post my original drawing.  Would do the second time - would do differently and more compactly. <br><br><h3>  Conclusions from the results </h3><br>  If I needed to make a replicable industrial solution for a similar security alarm task, then I would not choose Raspberry Pi. <br><br>  Would take an OEM camera module, an STM32 type controller ... with a camera interface and an OEM GSM modem module. <br>  As for me, it is more convenient for me to do such things without OS at all or on specialized OS. <br><br>  Time to develop the functionality of a pure security alarm would take a maximum of 3-4 times more than pairing a heap of free software with redundant functionality and bringing the entire zoo to a working state. <br>  The power consumption of raspberries and fastidiousness to nutrition are simply depressing. <br><br>  And so raspberry pi toy is interesting.  But just play.  Although this is my personal opinion and I do not impose it. </div><p>Source: <a href="https://habr.com/ru/post/248327/">https://habr.com/ru/post/248327/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../248313/index.html">Normal-oriented Hemisphere SSAO for Dummies</a></li>
<li><a href="../248319/index.html">3CX Phone System 12.5 Final Release Released</a></li>
<li><a href="../248321/index.html">How to write a good demo</a></li>
<li><a href="../248323/index.html">65% discount on the seminar "Technologies and data storage systems for SMB customers" (Kiev)</a></li>
<li><a href="../248325/index.html">How to carry out an assessment on three points?</a></li>
<li><a href="../248329/index.html">Shared Hosting vs Clouds</a></li>
<li><a href="../248331/index.html">Calculate factorial on Church numbers</a></li>
<li><a href="../248333/index.html">Having trouble analyzing user behavior? Meet a newbie guide on creating an effective conversion funnel</a></li>
<li><a href="../248335/index.html">Hexapod-robot controlled from PC</a></li>
<li><a href="../248339/index.html">Regional small and medium business in IT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>