<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dollar</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For the last two years, the whole country has been closely following the dollar rate. News bulletins are full of loud reports about the dollar. Everyo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dollar</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/c52/839/265/c5283926576b4f40b2e09673f8bc00d2.jpg"><br><br>  For the last two years, the whole country has been closely following the dollar rate.  News bulletins are full of loud reports about the dollar.  Everyone is talking about the dollar.  And what if we are against the background of hot interest, let's look at how the dollar price is formed, let's see who and how trades currency?  All the results presented in this article were obtained on the basis of the official trading data full orders log (full order book) purchased on the <a href="http://moex.com/ru/orders%3Fhistoricaldata">Moscow Exchange</a> .  We will show the real trading from the inside.  In parallel, we will get acquainted with the standard methods of market analysis.  This kind of analytics costs a lot of money and a limited number of ‚Äúcompanies‚Äù can allow it. <br><br>  Java data analysis tool.  Analyzed stock instrument - <a href="http://moex.com/ru/issue/USD000UTSTOM/CETS">USDRUB_TOM</a> .  Our task is to extract curious details from the available data and try to draw certain conclusions. <br><a name="habracut"></a><br>  All over the world, foreign exchange transactions are mainly carried out on the interbank market and on specialized electronic trading platforms where the largest banks, treasuries and so on are connected.  Typical representatives of such sites FXall or Atriax. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In Russia, the currency is predominantly traded on the stock exchange, where huge amounts are held.  The share of the Moscow Exchange accounts for 45-50% of the total world trading volume for the pair USD / RUB.  This is a huge share, a few countries can boast such a share.  Therefore, the course of the Moscow Exchange, without exaggeration, is a world benchmark.  The exchange rate of the Central Bank is formed at the exchange rate, the settlement prices of futures contracts are based on exchange fixing ... Hundreds of banks are connected and trading to the foreign exchange market, the Central Bank comes out with interventions and buys the currency, exporters change the currency, the largest European and American investment companies are connected. <br><br>  Further, along the way, I will use the terms "spread" and "glass" (quotes).  Who hears for the first time, take a look. <br><div class="spoiler">  <b class="spoiler_title">The explanation on the fingers</b> <div class="spoiler_text">  Spread - the difference between the purchase and sale price.  In the exchanger, the purchase price is 75 rubles, the sale price is 80 rubles.  Here the spread is 5p. <br><br>  A glass of quotes is the entire list of buyers and sellers on the market, arranged by price.  A glass of quotes briefly and clearly describes the state of the market and looks like this.  In the terminals we usually see 10-20 price levels.  And they can be much more.  For a dollar, this is about 200-300 levels.  And in 1 second the glass can be changed tens or hundreds of times. <br><br><img src="https://habrastorage.org/files/479/542/998/47954299850b497d981646f44f95d977.jpg"><br><br>  The trading mechanism is well known to many: the newly arrived order, depending on the price, becomes a queue (in a glass).  As soon as the counter application arrives that satisfies ours, it is executed, a transaction occurs.  Otherwise, it remains in the queue.  This application can be withdrawn before it is fulfilled. <br></div></div><br>  We have on hand data on the trading process for February 2, 2016, containing all bids that are set, deleted or executed in the transaction.  They can track the life of each application.  The data is impersonal, we do not know who submitted the applications, but we see all its main parameters: time, price, volume, direction, id ... In the <a href="https://habrahabr.ru/post/276635/">previous post</a> I described in detail the format of this data. <br><br>  Let's remember what was the second of February.  Nothing special, a normal day without features and anomalies.  And so much the better. <br><br><img src="https://habrastorage.org/files/110/348/ddc/110348ddccd14848bd0162b65a5f9fa8.gif"><br><br>  Let's start with the simple.  On this day, 105 thousand transactions were made for a total of <b>504 billion ‚ÇΩ</b> .  Price movement is higher on the chart. <br><br>  <b>1. Let's see, what volumes of orders are bidders submit most often?</b>  <b>The minimum possible order amount is $ 1000 (1K $).</b> <br><br><img src="https://habrastorage.org/files/ce4/bf3/43f/ce4bf343f4444780a96c3e1525e17697.png"><br><br>  As you can see, the overwhelming majority of them trade in volumes of $ 50K and $ 100K, in the third place a million bucks ($ 1M).  Yes, it's all big.  I wonder what the picture will be for stocks or futures, where a lot of nat.  individuals?  Physicists have been admitted to the foreign exchange market relatively recently; <br>  <b>2. Orders come to the trading system.</b>  <b>And after what time they are executed?</b> <br><br><img src="https://habrastorage.org/files/6f2/40b/589/6f240b5897b84228a1b97d9bf9ea48fd.png"><br><br>  Rather smooth distribution.  Surprisingly, more than half of trades are executed in less than a second.  Here it is necessary to exclude the second participant in the transaction, because his application is executed instantly.  And even more interesting is the picture within a few milliseconds, where a very large number of transactions take place.  High frequency robots?  How do most applications get to the right place in a few milliseconds?  The question is open, there are opinions ?!  Offer. <br><br>  <b>3. Orders arrive in the trading system and are deleted by the participant.</b>  <b>So after what time are most applications filmed?</b> <br><br><img src="https://habrastorage.org/files/14f/2c0/1e2/14f2c01e27a943c083656c1eb2e15fc9.png"><br><br>  Immediately striking is the fact that an overwhelming number of applications are withdrawn in 1-2 milliseconds.  We also see that participants like whole numbers.  Peaks on the graph clearly follow with an interval of 50 milliseconds (no more, no less). <br>  I suppose that most people in the algorithms like to use integers (50, 100, 200 ...).  Then, looking intently at the spreading of the peaks, one can estimate the remoteness of the location of the bidders due to the existence of delays in the data.  If all participants were located in the colocation zone (in the same room with the trading system, microscopic delay), then we would see peaks in the form of sticks, without spreading.  Your thoughts? <br><br>  <b>4. Each transaction has an initiator: the seller or the buyer.</b>  <b>Sold more or bought more?</b> <br><br><img src="https://habrastorage.org/files/998/c4f/e75/998c4fe75d294668a33b153ccbe9c216.png"><br><br>  Data from 10:00 until closing time is 23:50.  The ratio of sellers and buyers directly depends on the price movement.  Here on the graph we see the nature of applications, i.e.  as participants indicate the price in the application. <br><br>  <b>5. What is the volume of transactions?</b> <b><br></b> <br><img src="https://habrastorage.org/files/d26/f75/28b/d26f7528b3a44f9094a2c83fac35803a.png"><br><br>  All the same $ 50K and $ 100K, also there were volumes 5K $ and 10K $. <br><br>  <b>Piece of magic code</b> <br><br>  All of the above distribution obtained by the tool HashMap.  Main couple of lines of code: <br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(mySet.containsKey(key)){ mySet.put(key, mySet.get(key)+<span class="hljs-number"><span class="hljs-number">1</span></span>); }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ mySet.put(key, <span class="hljs-number"><span class="hljs-number">1</span></span>); }</code> </pre> <br><br>  Next comes the heavy artillery.  For me, the most interesting part.  For further metrics you need to be able to build a glass of quotes.  How to build a glass, I described in the <a href="https://habrahabr.ru/post/276635/">previous article</a> with examples. <br>  Every 10 seconds we reproduced a glass of quotes and took readings.  The results in paragraphs 6 and 7. <br><br>  <b>6. Picture the depth of the market.</b>  <b>And how many goods?</b> <br><br><img src="https://habrastorage.org/files/b8a/aa1/0ce/b8aaa10ce6d94d4dbe07790234654395.png"><br><br>  The top chart is the one you want to buy.  Lower - the amount that they want to sell.  A large trade volume always moves the price up or down.  The meaning of the picture is to understand how much the transaction will shift the price by 0.5% or 1% for a certain time.  The picture makes it clear when it is better to enter the market in order to realize a large volume. <br>  Example (see top chart).  If at 12:00 we would like to sell the currency in the amount of 50M $, the price would go down by 1%.  And if the same thing was done at 14:30, the price would have left a maximum of 0.5% (here is our savings). <br><br>  <b>7. Picture the depth of the market.</b>  <b>Inverse problem</b> <br><br><img src="https://habrastorage.org/files/e0d/4c8/989/e0d4c8989c6d449ba76c143d52045a48.png"><br><br>  Gives an answer to the question: how much will the price move depending on a certain volume?  A picture for the whole trading day.  Before a large participant comes to a particular market, he first studies the data, conducting similar research.  If the market is small, there is no sense to enter. <br><br><h4>  Conclusion </h4><br>  From the historical data you can still pull a lot of interesting things.  You can study the habits of the entire ensemble of participants in certain events and improve their trading algorithms. <br><br>  Now we have an idea who and how trades currency, what volumes are spinning and at what speeds.  Felt the bottom of the dollar market. <br><br>  Well that's all.  Thank you for attention.  If there are thoughts / assumptions on any of the items, write. <br><br>  Special thanks to one good habraiser who helped with data visualization.  He promised to write a separate post on visualization on the example of financial information using Python + MatPlotLib. <br><br>  In the next part, we dive even deeper and consider some interesting situations on the market (the intervention of the Central Bank and Black Tuesday).  Any wishes ?!  I'll keep in mind the next article, let me know <br><br><img src="https://habrastorage.org/files/d77/8eb/406/d778eb4066eb443eb8e292b0788ada6f.gif"></div><p>Source: <a href="https://habr.com/ru/post/278403/">https://habr.com/ru/post/278403/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278391/index.html">Stack Overflow Architecture</a></li>
<li><a href="../278393/index.html">alter table without table locale</a></li>
<li><a href="../278395/index.html">We promote mobile applications in the AppStore and Google Play: how to use the method of featuring</a></li>
<li><a href="../278399/index.html">Grace "Grandma COBOL" Hopper</a></li>
<li><a href="../278401/index.html">JavaScript parser for treasure hunters of photographic depths</a></li>
<li><a href="../278405/index.html">Creating applications for Firebird with the use of various components and drivers: ADO.NET Entity Framework 6</a></li>
<li><a href="../278407/index.html">The key to JetBrains products for all students on Stepic.org</a></li>
<li><a href="../278409/index.html">Introduction to practical analytics, or what is common in neural networks with diet pills</a></li>
<li><a href="../278411/index.html">Authentication using Spring Security and JWT tokens</a></li>
<li><a href="../278413/index.html">Overview of synchronization primitives - mutex and cond</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>