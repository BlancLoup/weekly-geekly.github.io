<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Neural networks and character recognition</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, Habr√© has appeared, and there are also many informative articles describing the work and principle of the concept of ‚Äúneural network‚Äù, but, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Neural networks and character recognition</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/habraeffect/10/dd/10dd181079ee8ee6acc4285b546d9bf8.jpg" align="left">  Recently, Habr√© has appeared, and there are also many informative articles describing the work and principle of the concept of ‚Äúneural network‚Äù, but, unfortunately, as always, very little description and analysis of the practical results obtained or not received.  I think that many, like me, are more comfortable, easier and clearer to understand with a real example.  Therefore, in this article I will try to describe an almost step by step solution to the problem of recognizing the letters of the Latin alphabet + an example for independent research.  <a href="http://habrahabr.ru/blogs/artificial_intelligence/74865/">Recognition of numbers using a single-layer perceptron</a> has already been done, now let's look at it and teach the computer to recognize letters. <br><a name="habracut"></a><br><h1>  Our problem </h1><br>  In short, I will say that neural networks in general make it possible to solve a very large range of practical problems, in particular, recognition problems.  In most cases, the latter have a "template" character.  For example, a system that ‚Äúreads‚Äù bank checks, by efficiency, is several times greater than the operator.  In the tasks of such a plan, the use of neural networks is justified and largely saves money and resources. <br>  We will determine what we need to disassemble, understand and do.  We need to build an expert system that can recognize the letters of the Latin alphabet.  To do this, you need to understand the capabilities of neural networks (NA) and build a system that can recognize the letters of the Latin alphabet.  In detail with the theory of neural networks can be found at the links given at the end of the article.  This article does not find descriptions of the theory (mathematics) of the work of the National Assembly or the descriptions of the commands when working with MATLAB (well, only if the links are at the end of the article), this remains on your conscience.  The purpose of the article is to show and tell the application of a neural network for a practical task, show results, run into pitfalls, try to show that it is possible to squeeze out of a neural network, without going into details how it is implemented, for the rest there is specialized literature, from which everything don't run anyway. <br>  Let's try to figure out the possibilities when using a neural network with back propagation of an error in order to recognize the letters of the Latin alphabet.  We will implement the algorithm in the software environment of the MATLAB engineering math package, namely, the power of the Neural Network Toolbox will be needed. <br><br><h1>  What is given </h1><br>  It is necessary to understand the input data.  We all imagine what the letters represent, how they look on the monitor in a book, etc.  (as, for example, presented in the figure below). <br><div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/b8/2c/b82cce0efbda9b57c29ccf1fd357ad96.jpg"></div><br>  In reality, it is often necessary to work not with ideal letters, as shown above, but more often as shown below, that is, distortions are introduced in the symbols. <br><div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/da/bb/dabbad49384d3fbb9b01eba0e8d3e37a.jpg"></div><br>  Now back to the problem of image representation, understandable to the neural network.  It is clear that each letter in the image can be represented as a matrix with certain values ‚Äã‚Äãof elements that can clearly define the letter.  That is, it is convenient to formalize the representation of the Latin alphabet character by a matrix of n rows and m columns.  Each element of such a matrix can take values ‚Äã‚Äãin the range [0, 1].  Thus, the symbol A in such a formalized form will look as follows (on the left - without distortion, on the right - with distortion): <br><div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/81/a6/81a6dc83ed03d10b32d41fa33027bd76.jpg"></div><br>  Not many imagining what is happening in my head, let's proceed to implement it in MATLAB.  In this package, the Latin alphabet is already provided, there is even a demo example of working with it, but we will take only the alphabet from it.  Therefore, you can use their data, and you can even draw all the letters yourself, it is optional. <br>  MATLAB offers characters that are formalized by a matrix of 7 rows and 5 columns.  But such a matrix cannot be simply fed to the input of a neural network, for this it is necessary to collect a 35 - element vector. <br>  For compatibility with different versions and convenience, I saved the matrix of characters in the file (and so you can use the function prprob, it will load the alphabet into the workspace). <br>  It is known from theory that we need input data and output data (targets, target data) for network training.  The target vector will contain 26 elements, where one of the elements has the value 1, and all other elements are equal to 0, the element number containing the unit encodes the corresponding letter of the alphabet. <br>  To summarize, the input 35-element vector is fed to the input of the neural network, which is mapped to the corresponding letter from the 26-element output vector.  The output of the NA is the 26-element vector, in which only one element that encodes the corresponding letter of the alphabet is 1. Having dealt with the creation of the interface for working with the NA, we will proceed to its creation. <br><br><h1>  Network building </h1><br>  We construct a neural network that includes 35 inputs (because the vector consists of 35 elements) and 26 outputs (because 26 letters).  This NS is a two-layer network.  The activation function will put the logarithmic sigmoid function, which is convenient to use, because the output vectors contain elements with values ‚Äã‚Äãin the range from 0 to 1, which is then conveniently transferred to Boolean algebra.  On the hidden level, select 10 neurons (because just like that, you can any value, then check, and how many they need).  If something is not clear to you from the above written about the construction of the network, please read about it in the literature (necessary concepts if you are going to work with the National Assembly).  Schematically considered network can be represented by the following scheme: <br><div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/9c/52/9c52c0d0ee73f12f73994163ecca37c1.jpg"></div><br>  And if this is all written in the syntax of the MATLAB scripting language, we get: <br><blockquote><ol><li> <code><font color="black">S1 = 10; %      [S2,Q] = size(targets); %      (  ) P = alphabet; %  ,     %        net = newff(minmax(P), %         [S1 S2], %     {'logsig' 'logsig'}, %   'traingdx' %      ( ) );</font></code> </li> <li> <code><font color="black">S1 = 10; %      [S2,Q] = size(targets); %      (  ) P = alphabet; %  ,     %        net = newff(minmax(P), %         [S1 S2], %     {'logsig' 'logsig'}, %   'traingdx' %      ( ) );</font></code> </li> <li> <code><font color="black">S1 = 10; %      [S2,Q] = size(targets); %      (  ) P = alphabet; %  ,     %        net = newff(minmax(P), %         [S1 S2], %     {'logsig' 'logsig'}, %   'traingdx' %      ( ) );</font></code> </li> <li> <code><font color="black">S1 = 10; %      [S2,Q] = size(targets); %      (  ) P = alphabet; %  ,     %        net = newff(minmax(P), %         [S1 S2], %     {'logsig' 'logsig'}, %   'traingdx' %      ( ) );</font></code> </li> <li> <code><font color="black">S1 = 10; %      [S2,Q] = size(targets); %      (  ) P = alphabet; %  ,     %        net = newff(minmax(P), %         [S1 S2], %     {'logsig' 'logsig'}, %   'traingdx' %      ( ) );</font></code> </li> <li> <code><font color="black">S1 = 10; %      [S2,Q] = size(targets); %      (  ) P = alphabet; %  ,     %        net = newff(minmax(P), %         [S1 S2], %     {'logsig' 'logsig'}, %   'traingdx' %      ( ) );</font></code> </li> <li> <code><font color="black">S1 = 10; %      [S2,Q] = size(targets); %      (  ) P = alphabet; %  ,     %        net = newff(minmax(P), %         [S1 S2], %     {'logsig' 'logsig'}, %   'traingdx' %      ( ) );</font></code> </li> <li> <code><font color="black">S1 = 10; %      [S2,Q] = size(targets); %      (  ) P = alphabet; %  ,     %        net = newff(minmax(P), %         [S1 S2], %     {'logsig' 'logsig'}, %   'traingdx' %      ( ) );</font></code> </li> <li> <code><font color="black">S1 = 10; %      [S2,Q] = size(targets); %      (  ) P = alphabet; %  ,     %        net = newff(minmax(P), %         [S1 S2], %     {'logsig' 'logsig'}, %   'traingdx' %      ( ) );</font></code> </li> </ol></blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Network training </h1><br>  Now that the NA has been created, it is necessary to teach her, because she, as a small child, knows nothing, a completely blank sheet.  The neural network is trained using the back propagation procedure - propagation of error signals from the outputs of the NA to its inputs, in the direction opposite to the direct propagation of signals in normal operation (there are also learning methods, this is considered the most basic, and all the others are modifications). <br>  To create a neural network that can work with noisy input data, it is necessary to train the network by applying data to the input, both with noise and without it.  To do this, you must first train the network, submitting data without a noise component.  Then, when we train the network on ideal data, we will conduct training on sets of ideal and noisy input data (as we will see later, this is very important, because such training increases the percentage of correct letter recognition). <br>  For all workouts, the traingdx function is used ‚Äî a network training function that modifies the values ‚Äã‚Äãof weights and displacements according to the gradient descent method taking into account the moments and using adaptive training. <br>  First, you need to train the network on non-noisy data, that is, starting with simple.  In principle, the order of training is not particularly important, but often changing the order, you can get a different quality of the adequacy of the National Assembly.  Then, in order to be able to make a neural system that is not sensitive to noise, we will train the network with two perfect copies and two copies containing noise (noise with dispersion of 0.1 and 0.2 is added).  The target value will therefore contain 4 copies of the target vector. <br>  After completing the training with noisy input data, it is necessary to repeat the training with ideal input data in order for the neural network to successfully cope with the ideal input data.  I don‚Äôt cite pieces of code, because they are very simple, using one <b>train</b> function, which is easy to use. <br><br><h1>  Network testing </h1><br>  The most interesting and significant stage is what we got.  For this, I will provide dependency graphs with comments. <br>  First, we trained the network only on ideal data and now we will see how it copes with recognition.  For clarity, I will build a graph illustrating the input output ratio, that is, the number of the letter at the input must correspond to the number of the letter at the output (the perfect recognition will be the case when we get the diagonal of the quadrant on the graph). <br><div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/7f/7e/7f7e7eea2f4194c6bab9b83beb9655ee.jpg"></div><br>  As you can see, the network has coped poorly with the task, you can of course play around with the training parameters (which is desirable to do) and this will give the best result, but we will make another comparison, create a new network and train it with noisy data, and then compare the obtained NN. <br>  Now back to the question, but how many neurons in the hidden layer should be.  To do this, we construct a dependency that graphically shows the ratio of neurons in the hidden layer and the percentage of erroneous recognition. <br><div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/fd/0b/fd0bf0d8495907691f0d2d818b95217c.jpg"></div><br>  As can be seen, with an increase in the number of neurons, 100% recognition of input data can be achieved.  Also increasing the likelihood of correct recognition will be re-training the wound of a trained neural network with a large amount of data.  After such a stage it is easy to see that the percentage of correct letter recognition increases.  True, everything works well up to a certain point, because it can be seen that when the number exceeds 25 neurons, the network starts to make mistakes. <br><div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/68/fc/68fcb78d0a5e5dc36a81619a5822556a.jpg"></div><br>  Remember that we are going to train another network, using in addition to the ideal data, also noisy data and compare.  So let's take a look at which network is better, based on the results obtained in the graph below. <br><div style="text-align:center;"><img src="https://habrastorage.org/storage/habraeffect/4b/cd/4bcd1485ee8cd77b1c0c05bfb1b23f4a.jpg"></div><br>  As it can be seen, with not significant noise, the NA, which was trained by the distorted data, does much better (the percentage of erroneous recognition is lower). <br><br><h1>  Summarizing </h1><br>  I tried not to torment with details and trifles, I tried to organize a "murzilka" (a magazine with pictures) in order to simply understand what the use of NA is. <br>  As for the obtained results, they indicate that in order to increase the number of correct recognition, it is necessary to train (train) the neural network more and increase the number of neurons in the hidden layer.  If it is possible, then increase the resolution of the input vectors, for example, the letter is formalized by a 10x14 matrix.  The most important thing is that in the learning process it is necessary to use a larger number of input data sets, with as much noise as possible with useful information. <br>  Below is an example in which everything has been done, all that is described and cited in the article (even a little more).  I tried to tell something useful and not to load with some incomprehensible formulas.  More articles are planned, but it all depends on your wishes. <br><br><h1>  Example and literature </h1><br>  <a href="http://ge.tt/2HxIhWB">CharacterRecognition.zip</a> <br>  <a href="http://gotai.net/documents-neural_networks.aspx">Selection of articles on neural networks</a> <br>  <a href="http://www.basegroup.ru/library/analysis/neural/">Description of neural network algorithms</a> </div><p>Source: <a href="https://habr.com/ru/post/113245/">https://habr.com/ru/post/113245/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../113239/index.html">Draw a wave of the .wav file</a></li>
<li><a href="../113240/index.html">Anonymous leaders may soon be arrested</a></li>
<li><a href="../113241/index.html">MocoSpace has expressed interest in acquiring MySpace</a></li>
<li><a href="../113243/index.html">google translate script</a></li>
<li><a href="../113244/index.html">The film, shot on Canon 7D, bought for $ 4 million</a></li>
<li><a href="../113246/index.html">The story of one "violation" of copyright. Part 2</a></li>
<li><a href="../113247/index.html">How following the rules get banned Vkontakte</a></li>
<li><a href="../113250/index.html">Lua vs. Javascript</a></li>
<li><a href="../113252/index.html">Brainfuck - output in decimal format</a></li>
<li><a href="../113253/index.html">PHP Cheat Sheet: FALSE, NULL and values ‚Äã‚Äãassociated with them</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>