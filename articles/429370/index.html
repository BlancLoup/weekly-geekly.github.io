<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How does Google's Night Sight system work on phones and why does it work so well</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="You can be forgiven for the fact that after reading all the accolades for the new night photography feature from Google, Night Sight, you decide that ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How does Google's Night Sight system work on phones and why does it work so well</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/19d/dc4/57d/19ddc457d8f1d64075791cf016e8b0a0.jpg"></div><br>  You can be forgiven for the fact that after reading all the accolades for the new night photography feature from Google, Night Sight, you decide that the company has just invented a color film.  Night shooting modes did not appear yesterday, and many of the technologies on which they are based have been around for many years.  But Google has done an amazing job of combining computational photography skills with unprecedented machine learning abilities to push the boundaries of possibilities beyond everything we have seen before.  Let's look at the history of the technology of obtaining photos in low light using several shots taken in a row, think about how it is used in Google, and suppose what contribution AI makes to it. <br><a name="habracut"></a><br><h2>  The difficulty of photographing in low light </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/642/f37/6cc/642f376cc594bd13af38942c07c8f89c.jpg"><br><br>  All cameras hardly cope with obtaining photos in low light.  Without enough photons per pixel in the image it is easy to dominate noise.  If you leave the shutter open for a longer time to collect more light and get a useful picture, it will also increase the amount of noise.  Worse, it is rather difficult to get a clear picture without a stable tripod.  Increasing the gain (ISO) will make the picture brighter, but it will also increase the amount of noise in it. <br><br>  The traditional strategy was to use larger pixels in larger sensors.  Unfortunately, in the cell phones of the phones, the sensors, and, therefore, the pixels, are tiny - they work well with good lighting, but quickly fail when the light level decreases. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a result, the developers of telephone cameras are left with two options for improving the images obtained in low light.  The first is to use multiple images to combine them into one, with noise reduction.  An early implementation of such a strategy in a mobile device was the SRAW mode in the DxO ONE add-on for iPhone.  He merged four RAW images into one enhanced one.  The second option is to use ingenious post-processing (their latest versions are often equipped with machine learning) to reduce the noise level and improve the picture.  Google Night Sight uses both approaches. <br><br><h2>  Multiple images in one shot </h2><br>  To date, we have become accustomed to how telephones and cameras combine several images into one, mainly to improve the dynamic range.  Whether it's a group of images with <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25B2%25D1%2582%25D0%25BE%25D0%25B2%25D0%25B8%25D0%25BB%25D0%25BA%25D0%25B0">bracketing</a> , as most companies do, or Google's HDR +, which uses several images with a brief exposure, you can get a great picture as a result - if the artifacts generated by merging several images of moving objects can be minimized.  Usually, the base frame that best describes the scene on which the useful parts of the other frames are superimposed is selected for this.  Huawei, Google and others have also used this approach to create enhanced photos from a <a href="https://www.extremetech.com/electronics/278504-pixel-3-cameras-are-a-showcase-for-googles-ai%3Fsource%3Dfeed">telephoto lens</a> .  We recently saw the importance of choosing the right base frame when Apple explained that their mess with <a href="https://www.ixbt.com/news/2018/10/31/obnovlenie-ios-ispravilo-oshibku-beautygate-i-uluchshilo-kachestvo-svjazi.html">BeautyGate</a> was due to a bug in which the wrong base frame was selected during photo processing. <br><br>  It's clear why Google decided to combine these methods of using multiple images to get better photos in low light.  At the same time, the company introduces several ingenious innovations in the field of image processing.  Most likely, the roots of this lie in the application for Android from Mark Livoy, <a href="https://www.youtube.com/watch%3Fv%3DS7lbnMd56Ys">SeeInTheDark</a> , and his work in 2015 "Obtaining extreme images using cell phones."  Livoy was a pioneer in computational photography from Stanford, and now he is an honorary engineer, working on camera technology at Google.  SeeInTheDark (a continuation of its earlier work, SynthCam applications for iOS) used a standard phone to accumulate frames, change each frame so that it matches the typed image, and then apply various noise reduction techniques and image enhancement to produce a surprisingly high-quality image with low lighting.  In 2017, a programmer from Google, Florian Kants, used some of these concepts to <a href="https://ai.googleblog.com/2017/04/experimental-nighttime-photography-with.html">show</a> how the phone can be used to produce professional-quality images even in very low light. <br><br><h2>  Overlaying multiple images taken under low light is a well-known technology. </h2><br>  Photographers imposed several images to improve the quality of images taken in low light, from the very appearance of digital photography (I suspect that someone did this with film).  As for me, I started by doing this manually, and then I used the clever software tool Image Stacker.  since the very first digital SLRs were useless at high ISOs, the only way to get a normal night shot was to take a few frames and superimpose them.  Some classic photographs, like stellar tracks, were originally obtained that way.  Today, this is not so often used when using DSLRs and mirrorless cameras, since modern models have excellent tools for maintaining high ISO and reducing noise from long exposures.  On my Nikon D850, you can leave the shutter open for 10-20 minutes, and still get quite suitable photos. <br><br>  Therefore, it is reasonable that phone manufacturers should do the same.  However, unlike patient photographers who shoot stellar tracks with a tripod, the average phone user needs immediate satisfaction, and he will almost never use a tripod.  Therefore, the phone has additional difficulties associated with the need to quickly obtain images in low light and minimize blur from camera shake - and ideally, from the movement of the object being shot.  Even the optical stabilization available on many top models has its limitations. <br><br>  I'm not sure which phone maker first applied using multiple shots to get low-light images, but I was the first to use Huawei Mate 10 Pro.  In the Night Shot mode, he takes several frames in 4-5 seconds, and then merges them into one photo.  Since Huawei real-time preview remains enabled, you can see how it uses several different exposure options, in essence, creating a few frames of bracketing. <br><br>  In the work describing the first HDR +, Livoy claims that frames with different exposures are harder to align (why HDR + uses several frames with the same exposure), therefore, most likely, Google Night Sight, like SeeInTheDark, also uses several frames with the same exposure. .  However, Google (at least in the pre-release version of the application) does not display a real-time image on the screen, so I can only guess.  Samsung in the Galaxy S9 and S9 + used a different tactic with the main lens of the double aperture.  It can switch to an impressive f / 1.5 in low light to improve picture quality. <br><br><h2>  Comparison of the capabilities of Huawei and Google in low light </h2><br>  I don't have Pixel 3 or Mate 20 yet, but I have access to Mate 10 Pro with Night Shot and Pixel 2 with the pre-release version of Night Sight.  So I decided to compare them myself.  In the tests, Google apparently surpassed Huawei, showing less noise and a clearer picture.  Here is one of the test sequences: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/280/3ff/40f/2803ff40ffe6fa0d8e37fff803e5de82.jpg"><br>  <i>Huawei Mate 10 Pro in the afternoon</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7f3/c8a/aa4/7f3c8aaa4a2c229d3da6f6b29b2d0044.jpg"><br>  <i>Google pixel 2 day</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/da5/4e7/f26/da54e7f264ca68a13460abd79d56dda6.jpg"><br>  <i>This is what you can get by photographing the same scene in almost complete darkness without Night Shot mode on the Mate 10 Pro.</i>  <i>The shutter is open for 6 seconds, so you can see the blur</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a0b/947/4bd/a0b9474bd37aa782f26802285bb71240.jpg"><br>  <i>Snapshot almost in complete darkness with Night Shot on Huawei Mate 10 Pro.</i>  <i>EXIF data shows ISO3200 and 3 seconds of exposure in total.</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/48f/528/964/48f528964a8fd1df8d6d89dca5b04999.jpg"><br>  <i>The same scene with the help of the pre-release version of Night Sight on Pixel 2. More precisely, the colors are clearer.</i>  <i>EXIF shows ISO5962 and 1/4 s exposure (probably for each of several frames).</i> <br><br><h2>  Is machine learning the secret component of Night Sight? </h2><br>  Considering how long the overlapping of several images has existed, and how many versions of this technology have been used by camera and phone manufacturers, it becomes interesting why Google's Night Sight seems so much better than the rest.  Firstly, even the technology in the original work of Livoya is very difficult, so those years that Google had to improve it should have given the company a good edge.  But the company also announced that Night Sight uses machine learning to select the right colors in the image based on what was in the frame. <br><br>  It sounds cool, but foggy.  It is not clear whether the technology highlights individual objects, knowing that their color should be monotonous, or color known objects accordingly, or recognize the general type of scene, as intelligent automatic exposure algorithms do, and decide how a similar scene should look like (green foliage, white snow, blue sky).  I am sure that after the release of the final version, the photographers will get more experience with this opportunity, and we will be able to learn the details of how the technology uses the MO. <br><br>  Another place where MO can be useful is the initial calculation of the exposure.  HDR +‚Äôs underlying Night Sight technology, as described by Google‚Äôs SIGGRAPH, relies on a hand-marked set of thousands of photos to help it choose the right exposure.  In this area, MOs can bring some improvements, especially by performing exposure calculations in low light conditions, where scene objects are noisy and difficult to distinguish.  Also, Google <a href="https://groups.csail.mit.edu/graphics/hdrnet/">experimented</a> with using neural networks to improve the quality of photos on phones, so it would not be a surprise when some of these technologies begin to be implemented. <br><br>  Whatever combination of these technologies is used in Google, the result is definitely the best of all cameras capable of shooting in low light today.  I wonder if the Huawei P20 family will be able to give something to bring the quality of their Night Shot technology to what they did at Google. </div><p>Source: <a href="https://habr.com/ru/post/429370/">https://habr.com/ru/post/429370/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../429360/index.html">Introduction to SOLID: Tim Berners-Lee New Redirected Internet</a></li>
<li><a href="../429362/index.html">Malicious machine learning as a diagnostic method</a></li>
<li><a href="../429364/index.html">Gloomy consensus on children and screens begins to form in Silicon Valley</a></li>
<li><a href="../429366/index.html">How to make a time machine for radio</a></li>
<li><a href="../429368/index.html">You expect too much from the Boston Dynamics robots</a></li>
<li><a href="../429376/index.html">Thrift as REST API</a></li>
<li><a href="../429380/index.html">Replacing TCP: QUIC is ready for deployment [but not ready to become RFC]</a></li>
<li><a href="../429382/index.html">From Alibaba to Pyaterochka: who and how uses face recognition in business</a></li>
<li><a href="../429384/index.html">Components of electric bike: motor</a></li>
<li><a href="../429386/index.html">Provider AT & T has become the largest copyright holder and will begin to disconnect users accused of piracy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>