<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why put up a management interface or attack on a Cisco Smart Install on the Internet</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cisco recently learned about some hacker groupings that targeted Cisco switches as their target, using the issue of protocol misuse in the Cisco Smart...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why put up a management interface or attack on a Cisco Smart Install on the Internet</h1><div class="post__text post__text-html js-mediator-article">  Cisco recently learned about some hacker groupings that targeted Cisco switches as their target, using the issue of protocol misuse in the Cisco Smart Install Client.  Several incidents in different countries, including some involving critical infrastructure, have been associated with the misuse of the Smart Install protocol.  Some experts believe that a number of these attacks are associated with hackers in the service of the state.  As a result, we take a proactive stance and encourage customers, again, to assess risks and apply available methods to neutralize risks. <a name="habracut"></a><br><br>  On February 14, 2017 (yes, there is no error, this is about 2017), the Cisco Product Security Incident Response Team (PSIRT) published a bulletin describing the results of active scans associated with Cisco Smart Install Clients.  The Cisco Smart Install Client software is an outdated utility designed for remote configuration of new Cisco equipment, in particular Cisco switches.  In continuation, Cisco Talos posted a blog post and released an open source tool that scans devices using the Cisco Smart Install protocol.  In addition to the above, a signature was issued for the Snort attack detection system (SID: 41722-41725), which allows to detect any attempts to use this technology. <br><br>  The Cisco Smart Install protocol can be abused to change the TFTP server setting, export configuration files via TFTP, change the configuration files, replace the image of the network IOS operating system, and set up accounts that allow you to run IOS commands.  Although this is not a vulnerability in the classical sense, the misuse of this protocol can serve as an attack vector that should be immediately neutralized.  During late 2017 and early 2018, Talos watched as attackers attempted to scan clients using this vulnerability.  Recent information has increased the relevance of this problem and we decided to return to it again. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Although we only observed attacks related to the problem of misusing the Cisco Smart Install protocol, another vulnerability was recently discovered and <b>fixed</b> in the Cisco Smart Install Client.  This vulnerability has been discussed publicly, and a code has been released showing evidence of the possibility of exploiting the vulnerability (PoC).  To fix the problem of misuse of the protocol, clients should also eliminate this vulnerability by installing the appropriate update. <br><br><h3>  Scope </h3><br>  As part of the Cisco Talos study, we began to explore how many devices are potentially vulnerable to this attack.  The results were extremely disturbing.  Using Shodan, Talos was able to determine that more than 168,000 systems could potentially be detected via the Cisco Smart Install Client ‚Äúopen to the Internet‚Äù.  This is better than the results of 2016, when a Tenable employee reported 251,000 vulnerable Cisco Smart Install Clients ‚Äúvisible‚Äù from the Internet.  There may be differences in the Cisco Talos and Tenable scanning methodology, but we assume a significant reduction in the number of devices available to attack.  In addition, despite the fact that since our initial bulletin, there has been a drop in scan volumes, Talos observed a sharp increase in scanning attempts for the Cisco Smart Install Client around November 9, 2017. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/108/5e9/608/1085e9608260e451d5f2dce336b257db.jpg" alt="image"><br><br><h3>  Neutralization </h3><br>  You can determine if you have a device ‚Äúraised‚Äù on the Cisco Smart Install Client software switch.  Running the <b>show vstack config command</b> will allow you to determine if the Smart Install Client is active.  Below is an example of such a command with a response to it: <br><br><pre><code class="bash hljs">switch <span class="hljs-comment"><span class="hljs-comment"># show vstack config | inc Role Role: Client (SmartInstall enabled)</span></span></code> </pre> <br>  Additional features of the active Cisco Smart Install Client may be present if level 6 (informational) or higher registration is enabled.  These event logs may include, but are not limited to, TFTP write operations, command execution, and device reloads. <br><br>  The easiest way to counteract this problem is to run the no vstack command on a vulnerable device.  If for any reason this option is not available to the client, the best option would be to restrict access via an access control list (ACL) for the interface, an example of which is shown below: <br><br><pre> <code class="bash hljs">ip access-list extended SMI_HARDENING_LIST     permit tcp host 10.10.10.1 host 10.10.10.200 eq 4786   deny tcp any any eq 4786   permit ip any any</code> </pre> <br>  This type of ACL only allows the nodes shown above to access the Smart Install Client, which significantly limits the ability to launch an attack.  In addition, there are signatures in our Intrusion Prevention Systems (IPS) to determine if Smart Install Client is affected or not. <br><br><h3>  Support </h3><br>  For this and other issues, it is important to remember Cisco‚Äôs commitment to supporting affected customers.  All customers, regardless of the status of the support contract, receive free incident response assistance, as well as assistance offered to contract customers for any incident involving known or reasonably suspicious security vulnerabilities in a Cisco product.  If you encounter a Cisco product incident, contact the Cisco Technical Assistance Center (TAC): <br><br><ul><li>  In Moscow: +7 495 961 13 82 </li><li>  In St. Petersburg: +7 812 363-3328 </li><li>  Free call within Russia: 8 800 700 05 22 </li><li>  In Armenia: 800-721-7549 </li><li>  In Belarus: 8 800 101, then 800 721 7549 </li><li>  In Ukraine (main): 0800 301 2090 (toll free number) </li><li>  In Ukraine (alternative): +380 44 390 2400 </li><li>  In Azerbaijan: 088 9999999 </li><li>  In Kazakhstan: 8 ^ 800-121-4321 (dial 8, wait for the 2nd signal and then dial the remaining numbers).  Then dial the PIN, 800-721-7549 </li><li>  In Tajikistan: + 992 44 600 60 40 </li><li>  In Uzbekistan: 800-721-7549 </li></ul><br>  For more information, see the <a href="http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html">Cisco Vulnerability Security Policy</a> . <br><br><h3>  findings </h3><br>  To ensure perimeter security and control, network administrators need to be especially vigilant.  It is easy to ‚Äúinstall and forget‚Äù network devices, as they are usually very stable and rarely change.  Suffice it to recall the results of our annual cybersecurity annual report, in which we demonstrated the results of our study proving that the average non-elimination time for <b>clients of</b> vulnerabilities in network and server hardware and software is on average about five years.  Combine this with the advantages that an attacker has when gaining access and intercepting control of a network device and you will realize that routers and switches become very attractive targets for intruders.  Especially if we are talking about devices standing on the perimeter of the organization or carrier. <br><br>  Watching attackers actively using this vector, Cisco strongly recommends that all customers review their architecture, use the Talos tools to scan their network, and remove the Cisco Smart Install Client from all devices where it is not used. <br><br><h3>  Additional Information </h3><br><ul><li>  Cisco <a href="https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20170214-smi">bulletin</a> about incorrect use of Cisco Smart Install protocol </li><li>  Cisco <a href="https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180328-smi2">Newsletter</a> on Smart Install RCE Vulnerability </li><li>  Cisco <a href="https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180328-smi">bulletin</a> about DDoS vulnerabilities in the implementation of the Smart Install feature </li><li>  <a href="http://blog.talosintelligence.com/2017/02/cisco-coverage-for-smart-install-client.html">A note</a> on the Cisco Talos blog about incorrectly using the Smart Install protocol </li><li>  Cisco Talos Smart Install Client <a href="https://github.com/Cisco-Talos/smi_check">Scanner</a> </li><li>  This is the original Talos blog post. </li><li>  Cisco Cisco IOS and IOS XE Security Enhancement <a href="https://www.cisco.com/c/en/us/support/docs/ip/access-lists/13608-21.html">Guide</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/352996/">https://habr.com/ru/post/352996/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../352986/index.html">Messengers, it's time to take the next step.</a></li>
<li><a href="../352988/index.html">Self-Managed Virtual Infrastructures: VMware Updates vRealize Suite</a></li>
<li><a href="../352990/index.html">Massive attack on cisco</a></li>
<li><a href="../352992/index.html">Thymeleaf Tutorial: Chapter 20. Appendix C: Markup Selector Syntax</a></li>
<li><a href="../352994/index.html">Better way To Code</a></li>
<li><a href="../352998/index.html">The path of the IT-manager (part # 2)</a></li>
<li><a href="../353002/index.html">Mass Attack on Cisco Equipment</a></li>
<li><a href="../353006/index.html">Parsing tasks from Odnoklassniki on JPoint 2018</a></li>
<li><a href="../353008/index.html">Overview of cases of interesting Big Data implementations in financial sector companies</a></li>
<li><a href="../353010/index.html">N + 6 useful books</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>