<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The story of one Easter application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not eggs color a person, but a person paints eggs 
 Onion, beetroot, old tie, colored threads - how many ways to paint eggs do you know? Today we will...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The story of one Easter application</h1><div class="post__text post__text-html js-mediator-article"><h4>  <b>Not eggs color a person, but a person paints eggs</b> </h4><br>  Onion, beetroot, old tie, colored threads - how many ways to paint eggs do you know?  Today we will talk about one more, invented by us. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7cd/c4a/565/7cdc4a565a6e1baf645de1c367c16977.jpg" alt="image"><br><br><h4>  <b>Fill the face peacock</b> </h4><br>  <b>Paint eggs</b> - do not fry potatoes. <br><a name="habracut"></a><br>  For each palette there is a suitable material, and when it comes to the product, which is then also eaten up, I don‚Äôt want to do it at random. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/61b/7ff/95a/61b7ff95aa837cfdfc2719b48acbca1a.jpg" alt="image"><br><br>  <u>Can!</u> <br><br>  All you need is an <i>iPhone</i> , although at first you can do without it.  The main thing - store eggs. <br><br>  Having drawn the first prototypes of the interface, we figured out how much we will have layouts, ornaments, what they will look like and, finally, we set off to prepare content for the application.  A few days later we got a little-a lot of <b>350</b> different ornaments for <b>5</b> colors and <b>5</b> markings. <br><br><h4>  <b>‚ÄúMotor, camera ... action!‚Äù</b> </h4><br>  Here the first prototypes were drawn, on which the main application screens were distributed, the available functionality and the basic mechanics of the coloring.  Naturally, everything was tested on eggs. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b88/7e4/9bd/b887e49bd2e09e7792c954b04a05e1c5.jpg" alt="image"><br><br>  It seemed that with such a simple task there should be many ways to shape the idea in the interface, however, there remained a contradictory opinion on various trifles, such as ‚Äúdo I need to switch to the next editing stage when choosing a zone, or not?‚Äù And so on <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6cc/713/c2f/6cc713c2f990bcc2cd53015770bd2e74.jpg" alt="image"><br><br>  Each egg was carefully rendered by hand - it took a lot of time. <br>  <i>‚ÄúWhy not render it in the application itself according to the model?‚Äù</i> - you ask.  The answer is: each ornament was stretched on an egg in its own way - such work cannot be trusted to robots. <br><br><h4>  <b>Underwater eggs</b> </h4><br>  We did the first version on <a href="http://code.tutsplus.com/tutorials/sprite-kit-vs-cocos2d--mobile-19770">Cocos</a> , and the main difficulties were only with crossing the scene objects with the <a href="https://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html">UIView</a> heirs, but this can be solved by breaking the objects into different scenes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f03/165/b68/f03165b68f21703dbd7ae72f4d27204a.png" alt="image"><br><br>  <b>The task that appeared on the horizon</b> : too many pictures, you need to keep within <b>50 megabytes</b> (2013 was in the yard, the limit was <a href="http://www.macrumors.com/2013/09/18/apple-increases-over-the-air-app-store-download-limit-to-100mb/">doubled</a> in <b>iOS 7</b> ), otherwise the application will not be able to download via the cellular network.  They shook everything in jeeppeg, for each zone they drew a mask, by which they filtered the layer with each zone.  Fulfilled! <br><br><h4>  <b>In blue - squeeze the door</b> </h4><br>  Double check everything before sending the app with an <b>in-app purchase</b> inside.  Especially - do not forget the restore button for <b>non-consumable</b> purchases.  We received our well-deserved <b>reject</b> and went to work by the next year. <br><br>  Great attention is paid to testing <b>in-app purchase</b> .  Testing with test iTunes accounts is very peculiar - it is better to try <a href="https://developer.apple.com/library/ios/documentation/LanguagesUtilities/Conceptual/iTunesConnectInAppPurchase_Guide/Chapters/TestingInAppPurchases.html">once</a> .  And yes, if you publish a new version, and certain <b>In-App</b> 's are available only in it - do not forget that you need to specify this <a href="https://developer.apple.com/library/ios/technotes/tn2259/_index.html">before sending the</a> application for review. <br><br><h4>  <b>The same eggs - side view</b> </h4><br>  Quickly transferred the project to <a href="https://developer.apple.com/library/ios/documentation/GraphicsAnimation/Conceptual/SpriteKit_PG/Introduction/Introduction.html%255D">SpriteKit</a> - the logic remained <a href="http://code.tutsplus.com/tutorials/sprite-kit-vs-cocos2d--mobile-19770">the same</a> , but it became much easier to work with the internal structure of objects for drawing, for this, <i>CoreGraphics</i> did not even have to go: <br><br><pre><code class="markdown hljs">SKSpriteNode <span class="hljs-emphasis"><span class="hljs-emphasis">*patternNode = [SKSpriteNode spriteNodeWithImageNamed:spriteImageName]; SKSpriteNode *</span></span>maskNode = [SKSpriteNode spriteNodeWithImageNamed:maskImageName]; SKCropNode *zoneNode = [SKCropNode node]; [zoneNodeaddChild:patternNode]; [zoneNode setMaskNode:maskNode];</code> </pre> <br>  Why reinvent the wheel?  Returned to the standard navigation <a href="https://developer.apple.com/library/ios/documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html"><i>UINavigationController</i></a> , now customize - <a href="http://www.thinkandbuild.it/ios7-custom-transitions/">I do not want</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b60/5b0/939/b605b09391df8bf745af18286ad22b56.png" alt="image"><br><br>  You can simulate the behavior of a <i>UIScrollView</i> for a <i>SKNode</i> successor by putting it in one container with a <i>UIScrollView</i> , and putting the container on top of <i>SKView</i> which <i>renders SKScene</i> , and implementing the <i>UIScrollViewDelegate</i> protocol for such a container and further changing the position of <i>SKNode</i> inside the container depending on the <b>contentOffset</b> parameter: <br><br><pre> <code class="markdown hljs"><span class="hljs-bullet"><span class="hljs-bullet">- </span></span>(void)scrollViewDidScroll:(UIScrollView *)scrollView { // See also: http://stackoverflow.com/a/19197965/429253 <span class="hljs-emphasis"><span class="hljs-emphasis">_selectorNode.position = CGPointMake(- scrollView.contentOffset.x + 160.0f, _</span></span>selectorNode.position.y); }</code> </pre><br><br><h4>  Egg anatomy </h4><br><br>  As a counter, <a href="https://developers.google.com/analytics/devguides/collection/ios/">Google Analytics</a> was connected, it took a minimum amount of time to integrate, and provided a bunch of leverage right out of the box.  Screens, events, user behavior patterns - everything is added to a couple of lines. <br><br>  Event Tracking: <br><br><pre> <code class="markdown hljs">[[[GAI sharedInstance] defaultTracker] send: [[GAIDictionaryBuilder createEventWithCategory:@"Share" action:@"Facebook" label:nil value:nil] build]];</code> </pre><br>  Screen Tracking: <br><br><pre> <code class="markdown hljs">id tracker = [[GAI sharedInstance] defaultTracker]; [tracker set:kGAIScreenName value:@"Store: Super Eggs"]; [tracker send:[[GAIDictionaryBuilder createAppView] build]];</code> </pre><br>  Particularly delivers the <b>Real-Time</b> section: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/414/28e/60e/41428e60e29f1a800714cafd85d6c22b.jpg" alt="image"><br><br>  And yes, do not forget to cut off the statistics for the simulator and test runs - why is there rubbish in the statistics? <br><br><pre> <code class="markdown hljs"><span class="hljs-section"><span class="hljs-section">#if TARGET_IPHONE_SIMULATOR || DEBUG [[GAI sharedInstance] setOptOut:YES]; #endif</span></span></code> </pre><br><h4>  Network eggs </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/725/5af/3bc/7255af3bc28461b1d516f96f7d3bbea8.jpg" alt="image"><br><br>  Creating an ‚Äúapp‚Äù for <b>Facebook</b> is a bunch of banners of various sizes.  You still have to do them.  Here, too, it will take some time to wait (they talk about three working days, usually they do it a day) before the Facebook app appears in the <a href="https://www.facebook.com/appcenter">App Center</a> . <br><br>  Also, a login using the <i>Facebook SDK is</i> very sensitive to different conditions: depending on whether the Facebook application is installed on your phone or not, whether you are logged in to social networks in <b>iOS</b> settings or not, the result will be different.  For <a href="https://developers.facebook.com/docs/ios/getting-started">SSO</a> authorization, do not forget to set <i>URL types</i> correctly in the application settings in <b>Xcode</b> (replacing the nines with the identifier of your application on Facebook): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/11f/733/87b/11f73387ba4e4440135b51a8c73f741f.jpg" alt="image"><br><br>  <i>Fill the</i> photo with <i>FBRequestConnection</i> and indicate who we are in this photo: <br><br><pre> <code class="markdown hljs">FBRequestConnection <span class="hljs-emphasis"><span class="hljs-emphasis">*photoUploadConnection = [[FBRequestConnection alloc] init]; FBRequest *</span></span>request = [FBRequest requestForUploadPhoto:<span class="hljs-emphasis"><span class="hljs-emphasis">_image]; [request.parameters setObject:[NSString stringWithFormat:@"[{\"tag_</span></span>uid\":\"%@\"}]", friendId] forKey:@"tags"]; [request.parameters setObject:K<span class="hljs-emphasis"><span class="hljs-emphasis">_APP_</span></span>PROMO_TEXT forKey:@"name"]; [photoUploadConnection addRequest:request completionHandler:^(FBRequestConnection <span class="hljs-emphasis"><span class="hljs-emphasis">*connection, id result, NSError *</span></span>error) { if (!error){ // handle success } } batchEntryName:@"photopost"]; [photoUploadConnection start];</code> </pre><br>  It is a bit more difficult to fill in <b>VKontakte</b> pictures, you must first request the server address to upload the picture, and only after that post it to a friend on the wall (unlike <b>Facebook</b> , where we add a photo to the album and mark someone on it: <br><br><pre> <code class="markdown hljs"> // 1. Get upload server NSDictionary *result = [self sendVkRequestForMethod:@"photos.getWallUploadServer" params:[NSDictionary dictionaryWithObjectsAndKeys: friendId, @"uid", K<span class="hljs-emphasis"><span class="hljs-emphasis">_ACCESS_</span></span>TOKEN, @"access<span class="hljs-emphasis"><span class="hljs-emphasis">_token", nil] error:&amp;error]; // 2. Upload image if (!error) { result = [self sendPOSTRequest:[[result objectForKey:@"response"] objectForKey:@"upload_</span></span>url"] withImageData:UIImageJPEGRepresentation(<span class="hljs-emphasis"><span class="hljs-emphasis">_image, 75)]; } // 3. Save image if (!error) { result = [self sendVkRequestForMethod:@"photos.saveWallPhoto" params:[NSDictionary dictionaryWithObjectsAndKeys: friendId, @"uid", K_</span></span>ACCESS<span class="hljs-emphasis"><span class="hljs-emphasis">_TOKEN, @"access_</span></span>token", [result objectForKey:@"hash"], @"hash", [result objectForKey:@"photo"], @"photo", [result objectForKey:@"server"], @"server", nil] error:&amp;error]; } // 4. Post on wall if (!error) { result = [self sendVkRequestForMethod:@"wall.post" params:[NSDictionary dictionaryWithObjectsAndKeys: friendId, @"owner<span class="hljs-emphasis"><span class="hljs-emphasis">_id", K_</span></span>ACCESS<span class="hljs-emphasis"><span class="hljs-emphasis">_TOKEN, @"access_</span></span>token", K<span class="hljs-emphasis"><span class="hljs-emphasis">_APP_</span></span>PROMO_TEXT, @"message", [[[result objectForKey:@"response"] lastObject]objectForKey:@"id"], @"attachment", nil] error:&amp;error]; }</code> </pre><br>  With Instagram <a href="http://instagram.com/developer/iphone-hooks/">it's easier</a> , first save the image with the extension <b>* .igo</b> , then open the link via <i>UIDocumentInteractionController</i> . <br><br><pre> <code class="markdown hljs">// 1. Save file with <span class="hljs-emphasis"><span class="hljs-emphasis">*.igo extension NSString *</span></span>path = [[self applicationDocumentsDirectory].path stringByAppendingPathComponent:@"EggMaker.igo"]; NSError <span class="hljs-emphasis"><span class="hljs-emphasis">*error = nil; [UIImagePNGRepresentation(postcardImage) writeToFile:path options:0 // 2. Open with UIDocumentInteractionController if (!error) { NSURL *</span></span>instagramURL = [NSURL URLWithString:@"instagram://app"]; if ([[UIApplication sharedApplication] canOpenURL:instagramURL]) { self.documentInteractionController = [UIDocumentInteractionController interactionControllerWithURL: [NSURL fileURLWithPath:path]]; self.documentInteractionController.UTI = @"com.instagram.exclusivegram"; self.documentInteractionController.annotation = [NSDictionary dictionaryWithObject:K<span class="hljs-emphasis"><span class="hljs-emphasis">_SHARE_</span></span>TEXT forKey:@"InstagramCaption"]; [self.documentInteractionController presentOpenInMenuFromRect:self.view.frame inView:self.view animated:YES]; } }</code> </pre><br><h4>  Interactive eggs </h4><br>  Always lacked the ability to make an interactive re-presentation of your application, especially if the application is paid, and the rules of the <b>App Store</b> demo version is <a href="https://developer.apple.com/appstore/resources/approval/guidelines.html">prohibited</a> ?  <a href="http://docs.app.io/embed/">App.io</a> coped with this task: <br> <a href="https://app.io/MBd3Nl"><img src="https://habrastorage.org/getpro/habr/post_images/7de/10a/f7b/7de10af7b0d0d724a33876e6154b837e.png" alt="image"></a> <br><br>  You can add an application by registering a free account; many settings for displaying and embedding such an interactive demo are available through link options for free.  Recently, such a demo of your application can be embedded in the form of full-screen interactive advertising. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/z-PV-983qtQ%3Ffeature%3Doembed&amp;xid=17259,15700002,15700022,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhiADqPhXM2SY_KMJal0Hs9Rv2_pvg" frameborder="0" allowfullscreen=""></iframe><br><br>  Download Yajtsedel in the App Store: <a href="https://itunes.apple.com/us/app/ajcedel/id628391608%3Fl%3Dru%26ls%3D1%26mt%3D8">http://appstore.com/Izedel</a> ( <a href="https://developer.apple.com/library/ios/qa/qa1633/_index.html">who asked</a> about short links?) <br>  Thank you for being with us, be sure to try <b>Super Eggs</b> - there are cats and penguins there! <br>  Our pages on <a href="http://fb.me/eggmakerapp">Facebook</a> and <a href="https://vk.com/eggmaker">VKontakte</a> <br><br>  And for the future: take care of the eggs! <br>  <b>Christ is Risen!</b> </div><p>Source: <a href="https://habr.com/ru/post/219693/">https://habr.com/ru/post/219693/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../219683/index.html">We are going to one of the authors Laravel @laravelphp - Shawn McCool</a></li>
<li><a href="../219685/index.html">Delphi Interface Tricks</a></li>
<li><a href="../219687/index.html">We optimize the business process using a simulator</a></li>
<li><a href="../21969/index.html">The author of the book on project management "The Way of Kamikaze" Edward Yordon arrives in Russia</a></li>
<li><a href="../219691/index.html">Data of about 70,000 cards were compromised at the Russian Railways payment gateway.</a></li>
<li><a href="../219695/index.html">Do you know how the Paralympic Games staff connection was organized?</a></li>
<li><a href="../219697/index.html">DBMS InterSystems Cach√© 2014.1. Release notes</a></li>
<li><a href="../219699/index.html">Corridor testing: we get fast feedback on layouts</a></li>
<li><a href="../2197/index.html">Linux does not violate Microsoft intellectual property rights.</a></li>
<li><a href="../219705/index.html">The first book about 3D printing in Russian, ‚ÄúAffordable 3D printing for science, education and sustainable development‚Äù (Low-cost 3D Printing for Science, Education and Sustainable Development) is ready!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>