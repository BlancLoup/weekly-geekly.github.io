<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>X Neural Switcher - Cookbook (Part 2). Algorithms</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings. 

 Today I will talk about what input language recognition algorithms are used in the X Neural Switcher. 

 As you know, Punto Switcher use...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>X Neural Switcher - Cookbook (Part 2). Algorithms</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage1/e296a6f6/32a5a6e9/b9c5be5b/4fa20101.png">  Greetings. <br><br>  Today I will talk about what input language recognition algorithms are used in the X Neural Switcher. <br><br>  As you know, Punto Switcher uses dictionaries in its work, based on the impossibility of a specific letter combination for a given language.  You can see them if you have Punto installed, here is% PROGRAMFILES% \ Yandex \ Punto Switcher \ Data \ triggers.dat.  At least, google told me so.  These dictionaries are encrypted (easy, but still). <br>  Additionally, Punto uses custom exceptions.  I cannot tell where they are stored - the program is closed. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now back to xneur.  At the time when I switched to using linux (2005), there were exactly two programs that would declare the ability to recognize and switch the layout - sven (still alive) and xneur (half dead).  I chose to finish xneur, then it was version 0.0.3 (http://www.linux.org.ru/forum/talks/811959).  At that moment, it was actually abandoned by the original developers, and for more than half a year there was no movement there. <br><br><a name="habracut"></a><br><br>  At that time, xneur was more than wretched.  For lovers of thrills, so to speak, the People still have <a href="">version 0.0.3</a> - it was awful. <br><br>  The main idea of ‚Äã‚Äãpattern recognition then was the idea of ‚Äã‚Äãthe "weight" of letter combinations.  In short, a rather large text was taken, and on its basis it was considered how often a particular two-letter combination occurs.  His ‚Äúweight‚Äù for a specific language was calculated, and was written to a file. <br>  Xneur had to break the word into letter combinations and calculate the ‚Äúweight‚Äù of the word for each layout.  If the value was above a certain threshold (defined by eye), then the word was translated into this layout. <br><br>  After trying what was at the time when I became interested in xneur, I realized that this was no good.  Began to think how to finalize all this. <br><br>  Before the internal recognition algorithms were fixed, a couple of years of trial and error passed.  I have no philological or linguistic education, all the algorithms were invented on the basis of logic and influx. <br><br>  My conscience didn't allow me to use Punto's dictionaries, as well as the consideration that I thought of xneur to be multilingual, that is, the Russian-eng dictionary simply did not suit me. <br><br>  Further I will describe the algorithms used by the program at the moment. <br><br><h4>  Algorithms </h4><br><br>  Xneur currently uses a multi-level language definition.  Those.  I simply ranked the algorithms according to their degree of reliability.  Probably, many of you will see here a kind of ranking applied in antiviruses. <br><br>  As an input to the layout definition function, an array of strings is passed, each of which is a letter combination typed in each of the layouts installed in the system. <br><br>  At each stage, the program at the beginning checks whether it is possible to leave the typed word in the layout that is already included.  And only if the word does not fit the current layout, then the remaining layouts are checked. <br><br>  Next will go options for decreasing the reliability of switching. <br><br><h5>  User dictionary </h5><br>  At this stage, the word is checked using dictionaries, which I either predetermined beforehand (for example, switch e-mail, IP, MAC to English layout), or were added by the user, or were added by the program itself during the self-learning process. <br><br>  Previously, user dictionaries and regular expressions (ip, MAC, etc.) were divided into separate settings files, but later they were combined, which allows the user to add rules more flexibly.  For example, by adding the letter combination ‚Äúped‚Äù, you can specify where the letter combination should occur in the word for the switch to occur - at the beginning (‚Äú <b>ped</b> al‚Äù), at the end (‚Äúpedal <b>ped</b> ‚Äù) or just the word should contain this letter combination (‚Äú wiki <b>ped</b> ia ‚Äù). <br>  Moreover, for highly advanced users, you can create regular expressions yourself using the Perl regular expression standard.  But in my memory, no one uses this opportunity.  Maybe people do not know about it, eh? <br><br><h5>  System dictionary </h5><br>  If the word does not occur in any of the user's dictionaries, the program proceeds to the next level of verification - to the spell checker check.  As they say, thanks to those who invented and implemented them. <br>  Xneur can, depending on the build options, use either the <b>aspell</b> library or (by default) a wrapper over the <b>enchant</b> dictionaries. <br><br>  The <a href="http://aspell.net/">aspell</a> library is powerful enough, but already a bit outdated spelling checker library.  If you use the linux package distribution, the dictionary packages will be called aspell-ru, aspell-uk or aspell-en depending on your language. <br><br>  It is from this library that the dictionaries support in xneur began.  Unfortunately, the number of available dictionaries for this library does not increase, and that is why I had to look for a replacement for it. <br><br>  As such a replacement, the gaze fell on <b>myspell</b> and <b>hunspell</b> , and then on the magnificent wrapper over <b>Enchant</b> dictionaries.  This wrapper above dictionaries is used by AbiWord, LibreOffice and Firefox spell checkers. <br>  Enchant is just a wrapper over various dictionary libraries, not the dictionary library itself.  It combines various dictionary engines under its wing, combining ease of programming and speed. <br>  Basically, in Ubuntu, Enchant uses Myspell dictionaries, and only for rare languages ‚Äã‚Äãconnects other dictionaries. <br><br>  Therefore, xneur by default also uses Enchant. <br><br><h5>  Heuristic analysis </h5><br>  If the sources of reliable information in the form of dictionaries could not determine whether a word belongs to any of the layouts, then the most unreliable, but, in fact, the most interesting step - the heuristic analysis - comes into play. <br><br>  After much trial and error, I still came to the existing version.  But in the beginning I will talk about not suitable, intermediate options. <br>  <b>"Weight" of the letter combination</b> .  I already mentioned this option at the beginning of the article, but I will write again.  In short, a rather large text was taken, and on its basis it was considered how often a particular two-letter combination occurs.  The letter combination was supposed to be in Latin.  The ‚Äúweight‚Äù of the letter combination for a specific language was calculated, and was written to a file. <br>  Xneur had to break the word into letter combinations and calculate the ‚Äúweight‚Äù of the word for each layout.  If the value was above a certain threshold (defined by eye), then the word was translated into this layout. <br><br>  In general, this algorithm had to be immediately abandoned due to the complexity of calculating the weight and the ephemerality of the switching feature.  Although it does not leave me feeling that this algorithm can be refined and make candy. <br><br>  <b>Valid for the combination of letters</b> .  It's easier here.  The word belongs to one or another layout, if all the letter combinations of the word are included in a specific dictionary. <br><br>  Not drove - long and expensive in terms of resources.  At the same time, the letter combinations were always kept in Latin, which added fun with the recoding. <br><br>  And this is how we arrived at the modern version of heuristics - <b>unacceptable for the combination of letters</b> .  At this point, it was understood that the letter combinations should be stored in the letters of the language that we check to reduce the cost of translating the layout. <br><br>  According to current algorithms, a word cannot belong to one or another language, if the letter combination of this word is found in the list of such letter combinations.  Lists of letter combinations we called <b>proto-languages</b> .  On the basis of proto-languages, heuristics are built. <br><br>  Proto-languages ‚Äã‚Äãin xneur of two types - large and small.  Large letters are combinations of 3 characters, small letters are 2 characters long.  Why do you need this separation?  It's simple - big proto 10-15 times smaller.  This reduces the time to process a word.  Those.  first the word is checked by the large proto, and then (if the identification did not happen) by the small. <br><br>  The proto-languages ‚Äã‚Äãthemselves are obtained using xneur itself.  It already has a mechanism for out of generation.  Simply install the necessary layout into the system, take the text in this language, and more genuinely, launch xneur with the necessary key, and go! <br><br>  Proto-languages ‚Äã‚Äãare the last of the recognition algorithms.  If the word has passed all stages and has not encountered any obstacles, then it remains in the layout as it was. <br><br><h4>  Summarizing </h4><br>  As I have shown, the xneur algorithms are monstrously simple. <br><br>  Probably, someone expected me to reveal some terrible and complex algorithms, such as Markov chains, but this did not happen. <br>  When developing xneur, I followed the simple KISS rule - make it simple, you fool!  And as practice has shown, the level of false positives with such algorithms is very low.  Of course, at the moment the user is required to put the system dictionaries, but this is not a big payment for the processing speed. <br><br>  If you have any ideas or ideas on this topic, I will be happy to discuss them in the comments.  After all, it is in the community that the power of open source! <br><br><h4>  Previous parts </h4><br>  <a href="http://habrahabr.ru/blogs/linux/132635/">X Neural Switcher - Cookbook (Part 0).</a>  <a href="http://habrahabr.ru/blogs/linux/132635/">Introduction</a>  <a href="http://habrahabr.ru/blogs/linux/132635/">Build and configure</a> <br>  <a href="http://habrahabr.ru/blogs/linux/132684/">X Neural Switcher - Cookbook (Part 1).</a>  <a href="http://habrahabr.ru/blogs/linux/132684/">Forerunners and analogues</a> <br><br>  In further articles I will talk about: <br><ul><li>  Setting up xneur as a keylogger. </li><li>  Glitches and jokes xlib, locale and different DE. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/132851/">https://habr.com/ru/post/132851/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../132844/index.html">Will Apple buy Yahoo?</a></li>
<li><a href="../132846/index.html">Eradicate piracy in 7 days</a></li>
<li><a href="../132847/index.html">Cloud4Y has launched a new cloud!</a></li>
<li><a href="../132848/index.html">Efficiency of antivirus companies or the history of a single virus report</a></li>
<li><a href="../132850/index.html">Robots for agriculture</a></li>
<li><a href="../132852/index.html">Automatic backlight for TV</a></li>
<li><a href="../132855/index.html">Asynchronous Cramped ruby ‚Äã‚Äãframework: architecture and usage</a></li>
<li><a href="../132856/index.html">Flash vs HTML5. Our version</a></li>
<li><a href="../132857/index.html">College IT infrastructure. What is, what I would like and how to</a></li>
<li><a href="../132858/index.html">Tomorrow the Internet will start to die.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>