<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>About creating platformer on Unity. Part Three, the long-awaited</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! 

 Cold St. Petersburg autumn stacks people in bed with the temperature and other delights of the part of the universe that is responsible f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>About creating platformer on Unity. Part Three, the long-awaited</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr! <br><br>  Cold St. Petersburg autumn stacks people in bed with the temperature and other delights of the part of the universe that is responsible for the disease.  But all bad, fortunately, comes to an end.  Therefore, as you understand from the introduction, today in our course from beginner to beginners we will talk about the creation of enemies, levels and physics.  More physics! <br><br><img src="https://habrastorage.org/files/1a1/e74/116/1a1e74116ca84389bf8ba8d9e303039d.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Caution: the volumes of gifs under the cut become simply inhuman! <br><a name="habracut"></a><br><br>  <a href="http://habrahabr.ru/company/microsoft/blog/236125/">The previous</a> <a href="http://habrahabr.ru/company/microsoft/blog/236135/">parts</a> were published almost two weeks ago, so I advise you to refresh your knowledge a bit :) <br><br>  <i>Disclaimer: all the code shown in the article is not a role model, an example of an ideal code and other things that are fictional and do not exist in nature.</i>  <i>Practitioners applied in the article may be one of the many solutions to a specific problem.</i>  <i>And may not be.</i> <br><br>  Let's start from the end by adding the simplest physical piece to the box.  We need a sprite box, rigidbody2D and boxcollider2D.  Let's get started! <br><br><img src="https://habrastorage.org/files/6ed/0ca/b13/6ed0cab13d8b4c5ebc5c7c2dfdd1985d.gif"><br><br>  As you can see, there is still nothing complicated.  Prepare from the resulting box prefab and transfer again to the form.  Watch your hands: in one of the boxes we will put the isKinematic checkbox on a rigidbody2D and start up the fun that begins: <br><br><img src="https://habrastorage.org/files/317/ac5/e4b/317ac5e4be35459ba5e6156393a8c9ac.gif"><br><br>  The box with the set rigidbody2D.isKinematic = true does not move.  It can not be moved from the place by the use of forces or collisions, so this box will act as a fixed obstacle.  Go ahead. <br><br>  In the best traditions of the super meat boy, add to our yet_the game of the enemy-saw.  The saw will spin and ... everything. <br><br><img src="https://habrastorage.org/files/396/794/3cd/3967943cd122413c8dc63df7e785a861.gif"><br><br>  An incredibly complex script for this action looks like this: <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> sawScriptNew : MonoBehaviour { // Use this <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> initialization <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Start</span></span> () { } // <span class="hljs-keyword"><span class="hljs-keyword">Update</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">called</span></span> once per frame <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Update</span></span> () { <span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.Rotate (<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Vector3(<span class="hljs-number"><span class="hljs-number">0</span></span>f,<span class="hljs-number"><span class="hljs-number">0</span></span>f,<span class="hljs-number"><span class="hljs-number">-3</span></span>f)); } }</code> </pre> <br><br>  Let me explain: transform.rotate rotates a sprite by the angles given in vector3 around, respectively, the x, y and z axes.  In the case of a 2D game, the first two axes are of little use for our task, and here's why: <br><br>  transform.Rotate (new Vector3 (-3f, 0f, 0f)); <br><img src="https://habrastorage.org/files/aaf/469/cf7/aaf469cf7809465998b2723a0c2ff4e1.gif"><br><br>  transform.Rotate (new Vector3 (0f, -3f, 0f)); <br><img src="https://habrastorage.org/files/c58/ac0/308/c58ac0308fb4416b9e379608ad88fa09.gif"><br><br>  By the way, about 2D mode.  The attentive reader noticed that the saw was ugly sticking out in front of the platform and blocking the whole look.  In order to fix this, it is enough to know a simple thing - in 2D mode, the objects on the screen are ordered (here I‚Äôm not so sure about the terminology, correct) by the z-level.  Here's a visual gif about how it works. <br><br><img src="https://habrastorage.org/files/50e/fb1/4d6/50efb14d6bc44cab8ee8fb063cbed769.gif"><br><br>  Now we will make the hero die when interacting with the saw.  Fix characterController.cs as follows: <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">void</span></span> OnTriggerEnter2D(Collider2D col){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((col.gameObject.name == "dieCollider")||(col.gameObject.name == "saw")) Application.LoadLevel (Application.loadedLevel);</code> </pre><br><br>  Bingo!  Now, having stars, boxes, obstacles and dieColliders, let's try to collect a level.  This is done very quickly and easily, since all the objects already exist in the form of prefabs, and they do not need to be re-configured each time. <br><br><img src="https://habrastorage.org/files/ef3/4d0/ebc/ef34d0ebcf8f4b6288e2b7d09422fcea.gif"><br><br><div class="spoiler">  <b class="spoiler_title">Short guide on game design</b> <div class="spoiler_text">  When creating a level, motivate a player to get acquainted with the world.  Place a prize in front of him, and place the next one in such a way that, for example, you should jump.  Having, for example, moving boxes, put them so that the next star could not be reached without them.  And so on. <br><br><img src="https://habrastorage.org/files/662/c9a/0c9/662c9a0c9fa649fca93886c08d955e83.gif"><br><br>  Teach the player as efficiently as possible: do not stretch the introduction to several levels.  Remember the classic world 1-1 from Super Mario Brothers.  It is (usually) enough to get acquainted with the main game mechanics and the most frequently encountered enemies. <br></div></div><br><br>  Go ahead.  When there is one level, the second is needed.  Save the scene as scene1.unity and create a new one.  Let's build, similarly to the example above, one more level and save (already guessed? Well done) as scene2.  Now go to File -&gt; Build Settings and put daws on both scenes.  Like that: <br><br><img src="https://habrastorage.org/files/cc3/7d2/774/cc37d27749cd4ead876f191b2825655b.png"><br><br>  A number is displayed next to the scene name - by it we can refer to the scene to load it.  Or by name, to whom it is more convenient.  Create an empty object and program it so that after collecting all the stars and colliding with it (the object), the player moves to the second scene.  To do this, in the OnTriggerEnter method we will check whether there are more stars on the scene. <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (col.gameObject.name == "endLevel") { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(GameObject.Find("star"))) Application.LoadLevel ("scene2"); }</code> </pre><br><br>  That's how it will look on stage.  If desired, you can add a sprite using the sprite renderer component. <br><img src="https://habrastorage.org/files/f16/2ba/9d5/f162ba9d55304813b5d3c3cf14314513.png"><br><br><div class="spoiler">  <b class="spoiler_title">How does the switching levels (gif, 3.7 MB)</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/820/6ca/157/8206ca1572b64edc9a2a97bafec7d5ec.gif"><br></div></div><br><br>  This is where the main part of the article ends and the bonus track starts at your request. <br><br><img src="https://habrastorage.org/files/952/11e/8f7/95211e8f7532498fae8e9f1f5fdb0ebc.png"><br><br>  Accordingly, a little about fun and about physics!  Add a couple of sprites - a platform and a fireball from Super Mario, and try to make a machine out of it to destroy a pile of boxes. <br><br><img src="https://habrastorage.org/files/45e/b39/6bd/45eb396bd0b8452ca10129af87e97236.gif"><br><br>  This will help us the first representative of the JDC family, with whom we will get acquainted - Distance Joint, which, in fact, allows you to turn anything in the game into a mathematical pendulum.  We add it to the object, choose what will be on the other side of the pendulum (an object with rigidbody2d.isKinematic = true is useful here), what is the distance between them and eventually we get what we got above.  The boxes, by the way, are the same as those used in our platformer.  Look! <br><br><img src="https://habrastorage.org/files/b04/d03/bc4/b04d03bc4cb64f7ab85c82c3aead5bac.gif"><br><br>  The object to which our destructive ball is attached has a rigidbody2D component with the isKinematic attribute enabled.  This is necessary so that it does not fall immediately after the launch of the game (and never at all). <br><br>  But this is really all!  Thank you for your attention, come again, ask questions!  In the next article I will show how to animate the hero, asterisks and draw normal inscriptions on the screen.  In general, let's do all sorts of decorations. <br><br>  Previous series: <br>  <a href="http://habrahabr.ru/company/microsoft/blog/236125/">Part one, in which the charming nose learns to walk</a> <br>  <a href="http://habrahabr.ru/company/microsoft/blog/236135/">Part two, in which losing is fun.</a> <br><br>  ps <a href="">More fun with physics (GIF, 3.1 MB)</a> </div><p>Source: <a href="https://habr.com/ru/post/238071/">https://habr.com/ru/post/238071/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../238057/index.html">Future of Virgin Galactic transorbital flights: 45 minutes from London to New York, an hour and a half from London to Sydney</a></li>
<li><a href="../238059/index.html">Virtualization¬≤</a></li>
<li><a href="../238063/index.html">The Dude. Setting up email notifications for toner level in network printers</a></li>
<li><a href="../238065/index.html">Visual windows configurator written in one hour</a></li>
<li><a href="../238069/index.html">Deploying Rails Applications with Docker</a></li>
<li><a href="../238073/index.html">Customs duties on the package still to be, and soon</a></li>
<li><a href="../238075/index.html">How does friendship begin with Active Directory</a></li>
<li><a href="../238077/index.html">Expandable mappings of any type of value without using macros</a></li>
<li><a href="../238079/index.html">Illusion of impressions: symbols of the future</a></li>
<li><a href="../238083/index.html">Automatic recovery of disk partitions using Ghost</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>