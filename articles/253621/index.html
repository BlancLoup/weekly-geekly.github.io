<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Meet the Rock Validate</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Data validation is one of many practices in developing a secure web application. Even a completely ‚Äúyoung‚Äù developer, when he first becomes acquainted...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Meet the Rock Validate</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/1e0/ada/394/1e0ada3949de4071b22c5fe6c11aca2f.jpg" align="right">  Data validation is one of many practices in developing a secure web application.  Even a completely ‚Äúyoung‚Äù developer, when he first becomes acquainted with the html form, tries to display a beautiful error message.  What can we say about the model in some heaped framework.  And therefore ... <br><br>  I bring to your attention a library for data validation with customization, internationalization and other "buns".  Using the well-known <a href="https://github.com/Respect/Validation">Respect / Validation</a> tool with many crutches hammered in along the way, at some point I said to myself: Enough! <br><br>  Tasks were set: <br><ul><li>  keep elegant syntax (coupling principle for rules); </li><li>  implement a "light" and flexible alternative; </li><li>  add internationalization; </li><li>  provide the ability to add your own rules; </li><li>  prepare the foundation for the sanitizer - provide a uniform implementation style for both libraries. </li></ul><br><a name="habracut"></a><br><h4>  Everything is ugly just </h4><br><pre><code class="php hljs">$v = Validate::length(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>)-&gt;regex(<span class="hljs-string"><span class="hljs-string">'/^[az]+$/i'</span></span>); $v-&gt;validate(<span class="hljs-string"><span class="hljs-string">'O'</span></span>Reilly<span class="hljs-string"><span class="hljs-string">'); // output: false $v-&gt;getErrors(); /* output: [ '</span></span>length<span class="hljs-string"><span class="hljs-string">' =&gt; '</span></span>value must have a length between <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span><span class="hljs-string"><span class="hljs-string">', '</span></span>regex<span class="hljs-string"><span class="hljs-string">' =&gt; '</span></span>value contains invalid characters<span class="hljs-string"><span class="hljs-string">' ] */ $v-&gt;getFirstError(); // output: value must have a length between 10 and 20</span></span></code> </pre> <br>  The list of errors is presented in the form of an associative array. <br><ul><li>  getErrors () - output the entire error stack; </li><li>  getFirstError () - returns the first error; </li><li>  getLastError () - returns the last error. </li></ul><br><h4>  rules </h4><br>  The set of rules is quite wide, because with minor changes pumped from the camp of "competitor". 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There are groups of rules: <br><ul><li>  general purpose </li><li>  string </li><li>  numeric </li><li>  date and time </li><li>  file system </li><li>  networked </li><li>  and etc. </li></ul><br>  <a href="">Full list of rules</a> <br><br>  Any additional caprice is realized by customization, or pull request. <br><br><h4>  Attribute Validation </h4><br>  To validate an array / object by attributes, use the attributes () method. <br><pre> <code class="php hljs">$input = [ <span class="hljs-string"><span class="hljs-string">'username'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'O'</span></span>Reilly<span class="hljs-string"><span class="hljs-string">', '</span></span>email<span class="hljs-string"><span class="hljs-string">' =&gt; '</span></span>o-reilly@site<span class="hljs-string"><span class="hljs-string">' ]; $attributes = [ '</span></span>username<span class="hljs-string"><span class="hljs-string">' =&gt; Validate::required() -&gt;length(2, 20, true) -&gt;regex('</span></span>/^[az]+$/i<span class="hljs-string"><span class="hljs-string">'), '</span></span>email<span class="hljs-string"><span class="hljs-string">' =&gt; Validate::required()-&gt;email() ]; $v = Valiadte::attributes($attributes); $v-&gt;validate($input); // output: false $v-&gt;getErrors(); /* output: [ '</span></span>username<span class="hljs-string"><span class="hljs-string">' =&gt; [ '</span></span>regex<span class="hljs-string"><span class="hljs-string">' =&gt; '</span></span>value contains invalid characters<span class="hljs-string"><span class="hljs-string">', ], '</span></span>email<span class="hljs-string"><span class="hljs-string">' =&gt; [ '</span></span>email<span class="hljs-string"><span class="hljs-string">' =&gt; '</span></span>email must be valid<span class="hljs-string"><span class="hljs-string">', ], ] */</span></span></code> </pre><br>  Use one set of rules for each attribute: <br><br><pre> <code class="php hljs">Validate::attributes(Validate::required()-&gt;string())-&gt;validate($input);</code> </pre><br><h4>  Denial of the rules </h4><br>  You can invert the behavior of the rules using the notOf () method.  In this case, the ‚Äúnegative‚Äù message template Locale :: MODE_NEGATIVE is used. <br><br><pre> <code class="php hljs">$v = Validate::notOf(Validate::required()); $v-&gt;validate(<span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-comment"><span class="hljs-comment">// output: true</span></span></code> </pre><br>  This method is applicable both for the rules of the internal attribute ['email' =&gt; Validate :: notOf (Validate :: email ())], and for all attributes as a whole.  Example: <br><br><pre> <code class="php hljs">$input = [ <span class="hljs-string"><span class="hljs-string">'email'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'tom@site'</span></span>, <span class="hljs-string"><span class="hljs-string">'username'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">''</span></span> ]; $attributes = Validate::attributes([ <span class="hljs-string"><span class="hljs-string">'email'</span></span> =&gt; Validate::email(), <span class="hljs-string"><span class="hljs-string">'username'</span></span> =&gt; Validate::required() ]); $v = Validate::notOf($attributes); $v-&gt;validate($input); <span class="hljs-comment"><span class="hljs-comment">// output: true</span></span></code> </pre><br><h4>  Rule oneOf () </h4><br>  If at least one rule is incorrect, then the check stops.  Example: <br><pre> <code class="php hljs">$input = <span class="hljs-number"><span class="hljs-number">7</span></span>; $v = Validate::oneOf(Validate::string()-&gt;email()); $v-&gt;validate($input); <span class="hljs-comment"><span class="hljs-comment">// output: false $v-&gt;getErrors(); /* output: [ 'string' =&gt; 'value must be string' ] */</span></span></code> </pre><br>  For attribute validation, the script is similar to negation: <br><pre> <code class="php hljs">$input = [ <span class="hljs-string"><span class="hljs-string">'email'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'tom@site'</span></span>, <span class="hljs-string"><span class="hljs-string">'username'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">''</span></span> ]; $attributes = Validate::attributes([ <span class="hljs-string"><span class="hljs-string">'email'</span></span> =&gt; Validate::email(), <span class="hljs-string"><span class="hljs-string">'username'</span></span> =&gt; Validate::required() ]); $v = Validate::oneOf($attributes); $v-&gt;validate($input); <span class="hljs-comment"><span class="hljs-comment">// output: false $v-&gt;getErrors(); /* output: [ 'email' =&gt; [ 'email' =&gt; 'email must be valid', ] ] */</span></span></code> </pre><br><h4>  When () rule </h4><br>  Necessary to implement the condition (ternary conditional operation).  The general syntax of the method is as follows: <br><br><pre> <code class="php hljs">v::when(v $if, v $then, v $else = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>)</code> </pre><br>  Example: <br><pre> <code class="php hljs">$v = Validate::when(Validate::equals(<span class="hljs-string"><span class="hljs-string">'Tom'</span></span>), Validate::numeric()); $v-&gt;validate(<span class="hljs-string"><span class="hljs-string">'Tom'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// output false $v-&gt;getErrors(); /* output: [ 'numeric' =&gt; 'value must be numeric', ] */</span></span></code> </pre><br><h4>  Replacing Placeholders, Messages and Templates </h4><br>  Many error messages contain placeholders (for example, {{name}}), which are replaced by default values.  Replace your own is not difficult: <br><pre> <code class="php hljs">$v = Validate::length(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>) -&gt;regex(<span class="hljs-string"><span class="hljs-string">'/^[az]+$/i'</span></span>) -&gt;placeholders([<span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'username'</span></span>]); $v-&gt;validate(<span class="hljs-string"><span class="hljs-string">'O'</span></span>Reilly<span class="hljs-string"><span class="hljs-string">'); // output: false $v-&gt;getErrors(); /* output: [ '</span></span>length<span class="hljs-string"><span class="hljs-string">' =&gt; '</span></span>username must have a length between <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span><span class="hljs-string"><span class="hljs-string">', '</span></span>regex<span class="hljs-string"><span class="hljs-string">' =&gt; '</span></span>username contains invalid characters<span class="hljs-string"><span class="hljs-string">', ] */</span></span></code> </pre><br>  Similarly, the entire message is subject to this ‚Äúhot‚Äù replacement: <br><br><pre> <code class="php hljs">$v = Validate::length(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>) -&gt;regex(<span class="hljs-string"><span class="hljs-string">'/^[az]+$/i'</span></span>) -&gt;messages([<span class="hljs-string"><span class="hljs-string">'regex'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">',   !'</span></span>]); $v-&gt;validate(<span class="hljs-string"><span class="hljs-string">'O'</span></span>Reilly<span class="hljs-string"><span class="hljs-string">'); // output: false $v-&gt;getErrors(); /* output: [ '</span></span>length<span class="hljs-string"><span class="hljs-string">' =&gt; '</span></span>username must have a length between <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span><span class="hljs-string"><span class="hljs-string">', '</span></span>regex<span class="hljs-string"><span class="hljs-string">' =&gt; '</span></span>,   !<span class="hljs-string"><span class="hljs-string">' ] */</span></span></code> </pre><br>  Depending on the arguments given in the rule method, the message template is automatically selected, but no one bothers to substitute any other that is described in the current locale.  Example: <br><br><pre> <code class="php hljs">$v = Validate::length(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>)-&gt;templates([<span class="hljs-string"><span class="hljs-string">'length'</span></span> =&gt; Length::GREATER]); $v-&gt;validate(<span class="hljs-string"><span class="hljs-string">'O'</span></span>Reilly<span class="hljs-string"><span class="hljs-string">'); // output: false $v-&gt;getErrors(); /* output: [ '</span></span>length<span class="hljs-string"><span class="hljs-string">' =&gt; '</span></span>value must have a length lower than <span class="hljs-number"><span class="hljs-number">20</span></span><span class="hljs-string"><span class="hljs-string">', ] */</span></span></code> </pre><br><h4>  Internationalization </h4><br>  Currently, there are two message dictionaries: Russian and English.  By default, error messages will be displayed in English.  You can set the locale via the locale () method: <br><br><pre> <code class="php hljs">$v = Validate::locale(<span class="hljs-string"><span class="hljs-string">'ru'</span></span>) -&gt;length(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>) -&gt;regex(<span class="hljs-string"><span class="hljs-string">'/^[az]+$/i'</span></span>); $v-&gt;validate(<span class="hljs-string"><span class="hljs-string">'O'</span></span>Reilly<span class="hljs-string"><span class="hljs-string">'); // output: false $v-&gt;getErrors(); /* output: [ '</span></span>length<span class="hljs-string"><span class="hljs-string">' =&gt; '</span></span>       <span class="hljs-number"><span class="hljs-number">10</span></span>  <span class="hljs-number"><span class="hljs-number">20</span></span><span class="hljs-string"><span class="hljs-string">', '</span></span>regex<span class="hljs-string"><span class="hljs-string">' =&gt; '</span></span>   <span class="hljs-string"><span class="hljs-string">', ] */</span></span></code> </pre><br><h4>  Customization </h4><br>  You can create your own rules in two steps. <br><br>  <b>Step 1.</b>  Create a class with the rule: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">rock</span></span>\<span class="hljs-title"><span class="hljs-title">validate</span></span>\<span class="hljs-title"><span class="hljs-title">rules</span></span>\<span class="hljs-title"><span class="hljs-title">Rule</span></span> <span class="hljs-title"><span class="hljs-title">class</span></span> <span class="hljs-title"><span class="hljs-title">CSRF</span></span> <span class="hljs-title"><span class="hljs-title">extends</span></span> <span class="hljs-title"><span class="hljs-title">Rule</span></span> { <span class="hljs-title"><span class="hljs-title">public</span></span> <span class="hljs-title"><span class="hljs-title">function</span></span> <span class="hljs-title"><span class="hljs-title">__construct</span></span>($<span class="hljs-title"><span class="hljs-title">compareTo</span></span>, $<span class="hljs-title"><span class="hljs-title">compareIdentical</span></span> = <span class="hljs-title"><span class="hljs-title">false</span></span>, $<span class="hljs-title"><span class="hljs-title">config</span></span> = []) { $<span class="hljs-title"><span class="hljs-title">this</span></span>-&gt;<span class="hljs-title"><span class="hljs-title">parentConstruct</span></span>($<span class="hljs-title"><span class="hljs-title">config</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;params[<span class="hljs-string"><span class="hljs-string">'compareTo'</span></span>] = $compareTo; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;params[<span class="hljs-string"><span class="hljs-string">'compareIdentical'</span></span>] = $compareIdentical; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">validate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($input)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;params[<span class="hljs-string"><span class="hljs-string">'compareIdentical'</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $input === <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;params[<span class="hljs-string"><span class="hljs-string">'compareTo'</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $input == <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;params[<span class="hljs-string"><span class="hljs-string">'compareTo'</span></span>]; } }</code> </pre><br>  <b>Step # 2.</b>  Create a class with messages: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">rock</span></span>\<span class="hljs-title"><span class="hljs-title">validate</span></span>\<span class="hljs-title"><span class="hljs-title">locale</span></span>\<span class="hljs-title"><span class="hljs-title">Locale</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CSRF</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Locale</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> REQUIRED = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defaultTemplates</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::MODE_DEFAULT =&gt; [ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::STANDARD =&gt; <span class="hljs-string"><span class="hljs-string">'{{name}} must be valid'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::REQUIRED =&gt; <span class="hljs-string"><span class="hljs-string">'{{name}} must not be empty'</span></span> ], <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::MODE_NEGATIVE =&gt; [ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::STANDARD =&gt; <span class="hljs-string"><span class="hljs-string">'{{name}} must be invalid'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::REQUIRED =&gt; <span class="hljs-string"><span class="hljs-string">'{{name}} must be empty'</span></span> ] ]; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defaultPlaceholders</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($compareTo)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($compareTo)) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;defaultTemplate = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::REQUIRED; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-string"><span class="hljs-string">'name'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'CSRF-token'</span></span> ]; } }</code> </pre><br>  As previously noted, when using the notOf () rule, the message template Locale :: MODE_NEGATIVE will be substituted.  The subpattern allows you to diversify messages depending on the specified arguments in the rule method.  Default Locale :: STANDARD. <br><br>  <b>Profit:</b> <br><br><pre> <code class="php hljs">$config = [ <span class="hljs-string"><span class="hljs-string">'rules'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'csrf'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; \<span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span>\<span class="hljs-title"><span class="hljs-title">to</span></span>\<span class="hljs-title"><span class="hljs-title">CSRF</span></span>::<span class="hljs-title"><span class="hljs-title">className</span></span>(), '<span class="hljs-title"><span class="hljs-title">locales</span></span>' =&gt; [ '<span class="hljs-title"><span class="hljs-title">en</span></span>' =&gt; \<span class="hljs-title"><span class="hljs-title">namespace</span></span>\<span class="hljs-title"><span class="hljs-title">to</span></span>\<span class="hljs-title"><span class="hljs-title">en</span></span>\<span class="hljs-title"><span class="hljs-title">CSRF</span></span>::<span class="hljs-title"><span class="hljs-title">className</span></span>(), ] ], ] ]; $sessionToken = <span class="hljs-string"><span class="hljs-string">'foo'</span></span>; $requestToken = <span class="hljs-string"><span class="hljs-string">'bar'</span></span>; $v = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Validate($config); $v-&gt;csrf($sessionToken)-&gt;validate($requestToken); <span class="hljs-comment"><span class="hljs-comment">// output: false $v-&gt;getErrors(); /* output: [ 'csrf' =&gt; 'CSRF-token must be valid', ] */</span></span></code> </pre><br>  Thus, it is possible to substitute the <a href="https://github.com/romeOz/rock-validate/blob/master/src/Validate.php">existing rules</a> . <br><br><h4>  Additional features </h4><br>  There is a scenario when you need to skip the "empty" values.  For example, for form fields optional to fill.  For these purposes, there is a property skipEmpty - sets the reaction for each rule to "empty" values.  For some rules, this property is set to false (do not skip), namely: Required, Arr, Bool, String, Int, Float, Numeric, Object, NullValue, Closure, all ctype-rules.  Example: <br><br><pre> <code class="php hljs">$v = Validate::email(); $v-&gt;validate(<span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-comment"><span class="hljs-comment">// output: true</span></span></code> </pre><br>  This behavior can be canceled: <br><br><pre> <code class="php hljs">$v-&gt;skipEmpty(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)-&gt;validate(<span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-comment"><span class="hljs-comment">// output: false</span></span></code> </pre><br>  By default, empty values ‚Äã‚Äãare $ value === null ||  $ value === [] ||  $ value === ''.  For each of the rules, it is possible to set your own isEmpty handler: <br><br><pre> <code class="php hljs">$config = [ <span class="hljs-string"><span class="hljs-string">'rules'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'custom'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; \<span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span>\<span class="hljs-title"><span class="hljs-title">to</span></span>\<span class="hljs-title"><span class="hljs-title">CustomRule</span></span>::<span class="hljs-title"><span class="hljs-title">className</span></span>(), '<span class="hljs-title"><span class="hljs-title">locales</span></span>' =&gt; [ '<span class="hljs-title"><span class="hljs-title">en</span></span>' =&gt; \<span class="hljs-title"><span class="hljs-title">namespace</span></span>\<span class="hljs-title"><span class="hljs-title">to</span></span>\<span class="hljs-title"><span class="hljs-title">en</span></span>\<span class="hljs-title"><span class="hljs-title">Custom</span></span>::<span class="hljs-title"><span class="hljs-title">className</span></span>(), ], '<span class="hljs-title"><span class="hljs-title">isEmpty</span></span>' =&gt; <span class="hljs-title"><span class="hljs-title">function</span></span>($<span class="hljs-title"><span class="hljs-title">input</span></span>){ <span class="hljs-title"><span class="hljs-title">return</span></span> $<span class="hljs-title"><span class="hljs-title">input</span></span> === ''; } ], ] ]; $v = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Validate($config);</code> </pre><br><h4>  Installation </h4><br><pre> <code class="bash hljs">composer require romeoz/rock-validate:*</code> </pre><br><h4>  And look? </h4><br><ul><li>  <a href="https://github.com/romeOz/rock-validate"><b>Project on github</b></a> </li><li>  <a href="https://github.com/romeOz/rock-validate"><b>Documentation</b></a> </li></ul><br>  There is a small <a href="https://github.com/romeOz/docker-rock-validate">demo</a> that you can run with <a href="https://docs.docker.com/installation/">Docker</a> : <br><br><pre> <code class="bash hljs">docker run --name demo -d -p 8080:80 romeoz/docker-rock-validate</code> </pre><br>  The demo will be available at <a href="http://localhost:8080/">http: // localhost: 8080 /</a> </div><p>Source: <a href="https://habr.com/ru/post/253621/">https://habr.com/ru/post/253621/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../253611/index.html">And for whom are you Habrahabr</a></li>
<li><a href="../253613/index.html">Mirantis OpenStack 6.0: now with plugins</a></li>
<li><a href="../253615/index.html">50% discount on e-books</a></li>
<li><a href="../253617/index.html">As I defended against phishing, and wrote a bicycle, but my own</a></li>
<li><a href="../253619/index.html">Electronic signature in a trusted environment based on the bootable Ubuntu 14.04 LTS and Rutoken EDS Flash</a></li>
<li><a href="../253623/index.html">Anonymous payments: Dash or Bitcoin + Mixers?</a></li>
<li><a href="../253625/index.html">Lectures Technopark. Game design from idea to release</a></li>
<li><a href="../253627/index.html">How Big Data and Internet of Things affect data centers. Power usage. Part 1</a></li>
<li><a href="../253631/index.html">10 relatively unknown facts about K-Meleon</a></li>
<li><a href="../253635/index.html">Automatically highlight links in universal Windows applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>