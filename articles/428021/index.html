<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Seals against neural networks. Or choose and run the neural network to recognize objects on the Raspberry Zero</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day to all. 

 A tiny computer Raspberry is a wonderful thing. I used Raspberry Zero W in a couple of projects for the last six months. Bribed th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Seals against neural networks. Or choose and run the neural network to recognize objects on the Raspberry Zero</h1><div class="post__text post__text-html js-mediator-article">  Good day to all. <br><br>  A tiny computer Raspberry is a wonderful thing.  I used Raspberry Zero W in a couple of projects for the last six months.  Bribed the simplicity of typing and hauling various ideas.  And now the optional question interested, will this device draw a full convolutional grid?  [Spoiler - pull, but there are fun nuances].  Who is interested in the topic - welcome under cat.  Be careful, there will be many cats! <br><br><img src="https://habrastorage.org/webt/8b/mr/ki/8bmrkihh9e5nc34ibcorjmjuwos.jpeg" alt="image"><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Why Raspberry Neural Network? </h2><br>  Once I gathered at Raspbery Zero W a simple video trap to monitor the nightlife of animals (mostly cats) in the country.  The code was simple and worked well.  For video-photo detection, an infrared camera was used like <a href="https://ru.aliexpress.com/item/Raspberry-Pi-3-Camera-Focal-Adjustable-Night-Vision-Camera-Module-IR-Sensor-Light-Acryclic-Holder-FFC/32799003871.html%3Fspm%3Da2g0s.9042311.0.0.45b233edGxAtKj">this ‚ÄúRaspberry Pi Night Version Camera‚Äù</a> . <br><br><img src="https://habrastorage.org/webt/is/4n/el/is4nelvh4jnhu9d_muw2-shijuy.jpeg" alt="image"><br><br>  The essence of the code is to take two consecutive frames, compare pixel by pixel, and if the number of changed pixels is more than a certain threshold value, start recording a 10-second video.  The text of the code in this post will not give, if someone is interested, write in the comments, I can put in the following.  The main chip, put the receipt of two compared frames in 0.2 seconds at least to catch the fast events.  Well, quickly compare these frames, of course. <br><br>  Then the idea arose of screwing a simple neural network to the algorithm, so that you could define an object in a captured frame and start recording video only if the class of the object was reliably determined.  This potentially eliminates the false positives of the video trap.  These happen from moving objects (for example, grass or branches) or from the sharp illumination of the camera scene (the light in the window turned on or the lamp went out, for example). <br><br><h2>  What kind of mesh to put on Raspberry? </h2><br>  Fortunately, under the pre-installed Python (in my case it is 3.5.3) and widely available OpenCV (I use 3.4.3), you can put almost any mesh.  Unfortunately, due to the limited computing capabilities of the device, the list of options is small.  In fact, you can choose only from the "light" options: <br><br>  1. SqueezeNet (sample code <a href="http://cv-blog.ru/%3Fp%3D105">here</a> ). <br>  2. YOLO Tiny ( <a href="https://github.com/CiscoBlockChain/YOLO-Pi">here</a> ). <br>  3. MobileNet-SSD ( <a href="https://heartbeat.fritz.ai/real-time-object-detection-on-raspberry-pi-using-opencv-dnn-98827255fa60">here</a> ). <br>  4. MobileNet_v1_224 (there is a fantastic <a href="https://www.youtube.com/watch%3Fv%3DzRaQS5MA2fU">video of the work of the object detector on this grid</a> ). <br><br>  In all the cases listed above, the opportunity to use the model trained in respectable datasets is captivating, thereby relieving oneself of all the agony and anxieties of an independent data set and the subsequent training on them of a neural network. <br><br>  Applicant No. 1 was inspired by the <a href="https://arxiv.org/pdf/1602.07360.pdf">declared high accuracy of recognition</a> with modest weights.  In addition, a brief Internet search brought to <a href="https://www.pyimagesearch.com/author/adrian/">Adrian Rosebrock‚Äôs</a> awesome blog, which commented in detail on the code and outlined several options for implementing deep learning on Raspberry. <br><br>  To test the capabilities of SqueezeNet, we used the code <a href="https://www.pyimagesearch.com/2017/10/02/deep-learning-on-the-raspberry-pi-with-opencv/">from here</a> .  The author of the code sends the weights and textual representation of the model to an email after filling out the form on the website.  By the way, if you do not have OpenCV installed, you can find an algorithm of actions in his own blog.  Plus, there are also examples of ‚Äúoverclocking‚Äù of the code to speed up the model operation time and much more.  Respect Adriana, really cool resource. <br><br>  Well, we run the code and on the very first picture we get a stunning result! <br><br><img src="https://habrastorage.org/webt/9w/ip/c3/9wipc305vgfjkeprf21e4dv2ruc.jpeg" alt="image"><br><br>  The cat in the picture is defined as Persian with a probability of 99%.  In fact, he is not a Persian, but a British longhair or Highlander.  But for a model with a range of 1000 classes, one can say, hit the bull's eye.  For convenience, I put the main results of the neural network directly on the photo.  These are the 5 most probable classes, the first is the most likely, the second is the next in importance, and so on. <br><br>  By the way, the model counts object classes in my Zero 6.5 seconds.  According to Adrian, the calculation for the Raspberry Pi B + on the pictures in his post (photo of the barber shop, cobra and jellyfish) will take about 0.92 seconds.  I readily believe that a full-fledged version of the Raspberry 4 cores in the processor after all.  I suppose everyone knows that Zero has only one ((( <br><br>  It seems that you will have to forget about determining the class of an object in real time at Zero.  By the way, I must admit that even the second of the time spent on the work of the model on a ‚Äúfull-fledged‚Äù Pi is also far from the limit of dreams. <br><br>  But we will continue testing the model. <br><br><img src="https://habrastorage.org/webt/l6/ga/sg/l6gasgvwsavydyknmgm2ayzy948.jpeg" alt="image"><br><br>  The cat changed its position and lost as much as 7% of its former ‚ÄúPersianness‚Äù).  But this is a joke, of course, in general, the work of the model is very high.  It was possible to finish this very spot, but I wanted to slightly complicate the task of the model.  Let's continue to exercise on ... cats.  But recruit frames where the cat is not sitting in the classic position, and sleeping, for example.  So let's go. <br><br><img src="https://habrastorage.org/webt/zm/qc/a6/zmqca6rk4v_kswhdc2zobjivz5o.jpeg" alt="image"><br><br>  In this picture, the cat is defined as Angora, but this is not accurate.  Apparently from the fact that she was annoyed by the obsessive request to leave the sink.  Well, the neural network was mistaken, well, who does not happen in the end? <br><br><img src="https://habrastorage.org/webt/4c/ki/4-/4cki4-dqt-fsq0nxfcbtzkgdpdo.jpeg" alt="image"><br><br>  It turns out that a fluffy soccer ball lives in my house) Yes, it happens that people are not at all what they seem at first glance.  Fighting cats and neural networks takes a serious turn. <br><br><img src="https://habrastorage.org/webt/og/v7/7d/ogv77daxm11eov32uhjf4-ssv2m.jpeg" alt="image"><br><br>  Wow.  Now she is a Siberian Husky.  Something tells me that the cat is still in the account) <br><br><img src="https://habrastorage.org/webt/3k/bs/n4/3kbsn40vaigsobq41ks9rmnj1vc.jpeg" alt="image"><br><br>  It seems that one of these two is clearly knocked down and this is clearly not a cat.  Now it is defined by the neural network as a spindle (albeit only by 8.5%), there are also options that it is a beagle, a killer whale, a rocky python or a skunk.  Not a cat, but a woman of mystery! <br><br><img src="https://habrastorage.org/webt/pk/8j/tv/pk8jtvc5aeesdnetalwdfxep-jw.jpeg" alt="image"><br><br>  Come on!  It's all the same killer whale!  Yes, yes, a marine mammal of the order of cetaceans.  For some reason, I remembered lines from a distant childhood: <br>  "There is no order in this tale <br>  Here is a mistake, a typo!  Someone, <br>  Against any rules <br>  In the tale, the letters are rearranged, <br>  Ferried <br>  "KIT" on "CAT", <br>  "CAT" on "KIT", on the contrary! ". <br>  Ringing gong, the referee stops the fight) <br><br><img src="https://habrastorage.org/webt/xf/bp/-7/xfbp-7svqzxku4awsfk-cxx7fpi.jpeg" alt="image"><br><br>  In the second round, the cat, wearing insidiously wearing glasses, stepped down for the Boston bulldog with a probability of 34%.  Or for the French.  It seems that the neural network has not fully recovered from the defeat in the first round) <br><br><img src="https://habrastorage.org/webt/ao/c8/j5/aoc8j5rjtsgodpe4hwpjex94mgs.jpeg" alt="image"><br><br>  Well, finally!  The cat is defined as Siamese with a probability of as much as 66%!  Bravo, SqueezeNet!  But seriously, it seems that in the original dataset photos of not lying cats prevailed.  Lying were mostly dogs) <br><br><img src="https://habrastorage.org/webt/0p/oz/ro/0pozrokqqgilu4xfmtpumwzrlkm.jpeg" alt="image"><br><br>  The ability of cats to take the form of a box confuses even people, what can we say about the neural network.  Immersion to the box reduced recognition accuracy by as much as 40%. <br><br><img src="https://habrastorage.org/webt/zj/is/nr/zjisnron-r3rauwfpsjtfld1694.jpeg" alt="image"><br><br>  So, so ... And this, it seems, is generally prohibited reception.  A computer mouse lying next to a cat finally confuses a neural network.  Now our cat is a mouse!  ) <br><br>  So, all the neural networks were presented 11 photos of cats, of which only 5 were correctly identified. At the same time, with a probability of more than 50% in only three cases.  In no way detract from the work of the authors SqueezeNet.  This is a good-quality network with a very wide class of objects and relatively low resource requirements. <br><br>  The article, of course, is a comic character, but quite pragmatic conclusions can be drawn from the obtained data.  It is necessary to use pre-trained neural networks with great care, checking them on real images of the task for which you plan to use the neural network. <br><br>  As for choosing the optimal neural network for Raspberry, the question remains open.  I continue to experiment, with the interest of the audience to this topic, I will share the results of further research.  Simply, the results of the first step were so funny that I really wanted to share them. <br><br>  Thank you for reading to the end.  Good luck and good work week) <br><br>  UPD: The working code for running the neural network on the Raspberry Pi Zero W is in the <a href="https://habr.com/post/429400/">second part of</a> this post. </div><p>Source: <a href="https://habr.com/ru/post/428021/">https://habr.com/ru/post/428021/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../428005/index.html">Three effective ways to aggravate PR disaster</a></li>
<li><a href="../428007/index.html">Already not luggable pc, not yet notebook: Laptop TOSHIBA T3100 / 20</a></li>
<li><a href="../428009/index.html">Equifax: one year after the largest data breach</a></li>
<li><a href="../428011/index.html">Space Zombie Songs</a></li>
<li><a href="../428019/index.html">Playing Mortal Kombat with TensorFlow.js</a></li>
<li><a href="../428023/index.html">Basics of electrical safety in the design of electronic devices</a></li>
<li><a href="../428025/index.html">Connecting the paging file (SWAP) in MAC OS X when using an external SSD-drive as a system</a></li>
<li><a href="../428027/index.html">How I tried to make a static analyzer GLSL (and what went wrong)</a></li>
<li><a href="../428029/index.html">Digital events in Moscow from October 29 to November 4</a></li>
<li><a href="../428031/index.html">Integration of 3CX with 1C: Trade Management - a method of combining configurations</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>