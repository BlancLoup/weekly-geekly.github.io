<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google Chrome Extensions: a quick do-it-yourself translator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently I noticed that even if my English is not so bad, I still often get distracted by the translation of certain unfamiliar words. And since I was...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google Chrome Extensions: a quick do-it-yourself translator</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/148/723/aff/148723affa9ca09ff095c62e0db603f1.jpg" alt="image"><br><br>  Recently I noticed that even if my English is not so bad, I still often get distracted by the translation of certain unfamiliar words.  And since I was tired of spending my time on it, I decided to write an extension-translator.  Can say <blockquote>  But there are already! </blockquote>  Yes, there is, but, firstly, I did not write browser extensions before and wanted to try, secondly, it‚Äôs always more fun to create something myself than to use ready-made ones.  So to whom it is interesting as well as me - welcome under cat. <br><a name="habracut"></a><br>  And I decided to write the article itself, because I had to collect a lot of information in parts from the far corners of the Internet and I decided to combine everything a little. <br><br>  So, <s>sit down closer to the fireplace</s> open Notepad ++, VS Code or any other convenient editor and start. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  1. Preparing the necessary files </h2><br>  We will need: <br><br><ol><li>  Manifest.json - version of our extension, name, list of used files, permissions will be stored here. </li><li>  Popup.html is the face of our extension, here we will write a popup page that will be displayed when clicking on the icon of our extension </li><li>  Background.html are all background processes of our extension. </li><li>  4 icons: 16x16, 36x36, 48x48, 128x128 - this is the icon of your application, chrome and can itself customize the icon to the desired size, but you can set different icons and depending on this they will be different in the context menu, near the address bar, in the menu extensions, etc. </li></ol><br><div class="spoiler">  <b class="spoiler_title">Immediately a small footnote on how to upload extensions to google chrome:</b> <div class="spoiler_text"><ol><li>  Save all extension files to a separate folder. </li><li>  Open Google Chrome -&gt; Options -&gt; Settings -&gt; Extensions </li><li>  We tick <i>the developer mode</i> , click to <i>load the unpacked extension</i> . <br><img src="https://habrastorage.org/getpro/habr/post_images/660/61f/8a1/66061f8a1d6f5d8fd6ba41ebe698aa4e.png" alt="image"></li><li>  Specify the path to the folder with the extension, click OK </li></ol><br></div></div><br><h2>  2. Parable about the manifest and popup </h2><br><blockquote>  And the programmer created a manifesto and the programmer saw that it was good. </blockquote><br>  Our manifest.json should look like <div class="spoiler">  <b class="spoiler_title">like that:</b> <div class="spoiler_text"><pre><code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"manifest_version"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Translator"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"icons"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"16"</span></span>: <span class="hljs-string"><span class="hljs-string">"16x16.png"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"32"</span></span>: <span class="hljs-string"><span class="hljs-string">"32x32.png"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"48"</span></span>: <span class="hljs-string"><span class="hljs-string">"48x48.png"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"128"</span></span>: <span class="hljs-string"><span class="hljs-string">"128x128.png"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"permissions"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"http://translate.yandex.net/*"</span></span>, <span class="hljs-string"><span class="hljs-string">"contextMenus"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"browser_action"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"default_title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Open translator"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"default_icon"</span></span>: <span class="hljs-string"><span class="hljs-string">"48x48.png"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"default_popup"</span></span>: <span class="hljs-string"><span class="hljs-string">"popup.html"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"background"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"page"</span></span>: <span class="hljs-string"><span class="hljs-string">"background.html"</span></span> } }</code> </pre> <br></div></div><br>  Now in order: <br><br><ul><li>  manifest_version is the version of our manifest, now version 2 is relevant. </li><li>  name - extension name </li><li>  version - version of the extension, there should be <b>only</b> numbers, but in any format: 1.0 or 1.0.0.1 or 1.1.2, you can write as you like. </li><li>  icons - the list of icons of our extension </li><li>  permissions - permissions of our extension, the link gives access to a specific resource, contextMenus gives access to the context menu. </li><li>  browser_action: default_title - the text that will appear when you hover the mouse over the extension icon, default_icon is the default application icon, default_popup is the default popup window. </li><li>  background - here you can connect the background page, if it exists or background scripts. </li></ul><br>  With the manifesto figured out, now you can go to a more interesting lesson.  Before we begin to create a View of our extension - we need to download additional files of all colors and colors.  In general, this is optional and someone can write an extension on pure JS, without third-party styles, but I wanted to use <a href="https://jquery.com/">Jquery</a> and <a href="">Bootstrap</a> . <br><br>  I decided especially not to bother with the look and quickly rolled up a more or less nice window decent looking translator. <br><br><div class="spoiler">  <b class="spoiler_title">popup.html</b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jquery.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"popup.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bootstrap.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bootstrap.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bootstrap-theme.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"popup.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"logo"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mixx.png"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrapper"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"li"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"form-control"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"li"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"margin-bottom: 10px;"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn_submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn btn-default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"margin-top: 10px;"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">footer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"options"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">role</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"result"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">footer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  <i>I do not know how personally you, the reader, are in html, js and css, but at this level I do not set out to explain the principles of these languages ‚Äã‚Äãto you, everything that I use and do not explain is rather primitive and easy to google.</i> <br><br>  Styles are not at all necessary, you can do without them, but with them everything looks a little friendlier and more beautiful. <br><br>  Create a popup.css file and add some styles: <br><br><div class="spoiler">  <b class="spoiler_title">popup.css</b> <div class="spoiler_text"><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">body</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">min-width</span></span>: <span class="hljs-number"><span class="hljs-number">250px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">margin</span></span>: <span class="hljs-number"><span class="hljs-number">0px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">font-family</span></span>: Segoe UI, Arial, sans-serif; <span class="hljs-attribute"><span class="hljs-attribute">font-size</span></span>: <span class="hljs-number"><span class="hljs-number">13px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: <span class="hljs-number"><span class="hljs-number">#f8f6f2</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">header</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">45px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">margin-bottom</span></span>: <span class="hljs-number"><span class="hljs-number">40px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-bottom</span></span>: <span class="hljs-number"><span class="hljs-number">1px</span></span> solid <span class="hljs-number"><span class="hljs-number">#e1ddd8</span></span>; } <span class="hljs-selector-id"><span class="hljs-selector-id">#logo</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">display</span></span>: block; <span class="hljs-attribute"><span class="hljs-attribute">position</span></span>: relative; <span class="hljs-attribute"><span class="hljs-attribute">top</span></span>: <span class="hljs-number"><span class="hljs-number">15px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">margin</span></span>: <span class="hljs-number"><span class="hljs-number">0px</span></span> auto; } <span class="hljs-selector-id"><span class="hljs-selector-id">#wrapper</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>: <span class="hljs-number"><span class="hljs-number">0px</span></span> <span class="hljs-number"><span class="hljs-number">20px</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">footer</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">cursor</span></span>: pointer; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>: <span class="hljs-number"><span class="hljs-number">10px</span></span> <span class="hljs-number"><span class="hljs-number">35px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-top</span></span>: <span class="hljs-number"><span class="hljs-number">1px</span></span> solid <span class="hljs-number"><span class="hljs-number">#e1ddd8</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">footer</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:hover</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">linear-gradient</span></span>(to bottom, rgba(70, 50, 0, 0.1), <span class="hljs-built_in"><span class="hljs-built_in">rgba</span></span>(70, 50, 0, 0.1)); } <span class="hljs-selector-class"><span class="hljs-selector-class">.li</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">list-style-type</span></span>: none; <span class="hljs-attribute"><span class="hljs-attribute">border-top</span></span>: <span class="hljs-number"><span class="hljs-number">1px</span></span> dashed <span class="hljs-number"><span class="hljs-number">#a5a4a1</span></span>; } <span class="hljs-selector-tag"><span class="hljs-selector-tag">label</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">vertical-align</span></span>: middle; }</code> </pre><br></div></div><br>  Now our extension should look something like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/738/992/aaf/738992aaf3b4c1696b3a31fe37b03b5c.jpg" alt="image"></div><br>  Now you can go to the very logic of the translator, create a file <div class="spoiler">  <b class="spoiler_title">popup.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs">$(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>).ready(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ $(<span class="hljs-string"><span class="hljs-string">'#btn_submit'</span></span>).click(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*    ,        id = "btn_submit" */</span></span> translate($(<span class="hljs-string"><span class="hljs-string">'#input'</span></span>).val()); }); }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">translate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">input</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> url = <span class="hljs-string"><span class="hljs-string">"https://translate.yandex.net/api/v1.5/tr.json/translate"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*  ,      ,    1.5  ,   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> key = <span class="hljs-string"><span class="hljs-string">"trnsl.1.1.20170124T214153Z.11b2724899c0a9fc.6d5c7e3a02107ce1349d21bbc6dc9dd4a86dc62a"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*    ,       ,     &lt;b&gt; !&lt;/b&gt; https://tech.yandex.ru/keys/get/?service=trnsl ( )*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parent = <span class="hljs-regexp"><span class="hljs-regexp">/[-]/i</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> language = (parent.test(input))? <span class="hljs-string"><span class="hljs-string">'ru-en'</span></span>:<span class="hljs-string"><span class="hljs-string">'en-ru'</span></span>; $.getJSON(url, {<span class="hljs-attr"><span class="hljs-attr">lang</span></span>: language, <span class="hljs-attr"><span class="hljs-attr">key</span></span>: key, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: input}, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> $(<span class="hljs-string"><span class="hljs-string">'#result'</span></span>).text(<span class="hljs-string"><span class="hljs-string">""</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> res.text) { $(<span class="hljs-string"><span class="hljs-string">'#result'</span></span>).text($(<span class="hljs-string"><span class="hljs-string">'#result'</span></span>).text() + res.text[i] + <span class="hljs-string"><span class="hljs-string">" "</span></span>); } }); }</code> </pre><br></div></div><br>  Save and load our extension in chrome.  Sometimes the button to <i>update the extension</i> does not help and then you need to delete the extension and reload it. <br><br>  We check the work, we should get something like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ab1/e61/6ae/ab1e616ae16c19dec7103a01e9750b42.jpg" alt="image"></div><br>  It seems to have tried well, but something is missing.  Add a reaction to the Enter key. <br><br><div class="spoiler">  <b class="spoiler_title">Add code to popup.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs">$(<span class="hljs-string"><span class="hljs-string">"#input"</span></span>).keyup(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(event.keyCode == <span class="hljs-number"><span class="hljs-number">13</span></span>){ <span class="hljs-comment"><span class="hljs-comment">/* 13 -    Enter $("#btn_submit").click(); } });</span></span></code> </pre> <br></div></div><br>  Check and see that you can now press enter, and not click on the button.  But you need to add at least one more function that is present in most translators - this is copying the translated text to the clipboard. <br><br><div class="spoiler">  <b class="spoiler_title">Add code to popup.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> options = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"options"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(options) { options.addEventListener(<span class="hljs-string"><span class="hljs-string">"click"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) /*      </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">footer</span></span></span><span class="hljs-function"> */ </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> range = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createRange(); *<span class="hljs-regexp"><span class="hljs-regexp">/     Range. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> value = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">"#result"</span></span>); <span class="hljs-comment"><span class="hljs-comment">/*     id = "result" */</span></span> range.selectNode(value); <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.getSelection().addRange(range); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> successful = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.execCommand(<span class="hljs-string"><span class="hljs-string">'copy'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> msg = successful ? <span class="hljs-string"><span class="hljs-string">'successful'</span></span> : <span class="hljs-string"><span class="hljs-string">'unsuccessful'</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Copy email command was '</span></span> + msg); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(err) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Oops, unable to copy'</span></span>); } <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.getSelection().removeAllRanges(); });</code> </pre> <br></div></div><br>  Well, we did a good job on the view, now we have a good translator, moreover, written by us!  But not everyone will be satisfied with such a result, for the same tireless adventure seekers who are trying to bring the instrument to perfection, but at least to make it as convenient as possible - we will not stop there! <br><br><h2>  Saga of background.js </h2><br>  The translator is, of course, good, but after all, taking, copying and pasting text is also tiring, so we need to make sure that our extension translates the text we select. <br><br>  Background.html - background page and one of its features is to add an item to the context menu.  In the background.html itself, we just connect the scripts, we need them. <br><br><div class="spoiler">  <b class="spoiler_title">background.html</b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jquery.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"background.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br>  But with the background.js we have more fun.  Create a point of our application in the menu: <br><br><div class="spoiler">  <b class="spoiler_title">Add to background.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs">chrome.contextMenus.create({ <span class="hljs-string"><span class="hljs-string">'title'</span></span>: <span class="hljs-string"><span class="hljs-string">'  Translator'</span></span>, <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> <span class="hljs-string"><span class="hljs-string">'contexts'</span></span>:[<span class="hljs-string"><span class="hljs-string">'selection'</span></span>], <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> <span class="hljs-string"><span class="hljs-string">'onclick'</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{} <span class="hljs-comment"><span class="hljs-comment">/*   ,         */</span></span> });</code> </pre> <br></div></div><br>  Now, when we reload the extension and select some text by right-clicking - we will see that a new item has appeared in the context menu: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c9e/017/eab/c9e017eab2cf6451ae860feef9adfb02.png" alt="image"></div><br>  Now you need to figure out how to translate this text.  At first, I wanted our popup window to open when the text was selected and the translation was there, but I was faced with the fact that Google limited the possibility of opening the window only by clicking on the icon.  Then I <s>picked up the sword</s> decided to make a translation in the context menu, as it was done in the Yandex browser: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4a3/522/ee6/4a3522ee6cc4b6941947a7ce25f1651e.jpg" alt="image"></div><br>  But I could not find information on how to change the context menu in this way.  I don‚Äôt want to open new tabs, so here we are a little shallow. <br><br>  In background.js in place of the old empty function, insert this line: <br><br><div class="spoiler">  <b class="spoiler_title">Paste the code into background.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">info, tab</span></span></span><span class="hljs-function">) </span></span>{ translate(info.selectionText) }</code> </pre> <br></div></div><br>  And add the translate function separately: <br><br><div class="spoiler">  <b class="spoiler_title">Paste the code into background.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">translate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">input</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> url = <span class="hljs-string"><span class="hljs-string">"https://translate.yandex.net/api/v1.5/tr.json/translate"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> key = <span class="hljs-string"><span class="hljs-string">"trnsl.1.1.20170124T214153Z.11b2724899c0a9fc.6d5c7e3a02107ce1349d21bbc6dc9dd4a86dc62a"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parent = <span class="hljs-regexp"><span class="hljs-regexp">/[-]/i</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> language = (parent.test(input))? <span class="hljs-string"><span class="hljs-string">'ru-en'</span></span>:<span class="hljs-string"><span class="hljs-string">'en-ru'</span></span>; $.getJSON(url, {<span class="hljs-attr"><span class="hljs-attr">lang</span></span>: language, <span class="hljs-attr"><span class="hljs-attr">key</span></span>: key, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: input}, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function">)</span></span>{ alert(res.text); }); }</code> </pre> <br></div></div><br>  Let's check the work and see that when we select the text and click the translate button in the context menu, this window appears: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8a3/a60/317/8a3a603172a0ade57e1f23bb02e4b578.png" alt="image"></div><br>  Well, that's all, friends!  If someone tells you the best way to implement the translation using the context menu, I will be glad to hear. <br><br><hr><br>  For information on the implementation of such things, I express my gratitude to the articles on Habrahabr and the responses to StackOverflow. </div><p>Source: <a href="https://habr.com/ru/post/320776/">https://habr.com/ru/post/320776/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../320762/index.html">A small comparison of the performance of the MongoDB vs ClickHouse DBMS</a></li>
<li><a href="../320764/index.html">Dell EMC: Convergence Conversion</a></li>
<li><a href="../320766/index.html">Comparison of 7 photogrammetry systems. What is better to choose?</a></li>
<li><a href="../320768/index.html">BGP Fake-AS</a></li>
<li><a href="../320772/index.html">The difference between statistics and data science</a></li>
<li><a href="../320778/index.html">Recheck SharpDevelop: What's New?</a></li>
<li><a href="../320780/index.html">Vysor is a handy tool for testing.</a></li>
<li><a href="../320782/index.html">Agile is dead, long live ... Agile</a></li>
<li><a href="../320784/index.html">Kamailio SIP proxy: an example of installation and minimum configuration</a></li>
<li><a href="../320788/index.html">How to make friends Custom View and keyboard</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>