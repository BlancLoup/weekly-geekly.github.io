<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>JavaScript Augmented Reality - JSARToolkit test</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="JSARToolkit is a JavaScript library ported with FLARToolkit (Flash) and intended to track AR Markers on video. ARToolKit converts data from markers to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>JavaScript Augmented Reality - JSARToolkit test</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c58/758/2cb/c587582cb123b60ecf2f2a2080c81419.png" alt="If the picture is not displayed, please write to the author."></div><br>  <a href="https://github.com/kig/JSARToolKit">JSARToolkit</a> is a JavaScript library ported with FLARToolkit (Flash) and intended to track AR Markers on video.  ARToolKit converts data from markers to 3D coordinates, using them you can superimpose images or 3D objects on a flat surface. <br><br>  You've probably already seen JSARToolkit in action on the <a href="http://fhtr.org/">Ilmari Heikkinen</a> <a href="https://mozillademos.org/demos/remixingreality/demo.html">demo</a> - <a href="https://mozillademos.org/demos/remixingreality/demo.html">Remixing Reality</a> . <br>  Ilmari's demo is part of Mozillov's ‚Äú <a href="https://demos.mozilla.org/en-US/">Web O 'Wonder</a> ‚Äù, a site showing new technologies that will be added to <a href="http://www.mozilla.com/en-US/firefox/RC/">Firefox 4</a> . <br><br><h4>  HTML5 Clip Studies </h4><br>  The customer gave us a task - to evaluate the possibility of using JSARToolkit for online HTML5 clips.  (We were asked to consider only those users who used the latest version of Firefox and Chrome) <br>  Here are some of the questions we would like to answer: <br>  - Will the processing be fast on slow computers? <br>  - How many AR Markers can we track at the same time? <br>  - How fast can you move the marker so that it becomes not traceable? <br>  - What is the greatest distance at which the camera can track the marker? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Answers to these questions, source code and demos can be found below. <br><a name="habracut"></a><br><h4>  Video recording </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/449/6e4/be5/4496e4be57b0448fd86017f7f9ac6c75.png" align="left">  I used Flip Ultra HD to record a test video.  Flip Ultra HD video quality is acceptable, considering that this is not a professional camera.  We knew that we would not get anything good from such a camera, but that was enough for a test.  The main problem with such a low-quality camera is the inability to switch the shutter speed. <br><br>  This meant that we could not do anything with blurred AR Tags if we moved too fast.  We were surprised at how quickly we lose the marker, when we move from side to side. <br>  However, we are confident that when shooting in a well-lit studio using a camera with a high shutter speed, there will be very few unreadable AR tags. <br><br><h4>  Printing AR Markers </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/daf/e35/81b/dafe3581bca096b24c5141c78e71d185.png" align="left">  I typed a few markers that came with JSARToolkit and started shooting test footage in the kitchen.  I didn‚Äôt even expect that everything will work the first time, every video added to the library turned out to be working. <br><br>  Some of the results were not qualitative, but I want to repeat that the quality of our camera was poor compared to professional ones.  We shot the video without focusing on individual markers, which could add to the accuracy of their tracking. <br><br><h4>  Recoding video to VP8 WebM </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/1ef/1c6/b0d/1ef1c6b0da967d7bccf8ceb0d8f145d6.png" align="left">  We recorded video in H.264 Mpeg format.  For everything to work with HTML5 video, we had to convert the video to WebM.  The first video decoder I tried was Ffmpeg2Theora, judging by the name, it should have encoded the video in WebM.  However, I realized that there are problems with Ffmpeg2Theora.  When I encoded a video under Linux, it could not play in Windows and vice versa. <br><br>  After the tests of other encoders, I stopped at Miro Video Converter.  Unfortunately, Miro cannot handle multiple videos, but the video it produces works on all operating systems and browsers. <br><br><h4>  Create wrapper </h4><br>  I wanted to write a simple JSARToolkit based API that could be reused.  Something that I could connect to another JavaScript library, for example Popcorn.js.  The code I found in the Ilmari demo was task specific.  Since the code was not full of comments, I had problems understanding what was happening.  I had to experiment.  I have come to a simple way of writing a wrapper for JSARToolkit. <br><br>  The first step in using the JSARToolkit wrapper is to install your tracker.  An example of how this can be done: <br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//        var myTracker = jsartoolkit.tracker({ src : 'my-video.webm', //    autoplay : true, //      repeat : true, //   volume : 0, //    target : doc.getElementById('DOMTarget'), // DOM element     canvas width : 720, //   height : 360, //   threshold : 100, //    ratio : 0.5, //    canvas   (1 = 11  ) debug : false //     -     });</span></span></code> </pre> <br><br>  Once the tracker was created, the next step was to add content to the markers. <br>  We added a static image, and then a 3D object exported from Blender3D: <br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">//     myTracker.marker(0).image('my-image_01.png'); //   Blender3D myTracker.marker(2).model('HTML5_Logo001');</span></span></code> </pre><br>  This example shows how to update the properties of the marker after it has been created: <br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">//    0 myTracker.marker(0) .scale(1) .axis(0, 0, 1) .angle(0) .position(0,0,0) ;</span></span></code> </pre><br>  You can also add more complex behavior using JSARToolkit-Wrapper.  The following example demonstrates how to update the properties of a marker in real time.  This code causes the first marker to spin and pulsate: <br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">//    Marker_0   var interval = global.setInterval( function(){ var date = + new Date(), scl = 1.5 + (Math.sin( date/200 ) * 0.5), axs = Math.cos( date/300 ), posX = Math.sin( date/300 ), posY = Math.cos( date/300 ) ; myTracker.marker(0) .scale(scl) .axis(0, axs, 0) .position(posY, posX, 0) .angle(date / 230) ; }, 20);</span></span></code> </pre><br>  To access the video tracker, you can do something like this: <br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">//        currentTime myTracker.video.currentTime = 1;</span></span></code> </pre><br><br><h4>  Answers on questions </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/166/3b2/18a/1663b218ad2804ab4ed94b46e419b762.png"><br><br>  <b>Will the processing be fast on slow computers?</b> <br>  Video processing and marker positioning is very fast.  I almost did not notice the difference in tracking 1 marker and 100 markers.  The main load - the imposition of content on the video. <br><br>  <b>How many AR-Markers can we track at the same time?</b> <br>  I tracked 100 markers at the same time without any problems. <br><br>  <b>How fast can you move a marker so that it becomes not traceable?</b> <br>  It all depends on your camera and how you shoot.  If you use a camera with a high shutter speed, such as those used to record sports, we will get a minimum of blurry markers (if we get at all) and they will be tracked very well. <br><br>  <b>What is the longest distance a camera can track a marker?</b> <br>  Again, everything depends on several factors - on the speed of movement of the camera / objects and on the lighting.  In a well-lit room (not a professional studio).  I managed to track Markers from 10 meters in the direction of the lens in a resolution of 720p.  The higher the resolution of the camera, the higher the quality of tracking markers.  One thing that is worth noting: you can shoot your video in 1080 resolution, cache the tracking results and reduce the number of processing on the client side.  You can rotate the ratio if something is poorly tracked or the threshold if the frame was poorly lit. <br><br><h4>  Conclusion </h4><br><br><h5>  pros </h5><br>  - Easy to implement <br>  - Optimum tracking algorithm, does not load the processor <br>  - You can track at least 100 markers <br>  - Can be exported directly from Blender3D <br>  - You can overlay any content: pictures, videos, 3D objects <br><br><h5>  Minuses </h5><br>  - Too many global variables in source library code <br>  - It is necessary to tighten up export from Blender3D a little <br>  - Simultaneous processing of multiple videos is not supported. <br>  - Too many costly getElementById () calls <br><br>  You need to do a great job if you want to use this library on a production or make it part of a large library.  But after a huge number of tests and experiments, I will say that this code works amazingly! <br><br><h4>  Examples, Tests and references </h4><br>  <a href="http://code.bocoup.com/webgl/JSARToolkit-Wrapper/JSARToolkit-Wrapper_Demo.html">JSARToolkit-Wrapper Demo</a> <br>  <a href="http://code.bocoup.com/webgl/JSARToolkit-Wrapper/video-tracking-tests">JSARToolkit Video Tests</a> <br>  <a href="http://code.bocoup.com/webgl/JSARToolkit-Wrapper/marker-images">JSARToolkit Marker Images</a> <br>  <a href="https://github.com/Bocoup/JSARToolkit-Wrapper">JSARToolkit-Wrapper on Github</a> <br><br>  You need the latest version of Firefox 4 or Chrome to view. <br><br><h4>  From translator </h4><br>  The author unfortunately has not yet posted a demo.  The use of AR in the form in which it is presented in translation is not very broad, but with the advent of <a href="http://habrahabr.ru/blogs/html5/113547/">HTML5 Device Element</a> ( <a href="http://ajaxian.com/archives/video-conferencing-with-the-html5-device-element">another article</a> ), everything can change. <br>  AR Soon and in your browser;) </div><p>Source: <a href="https://habr.com/ru/post/115485/">https://habr.com/ru/post/115485/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../115476/index.html">Answers ABBYY CEO Sergey Andreev to questions from readers Habr. Part 3</a></li>
<li><a href="../115480/index.html">TransactionScope - tempting, but treacherous</a></li>
<li><a href="../115481/index.html">Lost in static</a></li>
<li><a href="../115482/index.html">Web development issues in the middle lane</a></li>
<li><a href="../115483/index.html">Droider Chart 43. Hit parade of Android applications</a></li>
<li><a href="../115486/index.html">Iran has created a special unit that carries out attacks against "enemy sites"</a></li>
<li><a href="../115487/index.html">Wikimedia Foundation Director admitted that Wikipedia has serious problems</a></li>
<li><a href="../115488/index.html">Moscow DrupalConf'2011 - April 23</a></li>
<li><a href="../115489/index.html">Catalog Softline-direct can be read on the iPad</a></li>
<li><a href="../115490/index.html">Rest in Peace, Zune</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>