<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New in Reflection for .NET 4.5</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=".NET 4.5 includes some changes to System.Reflection. The most significant of these is that Type is now divided into two separate classes: Type and Typ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New in Reflection for .NET 4.5</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/0a4/ad8/7bf/0a4ad87bfba73819105e3decad42452a.png" align="right">  .NET 4.5 includes some changes to System.Reflection.  The most significant of these is that Type is now divided into two separate classes: Type and TypeInfo.  The TypeInfo object stores the full definition, and the Type itself now stores only shared data.  If you use reflection from your desktop or web application under NET 4.5, then the old API is still available along with new methods of reflection.  Today, I will focus on how to use some of the main features of the new API. <a name="habracut"></a><br><br>  <b>Type and TypeInfo overview</b> <br><br>  The Type class provides an overview of the structure of an object.  TypeInfo, on the other hand, represents the complete definition of an object, including its association with the parent and inherited classes.  Moreover, the API of the Type class has been updated and now returns collections in the form of typed IEnumerable, and not as before - arrays.  In the case of large and complex assemblies, this allows one to read the values ‚Äã‚Äãof the reflection results one by one, and also simplifies the use of type metadata using LINQ.  Windows Store apps have access only to these new IEnumerable collections. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Type API class changes</b> <br><br>  Let's look at some metadata that can be obtained from Type without using TypeInfo, and then dive into the TypeInfo API.  The API of the Type class allows you to get general information about types.  This means that you can get metadata like name, namespace, full name, module, and so on.  This is done through the same API as in .NET 4.0.  For example, to get the full name and namespace of some type, you can do the following: <br><br><pre><code class="cs hljs">Type stringType = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> fullName = stringType.FullName; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> stringNameSpace = stringType.Namespace;</code> </pre> <br><br>  <b>API TypeInfo</b> <br><br>  As you can see, Type provides an overview of the structure of a class.  If you want to dive a little deeper, then you can use the new API class TypeInfo.  You can get the TypeInfo value from a Type by calling its GetTypeInfo () method.  Take, for example, the Person class, which contains first name properties (FirstName), last names (LastName), the Modified event, and the Save method: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Person</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> FirstName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> LastName { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">event</span></span> EventHandler Modified; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Save</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//    ... } }</span></span></code> </pre><br><br>  Now let's say that you need to know which properties, methods and events are defined in the Person class.  This can be easily learned from TypeInfo using its DeclaredProperties, DeclaredMethods, and DeclaredProperties properties: <br><br><pre> <code class="cs hljs">TypeInfo personInfo = personType.GetTypeInfo(); IEnumerable&lt;PropertyInfo&gt; declaredProperties = personInfo.DeclaredProperties; IEnumerable&lt;MethodInfo&gt; declaredMethods = personInfo.DeclaredMethods; IEnumerable&lt;EventInfo&gt; declaredEvents = personInfo.DeclaredEvents;</code> </pre><br><br>  Another common task of reflection is the need to find all types within an assembly.  Using the updated System.Reflection API, the Assembly class now returns a TypeInfo collection instead of a Type array.  For example, to get all the types defined in the assembly being executed, you can use the TypeInfo.Assembly property, and then read the DefinedTypes property on the resulting Assembly object: <br><br><pre> <code class="cs hljs">Assembly myAssembly = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.GetType().GetTypeInfo().Assembly; IEnumerable&lt;TypeInfo&gt; myTypes = myAssembly.DefinedTypes;</code> </pre><br><br>  To get a better idea of ‚Äã‚Äãthe new System.Reflection APIs, let's create an example of an application that receives a list of all types in the assembly being executed.  And when we select a type, we will display its name, full name, properties, methods, and events. <br><br>  <b>Create an application</b> <br><br>  To begin with, create a new C # Windows Store application and add a class for Person there, as we described earlier.  The next step is to open <i>MainPage.xaml</i> and add <a href="http://visualstudiomagazine.com/articles/2012/11/29/typeinfo-reflection/listing1.aspx">this XAML</a> there as the root element of the Grid. <br><br>  Now let's update the MainPage class so that it collects a list of the types defined in the assembly being executed.  First add <code>using System.Reflection</code> to the top of the file.  Then update the <code>OnNavigateTo</code> method to get the received types from the application assembly and link them to the <code>MyDefinedTypes</code> list: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnNavigatedTo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">NavigationEventArgs e</span></span></span><span class="hljs-function">)</span></span> { Assembly myAssembly = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.GetType().GetTypeInfo().Assembly; IEnumerable&lt;TypeInfo&gt; myTypes = myAssembly.DefinedTypes; MyDefinedTypes.DataContext = myTypes; }</code> </pre><br><br>  Now all we have left is to associate the <code>SelectionChanged</code> event of the <code>MyDefinedTypes</code> element with a handler that will show the selected TypeInfo in the <code>TypeInfoDetails</code> panel: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyDefinedTypes_SelectionChanged</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, SelectionChangedEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.AddedItems.Count &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { TypeInfo selectedTypeInfo = e.AddedItems.First() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> TypeInfo; TypeInfoDetails.DataContext = selectedTypeInfo; TypeInfoDetails.Visibility = Windows.UI.Xaml.Visibility.Visible; } }</code> </pre><br><br>  In the finished form, your MainPage class should look <a href="http://visualstudiomagazine.com/articles/2012/11/29/typeinfo-reflection/listing2.aspx">like this</a> . <br><br>  Congratulations!  Our application is ready and now displays the following result at runtime: <br><img src="https://habrastorage.org/storage2/30e/5d0/0bc/30e5d00bc17ef25ea0755079cd54de7a.png"><br><br>  As you can see, there are quite significant changes in the Type API class.  This is especially important if you are migrating from previous versions of .NET and want to create a Windows Store application in which only a new API is available.  This API is also available in plain desktop and .NET 4.5 web applications, as well as in projects of the Portable Class Library.  I believe that the new API has become cleaner due to the use of IEnumerable instead of arrays, as well as the separation of general and detailed reflection data into two classes: Type and TypeInfo. </div><p>Source: <a href="https://habr.com/ru/post/161095/">https://habr.com/ru/post/161095/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../161081/index.html">Android in every TV: ASUS and Netgear prepare Google TV devices, according to FCC</a></li>
<li><a href="../161083/index.html">TouchDevelop - creating applications on touch devices directly from the browser</a></li>
<li><a href="../161085/index.html">About components and interfaces. Java</a></li>
<li><a href="../161089/index.html">Week Express School Imagine Cup</a></li>
<li><a href="../161093/index.html">Cartesian trees by implicit key + space compression</a></li>
<li><a href="../161097/index.html">Watch out for the BlackBerry Native SDK</a></li>
<li><a href="../161099/index.html">Vint Cerf: we will keep the Internet free and open!</a></li>
<li><a href="../161101/index.html">And nerds do business</a></li>
<li><a href="../161103/index.html">WSS 3.0 Update -> Sharepoint 2010 Foundation, or the right path to Disaster Recovery</a></li>
<li><a href="../161105/index.html">Cross-platform media center XBMC 12 Beta 2 is available for download.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>