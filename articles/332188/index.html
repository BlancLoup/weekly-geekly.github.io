<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Three days like all ticket offices in the country should become online (in fact, not)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Now you can not do that 

 The old logic is this: inside the cash register there is some constant write-only memory to which the cash register writes ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Three days like all ticket offices in the country should become online (in fact, not)</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/web/3b4/728/4a5/3b47284a54784c40b1401a54a02a69e7.jpeg"></div><br>  <i>Now you can not do that</i> <br><br>  The old logic is this: inside the cash register there is some constant write-only memory to which the cash register writes each punched check.  This is realized in the form of <a href="https://ru.wikipedia.org/wiki/%25D0%25AD%25D0%25BB%25D0%25B5%25D0%25BA%25D1%2582%25D1%2580%25D0%25BE%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BA%25D0%25BE%25D0%25BD%25D1%2582%25D1%2580%25D0%25BE%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BB%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B0_%25D0%25B7%25D0%25B0%25D1%2589%25D0%25B8%25D1%2589%25D1%2591%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F">EKLZ</a> - an electronic control protected tape, which is no longer a tape, but a board.  This device requires a lot of hemorrhoids - there is a quest with the replacement, the establishment of a new box office and so on. <br><br>  <b>In the digital world, such problems have been solved by certificates for a very long time.</b>  It is this bun that gives us the FZ-54, which describes the online sending of checks.  It also prohibits from February 1, 2017 to start a new box office of the old type, and from July 1, 2017 (that is, already) to use such cash registers altogether.  That is, if in February it was planned to open a new store, then there should already be an online cash register in it.  From July 1, 2017 all ticket offices should be online. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Small businesses (IP, UTII and patent taxation) could have been degraded until July 1, without any cash register, but then even for vending machines they became mandatory.  In fact, this is unrealistically cool for the country, but ... <br><br>  ... implementation has created a whole mountain of problems.  The first and main thing is the actual speculation with new equipment, because the need for it was more than the manufacturers managed to put on the shelves. <br><a name="habracut"></a><br><h2>  How is the process of transferring data about the check </h2><br>  Now, when you buy something, the data on the stamped check is signed and put into the send buffer.  Logically, this buffer is immediately emptied in real time as data is sent to the fiscal data operator.  In fact - in Russia, the Internet lags, there are exit fairs and other things, where the hell is you, and not the connection.  Therefore, the buffer is stored as long as necessary - up to a month, it seems, nothing terrible should happen. <br><br>  The operator of the fiscal data, having received a check, must inform the cashier that everything is in order, the receipt has been received.  Then he keeps this check "and, if necessary, transfers it to the Federal Tax Service."  As I understand the current implementation logic (this is my personal opinion) - it is just immediately unloaded into the tax one. <br><br><img src="https://habrastorage.org/web/e43/7b4/685/e437b46857ba46129cf8b63c5cb89c24.jpg"><br><br>  On each paper form of the check there is a QR code, which can be scanned and get this check for yourself in the personal account of the State Services or in the tax service application. <br><br>  Instead of scanning, you can drive in parameters with a check with your hands: <br><br><img src="https://habrastorage.org/web/94c/d3d/e1e/94cd3de1e4494f67b3cd59fc14c2d7d6.png"><br><br>  And get this result: <br><br><img src="https://habrastorage.org/web/0dd/e30/199/0dde301996dd45fbb414f5740aae08cc.png"><br><br>  If, within 30 days, the cash desk punches, but does not send checks online, it is automatically blocked (and then a fine is imposed).  The blocking in our modules is implemented at the device firmware level.  <b>UPD: a</b> good <a href="https://habrahabr.ru/company/mosigra/blog/332188/">clarification</a> from <a href="https://habrahabr.ru/users/8arlock/" class="user_link">8arlock</a> about the key of the fiscal sign and 29 days in the comments. <br><br>  That is, now Ikea will be able to carry out his campaign ‚Äúa guarantee of 25 years while keeping the check‚Äù without fear - it will not <abbr title="By the way, who cares, after my persistent inquiries, they added small footnotes to their promotional materials that the check should be kept in a closed box">fade</abbr> in a year to the white state, but will be stored forever in electronic form. <br><br><h2>  Upgrade </h2><br>  To make it all work, you need: <br><br><ol><li>  Update cash register hardware. </li><li>  Get a digital signature for tax to register cashier. </li><li>  Select the fiscal data operator. </li><li>  Remove cash from the account and put it on the account. </li></ol><br>  Point (4) is now made easy through the personal tax office: before it was necessary to go in person, register, wait, bring more documents in a week. <br><br>  The hardware base has almost not changed - these are the same good old terrible cash registers, but now with a network connection module.  And there are cash registers-tablets, as in the future. <br><br><img src="https://habrastorage.org/web/89f/971/ed5/89f971ed5508440ba79f0659ceb37bab.jpeg"><br>  <i>Communication module - cash desk gives data via Ethernet.</i>  <i>There are similar output interfaces with a 3G modem.</i>  <i>UPD: <a href="https://habrahabr.ru/users/pistol/" class="user_link">pistol</a> <a href="https://habrahabr.ru/post/330110/">tells</a> about the driver.</i> <br><br>  We have "Strokes".  Accordingly, there were two options - either to connect a revision module with an FN unit and an activation kit for CTR SHTRIH-M-02F (17 thousand rubles) to the already available cash desk, or to buy a new model of the cash desk - from 27 thousand rubles.  We replaced only the old cash registers with new models.  There is no question for ‚ÄúStroke‚Äù, they are cool and worked very well. <br><br>  On the other hand, sales companies immediately realized that it was possible to sell their registration-integration services.  In our case, the modules were not sold without services for 2000 rubles, which we do not need, and support for 2400 rubles.  It's like an audio system and other gadgets to the car - it seems you don‚Äôt want to take them, and they are not necessary, but if you don‚Äôt take it, there may be no car.  In fact, the modernization modules are almost not sold without this ‚Äústucco‚Äù.  Only perseverance and knowledge of rights changed the situation. <br><br><h2>  Little past </h2><br>  We started explaining the new Federal Law in September; our 1C specialists went to the conference.  At that time, new cash registers were present at the conference stands, but there was only a pre-order, the modules were not sold.  Terms told about.  Shtrikh did not give a clear working instruction and test copy - but not because they are evil reptiles, but because they apparently did not allow the iron to start a series until the final clarifications on the implementation of the law. <br><br>  Toward November-December, modernization kits for new cash registers appeared.  It was clear that everything was done in early beta mode.  Our test toy came without normal instructions, so everything was done with fingers at random.  On the very first day, the ticket office covered itself and refused to send checks to the network - we blunt it with our own experiences.  I had to reflash with a certified partner.  Then a week later, an instruction appeared with clearly described bugs that lead to a drop in the ticket office. <br><br>  We decided to do everything in advance by February, because February and March are a lot of exit fairs, we didn‚Äôt want to bother with the new EKLZ for a short period before replacement, plus we had to have a ticket office for opening points in February.  Again, there was no certainty that 1C will update everything as it should, and we will be able to take and jump in two weeks right away. <br><br>  The IT team put the cash register in the office back in January and started selling games to itself.  There were a lot of improvements - for example, so that the check would normally go to the CRF, so 1C would check the connection and warn sellers if checks are not loaded online. <br><br>  It was necessary to update the checks, incl.  add QR code seal and cashier name.  It is now mandatory.  And now for such as in the picture above (shot in Volgograd) they will now be kicked, unless, of course, the passport is the same. <br><br>  On development and tests - 3 months we slowly invented bicycles, because there was no distinct best practice.  Normally, the ticket office began selling only this year. <br><br><h2>  Nowadays </h2><br>  In April-May, we could not buy upgrades in the right quantity, because they are not stupid, everyone went to the grocery chains.  For example, Pyaterochka and Crossroads are also Strokes-M.  A month and a half ago, approximately at the ONLINE REVOLUTION: all checks in the clouds seminar, they said that there were more than a million registered cash registers in the country, and only 250,000 switched to a new scheme (this is not taking into account those guys who had not beat checks before, but now will have to trade with the cash register). <br><br>  As a result, it became clear to the controlling authorities that not everyone is in time - or rather, the manufacturer does not have time to meet the demand.  There was <a href="http://www.consultant.ru/document/cons_doc_LAW_217507/">such a letter</a> .  The most interesting part: <br><blockquote>  "In order to establish the fact of taking exhaustive measures to comply with the above requirements of the legislation of the Russian Federation, the contract for delivery of a fiscal drive entered into by the user for a reasonable period of time before the expiration of the EKLZ block or the deadline specified by the legislation of the Russian Federation on the use of cash register use. " </blockquote><br>  That is, if there is a pre-order (delivery contract and payment made) to the new cash registers, but they have not yet been delivered, and the old one has not ended the EKLZ - you can print old checks until the cash desks arrive. <br><br><h2>  Fines </h2><br><ul><li>  Old box office, but the check is knocked out - 10 thousand rubles. </li><li>  The check is not sent to the buyer - 10 thousand rubles. </li><li>  There is no cash, and it should be - 30 thousand rubles. </li></ul><br>  And here is a very good site with a <a href="http://54-fz.ru/">FAQ with a bunch of details</a> . <br><br><h2>  Summary </h2><br>  This is all very cool, because we in the country have finally abandoned the outdated media, plus were able to check everything online.  Yes, there are problems with the implementation, but in general - it's worth it. </div><p>Source: <a href="https://habr.com/ru/post/332188/">https://habr.com/ru/post/332188/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../332178/index.html">How computer pros crack hackers</a></li>
<li><a href="../332180/index.html">How to search for people among Pi and what's the point about Python</a></li>
<li><a href="../332182/index.html">How to quickly remove multiple rows from a large database in MySQL</a></li>
<li><a href="../332184/index.html">Six Myths about Big Data</a></li>
<li><a href="../332186/index.html">4 popular mistakes in business card design</a></li>
<li><a href="../332190/index.html">The tale of how an Android developer spammers, and that came out of it</a></li>
<li><a href="../332192/index.html">Canvas - almost like SVG</a></li>
<li><a href="../332194/index.html">ArrayBuffer and SharedArrayBuffer in JavaScript, part 3: race streams and Atomics</a></li>
<li><a href="../332196/index.html">How to organize secure access using VPN</a></li>
<li><a href="../332198/index.html">Introduction to procedural animation: inverse kinematics</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>