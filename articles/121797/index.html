<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>VHDL for beginners. Brainfuck</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As you know, VHDL is a high-level language for describing hardware (if this is doubtful, you can look here and here ). Of all the variety of tasks, I ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>VHDL for beginners. Brainfuck</h1><div class="post__text post__text-html js-mediator-article">  As you know, VHDL is a high-level language for describing hardware (if this is doubtful, you can look <a href="http://habrahabr.ru/blogs/controllers/112479/">here</a> and <a href="http://habrahabr.ru/blogs/DIY/80056/">here</a> ).  Of all the variety of tasks, I liked the <b>brainfuck</b> because of the ease of implementation on the one hand and the magic of creating a programmable (albeit rather limited) calculator on the other. <br>  In this article, I will not delve into the jungle of syntax and environment settings, concentrating on the implementation of a specific task. <br>  The test bench will be the <a href="http://www.terasic.com.tw/cgi-bin/page/archive.pl%3FLanguage%3DEnglish%26No%3D83">Altera Cyclone II Starter Kit</a> (EP2C20F484C7) <br><br><img src="https://habrastorage.org/storage/b2f72070/1116b2b1/60ca1d57/5184da94.jpg"><br>  Fans of flashing light bulbs please under cat. <br><a name="habracut"></a><br><h4>  Technical task </h4><img src="https://habrastorage.org/storage/46bda81b/e092e129/01b95143/01e4d68c.png"><br><ol><li>  Command memory - 64 commands, memory cells - 32 cells, 8 bits each; </li><li>  The device must support two modes: program enrollment and execution;  mode change must be carried out using the switch SW9; </li><li>  In the program entry mode, the switches SW8 - SW3 determine the address in the program memory, SW2 - SW0 - the command code;  memory recording is performed when the KEY3 button is pressed;  the contents of the current memory cell is displayed on LEDR2 LEDs - LEDR0; </li><li>  In the program execution mode, the values ‚Äã‚Äãof memory cells should be displayed on seven-segment indicators HEX1 - HEX0;  the address of the displayed cell must be set using switches SW4 - SW0; </li><li>  In any mode of operation by pressing the KEY3 button, the values ‚Äã‚Äãof all memory cells should be reset. </li></ol><br><h4>  Marking the front of work </h4>  The project in Quartus II was created, it's time to decide on the entity set.  I decided not to stand out and, even if it is not very beautiful, to realize everything in one essence.  To output to seven-segment indicators, a special decoder will be needed, which we will separate into a separate entity. <br><br><h4>  Implementation </h4>  The decoder can be implemented immediately, "in the forehead."  It performs the simplest conversion, which is given in tabular form, so there are only two ports: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="hljs vhdl"><span class="hljs-keyword"><span class="hljs-keyword">entity</span></span> dc7x <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">port</span></span>( i: <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std_logic_vector</span></span>(<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">downto</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>); z: <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std_logic_vector</span></span>(<span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-keyword"><span class="hljs-keyword">downto</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> dc7x;</code> </pre> <br><br>  The behavior model is set simply: <br><pre> <code class="hljs perl">with i <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> z &lt;= <span class="hljs-string"><span class="hljs-string">"1000000"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">"0000"</span></span>, --<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-string"><span class="hljs-string">"1111001"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">"0001"</span></span>, --<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-string"><span class="hljs-string">"0100100"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">"0010"</span></span>, --<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-string"><span class="hljs-string">"0110000"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">"0011"</span></span>, --<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-string"><span class="hljs-string">"0011001"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">"0100"</span></span>, ******** <span class="hljs-string"><span class="hljs-string">"0001110"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">"1111"</span></span>, --F <span class="hljs-string"><span class="hljs-string">"0111111"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> others;</code> </pre><br><br>  We proceed directly to the interpreter. <br><br><h5>  Ports </h5>  Involved external input and output devices are shown in the figure: <br><img src="http://habrastorage.org/storage/dce1987f/930a9ea7/78885452/6694ed48.jpg"><br>  As you can see, you need access to SW toggle switches, KEY buttons, LEDs and HEX seven-segment devices.  The synchronization signal will produce an internal 50Mhz generator. <br><pre> <code class="hljs vhdl"><span class="hljs-keyword"><span class="hljs-keyword">entity</span></span> brainfuck <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">port</span></span>( RUN: <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std_logic</span></span>; SW: <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std_logic_vector</span></span>(<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">downto</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>); LED: <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std_logic_vector</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">downto</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>); HEX1: <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std_logic_vector</span></span>(<span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-keyword"><span class="hljs-keyword">downto</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>); HEX2: <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std_logic_vector</span></span>(<span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-keyword"><span class="hljs-keyword">downto</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>); clk: <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std_logic</span></span>; RESET: <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">boolean</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> brainfuck;</code> </pre><br>  RUN - the same mode switch SW9, RESET - KEY3 button. <br><br><h5>  Architecture </h5>  We will need several internal elements: arrays of memory commands and data, as well as pointers to specific cells in them. <br>  Since the indicators need to show not only the output of the program, but the contents of each specific memory cell, two vectors are used: <i>out_result</i> contains the output of the program, and <i>final_out_result is</i> connected to the decoders of the seven-segment indicators. <br><pre> <code class="hljs javascript">type t_memory is array (<span class="hljs-number"><span class="hljs-number">31</span></span> downto <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> std_logic_vector (<span class="hljs-number"><span class="hljs-number">7</span></span> downto <span class="hljs-number"><span class="hljs-number">0</span></span>); -- command memory signal cell_memory: t_memory := (<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">others</span></span></span><span class="hljs-function"> =&gt;</span></span> x<span class="hljs-string"><span class="hljs-string">"00"</span></span>); type d_memory is array (<span class="hljs-number"><span class="hljs-number">63</span></span> downto <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> std_logic_vector (<span class="hljs-number"><span class="hljs-number">2</span></span> downto <span class="hljs-number"><span class="hljs-number">0</span></span>); -- cells memory signal comm_memory: d_memory := (<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">others</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-string"><span class="hljs-string">"000"</span></span>); signal comm_number: std_logic_vector(<span class="hljs-number"><span class="hljs-number">6</span></span> downto <span class="hljs-number"><span class="hljs-number">0</span></span>) := (<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">others</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-string"><span class="hljs-string">'0'</span></span>); signal cell_number: std_logic_vector(<span class="hljs-number"><span class="hljs-number">5</span></span> downto <span class="hljs-number"><span class="hljs-number">0</span></span>) := (<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">others</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-string"><span class="hljs-string">'0'</span></span>); signal out_result: std_logic_vector(<span class="hljs-number"><span class="hljs-number">7</span></span> downto <span class="hljs-number"><span class="hljs-number">0</span></span>) := (<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">others</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-string"><span class="hljs-string">'0'</span></span>); signal final_out_result: std_logic_vector(<span class="hljs-number"><span class="hljs-number">7</span></span> downto <span class="hljs-number"><span class="hljs-number">0</span></span>) := (<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">others</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-string"><span class="hljs-string">'0'</span></span>);</code> </pre><br><br><h6>  Process (clk, RESET) </h6>  Finally, they got to the most important thing - the interpreter's behavior patterns.  To begin, let's declare a variable-counter of open brackets. <pre> <code class="hljs vhdl"><span class="hljs-keyword"><span class="hljs-keyword">variable</span></span> u: <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> := <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre>  For normal work with cycles, it should be just a variable, not a signal.  The main difference between the first and the second is that the value is written to the signal at the end of the process, and to the variable - immediately at the moment of assignment. <br><pre> <code class="hljs vhdl"><span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> rising_edge(clk) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">not</span></span> RESET) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> cell_memory &lt;= (<span class="hljs-keyword"><span class="hljs-keyword">others</span></span> =&gt; x<span class="hljs-string"><span class="hljs-string">"00"</span></span>); out_result &lt;= (<span class="hljs-keyword"><span class="hljs-keyword">others</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'0'</span></span>); final_out_result &lt;= cell_memory(conv_integer(<span class="hljs-built_in"><span class="hljs-built_in">unsigned</span></span>(cell_number))); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (RUN = <span class="hljs-string"><span class="hljs-string">'0'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-comment"><span class="hljs-comment">-- writing a programm comm_memory(conv_integer(unsigned(SW(8 downto 3)))) &lt;= SW(2 downto 0); end if;</span></span></code> </pre> <br>  By the reset signal (the buttons in Cyclone II are inverse, and therefore the inverse condition), the values ‚Äã‚Äãof the memory cells and the output vector are zeroed, and if the program is also being recorded, we fill the corresponding command memory. <br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (RUN = <span class="hljs-string"><span class="hljs-string">'0'</span></span>) then running_led &lt;= <span class="hljs-literal"><span class="hljs-literal">false</span></span>; LED &lt;= comm_memory(conv_integer(unsigned(SW(<span class="hljs-number"><span class="hljs-number">8</span></span> downto <span class="hljs-number"><span class="hljs-number">3</span></span>)))); comm_number &lt;= (<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">others</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-string"><span class="hljs-string">'0'</span></span>); cell_number &lt;= (<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">others</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-string"><span class="hljs-string">'0'</span></span>); cell_memory &lt;= (<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">others</span></span></span><span class="hljs-function"> =&gt;</span></span> x<span class="hljs-string"><span class="hljs-string">"00"</span></span>);</code> </pre> <br>  In any case, when exiting the execution mode, it is necessary to ‚Äúforget‚Äù about the previous results so that each subsequent launch will occur from scratch. <br><pre> <code class="hljs delphi"><span class="hljs-keyword"><span class="hljs-keyword">else</span></span> -- executing running_led &lt;= true; LED &lt;= (others =&gt; <span class="hljs-string"><span class="hljs-string">'0'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (SW(<span class="hljs-number"><span class="hljs-number">5</span></span>) = <span class="hljs-string"><span class="hljs-string">'1'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> final_out_result &lt;= cell_memory(conv_integer(unsigned(SW(<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">downto</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>)))); -- <span class="hljs-keyword"><span class="hljs-keyword">out</span></span>: user<span class="hljs-string"><span class="hljs-string">'s or programm'</span></span>s cell <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> final_out_result &lt;= out_result; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>;</code> </pre><br>  Output selection: either the output of the program or the value from the current cell is sent to the decoders.  The selection is made using the SW5 toggle switch. <br><pre> <code class="hljs ruby"> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> comm_memory(conv_integer(unsigned(comm_number))) is <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">"000"</span></span> =&gt; -- <span class="hljs-keyword"><span class="hljs-keyword">next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (u = <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> cell_number &lt;= cell_number + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (u &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> )<span class="hljs-keyword"><span class="hljs-keyword">then</span></span> comm_number &lt;= comm_number - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> comm_number &lt;= comm_number + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; **************** <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">"100"</span></span> =&gt; -- [ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((cell_memory(conv_integer(unsigned(cell_number))) = x<span class="hljs-string"><span class="hljs-string">"00"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> (u /= <span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> u <span class="hljs-symbol"><span class="hljs-symbol">:</span></span>= u + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (u &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> )<span class="hljs-keyword"><span class="hljs-keyword">then</span></span> comm_number &lt;= comm_number - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> comm_number &lt;= comm_number + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">"101"</span></span> =&gt; -- ] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((cell_memory(conv_integer(unsigned(cell_number))) /= x<span class="hljs-string"><span class="hljs-string">"00"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> (u /= <span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> u <span class="hljs-symbol"><span class="hljs-symbol">:</span></span>= u - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (u &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> )<span class="hljs-keyword"><span class="hljs-keyword">then</span></span> comm_number &lt;= comm_number - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> comm_number &lt;= comm_number + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> others =&gt; -- stop <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (u = <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> null; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>;</code> </pre> <br>  The program on Brainfuck is represented as an automaton: there is a set of fixed states, the movement between which is carried out (with the exception of cycles) is linear.  Such a model on VHDL (and not only) is implemented by a switch-case construction. <br>  As already mentioned, u is the count of open brackets.  Commands are executed only when (u = 0), in other cases the search for matching brackets occurs.  In normal mode and when searching for the closing parenthesis, the instruction pointer moves forward, otherwise, backward.  It is clearly seen here that if <i>u</i> were a signal, the first reaction to the closing bracket would increase the command counter, only on the next clock cycle the pointer would go back, came across the closing bracket a second time (u = -2), and such a number of paired opening brackets no - the program would never have run. <br>  The condition (u / = 0) is made to implement nested loops. <br><br><h4>  Testbench </h4>  The code is ready and compiled, <br><img src="http://habrastorage.org/storage/80c38442/68978d71/99a7ecd7/fe7ef150.jpg"><br>  but before flashing the device, it is necessary to test the algorithm for adequacy.  I will not give the text of the testbench, it is in the attached files.  I will only note that a stupid sequential run of all values ‚Äã‚Äãdoes not work here, therefore the correctness of the execution of a specific program is checked.  I used the addition of two numbers: <br> <code>+++&gt;++&lt;[-&gt;+&lt;]&gt;.x</code> <br>  ModelSim-Altera was used as a modeling environment. <br><br><h4>  PCB layout </h4>  The last stage before the firmware is the task of matching the signals of the model to the real ports of the board.  The coordinates of the findings are in the application "Documentation Cyclone II", but for whom laziness is the finished pinout: <br><img src="http://habrastorage.org/storage/1fa683c6/1d8b4b14/9bf14ee0/dcf2588c.jpg"><br><img src="http://habrastorage.org/storage/df85ed88/027d89cd/b5570b70/8fbcd77c.jpg"><br><br><h4>  Conclusion </h4>  Well, that's all, it remains only to open the Programmer, flash the board, and ... sit and drive in all the commands and addresses manually :) I didn‚Äôt give all the code, omitting the standard parts like the <i>use</i> section.  Promised: <br><ul><li>  Completely ready for firmware (compiled and diluted on the board) <a href="">project</a> </li><li>  Altera Cyclone II <a href="https://www.dropbox.com/s/w7d55j6u9b024x2/cyclone2.pdf%3Fdl%3D0">documentation</a> (with all ports on the grid indicated) </li></ul><br><br><h4>  PS </h4>  The above code can, of course, be used for implementation on a different hardware, for this you need to create a project for a specific board and attach source files to it. </div><p>Source: <a href="https://habr.com/ru/post/121797/">https://habr.com/ru/post/121797/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../121291/index.html">Kothic JS: OpenStreetMap renderer supporting MapCSS / 0.2 ported to javascript drawing on canvas</a></li>
<li><a href="../121292/index.html">3D cinema watching at home</a></li>
<li><a href="../121295/index.html">The rhetoric on the topic "And if we are not carried away by the new media?"</a></li>
<li><a href="../121795/index.html">ReSharper 6 beta released</a></li>
<li><a href="../121796/index.html">Yevgeny Butman: ‚ÄúPrices in Apple for Apple products will never be equal to American ones‚Äù</a></li>
<li><a href="../121799/index.html">Property in C ++</a></li>
<li><a href="../121800/index.html">Young Tables in Search and Sort Tasks</a></li>
<li><a href="../121801/index.html">Experienced trivia windows admin</a></li>
<li><a href="../121803/index.html">Top 11 most common errors in javascript</a></li>
<li><a href="../121804/index.html">Time management in practice</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>