<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PHPixie Amalgama - Internationalization in PHPixie</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I have been using PHPixie for quite some time now and am very pleased, the only thing I lacked was support for multilingualism. Since I work in Kazakh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PHPixie Amalgama - Internationalization in PHPixie</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="https://habrastorage.org/getpro/habr/post_images/c13/3f1/403/c133f1403870b6f81ab5eed4e154b51d.png">  I have been using PHPixie for quite some time now and am very pleased, the only thing I lacked was support for multilingualism.  Since I work in Kazakhstan, most customers want several localizations on their website, especially for government agencies.  PHPixie was my first framework, I didn‚Äôt want to switch to something else (although I confess I almost changed it with an old woman, Kohana) and I wrote ‚Äúugly crutches‚Äù to implement multilingualism.  In this article, we will discuss my new, quite convenient and elegant ‚Äúcrutch‚Äù, which I decided to share - the ‚ÄúPHPixie Amalgama‚Äù module. <br><a name="habracut"></a><br><h2>  About module </h2><br>  In the arsenal, the module has basic functionality for working with line breaks, as well as a small extension for those who do not want to prescribe the language settings in the routes.  The module is easy to install, easy to configure, convenient to use for many tasks. <br><br><h2>  Installation and Setup </h2><br>  Register the package in the ‚Äúrequire‚Äù section of the ‚Äúcomposer.json‚Äù file like this: <br><br><pre><code class="hljs perl"><span class="hljs-string"><span class="hljs-string">"phpixie/amalgama"</span></span>: <span class="hljs-string"><span class="hljs-string">"2.*@dev"</span></span></code> </pre> <br>  Run the following command in the site directory: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="bash hljs">php composer.phar update -o --prefer-dist</code> </pre><br>  Add amalgama.php config to / assets / config / and write our settings: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-comment"><span class="hljs-comment">//    'list' =&gt; array('en', 'ru', 'kk'), //    'default' =&gt; 'en', // ,     'autorouting' =&gt; true, //    ,      'autoroutingExcept' =&gt; '^admin_' );</span></span></code> </pre><br>  Expand our Pixie.php: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Pixie</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> \</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PHPixie</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Amalgama</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Pixie</span></span></span><span class="hljs-class"> </span></span>{ ... <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">after_bootstrap</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::after_bootstrap(); } }</code> </pre><br>  There we define a module like this: <br><br><pre> <code class="hljs php"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $modules = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( ... <span class="hljs-string"><span class="hljs-string">'amalgama'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'\PHPixie\Amalgama'</span></span> );</code> </pre><br>  Expand our base controller: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Page</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> \</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PHPixie</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Amalgama</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">before</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::before(); ... } ... }</code> </pre><br>  Define routes if autorouting is false: <br><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">'default'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'(/&lt;lang&gt;)(/&lt;controller&gt;(/&lt;action&gt;(/&lt;id&gt;)))'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'lang'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'(en|ru|kk)'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'controller'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'hello'</span></span>, <span class="hljs-string"><span class="hljs-string">'action'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'index'</span></span>, <span class="hljs-string"><span class="hljs-string">'lang'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'en'</span></span> ), ),</code> </pre><br>  Add transfer files to the / assets / config / amalgama directory: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//ru.php </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?php</span></span></span><span class="hljs-comment"> return array( 'Hello World!' =&gt; ' !', 'Hello </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?</span></span></span><span class="hljs-comment">&gt;!' =&gt; ' </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?</span></span></span><span class="hljs-comment">&gt;!' ); //kk.php return array( 'Hello World!' =&gt; 'C”ô ”ô!', 'Hello </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?</span></span></span><span class="hljs-comment">&gt;!' =&gt; 'C”ô </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?</span></span></span><span class="hljs-comment">&gt;!' );</span></span></code> </pre><br>  As you can see, translations support parameters, and for the default language, translations are not required. <br>  It should also be said that the module itself extends the Route class to correctly generate addresses from the routes and View \ Helper, so that it is convenient to translate into views. <br><br><h2>  Using </h2><br>  Thanks to the helper, you can use the following abbreviated entry in representations for line breaks: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $__(<span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  " !"    </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?php</span></span></span><span class="hljs-comment"> echo $__('Hello </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?</span></span></span><span class="hljs-comment">&gt;!', array('')); //  " !"    </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br>  Displaying the language switch is also very simple: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;helper-&gt;getLangList() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $lang) : <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($lang == <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;helper-&gt;getCurrentLang()) : <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;span&gt;<span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $lang; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span>&lt;/span&gt; <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;a href=<span class="hljs-string"><span class="hljs-string">"&lt;?php echo $this-&gt;helper-&gt;langSwitchLink($lang); ?&gt;"</span></span>&gt;<span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $lang; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span>&lt;/a&gt; <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">endforeach</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  The Paginate module works as it should, just do not forget to transmit the current language: <br><br><pre> <code class="php hljs">$page = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;request-&gt;param(<span class="hljs-string"><span class="hljs-string">'page'</span></span>); $comments = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;pixie-&gt;orm-&gt;get(<span class="hljs-string"><span class="hljs-string">'comment'</span></span>); $pager = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;pixie-&gt;paginate-&gt;orm($comments, $page, <span class="hljs-number"><span class="hljs-number">10</span></span>); $pager-&gt;set_url_route(<span class="hljs-string"><span class="hljs-string">'comments'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'lang'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;lang));</code> </pre><br>  Well, as without validation: <br><br><pre> <code class="php hljs">$validator-&gt;field(<span class="hljs-string"><span class="hljs-string">'username'</span></span>) -&gt;rule(<span class="hljs-string"><span class="hljs-string">'filled'</span></span>) -&gt;error(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;__(<span class="hljs-string"><span class="hljs-string">'Field &lt;?&gt; must not be empty'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;__(<span class="hljs-string"><span class="hljs-string">'username'</span></span>))));</code> </pre><br><h2>  Conclusion </h2><br>  As you can see, PHPixie is very easy to expand.  For most small projects, it has everything you need, and if something is missing, then it‚Äôs not difficult to finish it yourself.  In the future, support for the plural is planned, the basic functionality is already there, but there is not enough time to bring it to the mind and write documentation.  It is possible to translate from Russian without too much strain with such functionality.  If you find a bug, errors in the documentation or have any ideas, I will be glad to get feedback and pullrequest. <br><br>  Module repository here: <a href="https://github.com/nxeed/PHPixie-Amalgama">Github</a> </div><p>Source: <a href="https://habr.com/ru/post/244113/">https://habr.com/ru/post/244113/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244103/index.html">A revolution in computer simulation of the human body in motion</a></li>
<li><a href="../244105/index.html">DD-WRT and SSL certificates</a></li>
<li><a href="../244107/index.html">PIN code when paying by card - dots above i</a></li>
<li><a href="../244109/index.html">A few thoughts about analyzing other people's opinions</a></li>
<li><a href="../244111/index.html">Setting up a server with Chef (Quick and easy)</a></li>
<li><a href="../244115/index.html">Attackers use CVE-2014-6332</a></li>
<li><a href="../244117/index.html">Multiple PHP Versions Under One Apache on Windows</a></li>
<li><a href="../244119/index.html">eBay API: Step Two</a></li>
<li><a href="../244121/index.html">How-to: How the hosting provider infrastructure is built</a></li>
<li><a href="../244127/index.html">14 effective tips for content marketing for small businesses (part 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>