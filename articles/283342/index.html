<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ONLYOFFICE Documents 1.3 for iOS: how the mobile spreadsheet editor is organized</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is finished: we have released a large-scale update of the ONLYOFFICE mobile application Documents numbered 1.3 for iOS devices. Now the application...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ONLYOFFICE Documents 1.3 for iOS: how the mobile spreadsheet editor is organized</h1><div class="post__text post__text-html js-mediator-article">  It is finished: we have released a large-scale update of the <b>ONLYOFFICE</b> mobile application <b>Documents</b> numbered 1.3 for iOS devices.  Now the application has a spreadsheet editor for iPad, which can do a lot of different and useful things - almost everything that can be done in the web version.  And added the ability to connect third-party storage Google Drive, Dropbox, OneDrive, Yandex Disk, and others that support the WebDAV protocol. <br><br>  In this article we will tell you more about how the spreadsheet editor is arranged. <br><br><img src="https://habrastorage.org/files/2cc/7e4/f12/2cc7e4f1293e437db75817fb33fd9048.png"><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Functionality </h1><br><br>  These are the capabilities that the ONLYOFFICE Documents application empowers its users: <br><br>  Manage documents stored on ONLYOFFICE portals and other cloud services connected to ONLYOFFICE; <br><br><ul><li>  Edit text files (iPhone, iPad); </li><li>  Edit spreadsheets (iPad); </li><li>  View presentations and pdf files. </li></ul><br><br>  We like our text editor - fully featured and very capable.  We even shot a video about what he can do.  Here it is: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/hVeJjGwJQ4U%3Ffeature%3Doembed&amp;xid=17259,1500004,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhg9dnXuty5FztaF224Ni-v5D-UzQQ" frameborder="0" allowfullscreen=""></iframe><br><br>  The table editor also knows a lot.  All table objects can be managed.  The text in the cells is formatted, the properties of the cells change, formulas, diagrams, autoshapes are inserted, the tables themselves are exported and printed. <br><br><img src="https://habrastorage.org/files/b2b/b9b/929/b2bb9b92995b4e5c81ba82d4b6e49ac4.jpg"><br><br>  Next, tell about the device of this editor. <br><br><h1>  Anatomy of a table editor </h1><br><br>  We have already written about the device of our desktop application <a href="https://habrahabr.ru/company/teamlab/blog/279397/">here</a> .  In principle, when developing all our document editors, we follow the same scheme.  All business logic for the formation of data is created on javascript'e.  We have a common code for the web, desktops and mobile applications, the only difference is the conclusion.  Unlike desktops, iOS apps have native document rendering. <br><br>  Here is the general scheme of the application: <br><br><img src="https://habrastorage.org/files/0e1/67b/2b3/0e167b2b38d649d7903a5772e5bdcd3f.png"><br><br><h1>  Why we did our own rendering </h1><br><br>  In theory, we had the option to draw and draw by analogy with the web, that is, to use WebView.  Why we did not do this: <br><br>  1. Analog Chrome in iOS can not be used: Apple does not allow the use of third-party javascript engines. <br><br>  2. The built-in browser works very slowly with our editors.  This is due to the fact that all iOS devices have a large screen resolution.  Since we ourselves draw all the documents on the Canvas, for such screens we need to draw and calculate more (approximately twice).  The result is a loss in performance. <br><br>  In general, we did this: selected graphics from the editor, working with fonts and displaying the document itself into separate native components and transferred them to C ++, leaving the core of editors to calculate the visible areas and tracking.  Due to this, we can draw an unlimited number of rows, columns. <br><br><h1>  Share and calculate </h1><br><br>  Unlike the document editor, where we know the physical size of the sheet, the table is limitless.  We cannot create a limitless virtual texture.  To render the picture faster, we break our potentially limitless table into squares.  For example, the table itself may be more than 100 thousand lines, but for the user, we draw only the area he needs at a given time ‚Äî several squares with visible areas (with a small margin).  Everything else is calculated as needed and is not physically drawn until it is needed.  Similar principles work, for example, Yandex.Maps. <br><br>  Scheme: <br><br><img src="https://habrastorage.org/files/61e/269/2c5/61e2692c516a49b6a53fafda96dd9e8a.png"><br><br>  After opening the document, the visible area beats into squares of 1024x1024 pixels.  Each such square is calculated by our javascript editor.  In the process of calculating the document from the native code, information on the fonts is taken and instruction is packed into the array.  As a result of calculating the visible square, we get an array of commands for drawing (for example, draw a line, paint a region, draw a letter, etc.).  Further commands are rasterized by the native graphic library into bitmaps.  Then, in the main thread, the OpenGL texture is updated or created using these bitmaps of the same size.  All this is done asynchronously (except for the last item). <br><br><h1>  Results </h1><br><br>  We have made a cool application that works well and supports most of the features of the web version.  But this development does not stop.  We are currently working on a spreadsheet editor for the iPhone.  We also plan to expand the capabilities of the spreadsheet editor, and also implement the demanded autosave feature. <br><br>  Our application is available in the App Store by <a href="https://itunes.apple.com/ru/app/onlyoffice-documents/id944896972%3Fmt%3D8">reference</a> .  To work with him you need an active portal ONLYOFFICE.  If there is no portal, you can create a <a href="https://personal.onlyoffice.com/ru/">personal office</a> for free using the application itself. </div><p>Source: <a href="https://habr.com/ru/post/283342/">https://habr.com/ru/post/283342/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../283328/index.html">Creating a touch node for the Internet of things on Intel Edison</a></li>
<li><a href="../283330/index.html">Build your AirFiber yourself Or NxN - the designer of the radio relay line from Ubiquiti</a></li>
<li><a href="../283332/index.html">Announcement! We invite you to take part in the hackathon on machine learning technologies</a></li>
<li><a href="../283334/index.html">Moscow Python Meetup ‚Ññ35 (May 23, 7 pm)</a></li>
<li><a href="../283340/index.html">DevConf-2016: conference program</a></li>
<li><a href="../283344/index.html">Theory and practice of escape from the 5 GHz band</a></li>
<li><a href="../283346/index.html">CUBA Platform Enters Free Software Market</a></li>
<li><a href="../283348/index.html">Firebird 3.0 Verification</a></li>
<li><a href="../283350/index.html">Basics of game design: 20 board games. Part one</a></li>
<li><a href="../283352/index.html">C ++ without new and delete</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>