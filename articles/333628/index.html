<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analyzing NHL players careers with Survival Regression and Python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! Today we consider one of the approaches to the assessment of temporary risk, which is based on the survival curve and the regression of the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Analyzing NHL players careers with Survival Regression and Python</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr!  Today we consider one of the approaches to the assessment of temporary risk, which is based on the survival curve and the regression of the same name, and apply it to the analysis of the length of careers of NHL players. <br><br>  When does this patient relapse?  When will our client leave?  Answers to such questions can be found using survival analysis, which can be used in all areas where the time interval from the ‚Äúbirth‚Äù to the ‚Äúdeath‚Äù of an object is studied, or similar events: the period from the arrival of equipment to its failure, from the start of use services of the company and to abandon them, etc.  Most often, these models are used in medicine, where it is necessary to assess the risk of death in a patient, which explains the name of the model, but they are also applicable in the manufacturing, banking and insurance sectors. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/715/8d1/4fe/7158d14fe55f791af3f6e1fe2cc3b8f5.jpg" alt="image" width="70%" height="70%"></div><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It is obvious that among the objects under consideration there will always be those for which the ‚Äúdeath‚Äù (failure, occurrence of the insured event) has not yet occurred, and not taking them into account is a common mistake among analysts, since in this case they do not include the most relevant information in the sample and can artificially underestimate the time interval.  To solve this problem, a survival analysis was developed, which assesses the potential ‚Äúlife expectancy‚Äù of observations with a ‚Äúdeath‚Äù that has not yet occurred. <br><br><h2>  NHL Player Career Analysis </h2><br><h3>  Data and Survival Curve </h3><br>  Above we talked about the application of this approach in medicine and economics, but now consider a less trivial example - the length of the career of NHL players.  We all know that hockey is a very dynamic and unpredictable game, where you can, like Gordie Howe (26 seasons), play at the highest level for many years, or because of an unsuccessful collision you can finish your career after a couple of seasons.  Therefore, we find out: how many seasons can a hockey player spend in the NHL and what factors influence the length of his career? <br><br>  Let's look at the data already cleared and ready for analysis: <br><br><pre><code class="python hljs">df.head(<span class="hljs-number"><span class="hljs-number">3</span></span>)</code> </pre> <br><table><tbody><tr><th>  Name </th><th>  Position </th><th>  Points </th><th>  Balance </th><th>  Career_start </th><th>  Career_length </th><th>  Observed </th></tr><tr><td>  Olli Jokinen </td><td>  F </td><td>  419 </td><td>  -58 </td><td>  1997 </td><td>  18 </td><td>  one </td></tr><tr><td>  Kevyn adams </td><td>  F </td><td>  72 </td><td>  -14 </td><td>  1997 </td><td>  eleven </td><td>  one </td></tr><tr><td>  Matt pettinger </td><td>  F </td><td>  99 </td><td>  -44 </td><td>  2000 </td><td>  ten </td><td>  one </td></tr></tbody></table><br>  Data were collected on 688 NHL hockey players who have played since 1979 and played at least 20 matches, their position on the field, the number of points scored, team benefits (¬±), the start of a career in the NHL and its duration.  The <em>observed</em> column indicates whether the player has completed his career, that is, players with a value of 0 are still in the league. <br><br>  Let's look at the distribution of players by the number of seasons played: <br><img src="https://habrastorage.org/web/908/b67/c7f/908b67c7f31e46eeb4ded9b02dffbf4d.PNG"><br>  The distribution is similar to a lognormal with a median of 11 seasons.  These statistics take into account only the number of seasons played by 2017 by current players, so the median score is clearly underestimated. <br><br>  To get a more accurate value, we estimate the survival function using the <em>lifelines</em> library: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> lifelines <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> KaplanMeierFitter kmf = KaplanMeierFitter() kmf.fit(df.career_length, event_observed = df.observed)</code> </pre><br><pre> <code class="python hljs">Out:&lt;lifelines.KaplanMeierFitter: fitted <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-number"><span class="hljs-number">1808</span></span> observations, <span class="hljs-number"><span class="hljs-number">340</span></span> censored&gt;</code> </pre> <br>  The library syntax is similar to scikit-learn and its fit / predict: by initiating <em>KaplanMeierFitter,</em> we then train the model on data.  The <em>fit</em> method takes the <em>career_length</em> time interval and the <em>observed</em> vector as an argument. <br><br>  Finally, when the model is trained, we can build a survival function for NHL players: <br><br><pre> <code class="python hljs">kmf.survival_function_.plot()</code> </pre> <br><img src="https://habrastorage.org/web/c88/5ea/15f/c885ea15ff7944c080d1b9ae28c47af5.PNG"><br>  Each point on the chart is the probability that the player will play more than <em>t</em> seasons.  As you can see, 80% of players overcome the milestone in 6 seasons, while a very small number of players manage to play more than 17 seasons in the NHL.  Now more strictly: <br><br><pre> <code class="python hljs">print(kmf.median_) print(kmf.survival_function_.KM_estimate[<span class="hljs-number"><span class="hljs-number">20</span></span>]) print(kmf.survival_function_.KM_estimate[<span class="hljs-number"><span class="hljs-number">5</span></span>])</code> </pre> <br><pre> <code class="python hljs">Out:<span class="hljs-number"><span class="hljs-number">13.0</span></span> <span class="hljs-number"><span class="hljs-number">0.0685611305647</span></span> <span class="hljs-number"><span class="hljs-number">0.888063315225</span></span></code> </pre> <br>  Thus, 50% of NHL players will play more than 13 seasons, which is 2 seasons more than the initial estimate.  Hockey players' chances to play more than 5 and 20 seasons are 88.8% and 6.9%, respectively.  Great incentive for young players! <br><br>  We can also derive the survival function, along with confidence intervals for probability: <br><br><pre> <code class="python hljs">kmf.plot()</code> </pre> <br><img src="https://habrastorage.org/web/abc/00b/682/abc00b682c7a4af6bf3282fe671fd268.PNG"><br>  Similarly, we construct the threat function using the Nelson-Aalen procedure: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> lifelines <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> NelsonAalenFitter naf = NelsonAalenFitter() naf.fit(df.career_length,event_observed=df.observed) naf.plot()</code> </pre> <br><img src="https://habrastorage.org/web/3f5/e05/072/3f5e050721e9477b9fba1f4d5d42f5e9.PNG"><br><br>  As can be seen on the graph, during the first 10 years the risk of an NHL player‚Äôs retirement at the end of the season is extremely small, but after the 10th season this risk is sharply increasing.  In other words, spending 10 seasons in the NHL, the player will increasingly think about how to complete a career. <br><br><h3>  Comparison of attackers and defenders </h3><br>  Now let's compare the length of the career of a defender and an NHL attacker.  Initially, we assume that strikers play on average much longer than defenders, since they are often more popular among fans, so they often get long-term contracts.  Also, with age, the players become slow, which hurts the most for defenders, who find it increasingly difficult to cope with brisk attackers. <br><br><pre> <code class="python hljs">ax = plt.subplot(<span class="hljs-number"><span class="hljs-number">111</span></span>) kmf.fit(df.career_length[df.Position == <span class="hljs-string"><span class="hljs-string">'D'</span></span>], event_observed=df.observed[df.Position == <span class="hljs-string"><span class="hljs-string">'D'</span></span>], label=<span class="hljs-string"><span class="hljs-string">"Defencemen"</span></span>) kmf.plot(ax=ax, ci_force_lines=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) kmf.fit(df.career_length[df.Position == <span class="hljs-string"><span class="hljs-string">'F'</span></span>], event_observed=df.observed[df.Position == <span class="hljs-string"><span class="hljs-string">'F'</span></span>], label=<span class="hljs-string"><span class="hljs-string">"Forwards"</span></span>) kmf.plot(ax=ax, ci_force_lines=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) plt.ylim(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> <br><img src="https://habrastorage.org/web/ba7/812/930/ba78129307c147cfaa5080a897003f4e.PNG"><br>  It seems that the length of the career defenders a little shorter than the attackers.  To verify the accuracy of the output, we will conduct a statistical test based on the chi-square test: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> lifelines.statistics <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> logrank_test dem = (df[<span class="hljs-string"><span class="hljs-string">"Position"</span></span>] == <span class="hljs-string"><span class="hljs-string">"F"</span></span>) L = df.career_length O = df.observed results = logrank_test(L[dem], L[~dem], O[dem], O[~dem], alpha=<span class="hljs-number"><span class="hljs-number">.90</span></span> ) results.print_summary()</code> </pre> <br><pre> <code class="python hljs">Results t <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-number"><span class="hljs-number">-1</span></span> test: logrank alpha: <span class="hljs-number"><span class="hljs-number">0.9</span></span> null distribution: chi squared df: <span class="hljs-number"><span class="hljs-number">1</span></span> __ p-value ___|__ test statistic __|____ test result ____|__ <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> significant __ <span class="hljs-number"><span class="hljs-number">0.05006</span></span> | <span class="hljs-number"><span class="hljs-number">3.840</span></span> | Reject Null | <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre> <br>  So, at 10% level of significance, we reject the null hypothesis: the defenders do have a greater chance of completing their careers earlier than the attackers, while, as can be seen from the diagram, the difference increases towards the end of the career, which also confirms the earlier idea: behind the game and becoming less in demand. <br><br><h3>  Survival regression </h3><br>  Often we also have other factors that affect the duration of ‚Äúlife‚Äù that we would like to take into account.  For this, a survival regression model was developed, which, like the classical linear regression, has a dependent variable and a set of factors. <br><br>  Consider one of the popular approaches to estimating regression parameters ‚Äî the additive Aalen model, which chose not the time intervals themselves as the dependent variable, but the values ‚Äã‚Äãof the threat function calculated on their basis <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>a</mi><mi>m</mi><mi>b</mi><mi>d</mi><mi>a</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.636ex" height="2.66ex" viewBox="0 -832 4579.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-6D" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-62" x="1956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-64" x="2386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-61" x="2909" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-28" x="3439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-74" x="3828" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-29" x="4190" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>l</mi><mi>a</mi><mi>m</mi><mi>b</mi><mi>d</mi><mi>a</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1"> \ lambda (t) </script>  : <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>a</mi><mi>m</mi><mi>b</mi><mi>d</mi><mi>a</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msub><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow></msub><mo>+</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>+</mo><msub><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="42.492ex" height="2.66ex" viewBox="0 -832 18295 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-6D" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-62" x="1956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-64" x="2386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-61" x="2909" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-28" x="3439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-74" x="3828" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-29" x="4190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-3D" x="4857" y="0"></use><g transform="translate(5913,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-30" x="607" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-28" x="6796" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-74" x="7186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-29" x="7547" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-2B" x="8159" y="0"></use><g transform="translate(9160,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-31" x="607" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-28" x="10043" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-74" x="10433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-29" x="10794" y="0"></use><g transform="translate(11184,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-31" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-2B" x="12210" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-2E" x="12989" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-2E" x="13434" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-2E" x="13879" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-2B" x="14324" y="0"></use><g transform="translate(15103,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-6E" x="607" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-28" x="16057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-74" x="16446" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMAIN-29" x="16808" y="0"></use><g transform="translate(17197,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/newprolab/blog/333628/&amp;xid=17259,15700023,15700043,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgcO-I5V5R7sFwQ0guX-IfIPhzWxQ#MJMATHI-6E" x="809" y="-213"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>l</mi><mi>a</mi><mi>m</mi><mi>b</mi><mi>d</mi><mi>a</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow></msub><mo>+</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>+</mo><msub><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow></msub></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> \ lambda (t) = b_ {0} (t) + b_ {1} (t) x_ {1} + ... + b_ {n} (t) x_ {n} </script></p><br>  Let us turn to the implementation of the model.  As factors of the model, we take the number of points, the position of the player, the date of the beginning of the career and the overall utility of the team (¬±): <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> lifelines <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AalenAdditiveFitter <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> patsy <span class="hljs-comment"><span class="hljs-comment">#   patsy,   design    # -1      ,     X = patsy.dmatrix('Position + Points + career_start + Balance -1', df, return_type='dataframe') aaf = AalenAdditiveFitter(coef_penalizer=1.0, fit_intercept=True) #  penalizer,     ,      )</span></span></code> </pre><br>  Now that everything is ready, we will teach survival regression: <br><br><pre> <code class="python hljs">X[<span class="hljs-string"><span class="hljs-string">'L'</span></span>] = df[<span class="hljs-string"><span class="hljs-string">'career_length'</span></span>] X[<span class="hljs-string"><span class="hljs-string">'O'</span></span>] = df[<span class="hljs-string"><span class="hljs-string">'observed'</span></span>] <span class="hljs-comment"><span class="hljs-comment">#  career_length  observed    aaf.fit(X, 'L', event_col='O')</span></span></code> </pre> <br>  Let's try to estimate how many more seasons 2 players will play in the NHL: Derek Stepan, an attacker who started his career in 2010 and scored 310 points with a utility rating of +109 and compare it with the less successful NHL player - Klas Dalbek, who ended up in the NHL in 2014, scored 11 points with a utility rating of -12. <br><br><pre> <code class="python hljs">ix1 = (df[<span class="hljs-string"><span class="hljs-string">'Position'</span></span>] == <span class="hljs-string"><span class="hljs-string">'F'</span></span>) &amp; (df[<span class="hljs-string"><span class="hljs-string">'Points'</span></span>] == <span class="hljs-number"><span class="hljs-number">360</span></span>) &amp; (df[<span class="hljs-string"><span class="hljs-string">'career_start'</span></span>] == <span class="hljs-number"><span class="hljs-number">2010</span></span>) &amp; (df[<span class="hljs-string"><span class="hljs-string">'Balance'</span></span>] == +<span class="hljs-number"><span class="hljs-number">109</span></span>) ix2 = (df[<span class="hljs-string"><span class="hljs-string">'Position'</span></span>] == <span class="hljs-string"><span class="hljs-string">'D'</span></span>) &amp; (df[<span class="hljs-string"><span class="hljs-string">'Points'</span></span>] == <span class="hljs-number"><span class="hljs-number">11</span></span>) &amp; (df[<span class="hljs-string"><span class="hljs-string">'career_start'</span></span>] == <span class="hljs-number"><span class="hljs-number">2014</span></span>) &amp; (df[<span class="hljs-string"><span class="hljs-string">'Balance'</span></span>] == <span class="hljs-number"><span class="hljs-number">-12</span></span>) stepan = X.ix[ix1] dahlbeck = X.ix[ix2] ax = plt.subplot(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) aaf.predict_cumulative_hazard(oshie).plot(ax=ax) aaf.predict_cumulative_hazard(jones).plot(ax=ax) plt.legend([<span class="hljs-string"><span class="hljs-string">'Stepan'</span></span>, <span class="hljs-string"><span class="hljs-string">'Dahlbeck'</span></span>]) plt.title(<span class="hljs-string"><span class="hljs-string">' '</span></span>) ax = plt.subplot(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) aaf.predict_survival_function(oshie).plot(ax=ax); aaf.predict_survival_function(jones).plot(ax=ax); plt.legend([<span class="hljs-string"><span class="hljs-string">'Stepan'</span></span>, <span class="hljs-string"><span class="hljs-string">'Dahlbeck'</span></span>]);</code> </pre> <br><img src="https://habrastorage.org/web/e70/865/894/e7086589413e4a87b0e210308aadf8b6.PNG"><br><br>  As expected, the more successful player has a longer career expectancy.  So, Stepan has a chance to play more than 11 seasons - 80%, while Dalbek has only 55%.  Also from the threat curve it can be seen that starting from season 13, the risk of completing a career for the next season increases dramatically, and at Dalbek it grows faster than Stepan. <br><br><h3>  Cross validation </h3><br>  To more strictly assess the quality of regression, we use the cross-validation procedure built into the <em>lifelines</em> library.  At the same time, while working with censored data, we cannot use rms error and similar criteria as a quality metric, therefore the library uses a <em>concordance index</em> or a consent index, which is a generalization of the AUC-metric.  Perform 5-step cross-validation: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> lifelines.utils <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> k_fold_cross_validation score = k_fold_cross_validation(aaf, X, <span class="hljs-string"><span class="hljs-string">'L'</span></span>, event_col=<span class="hljs-string"><span class="hljs-string">'O'</span></span>, k=<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (np.mean(score)) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (np.std(score))</code> </pre> <br><pre> <code class="python hljs">Out:<span class="hljs-number"><span class="hljs-number">0.764216775131</span></span> <span class="hljs-number"><span class="hljs-number">0.0269169670161</span></span></code> </pre><br>  The average accuracy for all iterations is 76.4% with a deviation of 2.7%, which indicates a fairly good quality of the algorithm. <br><br><h2>  Links </h2><br><ol><li>  <a href="https://lifelines.readthedocs.io/en/latest/">Lifelines</a> library <a href="https://lifelines.readthedocs.io/en/latest/">documentation</a> </li><li>  J.Klein, M.Moeschberger.  Survival Analysis.  Techniques for censored and truncated data is a book with many examples and datasets that can be accessed through the <em><a href="https://cran.r-project.org/web/packages/KMsurv/index.html">KMsurv</a></em> package in R. </li></ol></div><p>Source: <a href="https://habr.com/ru/post/333628/">https://habr.com/ru/post/333628/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../333616/index.html">Transition to embedded PostgreSQL in unit tests</a></li>
<li><a href="../333618/index.html">Solid RealTime on React and Socket.io</a></li>
<li><a href="../333622/index.html">Dereferencing null pointers is no longer a problem.</a></li>
<li><a href="../333624/index.html">Apple will spend a billion on Chinese data center</a></li>
<li><a href="../333626/index.html">Creating servlets for dummies. Walkthrough</a></li>
<li><a href="../333630/index.html">WebStorm 2017.2 - What's new in support for JavaScript, TypeScript, Angular and Sass and work with ESLint, Karma and Mocha</a></li>
<li><a href="../333632/index.html">What is SMT and how it works in applications - pros and cons</a></li>
<li><a href="../333634/index.html">Galactic hackathon: how to convince young developers to go over to their side</a></li>
<li><a href="../333636/index.html">XBRL: Just About the Difficult - Chapter 1. Introduction</a></li>
<li><a href="../333638/index.html">Education in the online magistracy as an option for professional and career growth</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>