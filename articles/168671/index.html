<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Qt5 build in Visual Studio 2012 or I can sew a kangaroo eye while my favorite ketchup flows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago a new Qt came out, promising a great and bright future, and I decided to try out this miracle. But to get started with this miracle, I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Qt5 build in Visual Studio 2012 or I can sew a kangaroo eye while my favorite ketchup flows</h1><div class="post__text post__text-html js-mediator-article">  Not so long ago a new Qt came out, promising a great and bright future, and I decided to try out this miracle.  But to get started with this miracle, I needed to build it for my installed studio of 2012 from the source files.  And the assembly turned out to be far from trivial (although no one has canceled the curvature of my arms ‚Äî students like me need to straighten the fence). <br><a name="habracut"></a><br>  As soon as a stable version of the new Qt5 came out at the end of last year, I decided to download and try it, but unfortunately, the assemblies that I needed, namely, for the Windows platform, the assemblies for MinGW and Visual Studio 2012 were missing from site <a href="http://qt-project.org/downloads">qt-project.org</a> .  Therefore, I downloaded and installed the finished build for my Linux: Ubuntu 12.04.  True, I already made attempts (more correctly attempts) to compile at least for the MinGW library from the sources.  However, everything turned into failure, frustration and deep depression. <br><br>  At the end of January, the developers pleased us with version 5.0.1, corrected and compiled to work with MinGW 4.7.  However, for VS2012, they again did not post the assembly.  And then I decided it was worth trying again, but what if it turns out? <br><br>  In search of information on the Internet, I came across a few articles on the assembly, but not under VS2012.  The most truthful, in my opinion, was the version on the official wiki page of the project, no matter how strange it might sound.  Therefore, I will try to describe the whole process once again here, commenting on and adding my own, necessary, in my opinion, assembly points.  I decided to take a chance and collect the fullest possible library. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  What is necessary: </h5><br><ul><li>  Installed Visual Studio 2012 (not Express Edition).  Windows Development Kit 8 with DirectX should already be included </li><li>  Installed <a href="http://www.activestate.com/activeperl/downloads">ActivePerl</a> </li><li>  Installed <a href="http://www.python.org/download/releases/2.7.3/">Python 2.7</a> </li><li>  Installed <a href="http://rubyinstaller.org/downloads/">Ruby</a> </li><li>  Installed <a href="http://www.npcglib.org/~stathis/blog/2012/06/17/windows-task-build-the-icu-library-for-32-bit-and-64-bit/">ICU</a> .  Note, the site is not <a href="http://site.icu-project.org/">official</a> </li><li>  And also download the actual <a href="">source files</a> themselves <a href="">.</a> </li></ul><br><br>  <b>The remark,</b> for some reason unknown to me, python version 3.3.0 gave an error when translating files, although the developers declared the efficiency of the new python, so I had to install version 2.7. <br><br>  My actions even seem to me to be strongly shamanic, so I will try to describe in detail my inept steps, since I‚Äôm not really looking for a chance to rebuild this whole machine again ‚Äî time and nerves are pitiful.  I hope that someone will take to collect too, and tell you what did not work out of my method, and with the common knowledge ‚Äúwe will finish‚Äù, so to speak, this miracle.  I recommend that you first read the entire article in order to avoid minor misunderstandings during assembly. <br><br><h5>  So, let's begin. </h5><br>  My system is Windows 8 Pro with Media Center x64.  Notebook brand eMachines E732ZG.  Brief specifications: Intel Pentium P6200 (dual-core) 2.13 GHz on each core, 6 GB DDR3 RAM, 320 GB HDD.  The version of Visual Studio 2012 Ultimate Update 1. Kaspersky Internet Security 2013 was turned off at the time of assembly. <br><br>  I installed all additional programs in C: \ Development \.  ICU was downloaded not on the official site, but on another one, but the build for vs2012 was posted there. <br><br>  The Qt5.0.1 source files were unpacked in the same folder: <br><br> <code>C:\Development\qt-everywhere-opensource-src-5.0.1</code> <br> <br>  During installation, checkboxes were selected for writing perl, ruby, and python to the PATH environment variable.  I think that the variant of their manual registration in the command line, in which we will collect, will also fit: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> PATH=C:\Development\Perl64\bin;C:\Development\Python27;C:\Development\Ruby193\bin;%PATH%</code> </pre> <br><br>  We start Command Prompt VS 2012 (I started on behalf of the Administrator).  This thing prescribes all of its own on the way, so we launch it.  The batch file itself is located in <br>  <code>¬´C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\Tools\VsDevCmd.bat¬ª</code> . <br>  Then in it we set the following variables: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> CL=/MP <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> INCLUDE=C:\Development\icu-50.1.2-shared-vs2012\include;%INCLUDE% <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> LIB=C:\Development\icu-50.1.2-shared-vs2012\lib;%LIB% <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> PATH=C:\Development\icu-50.1.2-shared-vs2012\bin;%PATH%</code> </pre><br><br>  With the <code>set CL=/MP</code> command, we most likely indicate to the <code>nmake</code> utility that we have several kernels: "Therefore, please parallelize the compilation tasks." <br><br>  Next, go to the sources folder itself: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> C:\Development\qt-everywhere-opensource-src-5.0.1</code> </pre> <br>  I think the following steps should be done right away, because otherwise the <i>qtwebkit</i> build fails, or rather it does not work: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> PATH=%PATH%;%CD%\gnuwin32\bin <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> .\qtwebkit <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> WEBKITOUTPUTDIR=%CD%\WebkitBuild <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ..\</code> </pre><br><br>  <b>By the way,</b> the <code>set WEBKITOUTPUTDIR=%CD%\WebkitBuild</code> under the big question, do you need it here?  It was taken from the manual on a separate <i>qtwebkit</i> compilation. <br><br>  You can verify the correctness of all paths by typing the following: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> INCLUDE &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> LIB &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> PATH</code> </pre> <br><br>  <b>By the way,</b> you can make a batch file from these commands and run it using the same Command Prompt 2012. <br><br><h5>  Configuration </h5><br>  Now you need to configure the assembly.  To do this, type the following, being in the directory <code>C:\Development\qt-everywhere-opensource-src-5.0.1\:</code> <br><br><pre> <code class="bash hljs">configure -prefix C:\Development\Qt\5.0.1_MSVC2012\qtbase -opensource -platform win32-msvc2012 -debug-and-release -shared -c++11 -nomake examples -nomake tests -icu -confirm-license</code> </pre> <br><br><ul><li>  <code>-prefix C:\Development\Qt\5.0.1_MSVC2012\qtbase</code> we <code>-prefix C:\Development\Qt\5.0.1_MSVC2012\qtbase</code> installation location of our Qt. </li><li>  <code>-confirm-license</code> simply skips the <code>-confirm-license</code> acceptance request. </li><li>  <code>-platform win32-msvc2012</code> point handles the platform.  It seems to me that it can be determined automatically. </li><li>  <code>-debug-and-release</code> collects two options at once, both for debugging and without it.  More options: <code>-debug</code> or <code>-release</code> . </li><li>  <code>-c++11</code> .  Strange, but for some reason this parameter is ignored, although a new standard is declared in VS2012.  By the way, while trying to build for MinGW 4.7 was also ignored.  I wonder how Linux is for gcc? </li><li>  <code>-nomake examples -nomake tests</code> do not collect an example for us and tests are unnecessary, but if you want, you can leave out </li><li>  <code>-shared</code> .  This parameter defines the future of your future Qt applications (I don‚Äôt know how to say it differently).  If it is specified (although, in my opinion, it is defined by default), then all the assembled applications will depend on the presence of installed libraries on the machine.  That is, with the transfer even to the neighbor's computer will be trouble.  To build independent applications, use <code>-static</code> .  But future applications will grow significantly in size (10 KB against 10 MB in a simple helloworld program with a GUI). </li></ul><br><br>  The remaining configuration parameters can be found by typing: <br><br><pre> <code class="bash hljs">configure -<span class="hljs-built_in"><span class="hljs-built_in">help</span></span></code> </pre> <br><br>  There will either be mistakes that are still easy to fix (there are not enough paths or libraries), or everything will be fine.  The process takes no more than 10 minutes. <br><br><h5>  Compile and install </h5><br>  Further, all less joyful.  Just run the <code>nmake</code> command and smoke, drink tea, cook, sleep, etc.  After many hours of assembly (or multi-day), you can run the <code>nmake install</code> command.  It will copy your library to the specified directory in the <code>-prefix</code> parameter. <br><br><h5>  Experience </h5><br>  I was even sadder.  Initially in <code>PATH</code> was a python version 3.3, but I didn‚Äôt do this thing: <br> <code>set PATH=%PATH%;%CD%\gnuwin32\bin</code> <br> <br>  I do not know how long the build lasted, an hour, two or more, but when I tried to build <i>qtwebkit, the nmake</i> utility <code>nmake</code> out due to the lack of some kind of <code>win_flex</code> .  I was crazy because it was my third attempt to build the entire library with <i>qtwebkit</i> , and just entered <code>nmake install</code> .  The library was copied, but not completely.  Again fell out when trying to copy an <i>uncompiled qtwebkit</i> . <br><br>  At this point, my studio has already installed the <a href="">Visual Studio Add-in 1.2.0 for Qt5 extension</a> .  In the settings, I indicated the path to the library installed in half.  Created the first trial application, but after a successful build but refused to start due to the absence of three <i>.dll</i> from <i>icu</i> .  I had to add the path <code>C:\Development\icu-50.1.2-shared-vs2012\lib</code> in the <code>PATH</code> and restart the studio, as a result, everything starts in the studio without any problems.  <i>QtCreator,</i> after setting up this library, refused to launch successfully built applications normally.  For some reason they flew with an error.  Running the assembled application from the build directory turned out to be missing <i>D3DCOMPILER_46.dll.</i> I don‚Äôt know what to do with it.  I would be glad if you tell me. <br><br>  Then I began to look for ways to assemble this sad module, and came across such an instruction: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> PATH=%PATH%;%CD%\gnuwin32\bin <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> .\qtwebkit <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> WEBKITOUTPUTDIR=%CD%\WebkitBuild perl Tools\Scripts\build-webkit --qt --qmake=‚Äù%CD%\\..\\qtbase\\bin\\qmake.exe‚Äù --install-libs= (install der) --release --makeargs=%MAKEFLAGS%</code> </pre><br><br>  But <code>nmake</code> now quarreled with <b>MAKEFLAGS</b> .  Launched without this argument: <br><br><pre> <code class="bash hljs">perl Tools\Scripts\build-webkit --qt --qmake=‚Äù%CD%\\..\\qtbase\\bin\\qmake.exe‚Äù --install-libs= (install der) --release</code> </pre> <br><br>  However, now <code>nmake</code> began to <b>complain</b> about the absence of <b>MainThreadQt.moc</b> .  Therefore, I entered <code>nmake clean</code> and went to the qt shared folder.  Already from there I launched <code>nmake</code> (now <code>%CD%\gnuwin32\bin</code> added to the <b>path</b> ), and, miraculously, it works, IT IS GOING TO.  And from the moment he fell out (he checked that the collected ones already exist and reached the first unassembled).  True, after a while he fell out again.  Now let me down python version 3.3.  Somewhere on the Internet I read that it is worthwhile to install version 2.7, which I did.  Restarted the command line after installing and replacing the path to python in the PATH variable.  I re-registered all the <code>set</code> and entered <code>nmake</code> .  He continued his work. <br><br>  <s>Now I sit waiting for the past hour of the end of the whole epic.</s>  <s>The last action began at about 14:00 Moscow time, somewhere at <code>qtwebkit\webcore</code> he finished <code>qtwebkit\webcore</code> version and began to ‚Äúcook‚Äù release object handlers, which will take the same time.</s>  <s>Plus, there, apparently, was not yet collected the entire library.</s>  <s>I hope that over the next night everything will be done.</s> <br><br>  At the time of writing the main part of the article, <code>nmake</code> collecting <i>qtwebkit</i> for about 8 hours in a row.  It has now been more than a day since the last launch of <code>nmake</code> .  I hasten to rejoice (perceived in two ways) - in a day and 6 hours he collected <i>qtwebkit</i> , another 2 - 4 hours were spent at the very beginning on assembling the main library.  Another 2 - 3 hours was spent on additional utilities, such as <i>QtDesigner</i> , <i>Linguist</i> and <i>Assistant</i> .  The assembly was completed successfully, without failures.  The folder with the source files has <b>grown from 700 - 800 MB to 10 GB!</b> <br><br>  Then I run nmake install.  Copied forty minutes.  As a result, the <code>C:\Development\Qt\5.0.1_MSVC2012\</code> weighs 1.22 GB.  Through <i>Visual Studio Add-in 1.2.0 for Qt5</i> to VS2012, everything ‚Äúclings‚Äù remarkably, only one problem, all Qt compiled applications, even <i>QtDesigner</i> require some kind of <i>D3DCOMPILER_46.dll</i> .  I found it at <code>C:\Program Files (x86)\Windows Kits\8.0\Redist\D3D\x86\</code> .  And also required the library <i>icudt50.dll</i> , <i>icuin50.dll</i> , <i>icuuc50.dll</i> , which are located in <code>C:\Development\icu-50.1.2-shared-vs2012\lib</code> . <br><br>  For some reason I do not understand, the <i>designer</i> and <i>assistant</i> from this assembly do not start, even after manually adding the <i>D3DCOMPILER_46.dll</i> to them.  Can someone have something to say about this? <br><br>  PS I hope that this article will help you, and you will spend less time figuring out the causes of inoperability. </div><p>Source: <a href="https://habr.com/ru/post/168671/">https://habr.com/ru/post/168671/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../168657/index.html">Pixel lights fast and easy</a></li>
<li><a href="../168661/index.html">Yahoo! will show ads google</a></li>
<li><a href="../168665/index.html">Open source software in operational printing</a></li>
<li><a href="../168667/index.html">Briefly about hydrodynamics: do you remember how it all began?</a></li>
<li><a href="../168669/index.html">Tasks and cancellation in .Net - tips & tricks</a></li>
<li><a href="../168673/index.html">Creating Warcraft (part 3)</a></li>
<li><a href="../168675/index.html">Similarities and differences between Mercurial and Git</a></li>
<li><a href="../168677/index.html">PowerShell. Decrypt files after exposure to "virus"</a></li>
<li><a href="../168681/index.html">Interactive infographics with CSS and SVG animations</a></li>
<li><a href="../168683/index.html">The next zero-day vulnerabilities in various routers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>