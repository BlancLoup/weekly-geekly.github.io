<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>.sorting in Perl 6</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sorting lists is a very common programming problem, and Perl 6 has several improvements to the sort function to help you solve this problem. 

 In lan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>.sorting in Perl 6</h1><div class="post__text post__text-html js-mediator-article">  Sorting lists is a very common programming problem, and Perl 6 has several improvements to the sort function to help you solve this problem. <br><br>  In language there is an ordinary typical sort: <br><br><pre><code class="perl hljs"><span class="hljs-comment"><span class="hljs-comment">#       my @sorted = @unsorted.sort; #  sort @unsorted;</span></span></code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As in Perl 5, you can configure a function to compare: <br><br><pre> <code class="perl hljs"> <span class="hljs-comment"><span class="hljs-comment">#   my @sorted = @unsorted.sort: { $^a &lt;=&gt; $^b };</span></span></code> </pre><br><br><pre> <code class="perl hljs"> <span class="hljs-comment"><span class="hljs-comment">#  ,     my @sorted = sort { $^a &lt;=&gt; $^b }, @unsorted;</span></span></code> </pre><br><br><pre> <code class="perl hljs"> <span class="hljs-comment"><span class="hljs-comment">#   (  cmp  Perl 5 ) my @sorted = @unsorted.sort: { $^a leg $^b };</span></span></code> </pre><br><br><pre> <code class="perl hljs"> <span class="hljs-comment"><span class="hljs-comment">#     my @sorted = @unsorted.sort: { $^a cmp $^b };</span></span></code> </pre><br><br>  If you write the comparison condition in parentheses, then you do not need a colon.  This is useful when you want to build a chain of other methods that stretches for sort: <br><br><pre> <code class="perl hljs"> <span class="hljs-keyword"><span class="hljs-keyword">my</span></span> @topten = @scores.sort( { $^b &lt;=&gt; $^a } ).list.munch(<span class="hljs-number"><span class="hljs-number">10</span></span>);</code> </pre><br><a name="habracut"></a><br>  Specification: in Perl 6, the variables $ a and $ b have no special purpose, as in Perl 5. In the sorting comparison block, as in any other block, you can use the usual variables ($ var), positional ($ ^ var) or " whatever ‚Äù(*). <br><br>  During the sorting, you can immediately apply the conversion function: <br><br><pre> <code class="perl hljs"> <span class="hljs-keyword"><span class="hljs-keyword">my</span></span> @sorted = @unsorted.sort: { foo($^a) cmp foo($^b) };</code> </pre><br><br>  but for each iteration, foo () is re-calculated.  For small lists, this is not a problem, but for large lists this becomes a problem, especially if this function is difficult to calculate. <br><br>  In Perl 5, it is typical to use the Schwarz transformation when you need to sort the list not by elements, but by some derivatives of them. <br><br>  When using the Schwartz transformation, each transformation is counted once, then the elements are sorted according to the results of the transformation, and then the original elements are taken from this list. <br><br>  Suppose you need to sort the list of words (‚Äúaaaa‚Äù, ‚Äúa‚Äù, ‚Äúaa‚Äù) by word length.  You must first create a list (["aaaa", 4], ["a", 1], ["aa", 2]), then sort it by numeric value, and then from the resulting list (["a", 1] , ["Aa", 2], ["aaaa", 4]) delete numbers.  As a result, a list will be obtained (‚Äúa‚Äù, ‚Äúaa‚Äù, ‚Äúaaaa‚Äù). <br><br><pre> <code class="perl hljs"> <span class="hljs-comment"><span class="hljs-comment">#   Perl 5 @sorted = map { $_-&gt;[0] } sort { $a-&gt;[1] cmp $b-&gt;[1] } map { [$_, foo($_)] } @unsorted;</span></span></code> </pre><br><br>  In Perl 6, it can also be done, but in addition, some intelligent algorithms are built into sort.  If your function has a number of operands 0 or 1, Perl 6 notices this and automatically adds the Schwartz transform. <br><br>  Take a look at the examples. <br><br><h4>  Case Sorting </h4><br>  Bring each element to lower case, sort, and return the original elements. <br><br><pre> <code class="perl hljs"> <span class="hljs-keyword"><span class="hljs-keyword">my</span></span> @sorted = @unsorted.sort: { .lc };</code> </pre><br><br>  Simplicity. <br><br><h4>  Sort by word length </h4><br>  Sort the list of strings by the number of characters, from short to long. <br><br><pre> <code class="perl hljs"> <span class="hljs-keyword"><span class="hljs-keyword">my</span></span> @sorted = @unsorted.sort: { .chars };</code> </pre><br><br>  Or longest to shortest: <br><br><pre> <code class="perl hljs"> <span class="hljs-keyword"><span class="hljs-keyword">my</span></span> @sorted = @unsorted.sort: { -.chars };</code> </pre><br><br><h4>  Multiple sorting comparators </h4><br>  Several functions can be passed to the sort block for comparison, and it will perform as many transformations as necessary to achieve the first inequality result. <br><br>  Sort by word length, while there is a secondary sort, which sorts words with the same length in order of ASCII characters. <br><br><pre> <code class="perl hljs"> .say <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> @a.sort: { $^a.chars, $^a } ;</code> </pre><br><br>  Sorting in Perl 6 is stable, so you can sort the list in ASCII order, and then by word length. <br><br><pre> <code class="perl hljs"> .say <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> @a.sort.sort: { $^a.chars };</code> </pre><br><br>  It works - but it is sorted twice.  You can rewrite it as follows: <br><br><pre> <code class="perl hljs"> .say <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> @a.sort: { $^a.chars &lt;=&gt; $^b.chars || $^a leg $^b };</code> </pre><br><br>  It also works, but now the automatic conversion of Schwartz is lost. <br><br>  Or you can apply a natural sorting transformation: <br><br><pre> <code class="perl hljs"> .say <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> @a.sort: { $^a.&amp;naturally, $^a };</code> </pre><br><br>  "Something?  Natural sorting?  Where did this come from? ‚Äù  Glad you asked. <br><br><h4>  Natural sorting </h4><br>  Standard sorting by string produces the result in an "ASCII" string.  The numbers in front of uppercase letters, and then lowercase.  People are often surprised to get the following as a result of sorting: <br><br><pre> <code class="bash hljs"> 0 1 100 11 144th 2 21 210 3rd 33rd AND ARE An Bit Can and by car d1 d10 d2</code> </pre><br><br>  And this, of course, is correct, but not entirely intuitive, especially for non-programmers.  Natural sorting would order the list in ascending numbers, and then alphabetically. <br><br>  Here are the same lines, sorted naturally: <br><br><pre> <code class="bash hljs"> 0 1 2 3rd 11 21 33rd 100 144th 210 An AND and ARE Bit by Can car d1 d2 d10</code> </pre><br><br>  To do this, you need to perform a simple conversion.  I will use the subst method.  This is an analogue of the operator s /// in the form of a method. <br><br><pre> <code class="perl hljs"> .subst(<span class="hljs-regexp"><span class="hljs-regexp">/(\d+)/</span></span>, -&gt; $/ { <span class="hljs-number"><span class="hljs-number">0</span></span> ~ $0.chars.chr ~ $0 }, :g)</code> </pre><br><br>  First, we ‚Äúcatch‚Äù a group of one or more consecutive digits.  The construction '-&gt; $ / {...}' is a ‚Äúblock with spikes‚Äù.  It means "to output the contents of the array of matches ($ /) within the scope of the next code block ({...})".  The block builds a replacement string: ‚Äú0‚Äù, to which the number of digits in a number is added, expressed as an ASCII character, after which the string of digits itself is added.  Prefix: g means "globally." <br><br>  And we also need to sort case-insensitively, so we attach another .lc method, and we get the result: <br><br><pre> <code class="perl hljs"> .lc.subst(<span class="hljs-regexp"><span class="hljs-regexp">/(\d+)/</span></span>, -&gt; $/ { <span class="hljs-number"><span class="hljs-number">0</span></span> ~ $0.chars.chr ~ $0 }, :g)</code> </pre><br><br>  We turn it into a function: <br><br><pre> <code class="perl hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">naturally</span></span></span><span class="hljs-function"> ($</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function">) </span></span>{ $a.lc.subst(<span class="hljs-regexp"><span class="hljs-regexp">/(\d+)/</span></span>, -&gt; $/ { <span class="hljs-number"><span class="hljs-number">0</span></span> ~ $0.chars.chr ~ $0 }, :g) }</code> </pre><br><br>  It works almost correctly, but not quite.  Values ‚Äã‚Äãzamaplennye in one transformation, will return in the order in which they were received.  For example, the words 'THE', 'The', and 'the' will return in the order they are received, not in the sort order.  The easiest way is to add the original value to the transformed tail. <br><br>  In total, the final function of natural sorting will be: <br><br><pre> <code class="perl hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">naturally</span></span></span><span class="hljs-function"> ($</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function">) </span></span>{ $a.lc.subst(<span class="hljs-regexp"><span class="hljs-regexp">/(\d+)/</span></span>, -&gt; $/ { <span class="hljs-number"><span class="hljs-number">0</span></span> ~ $0.chars.chr ~ $0 }, :g) ~ <span class="hljs-string"><span class="hljs-string">"\x0"</span></span> ~ $a }</code> </pre><br><br>  Since it works with values ‚Äã‚Äãin turn, we still get the Schwartz transformation for free.  Now it can be used as a sorting modifier. <br><br><pre> <code class="perl hljs"> .say <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> &lt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">144</span></span>th <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span> <span class="hljs-number"><span class="hljs-number">210</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>rd <span class="hljs-number"><span class="hljs-number">33</span></span>rd AND ARE An Bit Can <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> by car d1 d1<span class="hljs-number"><span class="hljs-number">0</span></span> d2&gt;.sort: { .&amp;naturally };</code> </pre><br><br>  Or sort ip addresses: <br><br><pre> <code class="perl hljs"> <span class="hljs-comment"><span class="hljs-comment">#   ip my @ips = ((0..255).roll(4).join('.')for 0..99); .say for @ips.sort: { .&amp;naturally }; 4.108.172.65 5.149.121.70 10.24.201.53 11.10.90.219 12.83.84.206 12.124.106.41 12.162.149.98 14.203.88.93 16.18.0.178 17.68.226.104 21.201.181.225 23.61.166.202 23.205.73.104 24.250.90.75 35.56.124.120 36.158.70.141 40.149.118.209 40.238.169.146 52.107.62.129 55.119.95.120 56.39.105.245 ...   </span></span></code> </pre><br><br>  Or sort the list of files, or anything that contains a mixture of numbers and symbols. </div><p>Source: <a href="https://habr.com/ru/post/267887/">https://habr.com/ru/post/267887/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267875/index.html">19 principles of development on BEM, or what every library developer should know</a></li>
<li><a href="../267877/index.html">Partner Seminar "1C" - for the first time not only for partners</a></li>
<li><a href="../267879/index.html">Financial Computing Challenge</a></li>
<li><a href="../267881/index.html">12 typical database backup errors</a></li>
<li><a href="../267883/index.html">Optimization of communication channels for mining in the north of Russia</a></li>
<li><a href="../267889/index.html">GitFlow and Semantic Versioning for every day</a></li>
<li><a href="../267893/index.html">Checking Appleseed source code</a></li>
<li><a href="../267895/index.html">Creating a JavaScript Synthesizer</a></li>
<li><a href="../267899/index.html">Online Trading: How to become a developer of systems for trading on the exchange</a></li>
<li><a href="../267901/index.html">The digest of news from the world of development on Unity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>