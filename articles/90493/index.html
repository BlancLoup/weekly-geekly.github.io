<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Code Like a Pythonista: Idiomatic Python (part2)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After a short break, I present the final part of the translation of David Guder‚Äôs article ‚ÄúWrite the code like a real Pythonist: Python idiomatics‚Äù 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Code Like a Pythonista: Idiomatic Python (part2)</h1><div class="post__text post__text-html js-mediator-article"><img src="http://img30.imageshack.us/img30/927/kaapart203.jpg" alt="Kaa, the Python"><br><br><br>  After a short break, I present the final part of the translation of David Guder‚Äôs article <a title="CLaP" href="http://python.net/~goodger/projects/pycon/2007/idiomatic/presentation.html">‚ÄúWrite the code like a real Pythonist: Python idiomatics‚Äù</a> <br><br><br>  References to the <a href="http://habrahabr.ru/blogs/python/88972/">first</a> and <a href="http://habrahabr.ru/blogs/python/89735/">second</a> parts. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <br>  <em>Once again, the author in this article does not discover America, most of the Pythonists will not find any "special magic" in it.</em>  <em>But the methodologies for using and selecting various constructions in Python are listed in some detail in terms of readability and proximity to the PEP8 ideology.</em> <br>  <em>In some places in the author's article there are no examples of source codes.</em>  <em>Of course, I left it as it is, I did not invent my own, in principle it should be clear what the author meant.</em> <br><br><a name="habracut"></a><br><hr><br><br><h2>  List generators (‚ÄúList Comprehensions‚Äù - possibly as ‚Äúlist convolution‚Äù - note. Transl.) </h2><br>  List generators (‚Äúlistcomps‚Äù for short) are a syntactic abbreviation for the following pattern: <br>  The traditional path, with for and if statements: <br><blockquote><code>new_list <font color="#666">=</font> []&lt;br/&gt; <br> <font color="#008000"><strong>for</strong></font> item <font color="#A2F"><strong>in</strong></font> a_list:&lt;br/&gt; <br> <font color="#008000"><strong>if</strong></font> condition(item):&lt;br/&gt; <br> new_list <font color="#666">.</font> append(fn(item))&lt;br/&gt; <br></code> </blockquote><br>  And so with the list generator: <br><blockquote> <code>new_list <font color="#666">=</font> [fn(item) <font color="#008000"><strong>for</strong></font> item <font color="#A2F"><strong>in</strong></font> a_list&lt;br/&gt; <br> <font color="#008000"><strong>if</strong></font> condition(item)]&lt;br/&gt; <br></code> </blockquote><br>  List generators are straightforward and short to the point.  You may need a lot of nested for and if conditions in the list generator, but for two, three cycles, or sets of if conditions, I recommend using nested for loops.  In accordance with the Python Zen, it is better to choose a more readable way. <br>  For example, the list of squares in the number series 0‚Äì9: <br><blockquote> <code><font color="#666">&gt;&gt;&gt;</font> [n <font color="#666">**</font> <font color="#666">2</font> <font color="#008000"><strong>for</strong></font> n <font color="#A2F"><strong>in</strong></font> <font color="#008000">range</font> ( <font color="#666">10</font> )]&lt;br/&gt; <br> [ <font color="#666">0,</font> <font color="#666">1</font> , <font color="#666">4</font> , <font color="#666">9</font> , <font color="#666">16</font> , <font color="#666">25</font> , <font color="#666">36</font> , <font color="#666">49</font> , <font color="#666">64</font> , <font color="#666">81</font> ]&lt;br/&gt; <br></code> </blockquote><br>  A list of odd squares between 0‚Äì9: <br><blockquote> <code><font color="#666">&gt;&gt;&gt;</font> [n <font color="#666">**</font> <font color="#666">2</font> <font color="#008000"><strong>for</strong></font> n <font color="#A2F"><strong>in</strong></font> <font color="#008000">range</font> ( <font color="#666">10</font> ) <font color="#008000"><strong>if</strong></font> n <font color="#666">%</font> <font color="#666">2</font> ]&lt;br/&gt; <br> [ <font color="#666">1</font> , <font color="#666">9</font> , <font color="#666">25</font> , <font color="#666">49</font> , <font color="#666">81</font> ]&lt;br/&gt; <br></code> </blockquote><br><br><br><h2>  Expressions Generators (1) </h2><br>  Let's sum up the squares of numbers up to 100: <br>  In the loop: <br><blockquote> <code>total <font color="#666">=</font> <font color="#666">0 <br> <font color="#008000"><strong>for</strong></font> num <font color="#A2F"><strong>in</strong></font> <font color="#008000">range</font> ( <font color="#666">1</font> , <font color="#666">101</font> ):&lt;br/&gt; <br> total <font color="#666">+=</font> num <font color="#666">*</font> num &lt;br/&gt;</font></code> <br>  You can use the sum function to quickly assemble the sequence that suits us. <br>  With list generator: <br><blockquote> <code>total <font color="#666">=</font> <font color="#008000">sum</font> ([num <font color="#666">*</font> num <font color="#008000"><strong>for</strong></font> num <font color="#A2F"><strong>in</strong></font> <font color="#008000">range</font> ( <font color="#666">1</font> , <font color="#666">101</font> )])&lt;br/&gt; <br></code> </blockquote><br>  With a generator expression: <br><blockquote> <code>total <font color="#666">=</font> <font color="#008000">sum</font> (num <font color="#666">*</font> num <font color="#008000"><strong>for</strong></font> num <font color="#A2F"><strong>in</strong></font> xrange( <font color="#666">1</font> , <font color="#666">101</font> ))&lt;br/&gt; <br></code> </blockquote><br>  Generator expressions (‚Äúgenexps‚Äù) are as simple as list generators, but list generators are ‚Äúgreedy,‚Äù and expression-generators are ‚Äúlazy.‚Äù  The list generator calculates the whole list-result, all at once.  The generator expression calculates only one value per pass when needed.  This is especially useful for long sequences, when the computed list is just an intermediate step, not the final result. <br>  In this case, we are interested only in the total amount;  we do not need an intermediate list of squares of numbers.  We use xrange for the same reason: it returns values ‚Äã‚Äãlazily, one per iteration. <br></blockquote><br><h2>  Expressions-generators (2) </h2><br>  For example, if we summed the squares of several billion numbers, we would face a lack of memory, and expression-generators do not have such a problem.  But this, all the same, takes time! <br><blockquote> <code>total <font color="#666">=</font> <font color="#008000">sum</font> (num <font color="#666">*</font> num&lt;br/&gt; <br> <font color="#008000"><strong>for</strong></font> num <font color="#A2F"><strong>in</strong></font> xrange( <font color="#666">1</font> , <font color="#666">1000000000</font> ))&lt;br/&gt; <br></code> </blockquote><br>  The difference in syntax is that the list generator is placed in square brackets, but the generator expression is not.  Generator expressions are sometimes required to be enclosed in parentheses, so you should always use them. <br>  The basic rule is: <br><ul><li>  Use the list generator when the calculated list is the desired result. </li><li>  Use a generator expression when a computed list is just an intermediate step. </li></ul><br><br>  Here is an example that recently caught in work. <br>  ?  <em>(for some reason, there is no example code - approx. transl.)</em> <br>  We need a dictionary containing numbers (both in strings and integers) and month codes for future contracts.  It can be obtained in just one line of code. <br>  ?  <em>(for some reason, there is no example code - approx. transl.)</em> <br>  The following will help us: <br><ul><li>  dict () takes a list of key / value pairs (2-tuples). </li><li>  We have a list of month codes (each month is encoded with one letter, and the string is also a list of characters).  We use the enumerate function for this list to get the numbered codes of all months. </li><li>  Month numbers start at 1, but Python starts indexing at 0, so the month number is one more than the corresponding index. </li><li>  We need to search the month by line and number.  We can use for this function int (), str () and iterate over them in a loop. </li></ul><br><br>  A recent example: <br><blockquote> <code>month_codes <font color="#666">=</font> <font color="#008000">dict</font> ((fn(i <font color="#666">+</font> <font color="#666">1</font> ), code)&lt;br/&gt; <br> <font color="#008000"><strong>for</strong></font> i, code <font color="#A2F"><strong>in</strong></font> <font color="#008000">enumerate</font> ( <font color="#BA2121">'FGHJKMNQUVXZ'</font> )&lt;br/&gt; <br> <font color="#008000"><strong>for</strong></font> fn <font color="#A2F"><strong>in</strong></font> ( <font color="#008000">int</font> , <font color="#008000">str</font> ))&lt;br/&gt; <br></code> </blockquote><br>  month_codes result: <br><blockquote> <code>{ <font color="#666">1</font> : <font color="#BA2121">'F'</font> , <font color="#666">2</font> : <font color="#BA2121">'G'</font> , <font color="#666">3</font> : <font color="#BA2121">'H'</font> , <font color="#666">4</font> : <font color="#BA2121">'J'</font> , <font color="#666">...</font> &lt;br/&gt; <br> <font color="#BA2121">'1'</font> : <font color="#BA2121">'F'</font> , <font color="#BA2121">'2'</font> : <font color="#BA2121">'G'</font> , <font color="#BA2121">'3'</font> : <font color="#BA2121">'H'</font> , <font color="#BA2121">'4'</font> : <font color="#BA2121">'J'</font> , <font color="#666">...</font> }&lt;br/&gt; <br></code> </blockquote><br><br><h2>  Sorting </h2><br>  Sorting lists in Python is easy: <br><blockquote> <code>a_list <font color="#666">.</font> sort()&lt;br/&gt; <br></code> </blockquote><br>  (Note that the list is sorted in the same list: the original list is sorted, and the sort method <strong>does not return a</strong> list or a copy of it) <br>  But what if you have a list of data that you need to sort, but in a different order than standard (ie, sort by first column, then by second, etc.)?  You may need to sort first by the second column, then by the fourth. <br><br>  We can use the built-in sort list method with a special function: <br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#00F">custom_cmp</font> (item1, item2):&lt;br/&gt; <br> <font color="#008000"><strong>return</strong></font> <font color="#008000">cmp</font> ((item1[ <font color="#666">1</font> ], item1[ <font color="#666">3</font> ]),&lt;br/&gt; <br> (item2[ <font color="#666">1</font> ], item2[ <font color="#666">3</font> ]))&lt;br/&gt; <br> &lt;br/&gt; <br> a_list <font color="#666">.</font> sort(custom_cmp)&lt;br/&gt; <br></code> </blockquote><br>  It works, but it is extremely slow with large lists. <br><br><h2>  Sort with DSU * </h2><br>  DSU = Decorate-Sort-Undecorate <br>  * Note: DSU is often not so necessary.  See the next section ‚ÄúKey sorting‚Äù for a description of another method. <br>  Instead of creating a special comparison function, we create an auxiliary list with which sorting will be normal: <br><blockquote> <code><font color="#408080"><em># Decorate:</em></font> &lt;br/&gt; <br> to_sort <font color="#666">=</font> [(item[ <font color="#666">1</font> ], item[ <font color="#666">3</font> ], item)&lt;br/&gt; <br> <font color="#008000"><strong>for</strong></font> item <font color="#A2F"><strong>in</strong></font> a_list]&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#408080"><em># Sort:</em></font> &lt;br/&gt; <br> to_sort <font color="#666">.</font> sort()&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#408080"><em># Undecorate:</em></font> &lt;br/&gt; <br> a_list <font color="#666">=</font> [item[ <font color="#666">-</font> <font color="#666">1</font> ] <font color="#008000"><strong>for</strong></font> item <font color="#A2F"><strong>in</strong></font> to_sort]&lt;br/&gt; <br></code> </blockquote><br>  The first line creates a list containing tuples: consisting of the sort condition in the correct order and the complete record (element) of the data. <br>  The second line performs traditional sorting, fast and efficient. <br>  The third line retrieves the <strong>last</strong> value from the sorted list. <br>  Remember, this last value is the whole element (record, block) of data.  We discard the sorting conditions with which the work was done, and they are no longer needed. <br><br>  This achieves a compromise of the memory used, the complexity of the algorithm and the execution time.  Much easier and faster, but you have to duplicate the original list. <br><br><h2>  Key sorting </h2><br>  In Python 2.4, the optional argument ‚Äúkey‚Äù appeared in the sort list method, which in turn sets the function of one argument, used to calculate the comparison key for each element of the list.  For example: <br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#00F">my_key</font> (item):&lt;br/&gt; <br> <font color="#008000"><strong>return</strong></font> (item[ <font color="#666">1</font> ], item[ <font color="#666">3</font> ])&lt;br/&gt; <br> &lt;br/&gt; <br> to_sort <font color="#666">.</font> sort(key <font color="#666">=</font> my_key)&lt;br/&gt; <br></code> </blockquote><br>  The my_key function will be called once for each item in the to_sort list. <br>  You can assemble your own key-function or use any existing function of one argument, if necessary: <br><ul><li>  str.lower to sort alphabetically regardless of the case of characters. </li><li>  len to sort by the length of the elements (strings or containers). </li><li>  int or float to sort in numerical order, as with numeric strings like "2", "123", "35". </li></ul><br><br><h2>  Generators </h2><br>  We have already seen the expression-generators.  We can develop our arbitrarily complex generators as functions: <br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#00F">my_range_generator</font> (stop):&lt;br/&gt; <br> value <font color="#666">=</font> <font color="#666">0</font> &lt;br/&gt; <br> <font color="#008000"><strong>while</strong></font> value <font color="#666">&lt;</font> stop:&lt;br/&gt; <br> <font color="#008000"><strong>yield</strong></font> value&lt;br/&gt; <br> value <font color="#666">+=</font> <font color="#666">1</font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#008000"><strong>for</strong></font> i <font color="#A2F"><strong>in</strong></font> my_range_generator( <font color="#666">10</font> ):&lt;br/&gt; <br> do_something(i)&lt;br/&gt; <br></code> </blockquote><br>  The yield keyword turns a function into a generator.  When you call a generator-function, instead of executing the code, Python returns a generator object, which, as we remember, is an iterator;  and it has a method next.  In the for loop, the iterator's next method is simply called until the StopIteration exception is generated.  You can cause StopIteration explicitly or implicitly, falling out at the end of the code, as above. <br>  Generators can simplify the processing of a sequence / iterator, since we do not need to build a specific list;  just one value is calculated for each iteration. <br><br>  Let me explain how the for loop actually works.  Python looks at the sequence specified after the in keyword.  If it is a simple container (like a list, tuple, dictionary, set, or user-defined), Python converts it into an iterator.  If this object is already an iterator, Python uses it directly. <br>  Python then repeatedly calls the iterator's next method, binds the return value to the loop counter (i in this case), and executes the loop body code.  This process is repeated again and again until the StopIteration exception is raised or the break instruction in the loop body is executed. <br>  The for loop may include an else condition (otherwise), the code of which will be executed after exiting the loop, but <strong>not after the</strong> execution of the break instruction.  This feature provides very elegant solutions.  The else condition is not always and often used with a for loop, but it may come in handy.  Sometimes else successfully expresses the logic you need. <br>  For example, if you need to check the condition contained in some element, any element of the sequence: <br><blockquote> <code><font color="#008000"><strong>for</strong></font> item <font color="#A2F"><strong>in</strong></font> sequence:&lt;br/&gt; <br> <font color="#008000"><strong>if</strong></font> condition(item):&lt;br/&gt; <br> <font color="#008000"><strong>break</strong></font> &lt;br/&gt; <br> <font color="#008000"><strong>else</strong></font> :&lt;br/&gt; <br> <font color="#008000"><strong>raise</strong></font> <font color="#D2413A"><strong>Exception</strong></font> ( <font color="#BA2121">'Condition not satisfied.'</font> )&lt;br/&gt; <br></code> </blockquote><br><br><br><h2>  Generator example </h2><br>  Filter blank lines from a CSV file (or items from the list): <br><blockquote> <code><font color="#008000"><strong>def</strong></font> <font color="#00F">filter_rows</font> (row_iterator):&lt;br/&gt; <br> <font color="#008000"><strong>for</strong></font> row <font color="#A2F"><strong>in</strong></font> row_iterator:&lt;br/&gt; <br> <font color="#008000"><strong>if</strong></font> row:&lt;br/&gt; <br> <font color="#008000"><strong>yield</strong></font> row&lt;br/&gt; <br> &lt;br/&gt; <br> data_file <font color="#666">=</font> <font color="#008000">open</font> (path, <font color="#BA2121">'rb'</font> )&lt;br/&gt; <br> irows <font color="#666">=</font> filter_rows(csv <font color="#666">.</font> reader(data_file))&lt;br/&gt; <br></code> </blockquote><br><br><h2>  Reading lines from a text file </h2><br><blockquote> <code>datafile <font color="#666">=</font> <font color="#008000">open</font> ( <font color="#BA2121">'datafile'</font> )&lt;br/&gt; <br> <font color="#008000"><strong>for</strong></font> line <font color="#A2F"><strong>in</strong></font> datafile:&lt;br/&gt; <br> do_something(line)&lt;br/&gt; <br></code> </blockquote><br>  It is possible, because the files support the next method, as other iterators do: lists, tuples, dictionaries (for their keys), <br>  generators. <br>  Be careful here: due to the buffering of file operations, you cannot mix the .next and .read * methods if you are not using Python 2.5+. <br><br><br><h2>  EAFP vs.  Lbyl </h2><br>  It's easier to ask forgiveness than permission.  (It's easier to ask forgiveness than permission) <br>  Measure seven times, cut one.  (Look before you leap) <br>  EAFP is usually preferred, but not always. <br><ul><li>  Duck typing <br>  If it walks like a duck, quacks like a duck and looks like a duck, then it is a duck.  (Gus? Close enough.) <br></li><li>  Exceptions <br>  Use an explicit indication if the object should be of a specific type.  If x must be a string for your code to work, then why not declare it? <br><br><blockquote> <code><font color="#008000">str</font> (x)&lt;br/&gt; <br></code> </blockquote><br>  and instead of trying at random, use something like: <br><br><blockquote> <code><font color="#008000">isinstance</font> (x, <font color="#008000">str</font> )&lt;br/&gt; <br></code> </blockquote><br></li></ul><br><br><h2>  EAFP try / except Example </h2><br>  You can put code that is prone to exceptions in the try / except block to catch errors, and in the end, you might get a more general solution than if you tried to anticipate all the options. <br><blockquote> <code><font color="#008000"><strong>try</strong></font> :&lt;br/&gt; <br> <font color="#008000"><strong>return</strong></font> <font color="#008000">str</font> (x)&lt;br/&gt; <br> <font color="#008000"><strong>except</strong></font> <font color="#D2413A"><strong>TypeError</strong></font> :&lt;br/&gt; <br> <font color="#666">...</font> &lt;br/&gt; <br></code> </blockquote><br>  Note: it is always necessary to define exceptions to intercept.  Never use the pure except condition.  The pure condition except will catch all the exceptions that occur in your code, making it extremely difficult to debug. <br><br><h2>  Importing </h2><br><blockquote> <code><font color="#008000"><strong>from</strong></font> <font color="#00F"><strong>module</strong></font> <font color="#008000"><strong>import</strong></font> <font color="#666">*</font> &lt;br/&gt; <br></code> </blockquote><br>  You have probably seen this ‚Äúwild card‚Äù (wild card, pattern) in the module import expressions.  You might even like her.  <strong>Do not use it.</strong> <br>  Adaptation of the famous dialogue: <br><blockquote>  (Outer Dagobah, jungle, swamp and fog.) <br>  LUC: from module import * better than explicit import? <br>  YODA: No better, no.  Faster, easier, more seductive. <br>  LUKE: But how do I know that explicit imports are better than wild cards? <br>  YODA: Find out when you want to read your code in six months, try. <br></blockquote><br>  <em>(Just in case, I cite the text of the original - note. Transl.)</em> <br><blockquote>  (Exterior Dagobah, jungle, swamp, and mist.) <br>  LUKE: Is it from module import * better than explicit imports? <br>  YODA: No, not better.  Quicker, easier, more seductive. <br>  I know what's better <br>  the wild-card form? <br>  YODA: six months <br>  from now. <br></blockquote><br>  Wild Card Import - The Dark Side of Python. <br><br>  <strong>Never!</strong> <br>  from module import * heavily pollutes the namespace.  You will find objects in your local namespace that you did not expect to receive.  You can see the names that override local, previously defined in the module.  You cannot figure out exactly where these names come from.  Although this form is short and simple, it has no place in the final code. <br>  Moral: <strong>Do not use imports with a wild card!</strong> <br>  So much better: <br><ul><li>  name binding through their modules (full description of identifiers, indicating their origin), <br></li><li>  import of long module names via a shortened name (alias, alias), <br></li><li>  or explicitly import the exact names you need. <br></li></ul><br>  Anxiety pollution namespace! <br>  Instead of this, <br>  Link the names through their modules (identifiers described in detail, with their origin): <br><blockquote> <code><font color="#008000"><strong>import</strong></font> <font color="#00F"><strong>module</strong></font> &lt;br/&gt; <br> module <font color="#666">.</font> name&lt;br/&gt; <br></code> </blockquote><br>  or import long module names via alias: <br><blockquote> <code><font color="#008000"><strong>import</strong></font> <font color="#00F"><strong>long_module_name</strong></font> <font color="#008000"><strong>as</strong></font> <font color="#00F"><strong>mod</strong></font> &lt;br/&gt; <br> mod <font color="#666">.</font> name&lt;br/&gt; <br></code> </blockquote><br>  or explicitly import only the names you need: <br><blockquote> <code><font color="#008000"><strong>from</strong></font> <font color="#00F"><strong>module</strong></font> <font color="#008000"><strong>import</strong></font> name&lt;br/&gt; <br> name&lt;br/&gt; <br></code> </blockquote><br>  Note that this form is not suitable for use in an interactive interpreter, where you may want to edit and reload (‚Äúreload ()‚Äù) a module. <br><br><h2>  Modules and Scripts </h2><br>  To make both an imported module and an executable script: <br><blockquote> <code><font color="#008000"><strong>if</strong></font> __name__ <font color="#666">==</font> <font color="#BA2121">'__main__'</font> :&lt;br/&gt; <br> <font color="#408080"><em># script code here</em></font> &lt;br/&gt; <br></code> </blockquote><br>  When you import it, the module attribute __name__ is set as the file name without the extension ".py".  So the code by condition if will not work when the module is imported.  When you execute the script, the __name__ attribute is set to "__main__", and the script code <em>will</em> work. <br>  With the exception of some special cases, you should not put all the code in the top level.  Hide the code in functions, classes, methods, and close it with if __name__ == '__main__'. <br><br><br><h2>  Module structure </h2><br><blockquote> <code><font color="#BA2121"><em>"""module docstring"""</em></font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#408080"><em># imports</em></font> &lt;br/&gt; <br> <font color="#408080"><em># constants</em></font> &lt;br/&gt; <br> <font color="#408080"><em># exception classes</em></font> &lt;br/&gt; <br> <font color="#408080"><em># interface functions</em></font> &lt;br/&gt; <br> <font color="#408080"><em># classes</em></font> &lt;br/&gt; <br> <font color="#408080"><em># internal functions &amp; classes</em></font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#008000"><strong>def</strong></font> <font color="#00F">main</font> ( <font color="#666">...</font> ):&lt;br/&gt; <br> <font color="#666">...</font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#008000"><strong>if</strong></font> __name__ <font color="#666">==</font> <font color="#BA2121">'__main__'</font> :&lt;br/&gt; <br> status <font color="#666">=</font> main()&lt;br/&gt; <br> sys <font color="#666">.</font> exit(status)&lt;br/&gt; <br></code> </blockquote><br>  This is how a module should be structured. <br><br><h2>  Command line processing </h2><br>  Example: cmdline.py: <br><blockquote> <code><font color="#408080"><em>#!/usr/bin/env python</em></font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#BA2121"><em>"""&lt;br/&gt; <br> Module docstring.&lt;br/&gt; <br> """</em></font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#008000"><strong>import</strong></font> <font color="#00F"><strong>sys</strong></font> &lt;br/&gt; <br> <font color="#008000"><strong>import</strong></font> <font color="#00F"><strong>optparse</strong></font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#008000"><strong>def</strong></font> <font color="#00F">process_command_line</font> (argv):&lt;br/&gt; <br> <font color="#BA2121"><em>"""&lt;br/&gt; <br> Return a 2-tuple: (settings object, args list).&lt;br/&gt; <br> `argv` is a list of arguments, or `None` for ``sys.argv[1:]``.&lt;br/&gt; <br> """</em></font> &lt;br/&gt; <br> <font color="#008000"><strong>if</strong></font> argv <font color="#A2F"><strong>is</strong></font> <font color="#008000"><strong>None</strong></font> :&lt;br/&gt; <br> argv <font color="#666">=</font> sys <font color="#666">.</font> argv[ <font color="#666">1</font> :]&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#408080"><em># initialize the parser object:</em></font> &lt;br/&gt; <br> parser <font color="#666">=</font> optparse <font color="#666">.</font> OptionParser(&lt;br/&gt; <br> formatter <font color="#666">=</font> optparse <font color="#666">.</font> TitledHelpFormatter(width <font color="#666">=</font> <font color="#666">78</font> ),&lt;br/&gt; <br> add_help_option <font color="#666">=</font> <font color="#008000"><strong>None</strong></font> )&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#408080"><em># define options here:</em></font> &lt;br/&gt; <br> parser <font color="#666">.</font> add_option( <font color="#408080"><em># customized description; put --help last</em></font> &lt;br/&gt; <br> <font color="#BA2121">'-h'</font> , <font color="#BA2121">'--help'</font> , action <font color="#666">=</font> <font color="#BA2121">'help'</font> ,&lt;br/&gt; <br> help <font color="#666">=</font> <font color="#BA2121">'Show this help message and exit.'</font> )&lt;br/&gt; <br> &lt;br/&gt; <br> settings, args <font color="#666">=</font> parser <font color="#666">.</font> parse_args(argv)&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#408080"><em># check number of arguments, verify values, etc.:</em></font> &lt;br/&gt; <br> <font color="#008000"><strong>if</strong></font> args:&lt;br/&gt; <br> parser <font color="#666">.</font> error( <font color="#BA2121">'program takes no command-line arguments; '</font> &lt;br/&gt; <br> <font color="#BA2121">'"%s" ignored.'</font> <font color="#666">%</font> (args,))&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#408080"><em># further process settings &amp; args if necessary</em></font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#008000"><strong>return</strong></font> settings, args&lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#008000"><strong>def</strong></font> <font color="#00F">main</font> (argv <font color="#666">=</font> <font color="#008000"><strong>None</strong></font> ):&lt;br/&gt; <br> settings, args <font color="#666">=</font> process_command_line(argv)&lt;br/&gt; <br> <font color="#408080"><em># application code here, like:</em></font> &lt;br/&gt; <br> <font color="#408080"><em># run(settings, args)</em></font> &lt;br/&gt; <br> <font color="#008000"><strong>return</strong></font> <font color="#666">0</font> <font color="#408080"><em># success</em></font> &lt;br/&gt; <br> &lt;br/&gt; <br> <font color="#008000"><strong>if</strong></font> __name__ <font color="#666">==</font> <font color="#BA2121">'__main__'</font> :&lt;br/&gt; <br> status <font color="#666">=</font> main()&lt;br/&gt; <br> sys <font color="#666">.</font> exit(status)&lt;br/&gt; <br></code> </blockquote><br><br><br><h2>  Packages </h2><br><blockquote> <code>package <font color="#666">/</font> &lt;br/&gt; <br> __init__ <font color="#666">.</font> py&lt;br/&gt; <br> module1 <font color="#666">.</font> py&lt;br/&gt; <br> subpackage <font color="#666">/</font> &lt;br/&gt; <br> __init__ <font color="#666">.</font> py&lt;br/&gt; <br> module2 <font color="#666">.</font> py&lt;br/&gt; <br></code> </blockquote><br><ul><li>  Use to organize your projects. </li><li>  Reduces the cost of finding the path when loading. </li><li>  Reduce name import conflicts. </li></ul><br>  Example: <br><blockquote> <code><font color="#008000"><strong>import</strong></font> <font color="#00F"><strong>package.module1</strong></font> &lt;br/&gt; <br> <font color="#008000"><strong>from</strong></font> <font color="#00F"><strong>package.subpackage</strong></font> <font color="#008000"><strong>import</strong></font> module2&lt;br/&gt; <br> <font color="#008000"><strong>from</strong></font> <font color="#00F"><strong>package.subpackage.module2</strong></font> <font color="#008000"><strong>import</strong></font> name&lt;br/&gt; <br></code> </blockquote><br>  In Python 2.5, we now have absolute and relative imports through future import: <br><blockquote> <code><font color="#008000"><strong>from</strong></font> <font color="#00F"><strong>__future__</strong></font> <font color="#008000"><strong>import</strong></font> absolute_import&lt;br/&gt; <br></code> </blockquote><br>  I haven't figured it out deeply enough yet, so we'll omit this part of our discussion. <br><br><br><h2>  Simple is better than difficult </h2><br><blockquote>  First, debugging is twice as difficult to write code.  Therefore, if you write code as intelligently as possible, you are, by definition, not smart enough to debug it. <br>  ‚ÄîBrian W. Kernighan, co-author of <em>The C Programming Language</em> and the ‚ÄúK‚Äù in ‚ÄúAWK‚Äù <br></blockquote><br>  In other words, keep your programs simple! <br><br><h2>  Do not reinvent the wheel </h2><br>  Before writing any code: <br><ul><li>  Check out the standard Python library. <br></li><li>  Check out the Python Package Index (‚ÄúCheese Shop‚Äù) <a href="http://cheeseshop.python.org/pypi">http://cheeseshop.python.org/pypi</a> <br>  <em>(Apparently, a hint of a sketch about a cheese shop; I found a similar one in the <a href="">wiki textbook</a> ‚Äî note. transl.)</em> <br></li><li>  Search the net.  Google is your friend. <br></li></ul><br><br><h2>  Links </h2><br><ul><li>  "Python Objects", Fredrik Lundh, <br>  <a href="http://www.effbot.org/zone/python-objects.htm">http://www.effbot.org/zone/python-objects.htm</a> </li><li>  "How to think like a Pythonista", by Mark Hammond, <br>  <a href="http://python.net/crew/mwh/hacks/objectthink.html">http://python.net/crew/mwh/hacks/objectthink.html</a> </li><li>  "Python main () functions", Guido van Rossum, <br>  <a href="http://www.artima.com/weblogs/viewpost.jsp%3Fthread%3D4829">http://www.artima.com/weblogs/viewpost.jsp?thread=4829</a> </li><li>  Python Idioms and Efficiency, <br>  <a href="http://jaynes.colorado.edu/PythonIdioms.html">http://jaynes.colorado.edu/PythonIdioms.html</a> </li><li>  "Python track: python idioms", <br>  <a href="http://www.cs.caltech.edu/courses/cs11/material/python/misc/python_idioms.html">http://www.cs.caltech.edu/courses/cs11/material/python/misc/python_idioms.html</a> </li><li>  "Be Pythonic", Shalabh Chaturvedi, <br>  <a href="http://shalabh.infogami.com/Be_Pythonic2">http://shalabh.infogami.com/Be_Pythonic2</a> </li><li>  "Python Is Not Java", Phillip J. Eby, <br>  <a href="http://dirtsimple.org/2004/12/python-is-not-java.html">http://dirtsimple.org/2004/12/python-is-not-java.html</a> </li><li>  "What is Pythonic?", Martijn Faassen, <br>  <a href="http://faassen.n--tree.net/blog/view/weblog/2005/08/06/0">http://faassen.n--tree.net/blog/view/weblog/2005/08/06/0</a> </li><li>  Sorting Mini-HOWTO, Andrew Dalke, <br>  <a href="http://wiki.python.org/moin/HowTo/Sorting">http://wiki.python.org/moin/HowTo/Sorting</a> </li><li>  Python Idioms, <a href="http://www.gungfu.de/facts/wiki/Main/PythonIdioms">http://www.gungfu.de/facts/wiki/Main/PythonIdioms</a> </li><li>  Python FAQs, <a href="http://www.python.org/doc/faq/">http://www.python.org/doc/faq/</a> </li></ul><br><br><br><br><br><hr><br>  The article was prepared in the <a title="Habra editor" href="http://www.bankinform.ru/HabraEditor/">Habraredactor</a> ; examples of the code are colored by <a href="http://habrahabr.ru/blogs/python/86781/">Habra-colorer</a> with the default style. <br></div><p>Source: <a href="https://habr.com/ru/post/90493/">https://habr.com/ru/post/90493/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../90486/index.html">nanoCAD VK 1.0 - water supply and sewage design</a></li>
<li><a href="../90487/index.html">Parallel data import</a></li>
<li><a href="../90488/index.html">Creating a scrollbar of pictures a la iPhoto. Part 1</a></li>
<li><a href="../90489/index.html">Catching online virus activity with Netflow</a></li>
<li><a href="../90491/index.html">You must be a fool to start a company</a></li>
<li><a href="../90495/index.html">Jump in! Developer camp. Microsoft and the Open Source Community - a course for convergence</a></li>
<li><a href="../90499/index.html">Are you excited about the taskbar, but do you work in Windows XP?</a></li>
<li><a href="../90500/index.html">Timezone on rutracker.org. Opinion habrovchan</a></li>
<li><a href="../90503/index.html">A new era of earnings on the Internet - mobile applications</a></li>
<li><a href="../90505/index.html">Who do you trust more: ebay.com or hammer.ru?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>