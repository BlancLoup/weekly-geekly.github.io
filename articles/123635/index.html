<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Scalable JavaScript applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="More than a month ago in the article FAQ on JavaScript: ask questions the question was ‚ÄúTell me examples of a good approach to organizing JS code to a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Scalable JavaScript applications</h1><div class="post__text post__text-html js-mediator-article">  More than a month ago in the article <a href="http://habrahabr.ru/blogs/javascript/119851/">FAQ on JavaScript: ask questions the question</a> was ‚ÄúTell me examples of a good approach to organizing JS code to a site at a high level.  How can I learn more about the practice of implementing for example gmail? ‚Äù. <br><br>  It's time to answer this question.  I tightened a bit.  I wanted to tell a report on the topic of the same name on J. Subbotnik.  The report was very short many important points had to be thrown out.  Article - more or less complete version. <br><br>  This article is about how to make a large web application extensible and supported: architecture, approaches, rules. <br><a name="habracut"></a><br>  If you are working on a web application, then most of the time you spend on writing code, fixing errors.  Only a small part is spent on writing new functionality.  Any complex web application is constantly changing.  Today - 1 line, tomorrow - 20, the day after tomorrow - 300. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's see what kind of code is on the sites: <br><pre><code class="javascript hljs">$(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//     $('#button').click(function (event) { alert(this.innerHTML); }); $('#list').uberScrollerPluginStart({ "theme": "red" }); $('#lazy_thing').click(function () { $.get('/lazy/thing/body.html', doLazyLoad.bind(this)); }); /*       */ });</span></span></code> </pre> <br>  More often it is jQeury, we hang events, connect plugins, execute ajax requests.  If any plugin is removed, then everything will break.  We get a kind of tangle of code in which frameworks, plugins, our code are mixed.  Such a tangle is not very large (lines 100) and, as a rule, is created and maintained by one person.  Most sites are created 1 time and not supported at all, so for them something more can be harmful and can increase the cost of the entire site. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/07e/c0c/e23/07ec0ce23dd447be81a32c5600c381c0.jpg"><br><br>  If we apply this architecture to GMail, Yandex.Mail, the Yahoo! Twitter portal, we will get a huge tangle of code (10,000+ lines) that creates several people.  A huge tangle is very difficult to unravel, and even more confusing to mess up, so as not to break anything.  Web applications are constantly evolving, so this tangle has to constantly unravel and confuse. <br>  The site code is not structured, and its architecture is strongly connected.  For web applications, this architecture cannot be used. <br><br><h4>  Architecture </h4><br>  Consider one of several architectures that allows you to easily create scalable applications.  The architecture is taken from NC Zakas, I like it very much (it will be great if you watched his presentation and remember what it is about), I will change it a bit in the course, and you will see the end result in the examples. <br><br><h5>  Framework </h5><br>  In any application, as a rule, the framework enters.  All client frameworks be jQuery, Mootools, YUI, dojo - this is just a toolbox.  Tools help you hammer in nails, saw boards.  Some tools are very necessary, there are and which are gathering dust.  If the basic tools are few, then heavier ones are connected, for example, Backbone.js + Underscore.js <br>  In life, replacing the jQuery box with Mootools is easy.  Think that you will be abandoned by jQuery or your favorite library now?  In order for the replacement to be easy, you need to add a wrapper over the library functions - it can be the Application Core. <br><br><h5>  Core </h5><br>  In addition to wrapping libraries, the kernel also has other functions: it manages the life of parts of the system, provides a communication interface, controls the errors of the entire application. <br><br><h5>  Modules </h5><br>  An application consists of modules ‚Äî these are independent parts of the application that are managed by the Core, but have no direct connection with the Core itself.  A heavy javascript application is just as complex as a space station.  The ISS has an extensible architecture in it dozens of modules, each fulfilling its own role.  Station modules were made in different countries, delivered at different times and there are a lot of them, but they all work as a single unit. <br><br>  Web application modules consist of HTML + CSS + JavaScript + Resources <br><br>  Module resources - localization, handles and other private data of the module. <br><br>  Each module must live separately from the entire application.  The task of each module is to perform a narrowly targeted function.  The modules should be separate and the less the module knows about other modules, the easier it will be to support the entire application.  When you create a new code and add dependencies, think about what you need to throw it tomorrow. <br><br>  To ensure weak connectivity and to restrict the freedom of a module, it is necessary to enclose it with a special medium object ‚Äî a sandbox.  Each module must be inside its sandbox and communicate only with it.  This is the only object that the module knows about.  The role of the sandbox is simple.  She acts as a security guard - she knows what the module can do, knows with whom the module can communicate.  Sandbox provides communication module with the kernel. <br><br>  A module can call its methods and sandboxes, use its HTML element.  The module must ask permission before performing any action.  The module is forbidden to create globals, use non-standard globals, communicate with other modules directly. <br><br><h5>  Submodules </h5><br>  Each module acts as a micro-application, which can have its own rules, the rules should not contradict the global one.  Each module can delegate its sandbox to its parts, connect other modules (during project assembly). <br><br>  It is not important for the kernel how the module will manage its parts - it is important for it that the global rules for each module are respected. <br><br><h4>  Subordination </h4><br>  To reduce the number of connections within the system, we need hard subordination. <br><br>  - Only the library knows about the browser and the existing API <br>  - Only the core knows about the library <br>  - Only the sandbox knows about the core <br>  - Each module knows only about its sandbox <br><br>  None of the objects should be aware of the entire application. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6da/430/ad2/6da430ad22e041148152ab9ef0fe7512.png"><br><br>  Our application must be constantly changing.  Users want a new functional - we add it.  Browsers get a new feature - we fasten it. <br><br>  Therefore, each object must change <br>  - The library is expanded by plugins - The browser gets a new API - add a plugin <br>  - The kernel is updated due to extensions - Replaced the protocol from XML to JSON, changed the format of the sent data, changed the AJAX transport - added the extension <br>  - The whole application is expanded with modules - Users want a new function - we add a module <br><br><h4>  Communication </h4><br>  Everyone knows that the HTML DOM is replete with events.  Events are everywhere - there are elements, there is an API (XHR, Workers).  DOM events allow the document object model to infinitely expand and create extensible applications.  I believe that events are the best base for web applications. <br><br>  Consider an example: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Module1 = { <span class="hljs-string"><span class="hljs-string">"someAction"</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ Module2.getSomeValue(); } }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Module2 = { <span class="hljs-string"><span class="hljs-string">"getSomeValue"</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'data'</span></span>; } };</code> </pre><br>  In a conventional pattern, modules communicate with each other directly.  Module 1 depends on module 2 and on its <code>getSomeValue()</code> method.  If we remove module 2, then everything will break. <br><br>  If the method call is replaced by an event, the modules will become independent (they will be loosely coupled). <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   var Module1 = { "init": function ($) { $.on('event', function (e) { // $ -  jQuery,   sandbox console.log(e.data); }); } }; var Module2 = { "someAction": function ($) { // $ -  jQuery $.trigger('event', 'data'); } };</span></span></code> </pre><br>  In module 1, we listen to the event event, module 2 causes an event event with some data and the event handler draws data to the console <br><br>  Yes, the architecture is changing a lot, but we get rid of strong connectivity. <br><br><h4>  Asynchronous functions </h4><br>  Events inevitably entail asynchrony, I think everyone knows that HTML DOM is replete with asynchronous methods.  XHR, JSONP, sending data from a frame to a frame, sending data to the worker and back.  Asynchronous programming is more complicated and its use is not always justified.  But in our case, asynchronous functions can be incredibly useful. <br><br>  Let's see an example: <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   var Storage = { "read": function (key) { return localStorage[key]; } }; var data = Storage.read('key'), pData = process(data); $.trigger('data', pData);</span></span></code> </pre><br>  Suppose we store some user data in <code>localStorage</code> , work with it synchronously and everything is fine.  Well, as long as we did not want to keep the same data on the server, the probability that we decide to change something is very high.  Translation of synchronous code to asynchronous can be a big problem, even with an event model. <br><br>  Rewrite our code with replacing localStorage: <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   var Storage = { "read": function (key, cb) { $.get('/read/' + key, cb); } }; Storage.read('key',function(data) { var pData = processData(data); $.trigger('data', pData); }.bind(this));</span></span></code> </pre><br>  We had a simple data retrieval function and 10 lines of source code.  We added 1 line and changed 4 lines.  Received almost 50% of changes (and that I considered brackets).  If it were not for our events, then we had to change the code that uses Storage.  Using the asynchronous approach in the functions of receiving and storing data, we save ourselves from some of the problems in the future. <br><br>  As a rule, all asynchronous methods are associated with sending and receiving data (XHR, Location API, File API), so all the functions of storing and receiving data are best made asynchronous or connect events. <br><br><h5>  Advantages of such an architecture </h5><ul><li>  Based on the resulting framework, a set of modules and plug-ins, we can create several applications </li><li>  We can test each module, each plugin separately.  This is incredibly beneficial compared to testing the entire application. </li><li>  We can flexibly scale our application ‚Äî change, add modules without fear that some important part of the application will change. </li><li>  Events reduce application connectivity. </li><li>  Asynchronous data functions enable you to prepare for global changes in the future. </li></ul><br>  These are excerpts from the <a href="http://video.yandex.ru/users/ya-events/view/291/%3Fcauthor%3Dya-events%26cid%3D33%26ncrnd%3D725647">report from J.Subbotnik</a> .  At a volunteer I promised to illustrate the theory with practice.  In theory, everything is beautiful, but theory without practice is of little value, so let's create an application based on our architecture. <br><br><h4>  Example: Scalable JavaScript application that is easy to maintain. </h4><br>  We will create an application, more precisely, an application stub (the article turns out to be very large, therefore I will shorten this part), demonstrating modularity.  The application includes: <ul><li>  Core, </li><li>  Sandbox, </li><li>  Modules: a module that displays text;  a module that generates events on a timer;  the module that filters this event;  module that logs some events in the console. </li></ul>  Part of the examples associated with the assembly of the project, the automatic generation of unit tests and unit testing, I will show on my fingers so as not to overload the article. <br><br><h5>  Libraries and Technologies </h5><br>  As usual, there will be jQuery.  To systematize the layout we will use the simplified BEM technology: Block, Element, Modifier.  For dynamic script loading we will use $ script.js.  Templates - Modified template engine from Rezig. <br><br><h5>  Project structure </h5><br><pre> <code class="hljs delphi"> /app /css -        /blocks /b-module-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span> /b-module-<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>.css ... ... /pages /<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.css ... /descriptors -   /ModuleName.json ... /locales -   /ModuleName.json ... /modules -   /ModuleName.js ... /templates -   /ModuleName.html ... /views -   /ModuleName.html ... /build -    /lib -   /Core.js /test -  /lib /qunit.css /qunit.js /ModuleName -   ModuleName /<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.html /<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.js /TestData.js -     /vendors -   /Script.js /jQuery.js ... /<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.html -   /<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.js -  js ,    /<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.json -   ...</code> </pre><br><h5>  Modules </h5><br>  Let's start first with the modules.  Each part of the module must be connected dynamically and statically (when assembled into a single file), or both.  Everything should be as transparent as possible for the developer: there is a module ‚Äî we use, no ‚Äî we load and use. <br><br>  <b>Our modules will consist of several parts:</b> <ol><li>  Layout sample: HTML file with connected styles.  This file will be used in the unit test, it shows how the module looks like. Samples can be taken from it to create a template. </li><li>  Template: The HTML blocks that the module uses. </li><li>  Styles and images: simple CSS file or files, images </li><li>  JavaScript: module code </li><li>  Descriptor: JSON file containing the name of the module, its settings and a list of those events that can listen and generate.  It is used to automatically generate a Unit Test, it is used by the sandbox to differentiate rights. </li><li>  Localization: JSON file containing texts in different languages </li></ol>  Each module has an adequate name, each part of the module is located in a separate directory and has the same name as the module.  We have maximally separated all the logical parts of the module (Markup / Template, View, Logic, Description and Configuration, Texts).  Each module exports only 2 methods: init and destroy: <br><br><h6>  Module Example (DataGenerator Module) </h6><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">global</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-string"><span class="hljs-string">"use strict"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> intervalId; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> DataGenerator = { <span class="hljs-attr"><span class="hljs-attr">init</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sandbox</span></span></span><span class="hljs-function">) </span></span>{ intervalId = setInterval(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ sandbox.trigger(<span class="hljs-string"><span class="hljs-string">'newData'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random()); }, sandbox.getResource(<span class="hljs-string"><span class="hljs-string">'interval'</span></span>)); }, <span class="hljs-attr"><span class="hljs-attr">destroy</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ clearInterval(intervalId); } }; <span class="hljs-comment"><span class="hljs-comment">//  if (!global) { return DataGenerator; } if (!global.exports) { global.exports = {}; } global.exports.DataGenerator = DataGenerator; }(this)) // ;  !</span></span></code> </pre><br>  I agree that a lot of garbage in the code.  We have exactly this format because of the requirements for the module: The kernel authoritatively connects the modules by itself, can be connected both statically and dynamically.  There are no modules in JavaScript as such, so everyone creates their own look.  There are some " <a href="http://wiki.commonjs.org/wiki/CommonJS">standard</a> ", but more often - this is a bike for specific tasks. <br><br><h6>  Descriptor Example (DataGenerator Module) </h6><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"DataGenerator"</span></span>, <span class="hljs-string"><span class="hljs-string">"acl"</span></span>: { <span class="hljs-string"><span class="hljs-string">"trigger:newData"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-comment"><span class="hljs-comment">//     newData }, "resources": { "interval": 1000 } }</span></span></code> </pre><br><h6>  Locale example (MessageView module) </h6><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"text_label"</span></span>: { <span class="hljs-string"><span class="hljs-string">"ru"</span></span>: <span class="hljs-string"><span class="hljs-string">" : "</span></span>, <span class="hljs-string"><span class="hljs-string">"en"</span></span>: <span class="hljs-string"><span class="hljs-string">"He said: "</span></span> } }</code> </pre><br><h6>  Template example (MessageView module) </h6><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-message-view"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-message-view__label"</span></span></span><span class="hljs-tag">&gt;</span></span>{%=label%}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-message-view__value"</span></span></span><span class="hljs-tag">&gt;</span></span>{%=value%}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  <b>Advantages of this format</b> <br>  Each logical part is separated.  We can use each part repeatedly.  For example, we can use the descriptor for automatic generation of skeleton unit tests. <br><br><h5>  Core </h5><br>  We need to load and register modules.  We need to be able to do it both at assembly and dynamically.  jQuery Deffered will help us a lot in this.  Since the process of loading one part of the module is practically no different from the other, and we have a lot of parts, we need to allocate a factory for the production of load functions: <br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> loaderFactory = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cacheObject, method, format, methodOwner, type</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dfd = $.Deferred(), self = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cacheObject[name]) { dfd.resolve(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dfd.promise(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">successOrFail</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">object</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> camelCasedType = type.slice(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>).toUpperCase() + type.slice(<span class="hljs-number"><span class="hljs-number">1</span></span>); self[<span class="hljs-string"><span class="hljs-string">'push'</span></span> + camelCasedType](name, object); dfd.resolve(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (object) { <span class="hljs-comment"><span class="hljs-comment">// if fail EventManager.trigger(type + ':loaded', {name: name}); EventManager.trigger(type + ':' + name + ':loaded'); } } var path = Core.descriptor.path[type] + format.replace('$0', name); if (type === 'module') { method.call(methodOwner, path, successOrFail); } else if (type === 'template') { method.call(methodOwner, path, successOrFail, 'html').error(successOrFail); } else { method.call(methodOwner, path, successOrFail).error(successOrFail); } return dfd.promise(); } };</span></span></code> </pre><br><br><h6>  ModuleManager </h6><br>  The module manager simply loads parts of the modules and caches them.  It has a number of methods for registering a module without loading (static build). <br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ModuleManager = { <span class="hljs-attr"><span class="hljs-attr">modules</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">descriptors</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">locales</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">templates</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">pushModule</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name, module</span></span></span><span class="hljs-function">) </span></span>{}, <span class="hljs-attr"><span class="hljs-attr">pushDescriptor</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name, descriptor</span></span></span><span class="hljs-function">) </span></span>{}, <span class="hljs-attr"><span class="hljs-attr">pushLocale</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name, locale</span></span></span><span class="hljs-function">) </span></span>{}, <span class="hljs-attr"><span class="hljs-attr">pushTemplate</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name, template</span></span></span><span class="hljs-function">) </span></span>{}, <span class="hljs-attr"><span class="hljs-attr">load</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">) </span></span>{} }; ModuleManager.getModule = loaderFactory(ModuleManager.modules, <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>, <span class="hljs-string"><span class="hljs-string">'$0.js'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">'module'</span></span>); ModuleManager.getDescriptor = loaderFactory(ModuleManager.descriptors, $.getJSON, <span class="hljs-string"><span class="hljs-string">'$0.json'</span></span>, $, <span class="hljs-string"><span class="hljs-string">'descriptor'</span></span>); ModuleManager.getLocale = loaderFactory(ModuleManager.locales, $.getJSON, <span class="hljs-string"><span class="hljs-string">'$0.json'</span></span>, $, <span class="hljs-string"><span class="hljs-string">'locale'</span></span>); ModuleManager.getTemplate = loaderFactory(ModuleManager.templates, $.get, <span class="hljs-string"><span class="hljs-string">'$0.html'</span></span>, $, <span class="hljs-string"><span class="hljs-string">'template'</span></span>);</code> </pre><br>  <i>I left the skeleton of the object to a lot of space did not take.</i>  <i>In any case, no one reads.</i>  <i>Full version in source code.</i> <br><br><h6>  Template engine </h6><br>  We will use a simple template from John Resig <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> templateFactory = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">str, data</span></span></span><span class="hljs-function">) </span></span>{}</code> </pre><br><h6>  Eventmanager </h6><br>  The event manager registers events, deletes, triggers.  All global events in the app go through it.  We will not reinvent the wheel.  EventManager will use <code>jQuery.bind jQuery.trigger jQuery.unbind</code> besides the standard methods it will have an interesting method - <code>hook</code> , which hooks the hook function to the event.  The hook function can change the contents of the event parameters, it can also prevent the event from being triggered. <br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> EventManager = { <span class="hljs-attr"><span class="hljs-attr">$</span></span>: $(<span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span>), <span class="hljs-attr"><span class="hljs-attr">hooks</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">trigger</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event, data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.hooks[event]) { <span class="hljs-comment"><span class="hljs-comment">// Update event data var result = this.hooks[event](data); // Don't trigger event if (result === false) { return this; } // Trigger with new data data = result || data; } this.$.trigger.apply(this.$, [event, data]); return this; }, bind: function () {}, unbind: function () {}, hook: function (event, hookFunction) { // One hook for example this.hooks[event] = hookFunction; return this; }, unhook: function (event) { delete this.hooks[event]; return this; } };</span></span></code> </pre><br>  Using the global event manager has one important plus: We can record the event log, and then reconstruct the course of events from the log (convenient for catching bugs on the user's side). <br><br><h6>  Core </h6><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Core = { <span class="hljs-attr"><span class="hljs-attr">descriptor</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">runningModules</span></span>: {}, <span class="hljs-comment"><span class="hljs-comment">//  ,   init: function (descriptorOrFileName, callback) {}, //    _initModules: function (callback) {}, //      initModule: function (name, callback) {}, //   destroyModule: function (name) {}, //  HTMLElement    getBox: function (name) {}, //      getTemplateFunction: function (moduleName, templateSelector) {} };</span></span></code> </pre><br>  Removed function body and JSDoc blocks. <br><br>  From the outside, we need only some methods from all of our kernel modules.  We will export only them: <br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> CorePublic = { <span class="hljs-attr"><span class="hljs-attr">trigger</span></span>: $.proxy(EventManager.trigger, EventManager), <span class="hljs-attr"><span class="hljs-attr">bind</span></span>: $.proxy(EventManager.bind, EventManager), <span class="hljs-attr"><span class="hljs-attr">unbind</span></span>: $.proxy(EventManager.trigger, EventManager), <span class="hljs-attr"><span class="hljs-attr">on</span></span>: $.proxy(EventManager.bind, EventManager), <span class="hljs-attr"><span class="hljs-attr">getModule</span></span>: $.proxy(ModuleManager.getModule, ModuleManager), <span class="hljs-attr"><span class="hljs-attr">getDescriptor</span></span>: $.proxy(ModuleManager.getDescriptor, ModuleManager), <span class="hljs-attr"><span class="hljs-attr">getLocale</span></span>: $.proxy(ModuleManager.getLocale, ModuleManager), <span class="hljs-attr"><span class="hljs-attr">getTemplate</span></span>: $.proxy(ModuleManager.getTemplate, ModuleManager), <span class="hljs-attr"><span class="hljs-attr">pushModule</span></span>: $.proxy(ModuleManager.pushModule, ModuleManager), <span class="hljs-attr"><span class="hljs-attr">pushDescriptor</span></span>: $.proxy(ModuleManager.pushDescriptor, ModuleManager), <span class="hljs-attr"><span class="hljs-attr">pushLocale</span></span>: $.proxy(ModuleManager.pushLocale, ModuleManager), <span class="hljs-attr"><span class="hljs-attr">pushTemplate</span></span>: $.proxy(ModuleManager.pushTemplate, ModuleManager), <span class="hljs-attr"><span class="hljs-attr">init</span></span>: $.proxy(Core.init, Core), <span class="hljs-attr"><span class="hljs-attr">destroyModule</span></span>: $.proxy(Core.destroyModule, Core), <span class="hljs-attr"><span class="hljs-attr">initModule</span></span>: $.proxy(Core.initModule, Core), <span class="hljs-attr"><span class="hljs-attr">getTemplateFunction</span></span>: $.proxy(Core.getTemplateFunction, Core) };</code> </pre><br><h5>  Sandbox </h5><br>  Each module has its own sandbox, so we will create a Sandbox constructor that generates sandboxes.  The sandbox receives a module handle as an argument.  All methods sandbox can use the module. <br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Sandbox = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">descriptor</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.descriptor = descriptor || {}; }; Sandbox.prototype.getBox = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{}; <span class="hljs-comment"><span class="hljs-comment">//      -  Sandbox.prototype.is = function (role) {}; Sandbox.prototype.bind = function (event, callback) {}; Sandbox.prototype.unbind = function (event, callback) {}; Sandbox.prototype.trigger = function (event, data) {}; Sandbox.prototype.hook = function (event, hookFunction) {}; Sandbox.prototype.unhook = function (event) {}; Sandbox.prototype.getText = function (message) {}; Sandbox.prototype.getResource = function (resource) {}; Sandbox.prototype.getTemplate = function (templateSelector) {};</span></span></code> </pre><br><br>  In those functions ( <code>bind, trigger, hook,</code> ...) that can affect other objects, the sandbox checks whether this function can be performed on this module (using the module descriptor). <br><br><h5>  Kernel build </h5><br>  Each part of the kernel should be placed in a separate file and put together by the preprocessor, in the example I do not use the preprocessor (it is spherical in a vacuum), so I threw it all together. <br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">global, $, require, undefined</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-string"><span class="hljs-string">"use strict"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> templateFactory = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">str, data</span></span></span><span class="hljs-function">)</span></span>{}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> loaderFactory = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cacheObject, method, format, self, type</span></span></span><span class="hljs-function">) </span></span>{}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ModuleManager = {}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Sandbox = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">descriptor</span></span></span><span class="hljs-function">) </span></span>{}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> EventManager = {}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Core = {}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> CorePublic = {}; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!global) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> CorePublic; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!global.exports) { global.exports = {}; } global.exports.Core = CorePublic; }(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, jQuery, $script));</code> </pre><br><h5>  Application descriptor </h5><br>  The application also has a descriptor that describes which modules are included in the application, where the parts of the modules are located, determines the current locale, describes the basic markup.  There can be several descriptors for different assemblies. <br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"modules"</span></span>: [<span class="hljs-string"><span class="hljs-string">"MessageView"</span></span>, <span class="hljs-string"><span class="hljs-string">"DataGenerator"</span></span>, <span class="hljs-string"><span class="hljs-string">"Logger"</span></span>, <span class="hljs-string"><span class="hljs-string">"Hook"</span></span>], <span class="hljs-string"><span class="hljs-string">"layout"</span></span>: { <span class="hljs-string"><span class="hljs-string">"MessageView"</span></span>: <span class="hljs-string"><span class="hljs-string">".b-message-view"</span></span> }, <span class="hljs-string"><span class="hljs-string">"locale"</span></span>: <span class="hljs-string"><span class="hljs-string">"ru"</span></span>, <span class="hljs-string"><span class="hljs-string">"path"</span></span>: { <span class="hljs-string"><span class="hljs-string">"descriptor"</span></span>: <span class="hljs-string"><span class="hljs-string">"./app/descriptors/"</span></span>, <span class="hljs-string"><span class="hljs-string">"module"</span></span>: <span class="hljs-string"><span class="hljs-string">"./app/modules/"</span></span>, <span class="hljs-string"><span class="hljs-string">"locale"</span></span>: <span class="hljs-string"><span class="hljs-string">"./app/locales/"</span></span>, <span class="hljs-string"><span class="hljs-string">"template"</span></span>: <span class="hljs-string"><span class="hljs-string">"./app/templates/"</span></span> } }</code> </pre><br><h5>  Application: index.js </h5><br>  As you understood from the application descriptor, we will have 4 modules.  The application turned out to be the simplest without any interaction with the server.  I do not attach the code for the modules in the article - it is in the repository. <br><br>  MessageView - displays a message on the event newData <br>  DataGenerator - generates a newData event once per second with data from <code>Math.random()</code> <br>  Logger - listens for the newData event and writes what came to the console <br>  Hook - puts a hook on the newData event.     ,    .     0.5,     100. <br><br><h4>  Assembly </h4><br>    (dev, test, prod)    (  ).     ,     .          ,     ,     ( ).       .   .        <code>index.json</code> . <br><br><h5>  index.js </h5><br>   index.js       ,   : require, buildFrom.      ,        (    JavaScript    CSS). index.js    ,      . <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/*$require: ./lib/Core.js */</span></span> (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Core</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-string"><span class="hljs-string">"use strict"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*$buildFrom ./index.json */</span></span> Core.on(<span class="hljs-string"><span class="hljs-string">'ready'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ Core.trigger(<span class="hljs-string"><span class="hljs-string">'newData'</span></span>, <span class="hljs-string"><span class="hljs-string">'Pewpew'</span></span>); }); Core.init(<span class="hljs-comment"><span class="hljs-comment">/*$require*/</span></span><span class="hljs-string"><span class="hljs-string">'./index.json'</span></span><span class="hljs-comment"><span class="hljs-comment">/*$*/</span></span>); }(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.exports.Core))</code> </pre><br>      -  : <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   Core.js (function (Core) { "use strict"; // + descriptors/Logger.json Core.pushDescriptor("Logger", { "name": "Logger", "acl": { "listen:newData": true, "listen:ready": true } }); // - descriptors/Logger.json // + modules/Logger.js Core.pushModule("Logger", (function(global){ // ... }(this))); // - modules/Logger.js // + locales/Logger.js Core.pushLocale("Logger", {}); // - locales/Logger.js // ...  -  .... Core.on('ready', function () { Core.trigger('newData', 'Pewpew'); }); Core.init({ "modules": ["MessageView", "DataGenerator", "Logger", "Hook"], "layout": { "MessageView": ".b-message-view" }, "locale": "ru", "path": { "descriptor": "./app/descriptors/", "module": "./app/modules/", "locale": "./app/locales/", "template": "./app/templates/" } }); }(this.exports.Core))</span></span></code> </pre><br><br> C <code>require</code>  ,   <code>buildFrom</code>  .         .       <code>Logger</code> (  - ).  <code>buildFrom</code>         (    <code>"en": "He said: "</code> ),     . <br>   dev     ‚Äî    . <br><br><h5>  index.css </h5><br>       :    1 ,         : <br><pre> <code class="css hljs"><span class="hljs-comment"><span class="hljs-comment">/*$buildFrom: ../../index.json */</span></span> <span class="hljs-comment"><span class="hljs-comment">/* app/css/blocks/b-message-view/b-message-view.css */</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.b-message-view</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">color</span></span>: green; <span class="hljs-attribute"><span class="hljs-attribute">font-family</span></span>: monospace; }</code> </pre><br>  <code>buildFrom</code>   <code>css</code> :       layout    ,       <code>b-message-view</code> ‚Äî  .     ,        ,     . ,    json     . <br><br><h5>  index.html </h5><br>    <code>index.css</code>  <code>index.js</code> .        <code>index.html</code> <br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE HTML&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"content-type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html; charset=utf-8"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--$require: index.css--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"app/css/pages/index.css"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--$--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--$buildFrom: index.json--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-message-view"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--$--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://yandex.st/jquery/1.6.1/jquery.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--$require: index.js--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./vendors/Script.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./lib/Core.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./index.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--$--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  <code>buildFrom</code>   html  (  css):       layout       div    <code>b-message-view</code> .   ,     .     xslt,   . <br><br>    : <br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE HTML&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"content-type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html; charset=utf-8"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/index.css"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"b-message-view"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://yandex.st/jquery/1.6.1/jquery.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/index.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Makefile - General build </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> What the collector does: </font></font><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Runs the preprocessor to build index.css </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Optimizes index.css: data / uri, etc. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Shrinks index.css (gz optional) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Assembles index.css resources: images </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Run automated unit tests (below) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Runs the preprocessor to build index.js </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Validates index.js </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Shrinks index.js (gz optional) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Build a package under your OS .deb .rpm </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Puts a package into the repository. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Installs a package </font></font></li></ol><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Unit tests </font></font></h4><br>    .  ,      ,     ,  ,         ,   . <br><br>       ,      -.  (    )     ,  acl   ,     ,     .   . <br><br>  ,      ,        : <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> TestData = { <span class="hljs-string"><span class="hljs-string">"newData"</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> data = [<span class="hljs-literal"><span class="hljs-literal">NaN</span></span>, <span class="hljs-literal"><span class="hljs-literal">Infinity</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>, <span class="hljs-string"><span class="hljs-string">'pewpewpew'</span></span>, <span class="hljs-string"><span class="hljs-string">'&lt;b&gt;Pewpew&lt;/b&gt;'</span></span>, <span class="hljs-string"><span class="hljs-string">'"'</span></span>, <span class="hljs-string"><span class="hljs-string">'\''</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>, <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data; } };</code> </pre><br>      QUnit.    MessageView.  -  ()     MessageView,        ‚Äî  ,     .   ,    . <br><br><h5>  : index.js </h5><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// MessageView test (function (Core, $, TestData, ok, test, module, equals, expect, asyncTest, start, stop) { "use strict"; //    var ApplicationEnvironment = { "modules": ["MessageView"], "layout": { "MessageView": ".b-message-view" }, "locale": "ru", "path": { "descriptor": "../../app/descriptors/", "module": "../../app/modules/", "locale": "../../app/locales/", "template": "../../app/templates/" } }; Core.on('ready', function () { module("MessageView"); //  1 test("listen:newData", function() { var testItems = TestData["newData"](), $MessageView = Core.getBox("MessageView"), template = Core.getTemplateFunction("MessageView", '.b-message-view'), label = Core.getText("MessageView", "text_label"); expect(testItems.length); // &gt;&gt;&gt; put your code $.each(testItems, function (index, text) { Core.trigger("newData", [text]); // &gt;&gt;&gt; put your code var expected = template({label: label, value: text}); // &lt;&lt;&lt; equals(expected, $MessageView.html(), 'Should be "text_label: value"'); // &lt;&lt;&lt; }); }); //  2 test("trigger:newData:display", function() { var testItems = TestData["newData"](), $MessageView = Core.getBox("MessageView"), template = Core.getTemplateFunction("MessageView", '.b-message-view'); expect(testItems.length); // &gt;&gt;&gt; put your code Core.on("newData:display", function () { // &lt;&lt;&lt; ok(true); // &lt;&lt;&lt; }); // &lt;&lt;&lt; $.each(testItems, function (index, item) { Core.trigger("newData", [item]); // &gt;&gt;&gt; put your code }); }); }); Core.init(ApplicationEnvironment); }(this.exports.Core, jQuery, TestData, ok, test, module, equals, expect, asyncTest, start, stop))</span></span></code> </pre><br>          5     " <code>&lt;&lt;&lt;</code> ". <br><br>   index.html  ‚Äî  . <br><br><h4>       </h4><br>      ,        60 (        ,     ).       ,        (    ).   ,      (    ,   ): <br> ‚Äî <a href="http://code.google.com/p/js-test-driver/">js-test-driver</a> ‚Äî   QUnit,     . <br> ‚Äî <a href="http://swarm.jquery.org/">TestSwarm</a> ( <a href="https://github.com/jquery/testswarm/wiki"></a> ) ‚Äî     Mozilla Labs <br> ‚Äî <a href="http://siliconforks.com/jscoverage/">JSCoverage</a> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Do tests so that they really work and perform their tasks. </font><font style="vertical-align: inherit;">Do not do "what would have happened" tests. </font><font style="vertical-align: inherit;">If you do not want to introduce automation and code coverage, it is better to think about the need for unit tests.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Code Validation and Documentation Assembly </font></font></h4><br>     ,   .    ,         ,  Dox, jsdoc-toolkit  .. . <a href="http://habrahabr.ru/blogs/javascript/111861/"> </a> <br>              .        (     ),      ‚Äî     ,               .        (  )   . <br><br><h4>   </h4><br>      .      -. <br><ol><li>      ‚Äî        </li><li>     (   ). JSLint, JSHint  ! </li><li>             . </li><li>      ,        ,    !     <code>$textarea.val($textarea.val())</code> </li><li> :   .    ‚Äî !  ‚Äî .  ‚Äî    .   : foo, temp.  ,       (    tmp), ,     ‚Äî    ! </li><li>  JavaScript, HTML  CSS  (   ). HTML ‚Äî , . CSS ‚Äî  . JavaScript ‚Äî  . </li><li>      .  Element.style.  ,  html ( FTW!).  CSS Expressions! </li><li>   . 2-3     ! </li><li>    ,      .     ‚Äî   ! (Array.prototype, Function.prototype) </li><li>     </li><li>     ,        ‚Äî ,  ! </li><li>     instanceof, typeof, Object.prototype.toString magic </li><li>    ! URL ; ; ,  ,  </li><li>   :     (js-test-driver),  (JSLint, JSHint),     (JSDocToolkit, Dox).     ,       Ctrl+S.   : ,  . </li></ol><h4>     </h4><br>    GitHub <a href="https://github.com/azproduction/scalable-js-app">scalable-js-app</a> (  , ) <br><br>    :  ,   -,   ( MessageView),   . <br><br><h4> / </h4><ol><li> Andrew Dupont (Gowalla, Prototype.js, S2) ‚Äî <a href="http://channel9.msdn.com/Events/MIX/MIX11/EXT23">Maintainable JavaScript</a> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nicholas Zakas (Yahoo !, YUI, YUI Test) - </font></font><a href="http://www.yuiblog.com/blog/2007/05/25/video-zakas/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Writing Maintainable JavaScript</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Slides are </font></font><a href="http://www.slideshare.net/nzakas/maintainable-javascript-2011"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">new</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="http://www.slideshare.net/nzakas/maintainable-javascript-1071179"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">old</font></font></a> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nicholas Zakas - </font></font><a href="http://developer.yahoo.com/yui/theater/video.php%3Fv%3Dzakas-architecture"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scalable JavaScript Application Architecture</font></font></a> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">My video " </font></font><a href="http://video.yandex.ru/users/ya-events/view/291/%3Fcauthor%3Dya-events%26cid%3D33%26ncrnd%3D725647"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scalable JavaScript applications</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " from J.Subbotnik </font></font><a href="http://download.yandex.ru/company/experience/subbotnik/Davydov_Ekb.pdf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">slides</font></font></a> </li></ol> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> And so, you decided to rewrite the whole code, clean the code with JSHint / JSLint. </font><font style="vertical-align: inherit;">Stop! </font><font style="vertical-align: inherit;">It will take you a lot of time to rework, even more to test and rework reworked because </font><font style="vertical-align: inherit;">surely at least something will break (if you do not have Unit Tests, then this will surely happen). </font><font style="vertical-align: inherit;">Create a new code according to the new standard, and modify the old one if necessary, then when you change its part.</font></font><br><br>  I hope it was interesting. , ,  !              .      ‚Äî    . </div><p>Source: <a href="https://habr.com/ru/post/123635/">https://habr.com/ru/post/123635/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../123628/index.html">Why do we listen but not hear?</a></li>
<li><a href="../123630/index.html">Elephants love mangoes, part 1/2: backstage look at Evernote for Windows Phone 7</a></li>
<li><a href="../123631/index.html">Accepting applications for two-character .SU open</a></li>
<li><a href="../123632/index.html">Isosurface rendering using reykasting algorithm</a></li>
<li><a href="../123633/index.html">TeamLab: 2 sevens + 1 year = 30 thousand portals</a></li>
<li><a href="../123636/index.html">Basics of SQL on the example of the task</a></li>
<li><a href="../123637/index.html">Google Reader Google Plus Design</a></li>
<li><a href="../123641/index.html">Low-cost controlled tv do it yourself</a></li>
<li><a href="../123642/index.html">In-app purchase in Android applications</a></li>
<li><a href="../123644/index.html">Pinch gesture orientation determination</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>