<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Introducing Kohana 3.0 - Parts 7, 8, 9</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Meet the seventh, eighth and ninth parts of a series of articles on development with Kohana PHP V3 (KO3). Previous parts can be found under the tag " ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Introducing Kohana 3.0 - Parts 7, 8, 9</h1><div class="post__text post__text-html js-mediator-article">  Meet the seventh, eighth and ninth parts of a series of articles on development with Kohana PHP V3 (KO3).  Previous parts can be found under the tag " <a href="http://habrahabr.ru/tag/%25D0%25B7%25D0%25BD%25D0%25B0%25D0%25BA%25D0%25BE%25D0%25BC%25D1%2581%25D1%2582%25D0%25B2%25D0%25BE%2520%25D1%2581%2520kohana%25203.0/">familiarity with kohana 3.0</a> ".  In this 3-in-1 article, we will look at helpers (helpers), modules, and the use of third-party libraries. <br><a name="habracut"></a><br><h4>  Part 7: Helpers </h4><br>  The Kohana 2.0 documentation provides the following definition for them: <br><blockquote>  Helpers are handy features that are designed to help you with development. <br><br>  They are similar to library functions, but there is a slight difference.  In the case of libraries, it is necessary to create an instance of the library class in order to use its methods.  Helpers are static class methods that are automatically loaded by the framework, so there is no need to perform additional actions. </blockquote><br>  That is, in essence, these are static methods made to ‚Äúhelp‚Äù you with routine things, like working with arrays or URLs.  Kohana has a number of <a href="http://kohanaframework.org/guide/api">ready-made assistants</a> , but we will create our own.  Open the editor and get started. <br><br>  Create a new ‚Äúhelper‚Äù folder in ‚Äú/ application / classes‚Äù.  Open a new file and place the following there: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Helper_MyUrl</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SEOIt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($str)</span></span></span><span class="hljs-function"> </span></span>{ $str = preg_replace(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'/\s/'</span></span>, <span class="hljs-string"><span class="hljs-string">'/[$.+!*\'(),"]/'</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'-'</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>), $str); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $str; } }</code> </pre> <br>  Save it as ‚Äúmyurl.php‚Äù in the newly created directory ‚Äú/ application / classes / helper‚Äù.  Now open ‚Äú/application/views/pages/ko3.php‚Äù and add this line to the end: <br><br><pre> <code class="php hljs">&lt;br /&gt;<span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> Helper_MyUrl::SEOIt(<span class="hljs-string"><span class="hljs-string">'This Is a string!!!'</span></span>);<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  After saving, opening ‚Äúhttp: // localhost / mykohana3 / ko3 /‚Äù in the browser, you will see ‚ÄúThisIsastring‚Äù below.  Pretty simple! <br><br>  <i>Translator‚Äôs note: this is not an article break; it‚Äôs just that this part is really indecently short.</i>  <i>I can do nothing, sorry!</i> <br><br><h4>  Part 8: Modules </h4><br>  A module is a plugin that can expand the core of the framework, give your project a new section (blogs and forums, for example) or simply provide a set of classes that are available globally.  Let's start! <br><br>  Create a new directory called ‚Äúfortune‚Äù in the ‚Äúmodules‚Äù folder.  Inside the ‚Äúmodule / fortune‚Äù create the ‚Äúclasses‚Äù and ‚Äúviews‚Äù folders.  Then in ‚Äú/ module / fortune / classes‚Äù create a folder ‚Äúkohana‚Äù, and in ‚Äú/ module / fortune / views‚Äù create ‚Äúfortune‚Äù.  The directory tree should look something like this: <br><br><pre> <code class="hljs pgsql">modules +<span class="hljs-comment"><span class="hljs-comment">-- fortune |-- classes | +-- kohana +-- views +-- fortune</span></span></code> </pre> <br>  In the folder ‚Äú/ module / fortune / classes /‚Äù create the file ‚Äúfortune.php‚Äù and put the following into it: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> defined(<span class="hljs-string"><span class="hljs-string">'SYSPATH'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'No direct script access.'</span></span>); <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Fortune</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Kohana_Fortune</span></span></span></span>{}</code> </pre> <br>  Here we simply inherit the class that we will create further.  Open a new document and copy the code there: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> defined(<span class="hljs-string"><span class="hljs-string">'SYSPATH'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'No direct script access.'</span></span>); <span class="hljs-comment"><span class="hljs-comment">/** * Fortune Cookie Module */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Kohana_Fortune</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Merged configuration settings protected $config = array('view' =&gt; 'fortune/default'); protected $fortune = ""; /** * Creates a new Fortune object. * * @return Fortune */ public static function factory(array $config = array()) { return new Fortune($config); } public function __construct(array $config = array()) { // Overwrite system defaults with application defaults $this-&gt;config = $this-&gt;config_group() + $this-&gt;config; } /** * Retrieves a fortune config group from the config file. One config group can * refer to another as its parent, which will be recursively loaded. * * @param STRING fortune config group; "default" if none given * @return ARRAY config settings */ public function config_group($group = 'default') { // Load the fortune config file $config_file = Kohana::config('fortune'); // Initialize the $config array $config = array('group' =&gt; (string)$group); // Recursively load requested config groups while(isset($config['group']) &amp;&amp; isset($config_file-&gt;$config['group'])) { // Temporarily store config group name $group = $config['group']; unset($config['group']); // Add config group values, not overwriting existing keys $config += $config_file-&gt;$group; } // Get rid of possible stray config group names unset($config['group']); // Return the merged config group settings return $config; } /** * Randomly pick a fortune * * @return STRING fortune text */ public function getFortune() { // Stolen from: http://fortunes.cat-v.org/plan_9/ $fortunes = array('2 is always smaller than 3, even for large values of 2.', 'A penny saved is a political breakthrough.', 'Avoid reality at all costs.', 'Bad taste is timeless.'); $this-&gt;fortune = $fortunes[array_rand($fortunes, 1)]; } /** * Renders the fortune. * * @param MIXED string of the view to use, or a View object * @return STRING fortune output (HTML) */ public function render($view = NULL) { if($view === NULL) { // Use the view from config $view = $this-&gt;config['view']; } if(!$view instanceof View) { // Load the view file $view = View::factory($view); } $this-&gt;getFortune(); // Pass on the whole Fortune object return $view-&gt;set(get_object_vars($this))-&gt;set('page', $this)-&gt;render(); } /** * Renders the fortune. * * @return STRING fortune output (HTML) */ public function __toString() { return $this-&gt;render(); } }</span></span></code> </pre> <br>  Save it as ‚Äúfortune.php‚Äù in ‚Äú/ modules / fortune / classes / kohana‚Äù.  For the most part, the class looks like an uncomplicated part of the core of Kohana.  We have two protected types: ‚Äúconfig‚Äù and ‚Äúfortune‚Äù.  ‚ÄúConfig‚Äù is intended for the configuration itself, and in the ‚Äúfortune‚Äù there is one prediction of fate (we make an analogue of cookies with predictions), which will be displayed on the screen.  Next, we have a ‚Äúfactory‚Äù method for implementing the corresponding pattern and a constructor that produces some manipulations with the ‚Äúconfig‚Äù property. <br><br>  The heart of the class is the getFortune method.  I used to cheat here and instead of creating a model and retrieving data from the database, I simply used an array.  A random element is taken from it and written into the ‚Äúfortune‚Äù property. <br><br>  Next we have the ‚Äúrender ()‚Äù method.  It runs the ‚ÄúgetFortune ()‚Äù method and visualizes the view.  It, in turn, is called by the ‚Äú__toString ()‚Äù method. <br><br>  Create a new file with the following contents: <br><br><pre> <code class="php hljs">&lt;div style=<span class="hljs-string"><span class="hljs-string">"width: 250px; height: 52px; vertical-align: middle; display: table-cell; text-align: center; border: 1px solid #CCCCCC; border-right-color: #666666; border-bottom-color: #666666;"</span></span>&gt; &lt;p&gt;<span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $fortune;<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span>&lt;/p&gt; &lt;/div&gt;</code> </pre> <br>  Save it as ‚Äúdefault.php‚Äù in ‚Äú/modules/fortune/views/fortune/default.php‚Äù.  As you can see, I, through ‚Äúecho‚Äù, derive the $ fortune variable, which is a property of the protected type.  This is because in the ‚Äúrender‚Äù method we passed all the properties to the mind, it's easier. <br><br>  It remains to edit a couple of files.  Open ‚Äú/application/bootstrap.php‚Äù and find the section with the text ‚ÄúKohana :: modules‚Äù.  Replace it with this: <br><br><pre> <code class="php hljs">Kohana::modules(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-comment"><span class="hljs-comment">// 'auth' =&gt; MODPATH.'auth', // Basic authentication // 'codebench' =&gt; MODPATH.'codebench', // Benchmarking tool 'database' =&gt; MODPATH.'database', // Database access // 'image' =&gt; MODPATH.'image', // Image manipulation // 'orm' =&gt; MODPATH.'orm', // Object Relationship Mapping // 'pagination' =&gt; MODPATH.'pagination', // Paging of results // 'userguide' =&gt; MODPATH.'userguide', // User guide and API documentation 'fortune' =&gt; MODPATH.'fortune', ));</span></span></code> </pre> <br>  We added a module for predictions and included it in the framework.  Now open the file ‚Äú/application/views/pages/ko3.php‚Äù and add the line to the end: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> Fortune::factory();<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Opening the browser ‚Äúhttp: // localhost / mykohana3 / ko3 /‚Äù, you should see the prediction of fate below! <br><br><h4>  Part 9: Using Third-Party Libraries </h4><br>  First of all, you need to create the ‚Äúvendors‚Äù folder in the ‚Äúapplication‚Äù directory.  In the ‚Äúvendors‚Äù create a folder ‚ÄúZend‚Äù (yes, with the capital ‚ÄúZ‚Äù).  Next you need to <a href="http://www.zend.com/community/downloads">download the latest version of Zend Framework</a> (Minimal Package), at the time of publication it is 1.11.2.  Open the archive and extract all of the ‚ÄúZendFramework-1.11.2-minimal / library / Zend /‚Äù into ‚Äúapplication / vendors / Zend‚Äù. <br><br>  Open the file ‚Äúapplication / bootstrap.php‚Äù and add the following above the line ‚Äúecho Request :: getInstance ()‚Äù: <br><br><pre> <code class="php hljs">$path = Kohana::find_file(<span class="hljs-string"><span class="hljs-string">'vendors'</span></span>, <span class="hljs-string"><span class="hljs-string">'Zend/Loader'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($path) { ini_set(<span class="hljs-string"><span class="hljs-string">'include_path'</span></span>, ini_get(<span class="hljs-string"><span class="hljs-string">'include_path'</span></span>) . PATH_SEPARATOR . dirname(dirname($path))); <span class="hljs-keyword"><span class="hljs-keyword">require_once</span></span> <span class="hljs-string"><span class="hljs-string">'Zend/Loader/Autoloader.php'</span></span>; Zend_Loader_Autoloader::getInstance(); }</code> </pre> <br>  Open ‚Äúapplication / views / pages / ko3.php‚Äù and paste at the very bottom: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $validator = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Zend_Validate_Isbn();<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;br /&gt;<span class="hljs-number"><span class="hljs-number">978</span></span><span class="hljs-number"><span class="hljs-number">-3</span></span><span class="hljs-number"><span class="hljs-number">-16</span></span><span class="hljs-number"><span class="hljs-number">-148410</span></span><span class="hljs-number"><span class="hljs-number">-0</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> ($validator-&gt;isValid(<span class="hljs-string"><span class="hljs-string">'978-3-16-148410-0'</span></span>)) ? <span class="hljs-string"><span class="hljs-string">'is'</span></span> : <span class="hljs-string"><span class="hljs-string">'is not'</span></span>;<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> valid. &lt;br /&gt;<span class="hljs-number"><span class="hljs-number">9783161484100</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> ($validator-&gt;isValid(<span class="hljs-string"><span class="hljs-string">'9783161484100'</span></span>)) ? <span class="hljs-string"><span class="hljs-string">'is'</span></span> : <span class="hljs-string"><span class="hljs-string">'is not'</span></span>;<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> valid.</code> </pre> <br>  Now at the address ‚Äúhttp: // localhost / mykohana3 / ko3 ‚Ä≥ you should see the results of the two tests below. <br><br>  <i>Translator‚Äôs note: although the author of the cycle further promised to tell about forms, since June 2010 there have been no new articles.</i>  <i>So this is the end of dating with Kohana 3.0.</i> </div><p>Source: <a href="https://habr.com/ru/post/112338/">https://habr.com/ru/post/112338/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../112329/index.html">Setup of FreeBSD for work of the Internet through Proxy server</a></li>
<li><a href="../112331/index.html">Microsoft has closed access to the source code utilities Sysinternals</a></li>
<li><a href="../112332/index.html">Manage Python packages with easy_install</a></li>
<li><a href="../112334/index.html">Cartographic capabilities of Samsung Bada</a></li>
<li><a href="../112337/index.html">Discussion of the work of the Romanov algorithm on the example</a></li>
<li><a href="../112339/index.html">Products phantoms (Vaporware) for 11 years. Article Two - 2000-2001</a></li>
<li><a href="../112340/index.html">House.gov decided to transfer to Drupal</a></li>
<li><a href="../112341/index.html">Android source code, Java and copyright infringement: continued</a></li>
<li><a href="../112344/index.html">Divorce from the Chinese comrades</a></li>
<li><a href="../112346/index.html">Google Docs removed limit on file size</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>