<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>AVA - Futuristic JavaScript library for testing.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I want to introduce you to a new library for testing AVA . Relatively new, it is already more than 2 years old, and it has acquired a ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>AVA - Futuristic JavaScript library for testing.</h1><div class="post__text post__text-html js-mediator-article"><p>  In this article I want to introduce you to a new library for testing <a href="https://github.com/avajs/ava">AVA</a> .  Relatively new, it is already more than 2 years old, and it has acquired a solid number of plug-ins and of course the community that develops it.  We will look at the library functionality.  Set up the environment and write a couple of tests to look at the library in action. </p><a name="habracut"></a><br><h2 id="chto-zhe-predlagaet-ava">  What does AVA offer? </h2><br><p>  First of all, the library offers speed.  Tests are run in parallel, which accelerates the execution of tests.  As an example, the <a href="https://github.com/sindresorhus/pageres">Pageres</a> project is <a href="https://github.com/sindresorhus/pageres">given</a> in which <a href="https://github.com/sindresorhus/pageres/commit/663be15acb3dd2eb0f71b1956ef28c2cd3fdeed0">testing was postponed to AVA</a> , which gave an increase of almost 3 times (31 seconds were and 11 became).  Tests do not depend on the global state and on other tests, which of course simplifies testing.  Out of the box, es2015 is immediately used. </p><br><h3 id="chto-nuzhno-sdelat-chtoby-nachat-polzovatsya-ava-uzhe-seychas">  What you need to do to start using AVA now? </h3><br><p>  Install the appropriate npm module.  Set as a dependency to work in a specific folder. </p><br><pre><code class="hljs lua">// <span class="hljs-built_in"><span class="hljs-built_in">package</span></span>.json ..., <span class="hljs-string"><span class="hljs-string">"scripts"</span></span>: { <span class="hljs-string"><span class="hljs-string">"test"</span></span>: <span class="hljs-string"><span class="hljs-string">"ava"</span></span> }, ...</code> </pre> <br><pre> <code class="hljs sql">npm <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> -D ava npm <span class="hljs-keyword"><span class="hljs-keyword">test</span></span></code> </pre> <br><p>  or globally </p><br><pre> <code class="hljs matlab">npm <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> -g ava ava</code> </pre> <br><h2 id="zapusk-testov">  Running tests </h2><br><p>  It's time to write the first test, take an example from the official repository.  And save it as my-tests.js </p><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> test <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ava'</span></span>; test(<span class="hljs-string"><span class="hljs-string">'foo'</span></span>, t =&gt; { t.pass(); }); test(<span class="hljs-string"><span class="hljs-string">'bar'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> t =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> bar = <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.resolve(<span class="hljs-string"><span class="hljs-string">'bar'</span></span>); t.is(<span class="hljs-keyword"><span class="hljs-keyword">await</span></span> bar, <span class="hljs-string"><span class="hljs-string">'bar'</span></span>); });</code> </pre> <br><p>  Immediately we see the use of es2015 with arrow functions, let and async.  In my opinion, the minimalist syntax was not deceived. </p><br><p>  Run tests </p><br><pre> <code class="hljs perl">npm test <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>-tests.js // <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> ava <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>-tests.js</code> </pre> <br><p>  And we get the result </p><br><pre> <code class="hljs">2 passed</code> </pre> <br><p>  If we want to see more detailed information about each test, we can use the parameters for the module </p><br><pre> <code class="hljs perl">ava <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>-tests.js --verbose // <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> ava <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>-tests.js -v</code> </pre> <br><pre> <code class="hljs nginx"> <span class="hljs-attribute"><span class="hljs-attribute">foo</span></span> bar <span class="hljs-number"><span class="hljs-number">2</span></span> tests passed</code> </pre> <br><p>  We can also run watcher to develop TDD style. </p><br><pre> <code class="hljs perl">ava <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>-tests.js --watch // <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> ava <span class="hljs-keyword"><span class="hljs-keyword">my</span></span>-tests.js -w</code> </pre> <br><p>  You can see the full list of parameters </p><br><pre> <code class="hljs pgsql">ava <span class="hljs-comment"><span class="hljs-comment">--help</span></span></code> </pre> <br><h2 id="api-biblioteki">  Library API </h2><br><p>  Simple test: </p><br><pre> <code class="hljs lisp">test('description', <span class="hljs-literal"><span class="hljs-literal">t</span></span> =&gt; { })<span class="hljs-comment"><span class="hljs-comment">;</span></span></code> </pre> <br><p>  One of the most common situations when you need to perform only one test of all: </p><br><pre> <code class="hljs pgsql">test.<span class="hljs-keyword"><span class="hljs-keyword">only</span></span>(<span class="hljs-string"><span class="hljs-string">'test only'</span></span>, t =&gt; { t.pass(); });</code> </pre> <br><p>  Skip the test, you may need to refactor, search for errors: </p><br><pre> <code class="hljs pgsql">test.<span class="hljs-keyword"><span class="hljs-keyword">only</span></span>(<span class="hljs-string"><span class="hljs-string">'test only'</span></span>, t =&gt; { t.fail(); });</code> </pre> <br><h4 id="zaglushka-dlya-testa">  Dough cap </h4><br><p>  Delivered to the API level, which is very interesting.  You can make a reminder right in the tests. </p><br><pre> <code class="hljs cs">test.todo(<span class="hljs-string"><span class="hljs-string">''</span></span>);</code> </pre> <br><p>  If we need to test the asynchronous part of the code, we can use "cb": </p><br><pre> <code class="hljs lua">test.cb(<span class="hljs-string"><span class="hljs-string">'callback'</span></span>, t =&gt; { setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">'time'</span></span>); t.<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>(); }, <span class="hljs-number"><span class="hljs-number">3000</span></span>); });</code> </pre> <br><h3 id="uporyadochennoe-vypolnenie-testov">  Orderly execution of tests </h3><br><p>  The serial parameter allows us to perform tests in a specific sequence.  For example, we want to check the existence of a configuration file.  If not, you need to create it.  We will do 2 tests, one will create our file, and the second to check. </p><br><p>  And it will be more convenient for us that they start exactly in sequence. </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> test <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ava'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> fs <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'fs'</span></span>; const <span class="hljs-type"><span class="hljs-type">path</span></span> = <span class="hljs-string"><span class="hljs-string">'serial-test-one.txt'</span></span>; test.cb(<span class="hljs-string"><span class="hljs-string">'serial 1: create file'</span></span>, t =&gt; { fs.writeFile(<span class="hljs-type"><span class="hljs-type">path</span></span>, <span class="hljs-string"><span class="hljs-string">'test'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>(err) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) { t.fail(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { t.pass(); } t.<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>(); }); }); test.cb(<span class="hljs-string"><span class="hljs-string">'serial 2: is file exists'</span></span>, t =&gt; { fs.<span class="hljs-keyword"><span class="hljs-keyword">access</span></span>(<span class="hljs-type"><span class="hljs-type">path</span></span>, fs.F_OK, <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>(err) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) { t.fail(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { t.pass(); } t.<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>(); }); });</code> </pre> <br><p>  By writing this code we get </p><br><pre> <code class="hljs pgsql"> <span class="hljs-type"><span class="hljs-type">serial</span></span>-one ‚Ä∫ <span class="hljs-type"><span class="hljs-type">serial</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-type"><span class="hljs-type">serial</span></span>-one ‚Ä∫ <span class="hljs-type"><span class="hljs-type">serial</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> tests passed</code> </pre> <br><p>  And we see that the tests started and ended successfully.  But this is not correct, this code does not guarantee the execution in the order we need.  If we simulate a situation when there is no file yet, skip the creation test, we will get an error </p><br><pre> <code class="hljs css"> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">serial-one</span></span> ‚Ä∫ <span class="hljs-selector-tag"><span class="hljs-selector-tag">serial</span></span> 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">serial-one</span></span> ‚Ä∫ <span class="hljs-selector-tag"><span class="hljs-selector-tag">serial</span></span> 2 <span class="hljs-selector-tag"><span class="hljs-selector-tag">Test</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">failed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">via</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">t</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.fail</span></span>() 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">test</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">failed</span></span> 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">test</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">skipped</span></span> 1. <span class="hljs-selector-tag"><span class="hljs-selector-tag">serial-one</span></span> ‚Ä∫ <span class="hljs-selector-tag"><span class="hljs-selector-tag">serial</span></span> 2 <span class="hljs-selector-tag"><span class="hljs-selector-tag">AssertionError</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Test</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">failed</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">via</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">t</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.fail</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">serial-one</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.js</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:19</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:9</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FSReqWrap</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.oncomplete</span></span> (<span class="hljs-selector-tag"><span class="hljs-selector-tag">fs</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.js</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:123</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:15)</span></span></code> </pre> <br><p>  To ensure consistency, we can use the --serial or -s option. </p><br><pre> <code class="hljs pgsql">ava <span class="hljs-type"><span class="hljs-type">serial</span></span>-one.js -s <span class="hljs-type"><span class="hljs-type">serial</span></span>-one ‚Ä∫ <span class="hljs-type"><span class="hljs-type">serial</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-type"><span class="hljs-type">serial</span></span>-one ‚Ä∫ <span class="hljs-type"><span class="hljs-type">serial</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> tests passed</code> </pre> <br><p>  Or use </p><br><pre> <code class="hljs php">test.cb.serial(<span class="hljs-string"><span class="hljs-string">'serial 1'</span></span>, t =&gt; { ... });</code> </pre> <br><p>  The test falls and we know about it.  We can clearly indicate this. </p><br><pre> <code class="hljs php">test.failing(<span class="hljs-string"><span class="hljs-string">'failing'</span></span>, t =&gt; { t.fail(); });</code> </pre> <br><p>  As a result, we see that this test falls, but we know about it, and ideally we are already doing something. </p><br><pre> <code class="hljs vhdl"><span class="hljs-number"><span class="hljs-number">1</span></span> known <span class="hljs-literal"><span class="hljs-literal">failure</span></span></code> </pre> <br><p>  Very pleased that we can combine the parameters.  This allows us to implement tests of any complexity and run in only the necessary and in the right order. </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">test</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.only</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.cb</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">test</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.cb</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.only</span></span></code> </pre> <br><h3 id="before-i-after">  Before and After </h3><br><p>  To configure the test environment there are before and after.  They will be executed once at the start of test execution and at the end, respectively. </p><br><pre> <code class="hljs javascript">test.before(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t</span></span></span><span class="hljs-function"> =&gt;</span></span> { }); test.after(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t</span></span></span><span class="hljs-function"> =&gt;</span></span> { });</code> </pre> <br><p>  We can also declare several such functions and they will be called in the order of adding </p><br><pre> <code class="hljs pgsql">test.<span class="hljs-keyword"><span class="hljs-keyword">before</span></span>(t =&gt; { console.log(<span class="hljs-string"><span class="hljs-string">'before'</span></span>); }); test.<span class="hljs-keyword"><span class="hljs-keyword">before</span></span>(t =&gt; { console.log(<span class="hljs-string"><span class="hljs-string">'before#2'</span></span>); }); <span class="hljs-keyword"><span class="hljs-keyword">before</span></span> <span class="hljs-keyword"><span class="hljs-keyword">before</span></span>#<span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre> <br><p>  Works for after. </p><br><p>  If the text falls, after are not called.  To remedy the situation you need to use the always modifier. </p><br><pre> <code class="hljs pgsql">test.<span class="hljs-keyword"><span class="hljs-keyword">after</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">always</span></span>(t =&gt; { });</code> </pre> <br><h3 id="beforeeach-i-aftereach">  beforeEach and afterEach </h3><br><p>  When we need to set up the environment before each test, we use beforeEach and afterEach. </p><br><pre> <code class="hljs javascript">test.beforeEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t</span></span></span><span class="hljs-function"> =&gt;</span></span> { }); test.afterEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t</span></span></span><span class="hljs-function"> =&gt;</span></span> { });</code> </pre> <br><p>  For them, the same behavior as for before and after is preserved: the declaration order and, if there is an error in the test, the after are not called (if there is not always). </p><br><h3 id="assertions">  Assertions </h3><br><pre> <code class="hljs pgsql">test(<span class="hljs-string"><span class="hljs-string">'test'</span></span>, t =&gt; { t.pass(); t.skip.fail(); t.truthy(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); t.truthy(<span class="hljs-string"><span class="hljs-string">'unicorn'</span></span>); t.falsy(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); t.falsy(<span class="hljs-number"><span class="hljs-number">1</span></span> === <span class="hljs-number"><span class="hljs-number">0</span></span>); t.<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); t.<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); t.<span class="hljs-keyword"><span class="hljs-keyword">not</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); t.deepEqual([<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>], [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>]); t.notDeepEqual([<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>], [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>]); });</code> </pre> <br><p>  Very convenient deepEqual, and the ability to skip the check. <br>  Separately, we consider the error output, it is very detailed. </p><br><pre> <code class="hljs javascript">test(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = <span class="hljs-regexp"><span class="hljs-regexp">/foo/</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b = <span class="hljs-string"><span class="hljs-string">'bar'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> c = <span class="hljs-string"><span class="hljs-string">'baz'</span></span>; t.true(a.test(b) || b === c); });</code> </pre> <br><pre> <code class="hljs swift">t.<span class="hljs-literal"><span class="hljs-literal">true</span></span>(a.test(b) || b === <span class="hljs-built_in"><span class="hljs-built_in">c</span></span>) | | | | | <span class="hljs-string"><span class="hljs-string">"bar"</span></span> <span class="hljs-string"><span class="hljs-string">"bar"</span></span> <span class="hljs-string"><span class="hljs-string">"baz"</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br><p>  Which certainly helps debugging. </p><br><h2 id="plaginy">  Plugins </h2><br><p>  Before exploring AVA, I wrote tests on <a href="http://jasmine.github.io/">Jasmine</a> .  I like the Behavior-Driven style.  For this AVA has a plugin <a href="https://github.com/sheerun/ava-spec">ava-spec</a> . </p><br><pre> <code class="hljs matlab">npm <span class="hljs-built_in"><span class="hljs-built_in">i</span></span> -D ava-spec</code> </pre> <br><p>  Then we can write tests like this. </p><br><pre> <code class="hljs php">import {describe} from <span class="hljs-string"><span class="hljs-string">'ava-spec'</span></span>; describe(<span class="hljs-string"><span class="hljs-string">'module#1'</span></span>, it =&gt; { it(<span class="hljs-string"><span class="hljs-string">'can look almost like jasmine'</span></span>, t =&gt; { t.deepEqual([<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>], [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>]); }); it.todo(<span class="hljs-string"><span class="hljs-string">'todo'</span></span>); it.skip(<span class="hljs-string"><span class="hljs-string">'fail'</span></span>, t =&gt; { t.fail(); }); });</code> </pre> <br><h3 id="tap---test-anything-protocolhttpstestanythingorg">  <a href="https://testanything.org/">TAP - Test Anything Protocol</a> </h3><br><p>  We can customize information about our tests.  I liked the <a href="https://github.com/zoubin/tap-summary">tap-summary</a> . </p><br><pre> <code class="hljs pgsql">npm i -D tap-<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span></code> </pre> <br><p>  We use </p><br><pre> <code class="hljs pgsql">ava ava-spec.js -t | tap-<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span></code> </pre> <br><h2 id="realnye-moduli-dlya-testirovaniya">  Real modules for testing </h2><br><p>  Let's make a function, put it in a separate file, connect it and test it. </p><br><pre> <code class="hljs pgsql">// ./test/sum.spec.js <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { describe } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ava-spec'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sum <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../src/sum'</span></span>; describe(<span class="hljs-string"><span class="hljs-string">'sum'</span></span>, it =&gt; { it(<span class="hljs-string"><span class="hljs-string">'should return 10'</span></span>, t =&gt; { const expected = <span class="hljs-number"><span class="hljs-number">10</span></span>; const actual = sum(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>); t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(actual, expected); }); });</code> </pre> <br><pre> <code class="hljs lua">// ./src/sum.js <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + y; } module.exports = sum;</code> </pre> <br><pre> <code class="hljs axapta">ava test/<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>.spec.js</code> </pre> <br><p>  Everything works, our code from the file is connected and tested.  But there is a problem, our code is written on ES5, and tests are ES6.  Let's fix this situation.  AVA out of the box uses <a href="http://babeljs.io/">Babeljs</a> .  And for our code, we will use it too.  Configuring configs. </p><br><pre> <code class="hljs pgsql">// .babelrc { "presets": [ "es2015" ] }</code> </pre> <br><p>  and for AVA.  The AVA config is right in package.json. </p><br><pre> <code class="hljs lua">// ./<span class="hljs-built_in"><span class="hljs-built_in">package</span></span>.json ..., <span class="hljs-string"><span class="hljs-string">"ava"</span></span>: { <span class="hljs-string"><span class="hljs-string">"babel"</span></span>: <span class="hljs-string"><span class="hljs-string">"inherit"</span></span>, <span class="hljs-string"><span class="hljs-string">"require"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"babel-register"</span></span> ] }, ...</code> </pre> <br><p>  We launch without changes. </p><br><pre> <code class="hljs axapta">ava test/<span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>.spec.js</code> </pre> <br><h2 id="itog">  Total </h2><br><p>  AVA provides an excellent test development platform.  This library has everything for it: minimalistic style, quick execution, flexibility in writing tests, work with tests and the environment for them, informative error output.  In total, with the ability to customize both the test code itself, based on preferences and necessity, and the output of information on tests. </p><br><h2 id="ob-avtore-biblioteki">  About the author of the library </h2><br><p>  I would like to tell a little bit about the author of this library.  This is probably one of the most famous people in the JS community of <a href="https://github.com/sindresorhus">Sindre Sorhus</a> .  On his page on github you can look at his projects and treasure in the community.  And / or you can get to know him as a person, as far as possible on the Internet, or ask question / s through <a href="https://blog.sindresorhus.com/answering-anything-678ce5623798">ama - Ask me anything!</a>  . </p><br><h4 id="ps">  PS </h4><br><ul><li>  In useful links last repository with examples for the article. </li><li>  From myself: after becoming acquainted with AVA, I switched to AVA in my new home projects.  The next working project will be developed with this library.  Perhaps some of my old projects will be translated into AVA at the same time measuring the speed of execution and complexity of the transition. </li></ul><br><p>  Useful links: </p><br><ul><li>  <a href="https://github.com/avajs/ava">Ava repo</a> </li><li>  <a href="https://github.com/avajs/awesome-ava">awesome-ava a</a> lot of useful information about AVA: articles, videos, plugins and tutorials. </li><li>  <a href="https://github.com/sindresorhus/awesome-tap">awesome-tap</a> - all about <a href="https://testanything.org/">TAP - Test Anything Protocol</a> </li><li>  <a href="https://github.com/AlekseyLeshko/ava-learn">Examples</a> </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/313468/">https://habr.com/ru/post/313468/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../313456/index.html">How to improve the process of finding a new job? Inside view</a></li>
<li><a href="../313458/index.html">We invite you to the II International GDG DevFest 2016 in Nizhny Novgorod</a></li>
<li><a href="../313460/index.html">Danger and Security - Virtual Arms Race</a></li>
<li><a href="../313464/index.html">ODBC Firebird Postgresql, execution of requests in Powershell</a></li>
<li><a href="../313466/index.html">The opening of a mobile development studio from scratch in St. Petersburg - 3.5 years later. Reincarnation. Part 1</a></li>
<li><a href="../313472/index.html">Slideshow without JS</a></li>
<li><a href="../313474/index.html">Short and simple about the complex - the service "8-800" (Freephone)</a></li>
<li><a href="../313476/index.html">Simplify Excel binary search - Double VLOOKUP Trick implementation using UDF</a></li>
<li><a href="../313478/index.html">GPU in the clouds</a></li>
<li><a href="../313480/index.html">Grandstream IP phones and Avaya Aura PBX</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>