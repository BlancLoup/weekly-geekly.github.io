<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>An example of developing a small python + PyQt4 application for the accounting system</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Often it is necessary to develop applications for the corporate system that should have functioned yesterday, without requiring strict compliance with...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>An example of developing a small python + PyQt4 application for the accounting system</h1><div class="post__text post__text-html js-mediator-article">  Often it is necessary to develop applications for the corporate system that should have functioned yesterday, without requiring strict compliance with corporate standards.  Such applications can submit cms to sites, gui for services under * nix systems, simply by the application of the accounting system.  Developing applications of this kind in scripting languages <strike>has a theme!</strike>  usually optimal in terms of speed of execution.  Under the cat, an example of implementing an application in python + PyQt4, the functions of the application parsing and loading data from xls files ... <a name="habracut"></a><br>  In order to <strike>cook scrambled eggs</strike> I used: <br><ol><li>  Python2.5 </li><li>  PyQt-4.4.3 </li><li>  kinterbasdb3 (DB KIS - Firebird) </li><li>  xlrd-0.6 </li></ol>  As an editor, I recommend to everyone emacs python-mode (this also applies to <br>  wind users): <br><br><img alt="emsc python-mode" src="http://smstwit.ru/media/buf/emacs-python.jpg"><br><br><h4>  1. We take the dishes out of the cabinet (storage settings) </h4><br>  In general, for scripting languages ‚Äã‚Äãthis question is not worth it, as you can get a settings file like settings.py and quietly run it at the code level: <br> <code># -*- coding: cp1251 -*- <br> host='localhost/3051:intur' <br> user='SYSDBA' <br> path='d:\\dlogs\\scanner\\xls' <br> <br> oprts = ( <br> u'', <br> u'', <br> u'', <br> u'', <br> u'', <br> )</code> <br>  Getting the variables in the program looks like this: <br> <code>mod = __import__(modName) <br> host = getattr(mod, 'host', 'horn:intur') <br> user = getattr(mod, 'user', 'SYSDBA') <br></code> <br><h4>  2. Drawing of forms </h4><br>  Qt Software is generally handsome in terms of documentation, or if you compare tools for drawing GUIs, here they are also great.  I drew the main window of the program in QtDesigner + marked the signals from the widgets that need to be processed. <br><img alt="emsc python-mode" src="http://smstwit.ru/media/buf/qtdesigner.jpg"><br>  In order to quickly assemble the forms in the designer, you certainly need to gain a little understanding of the mechanisms of formation of Layout and Spacers.  There are two options for raising the window in the application, or you generate the file for the programming language you need, or use the Qt special modules to build classes from the description xml files.  I usually generate a file, I can not say that this is something better, it just seems more convenient to me.  For python, PyQt supplies pyuic.bat which you just need to copy to your project directory and generate window handler classes as you work in the designer. <br>  I have it for the main window looks like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs css"> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pyuic</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bat</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-o</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mwnd</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.py</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">mwnd</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ui</span></span></code> </pre> <br>  Unlike wx Qt, it is not the heirs of the main window classes that generate, but the modifier classes that take the base class of the window as an argument and ‚Äúhang‚Äù your controls on it.  When generating on c ++, Qt uses multiple inheritance the class of your application becomes the heir of the base window class and the modifier class.  It is interesting that when generating files, pyuic slots are hung on the base class, hence the discrepancy - signal handlers are in the heir of the base class of the window, and references to controls of the same window are found in the modifier class of the generated pyuic. <br><br><pre> <code class="hljs ruby"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_initApp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">self</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.mwnd, <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.mwnd.ui = MainWnd(), Uwnd() <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.mwnd.ui.setupUi(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.mwnd)</code> </pre><br>  I acted simply: I connected the class-modifier with the heir of the base class of the window, it turned out just when I needed to access the controls, I communicate to them as - self.ui. "name".  It seems to be an obvious thing, but how often it happens it occurred to me not the first time. <br><br>  <b>!</b>  It is also interesting that python does not digest keywords in the names of attributes and methods of classes, so you can not create the self.pass variable or self.exec ().  Hence the funny inscription in every PyQt application sys.exit (app.exec_ ()) <br><br><h4>  3. Put the pan on the stove, or launch the application </h4><br>  Here is the main.py code - its tasks start, load the settings file, request a password and, in case of a successful connection, launch the main application window <br><br>  <a href="http://pastebin.com/d4df42363">main.py</a> <br><br><h4>  4. Do not forget to put eggs in the fried eggs. </h4><br>  The heir to the main window of the application (MainWnd) performs the functions of tracking user behavior; here, by the way, the slots that we generated in the designer are visible, here the main task of the code is the most transparent and simple window control functions for the main class of the application loading the file to the database. <br>  The class that performs the main function of the application - parsing and loading data (MainModel) does not make sense without the main window, so we will make it an attribute of the window.  To parse xls files in python, there is a trivial one to use, and, therefore, the wonderful xlrd library works with the file directly without lifting up bulky OLE machines, and therefore is also faster.  The application allows you to download only modified files, so the part when the MainModel, is taken away to compare the modification dates and the last download that is stored in the database.  So, apart from the main working class of the application, no one communicates with the database by giving it a small class (dbConn), which stores the MainModel instructions in "terms" sql. <br><br>  <a href="http://pastebin.com/m366ad394">WndModel.py</a> <br><br>  In general, according to science, there is a certain clumsiness of the program due to pulling variables (for example, app) from the Container class to the classes of the 2nd hierarchy level.  In large programs, there are a little more than <s>9000</s> such variables, and this problem is solved with the help of a singleton (next time I will consider this). <br><br>  As a result, we received an application template that you can use for your own purposes, throw away WndModel.py, write your successor to the base window, your class implementing your tasks - and everything seems to be now even working. <br><br>  PS Full source code <a href="">here</a> <br><br>  UPD.  delivered the code to an external codeguard, if someone tells me how to properly highlight the python code on Habr√© I will be grateful. </div><p>Source: <a href="https://habr.com/ru/post/73643/">https://habr.com/ru/post/73643/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../73637/index.html">RAR: getting a list of files without PECL</a></li>
<li><a href="../73638/index.html">Application Optimization (Iphone armv6)</a></li>
<li><a href="../73639/index.html">Habraluchusheniya - Color all</a></li>
<li><a href="../73641/index.html">New "vampire" advertising Bing</a></li>
<li><a href="../73642/index.html">Secure storage of secrets</a></li>
<li><a href="../73647/index.html">What measures the eye-tracker. Part two</a></li>
<li><a href="../73648/index.html">Stallman loves Windows 7 too</a></li>
<li><a href="../73649/index.html">WAS: 3 invites to Google Voice :)</a></li>
<li><a href="../73650/index.html">Microsoft helps Eclipse</a></li>
<li><a href="../73651/index.html">Google Maps Navigation (Beta)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>