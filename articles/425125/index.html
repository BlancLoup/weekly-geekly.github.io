<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Selection @pythonetc, September 2018</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the fourth selection of tips about Python and programming from my author‚Äôs @pythonetc channel. 


 Previous selections: 


- August 2018 
- Ju...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Selection @pythonetc, September 2018</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/79/ur/ug/79urugmgbgzjhlpozccip51e5_s.png"></p><br><p>  This is the fourth selection of tips about Python and programming from my author‚Äôs <a href="http://t.me/pythonetc">@pythonetc</a> channel. </p><br><p>  Previous selections: </p><br><ul><li>  <a href="https://habr.com/company/mailru/blog/422789/">August 2018</a> </li><li>  <a href="https://habr.com/company/mailru/blog/419025/">July 2018</a> </li><li>  <a href="https://habr.com/company/mailru/blog/416605/">June 2018</a> </li></ul><a name="habracut"></a><br><h2 id="pereopredelenie-i-peregruzka">  Override and Overload </h2><br><p>  There are two concepts that are easily confused: overriding and overloading. </p><br><p> Overriding happens when a child class defines a method already provided by the parent classes, and thereby replaces it.  In some languages, it is required to explicitly mark the overriding method (in C #, the <code>override</code> modifier is used), and in some languages ‚Äã‚Äãthis is done at will (the <code>@Override</code> annotation in Java).  Python does not require the use of a special modifier and does not provide for standard tagging of such methods (someone for the sake of readability uses the custom decorator <code>@override</code> , which does nothing). </p><br><p>  Overloading is another story.  This term refers to the situation when there are several functions with the same name, but with different signatures.  Overloading is possible in Java and C ++, it is often used to provide default arguments: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">System</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">out</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">println</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Hello</span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span><span class="hljs-class"><span class="hljs-params">)</span></span></span><span class="hljs-class">; } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">String</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hello</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hello</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"world"</span></span></span></span><span class="hljs-class"><span class="hljs-params">)</span></span></span><span class="hljs-class">; } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">public</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">String</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hello</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(String name)</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">return</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hello</span></span></span><span class="hljs-class">, " + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">; } }</span></span></code> </pre> <br><p>  Python does not support searching functions by signature, only by name.  Of course, you can write code that explicitly analyzes the types and number of arguments, but it will look awkward, and this practice is best avoided: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quadrilateral_area</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*args)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(args) == <span class="hljs-number"><span class="hljs-number">4</span></span>: quadrilateral = Quadrilateral(*args) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> len(args) == <span class="hljs-number"><span class="hljs-number">1</span></span>: quadrilateral = args[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> TypeError() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> quadrilateral.area()</code> </pre> <br><p>  If you need type hints, use the <code>typing</code> module with the <code>@overload</code> decorator: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> typing <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> overload @overload <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quadrilateral_area</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( q: Quadrilateral )</span></span></span><span class="hljs-function"> -&gt; float:</span></span> ... @overload <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quadrilateral_area</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( p1: Point, p2: Point, p3: Point, p4: Point )</span></span></span><span class="hljs-function"> -&gt; float:</span></span> ...</code> </pre> <br><h2 id="avtovivifikaciya">  Autovivification </h2><br><p>  <code>collections.defaultdict</code> allows you to create a dictionary that returns a default value if the requested key is not present (instead of throwing a <code>KeyError</code> ).  To create <code>defaultdict</code> you need to provide not just a default value, but a factory of such values. </p><br><p>  So you can create a dictionary with a virtually infinite number of nested dictionaries, which will allow you to use constructions like <code>d[a][b][c]...[z]</code> . </p><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">infinite_dict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> defaultdict(infinite_dict) ... &gt;&gt;&gt; d = infinite_dict() &gt;&gt;&gt; d[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">4</span></span>] = <span class="hljs-number"><span class="hljs-number">10</span></span> &gt;&gt;&gt; dict(d[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">5</span></span>]) {}</code> </pre> <br><p>  This behavior is called ‚Äúautovivification,‚Äù a term that comes from Perl. </p><br><h2 id="instancirovanie">  Instantiation </h2><br><p>  Instantiating objects involves two important steps.  First, the <code>__new__</code> method is called from the class, which creates and returns a new object.  Then, from it, Python calls the <code>__init__</code> method, which sets the initial state of this object. </p><br><p>  However, <code>__init__</code> will not be called if <code>__new__</code> returns an object that is not an instance of the original class.  In this case, the object could have been created by another class, and therefore <code>__init__</code> already called on the object: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__new__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls, x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dict(x=x) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x)</span></span></span><span class="hljs-function">:</span></span> print(x) <span class="hljs-comment"><span class="hljs-comment"># Never called print(Foo(0))</span></span></code> </pre> <br><p>  This also means that you should not create instances of the same class in <code>__new__</code> using the normal constructor ( <code>Foo(...)</code> ).  This can lead to the re-execution of <code>__init__</code> , or even to infinite recursion. </p><br><p>  Infinite recursion: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__new__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls, x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Foo(-x) <span class="hljs-comment"><span class="hljs-comment"># Recursion</span></span></code> </pre> <br><p>  Double performance <code>__init__</code> : </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__new__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls, x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Foo(-x) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> super().__new__(cls) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x)</span></span></span><span class="hljs-function">:</span></span> print(x) self._x = x</code> </pre> <br><p>  The right way: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__new__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cls, x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cls.__new__(cls, -x) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> super().__new__(cls) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x)</span></span></span><span class="hljs-function">:</span></span> print(x) self._x = x</code> </pre> <br><h2 id="operator--i-srezy">  [] Operator and slices </h2><br><p>  In Python, you can override the <code>[]</code> operator by defining the <code>__getitem__</code> magic method.  For example, you can create an object that virtually contains an infinite number of duplicate elements: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cycle</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, lst)</span></span></span><span class="hljs-function">:</span></span> self._lst = lst <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__getitem__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, index)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self._lst[ index % len(self._lst) ] print(Cycle([<span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>, <span class="hljs-string"><span class="hljs-string">'c'</span></span>])[<span class="hljs-number"><span class="hljs-number">100</span></span>]) <span class="hljs-comment"><span class="hljs-comment"># 'b'</span></span></code> </pre> <br><p>  The unusual thing here is that the <code>[]</code> operator supports a unique syntax.  With it, you can get not only <code>[2]</code> , but also <code>[2:10]</code> , <code>[2:10:2]</code> , <code>[2::2]</code> and even <code>[:]</code> .  The operator semantics is: [start: stop: step], however you can use it in any other way to create custom objects. </p><br><p>  But if you call <code>__getitem__</code> with this syntax, what does he get as an index parameter?  That is what slice objects are for. </p><br><pre> <code class="python hljs">In : <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Inspector</span></span></span><span class="hljs-class">:</span></span> ...: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__getitem__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, index)</span></span></span><span class="hljs-function">:</span></span> ...: print(index) ...: In : Inspector()[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-number"><span class="hljs-number">1</span></span> In : Inspector()[<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>] slice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) In : Inspector()[<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>] slice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) In : Inspector()[:] slice(<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>)</code> </pre> <br><p>  You can even combine syntaxes of tuples and slices: </p><br><pre> <code class="python hljs">In : Inspector()[:, <span class="hljs-number"><span class="hljs-number">0</span></span>, :] (slice(<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>, slice(<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>))</code> </pre> <br><p>  <code>slice</code> does nothing, only stores the <code>start</code> , <code>stop</code> and <code>step</code> attributes. </p><br><pre> <code class="python hljs">In : s = slice(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) In : s.start Out: <span class="hljs-number"><span class="hljs-number">1</span></span> In : s.stop Out: <span class="hljs-number"><span class="hljs-number">2</span></span> In : s.step Out: <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br><h2 id="preryvanie-korutiny-asyncio">  Asyncio interruption </h2><br><p>  Any coroutine <code>asyncio</code> can be interrupted using the <code>cancel()</code> method.  In this case, a CancelledError will be sent to the quortenine, as a result of this and all the associated Korutins will be interrupted until the error is caught and suppressed. </p><br><p>  <code>CancelledError</code> is a subclass of <code>Exception</code> , which means you can accidentally catch it using the <code>try ... except Exception</code> combination designed to catch "any errors."  To safely catch a coroutine, you have to do this: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> action() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> asyncio.CancelledError: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception: logging.exception(<span class="hljs-string"><span class="hljs-string">'action failed'</span></span>)</code> </pre> <br><h2 id="planirovanie-ispolneniya">  Execution planning </h2><br><p>  To schedule the execution of some code at a certain time in <code>asyncio</code> usually create a task that performs <code>await asyncio.sleep(x)</code> : </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> asyncio <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> print(n) <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>) loop.create_task(do(n + <span class="hljs-number"><span class="hljs-number">1</span></span>)) loop.create_task(do(n + <span class="hljs-number"><span class="hljs-number">1</span></span>)) loop = asyncio.get_event_loop() loop.create_task(do()) loop.run_forever()</code> </pre> <br><p>  But creating a new task can be expensive, and you don‚Äôt have to do it if you don‚Äôt plan to perform asynchronous operations (like the <code>do</code> function in my example).  Instead, you can use the functions <code>loop.call_later</code> and <code>loop.call_at</code> , which allow you to schedule an asynchronous callback call: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> asyncio <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> print(n) loop = asyncio.get_event_loop() loop.call_later(<span class="hljs-number"><span class="hljs-number">1</span></span>, do, n+<span class="hljs-number"><span class="hljs-number">1</span></span>) loop.call_later(<span class="hljs-number"><span class="hljs-number">1</span></span>, do, n+<span class="hljs-number"><span class="hljs-number">1</span></span>) loop = asyncio.get_event_loop() do() loop.run_forever()</code> </pre> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/425125/">https://habr.com/ru/post/425125/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../425111/index.html">Promotional tricks that can cost you money and reputation</a></li>
<li><a href="../425113/index.html">‚ÄúDigital typography‚Äù or my experience in mobile book digitization</a></li>
<li><a href="../425115/index.html">Full-blown DevOps: Greek tragedy in three acts</a></li>
<li><a href="../425117/index.html">Two bits per transistor: Intel 8087 floating point high density ROM</a></li>
<li><a href="../425123/index.html">Mysterious heart of the drum machine Roland TR-808</a></li>
<li><a href="../425129/index.html">How to automate the creation of virtual machines? We tell in detail</a></li>
<li><a href="../425131/index.html">What to read about blockchain technologies: manuals, books and articles</a></li>
<li><a href="../425133/index.html">Problems of cross-border payments - why and how blockchains are used here</a></li>
<li><a href="../425135/index.html">Why VoIP was recognized as an information service in the USA, and what it means for the telecom industry and users</a></li>
<li><a href="../425137/index.html">We work in the console quickly and efficiently</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>