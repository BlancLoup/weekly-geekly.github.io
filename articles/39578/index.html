<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We spin vote in WordPress</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="So, there is a WordPress blog with a voting form, which is implemented using the WP-Polls plugin. There was a desire to test the plugin for cheating b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We spin vote in WordPress</h1><div class="post__text post__text-html js-mediator-article">  So, there is a WordPress blog with a voting form, which is implemented using the WP-Polls plugin.  There was a desire to test the plugin for cheating before use. <br>  Below are the results of my experiments on the unfortunate WP and at least the unfortunate WP-Polls. <br><a name="habracut"></a><br><h5>  Initial data </h5><br>  Dan WordPress blog with a vote on WP-Polls.  Voting is available to all visitors.  Protection against re-voting by blocking by IP.  In the survey, you can select only one option. <br>  You need to write a script that can affect the voting results. <br><br><h5>  We study the subject area </h5><br>  When adding a vote, the following form is inserted on the page: <br><div style="text-align:center;"><img src="http://lesterchan.net/wordpress/screenshots/wp-polls/single_poll_answer.png"></div><br>  After selecting the option, a request of the following type is sent to the server by ajax: <br><pre> POST http://test.ru/wp-content/plugins/wp-polls/wp-polls.php
         poll_1: 1
         poll_id: 1
         rndval: 1221566428538
         vote: true
</pre><br>  where poll_id is the poll id, and poll_1 are the response options (after the underscore in the variable name, the poll id is followed). <br><br>  <b>Implementing Re-Voting Protection</b> <br>  We use the fact that WP is an open source project and examine the <a href="http://plugins.trac.wordpress.org/browser/wp-polls/trunk/wp-polls.php">source code of the</a> plugin. <br>  Obviously, we need a function <code>check_voted($poll_id)</code> in which <code>check_voted_ip($poll_id)</code> called. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Getting naughty </h5><br>  In the check_voted_ip ($ poll_id) function, a query is made to the database for the presence of a record with the given poll id and user ip.  The IP address is returned by the <code>get_ipaddress()</code> function: <br><pre> function get_ipaddress () {
         if (empty ($ _ SERVER ["HTTP_X_FORWARDED_FOR"])) {
                 $ ip_address = $ _SERVER ["REMOTE_ADDR"];
         } else {
                 $ ip_address = $ _SERVER ["HTTP_X_FORWARDED_FOR"];
         }
         if (strpos ($ ip_address, ',')! == false) {
                 $ ip_address = explode (',', $ ip_address);
                 $ ip_address = $ ip_address [0];
         }
         return $ ip_address;
 }
</pre><br>  From this function, it follows that we peacefully set the pens to the title " <a href="http://en.wikipedia.org/wiki/X-Forwarded-For">X_FORWARDED_FOR</a> ", which will be used by the plugin to verify the re-vote. <br><br><h5>  Implementation </h5><br>  I will not give the listing script for cheating the survey due to its triviality.  It is enough to write a script / program in your most favorite programming language that will send a POST request to the address of the plug-in with the required parameters; moreover, each request must have a unique ‚ÄúX_FORWARDED_FOR‚Äù header. <br><br><h5>  Conclusion </h5><br>  This article provides a way to bypass the protection from re-voting in the WP-Polls plugin for WordPress.  The presented material does not consider the option of using proxy-servers due to the greater labor intensity compared to the presented method. <br><br>  Naturally, the results of the script are easily corrected through the administrative panel WP.  This information is presented for informational purposes only. <br><br><h5>  PS </h5><br>  In the process of analyzing the source code of the plugin, another method of cheating was discovered, which does not work out quite correctly. <br>  This method is associated with the ability of the plugin to implement surveys in which the user can select several answer options.  They are transmitted to the server separated by commas: <br><pre>  poll_1: 1,2,3,4 </pre><br>  When processing by a script, this parameter beats comma to the array on which the loop is executed: <br><pre>  foreach ($ poll_aid_array as $ polla_aid) {
         $ wpdb-&gt; query ("
                        UPDATE $ wpdb-&gt; pollsa 
                        SET polla_votes = (polla_votes + 1) 
                        WHERE polla_qid = $ poll_id AND polla_aid = $ polla_aid
     ");
 } </pre><br>  Therefore, to wrap one of the options, it is enough to pass a string like: <br><pre>  poll_1: 1,1,1, ..., 1 </pre><br>  to increase the number of votes for this answer N times. <br>  The disadvantage is that the number of voters will still increase by only 1 and the display of the voting results will crawl </div><p>Source: <a href="https://habr.com/ru/post/39578/">https://habr.com/ru/post/39578/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../395771/index.html">It did happen: Putin signed the ‚ÄúSpring package.‚Äù Communication tariffs will grow 2-4 times</a></li>
<li><a href="../395773/index.html">Special project: Solar power station on autocamp. Part 2</a></li>
<li><a href="../395775/index.html">Sociable cars on the roads of the future</a></li>
<li><a href="../395777/index.html">The 15x4 science popularization project holds open lectures and scales to new cities</a></li>
<li><a href="../395779/index.html">Outstanding scientist Zinovy ‚Äã‚ÄãL. Rabinovich</a></li>
<li><a href="../395781/index.html">Homemade 200W light bazooka</a></li>
<li><a href="../395783/index.html">Snow removal? No problem</a></li>
<li><a href="../395785/index.html">Ask Ethan # 67: dark matter versus dark energy</a></li>
<li><a href="../395787/index.html">Singapore's economic miracle</a></li>
<li><a href="../395789/index.html">Microsoft managed to write 200 MB of data on synthetic DNA strands</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>