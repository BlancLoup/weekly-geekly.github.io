<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hijacking Whatsapp accounts using the web version</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="With the introduction of changes such as end-to-end encryption for all users, Whatsapp grew from an application that ignored security to an applicatio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hijacking Whatsapp accounts using the web version</h1><div class="post__text post__text-html js-mediator-article">  With the introduction of changes such as end-to-end encryption for all users, Whatsapp grew from an application that ignored security to an application that many people respect. <br><br>  Whatsapp accounts are based on phone numbers.  This means that your phone number is your login, which is also used for authentication. <br><br>  Although this is not the best solution in terms of privacy, it often saves unsafe users from remembering another password that they can potentially enter during a phishing attack. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A brief review of the entry process: <br><br><img src="https://blog.mawalabs.de/assets/whatsapp-phishing/whatsapp_login.svg" alt="image"><br><a name="habracut"></a><br>  When the application is launched for the first time, the user must enter his phone number.  Verification code is sent to the number in the form of sms or call.  After that, the code is entered into the application, the authentication token is stored on the device. <br><br>  When a user uses a new device, the process must be repeated for that device and the old one will be deauthorized. <br><br>  Whatsapp does not store old messages on their servers, so previous messages will not be transferred to the new device. <br><br>  Of course, the process is actually more complicated, but this simplification is appropriate for the purposes of this article. <br><br>  Convenience replaces security.  The price of this is a vulnerability to new attacks that can be used to access a phone number.  This also requires the trust of the mobile operator, since it has full access to the number and can easily access the account. <br><br><h3>  By the attacker </h3><br>  From the point of view of a ‚Äúlow-budget‚Äù malefactor, this is difficult to get around.  There are only two workarounds: <br><br>  1) Getting access to the victim's phone.  As stated above, this can be obtained by various attacks on the network or by a mobile provider.  Even if access to the phone number can be obtained, it will not give access to the message history and the victim will notice it, since its phone will be deauthorized. <br><br>  2) Protroyan phone itself and access the data section.  It is expensive. <br><br><h3>  Meet the new player </h3><br>  In 2015, whatsapp launched Whatsapp web, a site that allows you to send and receive messages from a computer.  In order to use this, the browser must be ‚Äúconnected‚Äù with the phone, while the phone remains ‚Äúat the head‚Äù of all this.  Overview of the process: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/355/5d7/dcc/3555d7dcc6031a52dbe2ae4030be3a0a.png" alt="image"><br><br>  Scanning the QR code shown on the Whatsapp web page using the phone, the browser is authorized.  The user can then use whatsapp in the browser as long as the phone is connected to the network. <br><br>  This procedure opens up the possibility for intruders.  The trick is to use a scanned QR code and this will give full account access, including future and past communications.  Bingo! <br><br><h3>  Attack description </h3><br>  It's simple: the attacker only has to force the user to scan the ‚Äúmalicious‚Äù QR code in order to authorize the attacker's browser.  This will give him full access to whatsaupp account. <br><br>  The following image shows how this works: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ae8/a3c/a07/ae8a3ca0715e151c6c7a78f9138a2941.png" alt="image"><br><br>  In order to do this, whatsapp should not display a static QR code on their registration page, but generate a different one every two seconds.  This prevents intruders from simply copying code and posting on a new page. <br><br><h3>  Demo </h3><br>  This tool I developed using selenium to get QR codes and express.js + socket.io to display them on the page.  If the victim scans this code using her phone, the browser's document.cookie and localStorage selenium is saved to a file on the attacker's machine. <br>  The data obtained can be used to log into the victim's account using any browser. <br><br>  ‚Üí <a href="https://github.com/Mawalu/whatsapp-phishing">Githab code</a> </div><p>Source: <a href="https://habr.com/ru/post/320282/">https://habr.com/ru/post/320282/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../320266/index.html">JunOS update on EX4500 switches in VirtualChassis - what could go wrong? Part 1</a></li>
<li><a href="../320268/index.html">Generating documents in doc, excel, pdf and other formats on the server</a></li>
<li><a href="../320270/index.html">Internet intelligence in action: who is Mr./Ms. Habraman?</a></li>
<li><a href="../320278/index.html">Hard parting with Net-Tools</a></li>
<li><a href="../320280/index.html">Javascript Video Refactoring</a></li>
<li><a href="../320284/index.html">Qt 5.8 framework release</a></li>
<li><a href="../320286/index.html">The right way to become a safe person: from lamer to practical exploit</a></li>
<li><a href="../320288/index.html">Python: collections, part 4/4: All about expression-generators, list generators, sets and dictionaries</a></li>
<li><a href="../320290/index.html">This is not ransomware, but in any case can ‚Äúseize‚Äù your server.</a></li>
<li><a href="../320292/index.html">How I created a SaaS service that brings me $ 1000 a month</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>