<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Facebook's Osquery Introduction</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 
 This publication is a relatively free translation of the article ‚ÄúIntroducing osquery‚Äù published on the Facebook blog. 

 Introduction to o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Facebook's Osquery Introduction</h1><div class="post__text post__text-html js-mediator-article"><h4>  Foreword </h4><br>  This publication is a relatively free translation of the article <a href="https://code.facebook.com/posts/844436395567983/introducing-osquery/">‚ÄúIntroducing osquery‚Äù</a> published on the Facebook blog. <br><br><h4>  Introduction to osquery </h4><br>  Monitoring the status of your system in real time is very important.  In Facebook, we developed a framework called osquery, which allows you to look at low-level monitoring of the operating system in a new way. <br><br>  Osquery represents the operating system as a high-performance relational database.  This approach allows you to write SQL queries to easily and efficiently retrieve information about your system.  With osquery, the current state of the OS is represented as SQL tables from which you can get information about: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  running processes; </li><li>  loaded kernel modules; </li><li>  open stevia compounds. </li></ul><br><a name="habracut"></a><br>  SQL tables are created through an easily extensible API.  Several tables already exist and many more are being developed.  To better understand the ease and expressiveness that osquery provides, the following examples will help. <br><br><h4>  Query examples </h4><br>  The first example illustrates how you can use osquery to interact with processes running on the current system.  Specifically, this query returns the processes that are currently running.  The WHERE clause in this query returns only those processes that were launched from binaries but are no longer in the file system at the moment.  This is a common practice that hackers resort to, so this query will not return any results on your system, provided that your system has not been compromised. <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">path</span></span>, pid <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> processes <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> on_disk = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre> <br>  Interacting with the OS using SQL is a simple and entertaining exercise.  One of the advantages that SQL gives us is the ability to join different tables together for system analysis.  The following example shows us how it is possible to simultaneously use information from two ‚Äútables‚Äù - listening_ports and processes.  This query looks for all processes that are listening to network ports.  Thus, using the ‚Äútable‚Äù of processes from the previous example, we can combine it with another ‚Äútable‚Äù - the network ports table.  Both there and there the PID of the process is used, by which the merging takes place. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DISTINCT</span></span> process.name, listening.port, listening.address, process.pid <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> processes <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> process <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> listening_ports <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> listening <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> process.pid = listening.pid;</code> </pre><br>  Osquery includes many tables and many more are created by us daily.  The tables are easy to write, so we don‚Äôt mind and even encourage the development of new tables by third-party developers.  Detailed information can be found in our <a href="https://github.com/facebook/osquery/wiki/creating-a-new-table">wiki</a> . <br><br><h4>  Features </h4><br>  Osquery is the framework we use to create new products and tools.  The osquery modular source code gives us an edge over existing concepts.  We release several tools as part of one open source release and we have a lot more in our plans.  We also look forward to the moment when our community will present its tools based on osquery. <br><br><h5>  Interactive console </h5><br>  The osqueryi interactive console is a SQL interface where you can execute your queries and examine your OS.  With all the expressive power of SQL and the many useful tables built into osquery, the console is an invaluable tool for diagnosing OS problems, solving performance problems, and more. <br><br>  More information on using osquery is in our <a href="https://github.com/facebook/osquery/wiki/using-osqueryi">wiki</a> . <br><br><h5>  Cluster Monitoring </h5><br>  To monitor large systems, we have a demon, osqueryd.  It allows you to schedule requests to execute them across your entire infrastructure.  The daemon independently takes care of the aggregation of the results of requests by time and generates logs showing the status of changes in the infrastructure.  You can use it to update the security, performance, configuration, and integrity status of your infrastructure.  The osqueryd daemon can also integrate your internal logs using a robust plugin architecture. <br><br>  If you are interested in using osqueryd in your infrastructure, we again invite you to the <a href="https://github.com/facebook/osquery/wiki/using-osqueryd">wiki</a> , as well as to the <a href="https://github.com/facebook/osquery/wiki/internal-deployment-guide">internal deployment guide</a> . <br><br><h5>  Cross Platform </h5><br>  Osquery is cross-platform.  And while osquery has an advantage in low-level operating systems, you can build and use it in Ubuntu, CentOS and MacOS.  It will even give a definite advantage, since  will allow to monitor corporate poppies at the same level as corporate Linux servers. <br><br><h5>  Native builds and documentation </h5><br>  To facilitate deployment, osquery comes as a regular package for all supported operating systems.  There is also detailed documentation on creating your own packages.  Therefore, developing and implementing your own osquery tools should be as easy as possible. <br>  Osquery was designed to take into account the characteristics of the environments used in order to enable hot plug-in replacement in an already running system.  Using the provided interfaces allows you to more deeply integrate osquery into your infrastructure if one or more of the plugins used no longer do not meet your needs. <br><br>  Read more <a href="https://github.com/facebook/osquery/wiki">here</a> . <br><br><h5>  Modular source code </h5><br>  Osquery consists of high-performance modular components with a well-documented public API.  These components can be easily put together to create new, interesting applications and tools.  Details on the API <a href="https://github.com/facebook/osquery/wiki/public-api">here</a> . <br><br><h5>  Open source </h5><br>  After talking with several external companies, it came to be understood that such monitoring of the low-level behavior of operating systems is not a unique problem for Facebook.  A few months later we released osquery as binary files for a limited number of companies.  They successfully implemented and tested osquery on their equipment, and we received excellent feedback from them. <br>  And now we are pleased to announce that the time has come for open source osquery.  You can find all the code and documentation on <a href="https://github.com/facebook/osquery">github</a> . <br><br>  We look forward to feedback from the community.  We will do all the work with osquery on github.  This will facilitate the work of third-party developers.  We hope you see the potential in osquery and do wonderful things with us. </div><p>Source: <a href="https://habr.com/ru/post/243391/">https://habr.com/ru/post/243391/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../243379/index.html">Zabbix + Communigate Pro: low-level discovery and account monitoring</a></li>
<li><a href="../243381/index.html">Work in the office VS Work in coworking for a small team</a></li>
<li><a href="../243383/index.html">How to send push notifications to the Windows Universal app</a></li>
<li><a href="../243385/index.html">Processors, cores and threads. System topology</a></li>
<li><a href="../243389/index.html">What will be new on .NEXT and why it will be good</a></li>
<li><a href="../243393/index.html">Should everyone learn programming?</a></li>
<li><a href="../243395/index.html">Moving from online to offline IDE when programming Nucleo-F401RE</a></li>
<li><a href="../243397/index.html">Well.js is another approach to modular JavaScript development.</a></li>
<li><a href="../243401/index.html">Customize viewing of individual Issue in Atlassian Jira</a></li>
<li><a href="../243403/index.html">A brief synopsis of javascript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>