<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automatic recommendation: some theory and practice</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1. Introduction 
 In this article some basic theoretical and practical questions of automatic recommendation will be considered. Particular attention ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automatic recommendation: some theory and practice</h1><div class="post__text post__text-html js-mediator-article"><h4>  1.  Introduction </h4><br>  In this article some basic theoretical and practical questions of automatic recommendation will be considered.  Particular attention will be paid to the story of the experience of using Apache Mahout on large portals (written in Yii 2) with high attendance (several million people per day).  There will be examples of source code in PHP and JAVA, which will help the reader to better understand the integration process of Mahout. <br><a name="habracut"></a><br><h4>  2. Robustness assessment </h4><br>  First of all, we must make sure that the results are not affected by various interferences.  As a rule, the easiest way to recommend a certain entity is the method of ranking by the average value of the user rating.  The higher the average grade, the higher the likelihood of recommending an item.  However, even in such a simple approach there is a very important point - interference in accuracy.  Let's look at a couple of examples.  Suppose that a user has the opportunity to rate a product (or another object) on a scale from 1 to 10. Let there be a finite set of user ratings of a certain object: 5, 7, 4, 8, 6, 5, 10, 5, 10, 9, 10, 10, 10, 5, 2, 10. For a more comfortable perception, we will display them in the form of a diagram: <br><br><img src="https://habrastorage.org/files/392/484/fd9/392484fd97dc4b838aee4f16cc3fb09c.png"><br><br>  The power of the set is 16. In this particular case, we do not observe a significant difference between the median (7.5) and the arithmetic average value (7.25), and the variance of the random variable is only 7.267.  In some cases, we may need to filter emissions (for example, if the variation range can be large).  Naturally, we can use robust indicators.  Let there be a set: 1, 2, 1, 2, 3, 1, 5, 100, 4. Its graphic representation: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/d3c/dc9/456/d3cdc94569b449b687fbcecabcdff3c9.png"><br><br>  In the example mentioned, the arithmetic mean value clearly does not reflect the real situation.  Moreover, the variance in the sample is clearly large (in this example, slightly more than 1060).  Using robust indicators (median and quartile) helps us avoid such problems. <br><br><h4>  3. Accounting for correlation </h4><br>  What is the very first way to find correlation?  Naturally, this is the linear correlation coefficient of Karl Pearson.  Here is another small example.  Suppose that two experts need to evaluate the quality of sites.  Each of them gives its assessment.  For example: <br><br><img src="https://habrastorage.org/files/125/b90/835/125b908353ba4e8791e173f72b7e1e8a.png"><br><br>  One glance at the graph is enough to see the strong similarity of the opinions of the two experts.  In this example, the linear correlation coefficient of Karl Pearson was 0.9684747092.  Based on the data obtained, it can be predicted that the probability of an event ‚Äúgiving a similar rating‚Äù to other sites will be high enough.  Knowing tastes is easier to recommend, right?  And can we rely on the estimates of only like-minded users, and not on everything? <br><br><h4>  4. Automatic recommendation </h4><br>  Let's look at an example of how an interesting free Apache Mahout library works.  Suppose that there are three objects.  I rated only two of them (I scored only two points for the first object, and five for the second object).  In addition to me, there are three more people who evaluated the objects.  But unlike me, they rated all three objects.  Let's look at the table with all the estimates: <br><br><img src="https://habrastorage.org/files/5c6/5d2/ccb/5c65d2ccb1a94eef95498ff2782c756c.png"><br><br>  Indeed, if you pass such data to Mahout, he will recommend the third object to me.  There is no sense in recommending the first two objects, since I no longer simply know about them, but even gave them a rating.  Moreover, Mahout could take into account the similarity of my opinion with three other people - if I give a very different assessment to the first object (say 10), then Mahout will not recommend anything to me.  I did not confuse?  Now check. <br><br>  The MySQLJDBCDataModel class can retrieve data from the MySQL database (the table should contain: user_id, item_id, and preference).  And the FileDataModel class can load from a file (CSV file, where each line has the form "1,1,2.0", and empty lines are ignored).  Theoretically, an application on Yii should not know anything at all about the methods of recommendations, but simply take the necessary information from the database (connection by table: user ID, recommended object ID) and display it for the user. <br><br>  I had to do quite a lot of tasks on high-load sites (with attendance of several million people per day) on Yii, including integration with various analytical systems and search platforms.  Naturally, I often had to understand a huge number of projects in Java, but for the first time I connected Mahout. <br><br>  Of course, there are many ways to exchange data.  Starting from direct downloads (export using Hibernate to the site database) from external systems, to using queues (Gearman, RabbitMQ).  I have seen some funny cases when parsing sites with JSOUP and even very slow PhantomJS was used to get data, and sometimes they were unloaded from Excel with the help of POI.  But let's not talk about sad things. <br><br>  By the way, storage methods are also not boring - from MongoDB to search engines (Endeca, Solr, Sphinx, even wonders built into ATG).  Of course, such options have the right to exist and are not rarely used by huge projects, however, in this article I would like to consider a more common option. <br><br>  Suppose we have a website on Yii with attendance of several million people per day.  Let MySQL cluster be used as a database (memcached takes on all burdens and hardships).  The application does not have write access to the database, and the data is transmitted exclusively through the API (to the Redis cluster), from where it is collected (thanks to the free google-gson and Jedis libraries) analytical system written in Java.  It was to her that the Mahout library was added. <br><br>  But I want to get not just a list of identifiers, but ready (for the widget) data.  What do I need?  Suppose I want to display a picture.  I also need a headline.  Of course, I need a link to the recommended object (the page where the user will go if he clicks on the widget).  This will be a universal option.  In the system responsible for unloading, I can add the logic I need to fill this table.  In such a case, the structure of the table may be something like <br><br><pre><code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">db</span></span>\<span class="hljs-title"><span class="hljs-title">Schema</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">db</span></span>\<span class="hljs-title"><span class="hljs-title">Migration</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">m150923_110338_recommend</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Migration</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">up</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;createTable(<span class="hljs-string"><span class="hljs-string">'recommend'</span></span>, [ <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;primaryKey(), <span class="hljs-string"><span class="hljs-string">'status'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;boolean()-&gt;notNull(), <span class="hljs-string"><span class="hljs-string">'url'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;string(<span class="hljs-number"><span class="hljs-number">255</span></span>)-&gt;notNull(), <span class="hljs-string"><span class="hljs-string">'title'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;string(<span class="hljs-number"><span class="hljs-number">255</span></span>)-&gt;notNull(), <span class="hljs-string"><span class="hljs-string">'image'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;string(<span class="hljs-number"><span class="hljs-number">255</span></span>)-&gt;notNull(), <span class="hljs-string"><span class="hljs-string">'created_at'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;datetime()-&gt;notNull(), <span class="hljs-string"><span class="hljs-string">'updated_at'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;datetime()-&gt;notNull(), ]); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">down</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;dropTable(<span class="hljs-string"><span class="hljs-string">'recommend'</span></span>); } }</code> </pre> <br>  The model should have a method that will allow us to understand to which user we will recommend this entity.  Some of the featured objects will tell us Mahout.  Of course, from the very beginning we will foresee a situation where Mahout cannot recommend anything to us (or the amount will be insufficient).  The model may be something like this: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">common</span></span>\<span class="hljs-title"><span class="hljs-title">models</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Yii</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">common</span></span>\<span class="hljs-title"><span class="hljs-title">models</span></span>\<span class="hljs-title"><span class="hljs-title">Api</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * This is the model class for table "recommend". * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@property</span></span></span><span class="hljs-comment"> integer $id * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@property</span></span></span><span class="hljs-comment"> integer $status * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@property</span></span></span><span class="hljs-comment"> string $url * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@property</span></span></span><span class="hljs-comment"> string $title * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@property</span></span></span><span class="hljs-comment"> string $image * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@property</span></span></span><span class="hljs-comment"> string $created_at * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@property</span></span></span><span class="hljs-comment"> string $updated_at */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Recommend</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> \</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">yii</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">db</span></span></span><span class="hljs-class">\</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActiveRecord</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> STATUS_INACTIVE = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> STATUS_ACTIVE = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@inheritdoc</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tableName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'recommend'</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@inheritdoc</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rules</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ [[<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'url'</span></span>, <span class="hljs-string"><span class="hljs-string">'title'</span></span>, <span class="hljs-string"><span class="hljs-string">'image'</span></span>, <span class="hljs-string"><span class="hljs-string">'created_at'</span></span>, <span class="hljs-string"><span class="hljs-string">'updated_at'</span></span>], <span class="hljs-string"><span class="hljs-string">'required'</span></span>], [[<span class="hljs-string"><span class="hljs-string">'status'</span></span>], <span class="hljs-string"><span class="hljs-string">'integer'</span></span>], [[<span class="hljs-string"><span class="hljs-string">'created_at'</span></span>, <span class="hljs-string"><span class="hljs-string">'updated_at'</span></span>], <span class="hljs-string"><span class="hljs-string">'safe'</span></span>], [[<span class="hljs-string"><span class="hljs-string">'url'</span></span>, <span class="hljs-string"><span class="hljs-string">'title'</span></span>, <span class="hljs-string"><span class="hljs-string">'image'</span></span>], <span class="hljs-string"><span class="hljs-string">'string'</span></span>, <span class="hljs-string"><span class="hljs-string">'max'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">255</span></span>] ]; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@inheritdoc</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">attributeLabels</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'ID'</span></span>, <span class="hljs-string"><span class="hljs-string">'status'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'url'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'title'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'image'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">'created_at'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'updated_at'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">''</span></span>, ]; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@inheritdoc</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">behaviors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ [ <span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; \yii\behaviors\TimestampBehavior::className(), <span class="hljs-string"><span class="hljs-string">'value'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \yii\db\Expression(<span class="hljs-string"><span class="hljs-string">'NOW()'</span></span>), ], ]; } <span class="hljs-comment"><span class="hljs-comment">/** * Status list */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">statusList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::STATUS_INACTIVE =&gt; <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>::STATUS_ACTIVE =&gt; <span class="hljs-string"><span class="hljs-string">' '</span></span>, ]; } <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> integer $userId * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> integer $limit */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getItemsByUserId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($userId = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">, $limit = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">6</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ $itemIds = []; <span class="hljs-comment"><span class="hljs-comment">//   get  Api   JSON::decode    //   ID  Recommend,      (, , ) $mahout = Api::get('s=mahout&amp;order=value&amp;limit=' . (int)$limit . '&amp;user=' . (int)$userId); if(!empty($mahout['status']) &amp;&amp; $mahout['status'] == true) { $itemIds = $mahout['item-ids']; } if(count($itemIds) &lt; $limit) { //        (   , //   ,    ,     ..).  , //    . $limit = $limit - count($itemIds); $recommend = Api::get('s=recommend&amp;limit=' . (int)$limit . '&amp;user=' . (int)$userId); if(!empty($recommend['status']) &amp;&amp; $recommend['status'] == true) { $itemIds = array_merge($itemIds, $recommend['item-ids']); } } return static::find()-&gt;where(['id' =&gt; $itemIds, 'status' =&gt; static::STATUS_ACTIVE])-&gt;all(); } }</span></span></code> </pre><br>  And the controller will not be tricky either: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">frontend</span></span>\<span class="hljs-title"><span class="hljs-title">controllers</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Yii</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">web</span></span>\<span class="hljs-title"><span class="hljs-title">Controller</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">common</span></span>\<span class="hljs-title"><span class="hljs-title">models</span></span>\<span class="hljs-title"><span class="hljs-title">Recommend</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $_itemsLimit = <span class="hljs-number"><span class="hljs-number">6</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $_cacheTime = <span class="hljs-number"><span class="hljs-number">120</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionIndex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $userId = Yii::$app-&gt;request-&gt;cookies-&gt;getValue(<span class="hljs-string"><span class="hljs-string">'userId'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); $recommends = Recommend::getDb()-&gt;cache(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($db)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">use</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($userId)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Recommend::getItemsByUserId($userId, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_itemsLimit); }, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;_cacheTime); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;render(<span class="hljs-string"><span class="hljs-string">'index'</span></span>, [<span class="hljs-string"><span class="hljs-string">'recommends'</span></span> =&gt; $recommends]); } }</code> </pre><br>  And here is the view (view in MVC): <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">helpers</span></span>\<span class="hljs-title"><span class="hljs-title">Html</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;title = <span class="hljs-string"><span class="hljs-string">'Example'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;params[<span class="hljs-string"><span class="hljs-string">'breadcrumbs'</span></span>][] = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;title; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;h3&gt; :&lt;/h3&gt; &lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">row</span></span></span><span class="hljs-class">"&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">foreach</span></span></span><span class="hljs-class"> ($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">recommends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">as</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">recommend</span></span></span><span class="hljs-class">) </span></span>{ <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">col</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">md</span></span></span><span class="hljs-class">-2"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">href</span></span></span><span class="hljs-class">="&lt;?= $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">recommend</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">url</span></span></span><span class="hljs-class"> ?&gt;" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">target</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">_blank</span></span></span><span class="hljs-class">"&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">img</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">src</span></span></span><span class="hljs-class">="&lt;?= $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">recommend</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">image</span></span></span><span class="hljs-class"> ?&gt;" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">img</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">thumbnail</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">alt</span></span></span><span class="hljs-class">="&lt;?= </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Html</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">encode</span></span></span><span class="hljs-class">($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">recommend</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">title</span></span></span><span class="hljs-class">) ?&gt;"&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> } ?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre><br>  The prototype is ready.  It remains to transfer the necessary code to the real system.  I had to start the task on Monday, and on Saturday I decided to try Mahout on my home computer.  A bunch of books read is good, and practice is important too.  In a few minutes, I sketched a simple Java application that takes data from a CSV file and writes the result in JSON format. <br><br>  The interface asks us to implement only one method that will return JSON.  In this particular case, we need to provide a link to the CSV data file and a list of user identifiers that need to be recommended: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.api.service; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String datasetFile, List&lt;Integer&gt; userIds)</span></span></span></span>; }</code> </pre><br>  Next, create a factory: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.api.service; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ServiceFactory</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * Get Service * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> type * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IService </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getService</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String type)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(type.equalsIgnoreCase(<span class="hljs-string"><span class="hljs-string">"Mahout"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MahoutService(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } }</code> </pre><br>  For example, I will get a list of recommended objects for each user that appears in the list of identifiers: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.api.service; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.mahout.cf.taste.common.TasteException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.api.model.CustomUserRecommender; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.api.util.MahoutHelper; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.Gson; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.GsonBuilder; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MahoutService</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String datasetFile, List&lt;Integer&gt; userIds)</span></span></span><span class="hljs-function"> </span></span>{ Gson gson = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GsonBuilder().create(); MahoutHelper mahoutHelper = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MahoutHelper(); List&lt;CustomUserRecommender&gt; customUserRecommenders = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { customUserRecommenders = mahoutHelper.customUserRecommender(userIds, datasetFile); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException | TasteException e) { e.printStackTrace(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> gson.toJson(customUserRecommenders); } }</code> </pre><br>  And here is the ‚Äúsame‚Äù class: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.api.util; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.File; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.ArrayList; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.mahout.cf.taste.common.TasteException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.mahout.cf.taste.impl.model.file.FileDataModel; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.mahout.cf.taste.impl.neighborhood.ThresholdUserNeighborhood; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.mahout.cf.taste.impl.recommender.GenericUserBasedRecommender; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.mahout.cf.taste.impl.similarity.PearsonCorrelationSimilarity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.mahout.cf.taste.model.DataModel; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.mahout.cf.taste.neighborhood.UserNeighborhood; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.mahout.cf.taste.recommender.UserBasedRecommender; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.mahout.cf.taste.similarity.UserSimilarity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.api.model.CustomUserRecommender; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MahoutHelper</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> List&lt;Integer&gt; userIds * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> String datasetFile * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> List&lt;CustomUserRecommender&gt; * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@throws</span></span></span><span class="hljs-comment"> IOException * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@throws</span></span></span><span class="hljs-comment"> TasteException */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;CustomUserRecommender&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">customUserRecommender</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Integer&gt; userIds, String datasetFile)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException, TasteException </span></span>{ List&lt;CustomUserRecommender&gt; customUserRecommenders = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;CustomUserRecommender&gt;(); DataModel datamodel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileDataModel(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(datasetFile)); UserSimilarity usersimilarity = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PearsonCorrelationSimilarity(datamodel); UserNeighborhood userneighborhood = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ThresholdUserNeighborhood(<span class="hljs-number"><span class="hljs-number">0.1</span></span>, usersimilarity, datamodel); UserBasedRecommender recommender = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GenericUserBasedRecommender(datamodel, userneighborhood, usersimilarity); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Integer userId : userIds) { customUserRecommenders.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CustomUserRecommender(userId, recommender.recommend(userId, <span class="hljs-number"><span class="hljs-number">10</span></span>))); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> customUserRecommenders; } }</code> </pre><br>  In a real project, the Mahout library was added to the existing system (a turnkey solution).  As I mentioned, an API was chosen as the data transfer method.  As practice has shown, adding recommendations to key pages (for example, product card) influences conversion very well.  Not infrequently, a personal rating of recommended objects is sent by e-mail, for example, once a week. <br><br>  If possible, try on each page to make a small form of user polling about the interestingness and usefulness of this or that product for him.  At a minimum, two characters can be made (‚Äú+‚Äù and ‚Äú-‚Äù).  A dichotomous classification is usually expressed in numerical estimates (preferably 2 and 10, so that the difference is more obvious).  Try to motivate people to leave ratings - the more ratings, the easier it is to give an accurate recommendation.  You can take into account orders of goods (once bought, it means highly appreciated).  Just be very careful to avoid all kinds of speculation.  Please constantly check the data obtained by a series of experiments (A / B tests). <br><br>  I do not want to remind the obvious things, but the opinion of most people is not always objectively correct.  For example, there can be a very beautiful girl of 25 years old who worries because of the complexes that she had in her childhood.  Some guys may strongly believe in the effectiveness of NLP and hypnosis as a way of seducing girls.  Even a good old woman can smear the wound of her grandson with an alcohol solution of brilliant green, although the use of miramistin will be clearly more reasonable.  The list can be continued for a very long time.  Ideally, you should add manual filtering of obviously poor recommendations (if we are talking about evaluating other sites) or tighten quality control (if objects on your site are evaluated). </div><p>Source: <a href="https://habr.com/ru/post/267963/">https://habr.com/ru/post/267963/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267953/index.html">About UEFI security, part five</a></li>
<li><a href="../267955/index.html">Javascript and nginx = nginScript, and http2 to boot</a></li>
<li><a href="../267957/index.html">Installing the Intel RealSense SDK on Macs</a></li>
<li><a href="../267959/index.html">Underground carders market. Translation of the book "KingPIN". Chapter 14. ‚ÄúThe Raid‚Äù</a></li>
<li><a href="../267961/index.html">Hawala: The algorithm of the underground banking system, preserved from ancient times</a></li>
<li><a href="../267965/index.html">Once again about hash collisions in switches</a></li>
<li><a href="../267967/index.html">Watson Health continues to evolve</a></li>
<li><a href="../267969/index.html">In the wake of the AzureCon conference - the main announcements</a></li>
<li><a href="../267971/index.html">Data Center for Health Protection</a></li>
<li><a href="../267973/index.html">Blog IT park. How is the state data center?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>