<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>About some features of Windows 8 and WinRT (Metro) applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It will be a new type of applications that are designed for the new operating system Windows 8 and the new Start menu. 

  

 I want to immediately no...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>About some features of Windows 8 and WinRT (Metro) applications</h1><div class="post__text post__text-html js-mediator-article">  It will be a new type of applications that are designed for the new operating system Windows 8 and the new Start menu. <br><br> <a href="http://habrastorage.com/%3Fv%3Dp1.png"><img src="http://habrastorage.com/thumbs/p1.png"></a> <br><br>  I want to immediately note that despite everything written below - I liked the technology, but the traditional approach of Microsoft - ‚Äúto do everything well, but something most often used - bad‚Äù - is observed in all its glory. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br>  If you programmed under WPF or Silverlight, the creation of WinRT (Metro) applications - in terms of programming the interface - will not cause you any difficulties.  Moreover, individual new controls make the design of interfaces much easier, but it‚Äôs better to read some <a href="http://www.msswit.in.ua/Windows8_A5.pdf">useful book</a> . <br><br>  All the pitfalls - in the other. <br><br>  Firstly, you can safely forget about the full access to any folders and files on the computer to which the user with whose rights your program is running will get.  Yes, even if it is an administrator.  And yes!  Another surprise - UAC for metro applications also does not work.  In the sense that it is now only for ordinary (old) applications. <br><br>  The second.  It is still possible to work with files on a computer, but not without difficulties.  In particular, your application may have access to the following locations: <br><ol><li>  Libraries: Documents, Videos, Images, Music </li><li>  Folder ‚ÄúDownloads‚Äù user </li><li>  Application folders in user profile </li><li>  The folder where your application was installed </li><li>  Folder / file shared with you </li></ol><br><br>  So let's start point by point. <br><br><h5>  1. Libraries. </h5><br><br>  Remember this strange thing, which appeared in Vista, but which almost nobody used?  <i>(Well, at least I definitely didn‚Äôt use it - from Far'a this is somehow quite inconvenient)</i> <br><br>  Rejoice!  Now you love will have to use them. <br><br>  Standard applications Music, Video, Photos work only with libraries.  Although, of course, you can open any file there, but if you do it from the applications themselves, it is inconvenient, and if you open it through a conductor, well, this is a conductor, it is in itself inconvenient. <br><br> <a href="http://habrastorage.com/%3Fv%3Dp2.png"><img src="http://habrastorage.com/thumbs/p2.png"></a> <br><br>  However, not everything is so simple - your application needs to explicitly indicate which particular libraries it needs.  Moreover, it will receive full and unlimited access and can add / delete / move any files and folders, as well as read and write to any file. <br><br> <a href="http://habrastorage.com/%3Fv%3Dp3.png"><img src="http://habrastorage.com/thumbs/p3.png"></a> <br><br>  <i>Note: I did not find the information whether it is possible to access the library that the user himself created (that is, not one of the above).</i>  <i>At the moment, everything looks like that such access cannot be obtained without the participation of the user.</i> <br><br>  The ‚ÄúDocuments‚Äù library stands apart, which you won't get access to just like that - you must first specify the file types (extensions) that our application will work with: <br><br> <a href="http://habrastorage.com/%3Fv%3Dp4.png"><img src="http://habrastorage.com/thumbs/p4.png"></a> <br><br>  Where the library folders are located you don‚Äôt need to know - you can access them through the <b>KnownFolders</b> class <br><br><h5>  2. Folder ‚ÄúDownloads‚Äù user </h5><br><br>  Well, everything is simple here - write access only.  You can create a file without user intervention and write something there. <br><br><h5>  3. Application folders in user profile </h5><br><br>  We have two folders: Local and Roaming.  One lies on the current computer, the other is moved if the user profile is stored centrally, for example, on a domain controller.  In general, everything is as before (see the folder C: \ Users \ ‚Äùuser‚Äù \ AppData \ subfolders Local and Roaming), only now only your application has access to these folders. <br><br><h5>  4. The folder where your application was installed </h5><br><br>  Your application has full access to any file / folder and can do whatever it wants with them. <br><br><h5>  5. Folder / file that the user has given you access to. </h5><br><br>  And now, in fact, the most interesting. <br><br>  The only way to get to a folder / file that is not in the places listed above is only through the use of the <b>FolderPicker</b> and <b>FilePicker classes</b> . <br><br>  This is done like this: <br><pre><code class="cs hljs">FolderPicker fp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FolderPicker(); fp.ViewMode = PickerViewMode.Thumbnail; fp.FileTypeFilter.Add(<span class="hljs-string"><span class="hljs-string">".jpg"</span></span>); StorageFolder folder = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fp.PickSingleFolderAsync(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (folder == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> files = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> folder.GetFilesAsync(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> file <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> files) ‚Ä¶;</code> </pre> <br><br>  After that, the user will see this window: <br><br> <a href="http://habrastorage.com/%3Fv%3Dp5.png"><img src="http://habrastorage.com/thumbs/p5.png"></a> <br><br>  And you get full access to the selected user. <br><br>  By the way, noticed <b>async / await</b> ? <br>  Get used to it - there are no more synchronous functions.  Well, at least those that are most often required.  For example, if earlier it was possible to read data from a file in one line of the form: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] lines = File.ReadAllLines(<span class="hljs-string"><span class="hljs-string">"filename.txt"</span></span>);</code> </pre> <br>  Now it will be something like this: <br><pre> <code class="cs hljs">IList&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt; lines = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> ReadFileAsync(<span class="hljs-string"><span class="hljs-string">"filename.txt"</span></span>);</code> </pre> <br><br>  By the way, the surprise is no more MessageBox :) Now this again will be something like: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">await</span></span> ShowMessage(‚Äú‚Äù);</code> </pre><br><br>  And here we come across another problem: await can only be used in functions marked as async.  Naturally, not every function can be so marked. <br>  In this case, it helps to bring all the necessary code into a separate function, and then wait for its completion in the right place: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyAsyncFunction</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> ‚Ä¶; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MySyncFunction</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> res=MyAsyncFunction(); res.Wait(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(res.Result==...) ...; }</code> </pre><br><br>  However, such code sometimes hangs, but does not fall.  Therefore, debugging it is a pleasure. <br><br>  Conclusion <br><br>  As I wrote above - in general, the technology is interesting, however, if your application wants to actively work with files on disks, and even secret from the user, then this is not your choice.  But to make an application that will download and draw cats from the Internet, you can literally without touching the keyboard </div><p>Source: <a href="https://habr.com/ru/post/151619/">https://habr.com/ru/post/151619/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../151610/index.html">IT audit</a></li>
<li><a href="../151612/index.html">DNS server on the local interface or a simple path to love between programmers and administrators</a></li>
<li><a href="../151614/index.html">Russian Code Cup 2012 Programming Championship: how it was</a></li>
<li><a href="../151615/index.html">Publish applications in the Windows Store. Part One - Register in the Windows Store</a></li>
<li><a href="../151616/index.html">How I picked up the firmware of the F500 DVR</a></li>
<li><a href="../151621/index.html">Gray Hat Python - DLL and Code Injection</a></li>
<li><a href="../151622/index.html">Asus PadFone video review</a></li>
<li><a href="../151623/index.html">The dream program of a novice pit driver</a></li>
<li><a href="../151624/index.html">Human colony on Mars. Detailed study of the Mars One project</a></li>
<li><a href="../151626/index.html">Design Patterns (Head First Design Patterns)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>