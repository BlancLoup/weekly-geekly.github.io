<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Windows.Git.Cygwin.SSH.Gitolite and User Guide</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1. What is this article for? 
 The desire to get Git features on the Windows platform materialized the desire to tinker with different configuration s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Windows.Git.Cygwin.SSH.Gitolite and User Guide</h1><div class="post__text post__text-html js-mediator-article"><h4>  1. What is this article for? </h4><br>  The desire to get Git features on the Windows platform materialized the desire to tinker with different configuration schemes. <br><br><h4>  2. Awareness </h4><br>  You need to realize that you have to use the program Cygwin, SSH, GitExtenstions, Git, Gitolite <br><br>  <b>Cygwin</b> is a program that emulates the Linux environment. It has its own black window that looks and works like a Linux terminal window. <br>  <b>MsysGit</b> is a program for emulating the git environment, but without an ssh server, so we will not use repositories on the server.  We use only for repository clients. <br>  <b>SSH</b> is a program for using ssh connections from ssh clients and is available for all operating systems. <br>  <b>SSH server</b> is a program that accepts connections from ssh clients. <br>  <b>Git</b> is a set of programs, including git itself, for working with file repositories. <br>  <b>Gitolite</b> is a program that wraps git and implements repository management functions: managing users, accessing them, and so on. <br>  <b>GitExtensions</b> is a windows program, wrapping functionality like git, as well as the accompanying set of programs in a GUI, which also integrates into the Visual Studio 05/08/10 development environment. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The corporate will have to allocate resources for hosting the SSH service, disk space for hosting repositories. <br>  The person who will serve the SSH server, access to the repository. <br>  Teach users to use analog functions to interact with their old version control system through GitExtensions. <br>  Offer them some schemes of work that Git allows to achieve. <br><br>  UPD: 08/05/2011 <br>  UPD: 01/30/2012 <br><a name="habracut"></a><br><h4>  3. Go to the result: Hosting for components </h4><br>  Git, SSH server, Gitolite will be hosted in Cygwin. <br>  go to <a href="">http://cygwin.com/setup.exe</a> <br>  Run the installer. <br>  Add a mirror <a href="http://cygwin.vc.ukrtel.net/">http://cygwin.vc.ukrtel.net/</a> <br>  <a href="">matway.org</a> - became unavailable.  Updated January 30, 2012. <br>  List of mirrors close to Russia: <a href="http://cygwin.com/mirrors.html">cygwin.com/mirrors.html</a> <br>  Mark the following components: <br>  Net |  openssh <br>  Devel |  git <br>  Devel |  git-completion <br>  Devel |  git-gui <br>  Devel |  gitk <br>  Editors |  vim <br>  Click Next and the installation will offer to add the necessary packages with which we agree and click Next. <br>  Check Start Menu / Cygwin / Cygwin Terminal: <br><img src="https://habrastorage.org/getpro/habr/post_images/b50/b73/62d/b50b7362d74e53543e074f175b024306.png" alt="image"><br><br>  Login Alexei is my login in windows, base machine name.  It all fits. <br><br><h4>  4. Go to the result: Setting up an SSH server </h4><br>  We start Cygwin Terminal. <br>  We start the SSH server configuration using the ssh-host-config command. <br><img src="https://habrastorage.org/getpro/habr/post_images/d99/64e/9df/d9964e9dfd032bc80c1299a7c2081063.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c4/aa2/901/1c4aa290139c2c0a3c8f83ba290db436.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/307/e4d/ce8/307e4dce8d3a2e001e04db45fd751b9c.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/60c/d33/e63/60cd33e637a803a46a6d521fa030a8bf.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/928/7d7/90f/9287d790f9128435fb898af3b01b7c83.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a69/95e/e0f/a6995ee0f63325d0b0ea08eba6396dfd.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/083/4b6/c38/0834b6c38a612eb7218a156b492cf386.png" alt="image"><br><br>  Go to / etc / sshd-config and connect the authorization without a password: <br>  Uncomment these lines: <br>  PubkeyAuthentication yes <br>  AuthorizedKeysFile .ssh / authorized_keys <br><br>  For all users who will work with Git, you need to configure the entrance to the SSH server, through the user git (or other name) TV mode without a password. <br><br>  A bit of theory about the operation of the SSH server. <br>  When connecting from an SSH client via the git @ localhost connection string, the first thing that happens is <br>  search for the private part of the key in the .ssh directory; if in CYGWIN, then ~ / .ssh /; if windows, then c: /users/yourname/.ssh <br>  Next, in the authorized_keys file in the git profile on the localhost server, you search for text that has a marker equal to your current username.  If it is located, then you get a terminal into which the git user profile is loaded. <br>  There are clients in cygwin, in gitbash, there are such as putty.  We are interested in the ssh client, which is in cygwin. <br>  It is called by the ssh command with git @ localhost arguments, where git is the name of the user whose profile we want to log in via ssh and localhost (this is the address of the SSH server). <br>  Actually, now we will make it work as it was said above. <br><br><ol><li>  Enter another user named git.  This name will be for service operations. <br>  Open Computer managment -&gt; Local User and Groups -&gt; Users-&gt; PCM -&gt; New User -&gt; <br>  Git name, password 123456, check ‚ÄúPassword never expires‚Äù -&gt; OK <br>  Open Cygwin Bash Shell, enter the command mkpasswd -l -u git &gt;&gt; / etc / passwd <br>  We animate the user profile with the command: <br><img src="https://habrastorage.org/getpro/habr/post_images/549/8dd/6f8/5498dd6f81b2e30d5d6d38e3397da39b.png" alt="image"><br>  Exit the profile by pressing Ctrl + D or using the exit command. <br></li><li>  We generate a key for our login.  In my case for Alexei login. <br>  The ssh-keygen -t rsa command will create a key in a folder that will consist of two files <br>  id_rsa (private part, stored at you) and id_rsa.pub (public part of the key). <br>  then we add the public part of the key to the authorized_keys file in the git user profile <br>  via the ssh-copy-id -i git @ localhost command. <br><img src="https://habrastorage.org/getpro/habr/post_images/003/1a1/522/0031a15220dd37f8ff671955fa6d90c6.png" alt="image"><br>  We start the SSH command server: <br><img src="https://habrastorage.org/getpro/habr/post_images/18b/41f/f93/18b41ff93705d08d5149d479eaca9821.png" alt="image"><br>  Copy the public part of the key to the git profile: <br><img src="https://habrastorage.org/getpro/habr/post_images/af1/ae3/b8c/af1ae3b8c9b8f7cf8178498d679f53bd.png" alt="image"><br>  Check whether it turned out to configure as we need.  Run the ssh git @ localhost command and wait for the terminal prompt <br>  from git <br><img src="https://habrastorage.org/getpro/habr/post_images/348/b9d/d7c/348b9dd7cc189297790af66f66632914.png" alt="image"><br>  Everything turned out to be customized. <br>  If it does not work, go to paragraph 10. <br></li></ol><br><h4>  5. Go to the result: Setting up Gitolite </h4><br><ul><li> Now you need to install gitolite, it will also install and configure repositories for storing files.  Go to / tmp and download the gitolite program using git: <br><img src="https://habrastorage.org/getpro/habr/post_images/698/0d5/ce2/6980d5ce2d25173e9797f741ce53c1d3.png" alt="image"><br>  Then go to / gitolite / src / and run ./gl-easy-install with the following keys <br>  git localhost Alexei.  git is the login where gitolite will be set, localhost address of the SSH server, Alexei username at the same time and the name of the private and public part of the key. <br><img src="https://habrastorage.org/getpro/habr/post_images/947/257/3ff/9472573ff3a96b1af5c5e91b0d6fbb35.png" alt="image"><br>  When asked to enter a password, then just press Enter, since the password is not needed anywhere. <br></li><li>  Next we go to the next installation screen. <br><img src="https://habrastorage.org/getpro/habr/post_images/900/123/584/900123584ba0f576b41407213d5e60ba.png" alt="image"><br>  This window shows the open .gitolite.rc file in the vim editor. <br>  It is necessary to pass the cursor to the place of text insertion, <b>press I</b> , enter text <br>  <b>$ ENV {PATH} = "/ usr / local / bin: / usr / bin: / bin";</b> <br>  The text must be entered without errors, otherwise you will get confused in this editor. <br>  For simplicity, you can copy the text, then move the cursor to the right place, press I, then click on <br>  the black window icon (terminal, command line, etc.) select edit-&gt; paste and paste the line. <br>  Press after entering ESC, press shift +:, type wq, press Enter. <br><img src="https://habrastorage.org/getpro/habr/post_images/975/591/2df/9755912dfc58a2b44d0c4ba5fb621e83.png" alt="image"><br>  This line will allow gitolite to call programs from the cygwin environment, which have similar names with windows programs.  For example, the find command is both there and there.  And if you do not specify, gitolite will work with errors, and even the installation program will work with errors, since the find from windows will be used. <br><br>  Press Enter several times and get the following image: <br><img src="https://habrastorage.org/getpro/habr/post_images/060/c8b/a06/060c8ba06402ff8a9ef600267019e208.png" alt="image"><br><br></li></ul><br><h4>  6. Go to the result: Configure GitExtensions </h4><br><ul><li>  Now let's move on to installing GitExtensions at <a href="http://code.google.com/p/gitextensions/">http://code.google.com/p/gitextensions/</a> <br>  We put it with msysgit, gitextensions will use it, after setup. <br>  Also note openssh in favor of putty. <br>  Setting up a user and email for GitExtensions will not be considered. <br>  Everything is going smoothly there. </li></ul><br><h4>  7. Go to the result: setting the user </h4><br>  Now you need to configure the windows profile of the current user. <br><ol><li>  Ensure that the Alexei file is in the .ssh / folder of the current profile c: /users/Alexei/.ssh/ </li><li>  Make sure the config file is in the same folder. </li><li>  in order to do this, you need to take them from c: \ cygwin \ home \ yourname \ .ssh \ config and yourname <br>  and copy to c: \ users \ yourname \ .ssh \ </li><li>  This is an option for the case when part of the work has already been done for us, in this case the gitolite program. <br>  at the beginning, it generated for us your name and your .pub key files.  I sent the pub version to the git profile's authrozied_keys file. <br>  and also added settings to this key in authorized_keys. <br>  Let's see this modified authorized_keys <br><img src="https://habrastorage.org/getpro/habr/post_images/909/6cd/4c8/9096cd4c8ef7afc04168b8eb70dee771.png" alt="image"></li><li>  Explanation of information. <br>  The private parts of the keys are placed in blocks marked at the end: for which user and from what address. <br>  The first one is from my first key id_rsa.pub. <br>  The second privatka is from the key Alexei.pub, which has already been done by gitolite itself;  As you can see, gitolite adds extended information to the key, which ensures the entire interaction of the system. </li></ol><br><ul><li>  To set up a new user, he needs to install for ease: gitextensions with msysgit and openssh enabled. <br>  Next you need to configure the user key to log in to the git profile on localhost. <br>  To do this, open start menu-&gt; git -&gt; git bash and enter ssh-keygen -t rsa, we get two key files. <br>  Give the pub file to the person who serves git. </li></ul><br><h4>  8. Go to the result: Algorithm work for the admin repository </h4><br><ul><li>  This person should take the pub file, put it in the folder of the local repository gitolite-admin \ keydir. <br>  This folder will already be created in the user profile where the installation was launched from. <br>  Register the file name in gitolite.conf and send via git push to the repository. <br>  Then gitolite will create settings in its gitolite.conf.pm, authorized_keys, etc. files in the git user profile. <br>  We can assume that the user is set up correctly in the system and from under it you can work in windows. <br>  To work from cygwin, you need to copy all the files relative to /home/user/.ssh/ </li></ul><br><h4>  9. We look at the result </h4><br><ul><li>  To see, you have to try. <br>  Run GitExtensions. <br>  Configuring it on the Git tab should be as follows: <br><img src="https://habrastorage.org/getpro/habr/post_images/d86/2b8/0da/d862b80da4a9c3b2cb8dcc29b3988102.png" alt="image"><br>  This folder appears if you install mSysGit together with GitExtensions (you need to install it for each client). <br>  We select clone repository, in the address we put git @ gitolite: testing.git, any destination folder. <br>  click clone and get an empty testing repository. <br><img src="https://habrastorage.org/getpro/habr/post_images/28a/62b/d5f/28a62bd5f23c4d94376eff6fb44b4d01.png" alt="image"><br>  and you can get this window: <br><img src="https://habrastorage.org/getpro/habr/post_images/354/72e/a08/35472ea08a6c7808a49607b4f8c151d2.png" alt="image"><br>  Which means a security violation in an ssh connection. <br>  In this case, our SSH server is on our computer, so to quickly solve this problem, delete the file c: \ users \ Alexei \ .ssh \ known_hosts, try again to make Clone. <br>  The following window will appear: <br><img src="http://img84.imageshack.us/img84/618/sshkh.png" alt="image"><br>  Click yes and Enter. <br>  The following window will appear: <br><img src="https://habrastorage.org/getpro/habr/post_images/bf4/dca/145/bf4dca1455dd54db2776957190028cd8.png" alt="image"><br>  The information in it means that the whole chain is working. <br>  <b>Open the d: \ test.rep folder and see that there is a hidden .git folder, which means success.</b> <br></li><li>  Why in the address git @ gitolite, gitolite, but not localhost?  because there is a config file in which the setting is written for the word gitolite.  If the ssh client sees that we have specified a word in the server address that is similar to the one in the config, then it applies the settings from this file.  In principle, you can not use the config, then the private key will be called by default id_rsa and server address localhost (or ip address). And it will look like git @ localhost.  But you can't do that.  Since gitolite will not understand who is who.  Therefore, all instead of id_rsa is a file with a private part, and its name is different from all others. <br>  Look at the file: <br><img src="https://habrastorage.org/getpro/habr/post_images/b1e/959/012/b1e9590121565f32fa40fed272bbbad2.png" alt="image"><br></li></ul><br><h4>  10. We look at the errors </h4><br><ol><li>  <b>SSH and login with password</b> <br>  All because of the broken authorized_keys. <br>  or ssh server settings, which include the use of the authorized_keys file. <br>  if we are at the git user setup stage, then we use ssh-copy id, which saves the pub version of the key and edits the authorized_keys.  If you have already installed the entire ecosystem, then: <br>  /home/git/.gitolite/src/gl-setup-authkeys -batch /home/git/.gitolite/keydir </li><li> <b>An address of the form git @ gitolite is not accepted: testing.git</b> <br> <code>/home/git/.gitolite/src/gl-setup-authkeys -batch /home/git/.gitolite/keydir</code> <br>  All because of the broken authorized_keys.  Generate it with this command again. </li><li>  <b>Constantly lost input without a password from cygwin bash shell</b> <br> <code>/home/git/.gitolite/src/gl-setup-authkeys -batch /home/git/.gitolite/keydir</code> <br>  All because of the broken authorized_keys, generate it with the help of this command again. <br>  Also, you may not have installed the following entry in gitolite.rc: <br> <code>$ENV{PATH}="/usr/local/bin:/usr/bin:/bin";</code> <br>  Put it in the means available to you. </li><li>  <b>Synchronize users between Windows and Cygwin</b> <br>  mkpasswd -l&gt; / etc / passwd <br>  It is necessary if you want to reassign the logins for the ssh server and the service login for the gitolite system. </li><li>  <b>Remove SSH server</b> <br> <code>cygrunsrv -R sshd</code> <br>  This will remove only the cygserver ssh service from windows, but the login will remain. <br>  To do this, you still need to clear / etc / ssh * of files. <br>  Remove the cygserver login from windows and synchronize / etc / passwd with the command <br> <code>mkpasswd -l &gt;/etc/passwd</code> </li> </ol><br><h4>  A little note about the big Nyance </h4><br><ul><li>  The mkpasswd command writes the path to the login directory to the / etc / passwd file. <br>  If the default cygwin \ home folder doesn‚Äôt fit, you can specify the c: \ users \ folder for Windows7 or another with the -p "$ (cygpath -H)" switch when you create a git user. <br> <code>mkpasswd -l -p "$(cygpath -H)" &gt; /etc/passwd</code> <br> </li><li>  Also in this article, the installation scheme is used, when the ssh server and the user are on the same computer. Which leads to another strategy.  By default, your Cygwin username looks into the cygwin \ home \% username% folder, in the article this is bypassed using msysgit, which has your username looking into the c: \ users \% username% folder (for win7), so your copies are made keys from cygwin \ home \% username% in c: \ users \% username% (p. 7.3).  If you send the home folder to Cygwin for your login on c: \ users \% username%, then the need for msysgit will disappear. <br>  With finishes completed. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/125152/">https://habr.com/ru/post/125152/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../125145/index.html">Innovative laboratory comments on the information that officials will be taken from iPad</a></li>
<li><a href="../125147/index.html">Asterisk + UniMRCP + VoiceNavigator. Synthesis and speech recognition in Asterisk. Part 2</a></li>
<li><a href="../125148/index.html">KnockoutJS: Ajax grid view from scratch to 40 lines</a></li>
<li><a href="../125150/index.html">Fast Automated Installation of Ruby on Rails on IIS 7</a></li>
<li><a href="../125151/index.html">Java SE 7 Released</a></li>
<li><a href="../125153/index.html">Symform offers to exchange 150gb local disk for 100gb cloud storage</a></li>
<li><a href="../125154/index.html">Microbash</a></li>
<li><a href="../125155/index.html">The publication on the wall Vkontakte means php</a></li>
<li><a href="../125156/index.html">Hackers have added a virtual Russian keyboard to the HP TouchPad</a></li>
<li><a href="../125161/index.html">Orfo Switcher History</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>