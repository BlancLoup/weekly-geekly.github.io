<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Darudar - a cloud as a gift from Microsoft</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Daudar is a project known in the vastness of Runet, which has become a link between people who want to donate something, but who do not know who, and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Darudar - a cloud as a gift from Microsoft</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <em><a href="https://habrahabr.ru/company/darudar">Daudar</a> is a <a href="http://darudar.ru/">project</a> known in the vastness of Runet, which has become a link between people who want to donate something, but who do not know who, and those who may want it.</em>  <em>On the site you can find anything you want - from household and not-so things to the most real <a href="http://darudar.org/search/%3Fq%3D%25D0%25BA%25D0%25BE%25D1%2582%2B%25D0%25B2%2B%25D0%25BC%25D0%25B5%25D1%2588%25D0%25BA%25D0%25B5%26rel%3D1%26quick%3D1%26x%3D0%26y%3D0">cats in bags</a> .</em>  <em>About how the service works, where more than 3 million gifts have already been presented, says one of the founders of the service, Anton <a href="https://habrahabr.ru/users/brutto/" class="user_link">brutto</a> Karakulov.</em> </blockquote><br><br><img src="https://habrastorage.org/files/a28/341/cf1/a28341cf15f7496981bddad622676392.png"><br>  Daudar is a real high-load project.  Hosted in the cloud and using the full Linux stack, it can withstand ~ 2.5 thousand gifts and ~ 1.5 thousand thanks, ~ 20 thousand comments, ~ 40 thousand notifications and ~ 4.5 thousand files per day.  Details under the cut. <br><br><a name="habracut"></a><br>  A modern person no longer needs to be convinced of the advantages of cloud platforms that are used as the main infrastructure for creating a web service, a mobile application, and finally - an ‚Äúordinary‚Äù web site.  To fix the facts, it would not be superfluous to repeat the main advantages of cloud hosting services: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      - A wide range of operating systems, PL, frameworks, tools, databases and devices. <br>  - Extensive integration options: Linux containers in Docker;  on a par with <br>  creating JavaScript, Python, .NET, PHP, Java and Node.JS applications <br>  - And, of course, the backend for iOS, Android and Windows applications <br><br>  The lack of need to develop new technologies or solutions / tools, coupled with real-time billing and scalable ‚Äúon-demand‚Äù iron infrastructure is the cornerstone on which all modern clouds stand, and Microsoft Azure is, of course, no exception. <br><br>  Perhaps another important advantage of cloud platforms in general, and Microsoft Azure in particular, is the ability to transfer an existing project and get all the benefits already mentioned.  Actually, now ‚Äúto transport‚Äù your own back-end from the data center, in which you may rent individual racks, to the cloud is not difficult: hybrid databases, storage, secure connection methods - all this is out of the box.  And in the case of Microsoft, there is also the <a href="https://habrahabr.ru/company/microsoft/blog/277777/">Azure Stack</a> , which allows you to bring a model of development and rollout (deployment) of Azure applications in any data center or data center. <br><br>  Finally, paying only for what you use, and not for the ‚Äúfact of availability‚Äù, has become such an integral value for developers and owners of virtual products that no one is even ready to consider the reverse model seriously. <br><br>  <b>About why?</b> <br><br>  We, like many others, received a grant from Microsoft for the startup support program.  In our opinion, this is a fat plus, especially for beginner projects or projects that would only like to try the cloud.  Although, of course, we were lucky to learn about the benefits of Azure in one of the most difficult moments (our previous site-hoster abruptly ceased operations, and we ‚Äúsaved‚Äù our own infrastructure).  Our previous hosters have done their time nicely, and I can‚Äôt say anything bad about them, but due to the constant lack of a full-fledged system administrator (for which we have no money for salaries) - the cloud has noticeably simplified the moments related to the administration of the infrastructure. <br><br>  <b>Pro architecture and technology</b> <br><br>  Daroudar has a classic nix-stack: nginx, php, mysql, memcached, sphinx. <br><br>  Meets all nginx, then the request goes to the php-backend, which already interacts with all the other internal and external services of the project. <br><br>  Currently, Azure uses Cloud Services and Ubuntu virtual machines within the same network.  For each internal service, an image is created that can be used for emergency <br>  restoration / replacement and it is planned to use also for the possibility of further horizontal scaling of the project services with the help of convenient tools of the Azure Available Sets and Load Balancing set. <br><br>  The plans are moving the media storage to Azure Blob Storage, as well as using Azure Queue (we are testing). <br><br><img src="https://habrastorage.org/files/9ff/4a8/705/9ff4a8705f2942ae86590a3d346920af.png"><br><br>  <b>About stereotypes</b> <br><br>  ‚ÄúAzure is MS, and MS is Windows‚Äù - this bundle also worked in my head.  And that was the first thing I checked when I got access to the Azure control panel. <br><br>  Everything turned out wrong.  Azure was loyal to Nix-systems, and we use them. <br><br>  We have never used Win-servers at Daroudara and we do not use them at all.  I know the virtualization technology only by hearsay ‚Äî mostly on Windows I use VMware for this purpose.  In Azure, there is, as far as I know, the ability to deploy a wine server and connect to it remotely, such as a ‚Äúremote desktop‚Äù, but I personally did not work with this and did not even try (note: you can connect using a visual interface). <br><br>  If we talk separately about the virtualization of nix-machines, then I can‚Äôt say anything about the technology itself - I haven‚Äôt dug so deeply, but there are a number of ‚Äúspecific‚Äù platform features. <br><br>  <b>Minuses:</b> <br><br>  - When resizing (reconfiguring) a VM (virtual machine), it fully reboots. <br>  - The VM system disk is extremely slow and must therefore be used carefully or not at all. <br>  - There is a large additional disk, which is present in every machine and at a good speed, but it is considered ‚Äútemporary‚Äù and can be reset when reset, therefore it is not recommended to use it for sensitive data (by the way, now Azure has started to write about it everywhere and not only in the documentation!). <br>  - Not obvious from the first time to understand the structure of Cloud Services. <br><br>  <b>Pros:</b> <br><br>  - You can create, and then use your own images (convenient for clustering and scaling). <br>  - Any disks can be added independently, it is possible even to make an image with the necessary number of disks which will then "rise" and "cling" independently. <br>  - Availability of console utility for managing infrastructure (convenient for automating work on / off, adding / deleting). <br>  - Ability to create a VPN. <br>  - Availability of tools for managing traffic / load (Azure Available Sets, Load Balancing Sets, DNS Traffic Manager). <br><br>  Perhaps, certain things have long been with Amazon or Google, but I have stopped following them for a while, and at Azure we all use it and stay with good impressions. <br><br>  <b>Pro cost</b> <br><br>  Azure costs us now at ~ 140 thousand rubles a month.  This is enough for us at 90%, since for peak loads it is still not enough. <br><br>  I think the final cost for the full service of the current state of affairs will be about 160-180 thousand. About the load on the ‚ÄúDaroudar‚Äù I will answer as follows: <br><br>  ~ 2.5 thousand gifts and ~ 1.5 thousand thanks a day <br>  ~ 20 thousand comments per day <br>  ~ 40 thousand notifications per day <br>  ~ 4.5 thousand files (images) per day <br><br>  As for the choice for companies, first we need to determine our goals and scope. <br><br>  It‚Äôs not worth trying because it‚Äôs fashionable and ‚Äúeverything is in the clouds now‚Äù.  For us (Durudar), the key to choosing to go to the cloud or remain on collocation was the absence of a sysadmin in the state, and therefore, in fact, for us the cost of cloud hosting is the cost of infrastructure + basic administrator. <br><br>  You can talk a lot about whether it is worth it or not at all, for example, like this: <br><br>  - It is good for projects that just happened and that only work out their model; <br>  - Good for projects that expect to live only on investments (meaning that in the absence of investments the project closes); <br>  - Good for projects that can earn independently and they are interested in growth and development. <br><br>  <b>About plans</b> <br><br>  All that is interesting to us and can be planned for implementation, one way or another, leads to vendor lock, demanding, respectively, a careful implementation of the project. <br><br>  1. For example, queues are very necessary.  We are thinking about implementation. <br>  2. It is necessary to resolve the issue with the media storage.  As a result, you will need to go to a full cloud solution (and this is 100% vendor lock). <br>  3. A very interesting thing, which we also planned and which was mentioned above - traffic control / load (Azure Available Sets, Load Balancing Sets, DNS Traffic Manager). <br><br>  <b>About best practices</b> <br><br>  The problem is in a very slow system disk for Linux instances, so either we don‚Äôt use it at all or only for some kind of tasks where it is not critical. <br><br>  Although the local disk looks attractive in terms of size and speed, and even despite the warning that data may be lost from it, it can save data when restarting instances (!), But storing critical data there is still an error.  For example, if the instance is vertically scaled, it will reset to any value. <br><br>  It happens that a VM can hang so that nothing will help it except a reboot.  And sometimes even she may not help.  Therefore, the allocation of each internal service in a separate instance or group on the order facilitates the management of infrastructure.  In this connection, even thoughts became ‚Äúcloudy‚Äù: it‚Äôs better to reboot than to fix.  If the reboot is not fixed, it is better to re-create. <br><br>  <b>Summarizing</b> <br><br>  After the pain and suffering in the development of the platform (there were such moments) now I feel calm for the future of the project infrastructure.  Appeared predictability, which allows you to fully engage in the planning and development of the project.  And what else is very valuable: the opportunity to manage the infrastructure has appeared, without having deep knowledge in the field of administration, and to connect additional people to the infrastructure maintenance. </div><p>Source: <a href="https://habr.com/ru/post/281467/">https://habr.com/ru/post/281467/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../281455/index.html">The use of machine learning methods in the task of assessing the actions of a pilot at the landing stage</a></li>
<li><a href="../281457/index.html">DataPro Data Center: cooling and fire suppression systems</a></li>
<li><a href="../281459/index.html">Hello, Bot! Chat bots - the next generation of applications?</a></li>
<li><a href="../281461/index.html">Humor in programming: P, NP and Turing machines</a></li>
<li><a href="../281463/index.html">BYOD - convenience versus security</a></li>
<li><a href="../281469/index.html">NVRAM device in UEFI-compatible firmware, part three</a></li>
<li><a href="../281471/index.html">Bye, Habrahabr</a></li>
<li><a href="../281473/index.html">Large JVM Survey: Java Versions, Alternative JVM Languages, Java EE Versions</a></li>
<li><a href="../281479/index.html">Quick start at easla.com (master class)</a></li>
<li><a href="../281481/index.html">Microsoft has added another exploit protection feature in Windows 10</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>