<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Authorization and registration components in CMS 1C-Bitrix</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In CMS 1C-Bitrix, the developers are presented with four system components for implementing authorization functions, changing the password and registe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Authorization and registration components in CMS 1C-Bitrix</h1><div class="post__text post__text-html js-mediator-article">  In CMS 1C-Bitrix, the developers are presented with four system components for implementing authorization functions, changing the password and registering ordinary users of the system (system.auth. *), But there is <a href="http://dev.1c-bitrix.ru/api_help/main/">no official documentation of</a> these.  In this article, you will learn the limitations and disadvantages of using these components, why you should use them, how best to use them, and perhaps make some conclusions about why there is no documentation. <br><a name="habracut"></a><br><h4>  Principle of operation </h4><br>  By default, old components 1.0 are used for authorization and registration, the use of which is undesirable.  You can fix this by ticking ‚ÄúUse Components 2.0 for authorization and registration‚Äù in the settings of the main module or by running the code once: <br><pre><code class="php hljs">COption::SetOptionString(<span class="hljs-string"><span class="hljs-string">'main'</span></span>, <span class="hljs-string"><span class="hljs-string">'auth_comp2'</span></span>, <span class="hljs-string"><span class="hljs-string">'Y'</span></span>);</code> </pre> <br>  After reviewing the description <a href="http://dev.1c-bitrix.ru/api_help/main/general/pageplan.php">of the page execution order,</a> we see that in step 1.13 (even before the output of header.php from the site template) a level 1 access right check is in place and if it is not passed, the authorization form is displayed.  Let us examine this in more detail. <br><br>  Calling the registration form means the following actions: <br>  - the page execution order continues to be executed without changes up to point 3 ‚ÄúBody of the page‚Äù, including the execution of header.php, <br>  - instead of ‚ÄúPage Body‚Äù, depending on the variables passed to $ _REQUEST, one of the system components system.auth. * Is connected (specifically system.auth.authorize if $ _REQUEST is empty) to which special parameters are passed (about this below), <br>  - the page execution order continues to be executed without changes, including the execution of footer.php. <br>  This allows you to implement your own design (template) for the system.auth.authorize component, organically fitting into the site template between the header and the basement. <br><br>  Verification of access rights "level 1" initiates a call to the authorization form in the following cases: <br>  - if the global constant NEED_AUTH is defined and equal to true, <br>  - if the user (including unregistered) does not have sufficient rights to read the file requested by him. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Permissions to read files and sections for different groups of users are formed when the administrative panel edits these in service files .access.php.  Each file describes the levels of access to files and directories located at the same level with it.  It is possible to create an .access.php file for each directory in the public part of the site, each subsequent such file complements the access rules for the chain of directories.  An example of such a file in the root of the site: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span> $PERM[<span class="hljs-string"><span class="hljs-string">"/"</span></span>][<span class="hljs-string"><span class="hljs-string">"*"</span></span>]=<span class="hljs-string"><span class="hljs-string">"D"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//           $PERM["/"]["AU"]="R"; //           $PERM["about"]["*"]="R"; //        about $PERM["login"]["*"]="R"; //        login $PERM["index.php"]["*"]="R"; //        index.php </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br>  This distribution of rights allows you to literally ‚Äúon the spot‚Äù to request the username and password of the user in cases when he goes without active authorization to the directory whose functionality requires authorization.  This often happens if the user keeps a link not in the root of the site, but in the specific section with which he works most.  As a result, the user enters the login and password without leaving the landing page, they are sent to its URL, instead of the page, the system component processes the received data, either raises an error or authorizes and reloads the page.  The user is satisfied, he does not need to make an extra click to go to the desired section.  The programmer is satisfied, he does not need to think about redirects to / auth / and $ backurl. <br><br>  I recommend using the global constant NEED_AUTH only in specific cases, one of which is the authorization page itself in the standard package of the demo site at /auth/index.php: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span> define(<span class="hljs-string"><span class="hljs-string">"NEED_AUTH"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">"DOCUMENT_ROOT"</span></span>].<span class="hljs-string"><span class="hljs-string">"/bitrix/header.php"</span></span>); IncludeModuleLangFile($_SERVER[<span class="hljs-string"><span class="hljs-string">"DOCUMENT_ROOT"</span></span>].<span class="hljs-string"><span class="hljs-string">"/bitrix/modules/intranet/public/about/auth/index.php"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ... $APPLICATION-&gt;SetTitle(GetMessage("AUTH_TITLE")); </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span><span class="hljs-comment"> &lt;p&gt;</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?</span></span></span><span class="hljs-comment">=GetMessage("AUTH_SUCCESS")</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span><span class="hljs-comment">&lt;/p&gt; &lt;p&gt;&lt;a href="</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?</span></span></span><span class="hljs-comment">=SITE_DIR</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span><span class="hljs-comment">"&gt;</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?</span></span></span><span class="hljs-comment">=GetMessage("AUTH_BACK")</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span><span class="hljs-comment">&lt;/a&gt;&lt;/p&gt; </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?</span></span></span><span class="hljs-comment">require($_SERVER["DOCUMENT_ROOT"]."/bitrix/footer.php");</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre><br>  This script transfers control to the Bitrix kernel, before defining the constant NEED_AUTH.  Bitrix, in case the user is not authorized, connects the header + system component (authorization) + basement and dies, not allowing the script to run beyond the second line.  If the user is authorized, he will receive a welcome message and a link to the root of the site. <br><br><h4>  Other system components </h4><br>  Let me remind you that when initiating authorization, instead of ‚ÄúPage Body‚Äù, the system.auth.authorize component will connect with the Bitrix kernel only if the user has not explicitly requested any other system component from the list: <br>  -? Forgot_password = yes connect system.auth.forgotpasswd (send control word to change password), <br>  -? Change_password = yes will connect system.auth.changepasswd (password change according to the control word), <br>  -? Register = yes connect system.auth.registration (registration), <br>  -? Confirm_registration = yes connect system.auth.confirmation (registration confirmation). <br>  This approach allows the user to recover the password or even register an account without leaving the landing page.  You can manipulate the available set of these links in your system component templates, but you cannot prevent them from being called when clicking on these links, and this is a fat minus. <br><br><h4>  Using the authorization component inside the page body </h4><br>  Sometimes it is required to embed an authorization form not instead of the page body, but inside the page body, for example, at /about/index.php in the middle of the content.  And here comes a <i>nuance</i> : it turns out that the system component of system.auth.authorize does absolutely nothing with respect to direct authorization, and therefore does not know anything about the result of authorization.  Therefore, if we connect a component without parameters, it will correctly authorize users, but will not display authorization errors.  In fact, the authorization mechanism occurs somewhere deep in the core of the kernel, after which the kernel connects the component, passing the ‚ÄúAUTH_RESULT‚Äù parameter to it by setting a value from $ APPLICATION-&gt; arAuthResult that we have to repeat on our pages: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">"DOCUMENT_ROOT"</span></span>] . <span class="hljs-string"><span class="hljs-string">"/bitrix/header.php"</span></span>); $APPLICATION-&gt;SetTitle(<span class="hljs-string"><span class="hljs-string">" "</span></span>); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> ... <span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$USER-&gt;IsAuthorized()): <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span> $APPLICATION-&gt;IncludeComponent(<span class="hljs-string"><span class="hljs-string">'bitrix:system.auth.authorize'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'AUTH_RESULT'</span></span> =&gt; $APPLICATION-&gt;arAuthResult)); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">endif</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> ... <span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">"DOCUMENT_ROOT"</span></span>] . <span class="hljs-string"><span class="hljs-string">"/bitrix/footer.php"</span></span>); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  If the need for authorization arises during the execution of the component, you should call the authorization form using the CMain :: AuthForm () method, which will allow the user to authorize not only without leaving the landing page, but also save all the parameters in the URL: <br><pre> <code class="php hljs">$APPLICATION-&gt;AuthForm(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">"MESSAGE"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"   ...  ."</span></span>, <span class="hljs-string"><span class="hljs-string">"TYPE"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">"OK"</span></span>, ));</code> </pre><br><br><h4>  Creating your own templates </h4><br>  In order to customize the appearance of the system authorization forms, registration, change password request and password change on the control line, you should copy the existing templates of these components (/bitrix/components/bitrix/system.auth.*/templates/.default) into the template site (/bitrix/templates/ &lt;site_colation &gt;/components/bitrix/system.auth.*/.default), then work with them.  You cannot change the names of the transmitted fields in these forms, but you can add any other fields, for example, ‚Äúphone‚Äù to the registration, though at this stage the system component will not understand what you want from it with these new fields.  You can also completely change the design and adjust the display of links to neighboring system components.  When processing these templates, pay attention to the output of messages by the global ShowMessage function, which accepts a string or array as input.  You can get rid of its use, but it is better to override the template system.show_message component. <br><br><h4>  Expansion of registration functionality </h4><br>  Unfortunately, today system components are implemented in a procedural style, which does not allow you to inherit your own components from them, redefining and complementing the functionality, so you need to use Bitrix events to solve such problems.  The two most interesting events generated by user registration are: <a href="http://dev.1c-bitrix.ru/api_help/main/events/onbeforeuserregister.php">OnBeforeUserRegister</a> and <a href="http://dev.1c-bitrix.ru/api_help/main/events/onafteruseradd.php">OnAfterUserAdd</a> .  Ideally, handlers for these events are registered when the module is installed, deleted when the module is deleted, for example: <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//   : RegisterModuleDependences("main", "OnAfterUserAdd", $this-&gt;MODULE_ID, "CWBroker", "OnAfterUserAdd"); RegisterModuleDependences("main", "OnBeforeUserRegister", $this-&gt;MODULE_ID, "CWBroker", "OnBeforeUserRegister"); //   : UnRegisterModuleDependences("main", "OnAfterUserAdd", $this-&gt;MODULE_ID, "CWBroker", "OnAfterUserAdd"); UnRegisterModuleDependences("main", "OnBeforeUserRegister", $this-&gt;MODULE_ID, "CWBroker", "OnBeforeUserRegister");</span></span></code> </pre><br>  The OnBeforeUserRegister event is remarkable in that it is not called during a regular user addition, be it an API call or manual addition in the administrative part, which allows changing the logic of the guest user registration, imposing additional restrictions on the fields or processing additional fields, for example, controlling the numbers in the phone , control the availability of data in the name and surname. <br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CWBroker</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ... public static function OnBeforeUserRegister(&amp;$arArgs) { global $APPLICATION; $_REQUEST['USER_PERSONAL_PHONE'] = preg_replace('#[^0-9]#', '', $_REQUEST['USER_PERSONAL_PHONE']); $arArgs['LOGIN'] = $arArgs['EMAIL']; $arArgs['CONFIRM_PASSWORD'] = $arArgs['PASSWORD']; $arArgs['PERSONAL_PHONE'] = $_REQUEST['USER_PERSONAL_PHONE']; $arArgs['PERSONAL_STATE'] = $_REQUEST['USER_PERSONAL_STATE']; if (empty($arArgs['NAME'])) { $APPLICATION-&gt;ThrowException('  '); return false; } if (empty($arArgs['LAST_NAME'])) { $APPLICATION-&gt;ThrowException('  '); return false; } if (empty($arArgs['PERSONAL_PHONE'])) { $APPLICATION-&gt;ThrowException('   '); return false; } if (empty($arArgs['PERSONAL_STATE'])) { $APPLICATION-&gt;ThrowException('  '); return false; } if ($_REQUEST['USER_AGREE_TERMS'] &lt;&gt; 'Y' || $_REQUEST['USER_AGREE_PHONE'] &lt;&gt; 'Y' || $_REQUEST['USER_AGREE_EMAIL'] &lt;&gt; 'Y') { $APPLICATION-&gt;ThrowException('   '); return false; } return $arArgs; } // ... }</span></span></code> </pre><br>  The task of the event handler is to correct the incoming data array $ arArgs or declare an error using the CMain :: ThrowException () method, returning false instead of the data array.  Unfortunately, to ensure that the fields of interest to us are passed through $ arArgs is impossible, so you have to analyze $ _REQUEST.  The listing can be improved by grouping the errors found, but unfortunately, even if the handler successfully completes, there may be other errors later in the registration process in the kernel that we cannot influence.  The user is not satisfied, receiving various errors in the registration process.  The programmer is looking for alternatives. <br><br>  The OnAfterUserAdd event is triggered not only after successful user self-registration, but also when API calls or adding a user to the administrative part, but the data array sent to the event handlers does not affect anything other than the handlers themselves, therefore, it is almost useless to generate exceptions, but instead you can do some common logic for all new users, such as: add a user to the mailing list, create a budget for it in the online store, or assign some  custom property <br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CWBroker</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// ... public static function OnAfterUserAdd(&amp;$arFields) { if (CModule::IncludeModule('inquiries')) { $CUser = new CUser(); $CUser-&gt;Update($arFields['ID'], array('UF_TARIFF' =&gt; 1)); } if (CModule::IncludeModule('sale')) { $sale_account = CSaleUserAccount::GetByUserID($arFields['ID'], 'RUB'); if (empty($sale_account)) { CSaleUserAccount::Add(array( 'USER_ID' =&gt; $arFields['ID'], 'CURRENT_BUDGET' =&gt; 0, 'CURRENCY' =&gt; 'RUB', )); } } if (CModule::IncludeModule('subscribe')) { $CDBResult = CRubric::GetList(array("SORT" =&gt; "ASC"), array("ACTIVE" =&gt; "Y")); $rubrics = array(); while ($rubric = $CDBResult-&gt;Fetch()) { $rubrics[] = $rubric['ID']; } $CSubscription = new CSubscription(); $CSubscription-&gt;Add(array( 'USER_ID' =&gt; $arFields['ID'], 'EMAIL' =&gt; $arFields['EMAIL'], 'FORMAT' =&gt; 'html', 'CONFIRMED' =&gt; 'Y', 'SEND_CONFIRM' =&gt; 'N', 'RUB_ID' =&gt; $rubrics, )); } } // ... }</span></span></code> </pre><br><br><h4>  Alternatives </h4><br>  If you have the courage to get into the source code of the system components (authorization), then you have drastically lost any desire to work with them.  As an obvious alternative, first of all, creating your own authorization, registration and other components comes to mind.  The benefit of the API allows you to implement all the same.  However, in this alternative, I see the following fat cons: <br>  - the cost of re-implementation of logic (in only one component of the authorization: test captcha, secure key authorization and authorization through external services), <br>  - refusal to update the considered system components, which is especially important with the gradual <a href="https://dev.1c-bitrix.ru/learning/course/index.php%3FCOURSE_ID%3D43%26CHAPTER_ID%3D05062">transition of the core to D7</a> , <br>  - the inability to connect your own authorization component to the user's target page in the case when he does not have enough rights to view the page, instead, he has to implement his own logic of the availability of certain pages and sections. <br><br>  Another alternative is the <a href="http://dev.1c-bitrix.ru/user_help/settings/users/components_2/main_register.php">bitrix: main.register component</a> , which has a wide range of parameters.  However, in order for this component to be displayed and worked out on the user's target page, the programmer has to go to the trick: insert the call of this component into the registration system component template (bitrix: system.auth.register), which entails the following disadvantages: <br>  - the same set of component parameters is stored in at least two places: in the public part on the authorization page and in the site template, <br>  - when calling bitrix: main.register through the bitrix: system.auth.register component template, the latter‚Äôs code is wasted. <br><br><h4>  Finally </h4><br>  It's no secret that the Bitrix platform is far from ideal.  Every time I see such things that distort my poker interface, I first call them <i>strange</i> , then I try to figure out and understand <i>why it was done this way</i> and in most cases I find <i>an acceptable</i> answer.  But in this case I did not find the answer, so I decided to write down all the thoughts about it.  I hope someone will come in handy. </div><p>Source: <a href="https://habr.com/ru/post/244959/">https://habr.com/ru/post/244959/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244949/index.html">Javascript birthday</a></li>
<li><a href="../244951/index.html">Administration of our days: ‚ÄúI have a lift hung!‚Äù</a></li>
<li><a href="../244953/index.html">Increase conversion Landing Page</a></li>
<li><a href="../244955/index.html">New GNS3 - step forward or jump on the spot?</a></li>
<li><a href="../244957/index.html">Maple: composing Lagrange equations of the 2 kind and the method of redundant coordinates</a></li>
<li><a href="../244963/index.html">Serialization and C ++ 11</a></li>
<li><a href="../244965/index.html">15 tips on how to build communication with web service users based on their behavior</a></li>
<li><a href="../244967/index.html">The explosive growth of downloads after the release of the iPhone 6, what will be the mobile Internet, the new App Store from Xiaomi - and other news of the week for a mobile developer</a></li>
<li><a href="../244969/index.html">The author of Lean Startup, Eric Rees and Ilya Korolev (IIDF), on the advantages of a ‚Äúlean‚Äù approach to creating companies</a></li>
<li><a href="../244971/index.html">Rising cost of cloud (and other outsourcing) providers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>