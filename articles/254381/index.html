<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>IO Ninja - programmable terminal emulator / sniffer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings to you, dear habrovchane! 

 Today I wanted to start a story about one interesting product I presented in Tibbo . This product can be useful...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>IO Ninja - programmable terminal emulator / sniffer</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/679/b09/a22/679b09a22de0cc3697e26879e0893973.png" alt="ioninja" align="right">  Greetings to you, dear habrovchane! <br><br>  Today I wanted to start a story about one interesting product I presented in <a href="http://tibbo.com/">Tibbo</a> .  This product can be useful to a wide range of IT-professionals, including system administrators, information security specialists, and, finally, simple developers who have no-no, and have to program communication with devices and other low-level I / O. <br><br>  The conversation will be about the programmable terminal / sniffer of <a href="http://tibbo.com/ioninja/">IO Ninja</a> (hereinafter I will omit the word ‚Äúemulator‚Äù and speak simply ‚Äúterminal‚Äù).  I suspect that the definition of ‚Äúterminal / sniffer‚Äù itself may look quite unusual, if not to say strange.  Therefore, we start with the history of the IO Ninja. <br><a name="habracut"></a><br><br clear="all">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Motivation and history </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/05b/131/bd1/05b131bd1167b8ddad09c7b72c8ce41a.jpg" alt="ioninja" align="left">  The very first product of our company was the <a href="http://tibbo.com/products/modules/em100.html">EM100</a> embedded module (embedded module) for converting a Serial RS232 serial interface into Ethernet 10BASE-T (now its equivalent is the <a href="http://tibbo.com/products/modules/x20x/em1206.html">EM1206</a> module). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d46/b08/663/d46b086636bdb1cfcc5d17234d728b1a.jpg" alt="ioninja" align="right">  On this device, protocols of interaction between the firmware (on modules) and virtual port drivers, as well as configuration utilities (on PC) were tested and tested. <br><br>  As you understand, in our imperfect world, no program works immediately after writing, and we have many months to debug communication protocols.  In our particular case of debugging a Serial-to-Ethernet converter, this resulted in the need to use the following utilities in parallel: <br><ul><li>  Serial terminal; </li><li>  TCP terminal; </li><li>  UDP terminal; </li><li>  Serial monitor; </li><li>  Ethernet sniffer. </li></ul><br>  In addition, to debug our protocols, we also needed: <br><ul><li>  Listen and accept incoming TCP connections; </li><li>  Send broadcast (broadcast) UDP packets; </li><li>  Receive responses from multiple nodes; </li><li>  Send and be able to display binary data in hexadecimal form. </li></ul><br>  There were no difficulties with monitors for Ethernet and Serial - even free products like <a href="https://www.wireshark.org/">Wireshark</a> (which was also called Ethereal at that time) completely satisfied our requests.  But with the terminals, we ran into problems. <br><br>  Like monitors, there are a lot of terminals.  But there is a nuance: most of them are very lame in terms of sending and displaying binary data.  If this opportunity is provided, then in an extremely inconvenient form - a full hexadecimal viewer of incoming packets and an outgoing editor (with the possibility of selecting, copying, pasting, etc.) was not found in any of the terminals we tested.  In addition, the situation is also bad with regard to the reception of TCP connections and a completely total darkness - with support for working with broadcast UDP packets. <br><br>  It was after an unsuccessful search that the idea was born of creating a universal utility for debugging communication protocols that could do all of the above and would do it well.  Yes - even dream so dream!  - would be programmable and would allow us to easily add analyzers of our own protocols and test scripts (such as, for example, wait for commands and send answers to them dynamically generated according to certain rules). <br><br>  Dreams of programmability, of course, for a long time remained just dreams.  But the utility for sending and displaying binary data, while supporting TCP reception of connections and UDP broadcasting, was spliced ‚Äã‚Äãout quite quickly.  She was called ingenuously - SockTerm - and looked like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/afb/3b6/ddd/afb3b6ddd8739ab11485001bfed8dcd4.png" alt="sockterm"><br><br>  In addition to supporting the socket operating modes that are not available in standard terminals, this utility demonstrated the extreme convenience of its approach to logging, namely, hexadecimal ‚Äúsheets‚Äù with pasting new packages to the previous ones. <br><br>  Work on the utility continued in its free time from the main projects and tasks for a couple of years.  The logging module was gradually refined, expanded and eventually reorganized as a full-fledged engine (its capabilities will be described in more detail below).  This engine was quite suitable for use in both terminals and sniffers - which was enthusiastically brought to life.  The result was the appearance of the first version of IO Ninja. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b37/e4d/e85/b37e4de85dc628675f4db4ae92ba6be6.png" alt="ioninja-1.8.6"><br><br>  This utility allowed us to work with all the transports we are interested in (Serial, TCP, UDP) both in the sniffer mode for passive listening and in the terminal mode for the directional transmission and reception of data.  Multiple modes of operation were implemented as plug-ins (written, like IO Ninja itself, in C ++), which in theory allowed us to easily add support for new modes, and eventually publish the SDK and allow customers to do it themselves.  However, in practice, the latter has not been implemented - those dreams of programmability did not give us peace of mind, and plug-ins in C ++ - in this case, is not the best architecture. <br><br>  What we needed instead was to make a ninja scripted.  But bad luck - in languages ‚Äã‚Äãwithout pointers and address arithmetic, working with binary data (and this is an integral part of any protocol analyzer) turns into a nightmare like ‚Äúpull bytes on the N index, move 8 bits to the left, add up with the byte on the N + 1 index etc. "  And scripting languages ‚Äã‚Äãwith pointers in nature does not exist.  More precisely, it did not exist before - we corrected this annoying misunderstanding by creating the <a href="http://tibbo.com/jancy/">Jancy</a> language. <br><br>  This article does not set itself the goal of telling about all the possibilities of the Jancy language (although, if respected habrovans show interest, the corresponding articles will definitely appear).  Now we are talking only about the fact that in our hands - after a long series of half-dead prototypes (and then a prototype of a completely viable and used when creating the second, scripted version of IO Ninja - its screenshot you see below) was a language with safe pointers and address arithmetic. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/817/ca7/6cd/817ca76cd4762d4e036f547731d55925.jpg" alt="ioninja-2.3.5"><br><br>  At the same time, this language is designed so binary compatible with C / C ++ that a direct call between Jancy and C ++ is possible, and this leads, firstly, to high efficiency of interaction between the script and the host C ++ application, and secondly, to ease creating C / C ++ libraries for use from Jancy scripts.  In addition to ABI (binary) compatibility, Jancy also has a high degree of compatibility at the source code level, which makes it possible to copy and use (often without any modifications at all) C code taken from publicly available sources. <br><br>  In 2014, work was completed on the creation and release of the third version of IO Ninja, based on the Jancy language.  About her and will be discussed further. <br><br>  If you highlight the most significant features of the new IO Ninja, then it will be: <br><ul><li>  Programmability; </li><li>  Logging engine; </li><li>  Package Builder; </li><li>  Universal redirector; </li><li>  Combining all kinds of utilities for debugging communications in one product. </li></ul><br>  The fact that a ninja can be turned into using programmability will be discussed in later parts of the article;  in this same let's see what is available out of the box. <br><br><h1>  Logging engine </h1><br>  The logging engine since the first non-programmable version of IO Ninja offered something that was not available in other terminals and sniffers.  This engine is highlighted primarily by the approach to displaying log data. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c27/8dd/a59/c278dda590ca182b9beaf86b71c21b0c.png" alt="log"><br><br>  Instead of a pair of ‚Äúmain list‚Äù and ‚Äúrecording details‚Äù windows (as in most monitors and log viewers), the IO Ninja engine offers a log of ‚Äúendless sheets‚Äù with alternating text messages and binary data ‚Äî something like an unboundedly growing heterogeneous HTML page.  By the way, it was in connection with the unlimited growth of the log that the development of its own engine was required - otherwise it would be possible to fasten something like Gecko or WebKit. <br><br>  At the same time, despite the actual unlimited size of the log (actually, it is limited only by the free space on the disk), the IO Ninja engine provides a ‚Äúsmooth‚Äù scrolling, while without directly depending on the amount of memory consumed from the size of the log. <br><br>  One of the reasons for avoiding standard terminals was the lack of convenient means for working with binary data, so it is not surprising that the IO Ninja logging engine is literally ‚Äúsharpened‚Äù for this task. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/552/cbb/62f/552cbb62fc39786fe8c745ffca532568.png" alt="log settings" align="left">  Binary data can be displayed in hexadecimal or textual form, with customizable line widths and tabs, and in any of the UTF encodings (including variations with reverse byte ordering).  Packages of the same type (for example, incoming) are optionally glued together.  Gluing can be configured to "always", "never" and "if the interval does not exceed a certain threshold."  Gluing places are highlighted (again, optional) color - checkered. <br><br clear="all">  The IO Ninja log also supports collapsing / unfolding of records, which may be necessary to switch between short and full descriptions and is used, for example, in a network sniffer: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/438/ebd/bac/438ebdbac1a75b95a9f74829d576d068.png" alt="log"><br><br><h1>  Package builder </h1><br>  Speaking about the support of working with binary data, it is impossible not to mention the IO Ninja tools for preparing outgoing packets. <br><br>  For the simplest cases, IO Ninja has a text editor package.  This editor understands all the well-known escape sequences (\ n \ e \ x01 \ u2661, etc.), therefore, introducing a couple of special characters is not a problem.  And if you want to make a package, consisting entirely of special characters?  Welcome to the IO Ninja Package Builder! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e47/669/a66/e47669a665c9421a8c03c11c5ea9c82f.png" alt="packet template editor" align="right">  The package builder is one of the strengths of IO Ninja available out of the box.  In addition to the modern hex editor with support for all UTF encodings, editing of nibbles (nibbles), restrictions on the size of the package above and below, convenient highlighting of the selection, as well as all other features that can be expected from a good editor (insert, overwrite, copy, paste, undo, redo) - in IO Ninja there is a tool for creating packages from a template. <br><br>  Remember, we talked about the high degree of compatibility between Jancy and C?  Preparing binary packages is one of the places where the benefits of this compatibility are reaped. <br><br clear="all">  <b>Phase 1</b> : find the source code for the implementation of the C protocol we need in publicly available sources; <br><br>  <b>Phase 2</b> : copy descriptions of packet structures in IO Ninja and, perhaps, a bit of retouching (after all, Jancy and C are different languages); <br><br>  <b>Phase 3</b> : ??? <br><br>  <b>Phase 4</b> : PROFIT!  You can fill in the package fields from the property grid editor (property grid)! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/521/d96/488/521d96488667ff89cb9e9519dae0b3dc.png" alt="packet template editor"><br><br><h1>  Instead of conclusion </h1><br>  This concludes the introductory review, and in the next part of the article we will demonstrate some real life scenarios from our company, in which IO Ninja helped solve certain practical problems better than their counterparts. <br><br>  In the meantime, you can download and try the latest version of IO Ninja for Windows or Linux at <a href="http://tibbo.com/ioninja/downloads">tibbo.com/ioninja/downloads</a> .  There is also a companion IDE based on NetBeans available for download (however, more about this another time). <br><br><h1>  The following parts of the article </h1><br>  Part 2: <a href="http://habrahabr.ru/company/tibbo/blog/255221/">http://habrahabr.ru/company/tibbo/blog/255221/</a> <br>  Part 3: <a href="http://habrahabr.ru/company/tibbo/blog/256803/">http://habrahabr.ru/company/tibbo/blog/256803/</a> </div><p>Source: <a href="https://habr.com/ru/post/254381/">https://habr.com/ru/post/254381/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254365/index.html">Correct insertion of C ++ preprocessor definitions in CMake</a></li>
<li><a href="../254367/index.html">See you at EMC Technology Day # 3</a></li>
<li><a href="../254369/index.html">Savings on printing documents: turnkey solutions</a></li>
<li><a href="../254373/index.html">Xaml context injectors</a></li>
<li><a href="../254379/index.html">Audio watermark for Second Screen applications</a></li>
<li><a href="../254383/index.html">Sending SMS via the Openvox VoxStack Gateway</a></li>
<li><a href="../254385/index.html">Based on Scott Guthrie Announcements - Azure Web Apps as a convenient and cheap way to develop</a></li>
<li><a href="../254387/index.html">AggreGate Network Manager: platform + box for umbrella monitoring of IT infrastructure</a></li>
<li><a href="../254393/index.html">How to launch a simple static site in five ‚âà five-minute steps using Node.js and Express</a></li>
<li><a href="../254397/index.html">Creating dynamic animations in WatchKit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>