<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>AnnotatedSQL lib - automatic database generation in Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When developing an Android application, we often write with our hands scripts to create a schema. 
 Everything would be fine when it needs to be done ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>AnnotatedSQL lib - automatic database generation in Android</h1><div class="post__text post__text-html js-mediator-article"> When developing an Android application, we often write with our hands scripts to create a schema. <br>  Everything would be fine when it needs to be done once, but when the application develops, it is often necessary to change the base. <br>  And when it is spread over several classes, then problems arise, somewhere I forgot to add / remove a column, change the type, and so on.  Also copy-paste ‚Äúhelps‚Äù: added a column - forgot to put a comma. <br><br>  Just to solve these problems, this library was invented. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b><a href="https://github.com/hamsterksu/">AnnotatedSQL</a></b> is a library that generates code for creating an annotation database.  Annotations are <u>not runtime</u> , but are processed by the preprocessor at compile time.  Thus, we can not defective project and the final apk. <br><br>  Actually, it consists of two pieces: jar with annotations and a preprocessor. <br>  Annotations put in the project libs folder. <br>  But the use of the preprocessor depends on the IDE and the way the project is built. <br><br>  If you use <i>Eclipse</i> , then copy the plugin into the plugins folder and restart eclipse if necessary.  then go to the settings of the project <i>Java Compiler -&gt; Annotation Processing</i> and select the folder where to generate the code.  Obviously, you need to put the standard <i>gen</i> folder.  Next, go to the <i>Factory Path</i> and select our plugin.  Well that's all. <br><br>  For <i>IDEA</i> plugin did not collect, litter <br><br>  To use with ant, you just need to add a preprocessor to the classpath to do it like this <br> <code>ant clean release -cp ../com.annotatedsql.AnnotatedSQL_1.0.12.jar <br></code> <br><br><h5>  Using </h5><br>  We turn to more technical things.  So, we know how to connect it, but what does it do? <br>  As I already said, according to the annotations, the base is generated, or rather the class is created with the help of which the base will be generated. <br>  As is usually the case, for use in code, we describe labels as interfaces with the name of the table and the columns in it. <br><br>  For example, we will have an application that should display data on the results of sports competitions.  Take a football match for now. <br>  Obviously, we should have several tablets in the database.  This is the team, the result and the championship. Let's describe them. <br>  I usually describe all the interfaces within one class, let's call it FStore, for example.  In addition to the description of the plates, it contains the name of the database, its version and a couple of utility methods. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FStore</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String DB_NAME = <span class="hljs-string"><span class="hljs-string">"fmanager"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> DB_VERSION = <span class="hljs-number"><span class="hljs-number">34</span></span>; .......... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TeamTable</span></span></span></span>{ String TABLE_NAME = <span class="hljs-string"><span class="hljs-string">"team_table"</span></span>; String ID = <span class="hljs-string"><span class="hljs-string">"_id"</span></span>; String TITLE = <span class="hljs-string"><span class="hljs-string">"title"</span></span>; String CHEMP_ID = <span class="hljs-string"><span class="hljs-string">"chemp_id"</span></span>; String IS_FAV = <span class="hljs-string"><span class="hljs-string">"is_fav"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ChempTable</span></span></span></span>{ String TABLE_NAME = <span class="hljs-string"><span class="hljs-string">"chemp_table"</span></span>; String CONTENT_PATH = <span class="hljs-string"><span class="hljs-string">"chemps"</span></span>; String ID = <span class="hljs-string"><span class="hljs-string">"_id"</span></span>; String TITLE = <span class="hljs-string"><span class="hljs-string">"title"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ResultsTable</span></span></span></span>{ String CONTENT_PATH = <span class="hljs-string"><span class="hljs-string">"results"</span></span>; String PATH_VIEW = <span class="hljs-string"><span class="hljs-string">"results_view"</span></span>; String TABLE_NAME = <span class="hljs-string"><span class="hljs-string">"result_table"</span></span>; String ID = <span class="hljs-string"><span class="hljs-string">"_id"</span></span>; String TEAM_ID = <span class="hljs-string"><span class="hljs-string">"team_id"</span></span>; String POINTS = <span class="hljs-string"><span class="hljs-string">"points"</span></span>; String CHEMP_ID = <span class="hljs-string"><span class="hljs-string">"chemp_id"</span></span>; String GAMES = <span class="hljs-string"><span class="hljs-string">"games"</span></span>; String WINS = <span class="hljs-string"><span class="hljs-string">"wins"</span></span>; String TIE = <span class="hljs-string"><span class="hljs-string">"tie"</span></span>; String LOSE = <span class="hljs-string"><span class="hljs-string">"lose"</span></span>; String BALLS = <span class="hljs-string"><span class="hljs-string">"balls"</span></span>; String GOALS = <span class="hljs-string"><span class="hljs-string">"goals"</span></span>; } ........ }</code> </pre><br><br>  Do not pay attention to CONTENT_PATH and all PATH_VIEW.  These are constants for accessing the content provider. <br>  So, we present the amount of manual work to create a pattern. <br>  In addition, in order to get the result in a readable form, we need to arm the plates on each other.  This can be done in the content provider, but I prefer to use <u>View</u> , here‚Äôs another big sql piece for writing. <br><br>  To facilitate our work, this was written.  So let's get started. <br><br><h5>  Schema </h5><br>  FStore - mark the <i>Schema</i> annotation <i>("SqlSchema")</i> and set the name of the class that will contain the code.  the class will be generated in the same package as FStore <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Schema</span></span>(<span class="hljs-string"><span class="hljs-string">"SqlSchema"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FStore</span></span></span><span class="hljs-class"> </span></span>{</code> </pre><br><br><h6>  Table, Index, PrimaryKey </h6><br>  Labels description is marked with <i>Table</i> annotation and set table name <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Table</span></span>(ChempTable.TABLE_NAME) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ChempTable</span></span></span></span>{ ................ <span class="hljs-meta"><span class="hljs-meta">@Table</span></span>(TeamTable.TABLE_NAME) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TeamTable</span></span></span></span>{ ............... <span class="hljs-meta"><span class="hljs-meta">@Table</span></span>(ResultsTable.TABLE_NAME) <span class="hljs-meta"><span class="hljs-meta">@Index</span></span>(name = <span class="hljs-string"><span class="hljs-string">"chemp_index"</span></span>, columns = ResultsTable.CHEMP_ID) <span class="hljs-meta"><span class="hljs-meta">@PrimaryKey</span></span>(collumns = {ResultsTable.TEAM_ID, ResultsTable.CHEMP_ID}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ResultsTable</span></span></span></span>{</code> </pre><br><br>  As we see on the table we can hang the creation of an index, and a complex key.  Everything seems simple and requires no explanation. <br><br><h5>  Column, PrimaryKey, Autoincrement, NotNull </h5><br>  These annotations are for fields, and are obvious in use. <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Table</span></span>(TeamTable.TABLE_NAME) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TeamTable</span></span></span></span>{ String TABLE_NAME = <span class="hljs-string"><span class="hljs-string">"team_table"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@PrimaryKey</span></span> <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(type = Type.INTEGER) String ID = <span class="hljs-string"><span class="hljs-string">"_id"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@NotNull</span></span> <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(type = Type.TEXT) String TITLE = <span class="hljs-string"><span class="hljs-string">"title"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(type = Type.INTEGER) <span class="hljs-meta"><span class="hljs-meta">@NotNull</span></span> String CHEMP_ID = <span class="hljs-string"><span class="hljs-string">"chemp_id"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(type = Type.INTEGER, defVal=<span class="hljs-string"><span class="hljs-string">"0"</span></span>) String IS_FAV = <span class="hljs-string"><span class="hljs-string">"is_fav"</span></span>; }</code> </pre><br><br><h5>  Simpleview </h5><br>  And the last, very important, element of the system and not quite trivial is <i>SimpleView</i> . <br>  It provides basic functionality for creating simple views.  There is INNER JOIN for now, but I will add others. <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@SimpleView</span></span>(ResultView.VIEW_NAME) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ResultView</span></span></span></span>{ String VIEW_NAME = <span class="hljs-string"><span class="hljs-string">"result_view"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@From</span></span>(ResultsTable.TABLE_NAME) String TABLE_RESULT = <span class="hljs-string"><span class="hljs-string">"table_result"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Join</span></span>(srcTable = TeamTable.TABLE_NAME, srcColumn = TeamTable.ID, destTable = ResultView.TABLE_RESULT, destColumn = ResultsTable.TEAM_ID) String TABLE_TEAM = <span class="hljs-string"><span class="hljs-string">"table_team"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Join</span></span>(srcTable = ChempTable.TABLE_NAME, srcColumn = ChempTable.ID, destTable = ResultView.TABLE_RESULT, destColumn = ResultsTable.CHEMP_ID) String TABLE_CHEMP = <span class="hljs-string"><span class="hljs-string">"table_chemp"</span></span>; }</code> </pre><br><br>  Consider annotations inside our view: <br>  <b><i>From</i></b> is the table from which we will do from :) Important - then with joins, it is necessary to use not the name of the table, but this constant. <br><br>  <b><i>Join</i></b> is the join table itself.  In our case, it is necessary to score on the team and championship table. <br><br>  <i>srcTable</i> is the source table. <br>  <i>destTable</i> is the new name of the from / join table in the view.  In our case <br><br><pre> <code class="java hljs">String TABLE_RESULT = <span class="hljs-string"><span class="hljs-string">"table_result"</span></span>;</code> </pre><br><br>  Another <u>very important note</u> is that in the view the field names are generated according to the following pattern: <br> <code>&lt;variable_name&gt;_&lt;column_name&gt;</code> <br> <br>  <u>The exception</u> is the <b>_id</b> field from the <i>From</i> table to use the cursor in the adapter. <br><br>  Therefore, to find the column index, you need to use something like <br><br><pre> <code class="java hljs">columnPoints = cursor.getColumnIndex(ResultView.TABLE_RESULT + <span class="hljs-string"><span class="hljs-string">"_"</span></span> + ResultsTable.POINTS);</code> </pre><br>  a little awkward but this is done once in <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">changeCursor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Cursor cursor)</span></span></span><span class="hljs-function"> </span></span>{</code> </pre><br>  You can still make such a helper <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ColumnMappingHelper</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> HashMap&lt;String, HashMap&lt;String, Integer&gt;&gt; indexes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;String, HashMap&lt;String, Integer&gt;&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getColumn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Cursor c, String table, String column)</span></span></span></span>{ HashMap&lt;String, Integer&gt; columns = indexes.get(table); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(columns != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>){ Integer index = columns.get(column); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(index != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> index; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(columns == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>){ columns = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;String, Integer&gt;(); indexes.put(table, columns); } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index = c.getColumnIndex(table + <span class="hljs-string"><span class="hljs-string">"_"</span></span> + column); columns.put(column, index); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> index; } }</code> </pre><br><br>  and yuzay it so <br><br><pre> <code class="java hljs">mappingHelper.getColumn(cursor, ResultView.TABLE_RESULT, ResultsTable.POINTS);</code> </pre><br><br><h5>  Result </h5><br><br>  Generated file <b>SqlSchema.java</b> <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SqlSchema</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String SQL_CREATE_RESULT_TABLE = <span class="hljs-string"><span class="hljs-string">"create table result_table( balls INTEGER, chemp_id INTEGER NOT NULL, games INTEGER NOT NULL, goals INTEGER, _id INTEGER, lose INTEGER, points INTEGER NOT NULL, team_id INTEGER NOT NULL, tie INTEGER, wins INTEGER, PRIMARY KEY( team_id, chemp_id))"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String SQL_CREATE_CHEMP_TABLE = <span class="hljs-string"><span class="hljs-string">"create table chemp_table( _id INTEGER PRIMARY KEY, title TEXT)"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String SQL_CREATE_TEAM_TABLE = <span class="hljs-string"><span class="hljs-string">"create table team_table( chemp_id INTEGER NOT NULL, _id INTEGER PRIMARY KEY, is_fav INTEGER DEFAULT (0), title TEXT NOT NULL)"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String SQL_CREATE_CHEMP_INDEX = <span class="hljs-string"><span class="hljs-string">"create index idx_chemp_index on result_table( chemp_id)"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String SQL_CREATE_RESULT_VIEW = <span class="hljs-string"><span class="hljs-string">"CREATE VIEW result_view AS SELECT table_chemp._id as table_chemp__id, table_chemp.title as table_chemp_title, table_result.balls as table_result_balls, table_result.chemp_id as table_result_chemp_id, table_result.games as table_result_games, table_result.goals as table_result_goals, table_result._id, table_result.lose as table_result_lose, table_result.points as table_result_points, table_result.team_id as table_result_team_id, table_result.tie as table_result_tie, table_result.wins as table_result_wins, table_team.chemp_id as table_team_chemp_id, table_team._id as table_team__id, table_team.is_fav as table_team_is_fav, table_team.title as table_team_title FROM result_table AS table_result JOIN chemp_table AS table_chemp ON table_chemp._id = table_result.chemp_id JOIN team_table AS table_team ON table_team._id = table_result.team_id"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> SQLiteDatabase db)</span></span></span><span class="hljs-function"> </span></span>{ db.execSQL(SQL_CREATE_RESULT_TABLE); db.execSQL(SQL_CREATE_CHEMP_TABLE); db.execSQL(SQL_CREATE_TEAM_TABLE); db.execSQL(SQL_CREATE_SCORE_TABLE); db.execSQL(SQL_CREATE_CHEMP_INDEX); db.execSQL(SQL_CREATE_RESULT_VIEW); db.execSQL(SQL_CREATE_SCORE_VIEW); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDrop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> SQLiteDatabase db)</span></span></span></span>{ db.execSQL(<span class="hljs-string"><span class="hljs-string">"drop table if exists result_table"</span></span>); db.execSQL(<span class="hljs-string"><span class="hljs-string">"drop table if exists chemp_table"</span></span>); db.execSQL(<span class="hljs-string"><span class="hljs-string">"drop table if exists team_table"</span></span>); db.execSQL(<span class="hljs-string"><span class="hljs-string">"drop table if exists score_table"</span></span>); db.execSQL(<span class="hljs-string"><span class="hljs-string">"drop view if exists result_view"</span></span>); db.execSQL(<span class="hljs-string"><span class="hljs-string">"drop view if exists score_view"</span></span>); } }</code> </pre><br><br>  The use of constants from the label description is not required, since  The file is generated and clearly follows what you wrote in the table declaration. <br><br><h5>  Using SqlSchema </h5><br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AnnotationSql</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SQLiteOpenHelper</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AnnotationSql</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(context, FStore.DB_NAME, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, FStore.DB_VERSION); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SQLiteDatabase db)</span></span></span><span class="hljs-function"> </span></span>{ SqlSchema.onCreate(db); init(db); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onUpgrade</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SQLiteDatabase db, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> oldVersion, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> newVersion)</span></span></span><span class="hljs-function"> </span></span>{ SqlSchema.onDrop(db); onCreate(db); } }</code> </pre><br><br><h5>  Plans </h5><br>  1. Add different types of joins <br>  2. Add the <i>Columns</i> annotation for the join to sort out only the required fields. <br><br><h5>  Links </h5><br><br>  Binary: <a href="https://github.com/hamsterksu/Android-AnnotatedSQL-binaries">github.com/hamsterksu/Android-AnnotatedSQL-binaries</a> <br>  Sources: <a href="https://github.com/hamsterksu/Android-AnnotatedSQL">github.com/hamsterksu/Android-AnnotatedSQL</a> <br><br>  License: MIT <br><br>  Thanks to all! <br><br>  <b>Update # 1</b> : About schema update <br><br>  I do not generate OpenHelper, you write it yourself.  so no one bothers to write complicated logic there, and the gene script will work for <i>onCreate</i> . <br>  In <i>onUpgrade,</i> you can write adding / removing / changing fields quite simply - you have the names of the tables and fields. <br>  In the diagram, I will make the members open - then you can access them and after changing the tables, re-create the views </div><p>Source: <a href="https://habr.com/ru/post/156283/">https://habr.com/ru/post/156283/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../156273/index.html">Modification in the database tabular or multiple fields of documents</a></li>
<li><a href="../156275/index.html">Data on 1 million Facebook users cost $ 5.</a></li>
<li><a href="../156277/index.html">How easy it is to connect any OPC server sensor to the narodmon.ru project</a></li>
<li><a href="../156279/index.html">Fuelphp in the field</a></li>
<li><a href="../156281/index.html">The benefits of a scientific approach for startups</a></li>
<li><a href="../156285/index.html">Disable editing model properties in ASP.NET MVC</a></li>
<li><a href="../156289/index.html">Intel¬Æ Inspector XE 2013: Automatic Real-Time Verification and Debugging</a></li>
<li><a href="../156291/index.html">A selection of tools for efficient frontend development</a></li>
<li><a href="../156293/index.html">Uploading files to Yii</a></li>
<li><a href="../156295/index.html">AutoTracker software. Work with routes and schedules</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>