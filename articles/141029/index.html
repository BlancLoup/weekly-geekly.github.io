<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Jianshitsi and tcl</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There is such a rare little known programming language tcl. In Wikipedia, it is painted well, but when writing a program, there will be questions. 
 J...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Jianshitsi and tcl</h1><div class="post__text post__text-html js-mediator-article">  There is such a rare little known programming language tcl.  In <a href="http://ru.wikipedia.org/wiki/Tcl">Wikipedia,</a> it is painted well, but when writing a program, there will be questions. <br>  Jianshitszy is such a Chinese (as the name suggests) game, translated as ‚Äúchoosing stones‚Äù, interesting by itself: there are two piles of stones with any number of stones, two are playing.  Each player can take any number of stones from any pile, as well as an equal number of both at once.  The winner is the one who takes the last stone.  More detailed description <a href="http://matsmekalka.ru/%3Fp%3D302">here</a> .  The game of maintaining balance: on the one hand, it is necessary that the numbers in the heaps differ, on the other, so that the difference is not too large.  To begin with, the game has a winning strategy, the origin of which we will not consider.  Take only a brief description.  There are combinations of heap sizes in which the player who will make the next move loses. <br><img src="https://habrastorage.org/storage2/b12/0c5/462/b120c54626c67c9ff9d13f997af92398.gif"><br><br><img src="https://habrastorage.org/storage2/b3b/700/5cd/b3b7005cd8f847bbb6f14ce0dea8d94b.gif"><br><br>  Square brackets denote taking the whole part.  No, the first formula is not Fibonacci numbers, although the coefficient is the same, but here is an arithmetic progression, not a geometric one.  Immediately, we note that the difference between the numbers of the pair is n. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Earlier on Habr√© were <a href="http://habrahabr.ru/post/89822/">Reversi on TCL in 64 lines</a> and <a href="http://habrahabr.ru/post/89919/">Fifteen on TCL in 10 lines</a> , in which there was a compact and beautiful code, you will not see this here.  He is also perhaps far from the rules of good form.  In general, if something seems to you to govnokodom, most likely the way it is.  On the other hand, it is even good, because it will be something to improve in the future.  Partly due to the fact that the language for me is new, partly to make it easier to make explanations.  There are also no optional checks. <br>  Next will go the pieces of the program.  It is far from optimal, but shows the features of the language and works. <br><a name="habracut"></a><br>  The beginning of the program is: <br><pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/tclsh #---  (+ ab)    #---  ,   , (a + b)     namespace path {::tcl::mathop ::tcl::mathfunc} #---   proc lsum L {expr [join $L +]+0} proc random range {expr int(rand()*$range)}</span></span></code> </pre> <br><br>  The code for losing pairs: <br><pre> <code class="php hljs">set n_max <span class="hljs-number"><span class="hljs-number">20</span></span> ;<span class="hljs-comment"><span class="hljs-comment">#  for {set i 1} {[&lt;= $i $n_max]} {incr i} { set q [/ [+ [sqrt 5] 1 ] 2] ;# " " set a [int [* $q $i]] ;#i-  a set b [+ $a $i] ;#ie  b lappend lPair1 "$a $b" ;#   lPair1  a  b }</span></span></code> </pre><br>  You can view the list like this: <br><pre> <code class="php hljs"> puts lPair1; <span class="hljs-comment"><span class="hljs-comment">#    ;  ,  ,      </span></span></code> </pre><br>  Here is what we get at the output: <br>  {0 0} {1 2} {3 5} {4 7} {6 10} {8 13} {9 15} {11 18} {12 20} {14 23} {16 26} {17 28} {19 31} {21 34} {22 36} {24 39} {25 41} {27 44} {29 47} {30 49} {32 52} <br><br>  So, we have a list of pairs with which to respond to the course of a person, it is necessary to learn how to choose a particular pair.  There are 3 options for moving to a new state: <br><ul><li>  change of one heap: 9 5 -&gt; 4 5; </li><li>  change another heap: 9 5 -&gt; 9 2; </li><li>  immediately change both: 9 5 -&gt; 6 2. </li></ul><br>  Since we only have to take the stones, the amount of stones decreases with each turn. <br>  Let us proceed to the consideration of the computer running command: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">#--- : #----st -  , #----lAns -             #----lPair -      , #--------------         proc turn {st lAns lPair} { set st_cur_sum [lsum $st] ;#   #---   ,    0    0, #---  ,      if {[== 0 $st_cur_sum]} {return {you win}} set a [lindex $st 0] ;#      set b [lindex $st 1] ;#      #---lindex -       , #---           set c [abs [- $a $b]] #--- ,     #---    ,     set a1 [min $a [lindex $lAns $b]] set b1 [min $b [lindex $lAns $a]] set cPair1 [lindex $lPair $c] #---      set a2 [random $a] set b2 [random $b] set c2 [random [+ 1 [min $a $b]]] set cPair2 [list [- $a $c2] [- $b $c2]] set st_next1 [list "$a $b1" [+ $a $b1]] set st_next2 [list "$a1 $b" [+ $a1 $b]] set st_next3 [list "$cPair1" [lsum $cPair1]] #---    set lst_next [list $st_next1 $st_next2 $st_next3] #---     set st_next [lindex [lsort -integer -index 1 $lst_next] 0] set st_next_sum [lindex $st_next 1] if {[== 0 $st_next_sum]} {return {i won}} ;#   -  ,   #--- ,     #---  ,    - , #--- :   ,      ,   #---   ,     if {[&gt; $st_cur_sum $st_next_sum]} { return [lindex $st_next 0] } else { #---     -    switch [random 3] { 0 {return "$a $b2"} 1 {return "$a2 $b"} 2 {return "$cPair2"} } } }</span></span></code> </pre><br>  A little explanation about what lAns and lPair are.  The winning response must match one of the three options above.  And the first two differ only in what heap to take.  Consider the first option, take from the first pile, which means that the second pile does not change, and by the number of stones in it you can determine the desired size of the first, i.e.  not how much we take, but how many we will leave.  The content of lAns is: <br>  0 2 1 5 7 3 10 4 13 15 6 18 20 8 23 9 26 28 11 31 12 34 36 14 39 41‚Ä¶ <br>  The index in the list is the number of stones in the heap, which does not change, the value for this index is the new number of stones in the heap from which we will take the stones. <br>  The content of lPair does not differ from the content of lPair1, above.  The value of the index is in this case a new pair of quantities of stones with a difference equal to the index. <br>  Here is how we organize the dialogue with the user: <br><pre> <code class="php hljs">puts {Enter heap sizes:} <span class="hljs-comment"><span class="hljs-comment">#--- ,     if {[&lt; 0 [gets stdin state]]} { #---    set n_max [lindex [lsort -integer $state] end] #---    genAnsList $n_max lPair lAns #---   set state [turn $state $lAns $lPair] #   puts $state #---      while {[&lt; 0 [gets stdin state]]} { set state [turn $state $lAns $lPair] puts $state } }</span></span></code> </pre><br><br>  The entire code can be seen on <a href="http://pastebin.com/MimrKH0i">pastebin</a> . <br>  The syntax of the language is on the <a href="http://tcl-tk.ru/doku.php/%25D1%2582%25D0%25B8%25D0%25BA%25D0%25BB%25D1%258C_%25D0%25BE%25D0%25BB%25D0%25BE%25D0%25BB%25D0%25BE%25D1%2588%25D0%25BA%25D0%25B5/%25D1%2581%25D0%25B8%25D0%25BD%25D1%2582%25D0%25B0%25D0%25BA%25D1%2581%25D0%25B8%25D1%2581">link</a> . <br>  Working with lists is important, the corresponding commands are in the <a href="http://wiki.tcl.tk/440">documentation</a> . <br>  PS In the next part, if it is, constructive comments will be taken into account in the comments. </div><p>Source: <a href="https://habr.com/ru/post/141029/">https://habr.com/ru/post/141029/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141022/index.html">The sources of Prince of Persia were found after 23 years</a></li>
<li><a href="../141024/index.html">Google uses reCaptcha to recognize street names and house numbers.</a></li>
<li><a href="../141025/index.html">Google Account Activity</a></li>
<li><a href="../141026/index.html">Second beta released Ubuntu 12.04</a></li>
<li><a href="../141027/index.html">Three social extensions</a></li>
<li><a href="../141031/index.html">Once again about screencasts in Linux</a></li>
<li><a href="../141032/index.html">Memory Management in the .Net Framework from Redgate</a></li>
<li><a href="../141033/index.html">Live Broadcast Quality Assurance Day</a></li>
<li><a href="../141034/index.html">Skolkovo in the British</a></li>
<li><a href="../141038/index.html">Lack of standard interaction of online stores and their suppliers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>