<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Designing a switching power supply with active CMC. Episode II</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In my previous article, I talked about designing a switching power supply, showed it to the circuitry and board design. I stopped at the fact that the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Designing a switching power supply with active CMC. Episode II</h1><div class="post__text post__text-html js-mediator-article">  In my previous <a href="https://geektimes.ru/post/284140/">article,</a> I talked about designing a switching power supply, showed it to the circuitry and board design.  I stopped at the fact that the boards for the project were ordered at the factory, I received them and you can proceed to the assembly of the device. <br><br><div class="spoiler">  <b class="spoiler_title">Why the article will not be big</b> <div class="spoiler_text">  Unfortunately, I managed to break the ban for some of the comments, as a result, the ‚Äúdrafts‚Äù were not available, including for this article.  To rewrite everything from scratch neither time nor great desire is present.  Therefore, I will show the main stages, photographs, especially as the previous article showed - only great specialists read and comment, so my explanations are hardly necessary for someone. <br><br>  Actually, the first unit was assembled and left for my friend, the second one I already collect for my beloved one - he will appear in this article. <br></div></div><br> <a href=""><img src="https://habrastorage.org/files/e39/85d/07e/e3985d07ea044f01ad026ac35e8be467.png" alt="image"></a> <br>  <i>Figure 1 - PCB view (top)</i> <br><a name="habracut"></a><br> <a href=""><img src="https://habrastorage.org/files/76d/c14/f21/76dc14f21bfe4c4796bc56ed27a74969.png" alt="image"></a> <br>  <i>Figure 2 - PCB view (bottom)</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Installation of the in-phase filter and auxiliary power supply unit </h2><br>  In this article I will only talk about the input common-mode filter and a multi-channel power supply for powering the PWM controllers and the cooling system.  It‚Äôs not convenient to write large articles for a long time, so I decided to dose in small quantities, but a little more often. <br><br>  You can familiarize yourself with the theoretical part in the previous article, but now I will remind you that this is a flyback converter, which has 3 galvanically isolated channels of 15V each with a rated current of 1A.  This is more than enough to power the controllers.  In reality, it would be possible to restrict 200-300 mA per channel, but only ETD34 was at hand and it was decided to do it with a margin ‚Äî it wouldn't be superfluous. <br><br>  At first, I wanted to mount SMD components at once in the oven, but such a path somewhat complicates debugging, so we first solder the components of the input group + all components for our flyback: <br><br> <a href=""><img src="https://habrastorage.org/files/b91/a95/fb8/b91a95fb870a4b5088255e77c8987061.png" alt="image"></a> <br><br> <a href=""><img src="https://habrastorage.org/files/ddb/93e/0b0/ddb93e0b0ba744abac17c57d745c48d7.png" alt="image"></a> <br>  <i>Figure 3 - The appearance of the board after installation of the components of the in-phase filter and its own power supply</i> <br><br>  There are no supernatural components here, but as you probably noticed, there is no transformer.  Probably, 60-70% of the questions I get asked in the drugs are somehow related to the waste products, most often: "How to wind a transformer (choke)?"  Therefore, the next section is devoted to the manufacture of a transformer. <br><br><h2>  Transformer manufacturing </h2><br>  There are two main problems because of which problems arise with the hatch products, this is the <b>gap</b> and the <b>definition of the beginning of the windings</b> .  It is precisely these two aspects that can completely ‚Äúhack‚Äù your entire converter on the root, so for more on them. <br><br>  1) If you look at any power supply circuit where there is a transformer, then you can see a ‚Äúpoint‚Äù near one of the ends of the winding - this is the way to designate its beginning.  It looks like this: <br><br> <a href=""><img src="https://habrastorage.org/files/67b/7bb/f18/67b7bbf18f9742e4ab57586fb0e1092b.JPG" alt="image"></a> <br>  <i>Figure 4 - Symbols of the transformer</i> <br><br>  In single-ended converters, this aspect plays a key role, due to the fact that the magnetic flux is a vector quantity, which means its direction is just as important as its value.  Therefore, when you start to wind the transformer, be sure to mark from which output you start to wind, it will be that very point - the beginning.  Also, all windings should be wound in one direction, this is not quite so, but it is in the process of winding that <b>everything is wound in one direction</b> .  In the case of the flyback, when you unsolder everything according to the ‚Äúbeginning of the windings‚Äù, it turns out that the flow in the primary winding has the opposite direction, which is why the energy transfer goes on the reverse stroke / course.  Hence the name of this topology.  Compliance with the marks ‚Äúbeginning of the winding‚Äù and winding in one direction during the manufacturing process will not allow you to get confused. <br><br>  2) Clearance ... In push-pull converters, it is not (not always), so this type of transformers is practically not affected, but the moment is relevant when manufacturing chokes and transformers for single-ended converters. <br><br>  If in a simple way - the gap does not allow your core to get enough, that is, the larger the gap, the greater the amount <s>(power) of</s> energy you can pump through it.  That is, by increasing the gap to infinity, we can increase the power of the transformer to infinity, but there is one limitation ... <br><br>  As the gap increases, the inductance of the winding decreases.  That is, in order to obtain the required inductance value, we will have to wind a greater number of turns, while the number of turns is already limited by the size of the core.  Actually, therefore, it is impossible to get that same ‚Äúinfinite <s>power!</s>  power". <br><br>  As for the chokes (by the way, the transformer of the single tactics is also chokes) - if it is made of ferrite, for example, N87, then the gap is obligatory!  Otherwise, the core will be saturated and the power of the converter will drop to almost zero.  That is why people often gather BP and run at idle, they are happy that it works, but under load it ‚Äúshuts up‚Äù - most likely in such cases it‚Äôs a gap. <br><br><h3>  We now turn to the manufacturing process: </h3><br>  a) Select the appropriate set, I use ETD34.  It consists of a frame, 2 parts of the core with already factory gaps of 0.2 mm and fixing brackets.  I also use ‚Äúspecial scotch tape‚Äù as insulation, its charm is that it is thin and durable, which means it practically does not take place in the transformer window. <br><br> <a href=""><img src="https://habrastorage.org/files/7c2/632/320/7c263232016d465bb7a857d9e5d9f7bf.png" alt="image"></a> <br>  <i>Figure 5 - Kit for the manufacture of a transformer</i> <br><br>  You also need a copper lacquered wire, preferably winding.  What good is ‚Äúwinding‚Äù - it is subjected to annealing after broaching and therefore softer, and therefore easier to wind.  On small transformers it is not very critical, but for 500+ watts, hands will say thanks for that, although it is certainly 10-15% more expensive, but you decide.  <i>I use annealed with a diameter of 0.335 mm.</i> <br><br>  b) We start the process of winding.  I advise you to start winding with the thinnest winding: in the down-converters this is the primary winding, for raising it is the secondary.  This will allow you to wind neatly, tightly the most complex winding, because  To do this on top of the ‚Äúfat and curve‚Äù will be quite problematic.  Again, the low power will forgive you the neglect of this advice, but at the power of 500+ watts you will be very sad. <br><br>  After winding each layer of the primary winding (I have it in 3 layers), we insulate 1-2 layers with insulating tape.  As the entire winding is wound, we unsolder it and isolate the winding in 3-4 layers, this is already interwinding insulation - it is the most important and the isolation voltage of the transformer depends on it. <br><br> <a href=""><img src="https://habrastorage.org/files/8d0/f91/8c9/8d0f918c9462438894343a2697570447.png" alt="image"></a> <br>  <i>Figure 6 - Type of transformer after winding the primary winding and the power winding</i> <br><br>  c) Next, we wind the remaining windings, better in order of increasing the <s>thickness of the</s> wire section.  The principles of insulation are the same as on the primary winding.  After all windings are wound, if space permits, we pass the final 5-6 turns additionally with tape. <br><br>  I also recommend, after winding all the windings and final isolation, ‚Äúpunch‚Äù with varnish, for example, Plastik-71.  This will allow you not to worry about possible moisture, condensate, dust and other nastiness.  Better in 2-3 passes, allowing the previous to dry.  And it is better to do this only on the frame before assembling the transformer + do not forget to cover the findings from varnish. <br><br> <a href=""><img src="https://habrastorage.org/files/608/0e4/8a9/6080e48a906145758a0a5ad41c09edc4.png" alt="image"></a> <br>  <i>Figure 7 - Type of frame after winding and insulation of all windings</i> <br><br>  d) Now it remains to simply assemble the transformer.  Themselves half of the core can be fixed with staples, and can be glued.  The last operation is ideally performed with a special glue with the addition of dispersed ferrite powder, and this can be done with the usual moment.  Only I strongly recommend gluing a thin layer - otherwise the gap will increase and the inductance will decrease.  I also advise you not to spread the average ‚Äúleg‚Äù with glue, this completely deprives you of the chance to disassemble it if necessary. <br> <a href=""><img src="https://habrastorage.org/files/b58/781/086/b58781086d85401da64712bb61072567.jpg" alt="image"></a> <br>  <i>Figure 8 - Type of transformer after assembly</i> <br><br><h2>  Final build </h2><br>  In general, it remains only to solder the transformer on our board and the assembly of this node will be completed, it will only remain to check the performance. <br><br> <a href=""><img src="https://habrastorage.org/files/fa4/071/6a1/fa40716a174a4dce9f72925972d53f63.png" alt="image"><br></a> <br>  <i>Figure 9 - The appearance of the board after the installation of the input circuits and power supply units of their own needs</i> <br><br><h2>  First power on and performance test </h2><br>  It is always scary to turn on the equipment in the network, especially if it is collected without experience, it is scary that it will bang or shock it - only fools are not afraid.  Therefore, if you decide to assemble a device from an article or any other with mains supply, then the first switching on after assembly is better done with the help of special tools.  <u>There are several options:</u> <br><br>  1) Test bench or laboratory source with an output of 0-400V just for such cases.  The price tag on them starts from about 80-120 thousand rubles, therefore, for certain reasons, not everyone can afford it at home, and you are unlikely to collect 2-3 new units a week so that such equipment is relevant.  So do you need it? <br><br>  2) Switching on via transformer 1: 1 + electronic fuse.  This method is cheap, which means it is available to everyone.  The transformer will untie the device and you from the network, and the fuse will not allow the unit to puff.  This collective farm equipment for 1000 rubles is clearly more accessible than the first item, and most importantly for the fans, it‚Äôs no worse. <br><br>  3) Probably a classic of the genre - we unsolder a fuse and instead we solder a 230V 60W lamp.  <b>Only incandescent lamp!</b>  Such a replacement will not allow the unit to burn.  If everything is good, then without a load, when the lamp is turned on, the bulb will light up and go out: it will flash, because  charge input capacity.  If it caught fire and does not go out, then somewhere short circuit - turn off and check the circuit. <br><br>  <b>Just do not forget to discharge the high-voltage capacitors!</b>  A battery of two 470 microfarads of Conder discharged into your hand (especially if slightly wet) with a 90% probability will ensure you travel with flashing lights to the nearest hospital or morgue.  A constant current is much more dangerous than a break, it is not in vain that they put a constant on an electric chair. <br><br>  4) An option for <s>real professionals</s> gibberish - just put it in the socket.  If there is a short circuit in the circuit or some other jamb, then on the condition that a good electrician did the wiring to you, the transistor will knock out the automata and the transistor will burn, if the unit is not made by a very competent person, then the unit will burn and melt and it‚Äôs not a fact that the machine will knock it out.  Therefore, I strongly advise paragraph 2. <br><br>  Now actually to the test.  I use an incandescent bulb at 12V and 10W.  Its current is about 900-1100 mA, this is enough to test our unit.  In fact, I‚Äôll just hang as a load on the channel and see what the output voltage is and how distorted they are, because  all stabilized by one of the 3 windings. <br><br> <a href=""><img src="https://habrastorage.org/files/3fd/066/b88/3fd066b882a24012b4a5215e265c9387.png" alt="image"></a> <br>  <i>Figure 10 - Type of operation of auxiliary power units under nominal channel load</i> <br><br><h2>  Conclusion </h2><br>  In the next part, I will show the results of the assembly and debugging of the CMC, as well as share my results under the calculation of the output capacitance.  Very interesting results were obtained there, especially when replacing electrolytes with a film, which will be the story. <br><br>  The format of further articles will be the same - small narration of the results, some comments and "tips" for beginners. <br><br>  One more thing - I will not read the comments, <i>alas and ah</i> ... They take a lot of time, and the benefits of them are a little less than zero, because  Reading the tips and opinions of experts ala "yes, two ATHs should be stuck together and it will be cool" - the <s>Ministry of Health warns</s> cause brain cancer. <br><br>  <b>If you really want to personally ask me something, advise, discuss a question, then welcome to PM.</b> <br><br>  Hope to see you soon!  The part on KKM is already written in "Drafts" and I will try to bring it as quickly as possible to a logical conclusion and publish it for your review. </div><p>Source: <a href="https://habr.com/ru/post/402303/">https://habr.com/ru/post/402303/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../402291/index.html">Overview of the smart air humidifier REDMOND SkyDew 3310S with Internet access</a></li>
<li><a href="../402293/index.html">Making a device for audio distortion: an introduction to Circuit bending</a></li>
<li><a href="../402295/index.html">Arithmetic HashFlare</a></li>
<li><a href="../402299/index.html">Marketing and reality monocoles of spring 2017</a></li>
<li><a href="../402301/index.html">Creating a story using the card method: simplifying the life of screenwriters</a></li>
<li><a href="../402305/index.html">How we tested the correction of bite by liners on our director</a></li>
<li><a href="../402307/index.html">Using the smartphone Meizu Pro 5 Ubuntu Edition for other purposes</a></li>
<li><a href="../402309/index.html">Irons or almost triangular ships</a></li>
<li><a href="../402311/index.html">Robots make the world clean</a></li>
<li><a href="../402313/index.html">How to manage sleep: direct effects on brain activity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>