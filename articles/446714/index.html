<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Curious perversions from the IT world - 4</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Daily WTF website has been collecting funny, wild and / or sad stories from the IT world for 15 years. I translated several stories that seemed in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Curious perversions from the IT world - 4</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://ic.pics.livejournal.com/egor_23/73280836/1707368/1707368_1000.jpg" alt="image"></div><br>  <a href="http://thedailywtf.com/">The Daily WTF</a> website has been collecting funny, wild and / or sad stories from the IT world for 15 years.  I translated several stories that seemed interesting to me.  All company names have been changed.  Previous issues can be found under the label " <a href="https://habr.com/ru/search/%3Fq%3D%255B%25D0%25BB%25D1%258E%25D0%25B1%25D0%25BE%25D0%25BF%25D1%258B%25D1%2582%25D0%25BD%25D1%258B%25D0%25B5%2520%25D0%25B8%25D0%25B7%25D0%25B2%25D1%2580%25D0%25B0%25D1%2589%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F%255D%26target_type%3Dposts">curious perversions</a> ." <br><br><h2>  The first story.  End of the <s>world</s> month </h2><br>  <a href="http://thedailywtf.com/articles/it-s-the-end-of-the-month-as-we-know-it">[Original]</a> <br><br>  If you ask a development engineer whether it is safe to walk across a bridge, he will be happy to tell you how reliable bridges are, how mathematics works in them, how far we have come in building safety issues.  After talking with him, you will get the impression that not a single bridge on Earth will ever fall apart.  But if you ask a software development engineer about banks, then you will most likely be horrified, and with a 50/50 probability, convince yourself to invest all the money in Bitcoin.  Banks are notorious for making bad software decisions when creating software ‚Äî not because these solutions are disgusting, but because most people assume banks are more careful and attentive to security. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Kato</b> works at Inibank, where a commercial product called T24 is used as the core of the banking system.  The T24 system is used by hundreds of banks around the world.  It can be customized for a wide range of banking solutions.  As is the case with most custom packages.  there are programmers specializing in writing code for it, and consultants who assist banks in making major updates. <br><a name="habracut"></a><br>  Inibank staff was loaded with work, so the bank invited a consultant to participate in a special project.  At the end of the working day, the bank conducted a process of completion of work, which is necessary for all the money to go where it was sent, recalculate all the necessary output data and run all the required reports.  In banks, this process also changes the system date to the next working day.  That is why when you do online banking on Sunday, no operation begins to be processed until Monday morning.  The consultant was to create a new report that would be performed during the completion process and included additional processing if the date was at the end of the month. <br><br>  Kato showed the new consultant how the end of the day reports are set up in the bank.  ‚ÄúYou see, we have global variables for the previous working day, for today, and for the next working day.  They are in YYMMDD format so that it‚Äôs easier to work with them. ‚Äù <br><br>  ‚ÄúYeah, yeah, got it.  Got it.  What format are they in? ‚Äù <br><br>  "... Uh-uh ... I can only assume that it is a year, a month and a day." <br><br>  ‚ÄúYeah, yeah, okay.  Fine.  Then I get to work. ‚Äù <br><br>  After this conversation, Kato got a bad feeling.  but he tried to get rid of him.  The consultant said that everything is set up and ready.  He knows exactly what he is doing, right?  Kato threw it out of his head and stopped worrying until it was time for code review and he didn‚Äôt find such a gem: <br><br><pre> <code class="hljs pgsql">TH.DATE = R.DATES(EB.DAT.NEXT.WORKING.DAY)[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>]:"01" <span class="hljs-keyword"><span class="hljs-keyword">CALL</span></span> CDT(<span class="hljs-string"><span class="hljs-string">'ES00'</span></span>,TH.DATE,"-1C") WTODAY = OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DY") : FMT(OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DM"),<span class="hljs-string"><span class="hljs-string">'R%2'</span></span>) : FMT(OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DD"),<span class="hljs-string"><span class="hljs-string">'R%2'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> TH.DATE EQ WTODAY <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span></code> </pre> <br>  We will explain briefly what is happening here: <br><br><ol><li>  We take the next working day and change the day to 01 to get the first day of the month. </li><li>  We change this date by subtracting 1 calendar day in Spain. </li><li>  We take the date from the server and translate it into the YYYYMMDD format by calling the Date command three times. </li><li>  If the date calculated in step 2 is equal to the date calculated in step 3, start the process. </li></ol><br>  Well, in general it ... works.  Mostly.  Unless for some reason the end of the day does not happen after midnight of the penultimate day of the month - and this is not so rare.  In this case, the code will mistakenly think that this is the last day of the month, and will start the creation of the report.  What goes well with another problem: if the same thing happens on the last day of the month, then the report creation will not be mistakenly launched.  And the best bug: if the last day of the month was Sunday, then the server calendar will never be installed on it, because it skips non-working days. <br><br>  Speaking of non-working days: since Inibank is in the USA, there is no reason to use the calendar of Spain.  Yes, the months and weeks will be the same, but in the Spanish software calendar you need to specify a bank holiday in the USA, otherwise the program will continue to work.  Finally, as if all this was not enough, a triple call to Date means that disagreements may arise when starting exactly at midnight: the month is requested before midnight and the day after. <br><br>  Kato added a comment suggesting how to change the code: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">IF</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">R</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DATES</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">EB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAT</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.TODAY</span></span>)<span class="hljs-selector-attr"><span class="hljs-selector-attr">[5,2]</span></span> # <span class="hljs-selector-tag"><span class="hljs-selector-tag">R</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DATES</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">EB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAT</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.LAST</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.WORKING</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAY</span></span>)<span class="hljs-selector-attr"><span class="hljs-selector-attr">[5,2]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">THEN</span></span></code> </pre> <br>  Five minutes later, the consultant went to his desk.  "What does this edit mean?" <br><br>  Kato was in no mood to argue at that moment.  ‚ÄúYour code is broken, friend.  All this is not necessary. " <br><br>  ‚ÄúI see, I see.  In fact, this is just a standard operating procedure for our industry.  Anyway". <br><br>  Kato doubted this, but he just shrugged.  ‚ÄúThen the industry is wrong.  I explained everything in the comments. ‚Äù <br><br>  ‚ÄúYeah.  Yes, I read it.  But I will read it again. ‚Äù  And he disappeared just as suddenly as he appeared. <br><br>  The edits were made, Kato approved the code and the consultant disappeared into a fog. <br><br>  Sometimes, lying in bed at night, Kato wondered: did the consultant really understand what he had done wrong, or did he simply agree for the show, received his check and continued to write a terrible code somewhere for a price twice as high as Kato?  In those banks where there are no employees capable of checking the code. <br><br>  But do not invest all the money in Bitcoin.  It's still worse there. <br><br><h2>  The second story.  How is it done </h2><br>  <a href="http://thedailywtf.com/articles/how-it-s-made">[Original]</a> <br><br>  People love eating hot dogs until they know how they are prepared.  Most do not ask because they do not want to know and continue to eat hot dogs.  When developing software, we sometimes <em>have to</em> ask.  Not only to solve problems, but also because some programmers are afraid that the software in their cars, rushing along the highway at a speed of 100 km / h, is assembled from electrical tape and sticks.  <a href="https://xkcd.com/2030/">Our entire industry is not doing its job well</a> . <br><br>  <strong>Brett</strong> worked as a systems analyst at the MedStitute Medical Research Center.  MedStitute used proprietary software called MedTech to store and analyze data.  Doctors and researchers liked the results of MedTech, but colleague Brett Tyree knew how they were created. <br><br>  The software did not have access to the backend, and the entire development process took place in a ‚Äúprogrammable mouse‚Äù GUI.  This interface looked as if it had been written by a person who studied the programming by copying and pasting the websites of the 1990s, who had looked at the ten minutes <em>of the Jurassic Park</em> and had been looking for answers to StackOverflow, until something could be compiled.  The ‚Äúprogramming language‚Äù also demonstrated a similar level of forethought of the design philosophy.  Every <code>if</code> had to have <code>else</code> .  Some modules used boolean values, while others returned empty lines to indicate false values.  From the documentation it was not clear in what situation one or the other happened.  In fact, each <code>if</code> turned into three statements. <br><br>  Brett needed to start a new study.  It was based on a simple set of statistics and grouped patients using a randomized variable.  Brett looked for a variable in the list that could be randomized, but could not find it.  He assumed that he had made a mistake and went back on several screens to check her name by copying it for searching.  Brett returned to the list of randomized variables.  She was not there.  He took a closer look at the list and noticed that the list of randomized variables contained data from multiple-choice fields.  The field he needed to randomize was based on a calculated field. <br><br>  Brett knew that Tyree was working on another project that was randomized by a calculated field, so I contacted him on Slack.  ‚ÄúHow did you code this random variable?  Doesn't Medtech allow this? ‚Äù <br><br>  ‚ÄúI speak from a conference call, call back later,‚Äù wrote Tyree. <br><br>  A few minutes later, Tyree called Brett. <br><br>  ‚ÄúYou need to start with two fields.  Let's say.  let's call them <code>$variable_choice</code> , that is, a multiple choice question, and <code>$variable_calced</code> , that is, your calculated field.  When you want to create a variable that performs a random selection based on a calculated field, you tell Medtech that this random variable is based on <code>$variable_choice</code> .  Then you delete <code>$variable_choice</code> , and rename <code>$variable_calced</code> to <code>$variable_choice</code> ¬ª <br><br>  ‚ÄúStop, the system allows you to do this, but does not allow you to randomize the calculated fields in some other way?  And she doesn't check it? ‚Äù <br><br>  ‚ÄúI hope nothing changes, and she will not begin to verify this until the completion of my project,‚Äù Tyri replied. <br><br>  ‚ÄúThis study should take place over ten years.  And its successful completion depends on whether the developers consider this trick to be a bug? ‚Äù <br><br>  ‚ÄúI managed to find only such a solution.  Let me know if you find something better. ‚Äù <br><br>  Brett did not satisfy such a hack, and he returned to studying the documentation.  He found a better solution: you can create a read-only multiple choice field with a single default value option ‚Äî the value of the calculated field.  Unfortunately, the user could inadvertently change the list by answering a multiple-choice question <em>before</em> calculating the value of the calculated field. <br><br>  In the end, the only thing Brett left was to take a break, go to the cafeteria and buy a couple of hot dogs. <br><br><h2>  The third story.  Portability and hardware </h2><br>  <a href="http://thedailywtf.com/articles/portage-and-portability">[Original]</a> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/52e/2cb/0c2/52e2cb0c2e0b8465a1b713aa60dfd474.jpg"></div><br>  Many moons ago, when the PCs had heavy metal and plastic cases, <b>Matt</b> and his colleague were assigned to evaluate the software package for the upcoming sales department operation.  Unfortunately, he and his colleague worked in different offices within the same city.  At that time, effective online collaboration tools did not exist, so Matt had to travel to another office regularly, taking PCs with him.  This meant that each time it was necessary to disconnect the peripherals from the 473 cable body, carry the computer along the corridors and down the stairs, catch the bus to get to the other office in which he did all this in the reverse order.  Sometimes the wrong organization of labor forced this couple to work on weekends, which means carrying the working machines home. <br><br>  In the process, the hard disk of 20 MB in Matt's computer overflowed.  From his office, he sent a request to the IT department.  To fulfill the application, Gary's technician was appointed, which after some time appeared in Matt's cubic, holding a new hard drive and a screwdriver.  Gary sent Matt over coffee to focus on his ‚Äúpatient.‚Äù  After a small surgery, Matt's PC turned on and started working with a large hard drive. <br><br>  The day before the project's deadline, Matt almost completed his share of the work.  He had only to make a few additions to his report, and then copy it to floppy disks and send it to the sales department.  Returning his PC to the cubicle and connecting the wires, he turned on the power and heard the clap.  The PC was dead and showed no signs of life. <br><br>  After a panic call to the IT department, Gary again appeared in his office with a screwdriver.  Having opened the PC case, he immediately yelled: ‚ÄúWait a minute!  Did you drag a computer somewhere? ‚Äù <br><br>  Matt frowned.  "Well yes.  What's the matter? ‚Äù <br><br>  ‚ÄúYes of course!  You shouldn't have done that! ‚ÄùGary began to curse.  ‚ÄúThe hard drive started to hang out and shorted everything inside!‚Äù <br><br>  Matt leaned over Gary to see the inside of the computer himself.  He immediately noticed that the new hard drive was "fixed" on the tape. <br><br>  "Stop!  You <i>should</i> n't have done this! ‚ÄùMatt pointed to a piece of scotch.  ‚ÄúDo I just need to contact your supervisor just in case?‚Äù <br><br>  Gary's face wrinkled.  "I do not give the necessary attachments!" <br><br>  "Then find the one who has them!" <br><br>  Given the impending deadline, with the permission of the chief, Matt passed on his application even higher.  Almost immediately, the adhesive tape was replaced with a real fastener.  He never understood <i>why</i> the IT staff did not have access to the necessary equipment;  He suggested that it was a brilliant idea of ‚Äã‚Äãsome kind of idiot to save money.  Matt could only guess what other desperate improvisations made it possible to ensure the efficiency of their IT infrastructure, and how long they would go unnoticed if his PC had not broken down. <br><br><h2>  The fourth story.  This is how PL / SQL affects your brain. </h2><br>  <a href="https://thedailywtf.com/articles/this-is-your-brain-on-pl-sql">[Original]</a> <br><br>  The eternal champion among the strangest and most unsuccessful decisions will always be <em>Oracle</em> .  Today we look at a little PL / SQL code. <br><br>  PL / SQL is a strange language, a mixture of SQL and <strong>P</strong> rocedural (procedural) <strong>L</strong> anguage (language) with side-oriented object orientation.  The syntax perfectly succeeds in creating the impression that it was developed in the 1970s, and each new function or language change continues this tradition. <br><br>  The structure of each PL / SQL code module is based on <em>blocks</em> .  Each block is an independent namespace.  In short, his anatomy looks like this: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-comment"><span class="hljs-comment">-- variable declarations go here BEGIN -- code goes here EXCEPTIONS -- exception handling code goes here, using WHEN clauses END;</span></span></code> </pre> <br>  If you are writing a stored procedure or event handler, then replace the <code>DECLARE</code> keyword with <code>CREATE [OR REPLACE]</code> .  You can also nest blocks inside other blocks, so you can often see code that is structured as follows: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-comment"><span class="hljs-comment">--stuff BEGIN --actions END; --more actions END;</span></span></code> </pre> <br>  Yes, pretty quickly it starts to get confusing.  And yes, if you want to provide at least approximately structured error handling, you <em>must</em> begin to put blocks into each other. <br><br>  Language and database have other fun features.  Prior to version 12c, they did not have an <code>IDENTITY</code> column type.  In previous versions, it was necessary to use the <code>SEQUENCE</code> object and write procedures or event handlers that perform forced automatic numbering.  Usually, a <code>SELECT INTO‚Ä¶</code> used to assign a value to a variable.  Bonus: Oracle SQL <em>always</em> requires the specification of a table in the <code>FROM</code> , so you need to use the invented <code>dual</code> table, like this: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRIGGER</span></span> <span class="hljs-string"><span class="hljs-string">"SOME_TABLE_AUTONUMBER"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEFORE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-string"><span class="hljs-string">"SOME_TABLE"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EACH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROW</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> myseq.nextval <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> :new.id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> dual; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre> <br>  <code>:new</code> in this context denotes a string for which we perform automatic numbering.  In older versions of Oracle, this was the ‚Äúusual‚Äù way to create columns with automatic numbering.  <strong>Benoit</strong> discovered another, slightly less common way of performing the same operation: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRIGGER</span></span> <span class="hljs-string"><span class="hljs-string">"SCHEMA1"</span></span>.<span class="hljs-string"><span class="hljs-string">"TABLE1_TRIGGER"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEFORE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-string"><span class="hljs-string">"SCHEMA1"</span></span>.<span class="hljs-string"><span class="hljs-string">"TABLE1"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EACH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROW</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> pl_error_id table1.error_id%<span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span>; CURSOR get_seq IS <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> table1_seq.nextval <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> dual; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OPEN</span></span> get_seq; FETCH get_seq INTO pl_error_id; IF get_seq%NOTFOUND THEN raise_application_error(-20001, 'Sequence TABLE1_SEQ does not exist'); CLOSE get_seq; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>; CLOSE get_seq; :new.error_id := pl_error_id; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> table1_trigger;</code> </pre> <br>  There is a lot going on here.  First, note that the <code>DECLARE</code> section contains a <code>CURSOR</code> statement.  Cursors allow you to iterate between records.  They are very expensive and in the Oracle world it is a resource that needs to be freed. <br><br>  This event handler (trigger) uses a nested block for no reason at all.  It also uses the additional variable <code>pl_error_id</code> , which you can do without. <br><br>  But the really weird part is the <code>IF get_seq%NOTFOUND</code> .  Everything is quite simple: it checks the condition that the cursor did not return a string.  This for this cursor can not happen even <em>theoretically</em> , so the operations inside are never performed.  A sequence always returns a value.  And this is <em>good</em> , given the code that goes on. <br><br>  <code>raise_application_error</code> is the ‚Äúthrow‚Äù equivalent in Oracle.  This statement climbs the stack of executable blocks until it finds the <code>EXCEPTIONS</code> section for handling the error.  Notice that we close the cursor <em>after</em> this statement ‚Äî that is, in fact, we <em>never</em> close the cursor.  Cursors, as mentioned above, are expensive, and Oracle allows you to use only a limited number of them. <br><br>  Here we see a strange example of how a developer tries to defend himself against an error that cannot occur, in a way that will eventually lead to new errors. <br><br><h2>  The fifth story.  Logins with double encryption </h2><br>  <a href="https://thedailywtf.com/articles/doubly-encrypted-logins">[Original]</a> <br><br>  Creating authentication for a web API is a <em>difficult</em> task, but it has <em>many</em> well-established solutions.  The most difficult thing is to choose one of the various options, after which you simply add the component. <br><br>  When properly implemented, the system does not depend on the type of client.  I can access the service through a browser, in a thick client, or through cURL.  With incorrect implementation, you get what happened to <strong>Amira</strong> . <br><br>  She solved the problem of pulling out the statistics she needed from the backend, but she could not figure out how to authenticate.  Therefore, she studied the frontend code to understand how it performs authentication: <br><br><pre> <code class="javascript hljs">crypt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JSEncrypt(); crypt.setPublicKey(<span class="hljs-string"><span class="hljs-string">'&lt;removed&gt;'</span></span>); challenge = <span class="hljs-string"><span class="hljs-string">"&lt;removed&gt;"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doChallengeResponse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value.replace(<span class="hljs-regexp"><span class="hljs-regexp">/&amp;/g</span></span>, <span class="hljs-string"><span class="hljs-string">'%26'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value.replace(<span class="hljs-regexp"><span class="hljs-regexp">/\\+/g</span></span>, <span class="hljs-string"><span class="hljs-string">'%2B'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value = crypt.encrypt(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.response.value = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.submit(); }</code> </pre> <br>  On the one hand, I can assume that this code is very old, given the <code>document.loginForm</code> used for interactions with DOM elements.  On the other hand, <code>JSEncrypt</code> was first released in 2013, which gives us the maximum age bar. <br><br>  We pass the access parameters to the backend by sending the form, which, according to the code developer, required clearing - all <code>&amp;</code> and <code>+</code> are replaced in the password, but ... this is not necessary because the form must perform a <code>POST</code> request and, in addition, <em>we encrypted the data</em> . <br><br>  That's what I think.  The code <em>is really</em> quite old.  The developer copied it from the post to StackOverflow in about 2005, which did not use encryption and form sending via <code>POST</code> .  Year after year small changes were added to it.  but the basic mechanism has never changed. <br><br>  Amira checked the story, and found that encryption was not used in the previous version.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The code concatenated the password with a variable </font></font><code>challenge</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, both of them were hashed by MD5, after which it transmitted </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">it</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to the network, and everything seemed to work, if you did not think too much about it. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There was a good side of things: when Amira figured out how to get the cookies she needed, the token life on the server never expired, so she could store it, send requests through cURL and no longer contact the web form. </font><font style="vertical-align: inherit;">She did not have to worry about compromising cookies during transmission, because the application </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uses and has always used SSL / TLS</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div><p>Source: <a href="https://habr.com/ru/post/446714/">https://habr.com/ru/post/446714/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../446704/index.html">The path of the programmer from working at the factory with a salary of 800 UAH to ‚Ç¨‚Ç¨‚Ç¨‚Ç¨ in top companies in Ukraine</a></li>
<li><a href="../446706/index.html">Parallel queries in PostgreSQL</a></li>
<li><a href="../446708/index.html">Comparison of space communication systems</a></li>
<li><a href="../446710/index.html">Four real histories of working with microservice architecture - report from the Backend United mitap 3: Kholodets</a></li>
<li><a href="../446712/index.html">HTTPS is not always as secure as it seems. Vulnerabilities found in 5.5% of HTTPS sites</a></li>
<li><a href="../446716/index.html">Consciousness and Doomsday Argument</a></li>
<li><a href="../446718/index.html">Review of the most interesting reports CodeFest 2019: the version of True Engineering</a></li>
<li><a href="../446722/index.html">Testing will show: how to prepare for the implementation of Cisco ISE and understand what features of the system you need</a></li>
<li><a href="../446728/index.html">How does the received power from the wireless charging, depending on the location of the phone</a></li>
<li><a href="../446730/index.html">Backend section on DUMP: Serverless, Postgres and Go, .NET Core, GraphQL and more</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>