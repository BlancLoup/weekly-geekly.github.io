<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Realization of live viewing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Problem 
 I would like to give users the opportunity to quickly view the data in the editing process, so that it does not work out that after sending ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Realization of live viewing</h1><div class="post__text post__text-html js-mediator-article">  <b>Problem</b> <br>  I would like to give users the opportunity to quickly view the data in the editing process, so that it does not work out that after sending from the form, the data appeared in a corrupted format (when it comes to, for example, the diary entry, which they are going to put on public display). <br><br><a name="habracut"></a><br>  <b>Decision</b> <br>  Live viewing is easy with the built-in Rails JavaScript helpers.  For this recipe, we will manage the creation of an on-line viewing of the simplest form intended for creating a diary entry. <br>  The first thing to do when creating any Rails effect associated with using Ajax is to ensure that the necessary JavaScript libraries are included in the code.  To achieve the effect of real-time viewing, you need to include only one library - Prototype.  I recommend doing this in the main application template (in our case, in the layouts / standard.rhtml file): <br><br><blockquote>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">html</font> <font color="#0000ff">&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">head</font> <font color="#0000ff">&gt;</font></font> <font color="black"><br></font>  <font color="black"><font>&lt;%</font> = javascript_include_tag <font color="#A31515">"prototype"</font> <font>%&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;/</font> <font color="#800000">head</font> <font color="#0000ff">&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">body</font> <font color="#0000ff">&gt;</font></font> <font color="black"><br></font>  <font color="black">...</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;/</font> <font color="#800000">body</font> <font color="#0000ff">&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;/</font> <font color="#800000">html</font> <font color="#0000ff">&gt;</font></font> <font color="gray">* This code was highlighted with <a href="http://source.virtser.net/"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br>  Now, after loading the required JavaScript libraries, you need to create a model and controller that will support the input of diary entries.  We will call the Entry model class, passing it the title and body properties.  If you want to continue working without defining the corresponding Active Record table, then the file app / models / entry.rb should take the following form: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote>  <font color="black"><font color="#0000ff">class</font> Entry</font> <font color="black"><br></font>  <font color="black">attr_accessor: title,: body</font> <font color="black"><br></font>  <font color="black">end</font> <font color="gray">this source code was highlighted with <a href="http://source.virtser.net/"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br><br>  The controller will be called DiaryController.  We will create it in app / control-lers / diary_controller.rb.  Let's stick to the basics, and call the action to create a new record new (): <br><br><blockquote>  <font color="black">def <font color="#0000ff">new</font></font> <font color="black"><br></font>  <font color="black"><a href="https://habrahabr.ru/users/entry/" class="user_link">entry</a> = Entry.</font>  <font color="black"><font color="#0000ff">new</font></font> <font color="black"><br></font>  <font color="black">end</font> <font color="gray">this source code was highlighted with <a href="http://source.virtser.net/"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br><br>  Now it is the turn of the function itself.  In the presentation created for this action, all our magic will be created.  Create the file app / views / diary / new.rhtml and give it the following view: <br><br><blockquote>  <font color="black"><font>&lt;%</font> form_tag ({: action =&gt; <font color="#A31515">"save"</font> },: id =&gt; <font color="#A31515">"entry-form"</font> ) <font color="#0000ff">do</font> <font>%&gt;</font></font> <font color="black"><br></font>  <font color="black"><font>&lt;%</font> = text_field: entry,: title <font>%&gt;</font> &lt;br /&gt;</font> <font color="black"><br></font>  <font color="black"><font>&lt;%</font> = text_area: entry,: body <font>%&gt;</font> &lt;br /&gt;</font> <font color="black"><br></font>  <font color="black"><font>&lt;%</font> = submit_tag <font color="#A31515">"Save"</font> <font>%&gt;</font></font> <font color="black"><br></font>  <font color="black"><font>&lt;%</font> end - <font>%&gt;</font></font> <font color="black"><br><br></font>  <font color="black"><font>&lt;%</font> = observe_form <font color="#A31515">"entry-form"</font> ,</font> <font color="black"><br></font>  <font color="black">: frequency =&gt; 2,</font> <font color="black"><br></font>  <font color="black">: update =&gt; <font color="#A31515">"live preview"</font> ,</font> <font color="black"><br></font>  <font color="black">: complete =&gt; <font color="#A31515">"Element.show ('live-preview')"</font> ,</font> <font color="black"><br></font>  <font color="black">: url =&gt; {: action =&gt; <font color="#A31515">"preview"</font> } <font>%&gt;</font></font> <font color="black"><br><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">id</font> <font color="#0000ff">= "live preview"</font> <font color="#ff0000">style</font> <font color="#0000ff">= "display: none;</font></font>  <font color="black"><font color="#0000ff">border: 1px solid "</font> <font color="#0000ff">&gt; &lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font></font> <font color="gray">* This code was highlighted with <a href="http://source.virtser.net/"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br><br>  We have created a standard, universal form with an id that has an entry-form value, so you can refer to it from the rest of the code.  The form definition is followed by a call to the assistant observe_form (), which generates the required JavaScript code to poll each form element displayed on the page (referring to it by id) and search for changes.  The survey will be conducted at intervals of time (in seconds) specified by the frequency parameter.  As soon as changes are noticed, a call will be sent to the URL defined by the parameter: url, to which the form data will be passed as parameters.  The: update parameter defines the HTML element (again by its id), which will be updated with the results of the URL call.  In this case, the contents of the element that is used for live viewing will be updated so that it will ultimately be sent as a result of a call to the preview () action. <br>  To make the live view element invisible when the page was initially loaded, we used inline CSS.  Until the user enters any data, there will be nothing to show in the online view item.  The parameter: complete, passed to the assistant observe_form (), instructs that after the completion of the call to the action preview (), the execution of the JavaScript fragment, which will include the display of the operational view element. <br>  If only one field needs to be displayed in the live view, we can use the observe_field () helper instead. <br>  Now it remains to ensure the execution of the action preview ().  Here is the code taken from the controller: <br><br><blockquote>  <font color="black">def preview</font> <font color="black"><br></font>  <font color="black">render: layout =&gt; <font color="#0000ff">false</font></font> <font color="black"><br></font>  <font color="black">end</font> <font color="gray">this source code was highlighted with <a href="http://source.virtser.net/"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br><br>  The only task performed by the action code is to ‚Äúshort-circuit‚Äù the usual data sending scheme used in the application.  Since we are going to update the live view item on the daily diary creation page and use only the results returned by the preview () action for this purpose, it is not required to return the entire HTML page.  We need only a passage that has a definite meaning in the composition of the larger content of the screen. <br>  The view intended for the preview () action is in the file app / views / diary / preview.rhtml and should look like this: <br><br><blockquote>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">h2</font> <font color="#0000ff">&gt;</font> Preview: <font color="#0000ff">&lt;/</font> <font color="#800000">h2</font> <font color="#0000ff">&gt; &lt;br</font> <font color="#800000">/&gt;</font></font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">h3</font> <font color="#0000ff">&gt;</font> <font>&lt;%</font> = <font color="#0000ff">params</font> [: entry] [: title] <font>%&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">h3</font> <font color="#0000ff">&gt;</font></font> <font color="black"><br></font>  <font color="black"><font>&lt;%</font> = textilize <font color="#0000ff">params</font> [: entry] [: body] <font>%&gt;</font></font> <font color="black"><br></font>  <font color="gray">* This source code was highlighted with <a href="http://source.virtser.net/"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br><br>  That's all!  This view uses the HTML header for the title of the entry, and then, using the textilize () method, generates the HTML output.  Inside this method, the RedCloth library is used to convert simple textual markup to HTML. <br>  Now you can load the diary entry form and see how plain text is converted to HTML before you click the Save button. <br> <a href=""><img title="screenshot__" src="http://leopard.in.ua/wp-content/uploads/2008/09/screenshot__.png" width="499" height="463"></a> <br><br>  <b>PS</b> <br>  The frequency parameter used in the observe_field () and observe_form () methods can be assigned a zero or negative value, which will lead to a real-time field survey.  It would seem that there may be a bad instantaneous user interface response, but in fact it will be suppressed, not to mention the additional heavy load on the servers.  When tracking changes in real time, each change will trigger a request to the server, from which you need to wait for the result to see the update on the screen.  Changes are queued, as a result of which the live view updates slowly follow them, waiting for the next interception. <br><br>  Crosspost from <a href="http://leopard.in.ua/2008/09/03/realizaciya-operativnogo-prosmotra/">my blog</a> <br><br>  <b>PS</b> <br>  Yes, please, if something is not clear to you - write in comments.  Stop minus karma for topics that seem to (IMHO) carry useful information. </div><p>Source: <a href="https://habr.com/ru/post/38893/">https://habr.com/ru/post/38893/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../38876/index.html">Ruby v8</a></li>
<li><a href="../38883/index.html">We are repairing the Dallas chip with a dead battery in the IBM 55SX</a></li>
<li><a href="../38884/index.html">Bypass password protection in documents ms word. (OFFICE11)</a></li>
<li><a href="../38886/index.html">IT journalist vacancy at ITC.UA</a></li>
<li><a href="../38892/index.html">Programmer graphophilia</a></li>
<li><a href="../38896/index.html">NConsoler - parsing console application arguments</a></li>
<li><a href="../38897/index.html">About business lynch, Chrome and people.</a></li>
<li><a href="../38900/index.html">Google is set to launch a new satellite, GeoEye-1</a></li>
<li><a href="../38901/index.html">Want to know the most expensive clicks in a runner?</a></li>
<li><a href="../38902/index.html">MDC: beta release of a new multi-protocol messenger</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>