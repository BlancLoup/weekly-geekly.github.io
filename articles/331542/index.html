<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Guide: how to use Python for algorithmic trading on the exchange. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Technology has become an asset - financial institutions are now not only engaged in their core business, but are paying a lot of attention to new deve...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Guide: how to use Python for algorithmic trading on the exchange. Part 1</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/itinvest/blog/331542/"><img src="https://habrastorage.org/web/ae7/bc3/f82/ae7bc3f8279f40dabc93bc979768a45f.png"></a> <br><br>  Technology has become an asset - financial institutions are now not only engaged in their core business, but are paying a lot of attention to new developments.  We have already told that in the world of high-frequency trading, the owners of not only the most efficient, but also fast software and hardware achieve the best results. <br><br>  Among the most popular in the field of finance programming languages ‚Äã‚Äãcan be noted R and Python, C ++, C # and Java are also often used.  A <a href="https://www.datacamp.com/community/tutorials/finance-python-trading">guide</a> published on the DataCamp website talks about how to start using Python to create financial applications - we present you a series of articles-adaptations of the chapters of this material. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Management structure: <br><br><ul><li>  The first part is intended for newcomers to the market, it will focus on the structure of financial markets, stocks and trading strategies, time series data, and what is needed to start developing. </li><li>  In the second part, an introduction to working with time series data and financial analysis tools, such as calculating volatility and moving averages, will be presented using the Pandas Python library. </li><li>  Then we proceed to the immediate development of a simple impulse trading strategy. </li><li>  The fourth part will discuss how to conduct backtesting strategies on historical data. </li><li>  In conclusion, the issues of strategy optimization for increasing its productivity, as well as evaluation of its work and reliability will be touched upon. </li></ul><br><h2>  Introduction: simple language about the sphere of finance </h2><br>  Before plunging into the world of trading strategies, it makes sense to touch on basic concepts.  However, this does not mean that what will be discussed below is intended entirely for beginners.  It would be great if you first familiarize yourself with the course on using <a href="https://www.datacamp.com/courses/intro-to-python-for-data-science">Python to work with data</a> , and also imagine how to work with lists and Python packages, as well as at least at a basic level are familiar with NumPy and Pandas. <br><br><h2>  Shares and trading on the stock exchange </h2><br>  When a company wants to continue developing its business, launch new projects or expand, it can use stocks as a financing instrument.  A share represents a share in the ownership of a company; shares are exchanged for money.  Shares can be bought and sold: participants in such transactions conduct transactions with existing, previously issued shares. <br><br>  The price at which a particular stock will be sold or bought may constantly change, regardless of the business performance of the issuing company stock: everything is determined by supply and demand.  It is important to understand the difference between stocks and, for example, bonds (bonds), which are used to attract borrowed funds. <br><br>  When it comes to trading, not only the sale and purchase of shares can be considered - a transaction can be concluded for various assets, including financial instruments and, for example, precious metals or resources like oil. <br><br>  When buying shares, the investor gets a certain share in the company, from which he can gain financial gain in the future by selling this share.  Strategies may vary: there are long deals (long) concluded in the hope of further growth of the shares, and short ones when the investor assumes that the shares will become cheaper, therefore he sells the shares in the hope of ‚Äúbuying back‚Äù them at a lower price in the future. <br><br>  Developing a trading strategy involves several stages, which is similar, for example, to building machine learning models: first you need to formulate a strategy and describe it in a format that allows you to run it on a computer, then you need to test the performance of the resulting program, optimize it, and then evaluate the performance and reliable performance. <br><br>  Trading strategies are usually tested using backtesting: this is an approach in which the strategy is ‚Äúrun‚Äù on historical trading data ‚Äî based on them, the program generates transactions.  This makes it possible to understand whether such a strategy would bring an income given the development of the market situation that was observed in the past.  Thus, it is possible to preliminarily assess the prospects of a strategy in real-time trading.  At the same time, there are no guarantees that good indicators on historical data will be repeated when working in the real market. <br><br><h2>  Time series data </h2><br>  A time series is a sequence of digital data received at consecutive equal intervals of time.  In the field of finance, such series are used to track price movements over a certain period of time, recorded at equal intervals.  Here is what it looks like: <br><br><img src="https://habrastorage.org/web/8e9/d94/84d/8e9d9484d8874cf8b2d10d6c2e01a7ff.png"><br><br>  Dates are located on the X axis, and the price is on the Y axis. "Consecutive equal intervals of time" in this case means that the dates on the time axis are located at a two-week interval: you can compare 3/7/2005 and 3/31/2005, and 4/5/2005 and 4/19/2005 ( <i>here the dates are recorded in the format adopted in the USA, when the month first comes and then the day</i> ). <br><br>  However, financial data usually includes not two parameters (price and date), but five - in addition to the value of the trading period, it is the opening price of the trading period, the highest and lowest price within it, as well as the price at the time of the closing period.  This means that if we consider the day period, the data analysis will give us information about the level at which the price was at the start and end of trading on the selected day, as well as the maximum and minimum price during the bidding. <br><br>  Above, we have described the basic concepts that you need to know in order to continue studying this manual. <br><br><h2>  Basics of Python for Finance: Pandas </h2><br>  One of the most popular tools when using Python to develop financial applications is the Pandas package.  It is needed at the very beginning, but as you go deeper into the development process, you will also need packages such as NumPy, SciPy, Matplotlib. <br><br>  First, focus on Pandas and apply this tool to time series analysis.  Below we will discuss how to use this package to import data, analyze and manipulate it. <br><br><h3>  Import Financial Data </h3><br>  The pandas-datareader package allows you to receive data from sources such as Google, Yahoo!  Finance or the World Bank - for more information about the available data sources, see the <a href="https://pandas-datareader.readthedocs.io/en/latest/remote_data.html">documentation</a> .  This tutorial will look at getting data from Yahoo!  Finance.  To get started, you need to install the latest version of the package using pip: <br><br><pre><code class="python hljs">pip install pandas-datareader</code> </pre> <br>  Installation instructions for the development version are presented <a href="https://github.com/pydata/pandas-datareader/">here</a> . <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas_datareader <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pdr <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datetime aapl = pdr.get_data_yahoo(<span class="hljs-string"><span class="hljs-string">'AAPL'</span></span>, start=datetime.datetime(<span class="hljs-number"><span class="hljs-number">2006</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), end=datetime.datetime(<span class="hljs-number"><span class="hljs-number">2012</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>))</code> </pre> <br>  Not so long ago there were changes in the Yahoo API, so to start independent work with the library, you need to install patches that will allow you to wait for the official patch.  More problem is described <a href="https://github.com/pydata/pandas-datareader/issues/315">here</a> .  However, for this guide, the data was downloaded in advance, so that problems with its study will not arise. <br><br>  It is also important to understand that despite the fact that pandas-datareader is a handy tool for loading data, it is not the only one for Python.  You can also use libraries like Quandl, which <a href="https://www.quandl.com/tools/python">allows you</a> to receive data from the Google Finance service: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> quandl aapl = quandl.get(<span class="hljs-string"><span class="hljs-string">"WIKI/AAPL"</span></span>, start_date=<span class="hljs-string"><span class="hljs-string">"2006-10-01"</span></span>, end_date=<span class="hljs-string"><span class="hljs-string">"2012-01-01"</span></span>)</code> </pre> <br>  Also, many people know that in the field of finance Excel is very popular for data analysis.  For the convenience of future work, you can integrate this tool with Python (for more information <a href="https://www.datacamp.com/community/tutorials/python-excel-tutorial">, click here</a> ). <br><br><h3>  Work with time series data </h3><br>  To import data, we used pandas_datareader.  As a result, the aapl object appeared - this is a DataFrame, that is, a two-dimensional named data structure with columns of potentially different types.  The first thing to do when working with such a frame is to run the head () and tail () functions in order to look at the first and last columns of the data frame.  To obtain a useful statistical summary of the downloaded data, use the describe () function. <br><br>  An example of this code can be found on <a href="https://www.datacamp.com/community/tutorials/finance-python-trading">the source page</a> . <br><br>  The data contains four columns with the price of opening and closing of the trading period, as well as the maximum and minimum price - we consider the daily intervals and stocks of Apple.  We also get two additional columns: Volume and Adj Close.  The first one is used to fix the number of shares with which deals were made on a trading day.  The second column is the ‚Äúadjusted closing price‚Äù, which means that all actions with stocks that could have been made before the opening of the next trading day were added to the closing price of the period. <br><br>  If you need to save data to a CSV file, you can do this with the help of the to_csv () function, and you can read the file with read_csv () - this is useful for situations when the data source changes and access to it is temporarily lost. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd aapl.to_csv(<span class="hljs-string"><span class="hljs-string">'data/aapl_ohlc.csv'</span></span>) df = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'data/aapl_ohlc.csv'</span></span>, header=<span class="hljs-number"><span class="hljs-number">0</span></span>, index_col=<span class="hljs-string"><span class="hljs-string">'Date'</span></span>, parse_dates=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br>  After a basic analysis of the downloaded data, it's time to move on.  To do this, you can, for example, examine the indices and columns by selecting, for example, the ten last rows of a specific column.  This is called subsetting, since only a small set of available data is taken.  The resulting subset is a series, that is, a one-dimensional named array. <br><br>  In order to look at the index and data columns, use the attributes index and columns.  You can then select a subset of the ten most recent observations in column.  To isolate these values, use square brackets.  The last value is placed in the ts variable, and its type is checked using the type () function. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Inspect the index aapl.index # Inspect the columns aapl.columns # Select only the last 10 observations of `Close` ts = aapl['Close'][-10:] # Check the type of `ts` type(ts)</span></span></code> </pre> <br>  Using square brackets is convenient, but this is not the most characteristic way of working with Pandas.  Therefore, it is also worth considering the functions loc () and iloc (): the first one is used for label-based indexing, and the last one is used for positional indexing. <br><br>  In practice, this means that you can pass a label of a series like 2007 or 2006-11-01 to the loc () function, and whole numbers like 22 or 43 are passed to the iloc () function. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Inspect the first rows of November-December 2006 print(aapl.loc[pd.Timestamp('2006-11-01'):pd.Timestamp('2006-12-31')].head()) # Inspect the first rows of 2007 print(aapl.loc['2007'].head()) # Inspect November 2006 print(aapl.iloc[22:43]) # Inspect the 'Open' and 'Close' values at 2006-11-01 and 2006-12-01 print(aapl.iloc[[22,43], [0, 3]])</span></span></code> </pre> <br>  If you take a close look at the results of the partitioning procedure, you will see that certain days are missing in the data.  Further analysis of the pattern will show that usually two or three days are missing.  These are weekends and public holidays, during which there is no exchange trading. <br><br>  In addition to indexing, there are several ways to learn more about data.  You can, for example, try to create a sample of 20 lines of data, and then reformat them so that appl becomes a non-daily value and monthly.  This can be done using the sample () and resample () functions: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Sample 20 rows sample = aapl.sample(20) # Print `sample` print(sample) # Resample to monthly level monthly_aapl = aapl.resample('M').mean() # Print `monthly_aapl` print(monthly_aapl)</span></span></code> </pre> <br>  Before proceeding to data visualization and financial analysis, you can begin to calculate the difference between the opening and closing prices of the trading period.  This arithmetic operation can be done using Pandas ‚Äî subtract the values ‚Äã‚Äãof the Open column of the appl data from the Close column.  Or, in other words, subtract aapl.Close from aapl.Open.  The result will be stored in a new column in the aapl data frame, called diff, which can be removed using the del function: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Add a column `diff` to `aapl` aapl['diff'] = aapl.Open - aapl.Close # Delete the new `diff` column del aapl['diff']</span></span></code> </pre> <br>  The resulting absolute values ‚Äã‚Äãmay already be useful in developing a financial strategy, but usually a more in-depth analysis is required, for example, the percentage values ‚Äã‚Äãof a rise or fall in the price of a certain stock. <br><br><h2>  Time Series Data Visualization </h2><br>  In addition to analyzing data using the functions head (), tail () and indexing, it is also possible to visualize them.  Thanks to the integration of Pandas with the Matplotlib graphing tool, this can be done quite easily.  It is only necessary to use the plot () function and pass it the relevant parameters.  In addition, if you add the grid parameter, the resulting graph will be superimposed on the grid. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Import Matplotlib's `pyplot` module as `plt` import matplotlib.pyplot as plt # Plot the closing prices for `aapl` aapl['Close'].plot(grid=True) # Show the plot plt.show()</span></span></code> </pre> <br>  This code gives the following schedule: <br><br><img src="https://habrastorage.org/web/d45/b98/2f4/d45b982f40cb48edae5ac4048187dc73.png"><br><br>  The next part of this tutorial focuses on the financial analysis of time series data using Python. <br><br>  <i>To be continued‚Ä¶..</i> <br><br><h2>  Other materials on finance and stock market from <a href="http://www.itinvest.ru/services/">ITinvest</a> : </h2><br><ul><li>  <a href="http://www.itinvest.ru/education/">ITinvest</a> educational resources </li><li>  <a href="http://www.itinvest.ru/analytics/">Analytics and market reviews</a> </li><li>  <a href="https://habrahabr.ru/post/275663/">What could be a stack of technologies for high-frequency trading</a> </li><li>  <a href="https://habrahabr.ru/post/271493/">Infrastructure and trading robots: What programming languages ‚Äã‚Äãare used in finance</a> </li><li>  <a href="https://habrahabr.ru/post/269367/">Experiment: Is it possible to create an effective trading strategy using machine learning and historical data</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/331542/">https://habr.com/ru/post/331542/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331532/index.html">Integration of scenario testing in the development of solutions based on the 1C platform</a></li>
<li><a href="../331534/index.html">The source code of the Windows 10 operating system has leaked to the network [small part]</a></li>
<li><a href="../331536/index.html">We transfer grades from Imhonet to the Must App</a></li>
<li><a href="../331538/index.html">Russia vs Mexico: a historic robots football game driven by fans via Twitter</a></li>
<li><a href="../331540/index.html">Static call script</a></li>
<li><a href="../331544/index.html">Mikrotik: Balancing in the CPSU and the observance of speed limits</a></li>
<li><a href="../331546/index.html">Installing ArchLinux ARM next to Android without chroot</a></li>
<li><a href="../331548/index.html">Connect: Modern Frontend Tips</a></li>
<li><a href="../331552/index.html">Autoencoders in Keras, Part 3: Variational autoencoders (VAE)</a></li>
<li><a href="../331554/index.html">New features of C # that can be expected soon</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>