<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Python cluster analysis</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The wonderful book ‚ÄúWe Program Collective Mind‚Äù inspired me to write this post based on her motives on cluster analysis. 

 There was a desire in one ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Python cluster analysis</h1><div class="post__text post__text-html js-mediator-article"> The wonderful book ‚ÄúWe Program Collective Mind‚Äù inspired me to write this post based on her motives on cluster analysis. <br><br>  There was a desire in one post to consider cluster analysis, its beautiful implementation in Python, and, especially, the visual representation of clusters - <b>dendrograms</b> . <br><br>  The code of the example is based on the code of the examples from the book. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The main idea of ‚Äã‚Äãcluster analysis is the selection among a multitude of data groups within which the elements are to some extent similar.  As part of this analysis, in fact, there is a certain classification of the studied data due to their distribution into groups.  These groups are arranged hierarchically and the structure of the clusters that have been obtained after the analysis can be represented as a tree - dendrogram (‚Äúdendro‚Äù, as is well known, in Greek, ‚Äútree‚Äù). <br><br>  The measure of similarity for each problem can be given its own, but the simplest are the <i>Euclidean distance</i> and <i>the Pearson correlation coefficient</i> .  The example deals with the Pearson correlation coefficient, but it can be easily replaced. <br><br>  In general, historically, cluster analysis became the most popular in the humanities, and one of the first tasks for which it was used was the analysis of data on ancient burials. <br><br>  The cluster construction algorithm is, in principle, simple and logical. <br><br>  <b>The initial data</b> for the algorithm is a list of some elements and a function of similarity between them (the "proximity" of elements).  Each element has ‚Äúcoordinates‚Äù in a certain space (for example, in the space of numbers of words), by which the similarity between the elements is calculated. <br><br>  Example: elements - blogs, 2 "coordinates" - the number of words "php" and "xml" in the content of blogs. <br>  The blog number 1 - 7 times found the word "php" and 5 times "xml".  Then the ‚Äúcoordinates‚Äù of the blog ‚Ññ1 in the space of the number of these words are (7; 5). <br>  Blog # 2 has the word ‚Äúphp‚Äù 6 times and ‚Äúxml‚Äù 4 times.  Then the ‚Äúcoordinates‚Äù of the blog ‚Ññ2 in the space of the number of these words is (6; 4). <br>  The similarity is determined by the function - Euclidean distance. <br> <code>d(blog1, blog2) = sqrt( (7-6)^2 + (5-4)^2) = 1.414 <br></code> <br><br>  <b>At the output</b> we get a tree of clusters (cluster hierarchy). <br><br>  <b>The algorithm works as follows:</b> <br>  1) Step 1: Count each element of the source list as a cluster and add them to <i>the merge list</i> <br>  2) Step 2 - N: Find the closest clusters and merge them into a new one (the ‚Äúcoordinates‚Äù of the new - the half-sum of the ‚Äúcoordinates‚Äù being joined).  Add a new <i>union</i> to the <i>list</i> , and remove original clusters from the <i>list</i> .  Thus, at each step in <i>the merge list, there</i> are fewer elements. <br><br>  <b>Stop criterion</b> : presence of only one cluster in <i>the merge list</i> , which can no longer be merged (getting one, ‚Äúroot‚Äù cluster) <br><br>  This algorithm is implemented by the hcluster function: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  def hcluster (rows, distance = pearson): </li><li>  distances = {} </li><li>  currentclustid = -1 </li><li></li><li>  # Clusters are initially just the rows </li><li>  clust = [bicluster (rows [i], id = i) <font color="#0000ff">for</font> i <font color="#0000ff">in</font> range (len (rows))] </li><li></li><li>  <font color="#0000ff">while</font> len (clust)&gt; 1: </li><li>  lowestpair = (0,1) </li><li>  closest = distance (clust [0] .vec, clust [1] .vec) </li><li></li><li>  # loop through every distance </li><li>  <font color="#0000ff">for</font> i <font color="#0000ff">in</font> range (len (clust)): </li><li>  <font color="#0000ff">for</font> j <font color="#0000ff">in</font> range (i + 1, len (clust)): </li><li>  # distance <font color="#0000ff">is</font> </li><li>  <font color="#0000ff">if</font> (clust [i] .id, clust [j] .id) not <font color="#0000ff">in</font> distances: </li><li>  distance [(clust [i] .id, clust [j] .id)] = distance (clust [i] .vec, clust [j] .vec) </li><li></li><li>  d = distances [(clust [i] .id, clust [j] .id)] </li><li></li><li>  <font color="#0000ff">if</font> d &lt;closest: </li><li>  closest = d </li><li>  lowestpair = (i, j) </li><li></li><li>  # calculate the average of the two clusters </li><li>  mergevec = [ </li><li>  (clust [lowestpair [0]]. vec [i] + clust [lowestpair [1]]. vec [i]) / 2.0 </li><li>  <font color="#0000ff">for</font> i <font color="#0000ff">in</font> range (len (clust [0] .vec))] </li><li></li><li>  # create the <font color="#0000ff">new</font> cluster </li><li>  newcluster = bicluster (mergevec, left = clust [lowestpair [0]], </li><li>  right = clust [lowestpair [1]], </li><li>  distance = closest, id = currentclustid) </li><li></li><li>  # cluster ids that weren't <font color="#0000ff">in</font> the original set are negative </li><li>  currentclustid- = 1 </li><li>  del clust [lowestpair [1]] </li><li>  del clust [lowestpair [0]] </li><li>  clust.append (newcluster) </li><li></li><li>  <font color="#0000ff">return</font> clust [0] </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  The example will be considered an example of cluster analysis of the contents of programming blogs.  The book deals with English-language blogs, but I decided to analyze 35 Russian-language terms of English-speaking terms.  To display the results of the analysis, the names of the blogs had to be translated using a small library. <br><br>  The full archive with all the necessary files and scripts in Python can be downloaded - <a href="http://narod.ru/disk/16504028000/clusters.zip.html">clusters.zip</a> <br>  The composition of the archive: <br> <code>blogdata.txt ‚Äì       <br> clusters.py -    <br> draw_dendrograms.py -        (   clusters.py) <br> feedlist.txt -  RSS    <br> generatefeedvector.py -        blogdata.txt <br> <br> translit.py, utils.py -      <br> <br></code> <br><br>  feedlist.txt with a list of RSS blogs, you can take, for example, such content (taken from the search <a href="">http://lenta.yandex.ru/feed_search.xml?text=programming</a> ): <br> <code><a href="http://feeds.feedburner.com/nayjest"></a> <a href=""></a> <a href="http://feeds2.feedburner.com/simplecoding"></a> <a href="http://feeds2.feedburner.com/nickspring"></a> <a href="http://feeds2.feedburner.com/Sribna"></a> <a href="http://community.livejournal.com/ru_cpp/data/rss"></a> <a href="http://community.livejournal.com/ru_lambda/data/rss"></a> <a href="http://feeds2.feedburner.com/rusarticles"></a> <a href="http://feeds2.feedburner.com/Jstoolbox"></a> <a href="http://feeds2.feedburner.com/rsdn/cpp"></a> <a href="http://4matic.wordpress.com/feed/"></a> <a href="http://www.nowa.cc/external.php%3Ftype%3DRSS2"></a> <a href="http://www.gotdotnet.ru/blogs/gaidar/rss/"></a> <a href="http://community.livejournal.com/ru_programmers/data/rss"></a> <a href="http://www.compdoc.ru/rssdok.php"></a> <a href="http://feeds2.feedburner.com/rsdn/philosophy"></a> <a href="http://softwaremaniacs.org/blog/feed/"></a> <a href="http://community.livejournal.com/new_ru_php/data/rss"></a> <a href=""></a> <a href="http://feeds2.feedburner.com/5an"></a> <a href=""></a> <a href="http://feeds.feedburner.com/mrkto"></a> <a href="http://rbogatyrev.livejournal.com/data/rss"></a> <a href="http://feeds2.feedburner.com/poisonsblog"></a> <a href="http://community.livejournal.com/ruby_ru/data/rss"></a> <a href="http://feeds2.feedburner.com/devoid"></a> <a href=""></a> <a href="http://feeds2.feedburner.com/rsdn/decl"></a> <a href="http://feeds2.feedburner.com/Toeveryonethe"></a> <a href=""></a> <a href="http://feeds2.feedburner.com/Freshcoder"></a> <a href=""></a> <a href="http://feeds2.feedburner.com/RuRubyRails"></a> <a href="http://feeds2.feedburner.com/bitby"></a> <a href=""></a> feeds.feedburner.com/nayjest <br> www.codenet.ru/export/read.xml <br> feeds2.feedburner.com/simplecoding <br> feeds2.feedburner.com/nickspring <br> feeds2.feedburner.com/Sribna <br> community.livejournal.com/ru_cpp/data/rss <br> community.livejournal.com/ru_lambda/data/rss <br> feeds2.feedburner.com/rusarticles <br> feeds2.feedburner.com/Jstoolbox <br> feeds2.feedburner.com/rsdn/cpp <br> 4matic.wordpress.com/feed <br> www.nowa.cc/external.php?type=RSS2 <br> www.gotdotnet.ru/blogs/gaidar/rss <br> community.livejournal.com/ru_programmers/data/rss <br> www.compdoc.ru/rssdok.php <br> feeds2.feedburner.com/rsdn/philosophy <br> softwaremaniacs.org/blog/feed <br> community.livejournal.com/new_ru_php/data/rss <br> www.newsrss.ru/mein_rss/rss_cdata.xml <br> feeds2.feedburner.com/5an <br> subscribe.ru/archive/comp.soft.prog.linuxp/index.rss <br> feeds.feedburner.com/mrkto <br> rbogatyrev.livejournal.com/data/rss <br> feeds2.feedburner.com/poisonsblog <br> community.livejournal.com/ruby_ru/data/rss <br> feeds2.feedburner.com/devoid <br> rgt.rpod.ru/rss.xml <br> feeds2.feedburner.com/rsdn/decl <br> feeds2.feedburner.com/Toeveryonethe <br> www.osp.ru/rss/Software.rss <br> feeds2.feedburner.com/Freshcoder <br> blogs.technet.com/craftsmans_notes/rss.xml <br> feeds2.feedburner.com/RuRubyRails <br> feeds2.feedburner.com/bitby <br> opita.net/rss.xml <br></code> <br><br>  The program for constructing dendrograms itself consists of 2 scripts (data collection + processing), which are launched sequentially: <br> <code>python generatefeedvector.py <br> <br> python draw_dengrograms.py <br></code> <br><br>  The example will require a Python Imaging Library (PIL), which can be downloaded from <a href="http://www.pythonware.com/products/pil/">www.pythonware.com/products/pil</a> <br>  After unzipping, it is installed as usual: <br> <code>python setup.py install</code> <br> <br>  And here is the most interesting moment.  As a result of the scripts, the following dendrograms were obtained: <br>  1) for blogs (in full quality - <a href="">img-fotki.yandex.ru/get/4100/serg-panarin.0/0_21f52_b8057f0d_-1-orig.jpg</a> ) <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/b63/e4a/47d/b63e4a47d83e36fd4bfe2eaa3f43a5c0.png" alt="image"><br><br>  2) for words (in full quality - <a href="">img-fotki.yandex.ru/get/4102/serg-panarin.0/0_21f53_dcdea04f_-1-orig.jpg</a> ) <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/79f/63e/8a2/79f63e8a259f5cf7df4c49ee47436d26.png" alt="image"><br><br>  By changing feedlist.txt you can analyze arbitrary blogs and get your dendrograms. </div><p>Source: <a href="https://habr.com/ru/post/79756/">https://habr.com/ru/post/79756/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../79750/index.html">Svyaznoy - business in Russian!</a></li>
<li><a href="../79751/index.html">Cool font = free</a></li>
<li><a href="../79752/index.html">Creating an acceptable home cinema, or listening to movies like music</a></li>
<li><a href="../79753/index.html">Map foci download pirated copies of "Black Lightning"</a></li>
<li><a href="../79754/index.html">Discount on sending telegrams on holidays</a></li>
<li><a href="../79765/index.html">Communications in 2020</a></li>
<li><a href="../79769/index.html">Voxelstein 3D / Voxelstein 3D, Happy New Year</a></li>
<li><a href="../79770/index.html">ExtJS. Presentations in the examples</a></li>
<li><a href="../79772/index.html">Proverbs, expelled from Earth - do not let shelter on other planets!</a></li>
<li><a href="../79773/index.html">Finally we can say: ‚ÄúThere are millions of us!‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>