<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Easy build virtual machines with PuPHPet</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Creating and managing development environments frustrates you, slows you down or distracts you from development? Do you have difficulties due to the f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Easy build virtual machines with PuPHPet</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/cb1/45c/5b4/cb145c5b49c3e3cae82671dffaacc950.png"><br>  Creating and managing development environments frustrates you, slows you down or distracts you from development?  Do you have difficulties due to the fact that your local environment and the environment are different at delay?  If so, I have a solution for you - <b>PuPHPet</b> ! <br><br><h4>  Introduction </h4><br>  I can‚Äôt say for you with confidence, but one of my favorite corns * in development is the environment, whether creating and maintaining it for various projects with different needs, ensuring interaction of the development team, (especially distributed), or setting up environments for development, testing and combat environment.  All this can be a time consuming task, especially when performed manually. <br><br>  Depending on the requirements of management or customers, a variety of choices can lead to depression.  All of them can pull in different directions (and pull!), Often at the same time. <br><a name="habracut"></a><br>  Take for example the choice of database MySQL, PostgreSQL, Oracle or SQLServer.  As well as NoSQL solutions such as Cassandra, Hadoop, and Redis.  Or choose a server, such as Apache or Nginx.  The list goes on and on.  And when there is not always a sysadmin ready to help (say, a freelancer or a very small team of developers), the time spent on maintaining the development environment increases significantly, and we turn into DevOps *. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In order to finally do away with this state of affairs and make the whole process as efficient as possible, I set about studying <a href="http://www.vagrantup.com/">Vagrant</a> and <a href="http://puppetlabs.com/puppet/what-is-puppet">Puppet</a> .  From conversations with colleagues and a thorough search on the Internet, it became clear that these two tools are in fact the standard for creating reusable media.  If you are not familiar with these great tools, here are two brief excerpts from their respective guides: <br><br>  <b>Vagrant:</b> <br><blockquote>  Designed to create and configure lightweight, portable and portable development environments.  Vagrant will change according to your requirements. </blockquote><br>  <b>Puppet:</b> <br><blockquote>  Software that automates the management of the infrastructure throughout its life cycle, from redundancy and configuration to setting up interaction and reporting.  Using Puppet, you can easily automate repetitive tasks, for example, quickly deploy critical applications, and actively manage changes, quickly scaling from 10 to 1000 servers, on your own equipment in the cloud. </blockquote><br>  However, like most people in the modern world, I am impatient.  I knew that there must be a way to solve the above problems rather quickly, but without becoming a passionate fan. <br><br><h4>  Introduction to PuPHPet </h4><br>  After further googling, I stumbled upon PuPHPet, an excellent GUI tool that gives you a simple way to create a Puppet configuration for Vagrant, which you can immediately start using. <br><br>  PuPHPet was originally conceived by Juan Treminio as a damn simple means of creating a working environment for, mainly, PHP developers. <br><br>  It focuses on 5 directions: <br><ul><li>  Deployment (memory, IP address, port forwarding) </li><li>  Basic server settings </li><li>  PHP (modules, libraries, configuration settings) </li><li>  Database (PostgreSQL, MySQL) </li><li>  Web server (Apache 2, Nginx) </li></ul><br>  If you need PHP 5.5 in conjunction with PostgreSQL and Nginx or PHP 5.4 with Apache 2 and MySQL, you can quickly create and load the necessary configuration. <br><br>  With PuPHPet, the environment will be ready in half an hour and all you need to do is execute the command: <br><pre><code class="bash hljs">vagrant up</code> </pre> <br>  This is how it is.  In the folder with the unpacked PuPHPet, you need to use this command, wait a bit and be ready.  Do not believe?  Let's step by step analyze the whole process, from beginning to end. <br><br>  When we finish, I strongly ask you - do not be afraid to change the configuration, change the options, add and remove packages and everything you can find.  I am sure you will be impressed. <br><br><h4>  Required software </h4><br>  A quick note before we begin.  One of the biggest problems I encountered when I first encountered PuPHPet is compatibility issues with the Vagrant and VirtualBox versions. <br><br>  I am currently using <a href="">Vagrant 1.3.5</a> and <a href="https://www.virtualbox.org/wiki/Downloads">VirtualBox 4.3.2</a> and they work flawlessly.  First, install these two packages. <br><br><h4>  Creating a configuration </h4><br>  When they are installed, open <a href="https://puphpet.com/">puphpet.com</a> .  At the very top, four configuration options are offered: Local (i.e., on the local computer), Digital Ocean, Rackspace, and Amazon Web Services.  Choose Local, we will not consider other options now. <br><br>  In the ‚ÄúLocal VM Details‚Äù section, we can select the following options: <br><ul><li>  operating system </li><li>  Hostname </li><li>  IP address </li><li>  RAM size </li></ul><br>  For our example, we use Debian Wheezy 7.2 x64 with VirtualBox 4.3. This will allow us to use PHP 5.4 or 5.5.  The remaining 3 options can be left as is or changed if you see fit. <br><br>  Next is the Local VM Forwarded Ports section.  I didn‚Äôt touch anything here, but if you want, you can configure port forwarding from the local to the virtual machine here. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fd1/97d/ee6/fd197dee639bc9a5d56805635ffe3e90.png"><br><br><h4>  Folder sharing </h4><br>  Here, Vagrant and Puppet begin to show all their power and flexibility.  In Box Sync Folder Source, you need to specify a local directory that will be synchronized with the directory in the virtual machine specified in the Box Sync Folder Target.  I left this item by default, as well as the folder type in the Shared Folder Type. <br><br>  This option is useful if you want to create several user directories in a virtual machine.  Let's say you have a working folder with a project in ~ / Documents / workspace / your-project.  You can map this directory directly to the root of the web server of your virtual machine.  Thus, you can develop locally, without synchronization or the need for manual copying to the project working folder in the virtual machine. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6bf/fa3/781/6bffa3781afc97902c7a8f0c8dea8fc7.png"><br><br><h4>  Basic server settings </h4><br>  If you need specific packages to work, such as Git, subversion, Vim, etc., then you need to list them in this section.  The only thing to remember is that the package name must be specified as well as in the selected operating system. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/773/016/2f9/7730162f9e083c5d50c3058c1dbbabe9.png"><br><br><h4>  Web server </h4><br>  Apache or Nginx?  Now I will choose Apache.  Then you need to specify the modules that will be installed and enabled by typing Apache Modules in the field.  To facilitate the process of entering module names, as well as to avoid errors, the input field will be presented with a pop-up list of available options. <br><br>  Next comes the Virtual Host configuration.  In the fields server name and alias specify the required domain name.  In order for this setting to work, you need to add an entry for this domain with the appropriate ip in the hosts file of the local computer.  In the Document Root field, you should specify the same directory as in Box Sync Folder Target to make synchronization easy and beautiful.  If you do not have a special need, leave in the Port 80 field, i.e.  default. <br><br>  The remaining two settings, Environment Variables and AllowOverride, change only if your application needs it.  (Note. Trans. - not quite understand the purpose of these two options, who in the course - please clarify). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ab/e1c/56e/9abe1c56e527cea56bdf088e9e216432.png"><br><br><h4>  Php </h4><br>  There are not so many options here, but the main ones, just the ones that are needed most often, are present.  I left the default PHP 5.5 (I think, now it is hardly worth looking at the version below this one).  I also noted the installation of Composer.  If you have not used Composer, or are not sure if you need it, I advise you to get to know it better, it is worth it. <br><br>  In the INI Settings section, I left the options already selected, and then added allow_url_fopen, allow_url_include, error_log, file_uploads, and apc.enabled.  Feel free to do the same, or browse and select from the extensive list. <br><br>  I changed PHP Timezone to Europe / Berlin as closest to my location.  I advise you to do the same and choose the time zone you need.  In PHP Modules, I stopped at the following list: cli, intl, mcrypt, cgi, curl, memcached, memcache, pspell, tidy and sqlite.  Browse through the list and add the ones you need.  For PEAR and Pecl modules, I left everything as it was. <br><br>  I chose to install Xdebug (by default) but not Xhprof.  I strongly recommend using XDebug for you too. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/28b/bba/f55/28bbbaf5597c1ca6857b9066c1ed322e.png"><br><br><h4>  Database </h4><br>  So, now carefully.  For our example, I chose MySQL, set a password for root, and left privileges for everyone.  SitePoint database name, TestUser username and password testpassword.  I do not have the setup SQL file in this example, so I‚Äôll leave the last field blank. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c29/bb6/4b3/c29bb64b339b4e97ef10f23a77099dc2.png"><br><br><h4>  Creating and loading configuration </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/6d8/3fa/a50/6d83faa505393543245c50a2a82e8c57.png"><br><br>  Now, just click the big go ahead then, make it button.  You will see that the download has begun.  After it is finished, unpack the archive and go to the directory in your terminal.  From there, run vagrant up. <br><br>  The process of creating a virtual machine begins.  If you have not previously loaded the Box file (OS image), which is specified when creating the configuration, you will have to wait a little longer, the image will be loaded first and only after that will the creation of the virtual machine begin.  If everything goes well, you will see the following output: <br><br><pre> <code class="bash hljs">vagrant up Bringing machine <span class="hljs-string"><span class="hljs-string">'default'</span></span> up with <span class="hljs-string"><span class="hljs-string">'virtualbox'</span></span> provider... [default] Importing base box <span class="hljs-string"><span class="hljs-string">'debian-wheezy72-x64-vbox43'</span></span>... [default] Matching MAC address <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> NAT networking... [default] Setting the name of the VM... [default] Clearing any previously <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> forwarded ports... [default] Creating shared folders metadata... [default] Clearing any previously <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> network interfaces... [default] Preparing network interfaces based on configuration... [default] Forwarding ports... [default] -- 22 =&gt; 2222 (adapter 1) [default] Running <span class="hljs-string"><span class="hljs-string">'pre-boot'</span></span> VM customizations... [default] Booting VM... [default] Waiting <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> machine to boot. This may take a few minutes... [default] Machine booted and ready! [default] Configuring and enabling network interfaces... [default] Mounting shared folders... [default] -- /vagrant [default] -- /var/www [default] -- /tmp/vagrant-puppet/manifests [default] Running provisioner: shell... [default] Running: /var/folders/_w/k6fxbl615w700lgkrtt0vb3w0000gn/T/vagrant-shell20131126-3538-kid3ga stdin: is not a tty ____ ____ _ _ ____ _ generated using | _ \ _ _| _ \| | | | _ \ ___| |_ ___ ___ _ __ ___ | |_) | | | | |_) | |_| | |_) / _ \ __| / __/ _ \| <span class="hljs-string"><span class="hljs-string">'_ ` _ \ | __/| |_| | __/| _ | __/ __/ |_ | (_| (_) | | | | | | |_| \__,_|_| |_| |_|_| \___|\__(_)___\___/|_| |_| |_| Created directory /.puphpet-stuff Running initial-setup apt-get update Finished running initial-setup apt-get update [default] Running provisioner: shell... [default] Running: /var/folders/_w/k6fxbl615w700lgkrtt0vb3w0000gn/T/vagrant-shell20131126-3538-1116fzj stdin: is not a tty Downloading http://apt.puppetlabs.com/puppetlabs-release-wheezy.deb Finished downloading http://apt.puppetlabs.com/puppetlabs-release-wheezy.deb Running update-puppet apt-get update Finished running update-puppet apt-get update Updating Puppet to latest version dpkg-preconfigure: unable to re-open stdin: No such file or directory Finished updating puppet to latest version: Puppet v3.3.2 Created empty file /.puphpet-stuff/update-puppet ... Info: Creating state file /var/lib/puppet/state/state.yaml Notice: Finished catalog run in 436.21 seconds</span></span></code> </pre><br><br><h4>  Check the performance </h4><br>  Now that the virtual machine is created, log in to it.  To do this, in the same directory run vagrant ssh.  After logging in to quickly verify that everything is working run sudo netstat -tlnp.  The output will show which services are running.  It must comply with this: <br><br><pre> <code class="bash hljs">Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 0.0.0.0:111 0.0.0.0:* LISTEN 1643/rpcbind tcp 0 0 0.0.0.0:39284 0.0.0.0:* LISTEN 1678/rpc.statd tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 2643/sshd tcp 0 0 127.0.0.1:5432 0.0.0.0:* LISTEN 13637/postgres tcp 0 0 127.0.0.1:25 0.0.0.0:* LISTEN 2399/exim4 tcp6 0 0 :::111 :::* LISTEN 1643/rpcbind tcp6 0 0 :::80 :::* LISTEN 31623/apache2 tcp6 0 0 :::22 :::* LISTEN 2643/sshd tcp6 0 0 ::1:5432 :::* LISTEN 13637/postgres tcp6 0 0 ::1:25 :::* LISTEN 2399/exim4 tcp6 0 0 :::37887 :::* LISTEN 1678/rpc.statd</code> </pre><br><br>  There you will see that Apache and PostgreSQL (Note: although MySql was in configuration) is working.  If you look in / etc / apache2 / sites-enabled / you will see the configuration for your virtual host. <br><br><h4>  All is ready! </h4><br>  Filling for the first time may seem like too many steps.  But now, when we have gone this way together, everything will turn out much faster.  Moreover, you do not need to create a configuration every time from scratch. <br>  If you drag puppet / hieradata / common.yaml onto puphpet.com, it will automatically fill in the form and all you have to do is edit it. <br><br>  <i>Translation of the first part of the <a href="http://www.sitepoint.com/build-virtual-machines-easily-puphpet/">Build Virtual Machines Easily With PuPHPet</a></i> . <br>  <a href="http://karmazzin.ru/easy-puphpet">This</a> and other translations from the Sitepoint site, as well as other <a href="http://karmazzin.ru/">articles on web development</a> . </div><p>Source: <a href="https://habr.com/ru/post/212009/">https://habr.com/ru/post/212009/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../211989/index.html">Free testing of mobile applications (Samsung Apps)</a></li>
<li><a href="../211995/index.html">The digest of interesting news and materials from the world of PHP No. 35 (January 26 - February 9, 2014)</a></li>
<li><a href="../211997/index.html">The Human Brain Project: how do we know how the brain works?</a></li>
<li><a href="../211999/index.html">ROBOT based on: android, arduino, bluetooth. Reflex. Part 2</a></li>
<li><a href="../212003/index.html">Yahoo geek-queen: conflicting results of the first year and a half</a></li>
<li><a href="../212011/index.html">New free courses of virtual academy of Microsoft Virtual Academy</a></li>
<li><a href="../212013/index.html">GUI control with echo and cat</a></li>
<li><a href="../212015/index.html">Creating a Markdown Tag Using Polymer / Web Components</a></li>
<li><a href="../212019/index.html">A passion for programming. Chapter 22. Remember who you work for</a></li>
<li><a href="../212023/index.html">Developing Backbone.js Applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>