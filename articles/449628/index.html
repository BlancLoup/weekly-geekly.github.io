<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Writing the "Hello, world!" Application for the Haskell web (Spock)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I was bored writing in Python, I wanted something unusual. Decided to try Haskell. I don‚Äôt know the language, but I didn‚Äôt want to simply write consol...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Writing the "Hello, world!" Application for the Haskell web (Spock)</h1><div class="post__text post__text-html js-mediator-article"><p>  I was bored writing in Python, I wanted something unusual.  Decided to try Haskell.  I don‚Äôt know the language, but I didn‚Äôt want to simply write console training programs, such as calculating factorial.  After studying a fairly large number of posts about Haskell and its use in real life, I realized that one of the potential points of growth in the popularity of a language is writing web applications.  Oddly enough, under Haskell there are quite a few <a href="https://wiki.haskell.org/Web/Frameworks">web-frameworks</a> .  My choice fell on <a href="https://www.spock.li/">Spock</a> , because, judging by the description, this is a simple and quick framework to develop.  I have some experience writing web applications on Flask, so I thought it would be interesting to compare such dissimilar approaches in solving similar problems.  In this article I will try to set out my way of trial and error in the study of Haskell as detailed as possible on the example of writing the simplest web application on Spock.  Perhaps it will be useful for those who doubt whether to try to learn Haskell and whether it will be useful in real life. </p><a name="habracut"></a><br><h2 id="nemnogo-pro-haskell-i-kak-ego-gotovit">  A little about Haskell and how to cook it </h2><br><p>  The first thing that every developer encounters when learning a new language is the choice and setting up the development environment.  Of course, you can write in a notebook, but if you have at least a little experience in developing production projects, this method will cause you pain.  By the way, Haskell is quite an old and common language and has <a href="https://wiki.haskell.org/IDEs">support</a> for most well-known editors and ide.  My friend haskelist uses emacs.  I'm used to normal IDE, so I put the plugin for IntelliJ. </p><br><p>  Also, for development, you will need a <a href="https://docs.haskellstack.org/en/stable/README/">stack</a> , which is now a standard and combines a compiler, a package management system, an assembly and testing system. </p><br><p>  Everything looks pretty friendly, there were no problems with the installation.  I use Mac OS for development, I haven‚Äôt checked it on other systems, but I suspect that everything will work fine under Linux too. </p><br><h2 id="hello-world">  Hello, world! </h2><br><h3 id="podgotovka">  Training </h3><br><p> We go to the <a href="https://www.spock.li/tutorials/getting-started">tutorial</a> and try to do everything according to the instructions.  They propose to first create a standard project via stack: <code>stack new MyLovelyProlect</code> .  A standard project is a folder with three subfolders: <code>app</code> , <code>src</code> , <code>test</code> .  It looks quite logical: one folder for the main application, one for support functions, and a third for testing.  Since we write "Hello, world!", We do not need the <code>src</code> and <code>test</code> folders, but we don‚Äôt need to delete them, because otherwise we will have to clean up other files, for example <code>HelloWorld.cabal</code> . </p><br><h3 id="sobstvenno-kod">  Actually, the code </h3><br><p>  Further in the tutorial it is proposed to copy some code into <code>Main.hs</code>  We will simplify it a little more in order to compare it with what flask offers. </p><br><pre> <code class="haskell hljs"><span class="hljs-meta"><span class="hljs-meta">{-# LANGUAGE OverloadedStrings #-}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span> Main <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Web.Spock <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Web.Spock.Config app :: SpockM () () () () app = get root $ text "Hello World!" main :: IO () main = do cfg &lt;- defaultSpockCfg () PCNoDatabase () let mw = spock cfg app runSpock 8080 mw</code> </pre> <br><p>  For comparison, I will give the same code on flask: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Flask app = Flask(__name__) @app.route(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Hello World!"</span></span> app.run()</code> </pre> <br><p>  In terms of the number of lines, flask still wins: 8 against 13. But given that Haskell is a statically typed language and 2 lines are occupied by the definition of types, the difference is, in my opinion, not great.  At least, the above code did not scare me away from further language learning. </p><br><h3 id="sborka-i-zapusk">  Build and Run </h3><br><p>  Next we go to <code>HelloWorld.cabal</code> and add the <code>executable HelloWorld-exe</code> to the <code>build-depends:</code> section <code>build-depends:</code> line <code>Spock &gt;=0.13</code> .  In the tutorial on the site it is proposed to include 2 more dependencies, but for my purposes they are not needed yet.  If now try to build the application using <code>stack build --fast --pedantic</code> , we get the following error: </p><br><pre> <code class="plaintext hljs">Error: While constructing the build plan, the following exceptions were encountered: In the dependencies for HelloWorld-0.1.0.0: Spock must match &gt;=0.13, but the stack configuration has no specified version (latest matching version is 0.13.0.0) needed since HelloWorld is a build target. Some different approaches to resolving this: * Consider trying 'stack solver', which uses the cabal-install solver to attempt to find some working build configuration. This can be convenient when dealing with many complicated constraint errors, but results may be unpredictable. * Recommended action: try adding the following to your extra-deps in /Users/dkvasov/Documents/Haskell/Spock/HelloWorld/stack.yaml: Spock-0.13.0.0@sha256:8115862eb4fb84a26fb7bcd34f30acf036bd2e7c4eaf813c185c5562d138bba2 Plan construction failed.</code> </pre> <br><p>  Quite understandably: stack does not know which version of Spock to install, so it needs to be written in <code>stack.yaml</code> .  We add <code>extra-deps</code> and repeat the build attempt.  There are several similar errors that will pop up, and as a result, I have the following in <code>stack.yaml</code> : </p><br><pre> <code class="plaintext hljs">extra-deps: - Spock-0.13.0.0 - Spock-core-0.13.0.0 - reroute-0.5.0.0 - stm-containers-0.2.16 - focus-0.1.5.2</code> </pre> <br><p>  After that, everything gathered.  I collected the artifacts in the <code>.stack-work/dist/x86_64-osx/Cabal-2.4.0.1/build</code> . </p><br><p>  I started everything by the <code>stack exec HelloWorld-exe</code> command, and on <code>localhost:8080</code> I saw the coveted "Hello, world!".  No dancing with a tambourine is needed. </p><br><h3 id="probuem-razobratsya-chto-voobsche-proishodit">  Trying to figure out what's going on. </h3><br><p>  So far, we have not used any specific knowledge of functional programming (FP) and Haskell.  We used common sense and basic development knowledge.  So it is impossible further.  For further understanding, we need to know some things about FP.  OP is not the opposite of OOP.  Those who are familiar with the Scala language know that in both of these concepts it is easy to get along.  The antithesis of OP is imperative programming.  While the functional model of computation relies on the composition of functions, the imperative model relies on the process of successive changes in the states of the system.  It follows from this that in purely functional languages, such as Haskell, it is assumed that the functions are "pure", that is, they do not contain a changeable state and "side effects", besides the return value.  This makes it easy to build compositions of functions.  Actually, the requirement of "purity" imposes many restrictions on the use of functional languages ‚Äã‚Äãin the real world.  However, since there are production applications in Haskell, it means you can somehow use pure functions in the real world.  Let's take a closer look at our <code>Main.hs</code> </p><br><p>  As I understand it, an <code>app</code> is a variable of type <code>SpockM</code> , which is a <em>monad</em> .  Most likely, if you are not familiar with the functional programming style and category theory, you will not understand from the first time what it is and why you need it.  However, it is necessary to deal with this at least at a basic level, since it is the monads that are the basis of the applied use of the Haskell language.  There are quite a few articles of varying degrees of detail on this topic, including on Habr√©.  I will not bring them here, of course.  So far, I propose to assume that monads are the kind of magic that allows one to produce so-called side effects.  In our application there is another monad: <code>IO</code> .  Its side effect is data input and output. </p><br><p>  SpockM is parameterized by four other types.  They correspond to the database connection, session, state, and return value.  For an empty application, this is not needed, so we will use the type <code>()</code> called Unit everywhere.  Inside the <code>app</code> we tie paths to action.  In this case, we defined the base path <code>/</code> and the action <code>   "Hello, world!  get-</code> . </p><br><p>  Next, we create the default config and assign it to <code>cfg</code> .  Next, using the <code>spock</code> function, <code>spock</code> create middleware for the app and cfg and pass it to <code>runSpock</code> along with the desired launch port. </p><br><h3 id="zaklyuchenie">  Conclusion </h3><br><p>  It is clear that everything described here is very simple, and every person who speaks English and equipped with a brain will be able to do the same thing, looking at the spoch tutorial in izachalny tutorial.  This article was more about how my acquaintance with the language Haskell.  What's next?  Then almost all learning resources suggest using state and writing an application todo, then connecting the database, then ... Maybe in the future I will write a sequel. </p><br><h2 id="ssylki">  Links </h2><br><ul><li>  <a href="https://youtu.be/Orm-jIIgVD0">Your First Web Application with Spock</a> is a rather detailed video in English with a similar Hello World analysis. </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/449628/">https://habr.com/ru/post/449628/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../449608/index.html">Why blur badly hide sensitive information</a></li>
<li><a href="../44961/index.html">TouchSmart tx2 in stock</a></li>
<li><a href="../449616/index.html">Fibonacci at the interview</a></li>
<li><a href="../449618/index.html">The future is in the clouds</a></li>
<li><a href="../449626/index.html">Cognitive straightening: a session of illusions with full exposure</a></li>
<li><a href="../44963/index.html">Mozilla stops supporting Firefox 2</a></li>
<li><a href="../449630/index.html">"They offered to get acquainted with the calculations of one indicator, and there are two sheets with integrals and second derivatives"</a></li>
<li><a href="../449632/index.html">AMA with Habrom v.8.0. Onboarding, news for all, PWA</a></li>
<li><a href="../449634/index.html">I am delighted with IoT</a></li>
<li><a href="../449636/index.html">How to avoid the bite of the bug kisser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>