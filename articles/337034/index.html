<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Call for free using ENUMER blockchain service</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article describes the decentralized implementation of the ENUM IP telephony protocol based on the Emercoin blockchain cryptocurrency. A descriptio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Call for free using ENUMER blockchain service</h1><div class="post__text post__text-html js-mediator-article">  The article describes the decentralized implementation of the <a href="http://www.voip-info.org/wiki/view/ENUM">ENUM</a> IP telephony protocol based on the <a href="http://emercoin.com/">Emercoin</a> blockchain cryptocurrency.  A description of the ENUMER system, its difference from other ENUM implementations is given.  Instructions are also given for expanding the ENUMER node and an example of a VOIP PBX FreeSWITCH configuration for working with ENUMER is given. <br><br><img src="https://habrastorage.org/web/d59/9a3/ec4/d599a3ec404346999cd9b38387e1c3f2.png"><br><br><a name="habracut"></a><br><h2>  Introduction </h2><br><p>  In the world, IP-telephony, which has a number of advantages in comparison with the classical one, is becoming more and more common.  IP solutions are usually cheaper than classic ones and have more functionality.  Currently, IP ATCs are used in various organizations, but the main telephone networks continue to use classic solutions, even if based on digital PBXs.  As a result of this state of affairs, communication even between two IP ATCs takes place through a regular telephone network, the PSTN.  Consider an example: <br></p><br><p>  Suppose we have the organization "Buyer", and another organization, "Seller".  Both organizations use IP ATC (also called PBX) for their internal needs.  Let the employee of the Buyer find in the advertisement the announcement of the Seller that interested him.  The buyer decided to call the Seller, and dials his number.  The call is as follows: <br></p><br><p> <b><img src="https://habrastorage.org/web/90f/1fd/afd/90f1fdafd35c469195c9df42f3dcbb58.png"><br></b> <br></p><p>  During this call, two IP ATCs are connected through the <a href="https://en.wikipedia.org/wiki/Public_switched_telephone_network">PSTN</a> chain of providers, and accordingly the buyer pays the call to the provider, who forwards the call from the VOIP network to the PSTN network (lands the call).  Well, then there are offsets between PSTN-providers that do not interest us. <br></p><br><p>  If IP_ATC_buyer ‚Äúknew the way‚Äù, it could directly connect to IP_ATC_ seller via the Internet, and thus save the buyer from paying for the PSTN-downer, and the call would be free: <br></p><br><p><img src="https://habrastorage.org/web/bb5/9f1/d76/bb59f1d76adc44fb8313ae9548a8a15a.png"><br></p><br><p>  Yes, and the reliability and quality of the connection would be significantly higher, since in such a chain there are less intermediate elements and transcoding of voice traffic. <br></p><br><p>  It is clear that ‚Äúto know all the roads‚Äù, that is, to support all kinds of direct IP connections, is very laborious, and a network protocol was developed for converting a phone number to a ‚Äúroad‚Äù, that is, into a URI, which was called ENUM. <br></p><br><h2>  Enum </h2><br><p>  The ENUM protocol ( <a href="https://tools.ietf.org/html/rfc6116">rfc6116</a> ) works as a distributed address book, and allows for a telephone number to ‚Äúfind the way‚Äù to the corresponding IP ATC that serves this number.  Protocol Description: <a href="https://en.wikipedia.org/wiki/Telephone_number_mapping">https://en.wikipedia.org/wiki/Telephone_number_mapping</a> <br></p><br><p>  The idea of ‚Äã‚Äãusing the protocol is as follows: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </p><ul><li>  The seller registers its IP ATC (PBX) with the ENUM system. </li><li>  When an IP ATC buyer calls before using the PSTN network, he tries to find a ‚Äúshort way‚Äù, for which he makes a request to the ENUM system. </li><li>  If there is a ‚Äúshortcut‚Äù in the system, the buyer‚Äôs PBX uses it.  If not, then it uses the standard path, via PSTN, and pays for the landing call in the usual way. </li></ul><br><h2>  Benefit from ENUM </h2><br><p>  Using ENUM provides benefits for both the initiator and the receiver of the call.  For them it is: <br><br></p><ul><li>  Improved signal quality due to direct digital connection. </li><li>  Increased connection speed and reliability. </li><li>  Bypassing the limit of the PSTN operator for the number of lines or minutes used. </li><li>  No denial of service due to operator overload. </li><li>  For the caller - the call is always free (direct savings). </li><li>  For the recipient - free too, even if he has a toll-free number when he has to pay for incoming (also savings). </li><li>  The use of ENUM occurs automatically, imperceptibly to users, and requires only minimal configuration of IP ATC. </li></ul><br>  The ENUM protocol is simple and lightweight, technically efficient, and all the most popular IP ATCs support it.  However, it did not receive wide distribution from, and there are a number of organizational and economic reasons that have become problems for widespread adoption.  Consider them in more detail. <br><br><h2>  Problems with current ENUM implementations </h2><br><p></p><ol><li>  The first problem of ENUM is that now there is simply no such place where the owner of a normal IP ATC could register his number (or several numbers) and the corresponding SIP URI.  Or rather, such places were, for example, freenum.org or e164.org.  But freenum has long been unavailable, and e164.org stopped working in November 2016. Yes, somewhere, an ENUM server like e164.arpa continues to exist.  But this service is not for IP ATC owners or individuals, but an ‚Äúinter-provider node‚Äù, where large and mutually verified VOIP providers give information about the possibility of landing on their network.  A kind of "parties for their own", where the usual owner of IP ATC is no road. </li><li>  The second problem is the critical dependence of network operation on a centralized service, which may behave incorrectly or not work at all.  A good example is e164.org.  In the last 2 years, he worked unstably, and besides, he was engaged in obscenity, for example, despite toll-free numbers registered with him, he directed traffic not to IP ATC subscribers, but to ‚Äúhis landowners‚Äù, who naturally did not forget to bill for the delivered PSTN network calls.  Naturally, this behavior led to the fact that the owners of toll-free numbers lost the economic incentive to register these numbers at e164.org. <br>  And about a month before closing - e164.org in general stopped giving ENUM answers, despite the fact that the records contained correct (we checked). </li><li>  Since the classic centralized ENUM system uses DNS transport, it is vulnerable to all sorts of attacks on the DNS infrastructure, such as <a href="https://en.wikipedia.org/wiki/DNS_spoofing">DNS-Spoofing</a> , <a href="https://en.wikipedia.org/wiki/DNS_hijacking">DNS-hijacking</a> , and the like.  Naturally, failures in the DNS system also lead to a denial of service in the ENUM system. </li><li>  And finally, but important: The load on such a server is very large, because the request is made when you try each call from IP ATC.  Yes, requests are cached by intermediate DNS servers, but nevertheless - the load still remains high for the server serving all telephone exchanges around the world.  As a result - denials of service or delays in processing requests, as well as the high cost of server infrastructure. </li></ol><br>  The aforementioned reasons for the ‚Äúfailure‚Äù are of an organizational and technical nature, stemming from the centralized organization of the service and the opacity of the query resolution algorithm.  Indeed, a centralized implementation of ENUM, like any network service, depends on the performance of the site that services the creation of ENUM records and their support for current ones, as well as the corresponding DNS server that allows ENUM requests.  In other words, trust in such an ENUM system cannot exceed trust in the organization that manages this system.  Confidence also reduces the fact that the algorithm and criteria by which a centralized service allows ENUM requests are completely unknown.  So, for example, today it can work as it should, and tomorrow it can redirect <i>where</i> calls to a certain number that interests the competent comrades ( <i>who</i> care <i>about everything</i> ).  For example, on an intermediate VOIP-node, which in turn can do anything with traffic.  Why suddenly redirect?  Well, maybe the owner of the room is playing jazz ... <br><br><p>  Accordingly, the failure of such a service leads to an instantaneous shutdown of the entire network.  Both of these shortcomings were fully demonstrated by e164.org: at first it redirected toll-free calls not to the registered numbers, but to its landline provider, then generally answered with empty answers, and at the end of the epic went out of business, with all the bases. <br></p><br><h2>  ENUMER - decentralized enum </h2><br><p>  To solve the above problems, we have developed a decentralized ENUM system based on the Emercoin blockchain.  The project was named "ENUMER", derived from the words "ENUM" and "Emer".  In short: ENUM + EMER = ENUMER. <br></p><br><p>  Cryptocurrencies are the trend of the modern financial industry, and are currently actively developing.  The basis of all cryptocurrencies, including Emercoin, is the blockchain - a distributed, trusted public database of payment transactions. <br></p><br><p> A feature of Emercoin is <a href="https://wiki.emercoin.com/en/Emercoin_NVS">NVS</a> (Name-Value Storage) - a distributed, trusted storage of general-purpose information.  That is, each network member has a valid local copy of the entire blockchain, and therefore the entire content of NVS, and trust in the contents of NVS, as well as the entire blockchain, is created through the consolidated efforts of miners to prove <a href="https://en.wikipedia.org/wiki/Proof-of-work_system">POW‚Äôs</a> work and to prove <a href="https://en.wikipedia.org/wiki/Proof-of-stake">POS‚Äôs</a> share. <br></p><br><p>  Based on this repository, <a href="https://cryptor.net/kriptovalyuty/pod-kapotom-emercoin-chast-3-emcssh-infrastruktura-publichnyh-klyuchey-vsemirnogo">emcSSH</a> / <a href="https://habrahabr.ru/post/257605/">emcSSL</a> security <a href="https://habrahabr.ru/post/257605/">systems</a> , as well as the invulnerable decentralized domain name system <a href="https://habrahabr.ru/post/257605/">EmerDNS</a> , have already been created and are being operated. <br></p><br><p>  This decentralized ENUM project is based on EmerDNS, and has the following advantages over the classic ENUM centralized implementation: <br><br></p><ul><li>  High resolution resolution of ENUM requests due to the locality of their processing. </li><li>  High reliability of request processing.  Even if the connection with other network members is lost, requests will continue to be resolved via a local copy of the blockchain. </li><li>  Anonymity ENUM requests.  Since requests do not leave the local computer or a trusted local network, no one outside can find out what is happening and who they are looking for. </li><li>  The inability to attack the DNS infrastructure due to the lack thereof [3]. </li><li>  By virtue of true network decentralization, trust in a network does not depend on trust in any one company.  Impossible situation when the whole system will be stopped by the decision of someone alone [2].  The ENUM network will continue to operate until hundreds of independent miners close the blocks and confirm the blockchain consensus. </li><li>  The ENUM request processing algorithm is executed on the requesting side.  The program code that does this is available on <a href="https://github.com/Emercoin">Github</a> , and can be analyzed by anyone for correctness.  The situation when the ENUM server changes the rules during the game is impossible.  That is, a private local server is requested via a local connection (or via a trusted network). </li><li>  Due to the decentralization of the Emercoin peer-to-peer network, it scales indefinitely.  Consequently, there is no ‚Äúnarrow throat‚Äù in which requests from all over the world are focused.  Everyone can set up as many independent EmerCoin nodes as they want, and resolve their ENUM requests on this cluster.  That is, the problem has been solved [4]. </li><li>  ENUM records are created and modified by the users themselves, through the local EmerCoin wallet.  Thus, a server or other place [1] is not required where it is necessary to enter information.  Each user does it locally at his place, and the ‚Äúplace to report about oneself‚Äù simply becomes unnecessary.  Each reports to its local wallet, and that one already transmits an ENUM record to the peer-to-peer network. </li></ul><br>  As a result, we get the system: <br><br><ul><li>  Fast </li><li>  Reliable </li><li>  Protected </li><li>  Scalable </li><li>  Not dependent critically on anyone </li><li>  Not subject to failure due to a voluntarist decision </li><li>  Without the ability to block unwanted </li><li>  With a transparent query resolution algorithm </li><li>  With the ability to control the recording through a local wallet, and not "server on the Internet" </li></ul><br>  But with such impressive advantages, the decentralized ENUM has its own specific problems related to the public availability of the infrastructure.  So, anyone can create a record with any content, and capture the record corresponding to someone else's phone number, and its contents either block ENUM access for the true owner of the phone, or worse, redirect the call to the wrong place.  You call, for example, the laundry, and you get into the Ministry of Culture ... <br><br><p>  To prevent such abuses, the system provides for verifiers.  These are agents who verify that an ENUM record really belongs to the owner of the corresponding number, and then pass the signature to the owner of the ENUM record - the verdict that the record is correct and can be used.  Also, in order to curb abuse, the ENUMER system only works with individual phone numbers.  That is, it is not possible to grab a large chunk of numbering space with one ENUM record. <br></p><br><h2>  How to create a verified entry in the ENUMER system </h2><br><p>  An IP ATC owner who wants to receive calls using ENUM must first configure his IP ATC so that he can receive incoming calls to the SIP URI "from the world."  The configuration details depend on the specific IP PBX (PBX) and network environment, and are no different from the usual PBX settings without a blockchain. <br></p><br><p>  After that, a verified ENUM record should be placed in EmerCoin NVS, which the callers will use.  To do this, take the following steps: <br></p><br><h3>  Set wallet Emercoin </h3><br><p>  Emercoin's purse (node) is a client program of a distributed ENUM network (and not only ENUM), and something like a ‚Äúpersonal account‚Äù where the user can create his ENUM records and then update them as needed.  Wallet can be downloaded from <a href="http://emercoin.com/">http://emercoin.com/#download</a> <br></p><br><p>  To manage your records, we recommend using a GUI wallet for your OS. <br></p><br><p>  After downloading and launching, wait until the wallet synchronizes the local copy of the blockchain.  This may take several hours. <br></p><br><h3>  Get EMC Coins </h3><br><p>  Next, you need somewhere to purchase the EMC coins needed to download and update records in NVS.  They can be purchased at <a href="http://coinmarketcap.com/currencies/emercoin/">one of the exchanges</a> , or <a href="http://emercoin.com/contact">contact the developers</a> . <br>  To reserve one record for 10 years and several subsequent updates, approximately 0.05EMC is required, which is $ 0.06 at the current rate.  In general, the price is quite acceptable.  And if we take into account that soon the price for NVS-recording will be <a href="https://habrahabr.ru/company/emercoin/blog/335630/">reduced by 100 times</a> , we can consider the costs for maintaining ENUMER-recordings close to zero. <br></p><br><p>  The address where to receive the coins is in the ‚ÄúFile / Receiving Addresses‚Äù menu, and it looks like this: <i>ERFJfQGwmZEomHQHGZsRFLZEyBxaWsCHTo</i> . <br></p><br><h3>  Create ENUM Record </h3><br><p>  To store ENUM records, trusted decentralized storage is used ‚Äî <a href="http://wiki.emercoin.com/en/Emercoin_NVS">EmerCoin NVS</a> (Name-Value Storage).  Access to NVS entries is done either through the GUI of the wallet in the ‚ÄúManage Names‚Äù tab, or by using the JSON API commands provided in the documentation.  NVS-record, as the name implies, consists of Name (Name) and value (Value). <br><br><img src="https://habrastorage.org/web/d1b/dd8/f38/d1bdd8f3835a4e6789d3326c3dd344a9.PNG"><br></p><br><h4>  Name </h4><br><p>  For the ENUM subsystem, the record names are as follows: <br><br>  <b>enum: phone_num: N</b> <br>  Here: <br><br></p><ul><li>  enum - service prefix </li><li>  phone_num - phone number in <a href="https://en.wikipedia.org/wiki/E.164">E164</a> format </li><li>  N - the number of attempts to fight squatters (decimal) </li></ul><br>  For example: <br><br>  <b>enum: 18009359935: 0</b> <br><br><p>  If the prefix of the service and the number is clear, the purpose of the parameter N needs clarification.  This number is needed to protect the true owner of the number from squatters who can capture an ENUM record corresponding to someone else's number, and through it try to do all sorts of bad things.  They will not be able to use the zipped recording (see about verification below), but in the absence of an attempt number N, the real owner of the number will not be able to enter his entry.  In the case of using the number N, the real owner of the phone number can create an entry with the first free value N. For example, suppose you want to create an ENUM record for the phone number <b>18009359935</b> , and the example shown above has already captured some kind of squatter.  It does not matter, create the name " <b>enum: 18009359935: 1</b> ", and after verification, the system will believe exactly your name, and the squatter will admire the useless record in which he burned his coins.  If this name is dropped too - try to create an entry with the number N = 2, and so on. <br></p><br><h3>  Value </h3><br><p>  The Value field consists of several lines.  The strings are either the U-directives of NAPTR ( <a href="https://tools.ietf.org/html/rfc3402">rfc3402</a> ) <a href="https://en.wikipedia.org/wiki/Telephone_number_mapping">ENUM</a> (start with E2U), or the signatures of verifiers (start with SIG).  One ENUM record may have several directives, as well as several signatures from different verifiers.  Example value, including U-directive and signature: <br></p><br><pre> E2U + sip = 100 | 10 |! ^ (. *) $! Sip: 17772325555@in.callcentric.com!
 SIG = ver: enum | IC00zMELlEwmMHLpQs8 =
</pre><br><p>  You do not have any signatures yet (verification lines will provide you with verifiers), so when creating a record, make only U-directives (at least one) that will ensure the routing of calls to your IP ATC.  The directive structure is as follows: <br><br>  <b>Service = Priority | Preference | Regex</b> <br></p><br><p>  In the example above: <br><br></p><ul><li>  Service -&gt; E2U + sip </li><li>  Priority -&gt; 100 </li><li>  Preference -&gt; 10 </li><li>  Regex -&gt;! ^ (. *) $! Sip: 17772325555@in.callcentric.com! </li></ul><br>  The meaning of the fields and their names correspond to the <a href="https://tools.ietf.org/html/rfc5483">standards of the</a> classical ENUM.  For those who are too lazy to read the documentation, a brief guide for beginners: <br><br><p>  Almost always service is as in the example above, E2U + sip for SIP IP ATC.  Other options are possible, for example E2U + iax or something like that.  As mentioned above, there may be several U directives in the ENUM record. <br></p><br><p>  Priority, Preference - leave as in the example to start.  It is not recommended to reduce them greatly. <br></p><p>  The most important thing is Regex.  This is the rule by which the phone number is converted to a SIP URI.  The delimiter is ‚Äú!‚Äù.  In the first part - regex is superimposed on the phone number, and in the second - this number is substituted for \ 1, and thus a SIP URI is formed. <br>  Another good example of using regex <b>:! ^ \ +? 441865332 (. *) $! Sip: \ 1@nominet.org.uk!</b> <br></p><br><h3>  Verify </h3><br><p>  So, the ENUM entry was created, and the blockchain accepted it.  It is already available to all.  But the IP ATC callers are ignoring it unanimously, since there are no signatures of verifiers that they believe in.  And it is right.  For you never know who created an entry with your phone number?  And what, now send all the traffic where indicated there, without looking?  No, traffic will be sent only on the basis of verified records containing the verifier's signature. <br></p><br><p>  At present, the automatic verification system has not yet been made, but the plans include its manufacture and commissioning.  If you wish to participate in the partnership for the creation and operation of the automatic verification subsystem, contact us: enumer@emercoin.com.  For the time being, verification takes place through a human operator. <br></p><br><p>  To get the signature, write an e-mail to enumer@emercoin.com.  In the letter, specify the NVS-name of your ENUMER record, for example: <b>enum: 18009359935: 0</b> . <br><br>  Within a few days, the operator will check for the record and make a test call to the appropriate number to make sure that the owner of the number is aware of the request and agrees to use ENUMER.  After successful verification, we will send a reply containing a signature that you will add to your NVS record.  After entering the signature, your entry will become trusted, and other users will be able to use it for direct calls to your PBX. <br></p><br><h3>  Add the signature of the verifier to your ENUM record </h3><br><p>  By putting this signature into your ENUM record and executing NAME_UPDATE, you prove to everyone the ownership of the number, and callers (ENUMER clients) who believe this verifier will send calls not to the PSTN, but to the SIP URI of your IP ATC. <br></p><br><p>  There may be several signatures in ENUM records, from different verifiers.  A client uses an ENUM record if there is at least one signature from one of those verifiers that he believes. <br></p><br><p>  After adding a signature - your ENUM record is active, and ENUMER clients can call you directly, without using a PSTN network. <br></p><br><h2>  How to call using ENUMER (client) </h2><br><p>  Now, after the entry about your IP ATC is made to ENUMER, it remains to start using the system for the benefit of yourself and other subscribers.  To do this, you need to make your IP ATC send ENUM requests to Emercoin NVS. <br></p><br><h3>  Using the enum.enumer.org service </h3><br><p>  We created a public gateway in ENUMER, and any PBX user without any settings of the blockchain and TP can use it in his PBX.  To do this, send an ENUM request to the DNS: to the resolum enum.enumer.org.  An example of a test request from the command line and response: <br></p><pre>
 $ dig -t naptr + short 53995390081.enum.enumer.org
 100 10 "u" "E2U + sip" "! ^ (. *) $! Sip: \\ 1@tollfree.alcazarnetworks.com!"  .
</pre><br>  But when using our gateway, you potentially get all the problems discussed above related to centralization and the use of an external server.  Therefore, the main purpose of our gateway is to provide a test environment, and nothing more.  We <b>strongly do not recommend</b> using our gateway for practical use in an under-exploited system, but rather deploy your own gateway in EmerDNS, as will be explained below. <br><br><h3>  Deploying a gateway in EmerDNS </h3><br><p>  The most correct, fast and secure option is to install the EmerCoin daemon and deploy the gateway to emcDNS on the local network or even on a server running IP ATC.  Documentation on the deployment of such a gateway - <a href="https://wiki.emercoin.com/en/EMCDNS">here</a> .  See ‚ÄúIntegration into a regular DNS tree‚Äù. <br></p><br><p>  In the BINDa config (or another DNS-proxy), you will need to add a link to the fifth zone ‚Äúenum‚Äù, by analogy with the four already existing ones from EmerDNS. <br></p><br><p>  In addition, in the emercoin.conf wallet config, you must add ‚Äú$ enum‚Äù to the list of served zones, as in the example below.  Using the ‚Äú$‚Äù sign instead of a dot indicates to the wallet that this zone will be serviced according to the ENUM rfc6116 rules.  In addition, two parameters specific to ENUM must be added to the wallet config: <br><br></p><ul><li>  The list of trusted verifiers enumtrust (in the example below - ver: enum | olegh) </li><li>  File name or link to NVS-record (the link starts with '@'), containing a list of rules for trying to work out toll-free calls through public landowners, if nothing was found for the desired number in ENUMER-e.  This is an enumtollfree. <br><br>  In the example below, such a list is a link to the NVS-record enum: tollfree, which currently contains rules for landing toll-free calls to the United States, France and Poland.  We will keep this record up-to-date, and add paths to other countries as the respective landowners appear. </li></ul><br>  Thus, the following lines should be added to the <a href="http://olegh.ftp.sh/emercoin/emercoin.conf.txt">emercoin.conf</a> configuration file: <br><pre>
 emcdnsallowed = $ enum | .coin | .emc | .lib | .bazar # Allowed TLDs, including ENUM
 enumtrust = ver: enum | olegh
 enumtollfree = @ enum: tollfree
</pre><p>  To test the settings, try manually sending an ENUM query to the DNS: <br><br>  <b>$ dig -t naptr + short 53995390081.enum <a href="https://habrahabr.ru/users/localhost/" class="user_link">localhost</a></b> </p><br><br>  The answer should be something like this: <br><pre> 100 10 "u" "E2U + sip" "! ^ (. *) $! Sip: \\ 1@tollfree.alcazarnetworks.com!"  .
</pre><br>  If something does not work, try sending the request directly to the wallet, to port 5335 <br><br>  <b>$ dig -t naptr + short 53995390081.enum <a href="https://habrahabr.ru/users/localhost/" class="user_link">localhost</a> ‚Äìp 5335</b> <br><br>  And localize the place of failure.  But with the right settings, everything works right away and without problems. <br><br><h3>  IP ATC connection </h3><br><p>  This is the easiest.  In dialplan-e IP ATC, you must specify that after resolving internal and corporate numbers, but before moving to PSTN providers, we make a request to ENUMER.  Naturally, before the request it is necessary to bring the desired number to the format of ITU-T E164. <br></p><br><p>  Below is an example of a fragment of the dialplan-a for FreeSWITCH, which first leads the number to the E164 format without the leading plus, and then makes a request to ENUMER, adding a plus when prompted.  If ENUMER cannot help, a request is made to e164.arpa.  Well, if there is nothing there, then the dialplan goes to the PSTN landings.  A similar dialplan fragment can be created for another IP ATC that supports ENUM (Asterisk, Yate, etc). <br></p><br><pre> &lt;! - Normalize numbers to ITU-T E164 without PLUS -&gt;
 &lt;extension name = "Normalize to ITU-T E164 without PLUS"&gt;
   &lt;condition field = "destination_number" expression = "^ (?: \ + | 011 | 00) (\ d {7,}) $" break = "on-true"&gt;
     &lt;action application = "transfer" data = "$ 1" /&gt;
   &lt;/ condition&gt;
   &lt;condition field = "destination_number" expression = "^ (\ d {10}) $" break = "on-true"&gt;
     &lt;action application = "transfer" data = "1 $ 1" /&gt;
   &lt;/ condition&gt;
   &lt;condition field = "destination_number" expression = "^ (\ d {7}) $" break = "on-true"&gt;
      &lt;action application = "transfer" data = "1 $ {home_code} $ 1" /&gt;
   &lt;/ condition&gt;
 &lt;/ extension&gt;<font></font>
<font></font>
 &lt;! - Lookup E164 with PLUS in the ENUMER and e164.arpa -&gt;
 &lt;extension name = "Lookup ENUM" continue = "true"&gt;
   &lt;condition field = "destination_number" expression = "^ (\ d {7,}) $" break = "on-true"&gt;
     &lt;action application = "ring_ready" /&gt;
     &lt;action application = "set" data = "hangup_after_bridge = true" /&gt;
     &lt;action application = "set" data = "continue_on_fail = true" /&gt;
     &lt;action application = "set" data = "effective_caller_id_name = + 15553550000" /&gt;
     &lt;action application = "set" data = "effective_caller_id_number = + 15553550000" /&gt;
     &lt;action application = "enum" data = "+ $ 1 enum" /&gt;
     &lt;action application = "bridge" data = "$ {enum_auto_route}" /&gt;
     &lt;action application = "enum" data = "+ $ 1 e164.arpa" /&gt;
     &lt;action application = "bridge" data = "$ {enum_auto_route}" /&gt;
     &lt;/ condition&gt;
 &lt;/ extension&gt;
</pre></div><p>Source: <a href="https://habr.com/ru/post/337034/">https://habr.com/ru/post/337034/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337022/index.html">The digest of interesting materials for the mobile developer # 219 (August 28 - September 3)</a></li>
<li><a href="../337024/index.html">Dive into BerkeleyDB JE. Introduction to Collections API</a></li>
<li><a href="../337026/index.html">GSoC 2017 Project Report: ReactOS Apps Manager</a></li>
<li><a href="../337028/index.html">Bayes Summer | Deep | Bayes Summer School Materials in In-Depth Learning</a></li>
<li><a href="../337030/index.html">How recursion works - explanation in flowcharts and video</a></li>
<li><a href="../337036/index.html">Wolfenstein 3D pixel-by-pixel fill</a></li>
<li><a href="../337038/index.html">JavaScript scopes</a></li>
<li><a href="../337040/index.html">‚ÄúRise of Machinery Learning‚Äù or combine a hobby in Data Science and analyzing the spectra of light bulbs</a></li>
<li><a href="../337042/index.html">How JS Works: Overview of the Engine, Runtime Mechanisms, Call Stack</a></li>
<li><a href="../337044/index.html">We write GraphQL API server on Yii2 with a client on Polymer + Apollo. Part 2. Client</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>