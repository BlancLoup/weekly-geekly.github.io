<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What's new in Rails 5.1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Rails 5.1: Favorite JavaScript, system tests, encrypted secrets, and more 



 As part of celebrating the 12th RailsConf in Phoenix, Arizona this week...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What's new in Rails 5.1</h1><div class="post__text post__text-html js-mediator-article"><h3>  Rails 5.1: Favorite JavaScript, system tests, encrypted secrets, and more <br></h3><br><img src="https://habrastorage.org/getpro/habr/post_images/b1c/2fc/332/b1c2fc33254cfcc9a2f68c03ad737cab.png" alt="image"><br><br>  As part of celebrating the 12th <a href="http://railsconf.com/">RailsConf</a> in Phoenix, Arizona this week, we are proud to announce that Rails 5.1 is ready in its final form!  We‚Äôve done <a href="">more than 4,100 commits since the release of Rails 5.0,</a> making it all EASIER, EASIER, and, uhh, FUN?  (This is a RailsConf joke). <br><a name="habracut"></a><br>  Key information has not changed since the first beta, but here‚Äôs a replay: <br><br><h3>  Favorite javascript </h3><br>  Over the years, we have had a tumultuous, perhaps even controversial relationship with JavaScript.  But this time has passed.  JavaScript has improved a lot over the past few years, especially with the advent of ES6, as well as with tools for building and compiling, such as Yarn and webpack.  Rails embraces both of these solutions with open arms and passes any past stream of water under the bridge. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      JavaScript and Ruby share a deep philosophical connection with language design, if not ecosystem management.  Let's focus on the aspects that we have and help Rails programmers get the best of JavaScript with some key guidelines. <br><br>  Improvements in Rails 5.1 focus on three main parts: <br><br><ol><li> <b>Manage JavaScript dependencies on NPM using Yarn.</b>  Think of <a href="https://yarnpkg.com/en/">Yarn</a> as a JavaScript Bundler (even <a href="https://github.com/wycats">Yehuda Katz is</a> involved!).  This makes it easy to manage dependencies on libraries such as React or anything else from NPM.  Everything that you need through Yarn becomes available for use in the asset pipeline, as well as resources belonging to third-party entities from the <code>vendor/assets</code> directory.  Just use binstub <code>bin/yarn</code> to add dependencies. <br><br></li><li>  <b>Optionally compile javascript using webpack.</b>  Despite the fact that there are a million different modules / module compilers for JavaScript, webpack quickly became the best choice.  We made it easy to use webpack with Rails with the new <a href="https://github.com/rails/webpacker">Webpacker gem</a> , which you can automatically configure in new projects with <code>--webpack</code> (or even <code>--webpack=react</code> , <code>--webpack=angular</code> , or <code>--webpack=vue</code> for individual configuration) .  This is fully compatible with the asset pipeline, which you can continue to use for images, fonts, sounds, etc.  You may even have some javascript in the asset pipeline, and done via webpack.  This is all controlled via Yarn, which is enabled by default. <br><br></li><li>  <b>Drop jQuery as a default dependency.</b>  We used to connect jQuery to provide functions such as data-remote, data-confirm, and other parts of Rails UJS.  This dependency is no longer needed, since we <a href="http://guides.rubyonrails.org/working_with_javascript_in_rails.html">rewrote rails-ujs to use vanilla javascript</a> .  Of course, you can still use jQuery, but you no longer need it. </li></ol><br>  Thanks to <a href="https://github.com/Liceth">Liceth Ovalles</a> for her work on integrating Yarn, <a href="https://github.com/liudangyi">Dangyi Liu</a> for working on rails-ujs and <a href="https://github.com/guilleiguaran">Guillermo Iguaran</a> for accompanying all this! <br><br><h3>  System tests </h3><br>  In my <a href="https://www.youtube.com/watch%3Fv%3D9LfmrkyP81M">speech at RailsConf in 2014,</a> I talked in detail about how excessive focusing on unit tests (and TDD) led us astray.  Although unit tests are part of a complete test solution, they are not the most important.  Integration tests that test behavior all the way from controllers through models and presentations should play a much larger role.  Rails already has an excellent built-in response to this. <br><br>  But integration tests do not help test the entire system if this system uses JavaScript.  And most of the major web systems today rely to some degree on JavaScript.  This is where the system tests run under the control of a real browser. <br><br>  Responses to system tests like this are called <a href="http://teamcapybara.github.io/capybara/">Capybara</a> in Ruby.  It was just a kind of adventure to set it up correctly in Rails.  So now we have <a href="">built it right into the framework</a> !  You get a great Capybara shell, which is pre-configured for Chrome and enhanced to provide screenshots of crashes within the Action Dispatch.  You also no <a href="https://github.com/rails/rails/pull/28083">longer have to worry about additional database cleaning strategies</a> , because embedded transactional tests now roll back test system changes. <br><br>  These tests are not without compromise.  Of course, it is even slower to run the entire browser setting than to just test the model with a stub-database.  But he also checks much more.  You should be familiar with the system tests and get them as part of your test answer. <br><br>  Thanks to <a href="https://github.com/eileencodes">Eileen M. Uchitelle</a> for her work, extracted from <a href="https://basecamp.com/">Basecamp</a> ! <br><br><h3>  Encrypted secrets </h3><br>  If you check the production passwords, API keys and other secrets hidden in your version control system, you do wrong.  It is not safe and you must stop it!  Now this is just an admonition, but without a coherent answer to what you should do instead, it is also not very useful. <br><br>  People have downloaded ENV long ago to store these secrets or use many other solutions.  There are all sorts of compromises and shortcomings in the ENV model, not least that you still need to keep these secrets somewhere else. <br><br>  Inspired by the heme <a href="https://github.com/ahoward/sekrets">sekrets of</a> <a href="https://github.com/ahoward">Ara T. Howard</a> , we <a href="https://github.com/rails/rails/pull/28038">created encrypted secrets management in Rails 5.1</a> .  You can set up a new encrypted secrets file using the <code>bin/rails secrets:setup</code> .  This will create a master key that you will store outside the repository, but will allow you to commit your current production secret to your version control system.  Then they are decrypted in the process either through the key file entered or via RAILS_MASTER_KEY to ENV. <br><br>  Thanks to <a href="https://github.com/kaspth">Kasper Timm Hansen</a> for working on this and Ara for inspiration! <br><br><h3>  Parameterized mailer </h3><br>  Action Mailer modeled on Action Controller.  He supports the basics of Abstract Controller, but has long been at a disadvantage from his cousin controller in how he can share logic between actions. <br><br>  In Action Controller, <code>before_action</code> and similar callbacks are typically used to extract logic applied to multiple actions.  This is doable, since the <code>params</code> hash is available before invoking this action.  But in Action Mailer, we used the usual method signatures with explicit arguments, so these arguments were not available for filters that were executed before the actions. <br><br>  With the help of the <a href="">parameterized mailer,</a> we now give you the opportunity to call the mailer with parameters that, like in controllers, are available before invoking this action.  This is combined with the default settings for / from / reply_to headers, which drastically reduces the actions of the mailer. <br><br>  It has full backward compatibility, and you can only convert mailers that will benefit in the first place. <br><br><h3>  Direct and permitted routes </h3><br>  We have a great simple API for announcing new resource routes.  But if you want to add new programmable routes that have logic that determines the final destination based on parameters, you will have to dig it out yourself with the help of helpers and other messy approaches. <br><br>  With the help of directional routes, you can now announce programmatic routes that, with all the power of Ruby, will do different things depending on the parameters passed. <br><br>  With allowed routes, you can reprogram a polymorphic search for models based directly on compatible methods.  Thus, it will allow you to turn <code>link_to @comment</code> into a final route, such as <br>  <code>message_path(@comment.parent, anchor: "comment_#{@comment.id}")</code> . <br><br>  Thanks to <a href="https://github.com/pixeltrix">Andrew White</a> for <a href="https://github.com/rails/rails/pull/23138">doing all this work</a> ! <br><br><h3>  Merging form_tag / form_for with form_with </h3><br>  We already have two parallel structures for creating forms.  Those that were based on the <code>form_for</code> , where we used the conditional configuration to extract the details, and manually configure them with <code>form_tag</code> .  Now we merged these two hierarchies with <code><a href="https://github.com/rails/rails/issues/25197">form_with</a></code> .  One root tree, which you can configure using the output entry or manually.  It is much better and easier. <br><br>  Thanks to <a href="https://github.com/kaspth">Kasper Timm Hansen</a> for that too! <br><br><h3>  All the rest </h3><br>  In addition to the main part, we have hundreds of other fixes and improvements throughout the framework.  Please read the CHANGELOG to get acquainted with all the useful things: <br><br><ul><li>  <a href="">Action Cable CHANGELOG</a> </li><li>  <a href="">Action Mailer CHANGELOG</a> </li><li>  <a href="">Action Pack CHANGELOG</a> </li><li>  <a href="">Action View CHANGELOG</a> </li><li>  <a href="">Active Model CHANGELOG</a> </li><li>  <a href="">Active Record CHANGELOG</a> </li><li>  <a href="">Active Support CHANGELOG</a> </li><li>  <a href="">Active Job CHANGELOG</a> </li><li>  <a href="">Railties CHANGELOG</a> </li></ul><br>  We have a big summary of the high level changes in <a href="http://guides.rubyonrails.org/5_1_release_notes.html">the release notes</a> . <br><br>  Your release manager for Rails 5.1 was <a href="https://github.com/rafaelfranca">Rafael Fran√ßa</a> . <br><br>  According to our <a href="http://guides.rubyonrails.org/maintenance_policy.html">maintenance policy, the</a> release of Rails 5.1 means that bug fixes will only apply to 5.1.x, common security issues up to 5.1.x and 5.0.x, and serious security issues up to 5.1.x, 5.0.x, and 4.2.x .  This means that 4.x and below essentially will not be supported! <br><br>  Thanks to everyone in the community for their hard work testing beta versions and releasing candidates for Rails 5.1!  We made more than 600 commits after reporting errors and problems caused by this process.  Thank you!  Gracias!  Merci!  So <br><br>  <a href="http://weblog.rubyonrails.org/2017/4/27/Rails-5-1-final/">Original article</a> </div><p>Source: <a href="https://habr.com/ru/post/327658/">https://habr.com/ru/post/327658/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../327642/index.html">How laser roulette works: reverse engineering</a></li>
<li><a href="../327644/index.html">SVG support and CompactOverlay mode in UWP applications</a></li>
<li><a href="../327646/index.html">First time (sketches from one workshop)</a></li>
<li><a href="../327648/index.html">How Do I Apply?</a></li>
<li><a href="../327656/index.html">The digest of interesting materials for the mobile developer # 201 (April 24 - 30)</a></li>
<li><a href="../327662/index.html">Swift Generics: Styles for UIView and more. # 1</a></li>
<li><a href="../327666/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ260 (April 24 - 30, 2017)</a></li>
<li><a href="../327668/index.html">Quick start on React Native</a></li>
<li><a href="../327670/index.html">Monitoring Docker Swarm with cAdvisor, InfluxDB and Grafana</a></li>
<li><a href="../327674/index.html">Bucardo: Multimaster replication</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>