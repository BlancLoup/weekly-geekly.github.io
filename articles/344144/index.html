<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Binary search in graphs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Binary search is one of the most basic algorithms known to me. Having a sorted list of comparable items and a target item, the binary search looks in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Binary search in graphs</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1a9/9cc/8e4/1a99cc8e4f4dd7a7b83cdf9d46b65093.png" width="50%" height="50%"></div><br>  Binary search is one of the most basic algorithms known to me.  Having a sorted list of comparable items and a target item, the binary search looks in the middle of the list and compares the value with the target item.  If the goal is larger, we repeat with the lower half of the list, and vice versa. <br><br>  For each comparison, the binary search algorithm splits the search space in half.  Thanks to this there will always be no more <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.722ex" height="2.66ex" viewBox="0 -832 2894 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6F" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-67" x="1034" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-28" x="1514" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6E" x="1904" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-29" x="2504" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1"> \ log (n) </script>  comparisons with runtime <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.495ex" height="2.66ex" viewBox="0 -832 3657.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6C" x="1403" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6F" x="1701" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-67" x="2187" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6E" x="2667" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-29" x="3268" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>l</mi><mi>o</mi><mi>g</mi><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2"> O (\ log n) </script>  .  Beautiful, effective, useful. <br><br>  But you can always look at a different angle. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      What if I try to perform a binary search on a graph?  Most graph search algorithms, such as wide or deep search, require linear time and were thought up by pretty smart people.  Therefore, if a binary search by a graph has any meaning, then it should use more information than the one that ordinary search algorithms have access to. <br><a name="habracut"></a><br>  For a binary list search, this information is the fact that the list is sorted, and to control the search, we can compare numbers with the item we are looking for.  But in fact, the most important information is not related to the comparability of the elements.  It lies in the fact that we can get rid of half the search space at each stage.  The stage ‚Äúcomparison with target value‚Äù can be perceived as a black box responding to requests like ‚ÄúIs this the value I was looking for?‚Äù With the answers ‚ÄúYes‚Äù or ‚ÄúNo, but look better here‚Äù <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7f0/3bc/818/7f03bc818da8ff5af3061ca8792e6931.png"></div><br>  If the answers to our queries are quite useful, that is, they allow us to separate large amounts of search space at each stage, then it looks like we got a good algorithm.  In fact, there is a natural model of graphs, defined in the <a href="https://arxiv.org/abs/1503.00805">article</a> Emamjome-Zade, Kempe, and Singel 2015 as follows. <br><br>  We receive as input an undirected weighted graph. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.331ex" height="2.66ex" viewBox="0 -832 4878.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-47" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-3D" x="1064" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-28" x="2120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-56" x="2510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-2C" x="3279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-45" x="3724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-29" x="4489" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3"> G = (V, E) </script>  with weights <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mi>e</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.663ex" height="1.817ex" viewBox="0 -520.7 1146.4 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-65" x="1013" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>e</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-4"> w_e </script>  at <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>e</mi><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><mi>E</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.637ex" height="2.057ex" viewBox="0 -780.1 2427 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-65" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-69" x="716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6E" x="1062" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-45" x="1662" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><mi>E</mi></math></span></span><script type="math/tex" id="MathJax-Element-5"> e \ in E </script>  .  We see the whole graph and can ask questions in the form of "Is a vertex <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>v</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.128ex" height="1.455ex" viewBox="0 -520.7 485.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-76" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-6"> v </script>  necessary to us? "Answers can have two options: <br><br><ul><li>  Yes (we won!) </li><li>  No, but <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>e</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>v</mi><mo>,</mo><mi>w</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.817ex" height="2.66ex" viewBox="0 -832 4226.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-65" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-3D" x="744" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-28" x="1800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-76" x="2190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-2C" x="2675" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-77" x="3120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-29" x="3837" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mo>=</mo><mo stretchy="false">(</mo><mi>v</mi><mo>,</mo><mi>w</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> e = (v, w) </script>  is the edge of <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>v</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.128ex" height="1.455ex" viewBox="0 -520.7 485.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-76" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-8"> v </script>  on the shortest path from <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>v</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.128ex" height="1.455ex" viewBox="0 -520.7 485.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-76" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> v </script>  to the desired vertex. </li></ul><br>  Our goal is to find the right vertex for the minimum number of queries. <br><br>  Obviously, this only works if <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.827ex" height="2.057ex" viewBox="0 -780.1 786.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-47" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> G </script>  is a connected graph, but small variations in the article will work for unrelated graphs.  (In general, this is not true for directed graphs.) <br><br>  When a graph is a line, the task is ‚Äúreduced‚Äù to a binary search in the sense that the same basic idea is used as in the binary search: we start from the middle of the graph, and the edge we get in response to the query tells us in which half count to continue the search. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e02/264/b95/e02264b958f2792c89dbc8b00fa4bd03.png"></div><br>  And if we make this example a bit more complicated, then the generalization will become obvious: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/396/412/0a7/3964120a791cd5a5f8a3c4686d3e7023.png"></div><br>  Here we start again from the ‚Äúcentral peak‚Äù and the answer to our inquiry will relieve us of one of the two halves.  But how then do we choose the next vertex, because now we do not have a linear order?  It should be obvious - choose the ‚Äúcentral top‚Äù of any half in which we find ourselves.  This choice can be formalized into a rule that will work even in the absence of obvious symmetry, and as it turns out, this choice will always be the right one. <br><br>  <strong>Definition:</strong> <em>median</em> weighted graph <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.827ex" height="2.057ex" viewBox="0 -780.1 786.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-47" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> G </script>  relative to a subset of vertices <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>e</mi><mi>t</mi><mi>V</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.298ex" height="2.057ex" viewBox="0 -780.1 4434 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-73" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-75" x="1365" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-62" x="1937" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-73" x="2367" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-65" x="2836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-74" x="3303" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-56" x="3664" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><mi>b</mi><mi>s</mi><mi>e</mi><mi>t</mi><mi>V</mi></math></span></span><script type="math/tex" id="MathJax-Element-12"> S \ subset V </script>  is the top <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>v</mi><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><mi>V</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.693ex" height="2.057ex" viewBox="0 -780.1 2451 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-76" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-69" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6E" x="1081" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-56" x="1681" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><mi>V</mi></math></span></span><script type="math/tex" id="MathJax-Element-13"> v \ in V </script>  (not necessarily located in <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.057ex" viewBox="0 -780.1 645.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-53" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-14"> S </script>  ), which minimizes the sum of the distances between vertices in <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.057ex" viewBox="0 -780.1 645.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-53" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-15"> S </script>  &gt;.  More formally, it minimizes <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>P</mi><mi>h</mi><msub><mi>i</mi><mi>S</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>v</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>u</mi><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><mi>S</mi></mrow></msub><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>v</mi><mo>,</mo><mi>u</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.72ex" height="2.66ex" viewBox="0 -832 11934.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-50" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-68" x="1001" y="0"></use><g transform="translate(1578,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-53" x="488" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-28" x="2479" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-76" x="2869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-29" x="3354" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-3D" x="4022" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-73" x="5328" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-75" x="5797" y="0"></use><g transform="translate(6370,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-69" x="926" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6E" x="1271" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-53" x="1872" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-64" x="9129" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-28" x="9652" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-76" x="10042" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-2C" x="10527" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-75" x="10972" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-29" x="11545" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>P</mi><mi>h</mi><msub><mi>i</mi><mi>S</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>u</mi><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><mi>S</mi></mrow></msub><mi>d</mi><mo stretchy="false">(</mo><mi>v</mi><mo>,</mo><mi>u</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> \ Phi_S (v) = \ sum_ {u \ in S} d (v, u) </script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.516ex" height="2.66ex" viewBox="0 -832 2805.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-28" x="523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-75" x="913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-2C" x="1485" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-76" x="1930" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-29" x="2416" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">(</mo><mi>u</mi><mo>,</mo><mi>v</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17"> d (u, v) </script>  - sum of edge weights along the shortest path from <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>v</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.128ex" height="1.455ex" viewBox="0 -520.7 485.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-76" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-18"> v </script>  before <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>u</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-75" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-19"> u </script>  . <br><br>  The generalization of a binary search to such a model with queries on the graph leads us to the following algorithm, which limits the search space by querying the median at each step. <br><br>  <strong>Algorithm:</strong> binary search in columns.  The input data is a graph. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.331ex" height="2.66ex" viewBox="0 -832 4878.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-47" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-3D" x="1064" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-28" x="2120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-56" x="2510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-2C" x="3279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-45" x="3724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-29" x="4489" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-20"> G = (V, E) </script>  . <br><br><ul><li>  We start with a lot of candidates <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mo>=</mo><mi>v</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.725ex" height="2.057ex" viewBox="0 -780.1 2465.1 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-3D" x="923" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-76" x="1979" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mo>=</mo><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-21"> S = v </script>  . </li><li>  Until we found the right vertex and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mo>&amp;gt;</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.054ex" height="2.66ex" viewBox="0 -832 3037.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-7C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-53" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-7C" x="924" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-3E" x="1480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-31" x="2536" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>&gt;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-22"> | S | > 1 </script>  : <br><ul><li>  Requesting median <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>v</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.128ex" height="1.455ex" viewBox="0 -520.7 485.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-76" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-23"> v </script>  sets <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.057ex" viewBox="0 -780.1 645.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-53" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-24"> S </script>  and stop if we find the desired vertex. </li><li>  Otherwise, let <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>e</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>v</mi><mo>,</mo><mi>w</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.817ex" height="2.66ex" viewBox="0 -832 4226.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-65" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-3D" x="744" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-28" x="1800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-76" x="2190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-2C" x="2675" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-77" x="3120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-29" x="3837" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi><mo>=</mo><mo stretchy="false">(</mo><mi>v</mi><mo>,</mo><mi>w</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-25"> e = (v, w) </script>  will be the edge received in response to the query;  calculate the set of all vertices <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><mi>V</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.895ex" height="2.057ex" viewBox="0 -780.1 2538 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-69" x="822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6E" x="1168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-56" x="1768" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><mi>V</mi></math></span></span><script type="math/tex" id="MathJax-Element-26"> x \ in V </script>  for which <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>e</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.083ex" height="1.455ex" viewBox="0 -520.7 466.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-65" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-27"> e </script>  is the shortest path of <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>v</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.128ex" height="1.455ex" viewBox="0 -520.7 485.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-76" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-28"> v </script>  at <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-29"> x </script>  .  Call this set <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.636ex" height="2.057ex" viewBox="0 -780.1 704.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-54" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-30"> T </script>  . </li><li>  Replace <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.057ex" viewBox="0 -780.1 645.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-53" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-31"> S </script>  on <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>a</mi><mi>p</mi><mi>t</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.326ex" height="2.419ex" viewBox="0 -780.1 2723.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-63" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-61" x="1329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-70" x="1858" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-74" x="2362" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi><mtext>&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>p</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-32"> S \ cap t </script>  . </li></ul></li><li>  Print the only remaining vertex in <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.499ex" height="2.057ex" viewBox="0 -780.1 645.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-53" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-33"> S </script></li></ul><br>  Indeed, as we will soon see, implementing in Python will be almost as simple.  The most important part of the work is to calculate the median and the set <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.636ex" height="2.057ex" viewBox="0 -780.1 704.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-54" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-34"> T </script>  .  Both of these operations are small varieties of <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25BB%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D1%2582%25D0%25BC_%25D0%2594%25D0%25B5%25D0%25B9%25D0%25BA%25D1%2581%25D1%2582%25D1%2580%25D1%258B">the Dijkstra algorithm</a> for computing the shortest paths. <br><br>  A theorem that is simple and <a href="https://arxiv.org/abs/1503.00805">well formulated by</a> Emamjome-Zadeh and his colleagues (about half of the page on page 5 in total) is that the algorithm requires only <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.304ex" height="2.66ex" viewBox="0 -832 4436.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6C" x="1403" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6F" x="1701" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-67" x="2187" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-28" x="2667" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6E" x="3057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-29" x="3657" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-29" x="4047" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-35"> O (\ log (n)) </script>  queries - the same as in the binary search. <br><br>  Before we dive into the implementation, it‚Äôs worth considering one trick.  Even despite the fact that we are guaranteed to be no more <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.722ex" height="2.66ex" viewBox="0 -832 2894 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6F" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-67" x="1034" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-28" x="1514" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-6E" x="1904" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMAIN-29" x="2504" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-36"> \ log (n) </script>  queries, because of our implementation of Dijkstra‚Äôs algorithm, we definitely won‚Äôt have a logarithmic time algorithm.  What would be useful in such a situation? <br><br>  Here we will use the ‚Äútheory‚Äù - we will create a fictional task, for which we will later find application (which is quite successfully used in computer science).  In this case, we will treat the request mechanism as a black box.  It will be natural to imagine that requests are time-consuming and are a resource that needs to be optimized.  For example, as the authors wrote in <a href="https://arxiv.org/abs/1710.05422">an additional article</a> , the graph can be a multitude of groupings of a set of data, and requests require the intervention of a person looking at the data and telling which classer should be divided, or which two clusters should be combined.  Of course, the graph is too large to handle when grouped, so the median search algorithm must be implicitly defined.  But the most important thing is clear: sometimes a request is the most expensive part of the algorithm. <br><br>  Well, let's implement it all!  The full code, as always <a href="https://github.com/j2kun/binary-search-graphs">on Github</a> . <br><br><h2>  We implement the algorithm </h2><br>  We start with a small variation of Dijkstra‚Äôs algorithm.  Here we are given the ‚Äústarting‚Äù point as input, and as output we create a list of all the shortest paths to all possible final vertices. <br><br>  We will start with a bare graph data structure. <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> collections <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> defaultdict <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> collections <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> namedtuple Edge = namedtuple(<span class="hljs-string"><span class="hljs-string">'Edge'</span></span>, (<span class="hljs-string"><span class="hljs-string">'source'</span></span>, <span class="hljs-string"><span class="hljs-string">'target'</span></span>, <span class="hljs-string"><span class="hljs-string">'weight'</span></span>)) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Graph</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#      def __init__(self, vertices, edges=tuple()): self.vertices = vertices self.incident_edges = defaultdict(list) for edge in edges: self.add_edge( edge[0], edge[1], 1 if len(edge) == 2 else edge[2] #   ) def add_edge(self, u, v, weight=1): self.incident_edges[u].append(Edge(u, v, weight)) self.incident_edges[v].append(Edge(v, u, weight)) def edge(self, u, v): return [e for e in self.incident_edges[u] if e.target == v][0]</span></span></code> </pre> <br>  Now, since most of the work in the Dijkstra algorithm is to track the information accumulated when searching on a graph, we define an ‚Äúoutput‚Äù data structure ‚Äî a dictionary with edge weights, along with backward pointers to the shortest paths found. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DijkstraOutput</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, graph, start)</span></span></span><span class="hljs-function">:</span></span> self.start = start self.graph = graph <span class="hljs-comment"><span class="hljs-comment">#        v self.distance_from_start = {v: math.inf for v in graph.vertices} self.distance_from_start[start] = 0 #        #        self.predecessor_edges = {v: [] for v in graph.vertices} def found_shorter_path(self, vertex, edge, new_distance): #        self.distance_from_start[vertex] = new_distance if new_distance &lt; self.distance_from_start[vertex]: self.predecessor_edges[vertex] = [edge] else: # ""     self.predecessor_edges[vertex].append(edge) def path_to_destination_contains_edge(self, destination, edge): predecessors = self.predecessor_edges[destination] if edge in predecessors: return True return any(self.path_to_destination_contains_edge(e.source, edge) for e in predecessors) def sum_of_distances(self, subset=None): subset = subset or self.graph.vertices return sum(self.distance_from_start[x] for x in subset)</span></span></code> </pre> <br>  Dijkstra‚Äôs real algorithm then performs a wide search (controlled by priority queue) by <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.827ex" height="2.057ex" viewBox="0 -780.1 786.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-47" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-37"> G </script>  by updating metadata while finding shorter paths. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">single_source_shortest_paths</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(graph, start)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">'''             .   DijkstraOutput. '''</span></span> output = DijkstraOutput(graph, start) visit_queue = [(<span class="hljs-number"><span class="hljs-number">0</span></span>, start)] <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> len(visit_queue) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>: priority, current = heapq.heappop(visit_queue) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> incident_edge <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> graph.incident_edges[current]: v = incident_edge.target weight = incident_edge.weight distance_from_current = output.distance_from_start[current] + weight <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> distance_from_current &lt;= output.distance_from_start[v]: output.found_shorter_path(v, incident_edge, distance_from_current) heapq.heappush(visit_queue, (distance_from_current, v)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> output</code> </pre> <br>  Finally, we implement subroutines for finding the median and computing <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.636ex" height="2.057ex" viewBox="0 -780.1 704.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/344144/&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiJLdEJJHONwE8pXtHx_1mLftJUPw#MJMATHI-54" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-38"> T </script>  : <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">possible_targets</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(graph, start, edge)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">'''     G = (V,E),   v  V   e,  v,    w, ,  e      v  w. '''</span></span> dijkstra_output = dijkstra.single_source_shortest_paths(graph, start) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> set(v <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> graph.vertices <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> dijkstra_output.path_to_destination_contains_edge(v, edge)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find_median</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(graph, vertices)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">'''    output    ,         '''</span></span> best_dijkstra_run = min( (single_source_shortest_paths(graph, v) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> graph.vertices), key=<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> run: run.sum_of_distances(vertices) ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> best_dijkstra_run.start</code> </pre> <br>  And now the core of the algorithm <br><br><pre> <code class="python hljs">QueryResult = namedtuple(<span class="hljs-string"><span class="hljs-string">'QueryResult'</span></span>, (<span class="hljs-string"><span class="hljs-string">'found_target'</span></span>, <span class="hljs-string"><span class="hljs-string">'feedback_edge'</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">binary_search</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(graph, query)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">'''          "  x  ?"    -  "   !",  "       ". '''</span></span> candidate_nodes = set(x <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> graph.vertices) <span class="hljs-comment"><span class="hljs-comment">#  while len(candidate_nodes) &gt; 1: median = find_median(graph, candidate_nodes) query_result = query(median) if query_result.found_target: return median else: edge = query_result.feedback_edge legal_targets = possible_targets(graph, median, edge) candidate_nodes = candidate_nodes.intersection(legal_targets) return candidate_nodes.pop()</span></span></code> </pre> <br>  Here is an example of running a script on a sample graph, which we used above in a post: <br><br><pre> <code class="python hljs"><span class="hljs-string"><span class="hljs-string">'''        ak bj cfghi dl em '''</span></span> G = Graph([<span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>, <span class="hljs-string"><span class="hljs-string">'c'</span></span>, <span class="hljs-string"><span class="hljs-string">'d'</span></span>, <span class="hljs-string"><span class="hljs-string">'e'</span></span>, <span class="hljs-string"><span class="hljs-string">'f'</span></span>, <span class="hljs-string"><span class="hljs-string">'g'</span></span>, <span class="hljs-string"><span class="hljs-string">'h'</span></span>, <span class="hljs-string"><span class="hljs-string">'i'</span></span>, <span class="hljs-string"><span class="hljs-string">'j'</span></span>, <span class="hljs-string"><span class="hljs-string">'k'</span></span>, <span class="hljs-string"><span class="hljs-string">'l'</span></span>, <span class="hljs-string"><span class="hljs-string">'m'</span></span>], [ (<span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>), (<span class="hljs-string"><span class="hljs-string">'b'</span></span>, <span class="hljs-string"><span class="hljs-string">'c'</span></span>), (<span class="hljs-string"><span class="hljs-string">'c'</span></span>, <span class="hljs-string"><span class="hljs-string">'d'</span></span>), (<span class="hljs-string"><span class="hljs-string">'d'</span></span>, <span class="hljs-string"><span class="hljs-string">'e'</span></span>), (<span class="hljs-string"><span class="hljs-string">'c'</span></span>, <span class="hljs-string"><span class="hljs-string">'f'</span></span>), (<span class="hljs-string"><span class="hljs-string">'f'</span></span>, <span class="hljs-string"><span class="hljs-string">'g'</span></span>), (<span class="hljs-string"><span class="hljs-string">'g'</span></span>, <span class="hljs-string"><span class="hljs-string">'h'</span></span>), (<span class="hljs-string"><span class="hljs-string">'h'</span></span>, <span class="hljs-string"><span class="hljs-string">'i'</span></span>), (<span class="hljs-string"><span class="hljs-string">'i'</span></span>, <span class="hljs-string"><span class="hljs-string">'j'</span></span>), (<span class="hljs-string"><span class="hljs-string">'j'</span></span>, <span class="hljs-string"><span class="hljs-string">'k'</span></span>), (<span class="hljs-string"><span class="hljs-string">'i'</span></span>, <span class="hljs-string"><span class="hljs-string">'l'</span></span>), (<span class="hljs-string"><span class="hljs-string">'l'</span></span>, <span class="hljs-string"><span class="hljs-string">'m'</span></span>), ]) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">simple_query</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(v)</span></span></span><span class="hljs-function">:</span></span> ans = input(<span class="hljs-string"><span class="hljs-string">"  '%s'  ? [y/N] "</span></span> % v) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ans <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> ans.lower()[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-string"><span class="hljs-string">'y'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> QueryResult(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: print(<span class="hljs-string"><span class="hljs-string">"     "</span></span> <span class="hljs-string"><span class="hljs-string">" '%s'   . : "</span></span> % v) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> w <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> G.incident_edges: print(<span class="hljs-string"><span class="hljs-string">"%s: %s"</span></span> % (w, G.incident_edges[w])) target = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> target <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> G.vertices: target = input(<span class="hljs-string"><span class="hljs-string">"   '%s': "</span></span> % v) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> QueryResult( <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, G.edge(v, target) ) output = binary_search(G, simple_query) print(<span class="hljs-string"><span class="hljs-string">"  : %s"</span></span> % output)</code> </pre> <br>  The query function simply displays a reminder about the structure of the graph and asks the user to answer (yes / no) and report the corresponding edge if in case of a negative answer. <br><br>  Execution Example: <br><br> <code>  'g'  ? [y/N] n <br>       'g'   . : <br> e: [Edge(source='e', target='d', weight=1)] <br> i: [Edge(source='i', target='h', weight=1), Edge(source='i', target='j', weight=1), Edge(source='i', target='l', weight=1)] <br> g: [Edge(source='g', target='f', weight=1), Edge(source='g', target='h', weight=1)] <br> l: [Edge(source='l', target='i', weight=1), Edge(source='l', target='m', weight=1)] <br> k: [Edge(source='k', target='j', weight=1)] <br> j: [Edge(source='j', target='i', weight=1), Edge(source='j', target='k', weight=1)] <br> c: [Edge(source='c', target='b', weight=1), Edge(source='c', target='d', weight=1), Edge(source='c', target='f', weight=1)] <br> f: [Edge(source='f', target='c', weight=1), Edge(source='f', target='g', weight=1)] <br> m: [Edge(source='m', target='l', weight=1)] <br> d: [Edge(source='d', target='c', weight=1), Edge(source='d', target='e', weight=1)] <br> h: [Edge(source='h', target='g', weight=1), Edge(source='h', target='i', weight=1)] <br> b: [Edge(source='b', target='a', weight=1), Edge(source='b', target='c', weight=1)] <br> a: [Edge(source='a', target='b', weight=1)] <br>    'g': f <br>   'c'  ? [y/N] n <br>       'c'   . : <br> [...] <br>    'c': d <br>   'd'  ? [y/N] n <br>       'd'   . : <br> [...] <br>    'd': e <br>   : e</code> <br> <br><h2>  Probabilistic history </h2><br>  The binary search implemented by us in this post is quite minimalistic.  In fact, the more interesting part of Emamjome-Zade's work with colleagues is the part in which the answer to the request may be incorrect with an unknown probability. <br><br>  In this case, there may be a set of shortest paths that are the correct answer to the request, in addition to all the incorrect answers.  In particular, this excludes the strategy of transmitting the same request several times and selecting the most popular answer.  If the error frequency is 1/3, and there are two shortest paths to the desired vertex, then we can get a situation in which we will see three answers with equal frequency and will not be able to figure out which one is false. <br><br>  Instead, Emamjome-Zade and his co-authors use a technique based on the algorithm of updating multiplicative weights ( <a href="https://jeremykun.com/2017/02/27/the-reasonable-effectiveness-of-the-multiplicative-weights-update-algorithm/">he is back in business!</a> ).  Each query gives a multiplicative increase (or decrease) for a set of nodes that are constant, desired vertices, provided that the answer to the query is correct.  There are some more details and post-processing to avoid incredible results, but in general, the basic idea is this.  Its implementation will be an excellent exercise for readers interested in learning more deeply from this recent article (or pondering their mathematical muscles) <br><br>  But if you look even deeper, this model of ‚Äúrequesting and receiving advice on how to improve the result‚Äù is the classical learning model <a href="http://machinelearning202.pbworks.com/f/AngluinQueriesConceptLearningfulltext.pdf">first formally studied by</a> Dana Engluin.  In her model, an algorithm is designed for training the classifier.  Valid queries are <em>membership</em> and <em>equivalence</em> queries.  Affiliation is, in essence, the question ‚ÄúWhat is the label of this element?‚Äù, And the equivalence query looks like ‚ÄúIs this a correct classifier?‚Äù If the answer is ‚Äúno‚Äù, then an example with the wrong label is passed. <br><br>  This is different from the usual machine learning assumption, because the learning algorithm has <em>to create</em> an example about which it wants more information, and not just rely on a randomly generated subset of data.  The goal is to minimize the number of queries until the algorithm exactly learns the desired hypothesis.  And in fact - as we saw in this post, if we have a little extra time to study the problem space, then we can create queries that receive a lot of information. <br><br>  The model of binary search by graphs presented here is a natural analogue of the equivalence query in the search problem: instead of a counter-example with an incorrect label, we get a ‚Äúpush‚Äù in the right direction to the goal.  Pretty good! <br><br>  Here we can go in different ways: (1) implement a version of the algorithm with multiplicative weights, (2) apply this technique to the task of ranking or grouping, or (3) consider in more detail theoretical models of learning such as belonging and equivalence. </div><p>Source: <a href="https://habr.com/ru/post/344144/">https://habr.com/ru/post/344144/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../344134/index.html">Top 10 examples and anti-examples of developer-audience interaction: Part One</a></li>
<li><a href="../344136/index.html">New life old pagination</a></li>
<li><a href="../344138/index.html">10 best free CRM systems for business</a></li>
<li><a href="../344140/index.html">Rostelecom: other people's accounts are not spam</a></li>
<li><a href="../344142/index.html">When the butler is a victim</a></li>
<li><a href="../344146/index.html">Kotlin Night Moscow - video, photo, presentation</a></li>
<li><a href="../344150/index.html">Survey for users of the browser Vivaldi</a></li>
<li><a href="../344156/index.html">Visual Studio extension to render instances of custom classes in debug mode. Part 2</a></li>
<li><a href="../344160/index.html">List of useful ideas for high-load services</a></li>
<li><a href="../344164/index.html">Layers, Bulbs, Hexogons, Ports and Adapters - it's all about one thing</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>