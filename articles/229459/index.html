<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Do-it-yourself visitor</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It's hard enough to find someone who would not watch the wonderful Soviet film ‚ÄúKin-Dza-Dza!‚Äù 
 I think that many had a desire to assemble a visitor -...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Do-it-yourself visitor</h1><div class="post__text post__text-html js-mediator-article">  It's hard enough to find someone who would not watch the wonderful Soviet film ‚ÄúKin-Dza-Dza!‚Äù <br>  I think that many had a desire to assemble a visitor - a device that allows us to distinguish chatlan from patsaks. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a52/a4d/14a/a52a4d14a8db280b6a215062bfb3ea2b.jpg"><br><br>  Now I will tell you how to assemble this wonderful device.  Comic, of course :) <br><a name="habracut"></a><br>  There is nothing difficult in blinking LEDs and peep piezo-speakers.  The most interesting and difficult in this problem is always to get the same result for each person.  Many ideas were passed over in my head, but in the end it was decided that people should somehow be tagged.  Of course, first and foremost, you need to label yourself so that you can proudly be a chatlanin, before whom you must do ‚ÄúKu!‚Äù 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/cb9/c7c/a1d/cb9c7ca1d9061274fd2e93a4a5e76e99.jpg" alt="image"><br><br>  However, such a label should be invisible to others.  The decision came quickly enough.  I took the remote from the TV and made sure that it punches perfectly through the T-shirt.  So it was decided to use a TSOP17xx-type remote receiver in the visitor, and hide a small board with an infrared LED under the T-shirt, which should blink accordingly, similar to the way the LEDs in the remote controls flash. <br><br><h4>  Make a "label" </h4><br>  I quickly sketched a fee for this label: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/afd/6a5/8a2/afd6a58a22d41fcff3ea9eabfe582523.png"><br><br>  In the center of the microcontroller ATmega8A.  In fact, this is very unnecessary, and some ATtiny would suffice here, but nothing was simpler in my presence.  Yes, it would be possible to do without a microcontroller at all, but it is much easier to adjust the timings.  On top of the two holes under the infrared LED, which is turned on through the transistor, and two more holes are scheduled so that you can thread and hang the device around your neck. <br><br>  The firmware is nowhere easier: <br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   C3   DDRC |= (1&lt;&lt;3); while (1) { //   50   ,  -    _delay_ms(50); int t; //   100  for (t = 0; t &lt; 100; t++) { //   PORTC |= (1&lt;&lt;3); //   11  _delay_us(11); //   PORTC &amp;= ~(1&lt;&lt;3); //   11  _delay_us(11); } } }</span></span></code> </pre> <br><br>  The blinking of the LED will occur continuously while the power is on.  I use a pause of 11 microseconds, which gives a frequency of about 45-46 kilohertz.  It is worth experimenting with this value, it depends on the type of remote control and greatly influences how well the signal will be caught through a T-shirt. <br><br>  Alas, for such a bright (if you can say so about invisible IR light) glow, a sufficiently large current is required, so you have to hide the batteries in your pocket.  Two AA batteries are enough, but for complete reliability it is better to take three or even four. <br><br>  Here's what happened: <br><br><img src="//habrastorage.org/files/5aa/c7a/fa2/5aac7afa2b434044b9c71f12b6c99886.jpg"><br><img src="//habrastorage.org/files/cf5/6f0/f53/cf56f0f53ef74b6391c261b1ba72212d.jpg"><br><br>  If you take pictures of yourself in the dark and without a flash, you can see how it shines through a T-shirt: <br><br> <a href=""><img src="//habrastorage.org/files/870/da5/414/870da5414d0643d9aaad5a894069e9fb.jpg"></a> <br><br>  The human eye is, of course, inaccessible.  By the way, it turned out to be much more convenient to fasten the label on an ordinary plaster. <br><br><h4>  We do the visitor himself </h4><br>  So, in the visitor we should have: <br><ul><li>  Microcontroller, I took the same ATmega8A, but again this is unnecessarily </li><li>  Remote control receiver TSOP17xx </li><li>  Green LED for patsakov </li><li>  LED orange for chatlan </li><li>  Power button </li><li>  Piezodinamik, because  in the film, the visitor made a sound </li></ul><br><br>  The fee turned out this: <br><br><img src="//habrastorage.org/files/ab3/1fd/41f/ab31fd41f24547bd902f9c93d8bf1de5.PNG"><br><br>  The algorithm works as follows: <br><ol><li>  The user presses a button that simply powers up. </li><li>  For half a second we are waiting for the signal from the remote control </li><li>  If the signal was, light the orange LED, otherwise the green </li><li>  In an infinite loop, we issue a corresponding squeak until the power stops. </li></ol><br><br>  Respectively code: <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//   #define LED_GREEN_ON PORTC |= (1&lt;&lt;2) #define LED_GREEN_OFF PORTC &amp;= ~(1&lt;&lt;2) #define LED_ORANGE_ON PORTC |= (1&lt;&lt;1) #define LED_ORANGE_OFF PORTC &amp;= ~(1&lt;&lt;1) #define SOUND_0 PORTD &amp;= ~(1&lt;&lt;5) #define SOUND_1 PORTD |= (1&lt;&lt;5) #define SIGNAL (!(PINC&amp;1)) int main (void) { //   - DDRC &amp;= ~1; //  PORTC |= 1; //    LED_GREEN_OFF; LED_ORANGE_OFF; //    DDRC |= (1&lt;&lt;1) | (1&lt;&lt;2); //    DDRD |= (1&lt;&lt;5); //     ,     _delay_ms(50); int t; int chatlanin = 0; // 500     for (t = 0; t &lt; 500; t++) { //  -     -,   ,   ! if (SIGNAL) chatlanin = 1; _delay_ms(1); } //    if (chatlanin) { LED_ORANGE_ON; } else { LED_GREEN_ON; } //    while (1) { //    if (chatlanin) { SOUND_1; _delay_ms(1); SOUND_0; _delay_ms(1); } //    else { SOUND_1; _delay_ms(7); SOUND_0; _delay_ms(7); } } }</span></span></code> </pre><br><br>  The fee of the visitor with the battery turned out to be this: <br><br><img src="//habrastorage.org/files/6cc/118/1c2/6cc1181c26e6485281d65464981d4afc.jpg"><br>  Sorry for the dirt on the board, my ultrasonic bath broke down. <br><br>  Then I quickly sketched a 3D model of the case to print it on a 3D printer.  At that moment I didn‚Äôt really try, so it turned out to be quite collective: <br><br> <a href=""><img src="//habrastorage.org/files/19a/6b5/e3b/19a6b5e3b9c341b78c4d386f1ac2536e.jpg"></a> <br><br>  Now you can play friends!  Of course, provided that they do not read Habrahabr.  The reaction is usually very positive :) Video with a demonstration of the device in operation: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/EiA0luQmgTM%3Ffeature%3Doembed&amp;xid=17259,1500003,15700023,15700043,15700186,15700191,15700253&amp;usg=ALkJrhhJPzWO_sItOrN8MMbXyLUKGdycfA" frameborder="0" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/229459/">https://habr.com/ru/post/229459/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../229445/index.html">A team of enthusiasts could not bring the ISEE-3 satellite ‚Äúfrozen‚Äù for 17 years</a></li>
<li><a href="../229449/index.html">Pseudo-random image (on the example of the 404th error page)</a></li>
<li><a href="../229451/index.html">MSI GX70 laptop video review</a></li>
<li><a href="../229453/index.html">Nvidia + Nexus 7 + two magnifiers + box = VR helmet</a></li>
<li><a href="../229455/index.html">TinyBanker banking trojan source leaked to network</a></li>
<li><a href="../229461/index.html">Check the validity of in-game purchases through the Google API</a></li>
<li><a href="../229465/index.html">Automatic code alignment</a></li>
<li><a href="../229467/index.html">Android last.fm scrobbler WAIL Beta is now open source</a></li>
<li><a href="../229469/index.html">We analyze the protocol of new sensors Noolite</a></li>
<li><a href="../229471/index.html">We charge Lumia with the power of sound</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>