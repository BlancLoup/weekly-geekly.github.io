<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ICQ: 20 years is not the limit</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A year ago, we recalled how, from release to release, ICQ was subjected to plastic surgery and facelift. But today is the anniversary - ICQ is 20 year...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ICQ: 20 years is not the limit</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/88d/fd3/eda/88dfd3edac284cb4b36a101e2ae6688e.jpg"></div><br>  A year ago, we <a href="https://habrahabr.ru/company/mailru/blog/271317/">recalled</a> how, from release to release, ICQ was subjected to plastic surgery and facelift.  But today is the anniversary - ICQ is 20 years old, this is not a cat sneezed!  Already a whole generation has grown up with the progenitor of instant messengers.  And in honor of such an event, we decided to look in retrospect, which technologies were used in ICQ for two decades. <br><a name="habracut"></a><br>  Over the years, the network has not much information about the first years of ICQ development.  The first version, released on November 15, 1996 by four Israeli high school students, was as simple as three rubles.  In fact, she could only exchange messages.  A client was connected to the server icq.mirabilis.com, to port UDP 4000. <br><br><img src="https://habrastorage.org/files/e87/938/3d2/e879383d23614d51891fbf1d4a09d441.png"><br><br>  A year later, by December 1997, there were client applications for Windows 3.1x, 95, NT and Macintosh.  The total number of users exceeded 5 million, the daily audience reached 1.3 million, and 300,000 users were online at the same time.  Today it seems ridiculous against the background of social networks and instant messengers in every mobile phone.  But, for a minute - 1997, the Internet through dial-up, no broadband access to you, pagers are mostly available from a wide range of mobile gadgets. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In 1998, ICQ user base every three weeks increased by 1 million people.  Almost explosive growth of the audience forced developers to quickly develop the client and the ICQ protocol.  In the version of ICQ 98, the microblogging function appeared, in 98SE - the repeated sending of undelivered messages. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ddd/11f/02b/ddd11f02b57547f3a38ea2852d03b39a.png"></div><br>  In mid-1998, Mirabilis was taken over by AOL (America Online) for $ 407 million. <br><br>  Only 2.5 years after its appearance, ICQ Version 99a has finally acquired the minimum gentlemanly set of functions: saving the history of correspondence, searching for users, sending emails, creating groups in the contact list, and so on. <br><br><img src="https://habrastorage.org/files/abb/941/107/abb941107308419dac104a50a68e179a.png"><br><br>  The ICQ protocol combined the features of p2p and client-server architectures.  Initially, encryption was not used at all, that is, the data was transferred to the open.  And indeed, the first few versions of the protocol were <a href="http://insecure.org/sploits/icq.spoof.overflow.seq.html">leaky, like a sieve</a> . <br><br>  By the time ICQ 99b was released, the fifth version of the protocol was already running.  It is necessary to clarify that the very first version was not used in public releases, that is, ICQ was formally published with the second version of the protocol.  The third version has a checksum check, an example of a packet header: <br><br><pre><code class="html hljs xml">2 Bytes  - This is the Version of the protocol = 03 00 (Major, Minor) 
2 Bytes  - This is the Function code.  The ones I know are listed below. 
2 Bytes  - First Sequence Code    \ These are usually the same 
2 Bytes  - Second Sequence Code   / 
4 Bytes  - This is the user ID of the client user 
4 Bytes  - These four bytes are ICQ's weak attempt at security: 
           to get these do the following: 
    check1 = ( data[8] <span class="hljs-tag"><span class="hljs-tag">&lt;&lt; </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">24</span></span></span><span class="hljs-tag">) | ( </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">4</span></span></span><span class="hljs-tag">] &lt;&lt; </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">16</span></span></span><span class="hljs-tag"> ) | ( </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span><span class="hljs-tag">] &lt;&lt; </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">8</span></span></span><span class="hljs-tag"> ) | ( </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">6</span></span></span><span class="hljs-tag">] ); 
    </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">offs1</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">Random</span></span></span><span class="hljs-tag"> % </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">length</span></span></span><span class="hljs-tag">;  // </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">offset</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">into</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">packet</span></span></span><span class="hljs-tag"> 
    </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">offs2</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">Random</span></span></span><span class="hljs-tag"> % </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">256</span></span></span><span class="hljs-tag">;     // </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">offset</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">into</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">magic</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span><span class="hljs-tag"> 
    </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">check2</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">(</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">offs1</span></span></span><span class="hljs-tag"> &lt;&lt; </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">24</span></span></span><span class="hljs-tag"> ) | !( </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">offs1</span></span></span><span class="hljs-tag">] &lt;&lt; </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">16</span></span></span><span class="hljs-tag"> ) | ( </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">offs2</span></span></span><span class="hljs-tag"> &lt;&lt; </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">8</span></span></span><span class="hljs-tag">) | !( </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">magic</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">offs2</span></span></span><span class="hljs-tag">] ); 
    </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">check</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">check1</span></span></span><span class="hljs-tag"> ^ </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">check2</span></span></span><span class="hljs-tag">;  // </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">XOR</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">the</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">two</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">checks</span></span></span></span></code></pre><br>
     :<br>
<br>
<pre><code class="html hljs xml">2 Bytes   - Version Number (not Encrypted) = 04 00 (Major, Minor) 
2 Bytes   - Random number (Not Encrypted) 
  ***** Everything from this point to the 1/4 mark is encrypted ***** 
2 Bytes   - Always 00 00 un-encrypted 
          - Since the key is xored to encrypt - whatever numbers are here 
            are the first 2 bytes of the encryption Key. 
2 Bytes   - Command Code. 
2 Bytes   - First Sequence Code 
2 Bytes   - Second Sequence Code 
4 Bytes   - User ID Number 
4 Bytes   - This is a Checksum. It is calculated the same as above 
          - The packet is encrypted by XORing 1/4 of the packet with a key 
          - The Key is calculated by multiplying the length * 0x66756B65 and 
            adding the check value.

                        1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3 
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |       4       |      0        |           RANDOM              | 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
        Everything below this point is encrypted 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |           ZEROS               |           COMMAND             | 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |          SEQUENCE             |         SECOND SEQUENCE       | 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |                              UIN                              | 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
   |                             CHECK                             | 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</code></pre> <br>
    ,     IP, TCP-,     .    -       .        UDP.<br>
<br>
     ,     ,  TCP- -. IP        .<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/738/f1f/3a2/738f1f3a28f540e7b0d645cb45a274d0.png"></div><br>
<br>
  ,   ICQ 2000b,   ,  .        ,  SMS   .              .<br>
<br>
<img src="https://habrastorage.org/files/0ad/71c/da5/0ad71cda522f4ce2b2049f991d3ed387.png"><br>
<br>
 2002  AOL  <a href="https://ru.wikipedia.org/wiki/OSCAR"> OSCAR</a>.           FLAP,     ,       .       ,    WIM.<br>
<br>
     2004     ICQ,   <a href="https://ru.wikipedia.org/wiki/Symbian_S60">Symbian S60</a>. ,  ,   1998   -  Palm OS.     ‚Äî   ‚Äî  ?<br>
<br>
<img src="https://habrastorage.org/files/f02/ce0/df0/f02ce0df0bea48d09961cd5022ad0e33.jpg"><br>
<br>
         .      ,        .    5.1         <a href="https://en.wikipedia.org/wiki/Global_IP_Solutions">Global IP Solutions</a>.<br>
<br>
<img src="https://habrastorage.org/files/14b/c33/90d/14bc3390db0040e9b550fc8b9a5b2edc.png"><br>
<br>
 2007   ICQ 6,     ¬´¬ª AOL' XML/CSS- <a href="http://boxely.blogspot.ru/">Boxely</a>. <br>
<br>
<img src="https://habrastorage.org/files/a3f/bc1/ed3/a3fbc1ed33834b869bce53226c6a057e.png"><br>
<br>
 2009   ICQ  Windows Mobile.     . <br>
<br>
<img src="https://habrastorage.org/files/6e1/aaf/be2/6e1aafbe259e47e081e6ba75cbf8dbec.png"><br>
<br>
C 2007  2010  ICQ   , AOL  .  2010     Mail.Ru Group,     2011  7- ,      Facebook, Twitter, Gmail, Youtube, Flickr   Mail.Ru.<br>
<br>
<img src="https://habrastorage.org/files/908/f8a/c24/908f8ac24d784c52ad0b95a31e5b4aab.png"><br>
<br>
      .    7.7        UIN,    . , ,   -   !             .              Facebook.<br>
<br>
  2012      . .<br>
<br>
  2012   ICQ 8,          .  ,   ICQ    ,   VoIP:        GIPS  WebRTC,     ,    .       ‚Äî   .       ,   .<br>
<br>
<img src="https://habrastorage.org/files/8f6/b36/4a6/8f6b364a69d64b39a9771b346bca137d.png"><br>
<br>
 2014      ICQ:       ,  ,      , <a href="https://github.com/mailru/icqdesktop">  </a>.       ICQ           .     <a href="https://ru.wikipedia.org/wiki/ZRTP">ZRTP</a>,         ICQ,    .<br>
<br>
<img src="https://habrastorage.org/files/e8b/908/3bc/e8b9083bc48e47bcaff77be5b4808eda.png"><br>
<br>
 2016 ‚Äî   ¬´¬ª.        ,             24   . ,    .<br>
<br>
  2016     ,        ,  ,   .  ,     ,      . <br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/c96/bad/c40/c96badc40a8b45acbb63ef363f18afc6.png"></div><br>
,   , ICQ   ,               .      API <a href="https://play.google.com/store/apps/details%3Fid%3Dio.vinci.android">  Vinci</a>.<br>
<br>
<img src="https://habrastorage.org/files/141/824/d9a/141824d9ae82406292e49d0aee185ef3.jpg"><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/6cb/a42/316/6cba423169184fa39c2e1b9e31612c52.jpg"></div><br>
       -       .                  .       <a href="http://www.visionlabs.ru/">VisionLabs</a>.<br>
<br>
<div class="spoiler"><b class="spoiler_title">gif</b><div class="spoiler_text"><img src="https://habrastorage.org/files/dbe/851/69d/dbe85169df594d1ab24c89172f4d2ee8.gif" alt="image"></div></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/027/ba8/741/027ba87418a64477bcc96734621bcfd7.jpg"></div><br>
,      ICQ:       ,     .          <a href="https://ru.wikipedia.org/wiki/Artisto"> Artisto</a>. <br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/9b1/71f/261/9b171f261afb46a3a368057177f8a15d.gif"></div><br>
  ,     ICQ :<br>
<br>
<ul>
<li>  :         ,   ;</li>
<li> :         ,     ;</li>
<li>      :     - ,        ,        ,    Siri.</li>
</ul><br>
       20         . ,    20     -  .</div><p>Source: <a href="https://habr.com/ru/post/315318/">https://habr.com/ru/post/315318/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../315306/index.html">Mobio Talks with Irina Shashkina, CEO of Lingualeo</a></li>
<li><a href="../315310/index.html">How cloud technologies change the world of sports</a></li>
<li><a href="../315312/index.html">Questions and answers about communication and technology in space. Part 1</a></li>
<li><a href="../315314/index.html">Questions and answers about communication and technology in space. Part 2</a></li>
<li><a href="../315316/index.html">‚ÄúMy Hyper Convergent Friend‚Äù: HPE New Boxed Solution</a></li>
<li><a href="../315320/index.html">How IT professionals work. Igor Sysoev - Founder and Service Station in Nginx</a></li>
<li><a href="../315324/index.html">Digital Transformation 2016</a></li>
<li><a href="../315326/index.html">In simple words: how machine learning works</a></li>
<li><a href="../315328/index.html">How to determine hot leads in 3 steps to make a sale and why 95% of companies do not know how</a></li>
<li><a href="../315330/index.html">Developer: Airbag</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>