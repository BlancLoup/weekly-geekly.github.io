<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Working with the clipboard in JavaScript using the asynchronous Clipboard API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There is a new javascript API designed to organize asynchronous access to the clipboard using the specification , which is still at the development st...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Working with the clipboard in JavaScript using the asynchronous Clipboard API</h1><div class="post__text post__text-html js-mediator-article">  There is a new javascript API designed to organize asynchronous access to the clipboard using the <a href="https://www.w3.org/TR/clipboard-apis/">specification</a> , which is still at the development stage.  So far in web development, the standard way to copy text to the clipboard is to use the <a href="https://alligator.io/js/copying-to-clipboard/">document.execCommand</a> method.  The main disadvantage of this approach is that it is a synchronous blocking operation.  The asynchronous API for working with the clipboard is based on <a href="https://alligator.io/js/promises-es6/">promises</a> ; one of its tasks is to eliminate this drawback.  It is designed to give web developers an easier-to-use, uniform API for working with the clipboard.  In addition, this API is designed with the ability to support multiple data types, not just text / plain. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/258/db1/199/258db11999a2f858d94ea88980acb4b9.jpg"></div><br>  It should be noted that now the new API is available only in Chrome 66+ and only supports copying and pasting plain text.  In addition, it only works when the page is loaded over HTTPS or from localhost, and only when the page is open in the current active browser tab. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Write data to the clipboard</font> </h2><br>  Writing data to the clipboard is a simple operation implemented by calling the <code>writeText</code> object's <code>writeText</code> method with passing it the corresponding text. <br><br><pre> <code class="hljs coffeescript">navigator.clipboard.writeText(<span class="hljs-string"><span class="hljs-string">'Hello Alligator!'</span></span>) .<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {   <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ! }) .<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(err =&gt; {   <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Something went wrong'</span></span>, err); });</code> </pre> <br><h2>  <font color="#3AC1EF">Reading data from the clipboard</font> </h2><br>  In order to read data from the clipboard, use the <code>readText</code> method.  In order to increase security, in addition to the page that reads data from the clipboard, should be open in the active tab of the browser, the user must grant it additional permission.  The browser will automatically request this permission on the first call to <code>readText</code> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs pgsql">navigator.clipboard.readText() .<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>(<span class="hljs-type"><span class="hljs-type">text</span></span> =&gt; {   // `<span class="hljs-type"><span class="hljs-type">text</span></span>`  ,     }) .catch(err =&gt; {   // ,             console.log(<span class="hljs-string"><span class="hljs-string">'Something went wrong'</span></span>, err); });</code> </pre> <br><h2>  <font color="#3AC1EF">Practical example</font> </h2><br>  Let us analyze a simple example of interaction with the clipboard from JavaScript.  It will only work in supported browsers.  If you want, you can customize it yourself by adding mechanisms that allow it to function in browsers that do not yet support the Clipboard API.  You can see how it all works on the <a href="https://alligator.io/js/async-clipboard-api/">page of the</a> original article, in the section Simple Demo. <br><br>  Consider the HTML markup. <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"to-copy"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Type something..."</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">aria-label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Type something"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"write-btn"</span></span></span><span class="hljs-tag">&gt;</span></span>Copy to clipboard<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"clipboard-results"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"read-btn"</span></span></span><span class="hljs-tag">&gt;</span></span>Paste from clipboard<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  And here is the JS code that is responsible for working with the clipboard. <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> readBtn = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'.read-btn'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> writeBtn = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'.write-btn'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> resultsEl = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'.clipboard-results'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> inputEl = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'.to-copy'</span></span>); readBtn.addEventListener(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, () =&gt; { navigator.clipboard.readText()   .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">text</span></span></span><span class="hljs-function"> =&gt;</span></span> {     resultsEl.innerText = text;   })   .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function"> =&gt;</span></span> {     <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Something went wrong'</span></span>, err);   }) }); writeBtn.addEventListener(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> inputValue = inputEl.value.trim(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inputValue) {   navigator.clipboard.writeText(inputValue)     .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {       inputEl.value = <span class="hljs-string"><span class="hljs-string">''</span></span>;       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (writeBtn.innerText !== <span class="hljs-string"><span class="hljs-string">'Copied!'</span></span>) {         <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> originalText = writeBtn.innerText;         writeBtn.innerText = <span class="hljs-string"><span class="hljs-string">'Copied!'</span></span>;         setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {           writeBtn.innerText = originalText;         }, <span class="hljs-number"><span class="hljs-number">1500</span></span>);       }     })     .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class="hljs-function"> =&gt;</span></span> {       <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Something went wrong'</span></span>, err);     }) } });</code> </pre> <br>  As you can see, everything here is very simple.  The only place that we had to work on was the code for working with the copy button, where we first check what we have to copy, and then briefly change the text of the button and clear the input field after successfully completing the copy operation. <br><br><h2>  <font color="#3AC1EF">Future Clipboard API</font> </h2><br>  This API describes the more general <code>write</code> and <code>read</code> methods that allow you to work with data that is different from plain text, in particular, with images.  For example, using the <code>read</code> method might look like this: <br><br><pre> <code class="hljs javascript">navigator.clipboard.read().then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ items }</span></span></span><span class="hljs-function">) =&gt;</span></span> { items.forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> {   <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(item.type);   <span class="hljs-comment"><span class="hljs-comment">//  -    }); });</span></span></code> </pre> <br>  Please note that these methods are not yet supported by any of the existing browsers. <br><br><h2>  <font color="#3AC1EF">Check browser capabilities</font> </h2><br>  Suppose you have created a web project, some of the functions of which rely on opportunities for working with the clipboard.  Considering that the Clipboard API currently supports only one browser, in such a project, it would be useful to provide alternative ways to work with the clipboard.  For example, a method based on <code>execCommand</code> .  In order to understand whether the browser supports what we need, you can simply check for the presence of the <code>clipboard</code> object in the global <code>navigator</code> object: <br><br><pre> <code class="hljs ruby"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (navigator.clipboard) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  ,    . } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  .   execCommand     . }</code> </pre> <br><h2>  <font color="#3AC1EF">Results</font> </h2><br>  We believe that a unified mechanism for working with the clipboard is a useful feature, the support of which will appear in all major browsers in the foreseeable future.  If this topic is interesting to you - take a look at <a href="https://developers.google.com/web/updates/2018/03/clipboardapi">this material by</a> Jason Miller. <br><br>  <b>Dear readers!</b>  What are the most promising options for using the Clipboard API? <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div><p>Source: <a href="https://habr.com/ru/post/358494/">https://habr.com/ru/post/358494/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../358484/index.html">Roskomnadzor unlocks Alibaba's IP address pool</a></li>
<li><a href="../358486/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ314 (May 7 - 13, 2018)</a></li>
<li><a href="../358488/index.html">How to connect via RDP with Windows, Ubuntu or Debian (Linux), Mac OS, as well as from a phone on Android and iPhone</a></li>
<li><a href="../358490/index.html">PHP Digest 130 (May 1 - 13, 2018)</a></li>
<li><a href="../358492/index.html">Stablecoins: a quick guide</a></li>
<li><a href="../358496/index.html">Applying trigonometry rules to create high-quality animation.</a></li>
<li><a href="../358500/index.html">SPLUNK VS ELK?</a></li>
<li><a href="../358502/index.html">noBackend, or How to survive the era of fat clients</a></li>
<li><a href="../358504/index.html">How to deploy Adaptavist ScriptRunner artifacts</a></li>
<li><a href="../358506/index.html">AI, practical course. Project planning</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>