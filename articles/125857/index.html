<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Create an html5 mini-walker on CraftyJS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I want to tell how to make my first mini-game on html5 without much difficulty (to be more precise: js, html5, css). 

 The essence of the game will b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Create an html5 mini-walker on CraftyJS</h1><div class="post__text post__text-html js-mediator-article">  I want to tell how to make my first mini-game on html5 without much difficulty (to be more precise: js, html5, css). <br><br>  The essence of the game will be as follows: a man walks across the field, between the stones and collects flowers, each flower has 1 guard.  The number of colors with each level increases, maps are created in random order. <br><br>  It all looks like this: <br><img src="https://habrastorage.org/storage1/9338e00f/7086a7e8/739f12e1/3e264b16.png"><br><a name="habracut"></a><br><h3>  Frame preparation </h3>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, for our task, I will use the js <a href="http://craftyjs.com/">craftyjs</a> library.  Since in order to draw sprites on my own, my hands do not grow from there, I will borrow sprites from the example on the website, we will do everything else from scratch, and we will supplement the sprite with enemies in red caps and T-shirts: <br><br><img src="https://habrastorage.org/storage1/5ef8d070/a116efa4/945f5d22/a8c6e656.png"><br><br>  Now it's time to make an application framework, for me it looks like this: <br><br><img src="https://habrastorage.org/storage1/14c9728c/41bc4372/752b8613/382b6ef5.png"><br><br>  Also, let's create it right away: <br><br>  /index.html <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;!</font> <font color="#800000">DOCTYPE</font> <font color="#ff0000">html</font> <font color="#ff0000">PUBLIC</font> <font color="#0000ff">"-//W3C//DTD XHTML 1.0 Strict//EN"</font> <br> <font color="#0000ff">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">html</font> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://www.w3.org/1999/xhtml"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">head</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">script</font> <font color="#ff0000">type</font> <font color="#0000ff">="text/javascript"</font> <font color="#ff0000">src</font> <font color="#0000ff">="js/jquery.js"</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> <br> &lt;script type= <font color="#A31515">"text/javascript"</font> src= <font color="#A31515">"js/crafty.js"</font> &gt;&lt;/script&gt; <br> &lt;!-- objects --&gt; <br> &lt;script type= <font color="#A31515">"text/javascript"</font> src= <font color="#A31515">"js/objects/flower.js"</font> &gt;&lt;/script&gt; <br> &lt;script type= <font color="#A31515">"text/javascript"</font> src= <font color="#A31515">"js/objects/bush.js"</font> &gt;&lt;/script&gt; <br> &lt;script type= <font color="#A31515">"text/javascript"</font> src= <font color="#A31515">"js/objects/grass.js"</font> &gt;&lt;/script&gt; <br> &lt;script type= <font color="#A31515">"text/javascript"</font> src= <font color="#A31515">"js/objects/unit.js"</font> &gt;&lt;/script&gt; <br> &lt;script type= <font color="#A31515">"text/javascript"</font> src= <font color="#A31515">"js/objects/player.js"</font> &gt;&lt;/script&gt; <br> &lt;script type= <font color="#A31515">"text/javascript"</font> src= <font color="#A31515">"js/objects/fourway_ai.js"</font> &gt;&lt;/script&gt; <br> &lt;script type= <font color="#A31515">"text/javascript"</font> src= <font color="#A31515">"js/objects/monster.js"</font> &gt;&lt;/script&gt; <br> &lt;!-- scenes --&gt; <br> &lt;script type= <font color="#A31515">"text/javascript"</font> src= <font color="#A31515">"js/scenes/loading.js"</font> &gt;&lt;/script&gt; <br> &lt;script type= <font color="#A31515">"text/javascript"</font> src= <font color="#A31515">"js/scenes/main.js"</font> &gt;&lt;/script&gt; <br> &lt;script type= <font color="#A31515">"text/javascript"</font> src= <font color="#A31515">"js/scenes/win.js"</font> &gt;&lt;/script&gt; <br> &lt;script type= <font color="#A31515">"text/javascript"</font> src= <font color="#A31515">"js/scenes/lose.js"</font> &gt;&lt;/script&gt; <br> <br> &lt;script type= <font color="#A31515">"text/javascript"</font> src= <font color="#A31515">"js/game.js"</font> &gt; <font color="#0000ff">&lt;/</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">link</font> <font color="#ff0000">rel</font> <font color="#0000ff">="stylesheet"</font> <font color="#ff0000">href</font> <font color="#0000ff">="css/game.css"</font> <font color="#ff0000">type</font> <font color="#0000ff">="text/css"</font> <font color="#ff0000">media</font> <font color="#0000ff">="screen"</font> <font color="#ff0000">charset</font> <font color="#0000ff">="utf-8"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">title</font> <font color="#0000ff">&gt;</font> Simpe RPG <font color="#0000ff">&lt;/</font> <font color="#800000">title</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">head</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">body</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">body</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">html</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  /css/game.css <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">body, html { margin:0; padding: 0; overflow:hidden; font-family:Arial; font-size:20px } <br> #cr-stage { border:2px solid black; margin:5px auto; color:white }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  /js/game.js <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">var Settings = { <br> width: 400, //    <br> height: 320, //  <br> poligon: 16, //   16x16 <br> level: 1, //   <br> flower_count: 0 //    <br> }; <br> <br> window.onload = function() { <br> Crafty.init(Settings.width, Settings.height); //    <br> <br> //  sprite <br> Crafty.sprite(Settings.poligon, "images/sprite.png", { <br> grass1: [0,0], <br> grass2: [1,0], <br> grass3: [2,0], <br> grass4: [3,0], <br> flower: [0,1], <br> bush1: [0,2], <br> bush2: [1,2], <br> player: [0,3], <br> monster: [0,4] <br> }); <br> <br> //    <br> Crafty.scene("loading"); <br> }; <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  In the last file, we create a canvas with a given width and height, create sprites from our file and run the first ‚Äúloading‚Äù scene. <br><br><h3>  Creating scenes </h3><br><br>  Let's do our loading scene: <br><br>  /js/scenes/loading.jd <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Crafty.scene("loading", function() { <br> Crafty.load(["images/sprite.png"], function() { <br> //   ,    images/sprite.png   <br> setTimeout(function() { <br> Crafty.scene("main"); <br> }, 100); <br> }); <br> <br> //    <br> Crafty.background("#000"); <br> //     <br> Crafty.e("2D, DOM, Text").attr({w: 100, h: 20, x: 150, y: 120}) <br> .text("Loading... <font color="#0000ff">&lt;</font> <font color="#800000">br</font> <font color="#0000ff">/&gt;</font> Level: " + Settings.level) <br> .css({"text-align": "center"}); <br> });</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Here we simply load sprite, make a black background and display text on the background.  By the way we brought the text, we will return, but for now let's immediately make 2 more similar scenes for winning and losing. <br><br>  /js/scenes/win.js <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Crafty.scene("win", function() { <br> Settings.level += 1; <br> <br> Crafty.background("#000"); <br> Crafty.e("2D, DOM, Text").attr({w: 100, h: 20, x: 150, y: 120}) <br> .text("You win! <font color="#0000ff">&lt;</font> <font color="#800000">br</font> <font color="#0000ff">/&gt;</font> Level: " + Settings.level) <br> .css({"text-align": "center"}); <br> <br> setTimeout(function() { <br> Crafty.scene("main"); <br> }, 1000); <br> });</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  /js/scenes/lose.js <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Crafty.scene("lose", function() { <br> Settings.level = 1; <br> <br> Crafty.background("#000"); <br> Crafty.e("2D, DOM, Text").attr({w: 100, h: 20, x: 150, y: 120}) <br> .text("You lose! <font color="#0000ff">&lt;</font> <font color="#800000">br</font> <font color="#0000ff">/&gt;</font> Level: " + Settings.level) <br> .css({"text-align": "center"}); <br> <br> setTimeout(function() { <br> Crafty.scene("main"); <br> }, 1000); <br> });</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Let's leave the main stage for a while and move on to the objects. <br><br><h3>  Creating components </h3><br><br>  Craftyjs has 2 basic types, the components Crafty.c and the entities Crafty.e.  Entities accumulate in themselves the properties of components.  In our game there will be 6 entities: a flower, a stone, a grass (background), a unit (base class of a little man), a player and a monster.  For each entity, we will create our own component. <br><br>  Let's start with the simplest grass: <br><br>  /js/objects/grass.js <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Crafty.c('Grass', { <br> init: function() { <br> this.requires("2D"); <br> this.requires("Canvas"); <br> this.requires("grass"+Crafty.randRange(1,2)); <br> <br> this.attr({x: 0, y: 0}); <br> } <br> });</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Notice that here we connected the Canvas component, and in the scenes, we connected the DOM component to the text, this gives us different behavior of objects, for example, in the text of the scenes we have the opportunity to use the css method.  Just here we connected our sprite, choosing in random order which of the 2 grass drawings we use.  Now, just make a component for the stone: <br><br>  /js/objects/bush.js <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Crafty.c('Bush', { <br> init: function() { <br> this.requires("2D"); <br> this.requires("Canvas"); <br> this.requires("bush"+Crafty.randRange(1,2)); <br> this.requires("hard_bush"); <br> <br> this.attr({x: 0, y: 0, z: 2}); <br> } <br> });</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Everything is the same here, just pay attention to hard_bush, it will come in handy soon.  We turn to the flowers, they will develop in our wind: <br><br>  /js/objects/flower.js <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Crafty.c('Flower', { <br> init: function() { <br> this.requires("2D"); <br> this.requires("Canvas"); <br> this.requires("flower"); <br> this.requires("SpriteAnimation"); <br> <br> this.attr({x: 0, y: 0}); <br> this.animate("wind", 0, 1, 3); <br> <br> this.bind("EnterFrame", function() { <br> if(!this.isPlaying()) <br> this.animate("wind", 80); <br> }); <br> }, <br> <br> clear: function() { <br> this.removeComponent('flower'); <br> this._visible = false; <br> } <br> });</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  To create an animation, we include the SpriteAnimation component, which gives us methods: <br><br>  public this .animate (String id, Number fromX, Number y, Number toX) - animation on sprite <br>  public Boolean .isPlaying ([String reel]) - check if animation is playing <br><br>  Next to the EnterFrame event, we create the wind.  Also in this component there is a clear module, which removes a flower if we have collected it. <br><br>  It's time to go to create a unit, I will describe everything in the comments: <br><br>  /js/objects/unit.js <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Crafty.c('Unit', { <br> init: function() { <br> this.requires("2D"); <br> this.requires("Canvas"); <br> this.requires("SpriteAnimation"); <br> this.requires("Collision"); //   <br> <br> this.attr({x: 0, y: 0, z: 1}); <br> <br> this.collision(); //    <br> <br> //      <br> <br> this.onHit("hard_bush", function(e) { <br> var object = e[0].obj; <br> // left <br> if (object.x <font color="#0000ff">&gt;</font> this.x &amp;&amp; (this.x + Settings.poligon) <font color="#0000ff">&gt;</font> object.x) { <br> this.x -= this._speed; <br> this.stop(); <br> } <br> // right <br> if (object.x <font color="#0000ff">&lt;</font> this.x &amp;&amp; this.x <font color="#0000ff">&lt;</font> (object.x + Settings.poligon)) { <br> this.x += this._speed; <br> this.stop(); <br> } <br> // top <br> if (object.y <font color="#0000ff">&lt;</font> this.y &amp;&amp; (this.y + Settings.poligon) <font color="#0000ff">&gt;</font> object.y) { <br> this.y += this._speed; <br> this.stop(); <br> } <br> // bottom <br> if (object.y <font color="#0000ff">&gt;</font> this.y &amp;&amp; this.y <font color="#0000ff">&lt;</font> (object.y + Settings.poligon)) { <br> this.y -= this._speed; <br> this.stop(); <br> } <br> }); <br> <br> //  ,    sprite <br> //     <br> <br> this.bind("Moved", function(e) { <br> if(this.x <font color="#0000ff">&lt;</font> ex) { <br> if(!this.isPlaying("walk_left")) <br> this.stop().animate("walk_left", 10); <br> } <br> if(this.x <font color="#0000ff">&gt;</font> ex) { <br> if(!this.isPlaying("walk_right")) <br> this.stop().animate("walk_right", 10); <br> } <br> if(this.y <font color="#0000ff">&lt;</font> ey) { <br> if(!this.isPlaying("walk_up")) <br> this.stop().animate("walk_up", 10); <br> } <br> if(this.y <font color="#0000ff">&gt;</font> ey) { <br> if(!this.isPlaying("walk_down")) <br> this.stop().animate("walk_down", 10); <br> } <br> }); <br> } <br> });</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Here, all the magic lies in the Collision component, which allows us to set collision boundaries, and work out various events. The Moved event is also processed in this component. . <br><br>  Create a player: <br><br>  /js/objects/player.js <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Crafty.c('Player', { <br> init: function() { <br> this.requires("Unit"); //   unit <br> this.requires("player"); //  sprite  <br> this.requires("Fourway"); //    <br> <br> this.attr({x: 0, y: 0, z: 1}); <br> <br> this.animate("walk_left", 6, 3, 8); <br> this.animate("walk_right", 9, 3, 11); <br> this.animate("walk_up", 3, 3, 5); <br> this.animate("walk_down", 0, 3, 2); <br> <br> this.fourway(1); <br> <br> this.onHit("flower", function(e) { <br> var object = e[0].obj; <br> object.clear(); <br> if ((Settings.flower_count -= 1) == 0) Crafty.scene("win"); <br> }); <br> <br> this.onHit("monster", function(e) { <br> var object = e[0].obj; <br> object.clear(); <br> Crafty.scene("lose"); <br> }); <br> } <br> });</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Connect the previously created component Unit, sprite player and motion component Fourway.  Fourway is a component that changes the position of our sprite depending on the pressed arrow on the keyboard, while creating it takes the parameter of the speed of movement.  Then, using the same collision component, we catch 2 events, a collision with a flower (then we collect it) and a collision with a monster (then we die). <br><br>  It's time to create a monster: <br><br>  /js/objects/monster.js <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Crafty.c('Monster', { <br> init: function() { <br> this.requires("Unit"); <br> this.requires("monster"); <br> this.requires("FourwayAI"); <br> <br> this.attr({x: 0, y: 0, z: 1}); <br> <br> this.animate("walk_left", 6, 4, 8); <br> this.animate("walk_right", 9, 4, 11); <br> this.animate("walk_up", 3, 4, 5); <br> this.animate("walk_down", 0, 4, 2); <br> <br> this.fourway_ai(1); <br> }, <br> <br> clear: function() { <br> clearInterval(this.removeComponent('monster')._interval); <br> } <br> });</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Pay attention to the FourwayAI component, there is no such component, we will need to create it.  This component will be responsible for the independent movement of the monster: <br><br>  /js/objects/fourwai_ai.js <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Crafty.c('FourwayAI', { <br> _speed: 3, <br> _interval: null, <br> <br> init: function() { <br> this._movement= { x: 0, y: 0}; <br> <br> this.bind("EnterFrame",function() { <br> if (this.disableControls) return; <br> <br> if(this._movement.x !== 0) { <br> this.x += this._movement.x; <br> this.trigger('Moved', {x: this.x - this._movement.x, y: this.y}); <br> } <br> if(this._movement.y !== 0) { <br> this.y += this._movement.y; <br> this.trigger('Moved', {x: this.x, y: this.y - this._movement.y}); <br> } <br> }); <br> }, <br> <br> fourway_ai: function(speed) { <br> this._speed = speed; <br> <br> this.make_step(); <br> <br> var kclass = this; <br> this._interval = setInterval(function() { <br> kclass.make_step(); <br> }, 1000 * this._speed); <br> }, <br> <br> make_step: function() { <br> step = Crafty.randRange(-1,1); <br> <br> if (Crafty.randRange(1,2) == 1) { <br> this._movement.x = step; <br> this._movement.y = 0; <br> } else { <br> this._movement.x = 0; <br> this._movement.y = step; <br> } <br> <br> this.trigger('NewDirection', this._movement); <br> } <br> });</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  this.trigger - as it is not difficult to guess, it creates an event that we later catch for animation. <br><br>  Now we have to create the last main scene, which will generate our entire map and place on it the player, monsters, stones and flowers. <br><br><h3>  Again creating scenes </h3><br><br>  /js/scenes/main.js <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">Crafty.scene("main", function() { <br> var flower_count = Settings.level + 1; <br> Settings.flower_count = 0; <br> <br> //generate the grass along the x-axis <br> for(var i = 0; i <font color="#0000ff">&lt;</font> 25; i++) { <br> //generate the grass along the y-axis <br> for(var j = 0; j <font color="#0000ff">&lt;</font> 20; j++) { <br> Crafty.e("Grass").attr({x: i * Settings.poligon, y: j * Settings.poligon}); <br> if (i * Settings.poligon == 160 &amp;&amp; j * Settings.poligon == 144) continue; <br> <br> if(i <font color="#0000ff">&gt;</font> 0 &amp;&amp; i <font color="#0000ff">&lt;</font> 24 &amp;&amp; j <font color="#0000ff">&gt;</font> 0 &amp;&amp; j <font color="#0000ff">&lt;</font> 19 &amp;&amp; Crafty.randRange(0, 50) <font color="#0000ff">&gt;</font> 40) { <br> if (Crafty.randRange(1,10) == 1 &amp;&amp; (flower_count -= 1) <font color="#0000ff">&gt;</font> 0) { <br> Crafty.e("Flower").attr({x: i * Settings.poligon, y: j * Settings.poligon}); <br> Settings.flower_count += 1 <br> // one monster for one flower <br> Crafty.e("Monster").attr({x: i * Settings.poligon, y: j * Settings.poligon}); <br> } else { <br> Crafty.e("Bush").attr({x: i * Settings.poligon, y: j * Settings.poligon}); <br> } <br> } <br> } <br> } <br> <br> //create the bushes along the x-axis which will form the boundaries <br> for(var i = 0; i <font color="#0000ff">&lt;</font> 25; i++) { <br> Crafty.e("Bush").attr({x: i * Settings.poligon, y: 0}); <br> Crafty.e("Bush").attr({x: i * Settings.poligon, y: 304}); <br> } <br> <br> //create the bushes along the y-axis <br> //we need to start one more and one less to not overlap the previous bushes <br> for(var i = 1; i <font color="#0000ff">&lt;</font> 19; i++) { <br> Crafty.e("Bush").attr({x: 0, y: i * Settings.poligon}); <br> Crafty.e("Bush").attr({x: 384, y: i * Settings.poligon}); <br> } <br> <br> Crafty.e("Player").attr({x: 160, y: 144, z: 1}); <br> });</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Here we finally create entities for our components, draw a wall of stones around the perimeter, fill the background with grass, and inside for each 16x16 square we create an emptiness, a stone or a flower + an enemy.  At the end we place our player. <br><br>  That's all, we made a simple, endless game - hdml5 walker.  Source code is available on <a href="https://github.com/arion/simplerpg">github</a> .  Checked only in chrome and firefox under mac os. <br><br>  If anyone tells a steady service where you can put a demo, I will be grateful. <br><br>  <b>UPD</b> : On the advice of <a href="https://habrahabr.ru/users/ridersx/" class="user_link">RiderSx</a> laid out a demo <a href="http://tlt-dessert.narod.ru/simplerpg/index.html">here</a> , I hope it will survive. </div><p>Source: <a href="https://habr.com/ru/post/125857/">https://habr.com/ru/post/125857/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../125849/index.html">DefCon: 10-year-old girl told about 0-day vulnerabilities in games on iOS and Android platforms</a></li>
<li><a href="../125851/index.html">Flexible, very flexible forms ... at ABBYY FlexiLayout Studio</a></li>
<li><a href="../125852/index.html">Patent drama with the stars</a></li>
<li><a href="../125855/index.html">Digest Wanted.VC # 9</a></li>
<li><a href="../125856/index.html">Rosreestr put in the free access satellite images of the Russian Federation with a resolution of 50 cm</a></li>
<li><a href="../125858/index.html">Results of the second week of the Log Marathon</a></li>
<li><a href="../125861/index.html">PS3 Wireless Controller Overview</a></li>
<li><a href="../125862/index.html">What web designers can learn from video games</a></li>
<li><a href="../125865/index.html">Intel software conference in Russia</a></li>
<li><a href="../125869/index.html">Continuous monitoring of radiation background in Moscow</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>