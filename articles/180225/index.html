<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Investigation of Targeted Attacks in South Asia</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this post we want to present our investigation of the targeted attack, which was used to steal confidential information from various organizations ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Investigation of Targeted Attacks in South Asia</h1><div class="post__text post__text-html js-mediator-article">  In this post we want to present our investigation of the targeted attack, which was used to steal confidential information from various organizations around the world.  During this investigation, it was discovered that the traces of this attack go to India, and Pakistan is the most affected country.  In addition, the actions of intruders have been active for at least the past two years.  A distinctive feature of the attack was the use of a valid digital certificate, which was used to sign malicious executables.  We also discovered an exploit that was used by attackers to install malicious code into the system. <br><br><a name="habracut"></a><img src="https://habrastorage.org/storage2/38d/575/f71/38d575f71e076f5c9a1fe024fbb7411e.jpg"><br><br>  As part of this campaign, a valid digital certificate was used, which signed malicious executables.  This was done to provide greater secrecy and create an image of the legitimacy of the installed malicious code.  The certificate was issued at the end of July 2011 for the Indian company Technical and Commercial Consulting Pvt.  Ltd., based in New Delhi. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/708/2dc/223/7082dc223814dfbfa1dc601d7094fb44.png"><br><br>  We promptly contacted VeriSign and, according to the information provided by us, this certificate was promptly withdrawn.  In total, as a result of the investigation of this incident, more than 70 malicious files (!) Signed with this digital signature were detected.  Based on the timestamps of these files, we created a timeline that reflects the timeline of the signing of these files. <br><br><img src="https://habrastorage.org/storage2/16f/2ad/b65/16f2adb657e51b32f51c70cd055b3728.png"><br><br>  Based on the information collected by us, it is clear that the attackers most actively signed malicious files from March to June 2012. Then we see a slight decline in activity from June to August 2012. Further, there is a surge in the use of the certificate in August and September 2012 despite that he was already recalled. <br><br>  In addition to these signed files, during the investigation several normal executable files that were missing a signature were also found.  Some of these files were discovered by us in early 2011. <br><br>  <b>Droppers and initial attack vector</b> <br><br>  In one of the attack vectors for users, attackers exploited the popular vulnerability CVE-2012-0158.  This vulnerability was exploited through a specially crafted Microsoft Office file, as a result of which arbitrary code was executed in the OS.  We observed an RTF document that, when it was opened on a vulnerable system, executed a two-stage shell code.  This shellcode sent system information to the feds.comule.com domain, and also downloaded the malicious file from digitalapp.org. <br><br>  Another attack vector was to use executable files that were masked as Microsoft Word or PDF files.  These files were distributed via email.  As soon as the user launched the file, this malicious program downloaded and launched for execution additional malicious modules.  To disguise, the malicious code did display a Word document with a specific content to the user, and we saw several such documents on various topics. <br><br>  One of the documents found used the theme of the Indian armed forces.  In fact, we do not have specific information about which specific people or organizations these files were intended for.  However, based on our telemetry system, we assume that the targets were people and educational institutions in Pakistan. <br><br>  The screenshot below shows one of these PDF documents, the content of which, in fact, is a compilation from various sources.  This document was delivered through a self-extracting archive, which had the name ‚Äúpakistandefencetoindiantopmiltrysecreat.exe‚Äù. <br><br><img src="https://habrastorage.org/storage2/1da/c42/184/1dac4218487a17cbde473188fd1df618.png"><br><br><img src="https://habrastorage.org/storage2/afd/6af/204/afd6af20485baef623f6005a8c0a9613.png"><br><br>  The following screenshot shows a PDF document that was delivered via the executable file ‚Äúpakterrisiomforindian.exe‚Äù.  In this case, the content of the document is based on the text from the Asian Defense blog.  On this blog, gather news about the military theme of the Asian region.  The data of our telemetry system shows that this file was first discovered in August 2011 on computers in Pakistan. <br><br><img src="https://habrastorage.org/storage2/315/760/7a5/3157607a5a4eb85fcad416ca8f155303.png"><br><br>  <b>Payload</b> <br><br>  We found a sufficient number of payload types that were used in this attack.  For its installation, as in other cases, droppers were used.  Its main task is to send important data from an infected computer to an attacking remote server.  The following table contains families of executable files and their modules with a description of functions.  All these modules were used in the targeted attack. <br><br><img src="https://habrastorage.org/storage2/f09/d76/fe7/f09d76fe7f04334b59063f11d6080d81.png"><br><br>  The information stolen from the infected computer is sent to the attacker's server in unencrypted form.  Such a decision is really puzzling, since it compromises the length of time the malicious code has been on the computer, which, in turn, is an important factor for the targeted attack.  In this case, network traffic analysis allows you to detect malicious activity.  The screenshot below shows the part of the keylogger log file. <br><br><img src="https://habrastorage.org/storage2/f4b/3b9/697/f4b3b96977766a3750f499b98c0a493f.png"><br><br>  This log file is quite informative and displays the characters typed by the user, as well as information about the window in which they were typed and at what time.  Due to the fact that these files are sent to the server in an unencrypted form, the task of detecting malicious code on a computer is solved quite simply by analyzing the traffic on the network. <br><br>  It should be noted that this malicious code added items to the ‚ÄúStart‚Äù menu with a deceptive name for the user.  The screenshot below shows an example of such a menu item. <br><br><img src="https://habrastorage.org/storage2/1ab/613/217/1ab61321762c70d880bc508a7aa182af.png"><br><br>  The Trojan uses methods that allow its various components to ensure their survival after a reboot.  But at the same time, it can not be called invisible.  Since targeted attacks usually try to be imperceptible in the system for as long as possible, we were surprised by the lack of appropriate mechanisms for this threat. <br><br>  <b>C &amp; C structure</b> <br><br>  Most of the malicious files that we have analyzed contain embedded URLs that are used to download additional modules, as well as to send data from the infected system to the attacker's server.  Sometimes the URLs of the managers of the C &amp; C servers are stored in the body of the malicious code in an unencrypted form.  In other cases, a fairly basic encryption method is used using one-character rotation (ROT-1) operation as shown below. <br><br>  ‚ÄúGjmftbttpdjbuf / ofu‚Äù -&gt; ‚Äúfilesassociate.net‚Äù <br><br>  We found more than 20 domains that were used in this campaign.  Despite the fact that some of these domains are still marked as active, most of them are no longer translated to IP addresses.  For most of these domains, hosting was performed on <a href="">OVH</a> servers.  This web hosting has a negative reputation because it is often used in spam and malware distribution operations.  In a recent <a href="http://hostexploit.com/downloads/viewdownload/7/46.html">HOSTExploit</a> report <a href="http://hostexploit.com/downloads/viewdownload/7/46.html">,</a> he was ranked 5th in the ranking of 50 web hosts that serve malicious content (top 50). <br><br>  The names of many of these domains, in spelling, are very similar to the names of legitimate sites and companies.  This approach is a common tactic to hide the true goals of using domains that acted as command C &amp; C servers.  For example, domain names such as ‚Äúwearwellgarments.eu‚Äù and ‚Äúsecuina.com‚Äù were used, which are very similar to the legitimate websites ‚Äúwearwellgarments.com‚Äù and ‚Äúsecunia.com‚Äù, the latter belongs to the well-known security company <a href="http://secunia.com/">Secunia</a> . <br><br>  <b>The origin of the malicious files</b> <br><br>  Analysis of this campaign allowed us to determine the geographical origin of malicious files.  With the help of several key indicators, it was established that these files were collected in India.  Malicious files were digitally signed by an Indian company.  In addition, signature time stamps vary between 5:06 and 13:45 UTC, which corresponds to an 8 hour working day between 10:36 and 19:15 in India.  It is likely that the authors lived in this particular time zone. <br><br>  Several malicious files have detected strings related to Indian culture, and some scripts use a variable called <i>ramukaka</i> . <br><br><img src="https://habrastorage.org/storage2/e14/5cd/f93/e145cdf933419263f91bb035157e39b7.png"><br><br>  The combination of ‚ÄúRamu Kaka‚Äù is quite common in <a href="http://ru.wikipedia.org/wiki/%25D0%2591%25D0%25BE%25D0%25BB%25D0%25BB%25D0%25B8%25D0%25B2%25D1%2583%25D0%25B4">Bollywood</a> films and means attendants.  Since this variable is used in a function whose purpose is to ensure the persistence of the presence of malicious code in the system, this name is quite well combined with its real function. <br><br>  But the most compelling argument in favor of India, as the country of origin of the malicious files, is the data of our telemetry system.  We found that many variants of the Trojan program were recorded in the same region in a rather short period of time.  Each variant of malicious code had insignificant differences from each other. <br><br>  <b>Infection statistics</b> <br><br>  According to our telemetry system, it is clear that Pakistan was the region that suffered the most from the activities of this attack.  The following diagram shows the distribution of detections recorded for all malicious files that we associate with this campaign over the past two years. <br><br><img src="https://habrastorage.org/storage2/d87/00f/81b/d8700f81bd5c9824da0aaf27a6835722.png"><br><br>  In addition to this, we collected statistics based on the syncholy data.  For this, three domains were used, and we were able to obtain the geography of the spread of infected hosts based on the IP addresses that addressed our registered domains. <br><br><img src="https://habrastorage.org/storage2/c51/180/d67/c51180d673eef28a99efee16deaf39d9.png"><br><br>  Obviously, the statistics on the two diagrams are completely different.  In the case of statistics obtained through syncholy, Ukraine and Kazakhstan account for three-quarters of all IP addresses of hosts that we were able to fix.  Apparently with the help of syncholing, we managed to fix only some small part of the infected systems, while the statistics on the detections shows the picture more holistically. <br><br>  <b>Conclusion</b> <br><br>  In our analysis, we looked at a targeted attack and provided evidence that this attack targets various targets around the world.  Obviously, it has roots in India.  Despite the fact that malicious activity has been recorded in many countries around the world, Pakistan has the highest number of infections.  In fact, targeted attacks have long ceased to be rare, but in this case, a relatively small number of any tools and techniques can be noted that would allow the malicious code to provide itself with good secrecy in the system.  The attackers used simple obfuscation of strings in executable files, did not use encryption when transmitting traffic over the network, gave legitimacy to malware by embedding additional items in the Start menu, used existing publicly available tools to collect information about the infected system.  These methods tell us that the attackers reacted to this operation without a proper approach.  On the other hand, they may not have seen the need to use means of concealment, since the existing methods provided the proper minimum masking. <br><br>  After the publication of our analysis, Symantec also identified the regions most affected by this attack.  As in the case of our telemetry systems, Symantec confirmed that the compromised hosts are most in South Asia, namely Pakistan.  India is indicated as a potential country of origin for this attack. <br><br><img src="https://habrastorage.org/storage2/4bc/f68/35b/4bcf6835b1790bab2f57cb75fe2c7a26.png"><br>  [Symantec data] <br><br>  <b>Object Names</b> <br><br>  ESET detects the malicious objects used in this campaign under the following names. <br><br>  Win32 / Agent.NLD worm <br>  Win32 / Spy.Agent.NZD trojan <br>  Win32 / Spy.Agent.OBF trojan <br>  Win32 / Spy.Agent.OBV trojan <br>  Win32 / Spy.KeyLogger.NZL trojan <br>  Win32 / Spy.KeyLogger.NZN trojan <br>  Win32 / Spy.VB.NOF trojan <br>  Win32 / Spy.VB.NRP trojan <br>  Win32 / TrojanDownloader.Agent.RNT trojan <br>  Win32 / TrojanDownloader.Agent.RNV trojan <br>  Win32 / TrojanDownloader.Agent.RNW trojan <br>  Win32 / VB.NTC trojan <br>  Win32 / VB.NVM trojan <br>  Win32 / VB.NWB trojan <br>  Win32 / VB.QPK trojan <br>  Win32 / VB.QTV trojan <br>  Win32 / VB.QTY trojan <br>  Win32 / Spy.Agent.NVL trojan <br>  Win32 / Spy.Agent.OAZ trojan </div><p>Source: <a href="https://habr.com/ru/post/180225/">https://habr.com/ru/post/180225/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../180213/index.html">Sphinx documentation on GitHub Pages</a></li>
<li><a href="../180217/index.html">The experience of failed projects is also experience.</a></li>
<li><a href="../180219/index.html">Simple-Science - Simple Experiments (Digest # 23)</a></li>
<li><a href="../180221/index.html">Payment security. Part 1: PCI DSS Standard</a></li>
<li><a href="../180223/index.html">To whom is singularity, and to whom is archaization</a></li>
<li><a href="../180227/index.html">How to grow beans in Raspberry PI and take a TimeLapse video</a></li>
<li><a href="../180229/index.html">8 years after launch, 100 hours of video is uploaded to YouTube every minute.</a></li>
<li><a href="../180231/index.html">Video interview from Silicon Valley. Alex Debelov is a graduate of YCombinator, leader and co-founder of Virool, an online video promotion service.</a></li>
<li><a href="../180233/index.html">A former employee of Google confirmed the fact of fraud company with taxes in Britain</a></li>
<li><a href="../180235/index.html">Selection of court decisions. Such different domain disputes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>