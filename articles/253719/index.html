<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Remote control of your smartphone with Node.js and Socket.io</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It would be fun to use your smartphone as a remote control, wouldn‚Äôt it? In fact, it does not look very difficult. You do not even need to be able to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Remote control of your smartphone with Node.js and Socket.io</h1><div class="post__text post__text-html js-mediator-article">  It would be fun to use your smartphone as a remote control, wouldn‚Äôt it?  In fact, it does not look very difficult.  You do not even need to be able to write large applications, as there is a browser that supports opening sockets.  In this short tutorial, we will use Node.js and <a href="http://socket.io/">Socket.io</a> to manage the presentation running on the computer using the phone. <br><a name="habracut"></a><br>  There are many cool HTML5 libraries for creating presentations, but not one of them is provided for our idea.  In this regard, we will use <a href="https://github.com/hakimel/reveal.js/">Reveal.js</a> - the library will work with animation and will respond to pressing the keyboard or touching the screen of the smartphone. <br><br>  We will not develop a separate management interface.  Instead, let's synchronize the open presentation on both devices.  This will allow you not only to see the mobile version of the presentation, but also to understand which of the slides is currently active. <br><br><h5>  Idea </h5><br>  Our idea is simple - Reveal.js will transmit the current slide number via a URL in the form of a hash (for example, <b><a href="http://example.com/">example.com/#/1</a></b> ).  Then we will send this hash to all other connected devices, which will turn over presentations on them automatically.  In this regard, anyone will be able to spoil everything with the elementary opening of an arbitrary slide, which will lead to flipping on all devices.  In order to avoid this, we will set a password and will require its entry to connect. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It is useful to mention that Reveal.js already has an API, and we can use it for synchronization, but the technique of changing and sending the hash is simpler, so let's use it. <br><img src="https://habrastorage.org/files/288/d0c/233/288d0c23339e47c3832c4d8d36c18fb5.jpg"><br>  <i>Our presentation</i> <br><br><h5>  Run example </h5><br>  You can run the example on your computer or deploy it with a provider like Heroku.  The first option is simpler, but you need to install node.js and npm.  The second involves installing the heroku toolbelt and registering with the system. <br><h6>  To run locally: </h6><br><ol><li>  Download the archive with the code; </li><li>  Make sure that node.js is installed ;. </li><li>  Unzip the downloaded file; </li><li>  Open a terminal and go to the folder with the extracted files; </li><li> Run <code>npm install</code> to install the libraries; </li><li>  Run the application with the <code>node app.js</code> ; </li><li>  Open <a href="http://localhost:8080/">http: // localhost: 8080</a> and enter the password (‚Äú <b>kittens</b> ‚Äú by default); </li><li>  Open http: // &lt;local address of computer&gt; on the phone and enter the same phrase; </li><li>  Rejoice! </li></ol><br><h6>  To run in Heroku: </h6><br><ol><li>  Download the archive with the code; </li><li>  Unzip it; </li><li>  Open a terminal and go to the folder; </li><li>  Create a repository and first commit; </li><li>  Create an application in Heroku; </li><li>  Run <code>git push heroku master</code> ; </li><li>  Open the application at its address and enter the password ‚Äú <b>kittens</b> ‚Äù (default). </li></ol><br>  Read more about this process <a href="https://devcenter.heroku.com/articles/getting-started-with-nodejs">here</a> .  If you use another provider, the last steps may vary. <br><br><h5>  Code </h5><br>  Stop talking, let's take a look at the code!  We have only two JavaScript files - app.js for the back-end and script.js for the browser.  You can run the application in Node.js 0.10+ or ‚Äã‚Äãin io.js. <br><br>  In the server part we use <a href="http://expressjs.com/">express</a> and <a href="http://socket.io/">socket.io</a> .  His task is to listen for the socket.io event and send responses to them.  With <a href="http://expressjs.com/guide/using-middleware.html">express.static</a> we display files from public folders.  The <b>public / index.html</b> file contains the presentation itself.  It is processed automatically via express.static, so that the address does not need to specify ‚Äú/‚Äù. <br>  <b>app.js</b> <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// This is the server-side file of our mobile remote controller app. // It initializes socket.io and a new express instance. // Start it by running 'node app.js' from your terminal. // Creating an express server var express = require('express'), app = express(); // This is needed if the app is run on heroku and other cloud providers: var port = process.env.PORT || 8080; // Initialize a new socket.io object. It is bound to // the express app, which allows them to coexist. var io = require('socket.io').listen(app.listen(port)); // App Configuration // Make the files in the public folder available to the world app.use(express.static(__dirname + '/public')); // This is a secret key that prevents others from opening your presentation // and controlling it. Change it to something that only you know. var secret = 'kittens'; // Initialize a new socket.io application var presentation = io.on('connection', function (socket) { // A new client has come online. Check the secret key and // emit a "granted" or "denied" message. socket.on('load', function(data){ socket.emit('access', { access: (data.key === secret ? "granted" : "denied") }); }); // Clients send the 'slide-changed' message whenever they navigate to a new slide. socket.on('slide-changed', function(data){ // Check the secret key again if(data.key === secret) { // Tell all connected clients to navigate to the new slide presentation.emit('navigate', { hash: data.hash }); } }); }); console.log('Your presentation is running on http://localhost:' + port);</span></span></code> </pre><br>  And here is the JavaScript for the front-end, which listens for the <a href="https://developer.mozilla.org/en-US/docs/Web/Events/hashchange">hashchange</a> event and sends the message socket.io to the server. <br>  <b>public / assets / js / script.js</b> <br><pre> <code class="javascript hljs">$(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Apply a CSS filter with our blur class (see our assets/css/styles.css) var blurredElements = $('.homebanner, div.reveal').addClass('blur'); // Initialize the Reveal.js library with the default config options // See more here https://github.com/hakimel/reveal.js#configuration Reveal.initialize({ history: true // Every slide will change the URL }); // Connect to the socket var socket = io(); // Variable initialization var form = $('form.login'), secretTextBox = form.find('input[type=text]'); var key = "", animationTimeout; // When the page is loaded it asks you for a key and sends it to the server form.submit(function(e){ e.preventDefault(); key = secretTextBox.val().trim(); // If there is a key, send it to the server-side // through the socket.io channel with a 'load' event. if(key.length) { socket.emit('load', { key: key }); } }); // The server will either grant or deny access, depending on the secret key socket.on('access', function(data){ // Check if we have "granted" access. // If we do, we can continue with the presentation. if(data.access === "granted") { // Unblur everything blurredElements.removeClass('blurred'); form.hide(); var ignore = false; $(window).on('hashchange', function(){ // Notify other clients that we have navigated to a new slide // by sending the "slide-changed" message to socket.io if(ignore){ // You will learn more about "ignore" in a bit return; } var hash = window.location.hash; socket.emit('slide-changed', { hash: hash, key: key }); }); socket.on('navigate', function(data){ // Another device has changed its slide. Change it in this browser, too: window.location.hash = data.hash; // The "ignore" variable stops the hash change from // triggering our hashchange handler above and sending // us into a never-ending cycle. ignore = true; setInterval(function () { ignore = false; },100); }); } else { // Wrong secret key clearTimeout(animationTimeout); // Addding the "animation" class triggers the CSS keyframe // animation that shakes the text input. secretTextBox.addClass('denied animation'); animationTimeout = setTimeout(function(){ secretTextBox.removeClass('animation'); }, 1000); form.show(); } }); });</span></span></code> </pre><br><br><h4>  It's Slideshow Time! </h4><br>  Our remote in the form of a smartphone is ready!  I hope you find this useful and enjoy it. <br><br>  <b><a href="">Download code</a></b> <br>  <b><a href="http://tz-smartphone-remote-control.herokuapp.com/">Demo</a></b> </div><p>Source: <a href="https://habr.com/ru/post/253719/">https://habr.com/ru/post/253719/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../253705/index.html">HowTo: DMARC</a></li>
<li><a href="../253711/index.html">Writing the motion component for RTS in Unreal engine 4</a></li>
<li><a href="../253713/index.html">The digest of interesting materials for the mobile # 95 developer (March 16-22)</a></li>
<li><a href="../253715/index.html">Pros and cons of customized development without TZ</a></li>
<li><a href="../253717/index.html">MailChimp UX Team: Patterns and SVG Animation [Part 5 of the Book]</a></li>
<li><a href="../253721/index.html">So you need a form</a></li>
<li><a href="../253723/index.html">We print stories from Medium</a></li>
<li><a href="../253725/index.html">Antifraud. Fast, cheap ... great (part 1)</a></li>
<li><a href="../253727/index.html">Pwn2Own 2015: results</a></li>
<li><a href="../253729/index.html">Using Microsoft Active Accessibility technology to access browser content</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>