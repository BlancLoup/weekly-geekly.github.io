<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>OSX Terminal Server</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As it turned out, the server version of OSX does not contain such a useful function as terminal sessions (several remote connections with the GUI). On...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>OSX Terminal Server</h1><div class="post__text post__text-html js-mediator-article"><img src="http://l0st.ws/f/f5/vnc.png"><br><br>  As it turned out, the server version of OSX does not contain such a useful function as terminal sessions (several remote connections with the GUI).  On the other hand, several users can use the GUI simultaneously (via Fast User Switching).  Today I decided to pick it up and squeeze the maximum possible out of it. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A little theoretical part.  WindowServer is responsible for all graphical sessions in OSX - the main and only process that communicates with a video card, accepts requests for rendering and, in fact, draws a picture.  With some stretch, it looks like an X11 server. <br><br>  The main difference is that user sessions specifically hold several loginwindow processes.  The primary is started by the WindowServer (from the root user), performs authorization and lowers itself to the level of the corresponding user.  The active user (the one whose session is drawn on the physical monitor) gets the loginwindow with the ‚Äúconsole‚Äù flag.  As soon as he tries to switch to another user through Fast User Switching, WindowServer will take away from him the status of the console, create a new loginwindow, and everything will be repeated.  When switching users, WindowServer simply makes the loginwindow process necessary for the console. <br><br>  So, the first problem.  Fast User Switching works very loosely on VNC / RDC, often killing the GUI in general. <br><br><img src="http://l0st.ws/f/e9/bug.png"><br><br>  The bug <a href="http://openradar.appspot.com/radar%3Fid%3D136415">was sent</a> to Apple and closed as a duplicate.  The first workaround I found was <code>killall -9 WindowServer</code> , which guaranteedly solved the problem, at the same time killing <b>all</b> graphical sessions, which was absolutely unacceptable, but at least returned control over the GUI.  The second workshop - killing the console loginwindow session - turned out to be much more efficient.  Upon a subsequent restart, the bug suddenly disappeared (however, before the first use of Fast User Switching). <br><br>  Thus, it became possible to use the GUI on the server remotely by any number of users, but only by one user at a time.  Not bad, but not interesting.  Of course, this solved several problems, such as unit-testing iPhone applications (ibtool basically does not work without an active GUI session of the user, so you cannot compile xibs). <br><br>  Both VNC and RDC, implemented by Apple, work in the same way.  It became interesting, but what happens in those "background" loginwindow, which remain behind the scenes?  The answer to this question helped me give <a href="http://sourceforge.net/projects/osxvnc/">OSX VNC</a> , an independent VNC server for OSX.  I started two sessions from different users and raised a VNC server on each one.  As it turned out, WindowServer completely renders background sessions as well, so when you connect to a specific user with a VNC server, you can work in a GUI session <b>absolutely fully</b> . <br><br><img src="http://l0st.ws/f/e29/2vnc.png"><br><br>  Now in this potential barrel of honey, I mix the tar.  For the VNC server to work, the user must create a session on the loginwindow.  This can be done through the primary VNC / RDC server (and the restriction of rights to the Login Window), but the primary server allows you to control the current console session and, potentially, is a security issue.  The VNC server of users is ‚Äúhard‚Äù clogged by ports, you need to know your terminal number, and set passwords manually (and forget about the common authorization base in LDAP).  This scheme is not suitable for a large number of GUI-sessions and deployment in strict security conditions, but the tasks that I set for it, it solves 100%. <br><br>  Perhaps, I will find time and make an aggregator of VNC-servers so that there is one server-router, which by LDAP-authorization would allow access to the final VNC-servers of users.  But I hope that Apple implements support for terminal sessions earlier. </div><p>Source: <a href="https://habr.com/ru/post/80799/">https://habr.com/ru/post/80799/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../80793/index.html">Benchmark: AutoMapper vs BLToolkit vs EmitMapper</a></li>
<li><a href="../80794/index.html">Google‚Äôs Chinese employees have a day off</a></li>
<li><a href="../80796/index.html">Dojo control for timing</a></li>
<li><a href="../80797/index.html">browser statistics, firefox and group policies</a></li>
<li><a href="../80798/index.html">WordPress Photo Gallery or a little more messing around with NextGen</a></li>
<li><a href="../80800/index.html">The first programmer is Augusta Ada Lovelace</a></li>
<li><a href="../80801/index.html">FlatHunter - Home Search</a></li>
<li><a href="../80803/index.html">HP Compaq T5000 - Home Seedbox</a></li>
<li><a href="../80804/index.html">pytesser - Python OCR Library (Optical Character Recognition)</a></li>
<li><a href="../80805/index.html">The art of caring for your monkeys</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>