<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why IoC, DI and Kaiten :: Container Magic Pill are so rarely used in Perl</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I think many understand the significance of Inversion of Control (Ioc) and Dependency Injection (DI) buzzwords. If not very, but interesting - on Habr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why IoC, DI and Kaiten :: Container Magic Pill are so rarely used in Perl</h1><div class="post__text post__text-html js-mediator-article">  I think many understand the significance of Inversion of Control (Ioc) and Dependency Injection (DI) buzzwords.  If not very, but interesting - on Habr√© there were several articles on this topic, very informative and well stated. <br>  The techniques are excellent, but somehow they could not be applied in real life. <br><br>  Under the cut - a small overview of the deplorable state of affairs in Perl and the separatist "it seems" solution. <br><a name="habracut"></a><br>  So, why did not it go out to apply something in real code? <br>  In fact, everything is quite clear - the available modules that declare the implementation of DI are difficult to understand and fantastically difficult to use, and the code turns out to be less and more.  And very strange. <br><pre><code class="perl hljs">$c-&gt;add_service( Bread::Board::BlockInjection-&gt;new( <span class="hljs-string"><span class="hljs-string">name =&gt;</span></span> <span class="hljs-string"><span class="hljs-string">'authenticator'</span></span>, <span class="hljs-string"><span class="hljs-string">block =&gt;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">my</span></span> $service = <span class="hljs-keyword"><span class="hljs-keyword">shift</span></span>; Authenticator-&gt;new( <span class="hljs-string"><span class="hljs-string">db_conn =&gt;</span></span> $service-&gt;param(<span class="hljs-string"><span class="hljs-string">'db_conn'</span></span>), <span class="hljs-string"><span class="hljs-string">logger =&gt;</span></span> $service-&gt;param(<span class="hljs-string"><span class="hljs-string">'logger'</span></span>) ); }, <span class="hljs-string"><span class="hljs-string">dependencies =&gt;</span></span> { <span class="hljs-string"><span class="hljs-string">db_conn =&gt;</span></span> Bread::Board::Dependency-&gt;new( <span class="hljs-string"><span class="hljs-string">service_path =&gt;</span></span> <span class="hljs-string"><span class="hljs-string">'db_conn'</span></span> ), <span class="hljs-string"><span class="hljs-string">logger =&gt;</span></span> Bread::Board::Dependency-&gt;new( <span class="hljs-string"><span class="hljs-string">service_path =&gt;</span></span> <span class="hljs-string"><span class="hljs-string">'logger'</span></span> ), } ) );</code> </pre> <br>  An example of the Bread :: Board manual, which (manual) is spread over 4 pages! <br><br><pre> <code class="perl hljs">$c = IOC::Slinky::Container-&gt;new( <span class="hljs-string"><span class="hljs-string">config =&gt;</span></span> { <span class="hljs-string"><span class="hljs-string">container =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment"># constructor injection dbh =&gt; { _class =&gt; "DBI", _constructor =&gt; "connect", _constructor_args =&gt; [ "DBD:SQLite:dbname=/tmp/my.db", "user", "pass", { RaiseError =&gt; 1 }, ], }, # setter injection y2k =&gt; { _singleton =&gt; 0, _class =&gt; "DateTime", year =&gt; 2000, month =&gt; 1, day =&gt; 1, }, } } );</span></span></code> </pre><br>  An example of IOC :: Slinky :: Container is already better, but still the same, if you think about it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="perl hljs"><span class="hljs-keyword"><span class="hljs-keyword">my</span></span> $c = Peco::Container-&gt;new; $c-&gt;register(<span class="hljs-string"><span class="hljs-string">'log_mode'</span></span>, O_APPEND); $c-&gt;register(<span class="hljs-string"><span class="hljs-string">'log_file'</span></span>, <span class="hljs-string"><span class="hljs-string">'/var/log/my-app.log'</span></span>); $c-&gt;register(<span class="hljs-string"><span class="hljs-string">'log_fh'</span></span>, <span class="hljs-string"><span class="hljs-string">'IO::File'</span></span>, [<span class="hljs-string"><span class="hljs-string">'log_file'</span></span>, <span class="hljs-string"><span class="hljs-string">'log_mode'</span></span>]); $c-&gt;register(<span class="hljs-string"><span class="hljs-string">'my_logger'</span></span>, <span class="hljs-string"><span class="hljs-string">'My::Logger'</span></span>, [<span class="hljs-string"><span class="hljs-string">'log_fh'</span></span>]);</code> </pre><br>  Example Peco :: Container - positioned as a ‚ÄúLight Inversion of Control (IoC) container‚Äù.  Try to take the last line and follow what is happening in the reverse order.  Still understand what's going on? <br><br>  IMHO the problem is that these implementations are complex, overloaded with some features and as a result are non-smoking, inconvenient to use and can turn support into hell. <br><br>  All that is needed from DIc is the ability to put a piece of code there and later get the result of its execution.  Put the workpiece dbh - got a working handler at the output.  No magic, create code from the configuration file and other academic pieces. <br><br><pre> <code class="perl hljs"><span class="hljs-keyword"><span class="hljs-keyword">my</span></span> $kaiten_config = { <span class="hljs-string"><span class="hljs-string">examplep_config =&gt;</span></span> { <span class="hljs-string"><span class="hljs-string">handler =&gt;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span></span>{ { <span class="hljs-string"><span class="hljs-string">RaiseError =&gt;</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> } }, <span class="hljs-string"><span class="hljs-string">probe =&gt;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-number"><span class="hljs-number">1</span></span> }, <span class="hljs-string"><span class="hljs-string">settings =&gt;</span></span> { <span class="hljs-string"><span class="hljs-string">reusable =&gt;</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> }, }, <span class="hljs-string"><span class="hljs-string">ExampleP =&gt;</span></span> { <span class="hljs-string"><span class="hljs-string">handler =&gt;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">my</span></span> $c = <span class="hljs-keyword"><span class="hljs-keyword">shift</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">my</span></span> $conf = $c-&gt;get_by_name(<span class="hljs-string"><span class="hljs-string">'examplep_config'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> DBI-&gt;<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span>( <span class="hljs-string"><span class="hljs-string">"dbi:ExampleP:"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>, $conf ) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">die</span></span> $DBI::errstr; }, <span class="hljs-string"><span class="hljs-string">probe =&gt;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">sub</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">shift</span></span>-&gt;ping() }, <span class="hljs-string"><span class="hljs-string">settings =&gt;</span></span> { <span class="hljs-string"><span class="hljs-string">reusable =&gt;</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> } } }; <span class="hljs-keyword"><span class="hljs-keyword">my</span></span> $container = Kaiten::Container-&gt;new( <span class="hljs-string"><span class="hljs-string">init =&gt;</span></span> $kaiten_config ); <span class="hljs-keyword"><span class="hljs-keyword">my</span></span> $dbh = $container-&gt;get_by_name(<span class="hljs-string"><span class="hljs-string">'ExampleP'</span></span>);</code> </pre><br>  The Kaiten :: Container example is simple, clear and effective. <br><br>  Examples and documentation included, you can take on the <a href="http://search.cpan.org/perldoc%3FKaiten::Container">CPAN</a> and <a href="https://github.com/Meettya/Kaiten-Container">github</a> . <br><br>  Questions, thanks, curses and rays of hatred can be published here or in any other way convenient to you. <br><br>  Ps.  If the module does not wish to be put, telling something like <br><br><pre> <code class="hljs vhdl"># Failed test <span class="hljs-symbol"><span class="hljs-symbol">'use</span></span> Kaiten::Container;' # at t/<span class="hljs-number"><span class="hljs-number">00</span></span>-load.t <span class="hljs-literal"><span class="hljs-literal">line</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>. # Tried <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-symbol"><span class="hljs-symbol">'Kaiten</span></span>::Container'. # <span class="hljs-literal"><span class="hljs-literal">Error</span></span>: Argument <span class="hljs-string"><span class="hljs-string">"1.12_03"</span></span> isn<span class="hljs-symbol"><span class="hljs-symbol">'t</span></span> numeric <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> numeric gt (&gt;)...</code> </pre><br>  Join the thirsty patch Moo <a href="https://rt.cpan.org/Ticket/Display.html%3Fid%3D72931">here</a> . <br><br>  Pps.  And now in 3D!  Supports dependency resolution. </div><p>Source: <a href="https://habr.com/ru/post/134891/">https://habr.com/ru/post/134891/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../134884/index.html">Fast server side integration ASP.NET + Facebook</a></li>
<li><a href="../134885/index.html">Detective story about SQL injection, sometimes blind</a></li>
<li><a href="../134886/index.html">How to overcome traditional problems in the implementation of Agile</a></li>
<li><a href="../134888/index.html">MsBuild Minimal Project</a></li>
<li><a href="../134890/index.html">Electronic signature in the browser using OpenSSL and SKZI Rutoken EDS</a></li>
<li><a href="../134892/index.html">Networks for the smallest. Part zero. Planning</a></li>
<li><a href="../134894/index.html">Access to samba ball through ssh tunnel</a></li>
<li><a href="../134896/index.html">Reply to email notifications</a></li>
<li><a href="../134897/index.html">Scala is worse than Java. At least half of Java projects</a></li>
<li><a href="../134900/index.html">More details from the report Site loading speed in Google Analytics</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>