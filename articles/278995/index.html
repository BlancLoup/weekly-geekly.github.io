<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Calltracking in Minecraft or how to quickly make a three-dimensional UI</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A couple of months ago, I showed Minecraft to children, and a little later, I bought them a book on programming in MineCraft. True, the children bough...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Calltracking in Minecraft or how to quickly make a three-dimensional UI</h1><div class="post__text post__text-html js-mediator-article">  A couple of months ago, I showed Minecraft to children, and a little later, I bought them a <a href="https://habrahabr.ru/company/piter/blog/269757/">book</a> on programming in MineCraft.  True, the children bought ches-word.  Well, he took a look, well, wrote a couple of scripts ... <br><br>  At this point, the story would have stopped, but the other day I had the opportunity to participate in the hackathon of a single calltracking service.  For those who do not know, <a href="https://ru.wikipedia.org/wiki/Call_tracking">calltracking</a> is such a thing that provides call statistics.  And what is important for our history is that these statistics are available by API. <br><br>  At this moment, the separate parts formed into a whole picture and I thought - oh!  call statistics in Minecraft. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/154/cbf/4ff/154cbf4ffd0e4a118fa2a89c9ee3a40a.png"><br><br>  Well, the hackathon format has to insane ideas, but this idea seemed crazy enough to be realized. <br><br>  But seriously - who said that the interfaces should be two-dimensional? <br>  And who said that the three-dimensional interface is long and difficult? <br>  The whole idea took 3 hours (57 lines on the python), given that for the first half hour I understood how to parse the python parsons Jason. <br><br>  Under the cut - the whole story, the video with the result and the bonus for those who read it to the end - all 3 hours of development in a 3-minute time-lapse video. <br><a name="habracut"></a><br>  To make it all work, it took me 3 simple steps: <br><br>  1. We lift the Minecraft server which allows to interact with the world of Minecraft on API on Python <br>  2. We take call statistics by calltracking API <br>  3. Create cubes in Minecraft. <br><br>  Ok, let's go! <br><br><h3>  1. Minecraft server </h3><br>  The minecraft server with the beautiful name <a href="https://bukkit.org/">bukkit</a> was already ready for me (you can download it from <a href="http://eu.wiley.com/WileyCDA/Section/id-823690.html">the book‚Äôs website</a> along with very detailed video instructions). <br>  The game version is 1.6.4, we will write scripts in Python, since  this server understands them. <br><br><h3>  2. We take the statistics of calls by API </h3><br>  Here, too, everything is simple, a couple of lines on the python and everything is ready: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> json, requests data = requests.get(<span class="hljs-string"><span class="hljs-string">"https://istat24.com.ua/api/{your_api_key}/calls.json?counter_start_date=2016-02-01&amp;counter_end_date=2016-02-05"</span></span>) json = json.loads(data.content)</code> </pre> <br>  A few words about the API itself. <br><br>  I use the API calltracking service of <a href="http://istat24.com/">iStat24</a> (in the development department of which this same hackathon took place), it returns the call log to JSON, and to get the data for a specific account you need to generate API_key in this account, which I had prepared for the hackathon in advance. <br><br>  An example of a call from JSON: <br><br><pre> <code class="java hljs">{ call_id: <span class="hljs-number"><span class="hljs-number">5555555</span></span>, numberA: <span class="hljs-string"><span class="hljs-string">"380555555555"</span></span>, numberB: <span class="hljs-string"><span class="hljs-string">"380555555555"</span></span>, start: <span class="hljs-string"><span class="hljs-string">"2016-02-05 15:11:13"</span></span>, duration: <span class="hljs-string"><span class="hljs-string">"00:03:57"</span></span>, wait_duration: <span class="hljs-string"><span class="hljs-string">"00:00:07"</span></span>, speak_duration: <span class="hljs-string"><span class="hljs-string">"00:03:50"</span></span>, record: <span class="hljs-string"><span class="hljs-string">"http://url_to_the_audio_record.mp3"</span></span>, accepted: <span class="hljs-number"><span class="hljs-number">1</span></span>, direction: <span class="hljs-string"><span class="hljs-string">"incoming"</span></span>, reklama_name: <span class="hljs-string"><span class="hljs-string">"Google organic"</span></span>, reklama_id: <span class="hljs-number"><span class="hljs-number">729</span></span> }</code> </pre><br>  From all this we are interested in: <br>  <b>wait_duration</b> - call waiting time (beeps, in short) <br>  <b>speak_duration</b> - talk time <br>  <b>accepted</b> - the value 1/0 determines if the call was accepted or missed. <br><br>  Total, we have an array of calls.  Now it remains only to present them visually. <br><br><h3>  3. Create cubes in Minecraft </h3><br>  Before that, everything was simple, right?  not even easy - trivial. <br>  You probably think some magic will start from this place?  And no. <br>  The fact is that everything is written before us. <br>  There is a wonderful python library - <b>minecraftstuff</b> , which can do all the basic things in Minecraft. <br>  We only need to describe where and what type of cube we want to create. <br><br>  We connect and initialize the library: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mcpi.minecraft <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> minecraft <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mcpi.block <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> block <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mcpi.minecraftstuff <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> minecraftstuff mc = minecraft.Minecraft.create() mcdrawing = minecraftstuff.MinecraftDrawing(mc)</code> </pre><br>  Now coordinates.  Minecraft is a three-dimensional world, so obviously we need x, y and z. <br>  You can take the current coordinates of the character with the mc.player.getTilePos () command, but I decided to hardcover a certain place in the Minecrft world (simply because after each iteration I needed to clear the entire space with the previous attempt of ‚Äúbuilding‚Äù.) For debug it‚Äôs more convenient, in general <br><br>  The cube is drawn with the mc.setBlock command (x, y, z, blockType). <br><br>  How to remove the cube?  As it turned out - the air in Minecraft is also a cube.  Therefore, instead of removing the cubes - you just need to draw the cubes with air.  You can do this individually using the same mc.setBlock command (x, y, z, block.AIR.id) - indicating the block type ‚Äúblock.AIR.id‚Äù.  And you can use the command mc.setBlocks () which clogs a rectangular area with cubes of the desired type.  The book says that it is faster than drawing cubes one by one. <br><br>  In the end, I got this code to clean the space: <br><br><pre> <code class="python hljs">mc.postToChat(<span class="hljs-string"><span class="hljs-string">"START"</span></span>) startX=<span class="hljs-number"><span class="hljs-number">146</span></span>; startY=<span class="hljs-number"><span class="hljs-number">0</span></span>; startZ=<span class="hljs-number"><span class="hljs-number">-30</span></span> //    <span class="hljs-comment"><span class="hljs-comment"># Clean up mc.setBlocks(startX-2, startY-20, startZ+5, startX+2, startY+200, startZ-250, 8) time.sleep(2) mc.setBlocks(startX-3, startY-1, startZ+6, startX+3, startY+210, startZ-551, block.AIR.id) time.sleep(2) # cleanUp(pos.x, pos.y, pos.z, 40) # Clean up self mc.postToChat("Clean up is done")</span></span></code> </pre><br>  Livehack  Here I first fill the space with dice with ID = 8 and then I fill the same space with air. <br>  This is done solely for debug, so that you can see exactly which area will be cleared after 2 seconds.  Otherwise, it is absolutely not obvious and takes a lot of time to guess the necessary coordinates. <br><br>  In general, this whole section of code can be replaced with just one command: mc.setBlocks (startX-3, startY-1, startZ + 6, startX + 3, startY + 210, startZ-551, block.AIR.id), everything else only for debug. <br><br>  To make it more beautiful, I decided that each call would be presented in the form of a tower 2 cubes wide (and thick) - and the duration of the bell would be represented by the height of the tower (1 second = 1 cubic).  Therefore, a simple procedure that draws a tower of a given height: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawCall</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y, z, length, blockType)</span></span></span><span class="hljs-function">:</span></span> length = (length, <span class="hljs-number"><span class="hljs-number">200</span></span>)[length&gt;<span class="hljs-number"><span class="hljs-number">200</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(y, y+length): mc.setBlock(x, i, z, blockType) mc.setBlock(x+<span class="hljs-number"><span class="hljs-number">1</span></span>, i, z, blockType) mc.setBlock(x+<span class="hljs-number"><span class="hljs-number">1</span></span>, i, z+<span class="hljs-number"><span class="hljs-number">1</span></span>, blockType) mc.setBlock(x, i, z+<span class="hljs-number"><span class="hljs-number">1</span></span>, blockType)</code> </pre><br>  Note that distortion is built into it - because the height of the world in Minecraft, as it turned out, is 255 cubes, so if the call was longer than 255 seconds (and there are of course many), they go above the ‚Äúroof of the world‚Äù and continue from the ‚Äúbottom of the world ‚ÄúWhich is certainly not aesthetic. <br><br>  Now we have everything ready to draw calls. <br>  Just go over the array of calls received from the API and draw towers (using cubes of different types to visually represent call waiting time, talk time and missed calls - in red). <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> call <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> json: offset+=<span class="hljs-number"><span class="hljs-number">3</span></span> duration = get_sec(call[<span class="hljs-string"><span class="hljs-string">'duration'</span></span>]) wait_duration = get_sec(call[<span class="hljs-string"><span class="hljs-string">'wait_duration'</span></span>]) speak_duration = get_sec(call[<span class="hljs-string"><span class="hljs-string">'speak_duration'</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> call[<span class="hljs-string"><span class="hljs-string">'accepted'</span></span>] == <span class="hljs-number"><span class="hljs-number">1</span></span>: drawCall(startX, startY, startZ-offset, wait_duration, <span class="hljs-number"><span class="hljs-number">41</span></span>) <span class="hljs-comment"><span class="hljs-comment"># wait_duration drawCall(startX, startY+wait_duration, startZ-offset, speak_duration, 133) #speak_duration else: drawCall(startX, startY, startZ-offset, duration, 152) # duration</span></span></code> </pre><br><br>  That's all, go to minecraft and admire the three-dimensional statistics of calls. <br><br>  By the way, I recorded one video myself, and the second one was recorded by a child.  Guess what where? <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/2J29UiNo1s8%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhixuH2rwzH8Io5CuCcKDRN5pf-ZYA" frameborder="0" allowfullscreen=""></iframe><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/kQyMo2mGyaU%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh6JTNfOnH-J_sSg6-tz-V_a45QHw" frameborder="0" allowfullscreen=""></iframe><br><br>  Yellow cubes - waiting time (beeps), green - talk time, red - missed call. <br><br>  [ <a href="https://github.com/n0quarter/minecraft_calltracking/blob/master/iStat24.py">Script source in Python</a> ] <br><br>  And the promised at the beginning of the post video 3 hours of development compressed to 3 minutes: <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/60Ib_D7sXtU%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgs6KYemed6RkEe2iaWKez071tFLg" frameborder="0" allowfullscreen=""></iframe><br><br>  And finally, the question, what processes / data, in your opinion, would look better in three-dimensional form? <br>  Offhand: <br>  - Dashboards for displaying production servers, in case of any of them falling - the script automatically adds a dynamite cube and blows it up :) if Minecraft is brought to the office monitor and the volume is adjusted loudly - it should be impressive. <br>  Any more ideas? </div><p>Source: <a href="https://habr.com/ru/post/278995/">https://habr.com/ru/post/278995/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278977/index.html">1.1 SFML and Visual Studio</a></li>
<li><a href="../278985/index.html">Async / await emulation in Delphi</a></li>
<li><a href="../278987/index.html">SonataAdminBundle: Creating an Object from a List View (Part 1)</a></li>
<li><a href="../278989/index.html">Android N makes it easy to work with encryption</a></li>
<li><a href="../278991/index.html">Report with MoscowJS February 25</a></li>
<li><a href="../278997/index.html">Release Webix 3.2. New widgets for working with data and other features</a></li>
<li><a href="../278999/index.html">Thorny road to sales on Themeforest.net - Part 1</a></li>
<li><a href="../279005/index.html">Creating reports in PowerShell</a></li>
<li><a href="../279007/index.html">Crutch for the signal-slot system in Qt</a></li>
<li><a href="../279011/index.html">Update DataGrid after DELETE (WPF)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>