<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automatic spell checker in EXCEL</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good time of the day Habrozhiteli. 

 Just the other day, ‚Äúexperienced users‚Äù Excel addressed me and my colleagues. According to the specifics of the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automatic spell checker in EXCEL</h1><div class="post__text post__text-html js-mediator-article">  Good time of the day Habrozhiteli. <br><br>  Just the other day, ‚Äúexperienced users‚Äù Excel addressed me and my colleagues.  According to the specifics of the work, ‚Äúexperienced users‚Äù often use an office suite for documentation.  Oddly enough, Excel spreadsheets are also common.  As on Habr√©, it is not permissible to issue documents with spelling errors.  There is no standard excel feature, there is no spelling error.  In this regard, I developed Add-ins for Excel that would implement such functionality. <br><a name="habracut"></a><br>  Check for errors is not so difficult, there is a standard SpellCheck, which I used.  It is planned to implement 2 parts: <br>  1) verification of already filled cells <br>  2) check in real time as you type. <br>  The very logic of the operation is simple. In the first case, we check all the cells, if there is an error, select the tokens and check each lexeme separately, for erroneous tokens, create a note and highlight the erroneous lexeme in red.  In the second case, we simply subscribe to the cell change event and do everything as in 1 case only with a smaller range. <br><br>  Let's start: <br>  Launch VisualStudio, create an extension for Excel 2007. <br>  When registering the plugin, subscribe to the Cell-Changed event and call our function (the function will be described a little later). <br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ThisAddIn_Startup</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, System.EventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//     Globals.ThisAddIn.Application.Cells.Worksheet.Change += new Excel.DocEvents_ChangeEventHandler(Worksheet_Change); } void Worksheet_Change(Excel.Range Target) { SpellCheck.SpellChecker(Target); }</span></span></code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      More during the registration will not do anything.  Check the entire book will leave the user on call. <br>  Create your own tab in Ribbon.  Add a new Item Ribbon (Visual Designer) / <br>  Create a new tab, do not touch the first, because  she is reserved. <br>  Also, add 2 check buttons: check the entire book, and check the current sheet. <br>  Let's write the following code in the button events <br>  <b>For the whole book</b> <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OrfoCheckAll_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, RibbonControlEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> excel = Globals.ThisAddIn.Application; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> wss = excel.Worksheets; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> app = excel.Application; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ws <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> wss) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sheet = ws <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Excel.Worksheet; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sheet != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> range = sheet.UsedRange; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cll <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cell = cll <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Excel.Range; SpellCheck.SpellChecker(cell); } } } }</code> </pre><br>  <b>For sheet</b> <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OrfoCheckCurrentSheet_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, RibbonControlEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> excel = Globals.ThisAddIn.Application; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> app = excel.Application; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sheet = app.ActiveSheet <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Excel.Worksheet; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sheet != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> range = sheet.UsedRange; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cll <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cell = cll <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Excel.Range; SpellCheck.SpellChecker(cell); } } }</code> </pre><br>  And most importantly, we will create a static class SpellCheck in which we describe our verification function <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SpellCheck</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SpellChecker</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Excel.Range Target</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> app = Globals.ThisAddIn.Application.Application; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> str = Target.Text.ToString(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (app.CheckSpelling(str, Type.Missing, <span class="hljs-literal"><span class="hljs-literal">true</span></span>) == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> tmp </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">in</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span></span><span class="hljs-function">)str).</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Split</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">' '</span></span></span></span></span><span class="hljs-function">))</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (app.CheckSpelling(tmp, Type.Missing, Type.Missing) == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Target.Comment == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { Target.AddComment(<span class="hljs-string"><span class="hljs-string">"   "</span></span> + tmp); Target.Characters[str.IndexOf(tmp) + <span class="hljs-number"><span class="hljs-number">1</span></span>, tmp.Length].Font.ColorIndex = <span class="hljs-number"><span class="hljs-number">3</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Excel.Characters c = Target.Comment.Shape.TextFrame.Characters(Type.Missing, Type.Missing); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!c.Caption.Contains(tmp)) { c.Caption = c.Caption + <span class="hljs-string"><span class="hljs-string">" "</span></span> + tmp; } Target.Characters[str.IndexOf(tmp) + <span class="hljs-number"><span class="hljs-number">1</span></span>, tmp.Length].Font.ColorIndex = <span class="hljs-number"><span class="hljs-number">3</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Target.Characters[str.IndexOf(tmp) + <span class="hljs-number"><span class="hljs-number">1</span></span>, tmp.Length].Font.ColorIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Target.Comment != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Target.Comment.Shape.AlternativeText.Contains(<span class="hljs-string"><span class="hljs-string">"   "</span></span>)) { Target.Characters[str.IndexOf(str), str.Length].Font.ColorIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>; Target.Comment.Delete(); } } } }</code> </pre><br>  After compiling and loading the plug-in, we check the work. <br><img src="http://sbdesign.ru/habr/snap.gif" alt="image"><br>  This is all that Excel lacked for automatic verification. <br>  As always, if you have more interesting implementation methods, share your experienceÔÅä <br><br>  UPD: At the request of the workers, I posted the ready Plugin <a href="http://depositfiles.com/files/ejg37ip3n">here</a> </div><p>Source: <a href="https://habr.com/ru/post/136520/">https://habr.com/ru/post/136520/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../136514/index.html">Axxerion received ISAE 3402 Type II certification</a></li>
<li><a href="../136515/index.html">ReactOS celebrates jubilee build 55000</a></li>
<li><a href="../136516/index.html">Templating in PHP using lambda functions and closures</a></li>
<li><a href="../136517/index.html">What is ITSM?</a></li>
<li><a href="../136518/index.html">Encapsulation - black box?</a></li>
<li><a href="../136525/index.html">LESS: programmable style language</a></li>
<li><a href="../136527/index.html">LG Electronics in 2012. Plans and business tasks</a></li>
<li><a href="../136528/index.html">Developing a compiler for the cool language in C # for .NET (Part 1)</a></li>
<li><a href="../136529/index.html">Writing a simple plugin for Sublime Text 2</a></li>
<li><a href="../136530/index.html">Determining the dominant tones in the image</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>