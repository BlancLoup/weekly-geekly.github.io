<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Anonymous browser do it yourself or Hide your ass yourself</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 This small topic will tell you how to quickly and easily create your browser, with a few extras that will help us stay anonymous in the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Anonymous browser do it yourself or Hide your ass yourself</h1><div class="post__text post__text-html js-mediator-article"><h5>  Introduction </h5><br>  This small topic will tell you how to quickly and easily create your browser, with a few extras that will help us stay anonymous in the network.  Qt will do all the hard work for us, namely its QtWebKit module.  We will only add lines to the right places that replace the http-headers of our http-requests.  This will allow you to remain anonymous when passively analyzing http requests.  We will also redefine the navigator, which allows us to remain anonymous for javascript-s with active identification.  For definiteness, we will designate the basic parameters with which we can be identified in the network - that‚Äôs what we‚Äôll replace them for.  The first is of course the IP address, everything is simple - we use a proxy.  The second is any http-request headers (the user-agent will be most interesting: its value should be replaced both in http-request headers and in javascript checking).  We also implement the ability to edit and substitute your cookies for certain sites, since there is such an opportunity.  And we will supplement all this with the built-in editor for the substituted parameters with the possibility of saving them for later use. <br><a name="habracut"></a><br>  We take the QWebView class as the basis for our browser, which will take over the work of loading and displaying any web pages. <br><br> <code>QWebView* pView = new QWebView; <br> pView-&gt;load(url);</code> <br> <br>  In order to have access to all requests that pView forms, define our QBotNetworkAccessManager class inherited from QNetworkAccessManager, create an object of this class and set it as a NetworkManager for pView. <br><br> <code>m_NetManage = new QBotNetworkAccessManager; <br> pView-&gt;page()-&gt;setNetworkAccessManager(m_NetManage);</code> <br> <br>  Install a proxy through which NetworkManager will work and, accordingly, our browser: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>//pProxiEdit ‚Äì       IP:Port <br> QRegExp rx("^\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3}:\\d{2,}$") <br> QString sProxiIP, sPRoxiPort, sTmp; <br> sTmp = pProxiEdit-&gt;text(); <br> if(rx.indexIn(sTmp, 0) != -1) { <br> int pos = sTmp.indexOf(":"); <br> sProxiIP = sTmp.mid(0, pos); <br> sPRoxiPort = sTmp.mid(pos + 1, sTmp.size() - pos - 1); <br> QNetworkProxy* proxy = new QNetworkProxy(QNetworkProxy::HttpProxy, sProxiIP, sPRoxiPort.toUInt()); <br> m_NetManage-&gt;setProxy(*proxy); <br> }</code> <br> <br><h5>  Changing HTTP request headers </h5><br>  Access to http requests generated by our browser is in the function <br><br> <code>QNetworkReply * QNetworkAccessManager::createRequest ( Operation op, const QNetworkRequest &amp; req, QIODevice * outgoingData = 0 ) [virtual protected]</code> <br> <br>  which we need to redefine in our QBotNetworkAccessManager class. <br>  Override it like this: <br><br> <code>QNetworkReply * QBotNetworkAccessManager::createRequest ( Operation op, const QNetworkRequest &amp; req, QIODevice * outgoingData) { <br> QNetworkRequest myReq(req);//   QNetworkRequest &amp; req <br> //   http-    <br> myReq.setRawHeader("User-Agent", sUA.toUtf8()); <br> //    ... <br> return QNetworkAccessManager::createRequest( op, myReq, outgoingData); <br> }</code> <br> <br>  This way you can implement the substitution of any http-request headers sent by our browser to the headers we need. <br>  Now, it is necessary that the javascript-s, our browser is also determined as necessary.  To do this, before downloading the next page, edit the javascript by changing it so that it sends the information we need to the server.  To do this, when changing the appearance of the page, we will override the navigator as shown below by running javascript: <br><br> <code>QString sUA = "MY_USER_AGENT"; <br> ... <br> connect(pView, SIGNAL(urlChanged(const QUrl&amp;)), this, SLOT(OnUrlChanged(const QUrl&amp;))); <br> ... <br> void MainWindow::OnUrlChanged(const QUrl&amp; url) { <br> QString jScript = QString("var navigator = new Object; navigator.appName = '%1';").arg(sUA); <br> pUrlEdit-&gt;setText(url.toString()); <br> pView-&gt;page()-&gt;mainFrame()-&gt;evaluateJavaScript(jScript); <br> }</code> <br> <br>  We perform the same function before loading the page: <br><br> <code>... <br> OnUrlChanged(url); <br> pView-&gt;load(url); <br> ...</code> <br> <br>  Now javascript is seen as in the analysis of http headers. <br><img src="https://habrastorage.org/getpro/habr/post_images/d7e/e26/24d/d7ee2624d98bc2d21202158790bcd394.jpg" alt="image"><br><br><h5>  Working with cookies </h5><br>  Save cookies and other information (in this case, only the cookie and user-agent will be) will be in the form of a vector of structures defined below: <br><br> <code><code><code><a href="http://www.free-lance.ru/">struct SDataArhive { <br> QByteArray BaseItemText; <br> QMap&lt;QByteArray, QByteArray&gt; ChItemText; <br> }; <br> QVector vDataArhive; <br> <br>  cookie  user-agent-      : <br> <br> QList ListCookies; <br> //   cookie    <br> ListCookies = pView-&gt;page()-&gt;networkAccessManager()-&gt;cookieJar()-&gt;cookiesForUrl(pView-&gt;url()); <br> QByteArray sByteAr = ""; <br> SDataArhive strTmp <br> //   cookie  QByteArray, <br> //      <br> for(int i = 0; i &lt; ListCookies.size(); i++) { <br> sByteAr += ListCookies[i].name(); <br> sByteAr += "="; <br> sByteAr += ListCookies[i].value(); <br> if(i &lt; (ListCookies.size() - 1)){ <br> sByteAr += "\n"; <br> } <br> } <br> strTmp.ChItemText.insert("cookie", sByteAr); <br> //---------------------------------------- <br> // User-Aget <br> sByteAr = sUA.toUtf8(); <br> strTmp.ChItemText.insert("user-agent", sByteAr); <br> //-------------------------------------- <br> vDataArhive.append(strTmp); <br> <br>      cookie    .    ,    . <br> <img src="http://s001.radikal.ru/i194/1101/66/f60caeb7d870.jpg" alt="image"> <br> <br> ,  cookie,      : <br> <br> //   QByteArray cookie <br> QByteArray tmp = vDataArhive[IdxTop].ChItemText[dataIdx]; <br> //  QByteArray   cookie <br> QList ListData = tmp.split('\n'); <br> QList ListCookies; <br> if(!ListData.isEmpty()) { <br> for(int i = 0; i &lt; ListData.size(); i++) { <br> QList cooka = ListData[i].split('='); <br> if(cooka.size() == 2) { <br> ListCookies.push_back(QNetworkCookie(cooka[0], cooka[1])); <br> } <br> } <br> if(!ListCookies.isEmpty()){ <br> //  cookie    <br> pView-&gt;page()-&gt;networkAccessManager()-&gt;cookieJar()-&gt;setCookiesFromUrl(ListCookies ,pView-&gt;url()); <br> } <br> } <br> //   user-agent <br> sUA = vDataArhive[IdxTop].ChItemText["user-agent"]; <br> <br>   :    . <br> <br> PS       www.free-lance.ru</a> ,      Qt   <a href="http://www.prog.org.ru/">www.prog.org.ru</a> .</code></code></code> </div><p>Source: <a href="https://habr.com/ru/post/111912/">https://habr.com/ru/post/111912/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../111902/index.html">REST through Spring: Strictly mapping a URL to a resource</a></li>
<li><a href="../111905/index.html">Facebook email</a></li>
<li><a href="../111907/index.html">OpenVZ Web Panel</a></li>
<li><a href="../111908/index.html">Configuring Eclipse to work with Arduino Uno</a></li>
<li><a href="../111911/index.html">Hibernate: using lazy initialization in developing a client-server application</a></li>
<li><a href="../111915/index.html">New design version</a></li>
<li><a href="../111916/index.html">NetApp AutoSupport - Call Your Parents!</a></li>
<li><a href="../111917/index.html">With a decade, Wikipedia!</a></li>
<li><a href="../111918/index.html">Making requests with difficult conditions</a></li>
<li><a href="../111919/index.html">Fast autocomplete using libscgi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>