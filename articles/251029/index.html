<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Create a rotating logo using ImageMagick and FFMPEG</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article may be of interest to those who want to slightly revive the design of their video channel, as well as those who have just started working ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Create a rotating logo using ImageMagick and FFMPEG</h1><div class="post__text post__text-html js-mediator-article">  The article may be of interest to those who want to slightly revive the design of their video channel, as well as those who have just started working with the tools specified in the title.  Confident users, I hope, will complement my material. <br><br>  I wondered how to revive the logo, which I impose on the videos of some sporting events.  There was an idea to make a 20 logo turning around its vertical axis every seconds.  As a result, I wanted to get something like this: <br><br><img src="//habrastorage.org/files/5e1/19b/98d/5e119b98db454c6aabe337e9ee9d993f.gif"><br><a name="habracut"></a><br>  To complete the task, you need a system with imagemagick and ffmpeg installed.  The bash will be used to form commands for imagemagick.  What would be the use of the bc utility?  The math in bash is pretty simple and it‚Äôs difficult to compute trigonometric functions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Using python, for example, you can make the same thing even easier; in it, sine and cosine are calculated. <br><br>  To create a video, create N frames for which the logo will take a full turn, then turn them into a video file. <br><br>  In fact, rotation is the sequential compression and expansion of an image in one of the dimensions.  If we want to get the effect of uniform rotation around the vertical axis, the image width will be changed multiple of the sine or cosine functions. <br><br>  The initial state for us is a logo visible in full size, so to change the width of the image we will multiply its width by the cosine (its value at zero is just one). <br><br>  Rotation of the image for these purposes can be divided into 4 stages: <br>  - the image is narrowed; <br>  - expands, but turned to the viewer the reverse side; <br>  - narrows downside to the viewer; <br>  - expands to its original size. <br><br>  Let's form a basic set of frames, build for rotation by 0-90 degrees, and frames for the remaining 270 will get a little converting them.  The cycle, accordingly, will not be from 0 to 360 degrees, but from 0 to 90. <br><br>  We will prescribe the path to our logo, so that we can then access it with a short $ logo: <br><br><pre><code class="bash hljs">logo=../../logo/Moto_Gymkhana_transparent.png</code> </pre> <br>  For convenience, we introduce variables equal to the width and height of the logo, so it will be easier to correct the script for another image: <br><br><pre> <code class="bash hljs">width=842 height=595</code> </pre> <br>  Let's get a variable equal to the number of frames for which the logo will make a quarter turn.  It will be needed once - to calculate the step with which the rotation angle should be calculated. <br><br><pre> <code class="bash hljs">Frames=15</code> </pre> <br>  In the loop you will need: <br>  - calculate what will be the width of the image when it is rotated at a given angle "n"; <br>  - create a blank canvas of size, say 850x600; <br>  - add a compressed image to its center. <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (( n=0; n&lt;=90; n+=$(expr $(( 90/<span class="hljs-variable"><span class="hljs-variable">$Frames</span></span> ))))) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> oWidth=$(<span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> %.<span class="hljs-variable"><span class="hljs-variable">$2f</span></span> $(<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$width</span></span></span><span class="hljs-string">*(c(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$n</span></span></span><span class="hljs-string">*4*a(1)/180))+1"</span></span> | bc -l)) convert -size 850x600 xc:transparent -background none \ \( -alpha <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> -channel A -evaluate add -60% <span class="hljs-variable"><span class="hljs-variable">$logo</span></span> -geometry <span class="hljs-variable"><span class="hljs-variable">$oWidth</span></span>\ x<span class="hljs-variable"><span class="hljs-variable">$height</span></span>\! \)\ -gravity center -composite ./tmp/<span class="hljs-variable"><span class="hljs-variable">$n</span></span>.png <span class="hljs-keyword"><span class="hljs-keyword">done</span></span></code> </pre> <br><br>  Let's sort the code in parts. <br><br>  Calculate the width of the image at a given angle: <br><br><pre> <code class="bash hljs">oWidth=$(<span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> %.<span class="hljs-variable"><span class="hljs-variable">$2f</span></span> $(<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$width</span></span></span><span class="hljs-string">*(c(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$n</span></span></span><span class="hljs-string">*4*a(1)/180))+1"</span></span> | bc -l))</code> </pre> <br>  It will be more convenient to disassemble this piece from right to left: <br>  "| bc -l" indicates that this will be computed by the bc utility. <br>  Since  cosine in the ‚Äúbc‚Äù utility accepts values ‚Äã‚Äãin radians as input, and pi numbers in bash are not ‚Äî use the following expression: <br>  c ($ n * 4 * a (1) / 180) - where <br>  ‚ÄúC‚Äù is the cosine, <br>  $ n - the angle in degrees is determined in a cycle; <br>  a (1) is the arctangent of a unit equal to pi / 4.  Therefore, 4 * a (1) is a way to write pi.  180 divide to go from radians to degrees. <br>  Thus, "$ width * (c ($ n * 4 * a (1) / 180))" is the width multiplied by the cosine of the angle "n". <br>  "+1" after this expression to ensure that the image width does not take the value 0. Attempting to make an image of zero width will not understand ImageMagick. <br>  $ (printf%. $ 2f $ (echo "$ width * (c ($ n * 4 * a (1) / 180)) + 1" | bc -l)) - calculate the width for a given angle and output rounded to the whole. <br><br><pre> <code class="bash hljs">convert -size 850x600 xc:transparent -background none \ \( -alpha <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> -channel A -evaluate add -60% <span class="hljs-variable"><span class="hljs-variable">$logo</span></span> -geometry <span class="hljs-variable"><span class="hljs-variable">$oWidth</span></span>\ x<span class="hljs-variable"><span class="hljs-variable">$height</span></span>\! \)\ -gravity center -composite ./tmp/<span class="hljs-variable"><span class="hljs-variable">$n</span></span>.png</code> </pre> <br>  convert -size 850x600 xc: transparent -background none - create a transparent canvas with the size of 640x360 without background. <br><br>  The following part of the command is taken in escaped "\" brackets so that it runs in isolation.  This is important, otherwise the resizing will touch the canvas. <br>  -alpha set - enable transparency channel. <br>  -channel A -evaluate add -60% - add "-60%" to the value of channel A of all image pixels. <br>  $ logo - the path to the image. <br>  -geometry $ oWidth \ x $ height \!  - resize the image. <br>  "-geometry AxB" will resize the image but maintain the aspect ratio.  Those.  if we try to reduce the width, the image height will also decrease to maintain the ‚Äúwidth x height‚Äù ratio, and empty areas will appear above and below. <br>  "-geometry AxB \!"  They are not trying to keep the ‚Äúwidth x height‚Äù ratio, but will change them independently of each other. <br>  -gravity center - place in the middle. <br>  -composite - combine images. <br>  ./tmp/$n.png - save the file to the ‚Äútmp‚Äù folder, calling the current value of the variable ‚Äún‚Äù. <br><br>  View from an angle of 54 degrees: <br><br><img src="//habrastorage.org/files/576/909/e27/576909e2779e487cb157d6208f86695b.png"><br><br>  From this reference image set, create 4 frames of future animation. <br><br>  Let the logo rotate clockwise when viewed from above.  To add volume to the image, add a ‚Äúshadow‚Äù shifted to the right or left depending on where the image rotates on the frame.  And we will reflect the image from left to right on the frames, where the logo is turned to the viewer with the back side.  The ‚Äúshadow‚Äù on the same frames will be added not under the original image, but on top of it to create the effect of the reverse side of the logo. <br><br>  Consider in detail the expression for the first quarter of the turn.  The rest will be clear by analogy.  I only focus on the differences from the first: <br><br><pre> <code class="bash hljs">convert tmp/<span class="hljs-variable"><span class="hljs-variable">$n</span></span>.png \ \( +<span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> -background <span class="hljs-string"><span class="hljs-string">'#cccf'</span></span> -shadow 100x8+<span class="hljs-variable"><span class="hljs-variable">$shadowShift</span></span>-3 \)\ -background none -compose Src_Over -layers merge \ -gravity center tmp/logo$(expr $(( 1000+n ))).png</code> </pre> <br><br>  convert tmp / $ n.png ‚Äî take the source image as a base. <br><br>  \ (+ clone -background '#cccf' -shadow 100x8 + $ shadowShift-3 \) - clone and create an image shadow. <br>  The color specified by the background option will set the color of the shadow. <br>  How much the shadow is opaque (in percent) and is blurred is set by the parameter ‚Äú100x5‚Äù. <br>  The shadow shift relative to the original image is given as + x + y.  In our case, the vertical shift is constant (3 pixels up), and the horizontal shift is set by the variable shadowShift. <br>  The value of this variable is calculated in the same way as the original frame is compressed vertically.  Just take the sine of the angle, not the cosine, because  the zero angle shift should be zero. <br><br>  shadowShift = $ (printf%. $ 2f $ (echo "15 * (s ($ n * 4 * a (1) / 180)) + 1" | bc -l)) <br>  For the first and second quarters, the shadow should be shifted to the right, so the shadowShift value is taken with a plus sign, for the third and fourth - with a minus sign. <br><br>  -background none -compose Dst_Over -layers merge -gravity center -depth 8 tmp / logo $ (expr $ ((1000 + n))). png <br><br>  Here the important option is -compose.  It sets which of the images will be located on top. <br>  For the first quarter of the turn, the logo itself is on top, therefore Dst_Over.  For the second and third quarters, Src_Over will be spelled out (shadow above). <br><br>  -layers merge -gravity center - combine layers, place in the middle. <br><br>  tmp / logo $ (expr $ ((1000 + n))). png - save as logo + ‚Äú1000 + value n‚Äù in the tmp folder. <br><br>  The name is so that the frame names are immediately sorted alphabetically, and it was convenient to give them to ffmpeg for processing. <br><br>  For frames of the second quarter of the turn there will be ‚Äú1800-n‚Äù, for the third ‚Äú2000 + n‚Äù, for the fourth ‚Äú2800-n‚Äù. <br><br>  For the second and third quarters, the -flop option will appear - flip the image from left to right.  Because of this, by the way, you need to change the sign of the displacement of the shadow to the opposite. <br><br>  Code for all four quarters of the turn: <br><br><pre> <code class="bash hljs">convert tmp/<span class="hljs-variable"><span class="hljs-variable">$n</span></span>.png \( +<span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> -background <span class="hljs-string"><span class="hljs-string">'#cccf'</span></span> -shadow 100x8+<span class="hljs-variable"><span class="hljs-variable">$shadowShift</span></span>-3 \) \ -background none -compose Dst_Over -layers merge -gravity center -depth 8 tmp/logo$(expr $(( 1000+n ))).png convert tmp/<span class="hljs-variable"><span class="hljs-variable">$n</span></span>.png \( +<span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> -background <span class="hljs-string"><span class="hljs-string">'#cccf'</span></span> -shadow 100x8-<span class="hljs-variable"><span class="hljs-variable">$shadowShift</span></span>-3 \) \ -background none -compose Src_Over -layers merge -gravity center -flop tmp/logo$(expr $(( 1800-n ))).png convert tmp/<span class="hljs-variable"><span class="hljs-variable">$n</span></span>.png \( +<span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> -background <span class="hljs-string"><span class="hljs-string">'#cccf'</span></span> -shadow 100x8+<span class="hljs-variable"><span class="hljs-variable">$shadowShift</span></span>-3 \) \ -background none -compose Src_Over -layers merge -gravity center -flop tmp/logo$(expr $(( 2000+n ))).png convert tmp/<span class="hljs-variable"><span class="hljs-variable">$n</span></span>.png \( +<span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> -background <span class="hljs-string"><span class="hljs-string">'#cccf'</span></span> -shadow 100x8-<span class="hljs-variable"><span class="hljs-variable">$shadowShift</span></span>-3 \) \ -background none -compose Dst_Over -layers merge -gravity center tmp/logo$(expr $(( 2800-n ))).png</code> </pre> <br><br>  As a result, 4 were obtained from the original frame with minor differences: <br><br><img src="//habrastorage.org/files/bc3/6cc/c5a/bc36ccc5aa4644bbab8a326c6cfb17a1.png"><br><br>  Now it's up to you to collect videos from these images: <br><br><pre> <code class="bash hljs">ffmpeg -pattern_type glob -i <span class="hljs-string"><span class="hljs-string">'tmp/logo*.png'</span></span> -pix_fmt argb -vcodec qtrle -r 30 rotatingLogo.mov</code> </pre> <br>  -pattern_type glob - allows you to set the frame name mask in the usual console view <br>  -i 'tmp / logo * .png' - take as the initial data of the image from the tmp folder whose name begins with "logo" <br>  -pix_fmt argb - set image format with transparency.  ‚ÄúA‚Äù in ARGB is just the alpha channel <br>  -vcodec qtrle - set the codec for video that supports transparency.  From the known to me this ‚Äúqtrle‚Äù and ‚Äúpng‚Äù <br>  -r 30 - set the final video frequency to 30 frames per second. <br>  rotating_logo.mov - save as ‚ÄúrotatingLogo.mov‚Äù <br><br>  Now we can execute the command <pre> <code class="bash hljs">ffplay rotatingLogo.mov</code> </pre>  and look at the result: <br><br><img src="//habrastorage.org/files/5e1/19b/98d/5e119b98db454c6aabe337e9ee9d993f.gif"><br><br>  The resulting video is only a couple of seconds long, t.ch.  Let's combine a lot of these pieces together. <br>  For this we use the same ffmpeg. <br><br>  So that the logo does not rotate permanently, but occasionally we will create a piece of video with a fixed logo.  For an article, let it be a duration of 3 seconds so that you do not have to wait long for a rotation while viewing: <br><br><pre> <code class="bash hljs">ffmpeg -loop 1 -pattern_type glob -i <span class="hljs-string"><span class="hljs-string">'tmp/logo1000.png'</span></span> -pix_fmt argb -vcodec qtrle -r 30 -t 3 stillLogo.mov</code> </pre> <br>  This command has the option "-loop 1" - indicating ffmpeg to repeat the input image sequence (in this case, the only one), and the option "-t 3" indicating that the duration of the final video is 3 seconds. <br><br>  To glue the video with a fixed and rotating logo, create a file with a list of files that you want to glue.  In this case, 20 copies of our files: <br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (( i=0; i&lt;20; i+=1 )) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> file <span class="hljs-string"><span class="hljs-string">'stillLogo.mov'</span></span> &gt;&gt; list.txt <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> file <span class="hljs-string"><span class="hljs-string">'rotatingLogo.mov'</span></span> &gt;&gt; list.txt <span class="hljs-keyword"><span class="hljs-keyword">done</span></span></code> </pre> <br><br>  Let's give this file an input to the concat filter with instructions to copy codecs, but not to transcode (-c copy). <br><br><pre> <code class="bash hljs">ffmpeg -f concat -i list.txt -c copy logoWithRotation.mov</code> </pre> <br><br><img src="//habrastorage.org/files/cdc/f58/3a2/cdcf583a296c408887d1c346600a203d.gif"><br><br>  It remains to impose the resulting logo on the video. <br>  The logo is quite large, t.ch.  at imposing we will scale it, reducing by three times. <br><br><pre> <code class="bash hljs">ffmpeg -i video.mov -i logoWithRotation.mov \ -filter_complex <span class="hljs-string"><span class="hljs-string">"[1:0]scale=iw/2:ih/2[logo];[0:0][logo]overlay=shortest=1:x=20:y=500"</span></span> \ -vcodec libx264 -crf 18 overlay.mov</code> </pre> <br><br>  ffmpeg -i video.mov -i logoWithRotation.mov - take two videos as input. <br><br>  -filter_complex - use filter_complex to which we specify the following: <br>  [1: 0] scale = iw / 3: ih / 3 [logo] - take stream 0 from the second video (1 sample is from zero) and reduce the width (iw - input width) and height (ih - input height) value .  Pass on with the name "logo". <br><br>  [0: 0] [logo] overlay = shortest = 1: x = 20: y = 0 ‚Äî take stream 0 from the first video and stream ‚Äúlogo‚Äù and superimpose them on each other. <br>  ‚ÄúShortest = 1‚Äù - says stop when the end of any stream is reached. <br>  x = 20: y = 500 - indicates where to place the left upper corner of the video overlay. <br><br>  -vcodec libx264 -crf 18 - use H264 codec.  The value after crf indicates how much to compress.  0 - no compression at all. <br><br>  overlay.mov - save under this name. <br><br>  View result: <br><br><pre> <code class="bash hljs">ffplay overlay.mov</code> </pre> <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/AwA-hi6sCRA%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700190,15700253&amp;usg=ALkJrhieWiidlaagCwLtdJFixiPkpxlBig" frameborder="0" allowfullscreen=""></iframe><br><br><hr><br>  Drawings and animation for the article created using the same tools.  In order of appearance in the article: <br><br><pre> <code class="bash hljs">ffmpeg -i rotatingLogo.mov -filter_complex <span class="hljs-string"><span class="hljs-string">"[0:0]scale=iw/3:ih/3"</span></span> rotatingLogo.gif montage tmp/54.png -geometry 300x200 result.png montage -mode concatenate -tile 2x2 tmp/logo1054.png tmp/logo1746.png tmp/logo2054.png tmp/logo2746.png -geometry 300x200 result.png ffmpeg -i logoWithRotation.mov -t 5.5 -filter_complex <span class="hljs-string"><span class="hljs-string">"[0:0]scale=iw/3:ih/3"</span></span> logoWithRotation.gif</code> </pre> <br><br><hr><br>  The final script for creating a rotating logo: <br><br><pre> <code class="bash hljs">logo=../../logo/Moto_Gymkhana_transparent.png Frames=15 width=842 height=595 mkdir tmp <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (( n=0; n&lt;=90; n+=$(expr $(( 90/<span class="hljs-variable"><span class="hljs-variable">$Frames</span></span> ))))) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> oWidth=$(<span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> %.<span class="hljs-variable"><span class="hljs-variable">$2f</span></span> $(<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$width</span></span></span><span class="hljs-string">*(c(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$n</span></span></span><span class="hljs-string">*4*a(1)/180))+1"</span></span> | bc -l)) shadowShift=$(<span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> %.<span class="hljs-variable"><span class="hljs-variable">$2f</span></span> $(<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"15*(s(</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$n</span></span></span><span class="hljs-string">*4*a(1)/180))+1"</span></span> | bc -l)) convert -size 850x600 xc:transparent -background none \( -alpha <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> -channel A -evaluate add -50% <span class="hljs-variable"><span class="hljs-variable">$logo</span></span> -geometry <span class="hljs-variable"><span class="hljs-variable">$oWidth</span></span>\ x<span class="hljs-variable"><span class="hljs-variable">$height</span></span>\! \) -gravity center -composite -depth 8 ./tmp/<span class="hljs-variable"><span class="hljs-variable">$n</span></span>.png convert tmp/<span class="hljs-variable"><span class="hljs-variable">$n</span></span>.png \( +<span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> -background <span class="hljs-string"><span class="hljs-string">'#cccf'</span></span> -shadow 100x8+<span class="hljs-variable"><span class="hljs-variable">$shadowShift</span></span>-3 \) -background none -compose Dst_Over -layers merge -gravity center -depth 8 tmp/logo$(expr $(( 1000+n ))).png convert tmp/<span class="hljs-variable"><span class="hljs-variable">$n</span></span>.png \( +<span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> -background <span class="hljs-string"><span class="hljs-string">'#cccf'</span></span> -shadow 100x8-<span class="hljs-variable"><span class="hljs-variable">$shadowShift</span></span>-3 \) -background none -compose Src_Over -layers merge -gravity center -flop tmp/logo$(expr $(( 1800-n ))).png convert tmp/<span class="hljs-variable"><span class="hljs-variable">$n</span></span>.png \( +<span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> -background <span class="hljs-string"><span class="hljs-string">'#cccf'</span></span> -shadow 100x8+<span class="hljs-variable"><span class="hljs-variable">$shadowShift</span></span>-3 \) -background none -compose Src_Over -layers merge -gravity center -flop tmp/logo$(expr $(( 2000+n ))).png convert tmp/<span class="hljs-variable"><span class="hljs-variable">$n</span></span>.png \( +<span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> -background <span class="hljs-string"><span class="hljs-string">'#cccf'</span></span> -shadow 100x8-<span class="hljs-variable"><span class="hljs-variable">$shadowShift</span></span>-3 \) -background none -compose Dst_Over -layers merge -gravity center tmp/logo$(expr $(( 2800-n ))).png <span class="hljs-keyword"><span class="hljs-keyword">done</span></span> ffmpeg -pattern_type glob -i <span class="hljs-string"><span class="hljs-string">'tmp/logo*.png'</span></span> -pix_fmt argb -vcodec qtrle -r 30 rotatingLogo.mov ffmpeg -loop 1 -pattern_type glob -i <span class="hljs-string"><span class="hljs-string">'tmp/logo1000.png'</span></span> -pix_fmt argb -vcodec qtrle -r 30 -t 3 stillLogo.mov rm list.txt <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (( i=0; i&lt;20; i+=1 )) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> file <span class="hljs-string"><span class="hljs-string">'stillLogo.mov'</span></span> &gt;&gt; list.txt <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> file <span class="hljs-string"><span class="hljs-string">'rotatingLogo.mov'</span></span> &gt;&gt; list.txt <span class="hljs-keyword"><span class="hljs-keyword">done</span></span> ffmpeg -f concat -i list.txt -c copy logoWithRotation.mov</code> </pre> <br><br>  Overlay on the video.mov file with a decrease in the logo three times: <br><br><pre> <code class="bash hljs">ffmpeg -i video.mov -i logoWithRotation.mov -filter_complex <span class="hljs-string"><span class="hljs-string">"[1:0]scale=iw/3:ih/3[logo];[0:0][logo]overlay=shortest=1:x=20:y=500"</span></span> -vcodec libx264 -crf 18 overlay.mov</code> </pre> </div><p>Source: <a href="https://habr.com/ru/post/251029/">https://habr.com/ru/post/251029/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../251011/index.html">Android users will pay for the words, Nintendo will release an application for iOS, Rovio will print a book - and other news of the week for a mobile developer</a></li>
<li><a href="../251015/index.html">All-Russian population census: how your data is compressed</a></li>
<li><a href="../251019/index.html">Nanobots in our brain</a></li>
<li><a href="../251023/index.html">Convergence based on HP Networking. Part 1</a></li>
<li><a href="../251025/index.html">Introducing 3CX WebMeeting 7.1 Beta - Next Generation Video Conferencing</a></li>
<li><a href="../251031/index.html">Updating services running on Go</a></li>
<li><a href="../251035/index.html">Learning JavaScript programming</a></li>
<li><a href="../251037/index.html">March 2-5: PRO online conference + Skills: 4 skills in 4 days</a></li>
<li><a href="../251039/index.html">WordPress 4.1.1 Released</a></li>
<li><a href="../251041/index.html">Transparent encryption: advantages and disadvantages</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>